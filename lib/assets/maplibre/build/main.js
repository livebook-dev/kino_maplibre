var f3=Object.create;var Wm=Object.defineProperty;var m3=Object.getOwnPropertyDescriptor;var C3=Object.getOwnPropertyNames;var I3=Object.getPrototypeOf,y3=Object.prototype.hasOwnProperty;var gd=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+r+'" is not supported')});var dd=(r,t)=>()=>(r&&(t=r(r=0)),t);var la=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),Om=(r,t)=>{for(var i in t)Wm(r,i,{get:t[i],enumerable:!0})},b3=(r,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let A of C3(t))!y3.call(r,A)&&A!==i&&Wm(r,A,{get:()=>t[A],enumerable:!(s=m3(t,A))||s.enumerable});return r};var pd=(r,t,i)=>(i=r!=null?f3(I3(r)):{},b3(t||!r||!r.__esModule?Wm(i,"default",{value:r,enumerable:!0}):i,r));var Xm=la((zm,Jm)=>{(function(r,t){typeof zm=="object"&&typeof Jm<"u"?Jm.exports=t():typeof define=="function"&&define.amd?define(t):(r=typeof globalThis<"u"?globalThis:r||self,r.maplibregl=t())})(zm,function(){"use strict";var r={},t={};function i(A,o,g){if(t[A]=g,A==="index"){var d="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",C={};return t.shared(C),t.index(r,C),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([d],{type:"text/javascript"}))),r}}i("shared",["exports"],function(A){"use strict";function o(a,e,l,u){return new(l||(l=Promise))(function(m,w){function B(M){try{Q(u.next(M))}catch(D){w(D)}}function S(M){try{Q(u.throw(M))}catch(D){w(D)}}function Q(M){var D;M.done?m(M.value):(D=M.value,D instanceof l?D:new l(function(z){z(D)})).then(B,S)}Q((u=u.apply(a,e||[])).next())})}function g(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}typeof SuppressedError=="function"&&SuppressedError;var d=C;function C(a,e){this.x=a,this.y=e}C.prototype={clone:function(){return new C(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,e){return this.clone()._rotateAround(a,e)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var e=a.x-this.x,l=a.y-this.y;return e*e+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,e){return Math.atan2(this.x*e-this.y*a,this.x*a+this.y*e)},_matMult:function(a){var e=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=e,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var e=Math.cos(a),l=Math.sin(a),u=l*this.x+e*this.y;return this.x=e*this.x-l*this.y,this.y=u,this},_rotateAround:function(a,e){var l=Math.cos(a),u=Math.sin(a),m=e.y+u*(this.x-e.x)+l*(this.y-e.y);return this.x=e.x+l*(this.x-e.x)-u*(this.y-e.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},C.convert=function(a){return a instanceof C?a:Array.isArray(a)?new C(a[0],a[1]):a};var v=g(d),x=T;function T(a,e,l,u){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(u-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=e,this.p2x=l,this.p2y=u}T.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,e){if(e===void 0&&(e=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,u=0;u<8;u++){var m=this.sampleCurveX(l)-a;if(Math.abs(m)<e)return l;var w=this.sampleCurveDerivativeX(l);if(Math.abs(w)<1e-6)break;l-=m/w}var B=0,S=1;for(l=a,u=0;u<20&&(m=this.sampleCurveX(l),!(Math.abs(m-a)<e));u++)a>m?B=l:S=l,l=.5*(S-B)+B;return l},solve:function(a,e){return this.sampleCurveY(this.solveCurveX(a,e))}};var G=g(x);let k,W;function K(){return k==null&&(k=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),k}function $(){if(W==null&&(W=!1,K())){let e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let u=0;u<5*5;u++){let m=4*u;e.fillStyle=`rgb(${m},${m+1},${m+2})`,e.fillRect(u%5,Math.floor(u/5),1,1)}let l=e.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&l[u]!==u){W=!0;break}}}return W||!1}function O(a,e,l,u){let m=new G(a,e,l,u);return function(w){return m.solve(w)}}let tt=O(.25,.1,.25,1);function at(a,e,l){return Math.min(l,Math.max(e,a))}function Lt(a,e,l){let u=l-e,m=((a-e)%u+u)%u+e;return m===e?l:m}function Tt(a,...e){for(let l of e)for(let u in l)a[u]=l[u];return a}let Qt=1;function Ft(a,e,l){let u={};for(let m in a)u[m]=e.call(l||this,a[m],m,a);return u}function vt(a,e,l){let u={};for(let m in a)e.call(l||this,a[m],m,a)&&(u[m]=a[m]);return u}function Jt(a){return Array.isArray(a)?a.map(Jt):typeof a=="object"&&a?Ft(a,Jt):a}let qt={};function At(a){qt[a]||(typeof console<"u"&&console.warn(a),qt[a]=!0)}function lt(a,e,l){return(l.y-a.y)*(e.x-a.x)>(e.y-a.y)*(l.x-a.x)}function kt(a){let e=0;for(let l,u,m=0,w=a.length,B=w-1;m<w;B=m++)l=a[m],u=a[B],e+=(u.x-l.x)*(l.y+u.y);return e}function _t(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let le=null;function ie(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}let ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function te(a,e,l,u,m){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let w=new VideoFrame(a,{timestamp:0});try{let B=w?.format;if(!B||!B.startsWith("BGR")&&!B.startsWith("RGB"))throw new Error(`Unrecognized format ${B}`);let S=B.startsWith("BGR"),Q=new Uint8ClampedArray(u*m*4);if(yield w.copyTo(Q,function(M,D,z,et,nt){let st=4*Math.max(-D,0),mt=(Math.max(0,z)-z)*et*4+st,St=4*et,Vt=Math.max(0,D),oe=Math.max(0,z);return{rect:{x:Vt,y:oe,width:Math.min(M.width,D+et)-Vt,height:Math.min(M.height,z+nt)-oe},layout:[{offset:mt,stride:St}]}}(a,e,l,u,m)),S)for(let M=0;M<Q.length;M+=4){let D=Q[M];Q[M]=Q[M+2],Q[M+2]=D}return Q}finally{w.close()}})}let wt,Ut,fe="AbortError";function j(){return new Error(fe)}let bt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function It(a){return bt.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}let Ht="global-dispatcher";class Ot extends Error{constructor(e,l,u,m){super(`AJAXError: ${l} (${e}): ${u}`),this.status=e,this.statusText=l,this.url=u,this.body=m}}let Ae=()=>_t(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,he=function(a,e){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){let u=It(a.url);if(u)return u(a,e);if(_t(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:a,targetMapId:Ht},e)}if(!(/^file:/.test(l=a.url)||/^file:/.test(Ae())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(u,m){return o(this,void 0,void 0,function*(){let w=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:Ae(),signal:m.signal});u.type==="json"&&w.headers.set("Accept","application/json");let B=yield fetch(w);if(!B.ok){let M=yield B.blob();throw new Ot(B.status,B.statusText,u.url,M)}let S;S=u.type==="arrayBuffer"||u.type==="image"?B.arrayBuffer():u.type==="json"?B.json():B.text();let Q=yield S;if(m.signal.aborted)throw j();return{data:Q,cacheControl:B.headers.get("Cache-Control"),expires:B.headers.get("Expires")}})}(a,e);if(_t(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"getResource",data:a,mustQueue:!0,targetMapId:Ht},e)}var l;return function(u,m){return new Promise((w,B)=>{let S=new XMLHttpRequest;S.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(S.responseType="arraybuffer");for(let Q in u.headers)S.setRequestHeader(Q,u.headers[Q]);u.type==="json"&&(S.responseType="text",S.setRequestHeader("Accept","application/json")),S.withCredentials=u.credentials==="include",S.onerror=()=>{B(new Error(S.statusText))},S.onload=()=>{if(!m.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let Q=S.response;if(u.type==="json")try{Q=JSON.parse(S.response)}catch(M){return void B(M)}w({data:Q,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{let Q=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});B(new Ot(S.status,S.statusText,u.url,Q))}},m.signal.addEventListener("abort",()=>{S.abort(),B(j())}),S.send(u.body)})}(a,e)};function de(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;let e=new URL(a),l=window.location;return e.protocol===l.protocol&&e.host===l.host}function He(a,e,l){l[a]&&l[a].indexOf(e)!==-1||(l[a]=l[a]||[],l[a].push(e))}function Re(a,e,l){if(l&&l[a]){let u=l[a].indexOf(e);u!==-1&&l[a].splice(u,1)}}class je{constructor(e,l={}){Tt(this,l),this.type=e}}class Me extends je{constructor(e,l={}){super("error",Tt({error:e},l))}}class gi{on(e,l){return this._listeners=this._listeners||{},He(e,l,this._listeners),this}off(e,l){return Re(e,l,this._listeners),Re(e,l,this._oneTimeListeners),this}once(e,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},He(e,l,this._oneTimeListeners),this):new Promise(u=>this.once(e,u))}fire(e,l){typeof e=="string"&&(e=new je(e,l||{}));let u=e.type;if(this.listens(u)){e.target=this;let m=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(let S of m)S.call(this,e);let w=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(let S of w)Re(u,S,this._oneTimeListeners),S.call(this,e);let B=this._eventedParent;B&&(Tt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),B.fire(e))}else e instanceof Me&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,l){return this._eventedParent=e,this._eventedParentData=l,this}}var xt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let Rt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Li(a,e){let l={};for(let u in a)u!=="ref"&&(l[u]=a[u]);return Rt.forEach(u=>{u in e&&(l[u]=e[u])}),l}function Ue(a,e){if(Array.isArray(a)){if(!Array.isArray(e)||a.length!==e.length)return!1;for(let l=0;l<a.length;l++)if(!Ue(a[l],e[l]))return!1;return!0}if(typeof a=="object"&&a!==null&&e!==null){if(typeof e!="object"||Object.keys(a).length!==Object.keys(e).length)return!1;for(let l in a)if(!Ue(a[l],e[l]))return!1;return!0}return a===e}function Ee(a,e){a.push(e)}function Ne(a,e,l){Ee(l,{command:"addSource",args:[a,e[a]]})}function Je(a,e,l){Ee(e,{command:"removeSource",args:[a]}),l[a]=!0}function ze(a,e,l,u){Je(a,l,u),Ne(a,e,l)}function ui(a,e,l){let u;for(u in a[l])if(Object.prototype.hasOwnProperty.call(a[l],u)&&u!=="data"&&!Ue(a[l][u],e[l][u]))return!1;for(u in e[l])if(Object.prototype.hasOwnProperty.call(e[l],u)&&u!=="data"&&!Ue(a[l][u],e[l][u]))return!1;return!0}function hi(a,e,l,u,m,w){a=a||{},e=e||{};for(let B in a)Object.prototype.hasOwnProperty.call(a,B)&&(Ue(a[B],e[B])||l.push({command:w,args:[u,B,e[B],m]}));for(let B in e)Object.prototype.hasOwnProperty.call(e,B)&&!Object.prototype.hasOwnProperty.call(a,B)&&(Ue(a[B],e[B])||l.push({command:w,args:[u,B,e[B],m]}))}function Ei(a){return a.id}function Pi(a,e){return a[e.id]=e,a}class Ie{constructor(e,l,u,m){this.message=(e?`${e}: `:"")+u,m&&(this.identifier=m),l!=null&&l.__line__&&(this.line=l.__line__)}}function Oi(a,...e){for(let l of e)for(let u in l)a[u]=l[u];return a}class mi extends Error{constructor(e,l){super(l),this.message=l,this.key=e}}class Vi{constructor(e,l=[]){this.parent=e,this.bindings={};for(let[u,m]of l)this.bindings[u]=m}concat(e){return new Vi(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}let We={kind:"null"},Se={kind:"number"},$e={kind:"string"},di={kind:"boolean"},Zi={kind:"color"},qi={kind:"object"},vi={kind:"value"},tr={kind:"collator"},Lr={kind:"formatted"},ft={kind:"padding"},Y={kind:"resolvedImage"},q={kind:"variableAnchorOffsetCollection"};function rt(a,e){return{kind:"array",itemType:a,N:e}}function ht(a){if(a.kind==="array"){let e=ht(a.itemType);return typeof a.N=="number"?`array<${e}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${e}>`}return a.kind}let Zt=[We,Se,$e,di,Zi,Lr,qi,rt(vi),ft,Y,q];function zt(a,e){if(e.kind==="error")return null;if(a.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!zt(a.itemType,e.itemType))&&(typeof a.N!="number"||a.N===e.N))return null}else{if(a.kind===e.kind)return null;if(a.kind==="value"){for(let l of Zt)if(!zt(l,e))return null}}return`Expected ${ht(a)} but found ${ht(e)} instead.`}function Xt(a,e){return e.some(l=>l.kind===a.kind)}function Mt(a,e){return e.some(l=>l==="null"?a===null:l==="array"?Array.isArray(a):l==="object"?a&&!Array.isArray(a)&&typeof a=="object":l===typeof a)}function re(a,e){return a.kind==="array"&&e.kind==="array"?a.itemType.kind===e.itemType.kind&&typeof a.N=="number":a.kind===e.kind}let ce=.96422,pe=.82521,me=4/29,Xe=6/29,oi=3*Xe*Xe,ii=Xe*Xe*Xe,Ni=Math.PI/180,Qi=180/Math.PI;function rr(a){return(a%=360)<0&&(a+=360),a}function zi([a,e,l,u]){let m,w,B=ki((.2225045*(a=Cr(a))+.7168786*(e=Cr(e))+.0606169*(l=Cr(l)))/1);a===e&&e===l?m=w=B:(m=ki((.4360747*a+.3850649*e+.1430804*l)/ce),w=ki((.0139322*a+.0971045*e+.7141733*l)/pe));let S=116*B-16;return[S<0?0:S,500*(m-B),200*(B-w),u]}function Cr(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function ki(a){return a>ii?Math.pow(a,1/3):a/oi+me}function fr([a,e,l,u]){let m=(a+16)/116,w=isNaN(e)?m:m+e/500,B=isNaN(l)?m:m-l/200;return m=1*Tr(m),w=ce*Tr(w),B=pe*Tr(B),[br(3.1338561*w-1.6168667*m-.4906146*B),br(-.9787684*w+1.9161415*m+.033454*B),br(.0719453*w-.2289914*m+1.4052427*B),u]}function br(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Tr(a){return a>Xe?a*a*a:oi*(a-me)}function Dt(a){return parseInt(a.padEnd(2,a),16)/255}function Ke(a,e){return Te(e?a/100:a,0,1)}function Te(a,e,l){return Math.min(Math.max(e,a),l)}function or(a){return!a.some(Number.isNaN)}let Er={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ji{constructor(e,l,u,m=1,w=!0){this.r=e,this.g=l,this.b=u,this.a=m,w||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[e,l,u,m]))}static parse(e){if(e instanceof Ji)return e;if(typeof e!="string")return;let l=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];let m=Er[u];if(m){let[B,S,Q]=m;return[B/255,S/255,Q/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){let B=u.length<6?1:2,S=1;return[Dt(u.slice(S,S+=B)),Dt(u.slice(S,S+=B)),Dt(u.slice(S,S+=B)),Dt(u.slice(S,S+B)||"ff")]}if(u.startsWith("rgb")){let B=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(B){let[S,Q,M,D,z,et,nt,st,mt,St,Vt,oe]=B,Wt=[D||" ",nt||" ",St].join("");if(Wt==="  "||Wt==="  /"||Wt===",,"||Wt===",,,"){let $t=[M,et,mt].join(""),ve=$t==="%%%"?100:$t===""?255:0;if(ve){let Le=[Te(+Q/ve,0,1),Te(+z/ve,0,1),Te(+st/ve,0,1),Vt?Ke(+Vt,oe):1];if(or(Le))return Le}}return}}let w=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){let[B,S,Q,M,D,z,et,nt,st]=w,mt=[Q||" ",D||" ",et].join("");if(mt==="  "||mt==="  /"||mt===",,"||mt===",,,"){let St=[+S,Te(+M,0,100),Te(+z,0,100),nt?Ke(+nt,st):1];if(or(St))return function([Vt,oe,Wt,$t]){function ve(Le){let ni=(Le+Vt/30)%12,bi=oe*Math.min(Wt,1-Wt);return Wt-bi*Math.max(-1,Math.min(ni-3,9-ni,1))}return Vt=rr(Vt),oe/=100,Wt/=100,[ve(0),ve(8),ve(4),$t]}(St)}}}(e);return l?new Ji(...l,!1):void 0}get rgb(){let{r:e,g:l,b:u,a:m}=this,w=m||1/0;return this.overwriteGetter("rgb",[e/w,l/w,u/w,m])}get hcl(){return this.overwriteGetter("hcl",function(e){let[l,u,m,w]=zi(e),B=Math.sqrt(u*u+m*m);return[Math.round(1e4*B)?rr(Math.atan2(m,u)*Qi):NaN,B,l,w]}(this.rgb))}get lab(){return this.overwriteGetter("lab",zi(this.rgb))}overwriteGetter(e,l){return Object.defineProperty(this,e,{value:l}),l}toString(){let[e,l,u,m]=this.rgb;return`rgba(${[e,l,u].map(w=>Math.round(255*w)).join(",")},${m})`}}Ji.black=new Ji(0,0,0,1),Ji.white=new Ji(1,1,1,1),Ji.transparent=new Ji(0,0,0,0),Ji.red=new Ji(1,0,0,1);class Mr{constructor(e,l,u){this.sensitivity=e?l?"variant":"case":l?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,l){return this.collator.compare(e,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class vs{constructor(e,l,u,m,w){this.text=e,this.image=l,this.scale=u,this.fontStack=m,this.textColor=w}}class Sr{constructor(e){this.sections=e}static fromString(e){return new Sr([new vs(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Sr?e:Sr.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class xr{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof xr)return e;if(typeof e=="number")return new xr([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let l of e)if(typeof l!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new xr(e)}}toString(){return JSON.stringify(this.values)}}let Wo=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class an{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof an)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let l=0;l<e.length;l+=2){let u=e[l],m=e[l+1];if(typeof u!="string"||!Wo.has(u)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new an(e)}}toString(){return JSON.stringify(this.values)}}class Dn{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Dn({name:e,available:!1}):null}}function Oo(a,e,l,u){return typeof a=="number"&&a>=0&&a<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof l=="number"&&l>=0&&l<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,e,l,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,e,l,u]:[a,e,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function As(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Ji||a instanceof Mr||a instanceof Sr||a instanceof xr||a instanceof an||a instanceof Dn)return!0;if(Array.isArray(a)){for(let e of a)if(!As(e))return!1;return!0}if(typeof a=="object"){for(let e in a)if(!As(a[e]))return!1;return!0}return!1}function Qr(a){if(a===null)return We;if(typeof a=="string")return $e;if(typeof a=="boolean")return di;if(typeof a=="number")return Se;if(a instanceof Ji)return Zi;if(a instanceof Mr)return tr;if(a instanceof Sr)return Lr;if(a instanceof xr)return ft;if(a instanceof an)return q;if(a instanceof Dn)return Y;if(Array.isArray(a)){let e=a.length,l;for(let u of a){let m=Qr(u);if(l){if(l===m)continue;l=vi;break}l=m}return rt(l||vi,e)}return qi}function zo(a){let e=typeof a;return a===null?"":e==="string"||e==="number"||e==="boolean"?String(a):a instanceof Ji||a instanceof Sr||a instanceof xr||a instanceof an||a instanceof Dn?a.toString():JSON.stringify(a)}class Fr{constructor(e,l){this.type=e,this.value=l}static parse(e,l){if(e.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!As(e[1]))return l.error("invalid value");let u=e[1],m=Qr(u),w=l.expectedType;return m.kind!=="array"||m.N!==0||!w||w.kind!=="array"||typeof w.N=="number"&&w.N!==0||(m=w),new Fr(m,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Nr{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}let Gs={string:$e,number:Se,boolean:di,object:qi};class Kn{constructor(e,l){this.type=e,this.args=l}static parse(e,l){if(e.length<2)return l.error("Expected at least one argument.");let u,m=1,w=e[0];if(w==="array"){let S,Q;if(e.length>2){let M=e[1];if(typeof M!="string"||!(M in Gs)||M==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);S=Gs[M],m++}else S=vi;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return l.error('The length argument to "array" must be a positive integer literal',2);Q=e[2],m++}u=rt(S,Q)}else{if(!Gs[w])throw new Error(`Types doesn't contain name = ${w}`);u=Gs[w]}let B=[];for(;m<e.length;m++){let S=l.parse(e[m],m,vi);if(!S)return null;B.push(S)}return new Kn(u,B)}evaluate(e){for(let l=0;l<this.args.length;l++){let u=this.args[l].evaluate(e);if(!zt(this.type,Qr(u)))return u;if(l===this.args.length-1)throw new Nr(`Expected value to be of type ${ht(this.type)}, but found ${ht(Qr(u))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}let to={"to-boolean":di,"to-color":Zi,"to-number":Se,"to-string":$e};class pt{constructor(e,l){this.type=e,this.args=l}static parse(e,l){if(e.length<2)return l.error("Expected at least one argument.");let u=e[0];if(!to[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&e.length!==2)return l.error("Expected one argument.");let m=to[u],w=[];for(let B=1;B<e.length;B++){let S=l.parse(e[B],B,vi);if(!S)return null;w.push(S)}return new pt(m,w)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let l,u;for(let m of this.args){if(l=m.evaluate(e),u=null,l instanceof Ji)return l;if(typeof l=="string"){let w=e.parseColor(l);if(w)return w}else if(Array.isArray(l)&&(u=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Oo(l[0],l[1],l[2],l[3]),!u))return new Ji(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Nr(u||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(let u of this.args){l=u.evaluate(e);let m=xr.parse(l);if(m)return m}throw new Nr(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(let u of this.args){l=u.evaluate(e);let m=an.parse(l);if(m)return m}throw new Nr(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(let u of this.args){if(l=u.evaluate(e),l===null)return 0;let m=Number(l);if(!isNaN(m))return m}throw new Nr(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return Sr.fromString(zo(this.args[0].evaluate(e)));case"resolvedImage":return Dn.fromString(zo(this.args[0].evaluate(e)));default:return zo(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}let yt=["Unknown","Point","LineString","Polygon"];class ct{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?yt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let l=this._parseColorCache[e];return l||(l=this._parseColorCache[e]=Ji.parse(e)),l}}class Bt{constructor(e,l,u=[],m,w=new Vi,B=[]){this.registry=e,this.path=u,this.key=u.map(S=>`[${S}]`).join(""),this.scope=w,this.errors=B,this.expectedType=m,this._isConstant=l}parse(e,l,u,m,w={}){return l?this.concat(l,u,m)._parse(e,w):this._parse(e,w)}_parse(e,l){function u(m,w,B){return B==="assert"?new Kn(w,[m]):B==="coerce"?new pt(w,[m]):m}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let m=e[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let w=this.registry[m];if(w){let B=w.parse(e,this);if(!B)return null;if(this.expectedType){let S=this.expectedType,Q=B.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||Q.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||Q.kind!=="value"&&Q.kind!=="string")if(S.kind!=="padding"||Q.kind!=="value"&&Q.kind!=="number"&&Q.kind!=="array")if(S.kind!=="variableAnchorOffsetCollection"||Q.kind!=="value"&&Q.kind!=="array"){if(this.checkSubtype(S,Q))return null}else B=u(B,S,l.typeAnnotation||"coerce");else B=u(B,S,l.typeAnnotation||"coerce");else B=u(B,S,l.typeAnnotation||"coerce");else B=u(B,S,l.typeAnnotation||"assert")}if(!(B instanceof Fr)&&B.type.kind!=="resolvedImage"&&this._isConstant(B)){let S=new ct;try{B=new Fr(B.type,B.evaluate(S))}catch(Q){return this.error(Q.message),null}}return B}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,l,u){let m=typeof e=="number"?this.path.concat(e):this.path,w=u?this.scope.concat(u):this.scope;return new Bt(this.registry,this._isConstant,m,l||null,w,this.errors)}error(e,...l){let u=`${this.key}${l.map(m=>`[${m}]`).join("")}`;this.errors.push(new mi(u,e))}checkSubtype(e,l){let u=zt(e,l);return u&&this.error(u),u}}class Kt{constructor(e,l,u){this.type=tr,this.locale=u,this.caseSensitive=e,this.diacriticSensitive=l}static parse(e,l){if(e.length!==2)return l.error("Expected one argument.");let u=e[1];if(typeof u!="object"||Array.isArray(u))return l.error("Collator options argument must be an object.");let m=l.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,di);if(!m)return null;let w=l.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,di);if(!w)return null;let B=null;return u.locale&&(B=l.parse(u.locale,1,$e),!B)?null:new Kt(m,w,B)}evaluate(e){return new Mr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}let Yt=8192;function ae(a,e){a[0]=Math.min(a[0],e[0]),a[1]=Math.min(a[1],e[1]),a[2]=Math.max(a[2],e[0]),a[3]=Math.max(a[3],e[1])}function Be(a,e){return!(a[0]<=e[0]||a[2]>=e[2]||a[1]<=e[1]||a[3]>=e[3])}function _e(a,e){let l=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,m=Math.pow(2,e.z);return[Math.round(l*m*Yt),Math.round(u*m*Yt)]}function Ce(a,e,l){let u=a[0]-e[0],m=a[1]-e[1],w=a[0]-l[0],B=a[1]-l[1];return u*B-w*m==0&&u*w<=0&&m*B<=0}function se(a,e){let l=!1;for(let B=0,S=e.length;B<S;B++){let Q=e[B];for(let M=0,D=Q.length;M<D-1;M++){if(Ce(a,Q[M],Q[M+1]))return!1;(m=Q[M])[1]>(u=a)[1]!=(w=Q[M+1])[1]>u[1]&&u[0]<(w[0]-m[0])*(u[1]-m[1])/(w[1]-m[1])+m[0]&&(l=!l)}}var u,m,w;return l}function ye(a,e){for(let l=0;l<e.length;l++)if(se(a,e[l]))return!0;return!1}function be(a,e,l,u){let m=u[0]-l[0],w=u[1]-l[1],B=(a[0]-l[0])*w-m*(a[1]-l[1]),S=(e[0]-l[0])*w-m*(e[1]-l[1]);return B>0&&S<0||B<0&&S>0}function Ge(a,e,l){for(let M of l)for(let D=0;D<M.length-1;++D)if((S=[(B=M[D+1])[0]-(w=M[D])[0],B[1]-w[1]])[0]*(Q=[(m=e)[0]-(u=a)[0],m[1]-u[1]])[1]-S[1]*Q[0]!=0&&be(u,m,w,B)&&be(w,B,u,m))return!0;var u,m,w,B,S,Q;return!1}function Ui(a,e){for(let l=0;l<a.length;++l)if(!se(a[l],e))return!1;for(let l=0;l<a.length-1;++l)if(Ge(a[l],a[l+1],e))return!1;return!0}function Ri(a,e){for(let l=0;l<e.length;l++)if(Ui(a,e[l]))return!0;return!1}function Pe(a,e,l){let u=[];for(let m=0;m<a.length;m++){let w=[];for(let B=0;B<a[m].length;B++){let S=_e(a[m][B],l);ae(e,S),w.push(S)}u.push(w)}return u}function Qe(a,e,l){let u=[];for(let m=0;m<a.length;m++){let w=Pe(a[m],e,l);u.push(w)}return u}function Ai(a,e,l,u){if(a[0]<l[0]||a[0]>l[2]){let m=.5*u,w=a[0]-l[0]>m?-u:l[0]-a[0]>m?u:0;w===0&&(w=a[0]-l[2]>m?-u:l[2]-a[0]>m?u:0),a[0]+=w}ae(e,a)}function Fi(a,e,l,u){let m=Math.pow(2,u.z)*Yt,w=[u.x*Yt,u.y*Yt],B=[];for(let S of a)for(let Q of S){let M=[Q.x+w[0],Q.y+w[1]];Ai(M,e,l,m),B.push(M)}return B}function Wi(a,e,l,u){let m=Math.pow(2,u.z)*Yt,w=[u.x*Yt,u.y*Yt],B=[];for(let Q of a){let M=[];for(let D of Q){let z=[D.x+w[0],D.y+w[1]];ae(e,z),M.push(z)}B.push(M)}if(e[2]-e[0]<=m/2){(S=e)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(let Q of B)for(let M of Q)Ai(M,e,l,m)}var S;return B}class nr{constructor(e,l){this.type=di,this.geojson=e,this.geometries=l}static parse(e,l){if(e.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(As(e[1])){let u=e[1];if(u.type==="FeatureCollection"){let m=[];for(let w of u.features){let{type:B,coordinates:S}=w.geometry;B==="Polygon"&&m.push(S),B==="MultiPolygon"&&m.push(...S)}if(m.length)return new nr(u,{type:"MultiPolygon",coordinates:m})}else if(u.type==="Feature"){let m=u.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new nr(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new nr(u,u)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(l,u){let m=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],B=l.canonicalID();if(u.type==="Polygon"){let S=Pe(u.coordinates,w,B),Q=Fi(l.geometry(),m,w,B);if(!Be(m,w))return!1;for(let M of Q)if(!se(M,S))return!1}if(u.type==="MultiPolygon"){let S=Qe(u.coordinates,w,B),Q=Fi(l.geometry(),m,w,B);if(!Be(m,w))return!1;for(let M of Q)if(!ye(M,S))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(l,u){let m=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],B=l.canonicalID();if(u.type==="Polygon"){let S=Pe(u.coordinates,w,B),Q=Wi(l.geometry(),m,w,B);if(!Be(m,w))return!1;for(let M of Q)if(!Ui(M,S))return!1}if(u.type==="MultiPolygon"){let S=Qe(u.coordinates,w,B),Q=Wi(l.geometry(),m,w,B);if(!Be(m,w))return!1;for(let M of Q)if(!Ri(M,S))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class ai{constructor(e,l){this.type=l.type,this.name=e,this.boundExpression=l}static parse(e,l){if(e.length!==2||typeof e[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");let u=e[1];return l.scope.has(u)?new ai(u,l.scope.get(u)):l.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class dr{constructor(e,l,u,m){this.name=e,this.type=l,this._evaluate=u,this.args=m}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,l){let u=e[0],m=dr.definitions[u];if(!m)return l.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);let w=Array.isArray(m)?m[0]:m.type,B=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,S=B.filter(([M])=>!Array.isArray(M)||M.length===e.length-1),Q=null;for(let[M,D]of S){Q=new Bt(l.registry,Or,l.path,null,l.scope);let z=[],et=!1;for(let nt=1;nt<e.length;nt++){let st=e[nt],mt=Array.isArray(M)?M[nt-1]:M.type,St=Q.parse(st,1+z.length,mt);if(!St){et=!0;break}z.push(St)}if(!et)if(Array.isArray(M)&&M.length!==z.length)Q.error(`Expected ${M.length} arguments, but found ${z.length} instead.`);else{for(let nt=0;nt<z.length;nt++){let st=Array.isArray(M)?M[nt]:M.type,mt=z[nt];Q.concat(nt+1).checkSubtype(st,mt.type)}if(Q.errors.length===0)return new dr(u,w,D,z)}}if(S.length===1)l.errors.push(...Q.errors);else{let M=(S.length?S:B).map(([z])=>{return et=z,Array.isArray(et)?`(${et.map(ht).join(", ")})`:`(${ht(et.type)}...)`;var et}).join(" | "),D=[];for(let z=1;z<e.length;z++){let et=l.parse(e[z],1+D.length);if(!et)return null;D.push(ht(et.type))}l.error(`Expected arguments of type ${M}, but found (${D.join(", ")}) instead.`)}return null}static register(e,l){dr.definitions=l;for(let u in l)e[u]=dr}}function Or(a){if(a instanceof ai)return Or(a.boundExpression);if(a instanceof dr&&a.name==="error"||a instanceof Kt||a instanceof nr)return!1;let e=a instanceof pt||a instanceof Kn,l=!0;return a.eachChild(u=>{l=e?l&&Or(u):l&&u instanceof Fr}),!!l&&Ur(a)&&vn(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ur(a){if(a instanceof dr&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof nr)return!1;let e=!0;return a.eachChild(l=>{e&&!Ur(l)&&(e=!1)}),e}function _n(a){if(a instanceof dr&&a.name==="feature-state")return!1;let e=!0;return a.eachChild(l=>{e&&!_n(l)&&(e=!1)}),e}function vn(a,e){if(a instanceof dr&&e.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(u=>{l&&!vn(u,e)&&(l=!1)}),l}function ws(a,e){let l=a.length-1,u,m,w=0,B=l,S=0;for(;w<=B;)if(S=Math.floor((w+B)/2),u=a[S],m=a[S+1],u<=e){if(S===l||e<m)return S;w=S+1}else{if(!(u>e))throw new Nr("Input is not a number.");B=S-1}return 0}class _o{constructor(e,l,u){this.type=e,this.input=l,this.labels=[],this.outputs=[];for(let[m,w]of u)this.labels.push(m),this.outputs.push(w)}static parse(e,l){if(e.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return l.error("Expected an even number of arguments.");let u=l.parse(e[1],1,Se);if(!u)return null;let m=[],w=null;l.expectedType&&l.expectedType.kind!=="value"&&(w=l.expectedType);for(let B=1;B<e.length;B+=2){let S=B===1?-1/0:e[B],Q=e[B+1],M=B,D=B+1;if(typeof S!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(m.length&&m[m.length-1][0]>=S)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);let z=l.parse(Q,D,w);if(!z)return null;w=w||z.type,m.push([S,z])}return new _o(w,u,m)}evaluate(e){let l=this.labels,u=this.outputs;if(l.length===1)return u[0].evaluate(e);let m=this.input.evaluate(e);if(m<=l[0])return u[0].evaluate(e);let w=l.length;return m>=l[w-1]?u[w-1].evaluate(e):u[ws(l,m)].evaluate(e)}eachChild(e){e(this.input);for(let l of this.outputs)e(l)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Ic(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var yc=El;function El(a,e,l,u){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(u-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=e,this.p2x=l,this.p2y=u}El.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,e){if(e===void 0&&(e=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,u=0;u<8;u++){var m=this.sampleCurveX(l)-a;if(Math.abs(m)<e)return l;var w=this.sampleCurveDerivativeX(l);if(Math.abs(w)<1e-6)break;l-=m/w}var B=0,S=1;for(l=a,u=0;u<20&&(m=this.sampleCurveX(l),!(Math.abs(m-a)<e));u++)a>m?B=l:S=l,l=.5*(S-B)+B;return l},solve:function(a,e){return this.sampleCurveY(this.solveCurveX(a,e))}};var el=Ic(yc);function Bs(a,e,l){return a+l*(e-a)}function eo(a,e,l){return a.map((u,m)=>Bs(u,e[m],l))}let qn={number:Bs,color:function(a,e,l,u="rgb"){switch(u){case"rgb":{let[m,w,B,S]=eo(a.rgb,e.rgb,l);return new Ji(m,w,B,S,!1)}case"hcl":{let[m,w,B,S]=a.hcl,[Q,M,D,z]=e.hcl,et,nt;if(isNaN(m)||isNaN(Q))isNaN(m)?isNaN(Q)?et=NaN:(et=Q,B!==1&&B!==0||(nt=M)):(et=m,D!==1&&D!==0||(nt=w));else{let oe=Q-m;Q>m&&oe>180?oe-=360:Q<m&&m-Q>180&&(oe+=360),et=m+l*oe}let[st,mt,St,Vt]=function([oe,Wt,$t,ve]){return oe=isNaN(oe)?0:oe*Ni,fr([$t,Math.cos(oe)*Wt,Math.sin(oe)*Wt,ve])}([et,nt??Bs(w,M,l),Bs(B,D,l),Bs(S,z,l)]);return new Ji(st,mt,St,Vt,!1)}case"lab":{let[m,w,B,S]=fr(eo(a.lab,e.lab,l));return new Ji(m,w,B,S,!1)}}},array:eo,padding:function(a,e,l){return new xr(eo(a.values,e.values,l))},variableAnchorOffsetCollection:function(a,e,l){let u=a.values,m=e.values;if(u.length!==m.length)throw new Nr(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${e.toString()}`);let w=[];for(let B=0;B<u.length;B+=2){if(u[B]!==m[B])throw new Nr(`Cannot interpolate values containing mismatched anchors. from[${B}]: ${u[B]}, to[${B}]: ${m[B]}`);w.push(u[B]);let[S,Q]=u[B+1],[M,D]=m[B+1];w.push([Bs(S,M,l),Bs(Q,D,l)])}return new an(w)}};class cn{constructor(e,l,u,m,w){this.type=e,this.operator=l,this.interpolation=u,this.input=m,this.labels=[],this.outputs=[];for(let[B,S]of w)this.labels.push(B),this.outputs.push(S)}static interpolationFactor(e,l,u,m){let w=0;if(e.name==="exponential")w=xo(l,e.base,u,m);else if(e.name==="linear")w=xo(l,1,u,m);else if(e.name==="cubic-bezier"){let B=e.controlPoints;w=new el(B[0],B[1],B[2],B[3]).solve(xo(l,1,u,m))}return w}static parse(e,l){let[u,m,w,...B]=e;if(!Array.isArray(m)||m.length===0)return l.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){let M=m[1];if(typeof M!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:M}}else{if(m[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(m[0])}`,1,0);{let M=m.slice(1);if(M.length!==4||M.some(D=>typeof D!="number"||D<0||D>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:M}}}if(e.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(w=l.parse(w,2,Se),!w)return null;let S=[],Q=null;u==="interpolate-hcl"||u==="interpolate-lab"?Q=Zi:l.expectedType&&l.expectedType.kind!=="value"&&(Q=l.expectedType);for(let M=0;M<B.length;M+=2){let D=B[M],z=B[M+1],et=M+3,nt=M+4;if(typeof D!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',et);if(S.length&&S[S.length-1][0]>=D)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',et);let st=l.parse(z,nt,Q);if(!st)return null;Q=Q||st.type,S.push([D,st])}return re(Q,Se)||re(Q,Zi)||re(Q,ft)||re(Q,q)||re(Q,rt(Se))?new cn(Q,u,m,w,S):l.error(`Type ${ht(Q)} is not interpolatable.`)}evaluate(e){let l=this.labels,u=this.outputs;if(l.length===1)return u[0].evaluate(e);let m=this.input.evaluate(e);if(m<=l[0])return u[0].evaluate(e);let w=l.length;if(m>=l[w-1])return u[w-1].evaluate(e);let B=ws(l,m),S=cn.interpolationFactor(this.interpolation,m,l[B],l[B+1]),Q=u[B].evaluate(e),M=u[B+1].evaluate(e);switch(this.operator){case"interpolate":return qn[this.type.kind](Q,M,S);case"interpolate-hcl":return qn.color(Q,M,S,"hcl");case"interpolate-lab":return qn.color(Q,M,S,"lab")}}eachChild(e){e(this.input);for(let l of this.outputs)e(l)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function xo(a,e,l,u){let m=u-l,w=a-l;return m===0?0:e===1?w/m:(Math.pow(e,w)-1)/(Math.pow(e,m)-1)}class lr{constructor(e,l){this.type=e,this.args=l}static parse(e,l){if(e.length<2)return l.error("Expectected at least one argument.");let u=null,m=l.expectedType;m&&m.kind!=="value"&&(u=m);let w=[];for(let S of e.slice(1)){let Q=l.parse(S,1+w.length,u,void 0,{typeAnnotation:"omit"});if(!Q)return null;u=u||Q.type,w.push(Q)}if(!u)throw new Error("No output type");let B=m&&w.some(S=>zt(m,S.type));return new lr(B?vi:u,w)}evaluate(e){let l,u=null,m=0;for(let w of this.args)if(m++,u=w.evaluate(e),u&&u instanceof Dn&&!u.available&&(l||(l=u.name),u=null,m===this.args.length&&(u=l)),u!==null)break;return u}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class Sa{constructor(e,l){this.type=l.type,this.bindings=[].concat(e),this.result=l}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let l of this.bindings)e(l[1]);e(this.result)}static parse(e,l){if(e.length<4)return l.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);let u=[];for(let w=1;w<e.length-1;w+=2){let B=e[w];if(typeof B!="string")return l.error(`Expected string, but found ${typeof B} instead.`,w);if(/[^a-zA-Z0-9_]/.test(B))return l.error("Variable names must contain only alphanumeric characters or '_'.",w);let S=l.parse(e[w+1],w+1);if(!S)return null;u.push([B,S])}let m=l.parse(e[e.length-1],e.length-1,l.expectedType,u);return m?new Sa(u,m):null}outputDefined(){return this.result.outputDefined()}}class pA{constructor(e,l,u){this.type=e,this.index=l,this.input=u}static parse(e,l){if(e.length!==3)return l.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let u=l.parse(e[1],1,Se),m=l.parse(e[2],2,rt(l.expectedType||vi));return u&&m?new pA(m.type.itemType,u,m):null}evaluate(e){let l=this.index.evaluate(e),u=this.input.evaluate(e);if(l<0)throw new Nr(`Array index out of bounds: ${l} < 0.`);if(l>=u.length)throw new Nr(`Array index out of bounds: ${l} > ${u.length-1}.`);if(l!==Math.floor(l))throw new Nr(`Array index must be an integer, but found ${l} instead.`);return u[l]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class fA{constructor(e,l){this.type=di,this.needle=e,this.haystack=l}static parse(e,l){if(e.length!==3)return l.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let u=l.parse(e[1],1,vi),m=l.parse(e[2],2,vi);return u&&m?Xt(u.type,[di,$e,Se,We,vi])?new fA(u,m):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ht(u.type)} instead`):null}evaluate(e){let l=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!u)return!1;if(!Mt(l,["boolean","string","number","null"]))throw new Nr(`Expected first argument to be of type boolean, string, number or null, but found ${ht(Qr(l))} instead.`);if(!Mt(u,["string","array"]))throw new Nr(`Expected second argument to be of type array or string, but found ${ht(Qr(u))} instead.`);return u.indexOf(l)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Fa{constructor(e,l,u){this.type=Se,this.needle=e,this.haystack=l,this.fromIndex=u}static parse(e,l){if(e.length<=2||e.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let u=l.parse(e[1],1,vi),m=l.parse(e[2],2,vi);if(!u||!m)return null;if(!Xt(u.type,[di,$e,Se,We,vi]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ht(u.type)} instead`);if(e.length===4){let w=l.parse(e[3],3,Se);return w?new Fa(u,m,w):null}return new Fa(u,m)}evaluate(e){let l=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!Mt(l,["boolean","string","number","null"]))throw new Nr(`Expected first argument to be of type boolean, string, number or null, but found ${ht(Qr(l))} instead.`);if(!Mt(u,["string","array"]))throw new Nr(`Expected second argument to be of type array or string, but found ${ht(Qr(u))} instead.`);if(this.fromIndex){let m=this.fromIndex.evaluate(e);return u.indexOf(l,m)}return u.indexOf(l)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class io{constructor(e,l,u,m,w,B){this.inputType=e,this.type=l,this.input=u,this.cases=m,this.outputs=w,this.otherwise=B}static parse(e,l){if(e.length<5)return l.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return l.error("Expected an even number of arguments.");let u,m;l.expectedType&&l.expectedType.kind!=="value"&&(m=l.expectedType);let w={},B=[];for(let M=2;M<e.length-1;M+=2){let D=e[M],z=e[M+1];Array.isArray(D)||(D=[D]);let et=l.concat(M);if(D.length===0)return et.error("Expected at least one branch label.");for(let st of D){if(typeof st!="number"&&typeof st!="string")return et.error("Branch labels must be numbers or strings.");if(typeof st=="number"&&Math.abs(st)>Number.MAX_SAFE_INTEGER)return et.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof st=="number"&&Math.floor(st)!==st)return et.error("Numeric branch labels must be integer values.");if(u){if(et.checkSubtype(u,Qr(st)))return null}else u=Qr(st);if(w[String(st)]!==void 0)return et.error("Branch labels must be unique.");w[String(st)]=B.length}let nt=l.parse(z,M,m);if(!nt)return null;m=m||nt.type,B.push(nt)}let S=l.parse(e[1],1,vi);if(!S)return null;let Q=l.parse(e[e.length-1],e.length-1,m);return Q?S.type.kind!=="value"&&l.concat(1).checkSubtype(u,S.type)?null:new io(u,m,S,w,B,Q):null}evaluate(e){let l=this.input.evaluate(e);return(Qr(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class So{constructor(e,l,u){this.type=e,this.branches=l,this.otherwise=u}static parse(e,l){if(e.length<4)return l.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return l.error("Expected an odd number of arguments.");let u;l.expectedType&&l.expectedType.kind!=="value"&&(u=l.expectedType);let m=[];for(let B=1;B<e.length-1;B+=2){let S=l.parse(e[B],B,di);if(!S)return null;let Q=l.parse(e[B+1],B+1,u);if(!Q)return null;m.push([S,Q]),u=u||Q.type}let w=l.parse(e[e.length-1],e.length-1,u);if(!w)return null;if(!u)throw new Error("Can't infer output type");return new So(u,m,w)}evaluate(e){for(let[l,u]of this.branches)if(l.evaluate(e))return u.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[l,u]of this.branches)e(l),e(u);e(this.otherwise)}outputDefined(){return this.branches.every(([e,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class mA{constructor(e,l,u,m){this.type=e,this.input=l,this.beginIndex=u,this.endIndex=m}static parse(e,l){if(e.length<=2||e.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let u=l.parse(e[1],1,vi),m=l.parse(e[2],2,Se);if(!u||!m)return null;if(!Xt(u.type,[rt(vi),$e,vi]))return l.error(`Expected first argument to be of type array or string, but found ${ht(u.type)} instead`);if(e.length===4){let w=l.parse(e[3],3,Se);return w?new mA(u.type,u,m,w):null}return new mA(u.type,u,m)}evaluate(e){let l=this.input.evaluate(e),u=this.beginIndex.evaluate(e);if(!Mt(l,["string","array"]))throw new Nr(`Expected first argument to be of type array or string, but found ${ht(Qr(l))} instead.`);if(this.endIndex){let m=this.endIndex.evaluate(e);return l.slice(u,m)}return l.slice(u)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Jo(a,e){return a==="=="||a==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Rs(a,e,l,u){return u.compare(e,l)===0}function Fo(a,e,l){let u=a!=="=="&&a!=="!=";return class Ab{constructor(w,B,S){this.type=di,this.lhs=w,this.rhs=B,this.collator=S,this.hasUntypedArgument=w.type.kind==="value"||B.type.kind==="value"}static parse(w,B){if(w.length!==3&&w.length!==4)return B.error("Expected two or three arguments.");let S=w[0],Q=B.parse(w[1],1,vi);if(!Q)return null;if(!Jo(S,Q.type))return B.concat(1).error(`"${S}" comparisons are not supported for type '${ht(Q.type)}'.`);let M=B.parse(w[2],2,vi);if(!M)return null;if(!Jo(S,M.type))return B.concat(2).error(`"${S}" comparisons are not supported for type '${ht(M.type)}'.`);if(Q.type.kind!==M.type.kind&&Q.type.kind!=="value"&&M.type.kind!=="value")return B.error(`Cannot compare types '${ht(Q.type)}' and '${ht(M.type)}'.`);u&&(Q.type.kind==="value"&&M.type.kind!=="value"?Q=new Kn(M.type,[Q]):Q.type.kind!=="value"&&M.type.kind==="value"&&(M=new Kn(Q.type,[M])));let D=null;if(w.length===4){if(Q.type.kind!=="string"&&M.type.kind!=="string"&&Q.type.kind!=="value"&&M.type.kind!=="value")return B.error("Cannot use collator to compare non-string types.");if(D=B.parse(w[3],3,tr),!D)return null}return new Ab(Q,M,D)}evaluate(w){let B=this.lhs.evaluate(w),S=this.rhs.evaluate(w);if(u&&this.hasUntypedArgument){let Q=Qr(B),M=Qr(S);if(Q.kind!==M.kind||Q.kind!=="string"&&Q.kind!=="number")throw new Nr(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${Q.kind}, ${M.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){let Q=Qr(B),M=Qr(S);if(Q.kind!=="string"||M.kind!=="string")return e(w,B,S)}return this.collator?l(w,B,S,this.collator.evaluate(w)):e(w,B,S)}eachChild(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)}outputDefined(){return!0}}}let ka=Fo("==",function(a,e,l){return e===l},Rs),bc=Fo("!=",function(a,e,l){return e!==l},function(a,e,l,u){return!Rs(0,e,l,u)}),CA=Fo("<",function(a,e,l){return e<l},function(a,e,l,u){return u.compare(e,l)<0}),vc=Fo(">",function(a,e,l){return e>l},function(a,e,l,u){return u.compare(e,l)>0}),il=Fo("<=",function(a,e,l){return e<=l},function(a,e,l,u){return u.compare(e,l)<=0}),rl=Fo(">=",function(a,e,l){return e>=l},function(a,e,l,u){return u.compare(e,l)>=0});class IA{constructor(e,l,u,m,w){this.type=$e,this.number=e,this.locale=l,this.currency=u,this.minFractionDigits=m,this.maxFractionDigits=w}static parse(e,l){if(e.length!==3)return l.error("Expected two arguments.");let u=l.parse(e[1],1,Se);if(!u)return null;let m=e[2];if(typeof m!="object"||Array.isArray(m))return l.error("NumberFormat options argument must be an object.");let w=null;if(m.locale&&(w=l.parse(m.locale,1,$e),!w))return null;let B=null;if(m.currency&&(B=l.parse(m.currency,1,$e),!B))return null;let S=null;if(m["min-fraction-digits"]&&(S=l.parse(m["min-fraction-digits"],1,Se),!S))return null;let Q=null;return m["max-fraction-digits"]&&(Q=l.parse(m["max-fraction-digits"],1,Se),!Q)?null:new IA(u,w,B,S,Q)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Xo{constructor(e){this.type=Lr,this.sections=e}static parse(e,l){if(e.length<2)return l.error("Expected at least one argument.");let u=e[1];if(!Array.isArray(u)&&typeof u=="object")return l.error("First argument must be an image or text section.");let m=[],w=!1;for(let B=1;B<=e.length-1;++B){let S=e[B];if(w&&typeof S=="object"&&!Array.isArray(S)){w=!1;let Q=null;if(S["font-scale"]&&(Q=l.parse(S["font-scale"],1,Se),!Q))return null;let M=null;if(S["text-font"]&&(M=l.parse(S["text-font"],1,rt($e)),!M))return null;let D=null;if(S["text-color"]&&(D=l.parse(S["text-color"],1,Zi),!D))return null;let z=m[m.length-1];z.scale=Q,z.font=M,z.textColor=D}else{let Q=l.parse(e[B],1,vi);if(!Q)return null;let M=Q.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,m.push({content:Q,scale:null,font:null,textColor:null})}}return new Xo(m)}evaluate(e){return new Sr(this.sections.map(l=>{let u=l.content.evaluate(e);return Qr(u)===Y?new vs("",u,null,null,null):new vs(zo(u),null,l.scale?l.scale.evaluate(e):null,l.font?l.font.evaluate(e).join(","):null,l.textColor?l.textColor.evaluate(e):null)}))}eachChild(e){for(let l of this.sections)e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}outputDefined(){return!1}}class La{constructor(e){this.type=Y,this.input=e}static parse(e,l){if(e.length!==2)return l.error("Expected two arguments.");let u=l.parse(e[1],1,$e);return u?new La(u):l.error("No image name provided.")}evaluate(e){let l=this.input.evaluate(e),u=Dn.fromString(l);return u&&e.availableImages&&(u.available=e.availableImages.indexOf(l)>-1),u}eachChild(e){e(this.input)}outputDefined(){return!1}}class Ea{constructor(e){this.type=Se,this.input=e}static parse(e,l){if(e.length!==2)return l.error(`Expected 1 argument, but found ${e.length-1} instead.`);let u=l.parse(e[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${ht(u.type)} instead.`):new Ea(u):null}evaluate(e){let l=this.input.evaluate(e);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Nr(`Expected value to be of type string or array, but found ${ht(Qr(l))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}let Yo={"==":ka,"!=":bc,">":vc,"<":CA,">=":rl,"<=":il,array:Kn,at:pA,boolean:Kn,case:So,coalesce:lr,collator:Kt,format:Xo,image:La,in:fA,"index-of":Fa,interpolate:cn,"interpolate-hcl":cn,"interpolate-lab":cn,length:Ea,let:Sa,literal:Fr,match:io,number:Kn,"number-format":IA,object:Kn,slice:mA,step:_o,string:Kn,"to-boolean":pt,"to-color":pt,"to-number":pt,"to-string":pt,var:ai,within:nr};function Tl(a,[e,l,u,m]){e=e.evaluate(a),l=l.evaluate(a),u=u.evaluate(a);let w=m?m.evaluate(a):1,B=Oo(e,l,u,w);if(B)throw new Nr(B);return new Ji(e/255,l/255,u/255,w,!1)}function Ta(a,e){return a in e}function jo(a,e){let l=e[a];return l===void 0?null:l}function ro(a){return{type:a}}function qo(a){return{result:"success",value:a}}function ko(a){return{result:"error",value:a}}function U(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function it(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Et(a){return!!a.expression&&a.expression.interpolated}function Nt(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function ue(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function we(a){return a}function Ve(a,e){let l=e.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",m=u||!(u||a.property!==void 0),w=a.type||(Et(e)?"exponential":"interval");if(l||e.type==="padding"){let D=l?Ji.parse:xr.parse;(a=Oi({},a)).stops&&(a.stops=a.stops.map(z=>[z[0],D(z[1])])),a.default=D(a.default?a.default:e.default)}if(a.colorSpace&&(B=a.colorSpace)!=="rgb"&&B!=="hcl"&&B!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var B;let S,Q,M;if(w==="exponential")S=ar;else if(w==="interval")S=xi;else if(w==="categorical"){S=Di,Q=Object.create(null);for(let D of a.stops)Q[D[0]]=D[1];M=typeof a.stops[0][0]}else{if(w!=="identity")throw new Error(`Unknown function type "${w}"`);S=Ci}if(u){let D={},z=[];for(let st=0;st<a.stops.length;st++){let mt=a.stops[st],St=mt[0].zoom;D[St]===void 0&&(D[St]={zoom:St,type:a.type,property:a.property,default:a.default,stops:[]},z.push(St)),D[St].stops.push([mt[0].value,mt[1]])}let et=[];for(let st of z)et.push([D[st].zoom,Ve(D[st],e)]);let nt={name:"linear"};return{kind:"composite",interpolationType:nt,interpolationFactor:cn.interpolationFactor.bind(void 0,nt),zoomStops:et.map(st=>st[0]),evaluate:({zoom:st},mt)=>ar({stops:et,base:a.base},e,st).evaluate(st,mt)}}if(m){let D=w==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:cn.interpolationFactor.bind(void 0,D),zoomStops:a.stops.map(z=>z[0]),evaluate:({zoom:z})=>S(a,e,z,Q,M)}}return{kind:"source",evaluate(D,z){let et=z&&z.properties?z.properties[a.property]:void 0;return et===void 0?li(a.default,e.default):S(a,e,et,Q,M)}}}function li(a,e,l){return a!==void 0?a:e!==void 0?e:l!==void 0?l:void 0}function Di(a,e,l,u,m){return li(typeof l===m?u[l]:void 0,a.default,e.default)}function xi(a,e,l){if(Nt(l)!=="number")return li(a.default,e.default);let u=a.stops.length;if(u===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[u-1][0])return a.stops[u-1][1];let m=ws(a.stops.map(w=>w[0]),l);return a.stops[m][1]}function ar(a,e,l){let u=a.base!==void 0?a.base:1;if(Nt(l)!=="number")return li(a.default,e.default);let m=a.stops.length;if(m===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[m-1][0])return a.stops[m-1][1];let w=ws(a.stops.map(D=>D[0]),l),B=function(D,z,et,nt){let st=nt-et,mt=D-et;return st===0?0:z===1?mt/st:(Math.pow(z,mt)-1)/(Math.pow(z,st)-1)}(l,u,a.stops[w][0],a.stops[w+1][0]),S=a.stops[w][1],Q=a.stops[w+1][1],M=qn[e.type]||we;return typeof S.evaluate=="function"?{evaluate(...D){let z=S.evaluate.apply(void 0,D),et=Q.evaluate.apply(void 0,D);if(z!==void 0&&et!==void 0)return M(z,et,B,a.colorSpace)}}:M(S,Q,B,a.colorSpace)}function Ci(a,e,l){switch(e.type){case"color":l=Ji.parse(l);break;case"formatted":l=Sr.fromString(l.toString());break;case"resolvedImage":l=Dn.fromString(l.toString());break;case"padding":l=xr.parse(l);break;default:Nt(l)===e.type||e.type==="enum"&&e.values[l]||(l=void 0)}return li(l,a.default,e.default)}dr.register(Yo,{error:[{kind:"error"},[$e],(a,[e])=>{throw new Nr(e.evaluate(a))}],typeof:[$e,[vi],(a,[e])=>ht(Qr(e.evaluate(a)))],"to-rgba":[rt(Se,4),[Zi],(a,[e])=>{let[l,u,m,w]=e.evaluate(a).rgb;return[255*l,255*u,255*m,w]}],rgb:[Zi,[Se,Se,Se],Tl],rgba:[Zi,[Se,Se,Se,Se],Tl],has:{type:di,overloads:[[[$e],(a,[e])=>Ta(e.evaluate(a),a.properties())],[[$e,qi],(a,[e,l])=>Ta(e.evaluate(a),l.evaluate(a))]]},get:{type:vi,overloads:[[[$e],(a,[e])=>jo(e.evaluate(a),a.properties())],[[$e,qi],(a,[e,l])=>jo(e.evaluate(a),l.evaluate(a))]]},"feature-state":[vi,[$e],(a,[e])=>jo(e.evaluate(a),a.featureState||{})],properties:[qi,[],a=>a.properties()],"geometry-type":[$e,[],a=>a.geometryType()],id:[vi,[],a=>a.id()],zoom:[Se,[],a=>a.globals.zoom],"heatmap-density":[Se,[],a=>a.globals.heatmapDensity||0],"line-progress":[Se,[],a=>a.globals.lineProgress||0],accumulated:[vi,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Se,ro(Se),(a,e)=>{let l=0;for(let u of e)l+=u.evaluate(a);return l}],"*":[Se,ro(Se),(a,e)=>{let l=1;for(let u of e)l*=u.evaluate(a);return l}],"-":{type:Se,overloads:[[[Se,Se],(a,[e,l])=>e.evaluate(a)-l.evaluate(a)],[[Se],(a,[e])=>-e.evaluate(a)]]},"/":[Se,[Se,Se],(a,[e,l])=>e.evaluate(a)/l.evaluate(a)],"%":[Se,[Se,Se],(a,[e,l])=>e.evaluate(a)%l.evaluate(a)],ln2:[Se,[],()=>Math.LN2],pi:[Se,[],()=>Math.PI],e:[Se,[],()=>Math.E],"^":[Se,[Se,Se],(a,[e,l])=>Math.pow(e.evaluate(a),l.evaluate(a))],sqrt:[Se,[Se],(a,[e])=>Math.sqrt(e.evaluate(a))],log10:[Se,[Se],(a,[e])=>Math.log(e.evaluate(a))/Math.LN10],ln:[Se,[Se],(a,[e])=>Math.log(e.evaluate(a))],log2:[Se,[Se],(a,[e])=>Math.log(e.evaluate(a))/Math.LN2],sin:[Se,[Se],(a,[e])=>Math.sin(e.evaluate(a))],cos:[Se,[Se],(a,[e])=>Math.cos(e.evaluate(a))],tan:[Se,[Se],(a,[e])=>Math.tan(e.evaluate(a))],asin:[Se,[Se],(a,[e])=>Math.asin(e.evaluate(a))],acos:[Se,[Se],(a,[e])=>Math.acos(e.evaluate(a))],atan:[Se,[Se],(a,[e])=>Math.atan(e.evaluate(a))],min:[Se,ro(Se),(a,e)=>Math.min(...e.map(l=>l.evaluate(a)))],max:[Se,ro(Se),(a,e)=>Math.max(...e.map(l=>l.evaluate(a)))],abs:[Se,[Se],(a,[e])=>Math.abs(e.evaluate(a))],round:[Se,[Se],(a,[e])=>{let l=e.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[Se,[Se],(a,[e])=>Math.floor(e.evaluate(a))],ceil:[Se,[Se],(a,[e])=>Math.ceil(e.evaluate(a))],"filter-==":[di,[$e,vi],(a,[e,l])=>a.properties()[e.value]===l.value],"filter-id-==":[di,[vi],(a,[e])=>a.id()===e.value],"filter-type-==":[di,[$e],(a,[e])=>a.geometryType()===e.value],"filter-<":[di,[$e,vi],(a,[e,l])=>{let u=a.properties()[e.value],m=l.value;return typeof u==typeof m&&u<m}],"filter-id-<":[di,[vi],(a,[e])=>{let l=a.id(),u=e.value;return typeof l==typeof u&&l<u}],"filter->":[di,[$e,vi],(a,[e,l])=>{let u=a.properties()[e.value],m=l.value;return typeof u==typeof m&&u>m}],"filter-id->":[di,[vi],(a,[e])=>{let l=a.id(),u=e.value;return typeof l==typeof u&&l>u}],"filter-<=":[di,[$e,vi],(a,[e,l])=>{let u=a.properties()[e.value],m=l.value;return typeof u==typeof m&&u<=m}],"filter-id-<=":[di,[vi],(a,[e])=>{let l=a.id(),u=e.value;return typeof l==typeof u&&l<=u}],"filter->=":[di,[$e,vi],(a,[e,l])=>{let u=a.properties()[e.value],m=l.value;return typeof u==typeof m&&u>=m}],"filter-id->=":[di,[vi],(a,[e])=>{let l=a.id(),u=e.value;return typeof l==typeof u&&l>=u}],"filter-has":[di,[vi],(a,[e])=>e.value in a.properties()],"filter-has-id":[di,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[di,[rt($e)],(a,[e])=>e.value.indexOf(a.geometryType())>=0],"filter-id-in":[di,[rt(vi)],(a,[e])=>e.value.indexOf(a.id())>=0],"filter-in-small":[di,[$e,rt(vi)],(a,[e,l])=>l.value.indexOf(a.properties()[e.value])>=0],"filter-in-large":[di,[$e,rt(vi)],(a,[e,l])=>function(u,m,w,B){for(;w<=B;){let S=w+B>>1;if(m[S]===u)return!0;m[S]>u?B=S-1:w=S+1}return!1}(a.properties()[e.value],l.value,0,l.value.length-1)],all:{type:di,overloads:[[[di,di],(a,[e,l])=>e.evaluate(a)&&l.evaluate(a)],[ro(di),(a,e)=>{for(let l of e)if(!l.evaluate(a))return!1;return!0}]]},any:{type:di,overloads:[[[di,di],(a,[e,l])=>e.evaluate(a)||l.evaluate(a)],[ro(di),(a,e)=>{for(let l of e)if(l.evaluate(a))return!0;return!1}]]},"!":[di,[di],(a,[e])=>!e.evaluate(a)],"is-supported-script":[di,[$e],(a,[e])=>{let l=a.globals&&a.globals.isSupportedScript;return!l||l(e.evaluate(a))}],upcase:[$e,[$e],(a,[e])=>e.evaluate(a).toUpperCase()],downcase:[$e,[$e],(a,[e])=>e.evaluate(a).toLowerCase()],concat:[$e,ro(vi),(a,e)=>e.map(l=>zo(l.evaluate(a))).join("")],"resolved-locale":[$e,[tr],(a,[e])=>e.evaluate(a).resolvedLocale()]});class Vr{constructor(e,l){var u;this.expression=e,this._warningHistory={},this._evaluator=new ct,this._defaultValue=l?(u=l).type==="color"&&ue(u.default)?new Ji(0,0,0,0):u.type==="color"?Ji.parse(u.default)||null:u.type==="padding"?xr.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?an.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(e,l,u,m,w,B){return this._evaluator.globals=e,this._evaluator.feature=l,this._evaluator.featureState=u,this._evaluator.canonical=m,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=B,this.expression.evaluate(this._evaluator)}evaluate(e,l,u,m,w,B){this._evaluator.globals=e,this._evaluator.feature=l||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=B||null;try{let S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Nr(`Expected value to be one of ${Object.keys(this._enumValues).map(Q=>JSON.stringify(Q)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function Xi(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Yo}function Yi(a,e){let l=new Bt(Yo,Or,[],e?function(m){let w={color:Zi,string:$e,number:Se,enum:$e,boolean:di,formatted:Lr,padding:ft,resolvedImage:Y,variableAnchorOffsetCollection:q};return m.type==="array"?rt(w[m.value]||vi,m.length):w[m.type]}(e):void 0),u=l.parse(a,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?qo(new Vr(u,e)):ko(l.errors)}class un{constructor(e,l){this.kind=e,this._styleExpression=l,this.isStateDependent=e!=="constant"&&!_n(l.expression)}evaluateWithoutErrorHandling(e,l,u,m,w,B){return this._styleExpression.evaluateWithoutErrorHandling(e,l,u,m,w,B)}evaluate(e,l,u,m,w,B){return this._styleExpression.evaluate(e,l,u,m,w,B)}}class hn{constructor(e,l,u,m){this.kind=e,this.zoomStops=u,this._styleExpression=l,this.isStateDependent=e!=="camera"&&!_n(l.expression),this.interpolationType=m}evaluateWithoutErrorHandling(e,l,u,m,w,B){return this._styleExpression.evaluateWithoutErrorHandling(e,l,u,m,w,B)}evaluate(e,l,u,m,w,B){return this._styleExpression.evaluate(e,l,u,m,w,B)}interpolationFactor(e,l,u){return this.interpolationType?cn.interpolationFactor(this.interpolationType,e,l,u):0}}function Hs(a,e){let l=Yi(a,e);if(l.result==="error")return l;let u=l.value.expression,m=Ur(u);if(!m&&!U(e))return ko([new mi("","data expressions not supported")]);let w=vn(u,["zoom"]);if(!w&&!it(e))return ko([new mi("","zoom expressions not supported")]);let B=Zs(u);return B||w?B instanceof mi?ko([B]):B instanceof cn&&!Et(e)?ko([new mi("",'"interpolate" expressions cannot be used with this property')]):qo(B?new hn(m?"camera":"composite",l.value,B.labels,B instanceof cn?B.interpolation:void 0):new un(m?"constant":"source",l.value)):ko([new mi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class $n{constructor(e,l){this._parameters=e,this._specification=l,Oi(this,Ve(this._parameters,this._specification))}static deserialize(e){return new $n(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Zs(a){let e=null;if(a instanceof Sa)e=Zs(a.result);else if(a instanceof lr){for(let l of a.args)if(e=Zs(l),e)break}else(a instanceof _o||a instanceof cn)&&a.input instanceof dr&&a.input.name==="zoom"&&(e=a);return e instanceof mi||a.eachChild(l=>{let u=Zs(l);u instanceof mi?e=u:!e&&u?e=new mi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&u&&e!==u&&(e=new mi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function yA(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(let e of a.slice(1))if(!yA(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}let bA={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ga(a){if(a==null)return{filter:()=>!0,needGeometry:!1};yA(a)||(a=Lo(a));let e=Yi(a,bA);if(e.result==="error")throw new Error(e.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,u,m)=>e.value.evaluate(l,u,{},m),needGeometry:Ua(a)}}function Qa(a,e){return a<e?-1:a>e?1:0}function Ua(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let e=1;e<a.length;e++)if(Ua(a[e]))return!0;return!1}function Lo(a){if(!a)return!0;let e=a[0];return a.length<=1?e!=="any":e==="=="?da(a[1],a[2],"=="):e==="!="?$o(da(a[1],a[2],"==")):e==="<"||e===">"||e==="<="||e===">="?da(a[1],a[2],e):e==="any"?(l=a.slice(1),["any"].concat(l.map(Lo))):e==="all"?["all"].concat(a.slice(1).map(Lo)):e==="none"?["all"].concat(a.slice(1).map(Lo).map($o)):e==="in"?ts(a[1],a.slice(2)):e==="!in"?$o(ts(a[1],a.slice(2))):e==="has"?Ga(a[1]):e==="!has"?$o(Ga(a[1])):e!=="within"||a;var l}function da(a,e,l){switch(a){case"$type":return[`filter-type-${l}`,e];case"$id":return[`filter-id-${l}`,e];default:return[`filter-${l}`,a,e]}}function ts(a,e){if(e.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(l=>typeof l!=typeof e[0])?["filter-in-large",a,["literal",e.sort(Qa)]]:["filter-in-small",a,["literal",e]]}}function Ga(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function $o(a){return["!",a]}function pa(a){let e=typeof a;if(e==="number"||e==="boolean"||e==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let m="[";for(let w of a)m+=`${pa(w)},`;return`${m}]`}let l=Object.keys(a).sort(),u="{";for(let m=0;m<l.length;m++)u+=`${JSON.stringify(l[m])}:${pa(a[l[m]])},`;return`${u}}`}function nl(a){let e="";for(let l of Rt)e+=`/${pa(a[l])}`;return e}function es(a){let e=a.value;return e?[new Ie(a.key,e,"constants have been deprecated as of v8")]:[]}function zr(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Ps(a){if(Array.isArray(a))return a.map(Ps);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){let e={};for(let l in a)e[l]=Ps(a[l]);return e}return zr(a)}function Wn(a){let e=a.key,l=a.value,u=a.valueSpec||{},m=a.objectElementValidators||{},w=a.style,B=a.styleSpec,S=a.validateSpec,Q=[],M=Nt(l);if(M!=="object")return[new Ie(e,l,`object expected, ${M} found`)];for(let D in l){let z=D.split(".")[0],et=u[z]||u["*"],nt;if(m[z])nt=m[z];else if(u[z])nt=S;else if(m["*"])nt=m["*"];else{if(!u["*"]){Q.push(new Ie(e,l[D],`unknown property "${D}"`));continue}nt=S}Q=Q.concat(nt({key:(e&&`${e}.`)+D,value:l[D],valueSpec:et,style:w,styleSpec:B,object:l,objectKey:D,validateSpec:S},l))}for(let D in u)m[D]||u[D].required&&u[D].default===void 0&&l[D]===void 0&&Q.push(new Ie(e,l,`missing required property "${D}"`));return Q}function On(a){let e=a.value,l=a.valueSpec,u=a.style,m=a.styleSpec,w=a.key,B=a.arrayElementValidator||a.validateSpec;if(Nt(e)!=="array")return[new Ie(w,e,`array expected, ${Nt(e)} found`)];if(l.length&&e.length!==l.length)return[new Ie(w,e,`array length ${l.length} expected, length ${e.length} found`)];if(l["min-length"]&&e.length<l["min-length"])return[new Ie(w,e,`array length at least ${l["min-length"]} expected, length ${e.length} found`)];let S={type:l.value,values:l.values};m.$version<7&&(S.function=l.function),Nt(l.value)==="object"&&(S=l.value);let Q=[];for(let M=0;M<e.length;M++)Q=Q.concat(B({array:e,arrayIndex:M,value:e[M],valueSpec:S,validateSpec:a.validateSpec,style:u,styleSpec:m,key:`${w}[${M}]`}));return Q}function Ra(a){let e=a.key,l=a.value,u=a.valueSpec,m=Nt(l);return m==="number"&&l!=l&&(m="NaN"),m!=="number"?[new Ie(e,l,`number expected, ${m} found`)]:"minimum"in u&&l<u.minimum?[new Ie(e,l,`${l} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&l>u.maximum?[new Ie(e,l,`${l} is greater than the maximum value ${u.maximum}`)]:[]}function sl(a){let e=a.valueSpec,l=zr(a.value.type),u,m,w,B={},S=l!=="categorical"&&a.value.property===void 0,Q=!S,M=Nt(a.value.stops)==="array"&&Nt(a.value.stops[0])==="array"&&Nt(a.value.stops[0][0])==="object",D=Wn({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(nt){if(l==="identity")return[new Ie(nt.key,nt.value,'identity function may not have a "stops" property')];let st=[],mt=nt.value;return st=st.concat(On({key:nt.key,value:mt,valueSpec:nt.valueSpec,validateSpec:nt.validateSpec,style:nt.style,styleSpec:nt.styleSpec,arrayElementValidator:z})),Nt(mt)==="array"&&mt.length===0&&st.push(new Ie(nt.key,mt,"array must have at least one stop")),st},default:function(nt){return nt.validateSpec({key:nt.key,value:nt.value,valueSpec:e,validateSpec:nt.validateSpec,style:nt.style,styleSpec:nt.styleSpec})}}});return l==="identity"&&S&&D.push(new Ie(a.key,a.value,'missing required property "property"')),l==="identity"||a.value.stops||D.push(new Ie(a.key,a.value,'missing required property "stops"')),l==="exponential"&&a.valueSpec.expression&&!Et(a.valueSpec)&&D.push(new Ie(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(Q&&!U(a.valueSpec)?D.push(new Ie(a.key,a.value,"property functions not supported")):S&&!it(a.valueSpec)&&D.push(new Ie(a.key,a.value,"zoom functions not supported"))),l!=="categorical"&&!M||a.value.property!==void 0||D.push(new Ie(a.key,a.value,'"property" property is required')),D;function z(nt){let st=[],mt=nt.value,St=nt.key;if(Nt(mt)!=="array")return[new Ie(St,mt,`array expected, ${Nt(mt)} found`)];if(mt.length!==2)return[new Ie(St,mt,`array length 2 expected, length ${mt.length} found`)];if(M){if(Nt(mt[0])!=="object")return[new Ie(St,mt,`object expected, ${Nt(mt[0])} found`)];if(mt[0].zoom===void 0)return[new Ie(St,mt,"object stop key must have zoom")];if(mt[0].value===void 0)return[new Ie(St,mt,"object stop key must have value")];if(w&&w>zr(mt[0].zoom))return[new Ie(St,mt[0].zoom,"stop zoom values must appear in ascending order")];zr(mt[0].zoom)!==w&&(w=zr(mt[0].zoom),m=void 0,B={}),st=st.concat(Wn({key:`${St}[0]`,value:mt[0],valueSpec:{zoom:{}},validateSpec:nt.validateSpec,style:nt.style,styleSpec:nt.styleSpec,objectElementValidators:{zoom:Ra,value:et}}))}else st=st.concat(et({key:`${St}[0]`,value:mt[0],valueSpec:{},validateSpec:nt.validateSpec,style:nt.style,styleSpec:nt.styleSpec},mt));return Xi(Ps(mt[1]))?st.concat([new Ie(`${St}[1]`,mt[1],"expressions are not allowed in function stops.")]):st.concat(nt.validateSpec({key:`${St}[1]`,value:mt[1],valueSpec:e,validateSpec:nt.validateSpec,style:nt.style,styleSpec:nt.styleSpec}))}function et(nt,st){let mt=Nt(nt.value),St=zr(nt.value),Vt=nt.value!==null?nt.value:st;if(u){if(mt!==u)return[new Ie(nt.key,Vt,`${mt} stop domain type must match previous stop domain type ${u}`)]}else u=mt;if(mt!=="number"&&mt!=="string"&&mt!=="boolean")return[new Ie(nt.key,Vt,"stop domain value must be a number, string, or boolean")];if(mt!=="number"&&l!=="categorical"){let oe=`number expected, ${mt} found`;return U(e)&&l===void 0&&(oe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ie(nt.key,Vt,oe)]}return l!=="categorical"||mt!=="number"||isFinite(St)&&Math.floor(St)===St?l!=="categorical"&&mt==="number"&&m!==void 0&&St<m?[new Ie(nt.key,Vt,"stop domain values must appear in ascending order")]:(m=St,l==="categorical"&&St in B?[new Ie(nt.key,Vt,"stop domain values must be unique")]:(B[St]=!0,[])):[new Ie(nt.key,Vt,`integer expected, found ${St}`)]}}function fa(a){let e=(a.expressionContext==="property"?Hs:Yi)(Ps(a.value),a.valueSpec);if(e.result==="error")return e.value.map(u=>new Ie(`${a.key}${u.key}`,a.value,u.message));let l=e.value.expression||e.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!l.outputDefined())return[new Ie(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!_n(l))return[new Ie(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!_n(l))return[new Ie(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!vn(l,["zoom","feature-state"]))return[new Ie(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Ur(l))return[new Ie(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ls(a){let e=a.key,l=a.value,u=a.valueSpec,m=[];return Array.isArray(u.values)?u.values.indexOf(zr(l))===-1&&m.push(new Ie(e,l,`expected one of [${u.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(u.values).indexOf(zr(l))===-1&&m.push(new Ie(e,l,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(l)} found`)),m}function xn(a){return yA(Ps(a.value))?fa(Oi({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):is(a)}function is(a){let e=a.value,l=a.key;if(Nt(e)!=="array")return[new Ie(l,e,`array expected, ${Nt(e)} found`)];let u=a.styleSpec,m,w=[];if(e.length<1)return[new Ie(l,e,"filter array must have at least 1 element")];switch(w=w.concat(ls({key:`${l}[0]`,value:e[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),zr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&zr(e[1])==="$type"&&w.push(new Ie(l,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&w.push(new Ie(l,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(m=Nt(e[1]),m!=="string"&&w.push(new Ie(`${l}[1]`,e[1],`string expected, ${m} found`)));for(let B=2;B<e.length;B++)m=Nt(e[B]),zr(e[1])==="$type"?w=w.concat(ls({key:`${l}[${B}]`,value:e[B],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&w.push(new Ie(`${l}[${B}]`,e[B],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let B=1;B<e.length;B++)w=w.concat(is({key:`${l}[${B}]`,value:e[B],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":m=Nt(e[1]),e.length!==2?w.push(new Ie(l,e,`filter array for "${e[0]}" operator must have 2 elements`)):m!=="string"&&w.push(new Ie(`${l}[1]`,e[1],`string expected, ${m} found`));break;case"within":m=Nt(e[1]),e.length!==2?w.push(new Ie(l,e,`filter array for "${e[0]}" operator must have 2 elements`)):m!=="object"&&w.push(new Ie(`${l}[1]`,e[1],`object expected, ${m} found`))}return w}function Eo(a,e){let l=a.key,u=a.validateSpec,m=a.style,w=a.styleSpec,B=a.value,S=a.objectKey,Q=w[`${e}_${a.layerType}`];if(!Q)return[];let M=S.match(/^(.*)-transition$/);if(e==="paint"&&M&&Q[M[1]]&&Q[M[1]].transition)return u({key:l,value:B,valueSpec:w.transition,style:m,styleSpec:w});let D=a.valueSpec||Q[S];if(!D)return[new Ie(l,B,`unknown property "${S}"`)];let z;if(Nt(B)==="string"&&U(D)&&!D.tokens&&(z=/^{([^}]+)}$/.exec(B)))return[new Ie(l,B,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(z[1])} }\`.`)];let et=[];return a.layerType==="symbol"&&(S==="text-field"&&m&&!m.glyphs&&et.push(new Ie(l,B,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&ue(Ps(B))&&zr(B.type)==="identity"&&et.push(new Ie(l,B,'"text-font" does not support identity functions'))),et.concat(u({key:a.key,value:B,valueSpec:D,style:m,styleSpec:w,expressionContext:"property",propertyType:e,propertyKey:S}))}function _s(a){return Eo(a,"paint")}function no(a){return Eo(a,"layout")}function ma(a){let e=[],l=a.value,u=a.key,m=a.style,w=a.styleSpec;l.type||l.ref||e.push(new Ie(u,l,'either "type" or "ref" is required'));let B=zr(l.type),S=zr(l.ref);if(l.id){let Q=zr(l.id);for(let M=0;M<a.arrayIndex;M++){let D=m.layers[M];zr(D.id)===Q&&e.push(new Ie(u,l.id,`duplicate layer id "${l.id}", previously used at line ${D.id.__line__}`))}}if("ref"in l){let Q;["type","source","source-layer","filter","layout"].forEach(M=>{M in l&&e.push(new Ie(u,l[M],`"${M}" is prohibited for ref layers`))}),m.layers.forEach(M=>{zr(M.id)===S&&(Q=M)}),Q?Q.ref?e.push(new Ie(u,l.ref,"ref cannot reference another ref layer")):B=zr(Q.type):e.push(new Ie(u,l.ref,`ref layer "${S}" not found`))}else if(B!=="background")if(l.source){let Q=m.sources&&m.sources[l.source],M=Q&&zr(Q.type);Q?M==="vector"&&B==="raster"?e.push(new Ie(u,l.source,`layer "${l.id}" requires a raster source`)):M!=="raster-dem"&&B==="hillshade"?e.push(new Ie(u,l.source,`layer "${l.id}" requires a raster-dem source`)):M==="raster"&&B!=="raster"?e.push(new Ie(u,l.source,`layer "${l.id}" requires a vector source`)):M!=="vector"||l["source-layer"]?M==="raster-dem"&&B!=="hillshade"?e.push(new Ie(u,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):B!=="line"||!l.paint||!l.paint["line-gradient"]||M==="geojson"&&Q.lineMetrics||e.push(new Ie(u,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ie(u,l,`layer "${l.id}" must specify a "source-layer"`)):e.push(new Ie(u,l.source,`source "${l.source}" not found`))}else e.push(new Ie(u,l,'missing required property "source"'));return e=e.concat(Wn({key:u,value:l,valueSpec:w.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${u}.type`,value:l.type,valueSpec:w.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:l,objectKey:"type"}),filter:xn,layout:Q=>Wn({layer:l,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,validateSpec:Q.validateSpec,objectElementValidators:{"*":M=>no(Oi({layerType:B},M))}}),paint:Q=>Wn({layer:l,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,validateSpec:Q.validateSpec,objectElementValidators:{"*":M=>_s(Oi({layerType:B},M))}})}})),e}function fn(a){let e=a.value,l=a.key,u=Nt(e);return u!=="string"?[new Ie(l,e,`string expected, ${u} found`)]:[]}let Ha={promoteId:function({key:a,value:e}){if(Nt(e)==="string")return fn({key:a,value:e});{let l=[];for(let u in e)l.push(...fn({key:`${a}.${u}`,value:e[u]}));return l}}};function vA(a){let e=a.value,l=a.key,u=a.styleSpec,m=a.style,w=a.validateSpec;if(!e.type)return[new Ie(l,e,'"type" is required')];let B=zr(e.type),S;switch(B){case"vector":case"raster":return S=Wn({key:l,value:e,valueSpec:u[`source_${B.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:Ha,validateSpec:w}),S;case"raster-dem":return S=function(Q){var M;let D=(M=Q.sourceName)!==null&&M!==void 0?M:"",z=Q.value,et=Q.styleSpec,nt=et.source_raster_dem,st=Q.style,mt=[],St=Nt(z);if(z===void 0)return mt;if(St!=="object")return mt.push(new Ie("source_raster_dem",z,`object expected, ${St} found`)),mt;let Vt=zr(z.encoding)==="custom",oe=["redFactor","greenFactor","blueFactor","baseShift"],Wt=Q.value.encoding?`"${Q.value.encoding}"`:"Default";for(let $t in z)!Vt&&oe.includes($t)?mt.push(new Ie($t,z[$t],`In "${D}": "${$t}" is only valid when "encoding" is set to "custom". ${Wt} encoding found`)):nt[$t]?mt=mt.concat(Q.validateSpec({key:$t,value:z[$t],valueSpec:nt[$t],validateSpec:Q.validateSpec,style:st,styleSpec:et})):mt.push(new Ie($t,z[$t],`unknown property "${$t}"`));return mt}({sourceName:l,value:e,style:a.style,styleSpec:u,validateSpec:w}),S;case"geojson":if(S=Wn({key:l,value:e,valueSpec:u.source_geojson,style:m,styleSpec:u,validateSpec:w,objectElementValidators:Ha}),e.cluster)for(let Q in e.clusterProperties){let[M,D]=e.clusterProperties[Q],z=typeof M=="string"?[M,["accumulated"],["get",Q]]:M;S.push(...fa({key:`${l}.${Q}.map`,value:D,validateSpec:w,expressionContext:"cluster-map"})),S.push(...fa({key:`${l}.${Q}.reduce`,value:z,validateSpec:w,expressionContext:"cluster-reduce"}))}return S;case"video":return Wn({key:l,value:e,valueSpec:u.source_video,style:m,validateSpec:w,styleSpec:u});case"image":return Wn({key:l,value:e,valueSpec:u.source_image,style:m,validateSpec:w,styleSpec:u});case"canvas":return[new Ie(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ls({key:`${l}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,validateSpec:w,styleSpec:u})}}function ta(a){let e=a.value,l=a.styleSpec,u=l.light,m=a.style,w=[],B=Nt(e);if(e===void 0)return w;if(B!=="object")return w=w.concat([new Ie("light",e,`object expected, ${B} found`)]),w;for(let S in e){let Q=S.match(/^(.*)-transition$/);w=w.concat(Q&&u[Q[1]]&&u[Q[1]].transition?a.validateSpec({key:S,value:e[S],valueSpec:l.transition,validateSpec:a.validateSpec,style:m,styleSpec:l}):u[S]?a.validateSpec({key:S,value:e[S],valueSpec:u[S],validateSpec:a.validateSpec,style:m,styleSpec:l}):[new Ie(S,e[S],`unknown property "${S}"`)])}return w}function Ms(a){let e=a.value,l=a.styleSpec,u=l.sky,m=a.style,w=Nt(e);if(e===void 0)return[];if(w!=="object")return[new Ie("sky",e,`object expected, ${w} found`)];let B=[];for(let S in e)B=B.concat(u[S]?Jr({key:S,value:e[S],valueSpec:u[S],style:m,styleSpec:l}):[new Ie(S,e[S],`unknown property "${S}"`)]);return B}function To(a){let e=a.value,l=a.styleSpec,u=l.terrain,m=a.style,w=[],B=Nt(e);if(e===void 0)return w;if(B!=="object")return w=w.concat([new Ie("terrain",e,`object expected, ${B} found`)]),w;for(let S in e)w=w.concat(u[S]?a.validateSpec({key:S,value:e[S],valueSpec:u[S],validateSpec:a.validateSpec,style:m,styleSpec:l}):[new Ie(S,e[S],`unknown property "${S}"`)]);return w}function so(a){let e=[],l=a.value,u=a.key;if(Array.isArray(l)){let m=[],w=[];for(let B in l)l[B].id&&m.includes(l[B].id)&&e.push(new Ie(u,l,`all the sprites' ids must be unique, but ${l[B].id} is duplicated`)),m.push(l[B].id),l[B].url&&w.includes(l[B].url)&&e.push(new Ie(u,l,`all the sprites' URLs must be unique, but ${l[B].url} is duplicated`)),w.push(l[B].url),e=e.concat(Wn({key:`${u}[${B}]`,value:l[B],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return e}return fn({key:u,value:l})}let Qo={"*":()=>[],array:On,boolean:function(a){let e=a.value,l=a.key,u=Nt(e);return u!=="boolean"?[new Ie(l,e,`boolean expected, ${u} found`)]:[]},number:Ra,color:function(a){let e=a.key,l=a.value,u=Nt(l);return u!=="string"?[new Ie(e,l,`color expected, ${u} found`)]:Ji.parse(String(l))?[]:[new Ie(e,l,`color expected, "${l}" found`)]},constants:es,enum:ls,filter:xn,function:sl,layer:ma,object:Wn,source:vA,light:ta,sky:Ms,terrain:To,string:fn,formatted:function(a){return fn(a).length===0?[]:fa(a)},resolvedImage:function(a){return fn(a).length===0?[]:fa(a)},padding:function(a){let e=a.key,l=a.value;if(Nt(l)==="array"){if(l.length<1||l.length>4)return[new Ie(e,l,`padding requires 1 to 4 values; ${l.length} values found`)];let u={type:"number"},m=[];for(let w=0;w<l.length;w++)m=m.concat(a.validateSpec({key:`${e}[${w}]`,value:l[w],validateSpec:a.validateSpec,valueSpec:u}));return m}return Ra({key:e,value:l,valueSpec:{}})},variableAnchorOffsetCollection:function(a){let e=a.key,l=a.value,u=Nt(l),m=a.styleSpec;if(u!=="array"||l.length<1||l.length%2!=0)return[new Ie(e,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let w=[];for(let B=0;B<l.length;B+=2)w=w.concat(ls({key:`${e}[${B}]`,value:l[B],valueSpec:m.layout_symbol["text-anchor"]})),w=w.concat(On({key:`${e}[${B+1}]`,value:l[B+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:m}));return w},sprite:so};function Jr(a){let e=a.value,l=a.valueSpec,u=a.styleSpec;return a.validateSpec=Jr,l.expression&&ue(zr(e))?sl(a):l.expression&&Xi(Ps(e))?fa(a):l.type&&Qo[l.type]?Qo[l.type](a):Wn(Oi({},a,{valueSpec:l.type?u[l.type]:l}))}function xs(a){let e=a.value,l=a.key,u=fn(a);return u.length||(e.indexOf("{fontstack}")===-1&&u.push(new Ie(l,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&u.push(new Ie(l,e,'"glyphs" url must include a "{range}" token'))),u}function zn(a,e=xt){let l=[];return l=l.concat(Jr({key:"",value:a,valueSpec:e.$root,styleSpec:e,style:a,validateSpec:Jr,objectElementValidators:{glyphs:xs,"*":()=>[]}})),a.constants&&(l=l.concat(es({key:"constants",value:a.constants,style:a,styleSpec:e,validateSpec:Jr}))),Uo(l)}function gn(a){return function(e){return a({...e,validateSpec:Jr})}}function Uo(a){return[].concat(a).sort((e,l)=>e.line-l.line)}function pr(a){return function(...e){return Uo(a.apply(this,e))}}zn.source=pr(gn(vA)),zn.sprite=pr(gn(so)),zn.glyphs=pr(gn(xs)),zn.light=pr(gn(ta)),zn.sky=pr(gn(Ms)),zn.terrain=pr(gn(To)),zn.layer=pr(gn(ma)),zn.filter=pr(gn(xn)),zn.paintProperty=pr(gn(_s)),zn.layoutProperty=pr(gn(no));let kr=zn,en=kr.light,yn=kr.paintProperty,oo=kr.layoutProperty;function ea(a,e){let l=!1;if(e&&e.length)for(let u of e)a.fire(new Me(new Error(u.message))),l=!0;return l}class cs{constructor(e,l,u){let m=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let B=new Int32Array(this.arrayBuffer);e=B[0],this.d=(l=B[1])+2*(u=B[2]);for(let Q=0;Q<this.d*this.d;Q++){let M=B[3+Q],D=B[3+Q+1];m.push(M===D?null:B.subarray(M,D))}let S=B[3+m.length+1];this.keys=B.subarray(B[3+m.length],S),this.bboxes=B.subarray(S),this.insert=this._insertReadonly}else{this.d=l+2*u;for(let B=0;B<this.d*this.d;B++)m.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=e,this.padding=u,this.scale=l/e,this.uid=0;let w=u/l*e;this.min=-w,this.max=e+w}insert(e,l,u,m,w){this._forEachCell(l,u,m,w,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(w)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,l,u,m,w,B){this.cells[w].push(B)}query(e,l,u,m,w){let B=this.min,S=this.max;if(e<=B&&l<=B&&S<=u&&S<=m&&!w)return Array.prototype.slice.call(this.keys);{let Q=[];return this._forEachCell(e,l,u,m,this._queryCell,Q,{},w),Q}}_queryCell(e,l,u,m,w,B,S,Q){let M=this.cells[w];if(M!==null){let D=this.keys,z=this.bboxes;for(let et=0;et<M.length;et++){let nt=M[et];if(S[nt]===void 0){let st=4*nt;(Q?Q(z[st+0],z[st+1],z[st+2],z[st+3]):e<=z[st+2]&&l<=z[st+3]&&u>=z[st+0]&&m>=z[st+1])?(S[nt]=!0,B.push(D[nt])):S[nt]=!1}}}}_forEachCell(e,l,u,m,w,B,S,Q){let M=this._convertToCellCoord(e),D=this._convertToCellCoord(l),z=this._convertToCellCoord(u),et=this._convertToCellCoord(m);for(let nt=M;nt<=z;nt++)for(let st=D;st<=et;st++){let mt=this.d*st+nt;if((!Q||Q(this._convertFromCellCoord(nt),this._convertFromCellCoord(st),this._convertFromCellCoord(nt+1),this._convertFromCellCoord(st+1)))&&w.call(this,e,l,u,m,mt,B,S,Q))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,l=3+this.cells.length+1+1,u=0;for(let B=0;B<this.cells.length;B++)u+=this.cells[B].length;let m=new Int32Array(l+u+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let w=l;for(let B=0;B<e.length;B++){let S=e[B];m[3+B]=w,m.set(S,w),w+=S.length}return m[3+e.length]=w,m.set(this.keys,w),w+=this.keys.length,m[3+e.length+1]=w,m.set(this.bboxes,w),w+=this.bboxes.length,m.buffer}static serialize(e,l){let u=e.toArrayBuffer();return l&&l.push(u),{buffer:u}}static deserialize(e){return new cs(e.buffer)}}let ao={};function si(a,e,l={}){if(ao[a])throw new Error(`${a} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:a,writeable:!1}),ao[a]={klass:e,omit:l.omit||[],shallow:l.shallow||[]}}si("Object",Object),si("TransferableGridIndex",cs),si("Color",Ji),si("Error",Error),si("AJAXError",Ot),si("ResolvedImage",Dn),si("StylePropertyFunction",$n),si("StyleExpression",Vr,{omit:["_evaluator"]}),si("ZoomDependentExpression",hn),si("ZoomConstantExpression",un),si("CompoundExpression",dr,{omit:["_evaluate"]});for(let a in Yo)Yo[a]._classRegistryKey||si(`Expression_${a}`,Yo[a]);function Ql(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Ca(a,e){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error)return a;if(Ql(a)||ie(a))return e&&e.push(a),a;if(ArrayBuffer.isView(a)){let l=a;return e&&e.push(l.buffer),l}if(a instanceof ImageData)return e&&e.push(a.data.buffer),a;if(Array.isArray(a)){let l=[];for(let u of a)l.push(Ca(u,e));return l}if(typeof a=="object"){let l=a.constructor,u=l._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${l.name}`);if(!ao[u])throw new Error(`${u} is not registered.`);let m=l.serialize?l.serialize(a,e):{};if(l.serialize){if(e&&m===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let w in a){if(!a.hasOwnProperty(w)||ao[u].omit.indexOf(w)>=0)continue;let B=a[w];m[w]=ao[u].shallow.indexOf(w)>=0?B:Ca(B,e)}a instanceof Error&&(m.message=a.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(m.$name=u),m}throw new Error("can't serialize object of type "+typeof a)}function Za(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Ql(a)||ie(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Za);if(typeof a=="object"){let e=a.$name||"Object";if(!ao[e])throw new Error(`can't deserialize unregistered class ${e}`);let{klass:l}=ao[e];if(!l)throw new Error(`can't deserialize unregistered class ${e}`);if(l.deserialize)return l.deserialize(a);let u=Object.create(l.prototype);for(let m of Object.keys(a)){if(m==="$name")continue;let w=a[m];u[m]=ao[e].shallow.indexOf(m)>=0?w:Za(w)}return u}throw new Error("can't deserialize object of type "+typeof a)}class Ul{constructor(){this.first=!0}update(e,l){let u=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=l),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=u,!0))}}let ei={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Pa(a){for(let e of a)if(rs(e.charCodeAt(0)))return!0;return!1}function Ma(a){for(let e of a)if(!us(e.charCodeAt(0)))return!1;return!0}function us(a){return!(ei.Arabic(a)||ei["Arabic Supplement"](a)||ei["Arabic Extended-A"](a)||ei["Arabic Presentation Forms-A"](a)||ei["Arabic Presentation Forms-B"](a))}function rs(a){return!(a!==746&&a!==747&&(a<4352||!(ei["Bopomofo Extended"](a)||ei.Bopomofo(a)||ei["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||ei["CJK Compatibility Ideographs"](a)||ei["CJK Compatibility"](a)||ei["CJK Radicals Supplement"](a)||ei["CJK Strokes"](a)||!(!ei["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||ei["CJK Unified Ideographs Extension A"](a)||ei["CJK Unified Ideographs"](a)||ei["Enclosed CJK Letters and Months"](a)||ei["Hangul Compatibility Jamo"](a)||ei["Hangul Jamo Extended-A"](a)||ei["Hangul Jamo Extended-B"](a)||ei["Hangul Jamo"](a)||ei["Hangul Syllables"](a)||ei.Hiragana(a)||ei["Ideographic Description Characters"](a)||ei.Kanbun(a)||ei["Kangxi Radicals"](a)||ei["Katakana Phonetic Extensions"](a)||ei.Katakana(a)&&a!==12540||!(!ei["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!ei["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||ei["Unified Canadian Aboriginal Syllabics"](a)||ei["Unified Canadian Aboriginal Syllabics Extended"](a)||ei["Vertical Forms"](a)||ei["Yijing Hexagram Symbols"](a)||ei["Yi Syllables"](a)||ei["Yi Radicals"](a))))}function wA(a){return!(rs(a)||function(e){return!!(ei["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||ei["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||ei["Letterlike Symbols"](e)||ei["Number Forms"](e)||ei["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||ei["Control Pictures"](e)&&e!==9251||ei["Optical Character Recognition"](e)||ei["Enclosed Alphanumerics"](e)||ei["Geometric Shapes"](e)||ei["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||ei["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ei["CJK Symbols and Punctuation"](e)||ei.Katakana(e)||ei["Private Use Area"](e)||ei["CJK Compatibility Forms"](e)||ei["Small Form Variants"](e)||ei["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(a))}function BA(a){return a>=1424&&a<=2303||ei["Arabic Presentation Forms-A"](a)||ei["Arabic Presentation Forms-B"](a)}function Gl(a,e){return!(!e&&BA(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||ei.Khmer(a))}function ol(a){for(let e of a)if(BA(e.charCodeAt(0)))return!0;return!1}let Go=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Hr{constructor(e,l){this.zoom=e,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ul,this.transition={})}isSupportedScript(e){return function(l,u){for(let m of l)if(!Gl(m.charCodeAt(0),u))return!1;return!0}(e,Go.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,l=e-Math.floor(e),u=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*l}}}class al{constructor(e,l){this.property=e,this.value=l,this.expression=function(u,m){if(ue(u))return new $n(u,m);if(Xi(u)){let w=Hs(u,m);if(w.result==="error")throw new Error(w.value.map(B=>`${B.key}: ${B.message}`).join(", "));return w.value}{let w=u;return m.type==="color"&&typeof u=="string"?w=Ji.parse(u):m.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(u)&&(w=an.parse(u)):w=xr.parse(u),{kind:"constant",evaluate:()=>w}}}(l===void 0?e.specification.default:l,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,l,u){return this.property.possiblyEvaluate(this,e,l,u)}}class _A{constructor(e){this.property=e,this.value=new al(e,void 0)}transitioned(e,l){return new xA(this.property,this.value,l,Tt({},e.transition,this.transition),e.now)}untransitioned(){return new xA(this.property,this.value,null,{},0)}}class Al{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Jt(this._values[e].value.value)}setValue(e,l){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new _A(this._values[e].property)),this._values[e].value=new al(this._values[e].property,l===null?void 0:Jt(l))}getTransition(e){return Jt(this._values[e].transition)}setTransition(e,l){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new _A(this._values[e].property)),this._values[e].transition=Jt(l)||void 0}serialize(){let e={};for(let l of Object.keys(this._values)){let u=this.getValue(l);u!==void 0&&(e[l]=u);let m=this.getTransition(l);m!==void 0&&(e[`${l}-transition`]=m)}return e}transitioned(e,l){let u=new Rl(this._properties);for(let m of Object.keys(this._values))u._values[m]=this._values[m].transitioned(e,l._values[m]);return u}untransitioned(){let e=new Rl(this._properties);for(let l of Object.keys(this._values))e._values[l]=this._values[l].untransitioned();return e}}class xA{constructor(e,l,u,m,w){this.property=e,this.value=l,this.begin=w+m.delay||0,this.end=this.begin+m.duration||0,e.specification.transition&&(m.delay||m.duration)&&(this.prior=u)}possiblyEvaluate(e,l,u){let m=e.now||0,w=this.value.possiblyEvaluate(e,l,u),B=this.prior;if(B){if(m>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(m<this.begin)return B.possiblyEvaluate(e,l,u);{let S=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(B.possiblyEvaluate(e,l,u),w,function(Q){if(Q<=0)return 0;if(Q>=1)return 1;let M=Q*Q,D=M*Q;return 4*(Q<.5?D:3*(Q-M)+D-.75)}(S))}}return w}}class Rl{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,l,u){let m=new SA(this._properties);for(let w of Object.keys(this._values))m._values[w]=this._values[w].possiblyEvaluate(e,l,u);return m}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class dh{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Jt(this._values[e].value)}setValue(e,l){this._values[e]=new al(this._values[e].property,l===null?void 0:Jt(l))}serialize(){let e={};for(let l of Object.keys(this._values)){let u=this.getValue(l);u!==void 0&&(e[l]=u)}return e}possiblyEvaluate(e,l,u){let m=new SA(this._properties);for(let w of Object.keys(this._values))m._values[w]=this._values[w].possiblyEvaluate(e,l,u);return m}}class Ao{constructor(e,l,u){this.property=e,this.value=l,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,l,u,m){return this.property.evaluate(this.value,this.parameters,e,l,u,m)}}class SA{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class wi{constructor(e){this.specification=e}possiblyEvaluate(e,l){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(l)}interpolate(e,l,u){let m=qn[this.specification.type];return m?m(e,l,u):e}}class Hi{constructor(e,l){this.specification=e,this.overrides=l}possiblyEvaluate(e,l,u,m){return new Ao(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(l,null,{},u,m)}:e.expression,l)}interpolate(e,l,u){if(e.value.kind!=="constant"||l.value.kind!=="constant")return e;if(e.value.value===void 0||l.value.value===void 0)return new Ao(this,{kind:"constant",value:void 0},e.parameters);let m=qn[this.specification.type];if(m){let w=m(e.value.value,l.value.value,u);return new Ao(this,{kind:"constant",value:w},e.parameters)}return e}evaluate(e,l,u,m,w,B){return e.kind==="constant"?e.value:e.evaluate(l,u,m,w,B)}}class Na extends Hi{possiblyEvaluate(e,l,u,m){if(e.value===void 0)return new Ao(this,{kind:"constant",value:void 0},l);if(e.expression.kind==="constant"){let w=e.expression.evaluate(l,null,{},u,m),B=e.property.specification.type==="resolvedImage"&&typeof w!="string"?w.name:w,S=this._calculate(B,B,B,l);return new Ao(this,{kind:"constant",value:S},l)}if(e.expression.kind==="camera"){let w=this._calculate(e.expression.evaluate({zoom:l.zoom-1}),e.expression.evaluate({zoom:l.zoom}),e.expression.evaluate({zoom:l.zoom+1}),l);return new Ao(this,{kind:"constant",value:w},l)}return new Ao(this,e.expression,l)}evaluate(e,l,u,m,w,B){if(e.kind==="source"){let S=e.evaluate(l,u,m,w,B);return this._calculate(S,S,S,l)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(l.zoom)-1},u,m),e.evaluate({zoom:Math.floor(l.zoom)},u,m),e.evaluate({zoom:Math.floor(l.zoom)+1},u,m),l):e.value}_calculate(e,l,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:e,to:l}:{from:u,to:l}}interpolate(e){return e}}class wc{constructor(e){this.specification=e}possiblyEvaluate(e,l,u,m){if(e.value!==void 0){if(e.expression.kind==="constant"){let w=e.expression.evaluate(l,null,{},u,m);return this._calculate(w,w,w,l)}return this._calculate(e.expression.evaluate(new Hr(Math.floor(l.zoom-1),l)),e.expression.evaluate(new Hr(Math.floor(l.zoom),l)),e.expression.evaluate(new Hr(Math.floor(l.zoom+1),l)),l)}}_calculate(e,l,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:e,to:l}:{from:u,to:l}}interpolate(e){return e}}class ll{constructor(e){this.specification=e}possiblyEvaluate(e,l,u,m){return!!e.expression.evaluate(l,null,{},u,m)}interpolate(){return!1}}class Jn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let l in e){let u=e[l];u.specification.overridable&&this.overridableProperties.push(l);let m=this.defaultPropertyValues[l]=new al(u,void 0),w=this.defaultTransitionablePropertyValues[l]=new _A(u);this.defaultTransitioningPropertyValues[l]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate({})}}}si("DataDrivenProperty",Hi),si("DataConstantProperty",wi),si("CrossFadedDataDrivenProperty",Na),si("CrossFadedProperty",wc),si("ColorRampProperty",ll);let Hl="-transition";class ns extends gi{constructor(e,l){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),l.layout&&(this._unevaluatedLayout=new dh(l.layout)),l.paint)){this._transitionablePaint=new Al(l.paint);for(let u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(let u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new SA(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,l,u={}){l!=null&&this._validate(oo,`layers.${this.id}.layout.${e}`,e,l,u)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,l):this.visibility=l)}getPaintProperty(e){return e.endsWith(Hl)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,l,u={}){if(l!=null&&this._validate(yn,`layers.${this.id}.paint.${e}`,e,l,u))return!1;if(e.endsWith(Hl))return this._transitionablePaint.setTransition(e.slice(0,-11),l||void 0),!1;{let m=this._transitionablePaint._values[e],w=m.property.specification["property-type"]==="cross-faded-data-driven",B=m.value.isDataDriven(),S=m.value;this._transitionablePaint.setValue(e,l),this._handleSpecialPaintPropertyUpdate(e);let Q=this._transitionablePaint._values[e].value;return Q.isDataDriven()||B||w||this._handleOverridablePaintPropertyUpdate(e,S,Q)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,l,u){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,l){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,l)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),vt(e,(l,u)=>!(l===void 0||u==="layout"&&!Object.keys(l).length||u==="paint"&&!Object.keys(l).length))}_validate(e,l,u,m,w={}){return(!w||w.validate!==!1)&&ea(this,e.call(kr,{key:l,layerType:this.type,objectKey:u,value:m,styleSpec:xt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let l=this.paint.get(e);if(l instanceof Ao&&U(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}let ou={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class FA{constructor(e,l){this._structArray=e,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Xr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,l){return e._trim(),l&&(e.isTransferred=!0,l.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let l=Object.create(this.prototype);return l.arrayBuffer=e.arrayBuffer,l.length=e.length,l.capacity=e.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function dn(a,e=1){let l=0,u=0;return{members:a.map(m=>{let w=ou[m.type].BYTES_PER_ELEMENT,B=l=au(l,Math.max(e,w)),S=m.components||1;return u=Math.max(u,w),l+=w*S,{name:m.name,type:m.type,components:S,offset:B}}),size:au(l,Math.max(u,e)),alignment:e}}function au(a,e){return Math.ceil(a/e)*e}class cl extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l){let u=this.length;return this.resize(u+1),this.emplace(u,e,l)}emplace(e,l,u){let m=2*e;return this.int16[m+0]=l,this.int16[m+1]=u,e}}cl.prototype.bytesPerElement=4,si("StructArrayLayout2i4",cl);class Zl extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,u){let m=this.length;return this.resize(m+1),this.emplace(m,e,l,u)}emplace(e,l,u,m){let w=3*e;return this.int16[w+0]=l,this.int16[w+1]=u,this.int16[w+2]=m,e}}Zl.prototype.bytesPerElement=6,si("StructArrayLayout3i6",Zl);class ss extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,u,m){let w=this.length;return this.resize(w+1),this.emplace(w,e,l,u,m)}emplace(e,l,u,m,w){let B=4*e;return this.int16[B+0]=l,this.int16[B+1]=u,this.int16[B+2]=m,this.int16[B+3]=w,e}}ss.prototype.bytesPerElement=8,si("StructArrayLayout4i8",ss);class Ss extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,u,m,w,B){let S=this.length;return this.resize(S+1),this.emplace(S,e,l,u,m,w,B)}emplace(e,l,u,m,w,B,S){let Q=6*e;return this.int16[Q+0]=l,this.int16[Q+1]=u,this.int16[Q+2]=m,this.int16[Q+3]=w,this.int16[Q+4]=B,this.int16[Q+5]=S,e}}Ss.prototype.bytesPerElement=12,si("StructArrayLayout2i4i12",Ss);class lo extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,u,m,w,B){let S=this.length;return this.resize(S+1),this.emplace(S,e,l,u,m,w,B)}emplace(e,l,u,m,w,B,S){let Q=4*e,M=8*e;return this.int16[Q+0]=l,this.int16[Q+1]=u,this.uint8[M+4]=m,this.uint8[M+5]=w,this.uint8[M+6]=B,this.uint8[M+7]=S,e}}lo.prototype.bytesPerElement=8,si("StructArrayLayout2i4ub8",lo);class ul extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l){let u=this.length;return this.resize(u+1),this.emplace(u,e,l)}emplace(e,l,u){let m=2*e;return this.float32[m+0]=l,this.float32[m+1]=u,e}}ul.prototype.bytesPerElement=8,si("StructArrayLayout2f8",ul);class Pl extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,u,m,w,B,S,Q,M,D){let z=this.length;return this.resize(z+1),this.emplace(z,e,l,u,m,w,B,S,Q,M,D)}emplace(e,l,u,m,w,B,S,Q,M,D,z){let et=10*e;return this.uint16[et+0]=l,this.uint16[et+1]=u,this.uint16[et+2]=m,this.uint16[et+3]=w,this.uint16[et+4]=B,this.uint16[et+5]=S,this.uint16[et+6]=Q,this.uint16[et+7]=M,this.uint16[et+8]=D,this.uint16[et+9]=z,e}}Pl.prototype.bytesPerElement=20,si("StructArrayLayout10ui20",Pl);class co extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,u,m,w,B,S,Q,M,D,z,et){let nt=this.length;return this.resize(nt+1),this.emplace(nt,e,l,u,m,w,B,S,Q,M,D,z,et)}emplace(e,l,u,m,w,B,S,Q,M,D,z,et,nt){let st=12*e;return this.int16[st+0]=l,this.int16[st+1]=u,this.int16[st+2]=m,this.int16[st+3]=w,this.uint16[st+4]=B,this.uint16[st+5]=S,this.uint16[st+6]=Q,this.uint16[st+7]=M,this.int16[st+8]=D,this.int16[st+9]=z,this.int16[st+10]=et,this.int16[st+11]=nt,e}}co.prototype.bytesPerElement=24,si("StructArrayLayout4i4ui4i24",co);class hs extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,u){let m=this.length;return this.resize(m+1),this.emplace(m,e,l,u)}emplace(e,l,u,m){let w=3*e;return this.float32[w+0]=l,this.float32[w+1]=u,this.float32[w+2]=m,e}}hs.prototype.bytesPerElement=12,si("StructArrayLayout3f12",hs);class Bc extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let l=this.length;return this.resize(l+1),this.emplace(l,e)}emplace(e,l){return this.uint32[1*e+0]=l,e}}Bc.prototype.bytesPerElement=4,si("StructArrayLayout1ul4",Bc);class ia extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,u,m,w,B,S,Q,M){let D=this.length;return this.resize(D+1),this.emplace(D,e,l,u,m,w,B,S,Q,M)}emplace(e,l,u,m,w,B,S,Q,M,D){let z=10*e,et=5*e;return this.int16[z+0]=l,this.int16[z+1]=u,this.int16[z+2]=m,this.int16[z+3]=w,this.int16[z+4]=B,this.int16[z+5]=S,this.uint32[et+3]=Q,this.uint16[z+8]=M,this.uint16[z+9]=D,e}}ia.prototype.bytesPerElement=20,si("StructArrayLayout6i1ul2ui20",ia);class hl extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,u,m,w,B){let S=this.length;return this.resize(S+1),this.emplace(S,e,l,u,m,w,B)}emplace(e,l,u,m,w,B,S){let Q=6*e;return this.int16[Q+0]=l,this.int16[Q+1]=u,this.int16[Q+2]=m,this.int16[Q+3]=w,this.int16[Q+4]=B,this.int16[Q+5]=S,e}}hl.prototype.bytesPerElement=12,si("StructArrayLayout2i2i2i12",hl);class kA extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,u,m,w){let B=this.length;return this.resize(B+1),this.emplace(B,e,l,u,m,w)}emplace(e,l,u,m,w,B){let S=4*e,Q=8*e;return this.float32[S+0]=l,this.float32[S+1]=u,this.float32[S+2]=m,this.int16[Q+6]=w,this.int16[Q+7]=B,e}}kA.prototype.bytesPerElement=16,si("StructArrayLayout2f1f2i16",kA);class gl extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,u,m){let w=this.length;return this.resize(w+1),this.emplace(w,e,l,u,m)}emplace(e,l,u,m,w){let B=12*e,S=3*e;return this.uint8[B+0]=l,this.uint8[B+1]=u,this.float32[S+1]=m,this.float32[S+2]=w,e}}gl.prototype.bytesPerElement=12,si("StructArrayLayout2ub2f12",gl);class Va extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,u){let m=this.length;return this.resize(m+1),this.emplace(m,e,l,u)}emplace(e,l,u,m){let w=3*e;return this.uint16[w+0]=l,this.uint16[w+1]=u,this.uint16[w+2]=m,e}}Va.prototype.bytesPerElement=6,si("StructArrayLayout3ui6",Va);class _c extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,u,m,w,B,S,Q,M,D,z,et,nt,st,mt,St,Vt){let oe=this.length;return this.resize(oe+1),this.emplace(oe,e,l,u,m,w,B,S,Q,M,D,z,et,nt,st,mt,St,Vt)}emplace(e,l,u,m,w,B,S,Q,M,D,z,et,nt,st,mt,St,Vt,oe){let Wt=24*e,$t=12*e,ve=48*e;return this.int16[Wt+0]=l,this.int16[Wt+1]=u,this.uint16[Wt+2]=m,this.uint16[Wt+3]=w,this.uint32[$t+2]=B,this.uint32[$t+3]=S,this.uint32[$t+4]=Q,this.uint16[Wt+10]=M,this.uint16[Wt+11]=D,this.uint16[Wt+12]=z,this.float32[$t+7]=et,this.float32[$t+8]=nt,this.uint8[ve+36]=st,this.uint8[ve+37]=mt,this.uint8[ve+38]=St,this.uint32[$t+10]=Vt,this.int16[Wt+22]=oe,e}}_c.prototype.bytesPerElement=48,si("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",_c);class ra extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,u,m,w,B,S,Q,M,D,z,et,nt,st,mt,St,Vt,oe,Wt,$t,ve,Le,ni,bi,ri,ti,Oe,fi){let qe=this.length;return this.resize(qe+1),this.emplace(qe,e,l,u,m,w,B,S,Q,M,D,z,et,nt,st,mt,St,Vt,oe,Wt,$t,ve,Le,ni,bi,ri,ti,Oe,fi)}emplace(e,l,u,m,w,B,S,Q,M,D,z,et,nt,st,mt,St,Vt,oe,Wt,$t,ve,Le,ni,bi,ri,ti,Oe,fi,qe){let Ze=32*e,Gi=16*e;return this.int16[Ze+0]=l,this.int16[Ze+1]=u,this.int16[Ze+2]=m,this.int16[Ze+3]=w,this.int16[Ze+4]=B,this.int16[Ze+5]=S,this.int16[Ze+6]=Q,this.int16[Ze+7]=M,this.uint16[Ze+8]=D,this.uint16[Ze+9]=z,this.uint16[Ze+10]=et,this.uint16[Ze+11]=nt,this.uint16[Ze+12]=st,this.uint16[Ze+13]=mt,this.uint16[Ze+14]=St,this.uint16[Ze+15]=Vt,this.uint16[Ze+16]=oe,this.uint16[Ze+17]=Wt,this.uint16[Ze+18]=$t,this.uint16[Ze+19]=ve,this.uint16[Ze+20]=Le,this.uint16[Ze+21]=ni,this.uint16[Ze+22]=bi,this.uint32[Gi+12]=ri,this.float32[Gi+13]=ti,this.float32[Gi+14]=Oe,this.uint16[Ze+30]=fi,this.uint16[Ze+31]=qe,e}}ra.prototype.bytesPerElement=64,si("StructArrayLayout8i15ui1ul2f2ui64",ra);class uo extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let l=this.length;return this.resize(l+1),this.emplace(l,e)}emplace(e,l){return this.float32[1*e+0]=l,e}}uo.prototype.bytesPerElement=4,si("StructArrayLayout1f4",uo);class Da extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,u){let m=this.length;return this.resize(m+1),this.emplace(m,e,l,u)}emplace(e,l,u,m){let w=3*e;return this.uint16[6*e+0]=l,this.float32[w+1]=u,this.float32[w+2]=m,e}}Da.prototype.bytesPerElement=12,si("StructArrayLayout1ui2f12",Da);class LA extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,u){let m=this.length;return this.resize(m+1),this.emplace(m,e,l,u)}emplace(e,l,u,m){let w=4*e;return this.uint32[2*e+0]=l,this.uint16[w+2]=u,this.uint16[w+3]=m,e}}LA.prototype.bytesPerElement=8,si("StructArrayLayout1ul2ui8",LA);class Ia extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l){let u=this.length;return this.resize(u+1),this.emplace(u,e,l)}emplace(e,l,u){let m=2*e;return this.uint16[m+0]=l,this.uint16[m+1]=u,e}}Ia.prototype.bytesPerElement=4,si("StructArrayLayout2ui4",Ia);class xc extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let l=this.length;return this.resize(l+1),this.emplace(l,e)}emplace(e,l){return this.uint16[1*e+0]=l,e}}xc.prototype.bytesPerElement=2,si("StructArrayLayout1ui2",xc);class Ml extends Xr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,u,m){let w=this.length;return this.resize(w+1),this.emplace(w,e,l,u,m)}emplace(e,l,u,m,w){let B=4*e;return this.float32[B+0]=l,this.float32[B+1]=u,this.float32[B+2]=m,this.float32[B+3]=w,e}}Ml.prototype.bytesPerElement=16,si("StructArrayLayout4f16",Ml);class Sc extends FA{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new v(this.anchorPointX,this.anchorPointY)}}Sc.prototype.size=20;class Au extends ia{get(e){return new Sc(this,e)}}si("CollisionBoxArray",Au);class y extends FA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}y.prototype.size=48;class n extends _c{get(e){return new y(this,e)}}si("PlacedSymbolArray",n);class c extends FA{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}c.prototype.size=64;class p extends ra{get(e){return new c(this,e)}}si("SymbolInstanceArray",p);class f extends uo{getoffsetX(e){return this.float32[1*e+0]}}si("GlyphOffsetArray",f);class b extends Zl{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}si("SymbolLineVertexArray",b);class L extends FA{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}L.prototype.size=12;class E extends Da{get(e){return new L(this,e)}}si("TextAnchorOffsetArray",E);class H extends FA{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}H.prototype.size=8;class h extends LA{get(e){return new H(this,e)}}si("FeatureIndexArray",h);class I extends cl{}class _ extends cl{}class F extends cl{}class R extends Ss{}class Z extends lo{}class N extends ul{}class P extends Pl{}class V extends co{}class X extends hs{}class J extends Bc{}class ot extends hl{}class dt extends gl{}class ut extends Va{}class Gt extends Ia{}let Pt=dn([{name:"a_pos",components:2,type:"Int16"}],4),{members:gt}=Pt;class Ct{constructor(e=[]){this.segments=e}prepareSegment(e,l,u,m){let w=this.segments[this.segments.length-1];return e>Ct.MAX_VERTEX_ARRAY_LENGTH&&At(`Max vertices per segment is ${Ct.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!w||w.vertexLength+e>Ct.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==m)&&(w={vertexOffset:l.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},m!==void 0&&(w.sortKey=m),this.segments.push(w)),w}get(){return this.segments}destroy(){for(let e of this.segments)for(let l in e.vaos)e.vaos[l].destroy()}static simpleSegment(e,l,u,m){return new Ct([{vertexOffset:e,primitiveOffset:l,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])}}function ee(a,e){return 256*(a=at(Math.floor(a),0,255))+at(Math.floor(e),0,255)}Ct.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,si("SegmentVector",Ct);let ge=dn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var jt={exports:{}},Fe={exports:{}};Fe.exports=function(a,e){var l,u,m,w,B,S,Q,M;for(u=a.length-(l=3&a.length),m=e,B=3432918353,S=461845907,M=0;M<u;)Q=255&a.charCodeAt(M)|(255&a.charCodeAt(++M))<<8|(255&a.charCodeAt(++M))<<16|(255&a.charCodeAt(++M))<<24,++M,m=27492+(65535&(w=5*(65535&(m=(m^=Q=(65535&(Q=(Q=(65535&Q)*B+(((Q>>>16)*B&65535)<<16)&4294967295)<<15|Q>>>17))*S+(((Q>>>16)*S&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(Q=0,l){case 3:Q^=(255&a.charCodeAt(M+2))<<16;case 2:Q^=(255&a.charCodeAt(M+1))<<8;case 1:m^=Q=(65535&(Q=(Q=(65535&(Q^=255&a.charCodeAt(M)))*B+(((Q>>>16)*B&65535)<<16)&4294967295)<<15|Q>>>17))*S+(((Q>>>16)*S&65535)<<16)&4294967295}return m^=a.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var ke=Fe.exports,Ye={exports:{}};Ye.exports=function(a,e){for(var l,u=a.length,m=e^u,w=0;u>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(w)|(255&a.charCodeAt(++w))<<8|(255&a.charCodeAt(++w))<<16|(255&a.charCodeAt(++w))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),u-=4,++w;switch(u){case 3:m^=(255&a.charCodeAt(w+2))<<16;case 2:m^=(255&a.charCodeAt(w+1))<<8;case 1:m=1540483477*(65535&(m^=255&a.charCodeAt(w)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var xe=ke,ci=Ye.exports;jt.exports=xe,jt.exports.murmur3=xe,jt.exports.murmur2=ci;var pi=g(jt.exports);class Mi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,l,u,m){this.ids.push(Si(e)),this.positions.push(l,u,m)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let l=Si(e),u=0,m=this.ids.length-1;for(;u<m;){let B=u+m>>1;this.ids[B]>=l?m=B:u=B+1}let w=[];for(;this.ids[u]===l;)w.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return w}static serialize(e,l){let u=new Float64Array(e.ids),m=new Uint32Array(e.positions);return cr(u,m,0,u.length-1),l&&l.push(u.buffer,m.buffer),{ids:u,positions:m}}static deserialize(e){let l=new Mi;return l.ids=e.ids,l.positions=e.positions,l.indexed=!0,l}}function Si(a){let e=+a;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:pi(String(a))}function cr(a,e,l,u){for(;l<u;){let m=a[l+u>>1],w=l-1,B=u+1;for(;;){do w++;while(a[w]<m);do B--;while(a[B]>m);if(w>=B)break;ji(a,w,B),ji(e,3*w,3*B),ji(e,3*w+1,3*B+1),ji(e,3*w+2,3*B+2)}B-l<u-B?(cr(a,e,l,B),l=B+1):(cr(a,e,B+1,u),u=B)}}function ji(a,e,l){let u=a[e];a[e]=a[l],a[l]=u}si("FeaturePositionMap",Mi);class Ii{constructor(e,l){this.gl=e.gl,this.location=l}}class vr extends Ii{constructor(e,l){super(e,l),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Yr extends Ii{constructor(e,l){super(e,l),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Gr extends Ii{constructor(e,l){super(e,l),this.current=Ji.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}let mn=new Float32Array(16);function wr(a){return[ee(255*a.r,255*a.g),ee(255*a.b,255*a.a)]}class An{constructor(e,l,u){this.value=e,this.uniformNames=l.map(m=>`u_${m}`),this.type=u}setUniform(e,l,u){e.set(u.constantOr(this.value))}getBinding(e,l,u){return this.type==="color"?new Gr(e,l):new vr(e,l)}}class rn{constructor(e,l){this.uniformNames=l.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=e.tlbr}setUniform(e,l,u,m){let w=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;w&&e.set(w)}getBinding(e,l,u){return u.substr(0,9)==="u_pattern"?new Yr(e,l):new vr(e,l)}}class ur{constructor(e,l,u,m){this.expression=e,this.type=u,this.maxValue=0,this.paintVertexAttributes=l.map(w=>({name:`a_${w}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(e,l,u,m,w){let B=this.paintVertexArray.length,S=this.expression.evaluate(new Hr(0),l,{},m,[],w);this.paintVertexArray.resize(e),this._setPaintValue(B,e,S)}updatePaintArray(e,l,u,m){let w=this.expression.evaluate({zoom:0},u,m);this._setPaintValue(e,l,w)}_setPaintValue(e,l,u){if(this.type==="color"){let m=wr(u);for(let w=e;w<l;w++)this.paintVertexArray.emplace(w,m[0],m[1])}else{for(let m=e;m<l;m++)this.paintVertexArray.emplace(m,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class sr{constructor(e,l,u,m,w,B){this.expression=e,this.uniformNames=l.map(S=>`u_${S}_t`),this.type=u,this.useIntegerZoom=m,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=l.map(S=>({name:`a_${S}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new B}populatePaintArray(e,l,u,m,w){let B=this.expression.evaluate(new Hr(this.zoom),l,{},m,[],w),S=this.expression.evaluate(new Hr(this.zoom+1),l,{},m,[],w),Q=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(Q,e,B,S)}updatePaintArray(e,l,u,m){let w=this.expression.evaluate({zoom:this.zoom},u,m),B=this.expression.evaluate({zoom:this.zoom+1},u,m);this._setPaintValue(e,l,w,B)}_setPaintValue(e,l,u,m){if(this.type==="color"){let w=wr(u),B=wr(m);for(let S=e;S<l;S++)this.paintVertexArray.emplace(S,w[0],w[1],B[0],B[1])}else{for(let w=e;w<l;w++)this.paintVertexArray.emplace(w,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,l){let u=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,m=at(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);e.set(m)}getBinding(e,l,u){return new vr(e,l)}}class Ir{constructor(e,l,u,m,w,B){this.expression=e,this.type=l,this.useIntegerZoom=u,this.zoom=m,this.layerId=B,this.zoomInPaintVertexArray=new w,this.zoomOutPaintVertexArray=new w}populatePaintArray(e,l,u){let m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(m,e,l.patterns&&l.patterns[this.layerId],u)}updatePaintArray(e,l,u,m,w){this._setPaintValues(e,l,u.patterns&&u.patterns[this.layerId],w)}_setPaintValues(e,l,u,m){if(!m||!u)return;let{min:w,mid:B,max:S}=u,Q=m[w],M=m[B],D=m[S];if(Q&&M&&D)for(let z=e;z<l;z++)this.zoomInPaintVertexArray.emplace(z,M.tl[0],M.tl[1],M.br[0],M.br[1],Q.tl[0],Q.tl[1],Q.br[0],Q.br[1],M.pixelRatio,Q.pixelRatio),this.zoomOutPaintVertexArray.emplace(z,M.tl[0],M.tl[1],M.br[0],M.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],M.pixelRatio,D.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,ge.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,ge.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Sn{constructor(e,l,u){this.binders={},this._buffers=[];let m=[];for(let w in e.paint._values){if(!u(w))continue;let B=e.paint.get(w);if(!(B instanceof Ao&&U(B.property.specification)))continue;let S=Br(w,e.type),Q=B.value,M=B.property.specification.type,D=B.property.useIntegerZoom,z=B.property.specification["property-type"],et=z==="cross-faded"||z==="cross-faded-data-driven";if(Q.kind==="constant")this.binders[w]=et?new rn(Q.value,S):new An(Q.value,S,M),m.push(`/u_${w}`);else if(Q.kind==="source"||et){let nt=pn(w,M,"source");this.binders[w]=et?new Ir(Q,M,D,l,nt,e.id):new ur(Q,S,M,nt),m.push(`/a_${w}`)}else{let nt=pn(w,M,"composite");this.binders[w]=new sr(Q,S,M,D,l,nt),m.push(`/z_${w}`)}}this.cacheKey=m.sort().join("")}getMaxValue(e){let l=this.binders[e];return l instanceof ur||l instanceof sr?l.maxValue:0}populatePaintArrays(e,l,u,m,w){for(let B in this.binders){let S=this.binders[B];(S instanceof ur||S instanceof sr||S instanceof Ir)&&S.populatePaintArray(e,l,u,m,w)}}setConstantPatternPositions(e,l){for(let u in this.binders){let m=this.binders[u];m instanceof rn&&m.setConstantPatternPositions(e,l)}}updatePaintArrays(e,l,u,m,w){let B=!1;for(let S in e){let Q=l.getPositions(S);for(let M of Q){let D=u.feature(M.index);for(let z in this.binders){let et=this.binders[z];if((et instanceof ur||et instanceof sr||et instanceof Ir)&&et.expression.isStateDependent===!0){let nt=m.paint.get(z);et.expression=nt.value,et.updatePaintArray(M.start,M.end,D,e[S],w),B=!0}}}}return B}defines(){let e=[];for(let l in this.binders){let u=this.binders[l];(u instanceof An||u instanceof rn)&&e.push(...u.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return e}getBinderAttributes(){let e=[];for(let l in this.binders){let u=this.binders[l];if(u instanceof ur||u instanceof sr)for(let m=0;m<u.paintVertexAttributes.length;m++)e.push(u.paintVertexAttributes[m].name);else if(u instanceof Ir)for(let m=0;m<ge.members.length;m++)e.push(ge.members[m].name)}return e}getBinderUniforms(){let e=[];for(let l in this.binders){let u=this.binders[l];if(u instanceof An||u instanceof rn||u instanceof sr)for(let m of u.uniformNames)e.push(m)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,l){let u=[];for(let m in this.binders){let w=this.binders[m];if(w instanceof An||w instanceof rn||w instanceof sr){for(let B of w.uniformNames)if(l[B]){let S=w.getBinding(e,l[B],B);u.push({name:B,property:m,binding:S})}}}return u}setUniforms(e,l,u,m){for(let{name:w,property:B,binding:S}of l)this.binders[B].setUniform(S,m,u.get(B),w)}updatePaintBuffers(e){this._buffers=[];for(let l in this.binders){let u=this.binders[l];if(e&&u instanceof Ir){let m=e.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(u instanceof ur||u instanceof sr)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(e){for(let l in this.binders){let u=this.binders[l];(u instanceof ur||u instanceof sr||u instanceof Ir)&&u.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let l=this.binders[e];(l instanceof ur||l instanceof sr||l instanceof Ir)&&l.destroy()}}}class _r{constructor(e,l,u=()=>!0){this.programConfigurations={};for(let m of e)this.programConfigurations[m.id]=new Sn(m,l,u);this.needsUpload=!1,this._featureMap=new Mi,this._bufferOffset=0}populatePaintArrays(e,l,u,m,w,B){for(let S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,l,m,w,B);l.id!==void 0&&this._featureMap.add(l.id,u,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,l,u,m){for(let w of u)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(e,this._featureMap,l,w,m)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let l in this.programConfigurations)this.programConfigurations[l].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Br(a,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${e}-`,"").replace(/-/g,"_")]}function pn(a,e,l){let u={color:{source:ul,composite:Ml},number:{source:uo,composite:ul}},m=function(w){return{"line-pattern":{source:P,composite:P},"fill-pattern":{source:P,composite:P},"fill-extrusion-pattern":{source:P,composite:P}}[w]}(a);return m&&m[l]||u[e][l]}si("ConstantBinder",An),si("CrossFadedConstantBinder",rn),si("SourceExpressionBinder",ur),si("CrossFadedCompositeBinder",Ir),si("CompositeExpressionBinder",sr),si("ProgramConfiguration",Sn,{omit:["_buffers"]}),si("ProgramConfigurationSet",_r);let $i=8192,ya=Math.pow(2,14)-1,na=-ya-1;function Zr(a){let e=$i/a.extent,l=a.loadGeometry();for(let u=0;u<l.length;u++){let m=l[u];for(let w=0;w<m.length;w++){let B=m[w],S=Math.round(B.x*e),Q=Math.round(B.y*e);B.x=at(S,na,ya),B.y=at(Q,na,ya),(S<B.x||S>B.x+1||Q<B.y||Q>B.y+1)&&At("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function sa(a,e){return{type:a.type,id:a.id,properties:a.properties,geometry:e?Zr(a):[]}}function dl(a,e,l,u,m){a.emplaceBack(2*e+(u+1)/2,2*l+(m+1)/2)}class Nl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new _,this.indexArray=new ut,this.segments=new Ct,this.programConfigurations=new _r(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(e,l,u){let m=this.layers[0],w=[],B=null,S=!1;m.type==="circle"&&(B=m.layout.get("circle-sort-key"),S=!B.isConstant());for(let{feature:Q,id:M,index:D,sourceLayerIndex:z}of e){let et=this.layers[0]._featureFilter.needGeometry,nt=sa(Q,et);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),nt,u))continue;let st=S?B.evaluate(nt,{},u):void 0,mt={id:M,properties:Q.properties,type:Q.type,sourceLayerIndex:z,index:D,geometry:et?nt.geometry:Zr(Q),patterns:{},sortKey:st};w.push(mt)}S&&w.sort((Q,M)=>Q.sortKey-M.sortKey);for(let Q of w){let{geometry:M,index:D,sourceLayerIndex:z}=Q,et=e[D].feature;this.addFeature(Q,M,D,u),l.featureIndex.insert(et,M,D,z,this.index)}}update(e,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,l,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gt),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,l,u,m){for(let w of l)for(let B of w){let S=B.x,Q=B.y;if(S<0||S>=$i||Q<0||Q>=$i)continue;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),D=M.vertexLength;dl(this.layoutVertexArray,S,Q,-1,-1),dl(this.layoutVertexArray,S,Q,1,-1),dl(this.layoutVertexArray,S,Q,1,1),dl(this.layoutVertexArray,S,Q,-1,1),this.indexArray.emplaceBack(D,D+1,D+2),this.indexArray.emplaceBack(D,D+3,D+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{},m)}}function Ro(a,e){for(let l=0;l<a.length;l++)if(Wa(e,a[l]))return!0;for(let l=0;l<e.length;l++)if(Wa(a,e[l]))return!0;return!!Ho(a,e)}function EA(a,e,l){return!!Wa(a,e)||!!QA(e,a,l)}function TA(a,e){if(a.length===1)return ph(e,a[0]);for(let l=0;l<e.length;l++){let u=e[l];for(let m=0;m<u.length;m++)if(Wa(a,u[m]))return!0}for(let l=0;l<a.length;l++)if(ph(e,a[l]))return!0;for(let l=0;l<e.length;l++)if(Ho(a,e[l]))return!0;return!1}function Ns(a,e,l){if(a.length>1){if(Ho(a,e))return!0;for(let u=0;u<e.length;u++)if(QA(e[u],a,l))return!0}for(let u=0;u<a.length;u++)if(QA(a[u],e,l))return!0;return!1}function Ho(a,e){if(a.length===0||e.length===0)return!1;for(let l=0;l<a.length-1;l++){let u=a[l],m=a[l+1];for(let w=0;w<e.length-1;w++)if(Ka(u,m,e[w],e[w+1]))return!0}return!1}function Ka(a,e,l,u){return lt(a,l,u)!==lt(e,l,u)&&lt(a,e,l)!==lt(a,e,u)}function QA(a,e,l){let u=l*l;if(e.length===1)return a.distSqr(e[0])<u;for(let m=1;m<e.length;m++)if(Fc(a,e[m-1],e[m])<u)return!0;return!1}function Fc(a,e,l){let u=e.distSqr(l);if(u===0)return a.distSqr(e);let m=((a.x-e.x)*(l.x-e.x)+(a.y-e.y)*(l.y-e.y))/u;return a.distSqr(m<0?e:m>1?l:l.sub(e)._mult(m)._add(e))}function ph(a,e){let l,u,m,w=!1;for(let B=0;B<a.length;B++){l=a[B];for(let S=0,Q=l.length-1;S<l.length;Q=S++)u=l[S],m=l[Q],u.y>e.y!=m.y>e.y&&e.x<(m.x-u.x)*(e.y-u.y)/(m.y-u.y)+u.x&&(w=!w)}return w}function Wa(a,e){let l=!1;for(let u=0,m=a.length-1;u<a.length;m=u++){let w=a[u],B=a[m];w.y>e.y!=B.y>e.y&&e.x<(B.x-w.x)*(e.y-w.y)/(B.y-w.y)+w.x&&(l=!l)}return l}function fh(a,e,l){let u=l[0],m=l[2];if(a.x<u.x&&e.x<u.x||a.x>m.x&&e.x>m.x||a.y<u.y&&e.y<u.y||a.y>m.y&&e.y>m.y)return!1;let w=lt(a,e,l[0]);return w!==lt(a,e,l[1])||w!==lt(a,e,l[2])||w!==lt(a,e,l[3])}function UA(a,e,l){let u=e.paint.get(a).value;return u.kind==="constant"?u.value:l.programConfigurations.get(e.id).getMaxValue(a)}function GA(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function lu(a,e,l,u,m){if(!e[0]&&!e[1])return a;let w=v.convert(e)._mult(m);l==="viewport"&&w._rotate(-u);let B=[];for(let S=0;S<a.length;S++)B.push(a[S].sub(w));return B}let zg,cu;si("CircleBucket",Nl,{omit:["layers"]});var RA={get paint(){return cu=cu||new Jn({"circle-radius":new Hi(xt.paint_circle["circle-radius"]),"circle-color":new Hi(xt.paint_circle["circle-color"]),"circle-blur":new Hi(xt.paint_circle["circle-blur"]),"circle-opacity":new Hi(xt.paint_circle["circle-opacity"]),"circle-translate":new wi(xt.paint_circle["circle-translate"]),"circle-translate-anchor":new wi(xt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wi(xt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wi(xt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Hi(xt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Hi(xt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Hi(xt.paint_circle["circle-stroke-opacity"])})},get layout(){return zg=zg||new Jn({"circle-sort-key":new Hi(xt.layout_circle["circle-sort-key"])})}},gs=1e-6,Vl=typeof Float32Array<"u"?Float32Array:Array;function mh(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Ch(a,e,l){var u=e[0],m=e[1],w=e[2],B=e[3],S=e[4],Q=e[5],M=e[6],D=e[7],z=e[8],et=e[9],nt=e[10],st=e[11],mt=e[12],St=e[13],Vt=e[14],oe=e[15],Wt=l[0],$t=l[1],ve=l[2],Le=l[3];return a[0]=Wt*u+$t*S+ve*z+Le*mt,a[1]=Wt*m+$t*Q+ve*et+Le*St,a[2]=Wt*w+$t*M+ve*nt+Le*Vt,a[3]=Wt*B+$t*D+ve*st+Le*oe,a[4]=(Wt=l[4])*u+($t=l[5])*S+(ve=l[6])*z+(Le=l[7])*mt,a[5]=Wt*m+$t*Q+ve*et+Le*St,a[6]=Wt*w+$t*M+ve*nt+Le*Vt,a[7]=Wt*B+$t*D+ve*st+Le*oe,a[8]=(Wt=l[8])*u+($t=l[9])*S+(ve=l[10])*z+(Le=l[11])*mt,a[9]=Wt*m+$t*Q+ve*et+Le*St,a[10]=Wt*w+$t*M+ve*nt+Le*Vt,a[11]=Wt*B+$t*D+ve*st+Le*oe,a[12]=(Wt=l[12])*u+($t=l[13])*S+(ve=l[14])*z+(Le=l[15])*mt,a[13]=Wt*m+$t*Q+ve*et+Le*St,a[14]=Wt*w+$t*M+ve*nt+Le*Vt,a[15]=Wt*B+$t*D+ve*st+Le*oe,a}Math.hypot||(Math.hypot=function(){for(var a=0,e=arguments.length;e--;)a+=arguments[e]*arguments[e];return Math.sqrt(a)});var HA,Jg=Ch;function kc(a,e,l){var u=e[0],m=e[1],w=e[2],B=e[3];return a[0]=l[0]*u+l[4]*m+l[8]*w+l[12]*B,a[1]=l[1]*u+l[5]*m+l[9]*w+l[13]*B,a[2]=l[2]*u+l[6]*m+l[10]*w+l[14]*B,a[3]=l[3]*u+l[7]*m+l[11]*w+l[15]*B,a}HA=new Vl(4),Vl!=Float32Array&&(HA[0]=0,HA[1]=0,HA[2]=0,HA[3]=0);class uu extends ns{constructor(e){super(e,RA)}createBucket(e){return new Nl(e)}queryRadius(e){let l=e;return UA("circle-radius",this,l)+UA("circle-stroke-width",this,l)+GA(this.paint.get("circle-translate"))}queryIntersectsFeature(e,l,u,m,w,B,S,Q){let M=lu(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),B.angle,S),D=this.paint.get("circle-radius").evaluate(l,u)+this.paint.get("circle-stroke-width").evaluate(l,u),z=this.paint.get("circle-pitch-alignment")==="map",et=z?M:function(st,mt){return st.map(St=>hu(St,mt))}(M,Q),nt=z?D*S:D;for(let st of m)for(let mt of st){let St=z?mt:hu(mt,Q),Vt=nt,oe=kc([],[mt.x,mt.y,0,1],Q);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Vt*=oe[3]/B.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Vt*=B.cameraToCenterDistance/oe[3]),EA(et,St,Vt))return!0}return!1}}function hu(a,e){let l=kc([],[a.x,a.y,0,1],e);return new v(l[0]/l[3],l[1]/l[3])}class Dl extends Nl{}let Ih;si("HeatmapBucket",Dl,{omit:["layers"]});var om={get paint(){return Ih=Ih||new Jn({"heatmap-radius":new Hi(xt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Hi(xt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wi(xt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ll(xt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wi(xt.paint_heatmap["heatmap-opacity"])})}};function Kl(a,{width:e,height:l},u,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==e*l*u)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${e*l*u}`)}else m=new Uint8Array(e*l*u);return a.width=e,a.height=l,a.data=m,a}function yh(a,{width:e,height:l},u){if(e===a.width&&l===a.height)return;let m=Kl({},{width:e,height:l},u);Lc(a,m,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,e),height:Math.min(a.height,l)},u),a.width=e,a.height=l,a.data=m.data}function Lc(a,e,l,u,m,w){if(m.width===0||m.height===0)return e;if(m.width>a.width||m.height>a.height||l.x>a.width-m.width||l.y>a.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>e.width||m.height>e.height||u.x>e.width-m.width||u.y>e.height-m.height)throw new RangeError("out of range destination coordinates for image copy");let B=a.data,S=e.data;if(B===S)throw new Error("srcData equals dstData, so image is already copied");for(let Q=0;Q<m.height;Q++){let M=((l.y+Q)*a.width+l.x)*w,D=((u.y+Q)*e.width+u.x)*w;for(let z=0;z<m.width*w;z++)S[D+z]=B[M+z]}return e}class Zo{constructor(e,l){Kl(this,e,1,l)}resize(e){yh(this,e,1)}clone(){return new Zo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,l,u,m,w){Lc(e,l,u,m,w,1)}}class Vs{constructor(e,l){Kl(this,e,4,l)}resize(e){yh(this,e,4)}replace(e,l){l?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Vs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,l,u,m,w){Lc(e,l,u,m,w,4)}}function bh(a){let e={},l=a.resolution||256,u=a.clips?a.clips.length:1,m=a.image||new Vs({width:l,height:u});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);let w=(B,S,Q)=>{e[a.evaluationKey]=Q;let M=a.expression.evaluate(e);m.data[B+S+0]=Math.floor(255*M.r/M.a),m.data[B+S+1]=Math.floor(255*M.g/M.a),m.data[B+S+2]=Math.floor(255*M.b/M.a),m.data[B+S+3]=Math.floor(255*M.a)};if(a.clips)for(let B=0,S=0;B<u;++B,S+=4*l)for(let Q=0,M=0;Q<l;Q++,M+=4){let D=Q/(l-1),{start:z,end:et}=a.clips[B];w(S,M,z*(1-D)+et*D)}else for(let B=0,S=0;B<l;B++,S+=4)w(0,S,B/(l-1));return m}si("AlphaImage",Zo),si("RGBAImage",Vs);class am extends ns{createBucket(e){return new Dl(e)}constructor(e){super(e,om),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=bh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let vh;var Wl={get paint(){return vh=vh||new Jn({"hillshade-illumination-direction":new wi(xt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wi(xt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wi(xt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wi(xt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wi(xt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wi(xt.paint_hillshade["hillshade-accent-color"])})}};class Am extends ns{constructor(e){super(e,Wl)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Xg=dn([{name:"a_pos",components:2,type:"Int16"}],4),{members:lm}=Xg;var gu={exports:{}};function du(a,e,l){l=l||2;var u,m,w,B,S,Q,M,D=e&&e.length,z=D?e[0]*l:a.length,et=Ol(a,0,z,l,!0),nt=[];if(!et||et.next===et.prev)return nt;if(D&&(et=function(mt,St,Vt,oe){var Wt,$t,ve,Le=[];for(Wt=0,$t=St.length;Wt<$t;Wt++)(ve=Ol(mt,St[Wt]*oe,Wt<$t-1?St[Wt+1]*oe:mt.length,oe,!1))===ve.next&&(ve.steiner=!0),Le.push(Bh(ve));for(Le.sort(wh),Wt=0;Wt<Le.length;Wt++)Vt=Yg(Le[Wt],Vt);return Vt}(a,e,et,l)),a.length>80*l){u=w=a[0],m=B=a[1];for(var st=l;st<z;st+=l)(S=a[st])<u&&(u=S),(Q=a[st+1])<m&&(m=Q),S>w&&(w=S),Q>B&&(B=Q);M=(M=Math.max(w-u,B-m))!==0?32767/M:0}return ZA(et,nt,l,u,m,M,0),nt}function Ol(a,e,l,u,m){var w,B;if(m===hm(a,e,l,u)>0)for(w=e;w<l;w+=u)B=zy(w,a[w],a[w+1],B);else for(w=l-u;w>=e;w-=u)B=zy(w,a[w],a[w+1],B);return B&&jg(B,B.next)&&(xh(B),B=B.next),B}function Oa(a,e){if(!a)return a;e||(e=a);var l,u=a;do if(l=!1,u.steiner||!jg(u,u.next)&&bn(u.prev,u,u.next)!==0)u=u.next;else{if(xh(u),(u=e=u.prev)===u.next)break;l=!0}while(l||u!==e);return e}function ZA(a,e,l,u,m,w,B){if(a){!B&&w&&function(D,z,et,nt){var st=D;do st.z===0&&(st.z=Ec(st.x,st.y,z,et,nt)),st.prevZ=st.prev,st.nextZ=st.next,st=st.next;while(st!==D);st.prevZ.nextZ=null,st.prevZ=null,function(mt){var St,Vt,oe,Wt,$t,ve,Le,ni,bi=1;do{for(Vt=mt,mt=null,$t=null,ve=0;Vt;){for(ve++,oe=Vt,Le=0,St=0;St<bi&&(Le++,oe=oe.nextZ);St++);for(ni=bi;Le>0||ni>0&&oe;)Le!==0&&(ni===0||!oe||Vt.z<=oe.z)?(Wt=Vt,Vt=Vt.nextZ,Le--):(Wt=oe,oe=oe.nextZ,ni--),$t?$t.nextZ=Wt:mt=Wt,Wt.prevZ=$t,$t=Wt;Vt=oe}$t.nextZ=null,bi*=2}while(ve>1)}(st)}(a,u,m,w);for(var S,Q,M=a;a.prev!==a.next;)if(S=a.prev,Q=a.next,w?PA(a,u,m,w):za(a))e.push(S.i/l|0),e.push(a.i/l|0),e.push(Q.i/l|0),xh(a),a=Q.next,M=Q.next;else if((a=Q)===M){B?B===1?ZA(a=MA(Oa(a),e,l),e,l,u,m,w,2):B===2&&pu(a,e,l,u,m,w):ZA(Oa(a),e,l,u,m,w,1);break}}}function za(a){var e=a.prev,l=a,u=a.next;if(bn(e,l,u)>=0)return!1;for(var m=e.x,w=l.x,B=u.x,S=e.y,Q=l.y,M=u.y,D=m<w?m<B?m:B:w<B?w:B,z=S<Q?S<M?S:M:Q<M?Q:M,et=m>w?m>B?m:B:w>B?w:B,nt=S>Q?S>M?S:M:Q>M?Q:M,st=u.next;st!==e;){if(st.x>=D&&st.x<=et&&st.y>=z&&st.y<=nt&&fu(m,S,w,Q,B,M,st.x,st.y)&&bn(st.prev,st,st.next)>=0)return!1;st=st.next}return!0}function PA(a,e,l,u){var m=a.prev,w=a,B=a.next;if(bn(m,w,B)>=0)return!1;for(var S=m.x,Q=w.x,M=B.x,D=m.y,z=w.y,et=B.y,nt=S<Q?S<M?S:M:Q<M?Q:M,st=D<z?D<et?D:et:z<et?z:et,mt=S>Q?S>M?S:M:Q>M?Q:M,St=D>z?D>et?D:et:z>et?z:et,Vt=Ec(nt,st,e,l,u),oe=Ec(mt,St,e,l,u),Wt=a.prevZ,$t=a.nextZ;Wt&&Wt.z>=Vt&&$t&&$t.z<=oe;){if(Wt.x>=nt&&Wt.x<=mt&&Wt.y>=st&&Wt.y<=St&&Wt!==m&&Wt!==B&&fu(S,D,Q,z,M,et,Wt.x,Wt.y)&&bn(Wt.prev,Wt,Wt.next)>=0||(Wt=Wt.prevZ,$t.x>=nt&&$t.x<=mt&&$t.y>=st&&$t.y<=St&&$t!==m&&$t!==B&&fu(S,D,Q,z,M,et,$t.x,$t.y)&&bn($t.prev,$t,$t.next)>=0))return!1;$t=$t.nextZ}for(;Wt&&Wt.z>=Vt;){if(Wt.x>=nt&&Wt.x<=mt&&Wt.y>=st&&Wt.y<=St&&Wt!==m&&Wt!==B&&fu(S,D,Q,z,M,et,Wt.x,Wt.y)&&bn(Wt.prev,Wt,Wt.next)>=0)return!1;Wt=Wt.prevZ}for(;$t&&$t.z<=oe;){if($t.x>=nt&&$t.x<=mt&&$t.y>=st&&$t.y<=St&&$t!==m&&$t!==B&&fu(S,D,Q,z,M,et,$t.x,$t.y)&&bn($t.prev,$t,$t.next)>=0)return!1;$t=$t.nextZ}return!0}function MA(a,e,l){var u=a;do{var m=u.prev,w=u.next.next;!jg(m,w)&&Wy(m,u,u.next,w)&&_h(m,w)&&_h(w,m)&&(e.push(m.i/l|0),e.push(u.i/l|0),e.push(w.i/l|0),xh(u),xh(u.next),u=a=w),u=u.next}while(u!==a);return Oa(u)}function pu(a,e,l,u,m,w){var B=a;do{for(var S=B.next.next;S!==B.prev;){if(B.i!==S.i&&K5(B,S)){var Q=Oy(B,S);return B=Oa(B,B.next),Q=Oa(Q,Q.next),ZA(B,e,l,u,m,w,0),void ZA(Q,e,l,u,m,w,0)}S=S.next}B=B.next}while(B!==a)}function wh(a,e){return a.x-e.x}function Yg(a,e){var l=function(m,w){var B,S=w,Q=m.x,M=m.y,D=-1/0;do{if(M<=S.y&&M>=S.next.y&&S.next.y!==S.y){var z=S.x+(M-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(z<=Q&&z>D&&(D=z,B=S.x<S.next.x?S:S.next,z===Q))return B}S=S.next}while(S!==w);if(!B)return null;var et,nt=B,st=B.x,mt=B.y,St=1/0;S=B;do Q>=S.x&&S.x>=st&&Q!==S.x&&fu(M<mt?Q:D,M,st,mt,M<mt?D:Q,M,S.x,S.y)&&(et=Math.abs(M-S.y)/(Q-S.x),_h(S,m)&&(et<St||et===St&&(S.x>B.x||S.x===B.x&&cm(B,S)))&&(B=S,St=et)),S=S.next;while(S!==nt);return B}(a,e);if(!l)return e;var u=Oy(l,a);return Oa(u,u.next),Oa(l,l.next)}function cm(a,e){return bn(a.prev,a,e.prev)<0&&bn(e.next,a,a.next)<0}function Ec(a,e,l,u,m){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-u)*m|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Bh(a){var e=a,l=a;do(e.x<l.x||e.x===l.x&&e.y<l.y)&&(l=e),e=e.next;while(e!==a);return l}function fu(a,e,l,u,m,w,B,S){return(m-B)*(e-S)>=(a-B)*(w-S)&&(a-B)*(u-S)>=(l-B)*(e-S)&&(l-B)*(w-S)>=(m-B)*(u-S)}function K5(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!function(l,u){var m=l;do{if(m.i!==l.i&&m.next.i!==l.i&&m.i!==u.i&&m.next.i!==u.i&&Wy(m,m.next,l,u))return!0;m=m.next}while(m!==l);return!1}(a,e)&&(_h(a,e)&&_h(e,a)&&function(l,u){var m=l,w=!1,B=(l.x+u.x)/2,S=(l.y+u.y)/2;do m.y>S!=m.next.y>S&&m.next.y!==m.y&&B<(m.next.x-m.x)*(S-m.y)/(m.next.y-m.y)+m.x&&(w=!w),m=m.next;while(m!==l);return w}(a,e)&&(bn(a.prev,a,e.prev)||bn(a,e.prev,e))||jg(a,e)&&bn(a.prev,a,a.next)>0&&bn(e.prev,e,e.next)>0)}function bn(a,e,l){return(e.y-a.y)*(l.x-e.x)-(e.x-a.x)*(l.y-e.y)}function jg(a,e){return a.x===e.x&&a.y===e.y}function Wy(a,e,l,u){var m=$g(bn(a,e,l)),w=$g(bn(a,e,u)),B=$g(bn(l,u,a)),S=$g(bn(l,u,e));return m!==w&&B!==S||!(m!==0||!qg(a,l,e))||!(w!==0||!qg(a,u,e))||!(B!==0||!qg(l,a,u))||!(S!==0||!qg(l,e,u))}function qg(a,e,l){return e.x<=Math.max(a.x,l.x)&&e.x>=Math.min(a.x,l.x)&&e.y<=Math.max(a.y,l.y)&&e.y>=Math.min(a.y,l.y)}function $g(a){return a>0?1:a<0?-1:0}function _h(a,e){return bn(a.prev,a,a.next)<0?bn(a,e,a.next)>=0&&bn(a,a.prev,e)>=0:bn(a,e,a.prev)<0||bn(a,a.next,e)<0}function Oy(a,e){var l=new um(a.i,a.x,a.y),u=new um(e.i,e.x,e.y),m=a.next,w=e.prev;return a.next=e,e.prev=a,l.next=m,m.prev=l,u.next=l,l.prev=u,w.next=u,u.prev=w,u}function zy(a,e,l,u){var m=new um(a,e,l);return u?(m.next=u.next,m.prev=u,u.next.prev=m,u.next=m):(m.prev=m,m.next=m),m}function xh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function um(a,e,l){this.i=a,this.x=e,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hm(a,e,l,u){for(var m=0,w=e,B=l-u;w<l;w+=u)m+=(a[B]-a[w])*(a[w+1]+a[B+1]),B=w;return m}gu.exports=du,gu.exports.default=du,du.deviation=function(a,e,l,u){var m=e&&e.length,w=Math.abs(hm(a,0,m?e[0]*l:a.length,l));if(m)for(var B=0,S=e.length;B<S;B++)w-=Math.abs(hm(a,e[B]*l,B<S-1?e[B+1]*l:a.length,l));var Q=0;for(B=0;B<u.length;B+=3){var M=u[B]*l,D=u[B+1]*l,z=u[B+2]*l;Q+=Math.abs((a[M]-a[z])*(a[D+1]-a[M+1])-(a[M]-a[D])*(a[z+1]-a[M+1]))}return w===0&&Q===0?0:Math.abs((Q-w)/w)},du.flatten=function(a){for(var e=a[0][0].length,l={vertices:[],holes:[],dimensions:e},u=0,m=0;m<a.length;m++){for(var w=0;w<a[m].length;w++)for(var B=0;B<e;B++)l.vertices.push(a[m][w][B]);m>0&&l.holes.push(u+=a[m-1].length)}return l};var Jy=g(gu.exports);function W5(a,e,l,u,m){Xy(a,e,l||0,u||a.length-1,m||O5)}function Xy(a,e,l,u,m){for(;u>l;){if(u-l>600){var w=u-l+1,B=e-l+1,S=Math.log(w),Q=.5*Math.exp(2*S/3),M=.5*Math.sqrt(S*Q*(w-Q)/w)*(B-w/2<0?-1:1);Xy(a,e,Math.max(l,Math.floor(e-B*Q/w+M)),Math.min(u,Math.floor(e+(w-B)*Q/w+M)),m)}var D=a[e],z=l,et=u;for(Sh(a,l,e),m(a[u],D)>0&&Sh(a,l,u);z<et;){for(Sh(a,z,et),z++,et--;m(a[z],D)<0;)z++;for(;m(a[et],D)>0;)et--}m(a[l],D)===0?Sh(a,l,et):Sh(a,++et,u),et<=e&&(l=et+1),e<=et&&(u=et-1)}}function Sh(a,e,l){var u=a[e];a[e]=a[l],a[l]=u}function O5(a,e){return a<e?-1:a>e?1:0}function gm(a,e){let l=a.length;if(l<=1)return[a];let u=[],m,w;for(let B=0;B<l;B++){let S=kt(a[B]);S!==0&&(a[B].area=Math.abs(S),w===void 0&&(w=S<0),w===S<0?(m&&u.push(m),m=[a[B]]):m.push(a[B]))}if(m&&u.push(m),e>1)for(let B=0;B<u.length;B++)u[B].length<=e||(W5(u[B],e,1,u[B].length-1,z5),u[B]=u[B].slice(0,e));return u}function z5(a,e){return e.area-a.area}function dm(a,e,l){let u=l.patternDependencies,m=!1;for(let w of e){let B=w.paint.get(`${a}-pattern`);B.isConstant()||(m=!0);let S=B.constantOr(null);S&&(m=!0,u[S.to]=!0,u[S.from]=!0)}return m}function pm(a,e,l,u,m){let w=m.patternDependencies;for(let B of e){let S=B.paint.get(`${a}-pattern`).value;if(S.kind!=="constant"){let Q=S.evaluate({zoom:u-1},l,{},m.availableImages),M=S.evaluate({zoom:u},l,{},m.availableImages),D=S.evaluate({zoom:u+1},l,{},m.availableImages);Q=Q&&Q.name?Q.name:Q,M=M&&M.name?M.name:M,D=D&&D.name?D.name:D,w[Q]=!0,w[M]=!0,w[D]=!0,l.patterns[B.id]={min:Q,mid:M,max:D}}}return l}class fm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new F,this.indexArray=new ut,this.indexArray2=new Gt,this.programConfigurations=new _r(e.layers,e.zoom),this.segments=new Ct,this.segments2=new Ct,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(e,l,u){this.hasPattern=dm("fill",this.layers,l);let m=this.layers[0].layout.get("fill-sort-key"),w=!m.isConstant(),B=[];for(let{feature:S,id:Q,index:M,sourceLayerIndex:D}of e){let z=this.layers[0]._featureFilter.needGeometry,et=sa(S,z);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),et,u))continue;let nt=w?m.evaluate(et,{},u,l.availableImages):void 0,st={id:Q,properties:S.properties,type:S.type,sourceLayerIndex:D,index:M,geometry:z?et.geometry:Zr(S),patterns:{},sortKey:nt};B.push(st)}w&&B.sort((S,Q)=>S.sortKey-Q.sortKey);for(let S of B){let{geometry:Q,index:M,sourceLayerIndex:D}=S;if(this.hasPattern){let z=pm("fill",this.layers,S,this.zoom,l);this.patternFeatures.push(z)}else this.addFeature(S,Q,M,u,{});l.featureIndex.insert(e[M].feature,Q,M,D,this.index)}}update(e,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,l,this.stateDependentLayers,u)}addFeatures(e,l,u){for(let m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,lm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,l,u,m,w){for(let B of gm(l,500)){let S=0;for(let nt of B)S+=nt.length;let Q=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),M=Q.vertexLength,D=[],z=[];for(let nt of B){if(nt.length===0)continue;nt!==B[0]&&z.push(D.length/2);let st=this.segments2.prepareSegment(nt.length,this.layoutVertexArray,this.indexArray2),mt=st.vertexLength;this.layoutVertexArray.emplaceBack(nt[0].x,nt[0].y),this.indexArray2.emplaceBack(mt+nt.length-1,mt),D.push(nt[0].x),D.push(nt[0].y);for(let St=1;St<nt.length;St++)this.layoutVertexArray.emplaceBack(nt[St].x,nt[St].y),this.indexArray2.emplaceBack(mt+St-1,mt+St),D.push(nt[St].x),D.push(nt[St].y);st.vertexLength+=nt.length,st.primitiveLength+=nt.length}let et=Jy(D,z);for(let nt=0;nt<et.length;nt+=3)this.indexArray.emplaceBack(M+et[nt],M+et[nt+1],M+et[nt+2]);Q.vertexLength+=S,Q.primitiveLength+=et.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,w,m)}}let Yy,jy;si("FillBucket",fm,{omit:["layers","patternFeatures"]});var J5={get paint(){return jy=jy||new Jn({"fill-antialias":new wi(xt.paint_fill["fill-antialias"]),"fill-opacity":new Hi(xt.paint_fill["fill-opacity"]),"fill-color":new Hi(xt.paint_fill["fill-color"]),"fill-outline-color":new Hi(xt.paint_fill["fill-outline-color"]),"fill-translate":new wi(xt.paint_fill["fill-translate"]),"fill-translate-anchor":new wi(xt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Na(xt.paint_fill["fill-pattern"])})},get layout(){return Yy=Yy||new Jn({"fill-sort-key":new Hi(xt.layout_fill["fill-sort-key"])})}};class X5 extends ns{constructor(e){super(e,J5)}recalculate(e,l){super.recalculate(e,l);let u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new fm(e)}queryRadius(){return GA(this.paint.get("fill-translate"))}queryIntersectsFeature(e,l,u,m,w,B,S){return TA(lu(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),B.angle,S),m)}isTileClipped(){return!0}}let Y5=dn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),j5=dn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:q5}=Y5;var zl={},$5=d,qy=mu;function mu(a,e,l,u,m){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=u,this._values=m,a.readFields(tS,this,e)}function tS(a,e,l){a==1?e.id=l.readVarint():a==2?function(u,m){for(var w=u.readVarint()+u.pos;u.pos<w;){var B=m._keys[u.readVarint()],S=m._values[u.readVarint()];m.properties[B]=S}}(l,e):a==3?e.type=l.readVarint():a==4&&(e._geometry=l.pos)}function eS(a){for(var e,l,u=0,m=0,w=a.length,B=w-1;m<w;B=m++)u+=((l=a[B]).x-(e=a[m]).x)*(e.y+l.y);return u}mu.types=["Unknown","Point","LineString","Polygon"],mu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var e,l=a.readVarint()+a.pos,u=1,m=0,w=0,B=0,S=[];a.pos<l;){if(m<=0){var Q=a.readVarint();u=7&Q,m=Q>>3}if(m--,u===1||u===2)w+=a.readSVarint(),B+=a.readSVarint(),u===1&&(e&&S.push(e),e=[]),e.push(new $5(w,B));else{if(u!==7)throw new Error("unknown command "+u);e&&e.push(e[0].clone())}}return e&&S.push(e),S},mu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var e=a.readVarint()+a.pos,l=1,u=0,m=0,w=0,B=1/0,S=-1/0,Q=1/0,M=-1/0;a.pos<e;){if(u<=0){var D=a.readVarint();l=7&D,u=D>>3}if(u--,l===1||l===2)(m+=a.readSVarint())<B&&(B=m),m>S&&(S=m),(w+=a.readSVarint())<Q&&(Q=w),w>M&&(M=w);else if(l!==7)throw new Error("unknown command "+l)}return[B,Q,S,M]},mu.prototype.toGeoJSON=function(a,e,l){var u,m,w=this.extent*Math.pow(2,l),B=this.extent*a,S=this.extent*e,Q=this.loadGeometry(),M=mu.types[this.type];function D(nt){for(var st=0;st<nt.length;st++){var mt=nt[st];nt[st]=[360*(mt.x+B)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(mt.y+S)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(u=0;u<Q.length;u++)z[u]=Q[u][0];D(Q=z);break;case 2:for(u=0;u<Q.length;u++)D(Q[u]);break;case 3:for(Q=function(nt){var st=nt.length;if(st<=1)return[nt];for(var mt,St,Vt=[],oe=0;oe<st;oe++){var Wt=eS(nt[oe]);Wt!==0&&(St===void 0&&(St=Wt<0),St===Wt<0?(mt&&Vt.push(mt),mt=[nt[oe]]):mt.push(nt[oe]))}return mt&&Vt.push(mt),Vt}(Q),u=0;u<Q.length;u++)for(m=0;m<Q[u].length;m++)D(Q[u][m])}Q.length===1?Q=Q[0]:M="Multi"+M;var et={type:"Feature",geometry:{type:M,coordinates:Q},properties:this.properties};return"id"in this&&(et.id=this.id),et};var iS=qy,$y=t1;function t1(a,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(rS,this,e),this.length=this._features.length}function rS(a,e,l){a===15?e.version=l.readVarint():a===1?e.name=l.readString():a===5?e.extent=l.readVarint():a===2?e._features.push(l.pos):a===3?e._keys.push(l.readString()):a===4&&e._values.push(function(u){for(var m=null,w=u.readVarint()+u.pos;u.pos<w;){var B=u.readVarint()>>3;m=B===1?u.readString():B===2?u.readFloat():B===3?u.readDouble():B===4?u.readVarint64():B===5?u.readVarint():B===6?u.readSVarint():B===7?u.readBoolean():null}return m}(l))}t1.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var e=this._pbf.readVarint()+this._pbf.pos;return new iS(this._pbf,e,this.extent,this._keys,this._values)};var nS=$y;function sS(a,e,l){if(a===3){var u=new nS(l,l.readVarint()+l.pos);u.length&&(e[u.name]=u)}}zl.VectorTile=function(a,e){this.layers=a.readFields(sS,{},e)},zl.VectorTileFeature=qy,zl.VectorTileLayer=$y;let oS=zl.VectorTileFeature.types,mm=Math.pow(2,13);function Fh(a,e,l,u,m,w,B,S){a.emplaceBack(e,l,2*Math.floor(u*mm)+B,m*mm*2,w*mm*2,Math.round(S))}class Cm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new R,this.centroidVertexArray=new I,this.indexArray=new ut,this.programConfigurations=new _r(e.layers,e.zoom),this.segments=new Ct,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(e,l,u){this.features=[],this.hasPattern=dm("fill-extrusion",this.layers,l);for(let{feature:m,id:w,index:B,sourceLayerIndex:S}of e){let Q=this.layers[0]._featureFilter.needGeometry,M=sa(m,Q);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),M,u))continue;let D={id:w,sourceLayerIndex:S,index:B,geometry:Q?M.geometry:Zr(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(pm("fill-extrusion",this.layers,D,this.zoom,l)):this.addFeature(D,D.geometry,B,u,{}),l.featureIndex.insert(m,D.geometry,B,S,this.index,!0)}}addFeatures(e,l,u){for(let m of this.features){let{geometry:w}=m;this.addFeature(m,w,m.index,l,u)}}update(e,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,l,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,q5),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,j5.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,l,u,m,w){let B={x:0,y:0,vertexCount:0};for(let S of gm(l,500)){let Q=0;for(let st of S)Q+=st.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let st of S){if(st.length===0||AS(st))continue;let mt=0;for(let St=0;St<st.length;St++){let Vt=st[St];if(St>=1){let oe=st[St-1];if(!aS(Vt,oe)){M.vertexLength+4>Ct.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let Wt=Vt.sub(oe)._perp()._unit(),$t=oe.dist(Vt);mt+$t>32768&&(mt=0),Fh(this.layoutVertexArray,Vt.x,Vt.y,Wt.x,Wt.y,0,0,mt),Fh(this.layoutVertexArray,Vt.x,Vt.y,Wt.x,Wt.y,0,1,mt),B.x+=2*Vt.x,B.y+=2*Vt.y,B.vertexCount+=2,mt+=$t,Fh(this.layoutVertexArray,oe.x,oe.y,Wt.x,Wt.y,0,0,mt),Fh(this.layoutVertexArray,oe.x,oe.y,Wt.x,Wt.y,0,1,mt),B.x+=2*oe.x,B.y+=2*oe.y,B.vertexCount+=2;let ve=M.vertexLength;this.indexArray.emplaceBack(ve,ve+2,ve+1),this.indexArray.emplaceBack(ve+1,ve+2,ve+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+Q>Ct.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(Q,this.layoutVertexArray,this.indexArray)),oS[e.type]!=="Polygon")continue;let D=[],z=[],et=M.vertexLength;for(let st of S)if(st.length!==0){st!==S[0]&&z.push(D.length/2);for(let mt=0;mt<st.length;mt++){let St=st[mt];Fh(this.layoutVertexArray,St.x,St.y,0,0,1,1,0),B.x+=St.x,B.y+=St.y,B.vertexCount+=1,D.push(St.x),D.push(St.y)}}let nt=Jy(D,z);for(let st=0;st<nt.length;st+=3)this.indexArray.emplaceBack(et+nt[st],et+nt[st+2],et+nt[st+1]);M.primitiveLength+=nt.length/3,M.vertexLength+=Q}for(let S=0;S<B.vertexCount;S++)this.centroidVertexArray.emplaceBack(Math.floor(B.x/B.vertexCount),Math.floor(B.y/B.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,w,m)}}function aS(a,e){return a.x===e.x&&(a.x<0||a.x>$i)||a.y===e.y&&(a.y<0||a.y>$i)}function AS(a){return a.every(e=>e.x<0)||a.every(e=>e.x>$i)||a.every(e=>e.y<0)||a.every(e=>e.y>$i)}let e1;si("FillExtrusionBucket",Cm,{omit:["layers","features"]});var lS={get paint(){return e1=e1||new Jn({"fill-extrusion-opacity":new wi(xt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Hi(xt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wi(xt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wi(xt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Na(xt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Hi(xt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Hi(xt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wi(xt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class cS extends ns{constructor(e){super(e,lS)}createBucket(e){return new Cm(e)}queryRadius(){return GA(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,l,u,m,w,B,S,Q){let M=lu(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),B.angle,S),D=this.paint.get("fill-extrusion-height").evaluate(l,u),z=this.paint.get("fill-extrusion-base").evaluate(l,u),et=function(st,mt,St,Vt){let oe=[];for(let Wt of st){let $t=[Wt.x,Wt.y,0,1];kc($t,$t,mt),oe.push(new v($t[0]/$t[3],$t[1]/$t[3]))}return oe}(M,Q),nt=function(st,mt,St,Vt){let oe=[],Wt=[],$t=Vt[8]*mt,ve=Vt[9]*mt,Le=Vt[10]*mt,ni=Vt[11]*mt,bi=Vt[8]*St,ri=Vt[9]*St,ti=Vt[10]*St,Oe=Vt[11]*St;for(let fi of st){let qe=[],Ze=[];for(let Gi of fi){let Bi=Gi.x,hr=Gi.y,jr=Vt[0]*Bi+Vt[4]*hr+Vt[12],nn=Vt[1]*Bi+Vt[5]*hr+Vt[13],kn=Vt[2]*Bi+Vt[6]*hr+Vt[14],Po=Vt[3]*Bi+Vt[7]*hr+Vt[15],Ds=kn+Le,wn=Po+ni,os=jr+bi,ps=nn+ri,Ks=kn+ti,Ws=Po+Oe,Ln=new v((jr+$t)/wn,(nn+ve)/wn);Ln.z=Ds/wn,qe.push(Ln);let En=new v(os/Ws,ps/Ws);En.z=Ks/Ws,Ze.push(En)}oe.push(qe),Wt.push(Ze)}return[oe,Wt]}(m,z,D,Q);return function(st,mt,St){let Vt=1/0;TA(St,mt)&&(Vt=i1(St,mt[0]));for(let oe=0;oe<mt.length;oe++){let Wt=mt[oe],$t=st[oe];for(let ve=0;ve<Wt.length-1;ve++){let Le=Wt[ve],ni=[Le,Wt[ve+1],$t[ve+1],$t[ve],Le];Ro(St,ni)&&(Vt=Math.min(Vt,i1(St,ni)))}}return Vt!==1/0&&Vt}(nt[0],nt[1],et)}}function kh(a,e){return a.x*e.x+a.y*e.y}function i1(a,e){if(a.length===1){let l=0,u=e[l++],m;for(;!m||u.equals(m);)if(m=e[l++],!m)return 1/0;for(;l<e.length;l++){let w=e[l],B=a[0],S=m.sub(u),Q=w.sub(u),M=B.sub(u),D=kh(S,S),z=kh(S,Q),et=kh(Q,Q),nt=kh(M,S),st=kh(M,Q),mt=D*et-z*z,St=(et*nt-z*st)/mt,Vt=(D*st-z*nt)/mt,oe=u.z*(1-St-Vt)+m.z*St+w.z*Vt;if(isFinite(oe))return oe}return 1/0}{let l=1/0;for(let u of e)l=Math.min(l,u.z);return l}}let uS=dn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:hS}=uS,gS=dn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:dS}=gS,pS=zl.VectorTileFeature.types,fS=Math.cos(Math.PI/180*37.5),r1=Math.pow(2,14)/.5;class Im{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Z,this.layoutVertexArray2=new N,this.indexArray=new ut,this.programConfigurations=new _r(e.layers,e.zoom),this.segments=new Ct,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(e,l,u){this.hasPattern=dm("line",this.layers,l);let m=this.layers[0].layout.get("line-sort-key"),w=!m.isConstant(),B=[];for(let{feature:S,id:Q,index:M,sourceLayerIndex:D}of e){let z=this.layers[0]._featureFilter.needGeometry,et=sa(S,z);if(!this.layers[0]._featureFilter.filter(new Hr(this.zoom),et,u))continue;let nt=w?m.evaluate(et,{},u):void 0,st={id:Q,properties:S.properties,type:S.type,sourceLayerIndex:D,index:M,geometry:z?et.geometry:Zr(S),patterns:{},sortKey:nt};B.push(st)}w&&B.sort((S,Q)=>S.sortKey-Q.sortKey);for(let S of B){let{geometry:Q,index:M,sourceLayerIndex:D}=S;if(this.hasPattern){let z=pm("line",this.layers,S,this.zoom,l);this.patternFeatures.push(z)}else this.addFeature(S,Q,M,u,{});l.featureIndex.insert(e[M].feature,Q,M,D,this.index)}}update(e,l,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,l,this.stateDependentLayers,u)}addFeatures(e,l,u){for(let m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,dS)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hS),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,l,u,m,w){let B=this.layers[0].layout,S=B.get("line-join").evaluate(e,{}),Q=B.get("line-cap"),M=B.get("line-miter-limit"),D=B.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let z of l)this.addLine(z,e,S,Q,M,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,w,m)}addLine(e,l,u,m,w,B){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Vt=0;Vt<e.length-1;Vt++)this.totalDistance+=e[Vt].dist(e[Vt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let S=pS[l.type]==="Polygon",Q=e.length;for(;Q>=2&&e[Q-1].equals(e[Q-2]);)Q--;let M=0;for(;M<Q-1&&e[M].equals(e[M+1]);)M++;if(Q<(S?3:2))return;u==="bevel"&&(w=1.05);let D=this.overscaling<=16?15*$i/(512*this.overscaling):0,z=this.segments.prepareSegment(10*Q,this.layoutVertexArray,this.indexArray),et,nt,st,mt,St;this.e1=this.e2=-1,S&&(et=e[Q-2],St=e[M].sub(et)._unit()._perp());for(let Vt=M;Vt<Q;Vt++){if(st=Vt===Q-1?S?e[M+1]:void 0:e[Vt+1],st&&e[Vt].equals(st))continue;St&&(mt=St),et&&(nt=et),et=e[Vt],St=st?st.sub(et)._unit()._perp():mt,mt=mt||St;let oe=mt.add(St);oe.x===0&&oe.y===0||oe._unit();let Wt=mt.x*St.x+mt.y*St.y,$t=oe.x*St.x+oe.y*St.y,ve=$t!==0?1/$t:1/0,Le=2*Math.sqrt(2-2*$t),ni=$t<fS&&nt&&st,bi=mt.x*St.y-mt.y*St.x>0;if(ni&&Vt>M){let Oe=et.dist(nt);if(Oe>2*D){let fi=et.sub(et.sub(nt)._mult(D/Oe)._round());this.updateDistance(nt,fi),this.addCurrentVertex(fi,mt,0,0,z),nt=fi}}let ri=nt&&st,ti=ri?u:S?"butt":m;if(ri&&ti==="round"&&(ve<B?ti="miter":ve<=2&&(ti="fakeround")),ti==="miter"&&ve>w&&(ti="bevel"),ti==="bevel"&&(ve>2&&(ti="flipbevel"),ve<w&&(ti="miter")),nt&&this.updateDistance(nt,et),ti==="miter")oe._mult(ve),this.addCurrentVertex(et,oe,0,0,z);else if(ti==="flipbevel"){if(ve>100)oe=St.mult(-1);else{let Oe=ve*mt.add(St).mag()/mt.sub(St).mag();oe._perp()._mult(Oe*(bi?-1:1))}this.addCurrentVertex(et,oe,0,0,z),this.addCurrentVertex(et,oe.mult(-1),0,0,z)}else if(ti==="bevel"||ti==="fakeround"){let Oe=-Math.sqrt(ve*ve-1),fi=bi?Oe:0,qe=bi?0:Oe;if(nt&&this.addCurrentVertex(et,mt,fi,qe,z),ti==="fakeround"){let Ze=Math.round(180*Le/Math.PI/20);for(let Gi=1;Gi<Ze;Gi++){let Bi=Gi/Ze;if(Bi!==.5){let jr=Bi-.5;Bi+=Bi*jr*(Bi-1)*((1.0904+Wt*(Wt*(3.55645-1.43519*Wt)-3.2452))*jr*jr+(.848013+Wt*(.215638*Wt-1.06021)))}let hr=St.sub(mt)._mult(Bi)._add(mt)._unit()._mult(bi?-1:1);this.addHalfVertex(et,hr.x,hr.y,!1,bi,0,z)}}st&&this.addCurrentVertex(et,St,-fi,-qe,z)}else if(ti==="butt")this.addCurrentVertex(et,oe,0,0,z);else if(ti==="square"){let Oe=nt?1:-1;this.addCurrentVertex(et,oe,Oe,Oe,z)}else ti==="round"&&(nt&&(this.addCurrentVertex(et,mt,0,0,z),this.addCurrentVertex(et,mt,1,1,z,!0)),st&&(this.addCurrentVertex(et,St,-1,-1,z,!0),this.addCurrentVertex(et,St,0,0,z)));if(ni&&Vt<Q-1){let Oe=et.dist(st);if(Oe>2*D){let fi=et.add(st.sub(et)._mult(D/Oe)._round());this.updateDistance(et,fi),this.addCurrentVertex(fi,St,0,0,z),et=fi}}}}addCurrentVertex(e,l,u,m,w,B=!1){let S=l.y*m-l.x,Q=-l.y-l.x*m;this.addHalfVertex(e,l.x+l.y*u,l.y-l.x*u,B,!1,u,w),this.addHalfVertex(e,S,Q,B,!0,-m,w),this.distance>r1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,l,u,m,w,B))}addHalfVertex({x:e,y:l},u,m,w,B,S,Q){let M=.5*(this.lineClips?this.scaledDistance*(r1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(w?1:0),(l<<1)+(B?1:0),Math.round(63*u)+128,Math.round(63*m)+128,1+(S===0?0:S<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let D=Q.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),Q.primitiveLength++),B?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,l){this.distance+=e.dist(l),this.updateScaledDistance()}}let n1,s1;si("LineBucket",Im,{omit:["layers","patternFeatures"]});var o1={get paint(){return s1=s1||new Jn({"line-opacity":new Hi(xt.paint_line["line-opacity"]),"line-color":new Hi(xt.paint_line["line-color"]),"line-translate":new wi(xt.paint_line["line-translate"]),"line-translate-anchor":new wi(xt.paint_line["line-translate-anchor"]),"line-width":new Hi(xt.paint_line["line-width"]),"line-gap-width":new Hi(xt.paint_line["line-gap-width"]),"line-offset":new Hi(xt.paint_line["line-offset"]),"line-blur":new Hi(xt.paint_line["line-blur"]),"line-dasharray":new wc(xt.paint_line["line-dasharray"]),"line-pattern":new Na(xt.paint_line["line-pattern"]),"line-gradient":new ll(xt.paint_line["line-gradient"])})},get layout(){return n1=n1||new Jn({"line-cap":new wi(xt.layout_line["line-cap"]),"line-join":new Hi(xt.layout_line["line-join"]),"line-miter-limit":new wi(xt.layout_line["line-miter-limit"]),"line-round-limit":new wi(xt.layout_line["line-round-limit"]),"line-sort-key":new Hi(xt.layout_line["line-sort-key"])})}};class mS extends Hi{possiblyEvaluate(e,l){return l=new Hr(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(e,l)}evaluate(e,l,u,m){return l=Tt({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(e,l,u,m)}}let td;class CS extends ns{constructor(e){super(e,o1),this.gradientVersion=0,td||(td=new mS(o1.paint.properties["line-width"].specification),td.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let l=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(l)&&l._styleExpression.expression instanceof _o,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,l){super.recalculate(e,l),this.paint._values["line-floorwidth"]=td.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Im(e)}queryRadius(e){let l=e,u=a1(UA("line-width",this,l),UA("line-gap-width",this,l)),m=UA("line-offset",this,l);return u/2+Math.abs(m)+GA(this.paint.get("line-translate"))}queryIntersectsFeature(e,l,u,m,w,B,S){let Q=lu(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),B.angle,S),M=S/2*a1(this.paint.get("line-width").evaluate(l,u),this.paint.get("line-gap-width").evaluate(l,u)),D=this.paint.get("line-offset").evaluate(l,u);return D&&(m=function(z,et){let nt=[];for(let st=0;st<z.length;st++){let mt=z[st],St=[];for(let Vt=0;Vt<mt.length;Vt++){let oe=mt[Vt-1],Wt=mt[Vt],$t=mt[Vt+1],ve=Vt===0?new v(0,0):Wt.sub(oe)._unit()._perp(),Le=Vt===mt.length-1?new v(0,0):$t.sub(Wt)._unit()._perp(),ni=ve._add(Le)._unit(),bi=ni.x*Le.x+ni.y*Le.y;bi!==0&&ni._mult(1/bi),St.push(ni._mult(et)._add(Wt))}nt.push(St)}return nt}(m,D*S)),function(z,et,nt){for(let st=0;st<et.length;st++){let mt=et[st];if(z.length>=3){for(let St=0;St<mt.length;St++)if(Wa(z,mt[St]))return!0}if(Ns(z,mt,nt))return!0}return!1}(Q,m,M)}isTileClipped(){return!0}}function a1(a,e){return e>0?e+2*a:a}let IS=dn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),yS=dn([{name:"a_projected_pos",components:3,type:"Float32"}],4);dn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let bS=dn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);dn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let A1=dn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),vS=dn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function wS(a,e,l){return a.sections.forEach(u=>{u.text=function(m,w,B){let S=w.layout.get("text-transform").evaluate(B,{});return S==="uppercase"?m=m.toLocaleUpperCase():S==="lowercase"&&(m=m.toLocaleLowerCase()),Go.applyArabicShaping&&(m=Go.applyArabicShaping(m)),m}(u.text,e,l)}),a}dn([{name:"triangle",components:3,type:"Uint16"}]),dn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),dn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),dn([{type:"Float32",name:"offsetX"}]),dn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),dn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let Lh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var Fn=24,l1=Dr,c1=function(a,e,l,u,m){var w,B,S=8*m-u-1,Q=(1<<S)-1,M=Q>>1,D=-7,z=l?m-1:0,et=l?-1:1,nt=a[e+z];for(z+=et,w=nt&(1<<-D)-1,nt>>=-D,D+=S;D>0;w=256*w+a[e+z],z+=et,D-=8);for(B=w&(1<<-D)-1,w>>=-D,D+=u;D>0;B=256*B+a[e+z],z+=et,D-=8);if(w===0)w=1-M;else{if(w===Q)return B?NaN:1/0*(nt?-1:1);B+=Math.pow(2,u),w-=M}return(nt?-1:1)*B*Math.pow(2,w-u)},u1=function(a,e,l,u,m,w){var B,S,Q,M=8*w-m-1,D=(1<<M)-1,z=D>>1,et=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,nt=u?0:w-1,st=u?1:-1,mt=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(S=isNaN(e)?1:0,B=D):(B=Math.floor(Math.log(e)/Math.LN2),e*(Q=Math.pow(2,-B))<1&&(B--,Q*=2),(e+=B+z>=1?et/Q:et*Math.pow(2,1-z))*Q>=2&&(B++,Q/=2),B+z>=D?(S=0,B=D):B+z>=1?(S=(e*Q-1)*Math.pow(2,m),B+=z):(S=e*Math.pow(2,z-1)*Math.pow(2,m),B=0));m>=8;a[l+nt]=255&S,nt+=st,S/=256,m-=8);for(B=B<<m|S,M+=m;M>0;a[l+nt]=255&B,nt+=st,B/=256,M-=8);a[l+nt-st]|=128*mt};function Dr(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Dr.Varint=0,Dr.Fixed64=1,Dr.Bytes=2,Dr.Fixed32=5;var ym=4294967296,h1=1/ym,g1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function pl(a){return a.type===Dr.Bytes?a.readVarint()+a.pos:a.pos+1}function Cu(a,e,l){return l?4294967296*e+(a>>>0):4294967296*(e>>>0)+(a>>>0)}function d1(a,e,l){var u=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));l.realloc(u);for(var m=l.pos-1;m>=a;m--)l.buf[m+u]=l.buf[m]}function BS(a,e){for(var l=0;l<a.length;l++)e.writeVarint(a[l])}function _S(a,e){for(var l=0;l<a.length;l++)e.writeSVarint(a[l])}function xS(a,e){for(var l=0;l<a.length;l++)e.writeFloat(a[l])}function SS(a,e){for(var l=0;l<a.length;l++)e.writeDouble(a[l])}function FS(a,e){for(var l=0;l<a.length;l++)e.writeBoolean(a[l])}function kS(a,e){for(var l=0;l<a.length;l++)e.writeFixed32(a[l])}function LS(a,e){for(var l=0;l<a.length;l++)e.writeSFixed32(a[l])}function ES(a,e){for(var l=0;l<a.length;l++)e.writeFixed64(a[l])}function TS(a,e){for(var l=0;l<a.length;l++)e.writeSFixed64(a[l])}function ed(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+16777216*a[e+3]}function Iu(a,e,l){a[l]=e,a[l+1]=e>>>8,a[l+2]=e>>>16,a[l+3]=e>>>24}function p1(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+(a[e+3]<<24)}Dr.prototype={destroy:function(){this.buf=null},readFields:function(a,e,l){for(l=l||this.length;this.pos<l;){var u=this.readVarint(),m=u>>3,w=this.pos;this.type=7&u,a(m,e,this),this.pos===w&&this.skip(u)}return e},readMessage:function(a,e){return this.readFields(a,e,this.readVarint()+this.pos)},readFixed32:function(){var a=ed(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=p1(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=ed(this.buf,this.pos)+ed(this.buf,this.pos+4)*ym;return this.pos+=8,a},readSFixed64:function(){var a=ed(this.buf,this.pos)+p1(this.buf,this.pos+4)*ym;return this.pos+=8,a},readFloat:function(){var a=c1(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=c1(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var e,l,u=this.buf;return e=127&(l=u[this.pos++]),l<128?e:(e|=(127&(l=u[this.pos++]))<<7,l<128?e:(e|=(127&(l=u[this.pos++]))<<14,l<128?e:(e|=(127&(l=u[this.pos++]))<<21,l<128?e:function(m,w,B){var S,Q,M=B.buf;if(S=(112&(Q=M[B.pos++]))>>4,Q<128||(S|=(127&(Q=M[B.pos++]))<<3,Q<128)||(S|=(127&(Q=M[B.pos++]))<<10,Q<128)||(S|=(127&(Q=M[B.pos++]))<<17,Q<128)||(S|=(127&(Q=M[B.pos++]))<<24,Q<128)||(S|=(1&(Q=M[B.pos++]))<<31,Q<128))return Cu(m,S,w);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(l=u[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,e=this.pos;return this.pos=a,a-e>=12&&g1?function(l,u,m){return g1.decode(l.subarray(u,m))}(this.buf,e,a):function(l,u,m){for(var w="",B=u;B<m;){var S,Q,M,D=l[B],z=null,et=D>239?4:D>223?3:D>191?2:1;if(B+et>m)break;et===1?D<128&&(z=D):et===2?(192&(S=l[B+1]))==128&&(z=(31&D)<<6|63&S)<=127&&(z=null):et===3?(Q=l[B+2],(192&(S=l[B+1]))==128&&(192&Q)==128&&((z=(15&D)<<12|(63&S)<<6|63&Q)<=2047||z>=55296&&z<=57343)&&(z=null)):et===4&&(Q=l[B+2],M=l[B+3],(192&(S=l[B+1]))==128&&(192&Q)==128&&(192&M)==128&&((z=(15&D)<<18|(63&S)<<12|(63&Q)<<6|63&M)<=65535||z>=1114112)&&(z=null)),z===null?(z=65533,et=1):z>65535&&(z-=65536,w+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),w+=String.fromCharCode(z),B+=et}return w}(this.buf,e,a)},readBytes:function(){var a=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,a);return this.pos=a,e},readPackedVarint:function(a,e){if(this.type!==Dr.Bytes)return a.push(this.readVarint(e));var l=pl(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(e));return a},readPackedSVarint:function(a){if(this.type!==Dr.Bytes)return a.push(this.readSVarint());var e=pl(this);for(a=a||[];this.pos<e;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Dr.Bytes)return a.push(this.readBoolean());var e=pl(this);for(a=a||[];this.pos<e;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Dr.Bytes)return a.push(this.readFloat());var e=pl(this);for(a=a||[];this.pos<e;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Dr.Bytes)return a.push(this.readDouble());var e=pl(this);for(a=a||[];this.pos<e;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Dr.Bytes)return a.push(this.readFixed32());var e=pl(this);for(a=a||[];this.pos<e;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Dr.Bytes)return a.push(this.readSFixed32());var e=pl(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Dr.Bytes)return a.push(this.readFixed64());var e=pl(this);for(a=a||[];this.pos<e;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Dr.Bytes)return a.push(this.readSFixed64());var e=pl(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed64());return a},skip:function(a){var e=7&a;if(e===Dr.Varint)for(;this.buf[this.pos++]>127;);else if(e===Dr.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Dr.Fixed32)this.pos+=4;else{if(e!==Dr.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(a,e){this.writeVarint(a<<3|e)},realloc:function(a){for(var e=this.length||16;e<this.pos+a;)e*=2;if(e!==this.length){var l=new Uint8Array(e);l.set(this.buf),this.buf=l,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Iu(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Iu(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Iu(this.buf,-1&a,this.pos),Iu(this.buf,Math.floor(a*h1),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Iu(this.buf,-1&a,this.pos),Iu(this.buf,Math.floor(a*h1),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(e,l){var u,m;if(e>=0?(u=e%4294967296|0,m=e/4294967296|0):(m=~(-e/4294967296),4294967295^(u=~(-e%4294967296))?u=u+1|0:(u=0,m=m+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(w,B,S){S.buf[S.pos++]=127&w|128,w>>>=7,S.buf[S.pos++]=127&w|128,w>>>=7,S.buf[S.pos++]=127&w|128,w>>>=7,S.buf[S.pos++]=127&w|128,S.buf[S.pos]=127&(w>>>=7)}(u,0,l),function(w,B){var S=(7&w)<<4;B.buf[B.pos++]|=S|((w>>>=3)?128:0),w&&(B.buf[B.pos++]=127&w|((w>>>=7)?128:0),w&&(B.buf[B.pos++]=127&w|((w>>>=7)?128:0),w&&(B.buf[B.pos++]=127&w|((w>>>=7)?128:0),w&&(B.buf[B.pos++]=127&w|((w>>>=7)?128:0),w&&(B.buf[B.pos++]=127&w)))))}(m,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var e=this.pos;this.pos=function(u,m,w){for(var B,S,Q=0;Q<m.length;Q++){if((B=m.charCodeAt(Q))>55295&&B<57344){if(!S){B>56319||Q+1===m.length?(u[w++]=239,u[w++]=191,u[w++]=189):S=B;continue}if(B<56320){u[w++]=239,u[w++]=191,u[w++]=189,S=B;continue}B=S-55296<<10|B-56320|65536,S=null}else S&&(u[w++]=239,u[w++]=191,u[w++]=189,S=null);B<128?u[w++]=B:(B<2048?u[w++]=B>>6|192:(B<65536?u[w++]=B>>12|224:(u[w++]=B>>18|240,u[w++]=B>>12&63|128),u[w++]=B>>6&63|128),u[w++]=63&B|128)}return w}(this.buf,a,this.pos);var l=this.pos-e;l>=128&&d1(e,l,this),this.pos=e-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),u1(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),u1(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var e=a.length;this.writeVarint(e),this.realloc(e);for(var l=0;l<e;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,e){this.pos++;var l=this.pos;a(e,this);var u=this.pos-l;u>=128&&d1(l,u,this),this.pos=l-1,this.writeVarint(u),this.pos+=u},writeMessage:function(a,e,l){this.writeTag(a,Dr.Bytes),this.writeRawMessage(e,l)},writePackedVarint:function(a,e){e.length&&this.writeMessage(a,BS,e)},writePackedSVarint:function(a,e){e.length&&this.writeMessage(a,_S,e)},writePackedBoolean:function(a,e){e.length&&this.writeMessage(a,FS,e)},writePackedFloat:function(a,e){e.length&&this.writeMessage(a,xS,e)},writePackedDouble:function(a,e){e.length&&this.writeMessage(a,SS,e)},writePackedFixed32:function(a,e){e.length&&this.writeMessage(a,kS,e)},writePackedSFixed32:function(a,e){e.length&&this.writeMessage(a,LS,e)},writePackedFixed64:function(a,e){e.length&&this.writeMessage(a,ES,e)},writePackedSFixed64:function(a,e){e.length&&this.writeMessage(a,TS,e)},writeBytesField:function(a,e){this.writeTag(a,Dr.Bytes),this.writeBytes(e)},writeFixed32Field:function(a,e){this.writeTag(a,Dr.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(a,e){this.writeTag(a,Dr.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(a,e){this.writeTag(a,Dr.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(a,e){this.writeTag(a,Dr.Fixed64),this.writeSFixed64(e)},writeVarintField:function(a,e){this.writeTag(a,Dr.Varint),this.writeVarint(e)},writeSVarintField:function(a,e){this.writeTag(a,Dr.Varint),this.writeSVarint(e)},writeStringField:function(a,e){this.writeTag(a,Dr.Bytes),this.writeString(e)},writeFloatField:function(a,e){this.writeTag(a,Dr.Fixed32),this.writeFloat(e)},writeDoubleField:function(a,e){this.writeTag(a,Dr.Fixed64),this.writeDouble(e)},writeBooleanField:function(a,e){this.writeVarintField(a,Boolean(e))}};var bm=g(l1);let vm=3;function QS(a,e,l){a===1&&l.readMessage(US,e)}function US(a,e,l){if(a===3){let{id:u,bitmap:m,width:w,height:B,left:S,top:Q,advance:M}=l.readMessage(GS,{});e.push({id:u,bitmap:new Zo({width:w+2*vm,height:B+2*vm},m),metrics:{width:w,height:B,left:S,top:Q,advance:M}})}}function GS(a,e,l){a===1?e.id=l.readVarint():a===2?e.bitmap=l.readBytes():a===3?e.width=l.readVarint():a===4?e.height=l.readVarint():a===5?e.left=l.readSVarint():a===6?e.top=l.readSVarint():a===7&&(e.advance=l.readVarint())}let f1=vm;function m1(a){let e=0,l=0;for(let B of a)e+=B.w*B.h,l=Math.max(l,B.w);a.sort((B,S)=>S.h-B.h);let u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),l),h:1/0}],m=0,w=0;for(let B of a)for(let S=u.length-1;S>=0;S--){let Q=u[S];if(!(B.w>Q.w||B.h>Q.h)){if(B.x=Q.x,B.y=Q.y,w=Math.max(w,B.y+B.h),m=Math.max(m,B.x+B.w),B.w===Q.w&&B.h===Q.h){let M=u.pop();S<u.length&&(u[S]=M)}else B.h===Q.h?(Q.x+=B.w,Q.w-=B.w):B.w===Q.w?(Q.y+=B.h,Q.h-=B.h):(u.push({x:Q.x+B.w,y:Q.y,w:Q.w-B.w,h:B.h}),Q.y+=B.h,Q.h-=B.h);break}}return{w:m,h:w,fill:e/(m*w)||0}}let ho=1;class wm{constructor(e,{pixelRatio:l,version:u,stretchX:m,stretchY:w,content:B}){this.paddedRect=e,this.pixelRatio=l,this.stretchX=m,this.stretchY=w,this.content=B,this.version=u}get tl(){return[this.paddedRect.x+ho,this.paddedRect.y+ho]}get br(){return[this.paddedRect.x+this.paddedRect.w-ho,this.paddedRect.y+this.paddedRect.h-ho]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ho)/this.pixelRatio,(this.paddedRect.h-2*ho)/this.pixelRatio]}}class C1{constructor(e,l){let u={},m={};this.haveRenderCallbacks=[];let w=[];this.addImages(e,u,w),this.addImages(l,m,w);let{w:B,h:S}=m1(w),Q=new Vs({width:B||1,height:S||1});for(let M in e){let D=e[M],z=u[M].paddedRect;Vs.copy(D.data,Q,{x:0,y:0},{x:z.x+ho,y:z.y+ho},D.data)}for(let M in l){let D=l[M],z=m[M].paddedRect,et=z.x+ho,nt=z.y+ho,st=D.data.width,mt=D.data.height;Vs.copy(D.data,Q,{x:0,y:0},{x:et,y:nt},D.data),Vs.copy(D.data,Q,{x:0,y:mt-1},{x:et,y:nt-1},{width:st,height:1}),Vs.copy(D.data,Q,{x:0,y:0},{x:et,y:nt+mt},{width:st,height:1}),Vs.copy(D.data,Q,{x:st-1,y:0},{x:et-1,y:nt},{width:1,height:mt}),Vs.copy(D.data,Q,{x:0,y:0},{x:et+st,y:nt},{width:1,height:mt})}this.image=Q,this.iconPositions=u,this.patternPositions=m}addImages(e,l,u){for(let m in e){let w=e[m],B={x:0,y:0,w:w.data.width+2*ho,h:w.data.height+2*ho};u.push(B),l[m]=new wm(B,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(e,l){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let u in e.updatedImages)this.patchUpdatedImage(this.iconPositions[u],e.getImage(u),l),this.patchUpdatedImage(this.patternPositions[u],e.getImage(u),l)}patchUpdatedImage(e,l,u){if(!e||!l||e.version===l.version)return;e.version=l.version;let[m,w]=e.tl;u.update(l.data,void 0,{x:m,y:w})}}var Jl;si("ImagePosition",wm),si("ImageAtlas",C1),A.ah=void 0,(Jl=A.ah||(A.ah={}))[Jl.none=0]="none",Jl[Jl.horizontal=1]="horizontal",Jl[Jl.vertical=2]="vertical",Jl[Jl.horizontalOnly=3]="horizontalOnly";let Eh=-17;class Th{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,l){let u=new Th;return u.scale=e||1,u.fontStack=l,u}static forImage(e){let l=new Th;return l.imageName=e,l}}class yu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,l){let u=new yu;for(let m=0;m<e.sections.length;m++){let w=e.sections[m];w.image?u.addImageSection(w):u.addTextSection(w,l)}return u}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let l="";for(let u=0;u<e.length;u++){let m=e.charCodeAt(u+1)||null,w=e.charCodeAt(u-1)||null;l+=m&&wA(m)&&!Lh[e[u+1]]||w&&wA(w)&&!Lh[e[u-1]]||!Lh[e[u]]?e[u]:Lh[e[u]]}return l}(this.text)}trim(){let e=0;for(let u=0;u<this.text.length&&rd[this.text.charCodeAt(u)];u++)e++;let l=this.text.length;for(let u=this.text.length-1;u>=0&&u>=e&&rd[this.text.charCodeAt(u)];u--)l--;this.text=this.text.substring(e,l),this.sectionIndex=this.sectionIndex.slice(e,l)}substring(e,l){let u=new yu;return u.text=this.text.substring(e,l),u.sectionIndex=this.sectionIndex.slice(e,l),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,l)=>Math.max(e,this.sections[l].scale),0)}addTextSection(e,l){this.text+=e.text,this.sections.push(Th.forText(e.scale,e.fontStack||l));let u=this.sections.length-1;for(let m=0;m<e.text.length;++m)this.sectionIndex.push(u)}addImageSection(e){let l=e.image?e.image.name:"";if(l.length===0)return void At("Can't add FormattedSection with an empty image.");let u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Th.forImage(l)),this.sectionIndex.push(this.sections.length-1)):At("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function id(a,e,l,u,m,w,B,S,Q,M,D,z,et,nt,st,mt){let St=yu.fromFeature(a,m),Vt;z===A.ah.vertical&&St.verticalizePunctuation();let{processBidirectionalText:oe,processStyledBidirectionalText:Wt}=Go;if(oe&&St.sections.length===1){Vt=[];let Le=oe(St.toString(),Bm(St,M,w,e,u,nt,st));for(let ni of Le){let bi=new yu;bi.text=ni,bi.sections=St.sections;for(let ri=0;ri<ni.length;ri++)bi.sectionIndex.push(0);Vt.push(bi)}}else if(Wt){Vt=[];let Le=Wt(St.text,St.sectionIndex,Bm(St,M,w,e,u,nt,st));for(let ni of Le){let bi=new yu;bi.text=ni[0],bi.sectionIndex=ni[1],bi.sections=St.sections,Vt.push(bi)}}else Vt=function(Le,ni){let bi=[],ri=Le.text,ti=0;for(let Oe of ni)bi.push(Le.substring(ti,Oe)),ti=Oe;return ti<ri.length&&bi.push(Le.substring(ti,ri.length)),bi}(St,Bm(St,M,w,e,u,nt,st));let $t=[],ve={positionedLines:$t,text:St.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:z,iconsInText:!1,verticalizable:!1};return function(Le,ni,bi,ri,ti,Oe,fi,qe,Ze,Gi,Bi,hr){let jr=0,nn=Eh,kn=0,Po=0,Ds=qe==="right"?1:qe==="left"?0:.5,wn=0;for(let Ln of ti){Ln.trim();let En=Ln.getMaxScale(),Fs=(En-1)*Fn,Os={positionedGlyphs:[],lineOffset:0};Le.positionedLines[wn]=Os;let ks=Os.positionedGlyphs,go=0;if(!Ln.length()){nn+=Oe,++wn;continue}for(let Tn=0;Tn<Ln.length();Tn++){let mr=Ln.getSection(Tn),Ls=Ln.getSectionIndex(Tn),fs=Ln.getCharCode(Tn),Qn=0,ba=null,Ja=null,Xa=null,fl=Fn,va=!(Ze===A.ah.horizontal||!Bi&&!rs(fs)||Bi&&(rd[fs]||(os=fs,ei.Arabic(os)||ei["Arabic Supplement"](os)||ei["Arabic Extended-A"](os)||ei["Arabic Presentation Forms-A"](os)||ei["Arabic Presentation Forms-B"](os))));if(mr.imageName){let aa=ri[mr.imageName];if(!aa)continue;Xa=mr.imageName,Le.iconsInText=Le.iconsInText||!0,Ja=aa.paddedRect;let fo=aa.displaySize;mr.scale=mr.scale*Fn/hr,ba={width:fo[0],height:fo[1],left:ho,top:-f1,advance:va?fo[1]:fo[0]},Qn=Fs+(Fn-fo[1]*mr.scale),fl=ba.advance;let ml=va?fo[0]*mr.scale-Fn*En:fo[1]*mr.scale-Fn*En;ml>0&&ml>go&&(go=ml)}else{let aa=bi[mr.fontStack],fo=aa&&aa[fs];if(fo&&fo.rect)Ja=fo.rect,ba=fo.metrics;else{let ml=ni[mr.fontStack],Hh=ml&&ml[fs];if(!Hh)continue;ba=Hh.metrics}Qn=(En-mr.scale)*Fn}va?(Le.verticalizable=!0,ks.push({glyph:fs,imageName:Xa,x:jr,y:nn+Qn,vertical:va,scale:mr.scale,fontStack:mr.fontStack,sectionIndex:Ls,metrics:ba,rect:Ja}),jr+=fl*mr.scale+Gi):(ks.push({glyph:fs,imageName:Xa,x:jr,y:nn+Qn,vertical:va,scale:mr.scale,fontStack:mr.fontStack,sectionIndex:Ls,metrics:ba,rect:Ja}),jr+=ba.advance*mr.scale+Gi)}ks.length!==0&&(kn=Math.max(jr-Gi,kn),ZS(ks,0,ks.length-1,Ds,go)),jr=0;let po=Oe*En+go;Os.lineOffset=Math.max(go,Fs),nn+=po,Po=Math.max(po,Po),++wn}var os;let ps=nn-Eh,{horizontalAlign:Ks,verticalAlign:Ws}=_m(fi);(function(Ln,En,Fs,Os,ks,go,po,Tn,mr){let Ls=(En-Fs)*ks,fs=0;fs=go!==po?-Tn*Os-Eh:(-Os*mr+.5)*po;for(let Qn of Ln)for(let ba of Qn.positionedGlyphs)ba.x+=Ls,ba.y+=fs})(Le.positionedLines,Ds,Ks,Ws,kn,Po,Oe,ps,ti.length),Le.top+=-Ws*ps,Le.bottom=Le.top+ps,Le.left+=-Ks*kn,Le.right=Le.left+kn}(ve,e,l,u,Vt,B,S,Q,z,M,et,mt),!function(Le){for(let ni of Le)if(ni.positionedGlyphs.length!==0)return!1;return!0}($t)&&ve}let rd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},RS={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function I1(a,e,l,u,m,w){if(e.imageName){let B=u[e.imageName];return B?B.displaySize[0]*e.scale*Fn/w+m:0}{let B=l[e.fontStack],S=B&&B[a];return S?S.metrics.advance*e.scale+m:0}}function y1(a,e,l,u){let m=Math.pow(a-e,2);return u?a<e?m/2:2*m:m+Math.abs(l)*l}function HS(a,e,l){let u=0;return a===10&&(u-=1e4),l&&(u+=150),a!==40&&a!==65288||(u+=50),e!==41&&e!==65289||(u+=50),u}function b1(a,e,l,u,m,w){let B=null,S=y1(e,l,m,w);for(let Q of u){let M=y1(e-Q.x,l,m,w)+Q.badness;M<=S&&(B=Q,S=M)}return{index:a,x:e,priorBreak:B,badness:S}}function v1(a){return a?v1(a.priorBreak).concat(a.index):[]}function Bm(a,e,l,u,m,w,B){if(w!=="point")return[];if(!a)return[];let S=[],Q=function(et,nt,st,mt,St,Vt){let oe=0;for(let Wt=0;Wt<et.length();Wt++){let $t=et.getSection(Wt);oe+=I1(et.getCharCode(Wt),$t,mt,St,nt,Vt)}return oe/Math.max(1,Math.ceil(oe/st))}(a,e,l,u,m,B),M=a.text.indexOf("\u200B")>=0,D=0;for(let et=0;et<a.length();et++){let nt=a.getSection(et),st=a.getCharCode(et);if(rd[st]||(D+=I1(st,nt,u,m,e,B)),et<a.length()-1){let mt=!((z=st)<11904||!(ei["Bopomofo Extended"](z)||ei.Bopomofo(z)||ei["CJK Compatibility Forms"](z)||ei["CJK Compatibility Ideographs"](z)||ei["CJK Compatibility"](z)||ei["CJK Radicals Supplement"](z)||ei["CJK Strokes"](z)||ei["CJK Symbols and Punctuation"](z)||ei["CJK Unified Ideographs Extension A"](z)||ei["CJK Unified Ideographs"](z)||ei["Enclosed CJK Letters and Months"](z)||ei["Halfwidth and Fullwidth Forms"](z)||ei.Hiragana(z)||ei["Ideographic Description Characters"](z)||ei["Kangxi Radicals"](z)||ei["Katakana Phonetic Extensions"](z)||ei.Katakana(z)||ei["Vertical Forms"](z)||ei["Yi Radicals"](z)||ei["Yi Syllables"](z)));(RS[st]||mt||nt.imageName)&&S.push(b1(et+1,D,Q,S,HS(st,a.getCharCode(et+1),mt&&M),!1))}}var z;return v1(b1(a.length(),D,Q,S,0,!0))}function _m(a){let e=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:e,verticalAlign:l}}function ZS(a,e,l,u,m){if(!u&&!m)return;let w=a[l],B=(a[l].x+w.metrics.advance*w.scale)*u;for(let S=e;S<=l;S++)a[S].x-=B,a[S].y+=m}function PS(a,e,l){let{horizontalAlign:u,verticalAlign:m}=_m(l),w=e[0]-a.displaySize[0]*u,B=e[1]-a.displaySize[1]*m;return{image:a,top:B,bottom:B+a.displaySize[1],left:w,right:w+a.displaySize[0]}}function w1(a,e,l,u,m,w){let B=a.image,S;if(B.content){let St=B.content,Vt=B.pixelRatio||1;S=[St[0]/Vt,St[1]/Vt,B.displaySize[0]-St[2]/Vt,B.displaySize[1]-St[3]/Vt]}let Q=e.left*w,M=e.right*w,D,z,et,nt;l==="width"||l==="both"?(nt=m[0]+Q-u[3],z=m[0]+M+u[1]):(nt=m[0]+(Q+M-B.displaySize[0])/2,z=nt+B.displaySize[0]);let st=e.top*w,mt=e.bottom*w;return l==="height"||l==="both"?(D=m[1]+st-u[0],et=m[1]+mt+u[2]):(D=m[1]+(st+mt-B.displaySize[1])/2,et=D+B.displaySize[1]),{image:B,top:D,right:z,bottom:et,left:nt,collisionPadding:S}}let Qh=255,NA=128,Xl=Qh*NA;function B1(a,e){let{expression:l}=e;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Hr(a+1))};if(l.kind==="source")return{kind:"source"};{let{zoomStops:u,interpolationType:m}=l,w=0;for(;w<u.length&&u[w]<=a;)w++;w=Math.max(0,w-1);let B=w;for(;B<u.length&&u[B]<a+1;)B++;B=Math.min(u.length-1,B);let S=u[w],Q=u[B];return l.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:Q,interpolationType:m}:{kind:"camera",minZoom:S,maxZoom:Q,minSize:l.evaluate(new Hr(S)),maxSize:l.evaluate(new Hr(Q)),interpolationType:m}}}function xm(a,e,l){let u="never",m=a.get(e);return m?u=m:a.get(l)&&(u="always"),u}let MS=zl.VectorTileFeature.types,NS=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nd(a,e,l,u,m,w,B,S,Q,M,D,z,et){let nt=S?Math.min(Xl,Math.round(S[0])):0,st=S?Math.min(Xl,Math.round(S[1])):0;a.emplaceBack(e,l,Math.round(32*u),Math.round(32*m),w,B,(nt<<1)+(Q?1:0),st,16*M,16*D,256*z,256*et)}function Sm(a,e,l){a.emplaceBack(e.x,e.y,l),a.emplaceBack(e.x,e.y,l),a.emplaceBack(e.x,e.y,l),a.emplaceBack(e.x,e.y,l)}function VS(a){for(let e of a.sections)if(ol(e.text))return!0;return!1}class Fm{constructor(e){this.layoutVertexArray=new V,this.indexArray=new ut,this.programConfigurations=e,this.segments=new Ct,this.dynamicLayoutVertexArray=new X,this.opacityVertexArray=new J,this.hasVisibleVertices=!1,this.placedSymbolArray=new n}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,l,u,m){this.isEmpty()||(u&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,IS.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,yS.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,NS,!0),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}si("SymbolBuffers",Fm);class km{constructor(e,l,u){this.layoutVertexArray=new e,this.layoutAttributes=l,this.indexArray=new u,this.segments=new Ct,this.collisionVertexArray=new dt}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,bS.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}si("CollisionBuffers",km);class bu{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(B=>B.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=mh([]),this.placementViewportMatrix=mh([]);let l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=B1(this.zoom,l["text-size"]),this.iconSizeData=B1(this.zoom,l["icon-size"]);let u=this.layers[0].layout,m=u.get("symbol-sort-key"),w=u.get("symbol-z-order");this.canOverlap=xm(u,"text-overlap","text-allow-overlap")!=="never"||xm(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=w!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(w==="viewport-y"||w==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(B=>A.ah[B])),this.stateDependentLayerIds=this.layers.filter(B=>B.isStateDependent()).map(B=>B.id),this.sourceID=e.sourceID}createArrays(){this.text=new Fm(new _r(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Fm(new _r(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new f,this.lineVertexArray=new b,this.symbolInstances=new p,this.textAnchorOffsets=new E}calculateGlyphDependencies(e,l,u,m,w){for(let B=0;B<e.length;B++)if(l[e.charCodeAt(B)]=!0,(u||m)&&w){let S=Lh[e.charAt(B)];S&&(l[S.charCodeAt(0)]=!0)}}populate(e,l,u){let m=this.layers[0],w=m.layout,B=w.get("text-font"),S=w.get("text-field"),Q=w.get("icon-image"),M=(S.value.kind!=="constant"||S.value.value instanceof Sr&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(B.value.kind!=="constant"||B.value.value.length>0),D=Q.value.kind!=="constant"||!!Q.value.value||Object.keys(Q.parameters).length>0,z=w.get("symbol-sort-key");if(this.features=[],!M&&!D)return;let et=l.iconDependencies,nt=l.glyphDependencies,st=l.availableImages,mt=new Hr(this.zoom);for(let{feature:St,id:Vt,index:oe,sourceLayerIndex:Wt}of e){let $t=m._featureFilter.needGeometry,ve=sa(St,$t);if(!m._featureFilter.filter(mt,ve,u))continue;let Le,ni;if($t||(ve.geometry=Zr(St)),M){let ri=m.getValueAndResolveTokens("text-field",ve,u,st),ti=Sr.factory(ri),Oe=this.hasRTLText=this.hasRTLText||VS(ti);(!Oe||Go.getRTLTextPluginStatus()==="unavailable"||Oe&&Go.isParsed())&&(Le=wS(ti,m,ve))}if(D){let ri=m.getValueAndResolveTokens("icon-image",ve,u,st);ni=ri instanceof Dn?ri:Dn.fromString(ri)}if(!Le&&!ni)continue;let bi=this.sortFeaturesByKey?z.evaluate(ve,{},u):void 0;if(this.features.push({id:Vt,text:Le,icon:ni,index:oe,sourceLayerIndex:Wt,geometry:ve.geometry,properties:St.properties,type:MS[St.type],sortKey:bi}),ni&&(et[ni.name]=!0),Le){let ri=B.evaluate(ve,{},u).join(","),ti=w.get("text-rotation-alignment")!=="viewport"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(A.ah.vertical)>=0;for(let Oe of Le.sections)if(Oe.image)et[Oe.image.name]=!0;else{let fi=Pa(Le.toString()),qe=Oe.fontStack||ri,Ze=nt[qe]=nt[qe]||{};this.calculateGlyphDependencies(Oe.text,Ze,ti,this.allowVerticalPlacement,fi)}}}w.get("symbol-placement")==="line"&&(this.features=function(St){let Vt={},oe={},Wt=[],$t=0;function ve(ri){Wt.push(St[ri]),$t++}function Le(ri,ti,Oe){let fi=oe[ri];return delete oe[ri],oe[ti]=fi,Wt[fi].geometry[0].pop(),Wt[fi].geometry[0]=Wt[fi].geometry[0].concat(Oe[0]),fi}function ni(ri,ti,Oe){let fi=Vt[ti];return delete Vt[ti],Vt[ri]=fi,Wt[fi].geometry[0].shift(),Wt[fi].geometry[0]=Oe[0].concat(Wt[fi].geometry[0]),fi}function bi(ri,ti,Oe){let fi=Oe?ti[0][ti[0].length-1]:ti[0][0];return`${ri}:${fi.x}:${fi.y}`}for(let ri=0;ri<St.length;ri++){let ti=St[ri],Oe=ti.geometry,fi=ti.text?ti.text.toString():null;if(!fi){ve(ri);continue}let qe=bi(fi,Oe),Ze=bi(fi,Oe,!0);if(qe in oe&&Ze in Vt&&oe[qe]!==Vt[Ze]){let Gi=ni(qe,Ze,Oe),Bi=Le(qe,Ze,Wt[Gi].geometry);delete Vt[qe],delete oe[Ze],oe[bi(fi,Wt[Bi].geometry,!0)]=Bi,Wt[Gi].geometry=null}else qe in oe?Le(qe,Ze,Oe):Ze in Vt?ni(qe,Ze,Oe):(ve(ri),Vt[qe]=$t-1,oe[Ze]=$t-1)}return Wt.filter(ri=>ri.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((St,Vt)=>St.sortKey-Vt.sortKey)}update(e,l,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,l,this.layers,u),this.icon.programConfigurations.updatePaintArrays(e,l,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,l){let u=this.lineVertexArray.length;if(e.segment!==void 0){let m=e.dist(l[e.segment+1]),w=e.dist(l[e.segment]),B={};for(let S=e.segment+1;S<l.length;S++)B[S]={x:l[S].x,y:l[S].y,tileUnitDistanceFromAnchor:m},S<l.length-1&&(m+=l[S+1].dist(l[S]));for(let S=e.segment||0;S>=0;S--)B[S]={x:l[S].x,y:l[S].y,tileUnitDistanceFromAnchor:w},S>0&&(w+=l[S-1].dist(l[S]));for(let S=0;S<l.length;S++){let Q=B[S];this.lineVertexArray.emplaceBack(Q.x,Q.y,Q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(e,l,u,m,w,B,S,Q,M,D,z,et){let nt=e.indexArray,st=e.layoutVertexArray,mt=e.segments.prepareSegment(4*l.length,st,nt,this.canOverlap?B.sortKey:void 0),St=this.glyphOffsetArray.length,Vt=mt.vertexLength,oe=this.allowVerticalPlacement&&S===A.ah.vertical?Math.PI/2:0,Wt=B.text&&B.text.sections;for(let $t=0;$t<l.length;$t++){let{tl:ve,tr:Le,bl:ni,br:bi,tex:ri,pixelOffsetTL:ti,pixelOffsetBR:Oe,minFontScaleX:fi,minFontScaleY:qe,glyphOffset:Ze,isSDF:Gi,sectionIndex:Bi}=l[$t],hr=mt.vertexLength,jr=Ze[1];nd(st,Q.x,Q.y,ve.x,jr+ve.y,ri.x,ri.y,u,Gi,ti.x,ti.y,fi,qe),nd(st,Q.x,Q.y,Le.x,jr+Le.y,ri.x+ri.w,ri.y,u,Gi,Oe.x,ti.y,fi,qe),nd(st,Q.x,Q.y,ni.x,jr+ni.y,ri.x,ri.y+ri.h,u,Gi,ti.x,Oe.y,fi,qe),nd(st,Q.x,Q.y,bi.x,jr+bi.y,ri.x+ri.w,ri.y+ri.h,u,Gi,Oe.x,Oe.y,fi,qe),Sm(e.dynamicLayoutVertexArray,Q,oe),nt.emplaceBack(hr,hr+1,hr+2),nt.emplaceBack(hr+1,hr+2,hr+3),mt.vertexLength+=4,mt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ze[0]),$t!==l.length-1&&Bi===l[$t+1].sectionIndex||e.programConfigurations.populatePaintArrays(st.length,B,B.index,{},et,Wt&&Wt[Bi])}e.placedSymbolArray.emplaceBack(Q.x,Q.y,St,this.glyphOffsetArray.length-St,Vt,M,D,Q.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],S,0,!1,0,z)}_addCollisionDebugVertex(e,l,u,m,w,B){return l.emplaceBack(0,0),e.emplaceBack(u.x,u.y,m,w,Math.round(B.x),Math.round(B.y))}addCollisionDebugVertices(e,l,u,m,w,B,S){let Q=w.segments.prepareSegment(4,w.layoutVertexArray,w.indexArray),M=Q.vertexLength,D=w.layoutVertexArray,z=w.collisionVertexArray,et=S.anchorX,nt=S.anchorY;this._addCollisionDebugVertex(D,z,B,et,nt,new v(e,l)),this._addCollisionDebugVertex(D,z,B,et,nt,new v(u,l)),this._addCollisionDebugVertex(D,z,B,et,nt,new v(u,m)),this._addCollisionDebugVertex(D,z,B,et,nt,new v(e,m)),Q.vertexLength+=4;let st=w.indexArray;st.emplaceBack(M,M+1),st.emplaceBack(M+1,M+2),st.emplaceBack(M+2,M+3),st.emplaceBack(M+3,M),Q.primitiveLength+=4}addDebugCollisionBoxes(e,l,u,m){for(let w=e;w<l;w++){let B=this.collisionBoxArray.get(w);this.addCollisionDebugVertices(B.x1,B.y1,B.x2,B.y2,m?this.textCollisionBox:this.iconCollisionBox,B.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new km(ot,A1.members,Gt),this.iconCollisionBox=new km(ot,A1.members,Gt);for(let e=0;e<this.symbolInstances.length;e++){let l=this.symbolInstances.get(e);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(e,l,u,m,w,B,S,Q,M){let D={};for(let z=l;z<u;z++){let et=e.get(z);D.textBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},D.textFeatureIndex=et.featureIndex;break}for(let z=m;z<w;z++){let et=e.get(z);D.verticalTextBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},D.verticalTextFeatureIndex=et.featureIndex;break}for(let z=B;z<S;z++){let et=e.get(z);D.iconBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},D.iconFeatureIndex=et.featureIndex;break}for(let z=Q;z<M;z++){let et=e.get(z);D.verticalIconBox={x1:et.x1,y1:et.y1,x2:et.x2,y2:et.y2,anchorPointX:et.anchorPointX,anchorPointY:et.anchorPointY},D.verticalIconFeatureIndex=et.featureIndex;break}return D}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){let u=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,l){let u=e.placedSymbolArray.get(l),m=u.vertexStartIndex+4*u.numGlyphs;for(let w=u.vertexStartIndex;w<m;w+=4)e.indexArray.emplaceBack(w,w+1,w+2),e.indexArray.emplaceBack(w+1,w+2,w+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let l=Math.sin(e),u=Math.cos(e),m=[],w=[],B=[];for(let S=0;S<this.symbolInstances.length;++S){B.push(S);let Q=this.symbolInstances.get(S);m.push(0|Math.round(l*Q.anchorX+u*Q.anchorY)),w.push(Q.featureIndex)}return B.sort((S,Q)=>m[S]-m[Q]||w[Q]-w[S]),B}addToSortKeyRanges(e,l){let u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===l?u.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let l of this.symbolInstanceIndexes){let u=this.symbolInstances.get(l);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((m,w,B)=>{m>=0&&B.indexOf(m)===w&&this.addIndicesForPlacedSymbol(this.text,m)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let _1,x1;si("SymbolBucket",bu,{omit:["layers","collisionBoxArray","features","compareText"]}),bu.MAX_GLYPHS=65535,bu.addDynamicAttributes=Sm;var Lm={get paint(){return x1=x1||new Jn({"icon-opacity":new Hi(xt.paint_symbol["icon-opacity"]),"icon-color":new Hi(xt.paint_symbol["icon-color"]),"icon-halo-color":new Hi(xt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Hi(xt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Hi(xt.paint_symbol["icon-halo-blur"]),"icon-translate":new wi(xt.paint_symbol["icon-translate"]),"icon-translate-anchor":new wi(xt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Hi(xt.paint_symbol["text-opacity"]),"text-color":new Hi(xt.paint_symbol["text-color"],{runtimeType:Zi,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Hi(xt.paint_symbol["text-halo-color"]),"text-halo-width":new Hi(xt.paint_symbol["text-halo-width"]),"text-halo-blur":new Hi(xt.paint_symbol["text-halo-blur"]),"text-translate":new wi(xt.paint_symbol["text-translate"]),"text-translate-anchor":new wi(xt.paint_symbol["text-translate-anchor"])})},get layout(){return _1=_1||new Jn({"symbol-placement":new wi(xt.layout_symbol["symbol-placement"]),"symbol-spacing":new wi(xt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wi(xt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Hi(xt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wi(xt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new wi(xt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new wi(xt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new wi(xt.layout_symbol["icon-ignore-placement"]),"icon-optional":new wi(xt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wi(xt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Hi(xt.layout_symbol["icon-size"]),"icon-text-fit":new wi(xt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wi(xt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Hi(xt.layout_symbol["icon-image"]),"icon-rotate":new Hi(xt.layout_symbol["icon-rotate"]),"icon-padding":new Hi(xt.layout_symbol["icon-padding"]),"icon-keep-upright":new wi(xt.layout_symbol["icon-keep-upright"]),"icon-offset":new Hi(xt.layout_symbol["icon-offset"]),"icon-anchor":new Hi(xt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wi(xt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wi(xt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wi(xt.layout_symbol["text-rotation-alignment"]),"text-field":new Hi(xt.layout_symbol["text-field"]),"text-font":new Hi(xt.layout_symbol["text-font"]),"text-size":new Hi(xt.layout_symbol["text-size"]),"text-max-width":new Hi(xt.layout_symbol["text-max-width"]),"text-line-height":new wi(xt.layout_symbol["text-line-height"]),"text-letter-spacing":new Hi(xt.layout_symbol["text-letter-spacing"]),"text-justify":new Hi(xt.layout_symbol["text-justify"]),"text-radial-offset":new Hi(xt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wi(xt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Hi(xt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Hi(xt.layout_symbol["text-anchor"]),"text-max-angle":new wi(xt.layout_symbol["text-max-angle"]),"text-writing-mode":new wi(xt.layout_symbol["text-writing-mode"]),"text-rotate":new Hi(xt.layout_symbol["text-rotate"]),"text-padding":new wi(xt.layout_symbol["text-padding"]),"text-keep-upright":new wi(xt.layout_symbol["text-keep-upright"]),"text-transform":new Hi(xt.layout_symbol["text-transform"]),"text-offset":new Hi(xt.layout_symbol["text-offset"]),"text-allow-overlap":new wi(xt.layout_symbol["text-allow-overlap"]),"text-overlap":new wi(xt.layout_symbol["text-overlap"]),"text-ignore-placement":new wi(xt.layout_symbol["text-ignore-placement"]),"text-optional":new wi(xt.layout_symbol["text-optional"])})}};class S1{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:We,this.defaultValue=e}evaluate(e){if(e.formattedSection){let l=this.defaultValue.property.overrides;if(l&&l.hasOverride(e.formattedSection))return l.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}si("FormatSectionOverride",S1,{omit:["defaultValue"]});class sd extends ns{constructor(e){super(e,Lm)}recalculate(e,l){if(super.recalculate(e,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let u=this.layout.get("text-writing-mode");if(u){let m=[];for(let w of u)m.indexOf(w)<0&&m.push(w);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,l,u,m){let w=this.layout.get(e).evaluate(l,{},u,m),B=this._unevaluatedLayout._values[e];return B.isDataDriven()||Xi(B.value)||!w?w:function(S,Q){return Q.replace(/{([^{}]+)}/g,(M,D)=>S&&D in S?String(S[D]):"")}(l.properties,w)}createBucket(e){return new bu(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of Lm.paint.overridableProperties){if(!sd.hasPaintOverride(this.layout,e))continue;let l=this.paint.get(e),u=new S1(l),m=new Vr(u,l.property.specification),w=null;w=l.value.kind==="constant"||l.value.kind==="source"?new un("source",m):new hn("composite",m,l.value.zoomStops),this.paint._values[e]=new Ao(l.property,w,l.parameters)}}_handleOverridablePaintPropertyUpdate(e,l,u){return!(!this.layout||l.isDataDriven()||u.isDataDriven())&&sd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,l){let u=e.get("text-field"),m=Lm.paint.properties[l],w=!1,B=S=>{for(let Q of S)if(m.overrides&&m.overrides.hasOverride(Q))return void(w=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Sr)B(u.value.value.sections);else if(u.value.kind==="source"){let S=M=>{w||(M instanceof Fr&&Qr(M.value)===Lr?B(M.value.sections):M instanceof Xo?B(M.sections):M.eachChild(S))},Q=u.value;Q._styleExpression&&S(Q._styleExpression.expression)}return w}}let F1;var DS={get paint(){return F1=F1||new Jn({"background-color":new wi(xt.paint_background["background-color"]),"background-pattern":new wc(xt.paint_background["background-pattern"]),"background-opacity":new wi(xt.paint_background["background-opacity"])})}};class KS extends ns{constructor(e){super(e,DS)}}let k1;var WS={get paint(){return k1=k1||new Jn({"raster-opacity":new wi(xt.paint_raster["raster-opacity"]),"raster-hue-rotate":new wi(xt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wi(xt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wi(xt.paint_raster["raster-brightness-max"]),"raster-saturation":new wi(xt.paint_raster["raster-saturation"]),"raster-contrast":new wi(xt.paint_raster["raster-contrast"]),"raster-resampling":new wi(xt.paint_raster["raster-resampling"]),"raster-fade-duration":new wi(xt.paint_raster["raster-fade-duration"])})}};class OS extends ns{constructor(e){super(e,WS)}}class zS extends ns{constructor(e){super(e,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class JS{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}let Em=63710088e-1;class Yl{constructor(e,l){if(isNaN(e)||isNaN(l))throw new Error(`Invalid LngLat object: (${e}, ${l})`);if(this.lng=+e,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Yl(Lt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){let l=Math.PI/180,u=this.lat*l,m=e.lat*l,w=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((e.lng-this.lng)*l);return Em*Math.acos(Math.min(w,1))}static convert(e){if(e instanceof Yl)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Yl(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Yl(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let L1=2*Math.PI*Em;function E1(a){return L1*Math.cos(a*Math.PI/180)}function T1(a){return(180+a)/360}function Q1(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function U1(a,e){return a/E1(e)}function Tm(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class od{constructor(e,l,u=0){this.x=+e,this.y=+l,this.z=+u}static fromLngLat(e,l=0){let u=Yl.convert(e);return new od(T1(u.lng),Q1(u.lat),U1(l,u.lat))}toLngLat(){return new Yl(360*this.x-180,Tm(this.y))}toAltitude(){return this.z*E1(Tm(this.y))}meterInMercatorCoordinateUnits(){return 1/L1*(e=Tm(this.y),1/Math.cos(e*Math.PI/180));var e}}function G1(a,e,l){var u=2*Math.PI*6378137/256/Math.pow(2,l);return[a*u-2*Math.PI*6378137/2,e*u-2*Math.PI*6378137/2]}class Qm{constructor(e,l,u){if(e<0||e>25||u<0||u>=Math.pow(2,e)||l<0||l>=Math.pow(2,e))throw new Error(`x=${l}, y=${u}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=l,this.y=u,this.key=Uh(0,e,e,l,u)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,l,u){let m=(B=this.y,S=this.z,Q=G1(256*(w=this.x),256*(B=Math.pow(2,S)-B-1),S),M=G1(256*(w+1),256*(B+1),S),Q[0]+","+Q[1]+","+M[0]+","+M[1]);var w,B,S,Q,M;let D=function(z,et,nt){let st,mt="";for(let St=z;St>0;St--)st=1<<St-1,mt+=(et&st?1:0)+(nt&st?2:0);return mt}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,m)}isChildOf(e){let l=this.z-e.z;return l>0&&e.x===this.x>>l&&e.y===this.y>>l}getTilePoint(e){let l=Math.pow(2,this.z);return new v((e.x*l-this.x)*$i,(e.y*l-this.y)*$i)}toString(){return`${this.z}/${this.x}/${this.y}`}}class R1{constructor(e,l){this.wrap=e,this.canonical=l,this.key=Uh(e,l.z,l.z,l.x,l.y)}}class oa{constructor(e,l,u,m,w){if(e<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${u}`);this.overscaledZ=e,this.wrap=l,this.canonical=new Qm(u,+m,+w),this.key=Uh(l,e,u,m,w)}clone(){return new oa(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let l=this.canonical.z-e;return e>this.canonical.z?new oa(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new oa(e,this.wrap,e,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(e,l){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let u=this.canonical.z-e;return e>this.canonical.z?Uh(this.wrap*+l,e,this.canonical.z,this.canonical.x,this.canonical.y):Uh(this.wrap*+l,e,e,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let l=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>l&&e.canonical.y===this.canonical.y>>l}children(e){if(this.overscaledZ>=e)return[new oa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let l=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new oa(l,this.wrap,l,u,m),new oa(l,this.wrap,l,u+1,m),new oa(l,this.wrap,l,u,m+1),new oa(l,this.wrap,l,u+1,m+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new oa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new oa(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new R1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new od(e.x-this.wrap,e.y))}}function Uh(a,e,l,u,m){(a*=2)<0&&(a=-1*a-1);let w=1<<l;return(w*w*a+w*m+u).toString(36)+l.toString(36)+e.toString(36)}si("CanonicalTileID",Qm),si("OverscaledTileID",oa,{omit:["posMatrix"]});class H1{constructor(e,l,u,m=1,w=1,B=1,S=0){if(this.uid=e,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void At(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;let Q=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=w,this.blueFactor=B,this.baseShift=S;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let M=0;M<Q;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(Q,M)]=this.data[this._idx(Q-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,Q)]=this.data[this._idx(M,Q-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Q,-1)]=this.data[this._idx(Q-1,0)],this.data[this._idx(-1,Q)]=this.data[this._idx(0,Q-1)],this.data[this._idx(Q,Q)]=this.data[this._idx(Q-1,Q-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<Q;M++)for(let D=0;D<Q;D++){let z=this.get(M,D);z>this.max&&(this.max=z),z<this.min&&(this.min=z)}}get(e,l){let u=new Uint8Array(this.data.buffer),m=4*this._idx(e,l);return this.unpack(u[m],u[m+1],u[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,l){if(e<-1||e>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(e+1)}unpack(e,l,u){return e*this.redFactor+l*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new Vs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,l,u){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let m=l*this.dim,w=l*this.dim+this.dim,B=u*this.dim,S=u*this.dim+this.dim;switch(l){case-1:m=w-1;break;case 1:w=m+1}switch(u){case-1:B=S-1;break;case 1:S=B+1}let Q=-l*this.dim,M=-u*this.dim;for(let D=B;D<S;D++)for(let z=m;z<w;z++)this.data[this._idx(z,D)]=e.data[this._idx(z+Q,D+M)]}}si("DEMData",H1);class Z1{constructor(e){this._stringToNumber={},this._numberToString=[];for(let l=0;l<e.length;l++){let u=e[l];this._stringToNumber[u]=l,this._numberToString[l]=u}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class P1{constructor(e,l,u,m,w){this.type="Feature",this._vectorTileFeature=e,e._z=l,e._x=u,e._y=m,this.properties=e.properties,this.id=w}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(e[l]=this[l]);return e}}class M1{constructor(e,l){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new cs($i,16,0),this.grid3D=new cs($i,16,0),this.featureIndexArray=new h,this.promoteId=l}insert(e,l,u,m,w,B){let S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,w);let Q=B?this.grid3D:this.grid;for(let M=0;M<l.length;M++){let D=l[M],z=[1/0,1/0,-1/0,-1/0];for(let et=0;et<D.length;et++){let nt=D[et];z[0]=Math.min(z[0],nt.x),z[1]=Math.min(z[1],nt.y),z[2]=Math.max(z[2],nt.x),z[3]=Math.max(z[3],nt.y)}z[0]<$i&&z[1]<$i&&z[2]>=0&&z[3]>=0&&Q.insert(S,z[0],z[1],z[2],z[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new zl.VectorTile(new bm(this.rawTileData)).layers,this.sourceLayerCoder=new Z1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,l,u,m){this.loadVTLayers();let w=e.params||{},B=$i/e.tileSize/e.scale,S=ga(w.filter),Q=e.queryGeometry,M=e.queryPadding*B,D=V1(Q),z=this.grid.query(D.minX-M,D.minY-M,D.maxX+M,D.maxY+M),et=V1(e.cameraQueryGeometry),nt=this.grid3D.query(et.minX-M,et.minY-M,et.maxX+M,et.maxY+M,(St,Vt,oe,Wt)=>function($t,ve,Le,ni,bi){for(let ti of $t)if(ve<=ti.x&&Le<=ti.y&&ni>=ti.x&&bi>=ti.y)return!0;let ri=[new v(ve,Le),new v(ve,bi),new v(ni,bi),new v(ni,Le)];if($t.length>2){for(let ti of ri)if(Wa($t,ti))return!0}for(let ti=0;ti<$t.length-1;ti++)if(fh($t[ti],$t[ti+1],ri))return!0;return!1}(e.cameraQueryGeometry,St-M,Vt-M,oe+M,Wt+M));for(let St of nt)z.push(St);z.sort(XS);let st={},mt;for(let St=0;St<z.length;St++){let Vt=z[St];if(Vt===mt)continue;mt=Vt;let oe=this.featureIndexArray.get(Vt),Wt=null;this.loadMatchingFeature(st,oe.bucketIndex,oe.sourceLayerIndex,oe.featureIndex,S,w.layers,w.availableImages,l,u,m,($t,ve,Le)=>(Wt||(Wt=Zr($t)),ve.queryIntersectsFeature(Q,$t,Le,Wt,this.z,e.transform,B,e.pixelPosMatrix)))}return st}loadMatchingFeature(e,l,u,m,w,B,S,Q,M,D,z){let et=this.bucketLayerIDs[l];if(B&&!function(St,Vt){for(let oe=0;oe<St.length;oe++)if(Vt.indexOf(St[oe])>=0)return!0;return!1}(B,et))return;let nt=this.sourceLayerCoder.decode(u),st=this.vtLayers[nt].feature(m);if(w.needGeometry){let St=sa(st,!0);if(!w.filter(new Hr(this.tileID.overscaledZ),St,this.tileID.canonical))return}else if(!w.filter(new Hr(this.tileID.overscaledZ),st))return;let mt=this.getId(st,nt);for(let St=0;St<et.length;St++){let Vt=et[St];if(B&&B.indexOf(Vt)<0)continue;let oe=Q[Vt];if(!oe)continue;let Wt={};mt&&D&&(Wt=D.getState(oe.sourceLayer||"_geojsonTileLayer",mt));let $t=Tt({},M[Vt]);$t.paint=N1($t.paint,oe.paint,st,Wt,S),$t.layout=N1($t.layout,oe.layout,st,Wt,S);let ve=!z||z(st,oe,Wt);if(!ve)continue;let Le=new P1(st,this.z,this.x,this.y,mt);Le.layer=$t;let ni=e[Vt];ni===void 0&&(ni=e[Vt]=[]),ni.push({featureIndex:m,feature:Le,intersectionZ:ve})}}lookupSymbolFeatures(e,l,u,m,w,B,S,Q){let M={};this.loadVTLayers();let D=ga(w);for(let z of e)this.loadMatchingFeature(M,u,m,z,D,B,S,Q,l);return M}hasLayer(e){for(let l of this.bucketLayerIDs)for(let u of l)if(e===u)return!0;return!1}getId(e,l){let u=e.id;return this.promoteId&&(u=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof u=="boolean"&&(u=Number(u))),u}}function N1(a,e,l,u,m){return Ft(a,(w,B)=>{let S=e instanceof SA?e.get(B):null;return S&&S.evaluate?S.evaluate(l,u,m):S})}function V1(a){let e=1/0,l=1/0,u=-1/0,m=-1/0;for(let w of a)e=Math.min(e,w.x),l=Math.min(l,w.y),u=Math.max(u,w.x),m=Math.max(m,w.y);return{minX:e,minY:l,maxX:u,maxY:m}}function XS(a,e){return e-a}function D1(a,e,l,u,m){let w=[];for(let B=0;B<a.length;B++){let S=a[B],Q;for(let M=0;M<S.length-1;M++){let D=S[M],z=S[M+1];D.x<e&&z.x<e||(D.x<e?D=new v(e,D.y+(e-D.x)/(z.x-D.x)*(z.y-D.y))._round():z.x<e&&(z=new v(e,D.y+(e-D.x)/(z.x-D.x)*(z.y-D.y))._round()),D.y<l&&z.y<l||(D.y<l?D=new v(D.x+(l-D.y)/(z.y-D.y)*(z.x-D.x),l)._round():z.y<l&&(z=new v(D.x+(l-D.y)/(z.y-D.y)*(z.x-D.x),l)._round()),D.x>=u&&z.x>=u||(D.x>=u?D=new v(u,D.y+(u-D.x)/(z.x-D.x)*(z.y-D.y))._round():z.x>=u&&(z=new v(u,D.y+(u-D.x)/(z.x-D.x)*(z.y-D.y))._round()),D.y>=m&&z.y>=m||(D.y>=m?D=new v(D.x+(m-D.y)/(z.y-D.y)*(z.x-D.x),m)._round():z.y>=m&&(z=new v(D.x+(m-D.y)/(z.y-D.y)*(z.x-D.x),m)._round()),Q&&D.equals(Q[Q.length-1])||(Q=[D],w.push(Q)),Q.push(z)))))}}return w}si("FeatureIndex",M1,{omit:["rawTileData","sourceLayerCoder"]});class jl extends v{constructor(e,l,u,m){super(e,l),this.angle=u,m!==void 0&&(this.segment=m)}clone(){return new jl(this.x,this.y,this.angle,this.segment)}}function K1(a,e,l,u,m){if(e.segment===void 0||l===0)return!0;let w=e,B=e.segment+1,S=0;for(;S>-l/2;){if(B--,B<0)return!1;S-=a[B].dist(w),w=a[B]}S+=a[B].dist(a[B+1]),B++;let Q=[],M=0;for(;S<l/2;){let D=a[B],z=a[B+1];if(!z)return!1;let et=a[B-1].angleTo(D)-D.angleTo(z);for(et=Math.abs((et+3*Math.PI)%(2*Math.PI)-Math.PI),Q.push({distance:S,angleDelta:et}),M+=et;S-Q[0].distance>u;)M-=Q.shift().angleDelta;if(M>m)return!1;B++,S+=D.dist(z)}return!0}function W1(a){let e=0;for(let l=0;l<a.length-1;l++)e+=a[l].dist(a[l+1]);return e}function O1(a,e,l){return a?.6*e*l:0}function z1(a,e){return Math.max(a?a.right-a.left:0,e?e.right-e.left:0)}function YS(a,e,l,u,m,w){let B=O1(l,m,w),S=z1(l,u)*w,Q=0,M=W1(a)/2;for(let D=0;D<a.length-1;D++){let z=a[D],et=a[D+1],nt=z.dist(et);if(Q+nt>M){let st=(M-Q)/nt,mt=qn.number(z.x,et.x,st),St=qn.number(z.y,et.y,st),Vt=new jl(mt,St,et.angleTo(z),D);return Vt._round(),!B||K1(a,Vt,S,B,e)?Vt:void 0}Q+=nt}}function jS(a,e,l,u,m,w,B,S,Q){let M=O1(u,w,B),D=z1(u,m),z=D*B,et=a[0].x===0||a[0].x===Q||a[0].y===0||a[0].y===Q;return e-z<e/4&&(e=z+e/4),J1(a,et?e/2*S%e:(D/2+2*w)*B*S%e,e,M,l,z,et,!1,Q)}function J1(a,e,l,u,m,w,B,S,Q){let M=w/2,D=W1(a),z=0,et=e-l,nt=[];for(let st=0;st<a.length-1;st++){let mt=a[st],St=a[st+1],Vt=mt.dist(St),oe=St.angleTo(mt);for(;et+l<z+Vt;){et+=l;let Wt=(et-z)/Vt,$t=qn.number(mt.x,St.x,Wt),ve=qn.number(mt.y,St.y,Wt);if($t>=0&&$t<Q&&ve>=0&&ve<Q&&et-M>=0&&et+M<=D){let Le=new jl($t,ve,oe,st);Le._round(),u&&!K1(a,Le,w,u,m)||nt.push(Le)}}z+=Vt}return S||nt.length||B||(nt=J1(a,z/2,l,u,m,w,B,!0,Q)),nt}si("Anchor",jl);let vu=ho;function X1(a,e,l,u){let m=[],w=a.image,B=w.pixelRatio,S=w.paddedRect.w-2*vu,Q=w.paddedRect.h-2*vu,M=a.right-a.left,D=a.bottom-a.top,z=w.stretchX||[[0,S]],et=w.stretchY||[[0,Q]],nt=(Oe,fi)=>Oe+fi[1]-fi[0],st=z.reduce(nt,0),mt=et.reduce(nt,0),St=S-st,Vt=Q-mt,oe=0,Wt=st,$t=0,ve=mt,Le=0,ni=St,bi=0,ri=Vt;if(w.content&&u){let Oe=w.content;oe=ad(z,0,Oe[0]),$t=ad(et,0,Oe[1]),Wt=ad(z,Oe[0],Oe[2]),ve=ad(et,Oe[1],Oe[3]),Le=Oe[0]-oe,bi=Oe[1]-$t,ni=Oe[2]-Oe[0]-Wt,ri=Oe[3]-Oe[1]-ve}let ti=(Oe,fi,qe,Ze)=>{let Gi=Ad(Oe.stretch-oe,Wt,M,a.left),Bi=ld(Oe.fixed-Le,ni,Oe.stretch,st),hr=Ad(fi.stretch-$t,ve,D,a.top),jr=ld(fi.fixed-bi,ri,fi.stretch,mt),nn=Ad(qe.stretch-oe,Wt,M,a.left),kn=ld(qe.fixed-Le,ni,qe.stretch,st),Po=Ad(Ze.stretch-$t,ve,D,a.top),Ds=ld(Ze.fixed-bi,ri,Ze.stretch,mt),wn=new v(Gi,hr),os=new v(nn,hr),ps=new v(nn,Po),Ks=new v(Gi,Po),Ws=new v(Bi/B,jr/B),Ln=new v(kn/B,Ds/B),En=e*Math.PI/180;if(En){let ks=Math.sin(En),go=Math.cos(En),po=[go,-ks,ks,go];wn._matMult(po),os._matMult(po),Ks._matMult(po),ps._matMult(po)}let Fs=Oe.stretch+Oe.fixed,Os=fi.stretch+fi.fixed;return{tl:wn,tr:os,bl:Ks,br:ps,tex:{x:w.paddedRect.x+vu+Fs,y:w.paddedRect.y+vu+Os,w:qe.stretch+qe.fixed-Fs,h:Ze.stretch+Ze.fixed-Os},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ws,pixelOffsetBR:Ln,minFontScaleX:ni/B/M,minFontScaleY:ri/B/D,isSDF:l}};if(u&&(w.stretchX||w.stretchY)){let Oe=Y1(z,St,st),fi=Y1(et,Vt,mt);for(let qe=0;qe<Oe.length-1;qe++){let Ze=Oe[qe],Gi=Oe[qe+1];for(let Bi=0;Bi<fi.length-1;Bi++)m.push(ti(Ze,fi[Bi],Gi,fi[Bi+1]))}}else m.push(ti({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:Q+1}));return m}function ad(a,e,l){let u=0;for(let m of a)u+=Math.max(e,Math.min(l,m[1]))-Math.max(e,Math.min(l,m[0]));return u}function Y1(a,e,l){let u=[{fixed:-vu,stretch:0}];for(let[m,w]of a){let B=u[u.length-1];u.push({fixed:m-B.stretch,stretch:B.stretch}),u.push({fixed:m-B.stretch,stretch:B.stretch+(w-m)})}return u.push({fixed:e+vu,stretch:l}),u}function Ad(a,e,l,u){return a/e*l+u}function ld(a,e,l,u){return a-e*l/u}class cd{constructor(e,l,u,m,w,B,S,Q,M,D){if(this.boxStartIndex=e.length,M){let z=B.top,et=B.bottom,nt=B.collisionPadding;nt&&(z-=nt[1],et+=nt[3]);let st=et-z;st>0&&(st=Math.max(10,st),this.circleDiameter=st)}else{let z=B.top*S-Q[0],et=B.bottom*S+Q[2],nt=B.left*S-Q[3],st=B.right*S+Q[1],mt=B.collisionPadding;if(mt&&(nt-=mt[0]*S,z-=mt[1]*S,st+=mt[2]*S,et+=mt[3]*S),D){let St=new v(nt,z),Vt=new v(st,z),oe=new v(nt,et),Wt=new v(st,et),$t=D*Math.PI/180;St._rotate($t),Vt._rotate($t),oe._rotate($t),Wt._rotate($t),nt=Math.min(St.x,Vt.x,oe.x,Wt.x),st=Math.max(St.x,Vt.x,oe.x,Wt.x),z=Math.min(St.y,Vt.y,oe.y,Wt.y),et=Math.max(St.y,Vt.y,oe.y,Wt.y)}e.emplaceBack(l.x,l.y,nt,z,st,et,u,m,w)}this.boxEndIndex=e.length}}class qS{constructor(e=[],l=$S){if(this.data=e,this.length=this.data.length,this.compare=l,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let e=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:l,compare:u}=this,m=l[e];for(;e>0;){let w=e-1>>1,B=l[w];if(u(m,B)>=0)break;l[e]=B,e=w}l[e]=m}_down(e){let{data:l,compare:u}=this,m=this.length>>1,w=l[e];for(;e<m;){let B=1+(e<<1),S=l[B],Q=B+1;if(Q<this.length&&u(l[Q],S)<0&&(B=Q,S=l[Q]),u(S,w)>=0)break;l[e]=S,e=B}l[e]=w}}function $S(a,e){return a<e?-1:a>e?1:0}function t3(a,e=1,l=!1){let u=1/0,m=1/0,w=-1/0,B=-1/0,S=a[0];for(let nt=0;nt<S.length;nt++){let st=S[nt];(!nt||st.x<u)&&(u=st.x),(!nt||st.y<m)&&(m=st.y),(!nt||st.x>w)&&(w=st.x),(!nt||st.y>B)&&(B=st.y)}let Q=Math.min(w-u,B-m),M=Q/2,D=new qS([],e3);if(Q===0)return new v(u,m);for(let nt=u;nt<w;nt+=Q)for(let st=m;st<B;st+=Q)D.push(new wu(nt+M,st+M,M,a));let z=function(nt){let st=0,mt=0,St=0,Vt=nt[0];for(let oe=0,Wt=Vt.length,$t=Wt-1;oe<Wt;$t=oe++){let ve=Vt[oe],Le=Vt[$t],ni=ve.x*Le.y-Le.x*ve.y;mt+=(ve.x+Le.x)*ni,St+=(ve.y+Le.y)*ni,st+=3*ni}return new wu(mt/st,St/st,0,nt)}(a),et=D.length;for(;D.length;){let nt=D.pop();(nt.d>z.d||!z.d)&&(z=nt,l&&console.log("found best %d after %d probes",Math.round(1e4*nt.d)/1e4,et)),nt.max-z.d<=e||(M=nt.h/2,D.push(new wu(nt.p.x-M,nt.p.y-M,M,a)),D.push(new wu(nt.p.x+M,nt.p.y-M,M,a)),D.push(new wu(nt.p.x-M,nt.p.y+M,M,a)),D.push(new wu(nt.p.x+M,nt.p.y+M,M,a)),et+=4)}return l&&(console.log(`num probes: ${et}`),console.log(`best distance: ${z.d}`)),z.p}function e3(a,e){return e.max-a.max}function wu(a,e,l,u){this.p=new v(a,e),this.h=l,this.d=function(m,w){let B=!1,S=1/0;for(let Q=0;Q<w.length;Q++){let M=w[Q];for(let D=0,z=M.length,et=z-1;D<z;et=D++){let nt=M[D],st=M[et];nt.y>m.y!=st.y>m.y&&m.x<(st.x-nt.x)*(m.y-nt.y)/(st.y-nt.y)+nt.x&&(B=!B),S=Math.min(S,Fc(m,nt,st))}}return(B?1:-1)*Math.sqrt(S)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var ds;A.ap=void 0,(ds=A.ap||(A.ap={}))[ds.center=1]="center",ds[ds.left=2]="left",ds[ds.right=3]="right",ds[ds.top=4]="top",ds[ds.bottom=5]="bottom",ds[ds["top-left"]=6]="top-left",ds[ds["top-right"]=7]="top-right",ds[ds["bottom-left"]=8]="bottom-left",ds[ds["bottom-right"]=9]="bottom-right";let ql=7,Um=Number.POSITIVE_INFINITY;function j1(a,e){return e[1]!==Um?function(l,u,m){let w=0,B=0;switch(u=Math.abs(u),m=Math.abs(m),l){case"top-right":case"top-left":case"top":B=m-ql;break;case"bottom-right":case"bottom-left":case"bottom":B=-m+ql}switch(l){case"top-right":case"bottom-right":case"right":w=-u;break;case"top-left":case"bottom-left":case"left":w=u}return[w,B]}(a,e[0],e[1]):function(l,u){let m=0,w=0;u<0&&(u=0);let B=u/Math.SQRT2;switch(l){case"top-right":case"top-left":w=B-ql;break;case"bottom-right":case"bottom-left":w=-B+ql;break;case"bottom":w=-u+ql;break;case"top":w=u-ql}switch(l){case"top-right":case"bottom-right":m=-B;break;case"top-left":case"bottom-left":m=B;break;case"left":m=u;break;case"right":m=-u}return[m,w]}(a,e[0])}function q1(a,e,l){var u;let m=a.layout,w=(u=m.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(e,{},l);if(w){let S=w.values,Q=[];for(let M=0;M<S.length;M+=2){let D=Q[M]=S[M],z=S[M+1].map(et=>et*Fn);D.startsWith("top")?z[1]-=ql:D.startsWith("bottom")&&(z[1]+=ql),Q[M+1]=z}return new an(Q)}let B=m.get("text-variable-anchor");if(B){let S;S=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(e,{},l)*Fn,Um]:m.get("text-offset").evaluate(e,{},l).map(M=>M*Fn);let Q=[];for(let M of B)Q.push(M,j1(M,S));return new an(Q)}return null}function Gm(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function i3(a,e,l,u,m,w,B,S,Q,M,D){let z=w.textMaxSize.evaluate(e,{});z===void 0&&(z=B);let et=a.layers[0].layout,nt=et.get("icon-offset").evaluate(e,{},D),st=tb(l.horizontal),mt=B/24,St=a.tilePixelRatio*mt,Vt=a.tilePixelRatio*z/24,oe=a.tilePixelRatio*S,Wt=a.tilePixelRatio*et.get("symbol-spacing"),$t=et.get("text-padding")*a.tilePixelRatio,ve=function(Ze,Gi,Bi,hr=1){let jr=Ze.get("icon-padding").evaluate(Gi,{},Bi),nn=jr&&jr.values;return[nn[0]*hr,nn[1]*hr,nn[2]*hr,nn[3]*hr]}(et,e,D,a.tilePixelRatio),Le=et.get("text-max-angle")/180*Math.PI,ni=et.get("text-rotation-alignment")!=="viewport"&&et.get("symbol-placement")!=="point",bi=et.get("icon-rotation-alignment")==="map"&&et.get("symbol-placement")!=="point",ri=et.get("symbol-placement"),ti=Wt/2,Oe=et.get("icon-text-fit"),fi;u&&Oe!=="none"&&(a.allowVerticalPlacement&&l.vertical&&(fi=w1(u,l.vertical,Oe,et.get("icon-text-fit-padding"),nt,mt)),st&&(u=w1(u,st,Oe,et.get("icon-text-fit-padding"),nt,mt)));let qe=(Ze,Gi)=>{Gi.x<0||Gi.x>=$i||Gi.y<0||Gi.y>=$i||function(Bi,hr,jr,nn,kn,Po,Ds,wn,os,ps,Ks,Ws,Ln,En,Fs,Os,ks,go,po,Tn,mr,Ls,fs,Qn,ba){let Ja=Bi.addToLineVertexArray(hr,jr),Xa,fl,va,aa,fo=0,ml=0,Hh=0,nb=0,Dm=-1,Km=-1,Cl={},sb=pi("");if(Bi.allowVerticalPlacement&&nn.vertical){let Es=wn.layout.get("text-rotate").evaluate(mr,{},Qn)+90;va=new cd(os,hr,ps,Ks,Ws,nn.vertical,Ln,En,Fs,Es),Ds&&(aa=new cd(os,hr,ps,Ks,Ws,Ds,ks,go,Fs,Es))}if(kn){let Es=wn.layout.get("icon-rotate").evaluate(mr,{}),Aa=wn.layout.get("icon-text-fit")!=="none",Tc=X1(kn,Es,fs,Aa),ja=Ds?X1(Ds,Es,fs,Aa):void 0;fl=new cd(os,hr,ps,Ks,Ws,kn,ks,go,!1,Es),fo=4*Tc.length;let Qc=Bi.iconSizeData,VA=null;Qc.kind==="source"?(VA=[NA*wn.layout.get("icon-size").evaluate(mr,{})],VA[0]>Xl&&At(`${Bi.layerIds[0]}: Value for "icon-size" is >= ${Qh}. Reduce your "icon-size".`)):Qc.kind==="composite"&&(VA=[NA*Ls.compositeIconSizes[0].evaluate(mr,{},Qn),NA*Ls.compositeIconSizes[1].evaluate(mr,{},Qn)],(VA[0]>Xl||VA[1]>Xl)&&At(`${Bi.layerIds[0]}: Value for "icon-size" is >= ${Qh}. Reduce your "icon-size".`)),Bi.addSymbols(Bi.icon,Tc,VA,Tn,po,mr,A.ah.none,hr,Ja.lineStartIndex,Ja.lineLength,-1,Qn),Dm=Bi.icon.placedSymbolArray.length-1,ja&&(ml=4*ja.length,Bi.addSymbols(Bi.icon,ja,VA,Tn,po,mr,A.ah.vertical,hr,Ja.lineStartIndex,Ja.lineLength,-1,Qn),Km=Bi.icon.placedSymbolArray.length-1)}let ob=Object.keys(nn.horizontal);for(let Es of ob){let Aa=nn.horizontal[Es];if(!Xa){sb=pi(Aa.text);let ja=wn.layout.get("text-rotate").evaluate(mr,{},Qn);Xa=new cd(os,hr,ps,Ks,Ws,Aa,Ln,En,Fs,ja)}let Tc=Aa.positionedLines.length===1;if(Hh+=$1(Bi,hr,Aa,Po,wn,Fs,mr,Os,Ja,nn.vertical?A.ah.horizontal:A.ah.horizontalOnly,Tc?ob:[Es],Cl,Dm,Ls,Qn),Tc)break}nn.vertical&&(nb+=$1(Bi,hr,nn.vertical,Po,wn,Fs,mr,Os,Ja,A.ah.vertical,["vertical"],Cl,Km,Ls,Qn));let s3=Xa?Xa.boxStartIndex:Bi.collisionBoxArray.length,o3=Xa?Xa.boxEndIndex:Bi.collisionBoxArray.length,a3=va?va.boxStartIndex:Bi.collisionBoxArray.length,A3=va?va.boxEndIndex:Bi.collisionBoxArray.length,l3=fl?fl.boxStartIndex:Bi.collisionBoxArray.length,c3=fl?fl.boxEndIndex:Bi.collisionBoxArray.length,u3=aa?aa.boxStartIndex:Bi.collisionBoxArray.length,h3=aa?aa.boxEndIndex:Bi.collisionBoxArray.length,Ya=-1,hd=(Es,Aa)=>Es&&Es.circleDiameter?Math.max(Es.circleDiameter,Aa):Aa;Ya=hd(Xa,Ya),Ya=hd(va,Ya),Ya=hd(fl,Ya),Ya=hd(aa,Ya);let ab=Ya>-1?1:0;ab&&(Ya*=ba/Fn),Bi.glyphOffsetArray.length>=bu.MAX_GLYPHS&&At("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mr.sortKey!==void 0&&Bi.addToSortKeyRanges(Bi.symbolInstances.length,mr.sortKey);let g3=q1(wn,mr,Qn),[d3,p3]=function(Es,Aa){let Tc=Es.length,ja=Aa?.values;if(ja?.length>0)for(let Qc=0;Qc<ja.length;Qc+=2){let VA=ja[Qc+1];Es.emplaceBack(A.ap[ja[Qc]],VA[0],VA[1])}return[Tc,Es.length]}(Bi.textAnchorOffsets,g3);Bi.symbolInstances.emplaceBack(hr.x,hr.y,Cl.right>=0?Cl.right:-1,Cl.center>=0?Cl.center:-1,Cl.left>=0?Cl.left:-1,Cl.vertical||-1,Dm,Km,sb,s3,o3,a3,A3,l3,c3,u3,h3,ps,Hh,nb,fo,ml,ab,0,Ln,Ya,d3,p3)}(a,Gi,Ze,l,u,m,fi,a.layers[0],a.collisionBoxArray,e.index,e.sourceLayerIndex,a.index,St,[$t,$t,$t,$t],ni,Q,oe,ve,bi,nt,e,w,M,D,B)};if(ri==="line")for(let Ze of D1(e.geometry,0,0,$i,$i)){let Gi=jS(Ze,Wt,Le,l.vertical||st,u,24,Vt,a.overscaling,$i);for(let Bi of Gi)st&&r3(a,st.text,ti,Bi)||qe(Ze,Bi)}else if(ri==="line-center"){for(let Ze of e.geometry)if(Ze.length>1){let Gi=YS(Ze,Le,l.vertical||st,u,24,Vt);Gi&&qe(Ze,Gi)}}else if(e.type==="Polygon")for(let Ze of gm(e.geometry,0)){let Gi=t3(Ze,16);qe(Ze[0],new jl(Gi.x,Gi.y,0))}else if(e.type==="LineString")for(let Ze of e.geometry)qe(Ze,new jl(Ze[0].x,Ze[0].y,0));else if(e.type==="Point")for(let Ze of e.geometry)for(let Gi of Ze)qe([Gi],new jl(Gi.x,Gi.y,0))}function $1(a,e,l,u,m,w,B,S,Q,M,D,z,et,nt,st){let mt=function(oe,Wt,$t,ve,Le,ni,bi,ri){let ti=ve.layout.get("text-rotate").evaluate(ni,{})*Math.PI/180,Oe=[];for(let fi of Wt.positionedLines)for(let qe of fi.positionedGlyphs){if(!qe.rect)continue;let Ze=qe.rect||{},Gi=f1+1,Bi=!0,hr=1,jr=0,nn=(Le||ri)&&qe.vertical,kn=qe.metrics.advance*qe.scale/2;if(ri&&Wt.verticalizable&&(jr=fi.lineOffset/2-(qe.imageName?-(Fn-qe.metrics.width*qe.scale)/2:(qe.scale-1)*Fn)),qe.imageName){let Tn=bi[qe.imageName];Bi=Tn.sdf,hr=Tn.pixelRatio,Gi=ho/hr}let Po=Le?[qe.x+kn,qe.y]:[0,0],Ds=Le?[0,0]:[qe.x+kn+$t[0],qe.y+$t[1]-jr],wn=[0,0];nn&&(wn=Ds,Ds=[0,0]);let os=qe.metrics.isDoubleResolution?2:1,ps=(qe.metrics.left-Gi)*qe.scale-kn+Ds[0],Ks=(-qe.metrics.top-Gi)*qe.scale+Ds[1],Ws=ps+Ze.w/os*qe.scale/hr,Ln=Ks+Ze.h/os*qe.scale/hr,En=new v(ps,Ks),Fs=new v(Ws,Ks),Os=new v(ps,Ln),ks=new v(Ws,Ln);if(nn){let Tn=new v(-kn,kn-Eh),mr=-Math.PI/2,Ls=Fn/2-kn,fs=new v(5-Eh-Ls,-(qe.imageName?Ls:0)),Qn=new v(...wn);En._rotateAround(mr,Tn)._add(fs)._add(Qn),Fs._rotateAround(mr,Tn)._add(fs)._add(Qn),Os._rotateAround(mr,Tn)._add(fs)._add(Qn),ks._rotateAround(mr,Tn)._add(fs)._add(Qn)}if(ti){let Tn=Math.sin(ti),mr=Math.cos(ti),Ls=[mr,-Tn,Tn,mr];En._matMult(Ls),Fs._matMult(Ls),Os._matMult(Ls),ks._matMult(Ls)}let go=new v(0,0),po=new v(0,0);Oe.push({tl:En,tr:Fs,bl:Os,br:ks,tex:Ze,writingMode:Wt.writingMode,glyphOffset:Po,sectionIndex:qe.sectionIndex,isSDF:Bi,pixelOffsetTL:go,pixelOffsetBR:po,minFontScaleX:0,minFontScaleY:0})}return Oe}(0,l,S,m,w,B,u,a.allowVerticalPlacement),St=a.textSizeData,Vt=null;St.kind==="source"?(Vt=[NA*m.layout.get("text-size").evaluate(B,{})],Vt[0]>Xl&&At(`${a.layerIds[0]}: Value for "text-size" is >= ${Qh}. Reduce your "text-size".`)):St.kind==="composite"&&(Vt=[NA*nt.compositeTextSizes[0].evaluate(B,{},st),NA*nt.compositeTextSizes[1].evaluate(B,{},st)],(Vt[0]>Xl||Vt[1]>Xl)&&At(`${a.layerIds[0]}: Value for "text-size" is >= ${Qh}. Reduce your "text-size".`)),a.addSymbols(a.text,mt,Vt,S,w,B,M,e,Q.lineStartIndex,Q.lineLength,et,st);for(let oe of D)z[oe]=a.text.placedSymbolArray.length-1;return 4*mt.length}function tb(a){for(let e in a)return a[e];return null}function r3(a,e,l,u){let m=a.compareText;if(e in m){let w=m[e];for(let B=w.length-1;B>=0;B--)if(u.dist(w[B])<l)return!0}else m[e]=[];return m[e].push(u),!1}let eb=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Rm{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[l,u]=new Uint8Array(e,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");let m=u>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);let w=eb[15&u];if(!w)throw new Error("Unrecognized array type.");let[B]=new Uint16Array(e,2,1),[S]=new Uint32Array(e,4,1);return new Rm(S,B,w,e)}constructor(e,l=64,u=Float64Array,m){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=u,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let w=eb.indexOf(this.ArrayType),B=2*e*this.ArrayType.BYTES_PER_ELEMENT,S=e*this.IndexArrayType.BYTES_PER_ELEMENT,Q=(8-S%8)%8;if(w<0)throw new Error(`Unexpected typed array class: ${u}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+S+Q,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+B+S+Q),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+S+Q,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+w]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=e)}add(e,l){let u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=e,this.coords[this._pos++]=l,u}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Hm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,l,u,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:w,coords:B,nodeSize:S}=this,Q=[0,w.length-1,0],M=[];for(;Q.length;){let D=Q.pop()||0,z=Q.pop()||0,et=Q.pop()||0;if(z-et<=S){for(let St=et;St<=z;St++){let Vt=B[2*St],oe=B[2*St+1];Vt>=e&&Vt<=u&&oe>=l&&oe<=m&&M.push(w[St])}continue}let nt=et+z>>1,st=B[2*nt],mt=B[2*nt+1];st>=e&&st<=u&&mt>=l&&mt<=m&&M.push(w[nt]),(D===0?e<=st:l<=mt)&&(Q.push(et),Q.push(nt-1),Q.push(1-D)),(D===0?u>=st:m>=mt)&&(Q.push(nt+1),Q.push(z),Q.push(1-D))}return M}within(e,l,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:m,coords:w,nodeSize:B}=this,S=[0,m.length-1,0],Q=[],M=u*u;for(;S.length;){let D=S.pop()||0,z=S.pop()||0,et=S.pop()||0;if(z-et<=B){for(let St=et;St<=z;St++)rb(w[2*St],w[2*St+1],e,l)<=M&&Q.push(m[St]);continue}let nt=et+z>>1,st=w[2*nt],mt=w[2*nt+1];rb(st,mt,e,l)<=M&&Q.push(m[nt]),(D===0?e-u<=st:l-u<=mt)&&(S.push(et),S.push(nt-1),S.push(1-D)),(D===0?e+u>=st:l+u>=mt)&&(S.push(nt+1),S.push(z),S.push(1-D))}return Q}}function Hm(a,e,l,u,m,w){if(m-u<=l)return;let B=u+m>>1;ib(a,e,B,u,m,w),Hm(a,e,l,u,B-1,1-w),Hm(a,e,l,B+1,m,1-w)}function ib(a,e,l,u,m,w){for(;m>u;){if(m-u>600){let M=m-u+1,D=l-u+1,z=Math.log(M),et=.5*Math.exp(2*z/3),nt=.5*Math.sqrt(z*et*(M-et)/M)*(D-M/2<0?-1:1);ib(a,e,l,Math.max(u,Math.floor(l-D*et/M+nt)),Math.min(m,Math.floor(l+(M-D)*et/M+nt)),w)}let B=e[2*l+w],S=u,Q=m;for(Gh(a,e,u,l),e[2*m+w]>B&&Gh(a,e,u,m);S<Q;){for(Gh(a,e,S,Q),S++,Q--;e[2*S+w]<B;)S++;for(;e[2*Q+w]>B;)Q--}e[2*u+w]===B?Gh(a,e,u,Q):(Q++,Gh(a,e,Q,m)),Q<=l&&(u=Q+1),l<=Q&&(m=Q-1)}}function Gh(a,e,l,u){Zm(a,l,u),Zm(e,2*l,2*u),Zm(e,2*l+1,2*u+1)}function Zm(a,e,l){let u=a[e];a[e]=a[l],a[l]=u}function rb(a,e,l,u){let m=a-l,w=e-u;return m*m+w*w}var Pm;A.bd=void 0,(Pm=A.bd||(A.bd={})).create="create",Pm.load="load",Pm.fullLoad="fullLoad";let ud=null,Rh=[],Mm=1e3/60,Nm="loadTime",Vm="fullLoadTime",n3={mark(a){performance.mark(a)},frame(a){let e=a;ud!=null&&Rh.push(e-ud),ud=e},clearMetrics(){ud=null,Rh=[],performance.clearMeasures(Nm),performance.clearMeasures(Vm);for(let a in A.bd)performance.clearMarks(A.bd[a])},getPerformanceMetrics(){performance.measure(Nm,A.bd.create,A.bd.load),performance.measure(Vm,A.bd.create,A.bd.fullLoad);let a=performance.getEntriesByName(Nm)[0].duration,e=performance.getEntriesByName(Vm)[0].duration,l=Rh.length,u=1/(Rh.reduce((w,B)=>w+B,0)/l/1e3),m=Rh.filter(w=>w>Mm).reduce((w,B)=>w+(B-Mm)/Mm,0);return{loadTime:a,fullLoadTime:e,fps:u,percentDroppedFrames:m/(l+m)*100,totalFrames:l}}};A.$=Ct,A.A=Vl,A.B=function(a){if(le==null){let e=a.navigator?a.navigator.userAgent:null;le=!!a.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return le},A.C=class{constructor(a,e){this.target=a,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new JS(()=>this.process()),this.subscription=function(l,u,m,w){return l.addEventListener(u,m,!1),{unsubscribe:()=>{l.removeEventListener(u,m,!1)}}}(this.target,"message",l=>this.receive(l)),this.globalScope=_t(self)?a:window}registerMessageHandler(a,e){this.messageHandlers[a]=e}sendAsync(a,e){return new Promise((l,u)=>{let m=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[m]={resolve:l,reject:u},e&&e.signal.addEventListener("abort",()=>{delete this.resolveRejects[m];let S={id:m,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(S)},{once:!0});let w=[],B=Object.assign(Object.assign({},a),{id:m,sourceMapId:this.mapId,origin:location.origin,data:Ca(a.data,w)});this.target.postMessage(B,{transfer:w})})}receive(a){let e=a.data,l=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[l];let u=this.abortControllers[l];return delete this.abortControllers[l],void(u&&u.abort())}if(_t(self)||e.mustQueue)return this.tasks[l]=e,this.taskQueue.push(l),void this.invoker.trigger();this.processTask(l,e)}}process(){if(this.taskQueue.length===0)return;let a=this.taskQueue.shift(),e=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(a,e)}processTask(a,e){return o(this,void 0,void 0,function*(){if(e.type==="<response>"){let m=this.resolveRejects[a];return delete this.resolveRejects[a],m?void(e.error?m.reject(Za(e.error)):m.resolve(Za(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));let l=Za(e.data),u=new AbortController;this.abortControllers[a]=u;try{let m=yield this.messageHandlers[e.type](e.sourceMapId,l,u);this.completeTask(a,null,m)}catch(m){this.completeTask(a,m)}})}completeTask(a,e,l){let u=[];delete this.abortControllers[a];let m={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?Ca(e):null,data:Ca(l,u)};this.target.postMessage(m,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},A.D=wi,A.E=gi,A.F=function(){var a=new Vl(16);return Vl!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},A.G=Ht,A.H=function(a,e,l){var u,m,w,B,S,Q,M,D,z,et,nt,st,mt=l[0],St=l[1],Vt=l[2];return e===a?(a[12]=e[0]*mt+e[4]*St+e[8]*Vt+e[12],a[13]=e[1]*mt+e[5]*St+e[9]*Vt+e[13],a[14]=e[2]*mt+e[6]*St+e[10]*Vt+e[14],a[15]=e[3]*mt+e[7]*St+e[11]*Vt+e[15]):(m=e[1],w=e[2],B=e[3],S=e[4],Q=e[5],M=e[6],D=e[7],z=e[8],et=e[9],nt=e[10],st=e[11],a[0]=u=e[0],a[1]=m,a[2]=w,a[3]=B,a[4]=S,a[5]=Q,a[6]=M,a[7]=D,a[8]=z,a[9]=et,a[10]=nt,a[11]=st,a[12]=u*mt+S*St+z*Vt+e[12],a[13]=m*mt+Q*St+et*Vt+e[13],a[14]=w*mt+M*St+nt*Vt+e[14],a[15]=B*mt+D*St+st*Vt+e[15]),a},A.I=wm,A.J=function(a,e,l){var u=l[0],m=l[1],w=l[2];return a[0]=e[0]*u,a[1]=e[1]*u,a[2]=e[2]*u,a[3]=e[3]*u,a[4]=e[4]*m,a[5]=e[5]*m,a[6]=e[6]*m,a[7]=e[7]*m,a[8]=e[8]*w,a[9]=e[9]*w,a[10]=e[10]*w,a[11]=e[11]*w,a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},A.K=Ch,A.L=function(a,e){let l={};for(let u=0;u<e.length;u++){let m=e[u];m in a&&(l[m]=a[m])}return l},A.M=Yl,A.N=T1,A.O=Q1,A.P=v,A.Q=oa,A.R=Vs,A.S=K,A.T=Al,A.U=$,A.V=te,A.W=$i,A.X=dn,A.Y=od,A.Z=class extends ss{},A._=o,A.a=bt,A.a$=function(a,e,l){return a[0]=e[0]*l[0],a[1]=e[1]*l[1],a[2]=e[2]*l[2],a[3]=e[3]*l[3],a},A.a0=Qm,A.a1=Ie,A.a2=a=>{let e=window.document.createElement("video");return e.muted=!0,new Promise(l=>{e.onloadstart=()=>{l(e)};for(let u of a){let m=window.document.createElement("source");de(u)||(e.crossOrigin="Anonymous"),m.src=u,e.appendChild(m)}})},A.a3=function(){return Qt++},A.a4=Au,A.a5=bu,A.a6=ga,A.a7=sa,A.a8=Hr,A.a9=P1,A.aA=Jt,A.aB=function(a,e){if(!a)return[{command:"setStyle",args:[e]}];let l=[];try{if(!Ue(a.version,e.version))return[{command:"setStyle",args:[e]}];Ue(a.center,e.center)||l.push({command:"setCenter",args:[e.center]}),Ue(a.zoom,e.zoom)||l.push({command:"setZoom",args:[e.zoom]}),Ue(a.bearing,e.bearing)||l.push({command:"setBearing",args:[e.bearing]}),Ue(a.pitch,e.pitch)||l.push({command:"setPitch",args:[e.pitch]}),Ue(a.sprite,e.sprite)||l.push({command:"setSprite",args:[e.sprite]}),Ue(a.glyphs,e.glyphs)||l.push({command:"setGlyphs",args:[e.glyphs]}),Ue(a.transition,e.transition)||l.push({command:"setTransition",args:[e.transition]}),Ue(a.light,e.light)||l.push({command:"setLight",args:[e.light]}),Ue(a.terrain,e.terrain)||l.push({command:"setTerrain",args:[e.terrain]}),Ue(a.sky,e.sky)||l.push({command:"setSky",args:[e.sky]});let u={},m=[];(function(B,S,Q,M){let D;for(D in S=S||{},B=B||{})Object.prototype.hasOwnProperty.call(B,D)&&(Object.prototype.hasOwnProperty.call(S,D)||Je(D,Q,M));for(D in S)Object.prototype.hasOwnProperty.call(S,D)&&(Object.prototype.hasOwnProperty.call(B,D)?Ue(B[D],S[D])||(B[D].type==="geojson"&&S[D].type==="geojson"&&ui(B,S,D)?Ee(Q,{command:"setGeoJSONSourceData",args:[D,S[D].data]}):ze(D,S,Q,M)):Ne(D,S,Q))})(a.sources,e.sources,m,u);let w=[];a.layers&&a.layers.forEach(B=>{"source"in B&&u[B.source]?l.push({command:"removeLayer",args:[B.id]}):w.push(B)}),l=l.concat(m),function(B,S,Q){S=S||[];let M=(B=B||[]).map(Ei),D=S.map(Ei),z=B.reduce(Pi,{}),et=S.reduce(Pi,{}),nt=M.slice(),st=Object.create(null),mt,St,Vt,oe,Wt;for(let $t=0,ve=0;$t<M.length;$t++)mt=M[$t],Object.prototype.hasOwnProperty.call(et,mt)?ve++:(Ee(Q,{command:"removeLayer",args:[mt]}),nt.splice(nt.indexOf(mt,ve),1));for(let $t=0,ve=0;$t<D.length;$t++)mt=D[D.length-1-$t],nt[nt.length-1-$t]!==mt&&(Object.prototype.hasOwnProperty.call(z,mt)?(Ee(Q,{command:"removeLayer",args:[mt]}),nt.splice(nt.lastIndexOf(mt,nt.length-ve),1)):ve++,oe=nt[nt.length-$t],Ee(Q,{command:"addLayer",args:[et[mt],oe]}),nt.splice(nt.length-$t,0,mt),st[mt]=!0);for(let $t=0;$t<D.length;$t++)if(mt=D[$t],St=z[mt],Vt=et[mt],!st[mt]&&!Ue(St,Vt))if(Ue(St.source,Vt.source)&&Ue(St["source-layer"],Vt["source-layer"])&&Ue(St.type,Vt.type)){for(Wt in hi(St.layout,Vt.layout,Q,mt,null,"setLayoutProperty"),hi(St.paint,Vt.paint,Q,mt,null,"setPaintProperty"),Ue(St.filter,Vt.filter)||Ee(Q,{command:"setFilter",args:[mt,Vt.filter]}),Ue(St.minzoom,Vt.minzoom)&&Ue(St.maxzoom,Vt.maxzoom)||Ee(Q,{command:"setLayerZoomRange",args:[mt,Vt.minzoom,Vt.maxzoom]}),St)Object.prototype.hasOwnProperty.call(St,Wt)&&Wt!=="layout"&&Wt!=="paint"&&Wt!=="filter"&&Wt!=="metadata"&&Wt!=="minzoom"&&Wt!=="maxzoom"&&(Wt.indexOf("paint.")===0?hi(St[Wt],Vt[Wt],Q,mt,Wt.slice(6),"setPaintProperty"):Ue(St[Wt],Vt[Wt])||Ee(Q,{command:"setLayerProperty",args:[mt,Wt,Vt[Wt]]}));for(Wt in Vt)Object.prototype.hasOwnProperty.call(Vt,Wt)&&!Object.prototype.hasOwnProperty.call(St,Wt)&&Wt!=="layout"&&Wt!=="paint"&&Wt!=="filter"&&Wt!=="metadata"&&Wt!=="minzoom"&&Wt!=="maxzoom"&&(Wt.indexOf("paint.")===0?hi(St[Wt],Vt[Wt],Q,mt,Wt.slice(6),"setPaintProperty"):Ue(St[Wt],Vt[Wt])||Ee(Q,{command:"setLayerProperty",args:[mt,Wt,Vt[Wt]]}))}else Ee(Q,{command:"removeLayer",args:[mt]}),oe=nt[nt.lastIndexOf(mt)+1],Ee(Q,{command:"addLayer",args:[Vt,oe]})}(w,e.layers,l)}catch(u){console.warn("Unable to compute style diff:",u),l=[{command:"setStyle",args:[e]}]}return l},A.aC=function(a){let e=[],l=a.id;return l===void 0&&e.push({message:`layers.${l}: missing required property "id"`}),a.render===void 0&&e.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&e.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),e},A.aD=function a(e,l){if(Array.isArray(e)){if(!Array.isArray(l)||e.length!==l.length)return!1;for(let u=0;u<e.length;u++)if(!a(e[u],l[u]))return!1;return!0}if(typeof e=="object"&&e!==null&&l!==null){if(typeof l!="object"||Object.keys(e).length!==Object.keys(l).length)return!1;for(let u in e)if(!a(e[u],l[u]))return!1;return!0}return e===l},A.aE=Ft,A.aF=vt,A.aG=class extends Ii{constructor(a,e){super(a,e),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},A.aH=vr,A.aI=class extends Ii{constructor(a,e){super(a,e),this.current=mn}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let e=1;e<16;e++)if(a[e]!==this.current[e]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},A.aJ=Yr,A.aK=class extends Ii{constructor(a,e){super(a,e),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},A.aL=class extends Ii{constructor(a,e){super(a,e),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},A.aM=Gr,A.aN=function(a,e,l,u,m,w,B){var S=1/(e-l),Q=1/(u-m),M=1/(w-B);return a[0]=-2*S,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*Q,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*M,a[11]=0,a[12]=(e+l)*S,a[13]=(m+u)*Q,a[14]=(B+w)*M,a[15]=1,a},A.aO=Ji,A.aP=Jg,A.aQ=class extends kA{},A.aR=vS,A.aS=class extends Va{},A.aT=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},A.aU=bh,A.aV=I,A.aW=class extends xc{},A.aX=ut,A.aY=function(a,e){return a[0]===e[0]&&a[1]===e[1]&&a[2]===e[2]&&a[3]===e[3]&&a[4]===e[4]&&a[5]===e[5]&&a[6]===e[6]&&a[7]===e[7]&&a[8]===e[8]&&a[9]===e[9]&&a[10]===e[10]&&a[11]===e[11]&&a[12]===e[12]&&a[13]===e[13]&&a[14]===e[14]&&a[15]===e[15]},A.aZ=function(a,e){var l=a[0],u=a[1],m=a[2],w=a[3],B=a[4],S=a[5],Q=a[6],M=a[7],D=a[8],z=a[9],et=a[10],nt=a[11],st=a[12],mt=a[13],St=a[14],Vt=a[15],oe=e[0],Wt=e[1],$t=e[2],ve=e[3],Le=e[4],ni=e[5],bi=e[6],ri=e[7],ti=e[8],Oe=e[9],fi=e[10],qe=e[11],Ze=e[12],Gi=e[13],Bi=e[14],hr=e[15];return Math.abs(l-oe)<=gs*Math.max(1,Math.abs(l),Math.abs(oe))&&Math.abs(u-Wt)<=gs*Math.max(1,Math.abs(u),Math.abs(Wt))&&Math.abs(m-$t)<=gs*Math.max(1,Math.abs(m),Math.abs($t))&&Math.abs(w-ve)<=gs*Math.max(1,Math.abs(w),Math.abs(ve))&&Math.abs(B-Le)<=gs*Math.max(1,Math.abs(B),Math.abs(Le))&&Math.abs(S-ni)<=gs*Math.max(1,Math.abs(S),Math.abs(ni))&&Math.abs(Q-bi)<=gs*Math.max(1,Math.abs(Q),Math.abs(bi))&&Math.abs(M-ri)<=gs*Math.max(1,Math.abs(M),Math.abs(ri))&&Math.abs(D-ti)<=gs*Math.max(1,Math.abs(D),Math.abs(ti))&&Math.abs(z-Oe)<=gs*Math.max(1,Math.abs(z),Math.abs(Oe))&&Math.abs(et-fi)<=gs*Math.max(1,Math.abs(et),Math.abs(fi))&&Math.abs(nt-qe)<=gs*Math.max(1,Math.abs(nt),Math.abs(qe))&&Math.abs(st-Ze)<=gs*Math.max(1,Math.abs(st),Math.abs(Ze))&&Math.abs(mt-Gi)<=gs*Math.max(1,Math.abs(mt),Math.abs(Gi))&&Math.abs(St-Bi)<=gs*Math.max(1,Math.abs(St),Math.abs(Bi))&&Math.abs(Vt-hr)<=gs*Math.max(1,Math.abs(Vt),Math.abs(hr))},A.a_=function(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},A.aa=function(a){let e={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,u,m,w)=>{let B=m||w;return e[u]=!B||B.toLowerCase(),""}),e["max-age"]){let l=parseInt(e["max-age"],10);isNaN(l)?delete e["max-age"]:e["max-age"]=l}return e},A.ab=function(a,e){let l=[];for(let u in a)u in e||l.push(u);return l},A.ac=at,A.ad=function(a,e,l){var u=Math.sin(l),m=Math.cos(l),w=e[0],B=e[1],S=e[2],Q=e[3],M=e[4],D=e[5],z=e[6],et=e[7];return e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=w*m+M*u,a[1]=B*m+D*u,a[2]=S*m+z*u,a[3]=Q*m+et*u,a[4]=M*m-w*u,a[5]=D*m-B*u,a[6]=z*m-S*u,a[7]=et*m-Q*u,a},A.ae=function(a){var e=new Vl(16);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[4]=a[4],e[5]=a[5],e[6]=a[6],e[7]=a[7],e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15],e},A.af=kc,A.ag=function(a,e){let l=0,u=0;if(a.kind==="constant")u=a.layoutSize;else if(a.kind!=="source"){let{interpolationType:m,minZoom:w,maxZoom:B}=a,S=m?at(cn.interpolationFactor(m,e,w,B),0,1):0;a.kind==="camera"?u=qn.number(a.minSize,a.maxSize,S):l=S}return{uSizeT:l,uSize:u}},A.ai=function(a,{uSize:e,uSizeT:l},{lowerSize:u,upperSize:m}){return a.kind==="source"?u/NA:a.kind==="composite"?qn.number(u/NA,m/NA,l):e},A.aj=Sm,A.ak=function(a,e,l,u){let m=e.y-a.y,w=e.x-a.x,B=u.y-l.y,S=u.x-l.x,Q=B*w-S*m;if(Q===0)return null;let M=(S*(a.y-l.y)-B*(a.x-l.x))/Q;return new v(a.x+M*w,a.y+M*m)},A.al=D1,A.am=Ro,A.an=mh,A.ao=Fn,A.aq=xm,A.ar=function(a,e){var l=e[0],u=e[1],m=e[2],w=e[3],B=e[4],S=e[5],Q=e[6],M=e[7],D=e[8],z=e[9],et=e[10],nt=e[11],st=e[12],mt=e[13],St=e[14],Vt=e[15],oe=l*S-u*B,Wt=l*Q-m*B,$t=l*M-w*B,ve=u*Q-m*S,Le=u*M-w*S,ni=m*M-w*Q,bi=D*mt-z*st,ri=D*St-et*st,ti=D*Vt-nt*st,Oe=z*St-et*mt,fi=z*Vt-nt*mt,qe=et*Vt-nt*St,Ze=oe*qe-Wt*fi+$t*Oe+ve*ti-Le*ri+ni*bi;return Ze?(a[0]=(S*qe-Q*fi+M*Oe)*(Ze=1/Ze),a[1]=(m*fi-u*qe-w*Oe)*Ze,a[2]=(mt*ni-St*Le+Vt*ve)*Ze,a[3]=(et*Le-z*ni-nt*ve)*Ze,a[4]=(Q*ti-B*qe-M*ri)*Ze,a[5]=(l*qe-m*ti+w*ri)*Ze,a[6]=(St*$t-st*ni-Vt*Wt)*Ze,a[7]=(D*ni-et*$t+nt*Wt)*Ze,a[8]=(B*fi-S*ti+M*bi)*Ze,a[9]=(u*ti-l*fi-w*bi)*Ze,a[10]=(st*Le-mt*$t+Vt*oe)*Ze,a[11]=(z*$t-D*Le-nt*oe)*Ze,a[12]=(S*ri-B*Oe-Q*bi)*Ze,a[13]=(l*Oe-u*ri+m*bi)*Ze,a[14]=(mt*Wt-st*ve-St*oe)*Ze,a[15]=(D*ve-z*Wt+et*oe)*Ze,a):null},A.as=Gm,A.at=_m,A.au=Rm,A.av=function(){let a={},e=xt.$version;for(let l in xt.$root){let u=xt.$root[l];if(u.required){let m=null;m=l==="version"?e:u.type==="array"?[]:{},m!=null&&(a[l]=m)}}return a},A.aw=Ul,A.ax=Ae,A.ay=function(a){a=a.slice();let e=Object.create(null);for(let l=0;l<a.length;l++)e[a[l].id]=a[l];for(let l=0;l<a.length;l++)"ref"in a[l]&&(a[l]=Li(a[l],e[a[l].ref]));return a},A.az=function(a){if(a.type==="custom")return new zS(a);switch(a.type){case"background":return new KS(a);case"circle":return new uu(a);case"fill":return new X5(a);case"fill-extrusion":return new cS(a);case"heatmap":return new am(a);case"hillshade":return new Am(a);case"line":return new CS(a);case"raster":return new OS(a);case"symbol":return new sd(a)}},A.b=ie,A.b0=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]*e[3]},A.b1=Lt,A.b2=R1,A.b3=U1,A.b4=function(a,e,l,u,m){var w,B=1/Math.tan(e/2);return a[0]=B/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=B,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,m!=null&&m!==1/0?(a[10]=(m+u)*(w=1/(u-m)),a[14]=2*m*u*w):(a[10]=-1,a[14]=-2*u),a},A.b5=function(a,e,l){var u=Math.sin(l),m=Math.cos(l),w=e[4],B=e[5],S=e[6],Q=e[7],M=e[8],D=e[9],z=e[10],et=e[11];return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[4]=w*m+M*u,a[5]=B*m+D*u,a[6]=S*m+z*u,a[7]=Q*m+et*u,a[8]=M*m-w*u,a[9]=D*m-B*u,a[10]=z*m-S*u,a[11]=et*m-Q*u,a},A.b6=O,A.b7=tt,A.b8=function(a){return a*Math.PI/180},A.b9=function(a,e){return a[0]=e[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=e[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},A.bA=Go,A.ba=class extends Zl{},A.bb=Em,A.bc=n3,A.be=Ot,A.bf=function(a,e){bt.REGISTERED_PROTOCOLS[a]=e},A.bg=function(a){delete bt.REGISTERED_PROTOCOLS[a]},A.bh=function(a,e){let l={};for(let m=0;m<a.length;m++){let w=e&&e[a[m].id]||nl(a[m]);e&&(e[a[m].id]=w);let B=l[w];B||(B=l[w]=[]),B.push(a[m])}let u=[];for(let m in l)u.push(l[m]);return u},A.bi=si,A.bj=Z1,A.bk=M1,A.bl=C1,A.bm=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=$i/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;let e=a.bucket.layers[0],l=e.layout,u=e._unevaluatedLayout._values,m={layoutIconSize:u["icon-size"].possiblyEvaluate(new Hr(a.bucket.zoom+1),a.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Hr(a.bucket.zoom+1),a.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Hr(18))};if(a.bucket.textSizeData.kind==="composite"){let{minZoom:M,maxZoom:D}=a.bucket.textSizeData;m.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Hr(M),a.canonical),u["text-size"].possiblyEvaluate(new Hr(D),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){let{minZoom:M,maxZoom:D}=a.bucket.iconSizeData;m.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Hr(M),a.canonical),u["icon-size"].possiblyEvaluate(new Hr(D),a.canonical)]}let w=l.get("text-line-height")*Fn,B=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",S=l.get("text-keep-upright"),Q=l.get("text-size");for(let M of a.bucket.features){let D=l.get("text-font").evaluate(M,{},a.canonical).join(","),z=Q.evaluate(M,{},a.canonical),et=m.layoutTextSize.evaluate(M,{},a.canonical),nt=m.layoutIconSize.evaluate(M,{},a.canonical),st={horizontal:{},vertical:void 0},mt=M.text,St,Vt=[0,0];if(mt){let $t=mt.toString(),ve=l.get("text-letter-spacing").evaluate(M,{},a.canonical)*Fn,Le=Ma($t)?ve:0,ni=l.get("text-anchor").evaluate(M,{},a.canonical),bi=q1(e,M,a.canonical);if(!bi){let qe=l.get("text-radial-offset").evaluate(M,{},a.canonical);Vt=qe?j1(ni,[qe*Fn,Um]):l.get("text-offset").evaluate(M,{},a.canonical).map(Ze=>Ze*Fn)}let ri=B?"center":l.get("text-justify").evaluate(M,{},a.canonical),ti=l.get("symbol-placement"),Oe=ti==="point"?l.get("text-max-width").evaluate(M,{},a.canonical)*Fn:0,fi=()=>{a.bucket.allowVerticalPlacement&&Pa($t)&&(st.vertical=id(mt,a.glyphMap,a.glyphPositions,a.imagePositions,D,Oe,w,ni,"left",Le,Vt,A.ah.vertical,!0,ti,et,z))};if(!B&&bi){let qe=new Set;if(ri==="auto")for(let Gi=0;Gi<bi.values.length;Gi+=2)qe.add(Gm(bi.values[Gi]));else qe.add(ri);let Ze=!1;for(let Gi of qe)if(!st.horizontal[Gi])if(Ze)st.horizontal[Gi]=st.horizontal[0];else{let Bi=id(mt,a.glyphMap,a.glyphPositions,a.imagePositions,D,Oe,w,"center",Gi,Le,Vt,A.ah.horizontal,!1,ti,et,z);Bi&&(st.horizontal[Gi]=Bi,Ze=Bi.positionedLines.length===1)}fi()}else{ri==="auto"&&(ri=Gm(ni));let qe=id(mt,a.glyphMap,a.glyphPositions,a.imagePositions,D,Oe,w,ni,ri,Le,Vt,A.ah.horizontal,!1,ti,et,z);qe&&(st.horizontal[ri]=qe),fi(),Pa($t)&&B&&S&&(st.vertical=id(mt,a.glyphMap,a.glyphPositions,a.imagePositions,D,Oe,w,ni,ri,Le,Vt,A.ah.vertical,!1,ti,et,z))}}let oe=!1;if(M.icon&&M.icon.name){let $t=a.imageMap[M.icon.name];$t&&(St=PS(a.imagePositions[M.icon.name],l.get("icon-offset").evaluate(M,{},a.canonical),l.get("icon-anchor").evaluate(M,{},a.canonical)),oe=!!$t.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=oe:a.bucket.sdfIcons!==oe&&At("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),($t.pixelRatio!==a.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}let Wt=tb(st.horizontal)||st.vertical;a.bucket.iconsInText=!!Wt&&Wt.iconsInText,(Wt||St)&&i3(a.bucket,M,st,St,a.imageMap,m,et,nt,Vt,oe,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},A.bn=Im,A.bo=fm,A.bp=Cm,A.bq=zl,A.br=bm,A.bs=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},A.bt=function(a,e,l,u,m){return o(this,void 0,void 0,function*(){if($())try{return yield te(a,e,l,u,m)}catch{}return function(w,B,S,Q,M){let D=w.width,z=w.height;wt&&Ut||(wt=new OffscreenCanvas(D,z),Ut=wt.getContext("2d",{willReadFrequently:!0})),wt.width=D,wt.height=z,Ut.drawImage(w,0,0,D,z);let et=Ut.getImageData(B,S,Q,M);return Ut.clearRect(0,0,D,z),et.data}(a,e,l,u,m)})},A.bu=H1,A.bv=g,A.bw=d,A.bx=l1,A.by=Yi,A.bz=function(a){return a.message===fe},A.c=j,A.d=a=>o(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));let e=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(e)}catch(l){throw new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),A.e=Tt,A.f=a=>new Promise((e,l)=>{let u=new Image;u.onload=()=>{e(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=ne})},u.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let m=new Blob([new Uint8Array(a)],{type:"image/png"});u.src=a.byteLength?URL.createObjectURL(m):ne}),A.g=It,A.h=(a,e)=>he(Tt(a,{type:"json"}),e),A.i=_t,A.j=Me,A.k=je,A.l=(a,e)=>he(Tt(a,{type:"arrayBuffer"}),e),A.m=he,A.n=function(a){return new bm(a).readFields(QS,[])},A.o=Zo,A.p=m1,A.q=Jn,A.r=en,A.s=de,A.t=ea,A.u=ei,A.v=xt,A.w=At,A.x=kr,A.y=function([a,e,l]){return e+=90,e*=Math.PI/180,l*=Math.PI/180,{x:a*Math.cos(e)*Math.sin(l),y:a*Math.sin(e)*Math.sin(l),z:a*Math.cos(l)}},A.z=qn}),i("worker",["./shared"],function(A){"use strict";class o{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y){this._layerConfigs={},this._layers={},this.update(Y,[])}update(Y,q){for(let ht of Y){this._layerConfigs[ht.id]=ht;let Zt=this._layers[ht.id]=A.az(ht);Zt._featureFilter=A.a6(Zt.filter),this.keyCache[ht.id]&&delete this.keyCache[ht.id]}for(let ht of q)delete this.keyCache[ht],delete this._layerConfigs[ht],delete this._layers[ht];this.familiesBySource={};let rt=A.bh(Object.values(this._layerConfigs),this.keyCache);for(let ht of rt){let Zt=ht.map(pe=>this._layers[pe.id]),zt=Zt[0];if(zt.visibility==="none")continue;let Xt=zt.source||"",Mt=this.familiesBySource[Xt];Mt||(Mt=this.familiesBySource[Xt]={});let re=zt.sourceLayer||"_geojsonTileLayer",ce=Mt[re];ce||(ce=Mt[re]=[]),ce.push(Zt)}}}class g{constructor(Y){let q={},rt=[];for(let Xt in Y){let Mt=Y[Xt],re=q[Xt]={};for(let ce in Mt){let pe=Mt[+ce];if(!pe||pe.bitmap.width===0||pe.bitmap.height===0)continue;let me={x:0,y:0,w:pe.bitmap.width+2,h:pe.bitmap.height+2};rt.push(me),re[ce]={rect:me,metrics:pe.metrics}}}let{w:ht,h:Zt}=A.p(rt),zt=new A.o({width:ht||1,height:Zt||1});for(let Xt in Y){let Mt=Y[Xt];for(let re in Mt){let ce=Mt[+re];if(!ce||ce.bitmap.width===0||ce.bitmap.height===0)continue;let pe=q[Xt][re].rect;A.o.copy(ce.bitmap,zt,{x:0,y:0},{x:pe.x+1,y:pe.y+1},ce.bitmap)}}this.image=zt,this.positions=q}}A.bi("GlyphAtlas",g);class d{constructor(Y){this.tileID=new A.Q(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.uid=Y.uid,this.zoom=Y.zoom,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.collectResourceTiming,this.returnDependencies=!!Y.returnDependencies,this.promoteId=Y.promoteId,this.inFlightDependencies=[]}parse(Y,q,rt,ht){return A._(this,void 0,void 0,function*(){this.status="parsing",this.data=Y,this.collisionBoxArray=new A.a4;let Zt=new A.bj(Object.keys(Y.layers).sort()),zt=new A.bk(this.tileID,this.promoteId);zt.bucketLayerIDs=[];let Xt={},Mt={featureIndex:zt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:rt},re=q.familiesBySource[this.source];for(let ki in re){let fr=Y.layers[ki];if(!fr)continue;fr.version===1&&A.w(`Vector tile source "${this.source}" layer "${ki}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let br=Zt.encode(ki),Tr=[];for(let Dt=0;Dt<fr.length;Dt++){let Ke=fr.feature(Dt),Te=zt.getId(Ke,ki);Tr.push({feature:Ke,id:Te,index:Dt,sourceLayerIndex:br})}for(let Dt of re[ki]){let Ke=Dt[0];Ke.source!==this.source&&A.w(`layer.source = ${Ke.source} does not equal this.source = ${this.source}`),Ke.minzoom&&this.zoom<Math.floor(Ke.minzoom)||Ke.maxzoom&&this.zoom>=Ke.maxzoom||Ke.visibility!=="none"&&(C(Dt,this.zoom,rt),(Xt[Ke.id]=Ke.createBucket({index:zt.bucketLayerIDs.length,layers:Dt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:br,sourceID:this.source})).populate(Tr,Mt,this.tileID.canonical),zt.bucketLayerIDs.push(Dt.map(Te=>Te.id)))}}let ce=A.aE(Mt.glyphDependencies,ki=>Object.keys(ki).map(Number));this.inFlightDependencies.forEach(ki=>ki?.abort()),this.inFlightDependencies=[];let pe=Promise.resolve({});if(Object.keys(ce).length){let ki=new AbortController;this.inFlightDependencies.push(ki),pe=ht.sendAsync({type:"getGlyphs",data:{stacks:ce,source:this.source,tileID:this.tileID,type:"glyphs"}},ki)}let me=Object.keys(Mt.iconDependencies),Xe=Promise.resolve({});if(me.length){let ki=new AbortController;this.inFlightDependencies.push(ki),Xe=ht.sendAsync({type:"getImages",data:{icons:me,source:this.source,tileID:this.tileID,type:"icons"}},ki)}let oi=Object.keys(Mt.patternDependencies),ii=Promise.resolve({});if(oi.length){let ki=new AbortController;this.inFlightDependencies.push(ki),ii=ht.sendAsync({type:"getImages",data:{icons:oi,source:this.source,tileID:this.tileID,type:"patterns"}},ki)}let[Ni,Qi,rr]=yield Promise.all([pe,Xe,ii]),zi=new g(Ni),Cr=new A.bl(Qi,rr);for(let ki in Xt){let fr=Xt[ki];fr instanceof A.a5?(C(fr.layers,this.zoom,rt),A.bm({bucket:fr,glyphMap:Ni,glyphPositions:zi.positions,imageMap:Qi,imagePositions:Cr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):fr.hasPattern&&(fr instanceof A.bn||fr instanceof A.bo||fr instanceof A.bp)&&(C(fr.layers,this.zoom,rt),fr.addFeatures(Mt,this.tileID.canonical,Cr.patternPositions))}return this.status="done",{buckets:Object.values(Xt).filter(ki=>!ki.isEmpty()),featureIndex:zt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:zi.image,imageAtlas:Cr,glyphMap:this.returnDependencies?Ni:null,iconMap:this.returnDependencies?Qi:null,glyphPositions:this.returnDependencies?zi.positions:null}})}}function C(ft,Y,q){let rt=new A.a8(Y);for(let ht of ft)ht.recalculate(rt,q)}class v{constructor(Y,q,rt){this.actor=Y,this.layerIndex=q,this.availableImages=rt,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Y,q){return A._(this,void 0,void 0,function*(){let rt=yield A.l(Y.request,q);try{return{vectorTile:new A.bq.VectorTile(new A.br(rt.data)),rawData:rt.data,cacheControl:rt.cacheControl,expires:rt.expires}}catch(ht){let Zt=new Uint8Array(rt.data),zt=`Unable to parse the tile at ${Y.request.url}, `;throw zt+=Zt[0]===31&&Zt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ht.messge}`,new Error(zt)}})}loadTile(Y){return A._(this,void 0,void 0,function*(){let q=Y.uid,rt=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new A.bs(Y.request),ht=new d(Y);this.loading[q]=ht;let Zt=new AbortController;ht.abort=Zt;try{let zt=yield this.loadVectorTile(Y,Zt);if(delete this.loading[q],!zt)return null;let Xt=zt.rawData,Mt={};zt.expires&&(Mt.expires=zt.expires),zt.cacheControl&&(Mt.cacheControl=zt.cacheControl);let re={};if(rt){let pe=rt.finish();pe&&(re.resourceTiming=JSON.parse(JSON.stringify(pe)))}ht.vectorTile=zt.vectorTile;let ce=ht.parse(zt.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[q]=ht,this.fetching[q]={rawTileData:Xt,cacheControl:Mt,resourceTiming:re};try{let pe=yield ce;return A.e({rawTileData:Xt.slice(0)},pe,Mt,re)}finally{delete this.fetching[q]}}catch(zt){throw delete this.loading[q],ht.status="done",this.loaded[q]=ht,zt}})}reloadTile(Y){return A._(this,void 0,void 0,function*(){let q=Y.uid;if(!this.loaded||!this.loaded[q])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let rt=this.loaded[q];if(rt.showCollisionBoxes=Y.showCollisionBoxes,rt.status==="parsing"){let ht=yield rt.parse(rt.vectorTile,this.layerIndex,this.availableImages,this.actor),Zt;if(this.fetching[q]){let{rawTileData:zt,cacheControl:Xt,resourceTiming:Mt}=this.fetching[q];delete this.fetching[q],Zt=A.e({rawTileData:zt.slice(0)},ht,Xt,Mt)}else Zt=ht;return Zt}if(rt.status==="done"&&rt.vectorTile)return rt.parse(rt.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(Y){return A._(this,void 0,void 0,function*(){let q=this.loading,rt=Y.uid;q&&q[rt]&&q[rt].abort&&(q[rt].abort.abort(),delete q[rt])})}removeTile(Y){return A._(this,void 0,void 0,function*(){this.loaded&&this.loaded[Y.uid]&&delete this.loaded[Y.uid]})}}class x{constructor(){this.loaded={}}loadTile(Y){return A._(this,void 0,void 0,function*(){let{uid:q,encoding:rt,rawImageData:ht,redFactor:Zt,greenFactor:zt,blueFactor:Xt,baseShift:Mt}=Y,re=ht.width+2,ce=ht.height+2,pe=A.b(ht)?new A.R({width:re,height:ce},yield A.bt(ht,-1,-1,re,ce)):ht,me=new A.bu(q,pe,rt,Zt,zt,Xt,Mt);return this.loaded=this.loaded||{},this.loaded[q]=me,me})}removeTile(Y){let q=this.loaded,rt=Y.uid;q&&q[rt]&&delete q[rt]}}function T(ft,Y){if(ft.length!==0){G(ft[0],Y);for(var q=1;q<ft.length;q++)G(ft[q],!Y)}}function G(ft,Y){for(var q=0,rt=0,ht=0,Zt=ft.length,zt=Zt-1;ht<Zt;zt=ht++){var Xt=(ft[ht][0]-ft[zt][0])*(ft[zt][1]+ft[ht][1]),Mt=q+Xt;rt+=Math.abs(q)>=Math.abs(Xt)?q-Mt+Xt:Xt-Mt+q,q=Mt}q+rt>=0!=!!Y&&ft.reverse()}var k=A.bv(function ft(Y,q){var rt,ht=Y&&Y.type;if(ht==="FeatureCollection")for(rt=0;rt<Y.features.length;rt++)ft(Y.features[rt],q);else if(ht==="GeometryCollection")for(rt=0;rt<Y.geometries.length;rt++)ft(Y.geometries[rt],q);else if(ht==="Feature")ft(Y.geometry,q);else if(ht==="Polygon")T(Y.coordinates,q);else if(ht==="MultiPolygon")for(rt=0;rt<Y.coordinates.length;rt++)T(Y.coordinates[rt],q);return Y});let W=A.bq.VectorTileFeature.prototype.toGeoJSON;var K={exports:{}},$=A.bw,O=A.bq.VectorTileFeature,tt=at;function at(ft,Y){this.options=Y||{},this.features=ft,this.length=ft.length}function Lt(ft,Y){this.id=typeof ft.id=="number"?ft.id:void 0,this.type=ft.type,this.rawGeometry=ft.type===1?[ft.geometry]:ft.geometry,this.properties=ft.tags,this.extent=Y||4096}at.prototype.feature=function(ft){return new Lt(this.features[ft],this.options.extent)},Lt.prototype.loadGeometry=function(){var ft=this.rawGeometry;this.geometry=[];for(var Y=0;Y<ft.length;Y++){for(var q=ft[Y],rt=[],ht=0;ht<q.length;ht++)rt.push(new $(q[ht][0],q[ht][1]));this.geometry.push(rt)}return this.geometry},Lt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ft=this.geometry,Y=1/0,q=-1/0,rt=1/0,ht=-1/0,Zt=0;Zt<ft.length;Zt++)for(var zt=ft[Zt],Xt=0;Xt<zt.length;Xt++){var Mt=zt[Xt];Y=Math.min(Y,Mt.x),q=Math.max(q,Mt.x),rt=Math.min(rt,Mt.y),ht=Math.max(ht,Mt.y)}return[Y,rt,q,ht]},Lt.prototype.toGeoJSON=O.prototype.toGeoJSON;var Tt=A.bx,Qt=tt;function Ft(ft){var Y=new Tt;return function(q,rt){for(var ht in q.layers)rt.writeMessage(3,vt,q.layers[ht])}(ft,Y),Y.finish()}function vt(ft,Y){var q;Y.writeVarintField(15,ft.version||1),Y.writeStringField(1,ft.name||""),Y.writeVarintField(5,ft.extent||4096);var rt={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<ft.length;q++)rt.feature=ft.feature(q),Y.writeMessage(2,Jt,rt);var ht=rt.keys;for(q=0;q<ht.length;q++)Y.writeStringField(3,ht[q]);var Zt=rt.values;for(q=0;q<Zt.length;q++)Y.writeMessage(4,_t,Zt[q])}function Jt(ft,Y){var q=ft.feature;q.id!==void 0&&Y.writeVarintField(1,q.id),Y.writeMessage(2,qt,ft),Y.writeVarintField(3,q.type),Y.writeMessage(4,kt,q)}function qt(ft,Y){var q=ft.feature,rt=ft.keys,ht=ft.values,Zt=ft.keycache,zt=ft.valuecache;for(var Xt in q.properties){var Mt=q.properties[Xt],re=Zt[Xt];if(Mt!==null){re===void 0&&(rt.push(Xt),Zt[Xt]=re=rt.length-1),Y.writeVarint(re);var ce=typeof Mt;ce!=="string"&&ce!=="boolean"&&ce!=="number"&&(Mt=JSON.stringify(Mt));var pe=ce+":"+Mt,me=zt[pe];me===void 0&&(ht.push(Mt),zt[pe]=me=ht.length-1),Y.writeVarint(me)}}}function At(ft,Y){return(Y<<3)+(7&ft)}function lt(ft){return ft<<1^ft>>31}function kt(ft,Y){for(var q=ft.loadGeometry(),rt=ft.type,ht=0,Zt=0,zt=q.length,Xt=0;Xt<zt;Xt++){var Mt=q[Xt],re=1;rt===1&&(re=Mt.length),Y.writeVarint(At(1,re));for(var ce=rt===3?Mt.length-1:Mt.length,pe=0;pe<ce;pe++){pe===1&&rt!==1&&Y.writeVarint(At(2,ce-1));var me=Mt[pe].x-ht,Xe=Mt[pe].y-Zt;Y.writeVarint(lt(me)),Y.writeVarint(lt(Xe)),ht+=me,Zt+=Xe}rt===3&&Y.writeVarint(At(7,1))}}function _t(ft,Y){var q=typeof ft;q==="string"?Y.writeStringField(1,ft):q==="boolean"?Y.writeBooleanField(7,ft):q==="number"&&(ft%1!=0?Y.writeDoubleField(3,ft):ft<0?Y.writeSVarintField(6,ft):Y.writeVarintField(5,ft))}K.exports=Ft,K.exports.fromVectorTileJs=Ft,K.exports.fromGeojsonVt=function(ft,Y){Y=Y||{};var q={};for(var rt in ft)q[rt]=new Qt(ft[rt].features,Y),q[rt].name=rt,q[rt].version=Y.version,q[rt].extent=Y.extent;return Ft({layers:q})},K.exports.GeoJSONWrapper=Qt;var le=A.bv(K.exports);let ie={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ft=>ft},ne=Math.fround||(te=new Float32Array(1),ft=>(te[0]=+ft,te[0]));var te;let wt=3,Ut=5,fe=6;class j{constructor(Y){this.options=Object.assign(Object.create(ie),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){let{log:q,minZoom:rt,maxZoom:ht}=this.options;q&&console.time("total time");let Zt=`prepare ${Y.length} points`;q&&console.time(Zt),this.points=Y;let zt=[];for(let Mt=0;Mt<Y.length;Mt++){let re=Y[Mt];if(!re.geometry)continue;let[ce,pe]=re.geometry.coordinates,me=ne(Ht(ce)),Xe=ne(Ot(pe));zt.push(me,Xe,1/0,Mt,-1,1),this.options.reduce&&zt.push(0)}let Xt=this.trees[ht+1]=this._createTree(zt);q&&console.timeEnd(Zt);for(let Mt=ht;Mt>=rt;Mt--){let re=+Date.now();Xt=this.trees[Mt]=this._createTree(this._cluster(Xt,Mt)),q&&console.log("z%d: %d clusters in %dms",Mt,Xt.numItems,+Date.now()-re)}return q&&console.timeEnd("total time"),this}getClusters(Y,q){let rt=((Y[0]+180)%360+360)%360-180,ht=Math.max(-90,Math.min(90,Y[1])),Zt=Y[2]===180?180:((Y[2]+180)%360+360)%360-180,zt=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)rt=-180,Zt=180;else if(rt>Zt){let pe=this.getClusters([rt,ht,180,zt],q),me=this.getClusters([-180,ht,Zt,zt],q);return pe.concat(me)}let Xt=this.trees[this._limitZoom(q)],Mt=Xt.range(Ht(rt),Ot(zt),Ht(Zt),Ot(ht)),re=Xt.data,ce=[];for(let pe of Mt){let me=this.stride*pe;ce.push(re[me+Ut]>1?bt(re,me,this.clusterProps):this.points[re[me+wt]])}return ce}getChildren(Y){let q=this._getOriginId(Y),rt=this._getOriginZoom(Y),ht="No cluster with the specified id.",Zt=this.trees[rt];if(!Zt)throw new Error(ht);let zt=Zt.data;if(q*this.stride>=zt.length)throw new Error(ht);let Xt=this.options.radius/(this.options.extent*Math.pow(2,rt-1)),Mt=Zt.within(zt[q*this.stride],zt[q*this.stride+1],Xt),re=[];for(let ce of Mt){let pe=ce*this.stride;zt[pe+4]===Y&&re.push(zt[pe+Ut]>1?bt(zt,pe,this.clusterProps):this.points[zt[pe+wt]])}if(re.length===0)throw new Error(ht);return re}getLeaves(Y,q,rt){let ht=[];return this._appendLeaves(ht,Y,q=q||10,rt=rt||0,0),ht}getTile(Y,q,rt){let ht=this.trees[this._limitZoom(Y)],Zt=Math.pow(2,Y),{extent:zt,radius:Xt}=this.options,Mt=Xt/zt,re=(rt-Mt)/Zt,ce=(rt+1+Mt)/Zt,pe={features:[]};return this._addTileFeatures(ht.range((q-Mt)/Zt,re,(q+1+Mt)/Zt,ce),ht.data,q,rt,Zt,pe),q===0&&this._addTileFeatures(ht.range(1-Mt/Zt,re,1,ce),ht.data,Zt,rt,Zt,pe),q===Zt-1&&this._addTileFeatures(ht.range(0,re,Mt/Zt,ce),ht.data,-1,rt,Zt,pe),pe.features.length?pe:null}getClusterExpansionZoom(Y){let q=this._getOriginZoom(Y)-1;for(;q<=this.options.maxZoom;){let rt=this.getChildren(Y);if(q++,rt.length!==1)break;Y=rt[0].properties.cluster_id}return q}_appendLeaves(Y,q,rt,ht,Zt){let zt=this.getChildren(q);for(let Xt of zt){let Mt=Xt.properties;if(Mt&&Mt.cluster?Zt+Mt.point_count<=ht?Zt+=Mt.point_count:Zt=this._appendLeaves(Y,Mt.cluster_id,rt,ht,Zt):Zt<ht?Zt++:Y.push(Xt),Y.length===rt)break}return Zt}_createTree(Y){let q=new A.au(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let rt=0;rt<Y.length;rt+=this.stride)q.add(Y[rt],Y[rt+1]);return q.finish(),q.data=Y,q}_addTileFeatures(Y,q,rt,ht,Zt,zt){for(let Xt of Y){let Mt=Xt*this.stride,re=q[Mt+Ut]>1,ce,pe,me;if(re)ce=It(q,Mt,this.clusterProps),pe=q[Mt],me=q[Mt+1];else{let ii=this.points[q[Mt+wt]];ce=ii.properties;let[Ni,Qi]=ii.geometry.coordinates;pe=Ht(Ni),me=Ot(Qi)}let Xe={type:1,geometry:[[Math.round(this.options.extent*(pe*Zt-rt)),Math.round(this.options.extent*(me*Zt-ht))]],tags:ce},oi;oi=re||this.options.generateId?q[Mt+wt]:this.points[q[Mt+wt]].id,oi!==void 0&&(Xe.id=oi),zt.features.push(Xe)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,q){let{radius:rt,extent:ht,reduce:Zt,minPoints:zt}=this.options,Xt=rt/(ht*Math.pow(2,q)),Mt=Y.data,re=[],ce=this.stride;for(let pe=0;pe<Mt.length;pe+=ce){if(Mt[pe+2]<=q)continue;Mt[pe+2]=q;let me=Mt[pe],Xe=Mt[pe+1],oi=Y.within(Mt[pe],Mt[pe+1],Xt),ii=Mt[pe+Ut],Ni=ii;for(let Qi of oi){let rr=Qi*ce;Mt[rr+2]>q&&(Ni+=Mt[rr+Ut])}if(Ni>ii&&Ni>=zt){let Qi,rr=me*ii,zi=Xe*ii,Cr=-1,ki=((pe/ce|0)<<5)+(q+1)+this.points.length;for(let fr of oi){let br=fr*ce;if(Mt[br+2]<=q)continue;Mt[br+2]=q;let Tr=Mt[br+Ut];rr+=Mt[br]*Tr,zi+=Mt[br+1]*Tr,Mt[br+4]=ki,Zt&&(Qi||(Qi=this._map(Mt,pe,!0),Cr=this.clusterProps.length,this.clusterProps.push(Qi)),Zt(Qi,this._map(Mt,br)))}Mt[pe+4]=ki,re.push(rr/Ni,zi/Ni,1/0,ki,-1,Ni),Zt&&re.push(Cr)}else{for(let Qi=0;Qi<ce;Qi++)re.push(Mt[pe+Qi]);if(Ni>1)for(let Qi of oi){let rr=Qi*ce;if(!(Mt[rr+2]<=q)){Mt[rr+2]=q;for(let zi=0;zi<ce;zi++)re.push(Mt[rr+zi])}}}}return re}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,q,rt){if(Y[q+Ut]>1){let zt=this.clusterProps[Y[q+fe]];return rt?Object.assign({},zt):zt}let ht=this.points[Y[q+wt]].properties,Zt=this.options.map(ht);return rt&&Zt===ht?Object.assign({},Zt):Zt}}function bt(ft,Y,q){return{type:"Feature",id:ft[Y+wt],properties:It(ft,Y,q),geometry:{type:"Point",coordinates:[(rt=ft[Y],360*(rt-.5)),Ae(ft[Y+1])]}};var rt}function It(ft,Y,q){let rt=ft[Y+Ut],ht=rt>=1e4?`${Math.round(rt/1e3)}k`:rt>=1e3?Math.round(rt/100)/10+"k":rt,Zt=ft[Y+fe],zt=Zt===-1?{}:Object.assign({},q[Zt]);return Object.assign(zt,{cluster:!0,cluster_id:ft[Y+wt],point_count:rt,point_count_abbreviated:ht})}function Ht(ft){return ft/360+.5}function Ot(ft){let Y=Math.sin(ft*Math.PI/180),q=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return q<0?0:q>1?1:q}function Ae(ft){let Y=(180-360*ft)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function he(ft,Y,q,rt){for(var ht,Zt=rt,zt=q-Y>>1,Xt=q-Y,Mt=ft[Y],re=ft[Y+1],ce=ft[q],pe=ft[q+1],me=Y+3;me<q;me+=3){var Xe=de(ft[me],ft[me+1],Mt,re,ce,pe);if(Xe>Zt)ht=me,Zt=Xe;else if(Xe===Zt){var oi=Math.abs(me-zt);oi<Xt&&(ht=me,Xt=oi)}}Zt>rt&&(ht-Y>3&&he(ft,Y,ht,rt),ft[ht+2]=Zt,q-ht>3&&he(ft,ht,q,rt))}function de(ft,Y,q,rt,ht,Zt){var zt=ht-q,Xt=Zt-rt;if(zt!==0||Xt!==0){var Mt=((ft-q)*zt+(Y-rt)*Xt)/(zt*zt+Xt*Xt);Mt>1?(q=ht,rt=Zt):Mt>0&&(q+=zt*Mt,rt+=Xt*Mt)}return(zt=ft-q)*zt+(Xt=Y-rt)*Xt}function He(ft,Y,q,rt){var ht={id:ft===void 0?null:ft,type:Y,geometry:q,tags:rt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Zt){var zt=Zt.geometry,Xt=Zt.type;if(Xt==="Point"||Xt==="MultiPoint"||Xt==="LineString")Re(Zt,zt);else if(Xt==="Polygon"||Xt==="MultiLineString")for(var Mt=0;Mt<zt.length;Mt++)Re(Zt,zt[Mt]);else if(Xt==="MultiPolygon")for(Mt=0;Mt<zt.length;Mt++)for(var re=0;re<zt[Mt].length;re++)Re(Zt,zt[Mt][re])}(ht),ht}function Re(ft,Y){for(var q=0;q<Y.length;q+=3)ft.minX=Math.min(ft.minX,Y[q]),ft.minY=Math.min(ft.minY,Y[q+1]),ft.maxX=Math.max(ft.maxX,Y[q]),ft.maxY=Math.max(ft.maxY,Y[q+1])}function je(ft,Y,q,rt){if(Y.geometry){var ht=Y.geometry.coordinates,Zt=Y.geometry.type,zt=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),Xt=[],Mt=Y.id;if(q.promoteId?Mt=Y.properties[q.promoteId]:q.generateId&&(Mt=rt||0),Zt==="Point")Me(ht,Xt);else if(Zt==="MultiPoint")for(var re=0;re<ht.length;re++)Me(ht[re],Xt);else if(Zt==="LineString")gi(ht,Xt,zt,!1);else if(Zt==="MultiLineString"){if(q.lineMetrics){for(re=0;re<ht.length;re++)gi(ht[re],Xt=[],zt,!1),ft.push(He(Mt,"LineString",Xt,Y.properties));return}xt(ht,Xt,zt,!1)}else if(Zt==="Polygon")xt(ht,Xt,zt,!0);else{if(Zt!=="MultiPolygon"){if(Zt==="GeometryCollection"){for(re=0;re<Y.geometry.geometries.length;re++)je(ft,{id:Mt,geometry:Y.geometry.geometries[re],properties:Y.properties},q,rt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(re=0;re<ht.length;re++){var ce=[];xt(ht[re],ce,zt,!0),Xt.push(ce)}}ft.push(He(Mt,Zt,Xt,Y.properties))}}function Me(ft,Y){Y.push(Rt(ft[0])),Y.push(Li(ft[1])),Y.push(0)}function gi(ft,Y,q,rt){for(var ht,Zt,zt=0,Xt=0;Xt<ft.length;Xt++){var Mt=Rt(ft[Xt][0]),re=Li(ft[Xt][1]);Y.push(Mt),Y.push(re),Y.push(0),Xt>0&&(zt+=rt?(ht*re-Mt*Zt)/2:Math.sqrt(Math.pow(Mt-ht,2)+Math.pow(re-Zt,2))),ht=Mt,Zt=re}var ce=Y.length-3;Y[2]=1,he(Y,0,ce,q),Y[ce+2]=1,Y.size=Math.abs(zt),Y.start=0,Y.end=Y.size}function xt(ft,Y,q,rt){for(var ht=0;ht<ft.length;ht++){var Zt=[];gi(ft[ht],Zt,q,rt),Y.push(Zt)}}function Rt(ft){return ft/360+.5}function Li(ft){var Y=Math.sin(ft*Math.PI/180),q=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return q<0?0:q>1?1:q}function Ue(ft,Y,q,rt,ht,Zt,zt,Xt){if(rt/=Y,Zt>=(q/=Y)&&zt<rt)return ft;if(zt<q||Zt>=rt)return null;for(var Mt=[],re=0;re<ft.length;re++){var ce=ft[re],pe=ce.geometry,me=ce.type,Xe=ht===0?ce.minX:ce.minY,oi=ht===0?ce.maxX:ce.maxY;if(Xe>=q&&oi<rt)Mt.push(ce);else if(!(oi<q||Xe>=rt)){var ii=[];if(me==="Point"||me==="MultiPoint")Ee(pe,ii,q,rt,ht);else if(me==="LineString")Ne(pe,ii,q,rt,ht,!1,Xt.lineMetrics);else if(me==="MultiLineString")ze(pe,ii,q,rt,ht,!1);else if(me==="Polygon")ze(pe,ii,q,rt,ht,!0);else if(me==="MultiPolygon")for(var Ni=0;Ni<pe.length;Ni++){var Qi=[];ze(pe[Ni],Qi,q,rt,ht,!0),Qi.length&&ii.push(Qi)}if(ii.length){if(Xt.lineMetrics&&me==="LineString"){for(Ni=0;Ni<ii.length;Ni++)Mt.push(He(ce.id,me,ii[Ni],ce.tags));continue}me!=="LineString"&&me!=="MultiLineString"||(ii.length===1?(me="LineString",ii=ii[0]):me="MultiLineString"),me!=="Point"&&me!=="MultiPoint"||(me=ii.length===3?"Point":"MultiPoint"),Mt.push(He(ce.id,me,ii,ce.tags))}}}return Mt.length?Mt:null}function Ee(ft,Y,q,rt,ht){for(var Zt=0;Zt<ft.length;Zt+=3){var zt=ft[Zt+ht];zt>=q&&zt<=rt&&(Y.push(ft[Zt]),Y.push(ft[Zt+1]),Y.push(ft[Zt+2]))}}function Ne(ft,Y,q,rt,ht,Zt,zt){for(var Xt,Mt,re=Je(ft),ce=ht===0?hi:Ei,pe=ft.start,me=0;me<ft.length-3;me+=3){var Xe=ft[me],oi=ft[me+1],ii=ft[me+2],Ni=ft[me+3],Qi=ft[me+4],rr=ht===0?Xe:oi,zi=ht===0?Ni:Qi,Cr=!1;zt&&(Xt=Math.sqrt(Math.pow(Xe-Ni,2)+Math.pow(oi-Qi,2))),rr<q?zi>q&&(Mt=ce(re,Xe,oi,Ni,Qi,q),zt&&(re.start=pe+Xt*Mt)):rr>rt?zi<rt&&(Mt=ce(re,Xe,oi,Ni,Qi,rt),zt&&(re.start=pe+Xt*Mt)):ui(re,Xe,oi,ii),zi<q&&rr>=q&&(Mt=ce(re,Xe,oi,Ni,Qi,q),Cr=!0),zi>rt&&rr<=rt&&(Mt=ce(re,Xe,oi,Ni,Qi,rt),Cr=!0),!Zt&&Cr&&(zt&&(re.end=pe+Xt*Mt),Y.push(re),re=Je(ft)),zt&&(pe+=Xt)}var ki=ft.length-3;Xe=ft[ki],oi=ft[ki+1],ii=ft[ki+2],(rr=ht===0?Xe:oi)>=q&&rr<=rt&&ui(re,Xe,oi,ii),ki=re.length-3,Zt&&ki>=3&&(re[ki]!==re[0]||re[ki+1]!==re[1])&&ui(re,re[0],re[1],re[2]),re.length&&Y.push(re)}function Je(ft){var Y=[];return Y.size=ft.size,Y.start=ft.start,Y.end=ft.end,Y}function ze(ft,Y,q,rt,ht,Zt){for(var zt=0;zt<ft.length;zt++)Ne(ft[zt],Y,q,rt,ht,Zt,!1)}function ui(ft,Y,q,rt){ft.push(Y),ft.push(q),ft.push(rt)}function hi(ft,Y,q,rt,ht,Zt){var zt=(Zt-Y)/(rt-Y);return ft.push(Zt),ft.push(q+(ht-q)*zt),ft.push(1),zt}function Ei(ft,Y,q,rt,ht,Zt){var zt=(Zt-q)/(ht-q);return ft.push(Y+(rt-Y)*zt),ft.push(Zt),ft.push(1),zt}function Pi(ft,Y){for(var q=[],rt=0;rt<ft.length;rt++){var ht,Zt=ft[rt],zt=Zt.type;if(zt==="Point"||zt==="MultiPoint"||zt==="LineString")ht=Ie(Zt.geometry,Y);else if(zt==="MultiLineString"||zt==="Polygon"){ht=[];for(var Xt=0;Xt<Zt.geometry.length;Xt++)ht.push(Ie(Zt.geometry[Xt],Y))}else if(zt==="MultiPolygon")for(ht=[],Xt=0;Xt<Zt.geometry.length;Xt++){for(var Mt=[],re=0;re<Zt.geometry[Xt].length;re++)Mt.push(Ie(Zt.geometry[Xt][re],Y));ht.push(Mt)}q.push(He(Zt.id,zt,ht,Zt.tags))}return q}function Ie(ft,Y){var q=[];q.size=ft.size,ft.start!==void 0&&(q.start=ft.start,q.end=ft.end);for(var rt=0;rt<ft.length;rt+=3)q.push(ft[rt]+Y,ft[rt+1],ft[rt+2]);return q}function Oi(ft,Y){if(ft.transformed)return ft;var q,rt,ht,Zt=1<<ft.z,zt=ft.x,Xt=ft.y;for(q=0;q<ft.features.length;q++){var Mt=ft.features[q],re=Mt.geometry,ce=Mt.type;if(Mt.geometry=[],ce===1)for(rt=0;rt<re.length;rt+=2)Mt.geometry.push(mi(re[rt],re[rt+1],Y,Zt,zt,Xt));else for(rt=0;rt<re.length;rt++){var pe=[];for(ht=0;ht<re[rt].length;ht+=2)pe.push(mi(re[rt][ht],re[rt][ht+1],Y,Zt,zt,Xt));Mt.geometry.push(pe)}}return ft.transformed=!0,ft}function mi(ft,Y,q,rt,ht,Zt){return[Math.round(q*(ft*rt-ht)),Math.round(q*(Y*rt-Zt))]}function Vi(ft,Y,q,rt,ht){for(var Zt=Y===ht.maxZoom?0:ht.tolerance/((1<<Y)*ht.extent),zt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:rt,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Xt=0;Xt<ft.length;Xt++){zt.numFeatures++,We(zt,ft[Xt],Zt,ht);var Mt=ft[Xt].minX,re=ft[Xt].minY,ce=ft[Xt].maxX,pe=ft[Xt].maxY;Mt<zt.minX&&(zt.minX=Mt),re<zt.minY&&(zt.minY=re),ce>zt.maxX&&(zt.maxX=ce),pe>zt.maxY&&(zt.maxY=pe)}return zt}function We(ft,Y,q,rt){var ht=Y.geometry,Zt=Y.type,zt=[];if(Zt==="Point"||Zt==="MultiPoint")for(var Xt=0;Xt<ht.length;Xt+=3)zt.push(ht[Xt]),zt.push(ht[Xt+1]),ft.numPoints++,ft.numSimplified++;else if(Zt==="LineString")Se(zt,ht,ft,q,!1,!1);else if(Zt==="MultiLineString"||Zt==="Polygon")for(Xt=0;Xt<ht.length;Xt++)Se(zt,ht[Xt],ft,q,Zt==="Polygon",Xt===0);else if(Zt==="MultiPolygon")for(var Mt=0;Mt<ht.length;Mt++){var re=ht[Mt];for(Xt=0;Xt<re.length;Xt++)Se(zt,re[Xt],ft,q,!0,Xt===0)}if(zt.length){var ce=Y.tags||null;if(Zt==="LineString"&&rt.lineMetrics){for(var pe in ce={},Y.tags)ce[pe]=Y.tags[pe];ce.mapbox_clip_start=ht.start/ht.size,ce.mapbox_clip_end=ht.end/ht.size}var me={geometry:zt,type:Zt==="Polygon"||Zt==="MultiPolygon"?3:Zt==="LineString"||Zt==="MultiLineString"?2:1,tags:ce};Y.id!==null&&(me.id=Y.id),ft.features.push(me)}}function Se(ft,Y,q,rt,ht,Zt){var zt=rt*rt;if(rt>0&&Y.size<(ht?zt:rt))q.numPoints+=Y.length/3;else{for(var Xt=[],Mt=0;Mt<Y.length;Mt+=3)(rt===0||Y[Mt+2]>zt)&&(q.numSimplified++,Xt.push(Y[Mt]),Xt.push(Y[Mt+1])),q.numPoints++;ht&&function(re,ce){for(var pe=0,me=0,Xe=re.length,oi=Xe-2;me<Xe;oi=me,me+=2)pe+=(re[me]-re[oi])*(re[me+1]+re[oi+1]);if(pe>0===ce)for(me=0,Xe=re.length;me<Xe/2;me+=2){var ii=re[me],Ni=re[me+1];re[me]=re[Xe-2-me],re[me+1]=re[Xe-1-me],re[Xe-2-me]=ii,re[Xe-1-me]=Ni}}(Xt,Zt),ft.push(Xt)}}function $e(ft,Y){var q=(Y=this.options=function(ht,Zt){for(var zt in Zt)ht[zt]=Zt[zt];return ht}(Object.create(this.options),Y)).debug;if(q&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");var rt=function(ht,Zt){var zt=[];if(ht.type==="FeatureCollection")for(var Xt=0;Xt<ht.features.length;Xt++)je(zt,ht.features[Xt],Zt,Xt);else je(zt,ht.type==="Feature"?ht:{geometry:ht},Zt);return zt}(ft,Y);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),rt=function(ht,Zt){var zt=Zt.buffer/Zt.extent,Xt=ht,Mt=Ue(ht,1,-1-zt,zt,0,-1,2,Zt),re=Ue(ht,1,1-zt,2+zt,0,-1,2,Zt);return(Mt||re)&&(Xt=Ue(ht,1,-zt,1+zt,0,-1,2,Zt)||[],Mt&&(Xt=Pi(Mt,1).concat(Xt)),re&&(Xt=Xt.concat(Pi(re,-1)))),Xt}(rt,Y),rt.length&&this.splitTile(rt,0,0,0),q&&(rt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function di(ft,Y,q){return 32*((1<<ft)*q+Y)+ft}function Zi(ft,Y){return Y?ft.properties[Y]:ft.id}function qi(ft,Y){if(ft==null)return!0;if(ft.type==="Feature")return Zi(ft,Y)!=null;if(ft.type==="FeatureCollection"){let q=new Set;for(let rt of ft.features){let ht=Zi(rt,Y);if(ht==null||q.has(ht))return!1;q.add(ht)}return!0}return!1}function vi(ft,Y){let q=new Map;if(ft!=null)if(ft.type==="Feature")q.set(Zi(ft,Y),ft);else for(let rt of ft.features)q.set(Zi(rt,Y),rt);return q}$e.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$e.prototype.splitTile=function(ft,Y,q,rt,ht,Zt,zt){for(var Xt=[ft,Y,q,rt],Mt=this.options,re=Mt.debug;Xt.length;){rt=Xt.pop(),q=Xt.pop(),Y=Xt.pop(),ft=Xt.pop();var ce=1<<Y,pe=di(Y,q,rt),me=this.tiles[pe];if(!me&&(re>1&&console.time("creation"),me=this.tiles[pe]=Vi(ft,Y,q,rt,Mt),this.tileCoords.push({z:Y,x:q,y:rt}),re)){re>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,q,rt,me.numFeatures,me.numPoints,me.numSimplified),console.timeEnd("creation"));var Xe="z"+Y;this.stats[Xe]=(this.stats[Xe]||0)+1,this.total++}if(me.source=ft,ht){if(Y===Mt.maxZoom||Y===ht)continue;var oi=1<<ht-Y;if(q!==Math.floor(Zt/oi)||rt!==Math.floor(zt/oi))continue}else if(Y===Mt.indexMaxZoom||me.numPoints<=Mt.indexMaxPoints)continue;if(me.source=null,ft.length!==0){re>1&&console.time("clipping");var ii,Ni,Qi,rr,zi,Cr,ki=.5*Mt.buffer/Mt.extent,fr=.5-ki,br=.5+ki,Tr=1+ki;ii=Ni=Qi=rr=null,zi=Ue(ft,ce,q-ki,q+br,0,me.minX,me.maxX,Mt),Cr=Ue(ft,ce,q+fr,q+Tr,0,me.minX,me.maxX,Mt),ft=null,zi&&(ii=Ue(zi,ce,rt-ki,rt+br,1,me.minY,me.maxY,Mt),Ni=Ue(zi,ce,rt+fr,rt+Tr,1,me.minY,me.maxY,Mt),zi=null),Cr&&(Qi=Ue(Cr,ce,rt-ki,rt+br,1,me.minY,me.maxY,Mt),rr=Ue(Cr,ce,rt+fr,rt+Tr,1,me.minY,me.maxY,Mt),Cr=null),re>1&&console.timeEnd("clipping"),Xt.push(ii||[],Y+1,2*q,2*rt),Xt.push(Ni||[],Y+1,2*q,2*rt+1),Xt.push(Qi||[],Y+1,2*q+1,2*rt),Xt.push(rr||[],Y+1,2*q+1,2*rt+1)}}},$e.prototype.getTile=function(ft,Y,q){var rt=this.options,ht=rt.extent,Zt=rt.debug;if(ft<0||ft>24)return null;var zt=1<<ft,Xt=di(ft,Y=(Y%zt+zt)%zt,q);if(this.tiles[Xt])return Oi(this.tiles[Xt],ht);Zt>1&&console.log("drilling down to z%d-%d-%d",ft,Y,q);for(var Mt,re=ft,ce=Y,pe=q;!Mt&&re>0;)re--,ce=Math.floor(ce/2),pe=Math.floor(pe/2),Mt=this.tiles[di(re,ce,pe)];return Mt&&Mt.source?(Zt>1&&console.log("found parent tile z%d-%d-%d",re,ce,pe),Zt>1&&console.time("drilling down"),this.splitTile(Mt.source,re,ce,pe,ft,Y,q),Zt>1&&console.timeEnd("drilling down"),this.tiles[Xt]?Oi(this.tiles[Xt],ht):null):null};class tr extends v{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Y,q){return A._(this,void 0,void 0,function*(){let rt=Y.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let ht=this._geoJSONIndex.getTile(rt.z,rt.x,rt.y);if(!ht)return null;let Zt=new class{constructor(Xt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=A.W,this.length=Xt.length,this._features=Xt}feature(Xt){return new class{constructor(Mt){this._feature=Mt,this.extent=A.W,this.type=Mt.type,this.properties=Mt.tags,"id"in Mt&&!isNaN(Mt.id)&&(this.id=parseInt(Mt.id,10))}loadGeometry(){if(this._feature.type===1){let Mt=[];for(let re of this._feature.geometry)Mt.push([new A.P(re[0],re[1])]);return Mt}{let Mt=[];for(let re of this._feature.geometry){let ce=[];for(let pe of re)ce.push(new A.P(pe[0],pe[1]));Mt.push(ce)}return Mt}}toGeoJSON(Mt,re,ce){return W.call(this,Mt,re,ce)}}(this._features[Xt])}}(ht.features),zt=le(Zt);return zt.byteOffset===0&&zt.byteLength===zt.buffer.byteLength||(zt=new Uint8Array(zt)),{vectorTile:Zt,rawData:zt.buffer}})}loadData(Y){return A._(this,void 0,void 0,function*(){var q;(q=this._pendingRequest)===null||q===void 0||q.abort();let rt=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new A.bs(Y.request);this._pendingRequest=new AbortController;try{let ht=yield this.loadGeoJSON(Y,this._pendingRequest);if(delete this._pendingRequest,typeof ht!="object")throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`);if(k(ht,!0),Y.filter){let zt=A.by(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(zt.result==="error")throw new Error(zt.value.map(Mt=>`${Mt.key}: ${Mt.message}`).join(", "));ht={type:"FeatureCollection",features:ht.features.filter(Mt=>zt.value.evaluate({zoom:0},Mt))}}this._geoJSONIndex=Y.cluster?new j(function({superclusterOptions:zt,clusterProperties:Xt}){if(!Xt||!zt)return zt;let Mt={},re={},ce={accumulated:null,zoom:0},pe={properties:null},me=Object.keys(Xt);for(let Xe of me){let[oi,ii]=Xt[Xe],Ni=A.by(ii),Qi=A.by(typeof oi=="string"?[oi,["accumulated"],["get",Xe]]:oi);Mt[Xe]=Ni.value,re[Xe]=Qi.value}return zt.map=Xe=>{pe.properties=Xe;let oi={};for(let ii of me)oi[ii]=Mt[ii].evaluate(ce,pe);return oi},zt.reduce=(Xe,oi)=>{pe.properties=oi;for(let ii of me)ce.accumulated=Xe[ii],Xe[ii]=re[ii].evaluate(ce,pe)},zt}(Y)).load(ht.features):function(zt,Xt){return new $e(zt,Xt)}(ht,Y.geojsonVtOptions),this.loaded={};let Zt={};if(rt){let zt=rt.finish();zt&&(Zt.resourceTiming={},Zt.resourceTiming[Y.source]=JSON.parse(JSON.stringify(zt)))}return Zt}catch(ht){if(delete this._pendingRequest,A.bz(ht))return{abandoned:!0};throw ht}})}reloadTile(Y){let q=this.loaded;return q&&q[Y.uid]?super.reloadTile(Y):this.loadTile(Y)}loadGeoJSON(Y,q){return A._(this,void 0,void 0,function*(){let{promoteId:rt}=Y;if(Y.request){let ht=yield A.h(Y.request,q);return this._dataUpdateable=qi(ht.data,rt)?vi(ht.data,rt):void 0,ht.data}if(typeof Y.data=="string")try{let ht=JSON.parse(Y.data);return this._dataUpdateable=qi(ht,rt)?vi(ht,rt):void 0,ht}catch{throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`)}if(!Y.dataDiff)throw new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Y.source}`);return function(ht,Zt,zt){var Xt,Mt,re,ce;if(Zt.removeAll&&ht.clear(),Zt.remove)for(let pe of Zt.remove)ht.delete(pe);if(Zt.add)for(let pe of Zt.add){let me=Zi(pe,zt);me!=null&&ht.set(me,pe)}if(Zt.update)for(let pe of Zt.update){let me=ht.get(pe.id);if(me==null)continue;let Xe=!pe.removeAllProperties&&(((Xt=pe.removeProperties)===null||Xt===void 0?void 0:Xt.length)>0||((Mt=pe.addOrUpdateProperties)===null||Mt===void 0?void 0:Mt.length)>0);if((pe.newGeometry||pe.removeAllProperties||Xe)&&(me=Object.assign({},me),ht.set(pe.id,me),Xe&&(me.properties=Object.assign({},me.properties))),pe.newGeometry&&(me.geometry=pe.newGeometry),pe.removeAllProperties)me.properties={};else if(((re=pe.removeProperties)===null||re===void 0?void 0:re.length)>0)for(let oi of pe.removeProperties)Object.prototype.hasOwnProperty.call(me.properties,oi)&&delete me.properties[oi];if(((ce=pe.addOrUpdateProperties)===null||ce===void 0?void 0:ce.length)>0)for(let{key:oi,value:ii}of pe.addOrUpdateProperties)me.properties[oi]=ii}}(this._dataUpdateable,Y.dataDiff,rt),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(Y){return A._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(Y){return this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId)}getClusterChildren(Y){return this._geoJSONIndex.getChildren(Y.clusterId)}getClusterLeaves(Y){return this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset)}}class Lr{constructor(Y){this.self=Y,this.actor=new A.C(Y),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(q,rt)=>{if(this.externalWorkerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.externalWorkerSourceTypes[q]=rt},this.self.addProtocol=A.bf,this.self.removeProtocol=A.bg,this.self.registerRTLTextPlugin=q=>{if(A.bA.isParsed())throw new Error("RTL text plugin already registered.");A.bA.setMethods(q)},this.actor.registerMessageHandler("loadDEMTile",(q,rt)=>this._getDEMWorkerSource(q,rt.source).loadTile(rt)),this.actor.registerMessageHandler("removeDEMTile",(q,rt)=>A._(this,void 0,void 0,function*(){this._getDEMWorkerSource(q,rt.source).removeTile(rt)})),this.actor.registerMessageHandler("getClusterExpansionZoom",(q,rt)=>A._(this,void 0,void 0,function*(){return this._getWorkerSource(q,rt.type,rt.source).getClusterExpansionZoom(rt)})),this.actor.registerMessageHandler("getClusterChildren",(q,rt)=>A._(this,void 0,void 0,function*(){return this._getWorkerSource(q,rt.type,rt.source).getClusterChildren(rt)})),this.actor.registerMessageHandler("getClusterLeaves",(q,rt)=>A._(this,void 0,void 0,function*(){return this._getWorkerSource(q,rt.type,rt.source).getClusterLeaves(rt)})),this.actor.registerMessageHandler("loadData",(q,rt)=>this._getWorkerSource(q,rt.type,rt.source).loadData(rt)),this.actor.registerMessageHandler("loadTile",(q,rt)=>this._getWorkerSource(q,rt.type,rt.source).loadTile(rt)),this.actor.registerMessageHandler("reloadTile",(q,rt)=>this._getWorkerSource(q,rt.type,rt.source).reloadTile(rt)),this.actor.registerMessageHandler("abortTile",(q,rt)=>this._getWorkerSource(q,rt.type,rt.source).abortTile(rt)),this.actor.registerMessageHandler("removeTile",(q,rt)=>this._getWorkerSource(q,rt.type,rt.source).removeTile(rt)),this.actor.registerMessageHandler("removeSource",(q,rt)=>A._(this,void 0,void 0,function*(){if(!this.workerSources[q]||!this.workerSources[q][rt.type]||!this.workerSources[q][rt.type][rt.source])return;let ht=this.workerSources[q][rt.type][rt.source];delete this.workerSources[q][rt.type][rt.source],ht.removeSource!==void 0&&ht.removeSource(rt)})),this.actor.registerMessageHandler("removeMap",q=>A._(this,void 0,void 0,function*(){delete this.layerIndexes[q],delete this.availableImages[q],delete this.workerSources[q],delete this.demWorkerSources[q]})),this.actor.registerMessageHandler("setReferrer",(q,rt)=>A._(this,void 0,void 0,function*(){this.referrer=rt})),this.actor.registerMessageHandler("syncRTLPluginState",(q,rt)=>this._syncRTLPluginState(q,rt)),this.actor.registerMessageHandler("importScript",(q,rt)=>A._(this,void 0,void 0,function*(){this.self.importScripts(rt)})),this.actor.registerMessageHandler("setImages",(q,rt)=>this._setImages(q,rt)),this.actor.registerMessageHandler("updateLayers",(q,rt)=>A._(this,void 0,void 0,function*(){this._getLayerIndex(q).update(rt.layers,rt.removedIds)})),this.actor.registerMessageHandler("setLayers",(q,rt)=>A._(this,void 0,void 0,function*(){this._getLayerIndex(q).replace(rt)}))}_setImages(Y,q){return A._(this,void 0,void 0,function*(){this.availableImages[Y]=q;for(let rt in this.workerSources[Y]){let ht=this.workerSources[Y][rt];for(let Zt in ht)ht[Zt].availableImages=q}})}_syncRTLPluginState(Y,q){return A._(this,void 0,void 0,function*(){if(A.bA.isParsed())return A.bA.getState();if(q.pluginStatus!=="loading")return A.bA.setState(q),q;let rt=q.pluginURL;if(this.self.importScripts(rt),A.bA.isParsed()){let ht={pluginStatus:"loaded",pluginURL:rt};return A.bA.setState(ht),ht}throw A.bA.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${rt}`)})}_getAvailableImages(Y){let q=this.availableImages[Y];return q||(q=[]),q}_getLayerIndex(Y){let q=this.layerIndexes[Y];return q||(q=this.layerIndexes[Y]=new o),q}_getWorkerSource(Y,q,rt){if(this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][q]||(this.workerSources[Y][q]={}),!this.workerSources[Y][q][rt]){let ht={sendAsync:(Zt,zt)=>(Zt.targetMapId=Y,this.actor.sendAsync(Zt,zt))};switch(q){case"vector":this.workerSources[Y][q][rt]=new v(ht,this._getLayerIndex(Y),this._getAvailableImages(Y));break;case"geojson":this.workerSources[Y][q][rt]=new tr(ht,this._getLayerIndex(Y),this._getAvailableImages(Y));break;default:this.workerSources[Y][q][rt]=new this.externalWorkerSourceTypes[q](ht,this._getLayerIndex(Y),this._getAvailableImages(Y))}}return this.workerSources[Y][q][rt]}_getDEMWorkerSource(Y,q){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][q]||(this.demWorkerSources[Y][q]=new x),this.demWorkerSources[Y][q]}}return A.i(self)&&(self.worker=new Lr(self)),Lr}),i("index",["exports","./shared"],function(A,o){"use strict";var g="4.1.2";let d,C,v={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((n,c)=>{let p=requestAnimationFrame(n);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(p),c(o.c())})}),getImageData(y,n=0){return this.getImageCanvasContext(y).getImageData(-n,-n,y.width+2*n,y.height+2*n)},getImageCanvasContext(y){let n=window.document.createElement("canvas"),c=n.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return n.width=y.width,n.height=y.height,c.drawImage(y,0,0,y.width,y.height),c},resolveURL:y=>(d||(d=document.createElement("a")),d.href=y,d.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(C==null&&(C=matchMedia("(prefers-reduced-motion: reduce)")),C.matches)}};class x{static testProp(n){if(!x.docStyle)return n[0];for(let c=0;c<n.length;c++)if(n[c]in x.docStyle)return n[c];return n[0]}static create(n,c,p){let f=window.document.createElement(n);return c!==void 0&&(f.className=c),p&&p.appendChild(f),f}static createNS(n,c){return window.document.createElementNS(n,c)}static disableDrag(){x.docStyle&&x.selectProp&&(x.userSelect=x.docStyle[x.selectProp],x.docStyle[x.selectProp]="none")}static enableDrag(){x.docStyle&&x.selectProp&&(x.docStyle[x.selectProp]=x.userSelect)}static setTransform(n,c){n.style[x.transformProp]=c}static addEventListener(n,c,p,f={}){n.addEventListener(c,p,"passive"in f?f:f.capture)}static removeEventListener(n,c,p,f={}){n.removeEventListener(c,p,"passive"in f?f:f.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",x.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",x.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",x.suppressClickInternal,!0)},0)}static getScale(n){let c=n.getBoundingClientRect();return{x:c.width/n.offsetWidth||1,y:c.height/n.offsetHeight||1,boundingClientRect:c}}static getPoint(n,c,p){let f=c.boundingClientRect;return new o.P((p.clientX-f.left)/c.x-n.clientLeft,(p.clientY-f.top)/c.y-n.clientTop)}static mousePos(n,c){let p=x.getScale(n);return x.getPoint(n,p,c)}static touchPos(n,c){let p=[],f=x.getScale(n);for(let b=0;b<c.length;b++)p.push(x.getPoint(n,f,c[b]));return p}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}x.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,x.selectProp=x.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),x.transformProp=x.testProp(["transform","WebkitTransform"]);let T={supported:!1,testSupport:function(y){!W&&k&&(K?$(y):G=y)}},G,k,W=!1,K=!1;function $(y){let n=y.createTexture();y.bindTexture(y.TEXTURE_2D,n);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,k),y.isContextLost())return;T.supported=!0}catch{}y.deleteTexture(n),W=!0}var O,tt;typeof document<"u"&&(k=document.createElement("img"),k.onload=function(){G&&$(G),G=null,K=!0},k.onerror=function(){W=!0,G=null},k.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let n,c,p,f;y.resetRequestQueue=()=>{n=[],c=0,p=0,f={}},y.addThrottleControl=H=>{let h=p++;return f[h]=H,h},y.removeThrottleControl=H=>{delete f[H],L()},y.getImage=(H,h,I=!0)=>new Promise((_,F)=>{T.supported&&(H.headers||(H.headers={}),H.headers.accept="image/webp,*/*"),o.e(H,{type:"image"}),n.push({abortController:h,requestParameters:H,supportImageRefresh:I,state:"queued",onError:R=>{F(R)},onSuccess:R=>{_(R)}}),L()});let b=H=>o._(this,void 0,void 0,function*(){H.state="running";let{requestParameters:h,supportImageRefresh:I,onError:_,onSuccess:F,abortController:R}=H,Z=I===!1&&!o.i(self)&&!o.g(h.url)&&(!h.headers||Object.keys(h.headers).reduce((V,X)=>V&&X==="accept",!0));c++;let N=Z?E(h,R):o.m(h,R);try{let V=yield N;delete H.abortController,H.state="completed",V.data instanceof HTMLImageElement||o.b(V.data)?F(V):V.data&&F({data:yield(P=V.data,typeof createImageBitmap=="function"?o.d(P):o.f(P)),cacheControl:V.cacheControl,expires:V.expires})}catch(V){delete H.abortController,_(V)}finally{c--,L()}var P}),L=()=>{let H=(()=>{for(let h of Object.keys(f))if(f[h]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let h=c;h<H&&n.length>0;h++){let I=n.shift();I.abortController.signal.aborted?h--:b(I)}},E=(H,h)=>new Promise((I,_)=>{let F=new Image,R=H.url,Z=H.credentials;Z&&Z==="include"?F.crossOrigin="use-credentials":(Z&&Z==="same-origin"||!o.s(R))&&(F.crossOrigin="anonymous"),h.signal.addEventListener("abort",()=>{F.src="",_(o.c())}),F.fetchPriority="high",F.onload=()=>{F.onerror=F.onload=null,I({data:F})},F.onerror=()=>{F.onerror=F.onload=null,h.signal.aborted||_(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},F.src=R})}(O||(O={})),O.resetRequestQueue(),function(y){y.Glyphs="Glyphs",y.Image="Image",y.Source="Source",y.SpriteImage="SpriteImage",y.SpriteJSON="SpriteJSON",y.Style="Style",y.Tile="Tile",y.Unknown="Unknown"}(tt||(tt={}));class at{constructor(n){this._transformRequestFn=n}transformRequest(n,c){return this._transformRequestFn&&this._transformRequestFn(n,c)||{url:n}}normalizeSpriteURL(n,c,p){let f=function(b){let L=b.match(Lt);if(!L)throw new Error(`Unable to parse URL "${b}"`);return{protocol:L[1],authority:L[2],path:L[3]||"/",params:L[4]?L[4].split("&"):[]}}(n);return f.path+=`${c}${p}`,function(b){let L=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${L}`}(f)}setTransformRequest(n){this._transformRequestFn=n}}let Lt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Tt(y){var n=new o.A(3);return n[0]=y[0],n[1]=y[1],n[2]=y[2],n}var Qt,Ft=function(y,n,c){return y[0]=n[0]-c[0],y[1]=n[1]-c[1],y[2]=n[2]-c[2],y};Qt=new o.A(3),o.A!=Float32Array&&(Qt[0]=0,Qt[1]=0,Qt[2]=0);var vt=function(y){var n=y[0],c=y[1];return n*n+c*c};function Jt(y){let n=[];if(typeof y=="string")n.push({id:"default",url:y});else if(y&&y.length>0){let c=[];for(let{id:p,url:f}of y){let b=`${p}${f}`;c.indexOf(b)===-1&&(c.push(b),n.push({id:p,url:f}))}}return n}(function(){var y=new o.A(2);o.A!=Float32Array&&(y[0]=0,y[1]=0)})();class qt{constructor(n,c,p,f){this.context=n,this.format=p,this.texture=n.gl.createTexture(),this.update(c,f)}update(n,c,p){let{width:f,height:b}=n,L=!(this.size&&this.size[0]===f&&this.size[1]===b||p),{context:E}=this,{gl:H}=E;if(this.useMipmap=Boolean(c&&c.useMipmap),H.bindTexture(H.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===H.RGBA&&(!c||c.premultiply!==!1)),L)this.size=[f,b],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||o.b(n)?H.texImage2D(H.TEXTURE_2D,0,this.format,this.format,H.UNSIGNED_BYTE,n):H.texImage2D(H.TEXTURE_2D,0,this.format,f,b,0,this.format,H.UNSIGNED_BYTE,n.data);else{let{x:h,y:I}=p||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||o.b(n)?H.texSubImage2D(H.TEXTURE_2D,0,h,I,H.RGBA,H.UNSIGNED_BYTE,n):H.texSubImage2D(H.TEXTURE_2D,0,h,I,f,b,H.RGBA,H.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&H.generateMipmap(H.TEXTURE_2D)}bind(n,c,p){let{context:f}=this,{gl:b}=f;b.bindTexture(b.TEXTURE_2D,this.texture),p!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=b.LINEAR),n!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,n),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,p||n),this.filter=n),c!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,c),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function At(y){let{userImage:n}=y;return!!(n&&n.render&&n.render())&&(y.data.replace(new Uint8Array(n.data.buffer)),!0)}class lt extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(let{ids:c,promiseResolve:p}of this.requestors)p(this._getImagesForIds(c));this.requestors=[]}}getImage(n){let c=this.images[n];if(c&&!c.data&&c.spriteData){let p=c.spriteData;c.data=new o.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),c.spriteData=null}return c}addImage(n,c){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,c)&&(this.images[n]=c)}_validate(n,c){let p=!0,f=c.data||c.spriteData;return this._validateStretch(c.stretchX,f&&f.width)||(this.fire(new o.j(new Error(`Image "${n}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,f&&f.height)||(this.fire(new o.j(new Error(`Image "${n}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new o.j(new Error(`Image "${n}" has invalid "content" value`))),p=!1),p}_validateStretch(n,c){if(!n)return!0;let p=0;for(let f of n){if(f[0]<p||f[1]<f[0]||c<f[1])return!1;p=f[1]}return!0}_validateContent(n,c){if(!n)return!0;if(n.length!==4)return!1;let p=c.spriteData,f=p&&p.width||c.data.width,b=p&&p.height||c.data.height;return!(n[0]<0||f<n[0]||n[1]<0||b<n[1]||n[2]<0||f<n[2]||n[3]<0||b<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,c,p=!0){let f=this.getImage(n);if(p&&(f.data.width!==c.data.width||f.data.height!==c.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${c.data.width}x${c.data.height}).`);c.version=f.version+1,this.images[n]=c,this.updatedImages[n]=!0}removeImage(n){let c=this.images[n];delete this.images[n],delete this.patterns[n],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((c,p)=>{let f=!0;if(!this.isLoaded())for(let b of n)this.images[b]||(f=!1);this.isLoaded()||f?c(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:c})})}_getImagesForIds(n){let c={};for(let p of n){let f=this.getImage(p);f||(this.fire(new o.k("styleimagemissing",{id:p})),f=this.getImage(p)),f?c[p]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,hasRenderCallback:Boolean(f.userImage&&f.userImage.render)}:o.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return c}getPixelSize(){let{width:n,height:c}=this.atlasImage;return{width:n,height:c}}getPattern(n){let c=this.patterns[n],p=this.getImage(n);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{let f={w:p.data.width+2,h:p.data.height+2,x:0,y:0},b=new o.I(f,p);this.patterns[n]={bin:f,position:b}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){let c=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new qt(n,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){let n=[];for(let b in this.patterns)n.push(this.patterns[b].bin);let{w:c,h:p}=o.p(n),f=this.atlasImage;f.resize({width:c||1,height:p||1});for(let b in this.patterns){let{bin:L}=this.patterns[b],E=L.x+1,H=L.y+1,h=this.getImage(b).data,I=h.width,_=h.height;o.R.copy(h,f,{x:0,y:0},{x:E,y:H},{width:I,height:_}),o.R.copy(h,f,{x:0,y:_-1},{x:E,y:H-1},{width:I,height:1}),o.R.copy(h,f,{x:0,y:0},{x:E,y:H+_},{width:I,height:1}),o.R.copy(h,f,{x:I-1,y:0},{x:E-1,y:H},{width:1,height:_}),o.R.copy(h,f,{x:0,y:0},{x:E+I,y:H},{width:1,height:_})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(let c of n){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;let p=this.getImage(c);p||o.w(`Image with ID: "${c}" was not found`),At(p)&&this.updateImage(c,p)}}}let kt=1e20;function _t(y,n,c,p,f,b,L,E,H){for(let h=n;h<n+p;h++)le(y,c*b+h,b,f,L,E,H);for(let h=c;h<c+f;h++)le(y,h*b+n,1,p,L,E,H)}function le(y,n,c,p,f,b,L){b[0]=0,L[0]=-kt,L[1]=kt,f[0]=y[n];for(let E=1,H=0,h=0;E<p;E++){f[E]=y[n+E*c];let I=E*E;do{let _=b[H];h=(f[E]-f[_]+I-_*_)/(E-_)/2}while(h<=L[H]&&--H>-1);H++,b[H]=E,L[H]=h,L[H+1]=kt}for(let E=0,H=0;E<p;E++){for(;L[H+1]<E;)H++;let h=b[H],I=E-h;y[n+E*c]=f[h]+I*I}}class ie{constructor(n,c){this.requestManager=n,this.localIdeographFontFamily=c,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return o._(this,void 0,void 0,function*(){let c=[];for(let b in n)for(let L of n[b])c.push(this._getAndCacheGlyphsPromise(b,L));let p=yield Promise.all(c),f={};for(let{stack:b,id:L,glyph:E}of p)f[b]||(f[b]={}),f[b][L]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics};return f})}_getAndCacheGlyphsPromise(n,c){return o._(this,void 0,void 0,function*(){let p=this.entries[n];p||(p=this.entries[n]={glyphs:{},requests:{},ranges:{}});let f=p.glyphs[c];if(f!==void 0)return{stack:n,id:c,glyph:f};if(f=this._tinySDF(p,n,c),f)return p.glyphs[c]=f,{stack:n,id:c,glyph:f};let b=Math.floor(c/256);if(256*b>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[b])return{stack:n,id:c,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[b]){let E=ie.loadGlyphRange(n,b,this.url,this.requestManager);p.requests[b]=E}let L=yield p.requests[b];for(let E in L)this._doesCharSupportLocalGlyph(+E)||(p.glyphs[+E]=L[+E]);return p.ranges[b]=!0,{stack:n,id:c,glyph:L[c]||null}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(o.u["CJK Unified Ideographs"](n)||o.u["Hangul Syllables"](n)||o.u.Hiragana(n)||o.u.Katakana(n))}_tinySDF(n,c,p){let f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(p))return;let b=n.tinySDF;if(!b){let E="400";/bold/i.test(c)?E="900":/medium/i.test(c)?E="500":/light/i.test(c)&&(E="200"),b=n.tinySDF=new ie.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:E})}let L=b.draw(String.fromCharCode(p));return{id:p,bitmap:new o.o({width:L.width||60,height:L.height||60},L.data),metrics:{width:L.glyphWidth/2||24,height:L.glyphHeight/2||24,left:L.glyphLeft/2+.5||0,top:L.glyphTop/2-27.5||-8,advance:L.glyphAdvance/2||24,isDoubleResolution:!0}}}}ie.loadGlyphRange=function(y,n,c,p){return o._(this,void 0,void 0,function*(){let f=256*n,b=f+255,L=p.transformRequest(c.replace("{fontstack}",y).replace("{range}",`${f}-${b}`),tt.Glyphs),E=yield o.l(L,new AbortController);if(!E||!E.data)throw new Error(`Could not load glyph range. range: ${n}, ${f}-${b}`);let H={};for(let h of o.n(E.data))H[h.id]=h;return H})},ie.TinySDF=class{constructor({fontSize:y=24,buffer:n=3,radius:c=8,cutoff:p=.25,fontFamily:f="sans-serif",fontWeight:b="normal",fontStyle:L="normal"}={}){this.buffer=n,this.cutoff=p,this.radius=c;let E=this.size=y+4*n,H=this._createCanvas(E),h=this.ctx=H.getContext("2d",{willReadFrequently:!0});h.font=`${L} ${b} ${y}px ${f}`,h.textBaseline="alphabetic",h.textAlign="left",h.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(y){let n=document.createElement("canvas");return n.width=n.height=y,n}draw(y){let{width:n,actualBoundingBoxAscent:c,actualBoundingBoxDescent:p,actualBoundingBoxLeft:f,actualBoundingBoxRight:b}=this.ctx.measureText(y),L=Math.ceil(c),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-f))),H=Math.min(this.size-this.buffer,L+Math.ceil(p)),h=E+2*this.buffer,I=H+2*this.buffer,_=Math.max(h*I,0),F=new Uint8ClampedArray(_),R={data:F,width:h,height:I,glyphWidth:E,glyphHeight:H,glyphTop:L,glyphLeft:0,glyphAdvance:n};if(E===0||H===0)return R;let{ctx:Z,buffer:N,gridInner:P,gridOuter:V}=this;Z.clearRect(N,N,E,H),Z.fillText(y,N,N+L);let X=Z.getImageData(N,N,E,H);V.fill(kt,0,_),P.fill(0,0,_);for(let J=0;J<H;J++)for(let ot=0;ot<E;ot++){let dt=X.data[4*(J*E+ot)+3]/255;if(dt===0)continue;let ut=(J+N)*h+ot+N;if(dt===1)V[ut]=0,P[ut]=kt;else{let Gt=.5-dt;V[ut]=Gt>0?Gt*Gt:0,P[ut]=Gt<0?Gt*Gt:0}}_t(V,0,0,h,I,h,this.f,this.v,this.z),_t(P,N,N,E,H,h,this.f,this.v,this.z);for(let J=0;J<_;J++){let ot=Math.sqrt(V[J])-Math.sqrt(P[J]);F[J]=Math.round(255-255*(ot/this.radius+this.cutoff))}return R}};class ne{constructor(){this.specification=o.v.light.position}possiblyEvaluate(n,c){return o.y(n.expression.evaluate(c))}interpolate(n,c,p){return{x:o.z.number(n.x,c.x,p),y:o.z.number(n.y,c.y,p),z:o.z.number(n.z,c.z,p)}}}let te;class wt extends o.E{constructor(n){super(),te=te||new o.q({anchor:new o.D(o.v.light.anchor),position:new ne,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.T(te),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,c={}){if(!this._validate(o.r,n,c))for(let p in n){let f=n[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),f):this._transitionable.setValue(p,f)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,c,p){return(!p||p.validate!==!1)&&o.t(this,n.call(o.x,{value:c,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}class Ut{constructor(n,c){this.width=n,this.height=c,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,c){let p=n.join(",")+String(c);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(n,c)),this.dashEntry[p]}getDashRanges(n,c,p){let f=[],b=n.length%2==1?-n[n.length-1]*p:0,L=n[0]*p,E=!0;f.push({left:b,right:L,isDash:E,zeroLength:n[0]===0});let H=n[0];for(let h=1;h<n.length;h++){E=!E;let I=n[h];b=H*p,H+=I,L=H*p,f.push({left:b,right:L,isDash:E,zeroLength:I===0})}return f}addRoundDash(n,c,p){let f=c/2;for(let b=-p;b<=p;b++){let L=this.width*(this.nextRow+p+b),E=0,H=n[E];for(let h=0;h<this.width;h++){h/H.right>1&&(H=n[++E]);let I=Math.abs(h-H.left),_=Math.abs(h-H.right),F=Math.min(I,_),R,Z=b/p*(f+1);if(H.isDash){let N=f-Math.abs(Z);R=Math.sqrt(F*F+N*N)}else R=f-Math.sqrt(F*F+Z*Z);this.data[L+h]=Math.max(0,Math.min(255,R+128))}}}addRegularDash(n){for(let E=n.length-1;E>=0;--E){let H=n[E],h=n[E+1];H.zeroLength?n.splice(E,1):h&&h.isDash===H.isDash&&(h.left=H.left,n.splice(E,1))}let c=n[0],p=n[n.length-1];c.isDash===p.isDash&&(c.left=p.left-this.width,p.right=c.right+this.width);let f=this.width*this.nextRow,b=0,L=n[b];for(let E=0;E<this.width;E++){E/L.right>1&&(L=n[++b]);let H=Math.abs(E-L.left),h=Math.abs(E-L.right),I=Math.min(H,h);this.data[f+E]=Math.max(0,Math.min(255,(L.isDash?I:-I)+128))}}addDash(n,c){let p=c?7:0,f=2*p+1;if(this.nextRow+f>this.height)return o.w("LineAtlas out of space"),null;let b=0;for(let E=0;E<n.length;E++)b+=n[E];if(b!==0){let E=this.width/b,H=this.getDashRanges(n,this.width,E);c?this.addRoundDash(H,E,p):this.addRegularDash(H)}let L={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:b};return this.nextRow+=f,this.dirty=!0,L}bind(n){let c=n.gl;this.texture?(c.bindTexture(c.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,c.texSubImage2D(c.TEXTURE_2D,0,0,0,this.width,this.height,c.ALPHA,c.UNSIGNED_BYTE,this.data))):(this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.ALPHA,this.width,this.height,0,c.ALPHA,c.UNSIGNED_BYTE,this.data))}}let fe="maplibre_preloaded_worker_pool";class j{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<j.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[fe]}numActive(){return Object.keys(this.active).length}}let bt=Math.floor(v.hardwareConcurrency/2),It,Ht;function Ot(){return It||(It=new j),It}j.workerCount=o.B(globalThis)?Math.max(Math.min(bt,3),1):1;class Ae{constructor(n,c){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=c;let p=this.workerPool.acquire(c);for(let f=0;f<p.length;f++){let b=new o.C(p[f],c);b.name=`Worker ${f}`,this.actors.push(b)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,c){let p=[];for(let f of this.actors)p.push(f.sendAsync({type:n,data:c}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(c=>{c.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,c){for(let p of this.actors)p.registerMessageHandler(n,c)}}function he(){return Ht||(Ht=new Ae(Ot(),o.G),Ht.registerMessageHandler("getResource",(y,n,c)=>o.m(n,c))),Ht}function de(y,n){let c=o.F();return o.H(c,c,[1,1,0]),o.J(c,c,[.5*y.width,.5*y.height,1]),o.K(c,c,y.calculatePosMatrix(n.toUnwrapped()))}function He(y,n,c,p,f,b){let L=function(_,F,R){if(_)for(let Z of _){let N=F[Z];if(N&&N.source===R&&N.type==="fill-extrusion")return!0}else for(let Z in F){let N=F[Z];if(N.source===R&&N.type==="fill-extrusion")return!0}return!1}(f&&f.layers,n,y.id),E=b.maxPitchScaleFactor(),H=y.tilesIn(p,E,L);H.sort(Re);let h=[];for(let _ of H)h.push({wrappedTileID:_.tileID.wrapped().key,queryResults:_.tile.queryRenderedFeatures(n,c,y._state,_.queryGeometry,_.cameraQueryGeometry,_.scale,f,b,E,de(y.transform,_.tileID))});let I=function(_){let F={},R={};for(let Z of _){let N=Z.queryResults,P=Z.wrappedTileID,V=R[P]=R[P]||{};for(let X in N){let J=N[X],ot=V[X]=V[X]||{},dt=F[X]=F[X]||[];for(let ut of J)ot[ut.featureIndex]||(ot[ut.featureIndex]=!0,dt.push(ut))}}return F}(h);for(let _ in I)I[_].forEach(F=>{let R=F.feature,Z=y.getFeatureState(R.layer["source-layer"],R.id);R.source=R.layer.source,R.layer["source-layer"]&&(R.sourceLayer=R.layer["source-layer"]),R.state=Z});return I}function Re(y,n){let c=y.tileID,p=n.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function je(y,n,c){return o._(this,void 0,void 0,function*(){let p=y;if(y.url?p=(yield o.h(n.transformRequest(y.url,tt.Source),c)).data:yield v.frameAsync(c),!p)return null;let f=o.L(o.e(p,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(f.vectorLayerIds=p.vector_layers.map(b=>b.id)),f})}class Me{constructor(n,c){n&&(c?this.setSouthWest(n).setNorthEast(c):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof o.M?new o.M(n.lng,n.lat):o.M.convert(n),this}setSouthWest(n){return this._sw=n instanceof o.M?new o.M(n.lng,n.lat):o.M.convert(n),this}extend(n){let c=this._sw,p=this._ne,f,b;if(n instanceof o.M)f=n,b=n;else{if(!(n instanceof Me))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Me.convert(n)):this.extend(o.M.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(o.M.convert(n)):this;if(f=n._sw,b=n._ne,!f||!b)return this}return c||p?(c.lng=Math.min(f.lng,c.lng),c.lat=Math.min(f.lat,c.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new o.M(f.lng,f.lat),this._ne=new o.M(b.lng,b.lat)),this}getCenter(){return new o.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.M(this.getWest(),this.getNorth())}getSouthEast(){return new o.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){let{lng:c,lat:p}=o.M.convert(n),f=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&f}static convert(n){return n instanceof Me?n:n&&new Me(n)}static fromLngLat(n,c=0){let p=360*c/40075017,f=p/Math.cos(Math.PI/180*n.lat);return new Me(new o.M(n.lng-f,n.lat-p),new o.M(n.lng+f,n.lat+p))}}class gi{constructor(n,c,p){this.bounds=Me.convert(this.validateBounds(n)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){let c=Math.pow(2,n.z),p=Math.floor(o.N(this.bounds.getWest())*c),f=Math.floor(o.O(this.bounds.getNorth())*c),b=Math.ceil(o.N(this.bounds.getEast())*c),L=Math.ceil(o.O(this.bounds.getSouth())*c);return n.x>=p&&n.x<b&&n.y>=f&&n.y<L}}class xt extends o.E{constructor(n,c,p,f){if(super(),this.id=n,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.L(c,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let n=yield je(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(o.e(this,n),n.bounds&&(this.tileBounds=new gi(n.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new o.j(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(n){return o._(this,void 0,void 0,function*(){let c=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(c,tt.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};p.request.collectResourceTiming=this._collectResourceTiming;let f="reloadTile";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((b,L)=>{n.reloadPromise={resolve:b,reject:L}})}else n.actor=this.dispatcher.getActor(),f="loadTile";n.abortController=new AbortController;try{let b=yield n.actor.sendAsync({type:f,data:p},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,b)}catch(b){if(delete n.abortController,n.aborted)return;if(b&&b.status!==404)throw b;this._afterTileLoadWorkerResponse(n,null)}})}_afterTileLoadWorkerResponse(n,c){if(c&&c.resourceTiming&&(n.resourceTiming=c.resourceTiming),c&&this.map._refreshExpiredTiles&&n.setExpiryData(c),n.loadVectorData(c,this.map.painter),n.reloadPromise){let p=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(p.resolve).catch(p.reject)}}abortTile(n){return o._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"abortTile",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return o._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"removeTile",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Rt extends o.E{constructor(n,c,p,f){super(),this.id=n,this.dispatcher=p,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},c),o.e(this,o.L(c,["url","scheme","tileSize"]))}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let n=yield je(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(o.e(this,n),n.bounds&&(this.tileBounds=new gi(n.bounds,this.minzoom,this.maxzoom)),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new o.j(n))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return o.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return o._(this,void 0,void 0,function*(){let c=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{let p=yield O.getImage(this.map._requestManager.transformRequest(c,tt.Tile),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&p.cacheControl&&p.expires&&n.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});let f=this.map.painter.context,b=f.gl,L=p.data;n.texture=this.map.painter.getTileTexture(L.width),n.texture?n.texture.update(L,{useMipmap:!0}):(n.texture=new qt(f,L,b.RGBA,{useMipmap:!0}),n.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST),f.extTextureFilterAnisotropic&&b.texParameterf(b.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax)),n.state="loaded"}}catch(p){if(delete n.abortController,n.aborted)n.state="unloaded";else if(p)throw n.state="errored",p}})}abortTile(n){return o._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return o._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class Li extends Rt{constructor(n,c,p,f){super(n,c,p,f),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox",this.redFactor=c.redFactor,this.greenFactor=c.greenFactor,this.blueFactor=c.blueFactor,this.baseShift=c.baseShift}loadTile(n){return o._(this,void 0,void 0,function*(){let c=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(c,tt.Tile);n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{let f=yield O.getImage(p,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(f&&f.data){let b=f.data;this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&n.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});let L=o.b(b)&&o.S()?b:yield this.readImageNow(b),E={type:this.type,uid:n.uid,source:this.id,rawImageData:L,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();let H=yield n.actor.sendAsync({type:"loadDEMTile",data:E});n.dem=H,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(f){if(delete n.abortController,n.aborted)n.state="unloaded";else if(f)throw n.state="errored",f}})}readImageNow(n){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.U()){let c=n.width+2,p=n.height+2;try{return new o.R({width:c,height:p},yield o.V(n,-1,-1,c,p))}catch{}}return v.getImageData(n,1)})}_getNeighboringTiles(n){let c=n.canonical,p=Math.pow(2,c.z),f=(c.x-1+p)%p,b=c.x===0?n.wrap-1:n.wrap,L=(c.x+1+p)%p,E=c.x+1===p?n.wrap+1:n.wrap,H={};return H[new o.Q(n.overscaledZ,b,c.z,f,c.y).key]={backfilled:!1},H[new o.Q(n.overscaledZ,E,c.z,L,c.y).key]={backfilled:!1},c.y>0&&(H[new o.Q(n.overscaledZ,b,c.z,f,c.y-1).key]={backfilled:!1},H[new o.Q(n.overscaledZ,n.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},H[new o.Q(n.overscaledZ,E,c.z,L,c.y-1).key]={backfilled:!1}),c.y+1<p&&(H[new o.Q(n.overscaledZ,b,c.z,f,c.y+1).key]={backfilled:!1},H[new o.Q(n.overscaledZ,n.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},H[new o.Q(n.overscaledZ,E,c.z,L,c.y+1).key]={backfilled:!1}),H}unloadTile(n){return o._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"removeDEMTile",data:{type:this.type,uid:n.uid,source:this.id}}))})}}class Ue extends o.E{constructor(n,c,p,f){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(f),this._data=c.data,this._options=o.e({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;let b=o.W/this.tileSize;this.workerOptions=o.e({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*b,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*b,extent:o.W,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:o.W,radius:(c.clusterRadius||50)*b,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=n.clusterRadius),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=n.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"getClusterExpansionZoom",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"getClusterChildren",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,c,p){return this.actor.sendAsync({type:"getClusterLeaves",data:{type:this.type,source:this.id,clusterId:n,limit:c,offset:p}})}_updateWorkerData(n){return o._(this,void 0,void 0,function*(){let c=o.e({type:this.type},this.workerOptions);n?c.dataDiff=n:typeof this._data=="string"?(c.request=this.map._requestManager.transformRequest(v.resolveURL(this._data),tt.Source),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new o.k("dataloading",{dataType:"source"}));try{let p=yield this.actor.sendAsync({type:"loadData",data:c});if(this._pendingLoads--,this._removed||p.abandoned)return void this.fire(new o.k("dataabort",{dataType:"source"}));let f=null;p.resourceTiming&&p.resourceTiming[this.id]&&(f=p.resourceTiming[this.id].slice(0));let b={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&o.e(b,{resourceTiming:f}),this.fire(new o.k("data",Object.assign(Object.assign({},b),{sourceDataType:"metadata"}))),this.fire(new o.k("data",Object.assign(Object.assign({},b),{sourceDataType:"content"})))}catch(p){if(this._pendingLoads--,this._removed)return void this.fire(new o.k("dataabort",{dataType:"source"}));this.fire(new o.j(p))}})}loaded(){return this._pendingLoads===0}loadTile(n){return o._(this,void 0,void 0,function*(){let c=n.actor?"reloadTile":"loadTile";n.actor=this.actor;let p={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.abortController=new AbortController;let f=yield this.actor.sendAsync({type:c,data:p},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(f,this.map.painter,c==="reloadTile")})}abortTile(n){return o._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return o._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"removeTile",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"removeSource",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ee=o.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ne extends o.E{constructor(n,c,p,f){super(),this.id=n,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=c}load(n){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let c=yield O.getImage(this.map._requestManager.transformRequest(this.url,tt.Image),this._request);this._request=null,this._loaded=!0,c&&c.data&&(this.image=c.data,n&&(this.coordinates=n),this._finishLoading())}catch(c){this._request=null,this.fire(new o.j(c))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;let c=n.map(o.Y.fromLngLat);this.tileID=function(f){let b=1/0,L=1/0,E=-1/0,H=-1/0;for(let F of f)b=Math.min(b,F.x),L=Math.min(L,F.y),E=Math.max(E,F.x),H=Math.max(H,F.y);let h=Math.max(E-b,H-L),I=Math.max(0,Math.floor(-Math.log(h)/Math.LN2)),_=Math.pow(2,I);return new o.a0(I,Math.floor((b+E)/2*_),Math.floor((L+H)/2*_))}(c),this.minzoom=this.maxzoom=this.tileID.z;let p=c.map(f=>this.tileID.getTilePoint(f)._round());return this._boundsArray=new o.Z,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,o.W,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,o.W),this._boundsArray.emplaceBack(p[2].x,p[2].y,o.W,o.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let n=this.map.painter.context,c=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ee.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new qt(n,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let p=!1;for(let f in this.tiles){let b=this.tiles[f];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,p=!0)}p&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Je extends Ne{constructor(n,c,p,f){super(n,c,p,f),this.roundZoom=!0,this.type="video",this.options=c}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;let n=this.options;this.urls=[];for(let c of n.urls)this.urls.push(this.map._requestManager.transformRequest(c,tt.Source).url);try{let c=yield o.a2(this.urls);if(this._loaded=!0,!c)return;this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(c){this.fire(new o.j(c))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){let c=this.video.seekable;n<c.start(0)||n>c.end(0)?this.fire(new o.j(new o.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let n=this.map.painter.context,c=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,Ee.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new qt(n,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let p=!1;for(let f in this.tiles){let b=this.tiles[f];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,p=!0)}p&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ze extends Ne{constructor(n,c,p,f){super(n,c,p,f),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(L=>typeof L!="number"))||this.fire(new o.j(new o.a1(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.j(new o.a1(`sources.${n}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new o.j(new o.a1(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof HTMLCanvasElement||this.fire(new o.j(new o.a1(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.j(new o.a1(`sources.${n}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let c=this.map.painter.context,p=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Ee.members)),this.boundsSegments||(this.boundsSegments=o.$.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new qt(c,this.canvas,p.RGBA,{premultiply:!0});let f=!1;for(let b in this.tiles){let L=this.tiles[b];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture,f=!0)}f&&this.fire(new o.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}let ui={},hi=y=>{switch(y){case"geojson":return Ue;case"image":return Ne;case"raster":return Rt;case"raster-dem":return Li;case"vector":return xt;case"video":return Je;case"canvas":return ze}return ui[y]},Ei="RTLPluginLoaded";class Pi extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=he()}_syncState(n){return this.status=n,this.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:n,pluginURL:this.url}).catch(c=>{throw this.status="error",c})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return o._(this,arguments,void 0,function*(c,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=v.resolveURL(c),!this.url)throw new Error(`requested url ${c} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.k(Ei))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ie=null;function Oi(){return Ie||(Ie=new Pi),Ie}class mi{constructor(n,c){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=o.a3(),this.uses=0,this.tileSize=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){let c=n+this.timeAdded;c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,c,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(f,b){let L={};if(!b)return L;for(let E of f){let H=E.layerIds.map(h=>b.getLayer(h)).filter(Boolean);if(H.length!==0){E.layers=H,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(h=>H.filter(I=>I.id===h)[0]));for(let h of H)L[h.id]=E}}return L}(n.buckets,c.style),this.hasSymbolBuckets=!1;for(let f in this.buckets){let b=this.buckets[f];if(b instanceof o.a5){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let f in this.buckets){let b=this.buckets[f];if(b instanceof o.a5&&b.hasRTLText){this.hasRTLText=!0,Oi().lazyLoad();break}}this.queryPadding=0;for(let f in this.buckets){let b=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(f).queryRadius(b))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new o.a4}unloadVectorData(){for(let n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(let p in this.buckets){let f=this.buckets[p];f.uploadPending()&&f.upload(n)}let c=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new qt(n,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new qt(n,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,c,p,f,b,L,E,H,h,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:b,scale:L,tileSize:this.tileSize,pixelPosMatrix:I,transform:H,params:E,queryPadding:this.queryPadding*h},n,c,p):{}}querySourceFeatures(n,c){let p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;let f=p.loadVTLayers(),b=c&&c.sourceLayer?c.sourceLayer:"",L=f._geojsonTileLayer||f[b];if(!L)return;let E=o.a6(c&&c.filter),{z:H,x:h,y:I}=this.tileID.canonical,_={z:H,x:h,y:I};for(let F=0;F<L.length;F++){let R=L.feature(F);if(E.needGeometry){let P=o.a7(R,!0);if(!E.filter(new o.a8(this.tileID.overscaledZ),P,this.tileID.canonical))continue}else if(!E.filter(new o.a8(this.tileID.overscaledZ),R))continue;let Z=p.getId(R,b),N=new o.a9(R,H,h,I,Z);N.tile=_,n.push(N)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){let c=this.expirationTime;if(n.cacheControl){let p=o.aa(n.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){let p=Date.now(),f=!1;if(this.expirationTime>p)f=!1;else if(c)if(this.expirationTime<c)f=!0;else{let b=this.expirationTime-c;b?this.expirationTime=p+Math.max(b,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;let p=this.latestFeatureIndex.loadVTLayers();for(let f in this.buckets){if(!c.style.hasLayer(f))continue;let b=this.buckets[f],L=b.layers[0].sourceLayer||"_geojsonTileLayer",E=p[L],H=n[L];if(!E||!H||Object.keys(H).length===0)continue;b.update(H,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});let h=c&&c.style&&c.style.getLayer(f);h&&(this.queryPadding=Math.max(this.queryPadding,h.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<v.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=v.now()+n}setDependencies(n,c){let p={};for(let f of c)p[f]=!0;this.dependencies[n]=p}hasDependency(n,c){for(let p of n){let f=this.dependencies[p];if(f){for(let b of c)if(f[b])return!0}}return!1}}class Vi{constructor(n,c){this.max=n,this.onRemove=c,this.reset()}reset(){for(let n in this.data)for(let c of this.data[n])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(n,c,p){let f=n.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);let b={value:c,timeout:void 0};if(p!==void 0&&(b.timeout=setTimeout(()=>{this.remove(n,b)},p)),this.data[f].push(b),this.order.push(f),this.order.length>this.max){let L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){let c=this.data[n].shift();return c.timeout&&clearTimeout(c.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),c.value}getByKey(n){let c=this.data[n];return c?c[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,c){if(!this.has(n))return this;let p=n.wrapped().key,f=c===void 0?0:this.data[p].indexOf(c),b=this.data[p][f];return this.data[p].splice(f,1),b.timeout&&clearTimeout(b.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){let c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(n){let c=[];for(let p in this.data)for(let f of this.data[p])n(f.value)||c.push(f);for(let p of c)this.remove(p.value.tileID,p)}}class We{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,c,p){let f=String(c);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][f]=this.stateChanges[n][f]||{},o.e(this.stateChanges[n][f],p),this.deletedStates[n]===null){this.deletedStates[n]={};for(let b in this.state[n])b!==f&&(this.deletedStates[n][b]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][f]===null){this.deletedStates[n][f]={};for(let b in this.state[n][f])p[b]||(this.deletedStates[n][f][b]=null)}else for(let b in p)this.deletedStates[n]&&this.deletedStates[n][f]&&this.deletedStates[n][f][b]===null&&delete this.deletedStates[n][f][b]}removeFeatureState(n,c,p){if(this.deletedStates[n]===null)return;let f=String(c);if(this.deletedStates[n]=this.deletedStates[n]||{},p&&c!==void 0)this.deletedStates[n][f]!==null&&(this.deletedStates[n][f]=this.deletedStates[n][f]||{},this.deletedStates[n][f][p]=null);else if(c!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][f])for(p in this.deletedStates[n][f]={},this.stateChanges[n][f])this.deletedStates[n][f][p]=null;else this.deletedStates[n][f]=null;else this.deletedStates[n]=null}getState(n,c){let p=String(c),f=o.e({},(this.state[n]||{})[p],(this.stateChanges[n]||{})[p]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){let b=this.deletedStates[n][c];if(b===null)return{};for(let L in b)delete f[L]}return f}initializeTileState(n,c){n.setFeatureState(this.state,c)}coalesceChanges(n,c){let p={};for(let f in this.stateChanges){this.state[f]=this.state[f]||{};let b={};for(let L in this.stateChanges[f])this.state[f][L]||(this.state[f][L]={}),o.e(this.state[f][L],this.stateChanges[f][L]),b[L]=this.state[f][L];p[f]=b}for(let f in this.deletedStates){this.state[f]=this.state[f]||{};let b={};if(this.deletedStates[f]===null)for(let L in this.state[f])b[L]={},this.state[f][L]={};else for(let L in this.deletedStates[f]){if(this.deletedStates[f][L]===null)this.state[f][L]={};else for(let E of Object.keys(this.deletedStates[f][L]))delete this.state[f][L][E];b[L]=this.state[f][L]}p[f]=p[f]||{},o.e(p[f],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(let f in n)n[f].setFeatureState(p,c)}}class Se extends o.E{constructor(n,c,p){super(),this.id=n,this.dispatcher=p,this.on("data",f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,b,L,E)=>{let H=new(hi(b.type))(f,b,L,E);if(H.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${H.id}`);return H})(n,c,p,this),this._tiles={},this._cache=new Vi(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new We,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let n in this._tiles){let c=this._tiles[n];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,c,p){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,c,p)}catch(f){n.state="errored",f.status!==404?this._source.fire(new o.j(f,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new o.k("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let c in this._tiles){let p=this._tiles[c];p.upload(n),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort($e).map(n=>n.key)}getRenderableIds(n){let c=[];for(let p in this._tiles)this._isIdRenderable(p,n)&&c.push(this._tiles[p]);return n?c.sort((p,f)=>{let b=p.tileID,L=f.tileID,E=new o.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),H=new o.P(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-L.overscaledZ||H.y-E.y||H.x-E.x}).map(p=>p.tileID.key):c.map(p=>p.tileID).sort($e).map(p=>p.key)}hasRenderableParent(n){let c=this.findLoadedParent(n,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(n,c){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(c||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,c){return o._(this,void 0,void 0,function*(){let p=this._tiles[n];p&&(p.state!=="loading"&&(p.state=c),yield this._loadTile(p,n,c))})}_tileLoaded(n,c,p){n.timeAdded=v.now(),p==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(c,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new o.k("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){let c=this.getRenderableIds();for(let f=0;f<c.length;f++){let b=c[f];if(n.neighboringTiles&&n.neighboringTiles[b]){let L=this.getTileByID(b);p(n,L),p(L,n)}}function p(f,b){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let L=b.tileID.canonical.x-f.tileID.canonical.x,E=b.tileID.canonical.y-f.tileID.canonical.y,H=Math.pow(2,f.tileID.canonical.z),h=b.tileID.key;L===0&&E===0||Math.abs(E)>1||(Math.abs(L)>1&&(Math.abs(L+H)===1?L+=H:Math.abs(L-H)===1&&(L-=H)),b.dem&&f.dem&&(f.dem.backfillBorder(b.dem,L,E),f.neighboringTiles&&f.neighboringTiles[h]&&(f.neighboringTiles[h].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,c,p,f){for(let b in this._tiles){let L=this._tiles[b];if(f[b]||!L.hasData()||L.tileID.overscaledZ<=c||L.tileID.overscaledZ>p)continue;let E=L.tileID;for(;L&&L.tileID.overscaledZ>c+1;){let h=L.tileID.scaledTo(L.tileID.overscaledZ-1);L=this._tiles[h.key],L&&L.hasData()&&(E=h)}let H=E;for(;H.overscaledZ>c;)if(H=H.scaledTo(H.overscaledZ-1),n[H.key]){f[E.key]=E;break}}}findLoadedParent(n,c){if(n.key in this._loadedParentTiles){let p=this._loadedParentTiles[n.key];return p&&p.tileID.overscaledZ>=c?p:null}for(let p=n.overscaledZ-1;p>=c;p--){let f=n.scaledTo(p),b=this._getLoadedTile(f);if(b)return b}}_getLoadedTile(n){let c=this._tiles[n.key];return c&&c.hasData()?c:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){let c=Math.ceil(n.width/this._source.tileSize)+1,p=Math.ceil(n.height/this._source.tileSize)+1,f=Math.floor(c*p*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(b)}handleWrapJump(n){let c=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,c){let p={};for(let f in this._tiles){let b=this._tiles[f];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+c),p[b.tileID.key]=b}this._tiles=p;for(let f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(let f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}update(n,c){if(this.transform=n,this.terrain=c,!this._sourceLoaded||this._paused)return;let p;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(I=>new o.Q(I.canonical.z,I.wrap,I.canonical.z,I.canonical.x,I.canonical.y)):(p=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:c}),this._source.hasTile&&(p=p.filter(I=>this._source.hasTile(I)))):p=[];let f=n.coveringZoomLevel(this._source),b=Math.max(f-Se.maxOverzooming,this._source.minzoom),L=Math.max(f+Se.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let I={};for(let _ of p)if(_.canonical.z>this._source.minzoom){let F=_.scaledTo(_.canonical.z-1);I[F.key]=F;let R=_.scaledTo(Math.max(this._source.minzoom,Math.min(_.canonical.z,5)));I[R.key]=R}p=p.concat(Object.values(I))}let E=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,E&&this.fire(new o.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let H=this._updateRetainedTiles(p,f);if(di(this._source.type)){let I={},_={},F=Object.keys(H),R=v.now();for(let Z of F){let N=H[Z],P=this._tiles[Z];if(!P||P.fadeEndTime!==0&&P.fadeEndTime<=R)continue;let V=this.findLoadedParent(N,b);V&&(this._addTile(V.tileID),I[V.tileID.key]=V.tileID),_[Z]=N}this._retainLoadedChildren(_,f,L,H);for(let Z in I)H[Z]||(this._coveredTiles[Z]=!0,H[Z]=I[Z]);if(c){let Z={},N={};for(let P of p)this._tiles[P.key].hasData()?Z[P.key]=P:N[P.key]=P;for(let P in N){let V=N[P].children(this._source.maxzoom);this._tiles[V[0].key]&&this._tiles[V[1].key]&&this._tiles[V[2].key]&&this._tiles[V[3].key]&&(Z[V[0].key]=H[V[0].key]=V[0],Z[V[1].key]=H[V[1].key]=V[1],Z[V[2].key]=H[V[2].key]=V[2],Z[V[3].key]=H[V[3].key]=V[3],delete N[P])}for(let P in N){let V=this.findLoadedParent(N[P],this._source.minzoom);if(V){Z[V.tileID.key]=H[V.tileID.key]=V.tileID;for(let X in Z)Z[X].isChildOf(V.tileID)&&delete Z[X]}}for(let P in this._tiles)Z[P]||(this._coveredTiles[P]=!0)}}for(let I in H)this._tiles[I].clearFadeHold();let h=o.ab(this._tiles,H);for(let I of h){let _=this._tiles[I];_.hasSymbolBuckets&&!_.holdingForFade()?_.setHoldDuration(this.map._fadeDuration):_.hasSymbolBuckets&&!_.symbolFadeFinished()||this._removeTile(I)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,c){let p={},f={},b=Math.max(c-Se.maxOverzooming,this._source.minzoom),L=Math.max(c+Se.maxUnderzooming,this._source.minzoom),E={};for(let H of n){let h=this._addTile(H);p[H.key]=H,h.hasData()||c<this._source.maxzoom&&(E[H.key]=H)}this._retainLoadedChildren(E,c,L,p);for(let H of n){let h=this._tiles[H.key];if(h.hasData())continue;if(c+1>this._source.maxzoom){let _=H.children(this._source.maxzoom)[0],F=this.getTile(_);if(F&&F.hasData()){p[_.key]=_;continue}}else{let _=H.children(this._source.maxzoom);if(p[_[0].key]&&p[_[1].key]&&p[_[2].key]&&p[_[3].key])continue}let I=h.wasRequested();for(let _=H.overscaledZ-1;_>=b;--_){let F=H.scaledTo(_);if(f[F.key])break;if(f[F.key]=!0,h=this.getTile(F),!h&&I&&(h=this._addTile(F)),h){let R=h.hasData();if((I||R)&&(p[F.key]=F),I=h.wasRequested(),R)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let n in this._tiles){let c=[],p,f=this._tiles[n].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){p=this._loadedParentTiles[f.key];break}c.push(f.key);let b=f.scaledTo(f.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;f=b}for(let b of c)this._loadedParentTiles[b]=p}}_addTile(n){let c=this._tiles[n.key];if(c)return c;c=this._cache.getAndRemove(n),c&&(this._setTileReloadTimer(n.key,c),c.tileID=n,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,c)));let p=c;return c||(c=new mi(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(c,n.key,c.state)),c.uses++,this._tiles[n.key]=c,p||this._source.fire(new o.k("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(n,c){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);let p=c.getExpiryTimeout();p&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},p))}_removeTile(n){let c=this._tiles[n];c&&(c.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,c,p){let f=[],b=this.transform;if(!b)return f;let L=p?b.getCameraQueryGeometry(n):n,E=n.map(Z=>b.pointCoordinate(Z,this.terrain)),H=L.map(Z=>b.pointCoordinate(Z,this.terrain)),h=this.getIds(),I=1/0,_=1/0,F=-1/0,R=-1/0;for(let Z of H)I=Math.min(I,Z.x),_=Math.min(_,Z.y),F=Math.max(F,Z.x),R=Math.max(R,Z.y);for(let Z=0;Z<h.length;Z++){let N=this._tiles[h[Z]];if(N.holdingForFade())continue;let P=N.tileID,V=Math.pow(2,b.zoom-N.tileID.overscaledZ),X=c*N.queryPadding*o.W/N.tileSize/V,J=[P.getTilePoint(new o.Y(I,_)),P.getTilePoint(new o.Y(F,R))];if(J[0].x-X<o.W&&J[0].y-X<o.W&&J[1].x+X>=0&&J[1].y+X>=0){let ot=E.map(ut=>P.getTilePoint(ut)),dt=H.map(ut=>P.getTilePoint(ut));f.push({tile:N,tileID:P,queryGeometry:ot,cameraQueryGeometry:dt,scale:V})}}return f}getVisibleCoordinates(n){let c=this.getRenderableIds(n).map(p=>this._tiles[p].tileID);for(let p of c)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(di(this._source.type)){let n=v.now();for(let c in this._tiles)if(this._tiles[c].fadeEndTime>=n)return!0}return!1}setFeatureState(n,c,p){this._state.updateState(n=n||"_geojsonTileLayer",c,p)}removeFeatureState(n,c,p){this._state.removeFeatureState(n=n||"_geojsonTileLayer",c,p)}getFeatureState(n,c){return this._state.getState(n=n||"_geojsonTileLayer",c)}setDependencies(n,c,p){let f=this._tiles[n];f&&f.setDependencies(c,p)}reloadTilesForDependencies(n,c){for(let p in this._tiles)this._tiles[p].hasDependency(n,c)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(n,c))}}function $e(y,n){let c=Math.abs(2*y.wrap)-+(y.wrap<0),p=Math.abs(2*n.wrap)-+(n.wrap<0);return y.overscaledZ-n.overscaledZ||p-c||n.canonical.y-y.canonical.y||n.canonical.x-y.canonical.x}function di(y){return y==="raster"||y==="image"||y==="video"}Se.maxOverzooming=10,Se.maxUnderzooming=3;class Zi{constructor(n,c){this.reset(n,c)}reset(n,c){this.points=n||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=o.ac(n,0,1);let c=1,p=this._distances[c],f=n*this.paddedLength+this.padding;for(;p<f&&c<this._distances.length;)p=this._distances[++c];let b=c-1,L=this._distances[b],E=p-L,H=E>0?(f-L)/E:0;return this.points[b].mult(1-H).add(this.points[c].mult(H))}}function qi(y,n){let c=!0;return y==="always"||y!=="never"&&n!=="never"||(c=!1),c}class vi{constructor(n,c,p){let f=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(n/p),this.yCellCount=Math.ceil(c/p);for(let L=0;L<this.xCellCount*this.yCellCount;L++)f.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=c,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,c,p,f,b){this._forEachCell(c,p,f,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(f),this.bboxes.push(b)}insertCircle(n,c,p,f){this._forEachCell(c-f,p-f,c+f,p+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(c),this.circles.push(p),this.circles.push(f)}_insertBoxCell(n,c,p,f,b,L){this.boxCells[b].push(L)}_insertCircleCell(n,c,p,f,b,L){this.circleCells[b].push(L)}_query(n,c,p,f,b,L,E){if(p<0||n>this.width||f<0||c>this.height)return[];let H=[];if(n<=0&&c<=0&&this.width<=p&&this.height<=f){if(b)return[{key:null,x1:n,y1:c,x2:p,y2:f}];for(let h=0;h<this.boxKeys.length;h++)H.push({key:this.boxKeys[h],x1:this.bboxes[4*h],y1:this.bboxes[4*h+1],x2:this.bboxes[4*h+2],y2:this.bboxes[4*h+3]});for(let h=0;h<this.circleKeys.length;h++){let I=this.circles[3*h],_=this.circles[3*h+1],F=this.circles[3*h+2];H.push({key:this.circleKeys[h],x1:I-F,y1:_-F,x2:I+F,y2:_+F})}}else this._forEachCell(n,c,p,f,this._queryCell,H,{hitTest:b,overlapMode:L,seenUids:{box:{},circle:{}}},E);return H}query(n,c,p,f){return this._query(n,c,p,f,!1,null)}hitTest(n,c,p,f,b,L){return this._query(n,c,p,f,!0,b,L).length>0}hitTestCircle(n,c,p,f,b){let L=n-p,E=n+p,H=c-p,h=c+p;if(E<0||L>this.width||h<0||H>this.height)return!1;let I=[];return this._forEachCell(L,H,E,h,this._queryCellCircle,I,{hitTest:!0,overlapMode:f,circle:{x:n,y:c,radius:p},seenUids:{box:{},circle:{}}},b),I.length>0}_queryCell(n,c,p,f,b,L,E,H){let{seenUids:h,hitTest:I,overlapMode:_}=E,F=this.boxCells[b];if(F!==null){let Z=this.bboxes;for(let N of F)if(!h.box[N]){h.box[N]=!0;let P=4*N,V=this.boxKeys[N];if(n<=Z[P+2]&&c<=Z[P+3]&&p>=Z[P+0]&&f>=Z[P+1]&&(!H||H(V))&&(!I||!qi(_,V.overlapMode))&&(L.push({key:V,x1:Z[P],y1:Z[P+1],x2:Z[P+2],y2:Z[P+3]}),I))return!0}}let R=this.circleCells[b];if(R!==null){let Z=this.circles;for(let N of R)if(!h.circle[N]){h.circle[N]=!0;let P=3*N,V=this.circleKeys[N];if(this._circleAndRectCollide(Z[P],Z[P+1],Z[P+2],n,c,p,f)&&(!H||H(V))&&(!I||!qi(_,V.overlapMode))){let X=Z[P],J=Z[P+1],ot=Z[P+2];if(L.push({key:V,x1:X-ot,y1:J-ot,x2:X+ot,y2:J+ot}),I)return!0}}}return!1}_queryCellCircle(n,c,p,f,b,L,E,H){let{circle:h,seenUids:I,overlapMode:_}=E,F=this.boxCells[b];if(F!==null){let Z=this.bboxes;for(let N of F)if(!I.box[N]){I.box[N]=!0;let P=4*N,V=this.boxKeys[N];if(this._circleAndRectCollide(h.x,h.y,h.radius,Z[P+0],Z[P+1],Z[P+2],Z[P+3])&&(!H||H(V))&&!qi(_,V.overlapMode))return L.push(!0),!0}}let R=this.circleCells[b];if(R!==null){let Z=this.circles;for(let N of R)if(!I.circle[N]){I.circle[N]=!0;let P=3*N,V=this.circleKeys[N];if(this._circlesCollide(Z[P],Z[P+1],Z[P+2],h.x,h.y,h.radius)&&(!H||H(V))&&!qi(_,V.overlapMode))return L.push(!0),!0}}}_forEachCell(n,c,p,f,b,L,E,H){let h=this._convertToXCellCoord(n),I=this._convertToYCellCoord(c),_=this._convertToXCellCoord(p),F=this._convertToYCellCoord(f);for(let R=h;R<=_;R++)for(let Z=I;Z<=F;Z++)if(b.call(this,n,c,p,f,this.xCellCount*Z+R,L,E,H))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,c,p,f,b,L){let E=f-n,H=b-c,h=p+L;return h*h>E*E+H*H}_circleAndRectCollide(n,c,p,f,b,L,E){let H=(L-f)/2,h=Math.abs(n-(f+H));if(h>H+p)return!1;let I=(E-b)/2,_=Math.abs(c-(b+I));if(_>I+p)return!1;if(h<=H||_<=I)return!0;let F=h-H,R=_-I;return F*F+R*R<=p*p}}function tr(y,n,c,p,f){let b=o.F();return n?(o.J(b,b,[1/f,1/f,1]),c||o.ad(b,b,p.angle)):o.K(b,p.labelPlaneMatrix,y),b}function Lr(y,n,c,p,f){if(n){let b=o.ae(y);return o.J(b,b,[f,f,1]),c||o.ad(b,b,-p.angle),b}return p.glCoordMatrix}function ft(y,n,c){let p;c?(p=[y.x,y.y,c(y.x,y.y),1],o.af(p,p,n)):(p=[y.x,y.y,0,1],oi(p,p,n));let f=p[3];return{point:new o.P(p[0]/f,p[1]/f),signedDistanceFromCamera:f}}function Y(y,n){return .5+y/n*.5}function q(y,n){let c=y[0]/y[3],p=y[1]/y[3];return c>=-n[0]&&c<=n[0]&&p>=-n[1]&&p<=n[1]}function rt(y,n,c,p,f,b,L,E,H,h){let I=p?y.textSizeData:y.iconSizeData,_=o.ag(I,c.transform.zoom),F=[256/c.width*2+1,256/c.height*2+1],R=p?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;R.clear();let Z=y.lineVertexArray,N=p?y.text.placedSymbolArray:y.icon.placedSymbolArray,P=c.transform.width/c.transform.height,V=!1;for(let X=0;X<N.length;X++){let J=N.get(X);if(J.hidden||J.writingMode===o.ah.vertical&&!V){Xe(J.numGlyphs,R);continue}let ot;if(V=!1,h?(ot=[J.anchorX,J.anchorY,h(J.anchorX,J.anchorY),1],o.af(ot,ot,n)):(ot=[J.anchorX,J.anchorY,0,1],oi(ot,ot,n)),!q(ot,F)){Xe(J.numGlyphs,R);continue}let dt=Y(c.transform.cameraToCenterDistance,ot[3]),ut=o.ai(I,_,J),Gt=L?ut/dt:ut*dt,Pt=new o.P(J.anchorX,J.anchorY),gt=ft(Pt,f,h).point,Ct={projections:{},offsets:{}},ee=zt(J,Gt,!1,E,n,f,b,y.glyphOffsetArray,Z,R,gt,Pt,Ct,P,H,h);V=ee.useVertical,(ee.notEnoughRoom||V||ee.needsFlipping&&zt(J,Gt,!0,E,n,f,b,y.glyphOffsetArray,Z,R,gt,Pt,Ct,P,H,h).notEnoughRoom)&&Xe(J.numGlyphs,R)}p?y.text.dynamicLayoutVertexBuffer.updateData(R):y.icon.dynamicLayoutVertexBuffer.updateData(R)}function ht(y,n,c,p,f,b,L,E,H,h,I,_,F){let R=E.glyphStartIndex+E.numGlyphs,Z=E.lineStartIndex,N=E.lineStartIndex+E.lineLength,P=n.getoffsetX(E.glyphStartIndex),V=n.getoffsetX(R-1),X=pe(y*P,c,p,f,b,L,E.segment,Z,N,H,h,I,_,F);if(!X)return null;let J=pe(y*V,c,p,f,b,L,E.segment,Z,N,H,h,I,_,F);return J?{first:X,last:J}:null}function Zt(y,n,c,p){return y===o.ah.horizontal&&Math.abs(c.y-n.y)>Math.abs(c.x-n.x)*p?{useVertical:!0}:(y===o.ah.vertical?n.y<c.y:n.x>c.x)?{needsFlipping:!0}:null}function zt(y,n,c,p,f,b,L,E,H,h,I,_,F,R,Z,N){let P=n/24,V=y.lineOffsetX*P,X=y.lineOffsetY*P,J;if(y.numGlyphs>1){let ot=y.glyphStartIndex+y.numGlyphs,dt=y.lineStartIndex,ut=y.lineStartIndex+y.lineLength,Gt=ht(P,E,V,X,c,I,_,y,H,b,F,Z,N);if(!Gt)return{notEnoughRoom:!0};let Pt=ft(Gt.first.point,L,N).point,gt=ft(Gt.last.point,L,N).point;if(p&&!c){let Ct=Zt(y.writingMode,Pt,gt,R);if(Ct)return Ct}J=[Gt.first];for(let Ct=y.glyphStartIndex+1;Ct<ot-1;Ct++)J.push(pe(P*E.getoffsetX(Ct),V,X,c,I,_,y.segment,dt,ut,H,b,F,Z,N));J.push(Gt.last)}else{if(p&&!c){let dt=ft(_,f,N).point,ut=y.lineStartIndex+y.segment+1,Gt=new o.P(H.getx(ut),H.gety(ut)),Pt=ft(Gt,f,N),gt=Pt.signedDistanceFromCamera>0?Pt.point:Xt(_,Gt,dt,1,f,N),Ct=Zt(y.writingMode,dt,gt,R);if(Ct)return Ct}let ot=pe(P*E.getoffsetX(y.glyphStartIndex),V,X,c,I,_,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,H,b,F,Z,N);if(!ot)return{notEnoughRoom:!0};J=[ot]}for(let ot of J)o.aj(h,ot.point,ot.angle);return{}}function Xt(y,n,c,p,f,b){let L=ft(y.add(y.sub(n)._unit()),f,b).point,E=c.sub(L);return c.add(E._mult(p/E.mag()))}function Mt(y,n){let{projectionCache:c,lineVertexArray:p,labelPlaneMatrix:f,tileAnchorPoint:b,distanceFromAnchor:L,getElevation:E,previousVertex:H,direction:h,absOffsetX:I}=n;if(c.projections[y])return c.projections[y];let _=new o.P(p.getx(y),p.gety(y)),F=ft(_,f,E);if(F.signedDistanceFromCamera>0)return c.projections[y]=F.point,F.point;let R=y-h;return Xt(L===0?b:new o.P(p.getx(R),p.gety(R)),_,H,I-L+1,f,E)}function re(y,n,c){return y._unit()._perp()._mult(n*c)}function ce(y,n,c,p,f,b,L,E){let{projectionCache:H,direction:h}=E;if(H.offsets[y])return H.offsets[y];let I=c.add(n);if(y+h<p||y+h>=f)return H.offsets[y]=I,I;let _=Mt(y+h,E),F=re(_.sub(c),L,h),R=c.add(F),Z=_.add(F);return H.offsets[y]=o.ak(b,I,R,Z)||I,H.offsets[y]}function pe(y,n,c,p,f,b,L,E,H,h,I,_,F,R){let Z=p?y-n:y+n,N=Z>0?1:-1,P=0;p&&(N*=-1,P=Math.PI),N<0&&(P+=Math.PI);let V,X,J=N>0?E+L:E+L+1,ot=f,dt=f,ut=0,Gt=0,Pt=Math.abs(Z),gt=[],Ct;for(;ut+Gt<=Pt;){if(J+=N,J<E||J>=H)return null;ut+=Gt,dt=ot,X=V;let jt={projectionCache:_,lineVertexArray:h,labelPlaneMatrix:I,tileAnchorPoint:b,distanceFromAnchor:ut,getElevation:R,previousVertex:dt,direction:N,absOffsetX:Pt};if(ot=Mt(J,jt),c===0)gt.push(dt),Ct=ot.sub(dt);else{let Fe,ke=ot.sub(dt);Fe=ke.mag()===0?re(Mt(J+N,jt).sub(ot),c,N):re(ke,c,N),X||(X=dt.add(Fe)),V=ce(J,Fe,ot,E,H,X,c,jt),gt.push(X),Ct=V.sub(X)}Gt=Ct.mag()}let ee=Ct._mult((Pt-ut)/Gt)._add(X||dt),ge=P+Math.atan2(ot.y-dt.y,ot.x-dt.x);return gt.push(ee),{point:ee,angle:F?ge:0,path:gt}}let me=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Xe(y,n){for(let c=0;c<y;c++){let p=n.length;n.resize(p+4),n.float32.set(me,3*p)}}function oi(y,n,c){let p=n[0],f=n[1];return y[0]=c[0]*p+c[4]*f+c[12],y[1]=c[1]*p+c[5]*f+c[13],y[3]=c[3]*p+c[7]*f+c[15],y}let ii=100;class Ni{constructor(n,c=new vi(n.width+200,n.height+200,25),p=new vi(n.width+200,n.height+200,25)){this.transform=n,this.grid=c,this.ignoredGrid=p,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+ii,this.screenBottomBoundary=n.height+ii,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,c,p,f,b,L){let E=this.projectAndGetPerspectiveRatio(f,n.anchorPointX,n.anchorPointY,L),H=p*E.perspectiveRatio,h=n.x1*H+E.point.x,I=n.y1*H+E.point.y,_=n.x2*H+E.point.x,F=n.y2*H+E.point.y;return!this.isInsideGrid(h,I,_,F)||c!=="always"&&this.grid.hitTest(h,I,_,F,c,b)||E.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[h,I,_,F],offscreen:this.isOffscreen(h,I,_,F)}}placeCollisionCircles(n,c,p,f,b,L,E,H,h,I,_,F,R,Z){let N=[],P=new o.P(c.anchorX,c.anchorY),V=ft(P,L,Z),X=Y(this.transform.cameraToCenterDistance,V.signedDistanceFromCamera),J=(I?b/X:b*X)/o.ao,ot=ft(P,E,Z).point,dt=ht(J,f,c.lineOffsetX*J,c.lineOffsetY*J,!1,ot,P,c,p,E,{projections:{},offsets:{}},!1,Z),ut=!1,Gt=!1,Pt=!0;if(dt){let gt=.5*F*X+R,Ct=new o.P(-100,-100),ee=new o.P(this.screenRightBoundary,this.screenBottomBoundary),ge=new Zi,jt=dt.first,Fe=dt.last,ke=[];for(let ci=jt.path.length-1;ci>=1;ci--)ke.push(jt.path[ci]);for(let ci=1;ci<Fe.path.length;ci++)ke.push(Fe.path[ci]);let Ye=2.5*gt;if(H){let ci=ke.map(pi=>ft(pi,H,Z));ke=ci.some(pi=>pi.signedDistanceFromCamera<=0)?[]:ci.map(pi=>pi.point)}let xe=[];if(ke.length>0){let ci=ke[0].clone(),pi=ke[0].clone();for(let Mi=1;Mi<ke.length;Mi++)ci.x=Math.min(ci.x,ke[Mi].x),ci.y=Math.min(ci.y,ke[Mi].y),pi.x=Math.max(pi.x,ke[Mi].x),pi.y=Math.max(pi.y,ke[Mi].y);xe=ci.x>=Ct.x&&pi.x<=ee.x&&ci.y>=Ct.y&&pi.y<=ee.y?[ke]:pi.x<Ct.x||ci.x>ee.x||pi.y<Ct.y||ci.y>ee.y?[]:o.al([ke],Ct.x,Ct.y,ee.x,ee.y)}for(let ci of xe){ge.reset(ci,.25*gt);let pi=0;pi=ge.length<=.5*gt?1:Math.ceil(ge.paddedLength/Ye)+1;for(let Mi=0;Mi<pi;Mi++){let Si=Mi/Math.max(pi-1,1),cr=ge.lerp(Si),ji=cr.x+ii,Ii=cr.y+ii;N.push(ji,Ii,gt,0);let vr=ji-gt,Yr=Ii-gt,Gr=ji+gt,mn=Ii+gt;if(Pt=Pt&&this.isOffscreen(vr,Yr,Gr,mn),Gt=Gt||this.isInsideGrid(vr,Yr,Gr,mn),n!=="always"&&this.grid.hitTestCircle(ji,Ii,gt,n,_)&&(ut=!0,!h))return{circles:[],offscreen:!1,collisionDetected:ut}}}}return{circles:!h&&ut||!Gt||X<this.perspectiveRatioCutoff?[]:N,offscreen:Pt,collisionDetected:ut}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let c=[],p=1/0,f=1/0,b=-1/0,L=-1/0;for(let I of n){let _=new o.P(I.x+ii,I.y+ii);p=Math.min(p,_.x),f=Math.min(f,_.y),b=Math.max(b,_.x),L=Math.max(L,_.y),c.push(_)}let E=this.grid.query(p,f,b,L).concat(this.ignoredGrid.query(p,f,b,L)),H={},h={};for(let I of E){let _=I.key;if(H[_.bucketInstanceId]===void 0&&(H[_.bucketInstanceId]={}),H[_.bucketInstanceId][_.featureIndex])continue;let F=[new o.P(I.x1,I.y1),new o.P(I.x2,I.y1),new o.P(I.x2,I.y2),new o.P(I.x1,I.y2)];o.am(c,F)&&(H[_.bucketInstanceId][_.featureIndex]=!0,h[_.bucketInstanceId]===void 0&&(h[_.bucketInstanceId]=[]),h[_.bucketInstanceId].push(_.featureIndex))}return h}insertCollisionBox(n,c,p,f,b,L){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:b,collisionGroupID:L,overlapMode:c},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,c,p,f,b,L){let E=p?this.ignoredGrid:this.grid,H={bucketInstanceId:f,featureIndex:b,collisionGroupID:L,overlapMode:c};for(let h=0;h<n.length;h+=4)E.insertCircle(H,n[h],n[h+1],n[h+2])}projectAndGetPerspectiveRatio(n,c,p,f){let b;return f?(b=[c,p,f(c,p),1],o.af(b,b,n)):(b=[c,p,0,1],oi(b,b,n)),{point:new o.P((b[0]/b[3]+1)/2*this.transform.width+ii,(-b[1]/b[3]+1)/2*this.transform.height+ii),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b[3]*.5}}isOffscreen(n,c,p,f){return p<ii||n>=this.screenRightBoundary||f<ii||c>this.screenBottomBoundary}isInsideGrid(n,c,p,f){return p>=0&&n<this.gridRightBoundary&&f>=0&&c<this.gridBottomBoundary}getViewportMatrix(){let n=o.an([]);return o.H(n,n,[-100,-100,0]),n}}function Qi(y,n,c){return n*(o.W/(y.tileSize*Math.pow(2,c-y.tileID.overscaledZ)))}class rr{constructor(n,c,p,f){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?c:-c))):f&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class zi{constructor(n,c,p,f,b){this.text=new rr(n?n.text:null,c,p,b),this.icon=new rr(n?n.icon:null,c,f,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Cr{constructor(n,c,p){this.text=n,this.icon=c,this.skipFade=p}}class ki{constructor(){this.invProjMatrix=o.F(),this.viewportMatrix=o.F(),this.circles=[]}}class fr{constructor(n,c,p,f,b){this.bucketInstanceId=n,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=f,this.tileID=b}}class br{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){let c=++this.maxGroupID;this.collisionGroups[n]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[n]}}function Tr(y,n,c,p,f){let{horizontalAlign:b,verticalAlign:L}=o.at(y);return new o.P(-(b-.5)*n+p[0]*f,-(L-.5)*c+p[1]*f)}function Dt(y,n,c,p,f,b){let{x1:L,x2:E,y1:H,y2:h,anchorPointX:I,anchorPointY:_}=y,F=new o.P(n,c);return p&&F._rotate(f?b:-b),{x1:L+F.x,y1:H+F.y,x2:E+F.x,y2:h+F.y,anchorPointX:I,anchorPointY:_}}class Ke{constructor(n,c,p,f,b){this.transform=n.clone(),this.terrain=c,this.collisionIndex=new Ni(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new br(f),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,c,p,f){let b=p.getBucket(c),L=p.latestFeatureIndex;if(!b||!L||c.id!==b.layerIds[0])return;let E=p.collisionBoxArray,H=b.layers[0].layout,h=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),I=p.tileSize/o.W,_=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),F=H.get("text-pitch-alignment")==="map",R=H.get("text-rotation-alignment")==="map",Z=Qi(p,1,this.transform.zoom),N=tr(_,F,R,this.transform,Z),P=null;if(F){let X=Lr(_,F,R,this.transform,Z);P=o.K([],this.transform.labelPlaneMatrix,X)}this.retainedQueryData[b.bucketInstanceId]=new fr(b.bucketInstanceId,L,b.sourceLayerIndex,b.index,p.tileID);let V={bucket:b,layout:H,posMatrix:_,textLabelPlaneMatrix:N,labelToScreenMatrix:P,scale:h,textPixelRatio:I,holdingForFade:p.holdingForFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:o.ag(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(f)for(let X of b.sortKeyRanges){let{sortKey:J,symbolInstanceStart:ot,symbolInstanceEnd:dt}=X;n.push({sortKey:J,symbolInstanceStart:ot,symbolInstanceEnd:dt,parameters:V})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:V})}attemptAnchorPlacement(n,c,p,f,b,L,E,H,h,I,_,F,R,Z,N,P){let V=o.ap[n.textAnchor],X=[n.textOffset0,n.textOffset1],J=Tr(V,p,f,X,b),ot=this.collisionIndex.placeCollisionBox(Dt(c,J.x,J.y,L,E,this.transform.angle),_,H,h,I.predicate,P);if((!N||this.collisionIndex.placeCollisionBox(Dt(N,J.x,J.y,L,E,this.transform.angle),_,H,h,I.predicate,P).box.length!==0)&&ot.box.length>0){let dt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(dt=this.prevPlacement.variableOffsets[F.crossTileID].anchor),F.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[F.crossTileID]={textOffset:X,width:p,height:f,anchor:V,textBoxScale:b,prevAnchor:dt},this.markUsedJustification(R,V,F,Z),R.allowVerticalPlacement&&(this.markUsedOrientation(R,Z,F),this.placedOrientations[F.crossTileID]=Z),{shift:J,placedGlyphBoxes:ot}}}placeLayerBucketPart(n,c,p){let{bucket:f,layout:b,posMatrix:L,textLabelPlaneMatrix:E,labelToScreenMatrix:H,textPixelRatio:h,holdingForFade:I,collisionBoxArray:_,partiallyEvaluatedTextSize:F,collisionGroup:R}=n.parameters,Z=b.get("text-optional"),N=b.get("icon-optional"),P=o.aq(b,"text-overlap","text-allow-overlap"),V=P==="always",X=o.aq(b,"icon-overlap","icon-allow-overlap"),J=X==="always",ot=b.get("text-rotation-alignment")==="map",dt=b.get("text-pitch-alignment")==="map",ut=b.get("icon-text-fit")!=="none",Gt=b.get("symbol-z-order")==="viewport-y",Pt=V&&(J||!f.hasIconData()||N),gt=J&&(V||!f.hasTextData()||Z);!f.collisionArrays&&_&&f.deserializeCollisionBoxes(_);let Ct=this.retainedQueryData[f.bucketInstanceId].tileID,ee=this.terrain?(jt,Fe)=>this.terrain.getElevation(Ct,jt,Fe):null,ge=(jt,Fe)=>{var ke,Ye;if(c[jt.crossTileID])return;if(I)return void(this.placements[jt.crossTileID]=new Cr(!1,!1,!1));let xe=!1,ci=!1,pi=!0,Mi=null,Si={box:null,offscreen:null},cr={box:null,offscreen:null},ji=null,Ii=null,vr=null,Yr=0,Gr=0,mn=0;Fe.textFeatureIndex?Yr=Fe.textFeatureIndex:jt.useRuntimeCollisionCircles&&(Yr=jt.featureIndex),Fe.verticalTextFeatureIndex&&(Gr=Fe.verticalTextFeatureIndex);let wr=Fe.textBox;if(wr){let ur=_r=>{let Br=o.ah.horizontal;if(f.allowVerticalPlacement&&!_r&&this.prevPlacement){let pn=this.prevPlacement.placedOrientations[jt.crossTileID];pn&&(this.placedOrientations[jt.crossTileID]=pn,Br=pn,this.markUsedOrientation(f,Br,jt))}return Br},sr=(_r,Br)=>{if(f.allowVerticalPlacement&&jt.numVerticalGlyphVertices>0&&Fe.verticalTextBox){for(let pn of f.writingModes)if(pn===o.ah.vertical?(Si=Br(),cr=Si):Si=_r(),Si&&Si.box&&Si.box.length)break}else Si=_r()},Ir=jt.textAnchorOffsetStartIndex,Sn=jt.textAnchorOffsetEndIndex;if(Sn===Ir){let _r=(Br,pn)=>{let $i=this.collisionIndex.placeCollisionBox(Br,P,h,L,R.predicate,ee);return $i&&$i.box&&$i.box.length&&(this.markUsedOrientation(f,pn,jt),this.placedOrientations[jt.crossTileID]=pn),$i};sr(()=>_r(wr,o.ah.horizontal),()=>{let Br=Fe.verticalTextBox;return f.allowVerticalPlacement&&jt.numVerticalGlyphVertices>0&&Br?_r(Br,o.ah.vertical):{box:null,offscreen:null}}),ur(Si&&Si.box&&Si.box.length)}else{let _r=o.ap[(Ye=(ke=this.prevPlacement)===null||ke===void 0?void 0:ke.variableOffsets[jt.crossTileID])===null||Ye===void 0?void 0:Ye.anchor],Br=($i,ya,na)=>{let Zr=$i.x2-$i.x1,sa=$i.y2-$i.y1,dl=jt.textBoxScale,Nl=ut&&X==="never"?ya:null,Ro={box:[],offscreen:!1},EA=P==="never"?1:2,TA="never";_r&&EA++;for(let Ns=0;Ns<EA;Ns++){for(let Ho=Ir;Ho<Sn;Ho++){let Ka=f.textAnchorOffsets.get(Ho);if(_r&&Ka.textAnchor!==_r)continue;let QA=this.attemptAnchorPlacement(Ka,$i,Zr,sa,dl,ot,dt,h,L,R,TA,jt,f,na,Nl,ee);if(QA&&(Ro=QA.placedGlyphBoxes,Ro&&Ro.box&&Ro.box.length))return xe=!0,Mi=QA.shift,Ro}_r?_r=null:TA=P}return Ro};sr(()=>Br(wr,Fe.iconBox,o.ah.horizontal),()=>{let $i=Fe.verticalTextBox;return f.allowVerticalPlacement&&!(Si&&Si.box&&Si.box.length)&&jt.numVerticalGlyphVertices>0&&$i?Br($i,Fe.verticalIconBox,o.ah.vertical):{box:null,offscreen:null}}),Si&&(xe=Si.box,pi=Si.offscreen);let pn=ur(Si&&Si.box);if(!xe&&this.prevPlacement){let $i=this.prevPlacement.variableOffsets[jt.crossTileID];$i&&(this.variableOffsets[jt.crossTileID]=$i,this.markUsedJustification(f,$i.anchor,jt,pn))}}}if(ji=Si,xe=ji&&ji.box&&ji.box.length>0,pi=ji&&ji.offscreen,jt.useRuntimeCollisionCircles){let ur=f.text.placedSymbolArray.get(jt.centerJustifiedTextSymbolIndex),sr=o.ai(f.textSizeData,F,ur),Ir=b.get("text-padding");Ii=this.collisionIndex.placeCollisionCircles(P,ur,f.lineVertexArray,f.glyphOffsetArray,sr,L,E,H,p,dt,R.predicate,jt.collisionCircleDiameter,Ir,ee),Ii.circles.length&&Ii.collisionDetected&&!p&&o.w("Collisions detected, but collision boxes are not shown"),xe=V||Ii.circles.length>0&&!Ii.collisionDetected,pi=pi&&Ii.offscreen}if(Fe.iconFeatureIndex&&(mn=Fe.iconFeatureIndex),Fe.iconBox){let ur=sr=>{let Ir=ut&&Mi?Dt(sr,Mi.x,Mi.y,ot,dt,this.transform.angle):sr;return this.collisionIndex.placeCollisionBox(Ir,X,h,L,R.predicate,ee)};cr&&cr.box&&cr.box.length&&Fe.verticalIconBox?(vr=ur(Fe.verticalIconBox),ci=vr.box.length>0):(vr=ur(Fe.iconBox),ci=vr.box.length>0),pi=pi&&vr.offscreen}let An=Z||jt.numHorizontalGlyphVertices===0&&jt.numVerticalGlyphVertices===0,rn=N||jt.numIconVertices===0;if(An||rn?rn?An||(ci=ci&&xe):xe=ci&&xe:ci=xe=ci&&xe,xe&&ji&&ji.box&&this.collisionIndex.insertCollisionBox(ji.box,P,b.get("text-ignore-placement"),f.bucketInstanceId,cr&&cr.box&&Gr?Gr:Yr,R.ID),ci&&vr&&this.collisionIndex.insertCollisionBox(vr.box,X,b.get("icon-ignore-placement"),f.bucketInstanceId,mn,R.ID),Ii&&(xe&&this.collisionIndex.insertCollisionCircles(Ii.circles,P,b.get("text-ignore-placement"),f.bucketInstanceId,Yr,R.ID),p)){let ur=f.bucketInstanceId,sr=this.collisionCircleArrays[ur];sr===void 0&&(sr=this.collisionCircleArrays[ur]=new ki);for(let Ir=0;Ir<Ii.circles.length;Ir+=4)sr.circles.push(Ii.circles[Ir+0]),sr.circles.push(Ii.circles[Ir+1]),sr.circles.push(Ii.circles[Ir+2]),sr.circles.push(Ii.collisionDetected?1:0)}if(jt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[jt.crossTileID]=new Cr(xe||Pt,ci||gt,pi||f.justReloaded),c[jt.crossTileID]=!0};if(Gt){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let jt=f.getSortedSymbolIndexes(this.transform.angle);for(let Fe=jt.length-1;Fe>=0;--Fe){let ke=jt[Fe];ge(f.symbolInstances.get(ke),f.collisionArrays[ke])}}else for(let jt=n.symbolInstanceStart;jt<n.symbolInstanceEnd;jt++)ge(f.symbolInstances.get(jt),f.collisionArrays[jt]);if(p&&f.bucketInstanceId in this.collisionCircleArrays){let jt=this.collisionCircleArrays[f.bucketInstanceId];o.ar(jt.invProjMatrix,L),jt.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}markUsedJustification(n,c,p,f){let b;b=f===o.ah.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[o.as(c)];let L=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(let E of L)E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=b>=0&&E!==b?0:p.crossTileID)}markUsedOrientation(n,c,p){let f=c===o.ah.horizontal||c===o.ah.horizontalOnly?c:0,b=c===o.ah.vertical?c:0,L=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(let E of L)n.text.placedSymbolArray.get(E).placedOrientation=f;p.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;let c=this.prevPlacement,p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;let f=c?c.symbolFadeChange(n):1,b=c?c.opacities:{},L=c?c.variableOffsets:{},E=c?c.placedOrientations:{};for(let H in this.placements){let h=this.placements[H],I=b[H];I?(this.opacities[H]=new zi(I,f,h.text,h.icon),p=p||h.text!==I.text.placed||h.icon!==I.icon.placed):(this.opacities[H]=new zi(null,f,h.text,h.icon,h.skipFade),p=p||h.text||h.icon)}for(let H in b){let h=b[H];if(!this.opacities[H]){let I=new zi(h,f,!1,!1);I.isHidden()||(this.opacities[H]=I,p=p||h.text.placed||h.icon.placed)}}for(let H in L)this.variableOffsets[H]||!this.opacities[H]||this.opacities[H].isHidden()||(this.variableOffsets[H]=L[H]);for(let H in E)this.placedOrientations[H]||!this.opacities[H]||this.opacities[H].isHidden()||(this.placedOrientations[H]=E[H]);if(c&&c.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:n)}updateLayerOpacities(n,c){let p={};for(let f of c){let b=f.getBucket(n);b&&f.latestFeatureIndex&&n.id===b.layerIds[0]&&this.updateBucketOpacities(b,p,f.collisionBoxArray)}}updateBucketOpacities(n,c,p){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();let f=n.layers[0],b=f.layout,L=new zi(null,0,!1,!1,!0),E=b.get("text-allow-overlap"),H=b.get("icon-allow-overlap"),h=f._unevaluatedLayout.hasValue("text-variable-anchor")||f._unevaluatedLayout.hasValue("text-variable-anchor-offset"),I=b.get("text-rotation-alignment")==="map",_=b.get("text-pitch-alignment")==="map",F=b.get("icon-text-fit")!=="none",R=new zi(null,0,E&&(H||!n.hasIconData()||b.get("icon-optional")),H&&(E||!n.hasTextData()||b.get("text-optional")),!0);!n.collisionArrays&&p&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(p);let Z=(N,P,V)=>{for(let X=0;X<P/4;X++)N.opacityVertexArray.emplaceBack(V);N.hasVisibleVertices=N.hasVisibleVertices||V!==an};for(let N=0;N<n.symbolInstances.length;N++){let P=n.symbolInstances.get(N),{numHorizontalGlyphVertices:V,numVerticalGlyphVertices:X,crossTileID:J}=P,ot=this.opacities[J];c[J]?ot=L:ot||(ot=R,this.opacities[J]=ot),c[J]=!0;let dt=P.numIconVertices>0,ut=this.placedOrientations[P.crossTileID],Gt=ut===o.ah.vertical,Pt=ut===o.ah.horizontal||ut===o.ah.horizontalOnly;if(V>0||X>0){let gt=Wo(ot.text);Z(n.text,V,Gt?an:gt),Z(n.text,X,Pt?an:gt);let Ct=ot.text.isHidden();[P.rightJustifiedTextSymbolIndex,P.centerJustifiedTextSymbolIndex,P.leftJustifiedTextSymbolIndex].forEach(jt=>{jt>=0&&(n.text.placedSymbolArray.get(jt).hidden=Ct||Gt?1:0)}),P.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(P.verticalPlacedTextSymbolIndex).hidden=Ct||Pt?1:0);let ee=this.variableOffsets[P.crossTileID];ee&&this.markUsedJustification(n,ee.anchor,P,ut);let ge=this.placedOrientations[P.crossTileID];ge&&(this.markUsedJustification(n,"left",P,ge),this.markUsedOrientation(n,ge,P))}if(dt){let gt=Wo(ot.icon),Ct=!(F&&P.verticalPlacedIconSymbolIndex&&Gt);P.placedIconSymbolIndex>=0&&(Z(n.icon,P.numIconVertices,Ct?gt:an),n.icon.placedSymbolArray.get(P.placedIconSymbolIndex).hidden=ot.icon.isHidden()),P.verticalPlacedIconSymbolIndex>=0&&(Z(n.icon,P.numVerticalIconVertices,Ct?an:gt),n.icon.placedSymbolArray.get(P.verticalPlacedIconSymbolIndex).hidden=ot.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){let gt=n.collisionArrays[N];if(gt){let Ct=new o.P(0,0);if(gt.textBox||gt.verticalTextBox){let ge=!0;if(h){let jt=this.variableOffsets[J];jt?(Ct=Tr(jt.anchor,jt.width,jt.height,jt.textOffset,jt.textBoxScale),I&&Ct._rotate(_?this.transform.angle:-this.transform.angle)):ge=!1}gt.textBox&&Te(n.textCollisionBox.collisionVertexArray,ot.text.placed,!ge||Gt,Ct.x,Ct.y),gt.verticalTextBox&&Te(n.textCollisionBox.collisionVertexArray,ot.text.placed,!ge||Pt,Ct.x,Ct.y)}let ee=Boolean(!Pt&&gt.verticalIconBox);gt.iconBox&&Te(n.iconCollisionBox.collisionVertexArray,ot.icon.placed,ee,F?Ct.x:0,F?Ct.y:0),gt.verticalIconBox&&Te(n.iconCollisionBox.collisionVertexArray,ot.icon.placed,!ee,F?Ct.x:0,F?Ct.y:0)}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){let N=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=N.invProjMatrix,n.placementViewportMatrix=N.viewportMatrix,n.collisionCircleArray=N.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,c){let p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>n}setStale(){this.stale=!0}}function Te(y,n,c,p,f){y.emplaceBack(n?1:0,c?1:0,p||0,f||0),y.emplaceBack(n?1:0,c?1:0,p||0,f||0),y.emplaceBack(n?1:0,c?1:0,p||0,f||0),y.emplaceBack(n?1:0,c?1:0,p||0,f||0)}let or=Math.pow(2,25),Er=Math.pow(2,24),Ji=Math.pow(2,17),Mr=Math.pow(2,16),vs=Math.pow(2,9),Sr=Math.pow(2,8),xr=Math.pow(2,1);function Wo(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;let n=y.placed?1:0,c=Math.floor(127*y.opacity);return c*or+n*Er+c*Ji+n*Mr+c*vs+n*Sr+c*xr+n}let an=0;class Dn{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,c,p,f,b){let L=this._bucketParts;for(;this._currentTileIndex<n.length;)if(c.getBucketParts(L,f,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((E,H)=>E.sortKey-H.sortKey));this._currentPartIndex<L.length;)if(c.placeLayerBucketPart(L[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,b())return!0;return!1}}class Oo{constructor(n,c,p,f,b,L,E,H){this.placement=new Ke(n,c,L,E,H),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(n,c,p){let f=v.now(),b=()=>!this._forceFullPlacement&&v.now()-f>2;for(;this._currentPlacementIndex>=0;){let L=c[n[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=E)&&(!L.maxzoom||L.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new Dn(L)),this._inProgressLayer.continuePlacement(p[L.source],this.placement,this._showCollisionBoxes,L,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}let As=512/o.W/2;class Qr{constructor(n,c,p){this.tileID=n,this.bucketInstanceId=p,this._symbolsByKey={};let f=new Map;for(let b=0;b<c.length;b++){let L=c.get(b),E=L.key,H=f.get(E);H?H.push(L):f.set(E,[L])}for(let[b,L]of f){let E={positions:L.map(H=>({x:Math.floor(H.anchorX*As),y:Math.floor(H.anchorY*As)})),crossTileIDs:L.map(H=>H.crossTileID)};if(E.positions.length>128){let H=new o.au(E.positions.length,16,Uint16Array);for(let{x:h,y:I}of E.positions)H.add(h,I);H.finish(),delete E.positions,E.index=H}this._symbolsByKey[b]=E}}getScaledCoordinates(n,c){let{x:p,y:f,z:b}=this.tileID.canonical,{x:L,y:E,z:H}=c.canonical,h=As/Math.pow(2,H-b),I=(E*o.W+n.anchorY)*h,_=f*o.W*As;return{x:Math.floor((L*o.W+n.anchorX)*h-p*o.W*As),y:Math.floor(I-_)}}findMatches(n,c,p){let f=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let b=0;b<n.length;b++){let L=n.get(b);if(L.crossTileID)continue;let E=this._symbolsByKey[L.key];if(!E)continue;let H=this.getScaledCoordinates(L,c);if(E.index){let h=E.index.range(H.x-f,H.y-f,H.x+f,H.y+f).sort();for(let I of h){let _=E.crossTileIDs[I];if(!p[_]){p[_]=!0,L.crossTileID=_;break}}}else if(E.positions)for(let h=0;h<E.positions.length;h++){let I=E.positions[h],_=E.crossTileIDs[h];if(Math.abs(I.x-H.x)<=f&&Math.abs(I.y-H.y)<=f&&!p[_]){p[_]=!0,L.crossTileID=_;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class zo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Fr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){let c=Math.round((n-this.lng)/360);if(c!==0)for(let p in this.indexes){let f=this.indexes[p],b={};for(let L in f){let E=f[L];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+c),b[E.tileID.key]=E}this.indexes[p]=b}this.lng=n}addBucket(n,c,p){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let b=0;b<c.symbolInstances.length;b++)c.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});let f=this.usedCrossTileIDs[n.overscaledZ];for(let b in this.indexes){let L=this.indexes[b];if(Number(b)>n.overscaledZ)for(let E in L){let H=L[E];H.tileID.isChildOf(n)&&H.findMatches(c.symbolInstances,n,f)}else{let E=L[n.scaledTo(Number(b)).key];E&&E.findMatches(c.symbolInstances,n,f)}}for(let b=0;b<c.symbolInstances.length;b++){let L=c.symbolInstances.get(b);L.crossTileID||(L.crossTileID=p.generate(),f[L.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Qr(n,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(n,c){for(let p of c.getCrossTileIDsLists())for(let f of p)delete this.usedCrossTileIDs[n][f]}removeStaleBuckets(n){let c=!1;for(let p in this.indexes){let f=this.indexes[p];for(let b in f)n[f[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,f[b]),delete f[b],c=!0)}return c}}class Nr{constructor(){this.layerIndexes={},this.crossTileIDs=new zo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,c,p){let f=this.layerIndexes[n.id];f===void 0&&(f=this.layerIndexes[n.id]=new Fr);let b=!1,L={};f.handleWrapJump(p);for(let E of c){let H=E.getBucket(n);H&&n.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(E.tileID,H,this.crossTileIDs)&&(b=!0),L[H.bucketInstanceId]=!0)}return f.removeStaleBuckets(L)&&(b=!0),b}pruneUnusedLayers(n){let c={};n.forEach(p=>{c[p]=!0});for(let p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}let Gs=(y,n)=>o.t(y,n&&n.filter(c=>c.identifier!=="source.canvas")),Kn=o.av();class to extends o.E{constructor(n,c={}){super(),this._rtlPluginLoaded=()=>{for(let p in this.sourceCaches){let f=this.sourceCaches[p].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[p].reload()}},this.map=n,this.dispatcher=new Ae(Ot(),n._getMapId()),this.dispatcher.registerMessageHandler("getGlyphs",(p,f)=>this.getGlyphs(p,f)),this.dispatcher.registerMessageHandler("getImages",(p,f)=>this.getImages(p,f)),this.imageManager=new lt,this.imageManager.setEventedParent(this),this.glyphManager=new ie(n._requestManager,c.localIdeographFontFamily),this.lineAtlas=new Ut(256,512),this.crossTileSymbolIndex=new Nr,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.aw,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.ax()),Oi().on(Ei,this._rtlPluginLoaded),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;let f=this.sourceCaches[p.sourceId];if(!f)return;let b=f.getSource();if(b&&b.vectorLayerIds)for(let L in this._layers){let E=this._layers[L];E.source===b.id&&this._validateLayer(E)}})}loadURL(n,c={},p){this.fire(new o.k("dataloading",{dataType:"style"})),c.validate=typeof c.validate!="boolean"||c.validate;let f=this.map._requestManager.transformRequest(n,tt.Style);this._loadStyleRequest=new AbortController,o.h(f,this._loadStyleRequest).then(b=>{this._loadStyleRequest=null,this._load(b.data,c,p)}).catch(b=>{this._loadStyleRequest=null,b&&this.fire(new o.j(b))})}loadJSON(n,c={},p){this.fire(new o.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,v.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,c.validate=c.validate!==!1,this._load(n,c,p)}).catch(()=>{})}loadEmpty(){this.fire(new o.k("dataloading",{dataType:"style"})),this._load(Kn,{validate:!1})}_load(n,c,p){var f;let b=c.transformStyle?c.transformStyle(p,n):n;if(!c.validate||!Gs(this,o.x(b))){this._loaded=!0,this.stylesheet=b;for(let L in b.sources)this.addSource(L,b.sources[L],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new wt(this.stylesheet.light),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.fire(new o.k("data",{dataType:"style"})),this.fire(new o.k("style.load"))}}_createLayers(){let n=o.ay(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",n),this._order=n.map(c=>c.id),this._layers={},this._serializedLayers=null;for(let c of n){let p=o.az(c);p.setEventedParent(this,{layer:{id:c.id}}),this._layers[c.id]=p}}_loadSprite(n,c=!1,p=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(b,L,E,H){return o._(this,void 0,void 0,function*(){let h=Jt(b),I=E>1?"@2x":"",_={},F={};for(let{id:R,url:Z}of h){let N=L.transformRequest(L.normalizeSpriteURL(Z,I,".json"),tt.SpriteJSON);_[R]=o.h(N,H);let P=L.transformRequest(L.normalizeSpriteURL(Z,I,".png"),tt.SpriteImage);F[R]=O.getImage(P,H)}return yield Promise.all([...Object.values(_),...Object.values(F)]),function(R,Z){return o._(this,void 0,void 0,function*(){let N={};for(let P in R){N[P]={};let V=v.getImageCanvasContext((yield Z[P]).data),X=(yield R[P]).data;for(let J in X){let{width:ot,height:dt,x:ut,y:Gt,sdf:Pt,pixelRatio:gt,stretchX:Ct,stretchY:ee,content:ge}=X[J];N[P][J]={data:null,pixelRatio:gt,sdf:Pt,stretchX:Ct,stretchY:ee,content:ge,spriteData:{width:ot,height:dt,x:ut,y:Gt,context:V}}}}return N})}(_,F)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(b=>{if(this._spriteRequest=null,b)for(let L in b){this._spritesImagesIds[L]=[];let E=this._spritesImagesIds[L]?this._spritesImagesIds[L].filter(H=>!(H in b)):[];for(let H of E)this.imageManager.removeImage(H),this._changedImages[H]=!0;for(let H in b[L]){let h=L==="default"?H:`${L}:${H}`;this._spritesImagesIds[L].push(h),h in this.imageManager.images?this.imageManager.updateImage(h,b[L][H],!1):this.imageManager.addImage(h,b[L][H]),c&&(this._changedImages[h]=!0)}}}).catch(b=>{this._spriteRequest=null,f=b,this.fire(new o.j(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),c&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"})),p&&p(f)})}_unloadSprite(){for(let n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}_validateLayer(n){let c=this.sourceCaches[n.source];if(!c)return;let p=n.sourceLayer;if(!p)return;let f=c.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(p)===-1)&&this.fire(new o.j(new Error(`Source layer "${p}" does not exist on source "${f.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n){let c=this._serializedAllLayers();if(!n||n.length===0)return Object.values(c);let p=[];for(let f of n)c[f]&&p.push(c[f]);return p}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};let c=Object.keys(this._layers);for(let p of c){let f=this._layers[p];f.type!=="custom"&&(n[p]=f.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(let n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;let c=this._changed;if(this._changed){let f=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(f.length||b.length)&&this._updateWorkerLayers(f,b);for(let L in this._updatedSources){let E=this._updatedSources[L];if(E==="reload")this._reloadSource(L);else{if(E!=="clear")throw new Error(`Invalid action ${E}`);this._clearSource(L)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let L in this._updatedPaintProps)this._layers[L].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}let p={};for(let f in this.sourceCaches){let b=this.sourceCaches[f];p[f]=b.used,b.used=!1}for(let f of this._order){let b=this._layers[f];b.recalculate(n,this._availableImages),!b.isHidden(n.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(let f in p){let b=this.sourceCaches[f];p[f]!==b.used&&b.fire(new o.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(n),this.z=n.zoom,c&&this.fire(new o.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){let n=Object.keys(this._changedImages);if(n.length){for(let c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(n),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,c={}){var p;this._checkLoaded();let f=this.serialize();if(n=c.transformStyle?c.transformStyle(f,n):n,((p=c.validate)===null||p===void 0||p)&&Gs(this,o.x(n)))return!1;(n=o.aA(n)).layers=o.ay(n.layers);let b=o.aB(f,n),L=this._getOperationsToPerform(b);if(L.unimplemented.length>0)throw new Error(`Unimplemented: ${L.unimplemented.join(", ")}.`);if(L.operations.length===0)return!1;for(let E of L.operations)E();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){let c=[],p=[];for(let f of n)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":c.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":c.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":c.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":c.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":c.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":c.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":c.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":c.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":c.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":c.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":c.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":c.push(()=>this.setSprite.apply(this,f.args));break;case"setTerrain":c.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setTransition":c.push(()=>{});break;default:p.push(f.command)}return{operations:c,unimplemented:p}}addImage(n,c){if(this.getImage(n))return this.fire(new o.j(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,c),this._afterImageUpdated(n)}updateImage(n,c){this.imageManager.updateImage(n,c)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new o.j(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,c,p={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(o.x.source,`sources.${n}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);let f=this.sourceCaches[n]=new Se(n,c,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:n})),f.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(let p in this._layers)if(this._layers[p].source===n)return this.fire(new o.j(new Error(`Source "${n}" cannot be removed while layer "${p}" is using it.`)));let c=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],c.fire(new o.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),c.setEventedParent(null),c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,c){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);let p=this.sourceCaches[n].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(c),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,c,p={}){this._checkLoaded();let f=n.id;if(this.getLayer(f))return void this.fire(new o.j(new Error(`Layer "${f}" already exists on this map.`)));let b;if(n.type==="custom"){if(Gs(this,o.aC(n)))return;b=o.az(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(f,n.source),n=o.aA(n),n=o.e(n,{source:f})),this._validate(o.x.layer,`layers.${f}`,n,{arrayIndex:-1},p))return;b=o.az(n),this._validateLayer(b),b.setEventedParent(this,{layer:{id:f}})}let L=c?this._order.indexOf(c):this._order.length;if(c&&L===-1)this.fire(new o.j(new Error(`Cannot add layer "${f}" before non-existing layer "${c}".`)));else{if(this._order.splice(L,0,f),this._layerOrderChanged=!0,this._layers[f]=b,this._removedLayers[f]&&b.source&&b.type!=="custom"){let E=this._removedLayers[f];delete this._removedLayers[f],E.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(n,c){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new o.j(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===c)return;let p=this._order.indexOf(n);this._order.splice(p,1);let f=c?this._order.indexOf(c):this._order.length;c&&f===-1?this.fire(new o.j(new Error(`Cannot move layer "${n}" before non-existing layer "${c}".`))):(this._order.splice(f,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();let c=this._layers[n];if(!c)return void this.fire(new o.j(new Error(`Cannot remove non-existing layer "${n}".`)));c.setEventedParent(null);let p=this._order.indexOf(n);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=c,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],c.onRemove&&c.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,c,p){this._checkLoaded();let f=this.getLayer(n);f?f.minzoom===c&&f.maxzoom===p||(c!=null&&(f.minzoom=c),p!=null&&(f.maxzoom=p),this._updateLayer(f)):this.fire(new o.j(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,c,p={}){this._checkLoaded();let f=this.getLayer(n);if(f){if(!o.aD(f.filter,c))return c==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(o.x.filter,`layers.${f.id}.filter`,c,null,p)||(f.filter=o.aA(c),this._updateLayer(f)))}else this.fire(new o.j(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return o.aA(this.getLayer(n).filter)}setLayoutProperty(n,c,p,f={}){this._checkLoaded();let b=this.getLayer(n);b?o.aD(b.getLayoutProperty(c),p)||(b.setLayoutProperty(c,p,f),this._updateLayer(b)):this.fire(new o.j(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,c){let p=this.getLayer(n);if(p)return p.getLayoutProperty(c);this.fire(new o.j(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,c,p,f={}){this._checkLoaded();let b=this.getLayer(n);b?o.aD(b.getPaintProperty(c),p)||(b.setPaintProperty(c,p,f)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new o.j(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,c){return this.getLayer(n).getPaintProperty(c)}setFeatureState(n,c){this._checkLoaded();let p=n.source,f=n.sourceLayer,b=this.sourceCaches[p];if(b===void 0)return void this.fire(new o.j(new Error(`The source '${p}' does not exist in the map's style.`)));let L=b.getSource().type;L==="geojson"&&f?this.fire(new o.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):L!=="vector"||f?(n.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),b.setFeatureState(f,n.id,c)):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,c){this._checkLoaded();let p=n.source,f=this.sourceCaches[p];if(f===void 0)return void this.fire(new o.j(new Error(`The source '${p}' does not exist in the map's style.`)));let b=f.getSource().type,L=b==="vector"?n.sourceLayer:void 0;b!=="vector"||L?c&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new o.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(L,n.id,c):this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();let c=n.source,p=n.sourceLayer,f=this.sourceCaches[c];if(f!==void 0)return f.getSource().type!=="vector"||p?(n.id===void 0&&this.fire(new o.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(p,n.id)):void this.fire(new o.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.j(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let n=o.aE(this.sourceCaches,b=>b.serialize()),c=this._serializeByIds(this._order),p=this.map.getTerrain()||void 0,f=this.stylesheet;return o.aF({version:f.version,name:f.name,metadata:f.metadata,light:f.light,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:n,layers:c,terrain:p},b=>b!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){let c=L=>this._layers[L].type==="fill-extrusion",p={},f=[];for(let L=this._order.length-1;L>=0;L--){let E=this._order[L];if(c(E)){p[E]=L;for(let H of n){let h=H[E];if(h)for(let I of h)f.push(I)}}}f.sort((L,E)=>E.intersectionZ-L.intersectionZ);let b=[];for(let L=this._order.length-1;L>=0;L--){let E=this._order[L];if(c(E))for(let H=f.length-1;H>=0;H--){let h=f[H].feature;if(p[h.layer.id]<L)break;b.push(h),f.pop()}else for(let H of n){let h=H[E];if(h)for(let I of h)b.push(I.feature)}}return b}queryRenderedFeatures(n,c,p){c&&c.filter&&this._validate(o.x.filter,"queryRenderedFeatures.filter",c.filter,null,c);let f={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new o.j(new Error("parameters.layers must be an Array."))),[];for(let E of c.layers){let H=this._layers[E];if(!H)return this.fire(new o.j(new Error(`The layer '${E}' does not exist in the map's style and cannot be queried for features.`))),[];f[H.source]=!0}}let b=[];c.availableImages=this._availableImages;let L=this._serializedAllLayers();for(let E in this.sourceCaches)c.layers&&!f[E]||b.push(He(this.sourceCaches[E],this._layers,L,n,c,p));return this.placement&&b.push(function(E,H,h,I,_,F,R){let Z={},N=F.queryRenderedSymbols(I),P=[];for(let V of Object.keys(N).map(Number))P.push(R[V]);P.sort(Re);for(let V of P){let X=V.featureIndex.lookupSymbolFeatures(N[V.bucketInstanceId],H,V.bucketIndex,V.sourceLayerIndex,_.filter,_.layers,_.availableImages,E);for(let J in X){let ot=Z[J]=Z[J]||[],dt=X[J];dt.sort((ut,Gt)=>{let Pt=V.featureSortOrder;if(Pt){let gt=Pt.indexOf(ut.featureIndex);return Pt.indexOf(Gt.featureIndex)-gt}return Gt.featureIndex-ut.featureIndex});for(let ut of dt)ot.push(ut)}}for(let V in Z)Z[V].forEach(X=>{let J=X.feature,ot=h[E[V].source].getFeatureState(J.layer["source-layer"],J.id);J.source=J.layer.source,J.layer["source-layer"]&&(J.sourceLayer=J.layer["source-layer"]),J.state=ot});return Z}(this._layers,L,this.sourceCaches,n,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(n,c){c&&c.filter&&this._validate(o.x.filter,"querySourceFeatures.filter",c.filter,null,c);let p=this.sourceCaches[n];return p?function(f,b){let L=f.getRenderableIds().map(h=>f.getTileByID(h)),E=[],H={};for(let h=0;h<L.length;h++){let I=L[h],_=I.tileID.canonical.key;H[_]||(H[_]=!0,I.querySourceFeatures(E,b))}return E}(p,c):[]}getLight(){return this.light.getLight()}setLight(n,c={}){this._checkLoaded();let p=this.light.getLight(),f=!1;for(let L in n)if(!o.aD(n[L],p[L])){f=!0;break}if(!f)return;let b={now:v.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,c),this.light.updateTransitions(b)}_validate(n,c,p,f,b={}){return(!b||b.validate!==!1)&&Gs(this,n.call(o.x,o.e({key:c,style:this.serialize(),value:p,styleSpec:o.v},f)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Oi().off(Ei,this._rtlPluginLoaded);for(let c in this._layers)this._layers[c].setEventedParent(null);for(let c in this.sourceCaches){let p=this.sourceCaches[c];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("removeMap",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(let c in this.sourceCaches)this.sourceCaches[c].update(n,this.map.terrain)}_generateCollisionBoxes(){for(let n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,c,p,f,b=!1){let L=!1,E=!1,H={};for(let h of this._order){let I=this._layers[h];if(I.type!=="symbol")continue;if(!H[I.source]){let F=this.sourceCaches[I.source];H[I.source]=F.getRenderableIds(!0).map(R=>F.getTileByID(R)).sort((R,Z)=>Z.tileID.overscaledZ-R.tileID.overscaledZ||(R.tileID.isLessThan(Z.tileID)?-1:1))}let _=this.crossTileSymbolIndex.addLayer(I,H[I.source],n.center.lng);L=L||_}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(v.now(),n.zoom))&&(this.pauseablePlacement=new Oo(n,this.map.terrain,this._order,b,c,p,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,H),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(v.now()),E=!0),L&&this.pauseablePlacement.placement.setStale()),E||L)for(let h of this._order){let I=this._layers[h];I.type==="symbol"&&this.placement.updateLayerOpacities(I,H[I.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(v.now())}_releaseSymbolFadeTiles(){for(let n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,c){return o._(this,void 0,void 0,function*(){let p=yield this.imageManager.getImages(c.icons);this._updateTilesForChangedImages();let f=this.sourceCaches[c.source];return f&&f.setDependencies(c.tileID.key,c.type,c.icons),p})}getGlyphs(n,c){return o._(this,void 0,void 0,function*(){let p=yield this.glyphManager.getGlyphs(c.stacks),f=this.sourceCaches[c.source];return f&&f.setDependencies(c.tileID.key,c.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,c={}){this._checkLoaded(),n&&this._validate(o.x.glyphs,"glyphs",n,null,c)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,c,p={},f){this._checkLoaded();let b=[{id:n,url:c}],L=[...Jt(this.stylesheet.sprite),...b];this._validate(o.x.sprite,"sprite",L,null,p)||(this.stylesheet.sprite=L,this._loadSprite(b,!0,f))}removeSprite(n){this._checkLoaded();let c=Jt(this.stylesheet.sprite);if(c.find(p=>p.id===n)){if(this._spritesImagesIds[n])for(let p of this._spritesImagesIds[n])this.imageManager.removeImage(p),this._changedImages[p]=!0;c.splice(c.findIndex(p=>p.id===n),1),this.stylesheet.sprite=c.length>0?c:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.k("data",{dataType:"style"}))}else this.fire(new o.j(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return Jt(this.stylesheet.sprite)}setSprite(n,c={},p){this._checkLoaded(),n&&this._validate(o.x.sprite,"sprite",n,null,c)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,p):(this._unloadSprite(),p&&p(null)))}}var pt=o.X([{name:"a_pos",type:"Int16",components:2}]),yt="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";let ct={prelude:Bt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Bt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Bt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Bt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Bt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Bt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Bt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Bt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Bt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Bt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Bt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Bt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Bt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Bt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Bt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Bt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Bt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Bt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Bt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Bt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Bt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Bt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Bt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Bt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Bt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Bt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Bt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",yt),terrainDepth:Bt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",yt),terrainCoords:Bt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",yt)};function Bt(y,n){let c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=n.match(/attribute ([\w]+) ([\w]+)/g),f=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=b?b.concat(f):f,E={};return{fragmentSource:y=y.replace(c,(H,h,I,_,F)=>(E[F]=!0,h==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${I} ${_} ${F};
#else
uniform ${I} ${_} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${I} ${_} ${F} = u_${F};
#endif
`)),vertexSource:n=n.replace(c,(H,h,I,_,F)=>{let R=_==="float"?"vec2":"vec4",Z=F.match(/color/)?"color":R;return E[F]?h==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${I} ${R} a_${F};
varying ${I} ${_} ${F};
#else
uniform ${I} ${_} u_${F};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${I} ${_} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${Z}(a_${F}, u_${F}_t);
#else
    ${I} ${_} ${F} = u_${F};
#endif
`:h==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${I} ${R} a_${F};
#else
uniform ${I} ${_} u_${F};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${I} ${_} ${F} = a_${F};
#else
    ${I} ${_} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${I} ${_} ${F} = unpack_mix_${Z}(a_${F}, u_${F}_t);
#else
    ${I} ${_} ${F} = u_${F};
#endif
`}),staticAttributes:p,staticUniforms:L}}class Kt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,c,p,f,b,L,E,H,h){this.context=n;let I=this.boundPaintVertexBuffers.length!==f.length;for(let _=0;!I&&_<f.length;_++)this.boundPaintVertexBuffers[_]!==f[_]&&(I=!0);!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==p||I||this.boundIndexBuffer!==b||this.boundVertexOffset!==L||this.boundDynamicVertexBuffer!==E||this.boundDynamicVertexBuffer2!==H||this.boundDynamicVertexBuffer3!==h?this.freshBind(c,p,f,b,L,E,H,h):(n.bindVertexArray.set(this.vao),E&&E.bind(),b&&b.dynamicDraw&&b.bind(),H&&H.bind(),h&&h.bind())}freshBind(n,c,p,f,b,L,E,H){let h=n.numAttributes,I=this.context,_=I.gl;this.vao&&this.destroy(),this.vao=I.createVertexArray(),I.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=f,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=L,this.boundDynamicVertexBuffer2=E,this.boundDynamicVertexBuffer3=H,c.enableAttributes(_,n);for(let F of p)F.enableAttributes(_,n);L&&L.enableAttributes(_,n),E&&E.enableAttributes(_,n),H&&H.enableAttributes(_,n),c.bind(),c.setVertexAttribPointers(_,n,b);for(let F of p)F.bind(),F.setVertexAttribPointers(_,n,b);L&&(L.bind(),L.setVertexAttribPointers(_,n,b)),f&&f.bind(),E&&(E.bind(),E.setVertexAttribPointers(_,n,b)),H&&(H.bind(),H.setVertexAttribPointers(_,n,b)),I.currentNumAttributes=h}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Yt(y){let n=[];for(let c=0;c<y.length;c++){if(y[c]===null)continue;let p=y[c].split(" ");n.push(p.pop())}return n}class ae{constructor(n,c,p,f,b,L){let E=n.gl;this.program=E.createProgram();let H=Yt(c.staticAttributes),h=p?p.getBinderAttributes():[],I=H.concat(h),_=ct.prelude.staticUniforms?Yt(ct.prelude.staticUniforms):[],F=c.staticUniforms?Yt(c.staticUniforms):[],R=p?p.getBinderUniforms():[],Z=_.concat(F).concat(R),N=[];for(let ut of Z)N.indexOf(ut)<0&&N.push(ut);let P=p?p.defines():[];b&&P.push("#define OVERDRAW_INSPECTOR;"),L&&P.push("#define TERRAIN3D;");let V=P.concat(ct.prelude.fragmentSource,c.fragmentSource).join(`
`),X=P.concat(ct.prelude.vertexSource,c.vertexSource).join(`
`),J=E.createShader(E.FRAGMENT_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);if(E.shaderSource(J,V),E.compileShader(J),!E.getShaderParameter(J,E.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${E.getShaderInfoLog(J)}`);E.attachShader(this.program,J);let ot=E.createShader(E.VERTEX_SHADER);if(E.isContextLost())return void(this.failedToCreate=!0);if(E.shaderSource(ot,X),E.compileShader(ot),!E.getShaderParameter(ot,E.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${E.getShaderInfoLog(ot)}`);E.attachShader(this.program,ot),this.attributes={};let dt={};this.numAttributes=I.length;for(let ut=0;ut<this.numAttributes;ut++)I[ut]&&(E.bindAttribLocation(this.program,ut,I[ut]),this.attributes[I[ut]]=ut);if(E.linkProgram(this.program),!E.getProgramParameter(this.program,E.LINK_STATUS))throw new Error(`Program failed to link: ${E.getProgramInfoLog(this.program)}`);E.deleteShader(ot),E.deleteShader(J);for(let ut=0;ut<N.length;ut++){let Gt=N[ut];if(Gt&&!dt[Gt]){let Pt=E.getUniformLocation(this.program,Gt);Pt&&(dt[Gt]=Pt)}}this.fixedUniforms=f(n,dt),this.terrainUniforms=((ut,Gt)=>({u_depth:new o.aG(ut,Gt.u_depth),u_terrain:new o.aG(ut,Gt.u_terrain),u_terrain_dim:new o.aH(ut,Gt.u_terrain_dim),u_terrain_matrix:new o.aI(ut,Gt.u_terrain_matrix),u_terrain_unpack:new o.aJ(ut,Gt.u_terrain_unpack),u_terrain_exaggeration:new o.aH(ut,Gt.u_terrain_exaggeration)}))(n,dt),this.binderUniforms=p?p.getUniforms(n,dt):[]}draw(n,c,p,f,b,L,E,H,h,I,_,F,R,Z,N,P,V,X){let J=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(p),n.setStencilMode(f),n.setColorMode(b),n.setCullFace(L),H){n.activeTexture.set(J.TEXTURE2),J.bindTexture(J.TEXTURE_2D,H.depthTexture),n.activeTexture.set(J.TEXTURE3),J.bindTexture(J.TEXTURE_2D,H.texture);for(let dt in this.terrainUniforms)this.terrainUniforms[dt].set(H[dt])}for(let dt in this.fixedUniforms)this.fixedUniforms[dt].set(E[dt]);N&&N.setUniforms(n,this.binderUniforms,R,{zoom:Z});let ot=0;switch(c){case J.LINES:ot=2;break;case J.TRIANGLES:ot=3;break;case J.LINE_STRIP:ot=1}for(let dt of F.get()){let ut=dt.vaos||(dt.vaos={});(ut[h]||(ut[h]=new Kt)).bind(n,this,I,N?N.getPaintVertexBuffers():[],_,dt.vertexOffset,P,V,X),J.drawElements(c,dt.primitiveLength*ot,J.UNSIGNED_SHORT,dt.primitiveOffset*ot*2)}}}function Be(y,n,c){let p=1/Qi(c,1,n.transform.tileZoom),f=Math.pow(2,c.tileID.overscaledZ),b=c.tileSize*Math.pow(2,n.transform.tileZoom)/f,L=b*(c.tileID.canonical.x+c.tileID.wrap*f),E=b*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[p,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[L>>16,E>>16],u_pixel_coord_lower:[65535&L,65535&E]}}let _e=(y,n,c,p)=>{let f=n.style.light,b=f.properties.get("position"),L=[b.x,b.y,b.z],E=function(){var h=new o.A(9);return o.A!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}();f.properties.get("anchor")==="viewport"&&function(h,I){var _=Math.sin(I),F=Math.cos(I);h[0]=F,h[1]=_,h[2]=0,h[3]=-_,h[4]=F,h[5]=0,h[6]=0,h[7]=0,h[8]=1}(E,-n.transform.angle),function(h,I,_){var F=I[0],R=I[1],Z=I[2];h[0]=F*_[0]+R*_[3]+Z*_[6],h[1]=F*_[1]+R*_[4]+Z*_[7],h[2]=F*_[2]+R*_[5]+Z*_[8]}(L,L,E);let H=f.properties.get("color");return{u_matrix:y,u_lightpos:L,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[H.r,H.g,H.b],u_vertical_gradient:+c,u_opacity:p}},Ce=(y,n,c,p,f,b,L)=>o.e(_e(y,n,c,p),Be(b,n,L),{u_height_factor:-Math.pow(2,f.overscaledZ)/L.tileSize/8}),se=y=>({u_matrix:y}),ye=(y,n,c,p)=>o.e(se(y),Be(c,n,p)),be=(y,n)=>({u_matrix:y,u_world:n}),Ge=(y,n,c,p,f)=>o.e(ye(y,n,c,p),{u_world:f}),Ui=(y,n,c,p)=>{let f=y.transform,b,L;if(p.paint.get("circle-pitch-alignment")==="map"){let E=Qi(c,1,f.zoom);b=!0,L=[E,E]}else b=!1,L=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(n.posMatrix,c,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:L}},Ri=(y,n,c)=>{let p=Qi(c,1,n.zoom),f=Math.pow(2,n.zoom-c.tileID.overscaledZ),b=c.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[n.pixelsToGLUnits[0]/(p*f),n.pixelsToGLUnits[1]/(p*f)],u_overscale_factor:b}},Pe=(y,n,c=1)=>({u_matrix:y,u_color:n,u_overlay:0,u_overlay_scale:c}),Qe=y=>({u_matrix:y}),Ai=(y,n,c,p)=>({u_matrix:y,u_extrude_scale:Qi(n,1,c),u_intensity:p});function Fi(y,n){let c=Math.pow(2,n.canonical.z),p=n.canonical.y;return[new o.Y(0,p/c).toLngLat().lat,new o.Y(0,(p+1)/c).toLngLat().lat]}let Wi=(y,n,c,p)=>{let f=y.transform;return{u_matrix:Ur(y,n,c,p),u_ratio:1/Qi(n,1,f.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},nr=(y,n,c,p,f)=>o.e(Wi(y,n,c,f),{u_image:0,u_image_height:p}),ai=(y,n,c,p,f)=>{let b=y.transform,L=Or(n,b);return{u_matrix:Ur(y,n,c,f),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Qi(n,1,b.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[L,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},dr=(y,n,c,p,f,b)=>{let L=y.lineAtlas,E=Or(n,y.transform),H=c.layout.get("line-cap")==="round",h=L.getDash(p.from,H),I=L.getDash(p.to,H),_=h.width*f.fromScale,F=I.width*f.toScale;return o.e(Wi(y,n,c,b),{u_patternscale_a:[E/_,-h.height/2],u_patternscale_b:[E/F,-I.height/2],u_sdfgamma:L.width/(256*Math.min(_,F)*y.pixelRatio)/2,u_image:0,u_tex_y_a:h.y,u_tex_y_b:I.y,u_mix:f.t})};function Or(y,n){return 1/Qi(y,1,n.tileZoom)}function Ur(y,n,c,p){return y.translatePosMatrix(p?p.posMatrix:n.tileID.posMatrix,n,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}let _n=(y,n,c,p,f)=>{return{u_matrix:y,u_tl_parent:n,u_scale_parent:c,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(L=f.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(b=f.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:vn(f.paint.get("raster-hue-rotate"))};var b,L};function vn(y){y*=Math.PI/180;let n=Math.sin(y),c=Math.cos(y);return[(2*c+1)/3,(-Math.sqrt(3)*n-c+1)/3,(Math.sqrt(3)*n-c+1)/3]}let ws=(y,n,c,p,f,b,L,E,H,h)=>{let I=f.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:I.cameraToCenterDistance,u_pitch:I.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:I.width/I.height,u_fade_change:f.options.fadeDuration?f.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:L,u_coord_matrix:E,u_is_text:+H,u_pitch_with_map:+p,u_texsize:h,u_texture:0}},_o=(y,n,c,p,f,b,L,E,H,h,I)=>{let _=f.transform;return o.e(ws(y,n,c,p,f,b,L,E,H,h),{u_gamma_scale:p?Math.cos(_._pitch)*_.cameraToCenterDistance:1,u_device_pixel_ratio:f.pixelRatio,u_is_halo:+I})},Ic=(y,n,c,p,f,b,L,E,H,h)=>o.e(_o(y,n,c,p,f,b,L,E,!0,H,!0),{u_texsize_icon:h,u_texture_icon:1}),yc=(y,n,c)=>({u_matrix:y,u_opacity:n,u_color:c}),El=(y,n,c,p,f,b)=>o.e(function(L,E,H,h){let I=H.imageManager.getPattern(L.from.toString()),_=H.imageManager.getPattern(L.to.toString()),{width:F,height:R}=H.imageManager.getPixelSize(),Z=Math.pow(2,h.tileID.overscaledZ),N=h.tileSize*Math.pow(2,H.transform.tileZoom)/Z,P=N*(h.tileID.canonical.x+h.tileID.wrap*Z),V=N*h.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:I.tl,u_pattern_br_a:I.br,u_pattern_tl_b:_.tl,u_pattern_br_b:_.br,u_texsize:[F,R],u_mix:E.t,u_pattern_size_a:I.displaySize,u_pattern_size_b:_.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/Qi(h,1,H.transform.tileZoom),u_pixel_coord_upper:[P>>16,V>>16],u_pixel_coord_lower:[65535&P,65535&V]}}(p,b,c,f),{u_matrix:y,u_opacity:n}),el={fillExtrusion:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_lightpos:new o.aK(y,n.u_lightpos),u_lightintensity:new o.aH(y,n.u_lightintensity),u_lightcolor:new o.aK(y,n.u_lightcolor),u_vertical_gradient:new o.aH(y,n.u_vertical_gradient),u_opacity:new o.aH(y,n.u_opacity)}),fillExtrusionPattern:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_lightpos:new o.aK(y,n.u_lightpos),u_lightintensity:new o.aH(y,n.u_lightintensity),u_lightcolor:new o.aK(y,n.u_lightcolor),u_vertical_gradient:new o.aH(y,n.u_vertical_gradient),u_height_factor:new o.aH(y,n.u_height_factor),u_image:new o.aG(y,n.u_image),u_texsize:new o.aL(y,n.u_texsize),u_pixel_coord_upper:new o.aL(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(y,n.u_pixel_coord_lower),u_scale:new o.aK(y,n.u_scale),u_fade:new o.aH(y,n.u_fade),u_opacity:new o.aH(y,n.u_opacity)}),fill:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix)}),fillPattern:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_image:new o.aG(y,n.u_image),u_texsize:new o.aL(y,n.u_texsize),u_pixel_coord_upper:new o.aL(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(y,n.u_pixel_coord_lower),u_scale:new o.aK(y,n.u_scale),u_fade:new o.aH(y,n.u_fade)}),fillOutline:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_world:new o.aL(y,n.u_world)}),fillOutlinePattern:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_world:new o.aL(y,n.u_world),u_image:new o.aG(y,n.u_image),u_texsize:new o.aL(y,n.u_texsize),u_pixel_coord_upper:new o.aL(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(y,n.u_pixel_coord_lower),u_scale:new o.aK(y,n.u_scale),u_fade:new o.aH(y,n.u_fade)}),circle:(y,n)=>({u_camera_to_center_distance:new o.aH(y,n.u_camera_to_center_distance),u_scale_with_map:new o.aG(y,n.u_scale_with_map),u_pitch_with_map:new o.aG(y,n.u_pitch_with_map),u_extrude_scale:new o.aL(y,n.u_extrude_scale),u_device_pixel_ratio:new o.aH(y,n.u_device_pixel_ratio),u_matrix:new o.aI(y,n.u_matrix)}),collisionBox:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_camera_to_center_distance:new o.aH(y,n.u_camera_to_center_distance),u_pixels_to_tile_units:new o.aH(y,n.u_pixels_to_tile_units),u_extrude_scale:new o.aL(y,n.u_extrude_scale),u_overscale_factor:new o.aH(y,n.u_overscale_factor)}),collisionCircle:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_inv_matrix:new o.aI(y,n.u_inv_matrix),u_camera_to_center_distance:new o.aH(y,n.u_camera_to_center_distance),u_viewport_size:new o.aL(y,n.u_viewport_size)}),debug:(y,n)=>({u_color:new o.aM(y,n.u_color),u_matrix:new o.aI(y,n.u_matrix),u_overlay:new o.aG(y,n.u_overlay),u_overlay_scale:new o.aH(y,n.u_overlay_scale)}),clippingMask:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix)}),heatmap:(y,n)=>({u_extrude_scale:new o.aH(y,n.u_extrude_scale),u_intensity:new o.aH(y,n.u_intensity),u_matrix:new o.aI(y,n.u_matrix)}),heatmapTexture:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_world:new o.aL(y,n.u_world),u_image:new o.aG(y,n.u_image),u_color_ramp:new o.aG(y,n.u_color_ramp),u_opacity:new o.aH(y,n.u_opacity)}),hillshade:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_image:new o.aG(y,n.u_image),u_latrange:new o.aL(y,n.u_latrange),u_light:new o.aL(y,n.u_light),u_shadow:new o.aM(y,n.u_shadow),u_highlight:new o.aM(y,n.u_highlight),u_accent:new o.aM(y,n.u_accent)}),hillshadePrepare:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_image:new o.aG(y,n.u_image),u_dimension:new o.aL(y,n.u_dimension),u_zoom:new o.aH(y,n.u_zoom),u_unpack:new o.aJ(y,n.u_unpack)}),line:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_ratio:new o.aH(y,n.u_ratio),u_device_pixel_ratio:new o.aH(y,n.u_device_pixel_ratio),u_units_to_pixels:new o.aL(y,n.u_units_to_pixels)}),lineGradient:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_ratio:new o.aH(y,n.u_ratio),u_device_pixel_ratio:new o.aH(y,n.u_device_pixel_ratio),u_units_to_pixels:new o.aL(y,n.u_units_to_pixels),u_image:new o.aG(y,n.u_image),u_image_height:new o.aH(y,n.u_image_height)}),linePattern:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_texsize:new o.aL(y,n.u_texsize),u_ratio:new o.aH(y,n.u_ratio),u_device_pixel_ratio:new o.aH(y,n.u_device_pixel_ratio),u_image:new o.aG(y,n.u_image),u_units_to_pixels:new o.aL(y,n.u_units_to_pixels),u_scale:new o.aK(y,n.u_scale),u_fade:new o.aH(y,n.u_fade)}),lineSDF:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_ratio:new o.aH(y,n.u_ratio),u_device_pixel_ratio:new o.aH(y,n.u_device_pixel_ratio),u_units_to_pixels:new o.aL(y,n.u_units_to_pixels),u_patternscale_a:new o.aL(y,n.u_patternscale_a),u_patternscale_b:new o.aL(y,n.u_patternscale_b),u_sdfgamma:new o.aH(y,n.u_sdfgamma),u_image:new o.aG(y,n.u_image),u_tex_y_a:new o.aH(y,n.u_tex_y_a),u_tex_y_b:new o.aH(y,n.u_tex_y_b),u_mix:new o.aH(y,n.u_mix)}),raster:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_tl_parent:new o.aL(y,n.u_tl_parent),u_scale_parent:new o.aH(y,n.u_scale_parent),u_buffer_scale:new o.aH(y,n.u_buffer_scale),u_fade_t:new o.aH(y,n.u_fade_t),u_opacity:new o.aH(y,n.u_opacity),u_image0:new o.aG(y,n.u_image0),u_image1:new o.aG(y,n.u_image1),u_brightness_low:new o.aH(y,n.u_brightness_low),u_brightness_high:new o.aH(y,n.u_brightness_high),u_saturation_factor:new o.aH(y,n.u_saturation_factor),u_contrast_factor:new o.aH(y,n.u_contrast_factor),u_spin_weights:new o.aK(y,n.u_spin_weights)}),symbolIcon:(y,n)=>({u_is_size_zoom_constant:new o.aG(y,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(y,n.u_is_size_feature_constant),u_size_t:new o.aH(y,n.u_size_t),u_size:new o.aH(y,n.u_size),u_camera_to_center_distance:new o.aH(y,n.u_camera_to_center_distance),u_pitch:new o.aH(y,n.u_pitch),u_rotate_symbol:new o.aG(y,n.u_rotate_symbol),u_aspect_ratio:new o.aH(y,n.u_aspect_ratio),u_fade_change:new o.aH(y,n.u_fade_change),u_matrix:new o.aI(y,n.u_matrix),u_label_plane_matrix:new o.aI(y,n.u_label_plane_matrix),u_coord_matrix:new o.aI(y,n.u_coord_matrix),u_is_text:new o.aG(y,n.u_is_text),u_pitch_with_map:new o.aG(y,n.u_pitch_with_map),u_texsize:new o.aL(y,n.u_texsize),u_texture:new o.aG(y,n.u_texture)}),symbolSDF:(y,n)=>({u_is_size_zoom_constant:new o.aG(y,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(y,n.u_is_size_feature_constant),u_size_t:new o.aH(y,n.u_size_t),u_size:new o.aH(y,n.u_size),u_camera_to_center_distance:new o.aH(y,n.u_camera_to_center_distance),u_pitch:new o.aH(y,n.u_pitch),u_rotate_symbol:new o.aG(y,n.u_rotate_symbol),u_aspect_ratio:new o.aH(y,n.u_aspect_ratio),u_fade_change:new o.aH(y,n.u_fade_change),u_matrix:new o.aI(y,n.u_matrix),u_label_plane_matrix:new o.aI(y,n.u_label_plane_matrix),u_coord_matrix:new o.aI(y,n.u_coord_matrix),u_is_text:new o.aG(y,n.u_is_text),u_pitch_with_map:new o.aG(y,n.u_pitch_with_map),u_texsize:new o.aL(y,n.u_texsize),u_texture:new o.aG(y,n.u_texture),u_gamma_scale:new o.aH(y,n.u_gamma_scale),u_device_pixel_ratio:new o.aH(y,n.u_device_pixel_ratio),u_is_halo:new o.aG(y,n.u_is_halo)}),symbolTextAndIcon:(y,n)=>({u_is_size_zoom_constant:new o.aG(y,n.u_is_size_zoom_constant),u_is_size_feature_constant:new o.aG(y,n.u_is_size_feature_constant),u_size_t:new o.aH(y,n.u_size_t),u_size:new o.aH(y,n.u_size),u_camera_to_center_distance:new o.aH(y,n.u_camera_to_center_distance),u_pitch:new o.aH(y,n.u_pitch),u_rotate_symbol:new o.aG(y,n.u_rotate_symbol),u_aspect_ratio:new o.aH(y,n.u_aspect_ratio),u_fade_change:new o.aH(y,n.u_fade_change),u_matrix:new o.aI(y,n.u_matrix),u_label_plane_matrix:new o.aI(y,n.u_label_plane_matrix),u_coord_matrix:new o.aI(y,n.u_coord_matrix),u_is_text:new o.aG(y,n.u_is_text),u_pitch_with_map:new o.aG(y,n.u_pitch_with_map),u_texsize:new o.aL(y,n.u_texsize),u_texsize_icon:new o.aL(y,n.u_texsize_icon),u_texture:new o.aG(y,n.u_texture),u_texture_icon:new o.aG(y,n.u_texture_icon),u_gamma_scale:new o.aH(y,n.u_gamma_scale),u_device_pixel_ratio:new o.aH(y,n.u_device_pixel_ratio),u_is_halo:new o.aG(y,n.u_is_halo)}),background:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_opacity:new o.aH(y,n.u_opacity),u_color:new o.aM(y,n.u_color)}),backgroundPattern:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_opacity:new o.aH(y,n.u_opacity),u_image:new o.aG(y,n.u_image),u_pattern_tl_a:new o.aL(y,n.u_pattern_tl_a),u_pattern_br_a:new o.aL(y,n.u_pattern_br_a),u_pattern_tl_b:new o.aL(y,n.u_pattern_tl_b),u_pattern_br_b:new o.aL(y,n.u_pattern_br_b),u_texsize:new o.aL(y,n.u_texsize),u_mix:new o.aH(y,n.u_mix),u_pattern_size_a:new o.aL(y,n.u_pattern_size_a),u_pattern_size_b:new o.aL(y,n.u_pattern_size_b),u_scale_a:new o.aH(y,n.u_scale_a),u_scale_b:new o.aH(y,n.u_scale_b),u_pixel_coord_upper:new o.aL(y,n.u_pixel_coord_upper),u_pixel_coord_lower:new o.aL(y,n.u_pixel_coord_lower),u_tile_units_to_pixels:new o.aH(y,n.u_tile_units_to_pixels)}),terrain:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_texture:new o.aG(y,n.u_texture),u_ele_delta:new o.aH(y,n.u_ele_delta)}),terrainDepth:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_ele_delta:new o.aH(y,n.u_ele_delta)}),terrainCoords:(y,n)=>({u_matrix:new o.aI(y,n.u_matrix),u_texture:new o.aG(y,n.u_texture),u_terrain_coords_id:new o.aH(y,n.u_terrain_coords_id),u_ele_delta:new o.aH(y,n.u_ele_delta)})};class Bs{constructor(n,c,p){this.context=n;let f=n.gl;this.buffer=f.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){let c=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let eo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class qn{constructor(n,c,p,f){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=f,this.context=n;let b=n.gl;this.buffer=b.createBuffer(),n.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);let c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,c){for(let p=0;p<this.attributes.length;p++){let f=c.attributes[this.attributes[p].name];f!==void 0&&n.enableVertexAttribArray(f)}}setVertexAttribPointers(n,c,p){for(let f=0;f<this.attributes.length;f++){let b=this.attributes[f],L=c.attributes[b.name];L!==void 0&&n.vertexAttribPointer(L,b.components,n[eo[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let cn=new WeakMap;function xo(y){var n;if(cn.has(y))return cn.get(y);{let c=(n=y.getParameter(y.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return cn.set(y,c),c}}class lr{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Sa extends lr{getDefault(){return o.aO.transparent}set(n){let c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class pA extends lr{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class fA extends lr{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Fa extends lr{getDefault(){return[!0,!0,!0,!0]}set(n){let c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class io extends lr{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class So extends lr{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class mA extends lr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){let c=this.current;(n.func!==c.func||n.ref!==c.ref||n.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Jo extends lr{getDefault(){let n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){let c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Rs extends lr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;n?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=n,this.dirty=!1}}class Fo extends lr{getDefault(){return[0,1]}set(n){let c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class ka extends lr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;n?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=n,this.dirty=!1}}class bc extends lr{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class CA extends lr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;n?c.enable(c.BLEND):c.disable(c.BLEND),this.current=n,this.dirty=!1}}class vc extends lr{getDefault(){let n=this.gl;return[n.ONE,n.ZERO]}set(n){let c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class il extends lr{getDefault(){return o.aO.transparent}set(n){let c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class rl extends lr{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class IA extends lr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;n?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=n,this.dirty=!1}}class Xo extends lr{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class La extends lr{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Ea extends lr{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Yo extends lr{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Tl extends lr{getDefault(){let n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){let c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ta extends lr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class jo extends lr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class ro extends lr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;c.bindTexture(c.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class qo extends lr{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ko extends lr{getDefault(){return null}set(n){let c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class U extends lr{getDefault(){return null}set(n){var c;if(n===this.current&&!this.dirty)return;let p=this.gl;xo(p)?p.bindVertexArray(n):(c=p.getExtension("OES_vertex_array_object"))===null||c===void 0||c.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class it extends lr{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Et extends lr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Nt extends lr{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class ue extends lr{constructor(n,c){super(n),this.context=n,this.parent=c}getDefault(){return null}}class we extends ue{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Ve extends ue{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class li extends ue{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Di{constructor(n,c,p,f,b){this.context=n,this.width=c,this.height=p;let L=n.gl,E=this.framebuffer=L.createFramebuffer();if(this.colorAttachment=new we(n,E),f)this.depthAttachment=b?new li(n,E):new Ve(n,E);else if(b)throw new Error("Stencil cannot be set without depth");if(L.checkFramebufferStatus(L.FRAMEBUFFER)!==L.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let n=this.context.gl,c=this.colorAttachment.get();if(c&&n.deleteTexture(c),this.depthAttachment){let p=this.depthAttachment.get();p&&n.deleteRenderbuffer(p)}n.deleteFramebuffer(this.framebuffer)}}class xi{constructor(n,c,p){this.blendFunction=n,this.blendColor=c,this.mask=p}}xi.Replace=[1,0],xi.disabled=new xi(xi.Replace,o.aO.transparent,[!1,!1,!1,!1]),xi.unblended=new xi(xi.Replace,o.aO.transparent,[!0,!0,!0,!0]),xi.alphaBlended=new xi([1,771],o.aO.transparent,[!0,!0,!0,!0]);class ar{constructor(n){var c,p;if(this.gl=n,this.clearColor=new Sa(this),this.clearDepth=new pA(this),this.clearStencil=new fA(this),this.colorMask=new Fa(this),this.depthMask=new io(this),this.stencilMask=new So(this),this.stencilFunc=new mA(this),this.stencilOp=new Jo(this),this.stencilTest=new Rs(this),this.depthRange=new Fo(this),this.depthTest=new ka(this),this.depthFunc=new bc(this),this.blend=new CA(this),this.blendFunc=new vc(this),this.blendColor=new il(this),this.blendEquation=new rl(this),this.cullFace=new IA(this),this.cullFaceSide=new Xo(this),this.frontFace=new La(this),this.program=new Ea(this),this.activeTexture=new Yo(this),this.viewport=new Tl(this),this.bindFramebuffer=new Ta(this),this.bindRenderbuffer=new jo(this),this.bindTexture=new ro(this),this.bindVertexBuffer=new qo(this),this.bindElementBuffer=new ko(this),this.bindVertexArray=new U(this),this.pixelStoreUnpack=new it(this),this.pixelStoreUnpackPremultiplyAlpha=new Et(this),this.pixelStoreUnpackFlipY=new Nt(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),xo(n)){this.HALF_FLOAT=n.HALF_FLOAT;let f=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(c=n.RGBA16F)!==null&&c!==void 0?c:f?.RGBA16F_EXT,this.RGB16F=(p=n.RGB16F)!==null&&p!==void 0?p:f?.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");let f=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=f?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,c){return new Bs(this,n,c)}createVertexBuffer(n,c,p){return new qn(this,n,c,p)}createRenderbuffer(n,c,p){let f=this.gl,b=f.createRenderbuffer();return this.bindRenderbuffer.set(b),f.renderbufferStorage(f.RENDERBUFFER,n,c,p),this.bindRenderbuffer.set(null),b}createFramebuffer(n,c,p,f){return new Di(this,n,c,p,f)}clear({color:n,depth:c,stencil:p}){let f=this.gl,b=0;n&&(b|=f.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(b|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),p!==void 0&&(b|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),f.clear(b)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){o.aD(n.blendFunction,xi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return xo(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var c;return xo(this.gl)?this.gl.deleteVertexArray(n):(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}class Ci{constructor(n,c,p){this.func=n,this.mask=c,this.range=p}}Ci.ReadOnly=!1,Ci.ReadWrite=!0,Ci.disabled=new Ci(519,Ci.ReadOnly,[0,1]);let Vr=7680;class Xi{constructor(n,c,p,f,b,L){this.test=n,this.ref=c,this.mask=p,this.fail=f,this.depthFail=b,this.pass=L}}Xi.disabled=new Xi({func:519,mask:0},0,0,Vr,Vr,Vr);class Yi{constructor(n,c,p){this.enable=n,this.mode=c,this.frontFace=p}}let un;function hn(y,n,c,p,f,b,L){let E=y.context,H=E.gl,h=y.useProgram("collisionBox"),I=[],_=0,F=0;for(let J=0;J<p.length;J++){let ot=p[J],dt=n.getTile(ot),ut=dt.getBucket(c);if(!ut)continue;let Gt=ot.posMatrix;f[0]===0&&f[1]===0||(Gt=y.translatePosMatrix(ot.posMatrix,dt,f,b));let Pt=L?ut.textCollisionBox:ut.iconCollisionBox,gt=ut.collisionCircleArray;if(gt.length>0){let Ct=o.F(),ee=Gt;o.aP(Ct,ut.placementInvProjMatrix,y.transform.glCoordMatrix),o.aP(Ct,Ct,ut.placementViewportMatrix),I.push({circleArray:gt,circleOffset:F,transform:ee,invTransform:Ct,coord:ot}),_+=gt.length/4,F=_}Pt&&h.draw(E,H.LINES,Ci.disabled,Xi.disabled,y.colorModeForRenderPass(),Yi.disabled,Ri(Gt,y.transform,dt),y.style.map.terrain&&y.style.map.terrain.getTerrainData(ot),c.id,Pt.layoutVertexBuffer,Pt.indexBuffer,Pt.segments,null,y.transform.zoom,null,null,Pt.collisionVertexBuffer)}if(!L||!I.length)return;let R=y.useProgram("collisionCircle"),Z=new o.aQ;Z.resize(4*_),Z._trim();let N=0;for(let J of I)for(let ot=0;ot<J.circleArray.length/4;ot++){let dt=4*ot,ut=J.circleArray[dt+0],Gt=J.circleArray[dt+1],Pt=J.circleArray[dt+2],gt=J.circleArray[dt+3];Z.emplace(N++,ut,Gt,Pt,gt,0),Z.emplace(N++,ut,Gt,Pt,gt,1),Z.emplace(N++,ut,Gt,Pt,gt,2),Z.emplace(N++,ut,Gt,Pt,gt,3)}(!un||un.length<2*_)&&(un=function(J){let ot=2*J,dt=new o.aS;dt.resize(ot),dt._trim();for(let ut=0;ut<ot;ut++){let Gt=6*ut;dt.uint16[Gt+0]=4*ut+0,dt.uint16[Gt+1]=4*ut+1,dt.uint16[Gt+2]=4*ut+2,dt.uint16[Gt+3]=4*ut+2,dt.uint16[Gt+4]=4*ut+3,dt.uint16[Gt+5]=4*ut+0}return dt}(_));let P=E.createIndexBuffer(un,!0),V=E.createVertexBuffer(Z,o.aR.members,!0);for(let J of I){let ot={u_matrix:J.transform,u_inv_matrix:J.invTransform,u_camera_to_center_distance:(X=y.transform).cameraToCenterDistance,u_viewport_size:[X.width,X.height]};R.draw(E,H.TRIANGLES,Ci.disabled,Xi.disabled,y.colorModeForRenderPass(),Yi.disabled,ot,y.style.map.terrain&&y.style.map.terrain.getTerrainData(J.coord),c.id,V,P,o.$.simpleSegment(0,2*J.circleOffset,J.circleArray.length,J.circleArray.length/2),null,y.transform.zoom,null,null,null)}var X;V.destroy(),P.destroy()}Yi.disabled=new Yi(!1,1029,2305),Yi.backCCW=new Yi(!0,1029,2305);let Hs=o.an(new Float32Array(16));function $n(y,n,c,p,f,b){let{horizontalAlign:L,verticalAlign:E}=o.at(y);return new o.P((-(L-.5)*n/f+p[0])*b,(-(E-.5)*c/f+p[1])*b)}function Zs(y,n,c,p,f,b,L,E,H,h,I){let _=y.text.placedSymbolArray,F=y.text.dynamicLayoutVertexArray,R=y.icon.dynamicLayoutVertexArray,Z={};F.clear();for(let N=0;N<_.length;N++){let P=_.get(N),V=P.hidden||!P.crossTileID||y.allowVerticalPlacement&&!P.placedOrientation?null:p[P.crossTileID];if(V){let X=new o.P(P.anchorX,P.anchorY),J=ft(X,c?L:b,I),ot=Y(f.cameraToCenterDistance,J.signedDistanceFromCamera),dt=o.ai(y.textSizeData,H,P)*ot/o.ao;c&&(dt*=y.tilePixelRatio/E);let{width:ut,height:Gt,anchor:Pt,textOffset:gt,textBoxScale:Ct}=V,ee=$n(Pt,ut,Gt,gt,Ct,dt),ge=c?ft(X.add(ee),b,I).point:J.point.add(n?ee.rotate(-f.angle):ee),jt=y.allowVerticalPlacement&&P.placedOrientation===o.ah.vertical?Math.PI/2:0;for(let Fe=0;Fe<P.numGlyphs;Fe++)o.aj(F,ge,jt);h&&P.associatedIconIndex>=0&&(Z[P.associatedIconIndex]={shiftedAnchor:ge,angle:jt})}else Xe(P.numGlyphs,F)}if(h){R.clear();let N=y.icon.placedSymbolArray;for(let P=0;P<N.length;P++){let V=N.get(P);if(V.hidden)Xe(V.numGlyphs,R);else{let X=Z[P];if(X)for(let J=0;J<V.numGlyphs;J++)o.aj(R,X.shiftedAnchor,X.angle);else Xe(V.numGlyphs,R)}}y.icon.dynamicLayoutVertexBuffer.updateData(R)}y.text.dynamicLayoutVertexBuffer.updateData(F)}function yA(y,n,c){return c.iconsInText&&n?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function bA(y,n,c,p,f,b,L,E,H,h,I,_){let F=y.context,R=F.gl,Z=y.transform,N=E==="map",P=H==="map",V=E!=="viewport"&&c.layout.get("symbol-placement")!=="point",X=N&&!P&&!V,J=!c.layout.get("symbol-sort-key").isConstant(),ot=!1,dt=y.depthModeForSublayer(0,Ci.ReadOnly),ut=c._unevaluatedLayout.hasValue("text-variable-anchor")||c._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Gt=[];for(let Pt of p){let gt=n.getTile(Pt),Ct=gt.getBucket(c);if(!Ct)continue;let ee=f?Ct.text:Ct.icon;if(!ee||!ee.segments.get().length||!ee.hasVisibleVertices)continue;let ge=ee.programConfigurations.get(c.id),jt=f||Ct.sdfIcons,Fe=f?Ct.textSizeData:Ct.iconSizeData,ke=P||Z.pitch!==0,Ye=y.useProgram(yA(jt,f,Ct),ge),xe=o.ag(Fe,Z.zoom),ci=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Pt),pi,Mi,Si,cr,ji=[0,0],Ii=null;if(f)Mi=gt.glyphAtlasTexture,Si=R.LINEAR,pi=gt.glyphAtlasTexture.size,Ct.iconsInText&&(ji=gt.imageAtlasTexture.size,Ii=gt.imageAtlasTexture,cr=ke||y.options.rotating||y.options.zooming||Fe.kind==="composite"||Fe.kind==="camera"?R.LINEAR:R.NEAREST);else{let _r=c.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear;Mi=gt.imageAtlasTexture,Si=jt||y.options.rotating||y.options.zooming||_r||ke?R.LINEAR:R.NEAREST,pi=gt.imageAtlasTexture.size}let vr=Qi(gt,1,y.transform.zoom),Yr=tr(Pt.posMatrix,P,N,y.transform,vr),Gr=Lr(Pt.posMatrix,P,N,y.transform,vr),mn=ut&&Ct.hasTextData(),wr=c.layout.get("icon-text-fit")!=="none"&&mn&&Ct.hasIconData();if(V){let _r=y.style.map.terrain?(pn,$i)=>y.style.map.terrain.getElevation(Pt,pn,$i):null,Br=c.layout.get("text-rotation-alignment")==="map";rt(Ct,Pt.posMatrix,y,f,Yr,Gr,P,h,Br,_r)}let An=y.translatePosMatrix(Pt.posMatrix,gt,b,L),rn=V||f&&ut||wr?Hs:Yr,ur=y.translatePosMatrix(Gr,gt,b,L,!0),sr=jt&&c.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ir;Ir=jt?Ct.iconsInText?Ic(Fe.kind,xe,X,P,y,An,rn,ur,pi,ji):_o(Fe.kind,xe,X,P,y,An,rn,ur,f,pi,!0):ws(Fe.kind,xe,X,P,y,An,rn,ur,f,pi);let Sn={program:Ye,buffers:ee,uniformValues:Ir,atlasTexture:Mi,atlasTextureIcon:Ii,atlasInterpolation:Si,atlasInterpolationIcon:cr,isSDF:jt,hasHalo:sr};if(J&&Ct.canOverlap){ot=!0;let _r=ee.segments.get();for(let Br of _r)Gt.push({segments:new o.$([Br]),sortKey:Br.sortKey,state:Sn,terrainData:ci})}else Gt.push({segments:ee.segments,sortKey:0,state:Sn,terrainData:ci})}ot&&Gt.sort((Pt,gt)=>Pt.sortKey-gt.sortKey);for(let Pt of Gt){let gt=Pt.state;if(F.activeTexture.set(R.TEXTURE0),gt.atlasTexture.bind(gt.atlasInterpolation,R.CLAMP_TO_EDGE),gt.atlasTextureIcon&&(F.activeTexture.set(R.TEXTURE1),gt.atlasTextureIcon&&gt.atlasTextureIcon.bind(gt.atlasInterpolationIcon,R.CLAMP_TO_EDGE)),gt.isSDF){let Ct=gt.uniformValues;gt.hasHalo&&(Ct.u_is_halo=1,ga(gt.buffers,Pt.segments,c,y,gt.program,dt,I,_,Ct,Pt.terrainData)),Ct.u_is_halo=0}ga(gt.buffers,Pt.segments,c,y,gt.program,dt,I,_,gt.uniformValues,Pt.terrainData)}}function ga(y,n,c,p,f,b,L,E,H,h){let I=p.context;f.draw(I,I.gl.TRIANGLES,b,L,E,Yi.disabled,H,h,c.id,y.layoutVertexBuffer,y.indexBuffer,n,c.paint,p.transform.zoom,y.programConfigurations.get(c.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function Qa(y,n,c,p,f){if(!c||!p||!p.imageAtlas)return;let b=p.imageAtlas.patternPositions,L=b[c.to.toString()],E=b[c.from.toString()];if(!L&&E&&(L=E),!E&&L&&(E=L),!L||!E){let H=f.getPaintProperty(n);L=b[H],E=b[H]}L&&E&&y.setConstantPatternPositions(L,E)}function Ua(y,n,c,p,f,b,L){let E=y.context.gl,H="fill-pattern",h=c.paint.get(H),I=h&&h.constantOr(1),_=c.getCrossfadeParameters(),F,R,Z,N,P;L?(R=I&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=E.LINES):(R=I?"fillPattern":"fill",F=E.TRIANGLES);let V=h.constantOr(null);for(let X of p){let J=n.getTile(X);if(I&&!J.patternsLoaded())continue;let ot=J.getBucket(c);if(!ot)continue;let dt=ot.programConfigurations.get(c.id),ut=y.useProgram(R,dt),Gt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(X);I&&(y.context.activeTexture.set(E.TEXTURE0),J.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),dt.updatePaintBuffers(_)),Qa(dt,H,V,J,c);let Pt=Gt?X:null,gt=y.translatePosMatrix(Pt?Pt.posMatrix:X.posMatrix,J,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(L){N=ot.indexBuffer2,P=ot.segments2;let Ct=[E.drawingBufferWidth,E.drawingBufferHeight];Z=R==="fillOutlinePattern"&&I?Ge(gt,y,_,J,Ct):be(gt,Ct)}else N=ot.indexBuffer,P=ot.segments,Z=I?ye(gt,y,_,J):se(gt);ut.draw(y.context,F,f,y.stencilModeForClipping(X),b,Yi.disabled,Z,Gt,c.id,ot.layoutVertexBuffer,N,P,c.paint,y.transform.zoom,dt)}}function Lo(y,n,c,p,f,b,L){let E=y.context,H=E.gl,h="fill-extrusion-pattern",I=c.paint.get(h),_=I.constantOr(1),F=c.getCrossfadeParameters(),R=c.paint.get("fill-extrusion-opacity"),Z=I.constantOr(null);for(let N of p){let P=n.getTile(N),V=P.getBucket(c);if(!V)continue;let X=y.style.map.terrain&&y.style.map.terrain.getTerrainData(N),J=V.programConfigurations.get(c.id),ot=y.useProgram(_?"fillExtrusionPattern":"fillExtrusion",J);_&&(y.context.activeTexture.set(H.TEXTURE0),P.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),J.updatePaintBuffers(F)),Qa(J,h,Z,P,c);let dt=y.translatePosMatrix(N.posMatrix,P,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),ut=c.paint.get("fill-extrusion-vertical-gradient"),Gt=_?Ce(dt,y,ut,R,N,F,P):_e(dt,y,ut,R);ot.draw(E,E.gl.TRIANGLES,f,b,L,Yi.backCCW,Gt,X,c.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,c.paint,y.transform.zoom,J,y.style.map.terrain&&V.centroidVertexBuffer)}}function da(y,n,c,p,f,b,L){let E=y.context,H=E.gl,h=c.fbo;if(!h)return;let I=y.useProgram("hillshade"),_=y.style.map.terrain&&y.style.map.terrain.getTerrainData(n);E.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,h.colorAttachment.get()),I.draw(E,H.TRIANGLES,f,b,L,Yi.disabled,((F,R,Z,N)=>{let P=Z.paint.get("hillshade-shadow-color"),V=Z.paint.get("hillshade-highlight-color"),X=Z.paint.get("hillshade-accent-color"),J=Z.paint.get("hillshade-illumination-direction")*(Math.PI/180);Z.paint.get("hillshade-illumination-anchor")==="viewport"&&(J-=F.transform.angle);let ot=!F.options.moving;return{u_matrix:N?N.posMatrix:F.transform.calculatePosMatrix(R.tileID.toUnwrapped(),ot),u_image:0,u_latrange:Fi(0,R.tileID),u_light:[Z.paint.get("hillshade-exaggeration"),J],u_shadow:P,u_highlight:V,u_accent:X}})(y,c,p,_?n:null),_,p.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function ts(y,n,c,p,f,b){let L=y.context,E=L.gl,H=n.dem;if(H&&H.data){let h=H.dim,I=H.stride,_=H.getPixels();if(L.activeTexture.set(E.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||y.getTileTexture(I),n.demTexture){let R=n.demTexture;R.update(_,{premultiply:!1}),R.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else n.demTexture=new qt(L,_,E.RGBA,{premultiply:!1}),n.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);L.activeTexture.set(E.TEXTURE0);let F=n.fbo;if(!F){let R=new qt(L,{width:h,height:h,data:null},E.RGBA);R.bind(E.LINEAR,E.CLAMP_TO_EDGE),F=n.fbo=L.createFramebuffer(h,h,!0,!1),F.colorAttachment.set(R.texture)}L.bindFramebuffer.set(F.framebuffer),L.viewport.set([0,0,h,h]),y.useProgram("hillshadePrepare").draw(L,E.TRIANGLES,p,f,b,Yi.disabled,((R,Z)=>{let N=Z.stride,P=o.F();return o.aN(P,0,o.W,-o.W,0,0,1),o.H(P,P,[0,-o.W,0]),{u_matrix:P,u_image:1,u_dimension:[N,N],u_zoom:R.overscaledZ,u_unpack:Z.getUnpackVector()}})(n.tileID,H),null,c.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Ga(y,n,c,p,f,b){let L=p.paint.get("raster-fade-duration");if(!b&&L>0){let E=v.now(),H=(E-y.timeAdded)/L,h=n?(E-n.timeAdded)/L:-1,I=c.getSource(),_=f.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),F=!n||Math.abs(n.tileID.overscaledZ-_)>Math.abs(y.tileID.overscaledZ-_),R=F&&y.refreshedUponExpiration?1:o.ac(F?H:1-h,0,1);return y.refreshedUponExpiration&&H>=1&&(y.refreshedUponExpiration=!1),n?{opacity:1,mix:1-R}:{opacity:R,mix:0}}return{opacity:1,mix:0}}let $o=new o.aO(1,0,0,1),pa=new o.aO(0,1,0,1),nl=new o.aO(0,0,1,1),es=new o.aO(1,0,1,1),zr=new o.aO(0,1,1,1);function Ps(y,n,c,p){On(y,0,n+c/2,y.transform.width,c,p)}function Wn(y,n,c,p){On(y,n-c/2,0,c,y.transform.height,p)}function On(y,n,c,p,f,b){let L=y.context,E=L.gl;E.enable(E.SCISSOR_TEST),E.scissor(n*y.pixelRatio,c*y.pixelRatio,p*y.pixelRatio,f*y.pixelRatio),L.clear({color:b}),E.disable(E.SCISSOR_TEST)}function Ra(y,n,c){let p=y.context,f=p.gl,b=c.posMatrix,L=y.useProgram("debug"),E=Ci.disabled,H=Xi.disabled,h=y.colorModeForRenderPass(),I="$debug",_=y.style.map.terrain&&y.style.map.terrain.getTerrainData(c);p.activeTexture.set(f.TEXTURE0);let F=n.getTileByID(c.key).latestRawTileData,R=Math.floor((F&&F.byteLength||0)/1024),Z=n.getTile(c).tileSize,N=512/Math.min(Z,512)*(c.overscaledZ/y.transform.zoom)*.5,P=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(P+=` => ${c.overscaledZ}`),function(V,X){V.initDebugOverlayCanvas();let J=V.debugOverlayCanvas,ot=V.context.gl,dt=V.debugOverlayCanvas.getContext("2d");dt.clearRect(0,0,J.width,J.height),dt.shadowColor="white",dt.shadowBlur=2,dt.lineWidth=1.5,dt.strokeStyle="white",dt.textBaseline="top",dt.font="bold 36px Open Sans, sans-serif",dt.fillText(X,5,5),dt.strokeText(X,5,5),V.debugOverlayTexture.update(J),V.debugOverlayTexture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE)}(y,`${P} ${R}kB`),L.draw(p,f.TRIANGLES,E,H,xi.alphaBlended,Yi.disabled,Pe(b,o.aO.transparent,N),null,I,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),L.draw(p,f.LINE_STRIP,E,H,h,Yi.disabled,Pe(b,o.aO.red),_,I,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function sl(y,n,c){let p=y.context,f=p.gl,b=y.colorModeForRenderPass(),L=new Ci(f.LEQUAL,Ci.ReadWrite,y.depthRangeFor3D),E=y.useProgram("terrain"),H=n.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,y.width,y.height]);for(let h of c){let I=y.renderToTexture.getTexture(h),_=n.getTerrainData(h.tileID);p.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,I.texture);let F={u_matrix:y.transform.calculatePosMatrix(h.tileID.toUnwrapped()),u_texture:0,u_ele_delta:n.getMeshFrameDelta(y.transform.zoom)};E.draw(p,f.TRIANGLES,L,Xi.disabled,b,Yi.backCCW,F,_,"terrain",H.vertexBuffer,H.indexBuffer,H.segments)}}class fa{constructor(n,c){this.context=new ar(n),this.transform=c,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Se.maxUnderzooming+Se.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Nr}resize(n,c,p){if(this.width=Math.floor(n*p),this.height=Math.floor(c*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let f of this.style._order)this.style._layers[f].resize()}setup(){let n=this.context,c=new o.aV;c.emplaceBack(0,0),c.emplaceBack(o.W,0),c.emplaceBack(0,o.W),c.emplaceBack(o.W,o.W),this.tileExtentBuffer=n.createVertexBuffer(c,pt.members),this.tileExtentSegments=o.$.simpleSegment(0,0,4,2);let p=new o.aV;p.emplaceBack(0,0),p.emplaceBack(o.W,0),p.emplaceBack(0,o.W),p.emplaceBack(o.W,o.W),this.debugBuffer=n.createVertexBuffer(p,pt.members),this.debugSegments=o.$.simpleSegment(0,0,4,5);let f=new o.Z;f.emplaceBack(0,0,0,0),f.emplaceBack(o.W,0,o.W,0),f.emplaceBack(0,o.W,0,o.W),f.emplaceBack(o.W,o.W,o.W,o.W),this.rasterBoundsBuffer=n.createVertexBuffer(f,Ee.members),this.rasterBoundsSegments=o.$.simpleSegment(0,0,4,2);let b=new o.aV;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(b,pt.members),this.viewportSegments=o.$.simpleSegment(0,0,4,2);let L=new o.aW;L.emplaceBack(0),L.emplaceBack(1),L.emplaceBack(3),L.emplaceBack(2),L.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(L);let E=new o.aX;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(E);let H=this.context.gl;this.stencilClearMode=new Xi({func:H.ALWAYS,mask:0},0,255,H.ZERO,H.ZERO,H.ZERO)}clearStencil(){let n=this.context,c=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let p=o.F();o.aN(p,0,this.width,this.height,0,0,1),o.J(p,p,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,c.TRIANGLES,Ci.disabled,this.stencilClearMode,xi.disabled,Yi.disabled,Qe(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,c){if(this.currentStencilSource===n.source||!n.isTileClipped()||!c||!c.length)return;this.currentStencilSource=n.source;let p=this.context,f=p.gl;this.nextStencilID+c.length>256&&this.clearStencil(),p.setColorMode(xi.disabled),p.setDepthMode(Ci.disabled);let b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let L of c){let E=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,H=this.style.map.terrain&&this.style.map.terrain.getTerrainData(L);b.draw(p,f.TRIANGLES,Ci.disabled,new Xi({func:f.ALWAYS,mask:0},E,255,f.KEEP,f.KEEP,f.REPLACE),xi.disabled,Yi.disabled,Qe(L.posMatrix),H,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let n=this.nextStencilID++,c=this.context.gl;return new Xi({func:c.NOTEQUAL,mask:255},n,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(n){let c=this.context.gl;return new Xi({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(n){let c=this.context.gl,p=n.sort((L,E)=>E.overscaledZ-L.overscaledZ),f=p[p.length-1].overscaledZ,b=p[0].overscaledZ-f+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();let L={};for(let E=0;E<b;E++)L[E+f]=new Xi({func:c.GEQUAL,mask:255},E+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=b,[L,p]}return[{[f]:Xi.disabled},p]}colorModeForRenderPass(){let n=this.context.gl;return this._showOverdrawInspector?new xi([n.CONSTANT_COLOR,n.ONE],new o.aO(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?xi.unblended:xi.alphaBlended}depthModeForSublayer(n,c,p){if(!this.opaquePassEnabledForLayer())return Ci.disabled;let f=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Ci(p||this.context.gl.LEQUAL,c,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,c){this.style=n,this.options=c,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(v.now()),this.imageManager.beginFrame();let p=this.style._order,f=this.style.sourceCaches,b={},L={},E={};for(let H in f){let h=f[H];h.used&&h.prepare(this.context),b[H]=h.getVisibleCoordinates(),L[H]=b[H].slice().reverse(),E[H]=h.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<p.length;H++)if(this.style._layers[p[H]].is3D()){this.opaquePassCutoff=H;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let H of p){let h=this.style._layers[H];if(!h.hasOffscreenPass()||h.isHidden(this.transform.zoom))continue;let I=L[h.source];(h.type==="custom"||I.length)&&this.renderLayer(this,f[h.source],h,I)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?o.aO.black:o.aO.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){let H=this.style._layers[p[this.currentLayer]],h=f[H.source],I=b[H.source];this._renderTileClippingMasks(H,I),this.renderLayer(this,h,H,I)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){let H=this.style._layers[p[this.currentLayer]],h=f[H.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(H))continue;let I=(H.type==="symbol"?E:L)[H.source];this._renderTileClippingMasks(H,b[H.source]),this.renderLayer(this,h,H,I)}if(this.options.showTileBoundaries){let H=function(h,I){let _=null,F=Object.values(h._layers).flatMap(P=>P.source&&!P.isHidden(I)?[h.sourceCaches[P.source]]:[]),R=F.filter(P=>P.getSource().type==="vector"),Z=F.filter(P=>P.getSource().type!=="vector"),N=P=>{(!_||_.getSource().maxzoom<P.getSource().maxzoom)&&(_=P)};return R.forEach(P=>N(P)),_||Z.forEach(P=>N(P)),_}(this.style,this.transform.zoom);H&&function(h,I,_){for(let F=0;F<_.length;F++)Ra(h,I,_[F])}(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){let h=H.transform.padding;Ps(H,H.transform.height-(h.top||0),3,$o),Ps(H,h.bottom||0,3,pa),Wn(H,h.left||0,3,nl),Wn(H,H.transform.width-(h.right||0),3,es);let I=H.transform.centerPoint;(function(_,F,R,Z){On(_,F-1,R-10,2,20,Z),On(_,F-10,R-1,20,2,Z)})(H,I.x,H.transform.height-I.y,zr)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;let c=this.terrainFacilitator.matrix,p=this.transform.projMatrix,f=this.terrainFacilitator.dirty;f||(f=n?!o.aY(c,p):!o.aZ(c,p)),f||(f=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),f&&(o.a_(c,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(b,L){let E=b.context,H=E.gl,h=xi.unblended,I=new Ci(H.LEQUAL,Ci.ReadWrite,[0,1]),_=L.getTerrainMesh(),F=L.sourceCache.getRenderableTiles(),R=b.useProgram("terrainDepth");E.bindFramebuffer.set(L.getFramebuffer("depth").framebuffer),E.viewport.set([0,0,b.width/devicePixelRatio,b.height/devicePixelRatio]),E.clear({color:o.aO.transparent,depth:1});for(let Z of F){let N=L.getTerrainData(Z.tileID),P={u_matrix:b.transform.calculatePosMatrix(Z.tileID.toUnwrapped()),u_ele_delta:L.getMeshFrameDelta(b.transform.zoom)};R.draw(E,H.TRIANGLES,I,Xi.disabled,h,Yi.backCCW,P,N,"terrain",_.vertexBuffer,_.indexBuffer,_.segments)}E.bindFramebuffer.set(null),E.viewport.set([0,0,b.width,b.height])}(this,this.style.map.terrain),function(b,L){let E=b.context,H=E.gl,h=xi.unblended,I=new Ci(H.LEQUAL,Ci.ReadWrite,[0,1]),_=L.getTerrainMesh(),F=L.getCoordsTexture(),R=L.sourceCache.getRenderableTiles(),Z=b.useProgram("terrainCoords");E.bindFramebuffer.set(L.getFramebuffer("coords").framebuffer),E.viewport.set([0,0,b.width/devicePixelRatio,b.height/devicePixelRatio]),E.clear({color:o.aO.transparent,depth:1}),L.coordsIndex=[];for(let N of R){let P=L.getTerrainData(N.tileID);E.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,F.texture);let V={u_matrix:b.transform.calculatePosMatrix(N.tileID.toUnwrapped()),u_terrain_coords_id:(255-L.coordsIndex.length)/255,u_texture:0,u_ele_delta:L.getMeshFrameDelta(b.transform.zoom)};Z.draw(E,H.TRIANGLES,I,Xi.disabled,h,Yi.backCCW,V,P,"terrain",_.vertexBuffer,_.indexBuffer,_.segments),L.coordsIndex.push(N.tileID.key)}E.bindFramebuffer.set(null),E.viewport.set([0,0,b.width,b.height])}(this,this.style.map.terrain))}renderLayer(n,c,p,f){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(f||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(b,L,E,H,h){if(b.renderPass!=="translucent")return;let I=Xi.disabled,_=b.colorModeForRenderPass();(E._unevaluatedLayout.hasValue("text-variable-anchor")||E._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(F,R,Z,N,P,V,X){let J=R.transform,ot=P==="map",dt=V==="map";for(let ut of F){let Gt=N.getTile(ut),Pt=Gt.getBucket(Z);if(!Pt||!Pt.text||!Pt.text.segments.get().length)continue;let gt=o.ag(Pt.textSizeData,J.zoom),Ct=Qi(Gt,1,R.transform.zoom),ee=tr(ut.posMatrix,dt,ot,R.transform,Ct),ge=Z.layout.get("icon-text-fit")!=="none"&&Pt.hasIconData();if(gt){let jt=Math.pow(2,J.zoom-Gt.tileID.overscaledZ);Zs(Pt,ot,dt,X,J,ee,ut.posMatrix,jt,gt,ge,R.style.map.terrain?(Fe,ke)=>R.style.map.terrain.getElevation(ut,Fe,ke):null)}}}(H,b,E,L,E.layout.get("text-rotation-alignment"),E.layout.get("text-pitch-alignment"),h),E.paint.get("icon-opacity").constantOr(1)!==0&&bA(b,L,E,H,!1,E.paint.get("icon-translate"),E.paint.get("icon-translate-anchor"),E.layout.get("icon-rotation-alignment"),E.layout.get("icon-pitch-alignment"),E.layout.get("icon-keep-upright"),I,_),E.paint.get("text-opacity").constantOr(1)!==0&&bA(b,L,E,H,!0,E.paint.get("text-translate"),E.paint.get("text-translate-anchor"),E.layout.get("text-rotation-alignment"),E.layout.get("text-pitch-alignment"),E.layout.get("text-keep-upright"),I,_),L.map.showCollisionBoxes&&(hn(b,L,E,H,E.paint.get("text-translate"),E.paint.get("text-translate-anchor"),!0),hn(b,L,E,H,E.paint.get("icon-translate"),E.paint.get("icon-translate-anchor"),!1))})(n,c,p,f,this.style.placement.variableOffsets);break;case"circle":(function(b,L,E,H){if(b.renderPass!=="translucent")return;let h=E.paint.get("circle-opacity"),I=E.paint.get("circle-stroke-width"),_=E.paint.get("circle-stroke-opacity"),F=!E.layout.get("circle-sort-key").isConstant();if(h.constantOr(1)===0&&(I.constantOr(1)===0||_.constantOr(1)===0))return;let R=b.context,Z=R.gl,N=b.depthModeForSublayer(0,Ci.ReadOnly),P=Xi.disabled,V=b.colorModeForRenderPass(),X=[];for(let J=0;J<H.length;J++){let ot=H[J],dt=L.getTile(ot),ut=dt.getBucket(E);if(!ut)continue;let Gt=ut.programConfigurations.get(E.id),Pt=b.useProgram("circle",Gt),gt=ut.layoutVertexBuffer,Ct=ut.indexBuffer,ee=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ot),ge={programConfiguration:Gt,program:Pt,layoutVertexBuffer:gt,indexBuffer:Ct,uniformValues:Ui(b,ot,dt,E),terrainData:ee};if(F){let jt=ut.segments.get();for(let Fe of jt)X.push({segments:new o.$([Fe]),sortKey:Fe.sortKey,state:ge})}else X.push({segments:ut.segments,sortKey:0,state:ge})}F&&X.sort((J,ot)=>J.sortKey-ot.sortKey);for(let J of X){let{programConfiguration:ot,program:dt,layoutVertexBuffer:ut,indexBuffer:Gt,uniformValues:Pt,terrainData:gt}=J.state;dt.draw(R,Z.TRIANGLES,N,P,V,Yi.disabled,Pt,gt,E.id,ut,Gt,J.segments,E.paint,b.transform.zoom,ot)}})(n,c,p,f);break;case"heatmap":(function(b,L,E,H){if(E.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){let h=b.context,I=h.gl,_=Xi.disabled,F=new xi([I.ONE,I.ONE],o.aO.transparent,[!0,!0,!0,!0]);(function(R,Z,N){let P=R.gl;R.activeTexture.set(P.TEXTURE1),R.viewport.set([0,0,Z.width/4,Z.height/4]);let V=N.heatmapFbo;if(V)P.bindTexture(P.TEXTURE_2D,V.colorAttachment.get()),R.bindFramebuffer.set(V.framebuffer);else{let X=P.createTexture();P.bindTexture(P.TEXTURE_2D,X),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.LINEAR),V=N.heatmapFbo=R.createFramebuffer(Z.width/4,Z.height/4,!1,!1),function(J,ot,dt,ut){var Gt,Pt;let gt=J.gl,Ct=(Gt=J.HALF_FLOAT)!==null&&Gt!==void 0?Gt:gt.UNSIGNED_BYTE,ee=(Pt=J.RGBA16F)!==null&&Pt!==void 0?Pt:gt.RGBA;gt.texImage2D(gt.TEXTURE_2D,0,ee,ot.width/4,ot.height/4,0,gt.RGBA,Ct,null),ut.colorAttachment.set(dt)}(R,Z,X,V)}})(h,b,E),h.clear({color:o.aO.transparent});for(let R=0;R<H.length;R++){let Z=H[R];if(L.hasRenderableParent(Z))continue;let N=L.getTile(Z),P=N.getBucket(E);if(!P)continue;let V=P.programConfigurations.get(E.id),X=b.useProgram("heatmap",V),{zoom:J}=b.transform;X.draw(h,I.TRIANGLES,Ci.disabled,_,F,Yi.disabled,Ai(Z.posMatrix,N,J,E.paint.get("heatmap-intensity")),null,E.id,P.layoutVertexBuffer,P.indexBuffer,P.segments,E.paint,b.transform.zoom,V)}h.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(h,I){let _=h.context,F=_.gl,R=I.heatmapFbo;if(!R)return;_.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,R.colorAttachment.get()),_.activeTexture.set(F.TEXTURE1);let Z=I.colorRampTexture;Z||(Z=I.colorRampTexture=new qt(_,I.colorRamp,F.RGBA)),Z.bind(F.LINEAR,F.CLAMP_TO_EDGE),h.useProgram("heatmapTexture").draw(_,F.TRIANGLES,Ci.disabled,Xi.disabled,h.colorModeForRenderPass(),Yi.disabled,((N,P,V,X)=>{let J=o.F();o.aN(J,0,N.width,N.height,0,0,1);let ot=N.context.gl;return{u_matrix:J,u_world:[ot.drawingBufferWidth,ot.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:P.paint.get("heatmap-opacity")}})(h,I),null,I.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments,I.paint,h.transform.zoom)}(b,E))})(n,c,p,f);break;case"line":(function(b,L,E,H){if(b.renderPass!=="translucent")return;let h=E.paint.get("line-opacity"),I=E.paint.get("line-width");if(h.constantOr(1)===0||I.constantOr(1)===0)return;let _=b.depthModeForSublayer(0,Ci.ReadOnly),F=b.colorModeForRenderPass(),R=E.paint.get("line-dasharray"),Z=E.paint.get("line-pattern"),N=Z.constantOr(1),P=E.paint.get("line-gradient"),V=E.getCrossfadeParameters(),X=N?"linePattern":R?"lineSDF":P?"lineGradient":"line",J=b.context,ot=J.gl,dt=!0;for(let ut of H){let Gt=L.getTile(ut);if(N&&!Gt.patternsLoaded())continue;let Pt=Gt.getBucket(E);if(!Pt)continue;let gt=Pt.programConfigurations.get(E.id),Ct=b.context.program.get(),ee=b.useProgram(X,gt),ge=dt||ee.program!==Ct,jt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ut),Fe=Z.constantOr(null);if(Fe&&Gt.imageAtlas){let xe=Gt.imageAtlas,ci=xe.patternPositions[Fe.to.toString()],pi=xe.patternPositions[Fe.from.toString()];ci&&pi&&gt.setConstantPatternPositions(ci,pi)}let ke=jt?ut:null,Ye=N?ai(b,Gt,E,V,ke):R?dr(b,Gt,E,R,V,ke):P?nr(b,Gt,E,Pt.lineClipsArray.length,ke):Wi(b,Gt,E,ke);if(N)J.activeTexture.set(ot.TEXTURE0),Gt.imageAtlasTexture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE),gt.updatePaintBuffers(V);else if(R&&(ge||b.lineAtlas.dirty))J.activeTexture.set(ot.TEXTURE0),b.lineAtlas.bind(J);else if(P){let xe=Pt.gradients[E.id],ci=xe.texture;if(E.gradientVersion!==xe.version){let pi=256;if(E.stepInterpolant){let Mi=L.getSource().maxzoom,Si=ut.canonical.z===Mi?Math.ceil(1<<b.transform.maxZoom-ut.canonical.z):1;pi=o.ac(o.aT(Pt.maxLineLength/o.W*1024*Si),256,J.maxTextureSize)}xe.gradient=o.aU({expression:E.gradientExpression(),evaluationKey:"lineProgress",resolution:pi,image:xe.gradient||void 0,clips:Pt.lineClipsArray}),xe.texture?xe.texture.update(xe.gradient):xe.texture=new qt(J,xe.gradient,ot.RGBA),xe.version=E.gradientVersion,ci=xe.texture}J.activeTexture.set(ot.TEXTURE0),ci.bind(E.stepInterpolant?ot.NEAREST:ot.LINEAR,ot.CLAMP_TO_EDGE)}ee.draw(J,ot.TRIANGLES,_,b.stencilModeForClipping(ut),F,Yi.disabled,Ye,jt,E.id,Pt.layoutVertexBuffer,Pt.indexBuffer,Pt.segments,E.paint,b.transform.zoom,gt,Pt.layoutVertexBuffer2),dt=!1}})(n,c,p,f);break;case"fill":(function(b,L,E,H){let h=E.paint.get("fill-color"),I=E.paint.get("fill-opacity");if(I.constantOr(1)===0)return;let _=b.colorModeForRenderPass(),F=E.paint.get("fill-pattern"),R=b.opaquePassEnabledForLayer()&&!F.constantOr(1)&&h.constantOr(o.aO.transparent).a===1&&I.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===R){let Z=b.depthModeForSublayer(1,b.renderPass==="opaque"?Ci.ReadWrite:Ci.ReadOnly);Ua(b,L,E,H,Z,_,!1)}if(b.renderPass==="translucent"&&E.paint.get("fill-antialias")){let Z=b.depthModeForSublayer(E.getPaintProperty("fill-outline-color")?2:0,Ci.ReadOnly);Ua(b,L,E,H,Z,_,!0)}})(n,c,p,f);break;case"fill-extrusion":(function(b,L,E,H){let h=E.paint.get("fill-extrusion-opacity");if(h!==0&&b.renderPass==="translucent"){let I=new Ci(b.context.gl.LEQUAL,Ci.ReadWrite,b.depthRangeFor3D);if(h!==1||E.paint.get("fill-extrusion-pattern").constantOr(1))Lo(b,L,E,H,I,Xi.disabled,xi.disabled),Lo(b,L,E,H,I,b.stencilModeFor3D(),b.colorModeForRenderPass());else{let _=b.colorModeForRenderPass();Lo(b,L,E,H,I,Xi.disabled,_)}}})(n,c,p,f);break;case"hillshade":(function(b,L,E,H){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;let h=b.context,I=b.depthModeForSublayer(0,Ci.ReadOnly),_=b.colorModeForRenderPass(),[F,R]=b.renderPass==="translucent"?b.stencilConfigForOverlap(H):[{},H];for(let Z of R){let N=L.getTile(Z);N.needsHillshadePrepare!==void 0&&N.needsHillshadePrepare&&b.renderPass==="offscreen"?ts(b,N,E,I,Xi.disabled,_):b.renderPass==="translucent"&&da(b,Z,N,E,I,F[Z.overscaledZ],_)}h.viewport.set([0,0,b.width,b.height])})(n,c,p,f);break;case"raster":(function(b,L,E,H){if(b.renderPass!=="translucent"||E.paint.get("raster-opacity")===0||!H.length)return;let h=b.context,I=h.gl,_=L.getSource(),F=b.useProgram("raster"),R=b.colorModeForRenderPass(),[Z,N]=_ instanceof Ne?[{},H]:b.stencilConfigForOverlap(H),P=N[N.length-1].overscaledZ,V=!b.options.moving;for(let X of N){let J=b.depthModeForSublayer(X.overscaledZ-P,E.paint.get("raster-opacity")===1?Ci.ReadWrite:Ci.ReadOnly,I.LESS),ot=L.getTile(X);ot.registerFadeDuration(E.paint.get("raster-fade-duration"));let dt=L.findLoadedParent(X,0),ut=Ga(ot,dt,L,E,b.transform,b.style.map.terrain),Gt,Pt,gt=E.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;h.activeTexture.set(I.TEXTURE0),ot.texture.bind(gt,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(I.TEXTURE1),dt?(dt.texture.bind(gt,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),Gt=Math.pow(2,dt.tileID.overscaledZ-ot.tileID.overscaledZ),Pt=[ot.tileID.canonical.x*Gt%1,ot.tileID.canonical.y*Gt%1]):ot.texture.bind(gt,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST);let Ct=b.style.map.terrain&&b.style.map.terrain.getTerrainData(X),ee=Ct?X:null,ge=ee?ee.posMatrix:b.transform.calculatePosMatrix(X.toUnwrapped(),V),jt=_n(ge,Pt||[0,0],Gt||1,ut,E);_ instanceof Ne?F.draw(h,I.TRIANGLES,J,Xi.disabled,R,Yi.disabled,jt,Ct,E.id,_.boundsBuffer,b.quadTriangleIndexBuffer,_.boundsSegments):F.draw(h,I.TRIANGLES,J,Z[X.overscaledZ],R,Yi.disabled,jt,Ct,E.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}})(n,c,p,f);break;case"background":(function(b,L,E,H){let h=E.paint.get("background-color"),I=E.paint.get("background-opacity");if(I===0)return;let _=b.context,F=_.gl,R=b.transform,Z=R.tileSize,N=E.paint.get("background-pattern");if(b.isPatternMissing(N))return;let P=!N&&h.a===1&&I===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==P)return;let V=Xi.disabled,X=b.depthModeForSublayer(0,P==="opaque"?Ci.ReadWrite:Ci.ReadOnly),J=b.colorModeForRenderPass(),ot=b.useProgram(N?"backgroundPattern":"background"),dt=H||R.coveringTiles({tileSize:Z,terrain:b.style.map.terrain});N&&(_.activeTexture.set(F.TEXTURE0),b.imageManager.bind(b.context));let ut=E.getCrossfadeParameters();for(let Gt of dt){let Pt=H?Gt.posMatrix:b.transform.calculatePosMatrix(Gt.toUnwrapped()),gt=N?El(Pt,I,b,N,{tileID:Gt,tileSize:Z},ut):yc(Pt,I,h),Ct=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Gt);ot.draw(_,F.TRIANGLES,X,V,J,Yi.disabled,gt,Ct,E.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}})(n,0,p,f);break;case"custom":(function(b,L,E){let H=b.context,h=E.implementation;if(b.renderPass==="offscreen"){let I=h.prerender;I&&(b.setCustomLayerDefaults(),H.setColorMode(b.colorModeForRenderPass()),I.call(h,H.gl,b.transform.customLayerMatrix()),H.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),H.setColorMode(b.colorModeForRenderPass()),H.setStencilMode(Xi.disabled);let I=h.renderingMode==="3d"?new Ci(b.context.gl.LEQUAL,Ci.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,Ci.ReadOnly);H.setDepthMode(I),h.render(H.gl,b.transform.customLayerMatrix()),H.setDirty(),b.setBaseState(),H.bindFramebuffer.set(null)}})(n,0,p)}}translatePosMatrix(n,c,p,f,b){if(!p[0]&&!p[1])return n;let L=b?f==="map"?this.transform.angle:0:f==="viewport"?-this.transform.angle:0;if(L){let h=Math.sin(L),I=Math.cos(L);p=[p[0]*I-p[1]*h,p[0]*h+p[1]*I]}let E=[b?p[0]:Qi(c,p[0],this.transform.zoom),b?p[1]:Qi(c,p[1],this.transform.zoom),0],H=new Float32Array(16);return o.H(H,n,E),H}saveTileTexture(n){let c=this._tileTextures[n.size[0]];c?c.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){let c=this._tileTextures[n];return c&&c.length>0?c.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;let c=this.imageManager.getPattern(n.from.toString()),p=this.imageManager.getPattern(n.to.toString());return!c||!p}useProgram(n,c){this.cache=this.cache||{};let p=n+(c?c.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new ae(this.context,ct[n],c,el[n],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new qt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:n,drawingBufferHeight:c}=this.context.gl;return this.width!==n||this.height!==c}}class ls{constructor(n,c){this.points=n,this.planes=c}static fromInvProjectionMatrix(n,c,p){let f=Math.pow(2,p),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{let H=1/(E=o.af([],E,n))[3]/c*f;return o.a$(E,E,[H,H,1/E[3],H])}),L=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{let H=function(F,R){var Z=R[0],N=R[1],P=R[2],V=Z*Z+N*N+P*P;return V>0&&(V=1/Math.sqrt(V)),F[0]=R[0]*V,F[1]=R[1]*V,F[2]=R[2]*V,F}([],function(F,R,Z){var N=R[0],P=R[1],V=R[2],X=Z[0],J=Z[1],ot=Z[2];return F[0]=P*ot-V*J,F[1]=V*X-N*ot,F[2]=N*J-P*X,F}([],Ft([],b[E[0]],b[E[1]]),Ft([],b[E[2]],b[E[1]]))),h=-((I=H)[0]*(_=b[E[1]])[0]+I[1]*_[1]+I[2]*_[2]);var I,_;return H.concat(h)});return new ls(b,L)}}class xn{constructor(n,c){this.min=n,this.max=c,this.center=function(p,f,b){return p[0]=.5*f[0],p[1]=.5*f[1],p[2]=.5*f[2],p}([],function(p,f,b){return p[0]=f[0]+b[0],p[1]=f[1]+b[1],p[2]=f[2]+b[2],p}([],this.min,this.max))}quadrant(n){let c=[n%2==0,n<2],p=Tt(this.min),f=Tt(this.max);for(let b=0;b<c.length;b++)p[b]=c[b]?this.min[b]:this.center[b],f[b]=c[b]?this.center[b]:this.max[b];return f[2]=this.max[2],new xn(p,f)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){let c=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],p=!0;for(let f=0;f<n.planes.length;f++){let b=n.planes[f],L=0;for(let E=0;E<c.length;E++)o.b0(b,c[E])>=0&&L++;if(L===0)return 0;L!==c.length&&(p=!1)}if(p)return 2;for(let f=0;f<3;f++){let b=Number.MAX_VALUE,L=-Number.MAX_VALUE;for(let E=0;E<n.points.length;E++){let H=n.points[E][f]-this.min[f];b=Math.min(b,H),L=Math.max(L,H)}if(L<0||b>this.max[f]-this.min[f])return 0}return 1}}class is{constructor(n=0,c=0,p=0,f=0){if(isNaN(n)||n<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=c,this.left=p,this.right=f}interpolate(n,c,p){return c.top!=null&&n.top!=null&&(this.top=o.z.number(n.top,c.top,p)),c.bottom!=null&&n.bottom!=null&&(this.bottom=o.z.number(n.bottom,c.bottom,p)),c.left!=null&&n.left!=null&&(this.left=o.z.number(n.left,c.left,p)),c.right!=null&&n.right!=null&&(this.right=o.z.number(n.right,c.right,p)),this}getCenter(n,c){let p=o.ac((this.left+n-this.right)/2,0,n),f=o.ac((this.top+c-this.bottom)/2,0,c);return new o.P(p,f)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new is(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}let Eo=85.051129;class _s{constructor(n,c,p,f,b){this.tileSize=512,this._renderWorldCopies=b===void 0||!!b,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=p??0,this._maxPitch=f??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new is,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){let n=new _s(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.apply(this),n}apply(n){this.tileSize=n.tileSize,this.latRange=n.latRange,this.width=n.width,this.height=n.height,this._center=n._center,this._elevation=n._elevation,this.minElevationForCurrentTile=n.minElevationForCurrentTile,this.zoom=n.zoom,this.angle=n.angle,this._fov=n._fov,this._pitch=n._pitch,this._unmodified=n._unmodified,this._edgeInsets=n._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){let c=-o.b1(n,-180,180)*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=function(){var p=new o.A(4);return o.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,f,b){var L=f[0],E=f[1],H=f[2],h=f[3],I=Math.sin(b),_=Math.cos(b);p[0]=L*_+H*I,p[1]=E*_+h*I,p[2]=L*-I+H*_,p[3]=E*-I+h*_}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){let c=o.ac(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){let c=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._zoom=c,this.tileZoom=Math.max(0,Math.floor(c)),this.scale=this.zoomScale(c),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,c,p){this._unmodified=!1,this._edgeInsets.interpolate(n,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){let c=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(n){let c=[new o.b2(0,n)];if(this._renderWorldCopies){let p=this.pointCoordinate(new o.P(0,0)),f=this.pointCoordinate(new o.P(this.width,0)),b=this.pointCoordinate(new o.P(this.width,this.height)),L=this.pointCoordinate(new o.P(0,this.height)),E=Math.floor(Math.min(p.x,f.x,b.x,L.x)),H=Math.floor(Math.max(p.x,f.x,b.x,L.x)),h=1;for(let I=E-h;I<=H+h;I++)I!==0&&c.push(new o.b2(I,n))}return c}coveringTiles(n){var c,p;let f=this.coveringZoomLevel(n),b=f;if(n.minzoom!==void 0&&f<n.minzoom)return[];n.maxzoom!==void 0&&f>n.maxzoom&&(f=n.maxzoom);let L=this.pointCoordinate(this.getCameraPoint()),E=o.Y.fromLngLat(this.center),H=Math.pow(2,f),h=[H*L.x,H*L.y,0],I=[H*E.x,H*E.y,0],_=ls.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f),F=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(F=f);let R=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,Z=J=>({aabb:new xn([J*H,0,0],[(J+1)*H,H,0]),zoom:0,x:0,y:0,wrap:J,fullyVisible:!1}),N=[],P=[],V=f,X=n.reparseOverscaled?b:f;if(this._renderWorldCopies)for(let J=1;J<=3;J++)N.push(Z(-J)),N.push(Z(J));for(N.push(Z(0));N.length>0;){let J=N.pop(),ot=J.x,dt=J.y,ut=J.fullyVisible;if(!ut){let ee=J.aabb.intersects(_);if(ee===0)continue;ut=ee===2}let Gt=n.terrain?h:I,Pt=J.aabb.distanceX(Gt),gt=J.aabb.distanceY(Gt),Ct=Math.max(Math.abs(Pt),Math.abs(gt));if(J.zoom===V||Ct>R+(1<<V-J.zoom)-2&&J.zoom>=F){let ee=V-J.zoom,ge=h[0]-.5-(ot<<ee),jt=h[1]-.5-(dt<<ee);P.push({tileID:new o.Q(J.zoom===V?X:J.zoom,J.wrap,J.zoom,ot,dt),distanceSq:vt([I[0]-.5-ot,I[1]-.5-dt]),tileDistanceToCamera:Math.sqrt(ge*ge+jt*jt)})}else for(let ee=0;ee<4;ee++){let ge=(ot<<1)+ee%2,jt=(dt<<1)+(ee>>1),Fe=J.zoom+1,ke=J.aabb.quadrant(ee);if(n.terrain){let Ye=new o.Q(Fe,J.wrap,Fe,ge,jt),xe=n.terrain.getMinMaxElevation(Ye),ci=(c=xe.minElevation)!==null&&c!==void 0?c:this.elevation,pi=(p=xe.maxElevation)!==null&&p!==void 0?p:this.elevation;ke=new xn([ke.min[0],ke.min[1],ci],[ke.max[0],ke.max[1],pi])}N.push({aabb:ke,zoom:Fe,x:ge,y:jt,wrap:J.wrap,fullyVisible:ut})}}return P.sort((J,ot)=>J.distanceSq-ot.distanceSq).map(J=>J.tileID)}resize(n,c){this.width=n,this.height=c,this.pixelsToGLUnits=[2/n,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){let c=o.ac(n.lat,-85.051129,Eo);return new o.P(o.N(n.lng)*this.worldSize,o.O(c)*this.worldSize)}unproject(n){return new o.Y(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){let c=this.elevation,p=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,f=this.pointLocation(this.centerPoint,n),b=n.getElevationForLngLatZoom(f,this.tileZoom);if(!(this.elevation-b))return;let L=p+c-b,E=Math.cos(this._pitch)*this.cameraToCenterDistance/L/o.b3(1,f.lat),H=this.scaleZoom(E/this.tileSize);this._elevation=b,this._center=f,this.zoom=H}setLocationAtPoint(n,c){let p=this.pointCoordinate(c),f=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(n),L=new o.Y(b.x-(p.x-f.x),b.y-(p.y-f.y));this.center=this.coordinateLocation(L),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,c){return c?this.coordinatePoint(this.locationCoordinate(n),c.getElevationForLngLatZoom(n,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,c){return this.coordinateLocation(this.pointCoordinate(n,c))}locationCoordinate(n){return o.Y.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,c){if(c){let F=c.pointCoordinate(n);if(F!=null)return F}let p=[n.x,n.y,0,1],f=[n.x,n.y,1,1];o.af(p,p,this.pixelMatrixInverse),o.af(f,f,this.pixelMatrixInverse);let b=p[3],L=f[3],E=p[1]/b,H=f[1]/L,h=p[2]/b,I=f[2]/L,_=h===I?0:(0-h)/(I-h);return new o.Y(o.z.number(p[0]/b,f[0]/L,_)/this.worldSize,o.z.number(E,H,_)/this.worldSize)}coordinatePoint(n,c=0,p=this.pixelMatrix){let f=[n.x*this.worldSize,n.y*this.worldSize,c,1];return o.af(f,f,p),new o.P(f[0]/f[3],f[1]/f[3])}getBounds(){let n=Math.max(0,this.height/2-this.getHorizon());return new Me().extend(this.pointLocation(new o.P(0,n))).extend(this.pointLocation(new o.P(this.width,n))).extend(this.pointLocation(new o.P(this.width,this.height))).extend(this.pointLocation(new o.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Me([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Eo])}calculatePosMatrix(n,c=!1){let p=n.key,f=c?this._alignedPosMatrixCache:this._posMatrixCache;if(f[p])return f[p];let b=n.canonical,L=this.worldSize/this.zoomScale(b.z),E=b.x+Math.pow(2,b.z)*n.wrap,H=o.an(new Float64Array(16));return o.H(H,H,[E*L,b.y*L,0]),o.J(H,H,[L/o.W,L/o.W,1]),o.K(H,c?this.alignedProjMatrix:this.projMatrix,H),f[p]=new Float32Array(H),f[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(n,c){c=o.ac(+c,this.minZoom,this.maxZoom);let p={center:new o.M(n.lng,n.lat),zoom:c},f=this.lngRange;if(!this._renderWorldCopies&&f===null){let J=179.9999999999;f=[-J,J]}let b=this.tileSize*this.zoomScale(p.zoom),L=0,E=b,H=0,h=b,I=0,_=0,{x:F,y:R}=this.size;if(this.latRange){let J=this.latRange;L=o.O(J[1])*b,E=o.O(J[0])*b,E-L<R&&(I=R/(E-L))}f&&(H=o.b1(o.N(f[0])*b,0,b),h=o.b1(o.N(f[1])*b,0,b),h<H&&(h+=b),h-H<F&&(_=F/(h-H)));let{x:Z,y:N}=this.project.call({worldSize:b},n),P,V,X=Math.max(_||0,I||0);if(X){let J=new o.P(_?(h+H)/2:Z,I?(E+L)/2:N);return p.center=this.unproject.call({worldSize:b},J).wrap(),p.zoom+=this.scaleZoom(X),p}if(this.latRange){let J=R/2;N-J<L&&(V=L+J),N+J>E&&(V=E-J)}if(f){let J=(H+h)/2,ot=Z;this._renderWorldCopies&&(ot=o.b1(Z,J-b/2,J+b/2));let dt=F/2;ot-dt<H&&(P=H+dt),ot+dt>h&&(P=h-dt)}if(P!==void 0||V!==void 0){let J=new o.P(P??Z,V??N);p.center=this.unproject.call({worldSize:b},J).wrap()}return p}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let n=this._unmodified,{center:c,zoom:p}=this.getConstrained(this.center,this.zoom);this.center=c,this.zoom=p,this._unmodified=n,this._constraining=!1}_calcMatrices(){if(!this.height)return;let n=this.centerOffset,c=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.b3(1,this.center.lat)*this.worldSize;let f=o.an(new Float64Array(16));o.J(f,f,[this.width/2,-this.height/2,1]),o.H(f,f,[1,-1,0]),this.labelPlaneMatrix=f,f=o.an(new Float64Array(16)),o.J(f,f,[1,-1,1]),o.H(f,f,[-1,-1,0]),o.J(f,f,[2/this.width,2/this.height,1]),this.glCoordMatrix=f;let b=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),L=Math.min(this.elevation,this.minElevationForCurrentTile),E=b-L*this._pixelPerMeter/Math.cos(this._pitch),H=L<0?E:b,h=Math.PI/2+this._pitch,I=this._fov*(.5+n.y/this.height),_=Math.sin(I)*H/Math.sin(o.ac(Math.PI-h-I,.01,Math.PI-.01)),F=this.getHorizon(),R=2*Math.atan(F/this.cameraToCenterDistance)*(.5+n.y/(2*F)),Z=Math.sin(R)*H/Math.sin(o.ac(Math.PI-h-R,.01,Math.PI-.01)),N=Math.min(_,Z),P=1.01*(Math.cos(Math.PI/2-this._pitch)*N+H),V=this.height/50;f=new Float64Array(16),o.b4(f,this._fov,this.width/this.height,V,P),f[8]=2*-n.x/this.width,f[9]=2*n.y/this.height,o.J(f,f,[1,-1,1]),o.H(f,f,[0,0,-this.cameraToCenterDistance]),o.b5(f,f,this._pitch),o.ad(f,f,this.angle),o.H(f,f,[-c,-p,0]),this.mercatorMatrix=o.J([],f,[this.worldSize,this.worldSize,this.worldSize]),o.J(f,f,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.K(new Float64Array(16),this.labelPlaneMatrix,f),o.H(f,f,[0,0,-this.elevation]),this.projMatrix=f,this.invProjMatrix=o.ar([],f),this.pixelMatrix3D=o.K(new Float64Array(16),this.labelPlaneMatrix,f);let X=this.width%2/2,J=this.height%2/2,ot=Math.cos(this.angle),dt=Math.sin(this.angle),ut=c-Math.round(c)+ot*X+dt*J,Gt=p-Math.round(p)+ot*J+dt*X,Pt=new Float64Array(f);if(o.H(Pt,Pt,[ut>.5?ut-1:ut,Gt>.5?Gt-1:Gt,0]),this.alignedProjMatrix=Pt,f=o.ar(new Float64Array(16),this.pixelMatrix),!f)throw new Error("failed to invert matrix");this.pixelMatrixInverse=f,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let n=this.pointCoordinate(new o.P(0,0)),c=[n.x*this.worldSize,n.y*this.worldSize,0,1];return o.af(c,c,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(0,n))}getCameraQueryGeometry(n){let c=this.getCameraPoint();if(n.length===1)return[n[0],c];{let p=c.x,f=c.y,b=c.x,L=c.y;for(let E of n)p=Math.min(p,E.x),f=Math.min(f,E.y),b=Math.max(b,E.x),L=Math.max(L,E.y);return[new o.P(p,f),new o.P(b,f),new o.P(b,L),new o.P(p,L),new o.P(p,f)]}}lngLatToCameraDepth(n,c){let p=this.locationCoordinate(n),f=[p.x*this.worldSize,p.y*this.worldSize,c,1];return o.af(f,f,this.projMatrix),f[2]/f[3]}}function no(y,n){let c,p=!1,f=null,b=null,L=()=>{f=null,p&&(y.apply(b,c),f=setTimeout(L,n),p=!1)};return(...E)=>(p=!0,b=this,c=E,f||L(),f)}class ma{constructor(n){this._getCurrentHash=()=>{let c=window.location.hash.replace("#","");if(this._hashName){let p;return c.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(p=f)}),(p&&p[1]||"").split("/")}return c.split("/")},this._onHashChange=()=>{let c=this._getCurrentHash();if(c.length>=3&&!c.some(p=>isNaN(p))){let p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{let c=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,c)}catch{}},this._updateHash=no(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){let c=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,f=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,f),L=Math.round(c.lng*b)/b,E=Math.round(c.lat*b)/b,H=this._map.getBearing(),h=this._map.getPitch(),I="";if(I+=n?`/${L}/${E}/${p}`:`${p}/${E}/${L}`,(H||h)&&(I+="/"+Math.round(10*H)/10),h&&(I+=`/${Math.round(h)}`),this._hashName){let _=this._hashName,F=!1,R=window.location.hash.slice(1).split("&").map(Z=>{let N=Z.split("=")[0];return N===_?(F=!0,`${N}=${I}`):Z}).filter(Z=>Z);return F||R.push(`${_}=${I}`),`#${R.join("&")}`}return`#${I}`}}let fn={linearity:.3,easing:o.b6(0,0,.3,1)},Ha=o.e({deceleration:2500,maxSpeed:1400},fn),vA=o.e({deceleration:20,maxSpeed:1400},fn),ta=o.e({deceleration:1e3,maxSpeed:360},fn),Ms=o.e({deceleration:1e3,maxSpeed:90},fn);class To{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:v.now(),settings:n})}_drainInertiaBuffer(){let n=this._inertiaBuffer,c=v.now();for(;n.length>0&&c-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let c={zoom:0,bearing:0,pitch:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:b}of this._inertiaBuffer)c.zoom+=b.zoomDelta||0,c.bearing+=b.bearingDelta||0,c.pitch+=b.pitchDelta||0,b.panDelta&&c.pan._add(b.panDelta),b.around&&(c.around=b.around),b.pinchAround&&(c.pinchAround=b.pinchAround);let p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(c.pan.mag()){let b=Qo(c.pan.mag(),p,o.e({},Ha,n||{}));f.offset=c.pan.mult(b.amount/c.pan.mag()),f.center=this._map.transform.center,so(f,b)}if(c.zoom){let b=Qo(c.zoom,p,vA);f.zoom=this._map.transform.zoom+b.amount,so(f,b)}if(c.bearing){let b=Qo(c.bearing,p,ta);f.bearing=this._map.transform.bearing+o.ac(b.amount,-179,179),so(f,b)}if(c.pitch){let b=Qo(c.pitch,p,Ms);f.pitch=this._map.transform.pitch+b.amount,so(f,b)}if(f.zoom||f.bearing){let b=c.pinchAround===void 0?c.around:c.pinchAround;f.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),o.e(f,{noMoveStart:!0})}}function so(y,n){(!y.duration||y.duration<n.duration)&&(y.duration=n.duration,y.easing=n.easing)}function Qo(y,n,c){let{maxSpeed:p,linearity:f,deceleration:b}=c,L=o.ac(y*f/(n/1e3),-p,p),E=Math.abs(L)/(b*f);return{easing:c.easing,duration:1e3*E,amount:L*(E/2)}}class Jr extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,p,f={}){let b=x.mousePos(c.getCanvas(),p),L=c.unproject(b);super(n,o.e({point:b,lngLat:L,originalEvent:p},f)),this._defaultPrevented=!1,this.target=c}}class xs extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,p){let f=n==="touchend"?p.changedTouches:p.touches,b=x.touchPos(c.getCanvasContainer(),f),L=b.map(H=>c.unproject(H)),E=b.reduce((H,h,I,_)=>H.add(h.div(_.length)),new o.P(0,0));super(n,{points:b,point:E,lngLats:L,lngLat:c.unproject(E),originalEvent:p}),this._defaultPrevented=!1}}class zn extends o.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,p){super(n,{originalEvent:p}),this._defaultPrevented=!1}}class gn{constructor(n,c){this._map=n,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new zn(n.type,this._map,n))}mousedown(n,c){return this._mousedownPos=c,this._firePreventable(new Jr(n.type,this._map,n))}mouseup(n){this._map.fire(new Jr(n.type,this._map,n))}click(n,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||this._map.fire(new Jr(n.type,this._map,n))}dblclick(n){return this._firePreventable(new Jr(n.type,this._map,n))}mouseover(n){this._map.fire(new Jr(n.type,this._map,n))}mouseout(n){this._map.fire(new Jr(n.type,this._map,n))}touchstart(n){return this._firePreventable(new xs(n.type,this._map,n))}touchmove(n){this._map.fire(new xs(n.type,this._map,n))}touchend(n){this._map.fire(new xs(n.type,this._map,n))}touchcancel(n){this._map.fire(new xs(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Uo{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new Jr(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Jr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new Jr(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pr{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.pointLocation(o.P.convert(n),this._map.terrain)}}class kr{constructor(n,c){this._map=n,this._tr=new pr(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,c){this.isEnabled()&&n.shiftKey&&n.button===0&&(x.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(n,c){if(!this._active)return;let p=c;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;let f=this._startPos;this._lastPos=p,this._box||(this._box=x.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));let b=Math.min(f.x,p.x),L=Math.max(f.x,p.x),E=Math.min(f.y,p.y),H=Math.max(f.y,p.y);x.setTransform(this._box,`translate(${b}px,${E}px)`),this._box.style.width=L-b+"px",this._box.style.height=H-E+"px"}mouseupWindow(n,c){if(!this._active||n.button!==0)return;let p=this._startPos,f=c;if(this.reset(),x.suppressClick(),p.x!==f.x||p.y!==f.y)return this._map.fire(new o.k("boxzoomend",{originalEvent:n})),{cameraAnimation:b=>b.fitScreenCoordinates(p,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(x.remove(this._box),this._box=null),x.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,c){return this._map.fire(new o.k(n,{originalEvent:c}))}}function en(y,n){if(y.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${n.length}`);let c={};for(let p=0;p<y.length;p++)c[y[p].identifier]=n[p];return c}class yn{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),p.length===this.numTouches&&(this.centroid=function(f){let b=new o.P(0,0);for(let L of f)b._add(L);return b.div(f.length)}(c),this.touches=en(p,c)))}touchmove(n,c,p){if(this.aborted||!this.centroid)return;let f=en(p,c);for(let b in this.touches){let L=f[b];(!L||L.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(n,c,p){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){let f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class oo{constructor(n){this.singleTap=new yn(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,c,p){this.singleTap.touchstart(n,c,p)}touchmove(n,c,p){this.singleTap.touchmove(n,c,p)}touchend(n,c,p){let f=this.singleTap.touchend(n,c,p);if(f){let b=n.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(f)<30;if(b&&L||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class ea{constructor(n){this._tr=new pr(n),this._zoomIn=new oo({numTouches:1,numTaps:2}),this._zoomOut=new oo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,c,p){this._zoomIn.touchstart(n,c,p),this._zoomOut.touchstart(n,c,p)}touchmove(n,c,p){this._zoomIn.touchmove(n,c,p),this._zoomOut.touchmove(n,c,p)}touchend(n,c,p){let f=this._zoomIn.touchend(n,c,p),b=this._zoomOut.touchend(n,c,p),L=this._tr;return f?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:L.zoom+1,around:L.unproject(f)},{originalEvent:n})}):b?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:L.zoom-1,around:L.unproject(b)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cs{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){let c=this._moveFunction(...n);if(c.bearingDelta||c.pitchDelta||c.around||c.panDelta)return this._active=!0,c}dragStart(n,c){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=c.length?c[0]:c,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,c){if(!this.isEnabled())return;let p=this._lastPoint;if(!p)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);let f=c.length?c[0]:c;return!this._moved&&f.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(p,f))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&x.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let ao={0:1,2:2};class si{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){let c=x.mouseButton(n);this._eventButton=c}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(c,p){let f=ao[p];return c.buttons===void 0||(c.buttons&f)!==f}(n,this._eventButton)}isValidEndEvent(n){return x.mouseButton(n)===this._eventButton}}class Ql{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}let Ca=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=function(n){n.preventDefault()}},Za=({enable:y,clickTolerance:n,bearingDegreesPerPixelMoved:c=.8})=>{let p=new si({checkCorrectEvent:f=>x.mouseButton(f)===0&&f.ctrlKey||x.mouseButton(f)===2});return new cs({clickTolerance:n,move:(f,b)=>({bearingDelta:(b.x-f.x)*c}),moveStateManager:p,enable:y,assignEvents:Ca})},Ul=({enable:y,clickTolerance:n,pitchDegreesPerPixelMoved:c=-.5})=>{let p=new si({checkCorrectEvent:f=>x.mouseButton(f)===0&&f.ctrlKey||x.mouseButton(f)===2});return new cs({clickTolerance:n,move:(f,b)=>({pitchDelta:(b.y-f.y)*c}),moveStateManager:p,enable:y,assignEvents:Ca})};class ei{constructor(n,c){this._clickTolerance=n.clickTolerance||1,this._map=c,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(n,c,p){return this._calculateTransform(n,c,p)}touchmove(n,c,p){if(this._active&&!(p.length<this.minTouchs()))return n.preventDefault(),this._calculateTransform(n,c,p)}touchend(n,c,p){this._calculateTransform(n,c,p),this._active&&p.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,c,p){p.length>0&&(this._active=!0);let f=en(p,c),b=new o.P(0,0),L=new o.P(0,0),E=0;for(let h in f){let I=f[h],_=this._touches[h];_&&(b._add(I),L._add(I.sub(_)),E++,f[h]=I)}if(this._touches=f,E<this.minTouchs()||!L.mag())return;let H=L.div(E);return this._sum._add(H),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(E),panDelta:H}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(n,c,p){if(!this._firstTwoTouches)return;n.preventDefault();let[f,b]=this._firstTwoTouches,L=Ma(p,c,f),E=Ma(p,c,b);if(!L||!E)return;let H=this._aroundCenter?null:L.add(E).div(2);return this._move([L,E],H,n)}touchend(n,c,p){if(!this._firstTwoTouches)return;let[f,b]=this._firstTwoTouches,L=Ma(p,c,f),E=Ma(p,c,b);L&&E||(this._active&&x.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ma(y,n,c){for(let p=0;p<y.length;p++)if(y[p].identifier===c)return n[p]}function us(y,n){return Math.log(y/n)/Math.LN2}class rs extends Pa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,c){let p=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(us(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:us(this._distance,p),pinchAround:c}}}function wA(y,n){return 180*y.angleWith(n)/Math.PI}class BA extends Pa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,c,p){let f=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:wA(this._vector,f),pinchAround:c}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());let c=25/(Math.PI*this._minDiameter)*360,p=wA(n,this._startVector);return Math.abs(p)<c}}function Gl(y){return Math.abs(y.y)>Math.abs(y.x)}class ol extends Pa{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,c,p){super.touchstart(n,c,p),this._currentTouchCount=p.length}_start(n){this._lastPoints=n,Gl(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,c,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let f=n[0].sub(this._lastPoints[0]),b=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,b,p.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(f.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(n,c,p){if(this._valid!==void 0)return this._valid;let f=n.mag()>=2,b=c.mag()>=2;if(!f&&!b)return;if(!f||!b)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;let L=n.y>0==c.y>0;return Gl(n)&&Gl(c)&&L}}let Go={panStep:100,bearingStep:15,pitchStep:10};class Hr{constructor(n){this._tr=new pr(n);let c=Go;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let c=0,p=0,f=0,b=0,L=0;switch(n.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:n.shiftKey?p=-1:(n.preventDefault(),b=-1);break;case 39:n.shiftKey?p=1:(n.preventDefault(),b=1);break;case 38:n.shiftKey?f=1:(n.preventDefault(),L=-1);break;case 40:n.shiftKey?f=-1:(n.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(p=0,f=0),{cameraAnimation:E=>{let H=this._tr;E.easeTo({duration:300,easeId:"keyboardHandler",easing:al,zoom:c?Math.round(H.zoom)+c*(n.shiftKey?2:1):H.zoom,bearing:H.bearing+p*this._bearingStep,pitch:H.pitch+f*this._pitchStep,offset:[-b*this._panStep,-L*this._panStep],center:H.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function al(y){return y*(2-y)}let _A=4.000244140625;class Al{constructor(n,c){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=n,this._tr=new pr(n),this._triggerRenderFrame=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(n){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!n[this._map.cooperativeGestures._bypassKey])return;let c=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,p=v.now(),f=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,c!==0&&c%_A==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(f*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),n.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=n,this._delta-=c,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let c=x.mousePos(this._map.getCanvas(),n),p=this._tr;this._around=c.y>p.transform.height/2-p.transform.getHorizon()?o.M.convert(this._aroundCenter?p.center:p.unproject(c)):o.M.convert(p.center),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let n=this._tr.transform;if(this._delta!==0){let E=this._type==="wheel"&&Math.abs(this._delta)>_A?this._wheelZoomRate:this._defaultZoomRate,H=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&H!==0&&(H=1/H);let h=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(h*H))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let c=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,p=this._startZoom,f=this._easing,b,L=!1;if(this._type==="wheel"&&p&&f){let E=Math.min((v.now()-this._lastWheelEventTime)/200,1),H=f(E);b=o.z.number(p,c,H),E<1?this._frameId||(this._frameId=!0):L=!0}else b=c,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:b-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let c=o.b7;if(this._prevEase){let p=this._prevEase,f=(v.now()-p.start)/p.duration,b=p.easing(f+.01)-p.easing(f),L=.27/Math.sqrt(b*b+1e-4)*.01,E=Math.sqrt(.0729-L*L);c=o.b6(L,E,.25,1)}return this._prevEase={start:v.now(),duration:n,easing:c},c}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class xA{constructor(n,c){this._clickZoom=n,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Rl{constructor(n){this._tr=new pr(n),this.reset()}reset(){this._active=!1}dblclick(n,c){return n.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(c)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dh{constructor(){this._tap=new oo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,c,p){if(!this._swipePoint)if(this._tapTime){let f=c[0],b=n.timeStamp-this._tapTime<500,L=this._tapPoint.dist(f)<30;b&&L?p.length>0&&(this._swipePoint=f,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(n,c,p)}touchmove(n,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;let f=c[0],b=f.y-this._swipePoint.y;return this._swipePoint=f,n.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(n,c,p)}touchend(n,c,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{let f=this._tap.touchend(n,c,p);f&&(this._tapTime=n.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ao{constructor(n,c,p){this._el=n,this._mousePan=c,this._touchPan=p}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class SA{constructor(n,c,p){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class wi{constructor(n,c,p,f){this._el=n,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Hi{constructor(n,c){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=c,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=x.create("div","maplibregl-cooperative-gesture-screen",n);let c=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(c=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=c,this._container.appendChild(f);let b=document.createElement("div");b.className="maplibregl-mobile-message",b.textContent=p,this._container.appendChild(b),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(x.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(n){this._onCooperativeGesture(n.touches.length===1)}wheel(n){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!n[this._bypassKey])}_onCooperativeGesture(n){this._enabled&&n&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}let Na=y=>y.zoom||y.drag||y.pitch||y.rotate;class wc extends o.k{}function ll(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class Jn{constructor(n,c){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,b)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let L=f.type==="renderFrame"?void 0:f,E={needsRenderFrame:!1},H={},h={},I=f.touches,_=I?this._getMapTouches(I):void 0,F=_?x.touchPos(this._map.getCanvas(),_):x.mousePos(this._map.getCanvas(),f);for(let{handlerName:N,handler:P,allowed:V}of this._handlers){if(!P.isEnabled())continue;let X;this._blockedByActive(h,V,N)?P.reset():P[b||f.type]&&(X=P[b||f.type](f,F,_),this.mergeHandlerResult(E,H,X,N,L),X&&X.needsRenderFrame&&this._triggerRenderFrame()),(X||P.isActive())&&(h[N]=P)}let R={};for(let N in this._previousActiveHandlers)h[N]||(R[N]=L);this._previousActiveHandlers=h,(Object.keys(R).length||ll(E))&&(this._changes.push([E,H,R]),this._triggerRenderFrame()),(Object.keys(h).length||ll(E))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:Z}=E;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new To(n),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(c);let p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(let[f,b,L]of this._listeners)x.addEventListener(f,b,f===document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(let[n,c,p]of this._listeners)x.removeEventListener(n,c,n===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(n){let c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new gn(c,n));let f=c.boxZoom=new kr(c,n);this._add("boxZoom",f),n.interactive&&n.boxZoom&&f.enable();let b=c.cooperativeGestures=new Hi(c,n.cooperativeGestures);this._add("cooperativeGestures",b),n.cooperativeGestures&&b.enable();let L=new ea(c),E=new Rl(c);c.doubleClickZoom=new xA(E,L),this._add("tapZoom",L),this._add("clickZoom",E),n.interactive&&n.doubleClickZoom&&c.doubleClickZoom.enable();let H=new dh;this._add("tapDragZoom",H);let h=c.touchPitch=new ol(c);this._add("touchPitch",h),n.interactive&&n.touchPitch&&c.touchPitch.enable(n.touchPitch);let I=Za(n),_=Ul(n);c.dragRotate=new SA(n,I,_),this._add("mouseRotate",I,["mousePitch"]),this._add("mousePitch",_,["mouseRotate"]),n.interactive&&n.dragRotate&&c.dragRotate.enable();let F=(({enable:X,clickTolerance:J})=>{let ot=new si({checkCorrectEvent:dt=>x.mouseButton(dt)===0&&!dt.ctrlKey});return new cs({clickTolerance:J,move:(dt,ut)=>({around:ut,panDelta:ut.sub(dt)}),activateOnStart:!0,moveStateManager:ot,enable:X,assignEvents:Ca})})(n),R=new ei(n,c);c.dragPan=new Ao(p,F,R),this._add("mousePan",F),this._add("touchPan",R,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&c.dragPan.enable(n.dragPan);let Z=new BA,N=new rs;c.touchZoomRotate=new wi(p,N,Z,H),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",N,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&c.touchZoomRotate.enable(n.touchZoomRotate);let P=c.scrollZoom=new Al(c,()=>this._triggerRenderFrame());this._add("scrollZoom",P,["mousePan"]),n.interactive&&n.scrollZoom&&c.scrollZoom.enable(n.scrollZoom);let V=c.keyboard=new Hr(c);this._add("keyboard",V),n.interactive&&n.keyboard&&c.keyboard.enable(),this._add("blockableMapEvent",new Uo(c))}_add(n,c,p){this._handlers.push({handlerName:n,handler:c,allowed:p}),this._handlersById[n]=c}stop(n){if(!this._updatingCamera){for(let{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(let{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Na(this._eventsInProgress))||this.isZooming()}_blockedByActive(n,c,p){for(let f in n)if(f!==p&&(!c||c.indexOf(f)<0))return!0;return!1}_getMapTouches(n){let c=[];for(let p of n)this._el.contains(p.target)&&c.push(p);return c}mergeHandlerResult(n,c,p,f,b){if(!p)return;o.e(n,p);let L={handlerName:f,originalEvent:p.originalEvent||b};p.zoomDelta!==void 0&&(c.zoom=L),p.panDelta!==void 0&&(c.drag=L),p.pitchDelta!==void 0&&(c.pitch=L),p.bearingDelta!==void 0&&(c.rotate=L)}_applyChanges(){let n={},c={},p={};for(let[f,b,L]of this._changes)f.panDelta&&(n.panDelta=(n.panDelta||new o.P(0,0))._add(f.panDelta)),f.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(n.around=f.around),f.pinchAround!==void 0&&(n.pinchAround=f.pinchAround),f.noInertia&&(n.noInertia=f.noInertia),o.e(c,b),o.e(p,L);this._updateMapTransform(n,c,p),this._changes=[]}_updateMapTransform(n,c,p){let f=this._map,b=f._getTransformForUpdate(),L=f.terrain;if(!(ll(n)||L&&this._terrainMovement))return this._fireEvents(c,p,!0);let{panDelta:E,zoomDelta:H,bearingDelta:h,pitchDelta:I,around:_,pinchAround:F}=n;F!==void 0&&(_=F),f._stop(!0),_=_||f.transform.centerPoint;let R=b.pointLocation(E?_.sub(E):_);h&&(b.bearing+=h),I&&(b.pitch+=I),H&&(b.zoom+=H),L?this._terrainMovement||!c.drag&&!c.zoom?c.drag&&this._terrainMovement?b.center=b.pointLocation(b.centerPoint.sub(E)):b.setLocationAtPoint(R,_):(this._terrainMovement=!0,this._map._elevationFreeze=!0,b.setLocationAtPoint(R,_),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,b.recalculateZoom(f.terrain)})):b.setLocationAtPoint(R,_),f._applyUpdatedTransform(b),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(c,p,!0)}_fireEvents(n,c,p){let f=Na(this._eventsInProgress),b=Na(n),L={};for(let I in n){let{originalEvent:_}=n[I];this._eventsInProgress[I]||(L[`${I}start`]=_),this._eventsInProgress[I]=n[I]}!f&&b&&this._fireEvent("movestart",b.originalEvent);for(let I in L)this._fireEvent(I,L[I]);b&&this._fireEvent("move",b.originalEvent);for(let I in n){let{originalEvent:_}=n[I];this._fireEvent(I,_)}let E={},H;for(let I in this._eventsInProgress){let{handlerName:_,originalEvent:F}=this._eventsInProgress[I];this._handlersById[_].isActive()||(delete this._eventsInProgress[I],H=c[_]||F,E[`${I}end`]=H)}for(let I in E)this._fireEvent(I,E[I]);let h=Na(this._eventsInProgress);if(p&&(f||b)&&!h){this._updatingCamera=!0;let I=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;!I||!I.essential&&v.prefersReducedMotion?(this._map.fire(new o.k("moveend",{originalEvent:H})),_(this._map.getBearing())&&this._map.resetNorth()):(_(I.bearing||this._map.getBearing())&&(I.bearing=0),I.freezeElevation=!0,this._map.easeTo(I,{originalEvent:H})),this._updatingCamera=!1}}_fireEvent(n,c){this._map.fire(new o.k(n,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new wc("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Hl extends o.E{constructor(n,c){super(),this._renderFrameCallback=()=>{let p=Math.min((v.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=c.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new o.M(this.transform.center.lng,this.transform.center.lat)}setCenter(n,c){return this.jumpTo({center:n},c)}panBy(n,c,p){return n=o.P.convert(n).mult(-1),this.panTo(this.transform.center,o.e({offset:n},c),p)}panTo(n,c,p){return this.easeTo(o.e({center:n},c),p)}getZoom(){return this.transform.zoom}setZoom(n,c){return this.jumpTo({zoom:n},c),this}zoomTo(n,c,p){return this.easeTo(o.e({zoom:n},c),p)}zoomIn(n,c){return this.zoomTo(this.getZoom()+1,n,c),this}zoomOut(n,c){return this.zoomTo(this.getZoom()-1,n,c),this}getBearing(){return this.transform.bearing}setBearing(n,c){return this.jumpTo({bearing:n},c),this}getPadding(){return this.transform.padding}setPadding(n,c){return this.jumpTo({padding:n},c),this}rotateTo(n,c,p){return this.easeTo(o.e({bearing:n},c),p)}resetNorth(n,c){return this.rotateTo(0,o.e({duration:1e3},n),c),this}resetNorthPitch(n,c){return this.easeTo(o.e({bearing:0,pitch:0,duration:1e3},n),c),this}snapToNorth(n,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,c):this}getPitch(){return this.transform.pitch}setPitch(n,c){return this.jumpTo({pitch:n},c),this}cameraForBounds(n,c){n=Me.convert(n);let p=c&&c.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),p,c)}_cameraForBoxAndBearing(n,c,p,f){let b={top:0,bottom:0,right:0,left:0};if(typeof(f=o.e({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){let ee=f.padding;f.padding={top:ee,bottom:ee,right:ee,left:ee}}f.padding=o.e(b,f.padding);let L=this.transform,E=L.padding,H=new Me(n,c),h=L.project(H.getNorthWest()),I=L.project(H.getNorthEast()),_=L.project(H.getSouthEast()),F=L.project(H.getSouthWest()),R=o.b8(-p),Z=h.rotate(R),N=I.rotate(R),P=_.rotate(R),V=F.rotate(R),X=new o.P(Math.max(Z.x,N.x,V.x,P.x),Math.max(Z.y,N.y,V.y,P.y)),J=new o.P(Math.min(Z.x,N.x,V.x,P.x),Math.min(Z.y,N.y,V.y,P.y)),ot=X.sub(J),dt=(L.width-(E.left+E.right+f.padding.left+f.padding.right))/ot.x,ut=(L.height-(E.top+E.bottom+f.padding.top+f.padding.bottom))/ot.y;if(ut<0||dt<0)return void o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");let Gt=Math.min(L.scaleZoom(L.scale*Math.min(dt,ut)),f.maxZoom),Pt=o.P.convert(f.offset),gt=new o.P((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(o.b8(p)),Ct=Pt.add(gt).mult(L.scale/L.zoomScale(Gt));return{center:L.unproject(h.add(_).div(2).sub(Ct)),zoom:Gt,bearing:p}}fitBounds(n,c,p){return this._fitInternal(this.cameraForBounds(n,c),c,p)}fitScreenCoordinates(n,c,p,f,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.P.convert(n)),this.transform.pointLocation(o.P.convert(c)),p,f),f,b)}_fitInternal(n,c,p){return n?(delete(c=o.e(n,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(n,c){this.stop();let p=this._getTransformForUpdate(),f=!1,b=!1,L=!1;return"zoom"in n&&p.zoom!==+n.zoom&&(f=!0,p.zoom=+n.zoom),n.center!==void 0&&(p.center=o.M.convert(n.center)),"bearing"in n&&p.bearing!==+n.bearing&&(b=!0,p.bearing=+n.bearing),"pitch"in n&&p.pitch!==+n.pitch&&(L=!0,p.pitch=+n.pitch),n.padding==null||p.isPaddingEqual(n.padding)||(p.padding=n.padding),this._applyUpdatedTransform(p),this.fire(new o.k("movestart",c)).fire(new o.k("move",c)),f&&this.fire(new o.k("zoomstart",c)).fire(new o.k("zoom",c)).fire(new o.k("zoomend",c)),b&&this.fire(new o.k("rotatestart",c)).fire(new o.k("rotate",c)).fire(new o.k("rotateend",c)),L&&this.fire(new o.k("pitchstart",c)).fire(new o.k("pitch",c)).fire(new o.k("pitchend",c)),this.fire(new o.k("moveend",c))}calculateCameraOptionsFromTo(n,c,p,f=0){let b=o.Y.fromLngLat(n,c),L=o.Y.fromLngLat(p,f),E=L.x-b.x,H=L.y-b.y,h=L.z-b.z,I=Math.hypot(E,H,h);if(I===0)throw new Error("Can't calculate camera options with same From and To");let _=Math.hypot(E,H),F=this.transform.scaleZoom(this.transform.cameraToCenterDistance/I/this.transform.tileSize),R=180*Math.atan2(E,-H)/Math.PI,Z=180*Math.acos(_/I)/Math.PI;return Z=h<0?90-Z:90+Z,{center:L.toLngLat(),zoom:F,pitch:Z,bearing:R}}easeTo(n,c){var p;this._stop(!1,n.easeId),((n=o.e({offset:[0,0],duration:500,easing:o.b7},n)).animate===!1||!n.essential&&v.prefersReducedMotion)&&(n.duration=0);let f=this._getTransformForUpdate(),b=this.getZoom(),L=this.getBearing(),E=this.getPitch(),H=this.getPadding(),h="bearing"in n?this._normalizeBearing(n.bearing,L):L,I="pitch"in n?+n.pitch:E,_="padding"in n?n.padding:f.padding,F=o.P.convert(n.offset),R=f.centerPoint.add(F),Z=f.pointLocation(R),{center:N,zoom:P}=f.getConstrained(o.M.convert(n.center||Z),(p=n.zoom)!==null&&p!==void 0?p:b);this._normalizeCenter(N);let V=f.project(Z),X=f.project(N).sub(V),J=f.zoomScale(P-b),ot,dt;n.around&&(ot=o.M.convert(n.around),dt=f.locationPoint(ot));let ut={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||P!==b,this._rotating=this._rotating||L!==h,this._pitching=this._pitching||I!==E,this._padding=!f.isPaddingEqual(_),this._easeId=n.easeId,this._prepareEase(c,n.noMoveStart,ut),this.terrain&&this._prepareElevation(N),this._ease(Gt=>{if(this._zooming&&(f.zoom=o.z.number(b,P,Gt)),this._rotating&&(f.bearing=o.z.number(L,h,Gt)),this._pitching&&(f.pitch=o.z.number(E,I,Gt)),this._padding&&(f.interpolatePadding(H,_,Gt),R=f.centerPoint.add(F)),this.terrain&&!n.freezeElevation&&this._updateElevation(Gt),ot)f.setLocationAtPoint(ot,dt);else{let Pt=f.zoomScale(f.zoom-b),gt=P>b?Math.min(2,J):Math.max(.5,J),Ct=Math.pow(gt,1-Gt),ee=f.unproject(V.add(X.mult(Gt*Ct)).mult(Pt));f.setLocationAtPoint(f.renderWorldCopies?ee.wrap():ee,R)}this._applyUpdatedTransform(f),this._fireMoveEvents(c)},Gt=>{this.terrain&&this._finalizeElevation(),this._afterEase(c,Gt)},n),this}_prepareEase(n,c,p={}){this._moving=!0,c||p.moving||this.fire(new o.k("movestart",n)),this._zooming&&!p.zooming&&this.fire(new o.k("zoomstart",n)),this._rotating&&!p.rotating&&this.fire(new o.k("rotatestart",n)),this._pitching&&!p.pitching&&this.fire(new o.k("pitchstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let c=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&c!==this._elevationTarget){let p=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(p-(c-(p*n+this._elevationStart))/(1-n)),this._elevationTarget=c}this.transform.elevation=o.z.number(this._elevationStart,this._elevationTarget,n)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(n){if(!this.transformCameraUpdate)return;let c=n.clone(),{center:p,zoom:f,pitch:b,bearing:L,elevation:E}=this.transformCameraUpdate(c);p&&(c.center=p),f!==void 0&&(c.zoom=f),b!==void 0&&(c.pitch=b),L!==void 0&&(c.bearing=L),E!==void 0&&(c.elevation=E),this.transform.apply(c)}_fireMoveEvents(n){this.fire(new o.k("move",n)),this._zooming&&this.fire(new o.k("zoom",n)),this._rotating&&this.fire(new o.k("rotate",n)),this._pitching&&this.fire(new o.k("pitch",n))}_afterEase(n,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId;let p=this._zooming,f=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new o.k("zoomend",n)),f&&this.fire(new o.k("rotateend",n)),b&&this.fire(new o.k("pitchend",n)),this.fire(new o.k("moveend",n))}flyTo(n,c){var p;if(!n.essential&&v.prefersReducedMotion){let Ye=o.L(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ye,c)}this.stop(),n=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.b7},n);let f=this._getTransformForUpdate(),b=this.getZoom(),L=this.getBearing(),E=this.getPitch(),H=this.getPadding(),h="bearing"in n?this._normalizeBearing(n.bearing,L):L,I="pitch"in n?+n.pitch:E,_="padding"in n?n.padding:f.padding,F=o.P.convert(n.offset),R=f.centerPoint.add(F),Z=f.pointLocation(R),{center:N,zoom:P}=f.getConstrained(o.M.convert(n.center||Z),(p=n.zoom)!==null&&p!==void 0?p:b);this._normalizeCenter(N);let V=f.zoomScale(P-b),X=f.project(Z),J=f.project(N).sub(X),ot=n.curve,dt=Math.max(f.width,f.height),ut=dt/V,Gt=J.mag();if("minZoom"in n){let Ye=o.ac(Math.min(n.minZoom,b,P),f.minZoom,f.maxZoom),xe=dt/f.zoomScale(Ye-b);ot=Math.sqrt(xe/Gt*2)}let Pt=ot*ot;function gt(Ye){let xe=(ut*ut-dt*dt+(Ye?-1:1)*Pt*Pt*Gt*Gt)/(2*(Ye?ut:dt)*Pt*Gt);return Math.log(Math.sqrt(xe*xe+1)-xe)}function Ct(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function ee(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}let ge=gt(!1),jt=function(Ye){return ee(ge)/ee(ge+ot*Ye)},Fe=function(Ye){return dt*((ee(ge)*(Ct(xe=ge+ot*Ye)/ee(xe))-Ct(ge))/Pt)/Gt;var xe},ke=(gt(!0)-ge)/ot;if(Math.abs(Gt)<1e-6||!isFinite(ke)){if(Math.abs(dt-ut)<1e-6)return this.easeTo(n,c);let Ye=ut<dt?-1:1;ke=Math.abs(Math.log(ut/dt))/ot,Fe=function(){return 0},jt=function(xe){return Math.exp(Ye*ot*xe)}}return n.duration="duration"in n?+n.duration:1e3*ke/("screenSpeed"in n?+n.screenSpeed/ot:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=L!==h,this._pitching=I!==E,this._padding=!f.isPaddingEqual(_),this._prepareEase(c,!1),this.terrain&&this._prepareElevation(N),this._ease(Ye=>{let xe=Ye*ke,ci=1/jt(xe);f.zoom=Ye===1?P:b+f.scaleZoom(ci),this._rotating&&(f.bearing=o.z.number(L,h,Ye)),this._pitching&&(f.pitch=o.z.number(E,I,Ye)),this._padding&&(f.interpolatePadding(H,_,Ye),R=f.centerPoint.add(F)),this.terrain&&!n.freezeElevation&&this._updateElevation(Ye);let pi=Ye===1?N:f.unproject(X.add(J.mult(Fe(xe))).mult(ci));f.setLocationAtPoint(f.renderWorldCopies?pi.wrap():pi,R),this._applyUpdatedTransform(f),this._fireMoveEvents(c)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(c)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,c)}if(!n){let p=this.handlers;p&&p.stop(!1)}return this}_ease(n,c,p){p.animate===!1||p.duration===0?(n(1),c()):(this._easeStart=v.now(),this._easeOptions=p,this._onEaseFrame=n,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,c){n=o.b1(n,-180,180);let p=Math.abs(n-c);return Math.abs(n-360-c)<p&&(n-=360),Math.abs(n+360-c)<p&&(n+=360),n}_normalizeCenter(n){let c=this.transform;if(!c.renderWorldCopies||c.lngRange)return;let p=n.lng-c.center.lng;n.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(o.M.convert(n),this.transform.tileZoom)-this.transform.elevation:null}}let ns={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ou{constructor(n=ns){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=c=>{!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=x.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=x.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=x.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){x.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,c){let p=this._map._getUIString(`AttributionControl.${c}`);n.title=p,n.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){let f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}let c=this._map.style.sourceCaches;for(let f in c){let b=c[f];if(b.used||b.usedForTerrain){let L=b.getSource();L.attribution&&n.indexOf(L.attribution)<0&&n.push(L.attribution)}}n=n.filter(f=>String(f).trim()),n.sort((f,b)=>f.length-b.length),n=n.filter((f,b)=>{for(let L=b+1;L<n.length;L++)if(n[L].indexOf(f)>=0)return!1;return!0});let p=n.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,n.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class FA{constructor(n={}){this._updateCompact=()=>{let c=this._container.children;if(c.length){let p=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=x.create("div","maplibregl-ctrl");let c=x.create("a","maplibregl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://maplibre.org/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){x.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Xr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){let c=++this._id;return this._queue.push({callback:n,id:c,cancelled:!1}),c}remove(n){let c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(let f of p)if(f.id===n)return void(f.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let c=this._currentlyRunning=this._queue;this._queue=[];for(let p of c)if(!p.cancelled&&(p.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var dn=o.X([{name:"a_pos3d",type:"Int16",components:3}]);class au extends o.E{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,c){this.sourceCache.update(n,c),this._renderableTilesKeys=[];let p={};for(let f of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:c}))p[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.posMatrix=new Float64Array(16),o.aN(f.posMatrix,0,o.W,0,o.W,0,1),this._tiles[f.key]=new mi(f,this.tileSize));for(let f in this._tiles)p[f]||delete this._tiles[f]}freeRtt(n){for(let c in this._tiles){let p=this._tiles[c];(!n||p.tileID.equals(n)||p.tileID.isChildOf(n)||n.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){let c={};for(let p of this._renderableTilesKeys){let f=this._tiles[p].tileID;if(f.canonical.equals(n.canonical)){let b=n.clone();b.posMatrix=new Float64Array(16),o.aN(b.posMatrix,0,o.W,0,o.W,0,1),c[p]=b}else if(f.canonical.isChildOf(n.canonical)){let b=n.clone();b.posMatrix=new Float64Array(16);let L=f.canonical.z-n.canonical.z,E=f.canonical.x-(f.canonical.x>>L<<L),H=f.canonical.y-(f.canonical.y>>L<<L),h=o.W>>L;o.aN(b.posMatrix,0,h,0,h,0,1),o.H(b.posMatrix,b.posMatrix,[-E*h,-H*h,0]),c[p]=b}else if(n.canonical.isChildOf(f.canonical)){let b=n.clone();b.posMatrix=new Float64Array(16);let L=n.canonical.z-f.canonical.z,E=n.canonical.x-(n.canonical.x>>L<<L),H=n.canonical.y-(n.canonical.y>>L<<L),h=o.W>>L;o.aN(b.posMatrix,0,o.W,0,o.W,0,1),o.H(b.posMatrix,b.posMatrix,[E*h,H*h,0]),o.J(b.posMatrix,b.posMatrix,[1/2**L,1/2**L,0]),c[p]=b}}return c}getSourceTile(n,c){let p=this.sourceCache._source,f=n.overscaledZ-this.deltaZoom;if(f>p.maxzoom&&(f=p.maxzoom),f<p.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(f).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!b||!b.dem)&&c)for(;f>=p.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(n.scaledTo(f--).key);return b}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(c=>c.timeAdded>=n)}}class cl{constructor(n,c,p){this.painter=n,this.sourceCache=new au(c),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,c,p,f=o.W){var b;if(!(c>=0&&c<f&&p>=0&&p<f))return 0;let L=this.getTerrainData(n),E=(b=L.tile)===null||b===void 0?void 0:b.dem;if(!E)return 0;let H=function(Z,N,P){var V=N[0],X=N[1];return Z[0]=P[0]*V+P[4]*X+P[12],Z[1]=P[1]*V+P[5]*X+P[13],Z}([],[c/f*o.W,p/f*o.W],L.u_terrain_matrix),h=[H[0]*E.dim,H[1]*E.dim],I=Math.floor(h[0]),_=Math.floor(h[1]),F=h[0]-I,R=h[1]-_;return E.get(I,_)*(1-F)*(1-R)+E.get(I+1,_)*F*(1-R)+E.get(I,_+1)*(1-F)*R+E.get(I+1,_+1)*F*R}getElevationForLngLatZoom(n,c){let{tileID:p,mercatorX:f,mercatorY:b}=this._getOverscaledTileIDFromLngLatZoom(n,c);return this.getElevation(p,f%o.W,b%o.W,o.W)}getElevation(n,c,p,f=o.W){return this.getDEMElevation(n,c,p,f)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){let f=this.painter.context,b=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new qt(f,b,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new qt(f,new o.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.an([])}let c=this.sourceCache.getSourceTile(n,!0);if(c&&c.dem&&(!c.demTexture||c.needsTerrainPrepare)){let f=this.painter.context;c.demTexture=this.painter.getTileTexture(c.dem.stride),c.demTexture?c.demTexture.update(c.dem.getPixels(),{premultiply:!1}):c.demTexture=new qt(f,c.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),c.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),c.needsTerrainPrepare=!1}let p=c&&c+c.tileID.key+n.key;if(p&&!this._demMatrixCache[p]){let f=this.sourceCache.sourceCache._source.maxzoom,b=n.canonical.z-c.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=f?b=n.canonical.z-f:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let L=n.canonical.x-(n.canonical.x>>b<<b),E=n.canonical.y-(n.canonical.y>>b<<b),H=o.b9(new Float64Array(16),[1/(o.W<<b),1/(o.W<<b),0]);o.H(H,H,[L*o.W,E*o.W,0]),this._demMatrixCache[n.key]={matrix:H,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:c&&c.dem&&c.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:c&&c.dem&&c.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(c&&c.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:c}}getFramebuffer(n){let c=this.painter,p=c.width/devicePixelRatio,f=c.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new qt(c.context,{width:p,height:f,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new qt(c.context,{width:p,height:f,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=c.context.createFramebuffer(p,f,!0,!1),this._fbo.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,p,f))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let c=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,L=0;b<this._coordsTextureSize;b++)for(let E=0;E<this._coordsTextureSize;E++,L+=4)c[L+0]=255&E,c[L+1]=255&b,c[L+2]=E>>8<<4|b>>8,c[L+3]=0;let p=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(c.buffer)),f=new qt(n,p,n.gl.RGBA,{premultiply:!1});return f.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);let c=new Uint8Array(4),p=this.painter.context,f=p.gl;p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,c),p.bindFramebuffer.set(null);let b=c[0]+(c[2]>>4<<8),L=c[1]+((15&c[2])<<8),E=this.coordsIndex[255-c[3]],H=E&&this.sourceCache.getTileByID(E);if(!H)return null;let h=this._coordsTextureSize,I=(1<<H.tileID.canonical.z)*h;return new o.Y((H.tileID.canonical.x*h+b)/I+H.tileID.wrap,(H.tileID.canonical.y*h+L)/I,this.getElevation(H.tileID,b,L,h))}depthAtPoint(n){let c=new Uint8Array(4),p=this.painter.context,f=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,c),p.bindFramebuffer.set(null),(c[0]/16777216+c[1]/65536+c[2]/256+c[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;let n=this.painter.context,c=new o.ba,p=new o.aX,f=this.meshSize,b=o.W/f,L=f*f;for(let _=0;_<=f;_++)for(let F=0;F<=f;F++)c.emplaceBack(F*b,_*b,0);for(let _=0;_<L;_+=f+1)for(let F=0;F<f;F++)p.emplaceBack(F+_,f+F+_+1,f+F+_+2),p.emplaceBack(F+_,f+F+_+2,F+_+1);let E=c.length,H=E+2*(f+1);for(let _ of[0,1])for(let F=0;F<=f;F++)for(let R of[0,1])c.emplaceBack(F*b,_*o.W,R);for(let _=0;_<2*f;_+=2)p.emplaceBack(H+_,H+_+1,H+_+3),p.emplaceBack(H+_,H+_+3,H+_+2),p.emplaceBack(E+_,E+_+3,E+_+1),p.emplaceBack(E+_,E+_+2,E+_+3);let h=c.length,I=h+2*(f+1);for(let _ of[0,1])for(let F=0;F<=f;F++)for(let R of[0,1])c.emplaceBack(_*o.W,F*b,R);for(let _=0;_<2*f;_+=2)p.emplaceBack(h+_,h+_+1,h+_+3),p.emplaceBack(h+_,h+_+3,h+_+2),p.emplaceBack(I+_,I+_+3,I+_+1),p.emplaceBack(I+_,I+_+2,I+_+3);return this._mesh={indexBuffer:n.createIndexBuffer(p),vertexBuffer:n.createVertexBuffer(c,dn.members),segments:o.$.simpleSegment(0,0,c.length,p.length)},this._mesh}getMeshFrameDelta(n){return 2*Math.PI*o.bb/Math.pow(2,n)/5}getMinTileElevationForLngLatZoom(n,c){var p;let{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(n,c);return(p=this.getMinMaxElevation(f).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(n){let c=this.getTerrainData(n).tile,p={minElevation:null,maxElevation:null};return c&&c.dem&&(p.minElevation=c.dem.min*this.exaggeration,p.maxElevation=c.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(n,c){let p=o.Y.fromLngLat(n.wrap()),f=(1<<c)*o.W,b=p.x*f,L=p.y*f,E=Math.floor(b/o.W),H=Math.floor(L/o.W);return{tileID:new o.Q(c,0,c,E,H),mercatorX:b,mercatorY:L}}}class Zl{constructor(n,c,p){this._context=n,this._size=c,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){let c=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new qt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),c.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),c.colorAttachment.set(p.texture),{id:n,fbo:c,texture:p,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(c=>n.id!==c),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(let c of this._recentlyUsed)if(!this._objects[c].inUse)return this._objects[c];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(let n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}let ss={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ss{constructor(n,c){this.painter=n,this.terrain=c,this.pool=new Zl(n.context,30,c.sourceCache.tileSize*c.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,c){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(p=>!n._layers[p].isHidden(c)),this._coordsDescendingInv={};for(let p in n.sourceCaches){this._coordsDescendingInv[p]={};let f=n.sourceCaches[p].getVisibleCoordinates();for(let b of f){let L=this.terrain.sourceCache.getTerrainCoords(b);for(let E in L)this._coordsDescendingInv[p][E]||(this._coordsDescendingInv[p][E]=[]),this._coordsDescendingInv[p][E].push(L[E])}}this._coordsDescendingInvStr={};for(let p of n._order){let f=n._layers[p],b=f.source;if(ss[f.type]&&!this._coordsDescendingInvStr[b]){this._coordsDescendingInvStr[b]={};for(let L in this._coordsDescendingInv[b])this._coordsDescendingInvStr[b][L]=this._coordsDescendingInv[b][L].map(E=>E.key).sort().join()}}for(let p of this._renderableTiles)for(let f in this._coordsDescendingInvStr){let b=this._coordsDescendingInvStr[f][p.tileID.key];b&&b!==p.rttCoords[f]&&(p.rtt=[])}}renderLayer(n){if(n.isHidden(this.painter.transform.zoom))return!1;let c=n.type,p=this.painter,f=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(ss[c]&&(this._prevType&&ss[this._prevType]||this._stacks.push([]),this._prevType=c,this._stacks[this._stacks.length-1].push(n.id),!f))return!0;if(ss[this._prevType]||ss[c]&&f){this._prevType=c;let b=this._stacks.length-1,L=this._stacks[b]||[];for(let E of this._renderableTiles){if(this.pool.isFull()&&(sl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(E),E.rtt[b]){let h=this.pool.getObjectForId(E.rtt[b].id);if(h.stamp===E.rtt[b].stamp){this.pool.useObject(h);continue}}let H=this.pool.getOrCreateFreeObject();this.pool.useObject(H),this.pool.stampObject(H),E.rtt[b]={id:H.id,stamp:H.stamp},p.context.bindFramebuffer.set(H.fbo.framebuffer),p.context.clear({color:o.aO.transparent,stencil:0}),p.currentStencilSource=void 0;for(let h=0;h<L.length;h++){let I=p.style._layers[L[h]],_=I.source?this._coordsDescendingInv[I.source][E.tileID.key]:[E.tileID];p.context.viewport.set([0,0,H.fbo.width,H.fbo.height]),p._renderTileClippingMasks(I,_),p.renderLayer(p,p.style.sourceCaches[I.source],I,_),I.source&&(E.rttCoords[I.source]=this._coordsDescendingInvStr[I.source][E.tileID.key])}}return sl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ss[c]}return!1}}let lo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ul=g,Pl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:ns,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},co=y=>{y.touchstart=y.dragStart,y.touchmoveWindow=y.dragMove,y.touchend=y.dragEnd},hs={showCompass:!0,showZoom:!0,visualizePitch:!1};class Bc{constructor(n,c,p=!1){this.mousedown=L=>{this.startMouse(o.e({},L,{ctrlKey:!0,preventDefault:()=>L.preventDefault()}),x.mousePos(this.element,L)),x.addEventListener(window,"mousemove",this.mousemove),x.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=L=>{this.moveMouse(L,x.mousePos(this.element,L))},this.mouseup=L=>{this.mouseRotate.dragEnd(L),this.mousePitch&&this.mousePitch.dragEnd(L),this.offTemp()},this.touchstart=L=>{L.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=x.touchPos(this.element,L.targetTouches)[0],this.startTouch(L,this._startPos),x.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.addEventListener(window,"touchend",this.touchend))},this.touchmove=L=>{L.targetTouches.length!==1?this.reset():(this._lastPos=x.touchPos(this.element,L.targetTouches)[0],this.moveTouch(L,this._lastPos))},this.touchend=L=>{L.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;let f=n.dragRotate._mouseRotate.getClickTolerance(),b=n.dragRotate._mousePitch.getClickTolerance();this.element=c,this.mouseRotate=Za({clickTolerance:f,enable:!0}),this.touchRotate=(({enable:L,clickTolerance:E,bearingDegreesPerPixelMoved:H=.8})=>{let h=new Ql;return new cs({clickTolerance:E,move:(I,_)=>({bearingDelta:(_.x-I.x)*H}),moveStateManager:h,enable:L,assignEvents:co})})({clickTolerance:f,enable:!0}),this.map=n,p&&(this.mousePitch=Ul({clickTolerance:b,enable:!0}),this.touchPitch=(({enable:L,clickTolerance:E,pitchDegreesPerPixelMoved:H=-.5})=>{let h=new Ql;return new cs({clickTolerance:E,move:(I,_)=>({pitchDelta:(_.y-I.y)*H}),moveStateManager:h,enable:L,assignEvents:co})})({clickTolerance:b,enable:!0})),x.addEventListener(c,"mousedown",this.mousedown),x.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),x.addEventListener(c,"touchcancel",this.reset)}startMouse(n,c){this.mouseRotate.dragStart(n,c),this.mousePitch&&this.mousePitch.dragStart(n,c),x.disableDrag()}startTouch(n,c){this.touchRotate.dragStart(n,c),this.touchPitch&&this.touchPitch.dragStart(n,c),x.disableDrag()}moveMouse(n,c){let p=this.map,{bearingDelta:f}=this.mouseRotate.dragMove(n,c)||{};if(f&&p.setBearing(p.getBearing()+f),this.mousePitch){let{pitchDelta:b}=this.mousePitch.dragMove(n,c)||{};b&&p.setPitch(p.getPitch()+b)}}moveTouch(n,c){let p=this.map,{bearingDelta:f}=this.touchRotate.dragMove(n,c)||{};if(f&&p.setBearing(p.getBearing()+f),this.touchPitch){let{pitchDelta:b}=this.touchPitch.dragMove(n,c)||{};b&&p.setPitch(p.getPitch()+b)}}off(){let n=this.element;x.removeEventListener(n,"mousedown",this.mousedown),x.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend),x.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){x.enableDrag(),x.removeEventListener(window,"mousemove",this.mousemove),x.removeEventListener(window,"mouseup",this.mouseup),x.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),x.removeEventListener(window,"touchend",this.touchend)}}let ia;function hl(y,n,c){let p=new o.M(y.lng,y.lat);if(y=new o.M(y.lng,y.lat),n){let f=new o.M(y.lng-360,y.lat),b=new o.M(y.lng+360,y.lat),L=c.locationPoint(y).distSqr(n);c.locationPoint(f).distSqr(n)<L?y=f:c.locationPoint(b).distSqr(n)<L&&(y=b)}for(;Math.abs(y.lng-c.center.lng)>180;){let f=c.locationPoint(y);if(f.x>=0&&f.y>=0&&f.x<=c.width&&f.y<=c.height)break;y.lng>c.center.lng?y.lng-=360:y.lng+=360}return y.lng!==p.lng&&c.locationPoint(y).y>c.height/2-c.getHorizon()?y:p}let kA={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function gl(y,n,c){let p=y.classList;for(let f in kA)p.remove(`maplibregl-${c}-anchor-${f}`);p.add(`maplibregl-${c}-anchor-${n}`)}class Va extends o.E{constructor(n){if(super(),this._onKeyPress=c=>{let p=c.code,f=c.charCode||c.keyCode;p!=="Space"&&p!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=c=>{let p=c.originalEvent.target,f=this._element;this._popup&&(p===f||f.contains(p))&&this.togglePopup()},this._update=c=>{var p;if(!this._map)return;let f=this._map.loaded()&&!this._map.isMoving();(c?.type==="terrain"||c?.type==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?hl(this._lngLat,this._flatPos,this._map.transform):(p=this._lngLat)===null||p===void 0?void 0:p.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let b="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?b=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(b=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let L="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?L="rotateX(0deg)":this._pitchAlignment==="map"&&(L=`rotateX(${this._map.getPitch()}deg)`),c&&c.type!=="moveend"||(this._pos=this._pos.round()),x.setTransform(this._element,`${kA[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${L} ${b}`),v.frameAsync(new AbortController).then(()=>{this._updateOpacity(c&&c.type==="moveend")}).catch(()=>{})},this._onMove=c=>{if(!this._isDragging){let p=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.k("dragstart"))),this.fire(new o.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.k("dragend")),this._state="inactive"},this._addDragHandler=c=>{this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(n?.opacity,n?.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=o.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=x.create("div"),this._element.setAttribute("aria-label","Map marker");let c=x.createNS("http://www.w3.org/2000/svg","svg"),p=41,f=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${p}px`),c.setAttributeNS(null,"width",`${f}px`),c.setAttributeNS(null,"viewBox",`0 0 ${f} ${p}`);let b=x.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");let L=x.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");let E=x.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(3.0, 29.0)"),E.setAttributeNS(null,"fill","#000000");let H=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let V of H){let X=x.createNS("http://www.w3.org/2000/svg","ellipse");X.setAttributeNS(null,"opacity","0.04"),X.setAttributeNS(null,"cx","10.5"),X.setAttributeNS(null,"cy","5.80029008"),X.setAttributeNS(null,"rx",V.rx),X.setAttributeNS(null,"ry",V.ry),E.appendChild(X)}let h=x.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"fill",this._color);let I=x.createNS("http://www.w3.org/2000/svg","path");I.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),h.appendChild(I);let _=x.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"fill","#000000");let F=x.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),_.appendChild(F);let R=x.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(6.0, 7.0)"),R.setAttributeNS(null,"fill","#FFFFFF");let Z=x.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");let N=x.createNS("http://www.w3.org/2000/svg","circle");N.setAttributeNS(null,"fill","#000000"),N.setAttributeNS(null,"opacity","0.25"),N.setAttributeNS(null,"cx","5.5"),N.setAttributeNS(null,"cy","5.5"),N.setAttributeNS(null,"r","5.4999962");let P=x.createNS("http://www.w3.org/2000/svg","circle");P.setAttributeNS(null,"fill","#FFFFFF"),P.setAttributeNS(null,"cx","5.5"),P.setAttributeNS(null,"cy","5.5"),P.setAttributeNS(null,"r","5.4999962"),Z.appendChild(N),Z.appendChild(P),L.appendChild(E),L.appendChild(h),L.appendChild(_),L.appendChild(R),L.appendChild(Z),c.appendChild(L),c.setAttributeNS(null,"height",p*this._scale+"px"),c.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(c),this._offset=o.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),gl(this._element,this._anchor,"marker"),n&&n.className)for(let c of n.className.split(" "))this._element.classList.add(c);this._popup=null}addTo(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),x.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=o.M.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){let f=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var c,p;if(!(!((c=this._map)===null||c===void 0)&&c.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let f=this._map,b=f.terrain.depthAtPoint(this._pos),L=f.terrain.getElevationForLngLatZoom(this._lngLat,f.transform.tileZoom);if(f.transform.lngLatToCameraDepth(this._lngLat,L)-b<.006)return void(this._element.style.opacity=this._opacity);let E=-this._offset.y/f.transform._pixelPerMeter,H=Math.sin(f.getPitch()*Math.PI/180)*E,h=f.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),I=f.transform.lngLatToCameraDepth(this._lngLat,L+H)-h>.006;((p=this._popup)===null||p===void 0?void 0:p.isOpen())&&I&&this._popup.remove(),this._element.style.opacity=I?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=o.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,c){return n===void 0&&c===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),c!==void 0&&(this._opacityWhenCovered=c),this._map&&this._updateOpacity(!0),this}}let _c={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ra=0,uo=!1,Da={maxWidth:100,unit:"metric"};function LA(y,n,c){let p=c&&c.maxWidth||100,f=y._container.clientHeight/2,b=y.unproject([0,f]),L=y.unproject([p,f]),E=b.distanceTo(L);if(c&&c.unit==="imperial"){let H=3.2808*E;H>5280?Ia(n,p,H/5280,y._getUIString("ScaleControl.Miles")):Ia(n,p,H,y._getUIString("ScaleControl.Feet"))}else c&&c.unit==="nautical"?Ia(n,p,E/1852,y._getUIString("ScaleControl.NauticalMiles")):E>=1e3?Ia(n,p,E/1e3,y._getUIString("ScaleControl.Kilometers")):Ia(n,p,E,y._getUIString("ScaleControl.Meters"))}function Ia(y,n,c,p){let f=function(b){let L=Math.pow(10,`${Math.floor(b)}`.length-1),E=b/L;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:function(H){let h=Math.pow(10,Math.ceil(-Math.log(H)/Math.LN10));return Math.round(H*h)/h}(E),L*E}(c);y.style.width=n*(f/c)+"px",y.innerHTML=`${f}&nbsp;${p}`}let xc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Ml=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Sc(y){if(y){if(typeof y=="number"){let n=Math.round(Math.abs(y)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,y),"top-left":new o.P(n,n),"top-right":new o.P(-n,n),bottom:new o.P(0,-y),"bottom-left":new o.P(n,-n),"bottom-right":new o.P(-n,-n),left:new o.P(y,0),right:new o.P(-y,0)}}if(y instanceof o.P||Array.isArray(y)){let n=o.P.convert(y);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:o.P.convert(y.center||[0,0]),top:o.P.convert(y.top||[0,0]),"top-left":o.P.convert(y["top-left"]||[0,0]),"top-right":o.P.convert(y["top-right"]||[0,0]),bottom:o.P.convert(y.bottom||[0,0]),"bottom-left":o.P.convert(y["bottom-left"]||[0,0]),"bottom-right":o.P.convert(y["bottom-right"]||[0,0]),left:o.P.convert(y.left||[0,0]),right:o.P.convert(y.right||[0,0])}}return Sc(new o.P(0,0))}let Au=g;A.AJAXError=o.be,A.Evented=o.E,A.LngLat=o.M,A.MercatorCoordinate=o.Y,A.Point=o.P,A.addProtocol=o.bf,A.config=o.a,A.removeProtocol=o.bg,A.AttributionControl=ou,A.BoxZoomHandler=kr,A.CanvasSource=ze,A.CooperativeGesturesHandler=Hi,A.DoubleClickZoomHandler=xA,A.DragPanHandler=Ao,A.DragRotateHandler=SA,A.EdgeInsets=is,A.FullscreenControl=class extends o.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var n;let c=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=c?.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)c=c.shadowRoot.fullscreenElement;c===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){x.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let y=this._fullscreenButton=x.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);x.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},A.GeoJSONSource=Ue,A.GeolocateControl=class extends o.E{constructor(y){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new o.k("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.k("geolocate",n)),this._finish()}},this._updateCamera=n=>{let c=new o.M(n.coords.longitude,n.coords.latitude),p=n.coords.accuracy,f=this._map.getBearing(),b=o.e({bearing:f},this.options.fitBoundsOptions),L=Me.fromLngLat(c,p);this._map.fitBounds(L,b,{geolocateSource:!0})},this._updateMarker=n=>{if(n){let c=new o.M(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&uo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.k("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=n=>{if(this._map){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=x.create("button","maplibregl-ctrl-geolocate",this._container),x.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",n===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");let c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{let c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=x.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Va({element:this._dotElement}),this._circleElement=x.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Va({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.k("trackuserlocationend")))})}},this.options=o.e({},_c,y)}onAdd(y){return this._map=y,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return o._(this,arguments,void 0,function*(n=!1){if(ia!==void 0&&!n)return ia;if(window.navigator.permissions===void 0)return ia=!!window.navigator.geolocation,ia;try{ia=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ia=!!window.navigator.geolocation}return ia})}().then(n=>this._setupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),x.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ra=0,uo=!1}_isOutOfMapMaxBounds(y){let n=this._map.getMaxBounds(),c=y.coords;return n&&(c.longitude<n.getWest()||c.longitude>n.getEast()||c.latitude<n.getSouth()||c.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let y=this._map.getBounds(),n=y.getSouthEast(),c=y.getNorthEast(),p=n.distanceTo(c),f=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ra--,uo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ra++,ra>1?(y={maximumAge:6e5,timeout:0},uo=!0):(y=this.options.positionOptions,uo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},A.Hash=ma,A.ImageSource=Ne,A.KeyboardHandler=Hr,A.LngLatBounds=Me,A.LogoControl=FA,A.Map=class extends Hl{constructor(y){if(o.bc.mark(o.bd.create),(y=o.e({},Pl,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new _s(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._contextLost=n=>{n.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.k("webglcontextlost",{originalEvent:n}))},this._contextRestored=n=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.k("webglcontextrestored",{originalEvent:n}))},this._onMapScroll=n=>{if(n.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=y.interactive,this._maxTileCacheSize=y.maxTileCacheSize,this._maxTileCacheZoomLevels=y.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new Xr,this._controls=[],this._mapId=o.a3(),this._locale=o.e({},lo,y.locale),this._clickTolerance=y.clickTolerance,this._overridePixelRatio=y.pixelRatio,this._maxCanvasSize=y.maxCanvasSize,this.transformCameraUpdate=y.transformCameraUpdate,this._imageQueueHandle=O.addThrottleControl(()=>this.isMoving()),this._requestManager=new at(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let n=!1,c=no(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{n?c(p):n=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Jn(this,y),this._hash=y.hash&&new ma(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,o.e({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,this._validateStyle=y.validateStyle,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new ou(typeof y.attributionControl=="boolean"?void 0:y.attributionControl)),y.maplibreLogo&&this.addControl(new FA,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new o.k(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new o.k(`${n.dataType}dataloading`,n))}),this.on("dataabort",n=>{this.fire(new o.k("sourcedataabort",n))})}_getMapId(){return this._mapId}addControl(y,n){if(n===void 0&&(n=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new o.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let c=y.onAdd(this);this._controls.push(y);let p=this._controlPositions[n];return n.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new o.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let n=this._controls.indexOf(y);return n>-1&&this._controls.splice(n,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,n,c,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(c,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,n,c,p)}resize(y){var n;let c=this._containerDimensions(),p=c[0],f=c[1],b=this._getClampedPixelRatio(p,f);if(this._resizeCanvas(p,f,b),this.painter.resize(p,f,b),this.painter.overLimit()){let E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];let H=this._getClampedPixelRatio(p,f);this._resizeCanvas(p,f,H),this.painter.resize(p,f,H)}this.transform.resize(p,f),(n=this._requestedCameraState)===null||n===void 0||n.resize(p,f);let L=!this._moving;return L&&(this.stop(),this.fire(new o.k("movestart",y)).fire(new o.k("move",y))),this.fire(new o.k("resize",y)),L&&this.fire(new o.k("moveend",y)),this}_getClampedPixelRatio(y,n){let{0:c,1:p}=this._maxCanvasSize,f=this.getPixelRatio(),b=y*f,L=n*f;return Math.min(b>c?c/b:1,L>p?p/L:1)*f}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(Me.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(o.M.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.pointLocation(o.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,n,c){if(y==="mouseenter"||y==="mouseover"){let p=!1;return{layer:n,listener:c,delegates:{mousemove:b=>{let L=this.getLayer(n)?this.queryRenderedFeatures(b.point,{layers:[n]}):[];L.length?p||(p=!0,c.call(this,new Jr(y,this,b.originalEvent,{features:L}))):p=!1},mouseout:()=>{p=!1}}}}if(y==="mouseleave"||y==="mouseout"){let p=!1;return{layer:n,listener:c,delegates:{mousemove:L=>{(this.getLayer(n)?this.queryRenderedFeatures(L.point,{layers:[n]}):[]).length?p=!0:p&&(p=!1,c.call(this,new Jr(y,this,L.originalEvent)))},mouseout:L=>{p&&(p=!1,c.call(this,new Jr(y,this,L.originalEvent)))}}}}{let p=f=>{let b=this.getLayer(n)?this.queryRenderedFeatures(f.point,{layers:[n]}):[];b.length&&(f.features=b,c.call(this,f),delete f.features)};return{layer:n,listener:c,delegates:{[y]:p}}}}on(y,n,c){if(c===void 0)return super.on(y,n);let p=this._createDelegatedListener(y,n,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(p);for(let f in p.delegates)this.on(f,p.delegates[f]);return this}once(y,n,c){if(c===void 0)return super.once(y,n);let p=this._createDelegatedListener(y,n,c);for(let f in p.delegates)this.once(f,p.delegates[f]);return this}off(y,n,c){return c===void 0?super.off(y,n):(this._delegatedListeners&&this._delegatedListeners[y]&&(p=>{let f=this._delegatedListeners[y];for(let b=0;b<f.length;b++){let L=f[b];if(L.layer===n&&L.listener===c){for(let E in L.delegates)this.off(E,L.delegates[E]);return f.splice(b,1),this}}})(),this)}queryRenderedFeatures(y,n){if(!this.style)return[];let c,p=y instanceof o.P||Array.isArray(y),f=p?y:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(p?{}:y)||{},f instanceof o.P||typeof f[0]=="number")c=[o.P.convert(f)];else{let b=o.P.convert(f[0]),L=o.P.convert(f[1]);c=[b,new o.P(L.x,b.y),L,new o.P(b.x,L.y),b]}return this.style.queryRenderedFeatures(c,n,this.transform)}querySourceFeatures(y,n){return this.style.querySourceFeatures(y,n)}setStyle(y,n){return(n=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(y,n))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){let n=this._locale[y];if(n==null)throw new Error(`Missing UI string '${y}'`);return n}_updateStyle(y,n){if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,n));let c=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new to(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,n,c):this.style.loadJSON(y,n,c),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new to(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,n){if(typeof y=="string"){let c=this._requestManager.transformRequest(y,tt.Style);o.h(c,new AbortController).then(p=>{this._updateDiff(p.data,n)}).catch(p=>{p&&this.fire(new o.j(p))})}else typeof y=="object"&&this._updateDiff(y,n)}_updateDiff(y,n){try{this.style.setState(y,n)&&this._update(!0)}catch(c){o.w(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(y,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(y,n){return this._lazyInitEmptyStyle(),this.style.addSource(y,n),this._update(!0)}isSourceLoaded(y){let n=this.style&&this.style.sourceCaches[y];if(n!==void 0)return n.loaded();this.fire(new o.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){let n=this.style.sourceCaches[y.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&n.reload();for(let c in this.style._layers){let p=this.style._layers[c];p.type==="hillshade"&&p.source===y.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new cl(this.painter,n,y),this.painter.renderToTexture=new Ss(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=c=>{c.dataType==="style"?this.terrain.sourceCache.freeRtt():c.dataType==="source"&&c.tile&&(c.sourceId!==y.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(c.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new o.k("terrain",{terrain:y})),this}getTerrain(){var y,n;return(n=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&n!==void 0?n:null}areTilesLoaded(){let y=this.style&&this.style.sourceCaches;for(let n in y){let c=y[n]._tiles;for(let p in c){let f=c[p];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,n,c={}){let{pixelRatio:p=1,sdf:f=!1,stretchX:b,stretchY:L,content:E}=c;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||o.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:H,height:h,data:I}=n,_=n;return this.style.addImage(y,{data:new o.R({width:H,height:h},new Uint8Array(I)),pixelRatio:p,stretchX:b,stretchY:L,content:E,sdf:f,version:0,userImage:_}),_.onAdd&&_.onAdd(this,y),this}}{let{width:H,height:h,data:I}=v.getImageData(n);this.style.addImage(y,{data:new o.R({width:H,height:h},I),pixelRatio:p,stretchX:b,stretchY:L,content:E,sdf:f,version:0})}}updateImage(y,n){let c=this.style.getImage(y);if(!c)return this.fire(new o.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let p=n instanceof HTMLImageElement||o.b(n)?v.getImageData(n):n,{width:f,height:b,data:L}=p;if(f===void 0||b===void 0)return this.fire(new o.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==c.data.width||b!==c.data.height)return this.fire(new o.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));let E=!(n instanceof HTMLImageElement||o.b(n));return c.data.replace(L,E),this.style.updateImage(y,c),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new o.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return O.getImage(this._requestManager.transformRequest(y,tt.Image),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,n){return this._lazyInitEmptyStyle(),this.style.addLayer(y,n),this._update(!0)}moveLayer(y,n){return this.style.moveLayer(y,n),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,n,c){return this.style.setLayerZoomRange(y,n,c),this._update(!0)}setFilter(y,n,c={}){return this.style.setFilter(y,n,c),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,n,c,p={}){return this.style.setPaintProperty(y,n,c,p),this._update(!0)}getPaintProperty(y,n){return this.style.getPaintProperty(y,n)}setLayoutProperty(y,n,c,p={}){return this.style.setLayoutProperty(y,n,c,p),this._update(!0)}getLayoutProperty(y,n){return this.style.getLayoutProperty(y,n)}setGlyphs(y,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,n,c={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,n,c,p=>{p||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,n,c=>{c||this._update(!0)}),this}setLight(y,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,n),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,n){return this.style.setFeatureState(y,n),this._update()}removeFeatureState(y,n){return this.style.removeFeatureState(y,n),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,n=0;return this._container&&(y=this._container.clientWidth||400,n=this._container.clientHeight||300),[y,n]}_setupContainer(){let y=this._container;y.classList.add("maplibregl-map");let n=this._canvasContainer=x.create("div","maplibregl-canvas-container",y);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=x.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let c=this._containerDimensions(),p=this._getClampedPixelRatio(c[0],c[1]);this._resizeCanvas(c[0],c[1],p);let f=this._controlContainer=x.create("div","maplibregl-control-container",y),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(L=>{b[L]=x.create("div",`maplibregl-ctrl-${L} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,n,c){this._canvas.width=Math.floor(c*y),this._canvas.height=Math.floor(c*n),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${n}px`}_setupPainter(){let y={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},n=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{n={requestedAttributes:y},p&&(n.statusMessage=p.statusMessage,n.type=p.type)},{once:!0});let c=this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y);if(!c){let p="Failed to initialize WebGL";throw n?(n.message=p,new Error(JSON.stringify(n))):new Error(p)}this.painter=new fa(c,this.transform),T.testSupport(c)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){let n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let c=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let f=this.transform.zoom,b=v.now();this.style.zoomHistory.update(f,b);let L=new o.a8(f,{now:b,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),E=L.crossFadingFactor();E===1&&E===this._crossFadingFactor||(c=!0,this._crossFadingFactor=E),this.style.update(L)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new o.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.bc.mark(o.bd.load),this.fire(new o.k("load"))),this.style&&(this.style.hasTransitions()||c)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.k("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,o.bc.mark(o.bd.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(let c of this._controls)c.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),O.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();let n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),x.remove(this._canvasContainer),x.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),o.bc.clearMetrics(),this._removed=!0,this.fire(new o.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,v.frameAsync(this._frameRequest).then(y=>{o.bc.frame(y),this._frameRequest=null,this._render(y)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return ul}getCameraTargetElevation(){return this.transform.elevation}},A.MapMouseEvent=Jr,A.MapTouchEvent=xs,A.MapWheelEvent=zn,A.Marker=Va,A.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{let n=this._map.getZoom(),c=n===this._map.getMaxZoom(),p=n===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{let n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n},this._setButtonTitle=(n,c)=>{let p=this._map._getUIString(`NavigationControl.${c}`);n.title=p,n.setAttribute("aria-label",p)},this.options=o.e({},hs,y),this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),x.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),x.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=x.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Bc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){x.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,n){let c=x.create("button",y,this._container);return c.type="button",c.addEventListener("click",n),c}},A.Popup=class extends o.E{constructor(y){super(),this.remove=()=>(this._content&&x.remove(this._content),this._container&&(x.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.k("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{var c;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=x.create("div","maplibregl-popup",this._map.getContainer()),this._tip=x.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let E of this.options.className.split(" "))this._container.classList.add(E);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?hl(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._trackPointer&&!n)return;let p=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationPoint(this._lngLat));let f=this.options.anchor,b=Sc(this.options.offset);if(!f){let E=this._container.offsetWidth,H=this._container.offsetHeight,h;h=p.y+b.bottom.y<H?["top"]:p.y>this._map.transform.height-H?["bottom"]:[],p.x<E/2?h.push("left"):p.x>this._map.transform.width-E/2&&h.push("right"),f=h.length===0?"bottom":h.join("-")}let L=p.add(b[f]);this.options.subpixelPositioning||(L=L.round()),x.setTransform(this._container,`${kA[f]} translate(${L.x}px,${L.y}px)`),gl(this._container,f,"popup")},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(xc),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=o.M.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){let n=document.createDocumentFragment(),c=document.createElement("body"),p;for(c.innerHTML=y;p=c.firstChild,p;)n.appendChild(p);return this.setDOMContent(n)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=x.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=x.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let y=this._container.querySelector(Ml);y&&y.focus()}},A.RasterDEMTileSource=Li,A.RasterTileSource=Rt,A.ScaleControl=class{constructor(y){this._onMove=()=>{LA(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,LA(this._map,this._container,this.options)},this.options=o.e({},Da,y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){x.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},A.ScrollZoomHandler=Al,A.Style=to,A.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=x.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=x.create("button","maplibregl-ctrl-terrain",this._container),x.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){x.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},A.TwoFingersTouchPitchHandler=ol,A.TwoFingersTouchRotateHandler=BA,A.TwoFingersTouchZoomHandler=rs,A.TwoFingersTouchZoomRotateHandler=wi,A.VectorTileSource=xt,A.VideoSource=Je,A.addSourceType=(y,n)=>o._(void 0,void 0,void 0,function*(){if(hi(y))throw new Error(`A source type called "${y}" already exists.`);((c,p)=>{ui[c]=p})(y,n)}),A.clearPrewarmedResources=function(){let y=It;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(fe),It=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},A.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},A.getRTLTextPluginStatus=function(){return Oi().getRTLTextPluginStatus()},A.getVersion=function(){return Au},A.getWorkerCount=function(){return j.workerCount},A.getWorkerUrl=function(){return o.a.WORKER_URL},A.importScriptInWorkers=function(y){return he().broadcast("importScript",y)},A.prewarm=function(){Ot().acquire(fe)},A.setMaxParallelImageRequests=function(y){o.a.MAX_PARALLEL_IMAGE_REQUESTS=y},A.setRTLTextPlugin=function(y,n){return Oi().setRTLTextPlugin(y,n)},A.setWorkerCount=function(y){j.workerCount=y},A.setWorkerUrl=function(y){o.a.WORKER_URL=y}});var s=r;return s})});var lb=la((fd,md)=>{(function(r,t){typeof fd=="object"&&typeof md<"u"?t(fd):typeof define=="function"&&define.amd?define(["exports"],t):t((r=typeof globalThis<"u"?globalThis:r||self).VectorTextProtocol={})})(fd,function(r){"use strict";function t(pt){return pt&&pt.__esModule&&Object.prototype.hasOwnProperty.call(pt,"default")?pt.default:pt}function i(pt){if(pt.__esModule)return pt;var yt=pt.default;if(typeof yt=="function"){var ct=function Bt(){return this instanceof Bt?Reflect.construct(yt,arguments,this.constructor):yt.apply(this,arguments)};ct.prototype=yt.prototype}else ct={};return Object.defineProperty(ct,"__esModule",{value:!0}),Object.keys(pt).forEach(function(Bt){var Kt=Object.getOwnPropertyDescriptor(pt,Bt);Object.defineProperty(ct,Bt,Kt.get?Kt:{enumerable:!0,get:function(){return pt[Bt]}})}),ct}function s(pt){return new Function("d","return {"+pt.map(function(yt,ct){return JSON.stringify(yt)+": d["+ct+"]"}).join(",")+"}")}function A(pt){var yt=new RegExp('["'+pt+`
]`),ct=pt.charCodeAt(0);function Bt(ae,Be){var _e,Ce,se={},ye={},be=[],Ge=ae.length,Ui=0,Ri=0;function Pe(){if(Ui>=Ge)return ye;if(Ce)return Ce=!1,se;var Ai,Fi=Ui;if(ae.charCodeAt(Fi)===34){for(var Wi=Fi;Wi++<Ge;)if(ae.charCodeAt(Wi)===34){if(ae.charCodeAt(Wi+1)!==34)break;++Wi}return Ui=Wi+2,(Ai=ae.charCodeAt(Wi+1))===13?(Ce=!0,ae.charCodeAt(Wi+2)===10&&++Ui):Ai===10&&(Ce=!0),ae.slice(Fi+1,Wi).replace(/""/g,'"')}for(;Ui<Ge;){var nr=1;if((Ai=ae.charCodeAt(Ui++))===10)Ce=!0;else if(Ai===13)Ce=!0,ae.charCodeAt(Ui)===10&&(++Ui,++nr);else if(Ai!==ct)continue;return ae.slice(Fi,Ui-nr)}return ae.slice(Fi)}for(;(_e=Pe())!==ye;){for(var Qe=[];_e!==se&&_e!==ye;)Qe.push(_e),_e=Pe();Be&&(Qe=Be(Qe,Ri++))==null||be.push(Qe)}return be}function Kt(ae){return ae.map(Yt).join(pt)}function Yt(ae){return ae==null?"":yt.test(ae+="")?'"'+ae.replace(/\"/g,'""')+'"':ae}return{parse:function(ae,Be){var _e,Ce,se=Bt(ae,function(ye,be){if(_e)return _e(ye,be-1);Ce=ye,_e=Be?function(Ge,Ui){var Ri=s(Ge);return function(Pe,Qe){return Ui(Ri(Pe),Qe,Ge)}}(ye,Be):s(ye)});return se.columns=Ce,se},parseRows:Bt,format:function(ae,Be){return Be==null&&(Be=function(_e){var Ce=Object.create(null),se=[];return _e.forEach(function(ye){for(var be in ye)be in Ce||se.push(Ce[be]=be)}),se}(ae)),[Be.map(Yt).join(pt)].concat(ae.map(function(_e){return Be.map(function(Ce){return Yt(_e[Ce])}).join(pt)})).join(`
`)},formatRows:function(ae){return ae.map(Kt).join(`
`)}}}var o=A(","),g=o.parse,d=o.parseRows,C=o.format,v=o.formatRows,x=A("	"),T=x.parse,G=x.parseRows,k=x.format,W=x.formatRows,K=i(Object.freeze({__proto__:null,csvFormat:C,csvFormatRows:v,csvParse:g,csvParseRows:d,dsvFormat:A,tsvFormat:k,tsvFormatRows:W,tsvParse:T,tsvParseRows:G})),$={exports:{}};function O(pt,yt){var ct=tt(pt,yt);return ct.whole+"\xB0 "+(ct.minutes?ct.minutes+"' ":"")+(ct.seconds?ct.seconds+'" ':"")+ct.dir}function tt(pt,yt){var ct=({lat:["N","S"],lon:["E","W"]}[yt]||"")[pt>=0?0:1],Bt=Math.abs(pt),Kt=Math.floor(Bt),Yt=60*(Bt-Kt),ae=Math.floor(Yt);return{whole:Kt,minutes:ae,seconds:Math.floor(60*(Yt-ae)),dir:ct}}function at(pt,yt){if(yt||(yt="NSEW"),typeof pt!="string")return null;var ct=(pt=pt.toUpperCase()).match(/^[\s\,]*([NSEW])?\s*([\-|\—|\―]?[0-9.]+)[°º˚]?\s*(?:([0-9.]+)['’′‘]\s*)?(?:([0-9.]+)(?:''|"|”|″)\s*)?([NSEW])?/);if(!ct)return null;var Bt,Kt=ct[0];if(ct[1]&&ct[5]?(Bt=ct[1],Kt=Kt.slice(0,-1)):Bt=ct[1]||ct[5],Bt&&yt.indexOf(Bt)===-1)return null;var Yt=ct[2]?parseFloat(ct[2]):0,ae=ct[3]?parseFloat(ct[3])/60:0,Be=ct[4]?parseFloat(ct[4])/3600:0,_e=Yt<0?-1:1;return Bt!=="S"&&Bt!=="W"||(_e*=-1),{val:(Math.abs(Yt)+ae+Be)*_e,dim:Bt,matched:Kt,remain:pt.slice(Kt.length)}}$.exports=function(pt,yt){var ct=at(pt,yt);return ct===null?null:ct.val},$.exports.pair=function(pt,yt){var ct=at(pt=pt.trim(),yt);if(!ct)return null;var Bt=at(pt=ct.remain.trim(),yt);return!Bt||Bt.remain?null:ct.dim?function(Kt,Yt,ae){if(ae==="N"||ae==="S")return[Kt,Yt];if(ae==="W"||ae==="E")return[Yt,Kt]}(ct.val,Bt.val,ct.dim):[ct.val,Bt.val]},$.exports.format=O,$.exports.formatPair=function(pt){return O(pt.lat,"lat")+" "+O(pt.lon,"lon")},$.exports.coordToDMS=tt;var Lt=$.exports,Tt=K,Qt=Lt,Ft=/(Lat)(itude)?/gi,vt=/(L)(on|ng)(gitude)?/i;function Jt(pt,yt){var ct,Bt,Kt;for(var Yt in pt)(Bt=Yt.match(yt))&&(!ct||Bt[0].length/Yt.length>Kt)&&(Kt=Bt[0].length/Yt.length,ct=Yt);return ct}function qt(pt){return Jt(pt,Ft)}function At(pt){return Jt(pt,vt)}function lt(pt){return typeof pt=="object"?Object.keys(pt).length:0}function kt(pt){var yt=[];return[",",";","	","|"].forEach(function(ct){var Bt=Tt.dsvFormat(ct).parse(pt);if(Bt.length>=1){for(var Kt=lt(Bt[0]),Yt=0;Yt<Bt.length;Yt++)if(lt(Bt[Yt])!==Kt)return;yt.push({delimiter:ct,arity:Object.keys(Bt[0]).length})}}),yt.length?yt.sort(function(ct,Bt){return Bt.arity-ct.arity})[0].delimiter:null}var _t={isLon:function(pt){return!!pt.match(vt)},isLat:function(pt){return!!pt.match(Ft)},guessLatHeader:qt,guessLonHeader:At,csv:Tt.csvParse,tsv:Tt.tsvParse,dsv:Tt,auto:function(pt){var yt=kt(pt);return yt?function(ct){return delete ct.columns,ct}(Tt.dsvFormat(yt).parse(pt)):null},csv2geojson:function(pt,yt,ct){ct||(ct=yt,yt={}),yt.delimiter=yt.delimiter||",";var Bt=yt.latfield||"",Kt=yt.lonfield||"",Yt=yt.crs||"",ae=[],Be={type:"FeatureCollection",features:ae};if(Yt!==""&&(Be.crs={type:"name",properties:{name:Yt}}),yt.delimiter!=="auto"||typeof pt!="string"||(yt.delimiter=kt(pt),yt.delimiter)){var _e=yt.numericFields?yt.numericFields.split(","):null,Ce=typeof pt=="string"?Tt.dsvFormat(yt.delimiter).parse(pt,function(Qe){if(_e)for(var Ai in Qe)_e.includes(Ai)&&(Qe[Ai]=+Qe[Ai]);return Qe}):pt;if(Ce.length){var se,ye=[];if(Bt||(Bt=qt(Ce[0])),Kt||(Kt=At(Ce[0])),!Bt||!Kt){for(se=0;se<Ce.length;se++)ae.push({type:"Feature",properties:Ce[se],geometry:null});ct(ye.length?ye:null,Be)}else{for(se=0;se<Ce.length;se++)if(Ce[se][Kt]!==void 0&&Ce[se][Bt]!==void 0){var be,Ge,Ui,Ri=Ce[se][Kt],Pe=Ce[se][Bt];(Ui=Qt(Ri,"EW"))&&(Ri=Ui),(Ui=Qt(Pe,"NS"))&&(Pe=Ui),be=parseFloat(Ri),Ge=parseFloat(Pe),isNaN(be)||isNaN(Ge)?ye.push({message:"A row contained an invalid value for latitude or longitude",row:Ce[se],index:se}):(yt.includeLatLon||(delete Ce[se][Kt],delete Ce[se][Bt]),ae.push({type:"Feature",properties:Ce[se],geometry:{type:"Point",coordinates:[parseFloat(be),parseFloat(Ge)]}}))}ct(ye.length?ye:null,Be)}}else ct(null,Be)}else ct({type:"Error",message:"Could not autodetect delimiter"})},toLine:function(pt){for(var yt=pt.features,ct={type:"Feature",geometry:{type:"LineString",coordinates:[]}},Bt=0;Bt<yt.length;Bt++)ct.geometry.coordinates.push(yt[Bt].geometry.coordinates);return ct.properties=yt.reduce(function(Kt,Yt){for(var ae in Yt.properties)Kt[ae]||(Kt[ae]=[]),Kt[ae].push(Yt.properties[ae]);return Kt},{}),{type:"FeatureCollection",features:[ct]}},toPolygon:function(pt){for(var yt=pt.features,ct={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},Bt=0;Bt<yt.length;Bt++)ct.geometry.coordinates[0].push(yt[Bt].geometry.coordinates);return ct.properties=yt.reduce(function(Kt,Yt){for(var ae in Yt.properties)Kt[ae]||(Kt[ae]=[]),Kt[ae].push(Yt.properties[ae]);return Kt},{}),{type:"FeatureCollection",features:[ct]}}};function le(pt){return pt}function ie(pt,yt){var ct=yt.id,Bt=yt.bbox,Kt=yt.properties==null?{}:yt.properties,Yt=function(ae,Be){var _e=function(Pe){if(Pe==null)return le;var Qe,Ai,Fi=Pe.scale[0],Wi=Pe.scale[1],nr=Pe.translate[0],ai=Pe.translate[1];return function(dr,Or){Or||(Qe=Ai=0);var Ur=2,_n=dr.length,vn=new Array(_n);for(vn[0]=(Qe+=dr[0])*Fi+nr,vn[1]=(Ai+=dr[1])*Wi+ai;Ur<_n;)vn[Ur]=dr[Ur],++Ur;return vn}}(ae.transform),Ce=ae.arcs;function se(Pe,Qe){Qe.length&&Qe.pop();for(var Ai=Ce[Pe<0?~Pe:Pe],Fi=0,Wi=Ai.length;Fi<Wi;++Fi)Qe.push(_e(Ai[Fi],Fi));Pe<0&&function(nr,ai){for(var dr,Or=nr.length,Ur=Or-ai;Ur<--Or;)dr=nr[Ur],nr[Ur++]=nr[Or],nr[Or]=dr}(Qe,Wi)}function ye(Pe){return _e(Pe)}function be(Pe){for(var Qe=[],Ai=0,Fi=Pe.length;Ai<Fi;++Ai)se(Pe[Ai],Qe);return Qe.length<2&&Qe.push(Qe[0]),Qe}function Ge(Pe){for(var Qe=be(Pe);Qe.length<4;)Qe.push(Qe[0]);return Qe}function Ui(Pe){return Pe.map(Ge)}function Ri(Pe){var Qe,Ai=Pe.type;switch(Ai){case"GeometryCollection":return{type:Ai,geometries:Pe.geometries.map(Ri)};case"Point":Qe=ye(Pe.coordinates);break;case"MultiPoint":Qe=Pe.coordinates.map(ye);break;case"LineString":Qe=be(Pe.arcs);break;case"MultiLineString":Qe=Pe.arcs.map(be);break;case"Polygon":Qe=Ui(Pe.arcs);break;case"MultiPolygon":Qe=Pe.arcs.map(Ui);break;default:return null}return{type:Ai,coordinates:Qe}}return Ri(Be)}(pt,yt);return ct==null&&Bt==null?{type:"Feature",properties:Kt,geometry:Yt}:Bt==null?{type:"Feature",id:ct,properties:Kt,geometry:Yt}:{type:"Feature",id:ct,bbox:Bt,properties:Kt,geometry:Yt}}function ne(pt,yt){return Array.from(pt.getElementsByTagName(yt))}function te(pt){return pt[0]==="#"?pt:`#${pt}`}function wt(pt){return pt?.normalize(),pt&&pt.textContent||""}function Ut(pt,yt,ct){let Bt=pt.getElementsByTagName(yt),Kt=Bt.length?Bt[0]:null;return Kt&&ct&&ct(Kt),Kt}function fe(pt,yt,ct){let Bt={};if(!pt)return Bt;let Kt=pt.getElementsByTagName(yt),Yt=Kt.length?Kt[0]:null;return Yt&&ct?ct(Yt,Bt):Bt}function j(pt,yt,ct){let Bt=wt(Ut(pt,yt));return Bt&&ct&&ct(Bt)||{}}function bt(pt,yt,ct){let Bt=parseFloat(wt(Ut(pt,yt)));if(!isNaN(Bt))return Bt&&ct&&ct(Bt)||{}}function It(pt,yt,ct){let Bt=parseFloat(wt(Ut(pt,yt)));if(!isNaN(Bt))return ct&&ct(Bt),Bt}function Ht(pt,yt){let ct={};for(let Bt of yt)j(pt,Bt,Kt=>{ct[Bt]=Kt});return ct}function Ot(pt){return pt?.nodeType===1}function Ae(pt){return fe(pt,"line",yt=>Object.assign({},j(yt,"color",ct=>({stroke:`#${ct}`})),bt(yt,"opacity",ct=>({"stroke-opacity":ct})),bt(yt,"width",ct=>({"stroke-width":96*ct/25.4}))))}function he(pt){let yt=[];if(pt===null)return yt;for(let ct of Array.from(pt.childNodes)){if(!Ot(ct))continue;let Bt=de(ct.nodeName);if(Bt==="gpxtpx:TrackPointExtension")yt=yt.concat(he(ct));else{let Kt=wt(ct);yt.push([Bt,He(Kt)])}}return yt}function de(pt){return["heart","gpxtpx:hr","hr"].includes(pt)?"heart":pt}function He(pt){let yt=parseFloat(pt);return isNaN(yt)?pt:yt}function Re(pt){let yt=[parseFloat(pt.getAttribute("lon")||""),parseFloat(pt.getAttribute("lat")||"")];if(isNaN(yt[0])||isNaN(yt[1]))return null;It(pt,"ele",Bt=>{yt.push(Bt)});let ct=Ut(pt,"time");return{coordinates:yt,time:ct?wt(ct):null,extendedValues:he(Ut(pt,"extensions"))}}function je(pt){let yt=Ht(pt,["name","cmt","desc","type","time","keywords"]),ct=Array.from(pt.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/GpxExtensions/v3","*"));for(let Kt of ct)Kt.parentNode?.parentNode===pt&&(yt[Kt.tagName.replace(":","_")]=wt(Kt));let Bt=ne(pt,"link");return Bt.length&&(yt.links=Bt.map(Kt=>Object.assign({href:Kt.getAttribute("href")},Ht(Kt,["text","type"])))),yt}function Me(pt,yt){let ct=ne(pt,yt),Bt=[],Kt=[],Yt={};for(let ae=0;ae<ct.length;ae++){let Be=Re(ct[ae]);if(Be){Bt.push(Be.coordinates),Be.time&&Kt.push(Be.time);for(let[_e,Ce]of Be.extendedValues){let se=_e==="heart"?_e:_e.replace("gpxtpx:","")+"s";Yt[se]||(Yt[se]=Array(ct.length).fill(null)),Yt[se][ae]=Ce}}}if(!(Bt.length<2))return{line:Bt,times:Kt,extendedValues:Yt}}function gi(pt){let yt=Me(pt,"rtept");if(yt)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},je(pt),Ae(Ut(pt,"extensions"))),geometry:{type:"LineString",coordinates:yt.line}}}function xt(pt){let yt=ne(pt,"trkseg"),ct=[],Bt=[],Kt=[];for(let Be of yt){let _e=Me(Be,"trkpt");_e&&(Kt.push(_e),_e.times&&_e.times.length&&Bt.push(_e.times))}if(Kt.length===0)return null;let Yt=Kt.length>1,ae=Object.assign({_gpxType:"trk"},je(pt),Ae(Ut(pt,"extensions")),Bt.length?{coordinateProperties:{times:Yt?Bt:Bt[0]}}:{});for(let Be of Kt){ct.push(Be.line),ae.coordinateProperties||(ae.coordinateProperties={});let _e=ae.coordinateProperties,Ce=Object.entries(Be.extendedValues);for(let se=0;se<Ce.length;se++){let[ye,be]=Ce[se];Yt?(_e[ye]||(_e[ye]=Kt.map(Ge=>new Array(Ge.line.length).fill(null))),_e[ye][se]=be):_e[ye]=be}}return{type:"Feature",properties:ae,geometry:Yt?{type:"MultiLineString",coordinates:ct}:{type:"LineString",coordinates:ct[0]}}}function Rt(pt){let yt=Object.assign(je(pt),Ht(pt,["sym"])),ct=Re(pt);return ct?{type:"Feature",properties:yt,geometry:{type:"Point",coordinates:ct.coordinates}}:null}function*Li(pt){for(let yt of ne(pt,"trk")){let ct=xt(yt);ct&&(yield ct)}for(let yt of ne(pt,"rte")){let ct=gi(yt);ct&&(yield ct)}for(let yt of ne(pt,"wpt")){let ct=Rt(yt);ct&&(yield ct)}}let Ue="http://www.garmin.com/xmlschemas/ActivityExtension/v2",Ee=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],Ne=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function Je(pt,yt){let ct=[];for(let[Bt,Kt]of yt){let Yt=Ut(pt,Bt);if(!Yt){let Be=pt.getElementsByTagNameNS(Ue,Bt);Be.length&&(Yt=Be[0])}let ae=parseFloat(wt(Yt));isNaN(ae)||ct.push([Kt,ae])}return ct}function ze(pt){let yt=[It(pt,"LongitudeDegrees"),It(pt,"LatitudeDegrees")];if(yt[0]===void 0||isNaN(yt[0])||yt[1]===void 0||isNaN(yt[1]))return null;let ct=Ut(pt,"HeartRateBpm"),Bt=wt(Ut(pt,"Time"));return Ut(pt,"AltitudeMeters",Kt=>{let Yt=parseFloat(wt(Kt));isNaN(Yt)||yt.push(Yt)}),{coordinates:yt,time:Bt||null,heartRate:ct?parseFloat(wt(ct)):null,extensions:Je(pt,Ee)}}function ui(pt){let yt=ne(pt,"Trackpoint"),ct=[],Bt=[],Kt=[];if(yt.length<2)return null;let Yt={},ae={extendedProperties:Yt};for(let Be=0;Be<yt.length;Be++){let _e=ze(yt[Be]);if(_e===null)continue;ct.push(_e.coordinates);let{time:Ce,heartRate:se,extensions:ye}=_e;Ce&&Bt.push(Ce),se&&Kt.push(se);for(let[be,Ge]of ye)Yt[be]||(Yt[be]=Array(yt.length).fill(null)),Yt[be][Be]=Ge}return ct.length<2?null:Object.assign(ae,{line:ct,times:Bt,heartRates:Kt})}function hi(pt){let yt=ne(pt,"Track"),ct=[],Bt=[],Kt=[],Yt=[],ae,Be=Object.assign(Object.fromEntries(Je(pt,Ne)),fe(pt,"Name",_e=>({name:wt(_e)})));for(let _e of yt)ae=ui(_e),ae&&(ct.push(ae.line),ae.times.length&&Bt.push(ae.times),ae.heartRates.length&&Kt.push(ae.heartRates),Yt.push(ae.extendedProperties));for(let _e=0;_e<Yt.length;_e++){let Ce=Yt[_e];for(let se in Ce)yt.length===1?ae&&(Be[se]=ae.extendedProperties[se]):(Be[se]||(Be[se]=ct.map(ye=>Array(ye.length).fill(null))),Be[se][_e]=Ce[se])}return ct.length===0?null:((Bt.length||Kt.length)&&(Be.coordinateProperties=Object.assign(Bt.length?{times:ct.length===1?Bt[0]:Bt}:{},Kt.length?{heart:ct.length===1?Kt[0]:Kt}:{})),{type:"Feature",properties:Be,geometry:ct.length===1?{type:"LineString",coordinates:ct[0]}:{type:"MultiLineString",coordinates:ct}})}function*Ei(pt){for(let yt of ne(pt,"Lap")){let ct=hi(yt);ct&&(yield ct)}for(let yt of ne(pt,"Courses")){let ct=hi(yt);ct&&(yield ct)}}function Pi(pt,yt){let ct={},Bt=yt=="stroke"||yt==="fill"?yt:yt+"-color";return pt[0]==="#"&&(pt=pt.substring(1)),pt.length===6||pt.length===3?ct[Bt]="#"+pt:pt.length===8&&(ct[yt+"-opacity"]=parseInt(pt.substring(0,2),16)/255,ct[Bt]="#"+pt.substring(6,8)+pt.substring(4,6)+pt.substring(2,4)),ct}function Ie(pt,yt,ct){let Bt={};return It(pt,yt,Kt=>{Bt[ct]=Kt}),Bt}function Oi(pt,yt){return fe(pt,"color",ct=>Pi(wt(ct),yt))}function mi(pt){return fe(pt,"Icon",(yt,ct)=>(j(yt,"href",Bt=>{ct.icon=Bt}),ct))}function Vi(pt){return Object.assign({},function(yt){return fe(yt,"PolyStyle",(ct,Bt)=>Object.assign(Bt,fe(ct,"color",Kt=>Pi(wt(Kt),"fill")),j(ct,"fill",Kt=>{if(Kt==="0")return{"fill-opacity":0}}),j(ct,"outline",Kt=>{if(Kt==="0")return{"stroke-opacity":0}})))}(pt),function(yt){return fe(yt,"LineStyle",ct=>Object.assign(Oi(ct,"stroke"),Ie(ct,"width","stroke-width")))}(pt),function(yt){return fe(yt,"LabelStyle",ct=>Object.assign(Oi(ct,"label"),Ie(ct,"scale","label-scale")))}(pt),function(yt){return fe(yt,"IconStyle",ct=>Object.assign(Oi(ct,"icon"),Ie(ct,"scale","icon-scale"),Ie(ct,"heading","icon-heading"),fe(ct,"hotSpot",Bt=>{let Kt=parseFloat(Bt.getAttribute("x")||""),Yt=parseFloat(Bt.getAttribute("y")||""),ae=Bt.getAttribute("xunits")||"",Be=Bt.getAttribute("yunits")||"";return isNaN(Kt)||isNaN(Yt)?{}:{"icon-offset":[Kt,Yt],"icon-offset-units":[ae,Be]}}),mi(ct)))}(pt))}let We=pt=>Number(pt),Se={string:pt=>pt,int:We,uint:We,short:We,ushort:We,float:We,double:We,bool:pt=>Boolean(pt)};function $e(pt,yt){return fe(pt,"ExtendedData",(ct,Bt)=>{for(let Kt of ne(ct,"Data"))Bt[Kt.getAttribute("name")||""]=wt(Ut(Kt,"value"));for(let Kt of ne(ct,"SimpleData")){let Yt=Kt.getAttribute("name")||"",ae=yt[Yt]||Se.string;Bt[Yt]=ae(wt(Kt))}return Bt})}function di(pt){let yt=Ut(pt,"description");for(let ct of Array.from(yt?.childNodes||[]))if(ct.nodeType===4)return{description:{"@type":"html",value:wt(ct)}};return{}}function Zi(pt){return fe(pt,"TimeSpan",yt=>({timespan:{begin:wt(Ut(yt,"begin")),end:wt(Ut(yt,"end"))}}))}function qi(pt){return fe(pt,"TimeStamp",yt=>({timestamp:wt(Ut(yt,"when"))}))}function vi(pt,yt){return j(pt,"styleUrl",ct=>(ct=te(ct),yt[ct]?Object.assign({styleUrl:ct},yt[ct]):{styleUrl:ct}))}let tr=/\s*/g,Lr=/^\s*|\s*$/g,ft=/\s+/;function Y(pt){return pt.replace(tr,"").split(",").map(parseFloat).filter(yt=>!isNaN(yt)).slice(0,3)}function q(pt){return pt.replace(Lr,"").split(ft).map(Y).filter(yt=>yt.length>=2)}function rt(pt){let yt=ne(pt,"coord");yt.length===0&&(yt=function(Bt,Kt,Yt){return Array.from(Bt.getElementsByTagNameNS(Yt,Kt))}(pt,"coord","*"));let ct=yt.map(Bt=>wt(Bt).split(" ").map(parseFloat));return ct.length===0?null:{geometry:ct.length>2?{type:"LineString",coordinates:ct}:{type:"Point",coordinates:ct[0]},times:ne(pt,"when").map(Bt=>wt(Bt))}}function ht(pt){if(pt.length===0)return pt;let yt=pt[0],ct=pt[pt.length-1],Bt=!0;for(let Kt=0;Kt<Math.max(yt.length,ct.length);Kt++)if(yt[Kt]!==ct[Kt]){Bt=!1;break}return Bt?pt:pt.concat([pt[0]])}function Zt(pt){return wt(Ut(pt,"coordinates"))}function zt(pt){let yt=[],ct=[];for(let Bt=0;Bt<pt.childNodes.length;Bt++){let Kt=pt.childNodes.item(Bt);if(Ot(Kt))switch(Kt.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{let Yt=zt(Kt);yt=yt.concat(Yt.geometries),ct=ct.concat(Yt.coordTimes);break}case"Point":{let Yt=Y(Zt(Kt));Yt.length>=2&&yt.push({type:"Point",coordinates:Yt});break}case"LinearRing":case"LineString":{let Yt=q(Zt(Kt));Yt.length>=2&&yt.push({type:"LineString",coordinates:Yt});break}case"Polygon":{let Yt=[];for(let ae of ne(Kt,"LinearRing")){let Be=ht(q(Zt(ae)));Be.length>=4&&Yt.push(Be)}Yt.length&&yt.push({type:"Polygon",coordinates:Yt});break}case"Track":case"gx:Track":{let Yt=rt(Kt);if(!Yt)break;let{times:ae,geometry:Be}=Yt;yt.push(Be),ae.length&&ct.push(ae);break}}}return{geometries:yt,coordTimes:ct}}function Xt(pt,yt,ct,Bt){let{coordTimes:Kt,geometries:Yt}=zt(pt),ae=function(Ce){return Ce.length===0?null:Ce.length===1?Ce[0]:{type:"GeometryCollection",geometries:Ce}}(Yt);if(!ae&&Bt.skipNullGeometry)return null;let Be={type:"Feature",geometry:ae,properties:Object.assign(Ht(pt,["name","address","visibility","open","phoneNumber","description"]),di(pt),vi(pt,yt),Vi(pt),$e(pt,ct),Zi(pt),qi(pt),Kt.length?{coordinateProperties:{times:Kt.length===1?Kt[0]:Kt}}:{})};Be.properties?.visibility!==void 0&&(Be.properties.visibility=Be.properties.visibility!=="0");let _e=pt.getAttribute("id");return _e!==null&&_e!==""&&(Be.id=_e),Be}function Mt(pt){return Ut(pt,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[ht(q(Zt(pt)))]}}:function(yt){let ct=Ut(yt,"LatLonBox");if(ct){let Bt=It(ct,"north"),Kt=It(ct,"west"),Yt=It(ct,"east"),ae=It(ct,"south"),Be=It(ct,"rotation");if(typeof Bt=="number"&&typeof ae=="number"&&typeof Kt=="number"&&typeof Yt=="number"){let _e=[Kt,ae,Yt,Bt],Ce=[[[Kt,Bt],[Yt,Bt],[Yt,ae],[Kt,ae],[Kt,Bt]]];return typeof Be=="number"&&(Ce=function(se,ye,be){let Ge=[(se[0]+se[2])/2,(se[1]+se[3])/2];return[ye[0].map(Ui=>{let Ri=Ui[1]-Ge[1],Pe=Ui[0]-Ge[0],Qe=Math.sqrt(Math.pow(Ri,2)+Math.pow(Pe,2)),Ai=Math.atan2(Ri,Pe)+be*re;return[Ge[0]+Math.cos(Ai)*Qe,Ge[1]+Math.sin(Ai)*Qe]})]}(_e,Ce,Be)),{bbox:_e,geometry:{type:"Polygon",coordinates:Ce}}}}return null}(pt)}let re=Math.PI/180;function ce(pt,yt,ct,Bt){let Kt=Mt(pt),Yt=Kt?.geometry||null;if(!Yt&&Bt.skipNullGeometry)return null;let ae={type:"Feature",geometry:Yt,properties:Object.assign({"@geometry-type":"groundoverlay"},Ht(pt,["name","address","visibility","open","phoneNumber","description"]),di(pt),vi(pt,yt),Vi(pt),mi(pt),$e(pt,ct),Zi(pt),qi(pt))};Kt?.bbox&&(ae.bbox=Kt.bbox),ae.properties?.visibility!==void 0&&(ae.properties.visibility=ae.properties.visibility!=="0");let Be=pt.getAttribute("id");return Be!==null&&Be!==""&&(ae.id=Be),ae}function pe(pt){let yt=pt.getAttribute("id"),ct=pt.parentNode;return!yt&&Ot(ct)&&ct.localName==="CascadingStyle"&&(yt=ct.getAttribute("kml:id")||ct.getAttribute("id")),te(yt||"")}function me(pt){let yt={};for(let ct of ne(pt,"Style"))yt[pe(ct)]=Vi(ct);for(let ct of ne(pt,"StyleMap")){let Bt=te(ct.getAttribute("id")||"");j(ct,"styleUrl",Kt=>{Kt=te(Kt),yt[Kt]&&(yt[Bt]=yt[Kt])})}return yt}function Xe(pt){let yt={};for(let ct of ne(pt,"SimpleField"))yt[ct.getAttribute("name")||""]=Se[ct.getAttribute("type")||""]||Se.string;return yt}let oi=["name","visibility","open","address","description","phoneNumber","visibility"];function*ii(pt,yt={skipNullGeometry:!1}){let ct=me(pt),Bt=Xe(pt);for(let Kt of ne(pt,"Placemark")){let Yt=Xt(Kt,ct,Bt,yt);Yt&&(yield Yt)}for(let Kt of ne(pt,"GroundOverlay")){let Yt=ce(Kt,ct,Bt,yt);Yt&&(yield Yt)}}var Ni=Object.freeze({__proto__:null,gpx:function(pt){return{type:"FeatureCollection",features:Array.from(Li(pt))}},gpxGen:Li,kml:function(pt,yt={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(ii(pt,yt))}},kmlGen:ii,kmlWithFolders:function(pt,yt={skipNullGeometry:!1}){let ct=me(pt),Bt=Xe(pt),Kt={type:"root",children:[]};return function Yt(ae,Be,_e){if(Ot(ae))switch(ae.tagName){case"GroundOverlay":{let Ce=ce(ae,ct,Bt,_e);Ce&&Be.children.push(Ce);break}case"Placemark":{let Ce=Xt(ae,ct,Bt,_e);Ce&&Be.children.push(Ce);break}case"Folder":{let Ce=function(se){let ye={};for(let be of Array.from(se.childNodes))Ot(be)&&oi.includes(be.tagName)&&(ye[be.tagName]=wt(be));return{type:"folder",meta:ye,children:[]}}(ae);Be.children.push(Ce),Be=Ce;break}}if(ae.childNodes)for(let Ce=0;Ce<ae.childNodes.length;Ce++)Yt(ae.childNodes[Ce],Be,_e)}(pt,Kt,yt),Kt},tcx:function(pt){return{type:"FeatureCollection",features:Array.from(Ei(pt))}},tcxGen:Ei}),Qi={exports:{}};(function(pt){var yt={};function ct(Yt){return Math.floor(Math.abs(Yt)+.5)*(Yt>=0?1:-1)}function Bt(Yt,ae,Be){var _e=2*((Yt=ct(Yt*Be))-(ae=ct(ae*Be)));_e<0&&(_e=-_e-1);for(var Ce="";_e>=32;)Ce+=String.fromCharCode(63+(32|31&_e)),_e/=32;return Ce+=String.fromCharCode(63+(0|_e))}function Kt(Yt){for(var ae=[],Be=0;Be<Yt.length;Be++){var _e=Yt[Be].slice();ae.push([_e[1],_e[0]])}return ae}yt.decode=function(Yt,ae){for(var Be,_e=0,Ce=0,se=0,ye=[],be=0,Ge=0,Ui=null,Ri=Math.pow(10,Number.isInteger(ae)?ae:5);_e<Yt.length;){Ui=null,be=1,Ge=0;do Ge+=(31&(Ui=Yt.charCodeAt(_e++)-63))*be,be*=32;while(Ui>=32);Be=1&Ge?(-Ge-1)/2:Ge/2,be=1,Ge=0;do Ge+=(31&(Ui=Yt.charCodeAt(_e++)-63))*be,be*=32;while(Ui>=32);Ce+=Be,se+=1&Ge?(-Ge-1)/2:Ge/2,ye.push([Ce/Ri,se/Ri])}return ye},yt.encode=function(Yt,ae){if(!Yt.length)return"";for(var Be=Math.pow(10,Number.isInteger(ae)?ae:5),_e=Bt(Yt[0][0],0,Be)+Bt(Yt[0][1],0,Be),Ce=1;Ce<Yt.length;Ce++){var se=Yt[Ce],ye=Yt[Ce-1];_e+=Bt(se[0],ye[0],Be),_e+=Bt(se[1],ye[1],Be)}return _e},yt.fromGeoJSON=function(Yt,ae){if(Yt&&Yt.type==="Feature"&&(Yt=Yt.geometry),!Yt||Yt.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return yt.encode(Kt(Yt.coordinates),ae)},yt.toGeoJSON=function(Yt,ae){return{type:"LineString",coordinates:Kt(yt.decode(Yt,ae))}},pt.exports&&(pt.exports=yt)})(Qi);var rr=Qi.exports,zi=(()=>{let pt=se=>se[0],yt=se=>se[se.length-1],ct=se=>se.join(","),Bt=(se,ye,be)=>{let Ge=se[ye];Ge?Ge.push(be):se[ye]=[be]},Kt=(se,ye,be)=>{let Ge=se[ye],Ui=null;Ge&&(Ui=Ge.indexOf(be))>=0&&Ge.splice(Ui,1)},Yt=(se,ye)=>{let be=se[ye];return be&&be.length>0?be[0]:null},ae=se=>se.length>3&&ct(pt(se))===ct(yt(se)),Be=(se,ye,be)=>{ye=ye||0,be=be||1;let Ge=se.reduce((nr,ai,dr)=>se[nr][ye]>ai[ye]?nr:dr,0),Ui=Ge<=0?se.length-2:Ge-1,Ri=Ge>=se.length-1?1:Ge+1,Pe=se[Ui][ye],Qe=se[Ge][ye],Ai=se[Ri][ye],Fi=se[Ui][be],Wi=se[Ge][be];return(Qe-Pe)*(se[Ri][be]-Fi)-(Ai-Pe)*(Wi-Fi)<0?"clockwise":"counterclockwise"},_e=se=>se instanceof Array?se.map(_e):parseFloat(se);class Ce extends Map{constructor(){super(),this.binders=[]}add(ye,be){this.has(ye)||this.set(ye,be)}addBinder(ye){this.binders.push(ye)}bindAll(){this.binders.forEach(ye=>ye.bind())}}return{purgeProps:(se,ye)=>{if(se){let be=Object.assign({},se);if(ye)for(let Ge of ye)delete be[Ge];return be}return{}},mergeProps:(se,ye)=>(se=se||{},ye=ye||{},Object.assign(se,ye)),first:pt,last:yt,coordsToKey:ct,addToMap:Bt,removeFromMap:Kt,getFirstFromMap:Yt,isRing:ae,ringDirection:Be,ptInsidePolygon:(se,ye,be,Ge)=>{be=be||0,Ge=Ge||1;let Ui=!1;for(let Ri=0,Pe=ye.length-1;Ri<ye.length;Pe=Ri++)(ye[Ri][be]<=se[be]&&se[be]<ye[Pe][be]||ye[Pe][be]<=se[be]&&se[be]<ye[Ri][be])&&se[Ge]<(ye[Pe][Ge]-ye[Ri][Ge])*(se[be]-ye[Ri][be])/(ye[Pe][be]-ye[Ri][be])+ye[Ri][Ge]&&(Ui=!Ui);return Ui},strToFloat:_e,RefElements:Ce,LateBinder:class{constructor(se,ye,be,Ge){this.container=se,this.valueFunc=ye,this.ctx=be,this.args=Ge}bind(){let se=this.valueFunc.apply(this.ctx,this.args);if(this.container instanceof Array){let ye=this.container.indexOf(this);if(ye>=0){let be=[ye,1];se&&be.push(se),[].splice.apply(this.container,be)}}else if(typeof this.container=="object"){let ye=Object.keys(this.container).find(be=>this.container[be]===this);ye&&(se?this.container[ye]=se:delete this.container[ye])}}},WayCollection:class extends Array{constructor(){super(),this.firstMap={},this.lastMap={}}addWay(se){(se=se.toCoordsArray()).length>0&&(this.push(se),Bt(this.firstMap,ct(pt(se)),se),Bt(this.lastMap,ct(yt(se)),se))}toStrings(){let se=[],ye=null;for(;ye=this.shift();){Kt(this.firstMap,ct(pt(ye)),ye),Kt(this.lastMap,ct(yt(ye)),ye);let be=ye,Ge=null;do{let Ui=ct(yt(be)),Ri=!1;Ge=Yt(this.firstMap,Ui),Ge||(Ge=Yt(this.lastMap,Ui),Ri=!0),Ge&&(this.splice(this.indexOf(Ge),1),Kt(this.firstMap,ct(pt(Ge)),Ge),Kt(this.lastMap,ct(yt(Ge)),Ge),Ri&&(Ge.length>be.length&&([be,Ge]=[Ge,be]),Ge.reverse()),be=be.concat(Ge.slice(1)))}while(Ge);se.push(_e(be))}return se}toRings(se){let ye=this.toStrings(),be=[],Ge=null;for(;Ge=ye.shift();)ae(Ge)&&(Be(Ge)!==se&&Ge.reverse(),be.push(Ge));return be}}}})(),Cr={building:{},highway:{whitelist:["services","rest_area","escape","elevator"]},natural:{blacklist:["coastline","cliff","ridge","arete","tree_row"]},landuse:{},waterway:{whitelist:["riverbank","dock","boatyard","dam"]},amenity:{},leisure:{},barrier:{whitelist:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},railway:{whitelist:["station","turntable","roundhouse","platform"]},area:{},boundary:{},man_made:{blacklist:["cutline","embankment","pipeline"]},power:{whitelist:["plant","substation","generator","transformer"]},place:{},shop:{},aeroway:{blacklist:["taxiway"]},tourism:{},historic:{},public_transport:{},office:{},"building:part":{},military:{},ruins:{},"area:highway":{},craft:{},golf:{},indoor:{}},ki=(()=>{let{first:pt,last:yt,coordsToKey:ct,addToMap:Bt,removeFromMap:Kt,getFirstFromMap:Yt,isRing:ae,ringDirection:Be,ptInsidePolygon:_e,strToFloat:Ce,LateBinder:se,WayCollection:ye}=zi,be=Cr;class Ge{constructor(Qe,Ai,Fi){this.type=Qe,this.id=Ai,this.refElems=Fi,this.tags={},this.props={id:this.getCompositeId()},this.refCount=0,this.hasTag=!1,Fi&&Fi.add(this.getCompositeId(),this)}addTags(Qe){this.tags=Object.assign(this.tags,Qe),this.hasTag=!!Qe}addTag(Qe,Ai){this.tags[Qe]=Ai,this.hasTag=!!Qe}addProp(Qe,Ai){this.props[Qe]=Ai}addProps(Qe){this.props=Object.assign(this.props,Qe)}getCompositeId(){return`${this.type}/${this.id}`}getProps(){return Object.assign(this.props,this.tags)}toFeatureArray(){return[]}}class Ui extends Ge{constructor(Qe,Ai){super("node",Qe,Ai),this.latLng=null}setLatLng(Qe){this.latLng=Qe}toFeatureArray(){return this.latLng?[{type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"Point",coordinates:Ce([this.latLng.lon,this.latLng.lat])}}]:[]}getLatLng(){return this.latLng}}class Ri extends Ge{constructor(Qe,Ai){super("way",Qe,Ai),this.latLngArray=[],this.isPolygon=!1}addLatLng(Qe){this.latLngArray.push(Qe)}setLatLngArray(Qe){this.latLngArray=Qe}addNodeRef(Qe){let Ai=new se(this.latLngArray,function(Fi){let Wi=this.refElems.get(`node/${Fi}`);if(Wi)return Wi.refCount++,Wi.getLatLng()},this,[Qe]);this.latLngArray.push(Ai),this.refElems.addBinder(Ai)}analyzeGeometryType(Qe,Ai){let Fi=be[Qe];Fi&&(this.isPolygon=!0,Fi.whitelist?this.isPolygon=Fi.whitelist.indexOf(Ai)>=0:Fi.blacklist&&(this.isPolygon=!(Fi.blacklist.indexOf(Ai)>=0)))}addTags(Qe){super.addTags(Qe);for(let[Ai,Fi]of Object.entries(Qe))this.analyzeGeometryType(Ai,Fi)}addTag(Qe,Ai){super.addTag(Qe,Ai),this.analyzeGeometryType(Qe,Ai)}toCoordsArray(){return this.latLngArray.map(Qe=>[Qe.lon,Qe.lat])}toFeatureArray(){let Qe=this.toCoordsArray();if(Qe.length>1){Qe=Ce(Qe);let Ai={type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"LineString",coordinates:Qe}};return this.isPolygon&&ae(Qe)?(Be(Qe)!=="counterclockwise"&&Qe.reverse(),Ai.geometry={type:"Polygon",coordinates:[Qe]},[Ai]):[Ai]}return[]}}return{Node:Ui,Way:Ri,Relation:class extends Ge{constructor(Pe,Qe){super("relation",Pe,Qe),this.relations=[],this.nodes=[],this.bounds=null}setBounds(Pe){this.bounds=Pe}addMember(Pe){switch(Pe.type){case"relation":let Qe=new se(this.relations,function(Wi){let nr=this.refElems.get(`relation/${Wi}`);if(nr)return nr.refCount++,nr},this,[Pe.ref]);this.relations.push(Qe),this.refElems.addBinder(Qe);break;case"way":Pe.role||(Pe.role="");let Ai=this[Pe.role];if(Ai||(Ai=this[Pe.role]=[]),Pe.geometry){let Wi=new Ri(Pe.ref,this.refElems);Wi.setLatLngArray(Pe.geometry),Wi.refCount++,Ai.push(Wi)}else if(Pe.nodes){let Wi=new Ri(Pe.ref,this.refElems);for(let nr of Pe.nodes)Wi.addNodeRef(nr);Wi.refCount++,Ai.push(Wi)}else{let Wi=new se(Ai,function(nr){let ai=this.refElems.get(`way/${nr}`);if(ai)return ai.refCount++,ai},this,[Pe.ref]);Ai.push(Wi),this.refElems.addBinder(Wi)}break;case"node":let Fi=null;if(Pe.lat&&Pe.lon){Fi=new Ui(Pe.ref,this.refElems),Fi.setLatLng({lon:Pe.lon,lat:Pe.lat}),Pe.tags&&Fi.addTags(Pe.tags);for(let[Wi,nr]of Object.entries(Pe))["id","type","lat","lon"].indexOf(Wi)<0&&Fi.addProp(Wi,nr);Fi.refCount++,this.nodes.push(Fi)}else{let Wi=new se(this.nodes,function(nr){let ai=this.refElems.get(`node/${nr}`);if(ai)return ai.refCount++,ai},this,[Pe.ref]);this.nodes.push(Wi),this.refElems.addBinder(Wi)}}}toFeatureArray(){let Pe=[],Qe=[],Ai=[],Fi=["outer","inner",""];for(let ai of this.relations)if(ai)for(let dr of Fi){let Or=ai[dr];if(Or){let Ur=this[dr];Ur?[].splice.apply(Ur,[Ur.length,0].concat(Or)):this[dr]=Or}}for(let ai of Fi){let dr=this[ai];if(dr){this[ai]=new ye;for(let Or of dr)this[ai].addWay(Or)}}let Wi=null,nr={type:"Feature",id:this.getCompositeId(),bbox:this.bounds,properties:this.getProps()};this.bounds||delete nr.bbox,this.outer?(Wi=((ai,dr)=>{let Or=ai?ai.toRings("counterclockwise"):[],Ur=dr?dr.toRings("clockwise"):[];if(Or.length>0){let _n=[],vn=null;for(vn of Or)_n.push([vn]);for(;vn=Ur.shift();)for(let ws in Or)if(_e(pt(vn),Or[ws])){_n[ws].push(vn);break}return _n.length===1?{type:"Polygon",coordinates:_n[0]}:{type:"MultiPolygon",coordinates:_n}}return null})(this.outer,this.inner),Wi&&(nr.geometry=Wi,Pe.push(nr))):this[""]&&(Wi=(ai=>{let dr=ai?ai.toStrings():[];return dr.length>0?dr.length===1?{type:"LineString",coordinates:dr[0]}:{type:"MultiLineString",coordinates:dr}:null})(this[""]),Wi&&(nr.geometry=Wi,Qe.push(nr)));for(let ai of this.nodes)Ai=Ai.concat(ai.toFeatureArray());return Pe.concat(Qe).concat(Ai)}}}})(),fr=(()=>{function pt(ct){return ct.match(/^(.+?)\[(.+?)\]>$/g)!=null}function yt(ct){let Bt=/^(.+?)\[(.+?)\]>$/g.exec(ct);return Bt?{evt:Bt[1]+">",exp:Bt[2]}:{evt:ct}}return class{constructor(ct){ct&&(this.queryParent=!!ct.queryParent,this.progressive=ct.progressive,this.queryParent&&(this.parentMap=new WeakMap)),this.evtListeners={}}parse(ct,Bt,Kt){Kt=Kt?Kt+".":"";let Yt=/<([^ >\/]+)(.*?)>/gm,ae=null,Be=[];for(;ae=Yt.exec(ct);){let _e=ae[1],Ce={$tag:_e},se=Kt+_e,ye=ae[2].trim(),be=!1;(ye.endsWith("/")||_e.startsWith("?")||_e.startsWith("!"))&&(be=!0);let Ge=/([^ ]+?)="(.+?)"/g,Ui=/([^ ]+?)='(.+?)'/g,Ri=null,Pe=!1;for(;Ri=Ge.exec(ye);)Pe=!0,Ce[Ri[1]]=Ri[2];if(!Pe)for(;Ri=Ui.exec(ye);)Pe=!0,Ce[Ri[1]]=Ri[2];if(Pe||ye===""||(Ce.text=ye),this.progressive&&this.emit(`<${se}>`,Ce,Bt),!be){let Qe=new RegExp(`([^]+?)</${_e}>`,"g");Qe.lastIndex=Yt.lastIndex;let Ai=Qe.exec(ct);if(Ai&&Ai[1]){Yt.lastIndex=Qe.lastIndex;let Fi=this.parse(Ai[1],Ce,se);Fi.length>0?Ce.$innerNodes=Fi:Ce.$innerText=Ai[1]}}this.queryParent&&Bt&&this.parentMap.set(Ce,Bt),this.progressive&&this.emit(`</${se}>`,Ce,Bt),Be.push(Ce)}return Be}getParent(ct){return this.queryParent?this.parentMap.get(ct):null}#t(ct,Bt){let Kt=this.evtListeners[ct];Kt?Kt.push(Bt):this.evtListeners[ct]=[Bt]}addListener(ct,Bt){pt(ct)&&(ct=yt(ct),Bt.condition=function(Kt){let Yt="return "+Kt.replace(/(\$.+?)(?=[=!.])/g,"node.$&")+";";return new Function("node",Yt)}(ct.exp),ct=ct.evt),this.#t(ct,Bt)}#e(ct,Bt){let Kt=this.evtListeners[ct],Yt=null;Kt&&(Yt=Kt.indexOf(Bt))>=0&&Kt.splice(Yt,1)}removeListener(ct,Bt){pt(ct)&&(ct=(ct=yt(ct)).evt),this.#e(ct,Bt)}emit(ct,...Bt){let Kt=this.evtListeners[ct];if(Kt)for(let Yt of Kt)Yt.condition?Yt.condition.apply(null,Bt)===!0&&Yt.apply(null,Bt):Yt.apply(null,Bt)}on(ct,Bt){this.addListener(ct,Bt)}off(ct,Bt){this.removeListener(ct,Bt)}}})();let{Node:br,Way:Tr,Relation:Dt}=ki,{purgeProps:Ke,RefElements:Te}=zi,or=fr;var Er=(pt,yt)=>{let ct=!1,Bt=!1,Kt=!0;(_e=>{if(_e){ct=!(!_e.completeFeature&&!_e.allFeatures),Bt=!!_e.renderTagged;let Ce=_e.suppressWay||_e.excludeWay;Ce===void 0||Ce||(Kt=!1)}})(yt);let Yt=(_e=>_e.elements?"json":_e.indexOf("<osm")>=0?"xml":_e.trim().startsWith("{")?"json-raw":"invalid")(pt),ae=new Te,Be=[];Yt==="json-raw"&&(Yt=(pt=JSON.parse(pt)).elements?"json":"invalid"),Yt==="json"?(_e=>{for(let Ce of _e.elements)switch(Ce.type){case"node":let se=new br(Ce.id,ae);Ce.tags&&se.addTags(Ce.tags),se.addProps(Ke(Ce,["id","type","tags","lat","lon"])),se.setLatLng(Ce);break;case"way":let ye=new Tr(Ce.id,ae);if(Ce.tags&&ye.addTags(Ce.tags),ye.addProps(Ke(Ce,["id","type","tags","nodes","geometry"])),Ce.nodes)for(let Ge of Ce.nodes)ye.addNodeRef(Ge);else Ce.geometry&&ye.setLatLngArray(Ce.geometry);break;case"relation":let be=new Dt(Ce.id,ae);if(Ce.bounds&&be.setBounds([parseFloat(Ce.bounds.minlon),parseFloat(Ce.bounds.minlat),parseFloat(Ce.bounds.maxlon),parseFloat(Ce.bounds.maxlat)]),Ce.tags&&be.addTags(Ce.tags),be.addProps(Ke(Ce,["id","type","tags","bounds","members"])),Ce.members)for(let Ge of Ce.members)be.addMember(Ge)}})(pt):Yt==="xml"&&(_e=>{let Ce=new or({progressive:!0});Ce.on("</osm.node>",se=>{let ye=new br(se.id,ae);for(let[be,Ge]of Object.entries(se))!be.startsWith("$")&&["id","lon","lat"].indexOf(be)<0&&ye.addProp(be,Ge);if(ye.setLatLng(se),se.$innerNodes)for(let be of se.$innerNodes)be.$tag==="tag"&&ye.addTag(be.k,be.v)}),Ce.on("</osm.way>",se=>{let ye=new Tr(se.id,ae);for(let[be,Ge]of Object.entries(se))!be.startsWith("$")&&["id"].indexOf(be)<0&&ye.addProp(be,Ge);if(se.$innerNodes)for(let be of se.$innerNodes)be.$tag==="nd"?be.lon&&be.lat?ye.addLatLng(be):be.ref&&ye.addNodeRef(be.ref):be.$tag==="tag"&&ye.addTag(be.k,be.v)}),Ce.on("<osm.relation>",se=>{new Dt(se.id,ae)}),Ce.on("</osm.relation.member>",(se,ye)=>{let be=ae.get(`relation/${ye.id}`),Ge={type:se.type,role:se.role?se.role:"",ref:se.ref};if(se.lat&&se.lon){Ge.lat=se.lat,Ge.lon=se.lon,Ge.tags={};for(let[Ui,Ri]of Object.entries(se))!Ui.startsWith("$")&&["type","lat","lon"].indexOf(Ui)<0&&(Ge[Ui]=Ri)}if(se.$innerNodes){let Ui=[],Ri=[];for(let Pe of se.$innerNodes)Pe.lat&&Pe.lon?Ui.push(Pe):Ri.push(Pe.ref);Ui.length>0?Ge.geometry=Ui:Ri.length>0&&(Ge.nodes=Ri)}be.addMember(Ge)}),Ce.on("</osm.relation.bounds>",(se,ye)=>{ae.get(`relation/${ye.id}`).setBounds([parseFloat(se.minlon),parseFloat(se.minlat),parseFloat(se.maxlon),parseFloat(se.maxlat)])}),Ce.on("</osm.relation.tag>",(se,ye)=>{ae.get(`relation/${ye.id}`).addTag(se.k,se.v)}),Ce.parse(_e)})(pt),ae.bindAll();for(let _e of ae.values())if(_e.refCount<=0||_e.hasTag&&Bt&&!(_e instanceof Tr&&Kt)){let Ce=_e.toFeatureArray();if(_e instanceof Dt&&!ct&&Ce.length>0)return Ce[0].geometry;Be=Be.concat(Ce)}return{type:"FeatureCollection",features:Be}},Ji=t(Er);let Mr=["topojson","osm","kml","gpx","tcx","csv","tsv","polyline"];class vs{constructor(yt,ct,Bt={}){this.blankGeoJSON=()=>({type:"FeatureCollection",features:[]}),this._rawData=ct,this._format=yt,this._options=Bt;let Kt={topojson:this.loadTopoJson,osm:this.loadOsm,kml:this.loadXml,gpx:this.loadXml,tcx:this.loadXml,csv:this.loadCsv,tsv:this.loadCsv,polyline:this.loadPolyline};this._conversionFn=Kt[yt]}async convert(){return this._conversionFn?this._conversionFn():new Promise((yt,ct)=>ct(`No converter exists for ${this._format}`))}async loadXml(){return Ni[this._format](new DOMParser().parseFromString(this._rawData,"text/xml"))}async loadCsv(){let yt=this._options.csvOptions||{};return this._format==="tsv"&&(yt.delimiter="	"),await new Promise((ct,Bt)=>{_t.csv2geojson(this._rawData,yt,(Kt,Yt)=>{Kt?Bt(Kt):ct(Yt)})})}async loadTopoJson(){let yt={};try{yt=JSON.parse(this._rawData)}catch{throw"Invalid TopoJson"}let ct=this.blankGeoJSON();return yt.type==="Topology"&&yt.objects!==void 0&&(ct={type:"FeatureCollection",features:ct.features=Object.keys(yt.objects).map(Bt=>{return Kt=yt,typeof(Yt=Bt)=="string"&&(Yt=Kt.objects[Yt]),Yt.type==="GeometryCollection"?{type:"FeatureCollection",features:Yt.geometries.map(function(ae){return ie(Kt,ae)})}:ie(Kt,Yt);var Kt,Yt}).reduce((Bt,Kt)=>[...Bt,...Kt.features],[])}),ct}async loadOsm(){return Ji(this._rawData)}async loadPolyline(){let yt=this._options.polylineOptions||{};return await new Promise((ct,Bt)=>{try{let Kt=rr.toGeoJSON(this._rawData,yt.precision),Yt=Kt;yt.type==="point"?Kt.coordinates.length===1?Yt={type:"Point",coordinates:Kt.coordinates[0]}:console.warn("Cannot convert polyline to "+yt.type):yt.type==="polygon"&&(Kt.coordinates[0][0]===Kt.coordinates[Kt.coordinates.length-1][0]&&Kt.coordinates[0][1]===Kt.coordinates[Kt.coordinates.length-1][1]?Yt={type:"Polygon",coordinates:[Kt.coordinates]}:console.warn("Cannot convert polyline to "+yt.type)),ct({type:"FeatureCollection",features:[{type:"Feature",geometry:Yt,properties:yt.properties||{}}]})}catch(Kt){Bt(Kt)}})}}var Sr=null;try{var xr=typeof md<"u"&&typeof md.require=="function"&&gd("worker_threads")||typeof __non_webpack_require__=="function"&&__non_webpack_require__("worker_threads")||typeof gd=="function"&&gd("worker_threads");Sr=xr.Worker}catch{}function Wo(pt,yt,ct){var Bt=yt===void 0?null:yt,Kt=function(Be,_e){return Buffer.from(Be,"base64").toString(_e?"utf16":"utf8")}(pt,ct!==void 0&&ct),Yt=Kt.indexOf(`
`,10)+1,ae=Kt.substring(Yt)+(Bt?"//# sourceMappingURL="+Bt:"");return function(Be){return new Sr(ae,Object.assign({},Be,{eval:!0}))}}function an(pt,yt,ct){var Bt=yt===void 0?null:yt,Kt=function(_e,Ce){var se=atob(_e);if(Ce){for(var ye=new Uint8Array(se.length),be=0,Ge=se.length;be<Ge;++be)ye[be]=se.charCodeAt(be);return String.fromCharCode.apply(null,new Uint16Array(ye.buffer))}return se}(pt,ct!==void 0&&ct),Yt=Kt.indexOf(`
`,10)+1,ae=Kt.substring(Yt)+(Bt?"//# sourceMappingURL="+Bt:""),Be=new Blob([ae],{type:"application/javascript"});return URL.createObjectURL(Be)}var Dn=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",Oo,As,Qr,zo=(Oo="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCWZ1bmN0aW9uIGdldERlZmF1bHRFeHBvcnRGcm9tQ2pzICh4KSB7CgkJcmV0dXJuIHggJiYgeC5fX2VzTW9kdWxlICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh4LCAnZGVmYXVsdCcpID8geFsnZGVmYXVsdCddIDogeDsKCX0KCglmdW5jdGlvbiBnZXRBdWdtZW50ZWROYW1lc3BhY2UobikgewoJICBpZiAobi5fX2VzTW9kdWxlKSByZXR1cm4gbjsKCSAgdmFyIGYgPSBuLmRlZmF1bHQ7CgkJaWYgKHR5cGVvZiBmID09ICJmdW5jdGlvbiIpIHsKCQkJdmFyIGEgPSBmdW5jdGlvbiBhICgpIHsKCQkJCWlmICh0aGlzIGluc3RhbmNlb2YgYSkgewoJICAgICAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoZiwgYXJndW1lbnRzLCB0aGlzLmNvbnN0cnVjdG9yKTsKCQkJCX0KCQkJCXJldHVybiBmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgkJCX07CgkJCWEucHJvdG90eXBlID0gZi5wcm90b3R5cGU7CgkgIH0gZWxzZSBhID0ge307CgkgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCAnX19lc01vZHVsZScsIHt2YWx1ZTogdHJ1ZX0pOwoJCU9iamVjdC5rZXlzKG4pLmZvckVhY2goZnVuY3Rpb24gKGspIHsKCQkJdmFyIGQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sIGspOwoJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoYSwgaywgZC5nZXQgPyBkIDogewoJCQkJZW51bWVyYWJsZTogdHJ1ZSwKCQkJCWdldDogZnVuY3Rpb24gKCkgewoJCQkJCXJldHVybiBuW2tdOwoJCQkJfQoJCQl9KTsKCQl9KTsKCQlyZXR1cm4gYTsKCX0KCglmdW5jdGlvbiBvYmplY3RDb252ZXJ0ZXIoY29sdW1ucykgewoJICByZXR1cm4gbmV3IEZ1bmN0aW9uKCJkIiwgInJldHVybiB7IiArIGNvbHVtbnMubWFwKGZ1bmN0aW9uKG5hbWUsIGkpIHsKCSAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobmFtZSkgKyAiOiBkWyIgKyBpICsgIl0iOwoJICB9KS5qb2luKCIsIikgKyAifSIpOwoJfQoKCWZ1bmN0aW9uIGN1c3RvbUNvbnZlcnRlcihjb2x1bW5zLCBmKSB7CgkgIHZhciBvYmplY3QgPSBvYmplY3RDb252ZXJ0ZXIoY29sdW1ucyk7CgkgIHJldHVybiBmdW5jdGlvbihyb3csIGkpIHsKCSAgICByZXR1cm4gZihvYmplY3Qocm93KSwgaSwgY29sdW1ucyk7CgkgIH07Cgl9CgoJLy8gQ29tcHV0ZSB1bmlxdWUgY29sdW1ucyBpbiBvcmRlciBvZiBkaXNjb3ZlcnkuCglmdW5jdGlvbiBpbmZlckNvbHVtbnMocm93cykgewoJICB2YXIgY29sdW1uU2V0ID0gT2JqZWN0LmNyZWF0ZShudWxsKSwKCSAgICAgIGNvbHVtbnMgPSBbXTsKCgkgIHJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpIHsKCSAgICBmb3IgKHZhciBjb2x1bW4gaW4gcm93KSB7CgkgICAgICBpZiAoIShjb2x1bW4gaW4gY29sdW1uU2V0KSkgewoJICAgICAgICBjb2x1bW5zLnB1c2goY29sdW1uU2V0W2NvbHVtbl0gPSBjb2x1bW4pOwoJICAgICAgfQoJICAgIH0KCSAgfSk7CgoJICByZXR1cm4gY29sdW1uczsKCX0KCglmdW5jdGlvbiBkc3YkMShkZWxpbWl0ZXIpIHsKCSAgdmFyIHJlRm9ybWF0ID0gbmV3IFJlZ0V4cCgiW1wiIiArIGRlbGltaXRlciArICJcbl0iKSwKCSAgICAgIGRlbGltaXRlckNvZGUgPSBkZWxpbWl0ZXIuY2hhckNvZGVBdCgwKTsKCgkgIGZ1bmN0aW9uIHBhcnNlKHRleHQsIGYpIHsKCSAgICB2YXIgY29udmVydCwgY29sdW1ucywgcm93cyA9IHBhcnNlUm93cyh0ZXh0LCBmdW5jdGlvbihyb3csIGkpIHsKCSAgICAgIGlmIChjb252ZXJ0KSByZXR1cm4gY29udmVydChyb3csIGkgLSAxKTsKCSAgICAgIGNvbHVtbnMgPSByb3csIGNvbnZlcnQgPSBmID8gY3VzdG9tQ29udmVydGVyKHJvdywgZikgOiBvYmplY3RDb252ZXJ0ZXIocm93KTsKCSAgICB9KTsKCSAgICByb3dzLmNvbHVtbnMgPSBjb2x1bW5zOwoJICAgIHJldHVybiByb3dzOwoJICB9CgoJICBmdW5jdGlvbiBwYXJzZVJvd3ModGV4dCwgZikgewoJICAgIHZhciBFT0wgPSB7fSwgLy8gc2VudGluZWwgdmFsdWUgZm9yIGVuZC1vZi1saW5lCgkgICAgICAgIEVPRiA9IHt9LCAvLyBzZW50aW5lbCB2YWx1ZSBmb3IgZW5kLW9mLWZpbGUKCSAgICAgICAgcm93cyA9IFtdLCAvLyBvdXRwdXQgcm93cwoJICAgICAgICBOID0gdGV4dC5sZW5ndGgsCgkgICAgICAgIEkgPSAwLCAvLyBjdXJyZW50IGNoYXJhY3RlciBpbmRleAoJICAgICAgICBuID0gMCwgLy8gdGhlIGN1cnJlbnQgbGluZSBudW1iZXIKCSAgICAgICAgdCwgLy8gdGhlIGN1cnJlbnQgdG9rZW4KCSAgICAgICAgZW9sOyAvLyBpcyB0aGUgY3VycmVudCB0b2tlbiBmb2xsb3dlZCBieSBFT0w/CgoJICAgIGZ1bmN0aW9uIHRva2VuKCkgewoJICAgICAgaWYgKEkgPj0gTikgcmV0dXJuIEVPRjsgLy8gc3BlY2lhbCBjYXNlOiBlbmQgb2YgZmlsZQoJICAgICAgaWYgKGVvbCkgcmV0dXJuIGVvbCA9IGZhbHNlLCBFT0w7IC8vIHNwZWNpYWwgY2FzZTogZW5kIG9mIGxpbmUKCgkgICAgICAvLyBzcGVjaWFsIGNhc2U6IHF1b3RlcwoJICAgICAgdmFyIGogPSBJLCBjOwoJICAgICAgaWYgKHRleHQuY2hhckNvZGVBdChqKSA9PT0gMzQpIHsKCSAgICAgICAgdmFyIGkgPSBqOwoJICAgICAgICB3aGlsZSAoaSsrIDwgTikgewoJICAgICAgICAgIGlmICh0ZXh0LmNoYXJDb2RlQXQoaSkgPT09IDM0KSB7CgkgICAgICAgICAgICBpZiAodGV4dC5jaGFyQ29kZUF0KGkgKyAxKSAhPT0gMzQpIGJyZWFrOwoJICAgICAgICAgICAgKytpOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBJID0gaSArIDI7CgkgICAgICAgIGMgPSB0ZXh0LmNoYXJDb2RlQXQoaSArIDEpOwoJICAgICAgICBpZiAoYyA9PT0gMTMpIHsKCSAgICAgICAgICBlb2wgPSB0cnVlOwoJICAgICAgICAgIGlmICh0ZXh0LmNoYXJDb2RlQXQoaSArIDIpID09PSAxMCkgKytJOwoJICAgICAgICB9IGVsc2UgaWYgKGMgPT09IDEwKSB7CgkgICAgICAgICAgZW9sID0gdHJ1ZTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGV4dC5zbGljZShqICsgMSwgaSkucmVwbGFjZSgvIiIvZywgIlwiIik7CgkgICAgICB9CgoJICAgICAgLy8gY29tbW9uIGNhc2U6IGZpbmQgbmV4dCBkZWxpbWl0ZXIgb3IgbmV3bGluZQoJICAgICAgd2hpbGUgKEkgPCBOKSB7CgkgICAgICAgIHZhciBrID0gMTsKCSAgICAgICAgYyA9IHRleHQuY2hhckNvZGVBdChJKyspOwoJICAgICAgICBpZiAoYyA9PT0gMTApIGVvbCA9IHRydWU7IC8vIFxuCgkgICAgICAgIGVsc2UgaWYgKGMgPT09IDEzKSB7IGVvbCA9IHRydWU7IGlmICh0ZXh0LmNoYXJDb2RlQXQoSSkgPT09IDEwKSArK0ksICsrazsgfSAvLyBccnxcclxuCgkgICAgICAgIGVsc2UgaWYgKGMgIT09IGRlbGltaXRlckNvZGUpIGNvbnRpbnVlOwoJICAgICAgICByZXR1cm4gdGV4dC5zbGljZShqLCBJIC0gayk7CgkgICAgICB9CgoJICAgICAgLy8gc3BlY2lhbCBjYXNlOiBsYXN0IHRva2VuIGJlZm9yZSBFT0YKCSAgICAgIHJldHVybiB0ZXh0LnNsaWNlKGopOwoJICAgIH0KCgkgICAgd2hpbGUgKCh0ID0gdG9rZW4oKSkgIT09IEVPRikgewoJICAgICAgdmFyIGEgPSBbXTsKCSAgICAgIHdoaWxlICh0ICE9PSBFT0wgJiYgdCAhPT0gRU9GKSB7CgkgICAgICAgIGEucHVzaCh0KTsKCSAgICAgICAgdCA9IHRva2VuKCk7CgkgICAgICB9CgkgICAgICBpZiAoZiAmJiAoYSA9IGYoYSwgbisrKSkgPT0gbnVsbCkgY29udGludWU7CgkgICAgICByb3dzLnB1c2goYSk7CgkgICAgfQoKCSAgICByZXR1cm4gcm93czsKCSAgfQoKCSAgZnVuY3Rpb24gZm9ybWF0KHJvd3MsIGNvbHVtbnMpIHsKCSAgICBpZiAoY29sdW1ucyA9PSBudWxsKSBjb2x1bW5zID0gaW5mZXJDb2x1bW5zKHJvd3MpOwoJICAgIHJldHVybiBbY29sdW1ucy5tYXAoZm9ybWF0VmFsdWUpLmpvaW4oZGVsaW1pdGVyKV0uY29uY2F0KHJvd3MubWFwKGZ1bmN0aW9uKHJvdykgewoJICAgICAgcmV0dXJuIGNvbHVtbnMubWFwKGZ1bmN0aW9uKGNvbHVtbikgewoJICAgICAgICByZXR1cm4gZm9ybWF0VmFsdWUocm93W2NvbHVtbl0pOwoJICAgICAgfSkuam9pbihkZWxpbWl0ZXIpOwoJICAgIH0pKS5qb2luKCJcbiIpOwoJICB9CgoJICBmdW5jdGlvbiBmb3JtYXRSb3dzKHJvd3MpIHsKCSAgICByZXR1cm4gcm93cy5tYXAoZm9ybWF0Um93KS5qb2luKCJcbiIpOwoJICB9CgoJICBmdW5jdGlvbiBmb3JtYXRSb3cocm93KSB7CgkgICAgcmV0dXJuIHJvdy5tYXAoZm9ybWF0VmFsdWUpLmpvaW4oZGVsaW1pdGVyKTsKCSAgfQoKCSAgZnVuY3Rpb24gZm9ybWF0VmFsdWUodGV4dCkgewoJICAgIHJldHVybiB0ZXh0ID09IG51bGwgPyAiIgoJICAgICAgICA6IHJlRm9ybWF0LnRlc3QodGV4dCArPSAiIikgPyAiXCIiICsgdGV4dC5yZXBsYWNlKC9cIi9nLCAiXCJcIiIpICsgIlwiIgoJICAgICAgICA6IHRleHQ7CgkgIH0KCgkgIHJldHVybiB7CgkgICAgcGFyc2U6IHBhcnNlLAoJICAgIHBhcnNlUm93czogcGFyc2VSb3dzLAoJICAgIGZvcm1hdDogZm9ybWF0LAoJICAgIGZvcm1hdFJvd3M6IGZvcm1hdFJvd3MKCSAgfTsKCX0KCgl2YXIgY3N2ID0gZHN2JDEoIiwiKTsKCgl2YXIgY3N2UGFyc2UgPSBjc3YucGFyc2U7Cgl2YXIgY3N2UGFyc2VSb3dzID0gY3N2LnBhcnNlUm93czsKCXZhciBjc3ZGb3JtYXQgPSBjc3YuZm9ybWF0OwoJdmFyIGNzdkZvcm1hdFJvd3MgPSBjc3YuZm9ybWF0Um93czsKCgl2YXIgdHN2ID0gZHN2JDEoIlx0Iik7CgoJdmFyIHRzdlBhcnNlID0gdHN2LnBhcnNlOwoJdmFyIHRzdlBhcnNlUm93cyA9IHRzdi5wYXJzZVJvd3M7Cgl2YXIgdHN2Rm9ybWF0ID0gdHN2LmZvcm1hdDsKCXZhciB0c3ZGb3JtYXRSb3dzID0gdHN2LmZvcm1hdFJvd3M7CgoJdmFyIGQzRHN2ID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoewoJCV9fcHJvdG9fXzogbnVsbCwKCQljc3ZGb3JtYXQ6IGNzdkZvcm1hdCwKCQljc3ZGb3JtYXRSb3dzOiBjc3ZGb3JtYXRSb3dzLAoJCWNzdlBhcnNlOiBjc3ZQYXJzZSwKCQljc3ZQYXJzZVJvd3M6IGNzdlBhcnNlUm93cywKCQlkc3ZGb3JtYXQ6IGRzdiQxLAoJCXRzdkZvcm1hdDogdHN2Rm9ybWF0LAoJCXRzdkZvcm1hdFJvd3M6IHRzdkZvcm1hdFJvd3MsCgkJdHN2UGFyc2U6IHRzdlBhcnNlLAoJCXRzdlBhcnNlUm93czogdHN2UGFyc2VSb3dzCgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoZDNEc3YpOwoKCXZhciBzZXhhZ2VzaW1hbCQxID0ge2V4cG9ydHM6IHt9fTsKCglzZXhhZ2VzaW1hbCQxLmV4cG9ydHMgPSBlbGVtZW50OwoJc2V4YWdlc2ltYWwkMS5leHBvcnRzLnBhaXIgPSBwYWlyOwoJc2V4YWdlc2ltYWwkMS5leHBvcnRzLmZvcm1hdCA9IGZvcm1hdDsKCXNleGFnZXNpbWFsJDEuZXhwb3J0cy5mb3JtYXRQYWlyID0gZm9ybWF0UGFpcjsKCXNleGFnZXNpbWFsJDEuZXhwb3J0cy5jb29yZFRvRE1TID0gY29vcmRUb0RNUzsKCgoJZnVuY3Rpb24gZWxlbWVudChpbnB1dCwgZGltcykgewoJICB2YXIgcmVzdWx0ID0gc2VhcmNoKGlucHV0LCBkaW1zKTsKCSAgcmV0dXJuIChyZXN1bHQgPT09IG51bGwpID8gbnVsbCA6IHJlc3VsdC52YWw7Cgl9CgoKCWZ1bmN0aW9uIGZvcm1hdFBhaXIoaW5wdXQpIHsKCSAgcmV0dXJuIGZvcm1hdChpbnB1dC5sYXQsICdsYXQnKSArICcgJyArIGZvcm1hdChpbnB1dC5sb24sICdsb24nKTsKCX0KCgoJLy8gSXMgMCBOb3J0aCBvciBTb3V0aD8KCWZ1bmN0aW9uIGZvcm1hdChpbnB1dCwgZGltKSB7CgkgIHZhciBkbXMgPSBjb29yZFRvRE1TKGlucHV0LCBkaW0pOwoJICByZXR1cm4gZG1zLndob2xlICsgJ8KwICcgKwoJICAgIChkbXMubWludXRlcyA/IGRtcy5taW51dGVzICsgJ1wnICcgOiAnJykgKwoJICAgIChkbXMuc2Vjb25kcyA/IGRtcy5zZWNvbmRzICsgJyIgJyA6ICcnKSArIGRtcy5kaXI7Cgl9CgoKCWZ1bmN0aW9uIGNvb3JkVG9ETVMoaW5wdXQsIGRpbSkgewoJICB2YXIgZGlycyA9IHsgbGF0OiBbJ04nLCAnUyddLCBsb246IFsnRScsICdXJ10gfVtkaW1dIHx8ICcnOwoJICB2YXIgZGlyID0gZGlyc1tpbnB1dCA+PSAwID8gMCA6IDFdOwoJICB2YXIgYWJzID0gTWF0aC5hYnMoaW5wdXQpOwoJICB2YXIgd2hvbGUgPSBNYXRoLmZsb29yKGFicyk7CgkgIHZhciBmcmFjdGlvbiA9IGFicyAtIHdob2xlOwoJICB2YXIgZnJhY3Rpb25NaW51dGVzID0gZnJhY3Rpb24gKiA2MDsKCSAgdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKGZyYWN0aW9uTWludXRlcyk7CgkgIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcigoZnJhY3Rpb25NaW51dGVzIC0gbWludXRlcykgKiA2MCk7CgoJICByZXR1cm4gewoJICAgIHdob2xlOiB3aG9sZSwKCSAgICBtaW51dGVzOiBtaW51dGVzLAoJICAgIHNlY29uZHM6IHNlY29uZHMsCgkgICAgZGlyOiBkaXIKCSAgfTsKCX0KCgoJZnVuY3Rpb24gc2VhcmNoKGlucHV0LCBkaW1zKSB7CgkgIGlmICghZGltcykgZGltcyA9ICdOU0VXJzsKCSAgaWYgKHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycpIHJldHVybiBudWxsOwoKCSAgaW5wdXQgPSBpbnB1dC50b1VwcGVyQ2FzZSgpOwoJICB2YXIgcmVnZXggPSAvXltcc1wsXSooW05TRVddKT9ccyooW1wtfFzigJR8XOKAlV0/WzAtOS5dKylbwrDCusuaXT9ccyooPzooWzAtOS5dKylbJ+KAmeKAsuKAmF1ccyopPyg/OihbMC05Ll0rKSg/OicnfCJ84oCdfOKAsylccyopPyhbTlNFV10pPy87CgoJICB2YXIgbSA9IGlucHV0Lm1hdGNoKHJlZ2V4KTsKCSAgaWYgKCFtKSByZXR1cm4gbnVsbDsgIC8vIG5vIG1hdGNoCgoJICB2YXIgbWF0Y2hlZCA9IG1bMF07CgoJICAvLyBleHRyYWN0IGRpbWVuc2lvbi4uIG1bMV0gPSBsZWFkaW5nLCBtWzVdID0gdHJhaWxpbmcKCSAgdmFyIGRpbTsKCSAgaWYgKG1bMV0gJiYgbVs1XSkgeyAgICAgICAgICAgICAgICAgLy8gaWYgbWF0Y2hlZCBib3RoLi4KCSAgICBkaW0gPSBtWzFdOyAgICAgICAgICAgICAgICAgICAgICAgLy8ga2VlcCBsZWFkaW5nCgkgICAgbWF0Y2hlZCA9IG1hdGNoZWQuc2xpY2UoMCwgLTEpOyAgIC8vIHJlbW92ZSB0cmFpbGluZyBkaW1lbnNpb24gZnJvbSBtYXRjaAoJICB9IGVsc2UgewoJICAgIGRpbSA9IG1bMV0gfHwgbVs1XTsKCSAgfQoKCSAgLy8gaWYgdW5yZWNvZ25pemVkIGRpbWVuc2lvbgoJICBpZiAoZGltICYmIGRpbXMuaW5kZXhPZihkaW0pID09PSAtMSkgcmV0dXJuIG51bGw7CgoJICAvLyBleHRyYWN0IERNUwoJICB2YXIgZGVnID0gbVsyXSA/IHBhcnNlRmxvYXQobVsyXSkgOiAwOwoJICB2YXIgbWluID0gbVszXSA/IHBhcnNlRmxvYXQobVszXSkgLyA2MCA6IDA7CgkgIHZhciBzZWMgPSBtWzRdID8gcGFyc2VGbG9hdChtWzRdKSAvIDM2MDAgOiAwOwoJICB2YXIgc2lnbiA9IChkZWcgPCAwKSA/IC0xIDogMTsKCSAgaWYgKGRpbSA9PT0gJ1MnIHx8IGRpbSA9PT0gJ1cnKSBzaWduICo9IC0xOwoKCSAgcmV0dXJuIHsKCSAgICB2YWw6IChNYXRoLmFicyhkZWcpICsgbWluICsgc2VjKSAqIHNpZ24sCgkgICAgZGltOiBkaW0sCgkgICAgbWF0Y2hlZDogbWF0Y2hlZCwKCSAgICByZW1haW46IGlucHV0LnNsaWNlKG1hdGNoZWQubGVuZ3RoKQoJICB9OwoJfQoKCglmdW5jdGlvbiBwYWlyKGlucHV0LCBkaW1zKSB7CgkgIGlucHV0ID0gaW5wdXQudHJpbSgpOwoJICB2YXIgb25lID0gc2VhcmNoKGlucHV0LCBkaW1zKTsKCSAgaWYgKCFvbmUpIHJldHVybiBudWxsOwoKCSAgaW5wdXQgPSBvbmUucmVtYWluLnRyaW0oKTsKCSAgdmFyIHR3byA9IHNlYXJjaChpbnB1dCwgZGltcyk7CgkgIGlmICghdHdvIHx8IHR3by5yZW1haW4pIHJldHVybiBudWxsOwoKCSAgaWYgKG9uZS5kaW0pIHsKCSAgICByZXR1cm4gc3dhcGRpbShvbmUudmFsLCB0d28udmFsLCBvbmUuZGltKTsKCSAgfSBlbHNlIHsKCSAgICByZXR1cm4gW29uZS52YWwsIHR3by52YWxdOwoJICB9Cgl9CgoKCWZ1bmN0aW9uIHN3YXBkaW0oYSwgYiwgZGltKSB7CgkgIGlmIChkaW0gPT09ICdOJyB8fCBkaW0gPT09ICdTJykgcmV0dXJuIFthLCBiXTsKCSAgaWYgKGRpbSA9PT0gJ1cnIHx8IGRpbSA9PT0gJ0UnKSByZXR1cm4gW2IsIGFdOwoJfQoKCXZhciBzZXhhZ2VzaW1hbEV4cG9ydHMgPSBzZXhhZ2VzaW1hbCQxLmV4cG9ydHM7CgoJdmFyIGRzdiA9IHJlcXVpcmUkJDAsCgkgICAgc2V4YWdlc2ltYWwgPSBzZXhhZ2VzaW1hbEV4cG9ydHM7CgoJdmFyIGxhdFJlZ2V4ID0gLyhMYXQpKGl0dWRlKT8vZ2ksCgkgICAgbG9uUmVnZXggPSAvKEwpKG9ufG5nKShnaXR1ZGUpPy9pOwoKCWZ1bmN0aW9uIGd1ZXNzSGVhZGVyKHJvdywgcmVnZXhwKSB7CgkgICAgdmFyIG5hbWUsIG1hdGNoLCBzY29yZTsKCSAgICBmb3IgKHZhciBmIGluIHJvdykgewoJICAgICAgICBtYXRjaCA9IGYubWF0Y2gocmVnZXhwKTsKCSAgICAgICAgaWYgKG1hdGNoICYmICghbmFtZSB8fCBtYXRjaFswXS5sZW5ndGggLyBmLmxlbmd0aCA+IHNjb3JlKSkgewoJICAgICAgICAgICAgc2NvcmUgPSBtYXRjaFswXS5sZW5ndGggLyBmLmxlbmd0aDsKCSAgICAgICAgICAgIG5hbWUgPSBmOwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiBuYW1lOwoJfQoKCWZ1bmN0aW9uIGd1ZXNzTGF0SGVhZGVyKHJvdykgeyByZXR1cm4gZ3Vlc3NIZWFkZXIocm93LCBsYXRSZWdleCk7IH0KCWZ1bmN0aW9uIGd1ZXNzTG9uSGVhZGVyKHJvdykgeyByZXR1cm4gZ3Vlc3NIZWFkZXIocm93LCBsb25SZWdleCk7IH0KCglmdW5jdGlvbiBpc0xhdChmKSB7IHJldHVybiAhIWYubWF0Y2gobGF0UmVnZXgpOyB9CglmdW5jdGlvbiBpc0xvbihmKSB7IHJldHVybiAhIWYubWF0Y2gobG9uUmVnZXgpOyB9CgoJZnVuY3Rpb24ga2V5Q291bnQobykgewoJICAgIHJldHVybiAodHlwZW9mIG8gPT0gJ29iamVjdCcpID8gT2JqZWN0LmtleXMobykubGVuZ3RoIDogMDsKCX0KCglmdW5jdGlvbiBhdXRvRGVsaW1pdGVyKHgpIHsKCSAgICB2YXIgZGVsaW1pdGVycyA9IFsnLCcsICc7JywgJ1x0JywgJ3wnXTsKCSAgICB2YXIgcmVzdWx0cyA9IFtdOwoKCSAgICBkZWxpbWl0ZXJzLmZvckVhY2goZnVuY3Rpb24gKGRlbGltaXRlcikgewoJICAgICAgICB2YXIgcmVzID0gZHN2LmRzdkZvcm1hdChkZWxpbWl0ZXIpLnBhcnNlKHgpOwoJICAgICAgICBpZiAocmVzLmxlbmd0aCA+PSAxKSB7CgkgICAgICAgICAgICB2YXIgY291bnQgPSBrZXlDb3VudChyZXNbMF0pOwoJICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoa2V5Q291bnQocmVzW2ldKSAhPT0gY291bnQpIHJldHVybjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7CgkgICAgICAgICAgICAgICAgZGVsaW1pdGVyOiBkZWxpbWl0ZXIsCgkgICAgICAgICAgICAgICAgYXJpdHk6IE9iamVjdC5rZXlzKHJlc1swXSkubGVuZ3RoLAoJICAgICAgICAgICAgfSk7CgkgICAgICAgIH0KCSAgICB9KTsKCgkgICAgaWYgKHJlc3VsdHMubGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiByZXN1bHRzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKCSAgICAgICAgICAgIHJldHVybiBiLmFyaXR5IC0gYS5hcml0eTsKCSAgICAgICAgfSlbMF0uZGVsaW1pdGVyOwoJICAgIH0gZWxzZSB7CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH0KCX0KCgkvKioKCSAqIFNpbGx5IHN0b3BnYXAgZm9yIGRzdiB0byBkMy1kc3YgdXBncmFkZQoJICoKCSAqIEBwYXJhbSB7QXJyYXl9IHggZHN2IG91dHB1dAoJICogQHJldHVybnMge0FycmF5fSBhcnJheSB3aXRob3V0IGNvbHVtbnMgbWVtYmVyCgkgKi8KCWZ1bmN0aW9uIGRlbGV0ZUNvbHVtbnMoeCkgewoJICAgIGRlbGV0ZSB4LmNvbHVtbnM7CgkgICAgcmV0dXJuIHg7Cgl9CgoJZnVuY3Rpb24gYXV0byh4KSB7CgkgICAgdmFyIGRlbGltaXRlciA9IGF1dG9EZWxpbWl0ZXIoeCk7CgkgICAgaWYgKCFkZWxpbWl0ZXIpIHJldHVybiBudWxsOwoJICAgIHJldHVybiBkZWxldGVDb2x1bW5zKGRzdi5kc3ZGb3JtYXQoZGVsaW1pdGVyKS5wYXJzZSh4KSk7Cgl9CgoJZnVuY3Rpb24gY3N2Mmdlb2pzb24oeCwgb3B0aW9ucywgY2FsbGJhY2spIHsKCgkgICAgaWYgKCFjYWxsYmFjaykgewoJICAgICAgICBjYWxsYmFjayA9IG9wdGlvbnM7CgkgICAgICAgIG9wdGlvbnMgPSB7fTsKCSAgICB9CgoJICAgIG9wdGlvbnMuZGVsaW1pdGVyID0gb3B0aW9ucy5kZWxpbWl0ZXIgfHwgJywnOwoKCSAgICB2YXIgbGF0ZmllbGQgPSBvcHRpb25zLmxhdGZpZWxkIHx8ICcnLAoJICAgICAgICBsb25maWVsZCA9IG9wdGlvbnMubG9uZmllbGQgfHwgJycsCgkgICAgICAgIGNycyA9IG9wdGlvbnMuY3JzIHx8ICcnOwoKCSAgICB2YXIgZmVhdHVyZXMgPSBbXSwKCSAgICAgICAgZmVhdHVyZWNvbGxlY3Rpb24gPSB7dHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywgZmVhdHVyZXM6IGZlYXR1cmVzfTsKCgkgICAgaWYgKGNycyAhPT0gJycpIHsKCSAgICAgICAgZmVhdHVyZWNvbGxlY3Rpb24uY3JzID0ge3R5cGU6ICduYW1lJywgcHJvcGVydGllczoge25hbWU6IGNyc319OwoJICAgIH0KCgkgICAgaWYgKG9wdGlvbnMuZGVsaW1pdGVyID09PSAnYXV0bycgJiYgdHlwZW9mIHggPT0gJ3N0cmluZycpIHsKCSAgICAgICAgb3B0aW9ucy5kZWxpbWl0ZXIgPSBhdXRvRGVsaW1pdGVyKHgpOwoJICAgICAgICBpZiAoIW9wdGlvbnMuZGVsaW1pdGVyKSB7CgkgICAgICAgICAgICBjYWxsYmFjayh7CgkgICAgICAgICAgICAgICAgdHlwZTogJ0Vycm9yJywKCSAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQ291bGQgbm90IGF1dG9kZXRlY3QgZGVsaW1pdGVyJwoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICByZXR1cm47CgkgICAgICAgIH0KCSAgICB9CgoJICAgIHZhciBudW1lcmljRmllbGRzID0gb3B0aW9ucy5udW1lcmljRmllbGRzID8gb3B0aW9ucy5udW1lcmljRmllbGRzLnNwbGl0KCcsJykgOiBudWxsOwoKCSAgICB2YXIgcGFyc2VkID0gKHR5cGVvZiB4ID09ICdzdHJpbmcnKSA/CgkgICAgICAgIGRzdi5kc3ZGb3JtYXQob3B0aW9ucy5kZWxpbWl0ZXIpLnBhcnNlKHgsIGZ1bmN0aW9uIChkKSB7CgkgICAgICAgICAgICBpZiAobnVtZXJpY0ZpZWxkcykgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChudW1lcmljRmllbGRzLmluY2x1ZGVzKGtleSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGRba2V5XSA9ICtkW2tleV07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXR1cm4gZDsKCSAgICAgICAgfSkgOiB4OwoKCSAgICBpZiAoIXBhcnNlZC5sZW5ndGgpIHsKCSAgICAgICAgY2FsbGJhY2sobnVsbCwgZmVhdHVyZWNvbGxlY3Rpb24pOwoJICAgICAgICByZXR1cm47CgkgICAgfQoKCSAgICB2YXIgZXJyb3JzID0gW107CgkgICAgdmFyIGk7CgoKCSAgICBpZiAoIWxhdGZpZWxkKSBsYXRmaWVsZCA9IGd1ZXNzTGF0SGVhZGVyKHBhcnNlZFswXSk7CgkgICAgaWYgKCFsb25maWVsZCkgbG9uZmllbGQgPSBndWVzc0xvbkhlYWRlcihwYXJzZWRbMF0pOwoJICAgIHZhciBub0dlb21ldHJ5ID0gKCFsYXRmaWVsZCB8fCAhbG9uZmllbGQpOwoKCSAgICBpZiAobm9HZW9tZXRyeSkgewoJICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGFyc2VkLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICBmZWF0dXJlcy5wdXNoKHsKCSAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgICAgICAgICAgcHJvcGVydGllczogcGFyc2VkW2ldLAoJICAgICAgICAgICAgICAgIGdlb21ldHJ5OiBudWxsCgkgICAgICAgICAgICB9KTsKCSAgICAgICAgfQoJICAgICAgICBjYWxsYmFjayhlcnJvcnMubGVuZ3RoID8gZXJyb3JzIDogbnVsbCwgZmVhdHVyZWNvbGxlY3Rpb24pOwoJICAgICAgICByZXR1cm47CgkgICAgfQoKCSAgICBmb3IgKGkgPSAwOyBpIDwgcGFyc2VkLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGlmIChwYXJzZWRbaV1bbG9uZmllbGRdICE9PSB1bmRlZmluZWQgJiYKCSAgICAgICAgICAgIHBhcnNlZFtpXVtsYXRmaWVsZF0gIT09IHVuZGVmaW5lZCkgewoKCSAgICAgICAgICAgIHZhciBsb25rID0gcGFyc2VkW2ldW2xvbmZpZWxkXSwKCSAgICAgICAgICAgICAgICBsYXRrID0gcGFyc2VkW2ldW2xhdGZpZWxkXSwKCSAgICAgICAgICAgICAgICBsb25mLCBsYXRmLAoJICAgICAgICAgICAgICAgIGE7CgoJICAgICAgICAgICAgYSA9IHNleGFnZXNpbWFsKGxvbmssICdFVycpOwoJICAgICAgICAgICAgaWYgKGEpIGxvbmsgPSBhOwoJICAgICAgICAgICAgYSA9IHNleGFnZXNpbWFsKGxhdGssICdOUycpOwoJICAgICAgICAgICAgaWYgKGEpIGxhdGsgPSBhOwoKCSAgICAgICAgICAgIGxvbmYgPSBwYXJzZUZsb2F0KGxvbmspOwoJICAgICAgICAgICAgbGF0ZiA9IHBhcnNlRmxvYXQobGF0ayk7CgoJICAgICAgICAgICAgaWYgKGlzTmFOKGxvbmYpIHx8CgkgICAgICAgICAgICAgICAgaXNOYU4obGF0ZikpIHsKCSAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7CgkgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdBIHJvdyBjb250YWluZWQgYW4gaW52YWxpZCB2YWx1ZSBmb3IgbGF0aXR1ZGUgb3IgbG9uZ2l0dWRlJywKCSAgICAgICAgICAgICAgICAgICAgcm93OiBwYXJzZWRbaV0sCgkgICAgICAgICAgICAgICAgICAgIGluZGV4OiBpCgkgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy5pbmNsdWRlTGF0TG9uKSB7CgkgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwYXJzZWRbaV1bbG9uZmllbGRdOwoJICAgICAgICAgICAgICAgICAgICBkZWxldGUgcGFyc2VkW2ldW2xhdGZpZWxkXTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIGZlYXR1cmVzLnB1c2goewoJICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHBhcnNlZFtpXSwKCSAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnk6IHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogWwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQobG9uZiksCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChsYXRmKQoJICAgICAgICAgICAgICAgICAgICAgICAgXQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGNhbGxiYWNrKGVycm9ycy5sZW5ndGggPyBlcnJvcnMgOiBudWxsLCBmZWF0dXJlY29sbGVjdGlvbik7Cgl9CgoJZnVuY3Rpb24gdG9MaW5lKGdqKSB7CgkgICAgdmFyIGZlYXR1cmVzID0gZ2ouZmVhdHVyZXM7CgkgICAgdmFyIGxpbmUgPSB7CgkgICAgICAgIHR5cGU6ICdGZWF0dXJlJywKCSAgICAgICAgZ2VvbWV0cnk6IHsKCSAgICAgICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJywKCSAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbXQoJICAgICAgICB9CgkgICAgfTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMucHVzaChmZWF0dXJlc1tpXS5nZW9tZXRyeS5jb29yZGluYXRlcyk7CgkgICAgfQoJICAgIGxpbmUucHJvcGVydGllcyA9IGZlYXR1cmVzLnJlZHVjZShmdW5jdGlvbiAoYWdncmVnYXRlZFByb3BlcnRpZXMsIG5ld0ZlYXR1cmUpIHsKCSAgICAgICAgZm9yICh2YXIga2V5IGluIG5ld0ZlYXR1cmUucHJvcGVydGllcykgewoJICAgICAgICAgICAgaWYgKCFhZ2dyZWdhdGVkUHJvcGVydGllc1trZXldKSB7CgkgICAgICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XSA9IFtdOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XS5wdXNoKG5ld0ZlYXR1cmUucHJvcGVydGllc1trZXldKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYWdncmVnYXRlZFByb3BlcnRpZXM7CgkgICAgfSwge30pOwoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCgkgICAgICAgIGZlYXR1cmVzOiBbbGluZV0KCSAgICB9OwoJfQoKCWZ1bmN0aW9uIHRvUG9seWdvbihnaikgewoJICAgIHZhciBmZWF0dXJlcyA9IGdqLmZlYXR1cmVzOwoJICAgIHZhciBwb2x5ID0gewoJICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICB0eXBlOiAnUG9seWdvbicsCgkgICAgICAgICAgICBjb29yZGluYXRlczogW1tdXQoJICAgICAgICB9CgkgICAgfTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIHBvbHkuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0ucHVzaChmZWF0dXJlc1tpXS5nZW9tZXRyeS5jb29yZGluYXRlcyk7CgkgICAgfQoJICAgIHBvbHkucHJvcGVydGllcyA9IGZlYXR1cmVzLnJlZHVjZShmdW5jdGlvbiAoYWdncmVnYXRlZFByb3BlcnRpZXMsIG5ld0ZlYXR1cmUpIHsKCSAgICAgICAgZm9yICh2YXIga2V5IGluIG5ld0ZlYXR1cmUucHJvcGVydGllcykgewoJICAgICAgICAgICAgaWYgKCFhZ2dyZWdhdGVkUHJvcGVydGllc1trZXldKSB7CgkgICAgICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XSA9IFtdOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XS5wdXNoKG5ld0ZlYXR1cmUucHJvcGVydGllc1trZXldKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYWdncmVnYXRlZFByb3BlcnRpZXM7CgkgICAgfSwge30pOwoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCgkgICAgICAgIGZlYXR1cmVzOiBbcG9seV0KCSAgICB9OwoJfQoKCXZhciBjc3YyZ2VvanNvbl8xID0gewoJICAgIGlzTG9uOiBpc0xvbiwKCSAgICBpc0xhdDogaXNMYXQsCgkgICAgZ3Vlc3NMYXRIZWFkZXI6IGd1ZXNzTGF0SGVhZGVyLAoJICAgIGd1ZXNzTG9uSGVhZGVyOiBndWVzc0xvbkhlYWRlciwKCSAgICBjc3Y6IGRzdi5jc3ZQYXJzZSwKCSAgICB0c3Y6IGRzdi50c3ZQYXJzZSwKCSAgICBkc3Y6IGRzdiwKCSAgICBhdXRvOiBhdXRvLAoJICAgIGNzdjJnZW9qc29uOiBjc3YyZ2VvanNvbiwKCSAgICB0b0xpbmU6IHRvTGluZSwKCSAgICB0b1BvbHlnb246IHRvUG9seWdvbgoJfTsKCglmdW5jdGlvbiBpZGVudGl0eSh4KSB7CgkgIHJldHVybiB4OwoJfQoKCWZ1bmN0aW9uIHRyYW5zZm9ybSh0cmFuc2Zvcm0pIHsKCSAgaWYgKHRyYW5zZm9ybSA9PSBudWxsKSByZXR1cm4gaWRlbnRpdHk7CgkgIHZhciB4MCwKCSAgICAgIHkwLAoJICAgICAga3ggPSB0cmFuc2Zvcm0uc2NhbGVbMF0sCgkgICAgICBreSA9IHRyYW5zZm9ybS5zY2FsZVsxXSwKCSAgICAgIGR4ID0gdHJhbnNmb3JtLnRyYW5zbGF0ZVswXSwKCSAgICAgIGR5ID0gdHJhbnNmb3JtLnRyYW5zbGF0ZVsxXTsKCSAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBpKSB7CgkgICAgaWYgKCFpKSB4MCA9IHkwID0gMDsKCSAgICB2YXIgaiA9IDIsIG4gPSBpbnB1dC5sZW5ndGgsIG91dHB1dCA9IG5ldyBBcnJheShuKTsKCSAgICBvdXRwdXRbMF0gPSAoeDAgKz0gaW5wdXRbMF0pICoga3ggKyBkeDsKCSAgICBvdXRwdXRbMV0gPSAoeTAgKz0gaW5wdXRbMV0pICoga3kgKyBkeTsKCSAgICB3aGlsZSAoaiA8IG4pIG91dHB1dFtqXSA9IGlucHV0W2pdLCArK2o7CgkgICAgcmV0dXJuIG91dHB1dDsKCSAgfTsKCX0KCglmdW5jdGlvbiByZXZlcnNlKGFycmF5LCBuKSB7CgkgIHZhciB0LCBqID0gYXJyYXkubGVuZ3RoLCBpID0gaiAtIG47CgkgIHdoaWxlIChpIDwgLS1qKSB0ID0gYXJyYXlbaV0sIGFycmF5W2krK10gPSBhcnJheVtqXSwgYXJyYXlbal0gPSB0OwoJfQoKCWZ1bmN0aW9uIHRvcG9qc29uRmVhdHVyZSh0b3BvbG9neSwgbykgewoJICBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSBvID0gdG9wb2xvZ3kub2JqZWN0c1tvXTsKCSAgcmV0dXJuIG8udHlwZSA9PT0gIkdlb21ldHJ5Q29sbGVjdGlvbiIKCSAgICAgID8ge3R5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsIGZlYXR1cmVzOiBvLmdlb21ldHJpZXMubWFwKGZ1bmN0aW9uKG8pIHsgcmV0dXJuIGZlYXR1cmUodG9wb2xvZ3ksIG8pOyB9KX0KCSAgICAgIDogZmVhdHVyZSh0b3BvbG9neSwgbyk7Cgl9CgoJZnVuY3Rpb24gZmVhdHVyZSh0b3BvbG9neSwgbykgewoJICB2YXIgaWQgPSBvLmlkLAoJICAgICAgYmJveCA9IG8uYmJveCwKCSAgICAgIHByb3BlcnRpZXMgPSBvLnByb3BlcnRpZXMgPT0gbnVsbCA/IHt9IDogby5wcm9wZXJ0aWVzLAoJICAgICAgZ2VvbWV0cnkgPSBvYmplY3QodG9wb2xvZ3ksIG8pOwoJICByZXR1cm4gaWQgPT0gbnVsbCAmJiBiYm94ID09IG51bGwgPyB7dHlwZTogIkZlYXR1cmUiLCBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLCBnZW9tZXRyeTogZ2VvbWV0cnl9CgkgICAgICA6IGJib3ggPT0gbnVsbCA/IHt0eXBlOiAiRmVhdHVyZSIsIGlkOiBpZCwgcHJvcGVydGllczogcHJvcGVydGllcywgZ2VvbWV0cnk6IGdlb21ldHJ5fQoJICAgICAgOiB7dHlwZTogIkZlYXR1cmUiLCBpZDogaWQsIGJib3g6IGJib3gsIHByb3BlcnRpZXM6IHByb3BlcnRpZXMsIGdlb21ldHJ5OiBnZW9tZXRyeX07Cgl9CgoJZnVuY3Rpb24gb2JqZWN0KHRvcG9sb2d5LCBvKSB7CgkgIHZhciB0cmFuc2Zvcm1Qb2ludCA9IHRyYW5zZm9ybSh0b3BvbG9neS50cmFuc2Zvcm0pLAoJICAgICAgYXJjcyA9IHRvcG9sb2d5LmFyY3M7CgoJICBmdW5jdGlvbiBhcmMoaSwgcG9pbnRzKSB7CgkgICAgaWYgKHBvaW50cy5sZW5ndGgpIHBvaW50cy5wb3AoKTsKCSAgICBmb3IgKHZhciBhID0gYXJjc1tpIDwgMCA/IH5pIDogaV0sIGsgPSAwLCBuID0gYS5sZW5ndGg7IGsgPCBuOyArK2spIHsKCSAgICAgIHBvaW50cy5wdXNoKHRyYW5zZm9ybVBvaW50KGFba10sIGspKTsKCSAgICB9CgkgICAgaWYgKGkgPCAwKSByZXZlcnNlKHBvaW50cywgbik7CgkgIH0KCgkgIGZ1bmN0aW9uIHBvaW50KHApIHsKCSAgICByZXR1cm4gdHJhbnNmb3JtUG9pbnQocCk7CgkgIH0KCgkgIGZ1bmN0aW9uIGxpbmUoYXJjcykgewoJICAgIHZhciBwb2ludHMgPSBbXTsKCSAgICBmb3IgKHZhciBpID0gMCwgbiA9IGFyY3MubGVuZ3RoOyBpIDwgbjsgKytpKSBhcmMoYXJjc1tpXSwgcG9pbnRzKTsKCSAgICBpZiAocG9pbnRzLmxlbmd0aCA8IDIpIHBvaW50cy5wdXNoKHBvaW50c1swXSk7IC8vIFRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiBwZXIgdGhlIHNwZWNpZmljYXRpb24uCgkgICAgcmV0dXJuIHBvaW50czsKCSAgfQoKCSAgZnVuY3Rpb24gcmluZyhhcmNzKSB7CgkgICAgdmFyIHBvaW50cyA9IGxpbmUoYXJjcyk7CgkgICAgd2hpbGUgKHBvaW50cy5sZW5ndGggPCA0KSBwb2ludHMucHVzaChwb2ludHNbMF0pOyAvLyBUaGlzIG1heSBoYXBwZW4gaWYgYW4gYXJjIGhhcyBvbmx5IHR3byBwb2ludHMuCgkgICAgcmV0dXJuIHBvaW50czsKCSAgfQoKCSAgZnVuY3Rpb24gcG9seWdvbihhcmNzKSB7CgkgICAgcmV0dXJuIGFyY3MubWFwKHJpbmcpOwoJICB9CgoJICBmdW5jdGlvbiBnZW9tZXRyeShvKSB7CgkgICAgdmFyIHR5cGUgPSBvLnR5cGUsIGNvb3JkaW5hdGVzOwoJICAgIHN3aXRjaCAodHlwZSkgewoJICAgICAgY2FzZSAiR2VvbWV0cnlDb2xsZWN0aW9uIjogcmV0dXJuIHt0eXBlOiB0eXBlLCBnZW9tZXRyaWVzOiBvLmdlb21ldHJpZXMubWFwKGdlb21ldHJ5KX07CgkgICAgICBjYXNlICJQb2ludCI6IGNvb3JkaW5hdGVzID0gcG9pbnQoby5jb29yZGluYXRlcyk7IGJyZWFrOwoJICAgICAgY2FzZSAiTXVsdGlQb2ludCI6IGNvb3JkaW5hdGVzID0gby5jb29yZGluYXRlcy5tYXAocG9pbnQpOyBicmVhazsKCSAgICAgIGNhc2UgIkxpbmVTdHJpbmciOiBjb29yZGluYXRlcyA9IGxpbmUoby5hcmNzKTsgYnJlYWs7CgkgICAgICBjYXNlICJNdWx0aUxpbmVTdHJpbmciOiBjb29yZGluYXRlcyA9IG8uYXJjcy5tYXAobGluZSk7IGJyZWFrOwoJICAgICAgY2FzZSAiUG9seWdvbiI6IGNvb3JkaW5hdGVzID0gcG9seWdvbihvLmFyY3MpOyBicmVhazsKCSAgICAgIGNhc2UgIk11bHRpUG9seWdvbiI6IGNvb3JkaW5hdGVzID0gby5hcmNzLm1hcChwb2x5Z29uKTsgYnJlYWs7CgkgICAgICBkZWZhdWx0OiByZXR1cm4gbnVsbDsKCSAgICB9CgkgICAgcmV0dXJuIHt0eXBlOiB0eXBlLCBjb29yZGluYXRlczogY29vcmRpbmF0ZXN9OwoJICB9CgoJICByZXR1cm4gZ2VvbWV0cnkobyk7Cgl9CgoJZnVuY3Rpb24gJChlbGVtZW50LCB0YWdOYW1lKSB7CgkgICAgcmV0dXJuIEFycmF5LmZyb20oZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKSk7Cgl9CglmdW5jdGlvbiBub3JtYWxpemVJZChpZCkgewoJICAgIHJldHVybiBpZFswXSA9PT0gIiMiID8gaWQgOiBgIyR7aWR9YDsKCX0KCWZ1bmN0aW9uICRucyhlbGVtZW50LCB0YWdOYW1lLCBucykgewoJICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhucywgdGFnTmFtZSkpOwoJfQoJLyoqCgkgKiBnZXQgdGhlIGNvbnRlbnQgb2YgYSB0ZXh0IG5vZGUsIGlmIGFueQoJICovCglmdW5jdGlvbiBub2RlVmFsKG5vZGUpIHsKCSAgICBub2RlPy5ub3JtYWxpemUoKTsKCSAgICByZXR1cm4gKG5vZGUgJiYgbm9kZS50ZXh0Q29udGVudCkgfHwgIiI7Cgl9CgkvKioKCSAqIEdldCBvbmUgWSBjaGlsZCBvZiBYLCBpZiBhbnksIG90aGVyd2lzZSBudWxsCgkgKi8KCWZ1bmN0aW9uIGdldDEobm9kZSwgdGFnTmFtZSwgY2FsbGJhY2spIHsKCSAgICBjb25zdCBuID0gbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKTsKCSAgICBjb25zdCByZXN1bHQgPSBuLmxlbmd0aCA/IG5bMF0gOiBudWxsOwoJICAgIGlmIChyZXN1bHQgJiYgY2FsbGJhY2spCgkgICAgICAgIGNhbGxiYWNrKHJlc3VsdCk7CgkgICAgcmV0dXJuIHJlc3VsdDsKCX0KCWZ1bmN0aW9uIGdldChub2RlLCB0YWdOYW1lLCBjYWxsYmFjaykgewoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7fTsKCSAgICBpZiAoIW5vZGUpCgkgICAgICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJICAgIGNvbnN0IG4gPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZ05hbWUpOwoJICAgIGNvbnN0IHJlc3VsdCA9IG4ubGVuZ3RoID8gblswXSA6IG51bGw7CgkgICAgaWYgKHJlc3VsdCAmJiBjYWxsYmFjaykgewoJICAgICAgICByZXR1cm4gY2FsbGJhY2socmVzdWx0LCBwcm9wZXJ0aWVzKTsKCSAgICB9CgkgICAgcmV0dXJuIHByb3BlcnRpZXM7Cgl9CglmdW5jdGlvbiB2YWwxKG5vZGUsIHRhZ05hbWUsIGNhbGxiYWNrKSB7CgkgICAgY29uc3QgdmFsID0gbm9kZVZhbChnZXQxKG5vZGUsIHRhZ05hbWUpKTsKCSAgICBpZiAodmFsICYmIGNhbGxiYWNrKQoJICAgICAgICByZXR1cm4gY2FsbGJhY2sodmFsKSB8fCB7fTsKCSAgICByZXR1cm4ge307Cgl9CglmdW5jdGlvbiAkbnVtKG5vZGUsIHRhZ05hbWUsIGNhbGxiYWNrKSB7CgkgICAgY29uc3QgdmFsID0gcGFyc2VGbG9hdChub2RlVmFsKGdldDEobm9kZSwgdGFnTmFtZSkpKTsKCSAgICBpZiAoaXNOYU4odmFsKSkKCSAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCSAgICBpZiAodmFsICYmIGNhbGxiYWNrKQoJICAgICAgICByZXR1cm4gY2FsbGJhY2sodmFsKSB8fCB7fTsKCSAgICByZXR1cm4ge307Cgl9CglmdW5jdGlvbiBudW0xKG5vZGUsIHRhZ05hbWUsIGNhbGxiYWNrKSB7CgkgICAgY29uc3QgdmFsID0gcGFyc2VGbG9hdChub2RlVmFsKGdldDEobm9kZSwgdGFnTmFtZSkpKTsKCSAgICBpZiAoaXNOYU4odmFsKSkKCSAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCSAgICBpZiAoY2FsbGJhY2spCgkgICAgICAgIGNhbGxiYWNrKHZhbCk7CgkgICAgcmV0dXJuIHZhbDsKCX0KCWZ1bmN0aW9uIGdldE11bHRpKG5vZGUsIHByb3BlcnR5TmFtZXMpIHsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0ge307CgkgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBvZiBwcm9wZXJ0eU5hbWVzKSB7CgkgICAgICAgIHZhbDEobm9kZSwgcHJvcGVydHksICh2YWwpID0+IHsKCSAgICAgICAgICAgIHByb3BlcnRpZXNbcHJvcGVydHldID0gdmFsOwoJICAgICAgICB9KTsKCSAgICB9CgkgICAgcmV0dXJuIHByb3BlcnRpZXM7Cgl9CglmdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkgewoJICAgIHJldHVybiBub2RlPy5ub2RlVHlwZSA9PT0gMTsKCX0KCglmdW5jdGlvbiBnZXRMaW5lU3R5bGUobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgImxpbmUiLCAobGluZVN0eWxlKSA9PiB7CgkgICAgICAgIGNvbnN0IHZhbCA9IE9iamVjdC5hc3NpZ24oe30sIHZhbDEobGluZVN0eWxlLCAiY29sb3IiLCAoY29sb3IpID0+IHsKCSAgICAgICAgICAgIHJldHVybiB7IHN0cm9rZTogYCMke2NvbG9yfWAgfTsKCSAgICAgICAgfSksICRudW0obGluZVN0eWxlLCAib3BhY2l0eSIsIChvcGFjaXR5KSA9PiB7CgkgICAgICAgICAgICByZXR1cm4geyAic3Ryb2tlLW9wYWNpdHkiOiBvcGFjaXR5IH07CgkgICAgICAgIH0pLCAkbnVtKGxpbmVTdHlsZSwgIndpZHRoIiwgKHdpZHRoKSA9PiB7CgkgICAgICAgICAgICAvLyBHUFggd2lkdGggaXMgaW4gbW0sIGNvbnZlcnQgdG8gcHggd2l0aCA5NiBweCBwZXIgaW5jaAoJICAgICAgICAgICAgcmV0dXJuIHsgInN0cm9rZS13aWR0aCI6ICh3aWR0aCAqIDk2KSAvIDI1LjQgfTsKCSAgICAgICAgfSkpOwoJICAgICAgICByZXR1cm4gdmFsOwoJICAgIH0pOwoJfQoKCWZ1bmN0aW9uIGdldEV4dGVuc2lvbnMobm9kZSkgewoJICAgIGxldCB2YWx1ZXMgPSBbXTsKCSAgICBpZiAobm9kZSA9PT0gbnVsbCkKCSAgICAgICAgcmV0dXJuIHZhbHVlczsKCSAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIEFycmF5LmZyb20obm9kZS5jaGlsZE5vZGVzKSkgewoJICAgICAgICBpZiAoIWlzRWxlbWVudChjaGlsZCkpCgkgICAgICAgICAgICBjb250aW51ZTsKCSAgICAgICAgY29uc3QgbmFtZSA9IGFiYnJldmlhdGVOYW1lKGNoaWxkLm5vZGVOYW1lKTsKCSAgICAgICAgaWYgKG5hbWUgPT09ICJncHh0cHg6VHJhY2tQb2ludEV4dGVuc2lvbiIpIHsKCSAgICAgICAgICAgIC8vIGxvb3AgYWdhaW4gZm9yIG5lc3RlZCBnYXJtaW4gZXh0ZW5zaW9ucyAoZWcuICJncHh0cHg6aHIiKQoJICAgICAgICAgICAgdmFsdWVzID0gdmFsdWVzLmNvbmNhdChnZXRFeHRlbnNpb25zKGNoaWxkKSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBwdXNoIGN1c3RvbSBleHRlbnNpb24gKGVnLiAicG93ZXIiKQoJICAgICAgICAgICAgY29uc3QgdmFsID0gbm9kZVZhbChjaGlsZCk7CgkgICAgICAgICAgICB2YWx1ZXMucHVzaChbbmFtZSwgcGFyc2VOdW1lcmljKHZhbCldKTsKCSAgICAgICAgfQoJICAgIH0KCSAgICByZXR1cm4gdmFsdWVzOwoJfQoJZnVuY3Rpb24gYWJicmV2aWF0ZU5hbWUobmFtZSkgewoJICAgIHJldHVybiBbImhlYXJ0IiwgImdweHRweDpociIsICJociJdLmluY2x1ZGVzKG5hbWUpID8gImhlYXJ0IiA6IG5hbWU7Cgl9CglmdW5jdGlvbiBwYXJzZU51bWVyaWModmFsKSB7CgkgICAgY29uc3QgbnVtID0gcGFyc2VGbG9hdCh2YWwpOwoJICAgIHJldHVybiBpc05hTihudW0pID8gdmFsIDogbnVtOwoJfQoKCWZ1bmN0aW9uIGNvb3JkUGFpciQxKG5vZGUpIHsKCSAgICBjb25zdCBsbCA9IFsKCSAgICAgICAgcGFyc2VGbG9hdChub2RlLmdldEF0dHJpYnV0ZSgibG9uIikgfHwgIiIpLAoJICAgICAgICBwYXJzZUZsb2F0KG5vZGUuZ2V0QXR0cmlidXRlKCJsYXQiKSB8fCAiIiksCgkgICAgXTsKCSAgICBpZiAoaXNOYU4obGxbMF0pIHx8IGlzTmFOKGxsWzFdKSkgewoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9CgkgICAgbnVtMShub2RlLCAiZWxlIiwgKHZhbCkgPT4gewoJICAgICAgICBsbC5wdXNoKHZhbCk7CgkgICAgfSk7CgkgICAgY29uc3QgdGltZSA9IGdldDEobm9kZSwgInRpbWUiKTsKCSAgICByZXR1cm4gewoJICAgICAgICBjb29yZGluYXRlczogbGwsCgkgICAgICAgIHRpbWU6IHRpbWUgPyBub2RlVmFsKHRpbWUpIDogbnVsbCwKCSAgICAgICAgZXh0ZW5kZWRWYWx1ZXM6IGdldEV4dGVuc2lvbnMoZ2V0MShub2RlLCAiZXh0ZW5zaW9ucyIpKSwKCSAgICB9OwoJfQoKCWZ1bmN0aW9uIGV4dHJhY3RQcm9wZXJ0aWVzKG5vZGUpIHsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0gZ2V0TXVsdGkobm9kZSwgWwoJICAgICAgICAibmFtZSIsCgkgICAgICAgICJjbXQiLAoJICAgICAgICAiZGVzYyIsCgkgICAgICAgICJ0eXBlIiwKCSAgICAgICAgInRpbWUiLAoJICAgICAgICAia2V5d29yZHMiLAoJICAgIF0pOwoJICAgIGNvbnN0IGV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUygiaHR0cDovL3d3dy5nYXJtaW4uY29tL3htbHNjaGVtYXMvR3B4RXh0ZW5zaW9ucy92MyIsICIqIikpOwoJICAgIGZvciAoY29uc3QgY2hpbGQgb2YgZXh0ZW5zaW9ucykgewoJICAgICAgICBpZiAoY2hpbGQucGFyZW50Tm9kZT8ucGFyZW50Tm9kZSA9PT0gbm9kZSkgewoJICAgICAgICAgICAgcHJvcGVydGllc1tjaGlsZC50YWdOYW1lLnJlcGxhY2UoIjoiLCAiXyIpXSA9IG5vZGVWYWwoY2hpbGQpOwoJICAgICAgICB9CgkgICAgfQoJICAgIGNvbnN0IGxpbmtzID0gJChub2RlLCAibGluayIpOwoJICAgIGlmIChsaW5rcy5sZW5ndGgpIHsKCSAgICAgICAgcHJvcGVydGllcy5saW5rcyA9IGxpbmtzLm1hcCgobGluaykgPT4gT2JqZWN0LmFzc2lnbih7IGhyZWY6IGxpbmsuZ2V0QXR0cmlidXRlKCJocmVmIikgfSwgZ2V0TXVsdGkobGluaywgWyJ0ZXh0IiwgInR5cGUiXSkpKTsKCSAgICB9CgkgICAgcmV0dXJuIHByb3BlcnRpZXM7Cgl9CgoJLyoqCgkgKiBFeHRyYWN0IHBvaW50cyBmcm9tIGEgdHJrc2VnIG9yIHJ0ZSBlbGVtZW50LgoJICovCglmdW5jdGlvbiBnZXRQb2ludHMkMShub2RlLCBwb2ludG5hbWUpIHsKCSAgICBjb25zdCBwdHMgPSAkKG5vZGUsIHBvaW50bmFtZSk7CgkgICAgY29uc3QgbGluZSA9IFtdOwoJICAgIGNvbnN0IHRpbWVzID0gW107CgkgICAgY29uc3QgZXh0ZW5kZWRWYWx1ZXMgPSB7fTsKCSAgICBmb3IgKGxldCBpID0gMDsgaSA8IHB0cy5sZW5ndGg7IGkrKykgewoJICAgICAgICBjb25zdCBjID0gY29vcmRQYWlyJDEocHRzW2ldKTsKCSAgICAgICAgaWYgKCFjKSB7CgkgICAgICAgICAgICBjb250aW51ZTsKCSAgICAgICAgfQoJICAgICAgICBsaW5lLnB1c2goYy5jb29yZGluYXRlcyk7CgkgICAgICAgIGlmIChjLnRpbWUpCgkgICAgICAgICAgICB0aW1lcy5wdXNoKGMudGltZSk7CgkgICAgICAgIGZvciAoY29uc3QgW25hbWUsIHZhbF0gb2YgYy5leHRlbmRlZFZhbHVlcykgewoJICAgICAgICAgICAgY29uc3QgcGx1cmFsID0gbmFtZSA9PT0gImhlYXJ0IiA/IG5hbWUgOiBuYW1lLnJlcGxhY2UoImdweHRweDoiLCAiIikgKyAicyI7CgkgICAgICAgICAgICBpZiAoIWV4dGVuZGVkVmFsdWVzW3BsdXJhbF0pIHsKCSAgICAgICAgICAgICAgICBleHRlbmRlZFZhbHVlc1twbHVyYWxdID0gQXJyYXkocHRzLmxlbmd0aCkuZmlsbChudWxsKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGV4dGVuZGVkVmFsdWVzW3BsdXJhbF1baV0gPSB2YWw7CgkgICAgICAgIH0KCSAgICB9CgkgICAgaWYgKGxpbmUubGVuZ3RoIDwgMikKCSAgICAgICAgcmV0dXJuOyAvLyBJbnZhbGlkIGxpbmUgaW4gR2VvSlNPTgoJICAgIHJldHVybiB7CgkgICAgICAgIGxpbmU6IGxpbmUsCgkgICAgICAgIHRpbWVzOiB0aW1lcywKCSAgICAgICAgZXh0ZW5kZWRWYWx1ZXM6IGV4dGVuZGVkVmFsdWVzLAoJICAgIH07Cgl9CgkvKioKCSAqIEV4dHJhY3QgYSBMaW5lU3RyaW5nIGdlb21ldHJ5IGZyb20gYSBydGUKCSAqIGVsZW1lbnQuCgkgKi8KCWZ1bmN0aW9uIGdldFJvdXRlKG5vZGUpIHsKCSAgICBjb25zdCBsaW5lID0gZ2V0UG9pbnRzJDEobm9kZSwgInJ0ZXB0Iik7CgkgICAgaWYgKCFsaW5lKQoJICAgICAgICByZXR1cm47CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmUiLAoJICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKHsgX2dweFR5cGU6ICJydGUiIH0sIGV4dHJhY3RQcm9wZXJ0aWVzKG5vZGUpLCBnZXRMaW5lU3R5bGUoZ2V0MShub2RlLCAiZXh0ZW5zaW9ucyIpKSksCgkgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICB0eXBlOiAiTGluZVN0cmluZyIsCgkgICAgICAgICAgICBjb29yZGluYXRlczogbGluZS5saW5lLAoJICAgICAgICB9LAoJICAgIH07Cgl9CglmdW5jdGlvbiBnZXRUcmFjayhub2RlKSB7CgkgICAgY29uc3Qgc2VnbWVudHMgPSAkKG5vZGUsICJ0cmtzZWciKTsKCSAgICBjb25zdCB0cmFjayA9IFtdOwoJICAgIGNvbnN0IHRpbWVzID0gW107CgkgICAgY29uc3QgZXh0cmFjdGVkTGluZXMgPSBbXTsKCSAgICBmb3IgKGNvbnN0IHNlZ21lbnQgb2Ygc2VnbWVudHMpIHsKCSAgICAgICAgY29uc3QgbGluZSA9IGdldFBvaW50cyQxKHNlZ21lbnQsICJ0cmtwdCIpOwoJICAgICAgICBpZiAobGluZSkgewoJICAgICAgICAgICAgZXh0cmFjdGVkTGluZXMucHVzaChsaW5lKTsKCSAgICAgICAgICAgIGlmIChsaW5lLnRpbWVzICYmIGxpbmUudGltZXMubGVuZ3RoKQoJICAgICAgICAgICAgICAgIHRpbWVzLnB1c2gobGluZS50aW1lcyk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgaWYgKGV4dHJhY3RlZExpbmVzLmxlbmd0aCA9PT0gMCkKCSAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgY29uc3QgbXVsdGkgPSBleHRyYWN0ZWRMaW5lcy5sZW5ndGggPiAxOwoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSBPYmplY3QuYXNzaWduKHsgX2dweFR5cGU6ICJ0cmsiIH0sIGV4dHJhY3RQcm9wZXJ0aWVzKG5vZGUpLCBnZXRMaW5lU3R5bGUoZ2V0MShub2RlLCAiZXh0ZW5zaW9ucyIpKSwgdGltZXMubGVuZ3RoCgkgICAgICAgID8gewoJICAgICAgICAgICAgY29vcmRpbmF0ZVByb3BlcnRpZXM6IHsKCSAgICAgICAgICAgICAgICB0aW1lczogbXVsdGkgPyB0aW1lcyA6IHRpbWVzWzBdLAoJICAgICAgICAgICAgfSwKCSAgICAgICAgfQoJICAgICAgICA6IHt9KTsKCSAgICBmb3IgKGNvbnN0IGxpbmUgb2YgZXh0cmFjdGVkTGluZXMpIHsKCSAgICAgICAgdHJhY2sucHVzaChsaW5lLmxpbmUpOwoJICAgICAgICBpZiAoIXByb3BlcnRpZXMuY29vcmRpbmF0ZVByb3BlcnRpZXMpIHsKCSAgICAgICAgICAgIHByb3BlcnRpZXMuY29vcmRpbmF0ZVByb3BlcnRpZXMgPSB7fTsKCSAgICAgICAgfQoJICAgICAgICBjb25zdCBwcm9wcyA9IHByb3BlcnRpZXMuY29vcmRpbmF0ZVByb3BlcnRpZXM7CgkgICAgICAgIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhsaW5lLmV4dGVuZGVkVmFsdWVzKTsKCSAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbnRyaWVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICBjb25zdCBbbmFtZSwgdmFsXSA9IGVudHJpZXNbaV07CgkgICAgICAgICAgICBpZiAobXVsdGkpIHsKCSAgICAgICAgICAgICAgICBpZiAoIXByb3BzW25hbWVdKSB7CgkgICAgICAgICAgICAgICAgICAgIHByb3BzW25hbWVdID0gZXh0cmFjdGVkTGluZXMubWFwKChsaW5lKSA9PiBuZXcgQXJyYXkobGluZS5saW5lLmxlbmd0aCkuZmlsbChudWxsKSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHByb3BzW25hbWVdW2ldID0gdmFsOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgcHJvcHNbbmFtZV0gPSB2YWw7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmUiLAoJICAgICAgICBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLAoJICAgICAgICBnZW9tZXRyeTogbXVsdGkKCSAgICAgICAgICAgID8gewoJICAgICAgICAgICAgICAgIHR5cGU6ICJNdWx0aUxpbmVTdHJpbmciLAoJICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiB0cmFjaywKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIDogewoJICAgICAgICAgICAgICAgIHR5cGU6ICJMaW5lU3RyaW5nIiwKCSAgICAgICAgICAgICAgICBjb29yZGluYXRlczogdHJhY2tbMF0sCgkgICAgICAgICAgICB9LAoJICAgIH07Cgl9CgkvKioKCSAqIEV4dHJhY3QgYSBwb2ludCwgaWYgcG9zc2libGUsIGZyb20gYSBnaXZlbiBub2RlLAoJICogd2hpY2ggaXMgdXN1YWxseSBhIHdwdCBvciB0cmtwdAoJICovCglmdW5jdGlvbiBnZXRQb2ludChub2RlKSB7CgkgICAgY29uc3QgcHJvcGVydGllcyA9IE9iamVjdC5hc3NpZ24oZXh0cmFjdFByb3BlcnRpZXMobm9kZSksIGdldE11bHRpKG5vZGUsIFsic3ltIl0pKTsKCSAgICBjb25zdCBwYWlyID0gY29vcmRQYWlyJDEobm9kZSk7CgkgICAgaWYgKCFwYWlyKQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICByZXR1cm4gewoJICAgICAgICB0eXBlOiAiRmVhdHVyZSIsCgkgICAgICAgIHByb3BlcnRpZXMsCgkgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICB0eXBlOiAiUG9pbnQiLAoJICAgICAgICAgICAgY29vcmRpbmF0ZXM6IHBhaXIuY29vcmRpbmF0ZXMsCgkgICAgICAgIH0sCgkgICAgfTsKCX0KCS8qKgoJICogQ29udmVydCBHUFggdG8gR2VvSlNPTiBpbmNyZW1lbnRhbGx5LCByZXR1cm5pbmcKCSAqIGEgW0dlbmVyYXRvcl0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9HdWlkZS9JdGVyYXRvcnNfYW5kX0dlbmVyYXRvcnMpCgkgKiB0aGF0IHlpZWxkcyBvdXRwdXQgZmVhdHVyZSBieSBmZWF0dXJlLgoJICovCglmdW5jdGlvbiogZ3B4R2VuKG5vZGUpIHsKCSAgICBmb3IgKGNvbnN0IHRyYWNrIG9mICQobm9kZSwgInRyayIpKSB7CgkgICAgICAgIGNvbnN0IGZlYXR1cmUgPSBnZXRUcmFjayh0cmFjayk7CgkgICAgICAgIGlmIChmZWF0dXJlKQoJICAgICAgICAgICAgeWllbGQgZmVhdHVyZTsKCSAgICB9CgkgICAgZm9yIChjb25zdCByb3V0ZSBvZiAkKG5vZGUsICJydGUiKSkgewoJICAgICAgICBjb25zdCBmZWF0dXJlID0gZ2V0Um91dGUocm91dGUpOwoJICAgICAgICBpZiAoZmVhdHVyZSkKCSAgICAgICAgICAgIHlpZWxkIGZlYXR1cmU7CgkgICAgfQoJICAgIGZvciAoY29uc3Qgd2F5cG9pbnQgb2YgJChub2RlLCAid3B0IikpIHsKCSAgICAgICAgY29uc3QgcG9pbnQgPSBnZXRQb2ludCh3YXlwb2ludCk7CgkgICAgICAgIGlmIChwb2ludCkKCSAgICAgICAgICAgIHlpZWxkIHBvaW50OwoJICAgIH0KCX0KCS8qKgoJICoKCSAqIENvbnZlcnQgYSBHUFggZG9jdW1lbnQgdG8gR2VvSlNPTi4gVGhlIGZpcnN0IGFyZ3VtZW50LCBgZG9jYCwgbXVzdCBiZSBhIEdQWAoJICogZG9jdW1lbnQgYXMgYW4gWE1MIERPTSAtIG5vdCBhcyBhIHN0cmluZy4gWW91IGNhbiBnZXQgdGhpcyB1c2luZyBqUXVlcnkncyBkZWZhdWx0CgkgKiBgLmFqYXhgIGZ1bmN0aW9uIG9yIHVzaW5nIGEgYmFyZSBYTUxIdHRwUmVxdWVzdCB3aXRoIHRoZSBgLnJlc3BvbnNlYCBwcm9wZXJ0eQoJICogaG9sZGluZyBhbiBYTUwgRE9NLgoJICoKCSAqIFRoZSBvdXRwdXQgaXMgYSBKYXZhU2NyaXB0IG9iamVjdCBvZiBHZW9KU09OIGRhdGEsIHNhbWUgYXMgYC5rbWxgIG91dHB1dHMsIHdpdGggdGhlCgkgKiBhZGRpdGlvbiBvZiBhIGBfZ3B4VHlwZWAgcHJvcGVydHkgb24gZWFjaCBgTGluZVN0cmluZ2AgZmVhdHVyZSB0aGF0IGluZGljYXRlcyB3aGV0aGVyCgkgKiB0aGUgZmVhdHVyZSB3YXMgZW5jb2RlZCBhcyBhIHJvdXRlIChgcnRlYCkgb3IgdHJhY2sgKGB0cmtgKSBpbiB0aGUgR1BYIGRvY3VtZW50LgoJICovCglmdW5jdGlvbiBncHgobm9kZSkgewoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsCgkgICAgICAgIGZlYXR1cmVzOiBBcnJheS5mcm9tKGdweEdlbihub2RlKSksCgkgICAgfTsKCX0KCgljb25zdCBFWFRFTlNJT05TX05TID0gImh0dHA6Ly93d3cuZ2FybWluLmNvbS94bWxzY2hlbWFzL0FjdGl2aXR5RXh0ZW5zaW9uL3YyIjsKCWNvbnN0IFRSQUNLUE9JTlRfQVRUUklCVVRFUyA9IFsKCSAgICBbImhlYXJ0UmF0ZSIsICJoZWFydFJhdGVzIl0sCgkgICAgWyJDYWRlbmNlIiwgImNhZGVuY2VzIl0sCgkgICAgLy8gRXh0ZW5kZWQgVHJhY2twb2ludCBhdHRyaWJ1dGVzCgkgICAgWyJTcGVlZCIsICJzcGVlZHMiXSwKCSAgICBbIldhdHRzIiwgIndhdHRzIl0sCgldOwoJY29uc3QgTEFQX0FUVFJJQlVURVMgPSBbCgkgICAgWyJUb3RhbFRpbWVTZWNvbmRzIiwgInRvdGFsVGltZVNlY29uZHMiXSwKCSAgICBbIkRpc3RhbmNlTWV0ZXJzIiwgImRpc3RhbmNlTWV0ZXJzIl0sCgkgICAgWyJNYXhpbXVtU3BlZWQiLCAibWF4U3BlZWQiXSwKCSAgICBbIkF2ZXJhZ2VIZWFydFJhdGVCcG0iLCAiYXZnSGVhcnRSYXRlIl0sCgkgICAgWyJNYXhpbXVtSGVhcnRSYXRlQnBtIiwgIm1heEhlYXJ0UmF0ZSJdLAoJICAgIC8vIEV4dGVuZGVkIExhcCBhdHRyaWJ1dGVzCgkgICAgWyJBdmdTcGVlZCIsICJhdmdTcGVlZCJdLAoJICAgIFsiQXZnV2F0dHMiLCAiYXZnV2F0dHMiXSwKCSAgICBbIk1heFdhdHRzIiwgIm1heFdhdHRzIl0sCgldOwoJZnVuY3Rpb24gZ2V0UHJvcGVydGllcyhub2RlLCBhdHRyaWJ1dGVOYW1lcykgewoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSBbXTsKCSAgICBmb3IgKGNvbnN0IFt0YWcsIGFsaWFzXSBvZiBhdHRyaWJ1dGVOYW1lcykgewoJICAgICAgICBsZXQgZWxlbSA9IGdldDEobm9kZSwgdGFnKTsKCSAgICAgICAgaWYgKCFlbGVtKSB7CgkgICAgICAgICAgICBjb25zdCBlbGVtZW50cyA9IG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhFWFRFTlNJT05TX05TLCB0YWcpOwoJICAgICAgICAgICAgaWYgKGVsZW1lbnRzLmxlbmd0aCkgewoJICAgICAgICAgICAgICAgIGVsZW0gPSBlbGVtZW50c1swXTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjb25zdCB2YWwgPSBwYXJzZUZsb2F0KG5vZGVWYWwoZWxlbSkpOwoJICAgICAgICBpZiAoIWlzTmFOKHZhbCkpIHsKCSAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbYWxpYXMsIHZhbF0pOwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJfQoJZnVuY3Rpb24gY29vcmRQYWlyKG5vZGUpIHsKCSAgICBjb25zdCBsbCA9IFtudW0xKG5vZGUsICJMb25naXR1ZGVEZWdyZWVzIiksIG51bTEobm9kZSwgIkxhdGl0dWRlRGVncmVlcyIpXTsKCSAgICBpZiAobGxbMF0gPT09IHVuZGVmaW5lZCB8fAoJICAgICAgICBpc05hTihsbFswXSkgfHwKCSAgICAgICAgbGxbMV0gPT09IHVuZGVmaW5lZCB8fAoJICAgICAgICBpc05hTihsbFsxXSkpIHsKCSAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgfQoJICAgIGNvbnN0IGhlYXJ0UmF0ZSA9IGdldDEobm9kZSwgIkhlYXJ0UmF0ZUJwbSIpOwoJICAgIGNvbnN0IHRpbWUgPSBub2RlVmFsKGdldDEobm9kZSwgIlRpbWUiKSk7CgkgICAgZ2V0MShub2RlLCAiQWx0aXR1ZGVNZXRlcnMiLCAoYWx0KSA9PiB7CgkgICAgICAgIGNvbnN0IGEgPSBwYXJzZUZsb2F0KG5vZGVWYWwoYWx0KSk7CgkgICAgICAgIGlmICghaXNOYU4oYSkpIHsKCSAgICAgICAgICAgIGxsLnB1c2goYSk7CgkgICAgICAgIH0KCSAgICB9KTsKCSAgICByZXR1cm4gewoJICAgICAgICBjb29yZGluYXRlczogbGwsCgkgICAgICAgIHRpbWU6IHRpbWUgfHwgbnVsbCwKCSAgICAgICAgaGVhcnRSYXRlOiBoZWFydFJhdGUgPyBwYXJzZUZsb2F0KG5vZGVWYWwoaGVhcnRSYXRlKSkgOiBudWxsLAoJICAgICAgICBleHRlbnNpb25zOiBnZXRQcm9wZXJ0aWVzKG5vZGUsIFRSQUNLUE9JTlRfQVRUUklCVVRFUyksCgkgICAgfTsKCX0KCWZ1bmN0aW9uIGdldFBvaW50cyhub2RlKSB7CgkgICAgY29uc3QgcHRzID0gJChub2RlLCAiVHJhY2twb2ludCIpOwoJICAgIGNvbnN0IGxpbmUgPSBbXTsKCSAgICBjb25zdCB0aW1lcyA9IFtdOwoJICAgIGNvbnN0IGhlYXJ0UmF0ZXMgPSBbXTsKCSAgICBpZiAocHRzLmxlbmd0aCA8IDIpCgkgICAgICAgIHJldHVybiBudWxsOyAvLyBJbnZhbGlkIGxpbmUgaW4gR2VvSlNPTgoJICAgIGNvbnN0IGV4dGVuZGVkUHJvcGVydGllcyA9IHt9OwoJICAgIGNvbnN0IHJlc3VsdCA9IHsgZXh0ZW5kZWRQcm9wZXJ0aWVzIH07CgkgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwdHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgY29uc3QgYyA9IGNvb3JkUGFpcihwdHNbaV0pOwoJICAgICAgICBpZiAoYyA9PT0gbnVsbCkKCSAgICAgICAgICAgIGNvbnRpbnVlOwoJICAgICAgICBsaW5lLnB1c2goYy5jb29yZGluYXRlcyk7CgkgICAgICAgIGNvbnN0IHsgdGltZSwgaGVhcnRSYXRlLCBleHRlbnNpb25zIH0gPSBjOwoJICAgICAgICBpZiAodGltZSkKCSAgICAgICAgICAgIHRpbWVzLnB1c2godGltZSk7CgkgICAgICAgIGlmIChoZWFydFJhdGUpCgkgICAgICAgICAgICBoZWFydFJhdGVzLnB1c2goaGVhcnRSYXRlKTsKCSAgICAgICAgZm9yIChjb25zdCBbYWxpYXMsIHZhbHVlXSBvZiBleHRlbnNpb25zKSB7CgkgICAgICAgICAgICBpZiAoIWV4dGVuZGVkUHJvcGVydGllc1thbGlhc10pIHsKCSAgICAgICAgICAgICAgICBleHRlbmRlZFByb3BlcnRpZXNbYWxpYXNdID0gQXJyYXkocHRzLmxlbmd0aCkuZmlsbChudWxsKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGV4dGVuZGVkUHJvcGVydGllc1thbGlhc11baV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH0KCSAgICBpZiAobGluZS5sZW5ndGggPCAyKQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihyZXN1bHQsIHsKCSAgICAgICAgbGluZTogbGluZSwKCSAgICAgICAgdGltZXM6IHRpbWVzLAoJICAgICAgICBoZWFydFJhdGVzOiBoZWFydFJhdGVzLAoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZ2V0TGFwKG5vZGUpIHsKCSAgICBjb25zdCBzZWdtZW50cyA9ICQobm9kZSwgIlRyYWNrIik7CgkgICAgY29uc3QgdHJhY2sgPSBbXTsKCSAgICBjb25zdCB0aW1lcyA9IFtdOwoJICAgIGNvbnN0IGhlYXJ0UmF0ZXMgPSBbXTsKCSAgICBjb25zdCBhbGxFeHRlbmRlZFByb3BlcnRpZXMgPSBbXTsKCSAgICBsZXQgbGluZTsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0gT2JqZWN0LmFzc2lnbihPYmplY3QuZnJvbUVudHJpZXMoZ2V0UHJvcGVydGllcyhub2RlLCBMQVBfQVRUUklCVVRFUykpLCBnZXQobm9kZSwgIk5hbWUiLCAobmFtZUVsZW1lbnQpID0+IHsKCSAgICAgICAgcmV0dXJuIHsgbmFtZTogbm9kZVZhbChuYW1lRWxlbWVudCkgfTsKCSAgICB9KSk7CgkgICAgZm9yIChjb25zdCBzZWdtZW50IG9mIHNlZ21lbnRzKSB7CgkgICAgICAgIGxpbmUgPSBnZXRQb2ludHMoc2VnbWVudCk7CgkgICAgICAgIGlmIChsaW5lKSB7CgkgICAgICAgICAgICB0cmFjay5wdXNoKGxpbmUubGluZSk7CgkgICAgICAgICAgICBpZiAobGluZS50aW1lcy5sZW5ndGgpCgkgICAgICAgICAgICAgICAgdGltZXMucHVzaChsaW5lLnRpbWVzKTsKCSAgICAgICAgICAgIGlmIChsaW5lLmhlYXJ0UmF0ZXMubGVuZ3RoKQoJICAgICAgICAgICAgICAgIGhlYXJ0UmF0ZXMucHVzaChsaW5lLmhlYXJ0UmF0ZXMpOwoJICAgICAgICAgICAgYWxsRXh0ZW5kZWRQcm9wZXJ0aWVzLnB1c2gobGluZS5leHRlbmRlZFByb3BlcnRpZXMpOwoJICAgICAgICB9CgkgICAgfQoJICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsRXh0ZW5kZWRQcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGNvbnN0IGV4dGVuZGVkUHJvcGVydGllcyA9IGFsbEV4dGVuZGVkUHJvcGVydGllc1tpXTsKCSAgICAgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBpbiBleHRlbmRlZFByb3BlcnRpZXMpIHsKCSAgICAgICAgICAgIGlmIChzZWdtZW50cy5sZW5ndGggPT09IDEpIHsKCSAgICAgICAgICAgICAgICBpZiAobGluZSkgewoJICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzW3Byb3BlcnR5XSA9IGxpbmUuZXh0ZW5kZWRQcm9wZXJ0aWVzW3Byb3BlcnR5XTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICBpZiAoIXByb3BlcnRpZXNbcHJvcGVydHldKSB7CgkgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNbcHJvcGVydHldID0gdHJhY2subWFwKCh0cmFjaykgPT4gQXJyYXkodHJhY2subGVuZ3RoKS5maWxsKG51bGwpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcHJvcGVydGllc1twcm9wZXJ0eV1baV0gPSBleHRlbmRlZFByb3BlcnRpZXNbcHJvcGVydHldOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoJICAgIGlmICh0cmFjay5sZW5ndGggPT09IDApCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIGlmICh0aW1lcy5sZW5ndGggfHwgaGVhcnRSYXRlcy5sZW5ndGgpIHsKCSAgICAgICAgcHJvcGVydGllcy5jb29yZGluYXRlUHJvcGVydGllcyA9IE9iamVjdC5hc3NpZ24odGltZXMubGVuZ3RoCgkgICAgICAgICAgICA/IHsKCSAgICAgICAgICAgICAgICB0aW1lczogdHJhY2subGVuZ3RoID09PSAxID8gdGltZXNbMF0gOiB0aW1lcywKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIDoge30sIGhlYXJ0UmF0ZXMubGVuZ3RoCgkgICAgICAgICAgICA/IHsKCSAgICAgICAgICAgICAgICBoZWFydDogdHJhY2subGVuZ3RoID09PSAxID8gaGVhcnRSYXRlc1swXSA6IGhlYXJ0UmF0ZXMsCgkgICAgICAgICAgICB9CgkgICAgICAgICAgICA6IHt9KTsKCSAgICB9CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmUiLAoJICAgICAgICBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLAoJICAgICAgICBnZW9tZXRyeTogdHJhY2subGVuZ3RoID09PSAxCgkgICAgICAgICAgICA/IHsKCSAgICAgICAgICAgICAgICB0eXBlOiAiTGluZVN0cmluZyIsCgkgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IHRyYWNrWzBdLAoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgOiB7CgkgICAgICAgICAgICAgICAgdHlwZTogIk11bHRpTGluZVN0cmluZyIsCgkgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IHRyYWNrLAoJICAgICAgICAgICAgfSwKCSAgICB9OwoJfQoJLyoqCgkgKiBJbmNyZW1lbnRhbGx5IGNvbnZlcnQgYSBUQ1ggZG9jdW1lbnQgdG8gR2VvSlNPTi4gVGhlCgkgKiBmaXJzdCBhcmd1bWVudCwgYGRvY2AsIG11c3QgYmUgYSBUQ1gKCSAqIGRvY3VtZW50IGFzIGFuIFhNTCBET00gLSBub3QgYXMgYSBzdHJpbmcuCgkgKi8KCWZ1bmN0aW9uKiB0Y3hHZW4obm9kZSkgewoJICAgIGZvciAoY29uc3QgbGFwIG9mICQobm9kZSwgIkxhcCIpKSB7CgkgICAgICAgIGNvbnN0IGZlYXR1cmUgPSBnZXRMYXAobGFwKTsKCSAgICAgICAgaWYgKGZlYXR1cmUpCgkgICAgICAgICAgICB5aWVsZCBmZWF0dXJlOwoJICAgIH0KCSAgICBmb3IgKGNvbnN0IGNvdXJzZSBvZiAkKG5vZGUsICJDb3Vyc2VzIikpIHsKCSAgICAgICAgY29uc3QgZmVhdHVyZSA9IGdldExhcChjb3Vyc2UpOwoJICAgICAgICBpZiAoZmVhdHVyZSkKCSAgICAgICAgICAgIHlpZWxkIGZlYXR1cmU7CgkgICAgfQoJfQoJLyoqCgkgKiBDb252ZXJ0IGEgVENYIGRvY3VtZW50IHRvIEdlb0pTT04uIFRoZSBmaXJzdCBhcmd1bWVudCwgYGRvY2AsIG11c3QgYmUgYSBUQ1gKCSAqIGRvY3VtZW50IGFzIGFuIFhNTCBET00gLSBub3QgYXMgYSBzdHJpbmcuCgkgKi8KCWZ1bmN0aW9uIHRjeChub2RlKSB7CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmVDb2xsZWN0aW9uIiwKCSAgICAgICAgZmVhdHVyZXM6IEFycmF5LmZyb20odGN4R2VuKG5vZGUpKSwKCSAgICB9OwoJfQoKCWZ1bmN0aW9uIGZpeENvbG9yKHYsIHByZWZpeCkgewoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7fTsKCSAgICBjb25zdCBjb2xvclByb3AgPSBwcmVmaXggPT0gInN0cm9rZSIgfHwgcHJlZml4ID09PSAiZmlsbCIgPyBwcmVmaXggOiBwcmVmaXggKyAiLWNvbG9yIjsKCSAgICBpZiAodlswXSA9PT0gIiMiKSB7CgkgICAgICAgIHYgPSB2LnN1YnN0cmluZygxKTsKCSAgICB9CgkgICAgaWYgKHYubGVuZ3RoID09PSA2IHx8IHYubGVuZ3RoID09PSAzKSB7CgkgICAgICAgIHByb3BlcnRpZXNbY29sb3JQcm9wXSA9ICIjIiArIHY7CgkgICAgfQoJICAgIGVsc2UgaWYgKHYubGVuZ3RoID09PSA4KSB7CgkgICAgICAgIHByb3BlcnRpZXNbcHJlZml4ICsgIi1vcGFjaXR5Il0gPSBwYXJzZUludCh2LnN1YnN0cmluZygwLCAyKSwgMTYpIC8gMjU1OwoJICAgICAgICBwcm9wZXJ0aWVzW2NvbG9yUHJvcF0gPQoJICAgICAgICAgICAgIiMiICsgdi5zdWJzdHJpbmcoNiwgOCkgKyB2LnN1YnN0cmluZyg0LCA2KSArIHYuc3Vic3RyaW5nKDIsIDQpOwoJICAgIH0KCSAgICByZXR1cm4gcHJvcGVydGllczsKCX0KCglmdW5jdGlvbiBudW1lcmljUHJvcGVydHkobm9kZSwgc291cmNlLCB0YXJnZXQpIHsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0ge307CgkgICAgbnVtMShub2RlLCBzb3VyY2UsICh2YWwpID0+IHsKCSAgICAgICAgcHJvcGVydGllc1t0YXJnZXRdID0gdmFsOwoJICAgIH0pOwoJICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJfQoJZnVuY3Rpb24gZ2V0Q29sb3Iobm9kZSwgb3V0cHV0KSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiY29sb3IiLCAoZWxlbSkgPT4gZml4Q29sb3Iobm9kZVZhbChlbGVtKSwgb3V0cHV0KSk7Cgl9CglmdW5jdGlvbiBleHRyYWN0SWNvbkhyZWYobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgIkljb24iLCAoaWNvbiwgcHJvcGVydGllcykgPT4gewoJICAgICAgICB2YWwxKGljb24sICJocmVmIiwgKGhyZWYpID0+IHsKCSAgICAgICAgICAgIHByb3BlcnRpZXMuaWNvbiA9IGhyZWY7CgkgICAgICAgIH0pOwoJICAgICAgICByZXR1cm4gcHJvcGVydGllczsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RJY29uKG5vZGUpIHsKCSAgICByZXR1cm4gZ2V0KG5vZGUsICJJY29uU3R5bGUiLCAoaWNvblN0eWxlKSA9PiB7CgkgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGdldENvbG9yKGljb25TdHlsZSwgImljb24iKSwgbnVtZXJpY1Byb3BlcnR5KGljb25TdHlsZSwgInNjYWxlIiwgImljb24tc2NhbGUiKSwgbnVtZXJpY1Byb3BlcnR5KGljb25TdHlsZSwgImhlYWRpbmciLCAiaWNvbi1oZWFkaW5nIiksIGdldChpY29uU3R5bGUsICJob3RTcG90IiwgKGhvdHNwb3QpID0+IHsKCSAgICAgICAgICAgIGNvbnN0IGxlZnQgPSBwYXJzZUZsb2F0KGhvdHNwb3QuZ2V0QXR0cmlidXRlKCJ4IikgfHwgIiIpOwoJICAgICAgICAgICAgY29uc3QgdG9wID0gcGFyc2VGbG9hdChob3RzcG90LmdldEF0dHJpYnV0ZSgieSIpIHx8ICIiKTsKCSAgICAgICAgICAgIGNvbnN0IHh1bml0cyA9IGhvdHNwb3QuZ2V0QXR0cmlidXRlKCJ4dW5pdHMiKSB8fCAiIjsKCSAgICAgICAgICAgIGNvbnN0IHl1bml0cyA9IGhvdHNwb3QuZ2V0QXR0cmlidXRlKCJ5dW5pdHMiKSB8fCAiIjsKCSAgICAgICAgICAgIGlmICghaXNOYU4obGVmdCkgJiYgIWlzTmFOKHRvcCkpCgkgICAgICAgICAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICAgICAgImljb24tb2Zmc2V0IjogW2xlZnQsIHRvcF0sCgkgICAgICAgICAgICAgICAgICAgICJpY29uLW9mZnNldC11bml0cyI6IFt4dW5pdHMsIHl1bml0c10sCgkgICAgICAgICAgICAgICAgfTsKCSAgICAgICAgICAgIHJldHVybiB7fTsKCSAgICAgICAgfSksIGV4dHJhY3RJY29uSHJlZihpY29uU3R5bGUpKTsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RMYWJlbChub2RlKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiTGFiZWxTdHlsZSIsIChsYWJlbFN0eWxlKSA9PiB7CgkgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGdldENvbG9yKGxhYmVsU3R5bGUsICJsYWJlbCIpLCBudW1lcmljUHJvcGVydHkobGFiZWxTdHlsZSwgInNjYWxlIiwgImxhYmVsLXNjYWxlIikpOwoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZXh0cmFjdExpbmUobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgIkxpbmVTdHlsZSIsIChsaW5lU3R5bGUpID0+IHsKCSAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZ2V0Q29sb3IobGluZVN0eWxlLCAic3Ryb2tlIiksIG51bWVyaWNQcm9wZXJ0eShsaW5lU3R5bGUsICJ3aWR0aCIsICJzdHJva2Utd2lkdGgiKSk7CgkgICAgfSk7Cgl9CglmdW5jdGlvbiBleHRyYWN0UG9seShub2RlKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiUG9seVN0eWxlIiwgKHBvbHlTdHlsZSwgcHJvcGVydGllcykgPT4gewoJICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwcm9wZXJ0aWVzLCBnZXQocG9seVN0eWxlLCAiY29sb3IiLCAoZWxlbSkgPT4gZml4Q29sb3Iobm9kZVZhbChlbGVtKSwgImZpbGwiKSksIHZhbDEocG9seVN0eWxlLCAiZmlsbCIsIChmaWxsKSA9PiB7CgkgICAgICAgICAgICBpZiAoZmlsbCA9PT0gIjAiKQoJICAgICAgICAgICAgICAgIHJldHVybiB7ICJmaWxsLW9wYWNpdHkiOiAwIH07CgkgICAgICAgIH0pLCB2YWwxKHBvbHlTdHlsZSwgIm91dGxpbmUiLCAob3V0bGluZSkgPT4gewoJICAgICAgICAgICAgaWYgKG91dGxpbmUgPT09ICIwIikKCSAgICAgICAgICAgICAgICByZXR1cm4geyAic3Ryb2tlLW9wYWNpdHkiOiAwIH07CgkgICAgICAgIH0pKTsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RTdHlsZShub2RlKSB7CgkgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGV4dHJhY3RQb2x5KG5vZGUpLCBleHRyYWN0TGluZShub2RlKSwgZXh0cmFjdExhYmVsKG5vZGUpLCBleHRyYWN0SWNvbihub2RlKSk7Cgl9CgoJY29uc3QgdG9OdW1iZXIgPSAoeCkgPT4gTnVtYmVyKHgpOwoJY29uc3QgdHlwZUNvbnZlcnRlcnMgPSB7CgkgICAgc3RyaW5nOiAoeCkgPT4geCwKCSAgICBpbnQ6IHRvTnVtYmVyLAoJICAgIHVpbnQ6IHRvTnVtYmVyLAoJICAgIHNob3J0OiB0b051bWJlciwKCSAgICB1c2hvcnQ6IHRvTnVtYmVyLAoJICAgIGZsb2F0OiB0b051bWJlciwKCSAgICBkb3VibGU6IHRvTnVtYmVyLAoJICAgIGJvb2w6ICh4KSA9PiBCb29sZWFuKHgpLAoJfTsKCWZ1bmN0aW9uIGV4dHJhY3RFeHRlbmRlZERhdGEobm9kZSwgc2NoZW1hKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiRXh0ZW5kZWREYXRhIiwgKGV4dGVuZGVkRGF0YSwgcHJvcGVydGllcykgPT4gewoJICAgICAgICBmb3IgKGNvbnN0IGRhdGEgb2YgJChleHRlbmRlZERhdGEsICJEYXRhIikpIHsKCSAgICAgICAgICAgIHByb3BlcnRpZXNbZGF0YS5nZXRBdHRyaWJ1dGUoIm5hbWUiKSB8fCAiIl0gPSBub2RlVmFsKGdldDEoZGF0YSwgInZhbHVlIikpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAoY29uc3Qgc2ltcGxlRGF0YSBvZiAkKGV4dGVuZGVkRGF0YSwgIlNpbXBsZURhdGEiKSkgewoJICAgICAgICAgICAgY29uc3QgbmFtZSA9IHNpbXBsZURhdGEuZ2V0QXR0cmlidXRlKCJuYW1lIikgfHwgIiI7CgkgICAgICAgICAgICBjb25zdCB0eXBlQ29udmVydGVyID0gc2NoZW1hW25hbWVdIHx8IHR5cGVDb252ZXJ0ZXJzLnN0cmluZzsKCSAgICAgICAgICAgIHByb3BlcnRpZXNbbmFtZV0gPSB0eXBlQ29udmVydGVyKG5vZGVWYWwoc2ltcGxlRGF0YSkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZ2V0TWF5YmVIVE1MRGVzY3JpcHRpb24obm9kZSkgewoJICAgIGNvbnN0IGRlc2NyaXB0aW9uTm9kZSA9IGdldDEobm9kZSwgImRlc2NyaXB0aW9uIik7CgkgICAgZm9yIChjb25zdCBjIG9mIEFycmF5LmZyb20oZGVzY3JpcHRpb25Ob2RlPy5jaGlsZE5vZGVzIHx8IFtdKSkgewoJICAgICAgICBpZiAoYy5ub2RlVHlwZSA9PT0gNCkgewoJICAgICAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogewoJICAgICAgICAgICAgICAgICAgICAiQHR5cGUiOiAiaHRtbCIsCgkgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBub2RlVmFsKGMpLAoJICAgICAgICAgICAgICAgIH0sCgkgICAgICAgICAgICB9OwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiB7fTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RUaW1lU3Bhbihub2RlKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiVGltZVNwYW4iLCAodGltZVNwYW4pID0+IHsKCSAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgIHRpbWVzcGFuOiB7CgkgICAgICAgICAgICAgICAgYmVnaW46IG5vZGVWYWwoZ2V0MSh0aW1lU3BhbiwgImJlZ2luIikpLAoJICAgICAgICAgICAgICAgIGVuZDogbm9kZVZhbChnZXQxKHRpbWVTcGFuLCAiZW5kIikpLAoJICAgICAgICAgICAgfSwKCSAgICAgICAgfTsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RUaW1lU3RhbXAobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgIlRpbWVTdGFtcCIsICh0aW1lU3RhbXApID0+IHsKCSAgICAgICAgcmV0dXJuIHsgdGltZXN0YW1wOiBub2RlVmFsKGdldDEodGltZVN0YW1wLCAid2hlbiIpKSB9OwoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZXh0cmFjdENhc2NhZGVkU3R5bGUobm9kZSwgc3R5bGVNYXApIHsKCSAgICByZXR1cm4gdmFsMShub2RlLCAic3R5bGVVcmwiLCAoc3R5bGVVcmwpID0+IHsKCSAgICAgICAgc3R5bGVVcmwgPSBub3JtYWxpemVJZChzdHlsZVVybCk7CgkgICAgICAgIGlmIChzdHlsZU1hcFtzdHlsZVVybF0pIHsKCSAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHsgc3R5bGVVcmwgfSwgc3R5bGVNYXBbc3R5bGVVcmxdKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBGb3IgYmFja3dhcmQtY29tcGF0aWJpbGl0eS4gU2hvdWxkIHdlIHN0aWxsIGluY2x1ZGUKCSAgICAgICAgLy8gc3R5bGVVcmwgZXZlbiBpZiBpdCdzIG5vdCByZXNvbHZlZD8KCSAgICAgICAgcmV0dXJuIHsgc3R5bGVVcmwgfTsKCSAgICB9KTsKCX0KCgljb25zdCByZW1vdmVTcGFjZSA9IC9ccyovZzsKCWNvbnN0IHRyaW1TcGFjZSA9IC9eXHMqfFxzKiQvZzsKCWNvbnN0IHNwbGl0U3BhY2UgPSAvXHMrLzsKCS8qKgoJICogR2V0IG9uZSBjb29yZGluYXRlIGZyb20gYSBjb29yZGluYXRlIGFycmF5LCBpZiBhbnkKCSAqLwoJZnVuY3Rpb24gY29vcmQxKHZhbHVlKSB7CgkgICAgcmV0dXJuIHZhbHVlCgkgICAgICAgIC5yZXBsYWNlKHJlbW92ZVNwYWNlLCAiIikKCSAgICAgICAgLnNwbGl0KCIsIikKCSAgICAgICAgLm1hcChwYXJzZUZsb2F0KQoJICAgICAgICAuZmlsdGVyKChudW0pID0+ICFpc05hTihudW0pKQoJICAgICAgICAuc2xpY2UoMCwgMyk7Cgl9CgkvKioKCSAqIEdldCBhbGwgY29vcmRpbmF0ZXMgZnJvbSBhIGNvb3JkaW5hdGUgYXJyYXkgYXMgW1tdLFtdXQoJICovCglmdW5jdGlvbiBjb29yZCh2YWx1ZSkgewoJICAgIHJldHVybiB2YWx1ZQoJICAgICAgICAucmVwbGFjZSh0cmltU3BhY2UsICIiKQoJICAgICAgICAuc3BsaXQoc3BsaXRTcGFjZSkKCSAgICAgICAgLm1hcChjb29yZDEpCgkgICAgICAgIC5maWx0ZXIoKGNvb3JkKSA9PiB7CgkgICAgICAgIHJldHVybiBjb29yZC5sZW5ndGggPj0gMjsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGd4Q29vcmRzKG5vZGUpIHsKCSAgICBsZXQgZWxlbXMgPSAkKG5vZGUsICJjb29yZCIpOwoJICAgIGlmIChlbGVtcy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgZWxlbXMgPSAkbnMobm9kZSwgImNvb3JkIiwgIioiKTsKCSAgICB9CgkgICAgY29uc3QgY29vcmRpbmF0ZXMgPSBlbGVtcy5tYXAoKGVsZW0pID0+IHsKCSAgICAgICAgcmV0dXJuIG5vZGVWYWwoZWxlbSkuc3BsaXQoIiAiKS5tYXAocGFyc2VGbG9hdCk7CgkgICAgfSk7CgkgICAgaWYgKGNvb3JkaW5hdGVzLmxlbmd0aCA9PT0gMCkgewoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9CgkgICAgcmV0dXJuIHsKCSAgICAgICAgZ2VvbWV0cnk6IGNvb3JkaW5hdGVzLmxlbmd0aCA+IDIKCSAgICAgICAgICAgID8gewoJICAgICAgICAgICAgICAgIHR5cGU6ICJMaW5lU3RyaW5nIiwKCSAgICAgICAgICAgICAgICBjb29yZGluYXRlcywKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIDogewoJICAgICAgICAgICAgICAgIHR5cGU6ICJQb2ludCIsCgkgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IGNvb3JkaW5hdGVzWzBdLAoJICAgICAgICAgICAgfSwKCSAgICAgICAgdGltZXM6ICQobm9kZSwgIndoZW4iKS5tYXAoKGVsZW0pID0+IG5vZGVWYWwoZWxlbSkpLAoJICAgIH07Cgl9CglmdW5jdGlvbiBmaXhSaW5nKHJpbmcpIHsKCSAgICBpZiAocmluZy5sZW5ndGggPT09IDApCgkgICAgICAgIHJldHVybiByaW5nOwoJICAgIGNvbnN0IGZpcnN0ID0gcmluZ1swXTsKCSAgICBjb25zdCBsYXN0ID0gcmluZ1tyaW5nLmxlbmd0aCAtIDFdOwoJICAgIGxldCBlcXVhbCA9IHRydWU7CgkgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLm1heChmaXJzdC5sZW5ndGgsIGxhc3QubGVuZ3RoKTsgaSsrKSB7CgkgICAgICAgIGlmIChmaXJzdFtpXSAhPT0gbGFzdFtpXSkgewoJICAgICAgICAgICAgZXF1YWwgPSBmYWxzZTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgfQoJICAgIGlmICghZXF1YWwpIHsKCSAgICAgICAgcmV0dXJuIHJpbmcuY29uY2F0KFtyaW5nWzBdXSk7CgkgICAgfQoJICAgIHJldHVybiByaW5nOwoJfQoJZnVuY3Rpb24gZ2V0Q29vcmRpbmF0ZXMobm9kZSkgewoJICAgIHJldHVybiBub2RlVmFsKGdldDEobm9kZSwgImNvb3JkaW5hdGVzIikpOwoJfQoJZnVuY3Rpb24gZ2V0R2VvbWV0cnkobm9kZSkgewoJICAgIGxldCBnZW9tZXRyaWVzID0gW107CgkgICAgbGV0IGNvb3JkVGltZXMgPSBbXTsKCSAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykgewoJICAgICAgICBjb25zdCBjaGlsZCA9IG5vZGUuY2hpbGROb2Rlcy5pdGVtKGkpOwoJICAgICAgICBpZiAoaXNFbGVtZW50KGNoaWxkKSkgewoJICAgICAgICAgICAgc3dpdGNoIChjaGlsZC50YWdOYW1lKSB7CgkgICAgICAgICAgICAgICAgY2FzZSAiTXVsdGlHZW9tZXRyeSI6CgkgICAgICAgICAgICAgICAgY2FzZSAiTXVsdGlUcmFjayI6CgkgICAgICAgICAgICAgICAgY2FzZSAiZ3g6TXVsdGlUcmFjayI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGRHZW9tZXRyaWVzID0gZ2V0R2VvbWV0cnkoY2hpbGQpOwoJICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzID0gZ2VvbWV0cmllcy5jb25jYXQoY2hpbGRHZW9tZXRyaWVzLmdlb21ldHJpZXMpOwoJICAgICAgICAgICAgICAgICAgICBjb29yZFRpbWVzID0gY29vcmRUaW1lcy5jb25jYXQoY2hpbGRHZW9tZXRyaWVzLmNvb3JkVGltZXMpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgY2FzZSAiUG9pbnQiOiB7CgkgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gY29vcmQxKGdldENvb3JkaW5hdGVzKGNoaWxkKSk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChjb29yZGluYXRlcy5sZW5ndGggPj0gMikgewoJICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cmllcy5wdXNoKHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiUG9pbnQiLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzLAoJICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhc2UgIkxpbmVhclJpbmciOgoJICAgICAgICAgICAgICAgIGNhc2UgIkxpbmVTdHJpbmciOiB7CgkgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gY29vcmQoZ2V0Q29vcmRpbmF0ZXMoY2hpbGQpKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNvb3JkaW5hdGVzLmxlbmd0aCA+PSAyKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzLnB1c2goewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJMaW5lU3RyaW5nIiwKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlcywKCSAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBjYXNlICJQb2x5Z29uIjogewoJICAgICAgICAgICAgICAgICAgICBjb25zdCBjb29yZHMgPSBbXTsKCSAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lYXJSaW5nIG9mICQoY2hpbGQsICJMaW5lYXJSaW5nIikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJpbmcgPSBmaXhSaW5nKGNvb3JkKGdldENvb3JkaW5hdGVzKGxpbmVhclJpbmcpKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmluZy5sZW5ndGggPj0gNCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3Jkcy5wdXNoKHJpbmcpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmIChjb29yZHMubGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzLnB1c2goewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQb2x5Z29uIiwKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogY29vcmRzLAoJICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhc2UgIlRyYWNrIjoKCSAgICAgICAgICAgICAgICBjYXNlICJneDpUcmFjayI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgZ3ggPSBneENvb3JkcyhjaGlsZCk7CgkgICAgICAgICAgICAgICAgICAgIGlmICghZ3gpCgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgeyB0aW1lcywgZ2VvbWV0cnkgfSA9IGd4OwoJICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzLnB1c2goZ2VvbWV0cnkpOwoJICAgICAgICAgICAgICAgICAgICBpZiAodGltZXMubGVuZ3RoKQoJICAgICAgICAgICAgICAgICAgICAgICAgY29vcmRUaW1lcy5wdXNoKHRpbWVzKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiB7CgkgICAgICAgIGdlb21ldHJpZXMsCgkgICAgICAgIGNvb3JkVGltZXMsCgkgICAgfTsKCX0KCglmdW5jdGlvbiBnZW9tZXRyeUxpc3RUb0dlb21ldHJ5KGdlb21ldHJpZXMpIHsKCSAgICByZXR1cm4gZ2VvbWV0cmllcy5sZW5ndGggPT09IDAKCSAgICAgICAgPyBudWxsCgkgICAgICAgIDogZ2VvbWV0cmllcy5sZW5ndGggPT09IDEKCSAgICAgICAgICAgID8gZ2VvbWV0cmllc1swXQoJICAgICAgICAgICAgOiB7CgkgICAgICAgICAgICAgICAgdHlwZTogIkdlb21ldHJ5Q29sbGVjdGlvbiIsCgkgICAgICAgICAgICAgICAgZ2VvbWV0cmllcywKCSAgICAgICAgICAgIH07Cgl9CglmdW5jdGlvbiBnZXRQbGFjZW1hcmsobm9kZSwgc3R5bGVNYXAsIHNjaGVtYSwgb3B0aW9ucykgewoJICAgIGNvbnN0IHsgY29vcmRUaW1lcywgZ2VvbWV0cmllcyB9ID0gZ2V0R2VvbWV0cnkobm9kZSk7CgkgICAgY29uc3QgZ2VvbWV0cnkgPSBnZW9tZXRyeUxpc3RUb0dlb21ldHJ5KGdlb21ldHJpZXMpOwoJICAgIGlmICghZ2VvbWV0cnkgJiYgb3B0aW9ucy5za2lwTnVsbEdlb21ldHJ5KSB7CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH0KCSAgICBjb25zdCBmZWF0dXJlID0gewoJICAgICAgICB0eXBlOiAiRmVhdHVyZSIsCgkgICAgICAgIGdlb21ldHJ5LAoJICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKGdldE11bHRpKG5vZGUsIFsKCSAgICAgICAgICAgICJuYW1lIiwKCSAgICAgICAgICAgICJhZGRyZXNzIiwKCSAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwKCSAgICAgICAgICAgICJvcGVuIiwKCSAgICAgICAgICAgICJwaG9uZU51bWJlciIsCgkgICAgICAgICAgICAiZGVzY3JpcHRpb24iLAoJICAgICAgICBdKSwgZ2V0TWF5YmVIVE1MRGVzY3JpcHRpb24obm9kZSksIGV4dHJhY3RDYXNjYWRlZFN0eWxlKG5vZGUsIHN0eWxlTWFwKSwgZXh0cmFjdFN0eWxlKG5vZGUpLCBleHRyYWN0RXh0ZW5kZWREYXRhKG5vZGUsIHNjaGVtYSksIGV4dHJhY3RUaW1lU3Bhbihub2RlKSwgZXh0cmFjdFRpbWVTdGFtcChub2RlKSwgY29vcmRUaW1lcy5sZW5ndGgKCSAgICAgICAgICAgID8gewoJICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVQcm9wZXJ0aWVzOiB7CgkgICAgICAgICAgICAgICAgICAgIHRpbWVzOiBjb29yZFRpbWVzLmxlbmd0aCA9PT0gMSA/IGNvb3JkVGltZXNbMF0gOiBjb29yZFRpbWVzLAoJICAgICAgICAgICAgICAgIH0sCgkgICAgICAgICAgICB9CgkgICAgICAgICAgICA6IHt9KSwKCSAgICB9OwoJICAgIGlmIChmZWF0dXJlLnByb3BlcnRpZXM/LnZpc2liaWxpdHkgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICBmZWF0dXJlLnByb3BlcnRpZXMudmlzaWJpbGl0eSA9IGZlYXR1cmUucHJvcGVydGllcy52aXNpYmlsaXR5ICE9PSAiMCI7CgkgICAgfQoJICAgIGNvbnN0IGlkID0gbm9kZS5nZXRBdHRyaWJ1dGUoImlkIik7CgkgICAgaWYgKGlkICE9PSBudWxsICYmIGlkICE9PSAiIikKCSAgICAgICAgZmVhdHVyZS5pZCA9IGlkOwoJICAgIHJldHVybiBmZWF0dXJlOwoJfQoKCWZ1bmN0aW9uIGdldEdyb3VuZE92ZXJsYXlCb3gobm9kZSkgewoJICAgIGNvbnN0IGxhdExvblF1YWQgPSBnZXQxKG5vZGUsICJneDpMYXRMb25RdWFkIik7CgkgICAgaWYgKGxhdExvblF1YWQpIHsKCSAgICAgICAgY29uc3QgcmluZyA9IGZpeFJpbmcoY29vcmQoZ2V0Q29vcmRpbmF0ZXMobm9kZSkpKTsKCSAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICAgICAgdHlwZTogIlBvbHlnb24iLAoJICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbcmluZ10sCgkgICAgICAgICAgICB9LAoJICAgICAgICB9OwoJICAgIH0KCSAgICByZXR1cm4gZ2V0TGF0TG9uQm94KG5vZGUpOwoJfQoJY29uc3QgREVHUkVFU19UT19SQURJQU5TID0gTWF0aC5QSSAvIDE4MDsKCWZ1bmN0aW9uIHJvdGF0ZUJveChiYm94LCBjb29yZGluYXRlcywgcm90YXRpb24pIHsKCSAgICBjb25zdCBjZW50ZXIgPSBbKGJib3hbMF0gKyBiYm94WzJdKSAvIDIsIChiYm94WzFdICsgYmJveFszXSkgLyAyXTsKCSAgICByZXR1cm4gWwoJICAgICAgICBjb29yZGluYXRlc1swXS5tYXAoKGNvb3JkaW5hdGUpID0+IHsKCSAgICAgICAgICAgIGNvbnN0IGR5ID0gY29vcmRpbmF0ZVsxXSAtIGNlbnRlclsxXTsKCSAgICAgICAgICAgIGNvbnN0IGR4ID0gY29vcmRpbmF0ZVswXSAtIGNlbnRlclswXTsKCSAgICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KE1hdGgucG93KGR5LCAyKSArIE1hdGgucG93KGR4LCAyKSk7CgkgICAgICAgICAgICBjb25zdCBhbmdsZSA9IE1hdGguYXRhbjIoZHksIGR4KSArIHJvdGF0aW9uICogREVHUkVFU19UT19SQURJQU5TOwoJICAgICAgICAgICAgcmV0dXJuIFsKCSAgICAgICAgICAgICAgICBjZW50ZXJbMF0gKyBNYXRoLmNvcyhhbmdsZSkgKiBkaXN0YW5jZSwKCSAgICAgICAgICAgICAgICBjZW50ZXJbMV0gKyBNYXRoLnNpbihhbmdsZSkgKiBkaXN0YW5jZSwKCSAgICAgICAgICAgIF07CgkgICAgICAgIH0pLAoJICAgIF07Cgl9CglmdW5jdGlvbiBnZXRMYXRMb25Cb3gobm9kZSkgewoJICAgIGNvbnN0IGxhdExvbkJveCA9IGdldDEobm9kZSwgIkxhdExvbkJveCIpOwoJICAgIGlmIChsYXRMb25Cb3gpIHsKCSAgICAgICAgY29uc3Qgbm9ydGggPSBudW0xKGxhdExvbkJveCwgIm5vcnRoIik7CgkgICAgICAgIGNvbnN0IHdlc3QgPSBudW0xKGxhdExvbkJveCwgIndlc3QiKTsKCSAgICAgICAgY29uc3QgZWFzdCA9IG51bTEobGF0TG9uQm94LCAiZWFzdCIpOwoJICAgICAgICBjb25zdCBzb3V0aCA9IG51bTEobGF0TG9uQm94LCAic291dGgiKTsKCSAgICAgICAgY29uc3Qgcm90YXRpb24gPSBudW0xKGxhdExvbkJveCwgInJvdGF0aW9uIik7CgkgICAgICAgIGlmICh0eXBlb2Ygbm9ydGggPT09ICJudW1iZXIiICYmCgkgICAgICAgICAgICB0eXBlb2Ygc291dGggPT09ICJudW1iZXIiICYmCgkgICAgICAgICAgICB0eXBlb2Ygd2VzdCA9PT0gIm51bWJlciIgJiYKCSAgICAgICAgICAgIHR5cGVvZiBlYXN0ID09PSAibnVtYmVyIikgewoJICAgICAgICAgICAgY29uc3QgYmJveCA9IFt3ZXN0LCBzb3V0aCwgZWFzdCwgbm9ydGhdOwoJICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVzID0gWwoJICAgICAgICAgICAgICAgIFsKCSAgICAgICAgICAgICAgICAgICAgW3dlc3QsIG5vcnRoXSwKCSAgICAgICAgICAgICAgICAgICAgW2Vhc3QsIG5vcnRoXSwKCSAgICAgICAgICAgICAgICAgICAgW2Vhc3QsIHNvdXRoXSwKCSAgICAgICAgICAgICAgICAgICAgW3dlc3QsIHNvdXRoXSwKCSAgICAgICAgICAgICAgICAgICAgW3dlc3QsIG5vcnRoXSwgLy8gdG9wIGxlZnQgKGFnYWluKQoJICAgICAgICAgICAgICAgIF0sCgkgICAgICAgICAgICBdOwoJICAgICAgICAgICAgaWYgKHR5cGVvZiByb3RhdGlvbiA9PT0gIm51bWJlciIpIHsKCSAgICAgICAgICAgICAgICBjb29yZGluYXRlcyA9IHJvdGF0ZUJveChiYm94LCBjb29yZGluYXRlcywgcm90YXRpb24pOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICBiYm94LAoJICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQb2x5Z29uIiwKCSAgICAgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXMsCgkgICAgICAgICAgICAgICAgfSwKCSAgICAgICAgICAgIH07CgkgICAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIG51bGw7Cgl9CglmdW5jdGlvbiBnZXRHcm91bmRPdmVybGF5KG5vZGUsIHN0eWxlTWFwLCBzY2hlbWEsIG9wdGlvbnMpIHsKCSAgICBjb25zdCBib3ggPSBnZXRHcm91bmRPdmVybGF5Qm94KG5vZGUpOwoJICAgIGNvbnN0IGdlb21ldHJ5ID0gYm94Py5nZW9tZXRyeSB8fCBudWxsOwoJICAgIGlmICghZ2VvbWV0cnkgJiYgb3B0aW9ucy5za2lwTnVsbEdlb21ldHJ5KSB7CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH0KCSAgICBjb25zdCBmZWF0dXJlID0gewoJICAgICAgICB0eXBlOiAiRmVhdHVyZSIsCgkgICAgICAgIGdlb21ldHJ5LAoJICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKAoJICAgICAgICAvKioKCSAgICAgICAgICogUmVsYXRlZCB0bwoJICAgICAgICAgKiBodHRwczovL2dpc3QuZ2l0aHViLmNvbS90bWN3LzAzN2ExY2I2NjYwZDc0YTM5MmU5ZGE3NDQ2NTQwZjQ2CgkgICAgICAgICAqLwoJICAgICAgICB7ICJAZ2VvbWV0cnktdHlwZSI6ICJncm91bmRvdmVybGF5IiB9LCBnZXRNdWx0aShub2RlLCBbCgkgICAgICAgICAgICAibmFtZSIsCgkgICAgICAgICAgICAiYWRkcmVzcyIsCgkgICAgICAgICAgICAidmlzaWJpbGl0eSIsCgkgICAgICAgICAgICAib3BlbiIsCgkgICAgICAgICAgICAicGhvbmVOdW1iZXIiLAoJICAgICAgICAgICAgImRlc2NyaXB0aW9uIiwKCSAgICAgICAgXSksIGdldE1heWJlSFRNTERlc2NyaXB0aW9uKG5vZGUpLCBleHRyYWN0Q2FzY2FkZWRTdHlsZShub2RlLCBzdHlsZU1hcCksIGV4dHJhY3RTdHlsZShub2RlKSwgZXh0cmFjdEljb25IcmVmKG5vZGUpLCBleHRyYWN0RXh0ZW5kZWREYXRhKG5vZGUsIHNjaGVtYSksIGV4dHJhY3RUaW1lU3Bhbihub2RlKSwgZXh0cmFjdFRpbWVTdGFtcChub2RlKSksCgkgICAgfTsKCSAgICBpZiAoYm94Py5iYm94KSB7CgkgICAgICAgIGZlYXR1cmUuYmJveCA9IGJveC5iYm94OwoJICAgIH0KCSAgICBpZiAoZmVhdHVyZS5wcm9wZXJ0aWVzPy52aXNpYmlsaXR5ICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgZmVhdHVyZS5wcm9wZXJ0aWVzLnZpc2liaWxpdHkgPSBmZWF0dXJlLnByb3BlcnRpZXMudmlzaWJpbGl0eSAhPT0gIjAiOwoJICAgIH0KCSAgICBjb25zdCBpZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCJpZCIpOwoJICAgIGlmIChpZCAhPT0gbnVsbCAmJiBpZCAhPT0gIiIpCgkgICAgICAgIGZlYXR1cmUuaWQgPSBpZDsKCSAgICByZXR1cm4gZmVhdHVyZTsKCX0KCglmdW5jdGlvbiBnZXRTdHlsZUlkKHN0eWxlKSB7CgkgICAgbGV0IGlkID0gc3R5bGUuZ2V0QXR0cmlidXRlKCJpZCIpOwoJICAgIGNvbnN0IHBhcmVudE5vZGUgPSBzdHlsZS5wYXJlbnROb2RlOwoJICAgIGlmICghaWQgJiYKCSAgICAgICAgaXNFbGVtZW50KHBhcmVudE5vZGUpICYmCgkgICAgICAgIHBhcmVudE5vZGUubG9jYWxOYW1lID09PSAiQ2FzY2FkaW5nU3R5bGUiKSB7CgkgICAgICAgIGlkID0gcGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoImttbDppZCIpIHx8IHBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCJpZCIpOwoJICAgIH0KCSAgICByZXR1cm4gbm9ybWFsaXplSWQoaWQgfHwgIiIpOwoJfQoJZnVuY3Rpb24gYnVpbGRTdHlsZU1hcChub2RlKSB7CgkgICAgY29uc3Qgc3R5bGVNYXAgPSB7fTsKCSAgICBmb3IgKGNvbnN0IHN0eWxlIG9mICQobm9kZSwgIlN0eWxlIikpIHsKCSAgICAgICAgc3R5bGVNYXBbZ2V0U3R5bGVJZChzdHlsZSldID0gZXh0cmFjdFN0eWxlKHN0eWxlKTsKCSAgICB9CgkgICAgZm9yIChjb25zdCBtYXAgb2YgJChub2RlLCAiU3R5bGVNYXAiKSkgewoJICAgICAgICBjb25zdCBpZCA9IG5vcm1hbGl6ZUlkKG1hcC5nZXRBdHRyaWJ1dGUoImlkIikgfHwgIiIpOwoJICAgICAgICB2YWwxKG1hcCwgInN0eWxlVXJsIiwgKHN0eWxlVXJsKSA9PiB7CgkgICAgICAgICAgICBzdHlsZVVybCA9IG5vcm1hbGl6ZUlkKHN0eWxlVXJsKTsKCSAgICAgICAgICAgIGlmIChzdHlsZU1hcFtzdHlsZVVybF0pIHsKCSAgICAgICAgICAgICAgICBzdHlsZU1hcFtpZF0gPSBzdHlsZU1hcFtzdHlsZVVybF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgIH0KCSAgICByZXR1cm4gc3R5bGVNYXA7Cgl9CglmdW5jdGlvbiBidWlsZFNjaGVtYShub2RlKSB7CgkgICAgY29uc3Qgc2NoZW1hID0ge307CgkgICAgZm9yIChjb25zdCBmaWVsZCBvZiAkKG5vZGUsICJTaW1wbGVGaWVsZCIpKSB7CgkgICAgICAgIHNjaGVtYVtmaWVsZC5nZXRBdHRyaWJ1dGUoIm5hbWUiKSB8fCAiIl0gPQoJICAgICAgICAgICAgdHlwZUNvbnZlcnRlcnNbZmllbGQuZ2V0QXR0cmlidXRlKCJ0eXBlIikgfHwgIiJdIHx8CgkgICAgICAgICAgICAgICAgdHlwZUNvbnZlcnRlcnNbInN0cmluZyJdOwoJICAgIH0KCSAgICByZXR1cm4gc2NoZW1hOwoJfQoJY29uc3QgRk9MREVSX1BST1BTID0gWwoJICAgICJuYW1lIiwKCSAgICAidmlzaWJpbGl0eSIsCgkgICAgIm9wZW4iLAoJICAgICJhZGRyZXNzIiwKCSAgICAiZGVzY3JpcHRpb24iLAoJICAgICJwaG9uZU51bWJlciIsCgkgICAgInZpc2liaWxpdHkiLAoJXTsKCWZ1bmN0aW9uIGdldEZvbGRlcihub2RlKSB7CgkgICAgY29uc3QgbWV0YSA9IHt9OwoJICAgIGZvciAoY29uc3QgY2hpbGQgb2YgQXJyYXkuZnJvbShub2RlLmNoaWxkTm9kZXMpKSB7CgkgICAgICAgIGlmIChpc0VsZW1lbnQoY2hpbGQpICYmIEZPTERFUl9QUk9QUy5pbmNsdWRlcyhjaGlsZC50YWdOYW1lKSkgewoJICAgICAgICAgICAgbWV0YVtjaGlsZC50YWdOYW1lXSA9IG5vZGVWYWwoY2hpbGQpOwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICJmb2xkZXIiLAoJICAgICAgICBtZXRhLAoJICAgICAgICBjaGlsZHJlbjogW10sCgkgICAgfTsKCX0KCS8qKgoJICogWWllbGQgYSBuZXN0ZWQgdHJlZSB3aXRoIEtNTCBmb2xkZXIgc3RydWN0dXJlCgkgKgoJICogVGhpcyBnZW5lcmF0ZXMgYSB0cmVlIHdpdGggdGhlIGdpdmVuIHN0cnVjdHVyZToKCSAqCgkgKiBgYGBqcwoJICogewoJICogICAidHlwZSI6ICJyb290IiwKCSAqICAgImNoaWxkcmVuIjogWwoJICogICAgIHsKCSAqICAgICAgICJ0eXBlIjogImZvbGRlciIsCgkgKiAgICAgICAibWV0YSI6IHsKCSAqICAgICAgICAgIm5hbWUiOiAiVGVzdCIKCSAqICAgICAgIH0sCgkgKiAgICAgICAiY2hpbGRyZW4iOiBbCgkgKiAgICAgICAgICAvLyAuLi5mZWF0dXJlcyBhbmQgZm9sZGVycwoJICogICAgICAgXQoJICogICAgIH0KCSAqICAgICAvLyAuLi5mZWF0dXJlcwoJICogICBdCgkgKiB9CgkgKiBgYGAKCSAqCgkgKiAjIyMgR3JvdW5kT3ZlcmxheQoJICoKCSAqIEdyb3VuZE92ZXJsYXkgZWxlbWVudHMgYXJlIGNvbnZlcnRlZCBpbnRvCgkgKiBgRmVhdHVyZWAgb2JqZWN0cyB3aXRoIGBQb2x5Z29uYCBnZW9tZXRyaWVzLAoJICogYSBwcm9wZXJ0eSBsaWtlOgoJICoKCSAqIGBgYGpzb24KCSAqIHsKCSAqICAgIkBnZW9tZXRyeS10eXBlIjogImdyb3VuZG92ZXJsYXkiCgkgKiB9CgkgKiBgYGAKCSAqCgkgKiBBbmQgdGhlIGdyb3VuZCBvdmVybGF5J3MgaW1hZ2UgVVJMIGluIHRoZSBgaHJlZmAKCSAqIHByb3BlcnR5LiBHcm91bmQgb3ZlcmxheXMgd2lsbCBuZWVkIHRvIGJlIGRpc3BsYXllZAoJICogd2l0aCBhIHNlcGFyYXRlIG1ldGhvZCB0byBvdGhlciBmZWF0dXJlcywgZGVwZW5kaW5nCgkgKiBvbiB3aGljaCBtYXAgZnJhbWV3b3JrIHlvdSdyZSB1c2luZy4KCSAqLwoJZnVuY3Rpb24ga21sV2l0aEZvbGRlcnMobm9kZSwgb3B0aW9ucyA9IHsKCSAgICBza2lwTnVsbEdlb21ldHJ5OiBmYWxzZSwKCX0pIHsKCSAgICBjb25zdCBzdHlsZU1hcCA9IGJ1aWxkU3R5bGVNYXAobm9kZSk7CgkgICAgY29uc3Qgc2NoZW1hID0gYnVpbGRTY2hlbWEobm9kZSk7CgkgICAgY29uc3QgdHJlZSA9IHsgdHlwZTogInJvb3QiLCBjaGlsZHJlbjogW10gfTsKCSAgICBmdW5jdGlvbiB0cmF2ZXJzZShub2RlLCBwb2ludGVyLCBvcHRpb25zKSB7CgkgICAgICAgIGlmIChpc0VsZW1lbnQobm9kZSkpIHsKCSAgICAgICAgICAgIHN3aXRjaCAobm9kZS50YWdOYW1lKSB7CgkgICAgICAgICAgICAgICAgY2FzZSAiR3JvdW5kT3ZlcmxheSI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgcGxhY2VtYXJrID0gZ2V0R3JvdW5kT3ZlcmxheShub2RlLCBzdHlsZU1hcCwgc2NoZW1hLCBvcHRpb25zKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHBsYWNlbWFyaykgewoJICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlci5jaGlsZHJlbi5wdXNoKHBsYWNlbWFyayk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhc2UgIlBsYWNlbWFyayI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgcGxhY2VtYXJrID0gZ2V0UGxhY2VtYXJrKG5vZGUsIHN0eWxlTWFwLCBzY2hlbWEsIG9wdGlvbnMpOwoJICAgICAgICAgICAgICAgICAgICBpZiAocGxhY2VtYXJrKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBwb2ludGVyLmNoaWxkcmVuLnB1c2gocGxhY2VtYXJrKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgY2FzZSAiRm9sZGVyIjogewoJICAgICAgICAgICAgICAgICAgICBjb25zdCBmb2xkZXIgPSBnZXRGb2xkZXIobm9kZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvaW50ZXIuY2hpbGRyZW4ucHVzaChmb2xkZXIpOwoJICAgICAgICAgICAgICAgICAgICBwb2ludGVyID0gZm9sZGVyOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG5vZGUuY2hpbGROb2RlcykgewoJICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2RlLmNoaWxkTm9kZXMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgICAgICB0cmF2ZXJzZShub2RlLmNoaWxkTm9kZXNbaV0sIHBvaW50ZXIsIG9wdGlvbnMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoJICAgIHRyYXZlcnNlKG5vZGUsIHRyZWUsIG9wdGlvbnMpOwoJICAgIHJldHVybiB0cmVlOwoJfQoJLyoqCgkgKiBDb252ZXJ0IEtNTCB0byBHZW9KU09OIGluY3JlbWVudGFsbHksIHJldHVybmluZwoJICogYSBbR2VuZXJhdG9yXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L0d1aWRlL0l0ZXJhdG9yc19hbmRfR2VuZXJhdG9ycykKCSAqIHRoYXQgeWllbGRzIG91dHB1dCBmZWF0dXJlIGJ5IGZlYXR1cmUuCgkgKi8KCWZ1bmN0aW9uKiBrbWxHZW4obm9kZSwgb3B0aW9ucyA9IHsKCSAgICBza2lwTnVsbEdlb21ldHJ5OiBmYWxzZSwKCX0pIHsKCSAgICBjb25zdCBzdHlsZU1hcCA9IGJ1aWxkU3R5bGVNYXAobm9kZSk7CgkgICAgY29uc3Qgc2NoZW1hID0gYnVpbGRTY2hlbWEobm9kZSk7CgkgICAgZm9yIChjb25zdCBwbGFjZW1hcmsgb2YgJChub2RlLCAiUGxhY2VtYXJrIikpIHsKCSAgICAgICAgY29uc3QgZmVhdHVyZSA9IGdldFBsYWNlbWFyayhwbGFjZW1hcmssIHN0eWxlTWFwLCBzY2hlbWEsIG9wdGlvbnMpOwoJICAgICAgICBpZiAoZmVhdHVyZSkKCSAgICAgICAgICAgIHlpZWxkIGZlYXR1cmU7CgkgICAgfQoJICAgIGZvciAoY29uc3QgZ3JvdW5kT3ZlcmxheSBvZiAkKG5vZGUsICJHcm91bmRPdmVybGF5IikpIHsKCSAgICAgICAgY29uc3QgZmVhdHVyZSA9IGdldEdyb3VuZE92ZXJsYXkoZ3JvdW5kT3ZlcmxheSwgc3R5bGVNYXAsIHNjaGVtYSwgb3B0aW9ucyk7CgkgICAgICAgIGlmIChmZWF0dXJlKQoJICAgICAgICAgICAgeWllbGQgZmVhdHVyZTsKCSAgICB9Cgl9CgkvKioKCSAqIENvbnZlcnQgYSBLTUwgZG9jdW1lbnQgdG8gR2VvSlNPTi4gVGhlIGZpcnN0IGFyZ3VtZW50LCBgZG9jYCwgbXVzdCBiZSBhIEtNTAoJICogZG9jdW1lbnQgYXMgYW4gWE1MIERPTSAtIG5vdCBhcyBhIHN0cmluZy4gWW91IGNhbiBnZXQgdGhpcyB1c2luZyBqUXVlcnkncyBkZWZhdWx0CgkgKiBgLmFqYXhgIGZ1bmN0aW9uIG9yIHVzaW5nIGEgYmFyZSBYTUxIdHRwUmVxdWVzdCB3aXRoIHRoZSBgLnJlc3BvbnNlYCBwcm9wZXJ0eQoJICogaG9sZGluZyBhbiBYTUwgRE9NLgoJICoKCSAqIFRoZSBvdXRwdXQgaXMgYSBKYXZhU2NyaXB0IG9iamVjdCBvZiBHZW9KU09OIGRhdGEuIFlvdSBjYW4gY29udmVydCBpdCB0byBhIHN0cmluZwoJICogd2l0aCBbSlNPTi5zdHJpbmdpZnldKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0pTT04vc3RyaW5naWZ5KQoJICogb3IgdXNlIGl0IGRpcmVjdGx5IGluIGxpYnJhcmllcy4KCSAqLwoJZnVuY3Rpb24ga21sKG5vZGUsIG9wdGlvbnMgPSB7CgkgICAgc2tpcE51bGxHZW9tZXRyeTogZmFsc2UsCgl9KSB7CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmVDb2xsZWN0aW9uIiwKCSAgICAgICAgZmVhdHVyZXM6IEFycmF5LmZyb20oa21sR2VuKG5vZGUsIG9wdGlvbnMpKSwKCSAgICB9OwoJfQoKCXZhciB0b0dlb0pzb24gPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7CgkJX19wcm90b19fOiBudWxsLAoJCWdweDogZ3B4LAoJCWdweEdlbjogZ3B4R2VuLAoJCWttbDoga21sLAoJCWttbEdlbjoga21sR2VuLAoJCWttbFdpdGhGb2xkZXJzOiBrbWxXaXRoRm9sZGVycywKCQl0Y3g6IHRjeCwKCQl0Y3hHZW46IHRjeEdlbgoJfSk7CgoJdmFyIHBvbHlsaW5lID0ge2V4cG9ydHM6IHt9fTsKCgkoZnVuY3Rpb24gKG1vZHVsZSkgewoKCQkvKioKCQkgKiBCYXNlZCBvZmYgb2YgW3RoZSBvZmZpY2FsIEdvb2dsZSBkb2N1bWVudF0oaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vbWFwcy9kb2N1bWVudGF0aW9uL3V0aWxpdGllcy9wb2x5bGluZWFsZ29yaXRobSkKCQkgKgoJCSAqIFNvbWUgcGFydHMgZnJvbSBbdGhpcyBpbXBsZW1lbnRhdGlvbl0oaHR0cDovL2ZhY3N0YWZmLnVuY2EuZWR1L21jbWNjbHVyL0dvb2dsZU1hcHMvRW5jb2RlUG9seWxpbmUvUG9seWxpbmVFbmNvZGVyLmpzKQoJCSAqIGJ5IFtNYXJrIE1jQ2x1cmVdKGh0dHA6Ly9mYWNzdGFmZi51bmNhLmVkdS9tY21jY2x1ci8pCgkJICoKCQkgKiBAbW9kdWxlIHBvbHlsaW5lCgkJICovCgoJCXZhciBwb2x5bGluZSA9IHt9OwoKCQlmdW5jdGlvbiBweTJfcm91bmQodmFsdWUpIHsKCQkgICAgLy8gR29vZ2xlJ3MgcG9seWxpbmUgYWxnb3JpdGhtIHVzZXMgdGhlIHNhbWUgcm91bmRpbmcgc3RyYXRlZ3kgYXMgUHl0aG9uIDIsIHdoaWNoIGlzIGRpZmZlcmVudCBmcm9tIEpTIGZvciBuZWdhdGl2ZSB2YWx1ZXMKCQkgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5hYnModmFsdWUpICsgMC41KSAqICh2YWx1ZSA+PSAwID8gMSA6IC0xKTsKCQl9CgoJCWZ1bmN0aW9uIGVuY29kZShjdXJyZW50LCBwcmV2aW91cywgZmFjdG9yKSB7CgkJICAgIGN1cnJlbnQgPSBweTJfcm91bmQoY3VycmVudCAqIGZhY3Rvcik7CgkJICAgIHByZXZpb3VzID0gcHkyX3JvdW5kKHByZXZpb3VzICogZmFjdG9yKTsKCQkgICAgdmFyIGNvb3JkaW5hdGUgPSAoY3VycmVudCAtIHByZXZpb3VzKSAqIDI7CgkJICAgIGlmIChjb29yZGluYXRlIDwgMCkgewoJCSAgICAgICAgY29vcmRpbmF0ZSA9IC1jb29yZGluYXRlIC0gMTsKCQkgICAgfQoJCSAgICB2YXIgb3V0cHV0ID0gJyc7CgkJICAgIHdoaWxlIChjb29yZGluYXRlID49IDB4MjApIHsKCQkgICAgICAgIG91dHB1dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgweDIwIHwgKGNvb3JkaW5hdGUgJiAweDFmKSkgKyA2Myk7CgkJICAgICAgICBjb29yZGluYXRlIC89IDMyOwoJCSAgICB9CgkJICAgIG91dHB1dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChjb29yZGluYXRlIHwgMCkgKyA2Myk7CgkJICAgIHJldHVybiBvdXRwdXQ7CgkJfQoKCQkvKioKCQkgKiBEZWNvZGVzIHRvIGEgW2xhdGl0dWRlLCBsb25naXR1ZGVdIGNvb3JkaW5hdGVzIGFycmF5LgoJCSAqCgkJICogVGhpcyBpcyBhZGFwdGVkIGZyb20gdGhlIGltcGxlbWVudGF0aW9uIGluIFByb2plY3QtT1NSTS4KCQkgKgoJCSAqIEBwYXJhbSB7U3RyaW5nfSBzdHIKCQkgKiBAcGFyYW0ge051bWJlcn0gcHJlY2lzaW9uCgkJICogQHJldHVybnMge0FycmF5fQoJCSAqCgkJICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vUHJvamVjdC1PU1JNL29zcm0tZnJvbnRlbmQvYmxvYi9tYXN0ZXIvV2ViQ29udGVudC9yb3V0aW5nL09TUk0uUm91dGluZ0dlb21ldHJ5LmpzCgkJICovCgkJcG9seWxpbmUuZGVjb2RlID0gZnVuY3Rpb24oc3RyLCBwcmVjaXNpb24pIHsKCQkgICAgdmFyIGluZGV4ID0gMCwKCQkgICAgICAgIGxhdCA9IDAsCgkJICAgICAgICBsbmcgPSAwLAoJCSAgICAgICAgY29vcmRpbmF0ZXMgPSBbXSwKCQkgICAgICAgIHNoaWZ0ID0gMCwKCQkgICAgICAgIHJlc3VsdCA9IDAsCgkJICAgICAgICBieXRlID0gbnVsbCwKCQkgICAgICAgIGxhdGl0dWRlX2NoYW5nZSwKCQkgICAgICAgIGxvbmdpdHVkZV9jaGFuZ2UsCgkJICAgICAgICBmYWN0b3IgPSBNYXRoLnBvdygxMCwgTnVtYmVyLmlzSW50ZWdlcihwcmVjaXNpb24pID8gcHJlY2lzaW9uIDogNSk7CgoJCSAgICAvLyBDb29yZGluYXRlcyBoYXZlIHZhcmlhYmxlIGxlbmd0aCB3aGVuIGVuY29kZWQsIHNvIGp1c3Qga2VlcAoJCSAgICAvLyB0cmFjayBvZiB3aGV0aGVyIHdlJ3ZlIGhpdCB0aGUgZW5kIG9mIHRoZSBzdHJpbmcuIEluIGVhY2gKCQkgICAgLy8gbG9vcCBpdGVyYXRpb24sIGEgc2luZ2xlIGNvb3JkaW5hdGUgaXMgZGVjb2RlZC4KCQkgICAgd2hpbGUgKGluZGV4IDwgc3RyLmxlbmd0aCkgewoKCQkgICAgICAgIC8vIFJlc2V0IHNoaWZ0LCByZXN1bHQsIGFuZCBieXRlCgkJICAgICAgICBieXRlID0gbnVsbDsKCQkgICAgICAgIHNoaWZ0ID0gMTsKCQkgICAgICAgIHJlc3VsdCA9IDA7CgoJCSAgICAgICAgZG8gewoJCSAgICAgICAgICAgIGJ5dGUgPSBzdHIuY2hhckNvZGVBdChpbmRleCsrKSAtIDYzOwoJCSAgICAgICAgICAgIHJlc3VsdCArPSAoYnl0ZSAmIDB4MWYpICogc2hpZnQ7CgkJICAgICAgICAgICAgc2hpZnQgKj0gMzI7CgkJICAgICAgICB9IHdoaWxlIChieXRlID49IDB4MjApOwoKCQkgICAgICAgIGxhdGl0dWRlX2NoYW5nZSA9IChyZXN1bHQgJiAxKSA/ICgoLXJlc3VsdCAtIDEpIC8gMikgOiAocmVzdWx0IC8gMik7CgoJCSAgICAgICAgc2hpZnQgPSAxOwoJCSAgICAgICAgcmVzdWx0ID0gMDsKCgkJICAgICAgICBkbyB7CgkJICAgICAgICAgICAgYnl0ZSA9IHN0ci5jaGFyQ29kZUF0KGluZGV4KyspIC0gNjM7CgkJICAgICAgICAgICAgcmVzdWx0ICs9IChieXRlICYgMHgxZikgKiBzaGlmdDsKCQkgICAgICAgICAgICBzaGlmdCAqPSAzMjsKCQkgICAgICAgIH0gd2hpbGUgKGJ5dGUgPj0gMHgyMCk7CgoJCSAgICAgICAgbG9uZ2l0dWRlX2NoYW5nZSA9IChyZXN1bHQgJiAxKSA/ICgoLXJlc3VsdCAtIDEpIC8gMikgOiAocmVzdWx0IC8gMik7CgoJCSAgICAgICAgbGF0ICs9IGxhdGl0dWRlX2NoYW5nZTsKCQkgICAgICAgIGxuZyArPSBsb25naXR1ZGVfY2hhbmdlOwoKCQkgICAgICAgIGNvb3JkaW5hdGVzLnB1c2goW2xhdCAvIGZhY3RvciwgbG5nIC8gZmFjdG9yXSk7CgkJICAgIH0KCgkJICAgIHJldHVybiBjb29yZGluYXRlczsKCQl9OwoKCQkvKioKCQkgKiBFbmNvZGVzIHRoZSBnaXZlbiBbbGF0aXR1ZGUsIGxvbmdpdHVkZV0gY29vcmRpbmF0ZXMgYXJyYXkuCgkJICoKCQkgKiBAcGFyYW0ge0FycmF5LjxBcnJheS48TnVtYmVyPj59IGNvb3JkaW5hdGVzCgkJICogQHBhcmFtIHtOdW1iZXJ9IHByZWNpc2lvbgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9CgkJICovCgkJcG9seWxpbmUuZW5jb2RlID0gZnVuY3Rpb24oY29vcmRpbmF0ZXMsIHByZWNpc2lvbikgewoJCSAgICBpZiAoIWNvb3JkaW5hdGVzLmxlbmd0aCkgeyByZXR1cm4gJyc7IH0KCgkJICAgIHZhciBmYWN0b3IgPSBNYXRoLnBvdygxMCwgTnVtYmVyLmlzSW50ZWdlcihwcmVjaXNpb24pID8gcHJlY2lzaW9uIDogNSksCgkJICAgICAgICBvdXRwdXQgPSBlbmNvZGUoY29vcmRpbmF0ZXNbMF1bMF0sIDAsIGZhY3RvcikgKyBlbmNvZGUoY29vcmRpbmF0ZXNbMF1bMV0sIDAsIGZhY3Rvcik7CgoJCSAgICBmb3IgKHZhciBpID0gMTsgaSA8IGNvb3JkaW5hdGVzLmxlbmd0aDsgaSsrKSB7CgkJICAgICAgICB2YXIgYSA9IGNvb3JkaW5hdGVzW2ldLCBiID0gY29vcmRpbmF0ZXNbaSAtIDFdOwoJCSAgICAgICAgb3V0cHV0ICs9IGVuY29kZShhWzBdLCBiWzBdLCBmYWN0b3IpOwoJCSAgICAgICAgb3V0cHV0ICs9IGVuY29kZShhWzFdLCBiWzFdLCBmYWN0b3IpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gb3V0cHV0OwoJCX07CgoJCWZ1bmN0aW9uIGZsaXBwZWQoY29vcmRzKSB7CgkJICAgIHZhciBmbGlwcGVkID0gW107CgkJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7CgkJICAgICAgICB2YXIgY29vcmQgPSBjb29yZHNbaV0uc2xpY2UoKTsKCQkgICAgICAgIGZsaXBwZWQucHVzaChbY29vcmRbMV0sIGNvb3JkWzBdXSk7CgkJICAgIH0KCQkgICAgcmV0dXJuIGZsaXBwZWQ7CgkJfQoKCQkvKioKCQkgKiBFbmNvZGVzIGEgR2VvSlNPTiBMaW5lU3RyaW5nIGZlYXR1cmUvZ2VvbWV0cnkuCgkJICoKCQkgKiBAcGFyYW0ge09iamVjdH0gZ2VvanNvbgoJCSAqIEBwYXJhbSB7TnVtYmVyfSBwcmVjaXNpb24KCQkgKiBAcmV0dXJucyB7U3RyaW5nfQoJCSAqLwoJCXBvbHlsaW5lLmZyb21HZW9KU09OID0gZnVuY3Rpb24oZ2VvanNvbiwgcHJlY2lzaW9uKSB7CgkJICAgIGlmIChnZW9qc29uICYmIGdlb2pzb24udHlwZSA9PT0gJ0ZlYXR1cmUnKSB7CgkJICAgICAgICBnZW9qc29uID0gZ2VvanNvbi5nZW9tZXRyeTsKCQkgICAgfQoJCSAgICBpZiAoIWdlb2pzb24gfHwgZ2VvanNvbi50eXBlICE9PSAnTGluZVN0cmluZycpIHsKCQkgICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgbXVzdCBiZSBhIEdlb0pTT04gTGluZVN0cmluZycpOwoJCSAgICB9CgkJICAgIHJldHVybiBwb2x5bGluZS5lbmNvZGUoZmxpcHBlZChnZW9qc29uLmNvb3JkaW5hdGVzKSwgcHJlY2lzaW9uKTsKCQl9OwoKCQkvKioKCQkgKiBEZWNvZGVzIHRvIGEgR2VvSlNPTiBMaW5lU3RyaW5nIGdlb21ldHJ5LgoJCSAqCgkJICogQHBhcmFtIHtTdHJpbmd9IHN0cgoJCSAqIEBwYXJhbSB7TnVtYmVyfSBwcmVjaXNpb24KCQkgKiBAcmV0dXJucyB7T2JqZWN0fQoJCSAqLwoJCXBvbHlsaW5lLnRvR2VvSlNPTiA9IGZ1bmN0aW9uKHN0ciwgcHJlY2lzaW9uKSB7CgkJICAgIHZhciBjb29yZHMgPSBwb2x5bGluZS5kZWNvZGUoc3RyLCBwcmVjaXNpb24pOwoJCSAgICByZXR1cm4gewoJCSAgICAgICAgdHlwZTogJ0xpbmVTdHJpbmcnLAoJCSAgICAgICAgY29vcmRpbmF0ZXM6IGZsaXBwZWQoY29vcmRzKQoJCSAgICB9OwoJCX07CgoJCWlmIChtb2R1bGUuZXhwb3J0cykgewoJCSAgICBtb2R1bGUuZXhwb3J0cyA9IHBvbHlsaW5lOwoJCX0gCgl9IChwb2x5bGluZSkpOwoKCXZhciBwb2x5bGluZUV4cG9ydHMgPSBwb2x5bGluZS5leHBvcnRzOwoKCXZhciB1dGlscyA9ICgoKSA9PiB7CgoJICAgIGNvbnN0IHB1cmdlUHJvcHMgPSAob2JqLCBibGFja2xpc3QpID0+IHsKCSAgICAgICAgaWYgKG9iaikgewoJICAgICAgICAgICAgbGV0IHJzID0gT2JqZWN0LmFzc2lnbih7fSwgb2JqKTsKCSAgICAgICAgICAgIGlmIChibGFja2xpc3QpIHsKCSAgICAgICAgICAgICAgICBmb3IgKGxldCBwcm9wIG9mIGJsYWNrbGlzdCkgewoJICAgICAgICAgICAgICAgICAgICBkZWxldGUgcnNbcHJvcF07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIHJzOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB7fTsKCSAgICB9OwoKCSAgICBjb25zdCBtZXJnZVByb3BzID0gKG9iajEsIG9iajIpID0+IHsKCSAgICAgICAgb2JqMSA9IG9iajEgPyBvYmoxIDoge307CgkgICAgICAgIG9iajIgPSBvYmoyID8gb2JqMiA6IHt9OwoJICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihvYmoxLCBvYmoyKTsKCSAgICB9OwoKCSAgICBjb25zdCBmaXJzdCA9IGEgPT4gYVswXTsKCSAgICBjb25zdCBsYXN0ID0gYSA9PiBhW2EubGVuZ3RoIC0gMV07CgkgICAgY29uc3QgY29vcmRzVG9LZXkgPSBhID0+IGEuam9pbignLCcpOwoKCSAgICBjb25zdCBhZGRUb01hcCA9IChtLCBrLCB2KSA9PiB7CgkgICAgICAgIGxldCBhID0gbVtrXTsKCSAgICAgICAgaWYgKGEpIHsKCSAgICAgICAgICAgIGEucHVzaCh2KTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIG1ba10gPSBbdl07CgkgICAgICAgIH0KCSAgICB9OwoKCSAgICBjb25zdCByZW1vdmVGcm9tTWFwID0gKG0sIGssIHYpID0+IHsKCSAgICAgICAgbGV0IGEgPSBtW2tdOwoJICAgICAgICBsZXQgaWR4ID0gbnVsbDsKCSAgICAgICAgaWYgKGEgJiYgKGlkeCA9IGEuaW5kZXhPZih2KSkgPj0gMCkgewoJICAgICAgICAgICAgYS5zcGxpY2UoaWR4LCAxKTsKCSAgICAgICAgfQoJICAgIH07CgoJICAgIGNvbnN0IGdldEZpcnN0RnJvbU1hcCA9IChtLCBrKSA9PiB7CgkgICAgICAgIGxldCBhID0gbVtrXTsKCSAgICAgICAgaWYgKGEgJiYgYS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICByZXR1cm4gYVswXTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoKCSAgICAvLyBuZWVkIDMrIGRpZmZlcmVudCBwb2ludHMgdG8gZm9ybSBhIHJpbmcsIGhlcmUgdXNpbmcgPiAzIGlzICdjb3ogYSB0aGUgZmlyc3QgYW5kIHRoZSBsYXN0IHBvaW50cyBhcmUgYWN0dWFsbHkgdGhlIHNhbWUKCSAgICBjb25zdCBpc1JpbmcgPSBhID0+IGEubGVuZ3RoID4gMyAmJiBjb29yZHNUb0tleShmaXJzdChhKSkgPT09IGNvb3Jkc1RvS2V5KGxhc3QoYSkpOwoKCSAgICBjb25zdCByaW5nRGlyZWN0aW9uID0gKGEsIHhJZHgsIHlJZHgpID0+IHsKCSAgICAgICAgeElkeCA9IHhJZHggfHwgMCwgeUlkeCA9IHlJZHggfHwgMTsKCSAgICAgICAgLy8gZ2V0IHRoZSBpbmRleCBvZiB0aGUgcG9pbnQgd2hpY2ggaGFzIHRoZSBtYXhpbXVtIHggdmFsdWUKCSAgICAgICAgbGV0IG0gPSBhLnJlZHVjZSgobWF4eElkeCwgdiwgaWR4KSA9PiBhW21heHhJZHhdW3hJZHhdID4gdlt4SWR4XSA/IG1heHhJZHggOiBpZHgsIDApOwoJICAgICAgICAvLyAnY296IHRoZSBmaXJzdCBwb2ludCBpcyB2aXJ0dWFsbHkgdGhlIHNhbWUgb25lIGFzIHRoZSBsYXN0IHBvaW50LCAKCSAgICAgICAgLy8gd2UgbmVlZCB0byBza2lwIGEubGVuZ3RoIC0gMSBmb3IgbGVmdCB3aGVuIG0gPSAwLAoJICAgICAgICAvLyBhbmQgc2tpcCAwIGZvciByaWdodCB3aGVuIG0gPSBhLmxlbmd0aCAtIDE7CgkgICAgICAgIGxldCBsID0gbSA8PSAwID8gYS5sZW5ndGggLSAyIDogbSAtIDEsIHIgPSBtID49IGEubGVuZ3RoIC0gMSA/IDEgOiBtICsgMTsKCSAgICAgICAgbGV0IHhhID0gYVtsXVt4SWR4XSwgeGIgPSBhW21dW3hJZHhdLCB4YyA9IGFbcl1beElkeF07CgkgICAgICAgIGxldCB5YSA9IGFbbF1beUlkeF0sIHliID0gYVttXVt5SWR4XSwgeWMgPSBhW3JdW3lJZHhdOwoJICAgICAgICBsZXQgZGV0ID0gKHhiIC0geGEpICogKHljIC0geWEpIC0gKHhjIC0geGEpICogKHliIC0geWEpOwoJICAgICAgICByZXR1cm4gZGV0IDwgMCA/ICdjbG9ja3dpc2UnIDogJ2NvdW50ZXJjbG9ja3dpc2UnOwoJICAgIH07CgoJICAgIGNvbnN0IHB0SW5zaWRlUG9seWdvbiA9IChwdCwgcG9seWdvbiwgeElkeCwgeUlkeCkgPT4gewoJICAgICAgICB4SWR4ID0geElkeCB8fCAwLCB5SWR4ID0geUlkeCB8fCAxOwoJICAgICAgICBsZXQgcmVzdWx0ID0gZmFsc2U7CgkgICAgICAgIGZvciAobGV0IGkgPSAwLCBqID0gcG9seWdvbi5sZW5ndGggLSAxOyBpIDwgcG9seWdvbi5sZW5ndGg7IGogPSBpKyspIHsKCSAgICAgICAgICAgIGlmICgocG9seWdvbltpXVt4SWR4XSA8PSBwdFt4SWR4XSAmJiBwdFt4SWR4XSA8IHBvbHlnb25bal1beElkeF0gfHwKCSAgICAgICAgICAgICAgICBwb2x5Z29uW2pdW3hJZHhdIDw9IHB0W3hJZHhdICYmIHB0W3hJZHhdIDwgcG9seWdvbltpXVt4SWR4XSkgJiYKCSAgICAgICAgICAgICAgICBwdFt5SWR4XSA8IChwb2x5Z29uW2pdW3lJZHhdIC0gcG9seWdvbltpXVt5SWR4XSkgKiAocHRbeElkeF0gLSBwb2x5Z29uW2ldW3hJZHhdKSAvIChwb2x5Z29uW2pdW3hJZHhdIC0gcG9seWdvbltpXVt4SWR4XSkgKyBwb2x5Z29uW2ldW3lJZHhdKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gIXJlc3VsdDsKCSAgICAgICAgICAgIH0KCgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoKCSAgICBjb25zdCBzdHJUb0Zsb2F0ID0gZWwgPT4gZWwgaW5zdGFuY2VvZiBBcnJheSA/IGVsLm1hcChzdHJUb0Zsb2F0KSA6IHBhcnNlRmxvYXQoZWwpOwoKCSAgICBjbGFzcyBSZWZFbGVtZW50cyBleHRlbmRzIE1hcCB7CgkgICAgICAgIGNvbnN0cnVjdG9yKCkgewoJICAgICAgICAgICAgc3VwZXIoKTsKCSAgICAgICAgICAgIHRoaXMuYmluZGVycyA9IFtdOwoJICAgICAgICB9CgoJICAgICAgICBhZGQoaywgdikgewoJICAgICAgICAgICAgaWYgKCF0aGlzLmhhcyhrKSkgewoJICAgICAgICAgICAgICAgIHRoaXMuc2V0KGssIHYpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gc3VwcHJlc3MgZHVwbGNhdGVkIGtleSBlcnJvcgoJICAgICAgICAgICAgLy8gZWxzZQoJICAgICAgICAgICAgLy8gdGhyb3cgYEVycm9yOiBhZGRpbmcgZHVwbGljYXRlZCBrZXkgJyR7a30nIHRvIFJlZkVsZW1lbnRzYDsKCSAgICAgICAgfQoKCSAgICAgICAgYWRkQmluZGVyKGJpbmRlcikgewoJICAgICAgICAgICAgdGhpcy5iaW5kZXJzLnB1c2goYmluZGVyKTsKCSAgICAgICAgfQoKCSAgICAgICAgYmluZEFsbCgpIHsKCSAgICAgICAgICAgIHRoaXMuYmluZGVycy5mb3JFYWNoKGJpbmRlciA9PiBiaW5kZXIuYmluZCgpKTsKCSAgICAgICAgfQoJICAgIH0KCgkgICAgY2xhc3MgTGF0ZUJpbmRlciB7CgkgICAgICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgdmFsdWVGdW5jLCBjdHgsIGFyZ3MpIHsKCSAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyOwoJICAgICAgICAgICAgdGhpcy52YWx1ZUZ1bmMgPSB2YWx1ZUZ1bmM7CgkgICAgICAgICAgICB0aGlzLmN0eCA9IGN0eDsKCSAgICAgICAgICAgIHRoaXMuYXJncyA9IGFyZ3M7CgkgICAgICAgIH0KCgkgICAgICAgIGJpbmQoKSB7CgkgICAgICAgICAgICBsZXQgdiA9IHRoaXMudmFsdWVGdW5jLmFwcGx5KHRoaXMuY3R4LCB0aGlzLmFyZ3MpOwoJICAgICAgICAgICAgaWYgKHRoaXMuY29udGFpbmVyIGluc3RhbmNlb2YgQXJyYXkpIHsKCSAgICAgICAgICAgICAgICBsZXQgaWR4ID0gdGhpcy5jb250YWluZXIuaW5kZXhPZih0aGlzKTsKCSAgICAgICAgICAgICAgICBpZiAoaWR4ID49IDApIHsKCSAgICAgICAgICAgICAgICAgICAgbGV0IGFyZ3MgPSBbaWR4LCAxXTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh2KTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBbXS5zcGxpY2UuYXBwbHkodGhpcy5jb250YWluZXIsIGFyZ3MpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuY29udGFpbmVyID09PSAnb2JqZWN0JykgewoJICAgICAgICAgICAgICAgIGxldCBrID0gT2JqZWN0LmtleXModGhpcy5jb250YWluZXIpLmZpbmQodiA9PiB0aGlzLmNvbnRhaW5lclt2XSA9PT0gdGhpcyk7CgkgICAgICAgICAgICAgICAgaWYgKGspIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyW2tdID0gdjsKCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNvbnRhaW5lcltrXTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCgkgICAgY2xhc3MgV2F5Q29sbGVjdGlvbiBleHRlbmRzIEFycmF5IHsKCSAgICAgICAgY29uc3RydWN0b3IoKSB7CgkgICAgICAgICAgICBzdXBlcigpOwoJICAgICAgICAgICAgdGhpcy5maXJzdE1hcCA9IHt9OwoJICAgICAgICAgICAgdGhpcy5sYXN0TWFwID0ge307CgkgICAgICAgIH0KCgkgICAgICAgIGFkZFdheSh3YXkpIHsKCSAgICAgICAgICAgIHdheSA9IHdheS50b0Nvb3Jkc0FycmF5KCk7CgkgICAgICAgICAgICBpZiAod2F5Lmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICB0aGlzLnB1c2god2F5KTsKCSAgICAgICAgICAgICAgICBhZGRUb01hcCh0aGlzLmZpcnN0TWFwLCBjb29yZHNUb0tleShmaXJzdCh3YXkpKSwgd2F5KTsKCSAgICAgICAgICAgICAgICBhZGRUb01hcCh0aGlzLmxhc3RNYXAsIGNvb3Jkc1RvS2V5KGxhc3Qod2F5KSksIHdheSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAgIHRvU3RyaW5ncygpIHsKCSAgICAgICAgICAgIGxldCBzdHJpbmdzID0gW10sIHdheSA9IG51bGw7CgkgICAgICAgICAgICB3aGlsZSAod2F5ID0gdGhpcy5zaGlmdCgpKSB7CgkgICAgICAgICAgICAgICAgcmVtb3ZlRnJvbU1hcCh0aGlzLmZpcnN0TWFwLCBjb29yZHNUb0tleShmaXJzdCh3YXkpKSwgd2F5KTsKCSAgICAgICAgICAgICAgICByZW1vdmVGcm9tTWFwKHRoaXMubGFzdE1hcCwgY29vcmRzVG9LZXkobGFzdCh3YXkpKSwgd2F5KTsKCSAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IHdheSwgbmV4dCA9IG51bGw7CgkgICAgICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gY29vcmRzVG9LZXkobGFzdChjdXJyZW50KSksIHNob3VsZFJldmVyc2UgPSBmYWxzZTsKCgkgICAgICAgICAgICAgICAgICAgIG5leHQgPSBnZXRGaXJzdEZyb21NYXAodGhpcy5maXJzdE1hcCwga2V5KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCFuZXh0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBuZXh0ID0gZ2V0Rmlyc3RGcm9tTWFwKHRoaXMubGFzdE1hcCwga2V5KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZFJldmVyc2UgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICBpZiAobmV4dCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpY2UodGhpcy5pbmRleE9mKG5leHQpLCAxKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZyb21NYXAodGhpcy5maXJzdE1hcCwgY29vcmRzVG9LZXkoZmlyc3QobmV4dCkpLCBuZXh0KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZyb21NYXAodGhpcy5sYXN0TWFwLCBjb29yZHNUb0tleShsYXN0KG5leHQpKSwgbmV4dCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdWxkUmV2ZXJzZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsd2F5cyByZXZlcnNlIHNob3J0ZXIgb25lIHRvIHNhdmUgdGltZQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0Lmxlbmd0aCA+IGN1cnJlbnQubGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtjdXJyZW50LCBuZXh0XSA9IFtuZXh0LCBjdXJyZW50XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dC5yZXZlcnNlKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQuY29uY2F0KG5leHQuc2xpY2UoMSkpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSB3aGlsZSAobmV4dCk7CgkgICAgICAgICAgICAgICAgc3RyaW5ncy5wdXNoKHN0clRvRmxvYXQoY3VycmVudCkpOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIHJldHVybiBzdHJpbmdzOwoJICAgICAgICB9CgoJICAgICAgICB0b1JpbmdzKGRpcmVjdGlvbikgewoJICAgICAgICAgICAgbGV0IHN0cmluZ3MgPSB0aGlzLnRvU3RyaW5ncygpOwoJICAgICAgICAgICAgbGV0IHJpbmdzID0gW10sIHN0cmluZyA9IG51bGw7CgkgICAgICAgICAgICB3aGlsZSAoc3RyaW5nID0gc3RyaW5ncy5zaGlmdCgpKSB7CgkgICAgICAgICAgICAgICAgaWYgKGlzUmluZyhzdHJpbmcpKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyaW5nRGlyZWN0aW9uKHN0cmluZykgIT09IGRpcmVjdGlvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nLnJldmVyc2UoKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByaW5ncy5wdXNoKHN0cmluZyk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIHJpbmdzOwoJICAgICAgICB9CgkgICAgfQoKCSAgICByZXR1cm4gewoJICAgICAgICBwdXJnZVByb3BzLCBtZXJnZVByb3BzLAoJICAgICAgICBmaXJzdCwgbGFzdCwgY29vcmRzVG9LZXksCgkgICAgICAgIGFkZFRvTWFwLCByZW1vdmVGcm9tTWFwLCBnZXRGaXJzdEZyb21NYXAsCgkgICAgICAgIGlzUmluZywgcmluZ0RpcmVjdGlvbiwgcHRJbnNpZGVQb2x5Z29uLCBzdHJUb0Zsb2F0LAoJICAgICAgICBSZWZFbGVtZW50cywgTGF0ZUJpbmRlciwgV2F5Q29sbGVjdGlvbgoJICAgIH07Cgl9KSgpOwoKCXZhciBidWlsZGluZyA9IHsKCX07Cgl2YXIgaGlnaHdheSA9IHsKCQl3aGl0ZWxpc3Q6IFsKCQkJInNlcnZpY2VzIiwKCQkJInJlc3RfYXJlYSIsCgkJCSJlc2NhcGUiLAoJCQkiZWxldmF0b3IiCgkJXQoJfTsKCXZhciBuYXR1cmFsID0gewoJCWJsYWNrbGlzdDogWwoJCQkiY29hc3RsaW5lIiwKCQkJImNsaWZmIiwKCQkJInJpZGdlIiwKCQkJImFyZXRlIiwKCQkJInRyZWVfcm93IgoJCV0KCX07Cgl2YXIgbGFuZHVzZSA9IHsKCX07Cgl2YXIgd2F0ZXJ3YXkgPSB7CgkJd2hpdGVsaXN0OiBbCgkJCSJyaXZlcmJhbmsiLAoJCQkiZG9jayIsCgkJCSJib2F0eWFyZCIsCgkJCSJkYW0iCgkJXQoJfTsKCXZhciBhbWVuaXR5ID0gewoJfTsKCXZhciBsZWlzdXJlID0gewoJfTsKCXZhciBiYXJyaWVyID0gewoJCXdoaXRlbGlzdDogWwoJCQkiY2l0eV93YWxsIiwKCQkJImRpdGNoIiwKCQkJImhlZGdlIiwKCQkJInJldGFpbmluZ193YWxsIiwKCQkJIndhbGwiLAoJCQkic3Bpa2VzIgoJCV0KCX07Cgl2YXIgcmFpbHdheSA9IHsKCQl3aGl0ZWxpc3Q6IFsKCQkJInN0YXRpb24iLAoJCQkidHVybnRhYmxlIiwKCQkJInJvdW5kaG91c2UiLAoJCQkicGxhdGZvcm0iCgkJXQoJfTsKCXZhciBhcmVhID0gewoJfTsKCXZhciBib3VuZGFyeSA9IHsKCX07Cgl2YXIgbWFuX21hZGUgPSB7CgkJYmxhY2tsaXN0OiBbCgkJCSJjdXRsaW5lIiwKCQkJImVtYmFua21lbnQiLAoJCQkicGlwZWxpbmUiCgkJXQoJfTsKCXZhciBwb3dlciA9IHsKCQl3aGl0ZWxpc3Q6IFsKCQkJInBsYW50IiwKCQkJInN1YnN0YXRpb24iLAoJCQkiZ2VuZXJhdG9yIiwKCQkJInRyYW5zZm9ybWVyIgoJCV0KCX07Cgl2YXIgcGxhY2UgPSB7Cgl9OwoJdmFyIHNob3AgPSB7Cgl9OwoJdmFyIGFlcm93YXkgPSB7CgkJYmxhY2tsaXN0OiBbCgkJCSJ0YXhpd2F5IgoJCV0KCX07Cgl2YXIgdG91cmlzbSA9IHsKCX07Cgl2YXIgaGlzdG9yaWMgPSB7Cgl9OwoJdmFyIHB1YmxpY190cmFuc3BvcnQgPSB7Cgl9OwoJdmFyIG9mZmljZSA9IHsKCX07Cgl2YXIgbWlsaXRhcnkgPSB7Cgl9OwoJdmFyIHJ1aW5zID0gewoJfTsKCXZhciBjcmFmdCA9IHsKCX07Cgl2YXIgZ29sZiA9IHsKCX07Cgl2YXIgaW5kb29yID0gewoJfTsKCXZhciByZXF1aXJlJCQxID0gewoJCWJ1aWxkaW5nOiBidWlsZGluZywKCQloaWdod2F5OiBoaWdod2F5LAoJCW5hdHVyYWw6IG5hdHVyYWwsCgkJbGFuZHVzZTogbGFuZHVzZSwKCQl3YXRlcndheTogd2F0ZXJ3YXksCgkJYW1lbml0eTogYW1lbml0eSwKCQlsZWlzdXJlOiBsZWlzdXJlLAoJCWJhcnJpZXI6IGJhcnJpZXIsCgkJcmFpbHdheTogcmFpbHdheSwKCQlhcmVhOiBhcmVhLAoJCWJvdW5kYXJ5OiBib3VuZGFyeSwKCQltYW5fbWFkZTogbWFuX21hZGUsCgkJcG93ZXI6IHBvd2VyLAoJCXBsYWNlOiBwbGFjZSwKCQlzaG9wOiBzaG9wLAoJCWFlcm93YXk6IGFlcm93YXksCgkJdG91cmlzbTogdG91cmlzbSwKCQloaXN0b3JpYzogaGlzdG9yaWMsCgkJcHVibGljX3RyYW5zcG9ydDogcHVibGljX3RyYW5zcG9ydCwKCQlvZmZpY2U6IG9mZmljZSwKCQkiYnVpbGRpbmc6cGFydCI6IHsKCX0sCgkJbWlsaXRhcnk6IG1pbGl0YXJ5LAoJCXJ1aW5zOiBydWlucywKCQkiYXJlYTpoaWdod2F5IjogewoJfSwKCQljcmFmdDogY3JhZnQsCgkJZ29sZjogZ29sZiwKCQlpbmRvb3I6IGluZG9vcgoJfTsKCgl2YXIgb3Ntb2JqcyA9ICgoKSA9PiB7CgoJICAgIGNvbnN0IHsgZmlyc3QsIGxhc3QsIGNvb3Jkc1RvS2V5LAoJICAgICAgICBhZGRUb01hcCwgcmVtb3ZlRnJvbU1hcCwgZ2V0Rmlyc3RGcm9tTWFwLAoJICAgICAgICBpc1JpbmcsIHJpbmdEaXJlY3Rpb24sIHB0SW5zaWRlUG9seWdvbiwgc3RyVG9GbG9hdCwKCSAgICAgICAgTGF0ZUJpbmRlciwgV2F5Q29sbGVjdGlvbiB9ID0gdXRpbHMsCgkgICAgICAgIHBvbHlnb25UYWdzID0gcmVxdWlyZSQkMTsKCgkgICAgY2xhc3MgT3NtT2JqZWN0IHsKCSAgICAgICAgY29uc3RydWN0b3IodHlwZSwgaWQsIHJlZkVsZW1zKSB7CgkgICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlOwoJICAgICAgICAgICAgdGhpcy5pZCA9IGlkOwoJICAgICAgICAgICAgdGhpcy5yZWZFbGVtcyA9IHJlZkVsZW1zOwoJICAgICAgICAgICAgdGhpcy50YWdzID0ge307CgkgICAgICAgICAgICB0aGlzLnByb3BzID0geyBpZDogdGhpcy5nZXRDb21wb3NpdGVJZCgpIH07CgkgICAgICAgICAgICB0aGlzLnJlZkNvdW50ID0gMDsKCSAgICAgICAgICAgIHRoaXMuaGFzVGFnID0gZmFsc2U7CgkgICAgICAgICAgICBpZiAocmVmRWxlbXMpIHsKCSAgICAgICAgICAgICAgICByZWZFbGVtcy5hZGQodGhpcy5nZXRDb21wb3NpdGVJZCgpLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgYWRkVGFncyh0YWdzKSB7CgkgICAgICAgICAgICB0aGlzLnRhZ3MgPSBPYmplY3QuYXNzaWduKHRoaXMudGFncywgdGFncyk7CgkgICAgICAgICAgICB0aGlzLmhhc1RhZyA9IHRhZ3MgPyB0cnVlIDogZmFsc2U7CgkgICAgICAgIH0KCgkgICAgICAgIGFkZFRhZyhrLCB2KSB7CgkgICAgICAgICAgICB0aGlzLnRhZ3Nba10gPSB2OwoJICAgICAgICAgICAgdGhpcy5oYXNUYWcgPSBrID8gdHJ1ZSA6IGZhbHNlOwoJICAgICAgICB9CgoJICAgICAgICBhZGRQcm9wKGssIHYpIHsKCSAgICAgICAgICAgIHRoaXMucHJvcHNba10gPSB2OwoJICAgICAgICB9CgoJICAgICAgICBhZGRQcm9wcyhwcm9wcykgewoJICAgICAgICAgICAgdGhpcy5wcm9wcyA9IE9iamVjdC5hc3NpZ24odGhpcy5wcm9wcywgcHJvcHMpOwoJICAgICAgICB9CgoJICAgICAgICBnZXRDb21wb3NpdGVJZCgpIHsKCSAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLnR5cGV9LyR7dGhpcy5pZH1gOwoJICAgICAgICB9CgoJICAgICAgICBnZXRQcm9wcygpIHsKCSAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHRoaXMucHJvcHMsIHRoaXMudGFncyk7CgkgICAgICAgIH0KCgkgICAgICAgIHRvRmVhdHVyZUFycmF5KCkgewoJICAgICAgICAgICAgcmV0dXJuIFtdOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBjbGFzcyBOb2RlIGV4dGVuZHMgT3NtT2JqZWN0IHsKCSAgICAgICAgY29uc3RydWN0b3IoaWQsIHJlZkVsZW1zKSB7CgkgICAgICAgICAgICBzdXBlcignbm9kZScsIGlkLCByZWZFbGVtcyk7CgkgICAgICAgICAgICB0aGlzLmxhdExuZyA9IG51bGw7CgkgICAgICAgIH0KCgkgICAgICAgIHNldExhdExuZyhsYXRMbmcpIHsKCSAgICAgICAgICAgIHRoaXMubGF0TG5nID0gbGF0TG5nOwoJICAgICAgICB9CgoJICAgICAgICB0b0ZlYXR1cmVBcnJheSgpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLmxhdExuZykgewoJICAgICAgICAgICAgICAgIHJldHVybiBbewoJICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLmdldENvbXBvc2l0ZUlkKCksCgkgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHRoaXMuZ2V0UHJvcHMoKSwKCSAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnk6IHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogc3RyVG9GbG9hdChbdGhpcy5sYXRMbmcubG9uLCB0aGlzLmxhdExuZy5sYXRdKQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfV07CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmV0dXJuIFtdOwoJICAgICAgICB9CgoJICAgICAgICBnZXRMYXRMbmcoKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sYXRMbmc7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGNsYXNzIFdheSBleHRlbmRzIE9zbU9iamVjdCB7CgkgICAgICAgIGNvbnN0cnVjdG9yKGlkLCByZWZFbGVtcykgewoJICAgICAgICAgICAgc3VwZXIoJ3dheScsIGlkLCByZWZFbGVtcyk7CgkgICAgICAgICAgICB0aGlzLmxhdExuZ0FycmF5ID0gW107CgkgICAgICAgICAgICB0aGlzLmlzUG9seWdvbiA9IGZhbHNlOwoJICAgICAgICB9CgoJICAgICAgICBhZGRMYXRMbmcobGF0TG5nKSB7CgkgICAgICAgICAgICB0aGlzLmxhdExuZ0FycmF5LnB1c2gobGF0TG5nKTsKCSAgICAgICAgfQoKCSAgICAgICAgc2V0TGF0TG5nQXJyYXkobGF0TG5nQXJyYXkpIHsKCSAgICAgICAgICAgIHRoaXMubGF0TG5nQXJyYXkgPSBsYXRMbmdBcnJheTsKCSAgICAgICAgfQoKCSAgICAgICAgYWRkTm9kZVJlZihyZWYpIHsKCSAgICAgICAgICAgIGxldCBiaW5kZXIgPSBuZXcgTGF0ZUJpbmRlcih0aGlzLmxhdExuZ0FycmF5LCBmdW5jdGlvbiAoaWQpIHsKCSAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IHRoaXMucmVmRWxlbXMuZ2V0KGBub2RlLyR7aWR9YCk7CgkgICAgICAgICAgICAgICAgaWYgKG5vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgbm9kZS5yZWZDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRMYXRMbmcoKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9LCB0aGlzLCBbcmVmXSk7CgoJICAgICAgICAgICAgdGhpcy5sYXRMbmdBcnJheS5wdXNoKGJpbmRlcik7CgkgICAgICAgICAgICB0aGlzLnJlZkVsZW1zLmFkZEJpbmRlcihiaW5kZXIpOwoJICAgICAgICB9CgoJICAgICAgICBhbmFseXplR2VvbWV0cnlUeXBlKGssIHYpIHsKCSAgICAgICAgICAgIGxldCBvID0gcG9seWdvblRhZ3Nba107CgkgICAgICAgICAgICBpZiAobykgewoJICAgICAgICAgICAgICAgIHRoaXMuaXNQb2x5Z29uID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICBpZiAoby53aGl0ZWxpc3QpIHsKCSAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1BvbHlnb24gPSBvLndoaXRlbGlzdC5pbmRleE9mKHYpID49IDAgPyB0cnVlIDogZmFsc2U7CgkgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvLmJsYWNrbGlzdCkgewoJICAgICAgICAgICAgICAgICAgICB0aGlzLmlzUG9seWdvbiA9IG8uYmxhY2tsaXN0LmluZGV4T2YodikgPj0gMCA/IGZhbHNlIDogdHJ1ZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAgIGFkZFRhZ3ModGFncykgewoJICAgICAgICAgICAgc3VwZXIuYWRkVGFncyh0YWdzKTsKCSAgICAgICAgICAgIGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyh0YWdzKSkgewoJICAgICAgICAgICAgICAgIHRoaXMuYW5hbHl6ZUdlb21ldHJ5VHlwZShrLCB2KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgYWRkVGFnKGssIHYpIHsKCSAgICAgICAgICAgIHN1cGVyLmFkZFRhZyhrLCB2KTsKCSAgICAgICAgICAgIHRoaXMuYW5hbHl6ZUdlb21ldHJ5VHlwZShrLCB2KTsKCSAgICAgICAgfQoKCSAgICAgICAgdG9Db29yZHNBcnJheSgpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmxhdExuZ0FycmF5Lm1hcChsYXRMbmcgPT4gW2xhdExuZy5sb24sIGxhdExuZy5sYXRdKTsKCSAgICAgICAgfQoKCSAgICAgICAgdG9GZWF0dXJlQXJyYXkoKSB7CgkgICAgICAgICAgICBsZXQgY29vcmRzQXJyYXkgPSB0aGlzLnRvQ29vcmRzQXJyYXkoKTsKCSAgICAgICAgICAgIGlmIChjb29yZHNBcnJheS5sZW5ndGggPiAxKSB7CgkgICAgICAgICAgICAgICAgY29vcmRzQXJyYXkgPSBzdHJUb0Zsb2F0KGNvb3Jkc0FycmF5KTsKCSAgICAgICAgICAgICAgICBsZXQgZmVhdHVyZSA9IHsKCSAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLAoJICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5nZXRDb21wb3NpdGVJZCgpLAoJICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB0aGlzLmdldFByb3BzKCksCgkgICAgICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTGluZVN0cmluZycsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogY29vcmRzQXJyYXkKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH07CgoJICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUG9seWdvbiAmJiBpc1JpbmcoY29vcmRzQXJyYXkpKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyaW5nRGlyZWN0aW9uKGNvb3Jkc0FycmF5KSAhPT0gJ2NvdW50ZXJjbG9ja3dpc2UnKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZHNBcnJheS5yZXZlcnNlKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIGZlYXR1cmUuZ2VvbWV0cnkgPSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnUG9seWdvbicsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogW2Nvb3Jkc0FycmF5XQoJICAgICAgICAgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtmZWF0dXJlXTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIHJldHVybiBbZmVhdHVyZV07CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmV0dXJuIFtdOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBjbGFzcyBSZWxhdGlvbiBleHRlbmRzIE9zbU9iamVjdCB7CgkgICAgICAgIGNvbnN0cnVjdG9yKGlkLCByZWZFbGVtcykgewoJICAgICAgICAgICAgc3VwZXIoJ3JlbGF0aW9uJywgaWQsIHJlZkVsZW1zKTsKCSAgICAgICAgICAgIHRoaXMucmVsYXRpb25zID0gW107CgkgICAgICAgICAgICB0aGlzLm5vZGVzID0gW107CgkgICAgICAgICAgICB0aGlzLmJvdW5kcyA9IG51bGw7CgkgICAgICAgIH0KCgkgICAgICAgIHNldEJvdW5kcyhib3VuZHMpIHsKCSAgICAgICAgICAgIHRoaXMuYm91bmRzID0gYm91bmRzOwoJICAgICAgICB9CgoJICAgICAgICBhZGRNZW1iZXIobWVtYmVyKSB7CgkgICAgICAgICAgICBzd2l0Y2ggKG1lbWJlci50eXBlKSB7CgkgICAgICAgICAgICAgICAgLy8gc3VwZXIgcmVsYXRpb24sIG5lZWQgdG8gZG8gY29tYmluYXRpb24KCSAgICAgICAgICAgICAgICBjYXNlICdyZWxhdGlvbic6CgkgICAgICAgICAgICAgICAgICAgIGxldCBiaW5kZXIgPSBuZXcgTGF0ZUJpbmRlcih0aGlzLnJlbGF0aW9ucywgZnVuY3Rpb24gKGlkKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVsYXRpb24gPSB0aGlzLnJlZkVsZW1zLmdldChgcmVsYXRpb24vJHtpZH1gKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxhdGlvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uLnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbGF0aW9uOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLCBbbWVtYmVyLnJlZl0pOwoJICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbGF0aW9ucy5wdXNoKGJpbmRlcik7CgkgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRWxlbXMuYWRkQmluZGVyKGJpbmRlcik7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKCSAgICAgICAgICAgICAgICBjYXNlICd3YXknOgoJICAgICAgICAgICAgICAgICAgICBpZiAoIW1lbWJlci5yb2xlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIucm9sZSA9ICcnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGxldCB3YXlzID0gdGhpc1ttZW1iZXIucm9sZV07CgkgICAgICAgICAgICAgICAgICAgIGlmICghd2F5cykgewoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5cyA9IHRoaXNbbWVtYmVyLnJvbGVdID0gW107CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgaWYgKG1lbWJlci5nZW9tZXRyeSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdheSA9IG5ldyBXYXkobWVtYmVyLnJlZiwgdGhpcy5yZWZFbGVtcyk7CgkgICAgICAgICAgICAgICAgICAgICAgICB3YXkuc2V0TGF0TG5nQXJyYXkobWVtYmVyLmdlb21ldHJ5KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdheS5yZWZDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5cy5wdXNoKHdheSk7CgkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVtYmVyLm5vZGVzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBsZXQgd2F5ID0gbmV3IFdheShtZW1iZXIucmVmLCB0aGlzLnJlZkVsZW1zKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG5pZCBvZiBtZW1iZXIubm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXkuYWRkTm9kZVJlZihuaWQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5LnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICB3YXlzLnB1c2god2F5KTsKCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGxldCBiaW5kZXIgPSBuZXcgTGF0ZUJpbmRlcih3YXlzLCBmdW5jdGlvbiAoaWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgd2F5ID0gdGhpcy5yZWZFbGVtcy5nZXQoYHdheS8ke2lkfWApOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3YXkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F5LnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3YXk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcywgW21lbWJlci5yZWZdKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdheXMucHVzaChiaW5kZXIpOwoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZFbGVtcy5hZGRCaW5kZXIoYmluZGVyKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCgkgICAgICAgICAgICAgICAgY2FzZSAnbm9kZSc6CgkgICAgICAgICAgICAgICAgICAgIGxldCBub2RlID0gbnVsbDsKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1lbWJlci5sYXQgJiYgbWVtYmVyLmxvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5ldyBOb2RlKG1lbWJlci5yZWYsIHRoaXMucmVmRWxlbXMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRMYXRMbmcoeyBsb246IG1lbWJlci5sb24sIGxhdDogbWVtYmVyLmxhdCB9KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZW1iZXIudGFncykgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYWRkVGFncyhtZW1iZXIudGFncyk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMobWVtYmVyKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChbJ2lkJywgJ3R5cGUnLCAnbGF0JywgJ2xvbiddLmluZGV4T2YoaykgPCAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYWRkUHJvcChrLCB2KTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5yZWZDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2Rlcy5wdXNoKG5vZGUpOwoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJpbmRlciA9IG5ldyBMYXRlQmluZGVyKHRoaXMubm9kZXMsIGZ1bmN0aW9uIChpZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBub2RlID0gdGhpcy5yZWZFbGVtcy5nZXQoYG5vZGUvJHtpZH1gKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMsIFttZW1iZXIucmVmXSk7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGVzLnB1c2goYmluZGVyKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRWxlbXMuYWRkQmluZGVyKGJpbmRlcik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAgIHRvRmVhdHVyZUFycmF5KCkgewoJICAgICAgICAgICAgY29uc3QgY29uc3RydWN0U3RyaW5nR2VvbWV0cnkgPSAod3MpID0+IHsKCSAgICAgICAgICAgICAgICBsZXQgc3RyaW5ncyA9IHdzID8gd3MudG9TdHJpbmdzKCkgOiBbXTsKCSAgICAgICAgICAgICAgICBpZiAoc3RyaW5ncy5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChzdHJpbmdzLmxlbmd0aCA9PT0gMSkgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJywKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBzdHJpbmdzWzBdCgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTXVsdGlMaW5lU3RyaW5nJywKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBzdHJpbmdzCgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgIGNvbnN0IGNvbnN0cnVjdFBvbHlnb25HZW9tZXRyeSA9IChvd3MsIGl3cykgPT4gewoJICAgICAgICAgICAgICAgIGxldCBvdXRlclJpbmdzID0gb3dzID8gb3dzLnRvUmluZ3MoJ2NvdW50ZXJjbG9ja3dpc2UnKSA6IFtdLAoJICAgICAgICAgICAgICAgICAgICBpbm5lclJpbmdzID0gaXdzID8gaXdzLnRvUmluZ3MoJ2Nsb2Nrd2lzZScpIDogW107CgoJICAgICAgICAgICAgICAgIGlmIChvdXRlclJpbmdzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICAgICAgbGV0IGNvbXBvc2l0UG9seW9ucyA9IFtdOwoKCSAgICAgICAgICAgICAgICAgICAgbGV0IHJpbmcgPSBudWxsOwoJICAgICAgICAgICAgICAgICAgICBmb3IgKHJpbmcgb2Ygb3V0ZXJSaW5ncykKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0UG9seW9ucy5wdXNoKFtyaW5nXSk7CgoJICAgICAgICAgICAgICAgICAgICAvLyBsaW5rIGlubmVyIHBvbHlnb25zIHRvIG91dGVyIGNvbnRhaW5lcnMKCSAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHJpbmcgPSBpbm5lclJpbmdzLnNoaWZ0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGlkeCBpbiBvdXRlclJpbmdzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHB0SW5zaWRlUG9seWdvbihmaXJzdChyaW5nKSwgb3V0ZXJSaW5nc1tpZHhdKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb3NpdFBvbHlvbnNbaWR4XS5wdXNoKHJpbmcpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIC8vIGNvbnN0cnVjdCB0aGUgUG9seWdvbi9NdWx0aVBvbHlnb24gZ2VvbWV0cnkKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvc2l0UG9seW9ucy5sZW5ndGggPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BvbHlnb24nLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBjb21wb3NpdFBvbHlvbnNbMF0KCSAgICAgICAgICAgICAgICAgICAgICAgIH07CgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTXVsdGlQb2x5Z29uJywKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBjb21wb3NpdFBvbHlvbnMKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgIGxldCBwb2x5Z29uRmVhdHVyZXMgPSBbXSwgc3RyaW5nRmVhdHVyZXMgPSBbXSwgcG9pbnRGZWF0dXJlcyA9IFtdOwoJICAgICAgICAgICAgY29uc3Qgd2F5c0ZpZWxkTmFtZXMgPSBbJ291dGVyJywgJ2lubmVyJywgJyddOwoJICAgICAgICAgICAgLy8gbmVlZCB0byBkbyBjb21iaW5hdGlvbiB3aGVuIHRoZXJlJ3JlIG5lc3RlZCByZWxhdGlvbnMKCSAgICAgICAgICAgIGZvciAobGV0IHJlbGF0aW9uIG9mIHRoaXMucmVsYXRpb25zKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlbGF0aW9uKSB7CgkgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGZpZWxkTmFtZSBvZiB3YXlzRmllbGROYW1lcykgewoJICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdheXMgPSByZWxhdGlvbltmaWVsZE5hbWVdOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdheXMpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGhpc1dheXMgPSB0aGlzW2ZpZWxkTmFtZV07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNXYXlzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtdLnNwbGljZS5hcHBseSh0aGlzV2F5cywgW3RoaXNXYXlzLmxlbmd0aCwgMF0uY29uY2F0KHdheXMpKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2ZpZWxkTmFtZV0gPSB3YXlzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICBmb3IgKGxldCBmaWVsZE5hbWUgb2Ygd2F5c0ZpZWxkTmFtZXMpIHsKCSAgICAgICAgICAgICAgICBsZXQgd2F5cyA9IHRoaXNbZmllbGROYW1lXTsKCSAgICAgICAgICAgICAgICBpZiAod2F5cykgewoJICAgICAgICAgICAgICAgICAgICB0aGlzW2ZpZWxkTmFtZV0gPSBuZXcgV2F5Q29sbGVjdGlvbigpOwoJICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB3YXkgb2Ygd2F5cykgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tmaWVsZE5hbWVdLmFkZFdheSh3YXkpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIGxldCBnZW9tZXRyeSA9IG51bGw7CgoJICAgICAgICAgICAgbGV0IGZlYXR1cmUgPSB7CgkgICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLAoJICAgICAgICAgICAgICAgIGlkOiB0aGlzLmdldENvbXBvc2l0ZUlkKCksCgkgICAgICAgICAgICAgICAgYmJveDogdGhpcy5ib3VuZHMsCgkgICAgICAgICAgICAgICAgcHJvcGVydGllczogdGhpcy5nZXRQcm9wcygpCgkgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgIGlmICghdGhpcy5ib3VuZHMpIHsKCSAgICAgICAgICAgICAgICBkZWxldGUgZmVhdHVyZS5iYm94OwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIGlmICh0aGlzLm91dGVyKSB7CgkgICAgICAgICAgICAgICAgZ2VvbWV0cnkgPSBjb25zdHJ1Y3RQb2x5Z29uR2VvbWV0cnkodGhpcy5vdXRlciwgdGhpcy5pbm5lcik7CgkgICAgICAgICAgICAgICAgaWYgKGdlb21ldHJ5KSB7CgkgICAgICAgICAgICAgICAgICAgIGZlYXR1cmUuZ2VvbWV0cnkgPSBnZW9tZXRyeTsKCSAgICAgICAgICAgICAgICAgICAgcG9seWdvbkZlYXR1cmVzLnB1c2goZmVhdHVyZSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAodGhpc1snJ10pIHsKCSAgICAgICAgICAgICAgICBnZW9tZXRyeSA9IGNvbnN0cnVjdFN0cmluZ0dlb21ldHJ5KHRoaXNbJyddKTsKCSAgICAgICAgICAgICAgICBpZiAoZ2VvbWV0cnkpIHsKCSAgICAgICAgICAgICAgICAgICAgZmVhdHVyZS5nZW9tZXRyeSA9IGdlb21ldHJ5OwoJICAgICAgICAgICAgICAgICAgICBzdHJpbmdGZWF0dXJlcy5wdXNoKGZlYXR1cmUpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICBmb3IgKGxldCBub2RlIG9mIHRoaXMubm9kZXMpIHsKCSAgICAgICAgICAgICAgICBwb2ludEZlYXR1cmVzID0gcG9pbnRGZWF0dXJlcy5jb25jYXQobm9kZS50b0ZlYXR1cmVBcnJheSgpKTsKCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICByZXR1cm4gcG9seWdvbkZlYXR1cmVzLmNvbmNhdChzdHJpbmdGZWF0dXJlcykuY29uY2F0KHBvaW50RmVhdHVyZXMpOwoJICAgICAgICB9CgkgICAgfQoKCSAgICByZXR1cm4geyBOb2RlLCBXYXksIFJlbGF0aW9uIH07Cgl9KSgpOwoKCXZhciB4bWxwYXJzZXIgPSAoKCkgPT4gewoKCSAgICBmdW5jdGlvbiBjb25kaXRpb25lZChldnQpIHsKCSAgICAgICAgcmV0dXJuIGV2dC5tYXRjaCgvXiguKz8pXFsoLis/KVxdPiQvZykgIT0gbnVsbDsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIHBhcnNlRXZlbnQoZXZ0KSB7CgkgICAgICAgIGxldCBtYXRjaCA9IC9eKC4rPylcWyguKz8pXF0+JC9nLmV4ZWMoZXZ0KTsKCSAgICAgICAgaWYgKG1hdGNoKSB7CgkgICAgICAgICAgICByZXR1cm4geyBldnQ6IG1hdGNoWzFdICsgJz4nLCBleHA6IG1hdGNoWzJdIH07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHsgZXZ0OiBldnQgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGdlbkNvbmRpdGlvbkZ1bmMoY29uZCkgewoJICAgICAgICBsZXQgYm9keSA9ICdyZXR1cm4gJyArIGNvbmQucmVwbGFjZSgvKFwkLis/KSg/PVs9IS5dKS9nLCAnbm9kZS4kJicpICsgJzsnOwoJICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCdub2RlJywgYm9keSk7CgkgICAgfQoKCSAgICByZXR1cm4gY2xhc3MgewoJICAgICAgICBjb25zdHJ1Y3RvcihvcHRzKSB7CgkgICAgICAgICAgICBpZiAob3B0cykgewoJICAgICAgICAgICAgICAgIHRoaXMucXVlcnlQYXJlbnQgPSBvcHRzLnF1ZXJ5UGFyZW50ID8gdHJ1ZSA6IGZhbHNlOwoJICAgICAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NpdmUgPSBvcHRzLnByb2dyZXNzaXZlOwoJICAgICAgICAgICAgICAgIGlmICh0aGlzLnF1ZXJ5UGFyZW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50TWFwID0gbmV3IFdlYWtNYXAoKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aGlzLmV2dExpc3RlbmVycyA9IHt9OwoJICAgICAgICB9CgoJICAgICAgICBwYXJzZSh4bWwsIHBhcmVudCwgZGlyKSB7CgkgICAgICAgICAgICBkaXIgPSBkaXIgPyBkaXIgKyAnLicgOiAnJzsKCSAgICAgICAgICAgIGxldCBub2RlUmVnRXggPSAvPChbXiA+XC9dKykoLio/KT4vbWcsIG5vZGVNYXRjaCA9IG51bGwsIG5vZGVzID0gW107CgkgICAgICAgICAgICB3aGlsZSAobm9kZU1hdGNoID0gbm9kZVJlZ0V4LmV4ZWMoeG1sKSkgewoJICAgICAgICAgICAgICAgIGxldCB0YWcgPSBub2RlTWF0Y2hbMV0sIG5vZGUgPSB7ICR0YWc6IHRhZyB9LCBmdWxsVGFnID0gZGlyICsgdGFnOwoKCSAgICAgICAgICAgICAgICBsZXQgYXR0clRleHQgPSBub2RlTWF0Y2hbMl0udHJpbSgpLCBjbG9zZWQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICBpZiAoYXR0clRleHQuZW5kc1dpdGgoJy8nKSB8fCB0YWcuc3RhcnRzV2l0aCgnPycpIHx8IHRhZy5zdGFydHNXaXRoKCchJykpIHsKCSAgICAgICAgICAgICAgICAgICAgY2xvc2VkID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIGxldCBhdHRSZWdFeDEgPSAvKFteIF0rPyk9IiguKz8pIi9nLCBhdHRSZWdFeDIgPSAvKFteIF0rPyk9JyguKz8pJy9nOwoJICAgICAgICAgICAgICAgIGxldCBhdHRNYXRjaCA9IG51bGwsIGhhc0F0dHJzID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgd2hpbGUgKGF0dE1hdGNoID0gYXR0UmVnRXgxLmV4ZWMoYXR0clRleHQpKSB7CgkgICAgICAgICAgICAgICAgICAgIGhhc0F0dHJzID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgbm9kZVthdHRNYXRjaFsxXV0gPSBhdHRNYXRjaFsyXTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFoYXNBdHRycykKCSAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGF0dE1hdGNoID0gYXR0UmVnRXgyLmV4ZWMoYXR0clRleHQpKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBoYXNBdHRycyA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICBub2RlW2F0dE1hdGNoWzFdXSA9IGF0dE1hdGNoWzJdOwoJICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIGlmICghaGFzQXR0cnMgJiYgYXR0clRleHQgIT09ICcnKSB7CgkgICAgICAgICAgICAgICAgICAgIG5vZGUudGV4dCA9IGF0dHJUZXh0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9ncmVzc2l2ZSkgewoJICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoYDwke2Z1bGxUYWd9PmAsIG5vZGUsIHBhcmVudCk7CgkgICAgICAgICAgICAgICAgfQoKCSAgICAgICAgICAgICAgICBpZiAoIWNsb3NlZCkgewoJICAgICAgICAgICAgICAgICAgICBsZXQgaW5uZXJSZWdFeCA9IG5ldyBSZWdFeHAoYChbXl0rPyk8XC8ke3RhZ30+YCwgJ2cnKTsKCSAgICAgICAgICAgICAgICAgICAgaW5uZXJSZWdFeC5sYXN0SW5kZXggPSBub2RlUmVnRXgubGFzdEluZGV4OwoJICAgICAgICAgICAgICAgICAgICBsZXQgaW5uZXJNYXRjaCA9IGlubmVyUmVnRXguZXhlYyh4bWwpOwoJICAgICAgICAgICAgICAgICAgICBpZiAoaW5uZXJNYXRjaCAmJiBpbm5lck1hdGNoWzFdKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBub2RlUmVnRXgubGFzdEluZGV4ID0gaW5uZXJSZWdFeC5sYXN0SW5kZXg7CgkgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5uZXJOb2RlcyA9IHRoaXMucGFyc2UoaW5uZXJNYXRjaFsxXSwgbm9kZSwgZnVsbFRhZyk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5uZXJOb2Rlcy5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS4kaW5uZXJOb2RlcyA9IGlubmVyTm9kZXM7CgkgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuJGlubmVyVGV4dCA9IGlubmVyTWF0Y2hbMV07CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlcnlQYXJlbnQgJiYgcGFyZW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50TWFwLnNldChub2RlLCBwYXJlbnQpOwoJICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NpdmUpIHsKCSAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KGA8LyR7ZnVsbFRhZ30+YCwgbm9kZSwgcGFyZW50KTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobm9kZSk7CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmV0dXJuIG5vZGVzOwoJICAgICAgICB9CgoJICAgICAgICBnZXRQYXJlbnQobm9kZSkgewoJICAgICAgICAgICAgaWYgKHRoaXMucXVlcnlQYXJlbnQpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnRNYXAuZ2V0KG5vZGUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCgkgICAgICAgICNhZGRMaXN0ZW5lcihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIGxldCBmdW5jcyA9IHRoaXMuZXZ0TGlzdGVuZXJzW2V2dF07CgkgICAgICAgICAgICBpZiAoZnVuY3MpIHsKCSAgICAgICAgICAgICAgICBmdW5jcy5wdXNoKGZ1bmMpOwoJICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmV2dExpc3RlbmVyc1tldnRdID0gW2Z1bmNdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICAvLyBzdXBwb3J0IGphdmFzY3JpcHQgY29uZGl0aW9uIGZvciB0aGUgbGFzdCB0YWcKCSAgICAgICAgYWRkTGlzdGVuZXIoZXZ0LCBmdW5jKSB7CgkgICAgICAgICAgICBpZiAoY29uZGl0aW9uZWQoZXZ0KSkgewoJICAgICAgICAgICAgICAgIC8vIGZ1bmMucHJvdG90eXBlID0gZXZ0OwoJICAgICAgICAgICAgICAgIGV2dCA9IHBhcnNlRXZlbnQoZXZ0KTsKCSAgICAgICAgICAgICAgICBmdW5jLmNvbmRpdGlvbiA9IGdlbkNvbmRpdGlvbkZ1bmMoZXZ0LmV4cCk7CgkgICAgICAgICAgICAgICAgZXZ0ID0gZXZ0LmV2dDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHRoaXMuI2FkZExpc3RlbmVyKGV2dCwgZnVuYyk7CgkgICAgICAgIH0KCgkgICAgICAgICNyZW1vdmVMaXN0ZW5lcihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIGxldCBmdW5jcyA9IHRoaXMuZXZ0TGlzdGVuZXJzW2V2dF07CgkgICAgICAgICAgICBsZXQgaWR4ID0gbnVsbDsKCSAgICAgICAgICAgIGlmIChmdW5jcyAmJiAoaWR4ID0gZnVuY3MuaW5kZXhPZihmdW5jKSkgPj0gMCkgewoJICAgICAgICAgICAgICAgIGZ1bmNzLnNwbGljZShpZHgsIDEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICByZW1vdmVMaXN0ZW5lcihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIGlmIChjb25kaXRpb25lZChldnQpKSB7CgkgICAgICAgICAgICAgICAgZXZ0ID0gcGFyc2VFdmVudChldnQpOwoJICAgICAgICAgICAgICAgIGV2dCA9IGV2dC5ldnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aGlzLiNyZW1vdmVMaXN0ZW5lcihldnQsIGZ1bmMpOwoJICAgICAgICB9CgoJICAgICAgICBlbWl0KGV2dCwgLi4uYXJncykgewoJICAgICAgICAgICAgbGV0IGZ1bmNzID0gdGhpcy5ldnRMaXN0ZW5lcnNbZXZ0XTsKCSAgICAgICAgICAgIGlmIChmdW5jcykgewoJICAgICAgICAgICAgICAgIGZvciAobGV0IGZ1bmMgb2YgZnVuY3MpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bmMuY29uZGl0aW9uKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuYy5jb25kaXRpb24uYXBwbHkobnVsbCwgYXJncykgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jLmFwcGx5KG51bGwsIGFyZ3MpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseShudWxsLCBhcmdzKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgb24oZXZ0LCBmdW5jKSB7CgkgICAgICAgICAgICB0aGlzLmFkZExpc3RlbmVyKGV2dCwgZnVuYyk7CgkgICAgICAgIH0KCgkgICAgICAgIG9mZihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoZXZ0LCBmdW5jKTsKCSAgICAgICAgfQoJICAgIH07Cgl9KSgpOwoKCWNvbnN0IHsgTm9kZSwgV2F5LCBSZWxhdGlvbiB9ID0gb3Ntb2JqcywKCSAgICB7IHB1cmdlUHJvcHMsIFJlZkVsZW1lbnRzIH0gPSB1dGlscywKCSAgICBYbWxQYXJzZXIgPSB4bWxwYXJzZXI7CgoJdmFyIGxpYiA9IChvc20sIG9wdHMpID0+IHsKCSAgICBsZXQgY29tcGxldGVGZWF0dXJlID0gZmFsc2UsIHJlbmRlclRhZ2dlZCA9IGZhbHNlLCBleGNsdWRlV2F5ID0gdHJ1ZTsKCgkgICAgY29uc3QgcGFyc2VPcHRzID0gb3B0cyA9PiB7CgkgICAgICAgIGlmIChvcHRzKSB7CgkgICAgICAgICAgICBjb21wbGV0ZUZlYXR1cmUgPSBvcHRzLmNvbXBsZXRlRmVhdHVyZSB8fCBvcHRzLmFsbEZlYXR1cmVzID8gdHJ1ZSA6IGZhbHNlOwoJICAgICAgICAgICAgcmVuZGVyVGFnZ2VkID0gb3B0cy5yZW5kZXJUYWdnZWQgPyB0cnVlIDogZmFsc2U7CgkgICAgICAgICAgICBsZXQgd2F5T3B0ID0gb3B0cy5zdXBwcmVzc1dheSB8fCBvcHRzLmV4Y2x1ZGVXYXk7CgkgICAgICAgICAgICBpZiAod2F5T3B0ICE9PSB1bmRlZmluZWQgJiYgIXdheU9wdCkgewoJICAgICAgICAgICAgICAgIGV4Y2x1ZGVXYXkgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgoJICAgIHBhcnNlT3B0cyhvcHRzKTsKCgkgICAgY29uc3QgZGV0ZWN0Rm9ybWF0ID0gb3NtID0+IHsKCSAgICAgICAgaWYgKG9zbS5lbGVtZW50cykgewoJICAgICAgICAgICAgcmV0dXJuICdqc29uJzsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3NtLmluZGV4T2YoJzxvc20nKSA+PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gJ3htbCc7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG9zbS50cmltKCkuc3RhcnRzV2l0aCgneycpKSB7CgkgICAgICAgICAgICByZXR1cm4gJ2pzb24tcmF3JzsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gJ2ludmFsaWQnOwoJICAgIH07CgoJICAgIGxldCBmb3JtYXQgPSBkZXRlY3RGb3JtYXQob3NtKTsKCgkgICAgbGV0IHJlZkVsZW1lbnRzID0gbmV3IFJlZkVsZW1lbnRzKCksIGZlYXR1cmVBcnJheSA9IFtdOwoKCSAgICBjb25zdCBhbmFseXplRmVhdHVyZXNGcm9tSnNvbiA9IG9zbSA9PiB7CgkgICAgICAgIGZvciAobGV0IGVsZW0gb2Ygb3NtLmVsZW1lbnRzKSB7CgkgICAgICAgICAgICBzd2l0Y2ggKGVsZW0udHlwZSkgewoJICAgICAgICAgICAgICAgIGNhc2UgJ25vZGUnOgoJICAgICAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IG5ldyBOb2RlKGVsZW0uaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0udGFncykgewoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5hZGRUYWdzKGVsZW0udGFncyk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgbm9kZS5hZGRQcm9wcyhwdXJnZVByb3BzKGVsZW0sIFsnaWQnLCAndHlwZScsICd0YWdzJywgJ2xhdCcsICdsb24nXSkpOwoJICAgICAgICAgICAgICAgICAgICBub2RlLnNldExhdExuZyhlbGVtKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgoJICAgICAgICAgICAgICAgIGNhc2UgJ3dheSc6CgkgICAgICAgICAgICAgICAgICAgIGxldCB3YXkgPSBuZXcgV2F5KGVsZW0uaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0udGFncykgewoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZFRhZ3MoZWxlbS50YWdzKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB3YXkuYWRkUHJvcHMocHVyZ2VQcm9wcyhlbGVtLCBbJ2lkJywgJ3R5cGUnLCAndGFncycsICdub2RlcycsICdnZW9tZXRyeSddKSk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLm5vZGVzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBuIG9mIGVsZW0ubm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXkuYWRkTm9kZVJlZihuKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtLmdlb21ldHJ5KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB3YXkuc2V0TGF0TG5nQXJyYXkoZWxlbS5nZW9tZXRyeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgoJICAgICAgICAgICAgICAgIGNhc2UgJ3JlbGF0aW9uJzoKCSAgICAgICAgICAgICAgICAgICAgbGV0IHJlbGF0aW9uID0gbmV3IFJlbGF0aW9uKGVsZW0uaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0uYm91bmRzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGlvbi5zZXRCb3VuZHMoW3BhcnNlRmxvYXQoZWxlbS5ib3VuZHMubWlubG9uKSwgcGFyc2VGbG9hdChlbGVtLmJvdW5kcy5taW5sYXQpLCBwYXJzZUZsb2F0KGVsZW0uYm91bmRzLm1heGxvbiksIHBhcnNlRmxvYXQoZWxlbS5ib3VuZHMubWF4bGF0KV0pOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLnRhZ3MpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uLmFkZFRhZ3MoZWxlbS50YWdzKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByZWxhdGlvbi5hZGRQcm9wcyhwdXJnZVByb3BzKGVsZW0sIFsnaWQnLCAndHlwZScsICd0YWdzJywgJ2JvdW5kcycsICdtZW1iZXJzJ10pKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0ubWVtYmVycykgewoJICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgbWVtYmVyIG9mIGVsZW0ubWVtYmVycykgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uLmFkZE1lbWJlcihtZW1iZXIpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCgkgICAgY29uc3QgYW5hbHl6ZUZlYXR1cmVzRnJvbVhtbCA9IG9zbSA9PiB7CgkgICAgICAgIGNvbnN0IHhtbFBhcnNlciA9IG5ldyBYbWxQYXJzZXIoeyBwcm9ncmVzc2l2ZTogdHJ1ZSB9KTsKCgkgICAgICAgIHhtbFBhcnNlci5vbignPC9vc20ubm9kZT4nLCBub2RlID0+IHsKCSAgICAgICAgICAgIGxldCBuZCA9IG5ldyBOb2RlKG5vZGUuaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgIGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhub2RlKSkKCSAgICAgICAgICAgICAgICBpZiAoIWsuc3RhcnRzV2l0aCgnJCcpICYmIFsnaWQnLCAnbG9uJywgJ2xhdCddLmluZGV4T2YoaykgPCAwKSB7CgkgICAgICAgICAgICAgICAgICAgIG5kLmFkZFByb3Aoaywgdik7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmQuc2V0TGF0TG5nKG5vZGUpOwoJICAgICAgICAgICAgaWYgKG5vZGUuJGlubmVyTm9kZXMpIHsKCSAgICAgICAgICAgICAgICBmb3IgKGxldCBpbmQgb2Ygbm9kZS4kaW5uZXJOb2RlcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW5kLiR0YWcgPT09ICd0YWcnKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBuZC5hZGRUYWcoaW5kLmssIGluZC52KTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfSk7CgoJICAgICAgICB4bWxQYXJzZXIub24oJzwvb3NtLndheT4nLCBub2RlID0+IHsKCSAgICAgICAgICAgIGxldCB3YXkgPSBuZXcgV2F5KG5vZGUuaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgIGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhub2RlKSkgewoJICAgICAgICAgICAgICAgIGlmICghay5zdGFydHNXaXRoKCckJykgJiYgWydpZCddLmluZGV4T2YoaykgPCAwKSB7CgkgICAgICAgICAgICAgICAgICAgIHdheS5hZGRQcm9wKGssIHYpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChub2RlLiRpbm5lck5vZGVzKSB7CgkgICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kIG9mIG5vZGUuJGlubmVyTm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGluZC4kdGFnID09PSAnbmQnKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kLmxvbiAmJiBpbmQubGF0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZExhdExuZyhpbmQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmQucmVmKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZE5vZGVSZWYoaW5kLnJlZik7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kLiR0YWcgPT09ICd0YWcnKQoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZFRhZyhpbmQuaywgaW5kLnYpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfSk7CgoJICAgICAgICB4bWxQYXJzZXIub24oJzxvc20ucmVsYXRpb24+Jywgbm9kZSA9PiB7CgkgICAgICAgICAgICBuZXcgUmVsYXRpb24obm9kZS5pZCwgcmVmRWxlbWVudHMpOwoJICAgICAgICB9KTsKCgkgICAgICAgIHhtbFBhcnNlci5vbignPC9vc20ucmVsYXRpb24ubWVtYmVyPicsIChub2RlLCBwYXJlbnQpID0+IHsKCSAgICAgICAgICAgIGxldCByZWxhdGlvbiA9IHJlZkVsZW1lbnRzLmdldChgcmVsYXRpb24vJHtwYXJlbnQuaWR9YCk7CgkgICAgICAgICAgICBsZXQgbWVtYmVyID0gewoJICAgICAgICAgICAgICAgIHR5cGU6IG5vZGUudHlwZSwKCSAgICAgICAgICAgICAgICByb2xlOiBub2RlLnJvbGUgPyBub2RlLnJvbGUgOiAnJywKCSAgICAgICAgICAgICAgICByZWY6IG5vZGUucmVmCgkgICAgICAgICAgICB9OwoJICAgICAgICAgICAgaWYgKG5vZGUubGF0ICYmIG5vZGUubG9uKSB7CgkgICAgICAgICAgICAgICAgbWVtYmVyLmxhdCA9IG5vZGUubGF0LCBtZW1iZXIubG9uID0gbm9kZS5sb24sIG1lbWJlci50YWdzID0ge307CgkgICAgICAgICAgICAgICAgZm9yIChsZXQgW2ssIHZdIG9mIE9iamVjdC5lbnRyaWVzKG5vZGUpKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICghay5zdGFydHNXaXRoKCckJykgJiYgWyd0eXBlJywgJ2xhdCcsICdsb24nXS5pbmRleE9mKGspIDwgMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyW2tdID0gdjsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChub2RlLiRpbm5lck5vZGVzKSB7CgkgICAgICAgICAgICAgICAgbGV0IGdlb21ldHJ5ID0gW107CgkgICAgICAgICAgICAgICAgbGV0IG5vZGVzID0gW107CgkgICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kIG9mIG5vZGUuJGlubmVyTm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGluZC5sYXQgJiYgaW5kLmxvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnkucHVzaChpbmQpOwoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChpbmQucmVmKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpZiAoZ2VvbWV0cnkubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICBtZW1iZXIuZ2VvbWV0cnkgPSBnZW9tZXRyeTsKCSAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGVzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICAgICAgbWVtYmVyLm5vZGVzID0gbm9kZXM7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVsYXRpb24uYWRkTWVtYmVyKG1lbWJlcik7CgkgICAgICAgIH0pOwoKCSAgICAgICAgeG1sUGFyc2VyLm9uKCc8L29zbS5yZWxhdGlvbi5ib3VuZHM+JywgKG5vZGUsIHBhcmVudCkgPT4gewoJICAgICAgICAgICAgcmVmRWxlbWVudHMuZ2V0KGByZWxhdGlvbi8ke3BhcmVudC5pZH1gKS5zZXRCb3VuZHMoW3BhcnNlRmxvYXQobm9kZS5taW5sb24pLCBwYXJzZUZsb2F0KG5vZGUubWlubGF0KSwgcGFyc2VGbG9hdChub2RlLm1heGxvbiksIHBhcnNlRmxvYXQobm9kZS5tYXhsYXQpXSk7CgkgICAgICAgIH0pOwoKCSAgICAgICAgeG1sUGFyc2VyLm9uKCc8L29zbS5yZWxhdGlvbi50YWc+JywgKG5vZGUsIHBhcmVudCkgPT4gewoJICAgICAgICAgICAgcmVmRWxlbWVudHMuZ2V0KGByZWxhdGlvbi8ke3BhcmVudC5pZH1gKS5hZGRUYWcobm9kZS5rLCBub2RlLnYpOwoJICAgICAgICB9KTsKCgkgICAgICAgIHhtbFBhcnNlci5wYXJzZShvc20pOwoJICAgIH07CgoJICAgIGlmIChmb3JtYXQgPT09ICdqc29uLXJhdycpIHsKCSAgICAgICAgb3NtID0gSlNPTi5wYXJzZShvc20pOwoJICAgICAgICBpZiAob3NtLmVsZW1lbnRzKSB7CgkgICAgICAgICAgICBmb3JtYXQgPSAnanNvbic7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBmb3JtYXQgPSAnaW52YWxpZCc7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykgewoJICAgICAgICBhbmFseXplRmVhdHVyZXNGcm9tSnNvbihvc20pOwoJICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAneG1sJykgewoJICAgICAgICBhbmFseXplRmVhdHVyZXNGcm9tWG1sKG9zbSk7CgkgICAgfQoKCSAgICByZWZFbGVtZW50cy5iaW5kQWxsKCk7CgoJICAgIGZvciAobGV0IHYgb2YgcmVmRWxlbWVudHMudmFsdWVzKCkpIHsKCSAgICAgICAgaWYgKHYucmVmQ291bnQgPD0gMCB8fCAodi5oYXNUYWcgJiYgcmVuZGVyVGFnZ2VkICYmICEodiBpbnN0YW5jZW9mIFdheSAmJiBleGNsdWRlV2F5KSkpIHsKCSAgICAgICAgICAgIGxldCBmZWF0dXJlcyA9IHYudG9GZWF0dXJlQXJyYXkoKTsKCSAgICAgICAgICAgIC8vIHJldHVybiB0aGUgZmlyc3QgZ2VvbWV0cnkgb2YgdGhlIGZpcnN0IHJlbGF0aW9uIGVsZW1lbnQKCSAgICAgICAgICAgIGlmICh2IGluc3RhbmNlb2YgUmVsYXRpb24gJiYgIWNvbXBsZXRlRmVhdHVyZSAmJiBmZWF0dXJlcy5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZlYXR1cmVzWzBdLmdlb21ldHJ5OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmVhdHVyZUFycmF5ID0gZmVhdHVyZUFycmF5LmNvbmNhdChmZWF0dXJlcyk7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIHJldHVybiB7IHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsIGZlYXR1cmVzOiBmZWF0dXJlQXJyYXkgfTsKCX07CgoJdmFyIG9zbTJnZW9qc29uID0gLypAX19QVVJFX18qL2dldERlZmF1bHRFeHBvcnRGcm9tQ2pzKGxpYik7CgoJY2xhc3MgQ29udmVydGVyIHsKCSAgICBjb25zdHJ1Y3Rvcihmb3JtYXQsIGRhdGEsIG9wdGlvbnMgPSB7fSkgewoJICAgICAgICAvKioKCSAgICAgICAgICogQ3JlYXRlcyBhIGJsYW5rIEdlb0pTT04gZmVhdHVyZSBjb2xsZWN0aW9uLgoJICAgICAgICAgKiBAcmV0dXJucyBBIG5ldyBHZW9KU09OIGZlYXR1cmUgY29sbGVjdGlvbiB3aXRoIG5vIGZlYXR1cmVzLgoJICAgICAgICAgKi8KCSAgICAgICAgdGhpcy5ibGFua0dlb0pTT04gPSAoKSA9PiAoewoJICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywKCSAgICAgICAgICAgIGZlYXR1cmVzOiBbXSwKCSAgICAgICAgfSk7CgkgICAgICAgIHRoaXMuX3Jhd0RhdGEgPSBkYXRhOwoJICAgICAgICB0aGlzLl9mb3JtYXQgPSBmb3JtYXQ7CgkgICAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zOwoJICAgICAgICBjb25zdCBjb252ZXJ0ZXJzID0gewoJICAgICAgICAgICAgJ3RvcG9qc29uJzogdGhpcy5sb2FkVG9wb0pzb24sCgkgICAgICAgICAgICAnb3NtJzogdGhpcy5sb2FkT3NtLAoJICAgICAgICAgICAgJ2ttbCc6IHRoaXMubG9hZFhtbCwKCSAgICAgICAgICAgICdncHgnOiB0aGlzLmxvYWRYbWwsCgkgICAgICAgICAgICAndGN4JzogdGhpcy5sb2FkWG1sLAoJICAgICAgICAgICAgJ2Nzdic6IHRoaXMubG9hZENzdiwKCSAgICAgICAgICAgICd0c3YnOiB0aGlzLmxvYWRDc3YsCgkgICAgICAgICAgICAncG9seWxpbmUnOiB0aGlzLmxvYWRQb2x5bGluZQoJICAgICAgICB9OwoJICAgICAgICB0aGlzLl9jb252ZXJzaW9uRm4gPSBjb252ZXJ0ZXJzW2Zvcm1hdF07CgkgICAgfQoJICAgIGFzeW5jIGNvbnZlcnQoKSB7CgkgICAgICAgIGlmICghdGhpcy5fY29udmVyc2lvbkZuKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKF8sIHJlaikgPT4gcmVqKGBObyBjb252ZXJ0ZXIgZXhpc3RzIGZvciAke3RoaXMuX2Zvcm1hdH1gKSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVyc2lvbkZuKCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogTG9hZCB0aGUgWE1MIGRhdGEgYXMgR2VvSlNPTgoJICAgICAqIEByZXR1cm5zIEEgcHJvbWlzZSByZXNvbHZpbmcgdG8gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZFhtbCgpIHsKCSAgICAgICAgLy8gVXNlIHRoZSBhcHByb3ByaWF0ZSBwYXJzZXIgYmFzZWQgb24gdGhlIGZvcm1hdAoJICAgICAgICBjb25zdCBnZW9qc29uID0gdG9HZW9Kc29uW3RoaXMuX2Zvcm1hdF0obmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh0aGlzLl9yYXdEYXRhLCAidGV4dC94bWwiKSk7CgkgICAgICAgIHJldHVybiBnZW9qc29uOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBMb2FkcyBhbmQgcGFyc2VzIENTViBkYXRhIGludG8gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uLgoJICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZENzdigpIHsKCSAgICAgICAgLy8gRGVmaW5lIG9wdGlvbnMgZm9yIHRoZSBjc3YyZ2VvanNvbiBsaWJyYXJ5CgkgICAgICAgIGxldCBvcHRpb25zID0gdGhpcy5fb3B0aW9ucy5jc3ZPcHRpb25zIHx8IHt9OyAvLyBUT0RPIGFsbG93IENTViBvcHRpb25zCgkgICAgICAgIGlmICh0aGlzLl9mb3JtYXQgPT09ICd0c3YnKSB7CgkgICAgICAgICAgICBvcHRpb25zLmRlbGltaXRlciA9ICdcdCc7CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIHRoZSBjc3YyZ2VvanNvbiBsaWJyYXJ5IHRvIGNvbnZlcnQgdGhlIENTViB0byBHZW9KU09OCgkgICAgICAgIGNvbnN0IGdlb2pzb24gPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CgkgICAgICAgICAgICBjc3YyZ2VvanNvbl8xLmNzdjJnZW9qc29uKHRoaXMuX3Jhd0RhdGEsIG9wdGlvbnMsIChlcnIsIGRhdGEpID0+IHsKCSAgICAgICAgICAgICAgICBpZiAoZXJyKSB7CgkgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9KTsKCSAgICAgICAgfSk7CgkgICAgICAgIHJldHVybiBnZW9qc29uOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBMb2FkcyBUb3BvSlNPTiBkYXRhIGFuZCBjb252ZXJ0cyBpdCBpbnRvIGEgR2VvSlNPTiBGZWF0dXJlQ29sbGVjdGlvbgoJICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZFRvcG9Kc29uKCkgewoJICAgICAgICBsZXQgdG9wb0pzb25EYXRhID0ge307CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB0b3BvSnNvbkRhdGEgPSBKU09OLnBhcnNlKHRoaXMuX3Jhd0RhdGEpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlKSB7CgkgICAgICAgICAgICB0aHJvdyAiSW52YWxpZCBUb3BvSnNvbiI7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udmVydCB0aGUgZGF0YQoJICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5ibGFua0dlb0pTT04oKTsKCSAgICAgICAgaWYgKHRvcG9Kc29uRGF0YS50eXBlID09PSAiVG9wb2xvZ3kiICYmIHRvcG9Kc29uRGF0YS5vYmplY3RzICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJlc3VsdCA9IHsKCSAgICAgICAgICAgICAgICB0eXBlOiAiRmVhdHVyZUNvbGxlY3Rpb24iLAoJICAgICAgICAgICAgICAgIGZlYXR1cmVzOiByZXN1bHQuZmVhdHVyZXMgPSBPYmplY3Qua2V5cyh0b3BvSnNvbkRhdGEub2JqZWN0cykubWFwKGtleSA9PiB0b3BvanNvbkZlYXR1cmUodG9wb0pzb25EYXRhLCBrZXkpKS5yZWR1Y2UoKGEsIHYpID0+IFsuLi5hLCAuLi52LmZlYXR1cmVzXSwgW10pCgkgICAgICAgICAgICB9OwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfQoJICAgIDsKCSAgICAvKioKCSAgICAgKiBMb2FkcyBPU00gZGF0YSBhbmQgY29udmVydHMgaXQgaW50byBhIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24KCSAgICAgKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uLgoJICAgICAqLwoJICAgIGFzeW5jIGxvYWRPc20oKSB7CgkgICAgICAgIHJldHVybiBvc20yZ2VvanNvbih0aGlzLl9yYXdEYXRhKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogTG9hZHMgYW5kIHBhcnNlcyBQb2x5bGluZSBkYXRhIGludG8gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uLgoJICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZFBvbHlsaW5lKCkgewoJICAgICAgICBsZXQgb3B0aW9ucyA9IHRoaXMuX29wdGlvbnMucG9seWxpbmVPcHRpb25zIHx8IHt9OwoJICAgICAgICAvLyBVc2UgdGhlIGNzdjJnZW9qc29uIGxpYnJhcnkgdG8gY29udmVydCB0aGUgQ1NWIHRvIEdlb0pTT04KCSAgICAgICAgY29uc3QgZ2VvanNvbiA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgY29uc3QgbGluZVN0cmluZyA9IHBvbHlsaW5lRXhwb3J0cy50b0dlb0pTT04odGhpcy5fcmF3RGF0YSwgb3B0aW9ucy5wcmVjaXNpb24pOwoJICAgICAgICAgICAgICAgIGxldCBnZW9tZXRyeSA9IGxpbmVTdHJpbmc7CgkgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMudHlwZSA9PT0gJ3BvaW50JykgewoJICAgICAgICAgICAgICAgICAgICBpZiAobGluZVN0cmluZy5jb29yZGluYXRlcy5sZW5ndGggPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgaXQgYSBwb2ludAoJICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnkgPSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnUG9pbnQnLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb29yZGluYXRlcyc6IGxpbmVTdHJpbmcuY29vcmRpbmF0ZXNbMF0KCSAgICAgICAgICAgICAgICAgICAgICAgIH07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0Nhbm5vdCBjb252ZXJ0IHBvbHlsaW5lIHRvICcgKyBvcHRpb25zLnR5cGUpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9wdGlvbnMudHlwZSA9PT0gJ3BvbHlnb24nKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lU3RyaW5nLmNvb3JkaW5hdGVzWzBdWzBdID09PSBsaW5lU3RyaW5nLmNvb3JkaW5hdGVzW2xpbmVTdHJpbmcuY29vcmRpbmF0ZXMubGVuZ3RoIC0gMV1bMF0gJiYKCSAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVTdHJpbmcuY29vcmRpbmF0ZXNbMF1bMV0gPT09IGxpbmVTdHJpbmcuY29vcmRpbmF0ZXNbbGluZVN0cmluZy5jb29yZGluYXRlcy5sZW5ndGggLSAxXVsxXSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSBpdCBhIHBvbHlnb24KCSAgICAgICAgICAgICAgICAgICAgICAgIGdlb21ldHJ5ID0gewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJzogJ1BvbHlnb24nLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb29yZGluYXRlcyc6IFtsaW5lU3RyaW5nLmNvb3JkaW5hdGVzXQoJICAgICAgICAgICAgICAgICAgICAgICAgfTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignQ2Fubm90IGNvbnZlcnQgcG9seWxpbmUgdG8gJyArIG9wdGlvbnMudHlwZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmVzb2x2ZSh7CgkgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsCgkgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzOiBbewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkZlYXR1cmUiLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICJnZW9tZXRyeSI6IGdlb21ldHJ5LAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwcm9wZXJ0aWVzIjogb3B0aW9ucy5wcm9wZXJ0aWVzIHx8IHt9CgkgICAgICAgICAgICAgICAgICAgICAgICB9XQoJICAgICAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVycikgewoJICAgICAgICAgICAgICAgIHJlamVjdChlcnIpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgICAgcmV0dXJuIGdlb2pzb247CgkgICAgfQoJfQoKCWNvbnN0IGxpYnJhcmllcyA9IHsKCSAgICAnQ29udmVydGVyJzogQ29udmVydGVyCgl9OwoJbGV0IHN1YkNsYXNzOwoJc2VsZi5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZSA9PiB7CgkgICAgY29uc3QgZGF0YSA9IChlLmRhdGEgfHwgZSk7CgkgICAgY29uc3QgcG9zdCA9IChpZCwgZXJyLCByZXMsIHR5cGUpID0+IHsKCSAgICAgICAgcG9zdE1lc3NhZ2UoewoJICAgICAgICAgICAgdHlwZTogdHlwZSA/IHR5cGUgOiAoZXJyID8gJ2Vycm9yJyA6ICdyZXNwb25zZScpLAoJICAgICAgICAgICAgaWQ6IGlkLAoJICAgICAgICAgICAgbWVzc2FnZTogcmVzLAoJICAgICAgICAgICAgZXJyb3I6IGVycgoJICAgICAgICB9KTsKCSAgICB9OwoJICAgIGNvbnN0IGNvbW1hbmRzID0gewoJICAgICAgICAnaW5pdCc6IChtc2cpID0+IHsKCSAgICAgICAgICAgIGNvbnN0IHsgaWQsIGNvbW1hbmQsIG1lc3NhZ2UgfSA9IG1zZzsKCSAgICAgICAgICAgIHN1YkNsYXNzID0gbmV3IGxpYnJhcmllc1tjb21tYW5kXShtZXNzYWdlWzBdLCBtZXNzYWdlWzFdKTsKCSAgICAgICAgICAgIC8vIHJldHVybiB0aGUgY2xhc3MnIG1ldGhvZHMKCSAgICAgICAgICAgIGNvbnN0IGZucyA9IFsKCSAgICAgICAgICAgICAgICAuLi5PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhsaWJyYXJpZXNbY29tbWFuZF0ucHJvdG90eXBlKSwKCSAgICAgICAgICAgICAgICAuLi5PYmplY3Qua2V5cyhzdWJDbGFzcykKCSAgICAgICAgICAgIF0ubWFwKGtleSA9PiBba2V5LCB0eXBlb2YgbGlicmFyaWVzW2NvbW1hbmRdLnByb3RvdHlwZVtrZXldXSkKCSAgICAgICAgICAgICAgICAucmVkdWNlKChhLCBjKSA9PiAoeyAuLi5hLCAuLi57IFtjWzBdXTogY1sxXSB9IH0pLCB7fSk7CgkgICAgICAgICAgICBwb3N0KGlkLCB1bmRlZmluZWQsIGZucywgJ2luaXRfcmVzcG9uc2UnKTsKCSAgICAgICAgfSwKCSAgICAgICAgJ2dldCc6IGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgICAgIGNvbnN0IHsgaWQsIGNvbW1hbmQgfSA9IG1zZzsKCSAgICAgICAgICAgIGlmIChzdWJDbGFzcyAmJiBzdWJDbGFzc1tjb21tYW5kXSkgewoJICAgICAgICAgICAgICAgIHBvc3QoaWQsIHVuZGVmaW5lZCwgc3ViQ2xhc3NbY29tbWFuZF0pOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgcG9zdChpZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9LAoJICAgICAgICAnZXhlYyc6IGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgICAgIGNvbnN0IHsgaWQsIGNvbW1hbmQsIG1lc3NhZ2UgfSA9IG1zZzsKCSAgICAgICAgICAgIGlmIChzdWJDbGFzcyAmJiBzdWJDbGFzc1tjb21tYW5kXSAmJiB0eXBlb2Ygc3ViQ2xhc3NbY29tbWFuZF0gPT09ICdmdW5jdGlvbicpIHsKCSAgICAgICAgICAgICAgICBjb25zdCBjbWQgPSBzdWJDbGFzc1tjb21tYW5kXQoJICAgICAgICAgICAgICAgICAgICAuYXBwbHkoc3ViQ2xhc3MsIG1lc3NhZ2UpOwoJICAgICAgICAgICAgICAgIGlmICghIWNtZCAmJiB0eXBlb2YgY21kLnRoZW4gPT09ICdmdW5jdGlvbicpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSXQncyBhIHByb21pc2UsIHNvIHdhaXQgZm9yIGl0CgkgICAgICAgICAgICAgICAgICAgIGNtZAoJICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHBvc3QoaWQsIHVuZGVmaW5lZCwgcmVzKSkKCSAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlID0+IHBvc3QoaWQsIGUpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBhIHByb21pc2UsIGp1c3QgcmV0dXJuIGl0CgkgICAgICAgICAgICAgICAgICAgIHBvc3QoaWQsIHVuZGVmaW5lZCwgY21kKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBFcnJvcgoJICAgICAgICAgICAgICAgIHBvc3QoaWQsIG5ldyBFcnJvcihgY29tbWFuZCAiJHtjb21tYW5kfSIgbm90IGZvdW5kYCkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBpZiAoY29tbWFuZHNbZGF0YS50eXBlXSkgewoJICAgICAgICBjb21tYW5kc1tkYXRhLnR5cGVdKGRhdGEpOwoJICAgIH0KCX0pOwoKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9d29ya2VyLmpzLm1hcAoK",As=null,Qr=!1,Dn?Wo(Oo,As,Qr):function(pt,yt,ct){var Bt;return function(Kt){return Bt=Bt||an(pt,yt,ct),new Worker(Bt,Kt)}}(Oo,As,Qr));let Fr=()=>Math.random().toString(36).substring(2);class Nr{constructor(yt,ct){this.initId=Fr()+"-"+yt,this.worker=new zo,this.handlers=new Map,this.worker.onmessage=Bt=>{let Kt=Bt.data,Yt=this.handlers.get(Kt.id),ae=this;if(Yt){if(Kt.type==="response"&&Yt.resolve(Kt.message),Kt.type==="error"){let Be=Kt.error||new Error(`Unknown error with ${yt}`);Yt.reject(Be)}Kt.type==="init_response"&&(this._=Object.keys(Kt.message).map(Be=>{let _e=typeof Kt.message[Be]=="function";return[Be,function(){return _e?ae.exec(Be)(...arguments):ae.get(Be)}]}).reduce((Be,_e)=>({...Be,[_e[0]]:_e[1]}),{}),Yt.resolve(this._))}},this.worker.postMessage({type:"init",id:this.initId,command:yt,message:ct})}onLoad(){return new Promise(yt=>{this._===void 0?this.handlers.set(this.initId,{resolve:yt,reject:yt}):yt(this._)})}exec(yt){let ct=this;return function(...Bt){return new Promise((Kt,Yt)=>{let ae=Fr()+"-"+yt;ct.handlers.set(ae,{resolve:Kt,reject:Yt}),ct.worker.postMessage({type:"exec",id:ae,command:yt,message:[...Bt]})})}}get(yt){return new Promise((ct,Bt)=>{let Kt=Fr()+"-"+yt;this.handlers.set(Kt,{resolve:ct,reject:Bt}),this.worker.postMessage({type:"get",id:Kt,command:yt,message:[]})})}}let Gs=new URL("test://http://example.com").href!=="test://http://example.com";async function Kn(pt,yt,ct){let Bt=await fetch(pt,ct?{signal:ct.signal}:void 0),Kt={};try{let Yt=new URL(pt,window.location.href).hash,ae=decodeURIComponent(Yt.slice(1));Kt=JSON.parse(ae)}catch(Yt){console.warn("Error parsing or reading URL:",Yt)}if(Bt.status==200){let Yt=await Bt.text(),ae;return["kml","tcx","gpx"].indexOf(yt)>=0||!(()=>{let Be=!1;try{Be=typeof window.Worker=="function"}catch{Be=!1}return Be})()?ae=new vs(yt,Yt,Kt).convert():ae=new Nr("Converter",[yt,Yt,Kt]).exec("convert")(),await ae}throw new Error(`Data fetch error: ${Bt.statusText}`)}let to=(pt,yt)=>{let ct=new AbortController,Bt=pt.url.split("://")[0],Kt=pt.url.replace(new RegExp(`^${Bt}://`),""),Yt=Gs?(ae=>{let Be=new RegExp("^(https?)(//)");return ae.replace(Be,"$1:$2")})(Kt):Kt;return Yt&&Kn(Yt,Bt,ct).then(ae=>yt(null,ae)).catch(ae=>yt(ae)),{cancel:()=>{ct.abort()}}};r.VectorTextProtocol=to,r.addOptions=(pt,yt)=>{try{let ct=new URL(pt);return ct.hash=`#${encodeURIComponent(JSON.stringify(yt))}`,ct.toString()}catch(ct){return console.error("Error parsing or updating URL:",ct),pt}},r.addProtocols=pt=>{Mr.forEach(yt=>{pt.addProtocol(yt,to)})}})});var Ym=la((kK,cb)=>{cb.exports=w3;var v3=Object.prototype.hasOwnProperty;function w3(){for(var r={},t=0;t<arguments.length;t++){var i=arguments[t];for(var s in i)v3.call(i,s)&&(r[s]=i[s])}return r}});var gb=la((ub,hb)=>{(function(){var r=this,t={};typeof ub<"u"?hb.exports=t:r.fuzzy=t,t.simpleFilter=function(i,s){return s.filter(function(A){return t.test(i,A)})},t.test=function(i,s){return t.match(i,s)!==null},t.match=function(i,s,A){A=A||{};var o=0,g=[],d=s.length,C=0,v=0,x=A.pre||"",T=A.post||"",G=A.caseSensitive&&s||s.toLowerCase(),k;i=A.caseSensitive&&i||i.toLowerCase();for(var W=0;W<d;W++)k=s[W],G[W]===i[o]?(k=x+k+T,o+=1,v+=1+v):v=0,C+=v,g[g.length]=k;return o===i.length?(C=G===i?1/0:C,{rendered:g.join(""),score:C}):null},t.filter=function(i,s,A){return!s||s.length===0?[]:typeof i!="string"?s:(A=A||{},s.reduce(function(o,g,d,C){var v=g;A.extract&&(v=A.extract(g));var x=t.match(i,v,A);return x!=null&&(o[o.length]={string:x.rendered,score:x.score,index:d,original:g}),o},[]).sort(function(o,g){var d=g.score-o.score;return d||o.index-g.index}))}})()});var pb=la((LK,db)=>{"use strict";var Mo=function(r){return this.component=r,this.items=[],this.active=r.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,r.el.parentNode.insertBefore(this.wrapper,r.el.nextSibling),this};Mo.prototype.show=function(){this.element.style.display="block"};Mo.prototype.hide=function(){this.element.style.display="none"};Mo.prototype.add=function(r){this.items.push(r)};Mo.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0};Mo.prototype.isEmpty=function(){return!this.items.length};Mo.prototype.isVisible=function(){return this.element.style.display==="block"};Mo.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var r=0;r<this.items.length;r++)this.drawItem(this.items[r],this.active===r);this.show()};Mo.prototype.drawItem=function(r,t){var i=document.createElement("li"),s=document.createElement("a");t&&(i.className+=" active"),s.innerHTML=r.string,i.appendChild(s),this.element.appendChild(i),i.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),i.addEventListener("mouseup",function(){this.handleMouseUp.call(this,r)}.bind(this))};Mo.prototype.handleMouseUp=function(r){this.selectingListItem=!1,this.component.value(r.original),this.clear(),this.draw()};Mo.prototype.move=function(r){this.active=r,this.draw()};Mo.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)};Mo.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)};Mo.prototype.drawError=function(r){var t=document.createElement("li");t.innerHTML=r,this.element.appendChild(t),this.show()};db.exports=Mo});var mb=la((EK,fb)=>{"use strict";var B3=Ym(),_3=gb(),x3=pb(),zs=function(r,t,i){return i=i||{},this.options=B3({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},i),this.el=r,this.data=t||[],this.list=new x3(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(s){this.handleKeyUp(s.keyCode,s)}.bind(this),!1),this.el.addEventListener("keydown",function(s){this.handleKeyDown(s)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(s){this.handlePaste(s)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};zs.prototype.handleKeyUp=function(r,t){if(!(r===40||r===38||r===27||r===9)){if(r===13){this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),t.stopPropagation());return}this.handleInputChange(this.el.value)}};zs.prototype.handleKeyDown=function(r){switch(r.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&r.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};zs.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};zs.prototype.handlePaste=function(r){if(r.clipboardData)this.handleInputChange(r.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(r.target.value)},100)}};zs.prototype.handleInputChange=function(r){if(this.query=this.normalize(r),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates(function(t){for(var i=0;i<t.length&&(this.list.add(t[i]),i!==this.options.limit-1);i++);this.list.draw()}.bind(this))};zs.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};zs.prototype.update=function(r){this.data=r,this.handleKeyUp()};zs.prototype.clear=function(){this.data=[],this.list.clear()};zs.prototype.normalize=function(r){return r=r.toLowerCase(),r};zs.prototype.match=function(r,t){return r.indexOf(t)>-1};zs.prototype.value=function(r){if(this.selected=r,this.el.value=this.getItemValue(r||{place_name:this.query}),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")};zs.prototype.getCandidates=function(r){var t={pre:"<strong>",post:"</strong>",extract:function(s){return this.getItemValue(s)}.bind(this)},i;this.options.filter?(i=_3.filter(this.query,this.data,t),i=i.map(function(s){return{original:s.original,string:this.render(s.original,s.string)}}.bind(this))):i=this.data.map(function(s){var A=this.render(s);return{original:s,string:A}}.bind(this)),r(i)};zs.prototype.getItemValue=function(r){return r};zs.prototype.render=function(r,t){if(t)return t;for(var i=r.original?this.getItemValue(r.original):this.getItemValue(r),s=this.normalize(i),A=s.lastIndexOf(this.query);A>-1;){var o=A+this.query.length;i=i.slice(0,A)+"<strong>"+i.slice(A,o)+"</strong>"+i.slice(o),A=s.slice(0,A).lastIndexOf(this.query)}return i};zs.prototype.renderError=function(r){this.list.drawError(r)};fb.exports=zs});var yb=la((TK,Ib)=>{"use strict";var Cb=mb();Ib.exports=Cb;typeof window<"u"&&(window.Suggestions=Cb)});var Bb=la((QK,wb)=>{var S3="Expected a function",bb=NaN,F3="[object Symbol]",k3=/^\s+|\s+$/g,L3=/^[-+]0x[0-9a-f]+$/i,E3=/^0b[01]+$/i,T3=/^0o[0-7]+$/i,Q3=parseInt,U3=typeof global=="object"&&global&&global.Object===Object&&global,G3=typeof self=="object"&&self&&self.Object===Object&&self,R3=U3||G3||Function("return this")(),H3=Object.prototype,Z3=H3.toString,P3=Math.max,M3=Math.min,jm=function(){return R3.Date.now()};function N3(r,t,i){var s,A,o,g,d,C,v=0,x=!1,T=!1,G=!0;if(typeof r!="function")throw new TypeError(S3);t=vb(t)||0,qm(i)&&(x=!!i.leading,T="maxWait"in i,o=T?P3(vb(i.maxWait)||0,t):o,G="trailing"in i?!!i.trailing:G);function k(Qt){var Ft=s,vt=A;return s=A=void 0,v=Qt,g=r.apply(vt,Ft),g}function W(Qt){return v=Qt,d=setTimeout(O,t),x?k(Qt):g}function K(Qt){var Ft=Qt-C,vt=Qt-v,Jt=t-Ft;return T?M3(Jt,o-vt):Jt}function $(Qt){var Ft=Qt-C,vt=Qt-v;return C===void 0||Ft>=t||Ft<0||T&&vt>=o}function O(){var Qt=jm();if($(Qt))return tt(Qt);d=setTimeout(O,K(Qt))}function tt(Qt){return d=void 0,G&&s?k(Qt):(s=A=void 0,g)}function at(){d!==void 0&&clearTimeout(d),v=0,s=C=A=d=void 0}function Lt(){return d===void 0?g:tt(jm())}function Tt(){var Qt=jm(),Ft=$(Qt);if(s=arguments,A=this,C=Qt,Ft){if(d===void 0)return W(C);if(T)return d=setTimeout(O,t),k(C)}return d===void 0&&(d=setTimeout(O,t)),g}return Tt.cancel=at,Tt.flush=Lt,Tt}function qm(r){var t=typeof r;return!!r&&(t=="object"||t=="function")}function V3(r){return!!r&&typeof r=="object"}function D3(r){return typeof r=="symbol"||V3(r)&&Z3.call(r)==F3}function vb(r){if(typeof r=="number")return r;if(D3(r))return bb;if(qm(r)){var t=typeof r.valueOf=="function"?r.valueOf():r;r=qm(t)?t+"":t}if(typeof r!="string")return r===0?r:+r;r=r.replace(k3,"");var i=E3.test(r);return i||T3.test(r)?Q3(r.slice(2),i?2:8):L3.test(r)?bb:+r}wb.exports=N3});var Gb=la((UK,$m)=>{"use strict";var Bu=typeof Reflect=="object"?Reflect:null,_b=Bu&&typeof Bu.apply=="function"?Bu.apply:function(t,i,s){return Function.prototype.apply.call(t,i,s)},Cd;Bu&&typeof Bu.ownKeys=="function"?Cd=Bu.ownKeys:Object.getOwnPropertySymbols?Cd=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Cd=function(t){return Object.getOwnPropertyNames(t)};function K3(r){console&&console.warn&&console.warn(r)}var Sb=Number.isNaN||function(t){return t!==t};function qr(){qr.init.call(this)}$m.exports=qr;$m.exports.once=J3;qr.EventEmitter=qr;qr.prototype._events=void 0;qr.prototype._eventsCount=0;qr.prototype._maxListeners=void 0;var xb=10;function Id(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(qr,"defaultMaxListeners",{enumerable:!0,get:function(){return xb},set:function(r){if(typeof r!="number"||r<0||Sb(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");xb=r}});qr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};qr.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Sb(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Fb(r){return r._maxListeners===void 0?qr.defaultMaxListeners:r._maxListeners}qr.prototype.getMaxListeners=function(){return Fb(this)};qr.prototype.emit=function(t){for(var i=[],s=1;s<arguments.length;s++)i.push(arguments[s]);var A=t==="error",o=this._events;if(o!==void 0)A=A&&o.error===void 0;else if(!A)return!1;if(A){var g;if(i.length>0&&(g=i[0]),g instanceof Error)throw g;var d=new Error("Unhandled error."+(g?" ("+g.message+")":""));throw d.context=g,d}var C=o[t];if(C===void 0)return!1;if(typeof C=="function")_b(C,this,i);else for(var v=C.length,x=Qb(C,v),s=0;s<v;++s)_b(x[s],this,i);return!0};function kb(r,t,i,s){var A,o,g;if(Id(i),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",t,i.listener?i.listener:i),o=r._events),g=o[t]),g===void 0)g=o[t]=i,++r._eventsCount;else if(typeof g=="function"?g=o[t]=s?[i,g]:[g,i]:s?g.unshift(i):g.push(i),A=Fb(r),A>0&&g.length>A&&!g.warned){g.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+g.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=r,d.type=t,d.count=g.length,K3(d)}return r}qr.prototype.addListener=function(t,i){return kb(this,t,i,!1)};qr.prototype.on=qr.prototype.addListener;qr.prototype.prependListener=function(t,i){return kb(this,t,i,!0)};function W3(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Lb(r,t,i){var s={fired:!1,wrapFn:void 0,target:r,type:t,listener:i},A=W3.bind(s);return A.listener=i,s.wrapFn=A,A}qr.prototype.once=function(t,i){return Id(i),this.on(t,Lb(this,t,i)),this};qr.prototype.prependOnceListener=function(t,i){return Id(i),this.prependListener(t,Lb(this,t,i)),this};qr.prototype.removeListener=function(t,i){var s,A,o,g,d;if(Id(i),A=this._events,A===void 0)return this;if(s=A[t],s===void 0)return this;if(s===i||s.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete A[t],A.removeListener&&this.emit("removeListener",t,s.listener||i));else if(typeof s!="function"){for(o=-1,g=s.length-1;g>=0;g--)if(s[g]===i||s[g].listener===i){d=s[g].listener,o=g;break}if(o<0)return this;o===0?s.shift():O3(s,o),s.length===1&&(A[t]=s[0]),A.removeListener!==void 0&&this.emit("removeListener",t,d||i)}return this};qr.prototype.off=qr.prototype.removeListener;qr.prototype.removeAllListeners=function(t){var i,s,A;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[t]),this;if(arguments.length===0){var o=Object.keys(s),g;for(A=0;A<o.length;++A)g=o[A],g!=="removeListener"&&this.removeAllListeners(g);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=s[t],typeof i=="function")this.removeListener(t,i);else if(i!==void 0)for(A=i.length-1;A>=0;A--)this.removeListener(t,i[A]);return this};function Eb(r,t,i){var s=r._events;if(s===void 0)return[];var A=s[t];return A===void 0?[]:typeof A=="function"?i?[A.listener||A]:[A]:i?z3(A):Qb(A,A.length)}qr.prototype.listeners=function(t){return Eb(this,t,!0)};qr.prototype.rawListeners=function(t){return Eb(this,t,!1)};qr.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):Tb.call(r,t)};qr.prototype.listenerCount=Tb;function Tb(r){var t=this._events;if(t!==void 0){var i=t[r];if(typeof i=="function")return 1;if(i!==void 0)return i.length}return 0}qr.prototype.eventNames=function(){return this._eventsCount>0?Cd(this._events):[]};function Qb(r,t){for(var i=new Array(t),s=0;s<t;++s)i[s]=r[s];return i}function O3(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}function z3(r){for(var t=new Array(r.length),i=0;i<t.length;++i)t[i]=r[i].listener||r[i];return t}function J3(r,t){return new Promise(function(i,s){function A(g){r.removeListener(t,o),s(g)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",A),i([].slice.call(arguments))}Ub(r,t,o,{once:!0}),t!=="error"&&X3(r,A,{once:!0})})}function X3(r,t,i){typeof r.on=="function"&&Ub(r,"error",t,i)}function Ub(r,t,i,s){if(typeof r.on=="function")s.once?r.once(t,i):r.on(t,i);else if(typeof r.addEventListener=="function")r.addEventListener(t,function A(o){s.once&&r.removeEventListener(t,A),i(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var Hb=la((GK,Rb)=>{Rb.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}});var Pb=la((RK,Zb)=>{"use strict";var Y3={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05DC\u05D7\u05E4\u05E9",ja:"\u30B5\u30FC\u30C1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041F\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641C\u7D22",cs:"Vyhled\xE1v\xE1n\xED",hu:"Keres\xE9s",ka:"\u10EB\u10D8\u10D4\u10D1\u10D0",nb:"S\xF8ke",sk:"Vyh\u013Ead\xE1vanie",th:"\u0E04\u0E49\u0E19\u0E2B\u0E32",fi:"Hae",is:"Leita",ko:"\uC218\uC0C9",pl:"Szukaj",sl:"Iskanje",fa:"\u062C\u0633\u062A\u062C\u0648",ru:"\u041F\u043E\u0438\u0441\u043A"};Zb.exports={placeholder:Y3}});var Nb=la((Mb,yd)=>{(function(r,t,i){typeof yd<"u"&&yd.exports?yd.exports=i():r[t]=i()})(Mb,"subtag",function(){var r="",t=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function i(d){return d.match(t)||[]}function s(d){return i(d).filter(function(C,v){return C&&v})}function A(d){return d=i(d),{language:d[1]||r,extlang:d[2]||r,script:d[3]||r,region:d[4]||r}}function o(d,C,v){Object.defineProperty(d,C,{value:v,enumerable:!0})}function g(d,C,v){function x(T){return i(T)[d]||r}o(x,"pattern",C),o(A,v,x)}return g(1,/^[a-zA-Z]{2,3}$/,"language"),g(2,/^[a-zA-Z]{3}$/,"extlang"),g(3,/^[a-zA-Z]{4}$/,"script"),g(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),o(A,"split",s),A})});var Wb=la((HK,Kb)=>{"use strict";var j3=yb(),q3=Bb(),ca=Ym(),$3=Gb().EventEmitter,Vb=Hb(),tF=Pb(),eF=Nb();function Db(r,t){this._eventEmitter=new $3,this.options=ca({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geocoderApi=r}Db.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(r){return r.text!==void 0?r.text:r.place_name},render:function(r){if(r.geometry){var d=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--result maplibregl-ctrl-geocoder--result"><svg class="mapboxgl-ctrl-geocoder--result-icon maplibre-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="mapboxgl-ctrl-geocoder--result-title maplibregl-ctrl-geocoder--result-title">'+d[0]+'</div><div class="mapboxgl-ctrl-geocoder--result-address maplibregl-ctrl-geocoder--result-address">'+d.splice(1,d.length).join(",")+"</div></div></div>"}else{var t=r.text,i=t.toLowerCase().indexOf(this.query.toLowerCase()),s=this.query.length,A=t.substring(0,i),o=t.substring(i,i+s),g=t.substring(i+s);return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibregl-ctrl-geocoder--suggestion"><svg class="mapboxgl-ctrl-geocoder--suggestion-icon maplibre-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="mapboxgl-ctrl-geocoder--suggestion-info maplibregl-ctrl-geocoder--suggestion-info"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibregl-ctrl-geocoder--suggestion-title">'+A+'<span class="mapboxgl-ctrl-geocoder--suggestion-match maplibregl-ctrl-geocoder--suggestion-match">'+o+"</span>"+g+"</div></div></div>"}},popupRender:function(r){var t=r.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibre-ctrl-geocoder--suggestion popup-suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibre-ctrl-geocoder--suggestion-title popup-suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address maplibre-ctrl-geocoder--suggestion-address popup-suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},addTo:function(r){function t(s,A){if(!document.body.contains(A))throw new Error("Element provided to #addTo() exists, but is not in the DOM");var o=s.onAdd();A.appendChild(o)}if(r._controlContainer)r.addControl(this);else if(r instanceof HTMLElement)t(this,r);else if(typeof r=="string"){var i=document.querySelectorAll(r);if(i.length===0)throw new Error("Element ",r,"not found.");if(i.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,i[0])}else throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(r){if(r&&typeof r!="string"&&(this._map=r),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";var i=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",q3(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);var s=document.createElement("div");s.classList.add("mapboxgl-ctrl-geocoder--pin-right","maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button maplibregl-ctrl-geocoder--button";var A=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(A),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),s.appendChild(this._clearEl),s.appendChild(this._loadingEl),t.appendChild(i),t.appendChild(this._inputEl),t.appendChild(s),this._typeahead=new j3(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),t},createIcon:function(r,t){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");if(i.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+r+" maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+r),i.setAttribute("viewBox","0 0 18 18"),i.setAttribute("xml:space","preserve"),i.setAttribute("width",18),i.setAttribute("height",18),"innerHTML"in i)i.innerHTML=t;else{var s=document.createElement("div");s.innerHTML="<svg>"+t.valueOf().toString()+"</svg>";var A=s.firstChild,o=A.firstChild;i.appendChild(o)}return i},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(r){var t=(r.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t)},_onKeyDown:function(r){var t=27,i=9;if(r.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(r),this._inputEl.blur();var s=r.target&&r.target.shadowRoot?r.target.shadowRoot.activeElement:r.target,A=s?s.value:"";if(!A)return this.fresh=!0,r.keyCode!==i&&this.clear(r),this._clearEl.style.display="none";if(!(r.metaKey||[i,t,37,39,38,40].indexOf(r.keyCode)!==-1)){if(r.keyCode===13)if(!this.options.showResultsWhileTyping)this._typeahead.selected||this._geocode(s.value);else{this._typeahead.selected==null&&this.geocoderApi.getSuggestions?this._geocode(s.value,!0):this._typeahead.selected==null&&this.options.showResultMarkers&&this._fitBoundsForMarkers();return}s.value.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(s.value)}},_showButton:function(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(r){this.options.clearOnBlur&&this._clearOnBlur(r),this.options.collapsed&&this._collapse()},_onChange:function(){var r=this._typeahead.selected;if(r&&!r.geometry)r.placeId?this._geocode(r.placeId,!0,!0):this._geocode(r.text,!0);else if(r&&JSON.stringify(r)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){var t;if(this._removeResultMarkers(),r.properties&&Vb[r.properties.short_code])t=ca({},this.options.flyTo),this._map&&this._map.fitBounds(Vb[r.properties.short_code].bbox,t);else if(r.bbox){var i=r.bbox;t=ca({},this.options.flyTo),this._map&&this._map.fitBounds([[i[0],i[1]],[i[2],i[3]]],t)}else{var s={zoom:this.options.zoom};t=ca({},s,this.options.flyTo),r.center?t.center=r.center:r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(t.center=r.geometry.coordinates),this._map&&this._map.flyTo(t)}}this.options.marker&&this._maplibregl&&this._handleMarker(r),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(r),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:r})}},_getConfigForRequest:function(){var r=["bbox","limit","proximity","countries","types","language","reverseMode"],t=this,i=r.reduce(function(s,A){return t.options[A]&&(["countries","types","language"].indexOf(A)>-1?s[A]=t.options[A].split(/[\s,]+/):s[A]=t.options[A],A==="proximity"&&t.options[A]&&typeof t.options[A].longitude=="number"&&typeof t.options[A].latitude=="number"&&(s[A]=[t.options[A].longitude,t.options[A].latitude])),s},{});return i},_geocode:function(r,t,i){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:r}),this.inputString=r;var s=null,A=this._getConfigForRequest(),o;if(this.options.localGeocoderOnly)o=Promise.resolve();else if(this.options.reverseGeocode&&/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(r)){var g=r.split(/[\s(,)?]+/).map(function(v){return parseFloat(v,10)}).reverse();A.types&&A.types[0],A=ca(A,{query:g,limit:1}),"proximity"in A&&delete A.proximity,o=this.geocoderApi.reverseGeocode(A)}else A=ca(A,{query:r}),this.geocoderApi.getSuggestions?t?this.geocoderApi.searchByPlaceId&&i?o=this.geocoderApi.searchByPlaceId(A):o=this.geocoderApi.forwardGeocode(A):o=this.geocoderApi.getSuggestions(A):o=this.geocoderApi.forwardGeocode(A);var d=[];this.options.localGeocoder&&(d=this.options.localGeocoder(r),d||(d=[]));var C=[];return o.catch(function(v){s=v}.bind(this)).then(function(v){this._loadingEl.style.display="none";var x={};return v?x=v:x={type:"FeatureCollection",features:[]},x.config=A,this.fresh&&(this.fresh=!1),x.features=x.features?d.concat(x.features):d,this.options.externalGeocoder?(C=this.options.externalGeocoder(r,x.features,A)||[],C.then(function(T){return x.features=x.features?T.concat(x.features):T,x},function(){return x})):x}.bind(this)).then(function(v){if(s)throw s;this.options.filter&&v.features.length&&(v.features=v.features.filter(this.options.filter));var x=[];v.suggestions?x=v.suggestions:v.place?x=[v.place]:x=v.features,x.length?(this._clearEl.style.display="block",this._typeahead.update(x),(!this.options.showResultsWhileTyping||t)&&this.options.showResultMarkers&&(v.features.length>0||v.place)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",v)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",v))}.bind(this)).catch(function(v){this._loadingEl.style.display="none",d.length&&this.options.localGeocoder||C.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(d)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:d}),this._eventEmitter.emit("error",{error:v})}.bind(this)),o},_clear:function(r){r&&r.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(r){this._clear(r),this._inputEl.focus()},_clearOnBlur:function(r){var t=this;r.relatedTarget&&t._clear(r)},_onQueryResult:function(r){var t=r;if(!!t.features.length){var i=t.features[0];this._typeahead.selected=i,this._inputEl.value=i.place_name,this._onChange()}},_updateProximity:function(){if(!!this._map)if(this._map.getZoom()>9){var r=this._map.getCenter().wrap();this.setProximity({longitude:r.lng,latitude:r.lat})}else this.setProximity(null)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},query:function(r){return this._geocode(r).then(this._onQueryResult),this},_renderError:function(){var r="<div class='mapbox-gl-geocoder--error maplibre-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(r)},_renderNoResults:function(){var r="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>No results found</div>";this._renderMessage(r)},_renderMessage:function(r){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(r)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var r=this.options.language.split(",")[0],t=eF.language(r),i=tF.placeholder[t];if(i)return i}return"Search"},_fitBoundsForMarkers:function(){if(!(this._typeahead.data.length<1)){var r=this._typeahead.data.filter(function(A){return typeof A!="string"}).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){var t={padding:100},i=ca({},t,this.options.flyTo),s=new this._maplibregl.LngLatBounds;r.forEach(function(A){s.extend(A.geometry.coordinates)}),this._map.fitBounds(s.toArray(),i)}return r.length>0&&this._maplibregl&&this._handleResultMarkers(r),this}},setInput:function(r){return this._inputEl.value=r,this._typeahead.selected=null,this._typeahead.clear(),r.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(r),this},setProximity:function(r){return this.options.proximity=r,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(r){return r&&typeof r=="function"&&(this._typeahead.render=r),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(r){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=r||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(r){return this.options.zoom=r,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(r){return this.options.flyTo=r,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(r){return this.placeholder=r||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(r){return this.options.bbox=r,this},getCountries:function(){return this.options.countries},setCountries:function(r){return this.options.countries=r,this},getTypes:function(){return this.options.types},setTypes:function(r){return this.options.types=r,this},getMinLength:function(){return this.options.minLength},setMinLength:function(r){return this.options.minLength=r,this._typeahead&&(this._typeahead.options.minLength=r),this},getLimit:function(){return this.options.limit},setLimit:function(r){return this.options.limit=r,this._typeahead&&(this._typeahead.options.limit=r),this},getFilter:function(){return this.options.filter},setFilter:function(r){return this.options.filter=r,this},setGeocoderApi:function(r){return this.geocoderApi=r,this},getGeocoderApi:function(){return this.geocoderApi},_handleMarker:function(r){if(!!this._map){this._removeMarker();var t={color:"#4668F2"},i=ca({},t,this.options.marker);this.mapMarker=new this._maplibregl.Marker(i);var s;if(this.options.popup){var A={},o=ca({},A,this.options.popup);s=new this._maplibregl.Popup(o).setHTML(this.options.popupRender(r))}return r.center?(this.mapMarker.setLngLat(r.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(s)):r.geometry&&r.geometry.type&&r.geometry.type==="Point"&&r.geometry.coordinates&&(this.mapMarker.setLngLat(r.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(s)),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},_handleResultMarkers:function(r){if(!!this._map){this._removeResultMarkers();var t={color:"#4668F2"},i=ca({},t,this.options.showResultMarkers);return r.forEach(function(s){if(this.options.showResultMarkers&&this.options.showResultMarkers.element){var A=this.options.showResultMarkers.element.cloneNode(!0);i=ca(i,{element:A})}var o=new this._maplibregl.Marker(ca({},i,{element:A})),g;if(this.options.popup){var d={},C=ca({},d,this.options.popup);g=new this._maplibregl.Popup(C).setHTML(this.options.popupRender(s))}s.center?(o.setLngLat(s.center).addTo(this._map),this.options.popup&&o.setPopup(g)):s.geometry&&s.geometry.type&&s.geometry.type==="Point"&&s.geometry.coordinates&&(o.setLngLat(s.geometry.coordinates).addTo(this._map),this.options.popup&&o.setPopup(g)),this.resultMarkers.push(o)}.bind(this)),this}},_removeResultMarkers:function(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(r){r.remove()}),this.resultMarkers=[])},on:function(r,t){return this._eventEmitter.on(r,t),this},off:function(r,t){return this._eventEmitter.removeListener(r,t),this}};Kb.exports=Db});var X2={};Om(X2,{default:()=>BT});function $a(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");yC(r,t);function i(){this.constructor=r}r.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}function Co(r,t,i,s){function A(o){return o instanceof i?o:new i(function(g){g(o)})}return new(i||(i=Promise))(function(o,g){function d(x){try{v(s.next(x))}catch(T){g(T)}}function C(x){try{v(s.throw(x))}catch(T){g(T)}}function v(x){x.done?o(x.value):A(x.value).then(d,C)}v((s=s.apply(r,t||[])).next())})}function Js(r,t){var i={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,A,o,g;return g={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function d(v){return function(x){return C([v,x])}}function C(v){if(s)throw new TypeError("Generator is already executing.");for(;i;)try{if(s=1,A&&(o=v[0]&2?A.return:v[0]?A.throw||((o=A.return)&&o.call(A),0):A.next)&&!(o=o.call(A,v[1])).done)return o;switch(A=0,o&&(v=[v[0]&2,o.value]),v[0]){case 0:case 1:o=v;break;case 4:return i.label++,{value:v[1],done:!1};case 5:i.label++,A=v[1],v=[0];continue;case 7:v=i.ops.pop(),i.trys.pop();continue;default:if(o=i.trys,!(o=o.length>0&&o[o.length-1])&&(v[0]===6||v[0]===2)){i=0;continue}if(v[0]===3&&(!o||v[1]>o[0]&&v[1]<o[3])){i.label=v[1];break}if(v[0]===6&&i.label<o[1]){i.label=o[1],o=v;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(v);break}o[2]&&i.ops.pop(),i.trys.pop();continue}v=t.call(r,i)}catch(x){v=[6,x],A=0}finally{s=o=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}}function bd(r,t,i){if(i||arguments.length===2)for(var s=0,A=t.length,o;s<A;s++)(o||!(s in t))&&(o||(o=Array.prototype.slice.call(t,0,s)),o[s]=t[s]);return r.concat(o||t)}function aC(r,t,i){return i<0&&(i+=1),i>=1&&(i-=1),i<1/6?(t-r)*i*6+r:i<1/2?t:i<2/3?(t-r)*6*(2/3-i)+r:r}function ik(r){return!(r.type===20&&r.value==="none")&&(r.type!==18||!!w2[r.name])}var yC,bC,vl,$d,iF,tp,Gn,Ob,rF,Zh,zb,zh,Ph,nF,sF,oF,Hc,DC,tC,aF,Ov,AF,eC,lF,cF,uF,hF,gF,dF,pF,fF,Jb,mF,CF,IF,Xb,yF,Mh,bF,Yb,vF,zv,Jv,wF,BF,jb,Xv,qb,ic,vC,$b,wC,_F,Jh,BC,vd,Nh,xF,tv,_C,Vh,iC,_u,ua,Xh,Yh,xu,SF,Qu,FF,wd,Bd,xC,SC,FC,sg,kC,Pd,Md,rC,Yv,kF,LF,jv,mo,_d,LC,Il,EC,qv,ev,EF,iv,TF,QF,nC,rv,UF,GF,RF,HF,ZF,PF,Ag,nv,Dd,sv,tg,MF,NF,xd,Dh,VF,DF,KF,Sd,Fd,Kh,WF,No,OF,zF,JF,XF,YF,jF,qF,$F,kd,t4,ov,e4,i4,av,sC,Gc,r4,n4,s4,og,o4,a4,A4,l4,c4,u4,DA,$v,t2,e2,h4,g4,d4,i2,r2,n2,p4,f4,Io,m4,Su,C4,I4,y4,b4,Ld,Kd,Av,v4,ec,Ed,oC,w4,B4,_4,x4,S4,F4,k4,L4,E4,T4,Q4,U4,Td,G4,R4,H4,Z4,P4,M4,N4,V4,TC,s2,o2,lg,Hu,$r,D4,QC,a2,Ru,KA,K4,ac,Xn,A2,Qs,KC,rc,jh,ln,l2,c2,u2,h2,ep,g2,d2,Ba,sc,oc,ms,nc,lv,cv,uv,W4,eg,bl,O4,z4,ip,hv,J4,X4,qa,gv,Y4,j4,Qd,q4,p2,f2,m2,C2,I2,y2,b2,v2,$4,Ud,tk,ek,WC,w2,rk,nk,sk,ok,ak,Gu,Ak,lk,rp,ck,uk,hk,gk,np,dk,pk,fk,mk,sp,Ck,Ik,yk,bk,op,vk,wk,Bk,_k,xk,Sk,Fk,kk,Lk,Ek,Wd,Tk,Qk,dv,Uk,Gk,UC,ap,Rk,Hk,Zk,Pk,Mk,Nk,Ap,Vk,Dk,Kk,Wk,Ok,zk,Jk,Xk,Yk,jk,qk,$k,pv,tL,eL,iL,ig,rL,nL,B2,sL,oL,aL,AL,lL,cL,uL,hL,as,gL,dL,pL,fL,mL,fv,CL,IL,yL,bL,vL,wL,mv,_i,BL,_L,GC,WA,xL,Cv,qh,Wh,SL,FL,kL,Zc,OC,AC,LL,_2,EL,lC,TL,QL,UL,GL,RL,HL,ZL,PL,Iv,ML,NL,VL,yv,DL,Oh,KL,cC,uC,bv,vv,WL,wv,hC,gC,Bv,_v,xv,Sv,dC,OL,zL,JL,Rc,Fv,XL,YL,jL,qL,$L,tE,eE,iE,rE,kv,nE,RC,Lv,Ts,rg,sE,oE,Ev,zC,aE,AE,lE,cE,uE,hE,gE,dE,x2,S2,F2,k2,HC,pE,fE,mE,CE,Od,zd,IE,Tv,JC,L2,E2,T2,yE,Nd,Q2,U2,bE,vE,G2,Uu,ZC,Vd,wE,BE,_E,xE,R2,XC,H2,Qv,PC,Z2,Uv,SE,Jd,Xd,P2,Gv,FE,Rv,Hv,kE,LE,Fu,M2,Un,Uc,Eu,$l,tc,$h,yl,Zv,Pv,Mv,pC,ag,N2,Nv,ng,EE,TE,QE,UE,GE,fC,RE,HE,ZE,PE,ME,MC,NC,Vv,NE,VE,V2,DE,KE,WE,OE,zE,mC,JE,CC,XE,yi,ku,Gd,wa,YE,Wr,Cn,Yd,jE,jd,qE,Rd,$E,tT,D2,eT,Dv,iT,K2,W2,VC,O2,rT,Kv,nT,sT,oT,Hd,_a,z2,qd,aT,AT,IC,Lu,Zd,lT,Tu,cT,uT,Wv,hT,J2,gT,dT,pT,fT,mT,CT,IT,yT,bT,vT,wT,BT,_T,xT,Y2=dd(()=>{yC=function(r,t){return yC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var A in s)Object.prototype.hasOwnProperty.call(s,A)&&(i[A]=s[A])},yC(r,t)};bC=function(){return bC=Object.assign||function(r){for(var t,i=1,s=arguments.length;i<s;i++){t=arguments[i];for(var A in t)Object.prototype.hasOwnProperty.call(t,A)&&(r[A]=t[A])}return r},bC.apply(this,arguments)};vl=function(){function r(t,i,s,A){this.left=t,this.top=i,this.width=s,this.height=A}return r.prototype.add=function(t,i,s,A){return new r(this.left+t,this.top+i,this.width+s,this.height+A)},r.fromClientRect=function(t,i){return new r(i.left+t.windowBounds.left,i.top+t.windowBounds.top,i.width,i.height)},r.fromDOMRectList=function(t,i){var s=Array.from(i).find(function(A){return A.width!==0});return s?new r(s.left+t.windowBounds.left,s.top+t.windowBounds.top,s.width,s.height):r.EMPTY},r.EMPTY=new r(0,0,0,0),r}(),$d=function(r,t){return vl.fromClientRect(r,t.getBoundingClientRect())},iF=function(r){var t=r.body,i=r.documentElement;if(!t||!i)throw new Error("Unable to get document size");var s=Math.max(Math.max(t.scrollWidth,i.scrollWidth),Math.max(t.offsetWidth,i.offsetWidth),Math.max(t.clientWidth,i.clientWidth)),A=Math.max(Math.max(t.scrollHeight,i.scrollHeight),Math.max(t.offsetHeight,i.offsetHeight),Math.max(t.clientHeight,i.clientHeight));return new vl(0,0,s,A)},tp=function(r){for(var t=[],i=0,s=r.length;i<s;){var A=r.charCodeAt(i++);if(A>=55296&&A<=56319&&i<s){var o=r.charCodeAt(i++);(o&64512)===56320?t.push(((A&1023)<<10)+(o&1023)+65536):(t.push(A),i--)}else t.push(A)}return t},Gn=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var i=r.length;if(!i)return"";for(var s=[],A=-1,o="";++A<i;){var g=r[A];g<=65535?s.push(g):(g-=65536,s.push((g>>10)+55296,g%1024+56320)),(A+1===i||s.length>16384)&&(o+=String.fromCharCode.apply(String,s),s.length=0)}return o},Ob="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rF=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Zh=0;Zh<Ob.length;Zh++)rF[Ob.charCodeAt(Zh)]=Zh;zb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Ph=0;Ph<zb.length;Ph++)zh[zb.charCodeAt(Ph)]=Ph;nF=function(r){var t=r.length*.75,i=r.length,s,A=0,o,g,d,C;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);var v=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),x=Array.isArray(v)?v:new Uint8Array(v);for(s=0;s<i;s+=4)o=zh[r.charCodeAt(s)],g=zh[r.charCodeAt(s+1)],d=zh[r.charCodeAt(s+2)],C=zh[r.charCodeAt(s+3)],x[A++]=o<<2|g>>4,x[A++]=(g&15)<<4|d>>2,x[A++]=(d&3)<<6|C&63;return v},sF=function(r){for(var t=r.length,i=[],s=0;s<t;s+=2)i.push(r[s+1]<<8|r[s]);return i},oF=function(r){for(var t=r.length,i=[],s=0;s<t;s+=4)i.push(r[s+3]<<24|r[s+2]<<16|r[s+1]<<8|r[s]);return i},Hc=5,DC=11,tC=2,aF=DC-Hc,Ov=65536>>Hc,AF=1<<Hc,eC=AF-1,lF=1024>>Hc,cF=Ov+lF,uF=cF,hF=32,gF=uF+hF,dF=65536>>DC,pF=1<<aF,fF=pF-1,Jb=function(r,t,i){return r.slice?r.slice(t,i):new Uint16Array(Array.prototype.slice.call(r,t,i))},mF=function(r,t,i){return r.slice?r.slice(t,i):new Uint32Array(Array.prototype.slice.call(r,t,i))},CF=function(r,t){var i=nF(r),s=Array.isArray(i)?oF(i):new Uint32Array(i),A=Array.isArray(i)?sF(i):new Uint16Array(i),o=24,g=Jb(A,o/2,s[4]/2),d=s[5]===2?Jb(A,(o+s[4])/2):mF(s,Math.ceil((o+s[4])/4));return new IF(s[0],s[1],s[2],s[3],g,d)},IF=function(){function r(t,i,s,A,o,g){this.initialValue=t,this.errorValue=i,this.highStart=s,this.highValueIndex=A,this.index=o,this.data=g}return r.prototype.get=function(t){var i;if(t>=0){if(t<55296||t>56319&&t<=65535)return i=this.index[t>>Hc],i=(i<<tC)+(t&eC),this.data[i];if(t<=65535)return i=this.index[Ov+(t-55296>>Hc)],i=(i<<tC)+(t&eC),this.data[i];if(t<this.highStart)return i=gF-dF+(t>>DC),i=this.index[i],i+=t>>Hc&fF,i=this.index[i],i=(i<<tC)+(t&eC),this.data[i];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),Xb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yF=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Mh=0;Mh<Xb.length;Mh++)yF[Xb.charCodeAt(Mh)]=Mh;bF="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Yb=50,vF=1,zv=2,Jv=3,wF=4,BF=5,jb=7,Xv=8,qb=9,ic=10,vC=11,$b=12,wC=13,_F=14,Jh=15,BC=16,vd=17,Nh=18,xF=19,tv=20,_C=21,Vh=22,iC=23,_u=24,ua=25,Xh=26,Yh=27,xu=28,SF=29,Qu=30,FF=31,wd=32,Bd=33,xC=34,SC=35,FC=36,sg=37,kC=38,Pd=39,Md=40,rC=41,Yv=42,kF=43,LF=[9001,65288],jv="!",mo="\xD7",_d="\xF7",LC=CF(bF),Il=[Qu,FC],EC=[vF,zv,Jv,BF],qv=[ic,Xv],ev=[Yh,Xh],EF=EC.concat(qv),iv=[kC,Pd,Md,xC,SC],TF=[Jh,wC],QF=function(r,t){t===void 0&&(t="strict");var i=[],s=[],A=[];return r.forEach(function(o,g){var d=LC.get(o);if(d>Yb?(A.push(!0),d-=Yb):A.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(o)!==-1)return s.push(g),i.push(BC);if(d===wF||d===vC){if(g===0)return s.push(g),i.push(Qu);var C=i[g-1];return EF.indexOf(C)===-1?(s.push(s[g-1]),i.push(C)):(s.push(g),i.push(Qu))}if(s.push(g),d===FF)return i.push(t==="strict"?_C:sg);if(d===Yv||d===SF)return i.push(Qu);if(d===kF)return o>=131072&&o<=196605||o>=196608&&o<=262141?i.push(sg):i.push(Qu);i.push(d)}),[s,i,A]},nC=function(r,t,i,s){var A=s[i];if(Array.isArray(r)?r.indexOf(A)!==-1:r===A)for(var o=i;o<=s.length;){o++;var g=s[o];if(g===t)return!0;if(g!==ic)break}if(A===ic)for(var o=i;o>0;){o--;var d=s[o];if(Array.isArray(r)?r.indexOf(d)!==-1:r===d)for(var C=i;C<=s.length;){C++;var g=s[C];if(g===t)return!0;if(g!==ic)break}if(d!==ic)break}return!1},rv=function(r,t){for(var i=r;i>=0;){var s=t[i];if(s===ic)i--;else return s}return 0},UF=function(r,t,i,s,A){if(i[s]===0)return mo;var o=s-1;if(Array.isArray(A)&&A[o]===!0)return mo;var g=o-1,d=o+1,C=t[o],v=g>=0?t[g]:0,x=t[d];if(C===zv&&x===Jv)return mo;if(EC.indexOf(C)!==-1)return jv;if(EC.indexOf(x)!==-1||qv.indexOf(x)!==-1)return mo;if(rv(o,t)===Xv)return _d;if(LC.get(r[o])===vC||(C===wd||C===Bd)&&LC.get(r[d])===vC||C===jb||x===jb||C===qb||[ic,wC,Jh].indexOf(C)===-1&&x===qb||[vd,Nh,xF,_u,xu].indexOf(x)!==-1||rv(o,t)===Vh||nC(iC,Vh,o,t)||nC([vd,Nh],_C,o,t)||nC($b,$b,o,t))return mo;if(C===ic)return _d;if(C===iC||x===iC)return mo;if(x===BC||C===BC)return _d;if([wC,Jh,_C].indexOf(x)!==-1||C===_F||v===FC&&TF.indexOf(C)!==-1||C===xu&&x===FC||x===tv||Il.indexOf(x)!==-1&&C===ua||Il.indexOf(C)!==-1&&x===ua||C===Yh&&[sg,wd,Bd].indexOf(x)!==-1||[sg,wd,Bd].indexOf(C)!==-1&&x===Xh||Il.indexOf(C)!==-1&&ev.indexOf(x)!==-1||ev.indexOf(C)!==-1&&Il.indexOf(x)!==-1||[Yh,Xh].indexOf(C)!==-1&&(x===ua||[Vh,Jh].indexOf(x)!==-1&&t[d+1]===ua)||[Vh,Jh].indexOf(C)!==-1&&x===ua||C===ua&&[ua,xu,_u].indexOf(x)!==-1)return mo;if([ua,xu,_u,vd,Nh].indexOf(x)!==-1)for(var T=o;T>=0;){var G=t[T];if(G===ua)return mo;if([xu,_u].indexOf(G)!==-1)T--;else break}if([Yh,Xh].indexOf(x)!==-1)for(var T=[vd,Nh].indexOf(C)!==-1?g:o;T>=0;){var G=t[T];if(G===ua)return mo;if([xu,_u].indexOf(G)!==-1)T--;else break}if(kC===C&&[kC,Pd,xC,SC].indexOf(x)!==-1||[Pd,xC].indexOf(C)!==-1&&[Pd,Md].indexOf(x)!==-1||[Md,SC].indexOf(C)!==-1&&x===Md||iv.indexOf(C)!==-1&&[tv,Xh].indexOf(x)!==-1||iv.indexOf(x)!==-1&&C===Yh||Il.indexOf(C)!==-1&&Il.indexOf(x)!==-1||C===_u&&Il.indexOf(x)!==-1||Il.concat(ua).indexOf(C)!==-1&&x===Vh&&LF.indexOf(r[d])===-1||Il.concat(ua).indexOf(x)!==-1&&C===Nh)return mo;if(C===rC&&x===rC){for(var k=i[o],W=1;k>0&&(k--,t[k]===rC);)W++;if(W%2!==0)return mo}return C===wd&&x===Bd?mo:_d},GF=function(r,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var i=QF(r,t.lineBreak),s=i[0],A=i[1],o=i[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(A=A.map(function(d){return[ua,Qu,Yv].indexOf(d)!==-1?sg:d}));var g=t.wordBreak==="keep-all"?o.map(function(d,C){return d&&r[C]>=19968&&r[C]<=40959}):void 0;return[s,A,g]},RF=function(){function r(t,i,s,A){this.codePoints=t,this.required=i===jv,this.start=s,this.end=A}return r.prototype.slice=function(){return Gn.apply(void 0,this.codePoints.slice(this.start,this.end))},r}(),HF=function(r,t){var i=tp(r),s=GF(i,t),A=s[0],o=s[1],g=s[2],d=i.length,C=0,v=0;return{next:function(){if(v>=d)return{done:!0,value:null};for(var x=mo;v<d&&(x=UF(i,o,A,++v,g))===mo;);if(x!==mo||v===d){var T=new RF(i,x,C,v);return C=v,{value:T,done:!1}}return{done:!0,value:null}}}},ZF=1,PF=2,Ag=4,nv=8,Dd=10,sv=47,tg=92,MF=9,NF=32,xd=34,Dh=61,VF=35,DF=36,KF=37,Sd=39,Fd=40,Kh=41,WF=95,No=45,OF=33,zF=60,JF=62,XF=64,YF=91,jF=93,qF=61,$F=123,kd=63,t4=125,ov=124,e4=126,i4=128,av=65533,sC=42,Gc=43,r4=44,n4=58,s4=59,og=46,o4=0,a4=8,A4=11,l4=14,c4=31,u4=127,DA=-1,$v=48,t2=97,e2=101,h4=102,g4=117,d4=122,i2=65,r2=69,n2=70,p4=85,f4=90,Io=function(r){return r>=$v&&r<=57},m4=function(r){return r>=55296&&r<=57343},Su=function(r){return Io(r)||r>=i2&&r<=n2||r>=t2&&r<=h4},C4=function(r){return r>=t2&&r<=d4},I4=function(r){return r>=i2&&r<=f4},y4=function(r){return C4(r)||I4(r)},b4=function(r){return r>=i4},Ld=function(r){return r===Dd||r===MF||r===NF},Kd=function(r){return y4(r)||b4(r)||r===WF},Av=function(r){return Kd(r)||Io(r)||r===No},v4=function(r){return r>=o4&&r<=a4||r===A4||r>=l4&&r<=c4||r===u4},ec=function(r,t){return r!==tg?!1:t!==Dd},Ed=function(r,t,i){return r===No?Kd(t)||ec(t,i):Kd(r)?!0:!!(r===tg&&ec(r,t))},oC=function(r,t,i){return r===Gc||r===No?Io(t)?!0:t===og&&Io(i):Io(r===og?t:r)},w4=function(r){var t=0,i=1;(r[t]===Gc||r[t]===No)&&(r[t]===No&&(i=-1),t++);for(var s=[];Io(r[t]);)s.push(r[t++]);var A=s.length?parseInt(Gn.apply(void 0,s),10):0;r[t]===og&&t++;for(var o=[];Io(r[t]);)o.push(r[t++]);var g=o.length,d=g?parseInt(Gn.apply(void 0,o),10):0;(r[t]===r2||r[t]===e2)&&t++;var C=1;(r[t]===Gc||r[t]===No)&&(r[t]===No&&(C=-1),t++);for(var v=[];Io(r[t]);)v.push(r[t++]);var x=v.length?parseInt(Gn.apply(void 0,v),10):0;return i*(A+d*Math.pow(10,-g))*Math.pow(10,C*x)},B4={type:2},_4={type:3},x4={type:4},S4={type:13},F4={type:8},k4={type:21},L4={type:9},E4={type:10},T4={type:11},Q4={type:12},U4={type:14},Td={type:23},G4={type:1},R4={type:25},H4={type:24},Z4={type:26},P4={type:27},M4={type:28},N4={type:29},V4={type:31},TC={type:32},s2=function(){function r(){this._value=[]}return r.prototype.write=function(t){this._value=this._value.concat(tp(t))},r.prototype.read=function(){for(var t=[],i=this.consumeToken();i!==TC;)t.push(i),i=this.consumeToken();return t},r.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case xd:return this.consumeStringToken(xd);case VF:var i=this.peekCodePoint(0),s=this.peekCodePoint(1),A=this.peekCodePoint(2);if(Av(i)||ec(s,A)){var o=Ed(i,s,A)?PF:ZF,g=this.consumeName();return{type:5,value:g,flags:o}}break;case DF:if(this.peekCodePoint(0)===Dh)return this.consumeCodePoint(),S4;break;case Sd:return this.consumeStringToken(Sd);case Fd:return B4;case Kh:return _4;case sC:if(this.peekCodePoint(0)===Dh)return this.consumeCodePoint(),U4;break;case Gc:if(oC(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case r4:return x4;case No:var d=t,C=this.peekCodePoint(0),v=this.peekCodePoint(1);if(oC(d,C,v))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Ed(d,C,v))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(C===No&&v===JF)return this.consumeCodePoint(),this.consumeCodePoint(),H4;break;case og:if(oC(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case sv:if(this.peekCodePoint(0)===sC)for(this.consumeCodePoint();;){var x=this.consumeCodePoint();if(x===sC&&(x=this.consumeCodePoint(),x===sv))return this.consumeToken();if(x===DA)return this.consumeToken()}break;case n4:return Z4;case s4:return P4;case zF:if(this.peekCodePoint(0)===OF&&this.peekCodePoint(1)===No&&this.peekCodePoint(2)===No)return this.consumeCodePoint(),this.consumeCodePoint(),R4;break;case XF:var T=this.peekCodePoint(0),G=this.peekCodePoint(1),k=this.peekCodePoint(2);if(Ed(T,G,k)){var g=this.consumeName();return{type:7,value:g}}break;case YF:return M4;case tg:if(ec(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case jF:return N4;case qF:if(this.peekCodePoint(0)===Dh)return this.consumeCodePoint(),F4;break;case $F:return T4;case t4:return Q4;case g4:case p4:var W=this.peekCodePoint(0),K=this.peekCodePoint(1);return W===Gc&&(Su(K)||K===kd)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case ov:if(this.peekCodePoint(0)===Dh)return this.consumeCodePoint(),L4;if(this.peekCodePoint(0)===ov)return this.consumeCodePoint(),k4;break;case e4:if(this.peekCodePoint(0)===Dh)return this.consumeCodePoint(),E4;break;case DA:return TC}return Ld(t)?(this.consumeWhiteSpace(),V4):Io(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Kd(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Gn(t)}},r.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},r.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},r.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},r.prototype.consumeUnicodeRangeToken=function(){for(var t=[],i=this.consumeCodePoint();Su(i)&&t.length<6;)t.push(i),i=this.consumeCodePoint();for(var s=!1;i===kd&&t.length<6;)t.push(i),i=this.consumeCodePoint(),s=!0;if(s){var A=parseInt(Gn.apply(void 0,t.map(function(C){return C===kd?$v:C})),16),o=parseInt(Gn.apply(void 0,t.map(function(C){return C===kd?n2:C})),16);return{type:30,start:A,end:o}}var g=parseInt(Gn.apply(void 0,t),16);if(this.peekCodePoint(0)===No&&Su(this.peekCodePoint(1))){this.consumeCodePoint(),i=this.consumeCodePoint();for(var d=[];Su(i)&&d.length<6;)d.push(i),i=this.consumeCodePoint();var o=parseInt(Gn.apply(void 0,d),16);return{type:30,start:g,end:o}}else return{type:30,start:g,end:g}},r.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===Fd?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Fd?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},r.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===DA)return{type:22,value:""};var i=this.peekCodePoint(0);if(i===Sd||i===xd){var s=this.consumeStringToken(this.consumeCodePoint());return s.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===DA||this.peekCodePoint(0)===Kh)?(this.consumeCodePoint(),{type:22,value:s.value}):(this.consumeBadUrlRemnants(),Td)}for(;;){var A=this.consumeCodePoint();if(A===DA||A===Kh)return{type:22,value:Gn.apply(void 0,t)};if(Ld(A))return this.consumeWhiteSpace(),this.peekCodePoint(0)===DA||this.peekCodePoint(0)===Kh?(this.consumeCodePoint(),{type:22,value:Gn.apply(void 0,t)}):(this.consumeBadUrlRemnants(),Td);if(A===xd||A===Sd||A===Fd||v4(A))return this.consumeBadUrlRemnants(),Td;if(A===tg)if(ec(A,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Td;else t.push(A)}},r.prototype.consumeWhiteSpace=function(){for(;Ld(this.peekCodePoint(0));)this.consumeCodePoint()},r.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Kh||t===DA)return;ec(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},r.prototype.consumeStringSlice=function(t){for(var i=5e4,s="";t>0;){var A=Math.min(i,t);s+=Gn.apply(void 0,this._value.splice(0,A)),t-=A}return this._value.shift(),s},r.prototype.consumeStringToken=function(t){var i="",s=0;do{var A=this._value[s];if(A===DA||A===void 0||A===t)return i+=this.consumeStringSlice(s),{type:0,value:i};if(A===Dd)return this._value.splice(0,s),G4;if(A===tg){var o=this._value[s+1];o!==DA&&o!==void 0&&(o===Dd?(i+=this.consumeStringSlice(s),s=-1,this._value.shift()):ec(A,o)&&(i+=this.consumeStringSlice(s),i+=Gn(this.consumeEscapedCodePoint()),s=-1))}s++}while(!0)},r.prototype.consumeNumber=function(){var t=[],i=Ag,s=this.peekCodePoint(0);for((s===Gc||s===No)&&t.push(this.consumeCodePoint());Io(this.peekCodePoint(0));)t.push(this.consumeCodePoint());s=this.peekCodePoint(0);var A=this.peekCodePoint(1);if(s===og&&Io(A))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),i=nv;Io(this.peekCodePoint(0));)t.push(this.consumeCodePoint());s=this.peekCodePoint(0),A=this.peekCodePoint(1);var o=this.peekCodePoint(2);if((s===r2||s===e2)&&((A===Gc||A===No)&&Io(o)||Io(A)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),i=nv;Io(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[w4(t),i]},r.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),i=t[0],s=t[1],A=this.peekCodePoint(0),o=this.peekCodePoint(1),g=this.peekCodePoint(2);if(Ed(A,o,g)){var d=this.consumeName();return{type:15,number:i,flags:s,unit:d}}return A===KF?(this.consumeCodePoint(),{type:16,number:i,flags:s}):{type:17,number:i,flags:s}},r.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Su(t)){for(var i=Gn(t);Su(this.peekCodePoint(0))&&i.length<6;)i+=Gn(this.consumeCodePoint());Ld(this.peekCodePoint(0))&&this.consumeCodePoint();var s=parseInt(i,16);return s===0||m4(s)||s>1114111?av:s}return t===DA?av:t},r.prototype.consumeName=function(){for(var t="";;){var i=this.consumeCodePoint();if(Av(i))t+=Gn(i);else if(ec(i,this.peekCodePoint(0)))t+=Gn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(i),t}},r}(),o2=function(){function r(t){this._tokens=t}return r.create=function(t){var i=new s2;return i.write(t),new r(i.read())},r.parseValue=function(t){return r.create(t).parseComponentValue()},r.parseValues=function(t){return r.create(t).parseComponentValues()},r.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var i=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return i;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},r.prototype.parseComponentValues=function(){for(var t=[];;){var i=this.consumeComponentValue();if(i.type===32)return t;t.push(i),t.push()}},r.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},r.prototype.consumeSimpleBlock=function(t){for(var i={type:t,values:[]},s=this.consumeToken();;){if(s.type===32||K4(s,t))return i;this.reconsumeToken(s),i.values.push(this.consumeComponentValue()),s=this.consumeToken()}},r.prototype.consumeFunction=function(t){for(var i={name:t.value,values:[],type:18};;){var s=this.consumeToken();if(s.type===32||s.type===3)return i;this.reconsumeToken(s),i.values.push(this.consumeComponentValue())}},r.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?TC:t},r.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},r}(),lg=function(r){return r.type===15},Hu=function(r){return r.type===17},$r=function(r){return r.type===20},D4=function(r){return r.type===0},QC=function(r,t){return $r(r)&&r.value===t},a2=function(r){return r.type!==31},Ru=function(r){return r.type!==31&&r.type!==4},KA=function(r){var t=[],i=[];return r.forEach(function(s){if(s.type===4){if(i.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(i),i=[];return}s.type!==31&&i.push(s)}),i.length&&t.push(i),t},K4=function(r,t){return t===11&&r.type===12||t===28&&r.type===29?!0:t===2&&r.type===3},ac=function(r){return r.type===17||r.type===15},Xn=function(r){return r.type===16||ac(r)},A2=function(r){return r.length>1?[r[0],r[1]]:[r[0]]},Qs={type:17,number:0,flags:Ag},KC={type:16,number:50,flags:Ag},rc={type:16,number:100,flags:Ag},jh=function(r,t,i){var s=r[0],A=r[1];return[ln(s,t),ln(typeof A<"u"?A:s,i)]},ln=function(r,t){if(r.type===16)return r.number/100*t;if(lg(r))switch(r.unit){case"rem":case"em":return 16*r.number;case"px":default:return r.number}return r.number},l2="deg",c2="grad",u2="rad",h2="turn",ep={name:"angle",parse:function(r,t){if(t.type===15)switch(t.unit){case l2:return Math.PI*t.number/180;case c2:return Math.PI/200*t.number;case u2:return t.number;case h2:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},g2=function(r){return r.type===15&&(r.unit===l2||r.unit===c2||r.unit===u2||r.unit===h2)},d2=function(r){var t=r.filter($r).map(function(i){return i.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Qs,Qs];case"to top":case"bottom":return Ba(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Qs,rc];case"to right":case"left":return Ba(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[rc,rc];case"to bottom":case"top":return Ba(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[rc,Qs];case"to left":case"right":return Ba(270)}return 0},Ba=function(r){return Math.PI*r/180},sc={name:"color",parse:function(r,t){if(t.type===18){var i=W4[t.name];if(typeof i>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return i(r,t.values)}if(t.type===5){if(t.value.length===3){var s=t.value.substring(0,1),A=t.value.substring(1,2),o=t.value.substring(2,3);return nc(parseInt(s+s,16),parseInt(A+A,16),parseInt(o+o,16),1)}if(t.value.length===4){var s=t.value.substring(0,1),A=t.value.substring(1,2),o=t.value.substring(2,3),g=t.value.substring(3,4);return nc(parseInt(s+s,16),parseInt(A+A,16),parseInt(o+o,16),parseInt(g+g,16)/255)}if(t.value.length===6){var s=t.value.substring(0,2),A=t.value.substring(2,4),o=t.value.substring(4,6);return nc(parseInt(s,16),parseInt(A,16),parseInt(o,16),1)}if(t.value.length===8){var s=t.value.substring(0,2),A=t.value.substring(2,4),o=t.value.substring(4,6),g=t.value.substring(6,8);return nc(parseInt(s,16),parseInt(A,16),parseInt(o,16),parseInt(g,16)/255)}}if(t.type===20){var d=bl[t.value.toUpperCase()];if(typeof d<"u")return d}return bl.TRANSPARENT}},oc=function(r){return(255&r)===0},ms=function(r){var t=255&r,i=255&r>>8,s=255&r>>16,A=255&r>>24;return t<255?"rgba("+A+","+s+","+i+","+t/255+")":"rgb("+A+","+s+","+i+")"},nc=function(r,t,i,s){return(r<<24|t<<16|i<<8|Math.round(s*255)<<0)>>>0},lv=function(r,t){if(r.type===17)return r.number;if(r.type===16){var i=t===3?1:255;return t===3?r.number/100*i:Math.round(r.number/100*i)}return 0},cv=function(r,t){var i=t.filter(Ru);if(i.length===3){var s=i.map(lv),A=s[0],o=s[1],g=s[2];return nc(A,o,g,1)}if(i.length===4){var d=i.map(lv),A=d[0],o=d[1],g=d[2],C=d[3];return nc(A,o,g,C)}return 0};uv=function(r,t){var i=t.filter(Ru),s=i[0],A=i[1],o=i[2],g=i[3],d=(s.type===17?Ba(s.number):ep.parse(r,s))/(Math.PI*2),C=Xn(A)?A.number/100:0,v=Xn(o)?o.number/100:0,x=typeof g<"u"&&Xn(g)?ln(g,1):1;if(C===0)return nc(v*255,v*255,v*255,1);var T=v<=.5?v*(C+1):v+C-v*C,G=v*2-T,k=aC(G,T,d+1/3),W=aC(G,T,d),K=aC(G,T,d-1/3);return nc(k*255,W*255,K*255,x)},W4={hsl:uv,hsla:uv,rgb:cv,rgba:cv},eg=function(r,t){return sc.parse(r,o2.create(t).parseComponentValue())},bl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},O4={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(r,t){return t.map(function(i){if($r(i))switch(i.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},z4={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},ip=function(r,t){var i=sc.parse(r,t[0]),s=t[1];return s&&Xn(s)?{color:i,stop:s}:{color:i,stop:null}},hv=function(r,t){var i=r[0],s=r[r.length-1];i.stop===null&&(i.stop=Qs),s.stop===null&&(s.stop=rc);for(var A=[],o=0,g=0;g<r.length;g++){var d=r[g].stop;if(d!==null){var C=ln(d,t);C>o?A.push(C):A.push(o),o=C}else A.push(null)}for(var v=null,g=0;g<A.length;g++){var x=A[g];if(x===null)v===null&&(v=g);else if(v!==null){for(var T=g-v,G=A[v-1],k=(x-G)/(T+1),W=1;W<=T;W++)A[v+W-1]=k*W;v=null}}return r.map(function(K,$){var O=K.color;return{color:O,stop:Math.max(Math.min(1,A[$]/t),0)}})},J4=function(r,t,i){var s=t/2,A=i/2,o=ln(r[0],t)-s,g=A-ln(r[1],i);return(Math.atan2(g,o)+Math.PI*2)%(Math.PI*2)},X4=function(r,t,i){var s=typeof r=="number"?r:J4(r,t,i),A=Math.abs(t*Math.sin(s))+Math.abs(i*Math.cos(s)),o=t/2,g=i/2,d=A/2,C=Math.sin(s-Math.PI/2)*d,v=Math.cos(s-Math.PI/2)*d;return[A,o-v,o+v,g-C,g+C]},qa=function(r,t){return Math.sqrt(r*r+t*t)},gv=function(r,t,i,s,A){var o=[[0,0],[0,t],[r,0],[r,t]];return o.reduce(function(g,d){var C=d[0],v=d[1],x=qa(i-C,s-v);return(A?x<g.optimumDistance:x>g.optimumDistance)?{optimumCorner:d,optimumDistance:x}:g},{optimumDistance:A?1/0:-1/0,optimumCorner:null}).optimumCorner},Y4=function(r,t,i,s,A){var o=0,g=0;switch(r.size){case 0:r.shape===0?o=g=Math.min(Math.abs(t),Math.abs(t-s),Math.abs(i),Math.abs(i-A)):r.shape===1&&(o=Math.min(Math.abs(t),Math.abs(t-s)),g=Math.min(Math.abs(i),Math.abs(i-A)));break;case 2:if(r.shape===0)o=g=Math.min(qa(t,i),qa(t,i-A),qa(t-s,i),qa(t-s,i-A));else if(r.shape===1){var d=Math.min(Math.abs(i),Math.abs(i-A))/Math.min(Math.abs(t),Math.abs(t-s)),C=gv(s,A,t,i,!0),v=C[0],x=C[1];o=qa(v-t,(x-i)/d),g=d*o}break;case 1:r.shape===0?o=g=Math.max(Math.abs(t),Math.abs(t-s),Math.abs(i),Math.abs(i-A)):r.shape===1&&(o=Math.max(Math.abs(t),Math.abs(t-s)),g=Math.max(Math.abs(i),Math.abs(i-A)));break;case 3:if(r.shape===0)o=g=Math.max(qa(t,i),qa(t,i-A),qa(t-s,i),qa(t-s,i-A));else if(r.shape===1){var d=Math.max(Math.abs(i),Math.abs(i-A))/Math.max(Math.abs(t),Math.abs(t-s)),T=gv(s,A,t,i,!1),v=T[0],x=T[1];o=qa(v-t,(x-i)/d),g=d*o}break}return Array.isArray(r.size)&&(o=ln(r.size[0],s),g=r.size.length===2?ln(r.size[1],A):o),[o,g]},j4=function(r,t){var i=Ba(180),s=[];return KA(t).forEach(function(A,o){if(o===0){var g=A[0];if(g.type===20&&g.value==="to"){i=d2(A);return}else if(g2(g)){i=ep.parse(r,g);return}}var d=ip(r,A);s.push(d)}),{angle:i,stops:s,type:1}},Qd=function(r,t){var i=Ba(180),s=[];return KA(t).forEach(function(A,o){if(o===0){var g=A[0];if(g.type===20&&["top","left","right","bottom"].indexOf(g.value)!==-1){i=d2(A);return}else if(g2(g)){i=(ep.parse(r,g)+Ba(270))%Ba(360);return}}var d=ip(r,A);s.push(d)}),{angle:i,stops:s,type:1}},q4=function(r,t){var i=Ba(180),s=[],A=1,o=0,g=3,d=[];return KA(t).forEach(function(C,v){var x=C[0];if(v===0){if($r(x)&&x.value==="linear"){A=1;return}else if($r(x)&&x.value==="radial"){A=2;return}}if(x.type===18){if(x.name==="from"){var T=sc.parse(r,x.values[0]);s.push({stop:Qs,color:T})}else if(x.name==="to"){var T=sc.parse(r,x.values[0]);s.push({stop:rc,color:T})}else if(x.name==="color-stop"){var G=x.values.filter(Ru);if(G.length===2){var T=sc.parse(r,G[1]),k=G[0];Hu(k)&&s.push({stop:{type:16,number:k.number*100,flags:k.flags},color:T})}}}}),A===1?{angle:(i+Ba(180))%Ba(360),stops:s,type:A}:{size:g,shape:o,stops:s,position:d,type:A}},p2="closest-side",f2="farthest-side",m2="closest-corner",C2="farthest-corner",I2="circle",y2="ellipse",b2="cover",v2="contain",$4=function(r,t){var i=0,s=3,A=[],o=[];return KA(t).forEach(function(g,d){var C=!0;if(d===0){var v=!1;C=g.reduce(function(T,G){if(v)if($r(G))switch(G.value){case"center":return o.push(KC),T;case"top":case"left":return o.push(Qs),T;case"right":case"bottom":return o.push(rc),T}else(Xn(G)||ac(G))&&o.push(G);else if($r(G))switch(G.value){case I2:return i=0,!1;case y2:return i=1,!1;case"at":return v=!0,!1;case p2:return s=0,!1;case b2:case f2:return s=1,!1;case v2:case m2:return s=2,!1;case C2:return s=3,!1}else if(ac(G)||Xn(G))return Array.isArray(s)||(s=[]),s.push(G),!1;return T},C)}if(C){var x=ip(r,g);A.push(x)}}),{size:s,shape:i,stops:A,position:o,type:2}},Ud=function(r,t){var i=0,s=3,A=[],o=[];return KA(t).forEach(function(g,d){var C=!0;if(d===0?C=g.reduce(function(x,T){if($r(T))switch(T.value){case"center":return o.push(KC),!1;case"top":case"left":return o.push(Qs),!1;case"right":case"bottom":return o.push(rc),!1}else if(Xn(T)||ac(T))return o.push(T),!1;return x},C):d===1&&(C=g.reduce(function(x,T){if($r(T))switch(T.value){case I2:return i=0,!1;case y2:return i=1,!1;case v2:case p2:return s=0,!1;case f2:return s=1,!1;case m2:return s=2,!1;case b2:case C2:return s=3,!1}else if(ac(T)||Xn(T))return Array.isArray(s)||(s=[]),s.push(T),!1;return x},C)),C){var v=ip(r,g);A.push(v)}}),{size:s,shape:i,stops:A,position:o,type:2}},tk=function(r){return r.type===1},ek=function(r){return r.type===2},WC={name:"image",parse:function(r,t){if(t.type===22){var i={url:t.value,type:0};return r.cache.addImage(t.value),i}if(t.type===18){var s=w2[t.name];if(typeof s>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return s(r,t.values)}throw new Error("Unsupported image type "+t.type)}};w2={"linear-gradient":j4,"-moz-linear-gradient":Qd,"-ms-linear-gradient":Qd,"-o-linear-gradient":Qd,"-webkit-linear-gradient":Qd,"radial-gradient":$4,"-moz-radial-gradient":Ud,"-ms-radial-gradient":Ud,"-o-radial-gradient":Ud,"-webkit-radial-gradient":Ud,"-webkit-gradient":q4},rk={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(r,t){if(t.length===0)return[];var i=t[0];return i.type===20&&i.value==="none"?[]:t.filter(function(s){return Ru(s)&&ik(s)}).map(function(s){return WC.parse(r,s)})}},nk={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(r,t){return t.map(function(i){if($r(i))switch(i.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},sk={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(r,t){return KA(t).map(function(i){return i.filter(Xn)}).map(A2)}},ok={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(r,t){return KA(t).map(function(i){return i.filter($r).map(function(s){return s.value}).join(" ")}).map(ak)}},ak=function(r){switch(r){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}};(function(r){r.AUTO="auto",r.CONTAIN="contain",r.COVER="cover"})(Gu||(Gu={}));Ak={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(r,t){return KA(t).map(function(i){return i.filter(lk)})}},lk=function(r){return $r(r)||Xn(r)},rp=function(r){return{name:"border-"+r+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},ck=rp("top"),uk=rp("right"),hk=rp("bottom"),gk=rp("left"),np=function(r){return{name:"border-radius-"+r,initialValue:"0 0",prefix:!1,type:1,parse:function(t,i){return A2(i.filter(Xn))}}},dk=np("top-left"),pk=np("top-right"),fk=np("bottom-right"),mk=np("bottom-left"),sp=function(r){return{name:"border-"+r+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,i){switch(i){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Ck=sp("top"),Ik=sp("right"),yk=sp("bottom"),bk=sp("left"),op=function(r){return{name:"border-"+r+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,i){return lg(i)?i.number:0}}},vk=op("top"),wk=op("right"),Bk=op("bottom"),_k=op("left"),xk={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Sk={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(r,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},Fk={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(r,t){return t.filter($r).reduce(function(i,s){return i|kk(s.value)},0)}},kk=function(r){switch(r){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Lk={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Ek={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(r,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}};(function(r){r.NORMAL="normal",r.STRICT="strict"})(Wd||(Wd={}));Tk={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"strict":return Wd.STRICT;case"normal":default:return Wd.NORMAL}}},Qk={name:"line-height",initialValue:"normal",prefix:!1,type:4},dv=function(r,t){return $r(r)&&r.value==="normal"?1.2*t:r.type===17?t*r.number:Xn(r)?ln(r,t):t},Uk={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(r,t){return t.type===20&&t.value==="none"?null:WC.parse(r,t)}},Gk={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(r,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},UC={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},ap=function(r){return{name:"margin-"+r,initialValue:"0",prefix:!1,type:4}},Rk=ap("top"),Hk=ap("right"),Zk=ap("bottom"),Pk=ap("left"),Mk={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(r,t){return t.filter($r).map(function(i){switch(i.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Nk={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Ap=function(r){return{name:"padding-"+r,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Vk=Ap("top"),Dk=Ap("right"),Kk=Ap("bottom"),Wk=Ap("left"),Ok={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(r,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},zk={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(r,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Jk={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.length===1&&QC(t[0],"none")?[]:KA(t).map(function(i){for(var s={color:bl.TRANSPARENT,offsetX:Qs,offsetY:Qs,blur:Qs},A=0,o=0;o<i.length;o++){var g=i[o];ac(g)?(A===0?s.offsetX=g:A===1?s.offsetY=g:s.blur=g,A++):s.color=sc.parse(r,g)}return s})}},Xk={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Yk={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(r,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var i=$k[t.name];if(typeof i>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return i(t.values)}return null}},jk=function(r){var t=r.filter(function(i){return i.type===17}).map(function(i){return i.number});return t.length===6?t:null},qk=function(r){var t=r.filter(function(C){return C.type===17}).map(function(C){return C.number}),i=t[0],s=t[1];t[2],t[3];var A=t[4],o=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var g=t[12],d=t[13];return t[14],t[15],t.length===16?[i,s,A,o,g,d]:null},$k={matrix:jk,matrix3d:qk},pv={type:16,number:50,flags:Ag},tL=[pv,pv],eL={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(r,t){var i=t.filter(Xn);return i.length!==2?tL:[i[0],i[1]]}},iL={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(r,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}};(function(r){r.NORMAL="normal",r.BREAK_ALL="break-all",r.KEEP_ALL="keep-all"})(ig||(ig={}));rL={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"break-all":return ig.BREAK_ALL;case"keep-all":return ig.KEEP_ALL;case"normal":default:return ig.NORMAL}}},nL={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(r,t){if(t.type===20)return{auto:!0,order:0};if(Hu(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},B2={name:"time",parse:function(r,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},sL={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(r,t){return Hu(t)?t.number:1}},oL={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},aL={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(r,t){return t.filter($r).map(function(i){switch(i.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(i){return i!==0})}},AL={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(r,t){var i=[],s=[];return t.forEach(function(A){switch(A.type){case 20:case 0:i.push(A.value);break;case 17:i.push(A.number.toString());break;case 4:s.push(i.join(" ")),i.length=0;break}}),i.length&&s.push(i.join(" ")),s.map(function(A){return A.indexOf(" ")===-1?A:"'"+A+"'"})}},lL={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},cL={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(r,t){if(Hu(t))return t.number;if($r(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},uL={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.filter($r).map(function(i){return i.value})}},hL={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(r,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},as=function(r,t){return(r&t)!==0},gL={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(r,t){if(t.length===0)return[];var i=t[0];return i.type===20&&i.value==="none"?[]:t}},dL={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return null;var i=t[0];if(i.type===20&&i.value==="none")return null;for(var s=[],A=t.filter(a2),o=0;o<A.length;o++){var g=A[o],d=A[o+1];if(g.type===20){var C=d&&Hu(d)?d.number:1;s.push({counter:g.value,increment:C})}}return s}},pL={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return[];for(var i=[],s=t.filter(a2),A=0;A<s.length;A++){var o=s[A],g=s[A+1];if($r(o)&&o.value!=="none"){var d=g&&Hu(g)?g.number:0;i.push({counter:o.value,reset:d})}}return i}},fL={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(r,t){return t.filter(lg).map(function(i){return B2.parse(r,i)})}},mL={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(r,t){if(t.length===0)return null;var i=t[0];if(i.type===20&&i.value==="none")return null;var s=[],A=t.filter(D4);if(A.length%2!==0)return null;for(var o=0;o<A.length;o+=2){var g=A[o].value,d=A[o+1].value;s.push({open:g,close:d})}return s}},fv=function(r,t,i){if(!r)return"";var s=r[Math.min(t,r.length-1)];return s?i?s.open:s.close:""},CL={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(r,t){return t.length===1&&QC(t[0],"none")?[]:KA(t).map(function(i){for(var s={color:255,offsetX:Qs,offsetY:Qs,blur:Qs,spread:Qs,inset:!1},A=0,o=0;o<i.length;o++){var g=i[o];QC(g,"inset")?s.inset=!0:ac(g)?(A===0?s.offsetX=g:A===1?s.offsetY=g:A===2?s.blur=g:s.spread=g,A++):s.color=sc.parse(r,g)}return s})}},IL={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(r,t){var i=[0,1,2],s=[];return t.filter($r).forEach(function(A){switch(A.value){case"stroke":s.push(1);break;case"fill":s.push(0);break;case"markers":s.push(2);break}}),i.forEach(function(A){s.indexOf(A)===-1&&s.push(A)}),s}},yL={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},bL={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(r,t){return lg(t)?t.number:0}},vL=function(){function r(t,i){var s,A;this.animationDuration=_i(t,fL,i.animationDuration),this.backgroundClip=_i(t,O4,i.backgroundClip),this.backgroundColor=_i(t,z4,i.backgroundColor),this.backgroundImage=_i(t,rk,i.backgroundImage),this.backgroundOrigin=_i(t,nk,i.backgroundOrigin),this.backgroundPosition=_i(t,sk,i.backgroundPosition),this.backgroundRepeat=_i(t,ok,i.backgroundRepeat),this.backgroundSize=_i(t,Ak,i.backgroundSize),this.borderTopColor=_i(t,ck,i.borderTopColor),this.borderRightColor=_i(t,uk,i.borderRightColor),this.borderBottomColor=_i(t,hk,i.borderBottomColor),this.borderLeftColor=_i(t,gk,i.borderLeftColor),this.borderTopLeftRadius=_i(t,dk,i.borderTopLeftRadius),this.borderTopRightRadius=_i(t,pk,i.borderTopRightRadius),this.borderBottomRightRadius=_i(t,fk,i.borderBottomRightRadius),this.borderBottomLeftRadius=_i(t,mk,i.borderBottomLeftRadius),this.borderTopStyle=_i(t,Ck,i.borderTopStyle),this.borderRightStyle=_i(t,Ik,i.borderRightStyle),this.borderBottomStyle=_i(t,yk,i.borderBottomStyle),this.borderLeftStyle=_i(t,bk,i.borderLeftStyle),this.borderTopWidth=_i(t,vk,i.borderTopWidth),this.borderRightWidth=_i(t,wk,i.borderRightWidth),this.borderBottomWidth=_i(t,Bk,i.borderBottomWidth),this.borderLeftWidth=_i(t,_k,i.borderLeftWidth),this.boxShadow=_i(t,CL,i.boxShadow),this.color=_i(t,xk,i.color),this.direction=_i(t,Sk,i.direction),this.display=_i(t,Fk,i.display),this.float=_i(t,Lk,i.cssFloat),this.fontFamily=_i(t,AL,i.fontFamily),this.fontSize=_i(t,lL,i.fontSize),this.fontStyle=_i(t,hL,i.fontStyle),this.fontVariant=_i(t,uL,i.fontVariant),this.fontWeight=_i(t,cL,i.fontWeight),this.letterSpacing=_i(t,Ek,i.letterSpacing),this.lineBreak=_i(t,Tk,i.lineBreak),this.lineHeight=_i(t,Qk,i.lineHeight),this.listStyleImage=_i(t,Uk,i.listStyleImage),this.listStylePosition=_i(t,Gk,i.listStylePosition),this.listStyleType=_i(t,UC,i.listStyleType),this.marginTop=_i(t,Rk,i.marginTop),this.marginRight=_i(t,Hk,i.marginRight),this.marginBottom=_i(t,Zk,i.marginBottom),this.marginLeft=_i(t,Pk,i.marginLeft),this.opacity=_i(t,sL,i.opacity);var o=_i(t,Mk,i.overflow);this.overflowX=o[0],this.overflowY=o[o.length>1?1:0],this.overflowWrap=_i(t,Nk,i.overflowWrap),this.paddingTop=_i(t,Vk,i.paddingTop),this.paddingRight=_i(t,Dk,i.paddingRight),this.paddingBottom=_i(t,Kk,i.paddingBottom),this.paddingLeft=_i(t,Wk,i.paddingLeft),this.paintOrder=_i(t,IL,i.paintOrder),this.position=_i(t,zk,i.position),this.textAlign=_i(t,Ok,i.textAlign),this.textDecorationColor=_i(t,oL,(s=i.textDecorationColor)!==null&&s!==void 0?s:i.color),this.textDecorationLine=_i(t,aL,(A=i.textDecorationLine)!==null&&A!==void 0?A:i.textDecoration),this.textShadow=_i(t,Jk,i.textShadow),this.textTransform=_i(t,Xk,i.textTransform),this.transform=_i(t,Yk,i.transform),this.transformOrigin=_i(t,eL,i.transformOrigin),this.visibility=_i(t,iL,i.visibility),this.webkitTextStrokeColor=_i(t,yL,i.webkitTextStrokeColor),this.webkitTextStrokeWidth=_i(t,bL,i.webkitTextStrokeWidth),this.wordBreak=_i(t,rL,i.wordBreak),this.zIndex=_i(t,nL,i.zIndex)}return r.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},r.prototype.isTransparent=function(){return oc(this.backgroundColor)},r.prototype.isTransformed=function(){return this.transform!==null},r.prototype.isPositioned=function(){return this.position!==0},r.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},r.prototype.isFloating=function(){return this.float!==0},r.prototype.isInlineLevel=function(){return as(this.display,4)||as(this.display,33554432)||as(this.display,268435456)||as(this.display,536870912)||as(this.display,67108864)||as(this.display,134217728)},r}(),wL=function(){function r(t,i){this.content=_i(t,gL,i.content),this.quotes=_i(t,mL,i.quotes)}return r}(),mv=function(){function r(t,i){this.counterIncrement=_i(t,dL,i.counterIncrement),this.counterReset=_i(t,pL,i.counterReset)}return r}(),_i=function(r,t,i){var s=new s2,A=i!==null&&typeof i<"u"?i.toString():t.initialValue;s.write(A);var o=new o2(s.read());switch(t.type){case 2:var g=o.parseComponentValue();return t.parse(r,$r(g)?g.value:t.initialValue);case 0:return t.parse(r,o.parseComponentValue());case 1:return t.parse(r,o.parseComponentValues());case 4:return o.parseComponentValue();case 3:switch(t.format){case"angle":return ep.parse(r,o.parseComponentValue());case"color":return sc.parse(r,o.parseComponentValue());case"image":return WC.parse(r,o.parseComponentValue());case"length":var d=o.parseComponentValue();return ac(d)?d:Qs;case"length-percentage":var C=o.parseComponentValue();return Xn(C)?C:Qs;case"time":return B2.parse(r,o.parseComponentValue())}break}},BL="data-html2canvas-debug",_L=function(r){var t=r.getAttribute(BL);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},GC=function(r,t){var i=_L(r);return i===1||t===i},WA=function(){function r(t,i){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,GC(i,3))debugger;this.styles=new vL(t,window.getComputedStyle(i,null)),ZC(i)&&(this.styles.animationDuration.some(function(s){return s>0})&&(i.style.animationDuration="0s"),this.styles.transform!==null&&(i.style.transform="none")),this.bounds=$d(this.context,i),GC(i,4)&&(this.flags|=16)}return r}(),xL="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",Cv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Wh=0;Wh<Cv.length;Wh++)qh[Cv.charCodeAt(Wh)]=Wh;SL=function(r){var t=r.length*.75,i=r.length,s,A=0,o,g,d,C;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);var v=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),x=Array.isArray(v)?v:new Uint8Array(v);for(s=0;s<i;s+=4)o=qh[r.charCodeAt(s)],g=qh[r.charCodeAt(s+1)],d=qh[r.charCodeAt(s+2)],C=qh[r.charCodeAt(s+3)],x[A++]=o<<2|g>>4,x[A++]=(g&15)<<4|d>>2,x[A++]=(d&3)<<6|C&63;return v},FL=function(r){for(var t=r.length,i=[],s=0;s<t;s+=2)i.push(r[s+1]<<8|r[s]);return i},kL=function(r){for(var t=r.length,i=[],s=0;s<t;s+=4)i.push(r[s+3]<<24|r[s+2]<<16|r[s+1]<<8|r[s]);return i},Zc=5,OC=11,AC=2,LL=OC-Zc,_2=65536>>Zc,EL=1<<Zc,lC=EL-1,TL=1024>>Zc,QL=_2+TL,UL=QL,GL=32,RL=UL+GL,HL=65536>>OC,ZL=1<<LL,PL=ZL-1,Iv=function(r,t,i){return r.slice?r.slice(t,i):new Uint16Array(Array.prototype.slice.call(r,t,i))},ML=function(r,t,i){return r.slice?r.slice(t,i):new Uint32Array(Array.prototype.slice.call(r,t,i))},NL=function(r,t){var i=SL(r),s=Array.isArray(i)?kL(i):new Uint32Array(i),A=Array.isArray(i)?FL(i):new Uint16Array(i),o=24,g=Iv(A,o/2,s[4]/2),d=s[5]===2?Iv(A,(o+s[4])/2):ML(s,Math.ceil((o+s[4])/4));return new VL(s[0],s[1],s[2],s[3],g,d)},VL=function(){function r(t,i,s,A,o,g){this.initialValue=t,this.errorValue=i,this.highStart=s,this.highValueIndex=A,this.index=o,this.data=g}return r.prototype.get=function(t){var i;if(t>=0){if(t<55296||t>56319&&t<=65535)return i=this.index[t>>Zc],i=(i<<AC)+(t&lC),this.data[i];if(t<=65535)return i=this.index[_2+(t-55296>>Zc)],i=(i<<AC)+(t&lC),this.data[i];if(t<this.highStart)return i=RL-HL+(t>>OC),i=this.index[i],i+=t>>Zc&PL,i=this.index[i],i=(i<<AC)+(t&lC),this.data[i];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},r}(),yv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",DL=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Oh=0;Oh<yv.length;Oh++)DL[yv.charCodeAt(Oh)]=Oh;KL=1,cC=2,uC=3,bv=4,vv=5,WL=7,wv=8,hC=9,gC=10,Bv=11,_v=12,xv=13,Sv=14,dC=15,OL=function(r){for(var t=[],i=0,s=r.length;i<s;){var A=r.charCodeAt(i++);if(A>=55296&&A<=56319&&i<s){var o=r.charCodeAt(i++);(o&64512)===56320?t.push(((A&1023)<<10)+(o&1023)+65536):(t.push(A),i--)}else t.push(A)}return t},zL=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,r);var i=r.length;if(!i)return"";for(var s=[],A=-1,o="";++A<i;){var g=r[A];g<=65535?s.push(g):(g-=65536,s.push((g>>10)+55296,g%1024+56320)),(A+1===i||s.length>16384)&&(o+=String.fromCharCode.apply(String,s),s.length=0)}return o},JL=NL(xL),Rc="\xD7",Fv="\xF7",XL=function(r){return JL.get(r)},YL=function(r,t,i){var s=i-2,A=t[s],o=t[i-1],g=t[i];if(o===cC&&g===uC)return Rc;if(o===cC||o===uC||o===bv||g===cC||g===uC||g===bv)return Fv;if(o===wv&&[wv,hC,Bv,_v].indexOf(g)!==-1||(o===Bv||o===hC)&&(g===hC||g===gC)||(o===_v||o===gC)&&g===gC||g===xv||g===vv||g===WL||o===KL)return Rc;if(o===xv&&g===Sv){for(;A===vv;)A=t[--s];if(A===Sv)return Rc}if(o===dC&&g===dC){for(var d=0;A===dC;)d++,A=t[--s];if(d%2===0)return Rc}return Fv},jL=function(r){var t=OL(r),i=t.length,s=0,A=0,o=t.map(XL);return{next:function(){if(s>=i)return{done:!0,value:null};for(var g=Rc;s<i&&(g=YL(t,o,++s))===Rc;);if(g!==Rc||s===i){var d=zL.apply(null,t.slice(A,s));return A=s,{value:d,done:!1}}return{done:!0,value:null}}}},qL=function(r){for(var t=jL(r),i=[],s;!(s=t.next()).done;)s.value&&i.push(s.value.slice());return i},$L=function(r){var t=123;if(r.createRange){var i=r.createRange();if(i.getBoundingClientRect){var s=r.createElement("boundtest");s.style.height=t+"px",s.style.display="block",r.body.appendChild(s),i.selectNode(s);var A=i.getBoundingClientRect(),o=Math.round(A.height);if(r.body.removeChild(s),o===t)return!0}}return!1},tE=function(r){var t=r.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",r.body.appendChild(t);var i=r.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var s=t.firstChild,A=tp(s.data).map(function(C){return Gn(C)}),o=0,g={},d=A.every(function(C,v){i.setStart(s,o),i.setEnd(s,o+C.length);var x=i.getBoundingClientRect();o+=C.length;var T=x.x>g.x||x.y>g.y;return g=x,v===0?!0:T});return r.body.removeChild(t),d},eE=function(){return typeof new Image().crossOrigin<"u"},iE=function(){return typeof new XMLHttpRequest().responseType=="string"},rE=function(r){var t=new Image,i=r.createElement("canvas"),s=i.getContext("2d");if(!s)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{s.drawImage(t,0,0),i.toDataURL()}catch{return!1}return!0},kv=function(r){return r[0]===0&&r[1]===255&&r[2]===0&&r[3]===255},nE=function(r){var t=r.createElement("canvas"),i=100;t.width=i,t.height=i;var s=t.getContext("2d");if(!s)return Promise.reject(!1);s.fillStyle="rgb(0, 255, 0)",s.fillRect(0,0,i,i);var A=new Image,o=t.toDataURL();A.src=o;var g=RC(i,i,0,0,A);return s.fillStyle="red",s.fillRect(0,0,i,i),Lv(g).then(function(d){s.drawImage(d,0,0);var C=s.getImageData(0,0,i,i).data;s.fillStyle="red",s.fillRect(0,0,i,i);var v=r.createElement("div");return v.style.backgroundImage="url("+o+")",v.style.height=i+"px",kv(C)?Lv(RC(i,i,0,0,v)):Promise.reject(!1)}).then(function(d){return s.drawImage(d,0,0),kv(s.getImageData(0,0,i,i).data)}).catch(function(){return!1})},RC=function(r,t,i,s,A){var o="http://www.w3.org/2000/svg",g=document.createElementNS(o,"svg"),d=document.createElementNS(o,"foreignObject");return g.setAttributeNS(null,"width",r.toString()),g.setAttributeNS(null,"height",t.toString()),d.setAttributeNS(null,"width","100%"),d.setAttributeNS(null,"height","100%"),d.setAttributeNS(null,"x",i.toString()),d.setAttributeNS(null,"y",s.toString()),d.setAttributeNS(null,"externalResourcesRequired","true"),g.appendChild(d),d.appendChild(A),g},Lv=function(r){return new Promise(function(t,i){var s=new Image;s.onload=function(){return t(s)},s.onerror=i,s.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},Ts={get SUPPORT_RANGE_BOUNDS(){var r=$L(document);return Object.defineProperty(Ts,"SUPPORT_RANGE_BOUNDS",{value:r}),r},get SUPPORT_WORD_BREAKING(){var r=Ts.SUPPORT_RANGE_BOUNDS&&tE(document);return Object.defineProperty(Ts,"SUPPORT_WORD_BREAKING",{value:r}),r},get SUPPORT_SVG_DRAWING(){var r=rE(document);return Object.defineProperty(Ts,"SUPPORT_SVG_DRAWING",{value:r}),r},get SUPPORT_FOREIGNOBJECT_DRAWING(){var r=typeof Array.from=="function"&&typeof window.fetch=="function"?nE(document):Promise.resolve(!1);return Object.defineProperty(Ts,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:r}),r},get SUPPORT_CORS_IMAGES(){var r=eE();return Object.defineProperty(Ts,"SUPPORT_CORS_IMAGES",{value:r}),r},get SUPPORT_RESPONSE_TYPE(){var r=iE();return Object.defineProperty(Ts,"SUPPORT_RESPONSE_TYPE",{value:r}),r},get SUPPORT_CORS_XHR(){var r="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ts,"SUPPORT_CORS_XHR",{value:r}),r},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var r=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Ts,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:r}),r}},rg=function(){function r(t,i){this.text=t,this.bounds=i}return r}(),sE=function(r,t,i,s){var A=AE(t,i),o=[],g=0;return A.forEach(function(d){if(i.textDecorationLine.length||d.trim().length>0)if(Ts.SUPPORT_RANGE_BOUNDS){var C=Ev(s,g,d.length).getClientRects();if(C.length>1){var v=zC(d),x=0;v.forEach(function(G){o.push(new rg(G,vl.fromDOMRectList(r,Ev(s,x+g,G.length).getClientRects()))),x+=G.length})}else o.push(new rg(d,vl.fromDOMRectList(r,C)))}else{var T=s.splitText(d.length);o.push(new rg(d,oE(r,s))),s=T}else Ts.SUPPORT_RANGE_BOUNDS||(s=s.splitText(d.length));g+=d.length}),o},oE=function(r,t){var i=t.ownerDocument;if(i){var s=i.createElement("html2canvaswrapper");s.appendChild(t.cloneNode(!0));var A=t.parentNode;if(A){A.replaceChild(s,t);var o=$d(r,s);return s.firstChild&&A.replaceChild(s.firstChild,s),o}}return vl.EMPTY},Ev=function(r,t,i){var s=r.ownerDocument;if(!s)throw new Error("Node has no owner document");var A=s.createRange();return A.setStart(r,t),A.setEnd(r,t+i),A},zC=function(r){if(Ts.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(r)).map(function(i){return i.segment})}return qL(r)},aE=function(r,t){if(Ts.SUPPORT_NATIVE_TEXT_SEGMENTATION){var i=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(i.segment(r)).map(function(s){return s.segment})}return cE(r,t)},AE=function(r,t){return t.letterSpacing!==0?zC(r):aE(r,t)},lE=[32,160,4961,65792,65793,4153,4241],cE=function(r,t){for(var i=HF(r,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),s=[],A,o=function(){if(A.value){var g=A.value.slice(),d=tp(g),C="";d.forEach(function(v){lE.indexOf(v)===-1?C+=Gn(v):(C.length&&s.push(C),s.push(Gn(v)),C="")}),C.length&&s.push(C)}};!(A=i.next()).done;)o();return s},uE=function(){function r(t,i,s){this.text=hE(i.data,s.textTransform),this.textBounds=sE(t,this.text,s,i)}return r}(),hE=function(r,t){switch(t){case 1:return r.toLowerCase();case 3:return r.replace(gE,dE);case 2:return r.toUpperCase();default:return r}},gE=/(^|\s|:|-|\(|\))([a-z])/g,dE=function(r,t,i){return r.length>0?t+i.toUpperCase():r},x2=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this;return A.src=s.currentSrc||s.src,A.intrinsicWidth=s.naturalWidth,A.intrinsicHeight=s.naturalHeight,A.context.cache.addImage(A.src),A}return t}(WA),S2=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this;return A.canvas=s,A.intrinsicWidth=s.width,A.intrinsicHeight=s.height,A}return t}(WA),F2=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this,o=new XMLSerializer,g=$d(i,s);return s.setAttribute("width",g.width+"px"),s.setAttribute("height",g.height+"px"),A.svg="data:image/svg+xml,"+encodeURIComponent(o.serializeToString(s)),A.intrinsicWidth=s.width.baseVal.value,A.intrinsicHeight=s.height.baseVal.value,A.context.cache.addImage(A.svg),A}return t}(WA),k2=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this;return A.value=s.value,A}return t}(WA),HC=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this;return A.start=s.start,A.reversed=typeof s.reversed=="boolean"&&s.reversed===!0,A}return t}(WA),pE=[{type:15,flags:0,unit:"px",number:3}],fE=[{type:16,flags:0,number:50}],mE=function(r){return r.width>r.height?new vl(r.left+(r.width-r.height)/2,r.top,r.height,r.height):r.width<r.height?new vl(r.left,r.top+(r.height-r.width)/2,r.width,r.width):r},CE=function(r){var t=r.type===IE?new Array(r.value.length+1).join("\u2022"):r.value;return t.length===0?r.placeholder||"":t},Od="checkbox",zd="radio",IE="password",Tv=707406591,JC=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this;switch(A.type=s.type.toLowerCase(),A.checked=s.checked,A.value=CE(s),(A.type===Od||A.type===zd)&&(A.styles.backgroundColor=3739148031,A.styles.borderTopColor=A.styles.borderRightColor=A.styles.borderBottomColor=A.styles.borderLeftColor=2779096575,A.styles.borderTopWidth=A.styles.borderRightWidth=A.styles.borderBottomWidth=A.styles.borderLeftWidth=1,A.styles.borderTopStyle=A.styles.borderRightStyle=A.styles.borderBottomStyle=A.styles.borderLeftStyle=1,A.styles.backgroundClip=[0],A.styles.backgroundOrigin=[0],A.bounds=mE(A.bounds)),A.type){case Od:A.styles.borderTopRightRadius=A.styles.borderTopLeftRadius=A.styles.borderBottomRightRadius=A.styles.borderBottomLeftRadius=pE;break;case zd:A.styles.borderTopRightRadius=A.styles.borderTopLeftRadius=A.styles.borderBottomRightRadius=A.styles.borderBottomLeftRadius=fE;break}return A}return t}(WA),L2=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this,o=s.options[s.selectedIndex||0];return A.value=o&&o.text||"",A}return t}(WA),E2=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this;return A.value=s.value,A}return t}(WA),T2=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this;A.src=s.src,A.width=parseInt(s.width,10)||0,A.height=parseInt(s.height,10)||0,A.backgroundColor=A.styles.backgroundColor;try{if(s.contentWindow&&s.contentWindow.document&&s.contentWindow.document.documentElement){A.tree=U2(i,s.contentWindow.document.documentElement);var o=s.contentWindow.document.documentElement?eg(i,getComputedStyle(s.contentWindow.document.documentElement).backgroundColor):bl.TRANSPARENT,g=s.contentWindow.document.body?eg(i,getComputedStyle(s.contentWindow.document.body).backgroundColor):bl.TRANSPARENT;A.backgroundColor=oc(o)?oc(g)?A.styles.backgroundColor:g:o}}catch{}return A}return t}(WA),yE=["OL","UL","MENU"],Nd=function(r,t,i,s){for(var A=t.firstChild,o=void 0;A;A=o)if(o=A.nextSibling,G2(A)&&A.data.trim().length>0)i.textNodes.push(new uE(r,A,i.styles));else if(Uu(A))if(P2(A)&&A.assignedNodes)A.assignedNodes().forEach(function(d){return Nd(r,d,i,s)});else{var g=Q2(r,A);g.styles.isVisible()&&(bE(A,g,s)?g.flags|=4:vE(g.styles)&&(g.flags|=2),yE.indexOf(A.tagName)!==-1&&(g.flags|=8),i.elements.push(g),A.slot,A.shadowRoot?Nd(r,A.shadowRoot,g,s):!Jd(A)&&!R2(A)&&!Xd(A)&&Nd(r,A,g,s))}},Q2=function(r,t){return PC(t)?new x2(r,t):H2(t)?new S2(r,t):R2(t)?new F2(r,t):wE(t)?new k2(r,t):BE(t)?new HC(r,t):_E(t)?new JC(r,t):Xd(t)?new L2(r,t):Jd(t)?new E2(r,t):Z2(t)?new T2(r,t):new WA(r,t)},U2=function(r,t){var i=Q2(r,t);return i.flags|=4,Nd(r,t,i,i),i},bE=function(r,t,i){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||XC(r)&&i.styles.isTransparent()},vE=function(r){return r.isPositioned()||r.isFloating()},G2=function(r){return r.nodeType===Node.TEXT_NODE},Uu=function(r){return r.nodeType===Node.ELEMENT_NODE},ZC=function(r){return Uu(r)&&typeof r.style<"u"&&!Vd(r)},Vd=function(r){return typeof r.className=="object"},wE=function(r){return r.tagName==="LI"},BE=function(r){return r.tagName==="OL"},_E=function(r){return r.tagName==="INPUT"},xE=function(r){return r.tagName==="HTML"},R2=function(r){return r.tagName==="svg"},XC=function(r){return r.tagName==="BODY"},H2=function(r){return r.tagName==="CANVAS"},Qv=function(r){return r.tagName==="VIDEO"},PC=function(r){return r.tagName==="IMG"},Z2=function(r){return r.tagName==="IFRAME"},Uv=function(r){return r.tagName==="STYLE"},SE=function(r){return r.tagName==="SCRIPT"},Jd=function(r){return r.tagName==="TEXTAREA"},Xd=function(r){return r.tagName==="SELECT"},P2=function(r){return r.tagName==="SLOT"},Gv=function(r){return r.tagName.indexOf("-")>0},FE=function(){function r(){this.counters={}}return r.prototype.getCounterValue=function(t){var i=this.counters[t];return i&&i.length?i[i.length-1]:1},r.prototype.getCounterValues=function(t){var i=this.counters[t];return i||[]},r.prototype.pop=function(t){var i=this;t.forEach(function(s){return i.counters[s].pop()})},r.prototype.parse=function(t){var i=this,s=t.counterIncrement,A=t.counterReset,o=!0;s!==null&&s.forEach(function(d){var C=i.counters[d.counter];C&&d.increment!==0&&(o=!1,C.length||C.push(1),C[Math.max(0,C.length-1)]+=d.increment)});var g=[];return o&&A.forEach(function(d){var C=i.counters[d.counter];g.push(d.counter),C||(C=i.counters[d.counter]=[]),C.push(d.reset)}),g},r}(),Rv={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Hv={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},kE={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},LE={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},Fu=function(r,t,i,s,A,o){return r<t||r>i?ag(r,A,o.length>0):s.integers.reduce(function(g,d,C){for(;r>=d;)r-=d,g+=s.values[C];return g},"")+o},M2=function(r,t,i,s){var A="";do i||r--,A=s(r)+A,r/=t;while(r*t>=t);return A},Un=function(r,t,i,s,A){var o=i-t+1;return(r<0?"-":"")+(M2(Math.abs(r),o,s,function(g){return Gn(Math.floor(g%o)+t)})+A)},Uc=function(r,t,i){i===void 0&&(i=". ");var s=t.length;return M2(Math.abs(r),s,!1,function(A){return t[Math.floor(A%s)]})+i},Eu=1,$l=2,tc=4,$h=8,yl=function(r,t,i,s,A,o){if(r<-9999||r>9999)return ag(r,4,A.length>0);var g=Math.abs(r),d=A;if(g===0)return t[0]+d;for(var C=0;g>0&&C<=4;C++){var v=g%10;v===0&&as(o,Eu)&&d!==""?d=t[v]+d:v>1||v===1&&C===0||v===1&&C===1&&as(o,$l)||v===1&&C===1&&as(o,tc)&&r>100||v===1&&C>1&&as(o,$h)?d=t[v]+(C>0?i[C-1]:"")+d:v===1&&C>0&&(d=i[C-1]+d),g=Math.floor(g/10)}return(r<0?s:"")+d},Zv="\u5341\u767E\u5343\u842C",Pv="\u62FE\u4F70\u4EDF\u842C",Mv="\u30DE\u30A4\u30CA\u30B9",pC="\uB9C8\uC774\uB108\uC2A4",ag=function(r,t,i){var s=i?". ":"",A=i?"\u3001":"",o=i?", ":"",g=i?" ":"";switch(t){case 0:return"\u2022"+g;case 1:return"\u25E6"+g;case 2:return"\u25FE"+g;case 5:var d=Un(r,48,57,!0,s);return d.length<4?"0"+d:d;case 4:return Uc(r,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",A);case 6:return Fu(r,1,3999,Rv,3,s).toLowerCase();case 7:return Fu(r,1,3999,Rv,3,s);case 8:return Un(r,945,969,!1,s);case 9:return Un(r,97,122,!1,s);case 10:return Un(r,65,90,!1,s);case 11:return Un(r,1632,1641,!0,s);case 12:case 49:return Fu(r,1,9999,Hv,3,s);case 35:return Fu(r,1,9999,Hv,3,s).toLowerCase();case 13:return Un(r,2534,2543,!0,s);case 14:case 30:return Un(r,6112,6121,!0,s);case 15:return Uc(r,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",A);case 16:return Uc(r,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",A);case 17:case 48:return yl(r,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Zv,"\u8CA0",A,$l|tc|$h);case 47:return yl(r,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",Pv,"\u8CA0",A,Eu|$l|tc|$h);case 42:return yl(r,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Zv,"\u8D1F",A,$l|tc|$h);case 41:return yl(r,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",Pv,"\u8D1F",A,Eu|$l|tc|$h);case 26:return yl(r,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",Mv,A,0);case 25:return yl(r,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",Mv,A,Eu|$l|tc);case 31:return yl(r,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",pC,o,Eu|$l|tc);case 33:return yl(r,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",pC,o,0);case 32:return yl(r,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",pC,o,Eu|$l|tc);case 18:return Un(r,2406,2415,!0,s);case 20:return Fu(r,1,19999,LE,3,s);case 21:return Un(r,2790,2799,!0,s);case 22:return Un(r,2662,2671,!0,s);case 22:return Fu(r,1,10999,kE,3,s);case 23:return Uc(r,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case 24:return Uc(r,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case 27:return Un(r,3302,3311,!0,s);case 28:return Uc(r,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",A);case 29:return Uc(r,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",A);case 34:return Un(r,3792,3801,!0,s);case 37:return Un(r,6160,6169,!0,s);case 38:return Un(r,4160,4169,!0,s);case 39:return Un(r,2918,2927,!0,s);case 40:return Un(r,1776,1785,!0,s);case 43:return Un(r,3046,3055,!0,s);case 44:return Un(r,3174,3183,!0,s);case 45:return Un(r,3664,3673,!0,s);case 46:return Un(r,3872,3881,!0,s);case 3:default:return Un(r,48,57,!0,s)}},N2="data-html2canvas-ignore",Nv=function(){function r(t,i,s){if(this.context=t,this.options=s,this.scrolledElements=[],this.referenceElement=i,this.counters=new FE,this.quoteDepth=0,!i.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(i.ownerDocument.documentElement,!1)}return r.prototype.toIFrame=function(t,i){var s=this,A=EE(t,i);if(!A.contentWindow)return Promise.reject("Unable to find iframe window");var o=t.defaultView.pageXOffset,g=t.defaultView.pageYOffset,d=A.contentWindow,C=d.document,v=UE(A).then(function(){return Co(s,void 0,void 0,function(){var x,T;return Js(this,function(G){switch(G.label){case 0:return this.scrolledElements.forEach(ZE),d&&(d.scrollTo(i.left,i.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(d.scrollY!==i.top||d.scrollX!==i.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(d.scrollX-i.left,d.scrollY-i.top,0,0))),x=this.options.onclone,T=this.clonedReferenceElement,typeof T>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:C.fonts&&C.fonts.ready?[4,C.fonts.ready]:[3,2];case 1:G.sent(),G.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,QE(C)]:[3,4];case 3:G.sent(),G.label=4;case 4:return typeof x=="function"?[2,Promise.resolve().then(function(){return x(C,T)}).then(function(){return A})]:[2,A]}})})});return C.open(),C.write(RE(document.doctype)+"<html></html>"),HE(this.referenceElement.ownerDocument,o,g),C.replaceChild(C.adoptNode(this.documentElement),C.documentElement),C.close(),v},r.prototype.createElementClone=function(t){if(GC(t,2))debugger;if(H2(t))return this.createCanvasClone(t);if(Qv(t))return this.createVideoClone(t);if(Uv(t))return this.createStyleClone(t);var i=t.cloneNode(!1);return PC(i)&&(PC(t)&&t.currentSrc&&t.currentSrc!==t.src&&(i.src=t.currentSrc,i.srcset=""),i.loading==="lazy"&&(i.loading="eager")),Gv(i)?this.createCustomElementClone(i):i},r.prototype.createCustomElementClone=function(t){var i=document.createElement("html2canvascustomelement");return fC(t.style,i),i},r.prototype.createStyleClone=function(t){try{var i=t.sheet;if(i&&i.cssRules){var s=[].slice.call(i.cssRules,0).reduce(function(o,g){return g&&typeof g.cssText=="string"?o+g.cssText:o},""),A=t.cloneNode(!1);return A.textContent=s,A}}catch(o){if(this.context.logger.error("Unable to access cssRules property",o),o.name!=="SecurityError")throw o}return t.cloneNode(!1)},r.prototype.createCanvasClone=function(t){var i;if(this.options.inlineImages&&t.ownerDocument){var s=t.ownerDocument.createElement("img");try{return s.src=t.toDataURL(),s}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var A=t.cloneNode(!1);try{A.width=t.width,A.height=t.height;var o=t.getContext("2d"),g=A.getContext("2d");if(g)if(!this.options.allowTaint&&o)g.putImageData(o.getImageData(0,0,t.width,t.height),0,0);else{var d=(i=t.getContext("webgl2"))!==null&&i!==void 0?i:t.getContext("webgl");if(d){var C=d.getContextAttributes();C?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}g.drawImage(t,0,0)}return A}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return A},r.prototype.createVideoClone=function(t){var i=t.ownerDocument.createElement("canvas");i.width=t.offsetWidth,i.height=t.offsetHeight;var s=i.getContext("2d");try{return s&&(s.drawImage(t,0,0,i.width,i.height),this.options.allowTaint||s.getImageData(0,0,i.width,i.height)),i}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var A=t.ownerDocument.createElement("canvas");return A.width=t.offsetWidth,A.height=t.offsetHeight,A},r.prototype.appendChildNode=function(t,i,s){(!Uu(i)||!SE(i)&&!i.hasAttribute(N2)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(i)))&&(!this.options.copyStyles||!Uu(i)||!Uv(i))&&t.appendChild(this.cloneNode(i,s))},r.prototype.cloneChildNodes=function(t,i,s){for(var A=this,o=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;o;o=o.nextSibling)if(Uu(o)&&P2(o)&&typeof o.assignedNodes=="function"){var g=o.assignedNodes();g.length&&g.forEach(function(d){return A.appendChildNode(i,d,s)})}else this.appendChildNode(i,o,s)},r.prototype.cloneNode=function(t,i){if(G2(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var s=t.ownerDocument.defaultView;if(s&&Uu(t)&&(ZC(t)||Vd(t))){var A=this.createElementClone(t);A.style.transitionProperty="none";var o=s.getComputedStyle(t),g=s.getComputedStyle(t,":before"),d=s.getComputedStyle(t,":after");this.referenceElement===t&&ZC(A)&&(this.clonedReferenceElement=A),XC(A)&&NE(A);var C=this.counters.parse(new mv(this.context,o)),v=this.resolvePseudoContent(t,A,g,ng.BEFORE);Gv(t)&&(i=!0),Qv(t)||this.cloneChildNodes(t,A,i),v&&A.insertBefore(v,A.firstChild);var x=this.resolvePseudoContent(t,A,d,ng.AFTER);return x&&A.appendChild(x),this.counters.pop(C),(o&&(this.options.copyStyles||Vd(t))&&!Z2(t)||i)&&fC(o,A),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([A,t.scrollLeft,t.scrollTop]),(Jd(t)||Xd(t))&&(Jd(A)||Xd(A))&&(A.value=t.value),A}return t.cloneNode(!1)},r.prototype.resolvePseudoContent=function(t,i,s,A){var o=this;if(s){var g=s.content,d=i.ownerDocument;if(!(!d||!g||g==="none"||g==="-moz-alt-content"||s.display==="none")){this.counters.parse(new mv(this.context,s));var C=new wL(this.context,s),v=d.createElement("html2canvaspseudoelement");fC(s,v),C.content.forEach(function(T){if(T.type===0)v.appendChild(d.createTextNode(T.value));else if(T.type===22){var G=d.createElement("img");G.src=T.value,G.style.opacity="1",v.appendChild(G)}else if(T.type===18){if(T.name==="attr"){var k=T.values.filter($r);k.length&&v.appendChild(d.createTextNode(t.getAttribute(k[0].value)||""))}else if(T.name==="counter"){var W=T.values.filter(Ru),K=W[0],$=W[1];if(K&&$r(K)){var O=o.counters.getCounterValue(K.value),tt=$&&$r($)?UC.parse(o.context,$.value):3;v.appendChild(d.createTextNode(ag(O,tt,!1)))}}else if(T.name==="counters"){var at=T.values.filter(Ru),K=at[0],Lt=at[1],$=at[2];if(K&&$r(K)){var Tt=o.counters.getCounterValues(K.value),Qt=$&&$r($)?UC.parse(o.context,$.value):3,Ft=Lt&&Lt.type===0?Lt.value:"",vt=Tt.map(function(At){return ag(At,Qt,!1)}).join(Ft);v.appendChild(d.createTextNode(vt))}}}else if(T.type===20)switch(T.value){case"open-quote":v.appendChild(d.createTextNode(fv(C.quotes,o.quoteDepth++,!0)));break;case"close-quote":v.appendChild(d.createTextNode(fv(C.quotes,--o.quoteDepth,!1)));break;default:v.appendChild(d.createTextNode(T.value))}}),v.className=MC+" "+NC;var x=A===ng.BEFORE?" "+MC:" "+NC;return Vd(i)?i.className.baseValue+=x:i.className+=x,v}}},r.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},r}();(function(r){r[r.BEFORE=0]="BEFORE",r[r.AFTER=1]="AFTER"})(ng||(ng={}));EE=function(r,t){var i=r.createElement("iframe");return i.className="html2canvas-container",i.style.visibility="hidden",i.style.position="fixed",i.style.left="-10000px",i.style.top="0px",i.style.border="0",i.width=t.width.toString(),i.height=t.height.toString(),i.scrolling="no",i.setAttribute(N2,"true"),r.body.appendChild(i),i},TE=function(r){return new Promise(function(t){if(r.complete){t();return}if(!r.src){t();return}r.onload=t,r.onerror=t})},QE=function(r){return Promise.all([].slice.call(r.images,0).map(TE))},UE=function(r){return new Promise(function(t,i){var s=r.contentWindow;if(!s)return i("No window assigned for iframe");var A=s.document;s.onload=r.onload=function(){s.onload=r.onload=null;var o=setInterval(function(){A.body.childNodes.length>0&&A.readyState==="complete"&&(clearInterval(o),t(r))},50)}})},GE=["all","d","content"],fC=function(r,t){for(var i=r.length-1;i>=0;i--){var s=r.item(i);GE.indexOf(s)===-1&&t.style.setProperty(s,r.getPropertyValue(s))}return t},RE=function(r){var t="";return r&&(t+="<!DOCTYPE ",r.name&&(t+=r.name),r.internalSubset&&(t+=r.internalSubset),r.publicId&&(t+='"'+r.publicId+'"'),r.systemId&&(t+='"'+r.systemId+'"'),t+=">"),t},HE=function(r,t,i){r&&r.defaultView&&(t!==r.defaultView.pageXOffset||i!==r.defaultView.pageYOffset)&&r.defaultView.scrollTo(t,i)},ZE=function(r){var t=r[0],i=r[1],s=r[2];t.scrollLeft=i,t.scrollTop=s},PE=":before",ME=":after",MC="___html2canvas___pseudoelement_before",NC="___html2canvas___pseudoelement_after",Vv=`{
    content: "" !important;
    display: none !important;
}`,NE=function(r){VE(r,"."+MC+PE+Vv+`
         .`+NC+ME+Vv)},VE=function(r,t){var i=r.ownerDocument;if(i){var s=i.createElement("style");s.textContent=t,r.appendChild(s)}},V2=function(){function r(){}return r.getOrigin=function(t){var i=r._link;return i?(i.href=t,i.href=i.href,i.protocol+i.hostname+i.port):"about:blank"},r.isSameOrigin=function(t){return r.getOrigin(t)===r._origin},r.setContext=function(t){r._link=t.document.createElement("a"),r._origin=r.getOrigin(t.location.href)},r._origin="about:blank",r}(),DE=function(){function r(t,i){this.context=t,this._options=i,this._cache={}}return r.prototype.addImage=function(t){var i=Promise.resolve();return this.has(t)||(CC(t)||zE(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),i},r.prototype.match=function(t){return this._cache[t]},r.prototype.loadImage=function(t){return Co(this,void 0,void 0,function(){var i,s,A,o,g=this;return Js(this,function(d){switch(d.label){case 0:return i=V2.isSameOrigin(t),s=!mC(t)&&this._options.useCORS===!0&&Ts.SUPPORT_CORS_IMAGES&&!i,A=!mC(t)&&!i&&!CC(t)&&typeof this._options.proxy=="string"&&Ts.SUPPORT_CORS_XHR&&!s,!i&&this._options.allowTaint===!1&&!mC(t)&&!CC(t)&&!A&&!s?[2]:(o=t,A?[4,this.proxy(o)]:[3,2]);case 1:o=d.sent(),d.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(C,v){var x=new Image;x.onload=function(){return C(x)},x.onerror=v,(JE(o)||s)&&(x.crossOrigin="anonymous"),x.src=o,x.complete===!0&&setTimeout(function(){return C(x)},500),g._options.imageTimeout>0&&setTimeout(function(){return v("Timed out ("+g._options.imageTimeout+"ms) loading image")},g._options.imageTimeout)})];case 3:return[2,d.sent()]}})})},r.prototype.has=function(t){return typeof this._cache[t]<"u"},r.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},r.prototype.proxy=function(t){var i=this,s=this._options.proxy;if(!s)throw new Error("No proxy defined");var A=t.substring(0,256);return new Promise(function(o,g){var d=Ts.SUPPORT_RESPONSE_TYPE?"blob":"text",C=new XMLHttpRequest;C.onload=function(){if(C.status===200)if(d==="text")o(C.response);else{var T=new FileReader;T.addEventListener("load",function(){return o(T.result)},!1),T.addEventListener("error",function(G){return g(G)},!1),T.readAsDataURL(C.response)}else g("Failed to proxy resource "+A+" with status code "+C.status)},C.onerror=g;var v=s.indexOf("?")>-1?"&":"?";if(C.open("GET",""+s+v+"url="+encodeURIComponent(t)+"&responseType="+d),d!=="text"&&C instanceof XMLHttpRequest&&(C.responseType=d),i._options.imageTimeout){var x=i._options.imageTimeout;C.timeout=x,C.ontimeout=function(){return g("Timed out ("+x+"ms) proxying "+A)}}C.send()})},r}(),KE=/^data:image\/svg\+xml/i,WE=/^data:image\/.*;base64,/i,OE=/^data:image\/.*/i,zE=function(r){return Ts.SUPPORT_SVG_DRAWING||!XE(r)},mC=function(r){return OE.test(r)},JE=function(r){return WE.test(r)},CC=function(r){return r.substr(0,4)==="blob"},XE=function(r){return r.substr(-3).toLowerCase()==="svg"||KE.test(r)},yi=function(){function r(t,i){this.type=0,this.x=t,this.y=i}return r.prototype.add=function(t,i){return new r(this.x+t,this.y+i)},r}(),ku=function(r,t,i){return new yi(r.x+(t.x-r.x)*i,r.y+(t.y-r.y)*i)},Gd=function(){function r(t,i,s,A){this.type=1,this.start=t,this.startControl=i,this.endControl=s,this.end=A}return r.prototype.subdivide=function(t,i){var s=ku(this.start,this.startControl,t),A=ku(this.startControl,this.endControl,t),o=ku(this.endControl,this.end,t),g=ku(s,A,t),d=ku(A,o,t),C=ku(g,d,t);return i?new r(this.start,s,g,C):new r(C,d,o,this.end)},r.prototype.add=function(t,i){return new r(this.start.add(t,i),this.startControl.add(t,i),this.endControl.add(t,i),this.end.add(t,i))},r.prototype.reverse=function(){return new r(this.end,this.endControl,this.startControl,this.start)},r}(),wa=function(r){return r.type===1},YE=function(){function r(t){var i=t.styles,s=t.bounds,A=jh(i.borderTopLeftRadius,s.width,s.height),o=A[0],g=A[1],d=jh(i.borderTopRightRadius,s.width,s.height),C=d[0],v=d[1],x=jh(i.borderBottomRightRadius,s.width,s.height),T=x[0],G=x[1],k=jh(i.borderBottomLeftRadius,s.width,s.height),W=k[0],K=k[1],$=[];$.push((o+C)/s.width),$.push((W+T)/s.width),$.push((g+K)/s.height),$.push((v+G)/s.height);var O=Math.max.apply(Math,$);O>1&&(o/=O,g/=O,C/=O,v/=O,T/=O,G/=O,W/=O,K/=O);var tt=s.width-C,at=s.height-G,Lt=s.width-T,Tt=s.height-K,Qt=i.borderTopWidth,Ft=i.borderRightWidth,vt=i.borderBottomWidth,Jt=i.borderLeftWidth,qt=ln(i.paddingTop,t.bounds.width),At=ln(i.paddingRight,t.bounds.width),lt=ln(i.paddingBottom,t.bounds.width),kt=ln(i.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=o>0||g>0?Cn(s.left+Jt/3,s.top+Qt/3,o-Jt/3,g-Qt/3,Wr.TOP_LEFT):new yi(s.left+Jt/3,s.top+Qt/3),this.topRightBorderDoubleOuterBox=o>0||g>0?Cn(s.left+tt,s.top+Qt/3,C-Ft/3,v-Qt/3,Wr.TOP_RIGHT):new yi(s.left+s.width-Ft/3,s.top+Qt/3),this.bottomRightBorderDoubleOuterBox=T>0||G>0?Cn(s.left+Lt,s.top+at,T-Ft/3,G-vt/3,Wr.BOTTOM_RIGHT):new yi(s.left+s.width-Ft/3,s.top+s.height-vt/3),this.bottomLeftBorderDoubleOuterBox=W>0||K>0?Cn(s.left+Jt/3,s.top+Tt,W-Jt/3,K-vt/3,Wr.BOTTOM_LEFT):new yi(s.left+Jt/3,s.top+s.height-vt/3),this.topLeftBorderDoubleInnerBox=o>0||g>0?Cn(s.left+Jt*2/3,s.top+Qt*2/3,o-Jt*2/3,g-Qt*2/3,Wr.TOP_LEFT):new yi(s.left+Jt*2/3,s.top+Qt*2/3),this.topRightBorderDoubleInnerBox=o>0||g>0?Cn(s.left+tt,s.top+Qt*2/3,C-Ft*2/3,v-Qt*2/3,Wr.TOP_RIGHT):new yi(s.left+s.width-Ft*2/3,s.top+Qt*2/3),this.bottomRightBorderDoubleInnerBox=T>0||G>0?Cn(s.left+Lt,s.top+at,T-Ft*2/3,G-vt*2/3,Wr.BOTTOM_RIGHT):new yi(s.left+s.width-Ft*2/3,s.top+s.height-vt*2/3),this.bottomLeftBorderDoubleInnerBox=W>0||K>0?Cn(s.left+Jt*2/3,s.top+Tt,W-Jt*2/3,K-vt*2/3,Wr.BOTTOM_LEFT):new yi(s.left+Jt*2/3,s.top+s.height-vt*2/3),this.topLeftBorderStroke=o>0||g>0?Cn(s.left+Jt/2,s.top+Qt/2,o-Jt/2,g-Qt/2,Wr.TOP_LEFT):new yi(s.left+Jt/2,s.top+Qt/2),this.topRightBorderStroke=o>0||g>0?Cn(s.left+tt,s.top+Qt/2,C-Ft/2,v-Qt/2,Wr.TOP_RIGHT):new yi(s.left+s.width-Ft/2,s.top+Qt/2),this.bottomRightBorderStroke=T>0||G>0?Cn(s.left+Lt,s.top+at,T-Ft/2,G-vt/2,Wr.BOTTOM_RIGHT):new yi(s.left+s.width-Ft/2,s.top+s.height-vt/2),this.bottomLeftBorderStroke=W>0||K>0?Cn(s.left+Jt/2,s.top+Tt,W-Jt/2,K-vt/2,Wr.BOTTOM_LEFT):new yi(s.left+Jt/2,s.top+s.height-vt/2),this.topLeftBorderBox=o>0||g>0?Cn(s.left,s.top,o,g,Wr.TOP_LEFT):new yi(s.left,s.top),this.topRightBorderBox=C>0||v>0?Cn(s.left+tt,s.top,C,v,Wr.TOP_RIGHT):new yi(s.left+s.width,s.top),this.bottomRightBorderBox=T>0||G>0?Cn(s.left+Lt,s.top+at,T,G,Wr.BOTTOM_RIGHT):new yi(s.left+s.width,s.top+s.height),this.bottomLeftBorderBox=W>0||K>0?Cn(s.left,s.top+Tt,W,K,Wr.BOTTOM_LEFT):new yi(s.left,s.top+s.height),this.topLeftPaddingBox=o>0||g>0?Cn(s.left+Jt,s.top+Qt,Math.max(0,o-Jt),Math.max(0,g-Qt),Wr.TOP_LEFT):new yi(s.left+Jt,s.top+Qt),this.topRightPaddingBox=C>0||v>0?Cn(s.left+Math.min(tt,s.width-Ft),s.top+Qt,tt>s.width+Ft?0:Math.max(0,C-Ft),Math.max(0,v-Qt),Wr.TOP_RIGHT):new yi(s.left+s.width-Ft,s.top+Qt),this.bottomRightPaddingBox=T>0||G>0?Cn(s.left+Math.min(Lt,s.width-Jt),s.top+Math.min(at,s.height-vt),Math.max(0,T-Ft),Math.max(0,G-vt),Wr.BOTTOM_RIGHT):new yi(s.left+s.width-Ft,s.top+s.height-vt),this.bottomLeftPaddingBox=W>0||K>0?Cn(s.left+Jt,s.top+Math.min(Tt,s.height-vt),Math.max(0,W-Jt),Math.max(0,K-vt),Wr.BOTTOM_LEFT):new yi(s.left+Jt,s.top+s.height-vt),this.topLeftContentBox=o>0||g>0?Cn(s.left+Jt+kt,s.top+Qt+qt,Math.max(0,o-(Jt+kt)),Math.max(0,g-(Qt+qt)),Wr.TOP_LEFT):new yi(s.left+Jt+kt,s.top+Qt+qt),this.topRightContentBox=C>0||v>0?Cn(s.left+Math.min(tt,s.width+Jt+kt),s.top+Qt+qt,tt>s.width+Jt+kt?0:C-Jt+kt,v-(Qt+qt),Wr.TOP_RIGHT):new yi(s.left+s.width-(Ft+At),s.top+Qt+qt),this.bottomRightContentBox=T>0||G>0?Cn(s.left+Math.min(Lt,s.width-(Jt+kt)),s.top+Math.min(at,s.height+Qt+qt),Math.max(0,T-(Ft+At)),G-(vt+lt),Wr.BOTTOM_RIGHT):new yi(s.left+s.width-(Ft+At),s.top+s.height-(vt+lt)),this.bottomLeftContentBox=W>0||K>0?Cn(s.left+Jt+kt,s.top+Tt,Math.max(0,W-(Jt+kt)),K-(vt+lt),Wr.BOTTOM_LEFT):new yi(s.left+Jt+kt,s.top+s.height-(vt+lt))}return r}();(function(r){r[r.TOP_LEFT=0]="TOP_LEFT",r[r.TOP_RIGHT=1]="TOP_RIGHT",r[r.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",r[r.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Wr||(Wr={}));Cn=function(r,t,i,s,A){var o=4*((Math.sqrt(2)-1)/3),g=i*o,d=s*o,C=r+i,v=t+s;switch(A){case Wr.TOP_LEFT:return new Gd(new yi(r,v),new yi(r,v-d),new yi(C-g,t),new yi(C,t));case Wr.TOP_RIGHT:return new Gd(new yi(r,t),new yi(r+g,t),new yi(C,v-d),new yi(C,v));case Wr.BOTTOM_RIGHT:return new Gd(new yi(C,t),new yi(C,t+d),new yi(r+g,v),new yi(r,v));case Wr.BOTTOM_LEFT:default:return new Gd(new yi(C,v),new yi(C-g,v),new yi(r,t+d),new yi(r,t))}},Yd=function(r){return[r.topLeftBorderBox,r.topRightBorderBox,r.bottomRightBorderBox,r.bottomLeftBorderBox]},jE=function(r){return[r.topLeftContentBox,r.topRightContentBox,r.bottomRightContentBox,r.bottomLeftContentBox]},jd=function(r){return[r.topLeftPaddingBox,r.topRightPaddingBox,r.bottomRightPaddingBox,r.bottomLeftPaddingBox]},qE=function(){function r(t,i,s){this.offsetX=t,this.offsetY=i,this.matrix=s,this.type=0,this.target=6}return r}(),Rd=function(){function r(t,i){this.path=t,this.target=i,this.type=1}return r}(),$E=function(){function r(t){this.opacity=t,this.type=2,this.target=6}return r}(),tT=function(r){return r.type===0},D2=function(r){return r.type===1},eT=function(r){return r.type===2},Dv=function(r,t){return r.length===t.length?r.some(function(i,s){return i===t[s]}):!1},iT=function(r,t,i,s,A){return r.map(function(o,g){switch(g){case 0:return o.add(t,i);case 1:return o.add(t+s,i);case 2:return o.add(t+s,i+A);case 3:return o.add(t,i+A)}return o})},K2=function(){function r(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return r}(),W2=function(){function r(t,i){if(this.container=t,this.parent=i,this.effects=[],this.curves=new YE(this.container),this.container.styles.opacity<1&&this.effects.push(new $E(this.container.styles.opacity)),this.container.styles.transform!==null){var s=this.container.bounds.left+this.container.styles.transformOrigin[0].number,A=this.container.bounds.top+this.container.styles.transformOrigin[1].number,o=this.container.styles.transform;this.effects.push(new qE(s,A,o))}if(this.container.styles.overflowX!==0){var g=Yd(this.curves),d=jd(this.curves);Dv(g,d)?this.effects.push(new Rd(g,6)):(this.effects.push(new Rd(g,2)),this.effects.push(new Rd(d,4)))}}return r.prototype.getEffects=function(t){for(var i=[2,3].indexOf(this.container.styles.position)===-1,s=this.parent,A=this.effects.slice(0);s;){var o=s.effects.filter(function(C){return!D2(C)});if(i||s.container.styles.position!==0||!s.parent){if(A.unshift.apply(A,o),i=[2,3].indexOf(s.container.styles.position)===-1,s.container.styles.overflowX!==0){var g=Yd(s.curves),d=jd(s.curves);Dv(g,d)||A.unshift(new Rd(d,6))}}else A.unshift.apply(A,o);s=s.parent}return A.filter(function(C){return as(C.target,t)})},r}(),VC=function(r,t,i,s){r.container.elements.forEach(function(A){var o=as(A.flags,4),g=as(A.flags,2),d=new W2(A,r);as(A.styles.display,2048)&&s.push(d);var C=as(A.flags,8)?[]:s;if(o||g){var v=o||A.styles.isPositioned()?i:t,x=new K2(d);if(A.styles.isPositioned()||A.styles.opacity<1||A.styles.isTransformed()){var T=A.styles.zIndex.order;if(T<0){var G=0;v.negativeZIndex.some(function(W,K){return T>W.element.container.styles.zIndex.order?(G=K,!1):G>0}),v.negativeZIndex.splice(G,0,x)}else if(T>0){var k=0;v.positiveZIndex.some(function(W,K){return T>=W.element.container.styles.zIndex.order?(k=K+1,!1):k>0}),v.positiveZIndex.splice(k,0,x)}else v.zeroOrAutoZIndexOrTransformedOrOpacity.push(x)}else A.styles.isFloating()?v.nonPositionedFloats.push(x):v.nonPositionedInlineLevel.push(x);VC(d,x,o?x:i,C)}else A.styles.isInlineLevel()?t.inlineLevel.push(d):t.nonInlineLevel.push(d),VC(d,t,i,C);as(A.flags,8)&&O2(A,C)})},O2=function(r,t){for(var i=r instanceof HC?r.start:1,s=r instanceof HC?r.reversed:!1,A=0;A<t.length;A++){var o=t[A];o.container instanceof k2&&typeof o.container.value=="number"&&o.container.value!==0&&(i=o.container.value),o.listValue=ag(i,o.container.styles.listStyleType,!0),i+=s?-1:1}},rT=function(r){var t=new W2(r,null),i=new K2(t),s=[];return VC(t,i,i,s),O2(t.container,s),i},Kv=function(r,t){switch(t){case 0:return _a(r.topLeftBorderBox,r.topLeftPaddingBox,r.topRightBorderBox,r.topRightPaddingBox);case 1:return _a(r.topRightBorderBox,r.topRightPaddingBox,r.bottomRightBorderBox,r.bottomRightPaddingBox);case 2:return _a(r.bottomRightBorderBox,r.bottomRightPaddingBox,r.bottomLeftBorderBox,r.bottomLeftPaddingBox);case 3:default:return _a(r.bottomLeftBorderBox,r.bottomLeftPaddingBox,r.topLeftBorderBox,r.topLeftPaddingBox)}},nT=function(r,t){switch(t){case 0:return _a(r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox,r.topRightBorderBox,r.topRightBorderDoubleOuterBox);case 1:return _a(r.topRightBorderBox,r.topRightBorderDoubleOuterBox,r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox);case 2:return _a(r.bottomRightBorderBox,r.bottomRightBorderDoubleOuterBox,r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox);case 3:default:return _a(r.bottomLeftBorderBox,r.bottomLeftBorderDoubleOuterBox,r.topLeftBorderBox,r.topLeftBorderDoubleOuterBox)}},sT=function(r,t){switch(t){case 0:return _a(r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox,r.topRightBorderDoubleInnerBox,r.topRightPaddingBox);case 1:return _a(r.topRightBorderDoubleInnerBox,r.topRightPaddingBox,r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox);case 2:return _a(r.bottomRightBorderDoubleInnerBox,r.bottomRightPaddingBox,r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox);case 3:default:return _a(r.bottomLeftBorderDoubleInnerBox,r.bottomLeftPaddingBox,r.topLeftBorderDoubleInnerBox,r.topLeftPaddingBox)}},oT=function(r,t){switch(t){case 0:return Hd(r.topLeftBorderStroke,r.topRightBorderStroke);case 1:return Hd(r.topRightBorderStroke,r.bottomRightBorderStroke);case 2:return Hd(r.bottomRightBorderStroke,r.bottomLeftBorderStroke);case 3:default:return Hd(r.bottomLeftBorderStroke,r.topLeftBorderStroke)}},Hd=function(r,t){var i=[];return wa(r)?i.push(r.subdivide(.5,!1)):i.push(r),wa(t)?i.push(t.subdivide(.5,!0)):i.push(t),i},_a=function(r,t,i,s){var A=[];return wa(r)?A.push(r.subdivide(.5,!1)):A.push(r),wa(i)?A.push(i.subdivide(.5,!0)):A.push(i),wa(s)?A.push(s.subdivide(.5,!0).reverse()):A.push(s),wa(t)?A.push(t.subdivide(.5,!1).reverse()):A.push(t),A},z2=function(r){var t=r.bounds,i=r.styles;return t.add(i.borderLeftWidth,i.borderTopWidth,-(i.borderRightWidth+i.borderLeftWidth),-(i.borderTopWidth+i.borderBottomWidth))},qd=function(r){var t=r.styles,i=r.bounds,s=ln(t.paddingLeft,i.width),A=ln(t.paddingRight,i.width),o=ln(t.paddingTop,i.width),g=ln(t.paddingBottom,i.width);return i.add(s+t.borderLeftWidth,o+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+s+A),-(t.borderTopWidth+t.borderBottomWidth+o+g))},aT=function(r,t){return r===0?t.bounds:r===2?qd(t):z2(t)},AT=function(r,t){return r===0?t.bounds:r===2?qd(t):z2(t)},IC=function(r,t,i){var s=aT(Tu(r.styles.backgroundOrigin,t),r),A=AT(Tu(r.styles.backgroundClip,t),r),o=lT(Tu(r.styles.backgroundSize,t),i,s),g=o[0],d=o[1],C=jh(Tu(r.styles.backgroundPosition,t),s.width-g,s.height-d),v=cT(Tu(r.styles.backgroundRepeat,t),C,o,s,A),x=Math.round(s.left+C[0]),T=Math.round(s.top+C[1]);return[v,x,T,g,d]},Lu=function(r){return $r(r)&&r.value===Gu.AUTO},Zd=function(r){return typeof r=="number"},lT=function(r,t,i){var s=t[0],A=t[1],o=t[2],g=r[0],d=r[1];if(!g)return[0,0];if(Xn(g)&&d&&Xn(d))return[ln(g,i.width),ln(d,i.height)];var C=Zd(o);if($r(g)&&(g.value===Gu.CONTAIN||g.value===Gu.COVER)){if(Zd(o)){var v=i.width/i.height;return v<o!=(g.value===Gu.COVER)?[i.width,i.width/o]:[i.height*o,i.height]}return[i.width,i.height]}var x=Zd(s),T=Zd(A),G=x||T;if(Lu(g)&&(!d||Lu(d))){if(x&&T)return[s,A];if(!C&&!G)return[i.width,i.height];if(G&&C){var k=x?s:A*o,W=T?A:s/o;return[k,W]}var K=x?s:i.width,$=T?A:i.height;return[K,$]}if(C){var O=0,tt=0;return Xn(g)?O=ln(g,i.width):Xn(d)&&(tt=ln(d,i.height)),Lu(g)?O=tt*o:(!d||Lu(d))&&(tt=O/o),[O,tt]}var at=null,Lt=null;if(Xn(g)?at=ln(g,i.width):d&&Xn(d)&&(Lt=ln(d,i.height)),at!==null&&(!d||Lu(d))&&(Lt=x&&T?at/s*A:i.height),Lt!==null&&Lu(g)&&(at=x&&T?Lt/A*s:i.width),at!==null&&Lt!==null)return[at,Lt];throw new Error("Unable to calculate background-size for element")},Tu=function(r,t){var i=r[t];return typeof i>"u"?r[0]:i},cT=function(r,t,i,s,A){var o=t[0],g=t[1],d=i[0],C=i[1];switch(r){case 2:return[new yi(Math.round(s.left),Math.round(s.top+g)),new yi(Math.round(s.left+s.width),Math.round(s.top+g)),new yi(Math.round(s.left+s.width),Math.round(C+s.top+g)),new yi(Math.round(s.left),Math.round(C+s.top+g))];case 3:return[new yi(Math.round(s.left+o),Math.round(s.top)),new yi(Math.round(s.left+o+d),Math.round(s.top)),new yi(Math.round(s.left+o+d),Math.round(s.height+s.top)),new yi(Math.round(s.left+o),Math.round(s.height+s.top))];case 1:return[new yi(Math.round(s.left+o),Math.round(s.top+g)),new yi(Math.round(s.left+o+d),Math.round(s.top+g)),new yi(Math.round(s.left+o+d),Math.round(s.top+g+C)),new yi(Math.round(s.left+o),Math.round(s.top+g+C))];default:return[new yi(Math.round(A.left),Math.round(A.top)),new yi(Math.round(A.left+A.width),Math.round(A.top)),new yi(Math.round(A.left+A.width),Math.round(A.height+A.top)),new yi(Math.round(A.left),Math.round(A.height+A.top))]}},uT="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Wv="Hidden Text",hT=function(){function r(t){this._data={},this._document=t}return r.prototype.parseMetrics=function(t,i){var s=this._document.createElement("div"),A=this._document.createElement("img"),o=this._document.createElement("span"),g=this._document.body;s.style.visibility="hidden",s.style.fontFamily=t,s.style.fontSize=i,s.style.margin="0",s.style.padding="0",s.style.whiteSpace="nowrap",g.appendChild(s),A.src=uT,A.width=1,A.height=1,A.style.margin="0",A.style.padding="0",A.style.verticalAlign="baseline",o.style.fontFamily=t,o.style.fontSize=i,o.style.margin="0",o.style.padding="0",o.appendChild(this._document.createTextNode(Wv)),s.appendChild(o),s.appendChild(A);var d=A.offsetTop-o.offsetTop+2;s.removeChild(o),s.appendChild(this._document.createTextNode(Wv)),s.style.lineHeight="normal",A.style.verticalAlign="super";var C=A.offsetTop-s.offsetTop+2;return g.removeChild(s),{baseline:d,middle:C}},r.prototype.getMetrics=function(t,i){var s=t+" "+i;return typeof this._data[s]>"u"&&(this._data[s]=this.parseMetrics(t,i)),this._data[s]},r}(),J2=function(){function r(t,i){this.context=t,this.options=i}return r}(),gT=1e4,dT=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this;return A._activeEffects=[],A.canvas=s.canvas?s.canvas:document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),s.canvas||(A.canvas.width=Math.floor(s.width*s.scale),A.canvas.height=Math.floor(s.height*s.scale),A.canvas.style.width=s.width+"px",A.canvas.style.height=s.height+"px"),A.fontMetrics=new hT(document),A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-s.x,-s.y),A.ctx.textBaseline="bottom",A._activeEffects=[],A.context.logger.debug("Canvas renderer initialized ("+s.width+"x"+s.height+") with scale "+s.scale),A}return t.prototype.applyEffects=function(i){for(var s=this;this._activeEffects.length;)this.popEffect();i.forEach(function(A){return s.applyEffect(A)})},t.prototype.applyEffect=function(i){this.ctx.save(),eT(i)&&(this.ctx.globalAlpha=i.opacity),tT(i)&&(this.ctx.translate(i.offsetX,i.offsetY),this.ctx.transform(i.matrix[0],i.matrix[1],i.matrix[2],i.matrix[3],i.matrix[4],i.matrix[5]),this.ctx.translate(-i.offsetX,-i.offsetY)),D2(i)&&(this.path(i.path),this.ctx.clip()),this._activeEffects.push(i)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(i){return Co(this,void 0,void 0,function(){var s;return Js(this,function(A){switch(A.label){case 0:return s=i.element.container.styles,s.isVisible()?[4,this.renderStackContent(i)]:[3,2];case 1:A.sent(),A.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(i){return Co(this,void 0,void 0,function(){return Js(this,function(s){switch(s.label){case 0:if(as(i.container.flags,16))debugger;return i.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(i)]:[3,3];case 1:return s.sent(),[4,this.renderNodeContent(i)];case 2:s.sent(),s.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(i,s,A){var o=this;if(s===0)this.ctx.fillText(i.text,i.bounds.left,i.bounds.top+A);else{var g=zC(i.text);g.reduce(function(d,C){return o.ctx.fillText(C,d,i.bounds.top+A),d+o.ctx.measureText(C).width},i.bounds.left)}},t.prototype.createFontStyle=function(i){var s=i.fontVariant.filter(function(g){return g==="normal"||g==="small-caps"}).join(""),A=IT(i.fontFamily).join(", "),o=lg(i.fontSize)?""+i.fontSize.number+i.fontSize.unit:i.fontSize.number+"px";return[[i.fontStyle,s,i.fontWeight,o,A].join(" "),A,o]},t.prototype.renderTextNode=function(i,s){return Co(this,void 0,void 0,function(){var A,o,g,d,C,v,x,T,G=this;return Js(this,function(k){return A=this.createFontStyle(s),o=A[0],g=A[1],d=A[2],this.ctx.font=o,this.ctx.direction=s.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",C=this.fontMetrics.getMetrics(g,d),v=C.baseline,x=C.middle,T=s.paintOrder,i.textBounds.forEach(function(W){T.forEach(function(K){switch(K){case 0:G.ctx.fillStyle=ms(s.color),G.renderTextWithLetterSpacing(W,s.letterSpacing,v);var $=s.textShadow;$.length&&W.text.trim().length&&($.slice(0).reverse().forEach(function(O){G.ctx.shadowColor=ms(O.color),G.ctx.shadowOffsetX=O.offsetX.number*G.options.scale,G.ctx.shadowOffsetY=O.offsetY.number*G.options.scale,G.ctx.shadowBlur=O.blur.number,G.renderTextWithLetterSpacing(W,s.letterSpacing,v)}),G.ctx.shadowColor="",G.ctx.shadowOffsetX=0,G.ctx.shadowOffsetY=0,G.ctx.shadowBlur=0),s.textDecorationLine.length&&(G.ctx.fillStyle=ms(s.textDecorationColor||s.color),s.textDecorationLine.forEach(function(O){switch(O){case 1:G.ctx.fillRect(W.bounds.left,Math.round(W.bounds.top+v),W.bounds.width,1);break;case 2:G.ctx.fillRect(W.bounds.left,Math.round(W.bounds.top),W.bounds.width,1);break;case 3:G.ctx.fillRect(W.bounds.left,Math.ceil(W.bounds.top+x),W.bounds.width,1);break}}));break;case 1:s.webkitTextStrokeWidth&&W.text.trim().length&&(G.ctx.strokeStyle=ms(s.webkitTextStrokeColor),G.ctx.lineWidth=s.webkitTextStrokeWidth,G.ctx.lineJoin=window.chrome?"miter":"round",G.ctx.strokeText(W.text,W.bounds.left,W.bounds.top+v)),G.ctx.strokeStyle="",G.ctx.lineWidth=0,G.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(i,s,A){if(A&&i.intrinsicWidth>0&&i.intrinsicHeight>0){var o=qd(i),g=jd(s);this.path(g),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(A,0,0,i.intrinsicWidth,i.intrinsicHeight,o.left,o.top,o.width,o.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(i){return Co(this,void 0,void 0,function(){var s,A,o,g,d,C,tt,tt,v,x,T,G,Lt,k,W,Tt,K,$,O,tt,at,Lt,Tt;return Js(this,function(Qt){switch(Qt.label){case 0:this.applyEffects(i.getEffects(4)),s=i.container,A=i.curves,o=s.styles,g=0,d=s.textNodes,Qt.label=1;case 1:return g<d.length?(C=d[g],[4,this.renderTextNode(C,o)]):[3,4];case 2:Qt.sent(),Qt.label=3;case 3:return g++,[3,1];case 4:if(!(s instanceof x2))return[3,8];Qt.label=5;case 5:return Qt.trys.push([5,7,,8]),[4,this.context.cache.match(s.src)];case 6:return tt=Qt.sent(),this.renderReplacedElement(s,A,tt),[3,8];case 7:return Qt.sent(),this.context.logger.error("Error loading image "+s.src),[3,8];case 8:if(s instanceof S2&&this.renderReplacedElement(s,A,s.canvas),!(s instanceof F2))return[3,12];Qt.label=9;case 9:return Qt.trys.push([9,11,,12]),[4,this.context.cache.match(s.svg)];case 10:return tt=Qt.sent(),this.renderReplacedElement(s,A,tt),[3,12];case 11:return Qt.sent(),this.context.logger.error("Error loading svg "+s.svg.substring(0,255)),[3,12];case 12:return s instanceof T2&&s.tree?(v=new t(this.context,{scale:this.options.scale,backgroundColor:s.backgroundColor,x:0,y:0,width:s.width,height:s.height}),[4,v.render(s.tree)]):[3,14];case 13:x=Qt.sent(),s.width&&s.height&&this.ctx.drawImage(x,0,0,s.width,s.height,s.bounds.left,s.bounds.top,s.bounds.width,s.bounds.height),Qt.label=14;case 14:if(s instanceof JC&&(T=Math.min(s.bounds.width,s.bounds.height),s.type===Od?s.checked&&(this.ctx.save(),this.path([new yi(s.bounds.left+T*.39363,s.bounds.top+T*.79),new yi(s.bounds.left+T*.16,s.bounds.top+T*.5549),new yi(s.bounds.left+T*.27347,s.bounds.top+T*.44071),new yi(s.bounds.left+T*.39694,s.bounds.top+T*.5649),new yi(s.bounds.left+T*.72983,s.bounds.top+T*.23),new yi(s.bounds.left+T*.84,s.bounds.top+T*.34085),new yi(s.bounds.left+T*.39363,s.bounds.top+T*.79)]),this.ctx.fillStyle=ms(Tv),this.ctx.fill(),this.ctx.restore()):s.type===zd&&s.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(s.bounds.left+T/2,s.bounds.top+T/2,T/4,0,Math.PI*2,!0),this.ctx.fillStyle=ms(Tv),this.ctx.fill(),this.ctx.restore())),pT(s)&&s.value.length){switch(G=this.createFontStyle(o),Lt=G[0],k=G[1],W=this.fontMetrics.getMetrics(Lt,k).baseline,this.ctx.font=Lt,this.ctx.fillStyle=ms(o.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=mT(s.styles.textAlign),Tt=qd(s),K=0,s.styles.textAlign){case 1:K+=Tt.width/2;break;case 2:K+=Tt.width;break}$=Tt.add(K,0,0,-Tt.height/2+1),this.ctx.save(),this.path([new yi(Tt.left,Tt.top),new yi(Tt.left+Tt.width,Tt.top),new yi(Tt.left+Tt.width,Tt.top+Tt.height),new yi(Tt.left,Tt.top+Tt.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new rg(s.value,$),o.letterSpacing,W),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!as(s.styles.display,2048))return[3,20];if(s.styles.listStyleImage===null)return[3,19];if(O=s.styles.listStyleImage,O.type!==0)return[3,18];tt=void 0,at=O.url,Qt.label=15;case 15:return Qt.trys.push([15,17,,18]),[4,this.context.cache.match(at)];case 16:return tt=Qt.sent(),this.ctx.drawImage(tt,s.bounds.left-(tt.width+10),s.bounds.top),[3,18];case 17:return Qt.sent(),this.context.logger.error("Error loading list-style-image "+at),[3,18];case 18:return[3,20];case 19:i.listValue&&s.styles.listStyleType!==-1&&(Lt=this.createFontStyle(o)[0],this.ctx.font=Lt,this.ctx.fillStyle=ms(o.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Tt=new vl(s.bounds.left,s.bounds.top+ln(s.styles.paddingTop,s.bounds.width),s.bounds.width,dv(o.lineHeight,o.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new rg(i.listValue,Tt),o.letterSpacing,dv(o.lineHeight,o.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Qt.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(i){return Co(this,void 0,void 0,function(){var s,A,O,o,g,O,d,C,O,v,x,O,T,G,O,k,W,O,K,$,O;return Js(this,function(tt){switch(tt.label){case 0:if(as(i.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(i.element)];case 1:tt.sent(),s=0,A=i.negativeZIndex,tt.label=2;case 2:return s<A.length?(O=A[s],[4,this.renderStack(O)]):[3,5];case 3:tt.sent(),tt.label=4;case 4:return s++,[3,2];case 5:return[4,this.renderNodeContent(i.element)];case 6:tt.sent(),o=0,g=i.nonInlineLevel,tt.label=7;case 7:return o<g.length?(O=g[o],[4,this.renderNode(O)]):[3,10];case 8:tt.sent(),tt.label=9;case 9:return o++,[3,7];case 10:d=0,C=i.nonPositionedFloats,tt.label=11;case 11:return d<C.length?(O=C[d],[4,this.renderStack(O)]):[3,14];case 12:tt.sent(),tt.label=13;case 13:return d++,[3,11];case 14:v=0,x=i.nonPositionedInlineLevel,tt.label=15;case 15:return v<x.length?(O=x[v],[4,this.renderStack(O)]):[3,18];case 16:tt.sent(),tt.label=17;case 17:return v++,[3,15];case 18:T=0,G=i.inlineLevel,tt.label=19;case 19:return T<G.length?(O=G[T],[4,this.renderNode(O)]):[3,22];case 20:tt.sent(),tt.label=21;case 21:return T++,[3,19];case 22:k=0,W=i.zeroOrAutoZIndexOrTransformedOrOpacity,tt.label=23;case 23:return k<W.length?(O=W[k],[4,this.renderStack(O)]):[3,26];case 24:tt.sent(),tt.label=25;case 25:return k++,[3,23];case 26:K=0,$=i.positiveZIndex,tt.label=27;case 27:return K<$.length?(O=$[K],[4,this.renderStack(O)]):[3,30];case 28:tt.sent(),tt.label=29;case 29:return K++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(i){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(i.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(i){this.ctx.beginPath(),this.formatPath(i),this.ctx.closePath()},t.prototype.formatPath=function(i){var s=this;i.forEach(function(A,o){var g=wa(A)?A.start:A;o===0?s.ctx.moveTo(g.x,g.y):s.ctx.lineTo(g.x,g.y),wa(A)&&s.ctx.bezierCurveTo(A.startControl.x,A.startControl.y,A.endControl.x,A.endControl.y,A.end.x,A.end.y)})},t.prototype.renderRepeat=function(i,s,A,o){this.path(i),this.ctx.fillStyle=s,this.ctx.translate(A,o),this.ctx.fill(),this.ctx.translate(-A,-o)},t.prototype.resizeImage=function(i,s,A){var o;if(i.width===s&&i.height===A)return i;var g=(o=this.canvas.ownerDocument)!==null&&o!==void 0?o:document,d=g.createElement("canvas");d.width=Math.max(1,s),d.height=Math.max(1,A);var C=d.getContext("2d");return C.drawImage(i,0,0,i.width,i.height,0,0,s,A),d},t.prototype.renderBackgroundImage=function(i){return Co(this,void 0,void 0,function(){var s,A,o,g,d,C;return Js(this,function(v){switch(v.label){case 0:s=i.styles.backgroundImage.length-1,A=function(x){var T,G,k,qt,ie,ne,kt,_t,vt,W,qt,ie,ne,kt,_t,K,$,O,tt,at,Lt,Tt,Qt,Ft,vt,Jt,qt,At,lt,kt,_t,le,ie,ne,te,wt,Ut,fe,j,bt,It,Ht;return Js(this,function(Ot){switch(Ot.label){case 0:if(x.type!==0)return[3,5];T=void 0,G=x.url,Ot.label=1;case 1:return Ot.trys.push([1,3,,4]),[4,o.context.cache.match(G)];case 2:return T=Ot.sent(),[3,4];case 3:return Ot.sent(),o.context.logger.error("Error loading background-image "+G),[3,4];case 4:return T&&(k=IC(i,s,[T.width,T.height,T.width/T.height]),qt=k[0],ie=k[1],ne=k[2],kt=k[3],_t=k[4],vt=o.ctx.createPattern(o.resizeImage(T,kt,_t),"repeat"),o.renderRepeat(qt,vt,ie,ne)),[3,6];case 5:tk(x)?(W=IC(i,s,[null,null,null]),qt=W[0],ie=W[1],ne=W[2],kt=W[3],_t=W[4],K=X4(x.angle,kt,_t),$=K[0],O=K[1],tt=K[2],at=K[3],Lt=K[4],Tt=document.createElement("canvas"),Tt.width=kt,Tt.height=_t,Qt=Tt.getContext("2d"),Ft=Qt.createLinearGradient(O,at,tt,Lt),hv(x.stops,$).forEach(function(Ae){return Ft.addColorStop(Ae.stop,ms(Ae.color))}),Qt.fillStyle=Ft,Qt.fillRect(0,0,kt,_t),kt>0&&_t>0&&(vt=o.ctx.createPattern(Tt,"repeat"),o.renderRepeat(qt,vt,ie,ne))):ek(x)&&(Jt=IC(i,s,[null,null,null]),qt=Jt[0],At=Jt[1],lt=Jt[2],kt=Jt[3],_t=Jt[4],le=x.position.length===0?[KC]:x.position,ie=ln(le[0],kt),ne=ln(le[le.length-1],_t),te=Y4(x,ie,ne,kt,_t),wt=te[0],Ut=te[1],wt>0&&Ut>0&&(fe=o.ctx.createRadialGradient(At+ie,lt+ne,0,At+ie,lt+ne,wt),hv(x.stops,wt*2).forEach(function(Ae){return fe.addColorStop(Ae.stop,ms(Ae.color))}),o.path(qt),o.ctx.fillStyle=fe,wt!==Ut?(j=i.bounds.left+.5*i.bounds.width,bt=i.bounds.top+.5*i.bounds.height,It=Ut/wt,Ht=1/It,o.ctx.save(),o.ctx.translate(j,bt),o.ctx.transform(1,0,0,It,0,0),o.ctx.translate(-j,-bt),o.ctx.fillRect(At,Ht*(lt-bt)+bt,kt,_t*Ht),o.ctx.restore()):o.ctx.fill())),Ot.label=6;case 6:return s--,[2]}})},o=this,g=0,d=i.styles.backgroundImage.slice(0).reverse(),v.label=1;case 1:return g<d.length?(C=d[g],[5,A(C)]):[3,4];case 2:v.sent(),v.label=3;case 3:return g++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(i,s,A){return Co(this,void 0,void 0,function(){return Js(this,function(o){return this.path(Kv(A,s)),this.ctx.fillStyle=ms(i),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(i,s,A,o){return Co(this,void 0,void 0,function(){var g,d;return Js(this,function(C){switch(C.label){case 0:return s<3?[4,this.renderSolidBorder(i,A,o)]:[3,2];case 1:return C.sent(),[2];case 2:return g=nT(o,A),this.path(g),this.ctx.fillStyle=ms(i),this.ctx.fill(),d=sT(o,A),this.path(d),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(i){return Co(this,void 0,void 0,function(){var s,A,o,g,d,C,v,x,T=this;return Js(this,function(G){switch(G.label){case 0:return this.applyEffects(i.getEffects(2)),s=i.container.styles,A=!oc(s.backgroundColor)||s.backgroundImage.length,o=[{style:s.borderTopStyle,color:s.borderTopColor,width:s.borderTopWidth},{style:s.borderRightStyle,color:s.borderRightColor,width:s.borderRightWidth},{style:s.borderBottomStyle,color:s.borderBottomColor,width:s.borderBottomWidth},{style:s.borderLeftStyle,color:s.borderLeftColor,width:s.borderLeftWidth}],g=fT(Tu(s.backgroundClip,0),i.curves),A||s.boxShadow.length?(this.ctx.save(),this.path(g),this.ctx.clip(),oc(s.backgroundColor)||(this.ctx.fillStyle=ms(s.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(i.container)]):[3,2];case 1:G.sent(),this.ctx.restore(),s.boxShadow.slice(0).reverse().forEach(function(k){T.ctx.save();var W=Yd(i.curves),K=k.inset?0:gT,$=iT(W,-K+(k.inset?1:-1)*k.spread.number,(k.inset?1:-1)*k.spread.number,k.spread.number*(k.inset?-2:2),k.spread.number*(k.inset?-2:2));k.inset?(T.path(W),T.ctx.clip(),T.mask($)):(T.mask(W),T.ctx.clip(),T.path($)),T.ctx.shadowOffsetX=k.offsetX.number+K,T.ctx.shadowOffsetY=k.offsetY.number,T.ctx.shadowColor=ms(k.color),T.ctx.shadowBlur=k.blur.number,T.ctx.fillStyle=k.inset?ms(k.color):"rgba(0,0,0,1)",T.ctx.fill(),T.ctx.restore()}),G.label=2;case 2:d=0,C=0,v=o,G.label=3;case 3:return C<v.length?(x=v[C],x.style!==0&&!oc(x.color)&&x.width>0?x.style!==2?[3,5]:[4,this.renderDashedDottedBorder(x.color,x.width,d,i.curves,2)]:[3,11]):[3,13];case 4:return G.sent(),[3,11];case 5:return x.style!==3?[3,7]:[4,this.renderDashedDottedBorder(x.color,x.width,d,i.curves,3)];case 6:return G.sent(),[3,11];case 7:return x.style!==4?[3,9]:[4,this.renderDoubleBorder(x.color,x.width,d,i.curves)];case 8:return G.sent(),[3,11];case 9:return[4,this.renderSolidBorder(x.color,d,i.curves)];case 10:G.sent(),G.label=11;case 11:d++,G.label=12;case 12:return C++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(i,s,A,o,g){return Co(this,void 0,void 0,function(){var d,C,v,x,T,G,k,W,K,$,O,tt,at,Lt,Tt,Qt,Tt,Qt;return Js(this,function(Ft){return this.ctx.save(),d=oT(o,A),C=Kv(o,A),g===2&&(this.path(C),this.ctx.clip()),wa(C[0])?(v=C[0].start.x,x=C[0].start.y):(v=C[0].x,x=C[0].y),wa(C[1])?(T=C[1].end.x,G=C[1].end.y):(T=C[1].x,G=C[1].y),A===0||A===2?k=Math.abs(v-T):k=Math.abs(x-G),this.ctx.beginPath(),g===3?this.formatPath(d):this.formatPath(C.slice(0,2)),W=s<3?s*3:s*2,K=s<3?s*2:s,g===3&&(W=s,K=s),$=!0,k<=W*2?$=!1:k<=W*2+K?(O=k/(2*W+K),W*=O,K*=O):(tt=Math.floor((k+K)/(W+K)),at=(k-tt*W)/(tt-1),Lt=(k-(tt+1)*W)/tt,K=Lt<=0||Math.abs(K-at)<Math.abs(K-Lt)?at:Lt),$&&(g===3?this.ctx.setLineDash([0,W+K]):this.ctx.setLineDash([W,K])),g===3?(this.ctx.lineCap="round",this.ctx.lineWidth=s):this.ctx.lineWidth=s*2+1.1,this.ctx.strokeStyle=ms(i),this.ctx.stroke(),this.ctx.setLineDash([]),g===2&&(wa(C[0])&&(Tt=C[3],Qt=C[0],this.ctx.beginPath(),this.formatPath([new yi(Tt.end.x,Tt.end.y),new yi(Qt.start.x,Qt.start.y)]),this.ctx.stroke()),wa(C[1])&&(Tt=C[1],Qt=C[2],this.ctx.beginPath(),this.formatPath([new yi(Tt.end.x,Tt.end.y),new yi(Qt.start.x,Qt.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(i){return Co(this,void 0,void 0,function(){var s;return Js(this,function(A){switch(A.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=ms(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),s=rT(i),[4,this.renderStack(s)];case 1:return A.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(J2),pT=function(r){return r instanceof E2||r instanceof L2?!0:r instanceof JC&&r.type!==zd&&r.type!==Od},fT=function(r,t){switch(r){case 0:return Yd(t);case 2:return jE(t);case 1:default:return jd(t)}},mT=function(r){switch(r){case 1:return"center";case 2:return"right";case 0:default:return"left"}},CT=["-apple-system","system-ui"],IT=function(r){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?r.filter(function(t){return CT.indexOf(t)===-1}):r},yT=function(r){$a(t,r);function t(i,s){var A=r.call(this,i,s)||this;return A.canvas=s.canvas?s.canvas:document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),A.options=s,A.canvas.width=Math.floor(s.width*s.scale),A.canvas.height=Math.floor(s.height*s.scale),A.canvas.style.width=s.width+"px",A.canvas.style.height=s.height+"px",A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-s.x,-s.y),A.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+s.width+"x"+s.height+" at "+s.x+","+s.y+") with scale "+s.scale),A}return t.prototype.render=function(i){return Co(this,void 0,void 0,function(){var s,A;return Js(this,function(o){switch(o.label){case 0:return s=RC(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,i),[4,bT(s)];case 1:return A=o.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=ms(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(A,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(J2),bT=function(r){return new Promise(function(t,i){var s=new Image;s.onload=function(){t(s)},s.onerror=i,s.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(r))})},vT=function(){function r(t){var i=t.id,s=t.enabled;this.id=i,this.enabled=s,this.start=Date.now()}return r.prototype.debug=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,bd([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.prototype.getTime=function(){return Date.now()-this.start},r.prototype.info=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,bd([this.id,this.getTime()+"ms"],t))},r.prototype.warn=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,bd([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.prototype.error=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,bd([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},r.instances={},r}(),wT=function(){function r(t,i){var s;this.windowBounds=i,this.instanceName="#"+r.instanceCount++,this.logger=new vT({id:this.instanceName,enabled:t.logging}),this.cache=(s=t.cache)!==null&&s!==void 0?s:new DE(this,t)}return r.instanceCount=1,r}(),BT=function(r,t){return t===void 0&&(t={}),_T(r,t)};typeof window<"u"&&V2.setContext(window);_T=function(r,t){return Co(void 0,void 0,void 0,function(){var i,s,A,o,g,d,C,v,x,T,G,k,W,K,$,O,tt,at,Lt,Tt,Ft,Qt,Ft,vt,Jt,qt,At,lt,kt,_t,le,ie,ne,te,wt,Ut,fe,j,bt,It;return Js(this,function(Ht){switch(Ht.label){case 0:if(!r||typeof r!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(i=r.ownerDocument,!i)throw new Error("Element is not attached to a Document");if(s=i.defaultView,!s)throw new Error("Document is not attached to a Window");return A={allowTaint:(vt=t.allowTaint)!==null&&vt!==void 0?vt:!1,imageTimeout:(Jt=t.imageTimeout)!==null&&Jt!==void 0?Jt:15e3,proxy:t.proxy,useCORS:(qt=t.useCORS)!==null&&qt!==void 0?qt:!1},o=bC({logging:(At=t.logging)!==null&&At!==void 0?At:!0,cache:t.cache},A),g={windowWidth:(lt=t.windowWidth)!==null&&lt!==void 0?lt:s.innerWidth,windowHeight:(kt=t.windowHeight)!==null&&kt!==void 0?kt:s.innerHeight,scrollX:(_t=t.scrollX)!==null&&_t!==void 0?_t:s.pageXOffset,scrollY:(le=t.scrollY)!==null&&le!==void 0?le:s.pageYOffset},d=new vl(g.scrollX,g.scrollY,g.windowWidth,g.windowHeight),C=new wT(o,d),v=(ie=t.foreignObjectRendering)!==null&&ie!==void 0?ie:!1,x={allowTaint:(ne=t.allowTaint)!==null&&ne!==void 0?ne:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:v,copyStyles:v},C.logger.debug("Starting document clone with size "+d.width+"x"+d.height+" scrolled to "+-d.left+","+-d.top),T=new Nv(C,r,x),G=T.clonedReferenceElement,G?[4,T.toIFrame(i,d)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return k=Ht.sent(),W=XC(G)||xE(G)?iF(G.ownerDocument):$d(C,G),K=W.width,$=W.height,O=W.left,tt=W.top,at=xT(C,G,t.backgroundColor),Lt={canvas:t.canvas,backgroundColor:at,scale:(wt=(te=t.scale)!==null&&te!==void 0?te:s.devicePixelRatio)!==null&&wt!==void 0?wt:1,x:((Ut=t.x)!==null&&Ut!==void 0?Ut:0)+O,y:((fe=t.y)!==null&&fe!==void 0?fe:0)+tt,width:(j=t.width)!==null&&j!==void 0?j:Math.ceil(K),height:(bt=t.height)!==null&&bt!==void 0?bt:Math.ceil($)},v?(C.logger.debug("Document cloned, using foreign object rendering"),Ft=new yT(C,Lt),[4,Ft.render(G)]):[3,3];case 2:return Tt=Ht.sent(),[3,5];case 3:return C.logger.debug("Document cloned, element located at "+O+","+tt+" with size "+K+"x"+$+" using computed rendering"),C.logger.debug("Starting DOM parsing"),Qt=U2(C,G),at===Qt.styles.backgroundColor&&(Qt.styles.backgroundColor=bl.TRANSPARENT),C.logger.debug("Starting renderer for element at "+Lt.x+","+Lt.y+" with size "+Lt.width+"x"+Lt.height),Ft=new dT(C,Lt),[4,Ft.render(Qt)];case 4:Tt=Ht.sent(),Ht.label=5;case 5:return(!((It=t.removeContainer)!==null&&It!==void 0)||It)&&(Nv.destroy(k)||C.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),C.logger.debug("Finished rendering"),[2,Tt]}})})},xT=function(r,t,i){var s=t.ownerDocument,A=s.documentElement?eg(r,getComputedStyle(s.documentElement).backgroundColor):bl.TRANSPARENT,o=s.body?eg(r,getComputedStyle(s.body).backgroundColor):bl.TRANSPARENT,g=typeof i=="string"?eg(r,i):i===null?bl.TRANSPARENT:4294967295;return t===s.documentElement?oc(A)?oc(o)?g:o:A:g}});var sw={};Om(sw,{default:()=>eQ});function Ac(r){return Ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ac(r)}function i0(r,t){return i0=Object.setPrototypeOf||function(i,s){return i.__proto__=s,i},i0(r,t)}function ST(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function up(r,t,i){return ST()?up=Reflect.construct:up=function(s,A,o){var g=[null];g.push.apply(g,A);var d=Function.bind.apply(s,g),C=new d;return o&&i0(C,o.prototype),C},up.apply(null,arguments)}function eA(r){return FT(r)||kT(r)||LT(r)||ET()}function FT(r){if(Array.isArray(r))return r0(r)}function kT(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function LT(r,t){if(r){if(typeof r=="string")return r0(r,t);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r0(r,t)}}function r0(r,t){(t==null||t>r.length)&&(t=r.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=r[i];return s}function ET(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xa(r){return function(t){for(var i=arguments.length,s=new Array(i>1?i-1:0),A=1;A<i;A++)s[A-1]=arguments[A];return gp(r,t,s)}}function NT(r){return function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return n0(r,i)}}function yr(r,t,i){var s;i=(s=i)!==null&&s!==void 0?s:hp,j2&&j2(r,null);for(var A=t.length;A--;){var o=t[A];if(typeof o=="string"){var g=i(o);g!==o&&(QT(t)||(t[A]=g),o=g)}r[o]=!0}return r}function Pc(r){var t=RT(null),i;for(i in r)gp(TT,r,[i])===!0&&(t[i]=r[i]);return t}function lp(r,t){for(;r!==null;){var i=GT(r,t);if(i){if(i.get)return xa(i.get);if(typeof i.value=="function")return xa(i.value)}r=UT(r)}function s(A){return console.warn("fallback value for",A),null}return s}function nw(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$T(),t=function(Dt){return nw(Dt)};if(t.version="2.4.7",t.removed=[],!r||!r.document||r.document.nodeType!==9)return t.isSupported=!1,t;var i=r.document,s=r.document,A=r.DocumentFragment,o=r.HTMLTemplateElement,g=r.Node,d=r.Element,C=r.NodeFilter,v=r.NamedNodeMap,x=v===void 0?r.NamedNodeMap||r.MozNamedAttrMap:v,T=r.HTMLFormElement,G=r.DOMParser,k=r.trustedTypes,W=d.prototype,K=lp(W,"cloneNode"),$=lp(W,"nextSibling"),O=lp(W,"childNodes"),tt=lp(W,"parentNode");if(typeof o=="function"){var at=s.createElement("template");at.content&&at.content.ownerDocument&&(s=at.content.ownerDocument)}var Lt=tQ(k,i),Tt=Lt?Lt.createHTML(""):"",Qt=s,Ft=Qt.implementation,vt=Qt.createNodeIterator,Jt=Qt.createDocumentFragment,qt=Qt.getElementsByTagName,At=i.importNode,lt={};try{lt=Pc(s).documentMode?s.documentMode:{}}catch{}var kt={};t.isSupported=typeof tt=="function"&&Ft&&Ft.createHTMLDocument!==void 0&&lt!==9;var _t=KT,le=WT,ie=OT,ne=zT,te=JT,wt=YT,Ut=jT,fe=XT,j=null,bt=yr({},[].concat(eA($2),eA(qC),eA($C),eA(t0),eA(tw))),It=null,Ht=yr({},[].concat(eA(ew),eA(e0),eA(iw),eA(cp))),Ot=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ae=null,he=null,de=!0,He=!0,Re=!1,je=!0,Me=!1,gi=!1,xt=!1,Rt=!1,Li=!1,Ue=!1,Ee=!1,Ne=!0,Je=!1,ze="user-content-",ui=!0,hi=!1,Ei={},Pi=null,Ie=yr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Oi=null,mi=yr({},["audio","video","img","source","image","track"]),Vi=null,We=yr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Se="http://www.w3.org/1998/Math/MathML",$e="http://www.w3.org/2000/svg",di="http://www.w3.org/1999/xhtml",Zi=di,qi=!1,vi=null,tr=yr({},[Se,$e,di],YC),Lr,ft=["application/xhtml+xml","text/html"],Y="text/html",q,rt=null,ht=s.createElement("form"),Zt=function(Dt){return Dt instanceof RegExp||Dt instanceof Function},zt=function(Dt){rt&&rt===Dt||((!Dt||Ac(Dt)!=="object")&&(Dt={}),Dt=Pc(Dt),Lr=ft.indexOf(Dt.PARSER_MEDIA_TYPE)===-1?Lr=Y:Lr=Dt.PARSER_MEDIA_TYPE,q=Lr==="application/xhtml+xml"?YC:hp,j="ALLOWED_TAGS"in Dt?yr({},Dt.ALLOWED_TAGS,q):bt,It="ALLOWED_ATTR"in Dt?yr({},Dt.ALLOWED_ATTR,q):Ht,vi="ALLOWED_NAMESPACES"in Dt?yr({},Dt.ALLOWED_NAMESPACES,YC):tr,Vi="ADD_URI_SAFE_ATTR"in Dt?yr(Pc(We),Dt.ADD_URI_SAFE_ATTR,q):We,Oi="ADD_DATA_URI_TAGS"in Dt?yr(Pc(mi),Dt.ADD_DATA_URI_TAGS,q):mi,Pi="FORBID_CONTENTS"in Dt?yr({},Dt.FORBID_CONTENTS,q):Ie,Ae="FORBID_TAGS"in Dt?yr({},Dt.FORBID_TAGS,q):{},he="FORBID_ATTR"in Dt?yr({},Dt.FORBID_ATTR,q):{},Ei="USE_PROFILES"in Dt?Dt.USE_PROFILES:!1,de=Dt.ALLOW_ARIA_ATTR!==!1,He=Dt.ALLOW_DATA_ATTR!==!1,Re=Dt.ALLOW_UNKNOWN_PROTOCOLS||!1,je=Dt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Me=Dt.SAFE_FOR_TEMPLATES||!1,gi=Dt.WHOLE_DOCUMENT||!1,Li=Dt.RETURN_DOM||!1,Ue=Dt.RETURN_DOM_FRAGMENT||!1,Ee=Dt.RETURN_TRUSTED_TYPE||!1,Rt=Dt.FORCE_BODY||!1,Ne=Dt.SANITIZE_DOM!==!1,Je=Dt.SANITIZE_NAMED_PROPS||!1,ui=Dt.KEEP_CONTENT!==!1,hi=Dt.IN_PLACE||!1,fe=Dt.ALLOWED_URI_REGEXP||fe,Zi=Dt.NAMESPACE||di,Ot=Dt.CUSTOM_ELEMENT_HANDLING||{},Dt.CUSTOM_ELEMENT_HANDLING&&Zt(Dt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ot.tagNameCheck=Dt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Dt.CUSTOM_ELEMENT_HANDLING&&Zt(Dt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ot.attributeNameCheck=Dt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Dt.CUSTOM_ELEMENT_HANDLING&&typeof Dt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ot.allowCustomizedBuiltInElements=Dt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Me&&(He=!1),Ue&&(Li=!0),Ei&&(j=yr({},eA(tw)),It=[],Ei.html===!0&&(yr(j,$2),yr(It,ew)),Ei.svg===!0&&(yr(j,qC),yr(It,e0),yr(It,cp)),Ei.svgFilters===!0&&(yr(j,$C),yr(It,e0),yr(It,cp)),Ei.mathMl===!0&&(yr(j,t0),yr(It,iw),yr(It,cp))),Dt.ADD_TAGS&&(j===bt&&(j=Pc(j)),yr(j,Dt.ADD_TAGS,q)),Dt.ADD_ATTR&&(It===Ht&&(It=Pc(It)),yr(It,Dt.ADD_ATTR,q)),Dt.ADD_URI_SAFE_ATTR&&yr(Vi,Dt.ADD_URI_SAFE_ATTR,q),Dt.FORBID_CONTENTS&&(Pi===Ie&&(Pi=Pc(Pi)),yr(Pi,Dt.FORBID_CONTENTS,q)),ui&&(j["#text"]=!0),gi&&yr(j,["html","head","body"]),j.table&&(yr(j,["tbody"]),delete Ae.tbody),bo&&bo(Dt),rt=Dt)},Xt=yr({},["mi","mo","mn","ms","mtext"]),Mt=yr({},["foreignobject","desc","title","annotation-xml"]),re=yr({},["title","style","font","a","script"]),ce=yr({},qC);yr(ce,$C),yr(ce,VT);var pe=yr({},t0);yr(pe,DT);var me=function(Dt){var Ke=tt(Dt);(!Ke||!Ke.tagName)&&(Ke={namespaceURI:Zi,tagName:"template"});var Te=hp(Dt.tagName),or=hp(Ke.tagName);return vi[Dt.namespaceURI]?Dt.namespaceURI===$e?Ke.namespaceURI===di?Te==="svg":Ke.namespaceURI===Se?Te==="svg"&&(or==="annotation-xml"||Xt[or]):!!ce[Te]:Dt.namespaceURI===Se?Ke.namespaceURI===di?Te==="math":Ke.namespaceURI===$e?Te==="math"&&Mt[or]:!!pe[Te]:Dt.namespaceURI===di?Ke.namespaceURI===$e&&!Mt[or]||Ke.namespaceURI===Se&&!Xt[or]?!1:!pe[Te]&&(re[Te]||!ce[Te]):!!(Lr==="application/xhtml+xml"&&vi[Dt.namespaceURI]):!1},Xe=function(Dt){cg(t.removed,{element:Dt});try{Dt.parentNode.removeChild(Dt)}catch{try{Dt.outerHTML=Tt}catch{Dt.remove()}}},oi=function(Dt,Ke){try{cg(t.removed,{attribute:Ke.getAttributeNode(Dt),from:Ke})}catch{cg(t.removed,{attribute:null,from:Ke})}if(Ke.removeAttribute(Dt),Dt==="is"&&!It[Dt])if(Li||Ue)try{Xe(Ke)}catch{}else try{Ke.setAttribute(Dt,"")}catch{}},ii=function(Dt){var Ke,Te;if(Rt)Dt="<remove></remove>"+Dt;else{var or=ZT(Dt,/^[\r\n\t ]+/);Te=or&&or[0]}Lr==="application/xhtml+xml"&&Zi===di&&(Dt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Dt+"</body></html>");var Er=Lt?Lt.createHTML(Dt):Dt;if(Zi===di)try{Ke=new G().parseFromString(Er,Lr)}catch{}if(!Ke||!Ke.documentElement){Ke=Ft.createDocument(Zi,"template",null);try{Ke.documentElement.innerHTML=qi?Tt:Er}catch{}}var Ji=Ke.body||Ke.documentElement;return Dt&&Te&&Ji.insertBefore(s.createTextNode(Te),Ji.childNodes[0]||null),Zi===di?qt.call(Ke,gi?"html":"body")[0]:gi?Ke.documentElement:Ji},Ni=function(Dt){return vt.call(Dt.ownerDocument||Dt,Dt,C.SHOW_ELEMENT|C.SHOW_COMMENT|C.SHOW_TEXT,null,!1)},Qi=function(Dt){return Dt instanceof T&&(typeof Dt.nodeName!="string"||typeof Dt.textContent!="string"||typeof Dt.removeChild!="function"||!(Dt.attributes instanceof x)||typeof Dt.removeAttribute!="function"||typeof Dt.setAttribute!="function"||typeof Dt.namespaceURI!="string"||typeof Dt.insertBefore!="function"||typeof Dt.hasChildNodes!="function")},rr=function(Dt){return Ac(g)==="object"?Dt instanceof g:Dt&&Ac(Dt)==="object"&&typeof Dt.nodeType=="number"&&typeof Dt.nodeName=="string"},zi=function(Dt,Ke,Te){kt[Dt]&&HT(kt[Dt],function(or){or.call(t,Ke,Te,rt)})},Cr=function(Dt){var Ke;if(zi("beforeSanitizeElements",Dt,null),Qi(Dt)||yo(/[\u0080-\uFFFF]/,Dt.nodeName))return Xe(Dt),!0;var Te=q(Dt.nodeName);if(zi("uponSanitizeElement",Dt,{tagName:Te,allowedTags:j}),Dt.hasChildNodes()&&!rr(Dt.firstElementChild)&&(!rr(Dt.content)||!rr(Dt.content.firstElementChild))&&yo(/<[/\w]/g,Dt.innerHTML)&&yo(/<[/\w]/g,Dt.textContent)||Te==="select"&&yo(/<template/i,Dt.innerHTML))return Xe(Dt),!0;if(!j[Te]||Ae[Te]){if(!Ae[Te]&&fr(Te)&&(Ot.tagNameCheck instanceof RegExp&&yo(Ot.tagNameCheck,Te)||Ot.tagNameCheck instanceof Function&&Ot.tagNameCheck(Te)))return!1;if(ui&&!Pi[Te]){var or=tt(Dt)||Dt.parentNode,Er=O(Dt)||Dt.childNodes;if(Er&&or)for(var Ji=Er.length,Mr=Ji-1;Mr>=0;--Mr)or.insertBefore(K(Er[Mr],!0),$(Dt))}return Xe(Dt),!0}return Dt instanceof d&&!me(Dt)||(Te==="noscript"||Te==="noembed"||Te==="noframes")&&yo(/<\/no(script|embed|frames)/i,Dt.innerHTML)?(Xe(Dt),!0):(Me&&Dt.nodeType===3&&(Ke=Dt.textContent,Ke=tA(Ke,_t," "),Ke=tA(Ke,le," "),Ke=tA(Ke,ie," "),Dt.textContent!==Ke&&(cg(t.removed,{element:Dt.cloneNode()}),Dt.textContent=Ke)),zi("afterSanitizeElements",Dt,null),!1)},ki=function(Dt,Ke,Te){if(Ne&&(Ke==="id"||Ke==="name")&&(Te in s||Te in ht))return!1;if(!(He&&!he[Ke]&&yo(ne,Ke))&&!(de&&yo(te,Ke))){if(!It[Ke]||he[Ke]){if(!(fr(Dt)&&(Ot.tagNameCheck instanceof RegExp&&yo(Ot.tagNameCheck,Dt)||Ot.tagNameCheck instanceof Function&&Ot.tagNameCheck(Dt))&&(Ot.attributeNameCheck instanceof RegExp&&yo(Ot.attributeNameCheck,Ke)||Ot.attributeNameCheck instanceof Function&&Ot.attributeNameCheck(Ke))||Ke==="is"&&Ot.allowCustomizedBuiltInElements&&(Ot.tagNameCheck instanceof RegExp&&yo(Ot.tagNameCheck,Te)||Ot.tagNameCheck instanceof Function&&Ot.tagNameCheck(Te))))return!1}else if(!Vi[Ke]&&!yo(fe,tA(Te,Ut,""))&&!((Ke==="src"||Ke==="xlink:href"||Ke==="href")&&Dt!=="script"&&PT(Te,"data:")===0&&Oi[Dt])&&!(Re&&!yo(wt,tA(Te,Ut,"")))&&Te)return!1}return!0},fr=function(Dt){return Dt.indexOf("-")>0},br=function(Dt){var Ke,Te,or,Er;zi("beforeSanitizeAttributes",Dt,null);var Ji=Dt.attributes;if(Ji){var Mr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:It};for(Er=Ji.length;Er--;){Ke=Ji[Er];var vs=Ke,Sr=vs.name,xr=vs.namespaceURI;if(Te=Sr==="value"?Ke.value:MT(Ke.value),or=q(Sr),Mr.attrName=or,Mr.attrValue=Te,Mr.keepAttr=!0,Mr.forceKeepAttr=void 0,zi("uponSanitizeAttribute",Dt,Mr),Te=Mr.attrValue,!Mr.forceKeepAttr&&(oi(Sr,Dt),!!Mr.keepAttr)){if(!je&&yo(/\/>/i,Te)){oi(Sr,Dt);continue}Me&&(Te=tA(Te,_t," "),Te=tA(Te,le," "),Te=tA(Te,ie," "));var Wo=q(Dt.nodeName);if(ki(Wo,or,Te)){if(Je&&(or==="id"||or==="name")&&(oi(Sr,Dt),Te=ze+Te),Lt&&Ac(k)==="object"&&typeof k.getAttributeType=="function"&&!xr)switch(k.getAttributeType(Wo,or)){case"TrustedHTML":{Te=Lt.createHTML(Te);break}case"TrustedScriptURL":{Te=Lt.createScriptURL(Te);break}}try{xr?Dt.setAttributeNS(xr,Sr,Te):Dt.setAttribute(Sr,Te),q2(t.removed)}catch{}}}}zi("afterSanitizeAttributes",Dt,null)}},Tr=function Dt(Ke){var Te,or=Ni(Ke);for(zi("beforeSanitizeShadowDOM",Ke,null);Te=or.nextNode();)zi("uponSanitizeShadowNode",Te,null),!Cr(Te)&&(Te.content instanceof A&&Dt(Te.content),br(Te));zi("afterSanitizeShadowDOM",Ke,null)};return t.sanitize=function(Dt){var Ke=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Te,or,Er,Ji,Mr;if(qi=!Dt,qi&&(Dt="<!-->"),typeof Dt!="string"&&!rr(Dt))if(typeof Dt.toString=="function"){if(Dt=Dt.toString(),typeof Dt!="string")throw jC("dirty is not a string, aborting")}else throw jC("toString is not a function");if(!t.isSupported){if(Ac(r.toStaticHTML)==="object"||typeof r.toStaticHTML=="function"){if(typeof Dt=="string")return r.toStaticHTML(Dt);if(rr(Dt))return r.toStaticHTML(Dt.outerHTML)}return Dt}if(xt||zt(Ke),t.removed=[],typeof Dt=="string"&&(hi=!1),hi){if(Dt.nodeName){var vs=q(Dt.nodeName);if(!j[vs]||Ae[vs])throw jC("root node is forbidden and cannot be sanitized in-place")}}else if(Dt instanceof g)Te=ii("<!---->"),or=Te.ownerDocument.importNode(Dt,!0),or.nodeType===1&&or.nodeName==="BODY"||or.nodeName==="HTML"?Te=or:Te.appendChild(or);else{if(!Li&&!Me&&!gi&&Dt.indexOf("<")===-1)return Lt&&Ee?Lt.createHTML(Dt):Dt;if(Te=ii(Dt),!Te)return Li?null:Ee?Tt:""}Te&&Rt&&Xe(Te.firstChild);for(var Sr=Ni(hi?Dt:Te);Er=Sr.nextNode();)Er.nodeType===3&&Er===Ji||Cr(Er)||(Er.content instanceof A&&Tr(Er.content),br(Er),Ji=Er);if(Ji=null,hi)return Dt;if(Li){if(Ue)for(Mr=Jt.call(Te.ownerDocument);Te.firstChild;)Mr.appendChild(Te.firstChild);else Mr=Te;return(It.shadowroot||It.shadowrootmod)&&(Mr=At.call(i,Mr,!0)),Mr}var xr=gi?Te.outerHTML:Te.innerHTML;return gi&&j["!doctype"]&&Te.ownerDocument&&Te.ownerDocument.doctype&&Te.ownerDocument.doctype.name&&yo(qT,Te.ownerDocument.doctype.name)&&(xr="<!DOCTYPE "+Te.ownerDocument.doctype.name+`>
`+xr),Me&&(xr=tA(xr,_t," "),xr=tA(xr,le," "),xr=tA(xr,ie," ")),Lt&&Ee?Lt.createHTML(xr):xr},t.setConfig=function(Dt){zt(Dt),xt=!0},t.clearConfig=function(){rt=null,xt=!1},t.isValidAttribute=function(Dt,Ke,Te){rt||zt({});var or=q(Dt),Er=q(Ke);return ki(or,Er,Te)},t.addHook=function(Dt,Ke){typeof Ke=="function"&&(kt[Dt]=kt[Dt]||[],cg(kt[Dt],Ke))},t.removeHook=function(Dt){if(kt[Dt])return q2(kt[Dt])},t.removeHooks=function(Dt){kt[Dt]&&(kt[Dt]=[])},t.removeAllHooks=function(){kt={}},t}var TT,j2,QT,UT,GT,bo,iA,RT,rw,gp,n0,HT,q2,cg,hp,YC,ZT,tA,PT,MT,yo,jC,$2,qC,$C,VT,t0,DT,tw,ew,e0,iw,cp,KT,WT,OT,zT,JT,XT,YT,jT,qT,$T,tQ,eQ,ow=dd(()=>{TT=Object.hasOwnProperty,j2=Object.setPrototypeOf,QT=Object.isFrozen,UT=Object.getPrototypeOf,GT=Object.getOwnPropertyDescriptor,bo=Object.freeze,iA=Object.seal,RT=Object.create,rw=typeof Reflect<"u"&&Reflect,gp=rw.apply,n0=rw.construct;gp||(gp=function(r,t,i){return r.apply(t,i)});bo||(bo=function(r){return r});iA||(iA=function(r){return r});n0||(n0=function(r,t){return up(r,eA(t))});HT=xa(Array.prototype.forEach),q2=xa(Array.prototype.pop),cg=xa(Array.prototype.push),hp=xa(String.prototype.toLowerCase),YC=xa(String.prototype.toString),ZT=xa(String.prototype.match),tA=xa(String.prototype.replace),PT=xa(String.prototype.indexOf),MT=xa(String.prototype.trim),yo=xa(RegExp.prototype.test),jC=NT(TypeError);$2=bo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),qC=bo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$C=bo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),VT=bo(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),t0=bo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),DT=bo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tw=bo(["#text"]),ew=bo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),e0=bo(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),iw=bo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),cp=bo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),KT=iA(/\{\{[\w\W]*|[\w\W]*\}\}/gm),WT=iA(/<%[\w\W]*|[\w\W]*%>/gm),OT=iA(/\${[\w\W]*}/gm),zT=iA(/^data-[\-\w.\u00B7-\uFFFF]/),JT=iA(/^aria-[\-\w]+$/),XT=iA(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),YT=iA(/^(?:\w+script|data):/i),jT=iA(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),qT=iA(/^html$/i),$T=function(){return typeof window>"u"?null:window},tQ=function(r,t){if(Ac(r)!=="object"||typeof r.createPolicy!="function")return null;var i=null,s="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(s)&&(i=t.currentScript.getAttribute(s));var A="dompurify"+(i?"#"+i:"");try{return r.createPolicy(A,{createHTML:function(o){return o},createScriptURL:function(o){return o}})}catch{return console.warn("TrustedTypes policy "+A+" could not be created."),null}};eQ=nw()});var $x={};Om($x,{AElement:()=>pf,AnimateColorElement:()=>lf,AnimateElement:()=>th,AnimateTransformElement:()=>cf,BoundingBox:()=>Do,CB1:()=>kI,CB2:()=>LI,CB3:()=>EI,CB4:()=>TI,Canvg:()=>uc,CircleElement:()=>qp,ClipPathElement:()=>bf,DefsElement:()=>sf,DescElement:()=>Sf,Document:()=>aA,Element:()=>tn,EllipseElement:()=>$p,FeColorMatrixElement:()=>Eg,FeCompositeElement:()=>Bf,FeDropShadowElement:()=>vf,FeGaussianBlurElement:()=>_f,FeMorphologyElement:()=>wf,FilterElement:()=>Yc,Font:()=>Cs,FontElement:()=>uf,FontFaceElement:()=>hf,GElement:()=>$u,GlyphElement:()=>xg,GradientElement:()=>kg,ImageElement:()=>mf,LineElement:()=>tf,LinearGradientElement:()=>of,MarkerElement:()=>nf,MaskElement:()=>Xc,Matrix:()=>Bg,MissingGlyphElement:()=>gf,Mouse:()=>Wp,PSEUDO_ZERO:()=>Wc,Parser:()=>Xu,PathElement:()=>Pr,PathParser:()=>Ar,PatternElement:()=>rf,Point:()=>In,PolygonElement:()=>ef,PolylineElement:()=>Fg,Property:()=>Ki,QB1:()=>QI,QB2:()=>UI,QB3:()=>GI,RadialGradientElement:()=>af,RectElement:()=>Sg,RenderedElement:()=>zA,Rotate:()=>zp,SVGElement:()=>gc,SVGFontLoader:()=>If,Scale:()=>Jp,Screen:()=>zc,Skew:()=>_g,SkewX:()=>Xp,SkewY:()=>Yp,StopElement:()=>Af,StyleElement:()=>Lg,SymbolElement:()=>Cf,TRefElement:()=>df,TSpanElement:()=>Jc,TextElement:()=>AA,TextPathElement:()=>ff,TitleElement:()=>xf,Transform:()=>OA,Translate:()=>Op,UnknownElement:()=>jp,UseElement:()=>yf,ViewPort:()=>Kp,compressSpaces:()=>eu,default:()=>uc,getSelectorSpecificity:()=>Yx,normalizeAttributeName:()=>Jx,normalizeColor:()=>Xx,parseExternalUrl:()=>yy,presets:()=>w6,toNumbers:()=>Vo,trimLeft:()=>Ox,trimRight:()=>zx,vectorMagnitude:()=>SI,vectorsAngle:()=>FI,vectorsRatio:()=>Dp});function h_(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function lB(r,t,i,s,A,o,g){try{var d=r[o](g),C=d.value}catch(v){i(v);return}d.done?t(C):Promise.resolve(C).then(s,A)}function xl(r){return function(){var t=this,i=arguments;return new Promise(function(s,A){var o=r.apply(t,i);function g(C){lB(o,s,A,g,d,"next",C)}function d(C){lB(o,s,A,g,d,"throw",C)}g(void 0)})}}function HV(r,t){if(Rr(r)!="object"||!r)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var s=i.call(r,t||"default");if(Rr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function ZV(r){var t=HV(r,"string");return Rr(t)=="symbol"?t:String(t)}function Cy(r,t,i){return t=ZV(t),t in r?Object.defineProperty(r,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[t]=i,r}function Vx(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=r}Nx(r,t),r.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}function $9(r){var t="";Array.isArray(r)||(r=[r]);for(var i=0;i<r.length;i++){var s=r[i];if(s.type===De.CLOSE_PATH)t+="z";else if(s.type===De.HORIZ_LINE_TO)t+=(s.relative?"h":"H")+s.x;else if(s.type===De.VERT_LINE_TO)t+=(s.relative?"v":"V")+s.y;else if(s.type===De.MOVE_TO)t+=(s.relative?"m":"M")+s.x+" "+s.y;else if(s.type===De.LINE_TO)t+=(s.relative?"l":"L")+s.x+" "+s.y;else if(s.type===De.CURVE_TO)t+=(s.relative?"c":"C")+s.x1+" "+s.y1+" "+s.x2+" "+s.y2+" "+s.x+" "+s.y;else if(s.type===De.SMOOTH_CURVE_TO)t+=(s.relative?"s":"S")+s.x2+" "+s.y2+" "+s.x+" "+s.y;else if(s.type===De.QUAD_TO)t+=(s.relative?"q":"Q")+s.x1+" "+s.y1+" "+s.x+" "+s.y;else if(s.type===De.SMOOTH_QUAD_TO)t+=(s.relative?"t":"T")+s.x+" "+s.y;else{if(s.type!==De.ARC)throw new Error('Unexpected command type "'+s.type+'" at index '+i+".");t+=(s.relative?"a":"A")+s.rX+" "+s.rY+" "+s.xRot+" "+ +s.lArcFlag+" "+ +s.sweepFlag+" "+s.x+" "+s.y}}return t}function xI(r,t){var i=r[0],s=r[1];return[i*Math.cos(t)-s*Math.sin(t),i*Math.sin(t)+s*Math.cos(t)]}function sA(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];for(var i=0;i<r.length;i++)if(typeof r[i]!="number")throw new Error("assertNumbers arguments["+i+"] is not a number. "+typeof r[i]+" == typeof "+r[i]);return!0}function q0(r,t,i){r.lArcFlag=r.lArcFlag===0?0:1,r.sweepFlag=r.sweepFlag===0?0:1;var s=r.rX,A=r.rY,o=r.x,g=r.y;s=Math.abs(r.rX),A=Math.abs(r.rY);var d=xI([(t-o)/2,(i-g)/2],-r.xRot/180*cc),C=d[0],v=d[1],x=Math.pow(C,2)/Math.pow(s,2)+Math.pow(v,2)/Math.pow(A,2);1<x&&(s*=Math.sqrt(x),A*=Math.sqrt(x)),r.rX=s,r.rY=A;var T=Math.pow(s,2)*Math.pow(v,2)+Math.pow(A,2)*Math.pow(C,2),G=(r.lArcFlag!==r.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(s,2)*Math.pow(A,2)-T)/T)),k=s*v/A*G,W=-A*C/s*G,K=xI([k,W],r.xRot/180*cc);r.cX=K[0]+(t+o)/2,r.cY=K[1]+(i+g)/2,r.phi1=Math.atan2((v-W)/A,(C-k)/s),r.phi2=Math.atan2((-v-W)/A,(-C-k)/s),r.sweepFlag===0&&r.phi2>r.phi1&&(r.phi2-=2*cc),r.sweepFlag===1&&r.phi2<r.phi1&&(r.phi2+=2*cc),r.phi1*=180/cc,r.phi2*=180/cc}function $B(r,t,i){sA(r,t,i);var s=r*r+t*t-i*i;if(0>s)return[];if(s===0)return[[r*i/(r*r+t*t),t*i/(r*r+t*t)]];var A=Math.sqrt(s);return[[(r*i+t*A)/(r*r+t*t),(t*i-r*A)/(r*r+t*t)],[(r*i-t*A)/(r*r+t*t),(t*i+r*A)/(r*r+t*t)]]}function t_(r,t,i){return(1-i)*r+i*t}function e_(r,t,i,s){return r+Math.cos(s/180*cc)*t+Math.sin(s/180*cc)*i}function i_(r,t,i,s){var A=1e-6,o=t-r,g=i-t,d=3*o+3*(s-i)-6*g,C=6*(g-o),v=3*o;return Math.abs(d)<A?[-v/C]:function(x,T,G){G===void 0&&(G=1e-6);var k=x*x/4-T;if(k<-G)return[];if(k<=G)return[-x/2];var W=Math.sqrt(k);return[-x/2-W,-x/2+W]}(C/d,v/d,A)}function r_(r,t,i,s,A){var o=1-A;return r*(o*o*o)+t*(3*o*o*A)+i*(3*o*A*A)+s*(A*A*A)}function Rp(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Rp=function(t){return typeof t}:Rp=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rp(r)}function p6(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function C6(r,t,i,s,A){if(typeof r=="string"&&(r=document.getElementById(r)),!r||Rp(r)!=="object"||!("getContext"in r))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var o=r.getContext("2d");try{return o.getImageData(t,i,s,A)}catch(g){throw new Error("unable to access image data: "+g)}}function I6(r,t,i,s,A,o){if(!(isNaN(o)||o<1)){o|=0;var g=C6(r,t,i,s,A);g=y6(g,t,i,s,A,o),r.getContext("2d").putImageData(g,t,i)}}function y6(r,t,i,s,A,o){for(var g=r.data,d=2*o+1,C=s-1,v=A-1,x=o+1,T=x*(x+1)/2,G=new a_,k=G,W,K=1;K<d;K++)k=k.next=new a_,K===x&&(W=k);k.next=G;for(var $=null,O=null,tt=0,at=0,Lt=f6[o],Tt=m6[o],Qt=0;Qt<A;Qt++){k=G;for(var Ft=g[at],vt=g[at+1],Jt=g[at+2],qt=g[at+3],At=0;At<x;At++)k.r=Ft,k.g=vt,k.b=Jt,k.a=qt,k=k.next;for(var lt=0,kt=0,_t=0,le=0,ie=x*Ft,ne=x*vt,te=x*Jt,wt=x*qt,Ut=T*Ft,fe=T*vt,j=T*Jt,bt=T*qt,It=1;It<x;It++){var Ht=at+((C<It?C:It)<<2),Ot=g[Ht],Ae=g[Ht+1],he=g[Ht+2],de=g[Ht+3],He=x-It;Ut+=(k.r=Ot)*He,fe+=(k.g=Ae)*He,j+=(k.b=he)*He,bt+=(k.a=de)*He,lt+=Ot,kt+=Ae,_t+=he,le+=de,k=k.next}$=G,O=W;for(var Re=0;Re<s;Re++){var je=bt*Lt>>>Tt;if(g[at+3]=je,je!==0){var Me=255/je;g[at]=(Ut*Lt>>>Tt)*Me,g[at+1]=(fe*Lt>>>Tt)*Me,g[at+2]=(j*Lt>>>Tt)*Me}else g[at]=g[at+1]=g[at+2]=0;Ut-=ie,fe-=ne,j-=te,bt-=wt,ie-=$.r,ne-=$.g,te-=$.b,wt-=$.a;var gi=Re+o+1;gi=tt+(gi<C?gi:C)<<2,lt+=$.r=g[gi],kt+=$.g=g[gi+1],_t+=$.b=g[gi+2],le+=$.a=g[gi+3],Ut+=lt,fe+=kt,j+=_t,bt+=le,$=$.next;var xt=O,Rt=xt.r,Li=xt.g,Ue=xt.b,Ee=xt.a;ie+=Rt,ne+=Li,te+=Ue,wt+=Ee,lt-=Rt,kt-=Li,_t-=Ue,le-=Ee,O=O.next,at+=4}tt+=s}for(var Ne=0;Ne<s;Ne++){at=Ne<<2;var Je=g[at],ze=g[at+1],ui=g[at+2],hi=g[at+3],Ei=x*Je,Pi=x*ze,Ie=x*ui,Oi=x*hi,mi=T*Je,Vi=T*ze,We=T*ui,Se=T*hi;k=G;for(var $e=0;$e<x;$e++)k.r=Je,k.g=ze,k.b=ui,k.a=hi,k=k.next;for(var di=s,Zi=0,qi=0,vi=0,tr=0,Lr=1;Lr<=o;Lr++){at=di+Ne<<2;var ft=x-Lr;mi+=(k.r=Je=g[at])*ft,Vi+=(k.g=ze=g[at+1])*ft,We+=(k.b=ui=g[at+2])*ft,Se+=(k.a=hi=g[at+3])*ft,tr+=Je,Zi+=ze,qi+=ui,vi+=hi,k=k.next,Lr<v&&(di+=s)}at=Ne,$=G,O=W;for(var Y=0;Y<A;Y++){var q=at<<2;g[q+3]=hi=Se*Lt>>>Tt,hi>0?(hi=255/hi,g[q]=(mi*Lt>>>Tt)*hi,g[q+1]=(Vi*Lt>>>Tt)*hi,g[q+2]=(We*Lt>>>Tt)*hi):g[q]=g[q+1]=g[q+2]=0,mi-=Ei,Vi-=Pi,We-=Ie,Se-=Oi,Ei-=$.r,Pi-=$.g,Ie-=$.b,Oi-=$.a,q=Ne+((q=Y+x)<v?q:v)*s<<2,mi+=tr+=$.r=g[q],Vi+=Zi+=$.g=g[q+1],We+=qi+=$.b=g[q+2],Se+=vi+=$.a=g[q+3],$=$.next,Ei+=Je=O.r,Pi+=ze=O.g,Ie+=ui=O.b,Oi+=hi=O.a,tr-=Je,Zi-=ze,qi-=ui,vi-=hi,O=O.next,at+=s}}return r}function b6(){var{DOMParser:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:r,createCanvas(i,s){return new OffscreenCanvas(i,s)},createImage(i){return xl(function*(){var s=yield fetch(i),A=yield s.blob(),o=yield createImageBitmap(A);return o})()}};return(typeof DOMParser<"u"||typeof r>"u")&&Reflect.deleteProperty(t,"DOMParser"),t}function v6(r){var{DOMParser:t,canvas:i,fetch:s}=r;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,fetch:s,createCanvas:i.createCanvas,createImage:i.loadImage}}function eu(r){return r.replace(/(?!\u3000)\s+/gm," ")}function Ox(r){return r.replace(/^[\n \t]+/,"")}function zx(r){return r.replace(/[\n \t]+$/,"")}function Vo(r){var t=(r||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return t.map(parseFloat)}function Jx(r){return B6.test(r)?r.toLowerCase():r}function yy(r){var t=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(r)||[];return t[2]||t[3]||t[4]}function Xx(r){if(!r.startsWith("rgb"))return r;var t=3,i=r.replace(/\d+(\.\d+)?/g,(s,A)=>t--&&A?String(Math.round(parseFloat(s))):s);return i}function Vc(r,t){var i=t.exec(r);return i?[r.replace(t," "),i.length]:[r,0]}function Yx(r){var t=[0,0,0],i=r.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),s=0;return[i,s]=Vc(i,_6),t[1]+=s,[i,s]=Vc(i,x6),t[0]+=s,[i,s]=Vc(i,S6),t[1]+=s,[i,s]=Vc(i,F6),t[2]+=s,[i,s]=Vc(i,k6),t[1]+=s,[i,s]=Vc(i,L6),t[1]+=s,i=i.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[i,s]=Vc(i,E6),t[2]+=s,t.join("")}function SI(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))}function Dp(r,t){return(r[0]*t[0]+r[1]*t[1])/(SI(r)*SI(t))}function FI(r,t){return(r[0]*t[1]<r[1]*t[0]?-1:1)*Math.acos(Dp(r,t))}function kI(r){return r*r*r}function LI(r){return 3*r*r*(1-r)}function EI(r){return 3*r*(1-r)*(1-r)}function TI(r){return(1-r)*(1-r)*(1-r)}function QI(r){return r*r}function UI(r){return 2*r*(1-r)}function GI(r){return(1-r)*(1-r)}function U6(r){return eu(r).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function G6(r){var[t,i]=r.split("(");return[t.trim(),i.trim().replace(")","")]}function R6(r){var t=r.trim();return/^('|")/.test(t)?t:'"'.concat(t,'"')}function H6(r){return typeof process>"u"?r:r.trim().split(",").map(R6).join(",")}function Z6(r){if(!r)return"";var t=r.trim().toLowerCase();switch(t){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return t;default:return/^oblique\s+(-|)\d+deg$/.test(t)?t:""}}function P6(r){if(!r)return"";var t=r.trim().toLowerCase();switch(t){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return t;default:return/^[\d.]+$/.test(t)?t:""}}function A_(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);t&&(s=s.filter(function(A){return Object.getOwnPropertyDescriptor(r,A).enumerable})),i.push.apply(i,s)}return i}function Fp(r){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?A_(Object(i),!0).forEach(function(s){Cy(r,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):A_(Object(i)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(i,s))})}return r}function kp(r,t,i,s,A,o){return r[i*s*4+t*4+o]}function Lp(r,t,i,s,A,o,g){r[i*s*4+t*4+o]=g}function Yn(r,t,i){var s=r[t];return s*i}function Bl(r,t,i,s){return t+Math.cos(r)*i+Math.sin(r)*s}function c_(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);t&&(s=s.filter(function(A){return Object.getOwnPropertyDescriptor(r,A).enumerable})),i.push.apply(i,s)}return i}function V6(r){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?c_(Object(i),!0).forEach(function(s){Cy(r,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):c_(Object(i)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(i,s))})}return r}function D6(r,t){var i=document.createElement("canvas");return i.width=r,i.height=t,i}function K6(r){return HI.apply(this,arguments)}function HI(){return HI=xl(function*(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=document.createElement("img");return t&&(i.crossOrigin="Anonymous"),new Promise((s,A)=>{i.onload=()=>{s(i)},i.onerror=(o,g,d,C,v)=>{A(v)},i.src=r})}),HI.apply(this,arguments)}function u_(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);t&&(s=s.filter(function(A){return Object.getOwnPropertyDescriptor(r,A).enumerable})),i.push.apply(i,s)}return i}function Dc(r){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?u_(Object(i),!0).forEach(function(s){Cy(r,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):u_(Object(i)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(i,s))})}return r}var Du,ug,Rn,Tg,Hn,iQ,lA,rQ,Ff,nQ,dp,Us,g_,d_,p_,sQ,ZI,f_,m_,$0,oQ,Zn,C_,aQ,AQ,jc,lQ,cQ,uQ,s0,hQ,I_,qc,gQ,dQ,JA,pQ,fQ,Qg,o0,Pn,mQ,XA,a0,CQ,IQ,$c,yQ,kf,Lf,y_,A0,aw,Aw,lw,cw,oA,Hp,PI,uw,bQ,vQ,wQ,b_,BQ,v_,_Q,xQ,SQ,FQ,kQ,w_,LQ,Ef,EQ,TQ,QQ,Sl,UQ,GQ,eh,l0,c0,u0,RQ,HQ,B_,hw,ZQ,MI,PQ,MQ,gw,dw,NI,pw,VI,NQ,VQ,Tf,DQ,KQ,WQ,cA,OQ,zQ,JQ,XQ,__,YQ,jQ,fw,qQ,$Q,tU,Ku,h0,eU,Is,iU,mw,Cw,rU,nU,sU,oU,aU,AU,lU,cU,x_,uU,Iw,tI,hU,Qf,gU,dU,pU,S_,fU,mU,CU,IU,yU,bU,vU,wU,yw,Fl,BU,_U,F_,xU,SU,FU,Xs,kU,LU,EU,pp,bw,TU,g0,QU,d0,p0,f0,UU,GU,RU,Ug,k_,eI,HU,L_,ZU,DI,PU,MU,Uf,NU,VU,iI,DU,KI,KU,WU,vw,OU,zU,JU,ww,WI,OI,XU,E_,YU,jU,m0,C0,qU,$U,Bw,rI,tG,Zp,bg,Pp,eG,iG,rA,Mc,Gf,zI,rG,nG,fp,nI,sG,oG,T_,aG,AG,_w,Ep,lG,cG,uG,hG,gG,dG,Q_,pG,fG,mG,CG,tu,U_,IG,yG,bG,vG,Rf,wG,BG,_G,xG,SG,FG,ih,kG,JI,LG,EG,TG,xw,G_,QG,I0,UG,GG,RG,Sw,R_,XI,HG,ZG,PG,H_,MG,NG,VG,DG,KG,WG,OG,Fw,zG,JG,XG,YG,jG,qG,$G,Gg,tR,eR,iR,rR,Z_,mp,nR,sR,oR,aR,AR,lR,vo,cR,uR,Rg,hR,gR,dR,pR,fR,mR,CR,IR,yR,bR,vR,wR,P_,BR,_R,xR,kw,Hf,Lw,SR,FR,kR,LR,ER,TR,Ew,QR,UR,GR,RR,HR,ZR,M_,PR,MR,NR,Tp,VR,DR,KR,WR,OR,YI,zR,JR,N_,XR,YR,jR,V_,D_,jI,qR,$R,hg,K_,tH,eH,iH,rH,nH,Tw,sH,oH,aH,AH,W_,lH,O_,Qw,Uw,z_,cH,uH,Zf,Gw,hH,gH,dH,qI,pH,J_,fH,mH,CH,IH,yH,X_,ha,bH,vH,Rw,wH,Y_,Hw,BH,Zw,_H,xH,SH,sI,oI,FH,y0,kH,Pw,LH,b0,Ig,Mw,vg,Nc,v0,w0,$I,B0,Nw,Vw,j_,Dw,EH,TH,QH,q_,$_,UH,GH,RH,HH,Yu,ZH,Kw,_0,PH,MH,NH,VH,x0,Ww,Ow,zw,Cp,aI,Zu,S0,F0,Ip,Jw,gg,dg,DH,KH,ty,WH,Pf,tx,OH,zH,JH,XH,yg,YH,jH,qH,$H,tZ,eZ,k0,iZ,AI,ex,rZ,Hg,rh,Xw,nZ,sZ,oZ,Mp,hc,ju,Yw,jw,aZ,AZ,lZ,Qp,cZ,uZ,hZ,ix,ey,gZ,dZ,pZ,rx,Np,iy,nx,Mf,sx,fZ,mZ,L0,CZ,Vu,Kc,yp,ox,lI,ry,cI,IZ,yZ,ax,bZ,qw,Ax,vZ,ny,lx,bp,$w,wZ,tB,cx,ux,hx,gx,BZ,eB,_Z,Wu,zu,uI,Zg,xZ,SZ,FZ,kZ,LZ,EZ,iB,TZ,QZ,UZ,GZ,dx,RZ,HZ,ZZ,PZ,MZ,NZ,VZ,DZ,rB,KZ,WZ,OZ,zZ,JZ,XZ,YZ,jZ,nB,qZ,$Z,sB,tP,Up,oB,px,eP,fx,mx,aB,E0,iP,rP,nP,sP,Cx,oP,aP,AP,lP,cP,uP,hP,gP,dP,hI,pP,fP,mP,AB,T0,CP,IP,yP,bP,vP,wP,BP,_P,xP,SP,FP,kP,LP,EP,TP,QP,UP,GP,RP,HP,YA,ZP,Ix,sy,PP,oy,ay,MP,NP,yx,bx,VP,DP,KP,WP,OP,zP,JP,XP,YP,jP,qP,cB,$P,tM,eM,iM,uB,hB,gI,dI,vx,Q0,wx,gB,rM,vp,Gp,Ay,nM,sM,oM,aM,AM,lM,cM,uM,Ou,Nf,hM,gM,dM,pM,fM,mM,CM,IM,yM,Vp,pI,bM,vM,wM,U0,fI,Bx,mI,BM,ly,_M,dB,pB,fB,xM,mB,_x,SM,FM,G0,cy,uy,kM,LM,EM,TM,CB,QM,IB,UM,GM,hy,yB,RM,HM,ZM,PM,MM,gy,NM,VM,DM,KM,WM,R0,OM,zM,JM,bB,dy,XM,YM,H0,jM,Z0,qM,$M,tN,eN,vB,Vf,iN,rN,nN,sN,oN,aN,AN,Pu,lN,cN,uN,hN,gN,dN,CI,pN,fN,mN,P0,wB,BB,CN,IN,_B,yN,bN,vN,wN,BN,_N,xN,SN,py,FN,kN,fy,LN,EN,TN,QN,xB,UN,GN,RN,HN,ZN,xx,PN,MN,NN,VN,II,yI,DN,KN,WN,ON,zN,JN,XN,YN,SB,bI,jN,Sx,qN,$N,tV,FB,eV,iV,vI,Fx,Oc,M0,N0,rV,kx,nV,sV,oV,aV,AV,lV,cV,uV,hV,Lx,gV,dV,kB,LB,pV,fV,V0,mV,CV,Ex,IV,yV,EB,wp,pg,TB,fg,QB,bV,vV,wV,BV,my,UB,Tx,_V,xV,Bp,SV,Qx,FV,kV,LV,GB,EV,TV,D0,RB,QV,HB,Ux,UV,mg,ZB,GV,RV,K0,W0,Gx,_p,PV,MV,NV,VV,PB,MB,NB,DV,KV,Rx,WV,OV,zV,VB,JV,XV,YV,jV,qV,$V,t9,DB,e9,i9,r9,n9,s9,Hx,o9,O0,Zx,a9,A9,l9,c9,u9,h9,g9,KB,d9,WB,p9,f9,Mu,m9,C9,z0,J0,I9,OB,Df,Cg,y9,b9,_l,xp,Ju,qu,wg,Nu,Sp,X0,lc,zB,v9,Y0,Px,w9,B9,_9,wI,JB,x9,S9,j0,F9,k9,L9,XB,YB,E9,T9,Q9,U9,G9,BI,R9,H9,Z9,P9,_I,Mx,M9,N9,V9,D9,K9,jB,W9,O9,z9,J9,X9,Y9,j9,q9,qB,Nx,cc,jn,wl,nA,Dx,t6,n_,e6,De,i6,r6,n6,s6,o6,s_,a6,A6,l6,c6,o_,u6,h6,Iy,Kx,Wx,g6,d6,f6,m6,a_,w6,B6,_6,x6,S6,F6,k6,L6,E6,Wc,Ki,Kp,In,Wp,jx,qx,zc,T6,Q6,Xu,Op,zp,Jp,Bg,_g,Xp,Yp,OA,tn,jp,Cs,Do,Ar,zA,Pr,xg,AA,Jc,RI,gc,Sg,qp,$p,tf,Fg,ef,rf,nf,sf,$u,kg,of,af,Af,th,lf,cf,uf,hf,gf,df,pf,ff,M6,mf,Cf,If,Lg,yf,Eg,Xc,l_,bf,Yc,vf,wf,Bf,_f,xf,Sf,N6,aA,uc,t5=dd(()=>{by();Du=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};ug=function(r){return r&&r.Math===Math&&r},Rn=ug(typeof globalThis=="object"&&globalThis)||ug(typeof window=="object"&&window)||ug(typeof self=="object"&&self)||ug(typeof Du=="object"&&Du)||ug(typeof Du=="object"&&Du)||function(){return this}()||Function("return this")(),Tg={},Hn=function(r){try{return!!r()}catch{return!0}},iQ=Hn,lA=!iQ(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),rQ=Hn,Ff=!rQ(function(){var r=function(){}.bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),nQ=Ff,dp=Function.prototype.call,Us=nQ?dp.bind(dp):function(){return dp.apply(dp,arguments)},g_={},d_={}.propertyIsEnumerable,p_=Object.getOwnPropertyDescriptor,sQ=p_&&!d_.call({1:2},1);g_.f=sQ?function(r){var t=p_(this,r);return!!t&&t.enumerable}:d_;ZI=function(r,t){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:t}},f_=Ff,m_=Function.prototype,$0=m_.call,oQ=f_&&m_.bind.bind($0,$0),Zn=f_?oQ:function(r){return function(){return $0.apply(r,arguments)}},C_=Zn,aQ=C_({}.toString),AQ=C_("".slice),jc=function(r){return AQ(aQ(r),8,-1)},lQ=Zn,cQ=Hn,uQ=jc,s0=Object,hQ=lQ("".split),I_=cQ(function(){return!s0("z").propertyIsEnumerable(0)})?function(r){return uQ(r)==="String"?hQ(r,""):s0(r)}:s0,qc=function(r){return r==null},gQ=qc,dQ=TypeError,JA=function(r){if(gQ(r))throw new dQ("Can't call method on "+r);return r},pQ=I_,fQ=JA,Qg=function(r){return pQ(fQ(r))},o0=typeof document=="object"&&document.all,Pn=typeof o0>"u"&&o0!==void 0?function(r){return typeof r=="function"||r===o0}:function(r){return typeof r=="function"},mQ=Pn,XA=function(r){return typeof r=="object"?r!==null:mQ(r)},a0=Rn,CQ=Pn,IQ=function(r){return CQ(r)?r:void 0},$c=function(r,t){return arguments.length<2?IQ(a0[r]):a0[r]&&a0[r][t]},yQ=Zn,kf=yQ({}.isPrototypeOf),Lf=typeof navigator<"u"&&String(navigator.userAgent)||"",y_=Rn,A0=Lf,aw=y_.process,Aw=y_.Deno,lw=aw&&aw.versions||Aw&&Aw.version,cw=lw&&lw.v8;cw&&(oA=cw.split("."),Hp=oA[0]>0&&oA[0]<4?1:+(oA[0]+oA[1]));!Hp&&A0&&(oA=A0.match(/Edge\/(\d+)/),(!oA||oA[1]>=74)&&(oA=A0.match(/Chrome\/(\d+)/),oA&&(Hp=+oA[1])));PI=Hp,uw=PI,bQ=Hn,vQ=Rn,wQ=vQ.String,b_=!!Object.getOwnPropertySymbols&&!bQ(function(){var r=Symbol("symbol detection");return!wQ(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&uw&&uw<41}),BQ=b_,v_=BQ&&!Symbol.sham&&typeof Symbol.iterator=="symbol",_Q=$c,xQ=Pn,SQ=kf,FQ=v_,kQ=Object,w_=FQ?function(r){return typeof r=="symbol"}:function(r){var t=_Q("Symbol");return xQ(t)&&SQ(t.prototype,kQ(r))},LQ=String,Ef=function(r){try{return LQ(r)}catch{return"Object"}},EQ=Pn,TQ=Ef,QQ=TypeError,Sl=function(r){if(EQ(r))return r;throw new QQ(TQ(r)+" is not a function")},UQ=Sl,GQ=qc,eh=function(r,t){var i=r[t];return GQ(i)?void 0:UQ(i)},l0=Us,c0=Pn,u0=XA,RQ=TypeError,HQ=function(r,t){var i,s;if(t==="string"&&c0(i=r.toString)&&!u0(s=l0(i,r))||c0(i=r.valueOf)&&!u0(s=l0(i,r))||t!=="string"&&c0(i=r.toString)&&!u0(s=l0(i,r)))return s;throw new RQ("Can't convert object to primitive value")},B_={exports:{}},hw=Rn,ZQ=Object.defineProperty,MI=function(r,t){try{ZQ(hw,r,{value:t,configurable:!0,writable:!0})}catch{hw[r]=t}return t},PQ=Rn,MQ=MI,gw="__core-js_shared__",dw=B_.exports=PQ[gw]||MQ(gw,{});(dw.versions||(dw.versions=[])).push({version:"3.36.0",mode:"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.0/LICENSE",source:"https://github.com/zloirock/core-js"});NI=B_.exports,pw=NI,VI=function(r,t){return pw[r]||(pw[r]=t||{})},NQ=JA,VQ=Object,Tf=function(r){return VQ(NQ(r))},DQ=Zn,KQ=Tf,WQ=DQ({}.hasOwnProperty),cA=Object.hasOwn||function(r,t){return WQ(KQ(r),t)},OQ=Zn,zQ=0,JQ=Math.random(),XQ=OQ(1 .toString),__=function(r){return"Symbol("+(r===void 0?"":r)+")_"+XQ(++zQ+JQ,36)},YQ=Rn,jQ=VI,fw=cA,qQ=__,$Q=b_,tU=v_,Ku=YQ.Symbol,h0=jQ("wks"),eU=tU?Ku.for||Ku:Ku&&Ku.withoutSetter||qQ,Is=function(r){return fw(h0,r)||(h0[r]=$Q&&fw(Ku,r)?Ku[r]:eU("Symbol."+r)),h0[r]},iU=Us,mw=XA,Cw=w_,rU=eh,nU=HQ,sU=Is,oU=TypeError,aU=sU("toPrimitive"),AU=function(r,t){if(!mw(r)||Cw(r))return r;var i=rU(r,aU),s;if(i){if(t===void 0&&(t="default"),s=iU(i,r,t),!mw(s)||Cw(s))return s;throw new oU("Can't convert object to primitive value")}return t===void 0&&(t="number"),nU(r,t)},lU=AU,cU=w_,x_=function(r){var t=lU(r,"string");return cU(t)?t:t+""},uU=Rn,Iw=XA,tI=uU.document,hU=Iw(tI)&&Iw(tI.createElement),Qf=function(r){return hU?tI.createElement(r):{}},gU=lA,dU=Hn,pU=Qf,S_=!gU&&!dU(function(){return Object.defineProperty(pU("div"),"a",{get:function(){return 7}}).a!==7}),fU=lA,mU=Us,CU=g_,IU=ZI,yU=Qg,bU=x_,vU=cA,wU=S_,yw=Object.getOwnPropertyDescriptor;Tg.f=fU?yw:function(r,t){if(r=yU(r),t=bU(t),wU)try{return yw(r,t)}catch{}if(vU(r,t))return IU(!mU(CU.f,r,t),r[t])};Fl={},BU=lA,_U=Hn,F_=BU&&_U(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),xU=XA,SU=String,FU=TypeError,Xs=function(r){if(xU(r))return r;throw new FU(SU(r)+" is not an object")},kU=lA,LU=S_,EU=F_,pp=Xs,bw=x_,TU=TypeError,g0=Object.defineProperty,QU=Object.getOwnPropertyDescriptor,d0="enumerable",p0="configurable",f0="writable";Fl.f=kU?EU?function(r,t,i){if(pp(r),t=bw(t),pp(i),typeof r=="function"&&t==="prototype"&&"value"in i&&f0 in i&&!i[f0]){var s=QU(r,t);s&&s[f0]&&(r[t]=i.value,i={configurable:p0 in i?i[p0]:s[p0],enumerable:d0 in i?i[d0]:s[d0],writable:!1})}return g0(r,t,i)}:g0:function(r,t,i){if(pp(r),t=bw(t),pp(i),LU)try{return g0(r,t,i)}catch{}if("get"in i||"set"in i)throw new TU("Accessors not supported");return"value"in i&&(r[t]=i.value),r};UU=lA,GU=Fl,RU=ZI,Ug=UU?function(r,t,i){return GU.f(r,t,RU(1,i))}:function(r,t,i){return r[t]=i,r},k_={exports:{}},eI=lA,HU=cA,L_=Function.prototype,ZU=eI&&Object.getOwnPropertyDescriptor,DI=HU(L_,"name"),PU=DI&&function(){}.name==="something",MU=DI&&(!eI||eI&&ZU(L_,"name").configurable),Uf={EXISTS:DI,PROPER:PU,CONFIGURABLE:MU},NU=Zn,VU=Pn,iI=NI,DU=NU(Function.toString);VU(iI.inspectSource)||(iI.inspectSource=function(r){return DU(r)});KI=iI.inspectSource,KU=Rn,WU=Pn,vw=KU.WeakMap,OU=WU(vw)&&/native code/.test(String(vw)),zU=VI,JU=__,ww=zU("keys"),WI=function(r){return ww[r]||(ww[r]=JU(r))},OI={},XU=OU,E_=Rn,YU=XA,jU=Ug,m0=cA,C0=NI,qU=WI,$U=OI,Bw="Object already initialized",rI=E_.TypeError,tG=E_.WeakMap,eG=function(r){return Pp(r)?bg(r):Zp(r,{})},iG=function(r){return function(t){var i;if(!YU(t)||(i=bg(t)).type!==r)throw new rI("Incompatible receiver, "+r+" required");return i}};XU||C0.state?(rA=C0.state||(C0.state=new tG),rA.get=rA.get,rA.has=rA.has,rA.set=rA.set,Zp=function(r,t){if(rA.has(r))throw new rI(Bw);return t.facade=r,rA.set(r,t),t},bg=function(r){return rA.get(r)||{}},Pp=function(r){return rA.has(r)}):(Mc=qU("state"),$U[Mc]=!0,Zp=function(r,t){if(m0(r,Mc))throw new rI(Bw);return t.facade=r,jU(r,Mc,t),t},bg=function(r){return m0(r,Mc)?r[Mc]:{}},Pp=function(r){return m0(r,Mc)});Gf={set:Zp,get:bg,has:Pp,enforce:eG,getterFor:iG},zI=Zn,rG=Hn,nG=Pn,fp=cA,nI=lA,sG=Uf.CONFIGURABLE,oG=KI,T_=Gf,aG=T_.enforce,AG=T_.get,_w=String,Ep=Object.defineProperty,lG=zI("".slice),cG=zI("".replace),uG=zI([].join),hG=nI&&!rG(function(){return Ep(function(){},"length",{value:8}).length!==8}),gG=String(String).split("String"),dG=k_.exports=function(r,t,i){lG(_w(t),0,7)==="Symbol("&&(t="["+cG(_w(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(t="get "+t),i&&i.setter&&(t="set "+t),(!fp(r,"name")||sG&&r.name!==t)&&(nI?Ep(r,"name",{value:t,configurable:!0}):r.name=t),hG&&i&&fp(i,"arity")&&r.length!==i.arity&&Ep(r,"length",{value:i.arity});try{i&&fp(i,"constructor")&&i.constructor?nI&&Ep(r,"prototype",{writable:!1}):r.prototype&&(r.prototype=void 0)}catch{}var s=aG(r);return fp(s,"source")||(s.source=uG(gG,typeof t=="string"?t:"")),r};Function.prototype.toString=dG(function(){return nG(this)&&AG(this).source||oG(this)},"toString");Q_=k_.exports,pG=Pn,fG=Fl,mG=Q_,CG=MI,tu=function(r,t,i,s){s||(s={});var A=s.enumerable,o=s.name!==void 0?s.name:t;if(pG(i)&&mG(i,o,s),s.global)A?r[t]=i:CG(t,i);else{try{s.unsafe?r[t]&&(A=!0):delete r[t]}catch{}A?r[t]=i:fG.f(r,t,{value:i,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return r},U_={},IG=Math.ceil,yG=Math.floor,bG=Math.trunc||function(r){var t=+r;return(t>0?yG:IG)(t)},vG=bG,Rf=function(r){var t=+r;return t!==t||t===0?0:vG(t)},wG=Rf,BG=Math.max,_G=Math.min,xG=function(r,t){var i=wG(r);return i<0?BG(i+t,0):_G(i,t)},SG=Rf,FG=Math.min,ih=function(r){var t=SG(r);return t>0?FG(t,9007199254740991):0},kG=ih,JI=function(r){return kG(r.length)},LG=Qg,EG=xG,TG=JI,xw=function(r){return function(t,i,s){var A=LG(t),o=TG(A);if(o===0)return!r&&-1;var g=EG(s,o),d;if(r&&i!==i){for(;o>g;)if(d=A[g++],d!==d)return!0}else for(;o>g;g++)if((r||g in A)&&A[g]===i)return r||g||0;return!r&&-1}},G_={includes:xw(!0),indexOf:xw(!1)},QG=Zn,I0=cA,UG=Qg,GG=G_.indexOf,RG=OI,Sw=QG([].push),R_=function(r,t){var i=UG(r),s=0,A=[],o;for(o in i)!I0(RG,o)&&I0(i,o)&&Sw(A,o);for(;t.length>s;)I0(i,o=t[s++])&&(~GG(A,o)||Sw(A,o));return A},XI=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],HG=R_,ZG=XI,PG=ZG.concat("length","prototype");U_.f=Object.getOwnPropertyNames||function(r){return HG(r,PG)};H_={};H_.f=Object.getOwnPropertySymbols;MG=$c,NG=Zn,VG=U_,DG=H_,KG=Xs,WG=NG([].concat),OG=MG("Reflect","ownKeys")||function(r){var t=VG.f(KG(r)),i=DG.f;return i?WG(t,i(r)):t},Fw=cA,zG=OG,JG=Tg,XG=Fl,YG=function(r,t,i){for(var s=zG(t),A=XG.f,o=JG.f,g=0;g<s.length;g++){var d=s[g];!Fw(r,d)&&!(i&&Fw(i,d))&&A(r,d,o(t,d))}},jG=Hn,qG=Pn,$G=/#|\.prototype\./,Gg=function(r,t){var i=eR[tR(r)];return i===rR?!0:i===iR?!1:qG(t)?jG(t):!!t},tR=Gg.normalize=function(r){return String(r).replace($G,".").toLowerCase()},eR=Gg.data={},iR=Gg.NATIVE="N",rR=Gg.POLYFILL="P",Z_=Gg,mp=Rn,nR=Tg.f,sR=Ug,oR=tu,aR=MI,AR=YG,lR=Z_,vo=function(r,t){var i=r.target,s=r.global,A=r.stat,o,g,d,C,v,x;if(s?g=mp:A?g=mp[i]||aR(i,{}):g=mp[i]&&mp[i].prototype,g)for(d in t){if(v=t[d],r.dontCallGetSet?(x=nR(g,d),C=x&&x.value):C=g[d],o=lR(s?d:i+(A?".":"#")+d,r.forced),!o&&C!==void 0){if(typeof v==typeof C)continue;AR(v,C)}(r.sham||C&&C.sham)&&sR(v,"sham",!0),oR(g,d,v,r)}},cR=Rn,uR=jc,Rg=uR(cR.process)==="process",hR=Zn,gR=Sl,dR=function(r,t,i){try{return hR(gR(Object.getOwnPropertyDescriptor(r,t)[i]))}catch{}},pR=XA,fR=function(r){return pR(r)||r===null},mR=fR,CR=String,IR=TypeError,yR=function(r){if(mR(r))return r;throw new IR("Can't set "+CR(r)+" as a prototype")},bR=dR,vR=Xs,wR=yR,P_=Object.setPrototypeOf||("__proto__"in{}?function(){var r=!1,t={},i;try{i=bR(Object.prototype,"__proto__","set"),i(t,[]),r=t instanceof Array}catch{}return function(s,A){return vR(s),wR(A),r?i(s,A):s.__proto__=A,s}}():void 0),BR=Fl.f,_R=cA,xR=Is,kw=xR("toStringTag"),Hf=function(r,t,i){r&&!i&&(r=r.prototype),r&&!_R(r,kw)&&BR(r,kw,{configurable:!0,value:t})},Lw=Q_,SR=Fl,FR=function(r,t,i){return i.get&&Lw(i.get,t,{getter:!0}),i.set&&Lw(i.set,t,{setter:!0}),SR.f(r,t,i)},kR=$c,LR=FR,ER=Is,TR=lA,Ew=ER("species"),QR=function(r){var t=kR(r);TR&&t&&!t[Ew]&&LR(t,Ew,{configurable:!0,get:function(){return this}})},UR=kf,GR=TypeError,RR=function(r,t){if(UR(t,r))return r;throw new GR("Incorrect invocation")},HR=Is,ZR=HR("toStringTag"),M_={};M_[ZR]="z";PR=String(M_)==="[object z]",MR=PR,NR=Pn,Tp=jc,VR=Is,DR=VR("toStringTag"),KR=Object,WR=Tp(function(){return arguments}())==="Arguments",OR=function(r,t){try{return r[t]}catch{}},YI=MR?Tp:function(r){var t,i,s;return r===void 0?"Undefined":r===null?"Null":typeof(i=OR(t=KR(r),DR))=="string"?i:WR?Tp(t):(s=Tp(t))==="Object"&&NR(t.callee)?"Arguments":s},zR=Zn,JR=Hn,N_=Pn,XR=YI,YR=$c,jR=KI,V_=function(){},D_=YR("Reflect","construct"),jI=/^\s*(?:class|function)\b/,qR=zR(jI.exec),$R=!jI.test(V_),hg=function(r){if(!N_(r))return!1;try{return D_(V_,[],r),!0}catch{return!1}},K_=function(r){if(!N_(r))return!1;switch(XR(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return $R||!!qR(jI,jR(r))}catch{return!0}};K_.sham=!0;tH=!D_||JR(function(){var r;return hg(hg.call)||!hg(Object)||!hg(function(){r=!0})||r})?K_:hg,eH=tH,iH=Ef,rH=TypeError,nH=function(r){if(eH(r))return r;throw new rH(iH(r)+" is not a constructor")},Tw=Xs,sH=nH,oH=qc,aH=Is,AH=aH("species"),W_=function(r,t){var i=Tw(r).constructor,s;return i===void 0||oH(s=Tw(i)[AH])?t:sH(s)},lH=Ff,O_=Function.prototype,Qw=O_.apply,Uw=O_.call,z_=typeof Reflect=="object"&&Reflect.apply||(lH?Uw.bind(Qw):function(){return Uw.apply(Qw,arguments)}),cH=jc,uH=Zn,Zf=function(r){if(cH(r)==="Function")return uH(r)},Gw=Zf,hH=Sl,gH=Ff,dH=Gw(Gw.bind),qI=function(r,t){return hH(r),t===void 0?r:gH?dH(r,t):function(){return r.apply(t,arguments)}},pH=$c,J_=pH("document","documentElement"),fH=Zn,mH=fH([].slice),CH=TypeError,IH=function(r,t){if(r<t)throw new CH("Not enough arguments");return r},yH=Lf,X_=/(?:ipad|iphone|ipod).*applewebkit/i.test(yH),ha=Rn,bH=z_,vH=qI,Rw=Pn,wH=cA,Y_=Hn,Hw=J_,BH=mH,Zw=Qf,_H=IH,xH=X_,SH=Rg,sI=ha.setImmediate,oI=ha.clearImmediate,FH=ha.process,y0=ha.Dispatch,kH=ha.Function,Pw=ha.MessageChannel,LH=ha.String,b0=0,Ig={},Mw="onreadystatechange";Y_(function(){vg=ha.location});$I=function(r){if(wH(Ig,r)){var t=Ig[r];delete Ig[r],t()}},B0=function(r){return function(){$I(r)}},Nw=function(r){$I(r.data)},Vw=function(r){ha.postMessage(LH(r),vg.protocol+"//"+vg.host)};(!sI||!oI)&&(sI=function(r){_H(arguments.length,1);var t=Rw(r)?r:kH(r),i=BH(arguments,1);return Ig[++b0]=function(){bH(t,void 0,i)},Nc(b0),b0},oI=function(r){delete Ig[r]},SH?Nc=function(r){FH.nextTick(B0(r))}:y0&&y0.now?Nc=function(r){y0.now(B0(r))}:Pw&&!xH?(v0=new Pw,w0=v0.port2,v0.port1.onmessage=Nw,Nc=vH(w0.postMessage,w0)):ha.addEventListener&&Rw(ha.postMessage)&&!ha.importScripts&&vg&&vg.protocol!=="file:"&&!Y_(Vw)?(Nc=Vw,ha.addEventListener("message",Nw,!1)):Mw in Zw("script")?Nc=function(r){Hw.appendChild(Zw("script"))[Mw]=function(){Hw.removeChild(this),$I(r)}}:Nc=function(r){setTimeout(B0(r),0)});j_={set:sI,clear:oI},Dw=Rn,EH=lA,TH=Object.getOwnPropertyDescriptor,QH=function(r){if(!EH)return Dw[r];var t=TH(Dw,r);return t&&t.value},q_=function(){this.head=null,this.tail=null};q_.prototype={add:function(r){var t={item:r,next:null},i=this.tail;i?i.next=t:this.head=t,this.tail=t},get:function(){var r=this.head;if(r){var t=this.head=r.next;return t===null&&(this.tail=null),r.item}}};$_=q_,UH=Lf,GH=/ipad|iphone|ipod/i.test(UH)&&typeof Pebble<"u",RH=Lf,HH=/web0s(?!.*chrome)/i.test(RH),Yu=Rn,ZH=QH,Kw=qI,_0=j_.set,PH=$_,MH=X_,NH=GH,VH=HH,x0=Rg,Ww=Yu.MutationObserver||Yu.WebKitMutationObserver,Ow=Yu.document,zw=Yu.process,Cp=Yu.Promise,aI=ZH("queueMicrotask");aI||(gg=new PH,dg=function(){var r,t;for(x0&&(r=zw.domain)&&r.exit();t=gg.get();)try{t()}catch(i){throw gg.head&&Zu(),i}r&&r.enter()},!MH&&!x0&&!VH&&Ww&&Ow?(S0=!0,F0=Ow.createTextNode(""),new Ww(dg).observe(F0,{characterData:!0}),Zu=function(){F0.data=S0=!S0}):!NH&&Cp&&Cp.resolve?(Ip=Cp.resolve(void 0),Ip.constructor=Cp,Jw=Kw(Ip.then,Ip),Zu=function(){Jw(dg)}):x0?Zu=function(){zw.nextTick(dg)}:(_0=Kw(_0,Yu),Zu=function(){_0(dg)}),aI=function(r){gg.head||Zu(),gg.add(r)});DH=aI,KH=function(r,t){try{arguments.length===1?console.error(r):console.error(r,t)}catch{}},ty=function(r){try{return{error:!1,value:r()}}catch(t){return{error:!0,value:t}}},WH=Rn,Pf=WH.Promise,tx=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",OH=tx,zH=Rg,JH=!OH&&!zH&&typeof window=="object"&&typeof document=="object",XH=Rn,yg=Pf,YH=Pn,jH=Z_,qH=KI,$H=Is,tZ=JH,eZ=tx,k0=PI;yg&&yg.prototype;iZ=$H("species"),AI=!1,ex=YH(XH.PromiseRejectionEvent),rZ=jH("Promise",function(){var r=qH(yg),t=r!==String(yg);if(!t&&k0===66)return!0;if(!k0||k0<51||!/native code/.test(r)){var i=new yg(function(o){o(1)}),s=function(o){o(function(){},function(){})},A=i.constructor={};if(A[iZ]=s,AI=i.then(function(){})instanceof s,!AI)return!0}return!t&&(tZ||eZ)&&!ex}),Hg={CONSTRUCTOR:rZ,REJECTION_EVENT:ex,SUBCLASSING:AI},rh={},Xw=Sl,nZ=TypeError,sZ=function(r){var t,i;this.promise=new r(function(s,A){if(t!==void 0||i!==void 0)throw new nZ("Bad Promise constructor");t=s,i=A}),this.resolve=Xw(t),this.reject=Xw(i)};rh.f=function(r){return new sZ(r)};oZ=vo,Mp=Rg,hc=Rn,ju=Us,Yw=tu,jw=P_,aZ=Hf,AZ=QR,lZ=Sl,Qp=Pn,cZ=XA,uZ=RR,hZ=W_,ix=j_.set,ey=DH,gZ=KH,dZ=ty,pZ=$_,rx=Gf,Np=Pf,iy=Hg,nx=rh,Mf="Promise",sx=iy.CONSTRUCTOR,fZ=iy.REJECTION_EVENT,mZ=iy.SUBCLASSING,L0=rx.getterFor(Mf),CZ=rx.set,Vu=Np&&Np.prototype,Kc=Np,yp=Vu,ox=hc.TypeError,lI=hc.document,ry=hc.process,cI=nx.f,IZ=cI,yZ=!!(lI&&lI.createEvent&&hc.dispatchEvent),ax="unhandledrejection",bZ="rejectionhandled",qw=0,Ax=1,vZ=2,ny=1,lx=2,cx=function(r){var t;return cZ(r)&&Qp(t=r.then)?t:!1},ux=function(r,t){var i=t.value,s=t.state===Ax,A=s?r.ok:r.fail,o=r.resolve,g=r.reject,d=r.domain,C,v,x;try{A?(s||(t.rejection===lx&&_Z(t),t.rejection=ny),A===!0?C=i:(d&&d.enter(),C=A(i),d&&(d.exit(),x=!0)),C===r.promise?g(new ox("Promise-chain cycle")):(v=cx(C))?ju(v,C,o,g):o(C)):g(i)}catch(T){d&&!x&&d.exit(),g(T)}},hx=function(r,t){r.notified||(r.notified=!0,ey(function(){for(var i=r.reactions,s;s=i.get();)ux(s,r);r.notified=!1,t&&!r.rejection&&BZ(r)}))},gx=function(r,t,i){var s,A;yZ?(s=lI.createEvent("Event"),s.promise=t,s.reason=i,s.initEvent(r,!1,!0),hc.dispatchEvent(s)):s={promise:t,reason:i},!fZ&&(A=hc["on"+r])?A(s):r===ax&&gZ("Unhandled promise rejection",i)},BZ=function(r){ju(ix,hc,function(){var t=r.facade,i=r.value,s=eB(r),A;if(s&&(A=dZ(function(){Mp?ry.emit("unhandledRejection",i,t):gx(ax,t,i)}),r.rejection=Mp||eB(r)?lx:ny,A.error))throw A.value})},eB=function(r){return r.rejection!==ny&&!r.parent},_Z=function(r){ju(ix,hc,function(){var t=r.facade;Mp?ry.emit("rejectionHandled",t):gx(bZ,t,r.value)})},Wu=function(r,t,i){return function(s){r(t,s,i)}},zu=function(r,t,i){r.done||(r.done=!0,i&&(r=i),r.value=t,r.state=vZ,hx(r,!0))},uI=function(r,t,i){if(!r.done){r.done=!0,i&&(r=i);try{if(r.facade===t)throw new ox("Promise can't be resolved itself");var s=cx(t);s?ey(function(){var A={done:!1};try{ju(s,t,Wu(uI,A,r),Wu(zu,A,r))}catch(o){zu(A,o,r)}}):(r.value=t,r.state=Ax,hx(r,!1))}catch(A){zu({done:!1},A,r)}}};if(sx&&(Kc=function(r){uZ(this,yp),lZ(r),ju(bp,this);var t=L0(this);try{r(Wu(uI,t),Wu(zu,t))}catch(i){zu(t,i)}},yp=Kc.prototype,bp=function(r){CZ(this,{type:Mf,done:!1,notified:!1,parent:!1,reactions:new pZ,rejection:!1,state:qw,value:void 0})},bp.prototype=Yw(yp,"then",function(r,t){var i=L0(this),s=cI(hZ(this,Kc));return i.parent=!0,s.ok=Qp(r)?r:!0,s.fail=Qp(t)&&t,s.domain=Mp?ry.domain:void 0,i.state===qw?i.reactions.add(s):ey(function(){ux(s,i)}),s.promise}),$w=function(){var r=new bp,t=L0(r);this.promise=r,this.resolve=Wu(uI,t),this.reject=Wu(zu,t)},nx.f=cI=function(r){return r===Kc||r===wZ?new $w(r):IZ(r)},Qp(Np)&&Vu!==Object.prototype)){tB=Vu.then,mZ||Yw(Vu,"then",function(r,t){var i=this;return new Kc(function(s,A){ju(tB,i,s,A)}).then(r,t)},{unsafe:!0});try{delete Vu.constructor}catch{}jw&&jw(Vu,yp)}oZ({global:!0,constructor:!0,wrap:!0,forced:sx},{Promise:Kc});aZ(Kc,Mf,!1);AZ(Mf);Zg={},xZ=Is,SZ=Zg,FZ=xZ("iterator"),kZ=Array.prototype,LZ=function(r){return r!==void 0&&(SZ.Array===r||kZ[FZ]===r)},EZ=YI,iB=eh,TZ=qc,QZ=Zg,UZ=Is,GZ=UZ("iterator"),dx=function(r){if(!TZ(r))return iB(r,GZ)||iB(r,"@@iterator")||QZ[EZ(r)]},RZ=Us,HZ=Sl,ZZ=Xs,PZ=Ef,MZ=dx,NZ=TypeError,VZ=function(r,t){var i=arguments.length<2?MZ(r):t;if(HZ(i))return ZZ(RZ(i,r));throw new NZ(PZ(r)+" is not iterable")},DZ=Us,rB=Xs,KZ=eh,WZ=function(r,t,i){var s,A;rB(r);try{if(s=KZ(r,"return"),!s){if(t==="throw")throw i;return i}s=DZ(s,r)}catch(o){A=!0,s=o}if(t==="throw")throw i;if(A)throw s;return rB(s),i},OZ=qI,zZ=Us,JZ=Xs,XZ=Ef,YZ=LZ,jZ=JI,nB=kf,qZ=VZ,$Z=dx,sB=WZ,tP=TypeError,Up=function(r,t){this.stopped=r,this.result=t},oB=Up.prototype,px=function(r,t,i){var s=i&&i.that,A=!!(i&&i.AS_ENTRIES),o=!!(i&&i.IS_RECORD),g=!!(i&&i.IS_ITERATOR),d=!!(i&&i.INTERRUPTED),C=OZ(t,s),v,x,T,G,k,W,K,$=function(tt){return v&&sB(v,"normal",tt),new Up(!0,tt)},O=function(tt){return A?(JZ(tt),d?C(tt[0],tt[1],$):C(tt[0],tt[1])):d?C(tt,$):C(tt)};if(o)v=r.iterator;else if(g)v=r;else{if(x=$Z(r),!x)throw new tP(XZ(r)+" is not iterable");if(YZ(x)){for(T=0,G=jZ(r);G>T;T++)if(k=O(r[T]),k&&nB(oB,k))return k;return new Up(!1)}v=qZ(r,x)}for(W=o?r.next:v.next;!(K=zZ(W,v)).done;){try{k=O(K.value)}catch(tt){sB(v,"throw",tt)}if(typeof k=="object"&&k&&nB(oB,k))return k}return new Up(!1)},eP=Is,fx=eP("iterator"),mx=!1;try{aB=0,E0={next:function(){return{done:!!aB++}},return:function(){mx=!0}},E0[fx]=function(){return this},Array.from(E0,function(){throw 2})}catch{}iP=function(r,t){try{if(!t&&!mx)return!1}catch{return!1}var i=!1;try{var s={};s[fx]=function(){return{next:function(){return{done:i=!0}}}},r(s)}catch{}return i},rP=Pf,nP=iP,sP=Hg.CONSTRUCTOR,Cx=sP||!nP(function(r){rP.all(r).then(void 0,function(){})}),oP=vo,aP=Us,AP=Sl,lP=rh,cP=ty,uP=px,hP=Cx;oP({target:"Promise",stat:!0,forced:hP},{all:function(r){var t=this,i=lP.f(t),s=i.resolve,A=i.reject,o=cP(function(){var g=AP(t.resolve),d=[],C=0,v=1;uP(r,function(x){var T=C++,G=!1;v++,aP(g,t,x).then(function(k){G||(G=!0,d[T]=k,--v||s(d))},A)}),--v||s(d)});return o.error&&A(o.value),i.promise}});gP=vo,dP=Hg.CONSTRUCTOR,hI=Pf,pP=$c,fP=Pn,mP=tu,AB=hI&&hI.prototype;gP({target:"Promise",proto:!0,forced:dP,real:!0},{catch:function(r){return this.then(void 0,r)}});fP(hI)&&(T0=pP("Promise").prototype.catch,AB.catch!==T0&&mP(AB,"catch",T0,{unsafe:!0}));CP=vo,IP=Us,yP=Sl,bP=rh,vP=ty,wP=px,BP=Cx;CP({target:"Promise",stat:!0,forced:BP},{race:function(r){var t=this,i=bP.f(t),s=i.reject,A=vP(function(){var o=yP(t.resolve);wP(r,function(g){IP(o,t,g).then(i.resolve,s)})});return A.error&&s(A.value),i.promise}});_P=vo,xP=rh,SP=Hg.CONSTRUCTOR;_P({target:"Promise",stat:!0,forced:SP},{reject:function(r){var t=xP.f(this),i=t.reject;return i(r),t.promise}});FP=Xs,kP=XA,LP=rh,EP=function(r,t){if(FP(r),kP(t)&&t.constructor===r)return t;var i=LP.f(r),s=i.resolve;return s(t),i.promise},TP=vo,QP=$c,UP=Hg.CONSTRUCTOR,GP=EP;QP("Promise");TP({target:"Promise",stat:!0,forced:UP},{resolve:function(r){return GP(this,r)}});RP=YI,HP=String,YA=function(r){if(RP(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return HP(r)},ZP=Xs,Ix=function(){var r=ZP(this),t="";return r.hasIndices&&(t+="d"),r.global&&(t+="g"),r.ignoreCase&&(t+="i"),r.multiline&&(t+="m"),r.dotAll&&(t+="s"),r.unicode&&(t+="u"),r.unicodeSets&&(t+="v"),r.sticky&&(t+="y"),t},sy=Hn,PP=Rn,oy=PP.RegExp,ay=sy(function(){var r=oy("a","y");return r.lastIndex=2,r.exec("abcd")!==null}),MP=ay||sy(function(){return!oy("a","y").sticky}),NP=ay||sy(function(){var r=oy("^r","gy");return r.lastIndex=2,r.exec("str")!==null}),yx={BROKEN_CARET:NP,MISSED_STICKY:MP,UNSUPPORTED_Y:ay},bx={},VP=R_,DP=XI,KP=Object.keys||function(r){return VP(r,DP)},WP=lA,OP=F_,zP=Fl,JP=Xs,XP=Qg,YP=KP;bx.f=WP&&!OP?Object.defineProperties:function(r,t){JP(r);for(var i=XP(t),s=YP(t),A=s.length,o=0,g;A>o;)zP.f(r,g=s[o++],i[g]);return r};jP=Xs,qP=bx,cB=XI,$P=OI,tM=J_,eM=Qf,iM=WI,uB=">",hB="<",gI="prototype",dI="script",vx=iM("IE_PROTO"),Q0=function(){},wx=function(r){return hB+dI+uB+r+hB+"/"+dI+uB},gB=function(r){r.write(wx("")),r.close();var t=r.parentWindow.Object;return r=null,t},rM=function(){var r=eM("iframe"),t="java"+dI+":",i;return r.style.display="none",tM.appendChild(r),r.src=String(t),i=r.contentWindow.document,i.open(),i.write(wx("document.F=Object")),i.close(),i.F},Gp=function(){try{vp=new ActiveXObject("htmlfile")}catch{}Gp=typeof document<"u"?document.domain&&vp?gB(vp):rM():gB(vp);for(var r=cB.length;r--;)delete Gp[gI][cB[r]];return Gp()};$P[vx]=!0;Ay=Object.create||function(r,t){var i;return r!==null?(Q0[gI]=jP(r),i=new Q0,Q0[gI]=null,i[vx]=r):i=Gp(),t===void 0?i:qP.f(i,t)},nM=Hn,sM=Rn,oM=sM.RegExp,aM=nM(function(){var r=oM(".","s");return!(r.dotAll&&r.test(`
`)&&r.flags==="s")}),AM=Hn,lM=Rn,cM=lM.RegExp,uM=AM(function(){var r=cM("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"}),Ou=Us,Nf=Zn,hM=YA,gM=Ix,dM=yx,pM=VI,fM=Ay,mM=Gf.get,CM=aM,IM=uM,yM=pM("native-string-replace",String.prototype.replace),Vp=RegExp.prototype.exec,pI=Vp,bM=Nf("".charAt),vM=Nf("".indexOf),wM=Nf("".replace),U0=Nf("".slice),fI=function(){var r=/a/,t=/b*/g;return Ou(Vp,r,"a"),Ou(Vp,t,"a"),r.lastIndex!==0||t.lastIndex!==0}(),Bx=dM.BROKEN_CARET,mI=/()??/.exec("")[1]!==void 0,BM=fI||mI||Bx||CM||IM;BM&&(pI=function(r){var t=this,i=mM(t),s=hM(r),A=i.raw,o,g,d,C,v,x,T;if(A)return A.lastIndex=t.lastIndex,o=Ou(pI,A,s),t.lastIndex=A.lastIndex,o;var G=i.groups,k=Bx&&t.sticky,W=Ou(gM,t),K=t.source,$=0,O=s;if(k&&(W=wM(W,"y",""),vM(W,"g")===-1&&(W+="g"),O=U0(s,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&bM(s,t.lastIndex-1)!==`
`)&&(K="(?: "+K+")",O=" "+O,$++),g=new RegExp("^(?:"+K+")",W)),mI&&(g=new RegExp("^"+K+"$(?!\\s)",W)),fI&&(d=t.lastIndex),C=Ou(Vp,k?g:t,O),k?C?(C.input=U0(C.input,$),C[0]=U0(C[0],$),C.index=t.lastIndex,t.lastIndex+=C[0].length):t.lastIndex=0:fI&&C&&(t.lastIndex=t.global?C.index+C[0].length:d),mI&&C&&C.length>1&&Ou(yM,C[0],g,function(){for(v=1;v<arguments.length-2;v++)arguments[v]===void 0&&(C[v]=void 0)}),C&&G)for(C.groups=x=fM(null),v=0;v<G.length;v++)T=G[v],x[T[0]]=C[T[1]];return C});ly=pI,_M=vo,dB=ly;_M({target:"RegExp",proto:!0,forced:/./.exec!==dB},{exec:dB});pB=Us,fB=tu,xM=ly,mB=Hn,_x=Is,SM=Ug,FM=_x("species"),G0=RegExp.prototype,cy=function(r,t,i,s){var A=_x(r),o=!mB(function(){var v={};return v[A]=function(){return 7},""[r](v)!==7}),g=o&&!mB(function(){var v=!1,x=/a/;return r==="split"&&(x={},x.constructor={},x.constructor[FM]=function(){return x},x.flags="",x[A]=/./[A]),x.exec=function(){return v=!0,null},x[A](""),!v});if(!o||!g||i){var d=/./[A],C=t(A,""[r],function(v,x,T,G,k){var W=x.exec;return W===xM||W===G0.exec?o&&!k?{done:!0,value:pB(d,x,T,G)}:{done:!0,value:pB(v,T,x,G)}:{done:!1}});fB(String.prototype,r,C[0]),fB(G0,A,C[1])}s&&SM(G0[A],"sham",!0)},uy=Zn,kM=Rf,LM=YA,EM=JA,TM=uy("".charAt),CB=uy("".charCodeAt),QM=uy("".slice),IB=function(r){return function(t,i){var s=LM(EM(t)),A=kM(i),o=s.length,g,d;return A<0||A>=o?r?"":void 0:(g=CB(s,A),g<55296||g>56319||A+1===o||(d=CB(s,A+1))<56320||d>57343?r?TM(s,A):g:r?QM(s,A,A+2):(g-55296<<10)+(d-56320)+65536)}},UM={codeAt:IB(!1),charAt:IB(!0)},GM=UM.charAt,hy=function(r,t,i){return t+(i?GM(r,t).length:1)},yB=Us,RM=Xs,HM=Pn,ZM=jc,PM=ly,MM=TypeError,gy=function(r,t){var i=r.exec;if(HM(i)){var s=yB(i,r,t);return s!==null&&RM(s),s}if(ZM(r)==="RegExp")return yB(PM,r,t);throw new MM("RegExp#exec called on incompatible receiver")},NM=Us,VM=cy,DM=Xs,KM=qc,WM=ih,R0=YA,OM=JA,zM=eh,JM=hy,bB=gy;VM("match",function(r,t,i){return[function(s){var A=OM(this),o=KM(s)?void 0:zM(s,r);return o?NM(o,s,A):new RegExp(s)[r](R0(A))},function(s){var A=DM(this),o=R0(s),g=i(t,A,o);if(g.done)return g.value;if(!A.global)return bB(A,o);var d=A.unicode;A.lastIndex=0;for(var C=[],v=0,x;(x=bB(A,o))!==null;){var T=R0(x[0]);C[v]=T,T===""&&(A.lastIndex=JM(o,WM(A.lastIndex),d)),v++}return v===0?null:C}]});dy=Zn,XM=Tf,YM=Math.floor,H0=dy("".charAt),jM=dy("".replace),Z0=dy("".slice),qM=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,$M=/\$([$&'`]|\d{1,2})/g,tN=function(r,t,i,s,A,o){var g=i+r.length,d=s.length,C=$M;return A!==void 0&&(A=XM(A),C=qM),jM(o,C,function(v,x){var T;switch(H0(x,0)){case"$":return"$";case"&":return r;case"`":return Z0(t,0,i);case"'":return Z0(t,g);case"<":T=A[Z0(x,1,-1)];break;default:var G=+x;if(G===0)return v;if(G>d){var k=YM(G/10);return k===0?v:k<=d?s[k-1]===void 0?H0(x,1):s[k-1]+H0(x,1):v}T=s[G-1]}return T===void 0?"":T})},eN=z_,vB=Us,Vf=Zn,iN=cy,rN=Hn,nN=Xs,sN=Pn,oN=qc,aN=Rf,AN=ih,Pu=YA,lN=JA,cN=hy,uN=eh,hN=tN,gN=gy,dN=Is,CI=dN("replace"),pN=Math.max,fN=Math.min,mN=Vf([].concat),P0=Vf([].push),wB=Vf("".indexOf),BB=Vf("".slice),CN=function(r){return r===void 0?r:String(r)},IN=function(){return"a".replace(/./,"$0")==="$0"}(),_B=function(){return/./[CI]?/./[CI]("a","$0")==="":!1}(),yN=!rN(function(){var r=/./;return r.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(r,"$<a>")!=="7"});iN("replace",function(r,t,i){var s=_B?"$":"$0";return[function(A,o){var g=lN(this),d=oN(A)?void 0:uN(A,CI);return d?vB(d,A,g,o):vB(t,Pu(g),A,o)},function(A,o){var g=nN(this),d=Pu(A);if(typeof o=="string"&&wB(o,s)===-1&&wB(o,"$<")===-1){var C=i(t,g,d,o);if(C.done)return C.value}var v=sN(o);v||(o=Pu(o));var x=g.global,T;x&&(T=g.unicode,g.lastIndex=0);for(var G=[],k;k=gN(g,d),!(k===null||(P0(G,k),!x));){var W=Pu(k[0]);W===""&&(g.lastIndex=cN(d,AN(g.lastIndex),T))}for(var K="",$=0,O=0;O<G.length;O++){k=G[O];for(var tt=Pu(k[0]),at=pN(fN(aN(k.index),d.length),0),Lt=[],Tt,Qt=1;Qt<k.length;Qt++)P0(Lt,CN(k[Qt]));var Ft=k.groups;if(v){var vt=mN([tt],Lt,at,d);Ft!==void 0&&P0(vt,Ft),Tt=Pu(eN(o,void 0,vt))}else Tt=hN(tt,d,at,Lt,Ft,o);at>=$&&(K+=BB(d,$,at)+Tt,$=at+tt.length)}return K+BB(d,$)}]},!yN||!IN||_B);bN=XA,vN=jc,wN=Is,BN=wN("match"),_N=function(r){var t;return bN(r)&&((t=r[BN])!==void 0?!!t:vN(r)==="RegExp")},xN=_N,SN=TypeError,py=function(r){if(xN(r))throw new SN("The method doesn't accept regular expressions");return r},FN=Is,kN=FN("match"),fy=function(r){var t=/./;try{"/./"[r](t)}catch{try{return t[kN]=!1,"/./"[r](t)}catch{}}return!1},LN=vo,EN=Zf,TN=Tg.f,QN=ih,xB=YA,UN=py,GN=JA,RN=fy,HN=EN("".slice),ZN=Math.min,xx=RN("startsWith"),PN=!xx&&!!function(){var r=TN(String.prototype,"startsWith");return r&&!r.writable}();LN({target:"String",proto:!0,forced:!PN&&!xx},{startsWith:function(r){var t=xB(GN(this));UN(r);var i=QN(ZN(arguments.length>1?arguments[1]:void 0,t.length)),s=xB(r);return HN(t,i,i+s.length)===s}});MN=Is,NN=Ay,VN=Fl.f,II=MN("unscopables"),yI=Array.prototype;yI[II]===void 0&&VN(yI,II,{configurable:!0,value:NN(null)});DN=function(r){yI[II][r]=!0},KN=Hn,WN=!KN(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),ON=cA,zN=Pn,JN=Tf,XN=WI,YN=WN,SB=XN("IE_PROTO"),bI=Object,jN=bI.prototype,Sx=YN?bI.getPrototypeOf:function(r){var t=JN(r);if(ON(t,SB))return t[SB];var i=t.constructor;return zN(i)&&t instanceof i?i.prototype:t instanceof bI?jN:null},qN=Hn,$N=Pn,tV=XA,FB=Sx,eV=tu,iV=Is,vI=iV("iterator"),Fx=!1;[].keys&&(N0=[].keys(),"next"in N0?(M0=FB(FB(N0)),M0!==Object.prototype&&(Oc=M0)):Fx=!0);rV=!tV(Oc)||qN(function(){var r={};return Oc[vI].call(r)!==r});rV&&(Oc={});$N(Oc[vI])||eV(Oc,vI,function(){return this});kx={IteratorPrototype:Oc,BUGGY_SAFARI_ITERATORS:Fx},nV=kx.IteratorPrototype,sV=Ay,oV=ZI,aV=Hf,AV=Zg,lV=function(){return this},cV=function(r,t,i,s){var A=t+" Iterator";return r.prototype=sV(nV,{next:oV(+!s,i)}),aV(r,A,!1),AV[A]=lV,r},uV=vo,hV=Us,Lx=Uf,gV=Pn,dV=cV,kB=Sx,LB=P_,pV=Hf,fV=Ug,V0=tu,mV=Is,CV=Zg,Ex=kx,IV=Lx.PROPER,yV=Lx.CONFIGURABLE,EB=Ex.IteratorPrototype,wp=Ex.BUGGY_SAFARI_ITERATORS,pg=mV("iterator"),TB="keys",fg="values",QB="entries",bV=function(){return this},vV=function(r,t,i,s,A,o,g){dV(i,t,s);var d=function(O){if(O===A&&G)return G;if(!wp&&O&&O in x)return x[O];switch(O){case TB:return function(){return new i(this,O)};case fg:return function(){return new i(this,O)};case QB:return function(){return new i(this,O)}}return function(){return new i(this)}},C=t+" Iterator",v=!1,x=r.prototype,T=x[pg]||x["@@iterator"]||A&&x[A],G=!wp&&T||d(A),k=t==="Array"&&x.entries||T,W,K,$;if(k&&(W=kB(k.call(new r)),W!==Object.prototype&&W.next&&(kB(W)!==EB&&(LB?LB(W,EB):gV(W[pg])||V0(W,pg,bV)),pV(W,C,!0))),IV&&A===fg&&T&&T.name!==fg&&(yV?fV(x,"name",fg):(v=!0,G=function(){return hV(T,this)})),A)if(K={values:d(fg),keys:o?G:d(TB),entries:d(QB)},g)for($ in K)(wp||v||!($ in x))&&V0(x,$,K[$]);else uV({target:t,proto:!0,forced:wp||v},K);return x[pg]!==G&&V0(x,pg,G,{name:A}),CV[t]=G,K},wV=function(r,t){return{value:r,done:t}},BV=Qg,my=DN,UB=Zg,Tx=Gf,_V=Fl.f,xV=vV,Bp=wV,SV=lA,Qx="Array Iterator",FV=Tx.set,kV=Tx.getterFor(Qx),LV=xV(Array,"Array",function(r,t){FV(this,{type:Qx,target:BV(r),index:0,kind:t})},function(){var r=kV(this),t=r.target,i=r.index++;if(!t||i>=t.length)return r.target=void 0,Bp(void 0,!0);switch(r.kind){case"keys":return Bp(i,!1);case"values":return Bp(t[i],!1)}return Bp([i,t[i]],!1)},"values"),GB=UB.Arguments=UB.Array;my("keys");my("values");my("entries");if(SV&&GB.name!=="values")try{_V(GB,"name",{value:"values"})}catch{}EV={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},TV=Qf,D0=TV("span").classList,RB=D0&&D0.constructor&&D0.constructor.prototype,QV=RB===Object.prototype?void 0:RB,HB=Rn,Ux=EV,UV=QV,mg=LV,ZB=Ug,GV=Hf,RV=Is,K0=RV("iterator"),W0=mg.values,Gx=function(r,t){if(r){if(r[K0]!==W0)try{ZB(r,K0,W0)}catch{r[K0]=W0}if(GV(r,t,!0),Ux[t]){for(var i in mg)if(r[i]!==mg[i])try{ZB(r,i,mg[i])}catch{r[i]=mg[i]}}}};for(_p in Ux)Gx(HB[_p]&&HB[_p].prototype,_p);Gx(UV,"DOMTokenList");PV=Sl,MV=Tf,NV=I_,VV=JI,PB=TypeError,MB="Reduce of empty array with no initial value",NB=function(r){return function(t,i,s,A){var o=MV(t),g=NV(o),d=VV(o);if(PV(i),d===0&&s<2)throw new PB(MB);var C=r?d-1:0,v=r?-1:1;if(s<2)for(;;){if(C in g){A=g[C],C+=v;break}if(C+=v,r?C<0:d<=C)throw new PB(MB)}for(;r?C>=0:d>C;C+=v)C in g&&(A=i(A,g[C],C,o));return A}},DV={left:NB(!1),right:NB(!0)},KV=Hn,Rx=function(r,t){var i=[][r];return!!i&&KV(function(){i.call(null,t||function(){return 1},1)})},WV=vo,OV=DV.left,zV=Rx,VB=PI,JV=Rg,XV=!JV&&VB>79&&VB<83,YV=XV||!zV("reduce");WV({target:"Array",proto:!0,forced:YV},{reduce:function(r){var t=arguments.length;return OV(this,r,t,t>1?arguments[1]:void 0)}});jV=vo,qV=Zf,$V=Tg.f,t9=ih,DB=YA,e9=py,i9=JA,r9=fy,n9=qV("".slice),s9=Math.min,Hx=r9("endsWith"),o9=!Hx&&!!function(){var r=$V(String.prototype,"endsWith");return r&&!r.writable}();jV({target:"String",proto:!0,forced:!o9&&!Hx},{endsWith:function(r){var t=DB(i9(this));e9(r);var i=arguments.length>1?arguments[1]:void 0,s=t.length,A=i===void 0?s:s9(t9(i),s),o=DB(r);return n9(t,A-o.length,A)===o}});O0=Us,Zx=Zn,a9=cy,A9=Xs,l9=qc,c9=JA,u9=W_,h9=hy,g9=ih,KB=YA,d9=eh,WB=gy,p9=yx,f9=Hn,Mu=p9.UNSUPPORTED_Y,m9=4294967295,C9=Math.min,z0=Zx([].push),J0=Zx("".slice),I9=!f9(function(){var r=/(?:)/,t=r.exec;r.exec=function(){return t.apply(this,arguments)};var i="ab".split(r);return i.length!==2||i[0]!=="a"||i[1]!=="b"}),OB="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;a9("split",function(r,t,i){var s="0".split(void 0,0).length?function(A,o){return A===void 0&&o===0?[]:O0(t,this,A,o)}:t;return[function(A,o){var g=c9(this),d=l9(A)?void 0:d9(A,r);return d?O0(d,A,g,o):O0(s,KB(g),A,o)},function(A,o){var g=A9(this),d=KB(A);if(!OB){var C=i(s,g,d,o,s!==t);if(C.done)return C.value}var v=u9(g,RegExp),x=g.unicode,T=(g.ignoreCase?"i":"")+(g.multiline?"m":"")+(g.unicode?"u":"")+(Mu?"g":"y"),G=new v(Mu?"^(?:"+g.source+")":g,T),k=o===void 0?m9:o>>>0;if(k===0)return[];if(d.length===0)return WB(G,d)===null?[d]:[];for(var W=0,K=0,$=[];K<d.length;){G.lastIndex=Mu?0:K;var O=WB(G,Mu?J0(d,K):d),tt;if(O===null||(tt=C9(g9(G.lastIndex+(Mu?K:0)),d.length))===W)K=h9(d,K,x);else{if(z0($,J0(d,W,K)),$.length===k)return $;for(var at=1;at<=O.length-1;at++)if(z0($,O[at]),$.length===k)return $;K=W=tt}}return z0($,J0(d,W)),$}]},OB||!I9,Mu);Df={exports:{}},Cg={exports:{}};(function(){var r,t,i,s,A,o;typeof performance<"u"&&performance!==null&&performance.now?Cg.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(Cg.exports=function(){return(r()-A)/1e6},t=process.hrtime,r=function(){var g;return g=t(),g[0]*1e9+g[1]},s=r(),o=process.uptime()*1e9,A=s-o):Date.now?(Cg.exports=function(){return Date.now()-i},i=Date.now()):(Cg.exports=function(){return new Date().getTime()-i},i=new Date().getTime())}).call(Du);y9=Cg.exports,b9=y9,_l=typeof window>"u"?Du:window,xp=["moz","webkit"],Ju="AnimationFrame",qu=_l["request"+Ju],wg=_l["cancel"+Ju]||_l["cancelRequest"+Ju];for(Nu=0;!qu&&Nu<xp.length;Nu++)qu=_l[xp[Nu]+"Request"+Ju],wg=_l[xp[Nu]+"Cancel"+Ju]||_l[xp[Nu]+"CancelRequest"+Ju];(!qu||!wg)&&(Sp=0,X0=0,lc=[],zB=1e3/60,qu=function(r){if(lc.length===0){var t=b9(),i=Math.max(0,zB-(t-Sp));Sp=i+t,setTimeout(function(){var s=lc.slice(0);lc.length=0;for(var A=0;A<s.length;A++)if(!s[A].cancelled)try{s[A].callback(Sp)}catch(o){setTimeout(function(){throw o},0)}},Math.round(i))}return lc.push({handle:++X0,callback:r,cancelled:!1}),X0},wg=function(r){for(var t=0;t<lc.length;t++)lc[t].handle===r&&(lc[t].cancelled=!0)});Df.exports=function(r){return qu.call(_l,r)};Df.exports.cancel=function(){wg.apply(_l,arguments)};Df.exports.polyfill=function(r){r||(r=_l),r.requestAnimationFrame=qu,r.cancelAnimationFrame=wg};v9=Df.exports,Y0=h_(v9),Px=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,w9=Zn,B9=JA,_9=YA,wI=Px,JB=w9("".replace),x9=RegExp("^["+wI+"]+"),S9=RegExp("(^|[^"+wI+"])["+wI+"]+$"),j0=function(r){return function(t){var i=_9(B9(t));return r&1&&(i=JB(i,x9,"")),r&2&&(i=JB(i,S9,"$1")),i}},F9={start:j0(1),end:j0(2),trim:j0(3)},k9=Uf.PROPER,L9=Hn,XB=Px,YB="\u200B\x85\u180E",E9=function(r){return L9(function(){return!!XB[r]()||YB[r]()!==YB||k9&&XB[r].name!==r})},T9=vo,Q9=F9.trim,U9=E9;T9({target:"String",proto:!0,forced:U9("trim")},{trim:function(){return Q9(this)}});G9=function(r){this.ok=!1,this.alpha=1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r=r.replace(/ /g,""),r=r.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};r=t[r]||r;for(var i=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(C){return[parseInt(C[1]),parseInt(C[2]),parseInt(C[3]),parseFloat(C[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(C){return[parseInt(C[1]),parseInt(C[2]),parseInt(C[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(C){return[parseInt(C[1],16),parseInt(C[2],16),parseInt(C[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(C){return[parseInt(C[1]+C[1],16),parseInt(C[2]+C[2],16),parseInt(C[3]+C[3],16)]}}],s=0;s<i.length;s++){var A=i[s].re,o=i[s].process,g=A.exec(r);if(g){var d=o(g);this.r=d[0],this.g=d[1],this.b=d[2],d.length>3&&(this.alpha=d[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var C=this.r.toString(16),v=this.g.toString(16),x=this.b.toString(16);return C.length==1&&(C="0"+C),v.length==1&&(v="0"+v),x.length==1&&(x="0"+x),"#"+C+v+x},this.getHelpXML=function(){for(var C=new Array,v=0;v<i.length;v++)for(var x=i[v].example,T=0;T<x.length;T++)C[C.length]=x[T];for(var G in t)C[C.length]=G;var k=document.createElement("ul");k.setAttribute("id","rgbcolor-examples");for(var v=0;v<C.length;v++)try{var W=document.createElement("li"),K=new RGBColor(C[v]),$=document.createElement("div");$.style.cssText="margin: 3px; border: 1px solid black; background:"+K.toHex()+"; color:"+K.toHex(),$.appendChild(document.createTextNode("test"));var O=document.createTextNode(" "+C[v]+" -> "+K.toRGB()+" -> "+K.toHex());W.appendChild($),W.appendChild(O),k.appendChild(W)}catch{}return k}},BI=h_(G9),R9=vo,H9=Zf,Z9=G_.indexOf,P9=Rx,_I=H9([].indexOf),Mx=!!_I&&1/_I([1],1,-0)<0,M9=Mx||!P9("indexOf");R9({target:"Array",proto:!0,forced:M9},{indexOf:function(r){var t=arguments.length>1?arguments[1]:void 0;return Mx?_I(this,r,t)||0:Z9(this,r,t)}});N9=vo,V9=Zn,D9=py,K9=JA,jB=YA,W9=fy,O9=V9("".indexOf);N9({target:"String",proto:!0,forced:!W9("includes")},{includes:function(r){return!!~O9(jB(K9(this)),jB(D9(r)),arguments.length>1?arguments[1]:void 0)}});z9=jc,J9=Array.isArray||function(r){return z9(r)==="Array"},X9=vo,Y9=Zn,j9=J9,q9=Y9([].reverse),qB=[1,2];X9({target:"Array",proto:!0,forced:String(qB)===String(qB.reverse())},{reverse:function(){return j9(this)&&(this.length=this.length),q9(this)}});Nx=function(r,t){return(Nx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var A in s)Object.prototype.hasOwnProperty.call(s,A)&&(i[A]=s[A])})(r,t)};cc=Math.PI;wl=Math.PI/180;(function(r){function t(){return A(function(d,C,v){return d.relative&&(d.x1!==void 0&&(d.x1+=C),d.y1!==void 0&&(d.y1+=v),d.x2!==void 0&&(d.x2+=C),d.y2!==void 0&&(d.y2+=v),d.x!==void 0&&(d.x+=C),d.y!==void 0&&(d.y+=v),d.relative=!1),d})}function i(){var d=NaN,C=NaN,v=NaN,x=NaN;return A(function(T,G,k){return T.type&De.SMOOTH_CURVE_TO&&(T.type=De.CURVE_TO,d=isNaN(d)?G:d,C=isNaN(C)?k:C,T.x1=T.relative?G-d:2*G-d,T.y1=T.relative?k-C:2*k-C),T.type&De.CURVE_TO?(d=T.relative?G+T.x2:T.x2,C=T.relative?k+T.y2:T.y2):(d=NaN,C=NaN),T.type&De.SMOOTH_QUAD_TO&&(T.type=De.QUAD_TO,v=isNaN(v)?G:v,x=isNaN(x)?k:x,T.x1=T.relative?G-v:2*G-v,T.y1=T.relative?k-x:2*k-x),T.type&De.QUAD_TO?(v=T.relative?G+T.x1:T.x1,x=T.relative?k+T.y1:T.y1):(v=NaN,x=NaN),T})}function s(){var d=NaN,C=NaN;return A(function(v,x,T){if(v.type&De.SMOOTH_QUAD_TO&&(v.type=De.QUAD_TO,d=isNaN(d)?x:d,C=isNaN(C)?T:C,v.x1=v.relative?x-d:2*x-d,v.y1=v.relative?T-C:2*T-C),v.type&De.QUAD_TO){d=v.relative?x+v.x1:v.x1,C=v.relative?T+v.y1:v.y1;var G=v.x1,k=v.y1;v.type=De.CURVE_TO,v.x1=((v.relative?0:x)+2*G)/3,v.y1=((v.relative?0:T)+2*k)/3,v.x2=(v.x+2*G)/3,v.y2=(v.y+2*k)/3}else d=NaN,C=NaN;return v})}function A(d){var C=0,v=0,x=NaN,T=NaN;return function(G){if(isNaN(x)&&!(G.type&De.MOVE_TO))throw new Error("path must start with moveto");var k=d(G,C,v,x,T);return G.type&De.CLOSE_PATH&&(C=x,v=T),G.x!==void 0&&(C=G.relative?C+G.x:G.x),G.y!==void 0&&(v=G.relative?v+G.y:G.y),G.type&De.MOVE_TO&&(x=C,T=v),k}}function o(d,C,v,x,T,G){return sA(d,C,v,x,T,G),A(function(k,W,K,$){var O=k.x1,tt=k.x2,at=k.relative&&!isNaN($),Lt=k.x!==void 0?k.x:at?0:W,Tt=k.y!==void 0?k.y:at?0:K;function Qt(j){return j*j}k.type&De.HORIZ_LINE_TO&&C!==0&&(k.type=De.LINE_TO,k.y=k.relative?0:K),k.type&De.VERT_LINE_TO&&v!==0&&(k.type=De.LINE_TO,k.x=k.relative?0:W),k.x!==void 0&&(k.x=k.x*d+Tt*v+(at?0:T)),k.y!==void 0&&(k.y=Lt*C+k.y*x+(at?0:G)),k.x1!==void 0&&(k.x1=k.x1*d+k.y1*v+(at?0:T)),k.y1!==void 0&&(k.y1=O*C+k.y1*x+(at?0:G)),k.x2!==void 0&&(k.x2=k.x2*d+k.y2*v+(at?0:T)),k.y2!==void 0&&(k.y2=tt*C+k.y2*x+(at?0:G));var Ft=d*x-C*v;if(k.xRot!==void 0&&(d!==1||C!==0||v!==0||x!==1))if(Ft===0)delete k.rX,delete k.rY,delete k.xRot,delete k.lArcFlag,delete k.sweepFlag,k.type=De.LINE_TO;else{var vt=k.xRot*Math.PI/180,Jt=Math.sin(vt),qt=Math.cos(vt),At=1/Qt(k.rX),lt=1/Qt(k.rY),kt=Qt(qt)*At+Qt(Jt)*lt,_t=2*Jt*qt*(At-lt),le=Qt(Jt)*At+Qt(qt)*lt,ie=kt*x*x-_t*C*x+le*C*C,ne=_t*(d*x+C*v)-2*(kt*v*x+le*d*C),te=kt*v*v-_t*d*v+le*d*d,wt=(Math.atan2(ne,ie-te)+Math.PI)%Math.PI/2,Ut=Math.sin(wt),fe=Math.cos(wt);k.rX=Math.abs(Ft)/Math.sqrt(ie*Qt(fe)+ne*Ut*fe+te*Qt(Ut)),k.rY=Math.abs(Ft)/Math.sqrt(ie*Qt(Ut)-ne*Ut*fe+te*Qt(fe)),k.xRot=180*wt/Math.PI}return k.sweepFlag!==void 0&&0>Ft&&(k.sweepFlag=+!k.sweepFlag),k})}function g(){return function(d){var C={};for(var v in d)C[v]=d[v];return C}}r.ROUND=function(d){function C(v){return Math.round(v*d)/d}return d===void 0&&(d=1e13),sA(d),function(v){return v.x1!==void 0&&(v.x1=C(v.x1)),v.y1!==void 0&&(v.y1=C(v.y1)),v.x2!==void 0&&(v.x2=C(v.x2)),v.y2!==void 0&&(v.y2=C(v.y2)),v.x!==void 0&&(v.x=C(v.x)),v.y!==void 0&&(v.y=C(v.y)),v.rX!==void 0&&(v.rX=C(v.rX)),v.rY!==void 0&&(v.rY=C(v.rY)),v}},r.TO_ABS=t,r.TO_REL=function(){return A(function(d,C,v){return d.relative||(d.x1!==void 0&&(d.x1-=C),d.y1!==void 0&&(d.y1-=v),d.x2!==void 0&&(d.x2-=C),d.y2!==void 0&&(d.y2-=v),d.x!==void 0&&(d.x-=C),d.y!==void 0&&(d.y-=v),d.relative=!0),d})},r.NORMALIZE_HVZ=function(d,C,v){return d===void 0&&(d=!0),C===void 0&&(C=!0),v===void 0&&(v=!0),A(function(x,T,G,k,W){if(isNaN(k)&&!(x.type&De.MOVE_TO))throw new Error("path must start with moveto");return C&&x.type&De.HORIZ_LINE_TO&&(x.type=De.LINE_TO,x.y=x.relative?0:G),v&&x.type&De.VERT_LINE_TO&&(x.type=De.LINE_TO,x.x=x.relative?0:T),d&&x.type&De.CLOSE_PATH&&(x.type=De.LINE_TO,x.x=x.relative?k-T:k,x.y=x.relative?W-G:W),x.type&De.ARC&&(x.rX===0||x.rY===0)&&(x.type=De.LINE_TO,delete x.rX,delete x.rY,delete x.xRot,delete x.lArcFlag,delete x.sweepFlag),x})},r.NORMALIZE_ST=i,r.QT_TO_C=s,r.INFO=A,r.SANITIZE=function(d){d===void 0&&(d=0),sA(d);var C=NaN,v=NaN,x=NaN,T=NaN;return A(function(G,k,W,K,$){var O=Math.abs,tt=!1,at=0,Lt=0;if(G.type&De.SMOOTH_CURVE_TO&&(at=isNaN(C)?0:k-C,Lt=isNaN(v)?0:W-v),G.type&(De.CURVE_TO|De.SMOOTH_CURVE_TO)?(C=G.relative?k+G.x2:G.x2,v=G.relative?W+G.y2:G.y2):(C=NaN,v=NaN),G.type&De.SMOOTH_QUAD_TO?(x=isNaN(x)?k:2*k-x,T=isNaN(T)?W:2*W-T):G.type&De.QUAD_TO?(x=G.relative?k+G.x1:G.x1,T=G.relative?W+G.y1:G.y2):(x=NaN,T=NaN),G.type&De.LINE_COMMANDS||G.type&De.ARC&&(G.rX===0||G.rY===0||!G.lArcFlag)||G.type&De.CURVE_TO||G.type&De.SMOOTH_CURVE_TO||G.type&De.QUAD_TO||G.type&De.SMOOTH_QUAD_TO){var Tt=G.x===void 0?0:G.relative?G.x:G.x-k,Qt=G.y===void 0?0:G.relative?G.y:G.y-W;at=isNaN(x)?G.x1===void 0?at:G.relative?G.x:G.x1-k:x-k,Lt=isNaN(T)?G.y1===void 0?Lt:G.relative?G.y:G.y1-W:T-W;var Ft=G.x2===void 0?0:G.relative?G.x:G.x2-k,vt=G.y2===void 0?0:G.relative?G.y:G.y2-W;O(Tt)<=d&&O(Qt)<=d&&O(at)<=d&&O(Lt)<=d&&O(Ft)<=d&&O(vt)<=d&&(tt=!0)}return G.type&De.CLOSE_PATH&&O(k-K)<=d&&O(W-$)<=d&&(tt=!0),tt?[]:G})},r.MATRIX=o,r.ROTATE=function(d,C,v){C===void 0&&(C=0),v===void 0&&(v=0),sA(d,C,v);var x=Math.sin(d),T=Math.cos(d);return o(T,x,-x,T,C-C*T+v*x,v-C*x-v*T)},r.TRANSLATE=function(d,C){return C===void 0&&(C=0),sA(d,C),o(1,0,0,1,d,C)},r.SCALE=function(d,C){return C===void 0&&(C=d),sA(d,C),o(d,0,0,C,0,0)},r.SKEW_X=function(d){return sA(d),o(1,0,Math.atan(d),1,0,0)},r.SKEW_Y=function(d){return sA(d),o(1,Math.atan(d),0,1,0,0)},r.X_AXIS_SYMMETRY=function(d){return d===void 0&&(d=0),sA(d),o(-1,0,0,1,d,0)},r.Y_AXIS_SYMMETRY=function(d){return d===void 0&&(d=0),sA(d),o(1,0,0,-1,0,d)},r.A_TO_C=function(){return A(function(d,C,v){return De.ARC===d.type?function(x,T,G){var k,W,K,$;x.cX||q0(x,T,G);for(var O=Math.min(x.phi1,x.phi2),tt=Math.max(x.phi1,x.phi2)-O,at=Math.ceil(tt/90),Lt=new Array(at),Tt=T,Qt=G,Ft=0;Ft<at;Ft++){var vt=t_(x.phi1,x.phi2,Ft/at),Jt=t_(x.phi1,x.phi2,(Ft+1)/at),qt=Jt-vt,At=4/3*Math.tan(qt*wl/4),lt=[Math.cos(vt*wl)-At*Math.sin(vt*wl),Math.sin(vt*wl)+At*Math.cos(vt*wl)],kt=lt[0],_t=lt[1],le=[Math.cos(Jt*wl),Math.sin(Jt*wl)],ie=le[0],ne=le[1],te=[ie+At*Math.sin(Jt*wl),ne-At*Math.cos(Jt*wl)],wt=te[0],Ut=te[1];Lt[Ft]={relative:x.relative,type:De.CURVE_TO};var fe=function(j,bt){var It=xI([j*x.rX,bt*x.rY],x.xRot),Ht=It[0],Ot=It[1];return[x.cX+Ht,x.cY+Ot]};k=fe(kt,_t),Lt[Ft].x1=k[0],Lt[Ft].y1=k[1],W=fe(wt,Ut),Lt[Ft].x2=W[0],Lt[Ft].y2=W[1],K=fe(ie,ne),Lt[Ft].x=K[0],Lt[Ft].y=K[1],x.relative&&(Lt[Ft].x1-=Tt,Lt[Ft].y1-=Qt,Lt[Ft].x2-=Tt,Lt[Ft].y2-=Qt,Lt[Ft].x-=Tt,Lt[Ft].y-=Qt),Tt=($=[Lt[Ft].x,Lt[Ft].y])[0],Qt=$[1]}return Lt}(d,d.relative?0:C,d.relative?0:v):d})},r.ANNOTATE_ARCS=function(){return A(function(d,C,v){return d.relative&&(C=0,v=0),De.ARC===d.type&&q0(d,C,v),d})},r.CLONE=g,r.CALCULATE_BOUNDS=function(){var d=function(G){var k={};for(var W in G)k[W]=G[W];return k},C=t(),v=s(),x=i(),T=A(function(G,k,W){var K=x(v(C(d(G))));function $(Ut){Ut>T.maxX&&(T.maxX=Ut),Ut<T.minX&&(T.minX=Ut)}function O(Ut){Ut>T.maxY&&(T.maxY=Ut),Ut<T.minY&&(T.minY=Ut)}if(K.type&De.DRAWING_COMMANDS&&($(k),O(W)),K.type&De.HORIZ_LINE_TO&&$(K.x),K.type&De.VERT_LINE_TO&&O(K.y),K.type&De.LINE_TO&&($(K.x),O(K.y)),K.type&De.CURVE_TO){$(K.x),O(K.y);for(var tt=0,at=i_(k,K.x1,K.x2,K.x);tt<at.length;tt++)0<(wt=at[tt])&&1>wt&&$(r_(k,K.x1,K.x2,K.x,wt));for(var Lt=0,Tt=i_(W,K.y1,K.y2,K.y);Lt<Tt.length;Lt++)0<(wt=Tt[Lt])&&1>wt&&O(r_(W,K.y1,K.y2,K.y,wt))}if(K.type&De.ARC){$(K.x),O(K.y),q0(K,k,W);for(var Qt=K.xRot/180*Math.PI,Ft=Math.cos(Qt)*K.rX,vt=Math.sin(Qt)*K.rX,Jt=-Math.sin(Qt)*K.rY,qt=Math.cos(Qt)*K.rY,At=K.phi1<K.phi2?[K.phi1,K.phi2]:-180>K.phi2?[K.phi2+360,K.phi1+360]:[K.phi2,K.phi1],lt=At[0],kt=At[1],_t=function(Ut){var fe=Ut[0],j=Ut[1],bt=180*Math.atan2(j,fe)/Math.PI;return bt<lt?bt+360:bt},le=0,ie=$B(Jt,-Ft,0).map(_t);le<ie.length;le++)(wt=ie[le])>lt&&wt<kt&&$(e_(K.cX,Ft,Jt,wt));for(var ne=0,te=$B(qt,-vt,0).map(_t);ne<te.length;ne++){var wt;(wt=te[ne])>lt&&wt<kt&&O(e_(K.cY,vt,qt,wt))}}return G});return T.minX=1/0,T.maxX=-1/0,T.minY=1/0,T.maxY=-1/0,T}})(jn||(jn={}));Dx=function(){function r(){}return r.prototype.round=function(t){return this.transform(jn.ROUND(t))},r.prototype.toAbs=function(){return this.transform(jn.TO_ABS())},r.prototype.toRel=function(){return this.transform(jn.TO_REL())},r.prototype.normalizeHVZ=function(t,i,s){return this.transform(jn.NORMALIZE_HVZ(t,i,s))},r.prototype.normalizeST=function(){return this.transform(jn.NORMALIZE_ST())},r.prototype.qtToC=function(){return this.transform(jn.QT_TO_C())},r.prototype.aToC=function(){return this.transform(jn.A_TO_C())},r.prototype.sanitize=function(t){return this.transform(jn.SANITIZE(t))},r.prototype.translate=function(t,i){return this.transform(jn.TRANSLATE(t,i))},r.prototype.scale=function(t,i){return this.transform(jn.SCALE(t,i))},r.prototype.rotate=function(t,i,s){return this.transform(jn.ROTATE(t,i,s))},r.prototype.matrix=function(t,i,s,A,o,g){return this.transform(jn.MATRIX(t,i,s,A,o,g))},r.prototype.skewX=function(t){return this.transform(jn.SKEW_X(t))},r.prototype.skewY=function(t){return this.transform(jn.SKEW_Y(t))},r.prototype.xSymmetry=function(t){return this.transform(jn.X_AXIS_SYMMETRY(t))},r.prototype.ySymmetry=function(t){return this.transform(jn.Y_AXIS_SYMMETRY(t))},r.prototype.annotateArcs=function(){return this.transform(jn.ANNOTATE_ARCS())},r}(),t6=function(r){return r===" "||r==="	"||r==="\r"||r===`
`},n_=function(r){return 48<=r.charCodeAt(0)&&r.charCodeAt(0)<=57},e6=function(r){function t(){var i=r.call(this)||this;return i.curNumber="",i.curCommandType=-1,i.curCommandRelative=!1,i.canParseCommandOrComma=!0,i.curNumberHasExp=!1,i.curNumberHasExpDigits=!1,i.curNumberHasDecimal=!1,i.curArgs=[],i}return Vx(t,r),t.prototype.finish=function(i){if(i===void 0&&(i=[]),this.parse(" ",i),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return i},t.prototype.parse=function(i,s){var A=this;s===void 0&&(s=[]);for(var o=function(T){s.push(T),A.curArgs.length=0,A.canParseCommandOrComma=!0},g=0;g<i.length;g++){var d=i[g],C=!(this.curCommandType!==De.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),v=n_(d)&&(this.curNumber==="0"&&d==="0"||C);if(!n_(d)||v)if(d!=="e"&&d!=="E")if(d!=="-"&&d!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(d!=="."||this.curNumberHasExp||this.curNumberHasDecimal||C){if(this.curNumber&&this.curCommandType!==-1){var x=Number(this.curNumber);if(isNaN(x))throw new SyntaxError("Invalid number ending at "+g);if(this.curCommandType===De.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>x)throw new SyntaxError('Expected positive number, got "'+x+'" at index "'+g+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+g+'"')}this.curArgs.push(x),this.curArgs.length===i6[this.curCommandType]&&(De.HORIZ_LINE_TO===this.curCommandType?o({type:De.HORIZ_LINE_TO,relative:this.curCommandRelative,x}):De.VERT_LINE_TO===this.curCommandType?o({type:De.VERT_LINE_TO,relative:this.curCommandRelative,y:x}):this.curCommandType===De.MOVE_TO||this.curCommandType===De.LINE_TO||this.curCommandType===De.SMOOTH_QUAD_TO?(o({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),De.MOVE_TO===this.curCommandType&&(this.curCommandType=De.LINE_TO)):this.curCommandType===De.CURVE_TO?o({type:De.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===De.SMOOTH_CURVE_TO?o({type:De.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===De.QUAD_TO?o({type:De.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===De.ARC&&o({type:De.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!t6(d))if(d===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(d!=="+"&&d!=="-"&&d!==".")if(v)this.curNumber=d,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+g+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+d+'" at index '+g+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,d!=="z"&&d!=="Z")if(d==="h"||d==="H")this.curCommandType=De.HORIZ_LINE_TO,this.curCommandRelative=d==="h";else if(d==="v"||d==="V")this.curCommandType=De.VERT_LINE_TO,this.curCommandRelative=d==="v";else if(d==="m"||d==="M")this.curCommandType=De.MOVE_TO,this.curCommandRelative=d==="m";else if(d==="l"||d==="L")this.curCommandType=De.LINE_TO,this.curCommandRelative=d==="l";else if(d==="c"||d==="C")this.curCommandType=De.CURVE_TO,this.curCommandRelative=d==="c";else if(d==="s"||d==="S")this.curCommandType=De.SMOOTH_CURVE_TO,this.curCommandRelative=d==="s";else if(d==="q"||d==="Q")this.curCommandType=De.QUAD_TO,this.curCommandRelative=d==="q";else if(d==="t"||d==="T")this.curCommandType=De.SMOOTH_QUAD_TO,this.curCommandRelative=d==="t";else{if(d!=="a"&&d!=="A")throw new SyntaxError('Unexpected character "'+d+'" at index '+g+".");this.curCommandType=De.ARC,this.curCommandRelative=d==="a"}else s.push({type:De.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=d,this.curNumberHasDecimal=d==="."}else this.curNumber+=d,this.curNumberHasDecimal=!0;else this.curNumber+=d;else this.curNumber+=d,this.curNumberHasExp=!0;else this.curNumber+=d,this.curNumberHasExpDigits=this.curNumberHasExp}return s},t.prototype.transform=function(i){return Object.create(this,{parse:{value:function(s,A){A===void 0&&(A=[]);for(var o=0,g=Object.getPrototypeOf(this).parse.call(this,s);o<g.length;o++){var d=g[o],C=i(d);Array.isArray(C)?A.push.apply(A,C):A.push(C)}return A}}})},t}(Dx),De=function(r){function t(i){var s=r.call(this)||this;return s.commands=typeof i=="string"?t.parse(i):i,s}return Vx(t,r),t.prototype.encode=function(){return t.encode(this.commands)},t.prototype.getBounds=function(){var i=jn.CALCULATE_BOUNDS();return this.transform(i),i},t.prototype.transform=function(i){for(var s=[],A=0,o=this.commands;A<o.length;A++){var g=i(o[A]);Array.isArray(g)?s.push.apply(s,g):s.push(g)}return this.commands=s,this},t.encode=function(i){return $9(i)},t.parse=function(i){var s=new e6,A=[];return s.parse(i,A),s.finish(A),A},t.CLOSE_PATH=1,t.MOVE_TO=2,t.HORIZ_LINE_TO=4,t.VERT_LINE_TO=8,t.LINE_TO=16,t.CURVE_TO=32,t.SMOOTH_CURVE_TO=64,t.QUAD_TO=128,t.SMOOTH_QUAD_TO=256,t.ARC=512,t.LINE_COMMANDS=t.LINE_TO|t.HORIZ_LINE_TO|t.VERT_LINE_TO,t.DRAWING_COMMANDS=t.HORIZ_LINE_TO|t.VERT_LINE_TO|t.LINE_TO|t.CURVE_TO|t.SMOOTH_CURVE_TO|t.QUAD_TO|t.SMOOTH_QUAD_TO|t.ARC,t}(Dx),i6=((nA={})[De.MOVE_TO]=2,nA[De.LINE_TO]=2,nA[De.HORIZ_LINE_TO]=1,nA[De.VERT_LINE_TO]=1,nA[De.CLOSE_PATH]=0,nA[De.QUAD_TO]=4,nA[De.SMOOTH_QUAD_TO]=2,nA[De.CURVE_TO]=6,nA[De.SMOOTH_CURVE_TO]=4,nA[De.ARC]=7,nA),r6=Us,n6=cA,s6=kf,o6=Ix,s_=RegExp.prototype,a6=function(r){var t=r.flags;return t===void 0&&!("flags"in s_)&&!n6(r,"flags")&&s6(s_,r)?r6(o6,r):t},A6=Uf.PROPER,l6=tu,c6=Xs,o_=YA,u6=Hn,h6=a6,Iy="toString",Kx=RegExp.prototype,Wx=Kx[Iy],g6=u6(function(){return Wx.call({source:"a",flags:"b"})!=="/a/b"}),d6=A6&&Wx.name!==Iy;(g6||d6)&&l6(Kx,Iy,function(){var r=c6(this),t=o_(r.source),i=o_(h6(r));return"/"+t+"/"+i},{unsafe:!0});f6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],m6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];a_=function r(){p6(this,r),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};w6=Object.freeze({__proto__:null,offscreen:b6,node:v6});B6=/^[A-Z-]+$/;_6=/(\[[^\]]+\])/g,x6=/(#[^\s+>~.[:]+)/g,S6=/(\.[^\s+>~.[:]+)/g,F6=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,k6=/(:[\w-]+\([^)]*\))/gi,L6=/(:[^\s+>~.[:]+)/g,E6=/([^\s+>~.[:]+)/g;Wc=1e-8;Ki=class{constructor(t,i,s){this.document=t,this.name=i,this.value=s,this.isNormalizedColor=!1}static empty(t){return new Ki(t,"EMPTY","")}split(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:i,name:s}=this;return eu(this.getString()).trim().split(t).map(A=>new Ki(i,s,A))}hasValue(t){var{value:i}=this;return i!==null&&i!==""&&(t||i!==0)&&typeof i<"u"}isString(t){var{value:i}=this,s=typeof i=="string";return!s||!t?s:t.test(i)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return typeof t>"u"||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return typeof t>"u"?0:parseFloat(t);var{value:i}=this,s=parseFloat(i);return this.isString(/%$/)&&(s/=100),s}getString(t){return typeof t>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(t)}getColor(t){var i=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,i=Xx(i),this.value=i),i}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[s,A]=typeof t=="boolean"?[void 0,t]:[t],{viewPort:o}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(o.computeSize("x"),o.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(o.computeSize("x"),o.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*o.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*o.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&A):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*o.computeSize(s);default:{var g=this.getNumber();return i&&g<1?g*o.computeSize(s):g}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var t=this.getString(),i=/#([^)'"]+)/.exec(t);return i&&(i=i[1]),i||(i=t),this.document.definitions[i]}getFillStyleDefinition(t,i){var s=this.getDefinition();if(!s)return null;if(typeof s.createGradient=="function")return s.createGradient(this.document.ctx,t,i);if(typeof s.createPattern=="function"){if(s.getHrefAttribute().hasValue()){var A=s.getAttribute("patternTransform");s=s.getHrefAttribute().getDefinition(),A.hasValue()&&s.getAttribute("patternTransform",!0).setValue(A.value)}return s.createPattern(this.document.ctx,t,i)}return null}getTextBaseline(){return this.hasValue()?Ki.textBaselineMapping[this.getString()]:null}addOpacity(t){for(var i=this.getColor(),s=i.length,A=0,o=0;o<s&&(i[o]===","&&A++,A!==3);o++);if(t.hasValue()&&this.isString()&&A!==3){var g=new BI(i);g.ok&&(g.alpha=t.getNumber(),i=g.toRGBA())}return new Ki(this.document,this.name,i)}};Ki.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};Kp=class{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(t,i){this.viewPorts.push({width:t,height:i})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:t}=this;return t[t.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return typeof t=="number"?t:t==="x"?this.width:t==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}},In=class{constructor(t,i){this.x=t,this.y=i}static parse(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[s=i,A=i]=Vo(t);return new In(s,A)}static parseScale(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[s=i,A=s]=Vo(t);return new In(s,A)}static parsePath(t){for(var i=Vo(t),s=i.length,A=[],o=0;o<s;o+=2)A.push(new In(i[o],i[o+1]));return A}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){var{x:i,y:s}=this,A=i*t[0]+s*t[2]+t[4],o=i*t[1]+s*t[3]+t[5];this.x=A,this.y=o}},Wp=class{constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:t,onClick:i,onMouseMove:s}=this,A=t.ctx.canvas;A.onclick=i,A.onmousemove=s,this.working=!0}}stop(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:t,events:i,eventElements:s}=this,{style:A}=t.ctx.canvas;A&&(A.cursor=""),i.forEach((o,g)=>{for(var{run:d}=o,C=s[g];C;)d(C),C=C.parent}),this.events=[],this.eventElements=[]}}checkPath(t,i){if(!(!this.working||!i)){var{events:s,eventElements:A}=this;s.forEach((o,g)=>{var{x:d,y:C}=o;!A[g]&&i.isPointInPath&&i.isPointInPath(d,C)&&(A[g]=t)})}}checkBoundingBox(t,i){if(!(!this.working||!i)){var{events:s,eventElements:A}=this;s.forEach((o,g)=>{var{x:d,y:C}=o;!A[g]&&i.isPointInBox(d,C)&&(A[g]=t)})}}mapXY(t,i){for(var{window:s,ctx:A}=this.screen,o=new In(t,i),g=A.canvas;g;)o.x-=g.offsetLeft,o.y-=g.offsetTop,g=g.offsetParent;return s.scrollX&&(o.x+=s.scrollX),s.scrollY&&(o.y+=s.scrollY),o}onClick(t){var{x:i,y:s}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:i,y:s,run(A){A.onClick&&A.onClick()}})}onMouseMove(t){var{x:i,y:s}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:i,y:s,run(A){A.onMouseMove&&A.onMouseMove()}})}},jx=typeof window<"u"?window:null,qx=typeof fetch<"u"?fetch.bind(void 0):null,zc=class{constructor(t){var{fetch:i=qx,window:s=jx}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=t,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new Kp,this.mouse=new Wp(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=s,this.fetch=i}wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var t=this.waits.every(i=>i());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){var{document:i,ctx:s,aspectRatio:A,width:o,desiredWidth:g,height:d,desiredHeight:C,minX:v=0,minY:x=0,refX:T,refY:G,clip:k=!1,clipX:W=0,clipY:K=0}=t,$=eu(A).replace(/^defer\s/,""),[O,tt]=$.split(" "),at=O||"xMidYMid",Lt=tt||"meet",Tt=o/g,Qt=d/C,Ft=Math.min(Tt,Qt),vt=Math.max(Tt,Qt),Jt=g,qt=C;Lt==="meet"&&(Jt*=Ft,qt*=Ft),Lt==="slice"&&(Jt*=vt,qt*=vt);var At=new Ki(i,"refX",T),lt=new Ki(i,"refY",G),kt=At.hasValue()&&lt.hasValue();if(kt&&s.translate(-Ft*At.getPixels("x"),-Ft*lt.getPixels("y")),k){var _t=Ft*W,le=Ft*K;s.beginPath(),s.moveTo(_t,le),s.lineTo(o,le),s.lineTo(o,d),s.lineTo(_t,d),s.closePath(),s.clip()}if(!kt){var ie=Lt==="meet"&&Ft===Qt,ne=Lt==="slice"&&vt===Qt,te=Lt==="meet"&&Ft===Tt,wt=Lt==="slice"&&vt===Tt;at.startsWith("xMid")&&(ie||ne)&&s.translate(o/2-Jt/2,0),at.endsWith("YMid")&&(te||wt)&&s.translate(0,d/2-qt/2),at.startsWith("xMax")&&(ie||ne)&&s.translate(o-Jt,0),at.endsWith("YMax")&&(te||wt)&&s.translate(0,d-qt)}switch(!0){case at==="none":s.scale(Tt,Qt);break;case Lt==="meet":s.scale(Ft,Ft);break;case Lt==="slice":s.scale(vt,vt);break}s.translate(-v,-x)}start(t){var{enableRedraw:i=!1,ignoreMouse:s=!1,ignoreAnimation:A=!1,ignoreDimensions:o=!1,ignoreClear:g=!1,forceRedraw:d,scaleWidth:C,scaleHeight:v,offsetX:x,offsetY:T}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:G,mouse:k}=this,W=1e3/G;if(this.frameDuration=W,this.readyPromise=new Promise(at=>{this.resolveReady=at}),this.isReady()&&this.render(t,o,g,C,v,x,T),!!i){var K=Date.now(),$=K,O=0,tt=()=>{K=Date.now(),O=K-$,O>=W&&($=K-O%W,this.shouldUpdate(A,d)&&(this.render(t,o,g,C,v,x,T),k.runEvents())),this.intervalId=Y0(tt)};s||k.start(),this.intervalId=Y0(tt)}}stop(){this.intervalId&&(Y0.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,i){if(!t){var{frameDuration:s}=this,A=this.animations.reduce((o,g)=>g.update(s)||o,!1);if(A)return!0}return!!(typeof i=="function"&&i()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(t,i,s,A,o,g,d){var{CLIENT_WIDTH:C,CLIENT_HEIGHT:v,viewPort:x,ctx:T,isFirstRender:G}=this,k=T.canvas;x.clear(),k.width&&k.height?x.setCurrent(k.width,k.height):x.setCurrent(C,v);var W=t.getStyle("width"),K=t.getStyle("height");!i&&(G||typeof A!="number"&&typeof o!="number")&&(W.hasValue()&&(k.width=W.getPixels("x"),k.style&&(k.style.width="".concat(k.width,"px"))),K.hasValue()&&(k.height=K.getPixels("y"),k.style&&(k.style.height="".concat(k.height,"px"))));var $=k.clientWidth||k.width,O=k.clientHeight||k.height;if(i&&W.hasValue()&&K.hasValue()&&($=W.getPixels("x"),O=K.getPixels("y")),x.setCurrent($,O),typeof g=="number"&&t.getAttribute("x",!0).setValue(g),typeof d=="number"&&t.getAttribute("y",!0).setValue(d),typeof A=="number"||typeof o=="number"){var tt=Vo(t.getAttribute("viewBox").getString()),at=0,Lt=0;if(typeof A=="number"){var Tt=t.getStyle("width");Tt.hasValue()?at=Tt.getPixels("x")/A:isNaN(tt[2])||(at=tt[2]/A)}if(typeof o=="number"){var Qt=t.getStyle("height");Qt.hasValue()?Lt=Qt.getPixels("y")/o:isNaN(tt[3])||(Lt=tt[3]/o)}at||(at=Lt),Lt||(Lt=at),t.getAttribute("width",!0).setValue(A),t.getAttribute("height",!0).setValue(o);var Ft=t.getStyle("transform",!0,!0);Ft.setValue("".concat(Ft.getString()," scale(").concat(1/at,", ").concat(1/Lt,")"))}s||T.clearRect(0,0,$,O),t.render(T),G&&(this.isFirstRender=!1)}};zc.defaultWindow=jx;zc.defaultFetch=qx;({defaultFetch:T6}=zc),Q6=typeof DOMParser<"u"?DOMParser:null,Xu=class{constructor(){var{fetch:t=T6,DOMParser:i=Q6}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=t,this.DOMParser=i}parse(t){var i=this;return xl(function*(){return t.startsWith("<")?i.parseFromString(t):i.load(t)})()}parseFromString(t){var i=new this.DOMParser;try{return this.checkDocument(i.parseFromString(t,"image/svg+xml"))}catch{return this.checkDocument(i.parseFromString(t,"text/xml"))}}checkDocument(t){var i=t.getElementsByTagName("parsererror")[0];if(i)throw new Error(i.textContent);return t}load(t){var i=this;return xl(function*(){var s=yield i.fetch(t),A=yield s.text();return i.parseFromString(A)})()}},Op=class{constructor(t,i){this.type="translate",this.point=null,this.point=In.parse(i)}apply(t){var{x:i,y:s}=this.point;t.translate(i||0,s||0)}unapply(t){var{x:i,y:s}=this.point;t.translate(-1*i||0,-1*s||0)}applyToPoint(t){var{x:i,y:s}=this.point;t.applyTransform([1,0,0,1,i||0,s||0])}},zp=class{constructor(t,i,s){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var A=Vo(i);this.angle=new Ki(t,"angle",A[0]),this.originX=s[0],this.originY=s[1],this.cx=A[1]||0,this.cy=A[2]||0}apply(t){var{cx:i,cy:s,originX:A,originY:o,angle:g}=this,d=i+A.getPixels("x"),C=s+o.getPixels("y");t.translate(d,C),t.rotate(g.getRadians()),t.translate(-d,-C)}unapply(t){var{cx:i,cy:s,originX:A,originY:o,angle:g}=this,d=i+A.getPixels("x"),C=s+o.getPixels("y");t.translate(d,C),t.rotate(-1*g.getRadians()),t.translate(-d,-C)}applyToPoint(t){var{cx:i,cy:s,angle:A}=this,o=A.getRadians();t.applyTransform([1,0,0,1,i||0,s||0]),t.applyTransform([Math.cos(o),Math.sin(o),-Math.sin(o),Math.cos(o),0,0]),t.applyTransform([1,0,0,1,-i||0,-s||0])}},Jp=class{constructor(t,i,s){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var A=In.parseScale(i);(A.x===0||A.y===0)&&(A.x=Wc,A.y=Wc),this.scale=A,this.originX=s[0],this.originY=s[1]}apply(t){var{scale:{x:i,y:s},originX:A,originY:o}=this,g=A.getPixels("x"),d=o.getPixels("y");t.translate(g,d),t.scale(i,s||i),t.translate(-g,-d)}unapply(t){var{scale:{x:i,y:s},originX:A,originY:o}=this,g=A.getPixels("x"),d=o.getPixels("y");t.translate(g,d),t.scale(1/i,1/s||i),t.translate(-g,-d)}applyToPoint(t){var{x:i,y:s}=this.scale;t.applyTransform([i||0,0,0,s||0,0,0])}},Bg=class{constructor(t,i,s){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=Vo(i),this.originX=s[0],this.originY=s[1]}apply(t){var{originX:i,originY:s,matrix:A}=this,o=i.getPixels("x"),g=s.getPixels("y");t.translate(o,g),t.transform(A[0],A[1],A[2],A[3],A[4],A[5]),t.translate(-o,-g)}unapply(t){var{originX:i,originY:s,matrix:A}=this,o=A[0],g=A[2],d=A[4],C=A[1],v=A[3],x=A[5],T=0,G=0,k=1,W=1/(o*(v*k-x*G)-g*(C*k-x*T)+d*(C*G-v*T)),K=i.getPixels("x"),$=s.getPixels("y");t.translate(K,$),t.transform(W*(v*k-x*G),W*(x*T-C*k),W*(d*G-g*k),W*(o*k-d*T),W*(g*x-d*v),W*(d*C-o*x)),t.translate(-K,-$)}applyToPoint(t){t.applyTransform(this.matrix)}},_g=class extends Bg{constructor(t,i,s){super(t,i,s),this.type="skew",this.angle=null,this.angle=new Ki(t,"angle",i)}},Xp=class extends _g{constructor(t,i,s){super(t,i,s),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}},Yp=class extends _g{constructor(t,i,s){super(t,i,s),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}};OA=class{constructor(t,i,s){this.document=t,this.transforms=[];var A=U6(i);A.forEach(o=>{if(o!=="none"){var[g,d]=G6(o),C=OA.transformTypes[g];typeof C<"u"&&this.transforms.push(new C(this.document,d,s))}})}static fromElement(t,i){var s=i.getStyle("transform",!1,!0),[A,o=A]=i.getStyle("transform-origin",!1,!0).split(),g=[A,o];return s.hasValue()?new OA(t,s.getString(),g):null}apply(t){for(var{transforms:i}=this,s=i.length,A=0;A<s;A++)i[A].apply(t)}unapply(t){for(var{transforms:i}=this,s=i.length,A=s-1;A>=0;A--)i[A].unapply(t)}applyToPoint(t){for(var{transforms:i}=this,s=i.length,A=0;A<s;A++)i[A].applyToPoint(t)}};OA.transformTypes={translate:Op,rotate:zp,scale:Jp,matrix:Bg,skewX:Xp,skewY:Yp};tn=class{constructor(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=t,this.node=i,this.captureTextNodes=s,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!i||i.nodeType!==1)){if(Array.from(i.attributes).forEach(d=>{var C=Jx(d.nodeName);this.attributes[C]=new Ki(t,C,d.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var A=this.getAttribute("style").getString().split(";").map(d=>d.trim());A.forEach(d=>{if(d){var[C,v]=d.split(":").map(x=>x.trim());this.styles[C]=new Ki(t,C,v)}})}var{definitions:o}=t,g=this.getAttribute("id");g.hasValue()&&(o[g.getString()]||(o[g.getString()]=this)),Array.from(i.childNodes).forEach(d=>{if(d.nodeType===1)this.addChild(d);else if(s&&(d.nodeType===3||d.nodeType===4)){var C=t.createTextNode(d);C.getText().length>0&&this.addChild(C)}})}}getAttribute(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=this.attributes[t];if(!s&&i){var A=new Ki(this.document,t,"");return this.attributes[t]=A,A}return s||Ki.empty(this.document)}getHrefAttribute(){for(var t in this.attributes)if(t==="href"||t.endsWith(":href"))return this.attributes[t];return Ki.empty(this.document)}getStyle(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=this.styles[t];if(A)return A;var o=this.getAttribute(t);if(o!=null&&o.hasValue())return this.styles[t]=o,o;if(!s){var{parent:g}=this;if(g){var d=g.getStyle(t);if(d!=null&&d.hasValue())return d}}if(i){var C=new Ki(this.document,t,"");return this.styles[t]=C,C}return A||Ki.empty(this.document)}render(t){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(t.save(),this.getStyle("mask").hasValue()){var i=this.getStyle("mask").getDefinition();i&&(this.applyEffects(t),i.apply(t,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var s=this.getStyle("filter").getDefinition();s&&(this.applyEffects(t),s.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){var i=OA.fromElement(this.document,this);i&&i.apply(t);var s=this.getStyle("clip-path",!1,!0);if(s.hasValue()){var A=s.getDefinition();A&&A.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(i=>{i.render(t)})}addChild(t){var i=t instanceof tn?t:this.document.createElement(t);i.parent=this,tn.ignoreChildTypes.includes(i.type)||this.children.push(i)}matchesSelector(t){var i,{node:s}=this;if(typeof s.matches=="function")return s.matches(t);var A=(i=s.getAttribute)===null||i===void 0?void 0:i.call(s,"class");return!A||A===""?!1:A.split(" ").some(o=>".".concat(o)===t)}addStylesFromStyleDefinition(){var{styles:t,stylesSpecificity:i}=this.document;for(var s in t)if(!s.startsWith("@")&&this.matchesSelector(s)){var A=t[s],o=i[s];if(A)for(var g in A){var d=this.stylesSpecificity[g];typeof d>"u"&&(d="000"),o>=d&&(this.styles[g]=A[g],this.stylesSpecificity[g]=o)}}}removeStyles(t,i){var s=i.reduce((A,o)=>{var g=t.getStyle(o);if(!g.hasValue())return A;var d=g.getString();return g.setValue(""),[...A,[o,d]]},[]);return s}restoreStyles(t,i){i.forEach(s=>{var[A,o]=s;t.getStyle(A,!0).setValue(o)})}isFirstChild(){var t;return((t=this.parent)===null||t===void 0?void 0:t.children.indexOf(this))===0}};tn.ignoreChildTypes=["title"];jp=class extends tn{constructor(t,i,s){super(t,i,s)}};Cs=class{constructor(t,i,s,A,o,g){var d=g?typeof g=="string"?Cs.parse(g):g:{};this.fontFamily=o||d.fontFamily,this.fontSize=A||d.fontSize,this.fontStyle=t||d.fontStyle,this.fontWeight=s||d.fontWeight,this.fontVariant=i||d.fontVariant}static parse(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0,s="",A="",o="",g="",d="",C=eu(t).trim().split(" "),v={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return C.forEach(x=>{switch(!0){case(!v.fontStyle&&Cs.styles.includes(x)):x!=="inherit"&&(s=x),v.fontStyle=!0;break;case(!v.fontVariant&&Cs.variants.includes(x)):x!=="inherit"&&(A=x),v.fontStyle=!0,v.fontVariant=!0;break;case(!v.fontWeight&&Cs.weights.includes(x)):x!=="inherit"&&(o=x),v.fontStyle=!0,v.fontVariant=!0,v.fontWeight=!0;break;case!v.fontSize:x!=="inherit"&&([g]=x.split("/")),v.fontStyle=!0,v.fontVariant=!0,v.fontWeight=!0,v.fontSize=!0;break;default:x!=="inherit"&&(d+=x)}}),new Cs(s,A,o,g,d,i)}toString(){return[Z6(this.fontStyle),this.fontVariant,P6(this.fontWeight),this.fontSize,H6(this.fontFamily)].join(" ").trim()}};Cs.styles="normal|italic|oblique|inherit";Cs.variants="normal|small-caps|inherit";Cs.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";Do=class{constructor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=t,this.y1=i,this.x2=s,this.y2=A,this.addPoint(t,i),this.addPoint(s,A)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,i){typeof t<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof i<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=i,this.y2=i),i<this.y1&&(this.y1=i),i>this.y2&&(this.y2=i))}addX(t){this.addPoint(t,null)}addY(t){this.addPoint(null,t)}addBoundingBox(t){if(t){var{x1:i,y1:s,x2:A,y2:o}=t;this.addPoint(i,s),this.addPoint(A,o)}}sumCubic(t,i,s,A,o){return Math.pow(1-t,3)*i+3*Math.pow(1-t,2)*t*s+3*(1-t)*Math.pow(t,2)*A+Math.pow(t,3)*o}bezierCurveAdd(t,i,s,A,o){var g=6*i-12*s+6*A,d=-3*i+9*s-9*A+3*o,C=3*s-3*i;if(d===0){if(g===0)return;var v=-C/g;0<v&&v<1&&(t?this.addX(this.sumCubic(v,i,s,A,o)):this.addY(this.sumCubic(v,i,s,A,o)));return}var x=Math.pow(g,2)-4*C*d;if(!(x<0)){var T=(-g+Math.sqrt(x))/(2*d);0<T&&T<1&&(t?this.addX(this.sumCubic(T,i,s,A,o)):this.addY(this.sumCubic(T,i,s,A,o)));var G=(-g-Math.sqrt(x))/(2*d);0<G&&G<1&&(t?this.addX(this.sumCubic(G,i,s,A,o)):this.addY(this.sumCubic(G,i,s,A,o)))}}addBezierCurve(t,i,s,A,o,g,d,C){this.addPoint(t,i),this.addPoint(d,C),this.bezierCurveAdd(!0,t,s,o,d),this.bezierCurveAdd(!1,i,A,g,C)}addQuadraticCurve(t,i,s,A,o,g){var d=t+.6666666666666666*(s-t),C=i+2/3*(A-i),v=d+1/3*(o-t),x=C+1/3*(g-i);this.addBezierCurve(t,i,d,v,C,x,o,g)}isPointInBox(t,i){var{x1:s,y1:A,x2:o,y2:g}=this;return s<=t&&t<=o&&A<=i&&i<=g}},Ar=class extends De{constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new In(0,0),this.control=new In(0,0),this.current=new In(0,0),this.points=[],this.angles=[]}isEnd(){var{i:t,commands:i}=this;return t>=i.length-1}next(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",s=new In(this.command[t],this.command[i]);return this.makeAbsolute(s)}getAsControlPoint(t,i){var s=this.getPoint(t,i);return this.control=s,s}getAsCurrentPoint(t,i){var s=this.getPoint(t,i);return this.current=s,s}getReflectedControlPoint(){var t=this.previousCommand.type;if(t!==De.CURVE_TO&&t!==De.SMOOTH_CURVE_TO&&t!==De.QUAD_TO&&t!==De.SMOOTH_QUAD_TO)return this.current;var{current:{x:i,y:s},control:{x:A,y:o}}=this,g=new In(2*i-A,2*s-o);return g}makeAbsolute(t){if(this.command.relative){var{x:i,y:s}=this.current;t.x+=i,t.y+=s}return t}addMarker(t,i,s){var{points:A,angles:o}=this;s&&o.length>0&&!o[o.length-1]&&(o[o.length-1]=A[A.length-1].angleTo(s)),this.addMarkerAngle(t,i?i.angleTo(t):null)}addMarkerAngle(t,i){this.points.push(t),this.angles.push(i)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:t}=this,i=t.length,s=0;s<i;s++)if(!t[s]){for(var A=s+1;A<i;A++)if(t[A]){t[s]=t[A];break}}return t}},zA=class extends tn{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var t=1,i=this;i;){var s=i.getStyle("opacity",!1,!0);s.hasValue(!0)&&(t*=s.getNumber()),i=i.parent}return t}setContext(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!i){var s=this.getStyle("fill"),A=this.getStyle("fill-opacity"),o=this.getStyle("stroke"),g=this.getStyle("stroke-opacity");if(s.isUrlDefinition()){var d=s.getFillStyleDefinition(this,A);d&&(t.fillStyle=d)}else if(s.hasValue()){s.getString()==="currentColor"&&s.setValue(this.getStyle("color").getColor());var C=s.getColor();C!=="inherit"&&(t.fillStyle=C==="none"?"rgba(0,0,0,0)":C)}if(A.hasValue()){var v=new Ki(this.document,"fill",t.fillStyle).addOpacity(A).getColor();t.fillStyle=v}if(o.isUrlDefinition()){var x=o.getFillStyleDefinition(this,g);x&&(t.strokeStyle=x)}else if(o.hasValue()){o.getString()==="currentColor"&&o.setValue(this.getStyle("color").getColor());var T=o.getString();T!=="inherit"&&(t.strokeStyle=T==="none"?"rgba(0,0,0,0)":T)}if(g.hasValue()){var G=new Ki(this.document,"stroke",t.strokeStyle).addOpacity(g).getString();t.strokeStyle=G}var k=this.getStyle("stroke-width");if(k.hasValue()){var W=k.getPixels();t.lineWidth=W||Wc}var K=this.getStyle("stroke-linecap"),$=this.getStyle("stroke-linejoin"),O=this.getStyle("stroke-miterlimit"),tt=this.getStyle("stroke-dasharray"),at=this.getStyle("stroke-dashoffset");if(K.hasValue()&&(t.lineCap=K.getString()),$.hasValue()&&(t.lineJoin=$.getString()),O.hasValue()&&(t.miterLimit=O.getNumber()),tt.hasValue()&&tt.getString()!=="none"){var Lt=Vo(tt.getString());typeof t.setLineDash<"u"?t.setLineDash(Lt):typeof t.webkitLineDash<"u"?t.webkitLineDash=Lt:typeof t.mozDash<"u"&&!(Lt.length===1&&Lt[0]===0)&&(t.mozDash=Lt);var Tt=at.getPixels();typeof t.lineDashOffset<"u"?t.lineDashOffset=Tt:typeof t.webkitLineDashOffset<"u"?t.webkitLineDashOffset=Tt:typeof t.mozDashOffset<"u"&&(t.mozDashOffset=Tt)}}if(this.modifiedEmSizeStack=!1,typeof t.font<"u"){var Qt=this.getStyle("font"),Ft=this.getStyle("font-style"),vt=this.getStyle("font-variant"),Jt=this.getStyle("font-weight"),qt=this.getStyle("font-size"),At=this.getStyle("font-family"),lt=new Cs(Ft.getString(),vt.getString(),Jt.getString(),qt.hasValue()?"".concat(qt.getPixels(!0),"px"):"",At.getString(),Cs.parse(Qt.getString(),t.font));Ft.setValue(lt.fontStyle),vt.setValue(lt.fontVariant),Jt.setValue(lt.fontWeight),qt.setValue(lt.fontSize),At.setValue(lt.fontFamily),t.font=lt.toString(),qt.isPixels()&&(this.document.emSize=qt.getPixels(),this.modifiedEmSizeStack=!0)}i||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}},Pr=class extends zA{constructor(t,i,s){super(t,i,s),this.type="path",this.pathParser=null,this.pathParser=new Ar(this.getAttribute("d").getString())}path(t){var{pathParser:i}=this,s=new Do;for(i.reset(),t&&t.beginPath();!i.isEnd();)switch(i.next().type){case Ar.MOVE_TO:this.pathM(t,s);break;case Ar.LINE_TO:this.pathL(t,s);break;case Ar.HORIZ_LINE_TO:this.pathH(t,s);break;case Ar.VERT_LINE_TO:this.pathV(t,s);break;case Ar.CURVE_TO:this.pathC(t,s);break;case Ar.SMOOTH_CURVE_TO:this.pathS(t,s);break;case Ar.QUAD_TO:this.pathQ(t,s);break;case Ar.SMOOTH_QUAD_TO:this.pathT(t,s);break;case Ar.ARC:this.pathA(t,s);break;case Ar.CLOSE_PATH:this.pathZ(t,s);break}return s}getBoundingBox(t){return this.path()}getMarkers(){var{pathParser:t}=this,i=t.getMarkerPoints(),s=t.getMarkerAngles(),A=i.map((o,g)=>[o,s[g]]);return A}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var i=this.getStyle("fill-rule");t.fillStyle!==""&&(i.getString("inherit")!=="inherit"?t.fill(i.getString()):t.fill()),t.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var s=this.getMarkers();if(s){var A=s.length-1,o=this.getStyle("marker-start"),g=this.getStyle("marker-mid"),d=this.getStyle("marker-end");if(o.isUrlDefinition()){var C=o.getDefinition(),[v,x]=s[0];C.render(t,v,x)}if(g.isUrlDefinition())for(var T=g.getDefinition(),G=1;G<A;G++){var[k,W]=s[G];T.render(t,k,W)}if(d.isUrlDefinition()){var K=d.getDefinition(),[$,O]=s[A];K.render(t,$,O)}}}static pathM(t){var i=t.getAsCurrentPoint();return t.start=t.current,{point:i}}pathM(t,i){var{pathParser:s}=this,{point:A}=Pr.pathM(s),{x:o,y:g}=A;s.addMarker(A),i.addPoint(o,g),t&&t.moveTo(o,g)}static pathL(t){var{current:i}=t,s=t.getAsCurrentPoint();return{current:i,point:s}}pathL(t,i){var{pathParser:s}=this,{current:A,point:o}=Pr.pathL(s),{x:g,y:d}=o;s.addMarker(o,A),i.addPoint(g,d),t&&t.lineTo(g,d)}static pathH(t){var{current:i,command:s}=t,A=new In((s.relative?i.x:0)+s.x,i.y);return t.current=A,{current:i,point:A}}pathH(t,i){var{pathParser:s}=this,{current:A,point:o}=Pr.pathH(s),{x:g,y:d}=o;s.addMarker(o,A),i.addPoint(g,d),t&&t.lineTo(g,d)}static pathV(t){var{current:i,command:s}=t,A=new In(i.x,(s.relative?i.y:0)+s.y);return t.current=A,{current:i,point:A}}pathV(t,i){var{pathParser:s}=this,{current:A,point:o}=Pr.pathV(s),{x:g,y:d}=o;s.addMarker(o,A),i.addPoint(g,d),t&&t.lineTo(g,d)}static pathC(t){var{current:i}=t,s=t.getPoint("x1","y1"),A=t.getAsControlPoint("x2","y2"),o=t.getAsCurrentPoint();return{current:i,point:s,controlPoint:A,currentPoint:o}}pathC(t,i){var{pathParser:s}=this,{current:A,point:o,controlPoint:g,currentPoint:d}=Pr.pathC(s);s.addMarker(d,g,o),i.addBezierCurve(A.x,A.y,o.x,o.y,g.x,g.y,d.x,d.y),t&&t.bezierCurveTo(o.x,o.y,g.x,g.y,d.x,d.y)}static pathS(t){var{current:i}=t,s=t.getReflectedControlPoint(),A=t.getAsControlPoint("x2","y2"),o=t.getAsCurrentPoint();return{current:i,point:s,controlPoint:A,currentPoint:o}}pathS(t,i){var{pathParser:s}=this,{current:A,point:o,controlPoint:g,currentPoint:d}=Pr.pathS(s);s.addMarker(d,g,o),i.addBezierCurve(A.x,A.y,o.x,o.y,g.x,g.y,d.x,d.y),t&&t.bezierCurveTo(o.x,o.y,g.x,g.y,d.x,d.y)}static pathQ(t){var{current:i}=t,s=t.getAsControlPoint("x1","y1"),A=t.getAsCurrentPoint();return{current:i,controlPoint:s,currentPoint:A}}pathQ(t,i){var{pathParser:s}=this,{current:A,controlPoint:o,currentPoint:g}=Pr.pathQ(s);s.addMarker(g,o,o),i.addQuadraticCurve(A.x,A.y,o.x,o.y,g.x,g.y),t&&t.quadraticCurveTo(o.x,o.y,g.x,g.y)}static pathT(t){var{current:i}=t,s=t.getReflectedControlPoint();t.control=s;var A=t.getAsCurrentPoint();return{current:i,controlPoint:s,currentPoint:A}}pathT(t,i){var{pathParser:s}=this,{current:A,controlPoint:o,currentPoint:g}=Pr.pathT(s);s.addMarker(g,o,o),i.addQuadraticCurve(A.x,A.y,o.x,o.y,g.x,g.y),t&&t.quadraticCurveTo(o.x,o.y,g.x,g.y)}static pathA(t){var{current:i,command:s}=t,{rX:A,rY:o,xRot:g,lArcFlag:d,sweepFlag:C}=s,v=g*(Math.PI/180),x=t.getAsCurrentPoint(),T=new In(Math.cos(v)*(i.x-x.x)/2+Math.sin(v)*(i.y-x.y)/2,-Math.sin(v)*(i.x-x.x)/2+Math.cos(v)*(i.y-x.y)/2),G=Math.pow(T.x,2)/Math.pow(A,2)+Math.pow(T.y,2)/Math.pow(o,2);G>1&&(A*=Math.sqrt(G),o*=Math.sqrt(G));var k=(d===C?-1:1)*Math.sqrt((Math.pow(A,2)*Math.pow(o,2)-Math.pow(A,2)*Math.pow(T.y,2)-Math.pow(o,2)*Math.pow(T.x,2))/(Math.pow(A,2)*Math.pow(T.y,2)+Math.pow(o,2)*Math.pow(T.x,2)));isNaN(k)&&(k=0);var W=new In(k*A*T.y/o,k*-o*T.x/A),K=new In((i.x+x.x)/2+Math.cos(v)*W.x-Math.sin(v)*W.y,(i.y+x.y)/2+Math.sin(v)*W.x+Math.cos(v)*W.y),$=FI([1,0],[(T.x-W.x)/A,(T.y-W.y)/o]),O=[(T.x-W.x)/A,(T.y-W.y)/o],tt=[(-T.x-W.x)/A,(-T.y-W.y)/o],at=FI(O,tt);return Dp(O,tt)<=-1&&(at=Math.PI),Dp(O,tt)>=1&&(at=0),{currentPoint:x,rX:A,rY:o,sweepFlag:C,xAxisRotation:v,centp:K,a1:$,ad:at}}pathA(t,i){var{pathParser:s}=this,{currentPoint:A,rX:o,rY:g,sweepFlag:d,xAxisRotation:C,centp:v,a1:x,ad:T}=Pr.pathA(s),G=1-d?1:-1,k=x+G*(T/2),W=new In(v.x+o*Math.cos(k),v.y+g*Math.sin(k));if(s.addMarkerAngle(W,k-G*Math.PI/2),s.addMarkerAngle(A,k-G*Math.PI),i.addPoint(A.x,A.y),t&&!isNaN(x)&&!isNaN(T)){var K=o>g?o:g,$=o>g?1:o/g,O=o>g?g/o:1;t.translate(v.x,v.y),t.rotate(C),t.scale($,O),t.arc(0,0,K,x,x+T,!!(1-d)),t.scale(1/$,1/O),t.rotate(-C),t.translate(-v.x,-v.y)}}static pathZ(t){t.current=t.start}pathZ(t,i){Pr.pathZ(this.pathParser),t&&i.x1!==i.x2&&i.y1!==i.y2&&t.closePath()}},xg=class extends Pr{constructor(t,i,s){super(t,i,s),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}},AA=class extends zA{constructor(t,i,s){super(t,i,new.target===AA?!0:s),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(t,i);var s=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();s&&(t.textBaseline=s)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if(this.type!=="text")return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);var i=null;return this.children.forEach((s,A)=>{var o=this.getChildBoundingBox(t,this,this,A);i?i.addBoundingBox(o):i=o}),i}getFontSize(){var{document:t,parent:i}=this,s=Cs.parse(t.ctx.font).fontSize,A=i.getStyle("font-size").getNumber(s);return A}getTElementBoundingBox(t){var i=this.getFontSize();return new Do(this.x,this.y-i,this.x+this.measureText(t),this.y)}getGlyph(t,i,s){var A=i[s],o=null;if(t.isArabic){var g=i.length,d=i[s-1],C=i[s+1],v="isolated";if((s===0||d===" ")&&s<g-1&&C!==" "&&(v="terminal"),s>0&&d!==" "&&s<g-1&&C!==" "&&(v="medial"),s>0&&d!==" "&&(s===g-1||C===" ")&&(v="initial"),typeof t.glyphs[A]<"u"){var x=t.glyphs[A];o=x instanceof xg?x:x[v]}}else o=t.glyphs[A];return o||(o=t.missingGlyph),o}getText(){return""}getTextFromNode(t){var i=t||this.node,s=Array.from(i.parentNode.childNodes),A=s.indexOf(i),o=s.length-1,g=eu(i.textContent||"");return A===0&&(g=Ox(g)),A===o&&(g=zx(g)),g}renderChildren(t){if(this.type!=="text"){this.renderTElementChildren(t);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((s,A)=>{this.renderChild(t,this,this,A)});var{mouse:i}=this.document.screen;i.isWorking()&&i.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){var{document:i,parent:s}=this,A=this.getText(),o=s.getStyle("font-family").getDefinition();if(o){for(var{unitsPerEm:g}=o.fontFace,d=Cs.parse(i.ctx.font),C=s.getStyle("font-size").getNumber(d.fontSize),v=s.getStyle("font-style").getString(d.fontStyle),x=C/g,T=o.isRTL?A.split("").reverse().join(""):A,G=Vo(s.getAttribute("dx").getString()),k=T.length,W=0;W<k;W++){var K=this.getGlyph(o,T,W);t.translate(this.x,this.y),t.scale(x,-x);var $=t.lineWidth;t.lineWidth=t.lineWidth*g/C,v==="italic"&&t.transform(1,0,.4,1,0,0),K.render(t),v==="italic"&&t.transform(1,0,-.4,1,0,0),t.lineWidth=$,t.scale(1/x,-1/x),t.translate(-this.x,-this.y),this.x+=C*(K.horizAdvX||o.horizAdvX)/g,typeof G[W]<"u"&&!isNaN(G[W])&&(this.x+=G[W])}return}var{x:O,y:tt}=this;t.fillStyle&&t.fillText(A,O,tt),t.strokeStyle&&t.strokeText(A,O,tt)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var t=this.leafTexts[this.textChunkStart],i=t.getStyle("text-anchor").getString("start"),s=!1,A=0;i==="start"&&!s||i==="end"&&s?A=t.x-this.minX:i==="end"&&!s||i==="start"&&s?A=t.x-this.maxX:A=t.x-(this.minX+this.maxX)/2;for(var o=this.textChunkStart;o<this.leafTexts.length;o++)this.leafTexts[o].x+=A;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(t){this.children.forEach((i,s)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,s)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,i,s,A){var o=s.children[A];o.children.length>0?o.children.forEach((g,d)=>{i.adjustChildCoordinatesRecursiveCore(t,i,o,d)}):this.adjustChildCoordinates(t,i,s,A)}adjustChildCoordinates(t,i,s,A){var o=s.children[A];if(typeof o.measureText!="function")return o;t.save(),o.setContext(t,!0);var g=o.getAttribute("x"),d=o.getAttribute("y"),C=o.getAttribute("dx"),v=o.getAttribute("dy"),x=o.getStyle("font-family").getDefinition(),T=!!x&&x.isRTL;A===0&&(g.hasValue()||g.setValue(o.getInheritedAttribute("x")),d.hasValue()||d.setValue(o.getInheritedAttribute("y")),C.hasValue()||C.setValue(o.getInheritedAttribute("dx")),v.hasValue()||v.setValue(o.getInheritedAttribute("dy")));var G=o.measureText(t);return T&&(i.x-=G),g.hasValue()?(i.applyAnchoring(),o.x=g.getPixels("x"),C.hasValue()&&(o.x+=C.getPixels("x"))):(C.hasValue()&&(i.x+=C.getPixels("x")),o.x=i.x),i.x=o.x,T||(i.x+=G),d.hasValue()?(o.y=d.getPixels("y"),v.hasValue()&&(o.y+=v.getPixels("y"))):(v.hasValue()&&(i.y+=v.getPixels("y")),o.y=i.y),i.y=o.y,i.leafTexts.push(o),i.minX=Math.min(i.minX,o.x,o.x+G),i.maxX=Math.max(i.maxX,o.x,o.x+G),o.clearContext(t),t.restore(),o}getChildBoundingBox(t,i,s,A){var o=s.children[A];if(typeof o.getBoundingBox!="function")return null;var g=o.getBoundingBox(t);return g?(o.children.forEach((d,C)=>{var v=i.getChildBoundingBox(t,i,o,C);g.addBoundingBox(v)}),g):null}renderChild(t,i,s,A){var o=s.children[A];o.render(t),o.children.forEach((g,d)=>{i.renderChild(t,i,o,d)})}measureText(t){var{measureCache:i}=this;if(~i)return i;var s=this.getText(),A=this.measureTargetText(t,s);return this.measureCache=A,A}measureTargetText(t,i){if(!i.length)return 0;var{parent:s}=this,A=s.getStyle("font-family").getDefinition();if(A){for(var o=this.getFontSize(),g=A.isRTL?i.split("").reverse().join(""):i,d=Vo(s.getAttribute("dx").getString()),C=g.length,v=0,x=0;x<C;x++){var T=this.getGlyph(A,g,x);v+=(T.horizAdvX||A.horizAdvX)*o/A.fontFace.unitsPerEm,typeof d[x]<"u"&&!isNaN(d[x])&&(v+=d[x])}return v}if(!t.measureText)return i.length*10;t.save(),this.setContext(t,!0);var{width:G}=t.measureText(i);return this.clearContext(t),t.restore(),G}getInheritedAttribute(t){for(var i=this;i instanceof AA&&i.isFirstChild();){var s=i.parent.getAttribute(t);if(s.hasValue(!0))return s.getValue("0");i=i.parent}return null}},Jc=class extends AA{constructor(t,i,s){super(t,i,new.target===Jc?!0:s),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}},RI=class extends Jc{constructor(){super(...arguments),this.type="textNode"}},gc=class extends zA{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(t){var i,{document:s}=this,{screen:A,window:o}=s,g=t.canvas;if(A.setDefaults(t),g.style&&typeof t.font<"u"&&o&&typeof o.getComputedStyle<"u"){t.font=o.getComputedStyle(g).getPropertyValue("font");var d=new Ki(s,"fontSize",Cs.parse(t.font).fontSize);d.hasValue()&&(s.rootEmSize=d.getPixels("y"),s.emSize=s.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:C,height:v}=A.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var x=this.getAttribute("refX"),T=this.getAttribute("refY"),G=this.getAttribute("viewBox"),k=G.hasValue()?Vo(G.getString()):null,W=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",K=0,$=0,O=0,tt=0;k&&(K=k[0],$=k[1]),this.root||(C=this.getStyle("width").getPixels("x"),v=this.getStyle("height").getPixels("y"),this.type==="marker"&&(O=K,tt=$,K=0,$=0)),A.viewPort.setCurrent(C,v),this.node&&(!this.parent||((i=this.node.parentNode)===null||i===void 0?void 0:i.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),k&&(C=k[2],v=k[3]),s.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:A.viewPort.width,desiredWidth:C,height:A.viewPort.height,desiredHeight:v,minX:K,minY:$,refX:x.getValue(),refY:T.getValue(),clip:W,clipX:O,clipY:tt}),k&&(A.viewPort.removeCurrent(),A.viewPort.setCurrent(C,v))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=this.getAttribute("width",!0),o=this.getAttribute("height",!0),g=this.getAttribute("viewBox"),d=this.getAttribute("style"),C=A.getNumber(0),v=o.getNumber(0);if(s)if(typeof s=="string")this.getAttribute("preserveAspectRatio",!0).setValue(s);else{var x=this.getAttribute("preserveAspectRatio");x.hasValue()&&x.setValue(x.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(A.setValue(t),o.setValue(i),g.hasValue()||g.setValue("0 0 ".concat(C||t," ").concat(v||i)),d.hasValue()){var T=this.getStyle("width"),G=this.getStyle("height");T.hasValue()&&T.setValue("".concat(t,"px")),G.hasValue()&&G.setValue("".concat(i,"px"))}}},Sg=class extends Pr{constructor(){super(...arguments),this.type="rect"}path(t){var i=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),A=this.getStyle("width",!1,!0).getPixels("x"),o=this.getStyle("height",!1,!0).getPixels("y"),g=this.getAttribute("rx"),d=this.getAttribute("ry"),C=g.getPixels("x"),v=d.getPixels("y");if(g.hasValue()&&!d.hasValue()&&(v=C),d.hasValue()&&!g.hasValue()&&(C=v),C=Math.min(C,A/2),v=Math.min(v,o/2),t){var x=4*((Math.sqrt(2)-1)/3);t.beginPath(),o>0&&A>0&&(t.moveTo(i+C,s),t.lineTo(i+A-C,s),t.bezierCurveTo(i+A-C+x*C,s,i+A,s+v-x*v,i+A,s+v),t.lineTo(i+A,s+o-v),t.bezierCurveTo(i+A,s+o-v+x*v,i+A-C+x*C,s+o,i+A-C,s+o),t.lineTo(i+C,s+o),t.bezierCurveTo(i+C-x*C,s+o,i,s+o-v+x*v,i,s+o-v),t.lineTo(i,s+v),t.bezierCurveTo(i,s+v-x*v,i+C-x*C,s,i+C,s),t.closePath())}return new Do(i,s,i+A,s+o)}getMarkers(){return null}},qp=class extends Pr{constructor(){super(...arguments),this.type="circle"}path(t){var i=this.getAttribute("cx").getPixels("x"),s=this.getAttribute("cy").getPixels("y"),A=this.getAttribute("r").getPixels();return t&&A>0&&(t.beginPath(),t.arc(i,s,A,0,Math.PI*2,!1),t.closePath()),new Do(i-A,s-A,i+A,s+A)}getMarkers(){return null}},$p=class extends Pr{constructor(){super(...arguments),this.type="ellipse"}path(t){var i=4*((Math.sqrt(2)-1)/3),s=this.getAttribute("rx").getPixels("x"),A=this.getAttribute("ry").getPixels("y"),o=this.getAttribute("cx").getPixels("x"),g=this.getAttribute("cy").getPixels("y");return t&&s>0&&A>0&&(t.beginPath(),t.moveTo(o+s,g),t.bezierCurveTo(o+s,g+i*A,o+i*s,g+A,o,g+A),t.bezierCurveTo(o-i*s,g+A,o-s,g+i*A,o-s,g),t.bezierCurveTo(o-s,g-i*A,o-i*s,g-A,o,g-A),t.bezierCurveTo(o+i*s,g-A,o+s,g-i*A,o+s,g),t.closePath()),new Do(o-s,g-A,o+s,g+A)}getMarkers(){return null}},tf=class extends Pr{constructor(){super(...arguments),this.type="line"}getPoints(){return[new In(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new In(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){var[{x:i,y:s},{x:A,y:o}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(i,s),t.lineTo(A,o)),new Do(i,s,A,o)}getMarkers(){var[t,i]=this.getPoints(),s=t.angleTo(i);return[[t,s],[i,s]]}},Fg=class extends Pr{constructor(t,i,s){super(t,i,s),this.type="polyline",this.points=[],this.points=In.parsePath(this.getAttribute("points").getString())}path(t){var{points:i}=this,[{x:s,y:A}]=i,o=new Do(s,A);return t&&(t.beginPath(),t.moveTo(s,A)),i.forEach(g=>{var{x:d,y:C}=g;o.addPoint(d,C),t&&t.lineTo(d,C)}),o}getMarkers(){var{points:t}=this,i=t.length-1,s=[];return t.forEach((A,o)=>{o!==i&&s.push([A,A.angleTo(t[o+1])])}),s.length>0&&s.push([t[t.length-1],s[s.length-1][1]]),s}},ef=class extends Fg{constructor(){super(...arguments),this.type="polygon"}path(t){var i=super.path(t),[{x:s,y:A}]=this.points;return t&&(t.lineTo(s,A),t.closePath()),i}},rf=class extends tn{constructor(){super(...arguments),this.type="pattern"}createPattern(t,i,s){var A=this.getStyle("width").getPixels("x",!0),o=this.getStyle("height").getPixels("y",!0),g=new gc(this.document,null);g.attributes.viewBox=new Ki(this.document,"viewBox",this.getAttribute("viewBox").getValue()),g.attributes.width=new Ki(this.document,"width","".concat(A,"px")),g.attributes.height=new Ki(this.document,"height","".concat(o,"px")),g.attributes.transform=new Ki(this.document,"transform",this.getAttribute("patternTransform").getValue()),g.children=this.children;var d=this.document.createCanvas(A,o),C=d.getContext("2d"),v=this.getAttribute("x"),x=this.getAttribute("y");v.hasValue()&&x.hasValue()&&C.translate(v.getPixels("x",!0),x.getPixels("y",!0)),s.hasValue()?this.styles["fill-opacity"]=s:Reflect.deleteProperty(this.styles,"fill-opacity");for(var T=-1;T<=1;T++)for(var G=-1;G<=1;G++)C.save(),g.attributes.x=new Ki(this.document,"x",T*d.width),g.attributes.y=new Ki(this.document,"y",G*d.height),g.render(C),C.restore();var k=t.createPattern(d,"repeat");return k}},nf=class extends tn{constructor(){super(...arguments),this.type="marker"}render(t,i,s){if(i){var{x:A,y:o}=i,g=this.getAttribute("orient").getString("auto"),d=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(A,o),g==="auto"&&t.rotate(s),d==="strokeWidth"&&t.scale(t.lineWidth,t.lineWidth),t.save();var C=new gc(this.document,null);C.type=this.type,C.attributes.viewBox=new Ki(this.document,"viewBox",this.getAttribute("viewBox").getValue()),C.attributes.refX=new Ki(this.document,"refX",this.getAttribute("refX").getValue()),C.attributes.refY=new Ki(this.document,"refY",this.getAttribute("refY").getValue()),C.attributes.width=new Ki(this.document,"width",this.getAttribute("markerWidth").getValue()),C.attributes.height=new Ki(this.document,"height",this.getAttribute("markerHeight").getValue()),C.attributes.overflow=new Ki(this.document,"overflow",this.getAttribute("overflow").getValue()),C.attributes.fill=new Ki(this.document,"fill",this.getAttribute("fill").getColor("black")),C.attributes.stroke=new Ki(this.document,"stroke",this.getAttribute("stroke").getValue("none")),C.children=this.children,C.render(t),t.restore(),d==="strokeWidth"&&t.scale(1/t.lineWidth,1/t.lineWidth),g==="auto"&&t.rotate(-s),t.translate(-A,-o)}}},sf=class extends tn{constructor(){super(...arguments),this.type="defs"}render(){}},$u=class extends zA{constructor(){super(...arguments),this.type="g"}getBoundingBox(t){var i=new Do;return this.children.forEach(s=>{i.addBoundingBox(s.getBoundingBox(t))}),i}},kg=class extends tn{constructor(t,i,s){super(t,i,s),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:A,children:o}=this;o.forEach(g=>{g.type==="stop"&&A.push(g)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,i,s){var A=this;this.getHrefAttribute().hasValue()&&(A=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(A));var{stops:o}=A,g=this.getGradient(t,i);if(!g)return this.addParentOpacity(s,o[o.length-1].color);if(o.forEach($=>{g.addColorStop($.offset,this.addParentOpacity(s,$.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:d}=this,{MAX_VIRTUAL_PIXELS:C,viewPort:v}=d.screen,[x]=v.viewPorts,T=new Sg(d,null);T.attributes.x=new Ki(d,"x",-C/3),T.attributes.y=new Ki(d,"y",-C/3),T.attributes.width=new Ki(d,"width",C),T.attributes.height=new Ki(d,"height",C);var G=new $u(d,null);G.attributes.transform=new Ki(d,"transform",this.getAttribute("gradientTransform").getValue()),G.children=[T];var k=new gc(d,null);k.attributes.x=new Ki(d,"x",0),k.attributes.y=new Ki(d,"y",0),k.attributes.width=new Ki(d,"width",x.width),k.attributes.height=new Ki(d,"height",x.height),k.children=[G];var W=d.createCanvas(x.width,x.height),K=W.getContext("2d");return K.fillStyle=g,k.render(K),K.createPattern(W,"no-repeat")}return g}inheritStopContainer(t){this.attributesToInherit.forEach(i=>{!this.getAttribute(i).hasValue()&&t.getAttribute(i).hasValue()&&this.getAttribute(i,!0).setValue(t.getAttribute(i).getValue())})}addParentOpacity(t,i){if(t.hasValue()){var s=new Ki(this.document,"color",i);return s.addOpacity(t).getColor()}return i}},of=class extends kg{constructor(t,i,s){super(t,i,s),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(t,i){var s=this.getGradientUnits()==="objectBoundingBox",A=s?i.getBoundingBox(t):null;if(s&&!A)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var o=s?A.x+A.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),g=s?A.y+A.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),d=s?A.x+A.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),C=s?A.y+A.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return o===d&&g===C?null:t.createLinearGradient(o,g,d,C)}},af=class extends kg{constructor(t,i,s){super(t,i,s),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(t,i){var s=this.getGradientUnits()==="objectBoundingBox",A=i.getBoundingBox(t);if(s&&!A)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var o=s?A.x+A.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),g=s?A.y+A.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),d=o,C=g;this.getAttribute("fx").hasValue()&&(d=s?A.x+A.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(C=s?A.y+A.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var v=s?(A.width+A.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),x=this.getAttribute("fr").getPixels();return t.createRadialGradient(d,C,x,o,g,v)}},Af=class extends tn{constructor(t,i,s){super(t,i,s),this.type="stop";var A=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),o=this.getStyle("stop-opacity"),g=this.getStyle("stop-color",!0);g.getString()===""&&g.setValue("#000"),o.hasValue()&&(g=g.addOpacity(o)),this.offset=A,this.color=g.getColor()}},th=class extends tn{constructor(t,i,s){super(t,i,s),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Ki(t,"values",null);var A=this.getAttribute("values");A.hasValue()&&this.values.setValue(A.getString().split(";"))}getProperty(){var t=this.getAttribute("attributeType").getString(),i=this.getAttribute("attributeName").getString();return t==="CSS"?this.parent.getStyle(i,!0):this.parent.getAttribute(i,!0)}calcValue(){var{initialUnits:t}=this,{progress:i,from:s,to:A}=this.getProgress(),o=s.getNumber()+(A.getNumber()-s.getNumber())*i;return t==="%"&&(o*=100),"".concat(o).concat(t)}update(t){var{parent:i}=this,s=this.getProperty();if(this.initialValue||(this.initialValue=s.getString(),this.initialUnits=s.getUnits()),this.duration>this.maxDuration){var A=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(A==="freeze"&&!this.frozen)this.frozen=!0,i.animationFrozen=!0,i.animationFrozenValue=s.getString();else if(A==="remove"&&!this.removed)return this.removed=!0,s.setValue(i.animationFrozen?i.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=t;var o=!1;if(this.begin<this.duration){var g=this.calcValue(),d=this.getAttribute("type");if(d.hasValue()){var C=d.getString();g="".concat(C,"(").concat(g,")")}s.setValue(g),o=!0}return o}getProgress(){var{document:t,values:i}=this,s={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(i.hasValue()){var A=s.progress*(i.getValue().length-1),o=Math.floor(A),g=Math.ceil(A);s.from=new Ki(t,"from",parseFloat(i.getValue()[o])),s.to=new Ki(t,"to",parseFloat(i.getValue()[g])),s.progress=(A-o)/(g-o)}else s.from=this.from,s.to=this.to;return s}},lf=class extends th{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:t,from:i,to:s}=this.getProgress(),A=new BI(i.getColor()),o=new BI(s.getColor());if(A.ok&&o.ok){var g=A.r+(o.r-A.r)*t,d=A.g+(o.g-A.g)*t,C=A.b+(o.b-A.b)*t;return"rgb(".concat(Math.floor(g),", ").concat(Math.floor(d),", ").concat(Math.floor(C),")")}return this.getAttribute("from").getColor()}},cf=class extends th{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:t,from:i,to:s}=this.getProgress(),A=Vo(i.getString()),o=Vo(s.getString()),g=A.map((d,C)=>{var v=o[C];return d+(v-d)*t}).join(" ");return g}},uf=class extends tn{constructor(t,i,s){super(t,i,s),this.type="font",this.glyphs={},this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:A}=t,{children:o}=this;for(var g of o)switch(g.type){case"font-face":{this.fontFace=g;var d=g.getStyle("font-family");d.hasValue()&&(A[d.getString()]=this);break}case"missing-glyph":this.missingGlyph=g;break;case"glyph":{var C=g;C.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[C.unicode]>"u"&&(this.glyphs[C.unicode]={}),this.glyphs[C.unicode][C.arabicForm]=C):this.glyphs[C.unicode]=C;break}}}render(){}},hf=class extends tn{constructor(t,i,s){super(t,i,s),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}},gf=class extends Pr{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}},df=class extends AA{constructor(){super(...arguments),this.type="tref"}getText(){var t=this.getHrefAttribute().getDefinition();if(t){var i=t.children[0];if(i)return i.getText()}return""}},pf=class extends AA{constructor(t,i,s){super(t,i,s),this.type="a";var{childNodes:A}=i,o=A[0],g=A.length>0&&Array.from(A).every(d=>d.nodeType===3);this.hasText=g,this.text=g?this.getTextFromNode(o):""}getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);var{document:i,x:s,y:A}=this,{mouse:o}=i.screen,g=new Ki(i,"fontSize",Cs.parse(i.ctx.font).fontSize);o.isWorking()&&o.checkBoundingBox(this,new Do(s,A-g.getPixels("y"),s+this.measureText(t),A))}else if(this.children.length>0){var d=new $u(this.document,null);d.children=this.children,d.parent=this,d.render(t)}}onClick(){var{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){var t=this.document.ctx;t.canvas.style.cursor="pointer"}};ff=class extends AA{constructor(t,i,s){super(t,i,s),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var A=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(A)}getText(){return this.text}path(t){var{dataArray:i}=this;t&&t.beginPath(),i.forEach(s=>{var{type:A,points:o}=s;switch(A){case Ar.LINE_TO:t&&t.lineTo(o[0],o[1]);break;case Ar.MOVE_TO:t&&t.moveTo(o[0],o[1]);break;case Ar.CURVE_TO:t&&t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case Ar.QUAD_TO:t&&t.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case Ar.ARC:{var[g,d,C,v,x,T,G,k]=o,W=C>v?C:v,K=C>v?1:C/v,$=C>v?v/C:1;t&&(t.translate(g,d),t.rotate(G),t.scale(K,$),t.arc(0,0,W,x,x+T,!!(1-k)),t.scale(1/K,1/$),t.rotate(-G),t.translate(-g,-d));break}case Ar.CLOSE_PATH:t&&t.closePath();break}})}renderChildren(t){this.setTextData(t),t.save();var i=this.parent.getStyle("text-decoration").getString(),s=this.getFontSize(),{glyphInfo:A}=this,o=t.fillStyle;i==="underline"&&t.beginPath(),A.forEach((g,d)=>{var{p0:C,p1:v,rotation:x,text:T}=g;t.save(),t.translate(C.x,C.y),t.rotate(x),t.fillStyle&&t.fillText(T,0,0),t.strokeStyle&&t.strokeText(T,0,0),t.restore(),i==="underline"&&(d===0&&t.moveTo(C.x,C.y+s/8),t.lineTo(v.x,v.y+s/5))}),i==="underline"&&(t.lineWidth=s/20,t.strokeStyle=o,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,i,s,A,o,g,d,C,v){var x=g,T=this.measureText(t,C);C===" "&&i==="justify"&&s<A&&(T+=(A-s)/o),v>-1&&(x+=this.getLetterSpacingAt(v));var G=this.textHeight/20,k=this.getEquidistantPointOnPath(x,G,0),W=this.getEquidistantPointOnPath(x+T,G,0),K={p0:k,p1:W},$=k&&W?Math.atan2(W.y-k.y,W.x-k.x):0;if(d){var O=Math.cos(Math.PI/2+$)*d,tt=Math.cos(-$)*d;K.p0=Fp(Fp({},k),{},{x:k.x+O,y:k.y+tt}),K.p1=Fp(Fp({},W),{},{x:W.x+O,y:W.y+tt})}return x+=T,{offset:x,segment:K,rotation:$}}measureText(t,i){var{measuresCache:s}=this,A=i||this.getText();if(s.has(A))return s.get(A);var o=this.measureTargetText(t,A);return s.set(A,o),o}setTextData(t){if(!this.glyphInfo){var i=this.getText(),s=i.split(""),A=i.split(" ").length-1,o=this.parent.getAttribute("dx").split().map(Lt=>Lt.getPixels("x")),g=this.parent.getAttribute("dy").getPixels("y"),d=this.parent.getStyle("text-anchor").getString("start"),C=this.getStyle("letter-spacing"),v=this.parent.getStyle("letter-spacing"),x=0;!C.hasValue()||C.getValue()==="inherit"?x=v.getPixels():C.hasValue()&&C.getValue()!=="initial"&&C.getValue()!=="unset"&&(x=C.getPixels());var T=[],G=i.length;this.letterSpacingCache=T;for(var k=0;k<G;k++)T.push(typeof o[k]<"u"?o[k]:x);var W=T.reduce((Lt,Tt,Qt)=>Qt===0?0:Lt+Tt||0,0),K=this.measureText(t),$=Math.max(K+W,0);this.textWidth=K,this.textHeight=this.getFontSize(),this.glyphInfo=[];var O=this.getPathLength(),tt=this.getStyle("startOffset").getNumber(0)*O,at=0;(d==="middle"||d==="center")&&(at=-$/2),(d==="end"||d==="right")&&(at=-$),at+=tt,s.forEach((Lt,Tt)=>{var{offset:Qt,segment:Ft,rotation:vt}=this.findSegmentToFitChar(t,d,$,O,A,at,g,Lt,Tt);at=Qt,!(!Ft.p0||!Ft.p1)&&this.glyphInfo.push({text:s[Tt],p0:Ft.p0,p1:Ft.p1,rotation:vt})})}}parsePathData(t){if(this.pathLength=-1,!t)return[];var i=[],{pathParser:s}=t;for(s.reset();!s.isEnd();){var{current:A}=s,o=A?A.x:0,g=A?A.y:0,d=s.next(),C=d.type,v=[];switch(d.type){case Ar.MOVE_TO:this.pathM(s,v);break;case Ar.LINE_TO:C=this.pathL(s,v);break;case Ar.HORIZ_LINE_TO:C=this.pathH(s,v);break;case Ar.VERT_LINE_TO:C=this.pathV(s,v);break;case Ar.CURVE_TO:this.pathC(s,v);break;case Ar.SMOOTH_CURVE_TO:C=this.pathS(s,v);break;case Ar.QUAD_TO:this.pathQ(s,v);break;case Ar.SMOOTH_QUAD_TO:C=this.pathT(s,v);break;case Ar.ARC:v=this.pathA(s);break;case Ar.CLOSE_PATH:Pr.pathZ(s);break}d.type!==Ar.CLOSE_PATH?i.push({type:C,points:v,start:{x:o,y:g},pathLength:this.calcLength(o,g,C,v)}):i.push({type:Ar.CLOSE_PATH,points:[],pathLength:0})}return i}pathM(t,i){var{x:s,y:A}=Pr.pathM(t).point;i.push(s,A)}pathL(t,i){var{x:s,y:A}=Pr.pathL(t).point;return i.push(s,A),Ar.LINE_TO}pathH(t,i){var{x:s,y:A}=Pr.pathH(t).point;return i.push(s,A),Ar.LINE_TO}pathV(t,i){var{x:s,y:A}=Pr.pathV(t).point;return i.push(s,A),Ar.LINE_TO}pathC(t,i){var{point:s,controlPoint:A,currentPoint:o}=Pr.pathC(t);i.push(s.x,s.y,A.x,A.y,o.x,o.y)}pathS(t,i){var{point:s,controlPoint:A,currentPoint:o}=Pr.pathS(t);return i.push(s.x,s.y,A.x,A.y,o.x,o.y),Ar.CURVE_TO}pathQ(t,i){var{controlPoint:s,currentPoint:A}=Pr.pathQ(t);i.push(s.x,s.y,A.x,A.y)}pathT(t,i){var{controlPoint:s,currentPoint:A}=Pr.pathT(t);return i.push(s.x,s.y,A.x,A.y),Ar.QUAD_TO}pathA(t){var{rX:i,rY:s,sweepFlag:A,xAxisRotation:o,centp:g,a1:d,ad:C}=Pr.pathA(t);return A===0&&C>0&&(C-=2*Math.PI),A===1&&C<0&&(C+=2*Math.PI),[g.x,g.y,i,s,d,C,o,A]}calcLength(t,i,s,A){var o=0,g=null,d=null,C=0;switch(s){case Ar.LINE_TO:return this.getLineLength(t,i,A[0],A[1]);case Ar.CURVE_TO:for(o=0,g=this.getPointOnCubicBezier(0,t,i,A[0],A[1],A[2],A[3],A[4],A[5]),C=.01;C<=1;C+=.01)d=this.getPointOnCubicBezier(C,t,i,A[0],A[1],A[2],A[3],A[4],A[5]),o+=this.getLineLength(g.x,g.y,d.x,d.y),g=d;return o;case Ar.QUAD_TO:for(o=0,g=this.getPointOnQuadraticBezier(0,t,i,A[0],A[1],A[2],A[3]),C=.01;C<=1;C+=.01)d=this.getPointOnQuadraticBezier(C,t,i,A[0],A[1],A[2],A[3]),o+=this.getLineLength(g.x,g.y,d.x,d.y),g=d;return o;case Ar.ARC:{o=0;var v=A[4],x=A[5],T=A[4]+x,G=Math.PI/180;if(Math.abs(v-T)<G&&(G=Math.abs(v-T)),g=this.getPointOnEllipticalArc(A[0],A[1],A[2],A[3],v,0),x<0)for(C=v-G;C>T;C-=G)d=this.getPointOnEllipticalArc(A[0],A[1],A[2],A[3],C,0),o+=this.getLineLength(g.x,g.y,d.x,d.y),g=d;else for(C=v+G;C<T;C+=G)d=this.getPointOnEllipticalArc(A[0],A[1],A[2],A[3],C,0),o+=this.getLineLength(g.x,g.y,d.x,d.y),g=d;return d=this.getPointOnEllipticalArc(A[0],A[1],A[2],A[3],T,0),o+=this.getLineLength(g.x,g.y,d.x,d.y),o}}return 0}getPointOnLine(t,i,s,A,o){var g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:i,d=arguments.length>6&&arguments[6]!==void 0?arguments[6]:s,C=(o-s)/(A-i+Wc),v=Math.sqrt(t*t/(1+C*C));A<i&&(v*=-1);var x=C*v,T=null;if(A===i)T={x:g,y:d+x};else if((d-s)/(g-i+Wc)===C)T={x:g+v,y:d+x};else{var G=0,k=0,W=this.getLineLength(i,s,A,o);if(W<Wc)return null;var K=(g-i)*(A-i)+(d-s)*(o-s);K/=W*W,G=i+K*(A-i),k=s+K*(o-s);var $=this.getLineLength(g,d,G,k),O=Math.sqrt(t*t-$*$);v=Math.sqrt(O*O/(1+C*C)),A<i&&(v*=-1),x=C*v,T={x:G+v,y:k+x}}return T}getPointOnPath(t){var i=this.getPathLength(),s=0,A=null;if(t<-5e-5||t-5e-5>i)return null;var{dataArray:o}=this;for(var g of o){if(g&&(g.pathLength<5e-5||s+g.pathLength+5e-5<t)){s+=g.pathLength;continue}var d=t-s,C=0;switch(g.type){case Ar.LINE_TO:A=this.getPointOnLine(d,g.start.x,g.start.y,g.points[0],g.points[1],g.start.x,g.start.y);break;case Ar.ARC:{var v=g.points[4],x=g.points[5],T=g.points[4]+x;if(C=v+d/g.pathLength*x,x<0&&C<T||x>=0&&C>T)break;A=this.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],C,g.points[6]);break}case Ar.CURVE_TO:C=d/g.pathLength,C>1&&(C=1),A=this.getPointOnCubicBezier(C,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);break;case Ar.QUAD_TO:C=d/g.pathLength,C>1&&(C=1),A=this.getPointOnQuadraticBezier(C,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3]);break}if(A)return A;break}return null}getLineLength(t,i,s,A){return Math.sqrt((s-t)*(s-t)+(A-i)*(A-i))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((t,i)=>i.pathLength>0?t+i.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,i,s,A,o,g,d,C,v){var x=C*kI(t)+g*LI(t)+A*EI(t)+i*TI(t),T=v*kI(t)+d*LI(t)+o*EI(t)+s*TI(t);return{x,y:T}}getPointOnQuadraticBezier(t,i,s,A,o,g,d){var C=g*QI(t)+A*UI(t)+i*GI(t),v=d*QI(t)+o*UI(t)+s*GI(t);return{x:C,y:v}}getPointOnEllipticalArc(t,i,s,A,o,g){var d=Math.cos(g),C=Math.sin(g),v={x:s*Math.cos(o),y:A*Math.sin(o)};return{x:t+(v.x*d-v.y*C),y:i+(v.x*C+v.y*d)}}buildEquidistantCache(t,i){var s=this.getPathLength(),A=i||.25,o=t||s/100;if(!this.equidistantCache||this.equidistantCache.step!==o||this.equidistantCache.precision!==A){this.equidistantCache={step:o,precision:A,points:[]};for(var g=0,d=0;d<=s;d+=A){var C=this.getPointOnPath(d),v=this.getPointOnPath(d+A);!C||!v||(g+=this.getLineLength(C.x,C.y,v.x,v.y),g>=o&&(this.equidistantCache.points.push({x:C.x,y:C.y,distance:d}),g-=o))}}}getEquidistantPointOnPath(t,i,s){if(this.buildEquidistantCache(i,s),t<0||t-this.getPathLength()>5e-5)return null;var A=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[A]||null}},M6=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i,mf=class extends zA{constructor(t,i,s){super(t,i,s),this.type="image",this.loaded=!1;var A=this.getHrefAttribute().getString();if(A){var o=A.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(A);t.images.push(this),o?this.loadSvg(A):this.loadImage(A),this.isSvg=o}}loadImage(t){var i=this;return xl(function*(){try{var s=yield i.document.createImage(t);i.image=s}catch(A){console.error('Error while loading image "'.concat(t,'":'),A)}i.loaded=!0})()}loadSvg(t){var i=this;return xl(function*(){var s=M6.exec(t);if(s){var A=s[5];s[4]==="base64"?i.image=atob(A):i.image=decodeURIComponent(A)}else try{var o=yield i.document.fetch(t),g=yield o.text();i.image=g}catch(d){console.error('Error while loading image "'.concat(t,'":'),d)}i.loaded=!0})()}renderChildren(t){var{document:i,image:s,loaded:A}=this,o=this.getAttribute("x").getPixels("x"),g=this.getAttribute("y").getPixels("y"),d=this.getStyle("width").getPixels("x"),C=this.getStyle("height").getPixels("y");if(!(!A||!s||!d||!C)){if(t.save(),t.translate(o,g),this.isSvg){var v=i.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:d,scaleHeight:C});v.document.documentElement.parent=this,v.render()}else{var x=this.image;i.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:d,desiredWidth:x.width,height:C,desiredHeight:x.height}),this.loaded&&(typeof x.complete>"u"||x.complete)&&t.drawImage(x,0,0)}t.restore()}}getBoundingBox(){var t=this.getAttribute("x").getPixels("x"),i=this.getAttribute("y").getPixels("y"),s=this.getStyle("width").getPixels("x"),A=this.getStyle("height").getPixels("y");return new Do(t,i,t+s,i+A)}},Cf=class extends zA{constructor(){super(...arguments),this.type="symbol"}render(t){}},If=class{constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}load(t,i){var s=this;return xl(function*(){try{var{document:A}=s,o=yield A.canvg.parser.load(i),g=o.getElementsByTagName("font");Array.from(g).forEach(d=>{var C=A.createElement(d);A.definitions[t]=C})}catch(d){console.error('Error while loading font "'.concat(i,'":'),d)}s.loaded=!0})()}},Lg=class extends tn{constructor(t,i,s){super(t,i,s),this.type="style";var A=eu(Array.from(i.childNodes).map(g=>g.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),o=A.split("}");o.forEach(g=>{var d=g.trim();if(d){var C=d.split("{"),v=C[0].split(","),x=C[1].split(";");v.forEach(T=>{var G=T.trim();if(G){var k=t.styles[G]||{};if(x.forEach($=>{var O=$.indexOf(":"),tt=$.substr(0,O).trim(),at=$.substr(O+1,$.length-O).trim();tt&&at&&(k[tt]=new Ki(t,tt,at))}),t.styles[G]=k,t.stylesSpecificity[G]=Yx(G),G==="@font-face"){var W=k["font-family"].getString().replace(/"|'/g,""),K=k.src.getString().split(",");K.forEach($=>{if($.indexOf('format("svg")')>0){var O=yy($);O&&new If(t).load(W,O)}})}}})}})}};Lg.parseExternalUrl=yy;yf=class extends zA{constructor(){super(...arguments),this.type="use"}setContext(t){super.setContext(t);var i=this.getAttribute("x"),s=this.getAttribute("y");i.hasValue()&&t.translate(i.getPixels("x"),0),s.hasValue()&&t.translate(0,s.getPixels("y"))}path(t){var{element:i}=this;i&&i.path(t)}renderChildren(t){var{document:i,element:s}=this;if(s){var A=s;if(s.type==="symbol"&&(A=new gc(i,null),A.attributes.viewBox=new Ki(i,"viewBox",s.getAttribute("viewBox").getString()),A.attributes.preserveAspectRatio=new Ki(i,"preserveAspectRatio",s.getAttribute("preserveAspectRatio").getString()),A.attributes.overflow=new Ki(i,"overflow",s.getAttribute("overflow").getString()),A.children=s.children,s.styles.opacity=new Ki(i,"opacity",this.calculateOpacity())),A.type==="svg"){var o=this.getStyle("width",!1,!0),g=this.getStyle("height",!1,!0);o.hasValue()&&(A.attributes.width=new Ki(i,"width",o.getString())),g.hasValue()&&(A.attributes.height=new Ki(i,"height",g.getString()))}var d=A.parent;A.parent=this,A.render(t),A.parent=d}}getBoundingBox(t){var{element:i}=this;return i?i.getBoundingBox(t):null}elementTransform(){var{document:t,element:i}=this;return OA.fromElement(t,i)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}};Eg=class extends tn{constructor(t,i,s){super(t,i,s),this.type="feColorMatrix";var A=Vo(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var o=A[0];A=[.213+.787*o,.715-.715*o,.072-.072*o,0,0,.213-.213*o,.715+.285*o,.072-.072*o,0,0,.213-.213*o,.715-.715*o,.072+.928*o,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var g=A[0]*Math.PI/180;A=[Bl(g,.213,.787,-.213),Bl(g,.715,-.715,-.715),Bl(g,.072,-.072,.928),0,0,Bl(g,.213,-.213,.143),Bl(g,.715,.285,.14),Bl(g,.072,-.072,-.283),0,0,Bl(g,.213,-.213,-.787),Bl(g,.715,-.715,.715),Bl(g,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=A,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(t,i,s,A,o){for(var{includeOpacity:g,matrix:d}=this,C=t.getImageData(0,0,A,o),v=0;v<o;v++)for(var x=0;x<A;x++){var T=kp(C.data,x,v,A,o,0),G=kp(C.data,x,v,A,o,1),k=kp(C.data,x,v,A,o,2),W=kp(C.data,x,v,A,o,3),K=Yn(d,0,T)+Yn(d,1,G)+Yn(d,2,k)+Yn(d,3,W)+Yn(d,4,1),$=Yn(d,5,T)+Yn(d,6,G)+Yn(d,7,k)+Yn(d,8,W)+Yn(d,9,1),O=Yn(d,10,T)+Yn(d,11,G)+Yn(d,12,k)+Yn(d,13,W)+Yn(d,14,1),tt=Yn(d,15,T)+Yn(d,16,G)+Yn(d,17,k)+Yn(d,18,W)+Yn(d,19,1);g&&(K=0,$=0,O=0,tt*=W/255),Lp(C.data,x,v,A,o,0,K),Lp(C.data,x,v,A,o,1,$),Lp(C.data,x,v,A,o,2,O),Lp(C.data,x,v,A,o,3,tt)}t.clearRect(0,0,A,o),t.putImageData(C,0,0)}},Xc=class extends tn{constructor(){super(...arguments),this.type="mask"}apply(t,i){var{document:s}=this,A=this.getAttribute("x").getPixels("x"),o=this.getAttribute("y").getPixels("y"),g=this.getStyle("width").getPixels("x"),d=this.getStyle("height").getPixels("y");if(!g&&!d){var C=new Do;this.children.forEach(W=>{C.addBoundingBox(W.getBoundingBox(t))}),A=Math.floor(C.x1),o=Math.floor(C.y1),g=Math.floor(C.width),d=Math.floor(C.height)}var v=this.removeStyles(i,Xc.ignoreStyles),x=s.createCanvas(A+g,o+d),T=x.getContext("2d");s.screen.setDefaults(T),this.renderChildren(T),new Eg(s,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(T,0,0,A+g,o+d);var G=s.createCanvas(A+g,o+d),k=G.getContext("2d");s.screen.setDefaults(k),i.render(k),k.globalCompositeOperation="destination-in",k.fillStyle=T.createPattern(x,"no-repeat"),k.fillRect(0,0,A+g,o+d),t.fillStyle=k.createPattern(G,"no-repeat"),t.fillRect(0,0,A+g,o+d),this.restoreStyles(i,v)}render(t){}};Xc.ignoreStyles=["mask","transform","clip-path"];l_=()=>{},bf=class extends tn{constructor(){super(...arguments),this.type="clipPath"}apply(t){var{document:i}=this,s=Reflect.getPrototypeOf(t),{beginPath:A,closePath:o}=t;s&&(s.beginPath=l_,s.closePath=l_),Reflect.apply(A,t,[]),this.children.forEach(g=>{if(!(typeof g.path>"u")){var d=typeof g.elementTransform<"u"?g.elementTransform():null;d||(d=OA.fromElement(i,g)),d&&d.apply(t),g.path(t),s&&(s.closePath=o),d&&d.unapply(t)}}),Reflect.apply(o,t,[]),t.clip(),s&&(s.beginPath=A,s.closePath=o)}render(t){}},Yc=class extends tn{constructor(){super(...arguments),this.type="filter"}apply(t,i){var{document:s,children:A}=this,o=i.getBoundingBox(t);if(o){var g=0,d=0;A.forEach(O=>{var tt=O.extraFilterDistance||0;g=Math.max(g,tt),d=Math.max(d,tt)});var C=Math.floor(o.width),v=Math.floor(o.height),x=C+2*g,T=v+2*d;if(!(x<1||T<1)){var G=Math.floor(o.x),k=Math.floor(o.y),W=this.removeStyles(i,Yc.ignoreStyles),K=s.createCanvas(x,T),$=K.getContext("2d");s.screen.setDefaults($),$.translate(-G+g,-k+d),i.render($),A.forEach(O=>{typeof O.apply=="function"&&O.apply($,0,0,x,T)}),t.drawImage(K,0,0,x,T,G-g,k-d,x,T),this.restoreStyles(i,W)}}}render(t){}};Yc.ignoreStyles=["filter","transform","clip-path"];vf=class extends tn{constructor(t,i,s){super(t,i,s),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(t,i,s,A,o){}},wf=class extends tn{constructor(){super(...arguments),this.type="feMorphology"}apply(t,i,s,A,o){}},Bf=class extends tn{constructor(){super(...arguments),this.type="feComposite"}apply(t,i,s,A,o){}},_f=class extends tn{constructor(t,i,s){super(t,i,s),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(t,i,s,A,o){var{document:g,blurRadius:d}=this,C=g.window?g.window.document.body:null,v=t.canvas;v.id=g.getUniqueId(),C&&(v.style.display="none",C.appendChild(v)),I6(v,i,s,A,o,d),C&&C.removeChild(v)}},xf=class extends tn{constructor(){super(...arguments),this.type="title"}},Sf=class extends tn{constructor(){super(...arguments),this.type="desc"}},N6={svg:gc,rect:Sg,circle:qp,ellipse:$p,line:tf,polyline:Fg,polygon:ef,path:Pr,pattern:rf,marker:nf,defs:sf,linearGradient:of,radialGradient:af,stop:Af,animate:th,animateColor:lf,animateTransform:cf,font:uf,"font-face":hf,"missing-glyph":gf,glyph:xg,text:AA,tspan:Jc,tref:df,a:pf,textPath:ff,image:mf,g:$u,symbol:Cf,style:Lg,use:yf,mask:Xc,clipPath:bf,filter:Yc,feDropShadow:vf,feMorphology:wf,feComposite:Bf,feColorMatrix:Eg,feGaussianBlur:_f,title:xf,desc:Sf};aA=class{constructor(t){var{rootEmSize:i=12,emSize:s=12,createCanvas:A=aA.createCanvas,createImage:o=aA.createImage,anonymousCrossOrigin:g}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=t,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=i,this.emSize=s,this.createCanvas=A,this.createImage=this.bindCreateImage(o,g),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(t,i){return typeof i=="boolean"?(s,A)=>t(s,typeof A=="boolean"?A:i):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:t}=this;return t[t.length-1]}set emSize(t){var{emSizeStack:i}=this;i.push(t)}popEmSize(){var{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){var i=this.createElement(t.documentElement);return i.root=!0,i.addStylesFromStyleDefinition(),this.documentElement=i,i}createElement(t){var i=t.nodeName.replace(/^[^:]+:/,""),s=aA.elementTypes[i];return typeof s<"u"?new s(this,t):new jp(this,t)}createTextNode(t){return new RI(this,t)}setViewBox(t){this.screen.setViewBox(V6({document:this},t))}};aA.createCanvas=D6;aA.createImage=K6;aA.elementTypes=N6;uc=class{constructor(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new Xu(s),this.screen=new zc(t,s),this.options=s;var A=new aA(this,s),o=A.createDocumentElement(i);this.document=A,this.documentElement=o}static from(t,i){var s=arguments;return xl(function*(){var A=s.length>2&&s[2]!==void 0?s[2]:{},o=new Xu(A),g=yield o.parse(i);return new uc(t,g,A)})()}static fromString(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},A=new Xu(s),o=A.parseFromString(i);return new uc(t,o,s)}fork(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return uc.from(t,i,Dc(Dc({},this.options),s))}forkString(t,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return uc.fromString(t,i,Dc(Dc({},this.options),s))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var t=arguments,i=this;return xl(function*(){var s=t.length>0&&t[0]!==void 0?t[0]:{};i.start(Dc({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},s)),yield i.ready(),i.stop()})()}start(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:i,screen:s,options:A}=this;s.start(i,Dc(Dc({enableRedraw:!0},A),t))}stop(){this.screen.stop()}resize(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(t,i,s)}}});function Rr(r){return Rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rr(r)}function Uy(r,t){t===void 0&&(t={});var i=iD();i.p(r);var s=rD(r,t,2,4);return sD(s,t),nD(s,s.length-4,i.d()),s}function aD(r,t){return q6((oD(r),r.subarray(2,-4)),t)}function _y(){ir.console&&typeof ir.console.log=="function"&&ir.console.log.apply(ir.console,arguments)}function xy(r,t,i){var s=new XMLHttpRequest;s.open("GET",r),s.responseType="blob",s.onload=function(){iu(s.response,t,i)},s.onerror=function(){sn.error("could not download file")},s.send()}function n5(r){var t=new XMLHttpRequest;t.open("HEAD",r,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Kf(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(t)}}function k5(r){var t;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var i=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(d){return[parseInt(d[1]),parseInt(d[2]),parseInt(d[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16)]}}],s=0;s<i.length;s++){var A=i[s].re,o=i[s].process,g=A.exec(r);g&&(t=o(g),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var d=this.r.toString(16),C=this.g.toString(16),v=this.b.toString(16);return d.length==1&&(d="0"+d),C.length==1&&(C="0"+C),v.length==1&&(v="0"+v),"#"+d+C+v}}function Sy(r,t){var i=r[0],s=r[1],A=r[2],o=r[3];i=Ys(i,s,A,o,t[0],7,-680876936),o=Ys(o,i,s,A,t[1],12,-389564586),A=Ys(A,o,i,s,t[2],17,606105819),s=Ys(s,A,o,i,t[3],22,-1044525330),i=Ys(i,s,A,o,t[4],7,-176418897),o=Ys(o,i,s,A,t[5],12,1200080426),A=Ys(A,o,i,s,t[6],17,-1473231341),s=Ys(s,A,o,i,t[7],22,-45705983),i=Ys(i,s,A,o,t[8],7,1770035416),o=Ys(o,i,s,A,t[9],12,-1958414417),A=Ys(A,o,i,s,t[10],17,-42063),s=Ys(s,A,o,i,t[11],22,-1990404162),i=Ys(i,s,A,o,t[12],7,1804603682),o=Ys(o,i,s,A,t[13],12,-40341101),A=Ys(A,o,i,s,t[14],17,-1502002290),i=js(i,s=Ys(s,A,o,i,t[15],22,1236535329),A,o,t[1],5,-165796510),o=js(o,i,s,A,t[6],9,-1069501632),A=js(A,o,i,s,t[11],14,643717713),s=js(s,A,o,i,t[0],20,-373897302),i=js(i,s,A,o,t[5],5,-701558691),o=js(o,i,s,A,t[10],9,38016083),A=js(A,o,i,s,t[15],14,-660478335),s=js(s,A,o,i,t[4],20,-405537848),i=js(i,s,A,o,t[9],5,568446438),o=js(o,i,s,A,t[14],9,-1019803690),A=js(A,o,i,s,t[3],14,-187363961),s=js(s,A,o,i,t[8],20,1163531501),i=js(i,s,A,o,t[13],5,-1444681467),o=js(o,i,s,A,t[2],9,-51403784),A=js(A,o,i,s,t[7],14,1735328473),i=qs(i,s=js(s,A,o,i,t[12],20,-1926607734),A,o,t[5],4,-378558),o=qs(o,i,s,A,t[8],11,-2022574463),A=qs(A,o,i,s,t[11],16,1839030562),s=qs(s,A,o,i,t[14],23,-35309556),i=qs(i,s,A,o,t[1],4,-1530992060),o=qs(o,i,s,A,t[4],11,1272893353),A=qs(A,o,i,s,t[7],16,-155497632),s=qs(s,A,o,i,t[10],23,-1094730640),i=qs(i,s,A,o,t[13],4,681279174),o=qs(o,i,s,A,t[0],11,-358537222),A=qs(A,o,i,s,t[3],16,-722521979),s=qs(s,A,o,i,t[6],23,76029189),i=qs(i,s,A,o,t[9],4,-640364487),o=qs(o,i,s,A,t[12],11,-421815835),A=qs(A,o,i,s,t[15],16,530742520),i=$s(i,s=qs(s,A,o,i,t[2],23,-995338651),A,o,t[0],6,-198630844),o=$s(o,i,s,A,t[7],10,1126891415),A=$s(A,o,i,s,t[14],15,-1416354905),s=$s(s,A,o,i,t[5],21,-57434055),i=$s(i,s,A,o,t[12],6,1700485571),o=$s(o,i,s,A,t[3],10,-1894986606),A=$s(A,o,i,s,t[10],15,-1051523),s=$s(s,A,o,i,t[1],21,-2054922799),i=$s(i,s,A,o,t[8],6,1873313359),o=$s(o,i,s,A,t[15],10,-30611744),A=$s(A,o,i,s,t[6],15,-1560198380),s=$s(s,A,o,i,t[13],21,1309151649),i=$s(i,s,A,o,t[4],6,-145523070),o=$s(o,i,s,A,t[11],10,-1120210379),A=$s(A,o,i,s,t[2],15,718787259),s=$s(s,A,o,i,t[9],21,-343485551),r[0]=fc(i,r[0]),r[1]=fc(s,r[1]),r[2]=fc(A,r[2]),r[3]=fc(o,r[3])}function sm(r,t,i,s,A,o){return t=fc(fc(t,r),fc(s,o)),fc(t<<A|t>>>32-A,i)}function Ys(r,t,i,s,A,o,g){return sm(t&i|~t&s,r,t,A,o,g)}function js(r,t,i,s,A,o,g){return sm(t&s|i&~s,r,t,A,o,g)}function qs(r,t,i,s,A,o,g){return sm(t^i^s,r,t,A,o,g)}function $s(r,t,i,s,A,o,g){return sm(i^(t|~s),r,t,A,o,g)}function L5(r){var t,i=r.length,s=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=r.length;t+=64)Sy(s,AD(r.substring(t-64,t)));r=r.substring(t-64);var A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<r.length;t++)A[t>>2]|=r.charCodeAt(t)<<(t%4<<3);if(A[t>>2]|=128<<(t%4<<3),t>55)for(Sy(s,A),t=0;t<16;t++)A[t]=0;return A[14]=8*i,Sy(s,A),s}function AD(r){var t,i=[];for(t=0;t<64;t+=4)i[t>>2]=r.charCodeAt(t)+(r.charCodeAt(t+1)<<8)+(r.charCodeAt(t+2)<<16)+(r.charCodeAt(t+3)<<24);return i}function lD(r){for(var t="",i=0;i<4;i++)t+=s5[r>>8*i+4&15]+s5[r>>8*i&15];return t}function cD(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function Ry(r){return L5(r).map(cD).join("")}function fc(r,t){if(uD){var i=(65535&r)+(65535&t);return(r>>16)+(t>>16)+(i>>16)<<16|65535&i}return r+t&4294967295}function Hy(r,t){var i,s,A,o;if(r!==i){for(var g=(A=r,o=1+(256/r.length>>0),new Array(o+1).join(A)),d=[],C=0;C<256;C++)d[C]=C;var v=0;for(C=0;C<256;C++){var x=d[C];v=(v+x+g.charCodeAt(C))%256,d[C]=d[v],d[v]=x}i=r,s=d}else d=s;var T=t.length,G=0,k=0,W="";for(C=0;C<T;C++)k=(k+(x=d[G=(G+1)%256]))%256,d[G]=d[k],d[k]=x,g=d[(d[G]+d[k])%256],W+=String.fromCharCode(t.charCodeAt(C)^g);return W}function oh(r,t,i,s){this.v=1,this.r=2;var A=192;r.forEach(function(d){if(o5.perm!==void 0)throw new Error("Invalid permission: "+d);A+=o5[d]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var o=(t+this.padding).substr(0,32),g=(i+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,g),this.P=-(1+(255^A)),this.encryptionKey=Ry(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=Hy(this.encryptionKey,this.padding)}function ah(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var t="",i=r.length,s=0;s<i;s++){var A=r.charCodeAt(s);A<33||A===35||A===37||A===40||A===41||A===47||A===60||A===62||A===91||A===93||A===123||A===125||A>126?t+="#"+("0"+A.toString(16)).slice(-2):t+=r[s]}return t}function a5(r){if(Rr(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(i,s,A){if(A=A||!1,typeof i!="string"||typeof s!="function"||typeof A!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(i)||(t[i]={});var o=Math.random().toString(35);return t[i][o]=[s,!!A],o},this.unsubscribe=function(i){for(var s in t)if(t[s][i])return delete t[s][i],Object.keys(t[s]).length===0&&delete t[s],!0;return!1},this.publish=function(i){if(t.hasOwnProperty(i)){var s=Array.prototype.slice.call(arguments,1),A=[];for(var o in t[i]){var g=t[i][o];try{g[0].apply(r,s)}catch(d){ir.console&&sn.error("jsPDF PubSub Error",d.message,d)}g[1]&&A.push(o)}A.length&&A.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function tm(r){if(!(this instanceof tm))return new tm(r);var t="opacity,stroke-opacity".split(",");for(var i in r)r.hasOwnProperty(i)&&t.indexOf(i)>=0&&(this[i]=r[i]);this.id="",this.objectNumber=-1}function E5(r,t){this.gState=r,this.matrix=t,this.id="",this.objectNumber=-1}function ru(r,t,i,s,A){if(!(this instanceof ru))return new ru(r,t,i,s,A);this.type=r==="axial"?2:3,this.coords=t,this.colors=i,E5.call(this,s,A)}function Ah(r,t,i,s,A){if(!(this instanceof Ah))return new Ah(r,t,i,s,A);this.boundingBox=r,this.xStep=t,this.yStep=i,this.stream="",this.cloneIndex=0,E5.call(this,s,A)}function er(r){var t,i=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],A=arguments[2],o=arguments[3],g=[],d=1,C=16,v="S",x=null;Rr(r=r||{})==="object"&&(i=r.orientation,s=r.unit||s,A=r.format||A,o=r.compress||r.compressPdf||o,(x=r.encryption||null)!==null&&(x.userPassword=x.userPassword||"",x.ownerPassword=x.ownerPassword||"",x.userPermissions=x.userPermissions||[]),d=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(t=r.precision),r.floatPrecision!==void 0&&(C=r.floatPrecision),v=r.defaultPathOperation||"S"),g=r.filters||(o===!0?["FlateEncode"]:g),s=s||"mm",i=(""+(i||"P")).toLowerCase();var T=r.putOnlyUsedFonts||!1,G={},k={internal:{},__private__:{}};k.__private__.PubSub=a5;var W="1.3",K=k.__private__.getPdfVersion=function(){return W};k.__private__.setPdfVersion=function(U){W=U};var $={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};k.__private__.getPageFormats=function(){return $};var O=k.__private__.getPageFormat=function(U){return $[U]};A=A||"a4";var tt={COMPAT:"compat",ADVANCED:"advanced"},at=tt.COMPAT;function Lt(){this.saveGraphicsState(),Rt(new ce(We,0,0,-We,0,qo()*We).toString()+" cm"),this.setFontSize(this.getFontSize()/We),v="n",at=tt.ADVANCED}function Tt(){this.restoreGraphicsState(),v="S",at=tt.COMPAT}var Qt=k.__private__.combineFontStyleAndFontWeight=function(U,it){if(U=="bold"&&it=="normal"||U=="bold"&&it==400||U=="normal"&&it=="italic"||U=="bold"&&it=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return it&&(U=it==400||it==="normal"?U==="italic"?"italic":"normal":it!=700&&it!=="bold"||U!=="normal"?(it==700?"bold":it)+""+U:"bold"),U};k.advancedAPI=function(U){var it=at===tt.COMPAT;return it&&Lt.call(this),typeof U!="function"||(U(this),it&&Tt.call(this)),this},k.compatAPI=function(U){var it=at===tt.ADVANCED;return it&&Tt.call(this),typeof U!="function"||(U(this),it&&Lt.call(this)),this},k.isAdvancedAPI=function(){return at===tt.ADVANCED};var Ft,vt=function(U){if(at!==tt.ADVANCED)throw new Error(U+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Jt=k.roundToPrecision=k.__private__.roundToPrecision=function(U,it){var Et=t||it;if(isNaN(U)||isNaN(Et))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return U.toFixed(Et).replace(/0+$/,"")};Ft=k.hpf=k.__private__.hpf=typeof C=="number"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return Jt(U,C)}:C==="smart"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return Jt(U,U>-1&&U<1?16:5)}:function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return Jt(U,16)};var qt=k.f2=k.__private__.f2=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f2");return Jt(U,2)},At=k.__private__.f3=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f3");return Jt(U,3)},lt=k.scale=k.__private__.scale=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.scale");return at===tt.COMPAT?U*We:at===tt.ADVANCED?U:void 0},kt=function(U){return at===tt.COMPAT?qo()-U:at===tt.ADVANCED?U:void 0},_t=function(U){return lt(kt(U))};k.__private__.setPrecision=k.setPrecision=function(U){typeof parseInt(U,10)=="number"&&(t=parseInt(U,10))};var le,ie="00000000000000000000000000000000",ne=k.__private__.getFileId=function(){return ie},te=k.__private__.setFileId=function(U){return ie=U!==void 0&&/^[a-fA-F0-9]{32}$/.test(U)?U.toUpperCase():ie.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),x!==null&&(Fi=new oh(x.userPermissions,x.userPassword,x.ownerPassword,ie)),ie};k.setFileId=function(U){return te(U),this},k.getFileId=function(){return ne()};var wt=k.__private__.convertDateToPDFDate=function(U){var it=U.getTimezoneOffset(),Et=it<0?"+":"-",Nt=Math.floor(Math.abs(it/60)),ue=Math.abs(it%60),we=[Et,It(Nt),"'",It(ue),"'"].join("");return["D:",U.getFullYear(),It(U.getMonth()+1),It(U.getDate()),It(U.getHours()),It(U.getMinutes()),It(U.getSeconds()),we].join("")},Ut=k.__private__.convertPDFDateToDate=function(U){var it=parseInt(U.substr(2,4),10),Et=parseInt(U.substr(6,2),10)-1,Nt=parseInt(U.substr(8,2),10),ue=parseInt(U.substr(10,2),10),we=parseInt(U.substr(12,2),10),Ve=parseInt(U.substr(14,2),10);return new Date(it,Et,Nt,ue,we,Ve,0)},fe=k.__private__.setCreationDate=function(U){var it;if(U===void 0&&(U=new Date),U instanceof Date)it=wt(U);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(U))throw new Error("Invalid argument passed to jsPDF.setCreationDate");it=U}return le=it},j=k.__private__.getCreationDate=function(U){var it=le;return U==="jsDate"&&(it=Ut(le)),it};k.setCreationDate=function(U){return fe(U),this},k.getCreationDate=function(U){return j(U)};var bt,It=k.__private__.padd2=function(U){return("0"+parseInt(U)).slice(-2)},Ht=k.__private__.padd2Hex=function(U){return("00"+(U=U.toString())).substr(U.length)},Ot=0,Ae=[],he=[],de=0,He=[],Re=[],je=!1,Me=he,gi=function(){Ot=0,de=0,he=[],Ae=[],He=[],rr=ii(),zi=ii()};k.__private__.setCustomOutputDestination=function(U){je=!0,Me=U};var xt=function(U){je||(Me=U)};k.__private__.resetCustomOutputDestination=function(){je=!1,Me=he};var Rt=k.__private__.out=function(U){return U=U.toString(),de+=U.length+1,Me.push(U),Me},Li=k.__private__.write=function(U){return Rt(arguments.length===1?U.toString():Array.prototype.join.call(arguments," "))},Ue=k.__private__.getArrayBuffer=function(U){for(var it=U.length,Et=new ArrayBuffer(it),Nt=new Uint8Array(Et);it--;)Nt[it]=U.charCodeAt(it);return Et},Ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];k.__private__.getStandardFonts=function(){return Ee};var Ne=r.fontSize||16;k.__private__.setFontSize=k.setFontSize=function(U){return Ne=at===tt.ADVANCED?U/We:U,this};var Je,ze=k.__private__.getFontSize=k.getFontSize=function(){return at===tt.COMPAT?Ne:Ne*We},ui=r.R2L||!1;k.__private__.setR2L=k.setR2L=function(U){return ui=U,this},k.__private__.getR2L=k.getR2L=function(){return ui};var hi,Ei=k.__private__.setZoomMode=function(U){var it=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(U))Je=U;else if(isNaN(U)){if(it.indexOf(U)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+U+'" is not recognized.');Je=U}else Je=parseInt(U,10)};k.__private__.getZoomMode=function(){return Je};var Pi,Ie=k.__private__.setPageMode=function(U){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(U)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+U+'" is not recognized.');hi=U};k.__private__.getPageMode=function(){return hi};var Oi=k.__private__.setLayoutMode=function(U){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(U)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+U+'" is not recognized.');Pi=U};k.__private__.getLayoutMode=function(){return Pi},k.__private__.setDisplayMode=k.setDisplayMode=function(U,it,Et){return Ei(U),Oi(it),Ie(Et),this};var mi={title:"",subject:"",author:"",keywords:"",creator:""};k.__private__.getDocumentProperty=function(U){if(Object.keys(mi).indexOf(U)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return mi[U]},k.__private__.getDocumentProperties=function(){return mi},k.__private__.setDocumentProperties=k.setProperties=k.setDocumentProperties=function(U){for(var it in mi)mi.hasOwnProperty(it)&&U[it]&&(mi[it]=U[it]);return this},k.__private__.setDocumentProperty=function(U,it){if(Object.keys(mi).indexOf(U)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return mi[U]=it};var Vi,We,Se,$e,di,Zi={},qi={},vi=[],tr={},Lr={},ft={},Y={},q=null,rt=0,ht=[],Zt=new a5(k),zt=r.hotfixes||[],Xt={},Mt={},re=[],ce=function U(it,Et,Nt,ue,we,Ve){if(!(this instanceof U))return new U(it,Et,Nt,ue,we,Ve);isNaN(it)&&(it=1),isNaN(Et)&&(Et=0),isNaN(Nt)&&(Nt=0),isNaN(ue)&&(ue=1),isNaN(we)&&(we=0),isNaN(Ve)&&(Ve=0),this._matrix=[it,Et,Nt,ue,we,Ve]};Object.defineProperty(ce.prototype,"sx",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(ce.prototype,"shy",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(ce.prototype,"shx",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(ce.prototype,"sy",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(ce.prototype,"tx",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(ce.prototype,"ty",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(ce.prototype,"a",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(ce.prototype,"b",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(ce.prototype,"c",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(ce.prototype,"d",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(ce.prototype,"e",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(ce.prototype,"f",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(ce.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ce.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ce.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ce.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ce.prototype.join=function(U){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Ft).join(U)},ce.prototype.multiply=function(U){var it=U.sx*this.sx+U.shy*this.shx,Et=U.sx*this.shy+U.shy*this.sy,Nt=U.shx*this.sx+U.sy*this.shx,ue=U.shx*this.shy+U.sy*this.sy,we=U.tx*this.sx+U.ty*this.shx+this.tx,Ve=U.tx*this.shy+U.ty*this.sy+this.ty;return new ce(it,Et,Nt,ue,we,Ve)},ce.prototype.decompose=function(){var U=this.sx,it=this.shy,Et=this.shx,Nt=this.sy,ue=this.tx,we=this.ty,Ve=Math.sqrt(U*U+it*it),li=(U/=Ve)*Et+(it/=Ve)*Nt;Et-=U*li,Nt-=it*li;var Di=Math.sqrt(Et*Et+Nt*Nt);return li/=Di,U*(Nt/=Di)<it*(Et/=Di)&&(U=-U,it=-it,li=-li,Ve=-Ve),{scale:new ce(Ve,0,0,Di,0,0),translate:new ce(1,0,0,1,ue,we),rotate:new ce(U,it,-it,U,0,0),skew:new ce(1,0,li,1,0,0)}},ce.prototype.toString=function(U){return this.join(" ")},ce.prototype.inversed=function(){var U=this.sx,it=this.shy,Et=this.shx,Nt=this.sy,ue=this.tx,we=this.ty,Ve=1/(U*Nt-it*Et),li=Nt*Ve,Di=-it*Ve,xi=-Et*Ve,ar=U*Ve;return new ce(li,Di,xi,ar,-li*ue-xi*we,-Di*ue-ar*we)},ce.prototype.applyToPoint=function(U){var it=U.x*this.sx+U.y*this.shx+this.tx,Et=U.x*this.shy+U.y*this.sy+this.ty;return new Xo(it,Et)},ce.prototype.applyToRectangle=function(U){var it=this.applyToPoint(U),Et=this.applyToPoint(new Xo(U.x+U.w,U.y+U.h));return new La(it.x,it.y,Et.x-it.x,Et.y-it.y)},ce.prototype.clone=function(){var U=this.sx,it=this.shy,Et=this.shx,Nt=this.sy,ue=this.tx,we=this.ty;return new ce(U,it,Et,Nt,ue,we)},k.Matrix=ce;var pe=k.matrixMult=function(U,it){return it.multiply(U)},me=new ce(1,0,0,1,0,0);k.unitMatrix=k.identityMatrix=me;var Xe=function(U,it){if(!Lr[U]){var Et=(it instanceof ru?"Sh":"P")+(Object.keys(tr).length+1).toString(10);it.id=Et,Lr[U]=Et,tr[Et]=it,Zt.publish("addPattern",it)}};k.ShadingPattern=ru,k.TilingPattern=Ah,k.addShadingPattern=function(U,it){return vt("addShadingPattern()"),Xe(U,it),this},k.beginTilingPattern=function(U){vt("beginTilingPattern()"),Yo(U.boundingBox[0],U.boundingBox[1],U.boundingBox[2]-U.boundingBox[0],U.boundingBox[3]-U.boundingBox[1],U.matrix)},k.endTilingPattern=function(U,it){vt("endTilingPattern()"),it.stream=Re[bt].join(`
`),Xe(U,it),Zt.publish("endTilingPattern",it),re.pop().restore()};var oi=k.__private__.newObject=function(){var U=ii();return Ni(U,!0),U},ii=k.__private__.newObjectDeferred=function(){return Ot++,Ae[Ot]=function(){return de},Ot},Ni=function(U,it){return it=typeof it=="boolean"&&it,Ae[U]=de,it&&Rt(U+" 0 obj"),U},Qi=k.__private__.newAdditionalObject=function(){var U={objId:ii(),content:""};return He.push(U),U},rr=ii(),zi=ii(),Cr=k.__private__.decodeColorString=function(U){var it=U.split(" ");if(it.length!==2||it[1]!=="g"&&it[1]!=="G")it.length===5&&(it[4]==="k"||it[4]==="K")&&(it=[(1-it[0])*(1-it[3]),(1-it[1])*(1-it[3]),(1-it[2])*(1-it[3]),"r"]);else{var Et=parseFloat(it[0]);it=[Et,Et,Et,"r"]}for(var Nt="#",ue=0;ue<3;ue++)Nt+=("0"+Math.floor(255*parseFloat(it[ue])).toString(16)).slice(-2);return Nt},ki=k.__private__.encodeColorString=function(U){var it;typeof U=="string"&&(U={ch1:U});var Et=U.ch1,Nt=U.ch2,ue=U.ch3,we=U.ch4,Ve=U.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Et=="string"&&Et.charAt(0)!=="#"){var li=new k5(Et);if(li.ok)Et=li.toHex();else if(!/^\d*\.?\d*$/.test(Et))throw new Error('Invalid color "'+Et+'" passed to jsPDF.encodeColorString.')}if(typeof Et=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Et)&&(Et="#"+Et[1]+Et[1]+Et[2]+Et[2]+Et[3]+Et[3]),typeof Et=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Et)){var Di=parseInt(Et.substr(1),16);Et=Di>>16&255,Nt=Di>>8&255,ue=255&Di}if(Nt===void 0||we===void 0&&Et===Nt&&Nt===ue)if(typeof Et=="string")it=Et+" "+Ve[0];else switch(U.precision){case 2:it=qt(Et/255)+" "+Ve[0];break;case 3:default:it=At(Et/255)+" "+Ve[0]}else if(we===void 0||Rr(we)==="object"){if(we&&!isNaN(we.a)&&we.a===0)return it=["1.","1.","1.",Ve[1]].join(" ");if(typeof Et=="string")it=[Et,Nt,ue,Ve[1]].join(" ");else switch(U.precision){case 2:it=[qt(Et/255),qt(Nt/255),qt(ue/255),Ve[1]].join(" ");break;default:case 3:it=[At(Et/255),At(Nt/255),At(ue/255),Ve[1]].join(" ")}}else if(typeof Et=="string")it=[Et,Nt,ue,we,Ve[2]].join(" ");else switch(U.precision){case 2:it=[qt(Et),qt(Nt),qt(ue),qt(we),Ve[2]].join(" ");break;case 3:default:it=[At(Et),At(Nt),At(ue),At(we),Ve[2]].join(" ")}return it},fr=k.__private__.getFilters=function(){return g},br=k.__private__.putStream=function(U){var it=(U=U||{}).data||"",Et=U.filters||fr(),Nt=U.alreadyAppliedFilters||[],ue=U.addLength1||!1,we=it.length,Ve=U.objectId,li=function(un){return un};if(x!==null&&Ve===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");x!==null&&(li=Fi.encryptor(Ve,0));var Di={};Et===!0&&(Et=["FlateEncode"]);var xi=U.additionalKeyValues||[],ar=(Di=er.API.processDataByFilters!==void 0?er.API.processDataByFilters(it,Et):{data:it,reverseChain:[]}).reverseChain+(Array.isArray(Nt)?Nt.join(" "):Nt.toString());if(Di.data.length!==0&&(xi.push({key:"Length",value:Di.data.length}),ue===!0&&xi.push({key:"Length1",value:we})),ar.length!=0)if(ar.split("/").length-1==1)xi.push({key:"Filter",value:ar});else{xi.push({key:"Filter",value:"["+ar+"]"});for(var Ci=0;Ci<xi.length;Ci+=1)if(xi[Ci].key==="DecodeParms"){for(var Vr=[],Xi=0;Xi<Di.reverseChain.split("/").length-1;Xi+=1)Vr.push("null");Vr.push(xi[Ci].value),xi[Ci].value="["+Vr.join(" ")+"]"}}Rt("<<");for(var Yi=0;Yi<xi.length;Yi++)Rt("/"+xi[Yi].key+" "+xi[Yi].value);Rt(">>"),Di.data.length!==0&&(Rt("stream"),Rt(li(Di.data)),Rt("endstream"))},Tr=k.__private__.putPage=function(U){var it=U.number,Et=U.data,Nt=U.objId,ue=U.contentsObjId;Ni(Nt,!0),Rt("<</Type /Page"),Rt("/Parent "+U.rootDictionaryObjId+" 0 R"),Rt("/Resources "+U.resourceDictionaryObjId+" 0 R"),Rt("/MediaBox ["+parseFloat(Ft(U.mediaBox.bottomLeftX))+" "+parseFloat(Ft(U.mediaBox.bottomLeftY))+" "+Ft(U.mediaBox.topRightX)+" "+Ft(U.mediaBox.topRightY)+"]"),U.cropBox!==null&&Rt("/CropBox ["+Ft(U.cropBox.bottomLeftX)+" "+Ft(U.cropBox.bottomLeftY)+" "+Ft(U.cropBox.topRightX)+" "+Ft(U.cropBox.topRightY)+"]"),U.bleedBox!==null&&Rt("/BleedBox ["+Ft(U.bleedBox.bottomLeftX)+" "+Ft(U.bleedBox.bottomLeftY)+" "+Ft(U.bleedBox.topRightX)+" "+Ft(U.bleedBox.topRightY)+"]"),U.trimBox!==null&&Rt("/TrimBox ["+Ft(U.trimBox.bottomLeftX)+" "+Ft(U.trimBox.bottomLeftY)+" "+Ft(U.trimBox.topRightX)+" "+Ft(U.trimBox.topRightY)+"]"),U.artBox!==null&&Rt("/ArtBox ["+Ft(U.artBox.bottomLeftX)+" "+Ft(U.artBox.bottomLeftY)+" "+Ft(U.artBox.topRightX)+" "+Ft(U.artBox.topRightY)+"]"),typeof U.userUnit=="number"&&U.userUnit!==1&&Rt("/UserUnit "+U.userUnit),Zt.publish("putPage",{objId:Nt,pageContext:ht[it],pageNumber:it,page:Et}),Rt("/Contents "+ue+" 0 R"),Rt(">>"),Rt("endobj");var we=Et.join(`
`);return at===tt.ADVANCED&&(we+=`
Q`),Ni(ue,!0),br({data:we,filters:fr(),objectId:ue}),Rt("endobj"),Nt},Dt=k.__private__.putPages=function(){var U,it,Et=[];for(U=1;U<=rt;U++)ht[U].objId=ii(),ht[U].contentsObjId=ii();for(U=1;U<=rt;U++)Et.push(Tr({number:U,data:Re[U],objId:ht[U].objId,contentsObjId:ht[U].contentsObjId,mediaBox:ht[U].mediaBox,cropBox:ht[U].cropBox,bleedBox:ht[U].bleedBox,trimBox:ht[U].trimBox,artBox:ht[U].artBox,userUnit:ht[U].userUnit,rootDictionaryObjId:rr,resourceDictionaryObjId:zi}));Ni(rr,!0),Rt("<</Type /Pages");var Nt="/Kids [";for(it=0;it<rt;it++)Nt+=Et[it]+" 0 R ";Rt(Nt+"]"),Rt("/Count "+rt),Rt(">>"),Rt("endobj"),Zt.publish("postPutPages")},Ke=function(U){Zt.publish("putFont",{font:U,out:Rt,newObject:oi,putStream:br}),U.isAlreadyPutted!==!0&&(U.objectNumber=oi(),Rt("<<"),Rt("/Type /Font"),Rt("/BaseFont /"+ah(U.postScriptName)),Rt("/Subtype /Type1"),typeof U.encoding=="string"&&Rt("/Encoding /"+U.encoding),Rt("/FirstChar 32"),Rt("/LastChar 255"),Rt(">>"),Rt("endobj"))},Te=function(){for(var U in Zi)Zi.hasOwnProperty(U)&&(T===!1||T===!0&&G.hasOwnProperty(U))&&Ke(Zi[U])},or=function(U){U.objectNumber=oi();var it=[];it.push({key:"Type",value:"/XObject"}),it.push({key:"Subtype",value:"/Form"}),it.push({key:"BBox",value:"["+[Ft(U.x),Ft(U.y),Ft(U.x+U.width),Ft(U.y+U.height)].join(" ")+"]"}),it.push({key:"Matrix",value:"["+U.matrix.toString()+"]"});var Et=U.pages[1].join(`
`);br({data:Et,additionalKeyValues:it,objectId:U.objectNumber}),Rt("endobj")},Er=function(){for(var U in Xt)Xt.hasOwnProperty(U)&&or(Xt[U])},Ji=function(U,it){var Et,Nt=[],ue=1/(it-1);for(Et=0;Et<1;Et+=ue)Nt.push(Et);if(Nt.push(1),U[0].offset!=0){var we={offset:0,color:U[0].color};U.unshift(we)}if(U[U.length-1].offset!=1){var Ve={offset:1,color:U[U.length-1].color};U.push(Ve)}for(var li="",Di=0,xi=0;xi<Nt.length;xi++){for(Et=Nt[xi];Et>U[Di+1].offset;)Di++;var ar=U[Di].offset,Ci=(Et-ar)/(U[Di+1].offset-ar),Vr=U[Di].color,Xi=U[Di+1].color;li+=Ht(Math.round((1-Ci)*Vr[0]+Ci*Xi[0]).toString(16))+Ht(Math.round((1-Ci)*Vr[1]+Ci*Xi[1]).toString(16))+Ht(Math.round((1-Ci)*Vr[2]+Ci*Xi[2]).toString(16))}return li.trim()},Mr=function(U,it){it||(it=21);var Et=oi(),Nt=Ji(U.colors,it),ue=[];ue.push({key:"FunctionType",value:"0"}),ue.push({key:"Domain",value:"[0.0 1.0]"}),ue.push({key:"Size",value:"["+it+"]"}),ue.push({key:"BitsPerSample",value:"8"}),ue.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ue.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),br({data:Nt,additionalKeyValues:ue,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Et}),Rt("endobj"),U.objectNumber=oi(),Rt("<< /ShadingType "+U.type),Rt("/ColorSpace /DeviceRGB");var we="/Coords ["+Ft(parseFloat(U.coords[0]))+" "+Ft(parseFloat(U.coords[1]))+" ";U.type===2?we+=Ft(parseFloat(U.coords[2]))+" "+Ft(parseFloat(U.coords[3])):we+=Ft(parseFloat(U.coords[2]))+" "+Ft(parseFloat(U.coords[3]))+" "+Ft(parseFloat(U.coords[4]))+" "+Ft(parseFloat(U.coords[5])),Rt(we+="]"),U.matrix&&Rt("/Matrix ["+U.matrix.toString()+"]"),Rt("/Function "+Et+" 0 R"),Rt("/Extend [true true]"),Rt(">>"),Rt("endobj")},vs=function(U,it){var Et=ii(),Nt=oi();it.push({resourcesOid:Et,objectOid:Nt}),U.objectNumber=Nt;var ue=[];ue.push({key:"Type",value:"/Pattern"}),ue.push({key:"PatternType",value:"1"}),ue.push({key:"PaintType",value:"1"}),ue.push({key:"TilingType",value:"1"}),ue.push({key:"BBox",value:"["+U.boundingBox.map(Ft).join(" ")+"]"}),ue.push({key:"XStep",value:Ft(U.xStep)}),ue.push({key:"YStep",value:Ft(U.yStep)}),ue.push({key:"Resources",value:Et+" 0 R"}),U.matrix&&ue.push({key:"Matrix",value:"["+U.matrix.toString()+"]"}),br({data:U.stream,additionalKeyValues:ue,objectId:U.objectNumber}),Rt("endobj")},Sr=function(U){var it;for(it in tr)tr.hasOwnProperty(it)&&(tr[it]instanceof ru?Mr(tr[it]):tr[it]instanceof Ah&&vs(tr[it],U))},xr=function(U){for(var it in U.objectNumber=oi(),Rt("<<"),U)switch(it){case"opacity":Rt("/ca "+qt(U[it]));break;case"stroke-opacity":Rt("/CA "+qt(U[it]))}Rt(">>"),Rt("endobj")},Wo=function(){var U;for(U in ft)ft.hasOwnProperty(U)&&xr(ft[U])},an=function(){for(var U in Rt("/XObject <<"),Xt)Xt.hasOwnProperty(U)&&Xt[U].objectNumber>=0&&Rt("/"+U+" "+Xt[U].objectNumber+" 0 R");Zt.publish("putXobjectDict"),Rt(">>")},Dn=function(){Fi.oid=oi(),Rt("<<"),Rt("/Filter /Standard"),Rt("/V "+Fi.v),Rt("/R "+Fi.r),Rt("/U <"+Fi.toHexString(Fi.U)+">"),Rt("/O <"+Fi.toHexString(Fi.O)+">"),Rt("/P "+Fi.P),Rt(">>"),Rt("endobj")},Oo=function(){for(var U in Rt("/Font <<"),Zi)Zi.hasOwnProperty(U)&&(T===!1||T===!0&&G.hasOwnProperty(U))&&Rt("/"+U+" "+Zi[U].objectNumber+" 0 R");Rt(">>")},As=function(){if(Object.keys(tr).length>0){for(var U in Rt("/Shading <<"),tr)tr.hasOwnProperty(U)&&tr[U]instanceof ru&&tr[U].objectNumber>=0&&Rt("/"+U+" "+tr[U].objectNumber+" 0 R");Zt.publish("putShadingPatternDict"),Rt(">>")}},Qr=function(U){if(Object.keys(tr).length>0){for(var it in Rt("/Pattern <<"),tr)tr.hasOwnProperty(it)&&tr[it]instanceof k.TilingPattern&&tr[it].objectNumber>=0&&tr[it].objectNumber<U&&Rt("/"+it+" "+tr[it].objectNumber+" 0 R");Zt.publish("putTilingPatternDict"),Rt(">>")}},zo=function(){if(Object.keys(ft).length>0){var U;for(U in Rt("/ExtGState <<"),ft)ft.hasOwnProperty(U)&&ft[U].objectNumber>=0&&Rt("/"+U+" "+ft[U].objectNumber+" 0 R");Zt.publish("putGStateDict"),Rt(">>")}},Fr=function(U){Ni(U.resourcesOid,!0),Rt("<<"),Rt("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Oo(),As(),Qr(U.objectOid),zo(),an(),Rt(">>"),Rt("endobj")},Nr=function(){var U=[];Te(),Wo(),Er(),Sr(U),Zt.publish("putResources"),U.forEach(Fr),Fr({resourcesOid:zi,objectOid:Number.MAX_SAFE_INTEGER}),Zt.publish("postPutResources")},Gs=function(){Zt.publish("putAdditionalObjects");for(var U=0;U<He.length;U++){var it=He[U];Ni(it.objId,!0),Rt(it.content),Rt("endobj")}Zt.publish("postPutAdditionalObjects")},Kn=function(U){qi[U.fontName]=qi[U.fontName]||{},qi[U.fontName][U.fontStyle]=U.id},to=function(U,it,Et,Nt,ue){var we={id:"F"+(Object.keys(Zi).length+1).toString(10),postScriptName:U,fontName:it,fontStyle:Et,encoding:Nt,isStandardFont:ue||!1,metadata:{}};return Zt.publish("addFont",{font:we,instance:this}),Zi[we.id]=we,Kn(we),we.id},pt=function(U){for(var it=0,Et=Ee.length;it<Et;it++){var Nt=to.call(this,U[it][0],U[it][1],U[it][2],Ee[it][3],!0);T===!1&&(G[Nt]=!0);var ue=U[it][0].split("-");Kn({id:Nt,fontName:ue[0],fontStyle:ue[1]||""})}Zt.publish("addFonts",{fonts:Zi,dictionary:qi})},yt=function(U){return U.foo=function(){try{return U.apply(this,arguments)}catch(Nt){var it=Nt.stack||"";~it.indexOf(" at ")&&(it=it.split(" at ")[1]);var Et="Error in function "+it.split(`
`)[0].split("<")[0]+": "+Nt.message;if(!ir.console)throw new Error(Et);ir.console.error(Et,Nt),ir.alert&&alert(Et)}},U.foo.bar=U,U.foo},ct=function(U,it){var Et,Nt,ue,we,Ve,li,Di,xi,ar;if(ue=(it=it||{}).sourceEncoding||"Unicode",Ve=it.outputEncoding,(it.autoencode||Ve)&&Zi[Vi].metadata&&Zi[Vi].metadata[ue]&&Zi[Vi].metadata[ue].encoding&&(we=Zi[Vi].metadata[ue].encoding,!Ve&&Zi[Vi].encoding&&(Ve=Zi[Vi].encoding),!Ve&&we.codePages&&(Ve=we.codePages[0]),typeof Ve=="string"&&(Ve=we[Ve]),Ve)){for(Di=!1,li=[],Et=0,Nt=U.length;Et<Nt;Et++)(xi=Ve[U.charCodeAt(Et)])?li.push(String.fromCharCode(xi)):li.push(U[Et]),li[Et].charCodeAt(0)>>8&&(Di=!0);U=li.join("")}for(Et=U.length;Di===void 0&&Et!==0;)U.charCodeAt(Et-1)>>8&&(Di=!0),Et--;if(!Di)return U;for(li=it.noBOM?[]:[254,255],Et=0,Nt=U.length;Et<Nt;Et++){if((ar=(xi=U.charCodeAt(Et))>>8)>>8)throw new Error("Character at position "+Et+" of string '"+U+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");li.push(ar),li.push(xi-(ar<<8))}return String.fromCharCode.apply(void 0,li)},Bt=k.__private__.pdfEscape=k.pdfEscape=function(U,it){return ct(U,it).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Kt=k.__private__.beginPage=function(U){Re[++rt]=[],ht[rt]={objId:0,contentsObjId:0,userUnit:Number(d),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(U[0]),topRightY:Number(U[1])}},Be(rt),xt(Re[bt])},Yt=function(U,it){var Et,Nt,ue;switch(i=it||i,typeof U=="string"&&(Et=O(U.toLowerCase()),Array.isArray(Et)&&(Nt=Et[0],ue=Et[1])),Array.isArray(U)&&(Nt=U[0]*We,ue=U[1]*We),isNaN(Nt)&&(Nt=A[0],ue=A[1]),(Nt>14400||ue>14400)&&(sn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Nt=Math.min(14400,Nt),ue=Math.min(14400,ue)),A=[Nt,ue],i.substr(0,1)){case"l":ue>Nt&&(A=[ue,Nt]);break;case"p":Nt>ue&&(A=[ue,Nt])}Kt(A),Sa(xo),Rt(Rs),il!==0&&Rt(il+" J"),rl!==0&&Rt(rl+" j"),Zt.publish("addPage",{pageNumber:rt})},ae=function(U){U>0&&U<=rt&&(Re.splice(U,1),ht.splice(U,1),rt--,bt>rt&&(bt=rt),this.setPage(bt))},Be=function(U){U>0&&U<=rt&&(bt=U)},_e=k.__private__.getNumberOfPages=k.getNumberOfPages=function(){return Re.length-1},Ce=function(U,it,Et){var Nt,ue=void 0;return Et=Et||{},U=U!==void 0?U:Zi[Vi].fontName,it=it!==void 0?it:Zi[Vi].fontStyle,Nt=U.toLowerCase(),qi[Nt]!==void 0&&qi[Nt][it]!==void 0?ue=qi[Nt][it]:qi[U]!==void 0&&qi[U][it]!==void 0?ue=qi[U][it]:Et.disableWarning===!1&&sn.warn("Unable to look up font label for font '"+U+"', '"+it+"'. Refer to getFontList() for available fonts."),ue||Et.noFallback||(ue=qi.times[it])==null&&(ue=qi.times.normal),ue},se=k.__private__.putInfo=function(){var U=oi(),it=function(Nt){return Nt};for(var Et in x!==null&&(it=Fi.encryptor(U,0)),Rt("<<"),Rt("/Producer ("+Bt(it("jsPDF "+er.version))+")"),mi)mi.hasOwnProperty(Et)&&mi[Et]&&Rt("/"+Et.substr(0,1).toUpperCase()+Et.substr(1)+" ("+Bt(it(mi[Et]))+")");Rt("/CreationDate ("+Bt(it(le))+")"),Rt(">>"),Rt("endobj")},ye=k.__private__.putCatalog=function(U){var it=(U=U||{}).rootDictionaryObjId||rr;switch(oi(),Rt("<<"),Rt("/Type /Catalog"),Rt("/Pages "+it+" 0 R"),Je||(Je="fullwidth"),Je){case"fullwidth":Rt("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Rt("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Rt("/OpenAction [3 0 R /Fit]");break;case"original":Rt("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Et=""+Je;Et.substr(Et.length-1)==="%"&&(Je=parseInt(Je)/100),typeof Je=="number"&&Rt("/OpenAction [3 0 R /XYZ null null "+qt(Je)+"]")}switch(Pi||(Pi="continuous"),Pi){case"continuous":Rt("/PageLayout /OneColumn");break;case"single":Rt("/PageLayout /SinglePage");break;case"two":case"twoleft":Rt("/PageLayout /TwoColumnLeft");break;case"tworight":Rt("/PageLayout /TwoColumnRight")}hi&&Rt("/PageMode /"+hi),Zt.publish("putCatalog"),Rt(">>"),Rt("endobj")},be=k.__private__.putTrailer=function(){Rt("trailer"),Rt("<<"),Rt("/Size "+(Ot+1)),Rt("/Root "+Ot+" 0 R"),Rt("/Info "+(Ot-1)+" 0 R"),x!==null&&Rt("/Encrypt "+Fi.oid+" 0 R"),Rt("/ID [ <"+ie+"> <"+ie+"> ]"),Rt(">>")},Ge=k.__private__.putHeader=function(){Rt("%PDF-"+W),Rt("%\xBA\xDF\xAC\xE0")},Ui=k.__private__.putXRef=function(){var U="0000000000";Rt("xref"),Rt("0 "+(Ot+1)),Rt("0000000000 65535 f ");for(var it=1;it<=Ot;it++)typeof Ae[it]=="function"?Rt((U+Ae[it]()).slice(-10)+" 00000 n "):Ae[it]!==void 0?Rt((U+Ae[it]).slice(-10)+" 00000 n "):Rt("0000000000 00000 n ")},Ri=k.__private__.buildDocument=function(){gi(),xt(he),Zt.publish("buildDocument"),Ge(),Dt(),Gs(),Nr(),x!==null&&Dn(),se(),ye();var U=de;return Ui(),be(),Rt("startxref"),Rt(""+U),Rt("%%EOF"),xt(Re[bt]),he.join(`
`)},Pe=k.__private__.getBlob=function(U){return new Blob([Ue(U)],{type:"application/pdf"})},Qe=k.output=k.__private__.output=yt(function(U,it){switch(typeof(it=it||{})=="string"?it={filename:it}:it.filename=it.filename||"generated.pdf",U){case void 0:return Ri();case"save":k.save(it.filename);break;case"arraybuffer":return Ue(Ri());case"blob":return Pe(Ri());case"bloburi":case"bloburl":if(ir.URL!==void 0&&typeof ir.URL.createObjectURL=="function")return ir.URL&&ir.URL.createObjectURL(Pe(Ri()))||void 0;sn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Et="",Nt=Ri();try{Et=Gy(Nt)}catch{Et=Gy(unescape(encodeURIComponent(Nt)))}return"data:application/pdf;filename="+it.filename+";base64,"+Et;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ir)==="[object Window]"){var ue="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",we=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';it.pdfObjectUrl&&(ue=it.pdfObjectUrl,we="");var Ve='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ue+'"'+we+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(it)+");<\/script></body></html>",li=ir.open();return li!==null&&li.document.write(Ve),li}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ir)==="[object Window]"){var Di='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(it.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+it.filename+'" width="500px" height="400px" /></body></html>',xi=ir.open();if(xi!==null){xi.document.write(Di);var ar=this;xi.document.documentElement.querySelector("#pdfViewer").onload=function(){xi.document.title=it.filename,xi.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ar.output("bloburl"))}}return xi}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ir)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ci='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",it)+'"></iframe></body></html>',Vr=ir.open();if(Vr!==null&&(Vr.document.write(Ci),Vr.document.title=it.filename),Vr||typeof safari>"u")return Vr;break;case"datauri":case"dataurl":return ir.document.location.href=this.output("datauristring",it);default:return null}}),Ai=function(U){return Array.isArray(zt)===!0&&zt.indexOf(U)>-1};switch(s){case"pt":We=1;break;case"mm":We=72/25.4;break;case"cm":We=72/2.54;break;case"in":We=72;break;case"px":We=Ai("px_scaling")==1?.75:96/72;break;case"pc":case"em":We=12;break;case"ex":We=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);We=s}var Fi=null;fe(),te();var Wi=function(U){return x!==null?Fi.encryptor(U,0):function(it){return it}},nr=k.__private__.getPageInfo=k.getPageInfo=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ht[U].objId,pageNumber:U,pageContext:ht[U]}},ai=k.__private__.getPageInfoByObjId=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var it in ht)if(ht[it].objId===U)break;return nr(it)},dr=k.__private__.getCurrentPageInfo=k.getCurrentPageInfo=function(){return{objId:ht[bt].objId,pageNumber:bt,pageContext:ht[bt]}};k.addPage=function(){return Yt.apply(this,arguments),this},k.setPage=function(){return Be.apply(this,arguments),xt.call(this,Re[bt]),this},k.insertPage=function(U){return this.addPage(),this.movePage(bt,U),this},k.movePage=function(U,it){var Et,Nt;if(U>it){Et=Re[U],Nt=ht[U];for(var ue=U;ue>it;ue--)Re[ue]=Re[ue-1],ht[ue]=ht[ue-1];Re[it]=Et,ht[it]=Nt,this.setPage(it)}else if(U<it){Et=Re[U],Nt=ht[U];for(var we=U;we<it;we++)Re[we]=Re[we+1],ht[we]=ht[we+1];Re[it]=Et,ht[it]=Nt,this.setPage(it)}return this},k.deletePage=function(){return ae.apply(this,arguments),this},k.__private__.text=k.text=function(U,it,Et,Nt,ue){var we,Ve,li,Di,xi,ar,Ci,Vr,Xi,Yi=(Nt=Nt||{}).scope||this;if(typeof U=="number"&&typeof it=="number"&&(typeof Et=="string"||Array.isArray(Et))){var un=Et;Et=it,it=U,U=un}if(arguments[3]instanceof ce?(vt("The transform parameter of text() with a Matrix value"),Xi=ue):(li=arguments[4],Di=arguments[5],Rr(Ci=arguments[3])==="object"&&Ci!==null||(typeof li=="string"&&(Di=li,li=null),typeof Ci=="string"&&(Di=Ci,Ci=null),typeof Ci=="number"&&(li=Ci,Ci=null),Nt={flags:Ci,angle:li,align:Di})),isNaN(it)||isNaN(Et)||U==null)throw new Error("Invalid arguments passed to jsPDF.text");if(U.length===0)return Yi;var hn="",Hs=!1,$n=typeof Nt.lineHeightFactor=="number"?Nt.lineHeightFactor:cn,Zs=Yi.internal.scaleFactor;function yA(pr){return pr=pr.split("	").join(Array(Nt.TabLen||9).join(" ")),Bt(pr,Ci)}function bA(pr){for(var kr,en=pr.concat(),yn=[],oo=en.length;oo--;)typeof(kr=en.shift())=="string"?yn.push(kr):Array.isArray(pr)&&(kr.length===1||kr[1]===void 0&&kr[2]===void 0)?yn.push(kr[0]):yn.push([kr[0],kr[1],kr[2]]);return yn}function ga(pr,kr){var en;if(typeof pr=="string")en=kr(pr)[0];else if(Array.isArray(pr)){for(var yn,oo,ea=pr.concat(),cs=[],ao=ea.length;ao--;)typeof(yn=ea.shift())=="string"?cs.push(kr(yn)[0]):Array.isArray(yn)&&typeof yn[0]=="string"&&(oo=kr(yn[0],yn[1],yn[2]),cs.push([oo[0],oo[1],oo[2]]));en=cs}return en}var Qa=!1,Ua=!0;if(typeof U=="string")Qa=!0;else if(Array.isArray(U)){var Lo=U.concat();Ve=[];for(var da,ts=Lo.length;ts--;)(typeof(da=Lo.shift())!="string"||Array.isArray(da)&&typeof da[0]!="string")&&(Ua=!1);Qa=Ua}if(Qa===!1)throw new Error('Type of text must be string or Array. "'+U+'" is not recognized.');typeof U=="string"&&(U=U.match(/[\r?\n]/)?U.split(/\r\n|\r|\n/g):[U]);var Ga=Ne/Yi.internal.scaleFactor,$o=Ga*($n-1);switch(Nt.baseline){case"bottom":Et-=$o;break;case"top":Et+=Ga-$o;break;case"hanging":Et+=Ga-2*$o;break;case"middle":Et+=Ga/2-$o}if((ar=Nt.maxWidth||0)>0&&(typeof U=="string"?U=Yi.splitTextToSize(U,ar):Object.prototype.toString.call(U)==="[object Array]"&&(U=U.reduce(function(pr,kr){return pr.concat(Yi.splitTextToSize(kr,ar))},[]))),we={text:U,x:it,y:Et,options:Nt,mutex:{pdfEscape:Bt,activeFontKey:Vi,fonts:Zi,activeFontSize:Ne}},Zt.publish("preProcessText",we),U=we.text,li=(Nt=we.options).angle,!(Xi instanceof ce)&&li&&typeof li=="number"){li*=Math.PI/180,Nt.rotationDirection===0&&(li=-li),at===tt.ADVANCED&&(li=-li);var pa=Math.cos(li),nl=Math.sin(li);Xi=new ce(pa,nl,-nl,pa,0,0)}else li&&li instanceof ce&&(Xi=li);at!==tt.ADVANCED||Xi||(Xi=me),(xi=Nt.charSpace||CA)!==void 0&&(hn+=Ft(lt(xi))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Vr=Nt.horizontalScale)!==void 0&&(hn+=Ft(100*Vr)+` Tz
`),Nt.lang;var es=-1,zr=Nt.renderingMode!==void 0?Nt.renderingMode:Nt.stroke,Ps=Yi.internal.getCurrentPageInfo().pageContext;switch(zr){case 0:case!1:case"fill":es=0;break;case 1:case!0:case"stroke":es=1;break;case 2:case"fillThenStroke":es=2;break;case 3:case"invisible":es=3;break;case 4:case"fillAndAddForClipping":es=4;break;case 5:case"strokeAndAddPathForClipping":es=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":es=6;break;case 7:case"addToPathForClipping":es=7}var Wn=Ps.usedRenderingMode!==void 0?Ps.usedRenderingMode:-1;es!==-1?hn+=es+` Tr
`:Wn!==-1&&(hn+=`0 Tr
`),es!==-1&&(Ps.usedRenderingMode=es),Di=Nt.align||"left";var On,Ra=Ne*$n,sl=Yi.internal.pageSize.getWidth(),fa=Zi[Vi];xi=Nt.charSpace||CA,ar=Nt.maxWidth||0,Ci=Object.assign({autoencode:!0,noBOM:!0},Nt.flags);var ls=[];if(Object.prototype.toString.call(U)==="[object Array]"){var xn;Ve=bA(U),Di!=="left"&&(On=Ve.map(function(pr){return Yi.getStringUnitWidth(pr,{font:fa,charSpace:xi,fontSize:Ne,doKerning:!1})*Ne/Zs}));var is,Eo=0;if(Di==="right"){it-=On[0],U=[],ts=Ve.length;for(var _s=0;_s<ts;_s++)_s===0?(is=io(it),xn=So(Et)):(is=lt(Eo-On[_s]),xn=-Ra),U.push([Ve[_s],is,xn]),Eo=On[_s]}else if(Di==="center"){it-=On[0]/2,U=[],ts=Ve.length;for(var no=0;no<ts;no++)no===0?(is=io(it),xn=So(Et)):(is=lt((Eo-On[no])/2),xn=-Ra),U.push([Ve[no],is,xn]),Eo=On[no]}else if(Di==="left"){U=[],ts=Ve.length;for(var ma=0;ma<ts;ma++)U.push(Ve[ma])}else{if(Di!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');U=[],ts=Ve.length,ar=ar!==0?ar:sl;for(var fn=0;fn<ts;fn++)xn=fn===0?So(Et):-Ra,is=fn===0?io(it):0,fn<ts-1?ls.push(Ft(lt((ar-On[fn])/(Ve[fn].split(" ").length-1)))):ls.push(0),U.push([Ve[fn],is,xn])}}var Ha=typeof Nt.R2L=="boolean"?Nt.R2L:ui;Ha===!0&&(U=ga(U,function(pr,kr,en){return[pr.split("").reverse().join(""),kr,en]})),we={text:U,x:it,y:Et,options:Nt,mutex:{pdfEscape:Bt,activeFontKey:Vi,fonts:Zi,activeFontSize:Ne}},Zt.publish("postProcessText",we),U=we.text,Hs=we.mutex.isHex||!1;var vA=Zi[Vi].encoding;vA!=="WinAnsiEncoding"&&vA!=="StandardEncoding"||(U=ga(U,function(pr,kr,en){return[yA(pr),kr,en]})),Ve=bA(U),U=[];for(var ta,Ms,To,so=0,Qo=1,Jr=Array.isArray(Ve[0])?Qo:so,xs="",zn=function(pr,kr,en){var yn="";return en instanceof ce?(en=typeof Nt.angle=="number"?pe(en,new ce(1,0,0,1,pr,kr)):pe(new ce(1,0,0,1,pr,kr),en),at===tt.ADVANCED&&(en=pe(new ce(1,0,0,-1,0,0),en)),yn=en.join(" ")+` Tm
`):yn=Ft(pr)+" "+Ft(kr)+` Td
`,yn},gn=0;gn<Ve.length;gn++){switch(xs="",Jr){case Qo:To=(Hs?"<":"(")+Ve[gn][0]+(Hs?">":")"),ta=parseFloat(Ve[gn][1]),Ms=parseFloat(Ve[gn][2]);break;case so:To=(Hs?"<":"(")+Ve[gn]+(Hs?">":")"),ta=io(it),Ms=So(Et)}ls!==void 0&&ls[gn]!==void 0&&(xs=ls[gn]+` Tw
`),gn===0?U.push(xs+zn(ta,Ms,Xi)+To):Jr===so?U.push(xs+To):Jr===Qo&&U.push(xs+zn(ta,Ms,Xi)+To)}U=Jr===so?U.join(` Tj
T* `):U.join(` Tj
`),U+=` Tj
`;var Uo=`BT
/`;return Uo+=Vi+" "+Ne+` Tf
`,Uo+=Ft(Ne*$n)+` TL
`,Uo+=ka+`
`,Uo+=hn,Uo+=U,Rt(Uo+="ET"),G[Vi]=!0,Yi};var Or=k.__private__.clip=k.clip=function(U){return Rt(U==="evenodd"?"W*":"W"),this};k.clipEvenOdd=function(){return Or("evenodd")},k.__private__.discardPath=k.discardPath=function(){return Rt("n"),this};var Ur=k.__private__.isValidStyle=function(U){var it=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(U)!==-1&&(it=!0),it};k.__private__.setDefaultPathOperation=k.setDefaultPathOperation=function(U){return Ur(U)&&(v=U),this};var _n=k.__private__.getStyle=k.getStyle=function(U){var it=v;switch(U){case"D":case"S":it="S";break;case"F":it="f";break;case"FD":case"DF":it="B";break;case"f":case"f*":case"B":case"B*":it=U}return it},vn=k.close=function(){return Rt("h"),this};k.stroke=function(){return Rt("S"),this},k.fill=function(U){return ws("f",U),this},k.fillEvenOdd=function(U){return ws("f*",U),this},k.fillStroke=function(U){return ws("B",U),this},k.fillStrokeEvenOdd=function(U){return ws("B*",U),this};var ws=function(U,it){Rr(it)==="object"?yc(it,U):Rt(U)},_o=function(U){U===null||at===tt.ADVANCED&&U===void 0||(U=_n(U),Rt(U))};function Ic(U,it,Et,Nt,ue){var we=new Ah(it||this.boundingBox,Et||this.xStep,Nt||this.yStep,this.gState,ue||this.matrix);we.stream=this.stream;var Ve=U+"$$"+this.cloneIndex+++"$$";return Xe(Ve,we),we}var yc=function(U,it){var Et=Lr[U.key],Nt=tr[Et];if(Nt instanceof ru)Rt("q"),Rt(El(it)),Nt.gState&&k.setGState(Nt.gState),Rt(U.matrix.toString()+" cm"),Rt("/"+Et+" sh"),Rt("Q");else if(Nt instanceof Ah){var ue=new ce(1,0,0,-1,0,qo());U.matrix&&(ue=ue.multiply(U.matrix||me),Et=Ic.call(Nt,U.key,U.boundingBox,U.xStep,U.yStep,ue).id),Rt("q"),Rt("/Pattern cs"),Rt("/"+Et+" scn"),Nt.gState&&k.setGState(Nt.gState),Rt(it),Rt("Q")}},El=function(U){switch(U){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},el=k.moveTo=function(U,it){return Rt(Ft(lt(U))+" "+Ft(_t(it))+" m"),this},Bs=k.lineTo=function(U,it){return Rt(Ft(lt(U))+" "+Ft(_t(it))+" l"),this},eo=k.curveTo=function(U,it,Et,Nt,ue,we){return Rt([Ft(lt(U)),Ft(_t(it)),Ft(lt(Et)),Ft(_t(Nt)),Ft(lt(ue)),Ft(_t(we)),"c"].join(" ")),this};k.__private__.line=k.line=function(U,it,Et,Nt,ue){if(isNaN(U)||isNaN(it)||isNaN(Et)||isNaN(Nt)||!Ur(ue))throw new Error("Invalid arguments passed to jsPDF.line");return at===tt.COMPAT?this.lines([[Et-U,Nt-it]],U,it,[1,1],ue||"S"):this.lines([[Et-U,Nt-it]],U,it,[1,1]).stroke()},k.__private__.lines=k.lines=function(U,it,Et,Nt,ue,we){var Ve,li,Di,xi,ar,Ci,Vr,Xi,Yi,un,hn,Hs;if(typeof U=="number"&&(Hs=Et,Et=it,it=U,U=Hs),Nt=Nt||[1,1],we=we||!1,isNaN(it)||isNaN(Et)||!Array.isArray(U)||!Array.isArray(Nt)||!Ur(ue)||typeof we!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(el(it,Et),Ve=Nt[0],li=Nt[1],xi=U.length,un=it,hn=Et,Di=0;Di<xi;Di++)(ar=U[Di]).length===2?(un=ar[0]*Ve+un,hn=ar[1]*li+hn,Bs(un,hn)):(Ci=ar[0]*Ve+un,Vr=ar[1]*li+hn,Xi=ar[2]*Ve+un,Yi=ar[3]*li+hn,un=ar[4]*Ve+un,hn=ar[5]*li+hn,eo(Ci,Vr,Xi,Yi,un,hn));return we&&vn(),_o(ue),this},k.path=function(U){for(var it=0;it<U.length;it++){var Et=U[it],Nt=Et.c;switch(Et.op){case"m":el(Nt[0],Nt[1]);break;case"l":Bs(Nt[0],Nt[1]);break;case"c":eo.apply(this,Nt);break;case"h":vn()}}return this},k.__private__.rect=k.rect=function(U,it,Et,Nt,ue){if(isNaN(U)||isNaN(it)||isNaN(Et)||isNaN(Nt)||!Ur(ue))throw new Error("Invalid arguments passed to jsPDF.rect");return at===tt.COMPAT&&(Nt=-Nt),Rt([Ft(lt(U)),Ft(_t(it)),Ft(lt(Et)),Ft(lt(Nt)),"re"].join(" ")),_o(ue),this},k.__private__.triangle=k.triangle=function(U,it,Et,Nt,ue,we,Ve){if(isNaN(U)||isNaN(it)||isNaN(Et)||isNaN(Nt)||isNaN(ue)||isNaN(we)||!Ur(Ve))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Et-U,Nt-it],[ue-Et,we-Nt],[U-ue,it-we]],U,it,[1,1],Ve,!0),this},k.__private__.roundedRect=k.roundedRect=function(U,it,Et,Nt,ue,we,Ve){if(isNaN(U)||isNaN(it)||isNaN(Et)||isNaN(Nt)||isNaN(ue)||isNaN(we)||!Ur(Ve))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var li=4/3*(Math.SQRT2-1);return ue=Math.min(ue,.5*Et),we=Math.min(we,.5*Nt),this.lines([[Et-2*ue,0],[ue*li,0,ue,we-we*li,ue,we],[0,Nt-2*we],[0,we*li,-ue*li,we,-ue,we],[2*ue-Et,0],[-ue*li,0,-ue,-we*li,-ue,-we],[0,2*we-Nt],[0,-we*li,ue*li,-we,ue,-we]],U+ue,it,[1,1],Ve,!0),this},k.__private__.ellipse=k.ellipse=function(U,it,Et,Nt,ue){if(isNaN(U)||isNaN(it)||isNaN(Et)||isNaN(Nt)||!Ur(ue))throw new Error("Invalid arguments passed to jsPDF.ellipse");var we=4/3*(Math.SQRT2-1)*Et,Ve=4/3*(Math.SQRT2-1)*Nt;return el(U+Et,it),eo(U+Et,it-Ve,U+we,it-Nt,U,it-Nt),eo(U-we,it-Nt,U-Et,it-Ve,U-Et,it),eo(U-Et,it+Ve,U-we,it+Nt,U,it+Nt),eo(U+we,it+Nt,U+Et,it+Ve,U+Et,it),_o(ue),this},k.__private__.circle=k.circle=function(U,it,Et,Nt){if(isNaN(U)||isNaN(it)||isNaN(Et)||!Ur(Nt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(U,it,Et,Et,Nt)},k.setFont=function(U,it,Et){return Et&&(it=Qt(it,Et)),Vi=Ce(U,it,{disableWarning:!1}),this};var qn=k.__private__.getFont=k.getFont=function(){return Zi[Ce.apply(k,arguments)]};k.__private__.getFontList=k.getFontList=function(){var U,it,Et={};for(U in qi)if(qi.hasOwnProperty(U))for(it in Et[U]=[],qi[U])qi[U].hasOwnProperty(it)&&Et[U].push(it);return Et},k.addFont=function(U,it,Et,Nt,ue){var we=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&we.indexOf(arguments[3])!==-1?ue=arguments[3]:arguments[3]&&we.indexOf(arguments[3])==-1&&(Et=Qt(Et,Nt)),ue=ue||"Identity-H",to.call(this,U,it,Et,ue)};var cn,xo=r.lineWidth||.200025,lr=k.__private__.getLineWidth=k.getLineWidth=function(){return xo},Sa=k.__private__.setLineWidth=k.setLineWidth=function(U){return xo=U,Rt(Ft(lt(U))+" w"),this};k.__private__.setLineDash=er.API.setLineDash=er.API.setLineDashPattern=function(U,it){if(U=U||[],it=it||0,isNaN(it)||!Array.isArray(U))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return U=U.map(function(Et){return Ft(lt(Et))}).join(" "),it=Ft(lt(it)),Rt("["+U+"] "+it+" d"),this};var pA=k.__private__.getLineHeight=k.getLineHeight=function(){return Ne*cn};k.__private__.getLineHeight=k.getLineHeight=function(){return Ne*cn};var fA=k.__private__.setLineHeightFactor=k.setLineHeightFactor=function(U){return typeof(U=U||1.15)=="number"&&(cn=U),this},Fa=k.__private__.getLineHeightFactor=k.getLineHeightFactor=function(){return cn};fA(r.lineHeight);var io=k.__private__.getHorizontalCoordinate=function(U){return lt(U)},So=k.__private__.getVerticalCoordinate=function(U){return at===tt.ADVANCED?U:ht[bt].mediaBox.topRightY-ht[bt].mediaBox.bottomLeftY-lt(U)},mA=k.__private__.getHorizontalCoordinateString=k.getHorizontalCoordinateString=function(U){return Ft(io(U))},Jo=k.__private__.getVerticalCoordinateString=k.getVerticalCoordinateString=function(U){return Ft(So(U))},Rs=r.strokeColor||"0 G";k.__private__.getStrokeColor=k.getDrawColor=function(){return Cr(Rs)},k.__private__.setStrokeColor=k.setDrawColor=function(U,it,Et,Nt){return Rs=ki({ch1:U,ch2:it,ch3:Et,ch4:Nt,pdfColorType:"draw",precision:2}),Rt(Rs),this};var Fo=r.fillColor||"0 g";k.__private__.getFillColor=k.getFillColor=function(){return Cr(Fo)},k.__private__.setFillColor=k.setFillColor=function(U,it,Et,Nt){return Fo=ki({ch1:U,ch2:it,ch3:Et,ch4:Nt,pdfColorType:"fill",precision:2}),Rt(Fo),this};var ka=r.textColor||"0 g",bc=k.__private__.getTextColor=k.getTextColor=function(){return Cr(ka)};k.__private__.setTextColor=k.setTextColor=function(U,it,Et,Nt){return ka=ki({ch1:U,ch2:it,ch3:Et,ch4:Nt,pdfColorType:"text",precision:3}),this};var CA=r.charSpace,vc=k.__private__.getCharSpace=k.getCharSpace=function(){return parseFloat(CA||0)};k.__private__.setCharSpace=k.setCharSpace=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return CA=U,this};var il=0;k.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},k.__private__.setLineCap=k.setLineCap=function(U){var it=k.CapJoinStyles[U];if(it===void 0)throw new Error("Line cap style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return il=it,Rt(it+" J"),this};var rl=0;k.__private__.setLineJoin=k.setLineJoin=function(U){var it=k.CapJoinStyles[U];if(it===void 0)throw new Error("Line join style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return rl=it,Rt(it+" j"),this},k.__private__.setLineMiterLimit=k.__private__.setMiterLimit=k.setLineMiterLimit=k.setMiterLimit=function(U){if(U=U||0,isNaN(U))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Rt(Ft(lt(U))+" M"),this},k.GState=tm,k.setGState=function(U){(U=typeof U=="string"?ft[Y[U]]:IA(null,U)).equals(q)||(Rt("/"+U.id+" gs"),q=U)};var IA=function(U,it){if(!U||!Y[U]){var Et=!1;for(var Nt in ft)if(ft.hasOwnProperty(Nt)&&ft[Nt].equals(it)){Et=!0;break}if(Et)it=ft[Nt];else{var ue="GS"+(Object.keys(ft).length+1).toString(10);ft[ue]=it,it.id=ue}return U&&(Y[U]=it.id),Zt.publish("addGState",it),it}};k.addGState=function(U,it){return IA(U,it),this},k.saveGraphicsState=function(){return Rt("q"),vi.push({key:Vi,size:Ne,color:ka}),this},k.restoreGraphicsState=function(){Rt("Q");var U=vi.pop();return Vi=U.key,Ne=U.size,ka=U.color,q=null,this},k.setCurrentTransformationMatrix=function(U){return Rt(U.toString()+" cm"),this},k.comment=function(U){return Rt("#"+U),this};var Xo=function(U,it){var Et=U||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Et},set:function(we){isNaN(we)||(Et=parseFloat(we))}});var Nt=it||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Nt},set:function(we){isNaN(we)||(Nt=parseFloat(we))}});var ue="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ue},set:function(we){ue=we.toString()}}),this},La=function(U,it,Et,Nt){Xo.call(this,U,it),this.type="rect";var ue=Et||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ue},set:function(Ve){isNaN(Ve)||(ue=parseFloat(Ve))}});var we=Nt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return we},set:function(Ve){isNaN(Ve)||(we=parseFloat(Ve))}}),this},Ea=function(){this.page=rt,this.currentPage=bt,this.pages=Re.slice(0),this.pagesContext=ht.slice(0),this.x=Se,this.y=$e,this.matrix=di,this.width=jo(bt),this.height=qo(bt),this.outputDestination=Me,this.id="",this.objectNumber=-1};Ea.prototype.restore=function(){rt=this.page,bt=this.currentPage,ht=this.pagesContext,Re=this.pages,Se=this.x,$e=this.y,di=this.matrix,ro(bt,this.width),ko(bt,this.height),Me=this.outputDestination};var Yo=function(U,it,Et,Nt,ue){re.push(new Ea),rt=bt=0,Re=[],Se=U,$e=it,di=ue,Kt([Et,Nt])},Tl=function(U){if(Mt[U])re.pop().restore();else{var it=new Ea,Et="Xo"+(Object.keys(Xt).length+1).toString(10);it.id=Et,Mt[U]=Et,Xt[Et]=it,Zt.publish("addFormObject",it),re.pop().restore()}};for(var Ta in k.beginFormObject=function(U,it,Et,Nt,ue){return Yo(U,it,Et,Nt,ue),this},k.endFormObject=function(U){return Tl(U),this},k.doFormObject=function(U,it){var Et=Xt[Mt[U]];return Rt("q"),Rt(it.toString()+" cm"),Rt("/"+Et.id+" Do"),Rt("Q"),this},k.getFormObject=function(U){var it=Xt[Mt[U]];return{x:it.x,y:it.y,width:it.width,height:it.height,matrix:it.matrix}},k.save=function(U,it){return U=U||"generated.pdf",(it=it||{}).returnPromise=it.returnPromise||!1,it.returnPromise===!1?(iu(Pe(Ri()),U),typeof iu.unload=="function"&&ir.setTimeout&&setTimeout(iu.unload,911),this):new Promise(function(Et,Nt){try{var ue=iu(Pe(Ri()),U);typeof iu.unload=="function"&&ir.setTimeout&&setTimeout(iu.unload,911),Et(ue)}catch(we){Nt(we.message)}})},er.API)er.API.hasOwnProperty(Ta)&&(Ta==="events"&&er.API.events.length?function(U,it){var Et,Nt,ue;for(ue=it.length-1;ue!==-1;ue--)Et=it[ue][0],Nt=it[ue][1],U.subscribe.apply(U,[Et].concat(typeof Nt=="function"?[Nt]:Nt))}(Zt,er.API.events):k[Ta]=er.API[Ta]);var jo=k.getPageWidth=function(U){return(ht[U=U||bt].mediaBox.topRightX-ht[U].mediaBox.bottomLeftX)/We},ro=k.setPageWidth=function(U,it){ht[U].mediaBox.topRightX=it*We+ht[U].mediaBox.bottomLeftX},qo=k.getPageHeight=function(U){return(ht[U=U||bt].mediaBox.topRightY-ht[U].mediaBox.bottomLeftY)/We},ko=k.setPageHeight=function(U,it){ht[U].mediaBox.topRightY=it*We+ht[U].mediaBox.bottomLeftY};return k.internal={pdfEscape:Bt,getStyle:_n,getFont:qn,getFontSize:ze,getCharSpace:vc,getTextColor:bc,getLineHeight:pA,getLineHeightFactor:Fa,getLineWidth:lr,write:Li,getHorizontalCoordinate:io,getVerticalCoordinate:So,getCoordinateString:mA,getVerticalCoordinateString:Jo,collections:{},newObject:oi,newAdditionalObject:Qi,newObjectDeferred:ii,newObjectDeferredBegin:Ni,getFilters:fr,putStream:br,events:Zt,scaleFactor:We,pageSize:{getWidth:function(){return jo(bt)},setWidth:function(U){ro(bt,U)},getHeight:function(){return qo(bt)},setHeight:function(U){ko(bt,U)}},encryptionOptions:x,encryption:Fi,getEncryptor:Wi,output:Qe,getNumberOfPages:_e,pages:Re,out:Rt,f2:qt,f3:At,getPageInfo:nr,getPageInfoByObjId:ai,getCurrentPageInfo:dr,getPDFVersion:K,Point:Xo,Rectangle:La,Matrix:ce,hasHotfix:Ai},Object.defineProperty(k.internal.pageSize,"width",{get:function(){return jo(bt)},set:function(U){ro(bt,U)},enumerable:!0,configurable:!0}),Object.defineProperty(k.internal.pageSize,"height",{get:function(){return qo(bt)},set:function(U){ko(bt,U)},enumerable:!0,configurable:!0}),pt.call(k,Ee),Vi="F1",Yt(A,i),Zt.publish("initialized"),k}function G5(r){return r.reduce(function(t,i,s){return t[i]=s,t},{})}function My(r){var t=r.family.replace(/"|'/g,"").toLowerCase(),i=function(o){return R5[o=o||"normal"]?o:"normal"}(r.style),s=function(o){if(!o)return 400;if(typeof o=="number")return o>=100&&o<=900&&o%100==0?o:400;if(/^\d00$/.test(o))return parseInt(o);switch(o){case"bold":return 700;case"normal":default:return 400}}(r.weight),A=function(o){return typeof Py[o=o||"normal"]=="number"?o:"normal"}(r.stretch);return{family:t,style:i,weight:s,stretch:A,src:r.src||[],ref:r.ref||{name:t,style:[A,i,s].join(" ")}}}function l5(r,t,i,s){var A;for(A=i;A>=0&&A<t.length;A+=s)if(r[t[A]])return r[t[A]];for(A=i;A>=0&&A<t.length;A-=s)if(r[t[A]])return r[t[A]]}function u5(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function BD(r,t,i){for(var s=(i=i||{}).defaultFontFamily||"times",A=Object.assign({},wD,i.genericFontFamilies||{}),o=null,g=null,d=0;d<t.length;++d)if(A[(o=My(t[d])).family]&&(o.family=A[o.family]),r.hasOwnProperty(o.family)){g=r[o.family];break}if(!(g=g||r[s]))throw new Error("Could not find a font-family for the rule '"+u5(o)+"' and default family '"+s+"'.");if(g=function(C,v){if(v[C])return v[C];var x=Py[C],T=x<=Py.normal?-1:1,G=l5(v,H5,x,T);if(!G)throw new Error("Could not find a matching font-stretch value for "+C);return G}(o.stretch,g),g=function(C,v){if(v[C])return v[C];for(var x=R5[C],T=0;T<x.length;++T)if(v[x[T]])return v[x[T]];throw new Error("Could not find a matching font-style for "+C)}(o.style,g),!(g=function(C,v){if(v[C])return v[C];if(C===400&&v[500])return v[500];if(C===500&&v[400])return v[400];var x=vD[C],T=l5(v,Z5,x,C<400?-1:1);if(!T)throw new Error("Could not find a matching font-weight for value "+C);return T}(o.weight,g)))throw new Error("Failed to resolve a font for the rule '"+u5(o)+"'.");return g}function h5(r){return r.trimLeft()}function _D(r,t){for(var i=0;i<r.length;){if(r.charAt(i)===t)return[r.substring(0,i),r.substring(i+1)];i+=1}return null}function xD(r){var t=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],r.substring(t[0].length)]}function FD(r){var t=0;if(r[t++]!==71||r[t++]!==73||r[t++]!==70||r[t++]!==56||(r[t++]+1&253)!=56||r[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var i=r[t++]|r[t++]<<8,s=r[t++]|r[t++]<<8,A=r[t++],o=A>>7,g=1<<(7&A)+1;r[t++],r[t++];var d=null,C=null;o&&(d=t,C=g,t+=3*g);var v=!0,x=[],T=0,G=null,k=0,W=null;for(this.width=i,this.height=s;v&&t<r.length;)switch(r[t++]){case 33:switch(r[t++]){case 255:if(r[t]!==11||r[t+1]==78&&r[t+2]==69&&r[t+3]==84&&r[t+4]==83&&r[t+5]==67&&r[t+6]==65&&r[t+7]==80&&r[t+8]==69&&r[t+9]==50&&r[t+10]==46&&r[t+11]==48&&r[t+12]==3&&r[t+13]==1&&r[t+16]==0)t+=14,W=r[t++]|r[t++]<<8,t++;else for(t+=12;;){if(!((At=r[t++])>=0))throw Error("Invalid block size");if(At===0)break;t+=At}break;case 249:if(r[t++]!==4||r[t+4]!==0)throw new Error("Invalid graphics extension block.");var K=r[t++];T=r[t++]|r[t++]<<8,G=r[t++],!(1&K)&&(G=null),k=K>>2&7,t++;break;case 254:for(;;){if(!((At=r[t++])>=0))throw Error("Invalid block size");if(At===0)break;t+=At}break;default:throw new Error("Unknown graphic control label: 0x"+r[t-1].toString(16))}break;case 44:var $=r[t++]|r[t++]<<8,O=r[t++]|r[t++]<<8,tt=r[t++]|r[t++]<<8,at=r[t++]|r[t++]<<8,Lt=r[t++],Tt=Lt>>6&1,Qt=1<<(7&Lt)+1,Ft=d,vt=C,Jt=!1;Lt>>7&&(Jt=!0,Ft=t,vt=Qt,t+=3*Qt);var qt=t;for(t++;;){var At;if(!((At=r[t++])>=0))throw Error("Invalid block size");if(At===0)break;t+=At}x.push({x:$,y:O,width:tt,height:at,has_local_palette:Jt,palette_offset:Ft,palette_size:vt,data_offset:qt,data_length:t-qt,transparent_index:G,interlaced:!!Tt,delay:T,disposal:k});break;case 59:v=!1;break;default:throw new Error("Unknown gif block: 0x"+r[t-1].toString(16))}this.numFrames=function(){return x.length},this.loopCount=function(){return W},this.frameInfo=function(lt){if(lt<0||lt>=x.length)throw new Error("Frame index out of range.");return x[lt]},this.decodeAndBlitFrameBGRA=function(lt,kt){var _t=this.frameInfo(lt),le=_t.width*_t.height,ie=new Uint8Array(le);I5(r,_t.data_offset,ie,le);var ne=_t.palette_offset,te=_t.transparent_index;te===null&&(te=256);var wt=_t.width,Ut=i-wt,fe=wt,j=4*(_t.y*i+_t.x),bt=4*((_t.y+_t.height)*i+_t.x),It=j,Ht=4*Ut;_t.interlaced===!0&&(Ht+=4*i*7);for(var Ot=8,Ae=0,he=ie.length;Ae<he;++Ae){var de=ie[Ae];if(fe===0&&(fe=wt,(It+=Ht)>=bt&&(Ht=4*Ut+4*i*(Ot-1),It=j+(wt+Ut)*(Ot<<1),Ot>>=1)),de===te)It+=4;else{var He=r[ne+3*de],Re=r[ne+3*de+1],je=r[ne+3*de+2];kt[It++]=je,kt[It++]=Re,kt[It++]=He,kt[It++]=255}--fe}},this.decodeAndBlitFrameRGBA=function(lt,kt){var _t=this.frameInfo(lt),le=_t.width*_t.height,ie=new Uint8Array(le);I5(r,_t.data_offset,ie,le);var ne=_t.palette_offset,te=_t.transparent_index;te===null&&(te=256);var wt=_t.width,Ut=i-wt,fe=wt,j=4*(_t.y*i+_t.x),bt=4*((_t.y+_t.height)*i+_t.x),It=j,Ht=4*Ut;_t.interlaced===!0&&(Ht+=4*i*7);for(var Ot=8,Ae=0,he=ie.length;Ae<he;++Ae){var de=ie[Ae];if(fe===0&&(fe=wt,(It+=Ht)>=bt&&(Ht=4*Ut+4*i*(Ot-1),It=j+(wt+Ut)*(Ot<<1),Ot>>=1)),de===te)It+=4;else{var He=r[ne+3*de],Re=r[ne+3*de+1],je=r[ne+3*de+2];kt[It++]=He,kt[It++]=Re,kt[It++]=je,kt[It++]=255}--fe}}}function I5(r,t,i,s){for(var A=r[t++],o=1<<A,g=o+1,d=g+1,C=A+1,v=(1<<C)-1,x=0,T=0,G=0,k=r[t++],W=new Int32Array(4096),K=null;;){for(;x<16&&k!==0;)T|=r[t++]<<x,x+=8,k===1?k=r[t++]:--k;if(x<C)break;var $=T&v;if(T>>=C,x-=C,$!==o){if($===g)break;for(var O=$<d?$:K,tt=0,at=O;at>o;)at=W[at]>>8,++tt;var Lt=at;if(G+tt+(O!==$?1:0)>s)return void sn.log("Warning, gif stream longer than expected.");i[G++]=Lt;var Tt=G+=tt;for(O!==$&&(i[G++]=Lt),at=O;tt--;)at=W[at],i[--Tt]=255&at,at>>=8;K!==null&&d<4096&&(W[d++]=K<<8|Lt,d>=v+1&&C<12&&(++C,v=v<<1|1)),K=$}else d=g+1,v=(1<<(C=A+1))-1,K=null}return G!==s&&sn.log("Warning, gif stream shorter than expected."),i}function ky(r){var t,i,s,A,o,g=Math.floor,d=new Array(64),C=new Array(64),v=new Array(64),x=new Array(64),T=new Array(65535),G=new Array(65535),k=new Array(64),W=new Array(64),K=[],$=0,O=7,tt=new Array(64),at=new Array(64),Lt=new Array(64),Tt=new Array(256),Qt=new Array(2048),Ft=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],vt=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Jt=[0,1,2,3,4,5,6,7,8,9,10,11],qt=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],At=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],lt=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],kt=[0,1,2,3,4,5,6,7,8,9,10,11],_t=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],le=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ie(j,bt){for(var It=0,Ht=0,Ot=new Array,Ae=1;Ae<=16;Ae++){for(var he=1;he<=j[Ae];he++)Ot[bt[Ht]]=[],Ot[bt[Ht]][0]=It,Ot[bt[Ht]][1]=Ae,Ht++,It++;It*=2}return Ot}function ne(j){for(var bt=j[0],It=j[1]-1;It>=0;)bt&1<<It&&($|=1<<O),It--,--O<0&&($==255?(te(255),te(0)):te($),O=7,$=0)}function te(j){K.push(j)}function wt(j){te(j>>8&255),te(255&j)}function Ut(j,bt,It,Ht,Ot){for(var Ae,he=Ot[0],de=Ot[240],He=function(Ee,Ne){var Je,ze,ui,hi,Ei,Pi,Ie,Oi,mi,Vi,We=0;for(mi=0;mi<8;++mi){Je=Ee[We],ze=Ee[We+1],ui=Ee[We+2],hi=Ee[We+3],Ei=Ee[We+4],Pi=Ee[We+5],Ie=Ee[We+6];var Se=Je+(Oi=Ee[We+7]),$e=Je-Oi,di=ze+Ie,Zi=ze-Ie,qi=ui+Pi,vi=ui-Pi,tr=hi+Ei,Lr=hi-Ei,ft=Se+tr,Y=Se-tr,q=di+qi,rt=di-qi;Ee[We]=ft+q,Ee[We+4]=ft-q;var ht=.707106781*(rt+Y);Ee[We+2]=Y+ht,Ee[We+6]=Y-ht;var Zt=.382683433*((ft=Lr+vi)-(rt=Zi+$e)),zt=.5411961*ft+Zt,Xt=1.306562965*rt+Zt,Mt=.707106781*(q=vi+Zi),re=$e+Mt,ce=$e-Mt;Ee[We+5]=ce+zt,Ee[We+3]=ce-zt,Ee[We+1]=re+Xt,Ee[We+7]=re-Xt,We+=8}for(We=0,mi=0;mi<8;++mi){Je=Ee[We],ze=Ee[We+8],ui=Ee[We+16],hi=Ee[We+24],Ei=Ee[We+32],Pi=Ee[We+40],Ie=Ee[We+48];var pe=Je+(Oi=Ee[We+56]),me=Je-Oi,Xe=ze+Ie,oi=ze-Ie,ii=ui+Pi,Ni=ui-Pi,Qi=hi+Ei,rr=hi-Ei,zi=pe+Qi,Cr=pe-Qi,ki=Xe+ii,fr=Xe-ii;Ee[We]=zi+ki,Ee[We+32]=zi-ki;var br=.707106781*(fr+Cr);Ee[We+16]=Cr+br,Ee[We+48]=Cr-br;var Tr=.382683433*((zi=rr+Ni)-(fr=oi+me)),Dt=.5411961*zi+Tr,Ke=1.306562965*fr+Tr,Te=.707106781*(ki=Ni+oi),or=me+Te,Er=me-Te;Ee[We+40]=Er+Dt,Ee[We+24]=Er-Dt,Ee[We+8]=or+Ke,Ee[We+56]=or-Ke,We++}for(mi=0;mi<64;++mi)Vi=Ee[mi]*Ne[mi],k[mi]=Vi>0?Vi+.5|0:Vi-.5|0;return k}(j,bt),Re=0;Re<64;++Re)W[Ft[Re]]=He[Re];var je=W[0]-It;It=W[0],je==0?ne(Ht[0]):(ne(Ht[G[Ae=32767+je]]),ne(T[Ae]));for(var Me=63;Me>0&&W[Me]==0;)Me--;if(Me==0)return ne(he),It;for(var gi,xt=1;xt<=Me;){for(var Rt=xt;W[xt]==0&&xt<=Me;)++xt;var Li=xt-Rt;if(Li>=16){gi=Li>>4;for(var Ue=1;Ue<=gi;++Ue)ne(de);Li&=15}Ae=32767+W[xt],ne(Ot[(Li<<4)+G[Ae]]),ne(T[Ae]),xt++}return Me!=63&&ne(he),It}function fe(j){j=Math.min(Math.max(j,1),100),o!=j&&(function(bt){for(var It=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ht=0;Ht<64;Ht++){var Ot=g((It[Ht]*bt+50)/100);Ot=Math.min(Math.max(Ot,1),255),d[Ft[Ht]]=Ot}for(var Ae=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],he=0;he<64;he++){var de=g((Ae[he]*bt+50)/100);de=Math.min(Math.max(de,1),255),C[Ft[he]]=de}for(var He=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Re=0,je=0;je<8;je++)for(var Me=0;Me<8;Me++)v[Re]=1/(d[Ft[Re]]*He[je]*He[Me]*8),x[Re]=1/(C[Ft[Re]]*He[je]*He[Me]*8),Re++}(j<50?Math.floor(5e3/j):Math.floor(200-2*j)),o=j)}this.encode=function(j,bt){bt&&fe(bt),K=new Array,$=0,O=7,wt(65496),wt(65504),wt(16),te(74),te(70),te(73),te(70),te(0),te(1),te(1),te(0),wt(1),wt(1),te(0),te(0),function(){wt(65499),wt(132),te(0);for(var ze=0;ze<64;ze++)te(d[ze]);te(1);for(var ui=0;ui<64;ui++)te(C[ui])}(),function(ze,ui){wt(65472),wt(17),te(8),wt(ui),wt(ze),te(3),te(1),te(17),te(0),te(2),te(17),te(1),te(3),te(17),te(1)}(j.width,j.height),function(){wt(65476),wt(418),te(0);for(var ze=0;ze<16;ze++)te(vt[ze+1]);for(var ui=0;ui<=11;ui++)te(Jt[ui]);te(16);for(var hi=0;hi<16;hi++)te(qt[hi+1]);for(var Ei=0;Ei<=161;Ei++)te(At[Ei]);te(1);for(var Pi=0;Pi<16;Pi++)te(lt[Pi+1]);for(var Ie=0;Ie<=11;Ie++)te(kt[Ie]);te(17);for(var Oi=0;Oi<16;Oi++)te(_t[Oi+1]);for(var mi=0;mi<=161;mi++)te(le[mi])}(),wt(65498),wt(12),te(3),te(1),te(0),te(2),te(17),te(3),te(17),te(0),te(63),te(0);var It=0,Ht=0,Ot=0;$=0,O=7,this.encode.displayName="_encode_";for(var Ae,he,de,He,Re,je,Me,gi,xt,Rt=j.data,Li=j.width,Ue=j.height,Ee=4*Li,Ne=0;Ne<Ue;){for(Ae=0;Ae<Ee;){for(Re=Ee*Ne+Ae,Me=-1,gi=0,xt=0;xt<64;xt++)je=Re+(gi=xt>>3)*Ee+(Me=4*(7&xt)),Ne+gi>=Ue&&(je-=Ee*(Ne+1+gi-Ue)),Ae+Me>=Ee&&(je-=Ae+Me-Ee+4),he=Rt[je++],de=Rt[je++],He=Rt[je++],tt[xt]=(Qt[he]+Qt[de+256>>0]+Qt[He+512>>0]>>16)-128,at[xt]=(Qt[he+768>>0]+Qt[de+1024>>0]+Qt[He+1280>>0]>>16)-128,Lt[xt]=(Qt[he+1280>>0]+Qt[de+1536>>0]+Qt[He+1792>>0]>>16)-128;It=Ut(tt,v,It,t,s),Ht=Ut(at,x,Ht,i,A),Ot=Ut(Lt,x,Ot,i,A),Ae+=32}Ne+=8}if(O>=0){var Je=[];Je[1]=O+1,Je[0]=(1<<O+1)-1,ne(Je)}return wt(65497),new Uint8Array(K)},r=r||50,function(){for(var j=String.fromCharCode,bt=0;bt<256;bt++)Tt[bt]=j(bt)}(),t=ie(vt,Jt),i=ie(lt,kt),s=ie(qt,At),A=ie(_t,le),function(){for(var j=1,bt=2,It=1;It<=15;It++){for(var Ht=j;Ht<bt;Ht++)G[32767+Ht]=It,T[32767+Ht]=[],T[32767+Ht][1]=It,T[32767+Ht][0]=Ht;for(var Ot=-(bt-1);Ot<=-j;Ot++)G[32767+Ot]=It,T[32767+Ot]=[],T[32767+Ot][1]=It,T[32767+Ot][0]=bt-1+Ot;j<<=1,bt<<=1}}(),function(){for(var j=0;j<256;j++)Qt[j]=19595*j,Qt[j+256>>0]=38470*j,Qt[j+512>>0]=7471*j+32768,Qt[j+768>>0]=-11059*j,Qt[j+1024>>0]=-21709*j,Qt[j+1280>>0]=32768*j+8421375,Qt[j+1536>>0]=-27439*j,Qt[j+1792>>0]=-5329*j}(),fe(r)}function hA(r,t){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function y5(r){function t(vt){if(!vt)throw Error("assert :P")}function i(vt,Jt,qt){for(var At=0;4>At;At++)if(vt[Jt+At]!=qt.charCodeAt(At))return!0;return!1}function s(vt,Jt,qt,At,lt){for(var kt=0;kt<lt;kt++)vt[Jt+kt]=qt[At+kt]}function A(vt,Jt,qt,At){for(var lt=0;lt<At;lt++)vt[Jt+lt]=qt}function o(vt){return new Int32Array(vt)}function g(vt,Jt){for(var qt=[],At=0;At<vt;At++)qt.push(new Jt);return qt}function d(vt,Jt){var qt=[];return function At(lt,kt,_t){for(var le=_t[kt],ie=0;ie<le&&(lt.push(_t.length>kt+1?[]:new Jt),!(_t.length<kt+1));ie++)At(lt[ie],kt+1,_t)}(qt,0,vt),qt}var C=function(){var vt=this;function Jt(h,I){for(var _=1<<I-1>>>0;h&_;)_>>>=1;return _?(h&_-1)+_:h}function qt(h,I,_,F,R){t(!(F%_));do h[I+(F-=_)]=R;while(0<F)}function At(h,I,_,F,R){if(t(2328>=R),512>=R)var Z=o(512);else if((Z=o(R))==null)return 0;return function(N,P,V,X,J,ot){var dt,ut,Gt=P,Pt=1<<V,gt=o(16),Ct=o(16);for(t(J!=0),t(X!=null),t(N!=null),t(0<V),ut=0;ut<J;++ut){if(15<X[ut])return 0;++gt[X[ut]]}if(gt[0]==J)return 0;for(Ct[1]=0,dt=1;15>dt;++dt){if(gt[dt]>1<<dt)return 0;Ct[dt+1]=Ct[dt]+gt[dt]}for(ut=0;ut<J;++ut)dt=X[ut],0<X[ut]&&(ot[Ct[dt]++]=ut);if(Ct[15]==1)return(X=new lt).g=0,X.value=ot[0],qt(N,Gt,1,Pt,X),Pt;var ee,ge=-1,jt=Pt-1,Fe=0,ke=1,Ye=1,xe=1<<V;for(ut=0,dt=1,J=2;dt<=V;++dt,J<<=1){if(ke+=Ye<<=1,0>(Ye-=gt[dt]))return 0;for(;0<gt[dt];--gt[dt])(X=new lt).g=dt,X.value=ot[ut++],qt(N,Gt+Fe,J,xe,X),Fe=Jt(Fe,dt)}for(dt=V+1,J=2;15>=dt;++dt,J<<=1){if(ke+=Ye<<=1,0>(Ye-=gt[dt]))return 0;for(;0<gt[dt];--gt[dt]){if(X=new lt,(Fe&jt)!=ge){for(Gt+=xe,ee=1<<(ge=dt)-V;15>ge&&!(0>=(ee-=gt[ge]));)++ge,ee<<=1;Pt+=xe=1<<(ee=ge-V),N[P+(ge=Fe&jt)].g=ee+V,N[P+ge].value=Gt-P-ge}X.g=dt-V,X.value=ot[ut++],qt(N,Gt+(Fe>>V),J,xe,X),Fe=Jt(Fe,dt)}}return ke!=2*Ct[15]-1?0:Pt}(h,I,_,F,R,Z)}function lt(){this.value=this.g=0}function kt(){this.value=this.g=0}function _t(){this.G=g(5,lt),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=g(ts,kt)}function le(h,I,_,F){t(h!=null),t(I!=null),t(2147483648>F),h.Ca=254,h.I=0,h.b=-8,h.Ka=0,h.oa=I,h.pa=_,h.Jd=I,h.Yc=_+F,h.Zc=4<=F?_+F-4+1:_,Ae(h)}function ie(h,I){for(var _=0;0<I--;)_|=de(h,128)<<I;return _}function ne(h,I){var _=ie(h,I);return he(h)?-_:_}function te(h,I,_,F){var R,Z=0;for(t(h!=null),t(I!=null),t(4294967288>F),h.Sb=F,h.Ra=0,h.u=0,h.h=0,4<F&&(F=4),R=0;R<F;++R)Z+=I[_+R]<<8*R;h.Ra=Z,h.bb=F,h.oa=I,h.pa=_}function wt(h){for(;8<=h.u&&h.bb<h.Sb;)h.Ra>>>=8,h.Ra+=h.oa[h.pa+h.bb]<<pa-8>>>0,++h.bb,h.u-=8;It(h)&&(h.h=1,h.u=0)}function Ut(h,I){if(t(0<=I),!h.h&&I<=$o){var _=bt(h)&Ga[I];return h.u+=I,wt(h),_}return h.h=1,h.u=0}function fe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function bt(h){return h.Ra>>>(h.u&pa-1)>>>0}function It(h){return t(h.bb<=h.Sb),h.h||h.bb==h.Sb&&h.u>pa}function Ht(h,I){h.u=I,h.h=It(h)}function Ot(h){h.u>=nl&&(t(h.u>=nl),wt(h))}function Ae(h){t(h!=null&&h.oa!=null),h.pa<h.Zc?(h.I=(h.oa[h.pa++]|h.I<<8)>>>0,h.b+=8):(t(h!=null&&h.oa!=null),h.pa<h.Yc?(h.b+=8,h.I=h.oa[h.pa++]|h.I<<8):h.Ka?h.b=0:(h.I<<=8,h.b+=8,h.Ka=1))}function he(h){return ie(h,1)}function de(h,I){var _=h.Ca;0>h.b&&Ae(h);var F=h.b,R=_*I>>>8,Z=(h.I>>>F>R)+0;for(Z?(_-=R,h.I-=R+1<<F>>>0):_=R+1,F=_,R=0;256<=F;)R+=8,F>>=8;return F=7^R+es[F],h.b-=F,h.Ca=(_<<F)-1,Z}function He(h,I,_){h[I+0]=_>>24&255,h[I+1]=_>>16&255,h[I+2]=_>>8&255,h[I+3]=_>>0&255}function Re(h,I){return h[I+0]<<0|h[I+1]<<8}function je(h,I){return Re(h,I)|h[I+2]<<16}function Me(h,I){return Re(h,I)|Re(h,I+2)<<16}function gi(h,I){var _=1<<I;return t(h!=null),t(0<I),h.X=o(_),h.X==null?0:(h.Mb=32-I,h.Xa=I,1)}function xt(h,I){t(h!=null),t(I!=null),t(h.Xa==I.Xa),s(I.X,0,h.X,0,1<<I.Xa)}function Rt(){this.X=[],this.Xa=this.Mb=0}function Li(h,I,_,F){t(_!=null),t(F!=null);var R=_[0],Z=F[0];return R==0&&(R=(h*Z+I/2)/I),Z==0&&(Z=(I*R+h/2)/h),0>=R||0>=Z?0:(_[0]=R,F[0]=Z,1)}function Ue(h,I){return h+(1<<I)-1>>>I}function Ee(h,I){return((4278255360&h)+(4278255360&I)>>>0&4278255360)+((16711935&h)+(16711935&I)>>>0&16711935)>>>0}function Ne(h,I){vt[I]=function(_,F,R,Z,N,P,V){var X;for(X=0;X<N;++X){var J=vt[h](P[V+X-1],R,Z+X);P[V+X]=Ee(_[F+X],J)}}}function Je(){this.ud=this.hd=this.jd=0}function ze(h,I){return((4278124286&(h^I))>>>1)+(h&I)>>>0}function ui(h){return 0<=h&&256>h?h:0>h?0:255<h?255:void 0}function hi(h,I){return ui(h+(h-I+.5>>1))}function Ei(h,I,_){return Math.abs(I-_)-Math.abs(h-_)}function Pi(h,I,_,F,R,Z,N){for(F=Z[N-1],_=0;_<R;++_)Z[N+_]=F=Ee(h[I+_],F)}function Ie(h,I,_,F,R){var Z;for(Z=0;Z<_;++Z){var N=h[I+Z],P=N>>8&255,V=16711935&(V=(V=16711935&N)+((P<<16)+P));F[R+Z]=(4278255360&N)+V>>>0}}function Oi(h,I){I.jd=h>>0&255,I.hd=h>>8&255,I.ud=h>>16&255}function mi(h,I,_,F,R,Z){var N;for(N=0;N<F;++N){var P=I[_+N],V=P>>>8,X=P,J=255&(J=(J=P>>>16)+((h.jd<<24>>24)*(V<<24>>24)>>>5));X=255&(X=(X=X+((h.hd<<24>>24)*(V<<24>>24)>>>5))+((h.ud<<24>>24)*(J<<24>>24)>>>5)),R[Z+N]=(4278255360&P)+(J<<16)+X}}function Vi(h,I,_,F,R){vt[I]=function(Z,N,P,V,X,J,ot,dt,ut){for(V=ot;V<dt;++V)for(ot=0;ot<ut;++ot)X[J++]=R(P[F(Z[N++])])},vt[h]=function(Z,N,P,V,X,J,ot){var dt=8>>Z.b,ut=Z.Ea,Gt=Z.K[0],Pt=Z.w;if(8>dt)for(Z=(1<<Z.b)-1,Pt=(1<<dt)-1;N<P;++N){var gt,Ct=0;for(gt=0;gt<ut;++gt)gt&Z||(Ct=F(V[X++])),J[ot++]=R(Gt[Ct&Pt]),Ct>>=dt}else vt["VP8LMapColor"+_](V,X,Gt,Pt,J,ot,N,P,ut)}}function We(h,I,_,F,R){for(_=I+_;I<_;){var Z=h[I++];F[R++]=Z>>16&255,F[R++]=Z>>8&255,F[R++]=Z>>0&255}}function Se(h,I,_,F,R){for(_=I+_;I<_;){var Z=h[I++];F[R++]=Z>>16&255,F[R++]=Z>>8&255,F[R++]=Z>>0&255,F[R++]=Z>>24&255}}function $e(h,I,_,F,R){for(_=I+_;I<_;){var Z=(N=h[I++])>>16&240|N>>12&15,N=N>>0&240|N>>28&15;F[R++]=Z,F[R++]=N}}function di(h,I,_,F,R){for(_=I+_;I<_;){var Z=(N=h[I++])>>16&248|N>>13&7,N=N>>5&224|N>>3&31;F[R++]=Z,F[R++]=N}}function Zi(h,I,_,F,R){for(_=I+_;I<_;){var Z=h[I++];F[R++]=Z>>0&255,F[R++]=Z>>8&255,F[R++]=Z>>16&255}}function qi(h,I,_,F,R,Z){if(Z==0)for(_=I+_;I<_;)He(F,((Z=h[I++])[0]>>24|Z[1]>>8&65280|Z[2]<<8&16711680|Z[3]<<24)>>>0),R+=32;else s(F,R,h,I,_)}function vi(h,I){vt[I][0]=vt[h+"0"],vt[I][1]=vt[h+"1"],vt[I][2]=vt[h+"2"],vt[I][3]=vt[h+"3"],vt[I][4]=vt[h+"4"],vt[I][5]=vt[h+"5"],vt[I][6]=vt[h+"6"],vt[I][7]=vt[h+"7"],vt[I][8]=vt[h+"8"],vt[I][9]=vt[h+"9"],vt[I][10]=vt[h+"10"],vt[I][11]=vt[h+"11"],vt[I][12]=vt[h+"12"],vt[I][13]=vt[h+"13"],vt[I][14]=vt[h+"0"],vt[I][15]=vt[h+"0"]}function tr(h){return h==_A||h==Al||h==xA||h==Rl}function Lr(){this.eb=[],this.size=this.A=this.fb=0}function ft(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Y(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Lr,this.f.kb=new ft,this.sd=null}function q(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function rt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ht(h){return alert("todo:WebPSamplerProcessPlane"),h.T}function Zt(h,I){var _=h.T,F=I.ba.f.RGBA,R=F.eb,Z=F.fb+h.ka*F.A,N=hs[I.ba.S],P=h.y,V=h.O,X=h.f,J=h.N,ot=h.ea,dt=h.W,ut=I.cc,Gt=I.dc,Pt=I.Mc,gt=I.Nc,Ct=h.ka,ee=h.ka+h.T,ge=h.U,jt=ge+1>>1;for(Ct==0?N(P,V,null,null,X,J,ot,dt,X,J,ot,dt,R,Z,null,null,ge):(N(I.ec,I.fc,P,V,ut,Gt,Pt,gt,X,J,ot,dt,R,Z-F.A,R,Z,ge),++_);Ct+2<ee;Ct+=2)ut=X,Gt=J,Pt=ot,gt=dt,J+=h.Rc,dt+=h.Rc,Z+=2*F.A,N(P,(V+=2*h.fa)-h.fa,P,V,ut,Gt,Pt,gt,X,J,ot,dt,R,Z-F.A,R,Z,ge);return V+=h.fa,h.j+ee<h.o?(s(I.ec,I.fc,P,V,ge),s(I.cc,I.dc,X,J,jt),s(I.Mc,I.Nc,ot,dt,jt),_--):1&ee||N(P,V,null,null,X,J,ot,dt,X,J,ot,dt,R,Z+F.A,null,null,ge),_}function zt(h,I,_){var F=h.F,R=[h.J];if(F!=null){var Z=h.U,N=I.ba.S,P=N==Go||N==xA;I=I.ba.f.RGBA;var V=[0],X=h.ka;V[0]=h.T,h.Kb&&(X==0?--V[0]:(--X,R[0]-=h.width),h.j+h.ka+h.T==h.o&&(V[0]=h.o-h.j-X));var J=I.eb;X=I.fb+X*I.A,h=ao(F,R[0],h.width,Z,V,J,X+(P?0:3),I.A),t(_==V),h&&tr(N)&&ea(J,X,P,Z,V,I.A)}return 0}function Xt(h){var I=h.ma,_=I.ba.S,F=11>_,R=_==BA||_==ol||_==Go||_==Hr||_==12||tr(_);if(I.memory=null,I.Ib=null,I.Jb=null,I.Nd=null,!Ua(I.Oa,h,R?11:12))return 0;if(R&&tr(_)&&Ve(),h.da)alert("todo:use_scaling");else{if(F){if(I.Ib=ht,h.Kb){if(_=h.U+1>>1,I.memory=o(h.U+2*_),I.memory==null)return 0;I.ec=I.memory,I.fc=0,I.cc=I.ec,I.dc=I.fc+h.U,I.Mc=I.cc,I.Nc=I.dc+_,I.Ib=Zt,Ve()}}else alert("todo:EmitYUV");R&&(I.Jb=zt,F&&ue())}if(F&&!Ml){for(h=0;256>h;++h)Sc[h]=89858*(h-128)+uo>>ra,n[h]=-22014*(h-128)+uo,y[h]=-45773*(h-128),Au[h]=113618*(h-128)+uo>>ra;for(h=Da;h<LA;++h)I=76283*(h-16)+uo>>ra,c[h-Da]=$n(I,255),p[h-Da]=$n(I+8>>4,15);Ml=1}return 1}function Mt(h){var I=h.ma,_=h.U,F=h.T;return t(!(1&h.ka)),0>=_||0>=F?0:(_=I.Ib(h,I),I.Jb!=null&&I.Jb(h,I,_),I.Dc+=_,1)}function re(h){h.ma.memory=null}function ce(h,I,_,F){return Ut(h,8)!=47?0:(I[0]=Ut(h,14)+1,_[0]=Ut(h,14)+1,F[0]=Ut(h,1),Ut(h,3)!=0?0:!h.h)}function pe(h,I){if(4>h)return h+1;var _=h-2>>1;return(2+(1&h)<<_)+Ut(I,_)+1}function me(h,I){return 120<I?I-120:1<=(_=((_=Na[I-1])>>4)*h+(8-(15&_)))?_:1;var _}function Xe(h,I,_){var F=bt(_),R=h[I+=255&F].g-8;return 0<R&&(Ht(_,_.u+8),F=bt(_),I+=h[I].value,I+=F&(1<<R)-1),Ht(_,_.u+h[I].g),h[I].value}function oi(h,I,_){return _.g+=h.g,_.value+=h.value<<I>>>0,t(8>=_.g),h.g}function ii(h,I,_){var F=h.xc;return t((I=F==0?0:h.vc[h.md*(_>>F)+(I>>F)])<h.Wb),h.Ya[I]}function Ni(h,I,_,F){var R=h.ab,Z=h.c*I,N=h.C;I=N+I;var P=_,V=F;for(F=h.Ta,_=h.Ua;0<R--;){var X=h.gc[R],J=N,ot=I,dt=P,ut=V,Gt=(V=F,P=_,X.Ea);switch(t(J<ot),t(ot<=X.nc),X.hc){case 2:Wn(dt,ut,(ot-J)*Gt,V,P);break;case 0:var Pt=J,gt=ot,Ct=V,ee=P,ge=(xe=X).Ea;Pt==0&&(zr(dt,ut,null,null,1,Ct,ee),Pi(dt,ut+1,0,0,ge-1,Ct,ee+1),ut+=ge,ee+=ge,++Pt);for(var jt=1<<xe.b,Fe=jt-1,ke=Ue(ge,xe.b),Ye=xe.K,xe=xe.w+(Pt>>xe.b)*ke;Pt<gt;){var ci=Ye,pi=xe,Mi=1;for(Ps(dt,ut,Ct,ee-ge,1,Ct,ee);Mi<ge;){var Si=(Mi&~Fe)+jt;Si>ge&&(Si=ge),(0,ls[ci[pi++]>>8&15])(dt,ut+ +Mi,Ct,ee+Mi-ge,Si-Mi,Ct,ee+Mi),Mi=Si}ut+=ge,ee+=ge,++Pt&Fe||(xe+=ke)}ot!=X.nc&&s(V,P-Gt,V,P+(ot-J-1)*Gt,Gt);break;case 1:for(Gt=dt,gt=ut,ge=(dt=X.Ea)-(ee=dt&~(Ct=(ut=1<<X.b)-1)),Pt=Ue(dt,X.b),jt=X.K,X=X.w+(J>>X.b)*Pt;J<ot;){for(Fe=jt,ke=X,Ye=new Je,xe=gt+ee,ci=gt+dt;gt<xe;)Oi(Fe[ke++],Ye),xn(Ye,Gt,gt,ut,V,P),gt+=ut,P+=ut;gt<ci&&(Oi(Fe[ke++],Ye),xn(Ye,Gt,gt,ge,V,P),gt+=ge,P+=ge),++J&Ct||(X+=Pt)}break;case 3:if(dt==V&&ut==P&&0<X.b){for(gt=V,dt=Gt=P+(ot-J)*Gt-(ee=(ot-J)*Ue(X.Ea,X.b)),ut=V,Ct=P,Pt=[],ee=(ge=ee)-1;0<=ee;--ee)Pt[ee]=ut[Ct+ee];for(ee=ge-1;0<=ee;--ee)gt[dt+ee]=Pt[ee];On(X,J,ot,V,Gt,V,P)}else On(X,J,ot,dt,ut,V,P)}P=F,V=_}V!=_&&s(F,_,P,V,Z)}function Qi(h,I){var _=h.V,F=h.Ba+h.c*h.C,R=I-h.C;if(t(I<=h.l.o),t(16>=R),0<R){var Z=h.l,N=h.Ta,P=h.Ua,V=Z.width;if(Ni(h,R,_,F),R=P=[P],t((_=h.C)<(F=I)),t(Z.v<Z.va),F>Z.o&&(F=Z.o),_<Z.j){var X=Z.j-_;_=Z.j,R[0]+=X*V}if(_>=F?_=0:(R[0]+=4*Z.v,Z.ka=_-Z.j,Z.U=Z.va-Z.v,Z.T=F-_,_=1),_){if(P=P[0],11>(_=h.ca).S){var J=_.f.RGBA,ot=(F=_.S,R=Z.U,Z=Z.T,X=J.eb,J.A),dt=Z;for(J=J.fb+h.Ma*J.A;0<dt--;){var ut=N,Gt=P,Pt=R,gt=X,Ct=J;switch(F){case wA:is(ut,Gt,Pt,gt,Ct);break;case BA:Eo(ut,Gt,Pt,gt,Ct);break;case _A:Eo(ut,Gt,Pt,gt,Ct),ea(gt,Ct,0,Pt,1,0);break;case Gl:ma(ut,Gt,Pt,gt,Ct);break;case ol:qi(ut,Gt,Pt,gt,Ct,1);break;case Al:qi(ut,Gt,Pt,gt,Ct,1),ea(gt,Ct,0,Pt,1,0);break;case Go:qi(ut,Gt,Pt,gt,Ct,0);break;case xA:qi(ut,Gt,Pt,gt,Ct,0),ea(gt,Ct,1,Pt,1,0);break;case Hr:_s(ut,Gt,Pt,gt,Ct);break;case Rl:_s(ut,Gt,Pt,gt,Ct),cs(gt,Ct,Pt,1,0);break;case al:no(ut,Gt,Pt,gt,Ct);break;default:t(0)}P+=V,J+=ot}h.Ma+=Z}else alert("todo:EmitRescaledRowsYUVA");t(h.Ma<=_.height)}}h.C=I,t(h.C<=h.i)}function rr(h){var I;if(0<h.ua)return 0;for(I=0;I<h.Wb;++I){var _=h.Ya[I].G,F=h.Ya[I].H;if(0<_[1][F[1]+0].g||0<_[2][F[2]+0].g||0<_[3][F[3]+0].g)return 0}return 1}function zi(h,I,_,F,R,Z){if(h.Z!=0){var N=h.qd,P=h.rd;for(t(co[h.Z]!=null);I<_;++I)co[h.Z](N,P,F,R,F,R,Z),N=F,P=R,R+=Z;h.qd=N,h.rd=P}}function Cr(h,I){var _=h.l.ma,F=_.Z==0||_.Z==1?h.l.j:h.C;if(F=h.C<F?F:h.C,t(I<=h.l.o),I>F){var R=h.l.width,Z=_.ca,N=_.tb+R*F,P=h.V,V=h.Ba+h.c*F,X=h.gc;t(h.ab==1),t(X[0].hc==3),sl(X[0],F,I,P,V,Z,N),zi(_,F,I,Z,N,R)}h.C=h.Ma=I}function ki(h,I,_,F,R,Z,N){var P=h.$/F,V=h.$%F,X=h.m,J=h.s,ot=_+h.$,dt=ot;R=_+F*R;var ut=_+F*Z,Gt=280+J.ua,Pt=h.Pb?P:16777216,gt=0<J.ua?J.Wa:null,Ct=J.wc,ee=ot<ut?ii(J,V,P):null;t(h.C<Z),t(ut<=R);var ge=!1;t:for(;;){for(;ge||ot<ut;){var jt=0;if(P>=Pt){var Fe=ot-_;t((Pt=h).Pb),Pt.wd=Pt.m,Pt.xd=Fe,0<Pt.s.ua&&xt(Pt.s.Wa,Pt.s.vb),Pt=P+ll}if(V&Ct||(ee=ii(J,V,P)),t(ee!=null),ee.Qb&&(I[ot]=ee.qb,ge=!0),!ge)if(Ot(X),ee.jc){jt=X,Fe=I;var ke=ot,Ye=ee.pd[bt(jt)&ts-1];t(ee.jc),256>Ye.g?(Ht(jt,jt.u+Ye.g),Fe[ke]=Ye.value,jt=0):(Ht(jt,jt.u+Ye.g-256),t(256<=Ye.value),jt=Ye.value),jt==0&&(ge=!0)}else jt=Xe(ee.G[0],ee.H[0],X);if(X.h)break;if(ge||256>jt){if(!ge)if(ee.nd)I[ot]=(ee.qb|jt<<8)>>>0;else{if(Ot(X),ge=Xe(ee.G[1],ee.H[1],X),Ot(X),Fe=Xe(ee.G[2],ee.H[2],X),ke=Xe(ee.G[3],ee.H[3],X),X.h)break;I[ot]=(ke<<24|ge<<16|jt<<8|Fe)>>>0}if(ge=!1,++ot,++V>=F&&(V=0,++P,N!=null&&P<=Z&&!(P%16)&&N(h,P),gt!=null))for(;dt<ot;)jt=I[dt++],gt.X[(506832829*jt&4294967295)>>>gt.Mb]=jt}else if(280>jt){if(jt=pe(jt-256,X),Fe=Xe(ee.G[4],ee.H[4],X),Ot(X),Fe=me(F,Fe=pe(Fe,X)),X.h)break;if(ot-_<Fe||R-ot<jt)break t;for(ke=0;ke<jt;++ke)I[ot+ke]=I[ot+ke-Fe];for(ot+=jt,V+=jt;V>=F;)V-=F,++P,N!=null&&P<=Z&&!(P%16)&&N(h,P);if(t(ot<=R),V&Ct&&(ee=ii(J,V,P)),gt!=null)for(;dt<ot;)jt=I[dt++],gt.X[(506832829*jt&4294967295)>>>gt.Mb]=jt}else{if(!(jt<Gt))break t;for(ge=jt-280,t(gt!=null);dt<ot;)jt=I[dt++],gt.X[(506832829*jt&4294967295)>>>gt.Mb]=jt;jt=ot,t(!(ge>>>(Fe=gt).Xa)),I[jt]=Fe.X[ge],ge=!0}ge||t(X.h==It(X))}if(h.Pb&&X.h&&ot<R)t(h.m.h),h.a=5,h.m=h.wd,h.$=h.xd,0<h.s.ua&&xt(h.s.vb,h.s.Wa);else{if(X.h)break t;N?.(h,P>Z?Z:P),h.a=0,h.$=ot-_}return 1}return h.a=3,0}function fr(h){t(h!=null),h.vc=null,h.yc=null,h.Ya=null;var I=h.Wa;I!=null&&(I.X=null),h.vb=null,t(h!=null)}function br(){var h=new Tl;return h==null?null:(h.a=0,h.xb=Pl,vi("Predictor","VP8LPredictors"),vi("Predictor","VP8LPredictors_C"),vi("PredictorAdd","VP8LPredictorsAdd"),vi("PredictorAdd","VP8LPredictorsAdd_C"),Wn=Ie,xn=mi,is=We,Eo=Se,_s=$e,no=di,ma=Zi,vt.VP8LMapColor32b=Ra,vt.VP8LMapColor8b=fa,h)}function Tr(h,I,_,F,R){var Z=1,N=[h],P=[I],V=F.m,X=F.s,J=null,ot=0;t:for(;;){if(_)for(;Z&&Ut(V,1);){var dt=N,ut=P,Gt=F,Pt=1,gt=Gt.m,Ct=Gt.gc[Gt.ab],ee=Ut(gt,2);if(Gt.Oc&1<<ee)Z=0;else{switch(Gt.Oc|=1<<ee,Ct.hc=ee,Ct.Ea=dt[0],Ct.nc=ut[0],Ct.K=[null],++Gt.ab,t(4>=Gt.ab),ee){case 0:case 1:Ct.b=Ut(gt,3)+2,Pt=Tr(Ue(Ct.Ea,Ct.b),Ue(Ct.nc,Ct.b),0,Gt,Ct.K),Ct.K=Ct.K[0];break;case 3:var ge,jt=Ut(gt,8)+1,Fe=16<jt?0:4<jt?1:2<jt?2:3;if(dt[0]=Ue(Ct.Ea,Fe),Ct.b=Fe,ge=Pt=Tr(jt,1,0,Gt,Ct.K)){var ke,Ye=jt,xe=Ct,ci=1<<(8>>xe.b),pi=o(ci);if(pi==null)ge=0;else{var Mi=xe.K[0],Si=xe.w;for(pi[0]=xe.K[0][0],ke=1;ke<1*Ye;++ke)pi[ke]=Ee(Mi[Si+ke],pi[ke-1]);for(;ke<4*ci;++ke)pi[ke]=0;xe.K[0]=null,xe.K[0]=pi,ge=1}}Pt=ge;break;case 2:break;default:t(0)}Z=Pt}}if(N=N[0],P=P[0],Z&&Ut(V,1)&&!(Z=1<=(ot=Ut(V,4))&&11>=ot)){F.a=3;break t}var cr;if(cr=Z)e:{var ji,Ii,vr,Yr=F,Gr=N,mn=P,wr=ot,An=_,rn=Yr.m,ur=Yr.s,sr=[null],Ir=1,Sn=0,_r=wc[wr];i:for(;;){if(An&&Ut(rn,1)){var Br=Ut(rn,3)+2,pn=Ue(Gr,Br),$i=Ue(mn,Br),ya=pn*$i;if(!Tr(pn,$i,0,Yr,sr))break i;for(sr=sr[0],ur.xc=Br,ji=0;ji<ya;++ji){var na=sr[ji]>>8&65535;sr[ji]=na,na>=Ir&&(Ir=na+1)}}if(rn.h)break i;for(Ii=0;5>Ii;++Ii){var Zr=SA[Ii];!Ii&&0<wr&&(Zr+=1<<wr),Sn<Zr&&(Sn=Zr)}var sa=g(Ir*_r,lt),dl=Ir,Nl=g(dl,_t);if(Nl==null)var Ro=null;else t(65536>=dl),Ro=Nl;var EA=o(Sn);if(Ro==null||EA==null||sa==null){Yr.a=1;break i}var TA=sa;for(ji=vr=0;ji<Ir;++ji){var Ns=Ro[ji],Ho=Ns.G,Ka=Ns.H,QA=0,Fc=1,ph=0;for(Ii=0;5>Ii;++Ii){Zr=SA[Ii],Ho[Ii]=TA,Ka[Ii]=vr,!Ii&&0<wr&&(Zr+=1<<wr);n:{var Wa,fh=Zr,UA=Yr,GA=EA,lu=TA,zg=vr,cu=0,RA=UA.m,gs=Ut(RA,1);if(A(GA,0,0,fh),gs){var Vl=Ut(RA,1)+1,mh=Ut(RA,1),Ch=Ut(RA,mh==0?1:8);GA[Ch]=1,Vl==2&&(GA[Ch=Ut(RA,8)]=1);var HA=1}else{var Jg=o(19),kc=Ut(RA,4)+4;if(19<kc){UA.a=3;var uu=0;break n}for(Wa=0;Wa<kc;++Wa)Jg[Hi[Wa]]=Ut(RA,3);var hu=void 0,Dl=void 0,Ih=UA,om=Jg,Kl=fh,yh=GA,Lc=0,Zo=Ih.m,Vs=8,bh=g(128,lt);r:for(;At(bh,0,7,om,19);){if(Ut(Zo,1)){var am=2+2*Ut(Zo,3);if((hu=2+Ut(Zo,am))>Kl)break r}else hu=Kl;for(Dl=0;Dl<Kl&&hu--;){Ot(Zo);var vh=bh[0+(127&bt(Zo))];Ht(Zo,Zo.u+vh.g);var Wl=vh.value;if(16>Wl)yh[Dl++]=Wl,Wl!=0&&(Vs=Wl);else{var Am=Wl==16,Xg=Wl-16,lm=Ao[Xg],gu=Ut(Zo,dh[Xg])+lm;if(Dl+gu>Kl)break r;for(var du=Am?Vs:0;0<gu--;)yh[Dl++]=du}}Lc=1;break r}Lc||(Ih.a=3),HA=Lc}(HA=HA&&!RA.h)&&(cu=At(lu,zg,8,GA,fh)),HA&&cu!=0?uu=cu:(UA.a=3,uu=0)}if(uu==0)break i;if(Fc&&wi[Ii]==1&&(Fc=TA[vr].g==0),QA+=TA[vr].g,vr+=uu,3>=Ii){var Ol,Oa=EA[0];for(Ol=1;Ol<Zr;++Ol)EA[Ol]>Oa&&(Oa=EA[Ol]);ph+=Oa}}if(Ns.nd=Fc,Ns.Qb=0,Fc&&(Ns.qb=(Ho[3][Ka[3]+0].value<<24|Ho[1][Ka[1]+0].value<<16|Ho[2][Ka[2]+0].value)>>>0,QA==0&&256>Ho[0][Ka[0]+0].value&&(Ns.Qb=1,Ns.qb+=Ho[0][Ka[0]+0].value<<8)),Ns.jc=!Ns.Qb&&6>ph,Ns.jc){var ZA,za=Ns;for(ZA=0;ZA<ts;++ZA){var PA=ZA,MA=za.pd[PA],pu=za.G[0][za.H[0]+PA];256<=pu.value?(MA.g=pu.g+256,MA.value=pu.value):(MA.g=0,MA.value=0,PA>>=oi(pu,8,MA),PA>>=oi(za.G[1][za.H[1]+PA],16,MA),PA>>=oi(za.G[2][za.H[2]+PA],0,MA),oi(za.G[3][za.H[3]+PA],24,MA))}}}ur.vc=sr,ur.Wb=Ir,ur.Ya=Ro,ur.yc=sa,cr=1;break e}cr=0}if(!(Z=cr)){F.a=3;break t}if(0<ot){if(X.ua=1<<ot,!gi(X.Wa,ot)){F.a=1,Z=0;break t}}else X.ua=0;var wh=F,Yg=N,cm=P,Ec=wh.s,Bh=Ec.xc;if(wh.c=Yg,wh.i=cm,Ec.md=Ue(Yg,Bh),Ec.wc=Bh==0?-1:(1<<Bh)-1,_){F.xb=ul;break t}if((J=o(N*P))==null){F.a=1,Z=0;break t}Z=(Z=ki(F,J,0,N,P,P,null))&&!V.h;break t}return Z?(R!=null?R[0]=J:(t(J==null),t(_)),F.$=0,_||fr(X)):fr(X),Z}function Dt(h,I){var _=h.c*h.i,F=_+I+16*I;return t(h.c<=I),h.V=o(F),h.V==null?(h.Ta=null,h.Ua=0,h.a=1,0):(h.Ta=h.V,h.Ua=h.Ba+_+I,1)}function Ke(h,I){var _=h.C,F=I-_,R=h.V,Z=h.Ba+h.c*_;for(t(I<=h.l.o);0<F;){var N=16<F?16:F,P=h.l.ma,V=h.l.width,X=V*N,J=P.ca,ot=P.tb+V*_,dt=h.Ta,ut=h.Ua;Ni(h,N,R,Z),si(dt,ut,J,ot,X),zi(P,_,_+N,J,ot,V),F-=N,R+=N*h.c,_+=N}t(_==I),h.C=h.Ma=I}function Te(){this.ub=this.yd=this.td=this.Rb=0}function or(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Er(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function Ji(){this.Yb=function(){var h=[];return function I(_,F,R){for(var Z=R[F],N=0;N<Z&&(_.push(R.length>F+1?[]:0),!(R.length<F+1));N++)I(_[N],F+1,R)}(h,0,[3,11]),h}()}function Mr(){this.jb=o(3),this.Wc=d([4,8],Ji),this.Xc=d([4,17],Ji)}function vs(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function Sr(){this.ld=this.La=this.dd=this.tc=0}function xr(){this.Na=this.la=0}function Wo(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function an(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Dn(){this.uc=this.M=this.Nb=0,this.wa=Array(new Sr),this.Y=0,this.ya=Array(new an),this.aa=0,this.l=new Qr}function Oo(){this.y=o(16),this.f=o(8),this.ea=o(8)}function As(){this.cb=this.a=0,this.sc="",this.m=new fe,this.Od=new Te,this.Kc=new or,this.ed=new vs,this.Qa=new Er,this.Ic=this.$c=this.Aa=0,this.D=new Dn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=g(8,fe),this.ia=0,this.pb=g(4,Wo),this.Pa=new Mr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Oo),this.Hd=0,this.rb=Array(new xr),this.sb=0,this.wa=Array(new Sr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new an),this.L=this.aa=0,this.gd=d([4,2],Sr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Qr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function zo(){var h=new As;return h!=null&&(h.a=0,h.sc="OK",h.cb=0,h.Xb=0,ns||(ns=Kn)),h}function Fr(h,I,_){return h.a==0&&(h.a=I,h.sc=_,h.cb=0),0}function Nr(h,I,_){return 3<=_&&h[I+0]==157&&h[I+1]==1&&h[I+2]==42}function Gs(h,I){if(h==null)return 0;if(h.a=0,h.sc="OK",I==null)return Fr(h,2,"null VP8Io passed to VP8GetHeaders()");var _=I.data,F=I.w,R=I.ha;if(4>R)return Fr(h,7,"Truncated header.");var Z=_[F+0]|_[F+1]<<8|_[F+2]<<16,N=h.Od;if(N.Rb=!(1&Z),N.td=Z>>1&7,N.yd=Z>>4&1,N.ub=Z>>5,3<N.td)return Fr(h,3,"Incorrect keyframe parameters.");if(!N.yd)return Fr(h,4,"Frame not displayable.");F+=3,R-=3;var P=h.Kc;if(N.Rb){if(7>R)return Fr(h,7,"cannot parse picture header");if(!Nr(_,F,R))return Fr(h,3,"Bad code word");P.c=16383&(_[F+4]<<8|_[F+3]),P.Td=_[F+4]>>6,P.i=16383&(_[F+6]<<8|_[F+5]),P.Ud=_[F+6]>>6,F+=7,R-=7,h.za=P.c+15>>4,h.Ub=P.i+15>>4,I.width=P.c,I.height=P.i,I.Da=0,I.j=0,I.v=0,I.va=I.width,I.o=I.height,I.da=0,I.ib=I.width,I.hb=I.height,I.U=I.width,I.T=I.height,A((Z=h.Pa).jb,0,255,Z.jb.length),t((Z=h.Qa)!=null),Z.Cb=0,Z.Bb=0,Z.Fb=1,A(Z.Zb,0,0,Z.Zb.length),A(Z.Lb,0,0,Z.Lb)}if(N.ub>R)return Fr(h,7,"bad partition length");le(Z=h.m,_,F,N.ub),F+=N.ub,R-=N.ub,N.Rb&&(P.Ld=he(Z),P.Kd=he(Z)),P=h.Qa;var V,X=h.Pa;if(t(Z!=null),t(P!=null),P.Cb=he(Z),P.Cb){if(P.Bb=he(Z),he(Z)){for(P.Fb=he(Z),V=0;4>V;++V)P.Zb[V]=he(Z)?ne(Z,7):0;for(V=0;4>V;++V)P.Lb[V]=he(Z)?ne(Z,6):0}if(P.Bb)for(V=0;3>V;++V)X.jb[V]=he(Z)?ie(Z,8):255}else P.Bb=0;if(Z.Ka)return Fr(h,3,"cannot parse segment header");if((P=h.ed).zd=he(Z),P.Tb=ie(Z,6),P.wb=ie(Z,3),P.Pc=he(Z),P.Pc&&he(Z)){for(X=0;4>X;++X)he(Z)&&(P.vd[X]=ne(Z,6));for(X=0;4>X;++X)he(Z)&&(P.od[X]=ne(Z,6))}if(h.L=P.Tb==0?0:P.zd?1:2,Z.Ka)return Fr(h,3,"cannot parse filter header");var J=R;if(R=V=F,F=V+J,P=J,h.Xb=(1<<ie(h.m,2))-1,J<3*(X=h.Xb))_=7;else{for(V+=3*X,P-=3*X,J=0;J<X;++J){var ot=_[R+0]|_[R+1]<<8|_[R+2]<<16;ot>P&&(ot=P),le(h.Jc[+J],_,V,ot),V+=ot,P-=ot,R+=3}le(h.Jc[+X],_,V,P),_=V<F?0:5}if(_!=0)return Fr(h,_,"cannot parse partitions");for(_=ie(V=h.m,7),R=he(V)?ne(V,4):0,F=he(V)?ne(V,4):0,P=he(V)?ne(V,4):0,X=he(V)?ne(V,4):0,V=he(V)?ne(V,4):0,J=h.Qa,ot=0;4>ot;++ot){if(J.Cb){var dt=J.Zb[ot];J.Fb||(dt+=_)}else{if(0<ot){h.pb[ot]=h.pb[0];continue}dt=_}var ut=h.pb[ot];ut.Sc[0]=Jn[$n(dt+R,127)],ut.Sc[1]=Hl[$n(dt+0,127)],ut.Eb[0]=2*Jn[$n(dt+F,127)],ut.Eb[1]=101581*Hl[$n(dt+P,127)]>>16,8>ut.Eb[1]&&(ut.Eb[1]=8),ut.Qc[0]=Jn[$n(dt+X,117)],ut.Qc[1]=Hl[$n(dt+V,127)],ut.lc=dt+V}if(!N.Rb)return Fr(h,4,"Not a key frame.");for(he(Z),N=h.Pa,_=0;4>_;++_){for(R=0;8>R;++R)for(F=0;3>F;++F)for(P=0;11>P;++P)X=de(Z,cl[_][R][F][P])?ie(Z,8):dn[_][R][F][P],N.Wc[_][R].Yb[F][P]=X;for(R=0;17>R;++R)N.Xc[_][R]=N.Wc[_][Zl[R]]}return h.kc=he(Z),h.kc&&(h.Bd=ie(Z,8)),h.cb=1}function Kn(h,I,_,F,R,Z,N){var P=I[R].Yb[_];for(_=0;16>R;++R){if(!de(h,P[_+0]))return R;for(;!de(h,P[_+1]);)if(P=I[++R].Yb[0],_=0,R==16)return 16;var V=I[R+1].Yb;if(de(h,P[_+2])){var X=h,J=0;if(de(X,(dt=P)[(ot=_)+3]))if(de(X,dt[ot+6])){for(P=0,ot=2*(J=de(X,dt[ot+8]))+(dt=de(X,dt[ot+9+J])),J=0,dt=ou[ot];dt[P];++P)J+=J+de(X,dt[P]);J+=3+(8<<ot)}else de(X,dt[ot+7])?(J=7+2*de(X,165),J+=de(X,145)):J=5+de(X,159);else J=de(X,dt[ot+4])?3+de(X,dt[ot+5]):2;P=V[2]}else J=1,P=V[1];V=N+FA[R],0>(X=h).b&&Ae(X);var ot,dt=X.b,ut=(ot=X.Ca>>1)-(X.I>>dt)>>31;--X.b,X.Ca+=ut,X.Ca|=1,X.I-=(ot+1&ut)<<dt,Z[V]=((J^ut)-ut)*F[(0<R)+0]}return 16}function to(h){var I=h.rb[h.sb-1];I.la=0,I.Na=0,A(h.zc,0,0,h.zc.length),h.ja=0}function pt(h,I){if(h==null)return 0;if(I==null)return Fr(h,2,"NULL VP8Io parameter in VP8Decode().");if(!h.cb&&!Gs(h,I))return 0;if(t(h.cb),I.ac==null||I.ac(I)){I.ob&&(h.L=0);var _=b[h.L];if(h.L==2?(h.yb=0,h.zb=0):(h.yb=I.v-_>>4,h.zb=I.j-_>>4,0>h.yb&&(h.yb=0),0>h.zb&&(h.zb=0)),h.Va=I.o+15+_>>4,h.Hb=I.va+15+_>>4,h.Hb>h.za&&(h.Hb=h.za),h.Va>h.Ub&&(h.Va=h.Ub),0<h.L){var F=h.ed;for(_=0;4>_;++_){var R;if(h.Qa.Cb){var Z=h.Qa.Lb[_];h.Qa.Fb||(Z+=F.Tb)}else Z=F.Tb;for(R=0;1>=R;++R){var N=h.gd[_][R],P=Z;if(F.Pc&&(P+=F.vd[0],R&&(P+=F.od[0])),0<(P=0>P?0:63<P?63:P)){var V=P;0<F.wb&&(V=4<F.wb?V>>2:V>>1)>9-F.wb&&(V=9-F.wb),1>V&&(V=1),N.dd=V,N.tc=2*P+V,N.ld=40<=P?2:15<=P?1:0}else N.tc=0;N.La=R}}}_=0}else Fr(h,6,"Frame setup failed"),_=h.a;if(_=_==0){if(_){h.$c=0,0<h.Aa||(h.Ic=E);t:{_=h.Ic,F=4*(V=h.za);var X=32*V,J=V+1,ot=0<h.L?V*(0<h.Aa?2:1):0,dt=(h.Aa==2?2:1)*V;if((N=F+832+(R=3*(16*_+b[h.L])/2*X)+(Z=h.Fa!=null&&0<h.Fa.length?h.Kc.c*h.Kc.i:0))!=N)_=0;else{if(N>h.Vb){if(h.Vb=0,h.Ec=o(N),h.Fc=0,h.Ec==null){_=Fr(h,1,"no memory during frame initialization.");break t}h.Vb=N}N=h.Ec,P=h.Fc,h.Ac=N,h.Bc=P,P+=F,h.Gd=g(X,Oo),h.Hd=0,h.rb=g(J+1,xr),h.sb=1,h.wa=ot?g(ot,Sr):null,h.Y=0,h.D.Nb=0,h.D.wa=h.wa,h.D.Y=h.Y,0<h.Aa&&(h.D.Y+=V),t(!0),h.oc=N,h.pc=P,P+=832,h.ya=g(dt,an),h.aa=0,h.D.ya=h.ya,h.D.aa=h.aa,h.Aa==2&&(h.D.aa+=V),h.R=16*V,h.B=8*V,V=(X=b[h.L])*h.R,X=X/2*h.B,h.sa=N,h.ta=P+V,h.qa=h.sa,h.ra=h.ta+16*_*h.R+X,h.Ha=h.qa,h.Ia=h.ra+8*_*h.B+X,h.$c=0,P+=R,h.mb=Z?N:null,h.nb=Z?P:null,t(P+Z<=h.Fc+h.Vb),to(h),A(h.Ac,h.Bc,0,F),_=1}}if(_){if(I.ka=0,I.y=h.sa,I.O=h.ta,I.f=h.qa,I.N=h.ra,I.ea=h.Ha,I.Vd=h.Ia,I.fa=h.R,I.Rc=h.B,I.F=null,I.J=0,!ei){for(_=-255;255>=_;++_)Ql[255+_]=0>_?-_:_;for(_=-1020;1020>=_;++_)Ca[1020+_]=-128>_?-128:127<_?127:_;for(_=-112;112>=_;++_)Za[112+_]=-16>_?-16:15<_?15:_;for(_=-255;510>=_;++_)Ul[255+_]=0>_?0:255<_?255:_;ei=1}fn=se,Ha=ae,ta=Be,Ms=_e,To=Ce,vA=Yt,so=Fo,Qo=ka,Jr=vc,xs=il,zn=bc,gn=CA,Uo=rl,pr=IA,kr=Fa,en=io,yn=So,oo=mA,Ss[0]=Ur,Ss[1]=be,Ss[2]=dr,Ss[3]=Or,Ss[4]=_n,Ss[5]=ws,Ss[6]=vn,Ss[7]=_o,Ss[8]=yc,Ss[9]=Ic,ss[0]=Ai,ss[1]=Ui,ss[2]=Ri,ss[3]=Pe,ss[4]=Fi,ss[5]=Wi,ss[6]=nr,lo[0]=eo,lo[1]=Ge,lo[2]=El,lo[3]=el,lo[4]=cn,lo[5]=qn,lo[6]=xo,_=1}else _=0}_&&(_=function(ut,Gt){for(ut.M=0;ut.M<ut.Va;++ut.M){var Pt,gt=ut.Jc[ut.M&ut.Xb],Ct=ut.m,ee=ut;for(Pt=0;Pt<ee.za;++Pt){var ge=Ct,jt=ee,Fe=jt.Ac,ke=jt.Bc+4*Pt,Ye=jt.zc,xe=jt.ya[jt.aa+Pt];if(jt.Qa.Bb?xe.$b=de(ge,jt.Pa.jb[0])?2+de(ge,jt.Pa.jb[2]):de(ge,jt.Pa.jb[1]):xe.$b=0,jt.kc&&(xe.Ad=de(ge,jt.Bd)),xe.Za=!de(ge,145)+0,xe.Za){var ci=xe.Ob,pi=0;for(jt=0;4>jt;++jt){var Mi,Si=Ye[0+jt];for(Mi=0;4>Mi;++Mi){Si=au[Fe[ke+Mi]][Si];for(var cr=Xr[de(ge,Si[0])];0<cr;)cr=Xr[2*cr+de(ge,Si[cr])];Si=-cr,Fe[ke+Mi]=Si}s(ci,pi,Fe,ke,4),pi+=4,Ye[0+jt]=Si}}else Si=de(ge,156)?de(ge,128)?1:3:de(ge,163)?2:0,xe.Ob[0]=Si,A(Fe,ke,Si,4),A(Ye,0,Si,4);xe.Dd=de(ge,142)?de(ge,114)?de(ge,183)?1:3:2:0}if(ee.m.Ka)return Fr(ut,7,"Premature end-of-partition0 encountered.");for(;ut.ja<ut.za;++ut.ja){if(ee=gt,ge=(Ct=ut).rb[Ct.sb-1],Fe=Ct.rb[Ct.sb+Ct.ja],Pt=Ct.ya[Ct.aa+Ct.ja],ke=Ct.kc?Pt.Ad:0)ge.la=Fe.la=0,Pt.Za||(ge.Na=Fe.Na=0),Pt.Hc=0,Pt.Gc=0,Pt.ia=0;else{var ji,Ii;if(ge=Fe,Fe=ee,ke=Ct.Pa.Xc,Ye=Ct.ya[Ct.aa+Ct.ja],xe=Ct.pb[Ye.$b],jt=Ye.ad,ci=0,pi=Ct.rb[Ct.sb-1],Si=Mi=0,A(jt,ci,0,384),Ye.Za)var vr=0,Yr=ke[3];else{cr=o(16);var Gr=ge.Na+pi.Na;if(Gr=ns(Fe,ke[1],Gr,xe.Eb,0,cr,0),ge.Na=pi.Na=(0<Gr)+0,1<Gr)fn(cr,0,jt,ci);else{var mn=cr[0]+3>>3;for(cr=0;256>cr;cr+=16)jt[ci+cr]=mn}vr=1,Yr=ke[0]}var wr=15&ge.la,An=15&pi.la;for(cr=0;4>cr;++cr){var rn=1&An;for(mn=Ii=0;4>mn;++mn)wr=wr>>1|(rn=(Gr=ns(Fe,Yr,Gr=rn+(1&wr),xe.Sc,vr,jt,ci))>vr)<<7,Ii=Ii<<2|(3<Gr?3:1<Gr?2:jt[ci+0]!=0),ci+=16;wr>>=4,An=An>>1|rn<<7,Mi=(Mi<<8|Ii)>>>0}for(Yr=wr,vr=An>>4,ji=0;4>ji;ji+=2){for(Ii=0,wr=ge.la>>4+ji,An=pi.la>>4+ji,cr=0;2>cr;++cr){for(rn=1&An,mn=0;2>mn;++mn)Gr=rn+(1&wr),wr=wr>>1|(rn=0<(Gr=ns(Fe,ke[2],Gr,xe.Qc,0,jt,ci)))<<3,Ii=Ii<<2|(3<Gr?3:1<Gr?2:jt[ci+0]!=0),ci+=16;wr>>=2,An=An>>1|rn<<5}Si|=Ii<<4*ji,Yr|=wr<<4<<ji,vr|=(240&An)<<ji}ge.la=Yr,pi.la=vr,Ye.Hc=Mi,Ye.Gc=Si,Ye.ia=43690&Si?0:xe.ia,ke=!(Mi|Si)}if(0<Ct.L&&(Ct.wa[Ct.Y+Ct.ja]=Ct.gd[Pt.$b][Pt.Za],Ct.wa[Ct.Y+Ct.ja].La|=!ke),ee.Ka)return Fr(ut,7,"Premature end-of-file encountered.")}if(to(ut),Ct=Gt,ee=1,Pt=(gt=ut).D,ge=0<gt.L&&gt.M>=gt.zb&&gt.M<=gt.Va,gt.Aa==0)t:{if(Pt.M=gt.M,Pt.uc=ge,ga(gt,Pt),ee=1,Pt=(Ii=gt.D).Nb,ge=(Si=b[gt.L])*gt.R,Fe=Si/2*gt.B,cr=16*Pt*gt.R,mn=8*Pt*gt.B,ke=gt.sa,Ye=gt.ta-ge+cr,xe=gt.qa,jt=gt.ra-Fe+mn,ci=gt.Ha,pi=gt.Ia-Fe+mn,An=(wr=Ii.M)==0,Mi=wr>=gt.Va-1,gt.Aa==2&&ga(gt,Ii),Ii.uc)for(rn=(Gr=gt).D.M,t(Gr.D.uc),Ii=Gr.yb;Ii<Gr.Hb;++Ii){vr=Ii,Yr=rn;var ur=(sr=(Zr=Gr).D).Nb;ji=Zr.R;var sr=sr.wa[sr.Y+vr],Ir=Zr.sa,Sn=Zr.ta+16*ur*ji+16*vr,_r=sr.dd,Br=sr.tc;if(Br!=0)if(t(3<=Br),Zr.L==1)0<vr&&en(Ir,Sn,ji,Br+4),sr.La&&oo(Ir,Sn,ji,Br),0<Yr&&kr(Ir,Sn,ji,Br+4),sr.La&&yn(Ir,Sn,ji,Br);else{var pn=Zr.B,$i=Zr.qa,ya=Zr.ra+8*ur*pn+8*vr,na=Zr.Ha,Zr=Zr.Ia+8*ur*pn+8*vr;ur=sr.ld,0<vr&&(Qo(Ir,Sn,ji,Br+4,_r,ur),xs($i,ya,na,Zr,pn,Br+4,_r,ur)),sr.La&&(gn(Ir,Sn,ji,Br,_r,ur),pr($i,ya,na,Zr,pn,Br,_r,ur)),0<Yr&&(so(Ir,Sn,ji,Br+4,_r,ur),Jr($i,ya,na,Zr,pn,Br+4,_r,ur)),sr.La&&(zn(Ir,Sn,ji,Br,_r,ur),Uo($i,ya,na,Zr,pn,Br,_r,ur))}}if(gt.ia&&alert("todo:DitherRow"),Ct.put!=null){if(Ii=16*wr,wr=16*(wr+1),An?(Ct.y=gt.sa,Ct.O=gt.ta+cr,Ct.f=gt.qa,Ct.N=gt.ra+mn,Ct.ea=gt.Ha,Ct.W=gt.Ia+mn):(Ii-=Si,Ct.y=ke,Ct.O=Ye,Ct.f=xe,Ct.N=jt,Ct.ea=ci,Ct.W=pi),Mi||(wr-=Si),wr>Ct.o&&(wr=Ct.o),Ct.F=null,Ct.J=null,gt.Fa!=null&&0<gt.Fa.length&&Ii<wr&&(Ct.J=ko(gt,Ct,Ii,wr-Ii),Ct.F=gt.mb,Ct.F==null&&Ct.F.length==0)){ee=Fr(gt,3,"Could not decode alpha data.");break t}Ii<Ct.j&&(Si=Ct.j-Ii,Ii=Ct.j,t(!(1&Si)),Ct.O+=gt.R*Si,Ct.N+=gt.B*(Si>>1),Ct.W+=gt.B*(Si>>1),Ct.F!=null&&(Ct.J+=Ct.width*Si)),Ii<wr&&(Ct.O+=Ct.v,Ct.N+=Ct.v>>1,Ct.W+=Ct.v>>1,Ct.F!=null&&(Ct.J+=Ct.v),Ct.ka=Ii-Ct.j,Ct.U=Ct.va-Ct.v,Ct.T=wr-Ii,ee=Ct.put(Ct))}Pt+1!=gt.Ic||Mi||(s(gt.sa,gt.ta-ge,ke,Ye+16*gt.R,ge),s(gt.qa,gt.ra-Fe,xe,jt+8*gt.B,Fe),s(gt.Ha,gt.Ia-Fe,ci,pi+8*gt.B,Fe))}if(!ee)return Fr(ut,6,"Output aborted.")}return 1}(h,I)),I.bc!=null&&I.bc(I),_&=1}return _?(h.cb=0,_):0}function yt(h,I,_,F,R){R=h[I+_+32*F]+(R>>3),h[I+_+32*F]=-256&R?0>R?0:255:R}function ct(h,I,_,F,R,Z){yt(h,I,0,_,F+R),yt(h,I,1,_,F+Z),yt(h,I,2,_,F-Z),yt(h,I,3,_,F-R)}function Bt(h){return(20091*h>>16)+h}function Kt(h,I,_,F){var R,Z=0,N=o(16);for(R=0;4>R;++R){var P=h[I+0]+h[I+8],V=h[I+0]-h[I+8],X=(35468*h[I+4]>>16)-Bt(h[I+12]),J=Bt(h[I+4])+(35468*h[I+12]>>16);N[Z+0]=P+J,N[Z+1]=V+X,N[Z+2]=V-X,N[Z+3]=P-J,Z+=4,I++}for(R=Z=0;4>R;++R)P=(h=N[Z+0]+4)+N[Z+8],V=h-N[Z+8],X=(35468*N[Z+4]>>16)-Bt(N[Z+12]),yt(_,F,0,0,P+(J=Bt(N[Z+4])+(35468*N[Z+12]>>16))),yt(_,F,1,0,V+X),yt(_,F,2,0,V-X),yt(_,F,3,0,P-J),Z++,F+=32}function Yt(h,I,_,F){var R=h[I+0]+4,Z=35468*h[I+4]>>16,N=Bt(h[I+4]),P=35468*h[I+1]>>16;ct(_,F,0,R+N,h=Bt(h[I+1]),P),ct(_,F,1,R+Z,h,P),ct(_,F,2,R-Z,h,P),ct(_,F,3,R-N,h,P)}function ae(h,I,_,F,R){Kt(h,I,_,F),R&&Kt(h,I+16,_,F+4)}function Be(h,I,_,F){Ha(h,I+0,_,F,1),Ha(h,I+32,_,F+128,1)}function _e(h,I,_,F){var R;for(h=h[I+0]+4,R=0;4>R;++R)for(I=0;4>I;++I)yt(_,F,I,R,h)}function Ce(h,I,_,F){h[I+0]&&Ms(h,I+0,_,F),h[I+16]&&Ms(h,I+16,_,F+4),h[I+32]&&Ms(h,I+32,_,F+128),h[I+48]&&Ms(h,I+48,_,F+128+4)}function se(h,I,_,F){var R,Z=o(16);for(R=0;4>R;++R){var N=h[I+0+R]+h[I+12+R],P=h[I+4+R]+h[I+8+R],V=h[I+4+R]-h[I+8+R],X=h[I+0+R]-h[I+12+R];Z[0+R]=N+P,Z[8+R]=N-P,Z[4+R]=X+V,Z[12+R]=X-V}for(R=0;4>R;++R)N=(h=Z[0+4*R]+3)+Z[3+4*R],P=Z[1+4*R]+Z[2+4*R],V=Z[1+4*R]-Z[2+4*R],X=h-Z[3+4*R],_[F+0]=N+P>>3,_[F+16]=X+V>>3,_[F+32]=N-P>>3,_[F+48]=X-V>>3,F+=64}function ye(h,I,_){var F,R=I-32,Z=us,N=255-h[R-1];for(F=0;F<_;++F){var P,V=Z,X=N+h[I-1];for(P=0;P<_;++P)h[I+P]=V[X+h[R+P]];I+=32}}function be(h,I){ye(h,I,4)}function Ge(h,I){ye(h,I,8)}function Ui(h,I){ye(h,I,16)}function Ri(h,I){var _;for(_=0;16>_;++_)s(h,I+32*_,h,I-32,16)}function Pe(h,I){var _;for(_=16;0<_;--_)A(h,I,h[I-1],16),I+=32}function Qe(h,I,_){var F;for(F=0;16>F;++F)A(I,_+32*F,h,16)}function Ai(h,I){var _,F=16;for(_=0;16>_;++_)F+=h[I-1+32*_]+h[I+_-32];Qe(F>>5,h,I)}function Fi(h,I){var _,F=8;for(_=0;16>_;++_)F+=h[I-1+32*_];Qe(F>>4,h,I)}function Wi(h,I){var _,F=8;for(_=0;16>_;++_)F+=h[I+_-32];Qe(F>>4,h,I)}function nr(h,I){Qe(128,h,I)}function ai(h,I,_){return h+2*I+_+2>>2}function dr(h,I){var _,F=I-32;for(F=new Uint8Array([ai(h[F-1],h[F+0],h[F+1]),ai(h[F+0],h[F+1],h[F+2]),ai(h[F+1],h[F+2],h[F+3]),ai(h[F+2],h[F+3],h[F+4])]),_=0;4>_;++_)s(h,I+32*_,F,0,F.length)}function Or(h,I){var _=h[I-1],F=h[I-1+32],R=h[I-1+64],Z=h[I-1+96];He(h,I+0,16843009*ai(h[I-1-32],_,F)),He(h,I+32,16843009*ai(_,F,R)),He(h,I+64,16843009*ai(F,R,Z)),He(h,I+96,16843009*ai(R,Z,Z))}function Ur(h,I){var _,F=4;for(_=0;4>_;++_)F+=h[I+_-32]+h[I-1+32*_];for(F>>=3,_=0;4>_;++_)A(h,I+32*_,F,4)}function _n(h,I){var _=h[I-1+0],F=h[I-1+32],R=h[I-1+64],Z=h[I-1-32],N=h[I+0-32],P=h[I+1-32],V=h[I+2-32],X=h[I+3-32];h[I+0+96]=ai(F,R,h[I-1+96]),h[I+1+96]=h[I+0+64]=ai(_,F,R),h[I+2+96]=h[I+1+64]=h[I+0+32]=ai(Z,_,F),h[I+3+96]=h[I+2+64]=h[I+1+32]=h[I+0+0]=ai(N,Z,_),h[I+3+64]=h[I+2+32]=h[I+1+0]=ai(P,N,Z),h[I+3+32]=h[I+2+0]=ai(V,P,N),h[I+3+0]=ai(X,V,P)}function vn(h,I){var _=h[I+1-32],F=h[I+2-32],R=h[I+3-32],Z=h[I+4-32],N=h[I+5-32],P=h[I+6-32],V=h[I+7-32];h[I+0+0]=ai(h[I+0-32],_,F),h[I+1+0]=h[I+0+32]=ai(_,F,R),h[I+2+0]=h[I+1+32]=h[I+0+64]=ai(F,R,Z),h[I+3+0]=h[I+2+32]=h[I+1+64]=h[I+0+96]=ai(R,Z,N),h[I+3+32]=h[I+2+64]=h[I+1+96]=ai(Z,N,P),h[I+3+64]=h[I+2+96]=ai(N,P,V),h[I+3+96]=ai(P,V,V)}function ws(h,I){var _=h[I-1+0],F=h[I-1+32],R=h[I-1+64],Z=h[I-1-32],N=h[I+0-32],P=h[I+1-32],V=h[I+2-32],X=h[I+3-32];h[I+0+0]=h[I+1+64]=Z+N+1>>1,h[I+1+0]=h[I+2+64]=N+P+1>>1,h[I+2+0]=h[I+3+64]=P+V+1>>1,h[I+3+0]=V+X+1>>1,h[I+0+96]=ai(R,F,_),h[I+0+64]=ai(F,_,Z),h[I+0+32]=h[I+1+96]=ai(_,Z,N),h[I+1+32]=h[I+2+96]=ai(Z,N,P),h[I+2+32]=h[I+3+96]=ai(N,P,V),h[I+3+32]=ai(P,V,X)}function _o(h,I){var _=h[I+0-32],F=h[I+1-32],R=h[I+2-32],Z=h[I+3-32],N=h[I+4-32],P=h[I+5-32],V=h[I+6-32],X=h[I+7-32];h[I+0+0]=_+F+1>>1,h[I+1+0]=h[I+0+64]=F+R+1>>1,h[I+2+0]=h[I+1+64]=R+Z+1>>1,h[I+3+0]=h[I+2+64]=Z+N+1>>1,h[I+0+32]=ai(_,F,R),h[I+1+32]=h[I+0+96]=ai(F,R,Z),h[I+2+32]=h[I+1+96]=ai(R,Z,N),h[I+3+32]=h[I+2+96]=ai(Z,N,P),h[I+3+64]=ai(N,P,V),h[I+3+96]=ai(P,V,X)}function Ic(h,I){var _=h[I-1+0],F=h[I-1+32],R=h[I-1+64],Z=h[I-1+96];h[I+0+0]=_+F+1>>1,h[I+2+0]=h[I+0+32]=F+R+1>>1,h[I+2+32]=h[I+0+64]=R+Z+1>>1,h[I+1+0]=ai(_,F,R),h[I+3+0]=h[I+1+32]=ai(F,R,Z),h[I+3+32]=h[I+1+64]=ai(R,Z,Z),h[I+3+64]=h[I+2+64]=h[I+0+96]=h[I+1+96]=h[I+2+96]=h[I+3+96]=Z}function yc(h,I){var _=h[I-1+0],F=h[I-1+32],R=h[I-1+64],Z=h[I-1+96],N=h[I-1-32],P=h[I+0-32],V=h[I+1-32],X=h[I+2-32];h[I+0+0]=h[I+2+32]=_+N+1>>1,h[I+0+32]=h[I+2+64]=F+_+1>>1,h[I+0+64]=h[I+2+96]=R+F+1>>1,h[I+0+96]=Z+R+1>>1,h[I+3+0]=ai(P,V,X),h[I+2+0]=ai(N,P,V),h[I+1+0]=h[I+3+32]=ai(_,N,P),h[I+1+32]=h[I+3+64]=ai(F,_,N),h[I+1+64]=h[I+3+96]=ai(R,F,_),h[I+1+96]=ai(Z,R,F)}function El(h,I){var _;for(_=0;8>_;++_)s(h,I+32*_,h,I-32,8)}function el(h,I){var _;for(_=0;8>_;++_)A(h,I,h[I-1],8),I+=32}function Bs(h,I,_){var F;for(F=0;8>F;++F)A(I,_+32*F,h,8)}function eo(h,I){var _,F=8;for(_=0;8>_;++_)F+=h[I+_-32]+h[I-1+32*_];Bs(F>>4,h,I)}function qn(h,I){var _,F=4;for(_=0;8>_;++_)F+=h[I+_-32];Bs(F>>3,h,I)}function cn(h,I){var _,F=4;for(_=0;8>_;++_)F+=h[I-1+32*_];Bs(F>>3,h,I)}function xo(h,I){Bs(128,h,I)}function lr(h,I,_){var F=h[I-_],R=h[I+0],Z=3*(R-F)+Pa[1020+h[I-2*_]-h[I+_]],N=Ma[112+(Z+4>>3)];h[I-_]=us[255+F+Ma[112+(Z+3>>3)]],h[I+0]=us[255+R-N]}function Sa(h,I,_,F){var R=h[I+0],Z=h[I+_];return rs[255+h[I-2*_]-h[I-_]]>F||rs[255+Z-R]>F}function pA(h,I,_,F){return 4*rs[255+h[I-_]-h[I+0]]+rs[255+h[I-2*_]-h[I+_]]<=F}function fA(h,I,_,F,R){var Z=h[I-3*_],N=h[I-2*_],P=h[I-_],V=h[I+0],X=h[I+_],J=h[I+2*_],ot=h[I+3*_];return 4*rs[255+P-V]+rs[255+N-X]>F?0:rs[255+h[I-4*_]-Z]<=R&&rs[255+Z-N]<=R&&rs[255+N-P]<=R&&rs[255+ot-J]<=R&&rs[255+J-X]<=R&&rs[255+X-V]<=R}function Fa(h,I,_,F){var R=2*F+1;for(F=0;16>F;++F)pA(h,I+F,_,R)&&lr(h,I+F,_)}function io(h,I,_,F){var R=2*F+1;for(F=0;16>F;++F)pA(h,I+F*_,1,R)&&lr(h,I+F*_,1)}function So(h,I,_,F){var R;for(R=3;0<R;--R)Fa(h,I+=4*_,_,F)}function mA(h,I,_,F){var R;for(R=3;0<R;--R)io(h,I+=4,_,F)}function Jo(h,I,_,F,R,Z,N,P){for(Z=2*Z+1;0<R--;){if(fA(h,I,_,Z,N))if(Sa(h,I,_,P))lr(h,I,_);else{var V=h,X=I,J=_,ot=V[X-2*J],dt=V[X-J],ut=V[X+0],Gt=V[X+J],Pt=V[X+2*J],gt=27*(ee=Pa[1020+3*(ut-dt)+Pa[1020+ot-Gt]])+63>>7,Ct=18*ee+63>>7,ee=9*ee+63>>7;V[X-3*J]=us[255+V[X-3*J]+ee],V[X-2*J]=us[255+ot+Ct],V[X-J]=us[255+dt+gt],V[X+0]=us[255+ut-gt],V[X+J]=us[255+Gt-Ct],V[X+2*J]=us[255+Pt-ee]}I+=F}}function Rs(h,I,_,F,R,Z,N,P){for(Z=2*Z+1;0<R--;){if(fA(h,I,_,Z,N))if(Sa(h,I,_,P))lr(h,I,_);else{var V=h,X=I,J=_,ot=V[X-J],dt=V[X+0],ut=V[X+J],Gt=Ma[112+((Pt=3*(dt-ot))+4>>3)],Pt=Ma[112+(Pt+3>>3)],gt=Gt+1>>1;V[X-2*J]=us[255+V[X-2*J]+gt],V[X-J]=us[255+ot+Pt],V[X+0]=us[255+dt-Gt],V[X+J]=us[255+ut-gt]}I+=F}}function Fo(h,I,_,F,R,Z){Jo(h,I,_,1,16,F,R,Z)}function ka(h,I,_,F,R,Z){Jo(h,I,1,_,16,F,R,Z)}function bc(h,I,_,F,R,Z){var N;for(N=3;0<N;--N)Rs(h,I+=4*_,_,1,16,F,R,Z)}function CA(h,I,_,F,R,Z){var N;for(N=3;0<N;--N)Rs(h,I+=4,1,_,16,F,R,Z)}function vc(h,I,_,F,R,Z,N,P){Jo(h,I,R,1,8,Z,N,P),Jo(_,F,R,1,8,Z,N,P)}function il(h,I,_,F,R,Z,N,P){Jo(h,I,1,R,8,Z,N,P),Jo(_,F,1,R,8,Z,N,P)}function rl(h,I,_,F,R,Z,N,P){Rs(h,I+4*R,R,1,8,Z,N,P),Rs(_,F+4*R,R,1,8,Z,N,P)}function IA(h,I,_,F,R,Z,N,P){Rs(h,I+4,1,R,8,Z,N,P),Rs(_,F+4,1,R,8,Z,N,P)}function Xo(){this.ba=new Y,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new rt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function La(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ea(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Yo(){this.ua=0,this.Wa=new Rt,this.vb=new Rt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new _t,this.yc=new lt}function Tl(){this.xb=this.a=0,this.l=new Qr,this.ca=new Y,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Yo,this.ab=0,this.gc=g(4,Ea),this.Oc=0}function Ta(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Qr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function jo(h,I,_,F,R,Z,N){for(h=h==null?0:h[I+0],I=0;I<N;++I)R[Z+I]=h+_[F+I]&255,h=R[Z+I]}function ro(h,I,_,F,R,Z,N){var P;if(h==null)jo(null,null,_,F,R,Z,N);else for(P=0;P<N;++P)R[Z+P]=h[I+P]+_[F+P]&255}function qo(h,I,_,F,R,Z,N){if(h==null)jo(null,null,_,F,R,Z,N);else{var P,V=h[I+0],X=V,J=V;for(P=0;P<N;++P)X=J+(V=h[I+P])-X,J=_[F+P]+(-256&X?0>X?0:255:X)&255,X=V,R[Z+P]=J}}function ko(h,I,_,F){var R=I.width,Z=I.o;if(t(h!=null&&I!=null),0>_||0>=F||_+F>Z)return null;if(!h.Cc){if(h.ga==null){var N;if(h.ga=new Ta,(N=h.ga==null)||(N=I.width*I.o,t(h.Gb.length==0),h.Gb=o(N),h.Uc=0,h.Gb==null?N=0:(h.mb=h.Gb,h.nb=h.Uc,h.rc=null,N=1),N=!N),!N){N=h.ga;var P=h.Fa,V=h.P,X=h.qc,J=h.mb,ot=h.nb,dt=V+1,ut=X-1,Gt=N.l;if(t(P!=null&&J!=null&&I!=null),co[0]=null,co[1]=jo,co[2]=ro,co[3]=qo,N.ca=J,N.tb=ot,N.c=I.width,N.i=I.height,t(0<N.c&&0<N.i),1>=X)I=0;else if(N.$a=P[V+0]>>0&3,N.Z=P[V+0]>>2&3,N.Lc=P[V+0]>>4&3,V=P[V+0]>>6&3,0>N.$a||1<N.$a||4<=N.Z||1<N.Lc||V)I=0;else if(Gt.put=Mt,Gt.ac=Xt,Gt.bc=re,Gt.ma=N,Gt.width=I.width,Gt.height=I.height,Gt.Da=I.Da,Gt.v=I.v,Gt.va=I.va,Gt.j=I.j,Gt.o=I.o,N.$a)t:{t(N.$a==1),I=br();e:for(;;){if(I==null){I=0;break t}if(t(N!=null),N.mc=I,I.c=N.c,I.i=N.i,I.l=N.l,I.l.ma=N,I.l.width=N.c,I.l.height=N.i,I.a=0,te(I.m,P,dt,ut),!Tr(N.c,N.i,1,I,null)||(I.ab==1&&I.gc[0].hc==3&&rr(I.s)?(N.ic=1,P=I.c*I.i,I.Ta=null,I.Ua=0,I.V=o(P),I.Ba=0,I.V==null?(I.a=1,I=0):I=1):(N.ic=0,I=Dt(I,N.c)),!I))break e;I=1;break t}N.mc=null,I=0}else I=ut>=N.c*N.i;N=!I}if(N)return null;h.ga.Lc!=1?h.Ga=0:F=Z-_}t(h.ga!=null),t(_+F<=Z);t:{if(I=(P=h.ga).c,Z=P.l.o,P.$a==0){if(dt=h.rc,ut=h.Vc,Gt=h.Fa,V=h.P+1+_*I,X=h.mb,J=h.nb+_*I,t(V<=h.P+h.qc),P.Z!=0)for(t(co[P.Z]!=null),N=0;N<F;++N)co[P.Z](dt,ut,Gt,V,X,J,I),dt=X,ut=J,J+=I,V+=I;else for(N=0;N<F;++N)s(X,J,Gt,V,I),dt=X,ut=J,J+=I,V+=I;h.rc=dt,h.Vc=ut}else{if(t(P.mc!=null),I=_+F,t((N=P.mc)!=null),t(I<=N.i),N.C>=I)I=1;else if(P.ic||ue(),P.ic){P=N.V,dt=N.Ba,ut=N.c;var Pt=N.i,gt=(Gt=1,V=N.$/ut,X=N.$%ut,J=N.m,ot=N.s,N.$),Ct=ut*Pt,ee=ut*I,ge=ot.wc,jt=gt<ee?ii(ot,X,V):null;t(gt<=Ct),t(I<=Pt),t(rr(ot));e:for(;;){for(;!J.h&&gt<ee;){if(X&ge||(jt=ii(ot,X,V)),t(jt!=null),Ot(J),256>(Pt=Xe(jt.G[0],jt.H[0],J)))P[dt+gt]=Pt,++gt,++X>=ut&&(X=0,++V<=I&&!(V%16)&&Cr(N,V));else{if(!(280>Pt)){Gt=0;break e}Pt=pe(Pt-256,J);var Fe,ke=Xe(jt.G[4],jt.H[4],J);if(Ot(J),!(gt>=(ke=me(ut,ke=pe(ke,J)))&&Ct-gt>=Pt)){Gt=0;break e}for(Fe=0;Fe<Pt;++Fe)P[dt+gt+Fe]=P[dt+gt+Fe-ke];for(gt+=Pt,X+=Pt;X>=ut;)X-=ut,++V<=I&&!(V%16)&&Cr(N,V);gt<ee&&X&ge&&(jt=ii(ot,X,V))}t(J.h==It(J))}Cr(N,V>I?I:V);break e}!Gt||J.h&&gt<Ct?(Gt=0,N.a=J.h?5:3):N.$=gt,I=Gt}else I=ki(N,N.V,N.Ba,N.c,N.i,I,Ke);if(!I){F=0;break t}}_+F>=Z&&(h.Cc=1),F=1}if(!F)return null;if(h.Cc&&((F=h.ga)!=null&&(F.mc=null),h.ga=null,0<h.Ga))return alert("todo:WebPDequantizeLevels"),null}return h.nb+_*R}function U(h,I,_,F,R,Z){for(;0<R--;){var N,P=h,V=I+(_?1:0),X=h,J=I+(_?0:3);for(N=0;N<F;++N){var ot=X[J+4*N];ot!=255&&(ot*=32897,P[V+4*N+0]=P[V+4*N+0]*ot>>23,P[V+4*N+1]=P[V+4*N+1]*ot>>23,P[V+4*N+2]=P[V+4*N+2]*ot>>23)}I+=Z}}function it(h,I,_,F,R){for(;0<F--;){var Z;for(Z=0;Z<_;++Z){var N=h[I+2*Z+0],P=15&(X=h[I+2*Z+1]),V=4369*P,X=(240&X|X>>4)*V>>16;h[I+2*Z+0]=(240&N|N>>4)*V>>16&240|(15&N|N<<4)*V>>16>>4&15,h[I+2*Z+1]=240&X|P}I+=R}}function Et(h,I,_,F,R,Z,N,P){var V,X,J=255;for(X=0;X<R;++X){for(V=0;V<F;++V){var ot=h[I+V];Z[N+4*V]=ot,J&=ot}I+=_,N+=P}return J!=255}function Nt(h,I,_,F,R){var Z;for(Z=0;Z<R;++Z)_[F+Z]=h[I+Z]>>8}function ue(){ea=U,cs=it,ao=Et,si=Nt}function we(h,I,_){vt[h]=function(F,R,Z,N,P,V,X,J,ot,dt,ut,Gt,Pt,gt,Ct,ee,ge){var jt,Fe=ge-1>>1,ke=P[V+0]|X[J+0]<<16,Ye=ot[dt+0]|ut[Gt+0]<<16;t(F!=null);var xe=3*ke+Ye+131074>>2;for(I(F[R+0],255&xe,xe>>16,Pt,gt),Z!=null&&(xe=3*Ye+ke+131074>>2,I(Z[N+0],255&xe,xe>>16,Ct,ee)),jt=1;jt<=Fe;++jt){var ci=P[V+jt]|X[J+jt]<<16,pi=ot[dt+jt]|ut[Gt+jt]<<16,Mi=ke+ci+Ye+pi+524296,Si=Mi+2*(ci+Ye)>>3;xe=Si+ke>>1,ke=(Mi=Mi+2*(ke+pi)>>3)+ci>>1,I(F[R+2*jt-1],255&xe,xe>>16,Pt,gt+(2*jt-1)*_),I(F[R+2*jt-0],255&ke,ke>>16,Pt,gt+(2*jt-0)*_),Z!=null&&(xe=Mi+Ye>>1,ke=Si+pi>>1,I(Z[N+2*jt-1],255&xe,xe>>16,Ct,ee+(2*jt-1)*_),I(Z[N+2*jt+0],255&ke,ke>>16,Ct,ee+(2*jt+0)*_)),ke=ci,Ye=pi}1&ge||(xe=3*ke+Ye+131074>>2,I(F[R+ge-1],255&xe,xe>>16,Pt,gt+(ge-1)*_),Z!=null&&(xe=3*Ye+ke+131074>>2,I(Z[N+ge-1],255&xe,xe>>16,Ct,ee+(ge-1)*_)))}}function Ve(){hs[wA]=Bc,hs[BA]=hl,hs[Gl]=ia,hs[ol]=kA,hs[Go]=gl,hs[Hr]=Va,hs[al]=_c,hs[_A]=hl,hs[Al]=kA,hs[xA]=gl,hs[Rl]=Va}function li(h){return h&~xc?0>h?0:255:h>>Ia}function Di(h,I){return li((19077*h>>8)+(26149*I>>8)-14234)}function xi(h,I,_){return li((19077*h>>8)-(6419*I>>8)-(13320*_>>8)+8708)}function ar(h,I){return li((19077*h>>8)+(33050*I>>8)-17685)}function Ci(h,I,_,F,R){F[R+0]=Di(h,_),F[R+1]=xi(h,I,_),F[R+2]=ar(h,I)}function Vr(h,I,_,F,R){F[R+0]=ar(h,I),F[R+1]=xi(h,I,_),F[R+2]=Di(h,_)}function Xi(h,I,_,F,R){var Z=xi(h,I,_);I=Z<<3&224|ar(h,I)>>3,F[R+0]=248&Di(h,_)|Z>>5,F[R+1]=I}function Yi(h,I,_,F,R){var Z=240&ar(h,I)|15;F[R+0]=240&Di(h,_)|xi(h,I,_)>>4,F[R+1]=Z}function un(h,I,_,F,R){F[R+0]=255,Ci(h,I,_,F,R+1)}function hn(h,I,_,F,R){Vr(h,I,_,F,R),F[R+3]=255}function Hs(h,I,_,F,R){Ci(h,I,_,F,R),F[R+3]=255}function $n(h,I){return 0>h?0:h>I?I:h}function Zs(h,I,_){vt[h]=function(F,R,Z,N,P,V,X,J,ot){for(var dt=J+(-2&ot)*_;J!=dt;)I(F[R+0],Z[N+0],P[V+0],X,J),I(F[R+1],Z[N+0],P[V+0],X,J+_),R+=2,++N,++V,J+=2*_;1&ot&&I(F[R+0],Z[N+0],P[V+0],X,J)}}function yA(h,I,_){return _==0?h==0?I==0?6:5:I==0?4:0:_}function bA(h,I,_,F,R){switch(h>>>30){case 3:Ha(I,_,F,R,0);break;case 2:vA(I,_,F,R);break;case 1:Ms(I,_,F,R)}}function ga(h,I){var _,F,R=I.M,Z=I.Nb,N=h.oc,P=h.pc+40,V=h.oc,X=h.pc+584,J=h.oc,ot=h.pc+600;for(_=0;16>_;++_)N[P+32*_-1]=129;for(_=0;8>_;++_)V[X+32*_-1]=129,J[ot+32*_-1]=129;for(0<R?N[P-1-32]=V[X-1-32]=J[ot-1-32]=129:(A(N,P-32-1,127,21),A(V,X-32-1,127,9),A(J,ot-32-1,127,9)),F=0;F<h.za;++F){var dt=I.ya[I.aa+F];if(0<F){for(_=-1;16>_;++_)s(N,P+32*_-4,N,P+32*_+12,4);for(_=-1;8>_;++_)s(V,X+32*_-4,V,X+32*_+4,4),s(J,ot+32*_-4,J,ot+32*_+4,4)}var ut=h.Gd,Gt=h.Hd+F,Pt=dt.ad,gt=dt.Hc;if(0<R&&(s(N,P-32,ut[Gt].y,0,16),s(V,X-32,ut[Gt].f,0,8),s(J,ot-32,ut[Gt].ea,0,8)),dt.Za){var Ct=N,ee=P-32+16;for(0<R&&(F>=h.za-1?A(Ct,ee,ut[Gt].y[15],4):s(Ct,ee,ut[Gt+1].y,0,4)),_=0;4>_;_++)Ct[ee+128+_]=Ct[ee+256+_]=Ct[ee+384+_]=Ct[ee+0+_];for(_=0;16>_;++_,gt<<=2)Ct=N,ee=P+f[_],Ss[dt.Ob[_]](Ct,ee),bA(gt,Pt,16*+_,Ct,ee)}else if(Ct=yA(F,R,dt.Ob[0]),ss[Ct](N,P),gt!=0)for(_=0;16>_;++_,gt<<=2)bA(gt,Pt,16*+_,N,P+f[_]);for(_=dt.Gc,Ct=yA(F,R,dt.Dd),lo[Ct](V,X),lo[Ct](J,ot),gt=Pt,Ct=V,ee=X,255&(dt=_>>0)&&(170&dt?ta(gt,256,Ct,ee):To(gt,256,Ct,ee)),dt=J,gt=ot,255&(_>>=8)&&(170&_?ta(Pt,320,dt,gt):To(Pt,320,dt,gt)),R<h.Ub-1&&(s(ut[Gt].y,0,N,P+480,16),s(ut[Gt].f,0,V,X+224,8),s(ut[Gt].ea,0,J,ot+224,8)),_=8*Z*h.B,ut=h.sa,Gt=h.ta+16*F+16*Z*h.R,Pt=h.qa,dt=h.ra+8*F+_,gt=h.Ha,Ct=h.Ia+8*F+_,_=0;16>_;++_)s(ut,Gt+_*h.R,N,P+32*_,16);for(_=0;8>_;++_)s(Pt,dt+_*h.B,V,X+32*_,8),s(gt,Ct+_*h.B,J,ot+32*_,8)}}function Qa(h,I,_,F,R,Z,N,P,V){var X=[0],J=[0],ot=0,dt=V!=null?V.kd:0,ut=V??new La;if(h==null||12>_)return 7;ut.data=h,ut.w=I,ut.ha=_,I=[I],_=[_],ut.gb=[ut.gb];t:{var Gt=I,Pt=_,gt=ut.gb;if(t(h!=null),t(Pt!=null),t(gt!=null),gt[0]=0,12<=Pt[0]&&!i(h,Gt[0],"RIFF")){if(i(h,Gt[0]+8,"WEBP")){gt=3;break t}var Ct=Me(h,Gt[0]+4);if(12>Ct||4294967286<Ct){gt=3;break t}if(dt&&Ct>Pt[0]-8){gt=7;break t}gt[0]=Ct,Gt[0]+=12,Pt[0]-=12}gt=0}if(gt!=0)return gt;for(Ct=0<ut.gb[0],_=_[0];;){t:{var ee=h;Pt=I,gt=_;var ge=X,jt=J,Fe=Gt=[0];if((xe=ot=[ot])[0]=0,8>gt[0])gt=7;else{if(!i(ee,Pt[0],"VP8X")){if(Me(ee,Pt[0]+4)!=10){gt=3;break t}if(18>gt[0]){gt=7;break t}var ke=Me(ee,Pt[0]+8),Ye=1+je(ee,Pt[0]+12);if(2147483648<=Ye*(ee=1+je(ee,Pt[0]+15))){gt=3;break t}Fe!=null&&(Fe[0]=ke),ge!=null&&(ge[0]=Ye),jt!=null&&(jt[0]=ee),Pt[0]+=18,gt[0]-=18,xe[0]=1}gt=0}}if(ot=ot[0],Gt=Gt[0],gt!=0)return gt;if(Pt=!!(2&Gt),!Ct&&ot)return 3;if(Z!=null&&(Z[0]=!!(16&Gt)),N!=null&&(N[0]=Pt),P!=null&&(P[0]=0),N=X[0],Gt=J[0],ot&&Pt&&V==null){gt=0;break}if(4>_){gt=7;break}if(Ct&&ot||!Ct&&!ot&&!i(h,I[0],"ALPH")){_=[_],ut.na=[ut.na],ut.P=[ut.P],ut.Sa=[ut.Sa];t:{ke=h,gt=I,Ct=_;var xe=ut.gb;ge=ut.na,jt=ut.P,Fe=ut.Sa,Ye=22,t(ke!=null),t(Ct!=null),ee=gt[0];var ci=Ct[0];for(t(ge!=null),t(Fe!=null),ge[0]=null,jt[0]=null,Fe[0]=0;;){if(gt[0]=ee,Ct[0]=ci,8>ci){gt=7;break t}var pi=Me(ke,ee+4);if(4294967286<pi){gt=3;break t}var Mi=8+pi+1&-2;if(Ye+=Mi,0<xe&&Ye>xe){gt=3;break t}if(!i(ke,ee,"VP8 ")||!i(ke,ee,"VP8L")){gt=0;break t}if(ci[0]<Mi){gt=7;break t}i(ke,ee,"ALPH")||(ge[0]=ke,jt[0]=ee+8,Fe[0]=pi),ee+=Mi,ci-=Mi}}if(_=_[0],ut.na=ut.na[0],ut.P=ut.P[0],ut.Sa=ut.Sa[0],gt!=0)break}_=[_],ut.Ja=[ut.Ja],ut.xa=[ut.xa];t:if(xe=h,gt=I,Ct=_,ge=ut.gb[0],jt=ut.Ja,Fe=ut.xa,ke=gt[0],ee=!i(xe,ke,"VP8 "),Ye=!i(xe,ke,"VP8L"),t(xe!=null),t(Ct!=null),t(jt!=null),t(Fe!=null),8>Ct[0])gt=7;else{if(ee||Ye){if(xe=Me(xe,ke+4),12<=ge&&xe>ge-12){gt=3;break t}if(dt&&xe>Ct[0]-8){gt=7;break t}jt[0]=xe,gt[0]+=8,Ct[0]-=8,Fe[0]=Ye}else Fe[0]=5<=Ct[0]&&xe[ke+0]==47&&!(xe[ke+4]>>5),jt[0]=Ct[0];gt=0}if(_=_[0],ut.Ja=ut.Ja[0],ut.xa=ut.xa[0],I=I[0],gt!=0)break;if(4294967286<ut.Ja)return 3;if(P==null||Pt||(P[0]=ut.xa?2:1),N=[N],Gt=[Gt],ut.xa){if(5>_){gt=7;break}P=N,dt=Gt,Pt=Z,h==null||5>_?h=0:5<=_&&h[I+0]==47&&!(h[I+4]>>5)?(Ct=[0],xe=[0],ge=[0],te(jt=new j,h,I,_),ce(jt,Ct,xe,ge)?(P!=null&&(P[0]=Ct[0]),dt!=null&&(dt[0]=xe[0]),Pt!=null&&(Pt[0]=ge[0]),h=1):h=0):h=0}else{if(10>_){gt=7;break}P=Gt,h==null||10>_||!Nr(h,I+3,_-3)?h=0:(dt=h[I+0]|h[I+1]<<8|h[I+2]<<16,Pt=16383&(h[I+7]<<8|h[I+6]),h=16383&(h[I+9]<<8|h[I+8]),1&dt||3<(dt>>1&7)||!(dt>>4&1)||dt>>5>=ut.Ja||!Pt||!h?h=0:(N&&(N[0]=Pt),P&&(P[0]=h),h=1))}if(!h||(N=N[0],Gt=Gt[0],ot&&(X[0]!=N||J[0]!=Gt)))return 3;V!=null&&(V[0]=ut,V.offset=I-V.w,t(4294967286>I-V.w),t(V.offset==V.ha-_));break}return gt==0||gt==7&&ot&&V==null?(Z!=null&&(Z[0]|=ut.na!=null&&0<ut.na.length),F!=null&&(F[0]=N),R!=null&&(R[0]=Gt),0):gt}function Ua(h,I,_){var F=I.width,R=I.height,Z=0,N=0,P=F,V=R;if(I.Da=h!=null&&0<h.Da,I.Da&&(P=h.cd,V=h.bd,Z=h.v,N=h.j,11>_||(Z&=-2,N&=-2),0>Z||0>N||0>=P||0>=V||Z+P>F||N+V>R))return 0;if(I.v=Z,I.j=N,I.va=Z+P,I.o=N+V,I.U=P,I.T=V,I.da=h!=null&&0<h.da,I.da){if(!Li(P,V,_=[h.ib],Z=[h.hb]))return 0;I.ib=_[0],I.hb=Z[0]}return I.ob=h!=null&&h.ob,I.Kb=h==null||!h.Sd,I.da&&(I.ob=I.ib<3*F/4&&I.hb<3*R/4,I.Kb=0),1}function Lo(h){if(h==null)return 2;if(11>h.S){var I=h.f.RGBA;I.fb+=(h.height-1)*I.A,I.A=-I.A}else I=h.f.kb,h=h.height,I.O+=(h-1)*I.fa,I.fa=-I.fa,I.N+=(h-1>>1)*I.Ab,I.Ab=-I.Ab,I.W+=(h-1>>1)*I.Db,I.Db=-I.Db,I.F!=null&&(I.J+=(h-1)*I.lb,I.lb=-I.lb);return 0}function da(h,I,_,F){if(F==null||0>=h||0>=I)return 2;if(_!=null){if(_.Da){var R=_.cd,Z=_.bd,N=-2&_.v,P=-2&_.j;if(0>N||0>P||0>=R||0>=Z||N+R>h||P+Z>I)return 2;h=R,I=Z}if(_.da){if(!Li(h,I,R=[_.ib],Z=[_.hb]))return 2;h=R[0],I=Z[0]}}F.width=h,F.height=I;t:{var V=F.width,X=F.height;if(h=F.S,0>=V||0>=X||!(h>=wA&&13>h))h=2;else{if(0>=F.Rd&&F.sd==null){N=Z=R=I=0;var J=(P=V*H[h])*X;if(11>h||(Z=(X+1)/2*(I=(V+1)/2),h==12&&(N=(R=V)*X)),(X=o(J+2*Z+N))==null){h=1;break t}F.sd=X,11>h?((V=F.f.RGBA).eb=X,V.fb=0,V.A=P,V.size=J):((V=F.f.kb).y=X,V.O=0,V.fa=P,V.Fd=J,V.f=X,V.N=0+J,V.Ab=I,V.Cd=Z,V.ea=X,V.W=0+J+Z,V.Db=I,V.Ed=Z,h==12&&(V.F=X,V.J=0+J+2*Z),V.Tc=N,V.lb=R)}if(I=1,R=F.S,Z=F.width,N=F.height,R>=wA&&13>R)if(11>R)h=F.f.RGBA,I&=(P=Math.abs(h.A))*(N-1)+Z<=h.size,I&=P>=Z*H[R],I&=h.eb!=null;else{h=F.f.kb,P=(Z+1)/2,J=(N+1)/2,V=Math.abs(h.fa),X=Math.abs(h.Ab);var ot=Math.abs(h.Db),dt=Math.abs(h.lb),ut=dt*(N-1)+Z;I&=V*(N-1)+Z<=h.Fd,I&=X*(J-1)+P<=h.Cd,I=(I&=ot*(J-1)+P<=h.Ed)&V>=Z&X>=P&ot>=P,I&=h.y!=null,I&=h.f!=null,I&=h.ea!=null,R==12&&(I&=dt>=Z,I&=ut<=h.Tc,I&=h.F!=null)}else I=0;h=I?0:2}}return h!=0||_!=null&&_.fd&&(h=Lo(F)),h}var ts=64,Ga=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],$o=24,pa=32,nl=8,es=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ne("Predictor0","PredictorAdd0"),vt.Predictor0=function(){return 4278190080},vt.Predictor1=function(h){return h},vt.Predictor2=function(h,I,_){return I[_+0]},vt.Predictor3=function(h,I,_){return I[_+1]},vt.Predictor4=function(h,I,_){return I[_-1]},vt.Predictor5=function(h,I,_){return ze(ze(h,I[_+1]),I[_+0])},vt.Predictor6=function(h,I,_){return ze(h,I[_-1])},vt.Predictor7=function(h,I,_){return ze(h,I[_+0])},vt.Predictor8=function(h,I,_){return ze(I[_-1],I[_+0])},vt.Predictor9=function(h,I,_){return ze(I[_+0],I[_+1])},vt.Predictor10=function(h,I,_){return ze(ze(h,I[_-1]),ze(I[_+0],I[_+1]))},vt.Predictor11=function(h,I,_){var F=I[_+0];return 0>=Ei(F>>24&255,h>>24&255,(I=I[_-1])>>24&255)+Ei(F>>16&255,h>>16&255,I>>16&255)+Ei(F>>8&255,h>>8&255,I>>8&255)+Ei(255&F,255&h,255&I)?F:h},vt.Predictor12=function(h,I,_){var F=I[_+0];return(ui((h>>24&255)+(F>>24&255)-((I=I[_-1])>>24&255))<<24|ui((h>>16&255)+(F>>16&255)-(I>>16&255))<<16|ui((h>>8&255)+(F>>8&255)-(I>>8&255))<<8|ui((255&h)+(255&F)-(255&I)))>>>0},vt.Predictor13=function(h,I,_){var F=I[_-1];return(hi((h=ze(h,I[_+0]))>>24&255,F>>24&255)<<24|hi(h>>16&255,F>>16&255)<<16|hi(h>>8&255,F>>8&255)<<8|hi(h>>0&255,F>>0&255))>>>0};var zr=vt.PredictorAdd0;vt.PredictorAdd1=Pi,Ne("Predictor2","PredictorAdd2"),Ne("Predictor3","PredictorAdd3"),Ne("Predictor4","PredictorAdd4"),Ne("Predictor5","PredictorAdd5"),Ne("Predictor6","PredictorAdd6"),Ne("Predictor7","PredictorAdd7"),Ne("Predictor8","PredictorAdd8"),Ne("Predictor9","PredictorAdd9"),Ne("Predictor10","PredictorAdd10"),Ne("Predictor11","PredictorAdd11"),Ne("Predictor12","PredictorAdd12"),Ne("Predictor13","PredictorAdd13");var Ps=vt.PredictorAdd2;Vi("ColorIndexInverseTransform","MapARGB","32b",function(h){return h>>8&255},function(h){return h}),Vi("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(h){return h},function(h){return h>>8&255});var Wn,On=vt.ColorIndexInverseTransform,Ra=vt.MapARGB,sl=vt.VP8LColorIndexInverseTransformAlpha,fa=vt.MapAlpha,ls=vt.VP8LPredictorsAdd=[];ls.length=16,(vt.VP8LPredictors=[]).length=16,(vt.VP8LPredictorsAdd_C=[]).length=16,(vt.VP8LPredictors_C=[]).length=16;var xn,is,Eo,_s,no,ma,fn,Ha,vA,ta,Ms,To,so,Qo,Jr,xs,zn,gn,Uo,pr,kr,en,yn,oo,ea,cs,ao,si,Ql=o(511),Ca=o(2041),Za=o(225),Ul=o(767),ei=0,Pa=Ca,Ma=Za,us=Ul,rs=Ql,wA=0,BA=1,Gl=2,ol=3,Go=4,Hr=5,al=6,_A=7,Al=8,xA=9,Rl=10,dh=[2,3,7],Ao=[3,3,11],SA=[280,256,256,256,40],wi=[0,1,1,1,0],Hi=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Na=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],wc=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ll=8,Jn=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Hl=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ns=null,ou=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],FA=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Xr=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],dn=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],au=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],cl=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Zl=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ss=[],Ss=[],lo=[],ul=1,Pl=2,co=[],hs=[];we("UpsampleRgbLinePair",Ci,3),we("UpsampleBgrLinePair",Vr,3),we("UpsampleRgbaLinePair",Hs,4),we("UpsampleBgraLinePair",hn,4),we("UpsampleArgbLinePair",un,4),we("UpsampleRgba4444LinePair",Yi,2),we("UpsampleRgb565LinePair",Xi,2);var Bc=vt.UpsampleRgbLinePair,ia=vt.UpsampleBgrLinePair,hl=vt.UpsampleRgbaLinePair,kA=vt.UpsampleBgraLinePair,gl=vt.UpsampleArgbLinePair,Va=vt.UpsampleRgba4444LinePair,_c=vt.UpsampleRgb565LinePair,ra=16,uo=1<<ra-1,Da=-227,LA=482,Ia=6,xc=(256<<Ia)-1,Ml=0,Sc=o(256),Au=o(256),y=o(256),n=o(256),c=o(LA-Da),p=o(LA-Da);Zs("YuvToRgbRow",Ci,3),Zs("YuvToBgrRow",Vr,3),Zs("YuvToRgbaRow",Hs,4),Zs("YuvToBgraRow",hn,4),Zs("YuvToArgbRow",un,4),Zs("YuvToRgba4444Row",Yi,2),Zs("YuvToRgb565Row",Xi,2);var f=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],b=[0,2,8],L=[8,7,6,4,4,2,2,2,1,1,1,1],E=1;this.WebPDecodeRGBA=function(h,I,_,F,R){var Z=BA,N=new Xo,P=new Y;N.ba=P,P.S=Z,P.width=[P.width],P.height=[P.height];var V=P.width,X=P.height,J=new q;if(J==null||h==null)var ot=2;else t(J!=null),ot=Qa(h,I,_,J.width,J.height,J.Pd,J.Qd,J.format,null);if(ot!=0?V=0:(V!=null&&(V[0]=J.width[0]),X!=null&&(X[0]=J.height[0]),V=1),V){P.width=P.width[0],P.height=P.height[0],F!=null&&(F[0]=P.width),R!=null&&(R[0]=P.height);t:{if(F=new Qr,(R=new La).data=h,R.w=I,R.ha=_,R.kd=1,I=[0],t(R!=null),((h=Qa(R.data,R.w,R.ha,null,null,null,I,null,R))==0||h==7)&&I[0]&&(h=4),(I=h)==0){if(t(N!=null),F.data=R.data,F.w=R.w+R.offset,F.ha=R.ha-R.offset,F.put=Mt,F.ac=Xt,F.bc=re,F.ma=N,R.xa){if((h=br())==null){N=1;break t}if(function(dt,ut){var Gt=[0],Pt=[0],gt=[0];e:for(;;){if(dt==null)return 0;if(ut==null)return dt.a=2,0;if(dt.l=ut,dt.a=0,te(dt.m,ut.data,ut.w,ut.ha),!ce(dt.m,Gt,Pt,gt)){dt.a=3;break e}if(dt.xb=Pl,ut.width=Gt[0],ut.height=Pt[0],!Tr(Gt[0],Pt[0],1,dt,null))break e;return 1}return t(dt.a!=0),0}(h,F)){if(F=(I=da(F.width,F.height,N.Oa,N.ba))==0){e:{F=h;i:for(;;){if(F==null){F=0;break e}if(t(F.s.yc!=null),t(F.s.Ya!=null),t(0<F.s.Wb),t((_=F.l)!=null),t((R=_.ma)!=null),F.xb!=0){if(F.ca=R.ba,F.tb=R.tb,t(F.ca!=null),!Ua(R.Oa,_,ol)){F.a=2;break i}if(!Dt(F,_.width)||_.da)break i;if((_.da||tr(F.ca.S))&&ue(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&ue()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!gi(F.s.vb,F.s.Wa.Xa)){F.a=1;break i}F.xb=0}if(!ki(F,F.V,F.Ba,F.c,F.i,_.o,Qi))break i;R.Dc=F.Ma,F=1;break e}t(F.a!=0),F=0}F=!F}F&&(I=h.a)}else I=h.a}else{if((h=new zo)==null){N=1;break t}if(h.Fa=R.na,h.P=R.P,h.qc=R.Sa,Gs(h,F)){if((I=da(F.width,F.height,N.Oa,N.ba))==0){if(h.Aa=0,_=N.Oa,t((R=h)!=null),_!=null){if(0<(V=0>(V=_.Md)?0:100<V?255:255*V/100)){for(X=J=0;4>X;++X)12>(ot=R.pb[X]).lc&&(ot.ia=V*L[0>ot.lc?0:ot.lc]>>3),J|=ot.ia;J&&(alert("todo:VP8InitRandom"),R.ia=1)}R.Ga=_.Id,100<R.Ga?R.Ga=100:0>R.Ga&&(R.Ga=0)}pt(h,F)||(I=h.a)}}else I=h.a}I==0&&N.Oa!=null&&N.Oa.fd&&(I=Lo(N.ba))}N=I}Z=N!=0?null:11>Z?P.f.RGBA.eb:P.f.kb.y}else Z=null;return Z};var H=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function v(vt,Jt){for(var qt="",At=0;At<4;At++)qt+=String.fromCharCode(vt[Jt++]);return qt}function x(vt,Jt){return(vt[Jt+0]<<0|vt[Jt+1]<<8|vt[Jt+2]<<16)>>>0}function T(vt,Jt){return(vt[Jt+0]<<0|vt[Jt+1]<<8|vt[Jt+2]<<16|vt[Jt+3]<<24)>>>0}new C;var G=[0],k=[0],W=[],K=new C,$=r,O=function(vt,Jt){var qt={},At=0,lt=!1,kt=0,_t=0;if(qt.frames=[],!function(bt,It,Ht,Ot){for(var Ae=0;Ae<Ot;Ae++)if(bt[It+Ae]!=Ht.charCodeAt(Ae))return!0;return!1}(vt,Jt,"RIFF",4)){var le,ie;for(T(vt,Jt+=4),Jt+=8;Jt<vt.length;){var ne=v(vt,Jt),te=T(vt,Jt+=4);Jt+=4;var wt=te+(1&te);switch(ne){case"VP8 ":case"VP8L":qt.frames[At]===void 0&&(qt.frames[At]={}),(j=qt.frames[At]).src_off=lt?_t:Jt-8,j.src_size=kt+te+8,At++,lt&&(lt=!1,kt=0,_t=0);break;case"VP8X":(j=qt.header={}).feature_flags=vt[Jt];var Ut=Jt+4;j.canvas_width=1+x(vt,Ut),Ut+=3,j.canvas_height=1+x(vt,Ut),Ut+=3;break;case"ALPH":lt=!0,kt=wt+8,_t=Jt-8;break;case"ANIM":(j=qt.header).bgcolor=T(vt,Jt),Ut=Jt+4,j.loop_count=(le=vt)[(ie=Ut)+0]<<0|le[ie+1]<<8,Ut+=2;break;case"ANMF":var fe,j;(j=qt.frames[At]={}).offset_x=2*x(vt,Jt),Jt+=3,j.offset_y=2*x(vt,Jt),Jt+=3,j.width=1+x(vt,Jt),Jt+=3,j.height=1+x(vt,Jt),Jt+=3,j.duration=x(vt,Jt),Jt+=3,fe=vt[Jt++],j.dispose=1&fe,j.blend=fe>>1&1}ne!="ANMF"&&(Jt+=wt)}return qt}}($,0);O.response=$,O.rgbaoutput=!0,O.dataurl=!1;var tt=O.header?O.header:null,at=O.frames?O.frames:null;if(tt){tt.loop_counter=tt.loop_count,G=[tt.canvas_height],k=[tt.canvas_width];for(var Lt=0;Lt<at.length&&at[Lt].blend!=0;Lt++);}var Tt=at[0],Qt=K.WebPDecodeRGBA($,Tt.src_off,Tt.src_size,k,G);Tt.rgba=Qt,Tt.imgwidth=k[0],Tt.imgheight=G[0];for(var Ft=0;Ft<k[0]*G[0]*4;Ft++)W[Ft]=Qt[Ft];return this.width=k,this.height=G,this.data=W,this}var w5,W6,O6,on,$f,wo,Bo,Dg,rm,nm,Ly,B5,_5,x5,Ey,S5,z6,e5,Ty,kl,Kr,$A,mc,Kr,Kr,Kr,Kr,Kg,Kr,J6,X6,Y6,j6,vy,uA,wy,Dy,F5,q6,Ll,Pg,By,Qy,i5,Mg,Jf,r5,$6,tD,eD,iD,rD,nD,sD,oD,ir,sn,Vg,Gy,iu,s5,uD,o5,Bn,Ky,su,nh,gr,dc,Ko,A5,jA,hD,gD,dD,Mn,Nn,Vn,pD,fD,Zy,Wf,mD,CD,ID,yD,T5,Fy,qA,Q5,U5,gA,ch,uh,hh,Xf,ys,Yf,gh,em,jf,nu,qf,Ti,bD,R5,H5,Py,Z5,vD,wD,c5,Of,g5,d5,p5,sh,zf,f5,m5,C5,SD,dA,Cc,kD,LD,tl,ED,b5,P5,TD,QD,UD,GD,RD,HD,ZD,M5,PD,MD,ND,VD,DD,pc,Wg,lh,Ng,Ny,Vy,im,v5,KD,WD,OD,zD,JD,XD,YD,jD,qD,$D,N5,Og,by=dd(()=>{w5=pd(Xm(),1),W6=Object.defineProperty,O6=(r,t,i)=>t in r?W6(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i,on=(r,t,i)=>(O6(r,typeof t!="symbol"?t+"":t,i),i),$f=class{constructor(t){on(this,"map"),on(this,"width"),on(this,"height"),on(this,"svgCanvas"),on(this,"xLine"),on(this,"yLine"),on(this,"color","#535353"),this.map=t,this.mapResize=this.mapResize.bind(this)}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var t,i;this.width=(t=this.map)==null?void 0:t.getCanvas().clientWidth,this.height=(i=this.map)==null?void 0:i.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);let t=this.width/2,i=this.height/2;this.yLine.setAttribute("x1",`${t}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${t}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1","0px"),this.xLine.setAttribute("y1",`${i}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${i}px`)}else console.error("element value is null")}createCanvas(t){if(this.width!==void 0&&this.height!==void 0){let i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.style.position="relative",i.setAttribute("width",`${this.width}px`),i.setAttribute("height",`${this.height}px`);let s=this.width/2,A=this.height/2;this.yLine=i.appendChild(this.createLine(s,0,s,this.height,this.color,"2px")),this.xLine=i.appendChild(this.createLine(0,A,this.width,A,this.color,"2px")),t?.appendChild(i),this.svgCanvas=i}}createLine(t,i,s,A,o,g){let d=document.createElementNS("http://www.w3.org/2000/svg","line");return d.setAttribute("x1",t),d.setAttribute("y1",i),d.setAttribute("x2",s),d.setAttribute("y2",A),d.setAttribute("stroke-dasharray","5,5"),d.setAttribute("stroke",o),d.setAttribute("stroke-width",g),d}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}};wo=Uint8Array,Bo=Uint16Array,Dg=Uint32Array,rm=new wo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nm=new wo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ly=new wo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),B5=function(r,t){for(var i=new Bo(31),s=0;s<31;++s)i[s]=t+=1<<r[s-1];for(var A=new Dg(i[30]),s=1;s<30;++s)for(var o=i[s];o<i[s+1];++o)A[o]=o-i[s]<<5|s;return[i,A]},_5=B5(rm,2),x5=_5[0],Ey=_5[1];x5[28]=258,Ey[258]=28;S5=B5(nm,0),z6=S5[0],e5=S5[1],Ty=new Bo(32768);for(Kr=0;Kr<32768;++Kr)kl=(Kr&43690)>>>1|(Kr&21845)<<1,kl=(kl&52428)>>>2|(kl&13107)<<2,kl=(kl&61680)>>>4|(kl&3855)<<4,Ty[Kr]=((kl&65280)>>>8|(kl&255)<<8)>>>1;$A=function(r,t,i){for(var s=r.length,A=0,o=new Bo(t);A<s;++A)++o[r[A]-1];var g=new Bo(t);for(A=0;A<t;++A)g[A]=g[A-1]+o[A-1]<<1;var d;if(i){d=new Bo(1<<t);var C=15-t;for(A=0;A<s;++A)if(r[A])for(var v=A<<4|r[A],x=t-r[A],T=g[r[A]-1]++<<x,G=T|(1<<x)-1;T<=G;++T)d[Ty[T]>>>C]=v}else for(d=new Bo(s),A=0;A<s;++A)d[A]=Ty[g[r[A]-1]++]>>>15-r[A];return d},mc=new wo(288);for(Kr=0;Kr<144;++Kr)mc[Kr]=8;for(Kr=144;Kr<256;++Kr)mc[Kr]=9;for(Kr=256;Kr<280;++Kr)mc[Kr]=7;for(Kr=280;Kr<288;++Kr)mc[Kr]=8;Kg=new wo(32);for(Kr=0;Kr<32;++Kr)Kg[Kr]=5;J6=$A(mc,9,0),X6=$A(mc,9,1),Y6=$A(Kg,5,0),j6=$A(Kg,5,1),vy=function(r){for(var t=r[0],i=1;i<r.length;++i)r[i]>t&&(t=r[i]);return t},uA=function(r,t,i){var s=t/8>>0;return(r[s]|r[s+1]<<8)>>>(t&7)&i},wy=function(r,t){var i=t/8>>0;return(r[i]|r[i+1]<<8|r[i+2]<<16)>>>(t&7)},Dy=function(r){return(r/8>>0)+(r&7&&1)},F5=function(r,t,i){(t==null||t<0)&&(t=0),(i==null||i>r.length)&&(i=r.length);var s=new(r instanceof Bo?Bo:r instanceof Dg?Dg:wo)(i-t);return s.set(r.subarray(t,i)),s},q6=function(r,t,i){var s=r.length,A=!t||i,o=!i||i.i;i||(i={}),t||(t=new wo(s*3));var g=function(Ot){var Ae=t.length;if(Ot>Ae){var he=new wo(Math.max(Ae*2,Ot));he.set(t),t=he}},d=i.f||0,C=i.p||0,v=i.b||0,x=i.l,T=i.d,G=i.m,k=i.n,W=s*8;do{if(!x){i.f=d=uA(r,C,1);var K=uA(r,C+1,3);if(C+=3,K)if(K==1)x=X6,T=j6,G=9,k=5;else if(K==2){var $=uA(r,C,31)+257,O=uA(r,C+10,15)+4,tt=$+uA(r,C+5,31)+1;C+=14;for(var at=new wo(tt),Lt=new wo(19),Tt=0;Tt<O;++Tt)Lt[Ly[Tt]]=uA(r,C+Tt*3,7);C+=O*3;var Qt=vy(Lt),Ft=(1<<Qt)-1;if(!o&&C+tt*(Qt+7)>W)break;for(var vt=$A(Lt,Qt,1),Tt=0;Tt<tt;){var Jt=vt[uA(r,C,Ft)];C+=Jt&15;var qt=Jt>>>4;if(qt<16)at[Tt++]=qt;else{var At=0,lt=0;for(qt==16?(lt=3+uA(r,C,3),C+=2,At=at[Tt-1]):qt==17?(lt=3+uA(r,C,7),C+=3):qt==18&&(lt=11+uA(r,C,127),C+=7);lt--;)at[Tt++]=At}}var kt=at.subarray(0,$),_t=at.subarray($);G=vy(kt),k=vy(_t),x=$A(kt,G,1),T=$A(_t,k,1)}else throw"invalid block type";else{var qt=Dy(C)+4,le=r[qt-4]|r[qt-3]<<8,ie=qt+le;if(ie>s){if(o)throw"unexpected EOF";break}A&&g(v+le),t.set(r.subarray(qt,ie),v),i.b=v+=le,i.p=C=ie*8;continue}if(C>W)throw"unexpected EOF"}A&&g(v+131072);for(var ne=(1<<G)-1,te=(1<<k)-1,wt=G+k+18;o||C+wt<W;){var At=x[wy(r,C)&ne],Ut=At>>>4;if(C+=At&15,C>W)throw"unexpected EOF";if(!At)throw"invalid length/literal";if(Ut<256)t[v++]=Ut;else if(Ut==256){x=null;break}else{var fe=Ut-254;if(Ut>264){var Tt=Ut-257,j=rm[Tt];fe=uA(r,C,(1<<j)-1)+x5[Tt],C+=j}var bt=T[wy(r,C)&te],It=bt>>>4;if(!bt)throw"invalid distance";C+=bt&15;var _t=z6[It];if(It>3){var j=nm[It];_t+=wy(r,C)&(1<<j)-1,C+=j}if(C>W)throw"unexpected EOF";A&&g(v+131072);for(var Ht=v+fe;v<Ht;v+=4)t[v]=t[v-_t],t[v+1]=t[v+1-_t],t[v+2]=t[v+2-_t],t[v+3]=t[v+3-_t];v=Ht}}i.l=x,i.p=C,i.b=v,x&&(d=1,i.m=G,i.d=T,i.n=k)}while(!d);return v==t.length?t:F5(t,0,v)},Ll=function(r,t,i){i<<=t&7;var s=t/8>>0;r[s]|=i,r[s+1]|=i>>>8},Pg=function(r,t,i){i<<=t&7;var s=t/8>>0;r[s]|=i,r[s+1]|=i>>>8,r[s+2]|=i>>>16},By=function(r,t){for(var i=[],s=0;s<r.length;++s)r[s]&&i.push({s,f:r[s]});var A=i.length,o=i.slice();if(!A)return[new wo(0),0];if(A==1){var g=new wo(i[0].s+1);return g[i[0].s]=1,[g,1]}i.sort(function(Tt,Qt){return Tt.f-Qt.f}),i.push({s:-1,f:25001});var d=i[0],C=i[1],v=0,x=1,T=2;for(i[0]={s:-1,f:d.f+C.f,l:d,r:C};x!=A-1;)d=i[i[v].f<i[T].f?v++:T++],C=i[v!=x&&i[v].f<i[T].f?v++:T++],i[x++]={s:-1,f:d.f+C.f,l:d,r:C};for(var G=o[0].s,s=1;s<A;++s)o[s].s>G&&(G=o[s].s);var k=new Bo(G+1),W=Qy(i[x-1],k,0);if(W>t){var s=0,K=0,$=W-t,O=1<<$;for(o.sort(function(Qt,Ft){return k[Ft.s]-k[Qt.s]||Qt.f-Ft.f});s<A;++s){var tt=o[s].s;if(k[tt]>t)K+=O-(1<<W-k[tt]),k[tt]=t;else break}for(K>>>=$;K>0;){var at=o[s].s;k[at]<t?K-=1<<t-k[at]++-1:++s}for(;s>=0&&K;--s){var Lt=o[s].s;k[Lt]==t&&(--k[Lt],++K)}W=t}return[new wo(k),W]},Qy=function(r,t,i){return r.s==-1?Math.max(Qy(r.l,t,i+1),Qy(r.r,t,i+1)):t[r.s]=i},i5=function(r){for(var t=r.length;t&&!r[--t];);for(var i=new Bo(++t),s=0,A=r[0],o=1,g=function(C){i[s++]=C},d=1;d<=t;++d)if(r[d]==A&&d!=t)++o;else{if(!A&&o>2){for(;o>138;o-=138)g(32754);o>2&&(g(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(g(A),--o;o>6;o-=6)g(8304);o>2&&(g(o-3<<5|8208),o=0)}for(;o--;)g(A);o=1,A=r[d]}return[i.subarray(0,s),t]},Mg=function(r,t){for(var i=0,s=0;s<t.length;++s)i+=r[s]*t[s];return i},Jf=function(r,t,i){var s=i.length,A=Dy(t+2);r[A]=s&255,r[A+1]=s>>>8,r[A+2]=r[A]^255,r[A+3]=r[A+1]^255;for(var o=0;o<s;++o)r[A+o+4]=i[o];return(A+4+s)*8},r5=function(r,t,i,s,A,o,g,d,C,v,x){Ll(t,x++,i),++A[256];for(var T=By(A,15),G=T[0],k=T[1],W=By(o,15),K=W[0],$=W[1],O=i5(G),tt=O[0],at=O[1],Lt=i5(K),Tt=Lt[0],Qt=Lt[1],Ft=new Bo(19),vt=0;vt<tt.length;++vt)Ft[tt[vt]&31]++;for(var vt=0;vt<Tt.length;++vt)Ft[Tt[vt]&31]++;for(var Jt=By(Ft,7),qt=Jt[0],At=Jt[1],lt=19;lt>4&&!qt[Ly[lt-1]];--lt);var kt=v+5<<3,_t=Mg(A,mc)+Mg(o,Kg)+g,le=Mg(A,G)+Mg(o,K)+g+14+3*lt+Mg(Ft,qt)+(2*Ft[16]+3*Ft[17]+7*Ft[18]);if(kt<=_t&&kt<=le)return Jf(t,x,r.subarray(C,C+v));var ie,ne,te,wt;if(Ll(t,x,1+(le<_t)),x+=2,le<_t){ie=$A(G,k,0),ne=G,te=$A(K,$,0),wt=K;var Ut=$A(qt,At,0);Ll(t,x,at-257),Ll(t,x+5,Qt-1),Ll(t,x+10,lt-4),x+=14;for(var vt=0;vt<lt;++vt)Ll(t,x+3*vt,qt[Ly[vt]]);x+=3*lt;for(var fe=[tt,Tt],j=0;j<2;++j)for(var bt=fe[j],vt=0;vt<bt.length;++vt){var It=bt[vt]&31;Ll(t,x,Ut[It]),x+=qt[It],It>15&&(Ll(t,x,bt[vt]>>>5&127),x+=bt[vt]>>>12)}}else ie=J6,ne=mc,te=Y6,wt=Kg;for(var vt=0;vt<d;++vt)if(s[vt]>255){var It=s[vt]>>>18&31;Pg(t,x,ie[It+257]),x+=ne[It+257],It>7&&(Ll(t,x,s[vt]>>>23&31),x+=rm[It]);var Ht=s[vt]&31;Pg(t,x,te[Ht]),x+=wt[Ht],Ht>3&&(Pg(t,x,s[vt]>>>5&8191),x+=nm[Ht])}else Pg(t,x,ie[s[vt]]),x+=ne[s[vt]];return Pg(t,x,ie[256]),x+ne[256]},$6=new Dg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),tD=new wo(0),eD=function(r,t,i,s,A,o){var g=r.length,d=new wo(s+g+5*(1+Math.floor(g/7e3))+A),C=d.subarray(s,d.length-A),v=0;if(!t||g<8)for(var x=0;x<=g;x+=65535){var T=x+65535;T<g?v=Jf(C,v,r.subarray(x,T)):(C[x]=o,v=Jf(C,v,r.subarray(x,g)))}else{for(var G=$6[t-1],k=G>>>13,W=G&8191,K=(1<<i)-1,$=new Bo(32768),O=new Bo(K+1),tt=Math.ceil(i/3),at=2*tt,Lt=function(gi){return(r[gi]^r[gi+1]<<tt^r[gi+2]<<at)&K},Tt=new Dg(25e3),Qt=new Bo(288),Ft=new Bo(32),vt=0,Jt=0,x=0,qt=0,At=0,lt=0;x<g;++x){var kt=Lt(x),_t=x&32767,le=O[kt];if($[_t]=le,O[kt]=_t,At<=x){var ie=g-x;if((vt>7e3||qt>24576)&&ie>423){v=r5(r,C,0,Tt,Qt,Ft,Jt,qt,lt,x-lt,v),qt=vt=Jt=0,lt=x;for(var ne=0;ne<286;++ne)Qt[ne]=0;for(var ne=0;ne<30;++ne)Ft[ne]=0}var te=2,wt=0,Ut=W,fe=_t-le&32767;if(ie>2&&kt==Lt(x-fe))for(var j=Math.min(k,ie)-1,bt=Math.min(32767,x),It=Math.min(258,ie);fe<=bt&&--Ut&&_t!=le;){if(r[x+te]==r[x+te-fe]){for(var Ht=0;Ht<It&&r[x+Ht]==r[x+Ht-fe];++Ht);if(Ht>te){if(te=Ht,wt=fe,Ht>j)break;for(var Ot=Math.min(fe,Ht-2),Ae=0,ne=0;ne<Ot;++ne){var he=x-fe+ne+32768&32767,de=$[he],He=he-de+32768&32767;He>Ae&&(Ae=He,le=he)}}}_t=le,le=$[_t],fe+=_t-le+32768&32767}if(wt){Tt[qt++]=268435456|Ey[te]<<18|e5[wt];var Re=Ey[te]&31,je=e5[wt]&31;Jt+=rm[Re]+nm[je],++Qt[257+Re],++Ft[je],At=x+te,++vt}else Tt[qt++]=r[x],++Qt[r[x]]}}v=r5(r,C,o,Tt,Qt,Ft,Jt,qt,lt,x-lt,v),o||(v=Jf(C,v,tD))}return F5(d,0,s+Dy(v)+A)},iD=function(){var r=1,t=0;return{p:function(i){for(var s=r,A=t,o=i.length,g=0;g!=o;){for(var d=Math.min(g+5552,o);g<d;++g)s+=i[g],A+=s;s%=65521,A%=65521}r=s,t=A},d:function(){return(r>>>8<<16|(t&255)<<8|t>>>8)+((r&255)<<23)*2}}},rD=function(r,t,i,s,A){return eD(r,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):12+t.mem,i,s,!A)},nD=function(r,t,i){for(;i;++t)r[t]=i,i>>>=8},sD=function(r,t){var i=t.level,s=i==0?0:i<6?1:i==9?3:2;r[0]=120,r[1]=s<<6|(s?32-2*s:1)},oD=function(r){if((r[0]&15)!=8||r[0]>>>4>7||(r[0]<<8|r[1])%31)throw"invalid zlib data";if(r[1]&32)throw"invalid zlib data: preset dictionaries not supported"};ir=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();sn={log:_y,warn:function(r){ir.console&&(typeof ir.console.warn=="function"?ir.console.warn.apply(ir.console,arguments):_y.call(null,arguments))},error:function(r){ir.console&&(typeof ir.console.error=="function"?ir.console.error.apply(ir.console,arguments):_y(r))}};iu=ir.saveAs||((typeof window>"u"?"undefined":Rr(window))!=="object"||window!==ir?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,t,i){var s=ir.URL||ir.webkitURL,A=document.createElement("a");t=t||r.name||"download",A.download=t,A.rel="noopener",typeof r=="string"?(A.href=r,A.origin!==location.origin?n5(A.href)?xy(r,t,i):Kf(A,A.target="_blank"):Kf(A)):(A.href=s.createObjectURL(r),setTimeout(function(){s.revokeObjectURL(A.href)},4e4),setTimeout(function(){Kf(A)},0))}:"msSaveOrOpenBlob"in navigator?function(r,t,i){if(t=t||r.name||"download",typeof r=="string")if(n5(r))xy(r,t,i);else{var s=document.createElement("a");s.href=r,s.target="_blank",setTimeout(function(){Kf(s)})}else navigator.msSaveOrOpenBlob(function(A,o){return o===void 0?o={autoBom:!1}:Rr(o)!=="object"&&(sn.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(A.type)?new Blob(["\uFEFF",A],{type:A.type}):A}(r,i),t)}:function(r,t,i,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof r=="string")return xy(r,t,i);var A=r.type==="application/octet-stream",o=/constructor/i.test(ir.HTMLElement)||ir.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||A&&o)&&(typeof FileReader>"u"?"undefined":Rr(FileReader))==="object"){var d=new FileReader;d.onloadend=function(){var x=d.result;x=g?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=x:location=x,s=null},d.readAsDataURL(r)}else{var C=ir.URL||ir.webkitURL,v=C.createObjectURL(r);s?s.location=v:location.href=v,s=null,setTimeout(function(){C.revokeObjectURL(v)},4e4)}});Vg=ir.atob.bind(ir),Gy=ir.btoa.bind(ir);s5="0123456789abcdef".split("");uD=function(r){for(var t=0;t<r.length;t++)r[t]=lD(r[t]);return r.join("")}(L5("hello"))!="5d41402abc4b2a76b9719d911017c592";o5={print:4,modify:8,copy:16,"annot-forms":32};oh.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},oh.prototype.toHexString=function(r){return r.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},oh.prototype.hexToBytes=function(r){for(var t=[],i=0;i<r.length;i+=2)t.push(String.fromCharCode(parseInt(r.substr(i,2),16)));return t.join("")},oh.prototype.processOwnerPassword=function(r,t){return Hy(Ry(t).substr(0,5),r)},oh.prototype.encryptor=function(r,t){var i=Ry(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&t,t>>8&255)).substr(0,10);return function(s){return Hy(i,s)}},tm.prototype.equals=function(r){var t,i="id,objectNumber,equals";if(!r||Rr(r)!==Rr(this))return!1;var s=0;for(t in this)if(!(i.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!r.hasOwnProperty(t)||this[t]!==r[t])return!1;s++}for(t in r)r.hasOwnProperty(t)&&i.indexOf(t)<0&&s--;return s===0},er.API={events:[]},er.version="2.5.1";Bn=er.API,Ky=1,su=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},nh=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},gr=function(r){return r.toFixed(2)},dc=function(r){return r.toFixed(5)};Bn.__acroform__={};Ko=function(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r},A5=function(r){return r*Ky},jA=function(r){var t=new Q5,i=Ti.internal.getHeight(r)||0,s=Ti.internal.getWidth(r)||0;return t.BBox=[0,0,Number(gr(s)),Number(gr(i))],t},hD=Bn.__acroform__.setBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<t},gD=Bn.__acroform__.clearBit=function(r,t){if(r=r||0,t=t||0,isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<t)},dD=Bn.__acroform__.getBit=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<t?1:0},Mn=Bn.__acroform__.getBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return dD(r,t-1)},Nn=Bn.__acroform__.setBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return hD(r,t-1)},Vn=Bn.__acroform__.clearBitForPdf=function(r,t){if(isNaN(r)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return gD(r,t-1)},pD=Bn.__acroform__.calculateCoordinates=function(r,t){var i=t.internal.getHorizontalCoordinate,s=t.internal.getVerticalCoordinate,A=r[0],o=r[1],g=r[2],d=r[3],C={};return C.lowerLeft_X=i(A)||0,C.lowerLeft_Y=s(o+d)||0,C.upperRight_X=i(A+g)||0,C.upperRight_Y=s(o)||0,[Number(gr(C.lowerLeft_X)),Number(gr(C.lowerLeft_Y)),Number(gr(C.upperRight_X)),Number(gr(C.upperRight_Y))]},fD=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var t=[],i=r._V||r.DV,s=Zy(r,i),A=r.scope.internal.getFont(r.fontName,r.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(r.scope.__private__.encodeColorString(r.color)),t.push("/"+A+" "+gr(s.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC");var o=jA(r);return o.scope=r.scope,o.stream=t.join(`
`),o}},Zy=function(r,t){var i=r.fontSize===0?r.maxFontSize:r.fontSize,s={text:"",fontSize:""},A=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");A=r.multiline?A.map(function(At){return At.split(`
`)}):A.map(function(At){return[At]});var o=i,g=Ti.internal.getHeight(r)||0;g=g<0?-g:g;var d=Ti.internal.getWidth(r)||0;d=d<0?-d:d;var C=function(At,lt,kt){if(At+1<A.length){var _t=lt+" "+A[At+1][0];return Wf(_t,r,kt).width<=d-4}return!1};o++;t:for(;o>0;){t="",o--;var v,x,T=Wf("3",r,o).height,G=r.multiline?g-o:(g-T)/2,k=G+=2,W=0,K=0,$=0;if(o<=0){t=`(...) Tj
`,t+="% Width of Text: "+Wf(t,r,o=12).width+", FieldWidth:"+d+`
`;break}for(var O="",tt=0,at=0;at<A.length;at++)if(A.hasOwnProperty(at)){var Lt=!1;if(A[at].length!==1&&$!==A[at].length-1){if((T+2)*(tt+2)+2>g)continue t;O+=A[at][$],Lt=!0,K=at,at--}else{O=(O+=A[at][$]+" ").substr(O.length-1)==" "?O.substr(0,O.length-1):O;var Tt=parseInt(at),Qt=C(Tt,O,o),Ft=at>=A.length-1;if(Qt&&!Ft){O+=" ",$=0;continue}if(Qt||Ft){if(Ft)K=Tt;else if(r.multiline&&(T+2)*(tt+2)+2>g)continue t}else{if(!r.multiline||(T+2)*(tt+2)+2>g)continue t;K=Tt}}for(var vt="",Jt=W;Jt<=K;Jt++){var qt=A[Jt];if(r.multiline){if(Jt===K){vt+=qt[$]+" ",$=($+1)%qt.length;continue}if(Jt===W){vt+=qt[qt.length-1]+" ";continue}}vt+=qt[0]+" "}switch(vt=vt.substr(vt.length-1)==" "?vt.substr(0,vt.length-1):vt,x=Wf(vt,r,o).width,r.textAlign){case"right":v=d-x-2;break;case"center":v=(d-x)/2;break;case"left":default:v=2}t+=gr(v)+" "+gr(k)+` Td
`,t+="("+su(vt)+`) Tj
`,t+=-gr(v)+` 0 Td
`,k=-(o+2),x=0,W=Lt?K:K+1,tt++,O=""}break}return s.text=t,s.fontSize=o,s},Wf=function(r,t,i){var s=t.scope.internal.getFont(t.fontName,t.fontStyle),A=t.scope.getStringUnitWidth(r,{font:s,fontSize:parseFloat(i),charSpace:0})*parseFloat(i);return{height:t.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(i),charSpace:0})*parseFloat(i)*1.5,width:A}},mD={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},CD=function(r,t){var i={type:"reference",object:r};t.internal.getPageInfo(r.page).pageContext.annotations.find(function(s){return s.type===i.type&&s.object===i.object})===void 0&&t.internal.getPageInfo(r.page).pageContext.annotations.push(i)},ID=function(r,t){for(var i in r)if(r.hasOwnProperty(i)){var s=i,A=r[i];t.internal.newObjectDeferredBegin(A.objId,!0),Rr(A)==="object"&&typeof A.putStream=="function"&&A.putStream(),delete r[s]}},yD=function(r,t){if(t.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(gA.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(mD)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Ky=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new U5,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(i){i.internal.events.unsubscribe(i.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete i.internal.acroformPlugin.acroFormDictionaryRoot._eventID,i.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(i){i.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=i.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var A in s)if(s.hasOwnProperty(A)){var o=s[A];o.objId=void 0,o.hasAnnotation&&CD(o,i)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(i){if(i.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");i.internal.write("/AcroForm "+i.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(i){(function(s,A){var o=!s;for(var g in s||(A.internal.newObjectDeferredBegin(A.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),A.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||A.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(g)){var d=s[g],C=[],v=d.Rect;if(d.Rect&&(d.Rect=pD(d.Rect,A)),A.internal.newObjectDeferredBegin(d.objId,!0),d.DA=Ti.createDefaultAppearanceStream(d),Rr(d)==="object"&&typeof d.getKeyValueListForStream=="function"&&(C=d.getKeyValueListForStream()),d.Rect=v,d.hasAppearanceStream&&!d.appearanceStreamContent){var x=fD(d);C.push({key:"AP",value:"<</N "+x+">>"}),A.internal.acroformPlugin.xForms.push(x)}if(d.appearanceStreamContent){var T="";for(var G in d.appearanceStreamContent)if(d.appearanceStreamContent.hasOwnProperty(G)){var k=d.appearanceStreamContent[G];if(T+="/"+G+" ",T+="<<",Object.keys(k).length>=1||Array.isArray(k)){for(var g in k)if(k.hasOwnProperty(g)){var W=k[g];typeof W=="function"&&(W=W.call(A,d)),T+="/"+g+" "+W+" ",A.internal.acroformPlugin.xForms.indexOf(W)>=0||A.internal.acroformPlugin.xForms.push(W)}}else typeof(W=k)=="function"&&(W=W.call(A,d)),T+="/"+g+" "+W,A.internal.acroformPlugin.xForms.indexOf(W)>=0||A.internal.acroformPlugin.xForms.push(W);T+=">>"}C.push({key:"AP",value:`<<
`+T+">>"})}A.internal.putStream({additionalKeyValues:C,objectId:d.objId}),A.internal.out("endobj")}o&&ID(A.internal.acroformPlugin.xForms,A)})(i,r)}),r.internal.acroformPlugin.isInitialized=!0}},T5=Bn.__acroform__.arrayToPdfArray=function(r,t,i){var s=function(g){return g};if(Array.isArray(r)){for(var A="[",o=0;o<r.length;o++)switch(o!==0&&(A+=" "),Rr(r[o])){case"boolean":case"number":case"object":A+=r[o].toString();break;case"string":r[o].substr(0,1)!=="/"?(t!==void 0&&i&&(s=i.internal.getEncryptor(t)),A+="("+su(s(r[o].toString()))+")"):A+=r[o].toString()}return A+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Fy=function(r,t,i){var s=function(A){return A};return t!==void 0&&i&&(s=i.internal.getEncryptor(t)),(r=r||"").toString(),r="("+su(s(r))+")"},qA=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};qA.prototype.toString=function(){return this.objId+" 0 R"},qA.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},qA.prototype.getKeyValueListForStream=function(){var r=[],t=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var i in t)if(Object.getOwnPropertyDescriptor(this,t[i]).configurable===!1){var s=t[i],A=this[s];A&&(Array.isArray(A)?r.push({key:s,value:T5(A,this.objId,this.scope)}):A instanceof qA?(A.scope=this.scope,r.push({key:s,value:A.objId+" 0 R"})):typeof A!="function"&&r.push({key:s,value:A}))}return r};Q5=function(){qA.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(i){r=i.trim()},get:function(){return r||null}})};Ko(Q5,qA);U5=function(){qA.call(this);var r,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var i=function(s){return s};return this.scope&&(i=this.scope.internal.getEncryptor(this.objId)),"("+su(i(r))+")"}},set:function(i){r=i}})};Ko(U5,qA);gA=function r(){qA.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(O){if(isNaN(O))throw new Error('Invalid value "'+O+'" for attribute F supplied.');t=O}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Mn(t,3)},set:function(O){O?this.F=Nn(t,3):this.F=Vn(t,3)}});var i=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return i},set:function(O){if(isNaN(O))throw new Error('Invalid value "'+O+'" for attribute Ff supplied.');i=O}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(O){s=O!==void 0?O:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(O){s[0]=O}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(O){s[1]=O}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(O){s[2]=O}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(O){s[3]=O}});var A="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return A},set:function(O){switch(O){case"/Btn":case"/Tx":case"/Ch":case"/Sig":A=O;break;default:throw new Error('Invalid value "'+O+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof em)return;o="FieldObject"+r.FieldNum++}var O=function(tt){return tt};return this.scope&&(O=this.scope.internal.getEncryptor(this.objId)),"("+su(O(o))+")"},set:function(O){o=O.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(O){o=O}});var g="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return g},set:function(O){g=O}});var d="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return d},set:function(O){d=O}});var C=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return C},set:function(O){C=O}});var v=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return v===void 0?50/Ky:v},set:function(O){v=O}});var x="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return x},set:function(O){x=O}});var T="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!T||this instanceof em||this instanceof nu))return Fy(T,this.objId,this.scope)},set:function(O){O=O.toString(),T=O}});var G=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(G)return this instanceof ys?G:Fy(G,this.objId,this.scope)},set:function(O){O=O.toString(),G=this instanceof ys?O:O.substr(0,1)==="("?nh(O.substr(1,O.length-2)):nh(O)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ys?nh(G.substr(1,G.length-1)):G},set:function(O){O=O.toString(),G=this instanceof ys?"/"+O:O}});var k=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(k)return k},set:function(O){this.V=O}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(k)return this instanceof ys?k:Fy(k,this.objId,this.scope)},set:function(O){O=O.toString(),k=this instanceof ys?O:O.substr(0,1)==="("?nh(O.substr(1,O.length-2)):nh(O)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ys?nh(k.substr(1,k.length-1)):k},set:function(O){O=O.toString(),k=this instanceof ys?"/"+O:O}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var W,K=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return K},set:function(O){O=!!O,K=O}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(W)return W},set:function(O){W=O}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,1)},set:function(O){O?this.Ff=Nn(this.Ff,1):this.Ff=Vn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,2)},set:function(O){O?this.Ff=Nn(this.Ff,2):this.Ff=Vn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,3)},set:function(O){O?this.Ff=Nn(this.Ff,3):this.Ff=Vn(this.Ff,3)}});var $=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if($!==null)return $},set:function(O){if([0,1,2].indexOf(O)===-1)throw new Error('Invalid value "'+O+'" for attribute Q supplied.');$=O}}),Object.defineProperty(this,"textAlign",{get:function(){var O;switch($){case 0:default:O="left";break;case 1:O="center";break;case 2:O="right"}return O},configurable:!0,enumerable:!0,set:function(O){switch(O){case"right":case 2:$=2;break;case"center":case 1:$=1;break;case"left":case 0:default:$=0}}})};Ko(gA,qA);ch=function(){gA.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(i){r=i}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return T5(t,this.objId,this.scope)},set:function(i){var s,A;A=[],typeof(s=i)=="string"&&(A=function(o,g,d){d||(d=1);for(var C,v=[];C=g.exec(o);)v.push(C[d]);return v}(s,/\((.*?)\)/g)),t=A}}),this.getOptions=function(){return t},this.setOptions=function(i){t=i,this.sort&&t.sort()},this.addOption=function(i){i=(i=i||"").toString(),t.push(i),this.sort&&t.sort()},this.removeOption=function(i,s){for(s=s||!1,i=(i=i||"").toString();t.indexOf(i)!==-1&&(t.splice(t.indexOf(i),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,18)},set:function(i){i?this.Ff=Nn(this.Ff,18):this.Ff=Vn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,19)},set:function(i){this.combo===!0&&(i?this.Ff=Nn(this.Ff,19):this.Ff=Vn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,20)},set:function(i){i?(this.Ff=Nn(this.Ff,20),t.sort()):this.Ff=Vn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,22)},set:function(i){i?this.Ff=Nn(this.Ff,22):this.Ff=Vn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,23)},set:function(i){i?this.Ff=Nn(this.Ff,23):this.Ff=Vn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,27)},set:function(i){i?this.Ff=Nn(this.Ff,27):this.Ff=Vn(this.Ff,27)}}),this.hasAppearanceStream=!1};Ko(ch,gA);uh=function(){ch.call(this),this.fontName="helvetica",this.combo=!1};Ko(uh,ch);hh=function(){uh.call(this),this.combo=!0};Ko(hh,uh);Xf=function(){hh.call(this),this.edit=!0};Ko(Xf,hh);ys=function(){gA.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,15)},set:function(i){i?this.Ff=Nn(this.Ff,15):this.Ff=Vn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,16)},set:function(i){i?this.Ff=Nn(this.Ff,16):this.Ff=Vn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,17)},set:function(i){i?this.Ff=Nn(this.Ff,17):this.Ff=Vn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,26)},set:function(i){i?this.Ff=Nn(this.Ff,26):this.Ff=Vn(this.Ff,26)}});var r,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};if(this.scope&&(i=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var s,A=[];for(s in A.push("<<"),t)A.push("/"+s+" ("+su(i(t[s]))+")");return A.push(">>"),A.join(`
`)}},set:function(i){Rr(i)==="object"&&(t=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(i){typeof i=="string"&&(t.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}})};Ko(ys,gA);Yf=function(){ys.call(this),this.pushButton=!0};Ko(Yf,ys);gh=function(){ys.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t!==void 0?t:[]}})};Ko(gh,ys);em=function(){var r,t;gA.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(A){r=A}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(A){t=A}});var i,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var A=function(d){return d};this.scope&&(A=this.scope.internal.getEncryptor(this.objId));var o,g=[];for(o in g.push("<<"),s)g.push("/"+o+" ("+su(A(s[o]))+")");return g.push(">>"),g.join(`
`)},set:function(A){Rr(A)==="object"&&(s=A)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(A){typeof A=="string"&&(s.CA=A)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(A){i=A}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(A){i="/"+A}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ti.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ko(em,gA),gh.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var i=this.Kids[t];i.appearanceStreamContent=r.createAppearanceStream(i.optionName),i.caption=r.getCA()}},gh.prototype.createOption=function(r){var t=new em;return t.Parent=this,t.optionName=r,this.Kids.push(t),bD.call(this.scope,t),t};jf=function(){ys.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ti.CheckBox.createAppearanceStream()};Ko(jf,ys);nu=function(){gA.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,13)},set:function(t){t?this.Ff=Nn(this.Ff,13):this.Ff=Vn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,21)},set:function(t){t?this.Ff=Nn(this.Ff,21):this.Ff=Vn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,23)},set:function(t){t?this.Ff=Nn(this.Ff,23):this.Ff=Vn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,24)},set:function(t){t?this.Ff=Nn(this.Ff,24):this.Ff=Vn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,25)},set:function(t){t?this.Ff=Nn(this.Ff,25):this.Ff=Vn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,26)},set:function(t){t?this.Ff=Nn(this.Ff,26):this.Ff=Vn(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){Number.isInteger(t)&&(r=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ko(nu,gA);qf=function(){nu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Mn(this.Ff,14)},set:function(r){r?this.Ff=Nn(this.Ff,14):this.Ff=Vn(this.Ff,14)}}),this.password=!0};Ko(qf,nu);Ti={CheckBox:{createAppearanceStream:function(){return{N:{On:Ti.CheckBox.YesNormal},D:{On:Ti.CheckBox.YesPushDown,Off:Ti.CheckBox.OffPushDown}}},YesPushDown:function(r){var t=jA(r);t.scope=r.scope;var i=[],s=r.scope.internal.getFont(r.fontName,r.fontStyle).id,A=r.scope.__private__.encodeColorString(r.color),o=Zy(r,r.caption);return i.push("0.749023 g"),i.push("0 0 "+gr(Ti.internal.getWidth(r))+" "+gr(Ti.internal.getHeight(r))+" re"),i.push("f"),i.push("BMC"),i.push("q"),i.push("0 0 1 rg"),i.push("/"+s+" "+gr(o.fontSize)+" Tf "+A),i.push("BT"),i.push(o.text),i.push("ET"),i.push("Q"),i.push("EMC"),t.stream=i.join(`
`),t},YesNormal:function(r){var t=jA(r);t.scope=r.scope;var i=r.scope.internal.getFont(r.fontName,r.fontStyle).id,s=r.scope.__private__.encodeColorString(r.color),A=[],o=Ti.internal.getHeight(r),g=Ti.internal.getWidth(r),d=Zy(r,r.caption);return A.push("1 g"),A.push("0 0 "+gr(g)+" "+gr(o)+" re"),A.push("f"),A.push("q"),A.push("0 0 1 rg"),A.push("0 0 "+gr(g-1)+" "+gr(o-1)+" re"),A.push("W"),A.push("n"),A.push("0 g"),A.push("BT"),A.push("/"+i+" "+gr(d.fontSize)+" Tf "+s),A.push(d.text),A.push("ET"),A.push("Q"),t.stream=A.join(`
`),t},OffPushDown:function(r){var t=jA(r);t.scope=r.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+gr(Ti.internal.getWidth(r))+" "+gr(Ti.internal.getHeight(r))+" re"),i.push("f"),t.stream=i.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(r){var t={D:{Off:Ti.RadioButton.Circle.OffPushDown},N:{}};return t.N[r]=Ti.RadioButton.Circle.YesNormal,t.D[r]=Ti.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(r){var t=jA(r);t.scope=r.scope;var i=[],s=Ti.internal.getWidth(r)<=Ti.internal.getHeight(r)?Ti.internal.getWidth(r)/4:Ti.internal.getHeight(r)/4;s=Number((.9*s).toFixed(5));var A=Ti.internal.Bezier_C,o=Number((s*A).toFixed(5));return i.push("q"),i.push("1 0 0 1 "+dc(Ti.internal.getWidth(r)/2)+" "+dc(Ti.internal.getHeight(r)/2)+" cm"),i.push(s+" 0 m"),i.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),i.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),i.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),i.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),i.push("f"),i.push("Q"),t.stream=i.join(`
`),t},YesPushDown:function(r){var t=jA(r);t.scope=r.scope;var i=[],s=Ti.internal.getWidth(r)<=Ti.internal.getHeight(r)?Ti.internal.getWidth(r)/4:Ti.internal.getHeight(r)/4;s=Number((.9*s).toFixed(5));var A=Number((2*s).toFixed(5)),o=Number((A*Ti.internal.Bezier_C).toFixed(5)),g=Number((s*Ti.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+dc(Ti.internal.getWidth(r)/2)+" "+dc(Ti.internal.getHeight(r)/2)+" cm"),i.push(A+" 0 m"),i.push(A+" "+o+" "+o+" "+A+" 0 "+A+" c"),i.push("-"+o+" "+A+" -"+A+" "+o+" -"+A+" 0 c"),i.push("-"+A+" -"+o+" -"+o+" -"+A+" 0 -"+A+" c"),i.push(o+" -"+A+" "+A+" -"+o+" "+A+" 0 c"),i.push("f"),i.push("Q"),i.push("0 g"),i.push("q"),i.push("1 0 0 1 "+dc(Ti.internal.getWidth(r)/2)+" "+dc(Ti.internal.getHeight(r)/2)+" cm"),i.push(s+" 0 m"),i.push(s+" "+g+" "+g+" "+s+" 0 "+s+" c"),i.push("-"+g+" "+s+" -"+s+" "+g+" -"+s+" 0 c"),i.push("-"+s+" -"+g+" -"+g+" -"+s+" 0 -"+s+" c"),i.push(g+" -"+s+" "+s+" -"+g+" "+s+" 0 c"),i.push("f"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(r){var t=jA(r);t.scope=r.scope;var i=[],s=Ti.internal.getWidth(r)<=Ti.internal.getHeight(r)?Ti.internal.getWidth(r)/4:Ti.internal.getHeight(r)/4;s=Number((.9*s).toFixed(5));var A=Number((2*s).toFixed(5)),o=Number((A*Ti.internal.Bezier_C).toFixed(5));return i.push("0.749023 g"),i.push("q"),i.push("1 0 0 1 "+dc(Ti.internal.getWidth(r)/2)+" "+dc(Ti.internal.getHeight(r)/2)+" cm"),i.push(A+" 0 m"),i.push(A+" "+o+" "+o+" "+A+" 0 "+A+" c"),i.push("-"+o+" "+A+" -"+A+" "+o+" -"+A+" 0 c"),i.push("-"+A+" -"+o+" -"+o+" -"+A+" 0 -"+A+" c"),i.push(o+" -"+A+" "+A+" -"+o+" "+A+" 0 c"),i.push("f"),i.push("Q"),t.stream=i.join(`
`),t}},Cross:{createAppearanceStream:function(r){var t={D:{Off:Ti.RadioButton.Cross.OffPushDown},N:{}};return t.N[r]=Ti.RadioButton.Cross.YesNormal,t.D[r]=Ti.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(r){var t=jA(r);t.scope=r.scope;var i=[],s=Ti.internal.calculateCross(r);return i.push("q"),i.push("1 1 "+gr(Ti.internal.getWidth(r)-2)+" "+gr(Ti.internal.getHeight(r)-2)+" re"),i.push("W"),i.push("n"),i.push(gr(s.x1.x)+" "+gr(s.x1.y)+" m"),i.push(gr(s.x2.x)+" "+gr(s.x2.y)+" l"),i.push(gr(s.x4.x)+" "+gr(s.x4.y)+" m"),i.push(gr(s.x3.x)+" "+gr(s.x3.y)+" l"),i.push("s"),i.push("Q"),t.stream=i.join(`
`),t},YesPushDown:function(r){var t=jA(r);t.scope=r.scope;var i=Ti.internal.calculateCross(r),s=[];return s.push("0.749023 g"),s.push("0 0 "+gr(Ti.internal.getWidth(r))+" "+gr(Ti.internal.getHeight(r))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+gr(Ti.internal.getWidth(r)-2)+" "+gr(Ti.internal.getHeight(r)-2)+" re"),s.push("W"),s.push("n"),s.push(gr(i.x1.x)+" "+gr(i.x1.y)+" m"),s.push(gr(i.x2.x)+" "+gr(i.x2.y)+" l"),s.push(gr(i.x4.x)+" "+gr(i.x4.y)+" m"),s.push(gr(i.x3.x)+" "+gr(i.x3.y)+" l"),s.push("s"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(r){var t=jA(r);t.scope=r.scope;var i=[];return i.push("0.749023 g"),i.push("0 0 "+gr(Ti.internal.getWidth(r))+" "+gr(Ti.internal.getHeight(r))+" re"),i.push("f"),t.stream=i.join(`
`),t}}},createDefaultAppearanceStream:function(r){var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,i=r.scope.__private__.encodeColorString(r.color);return"/"+t+" "+r.fontSize+" Tf "+i}};Ti.internal={Bezier_C:.551915024494,calculateCross:function(r){var t=Ti.internal.getWidth(r),i=Ti.internal.getHeight(r),s=Math.min(t,i);return{x1:{x:(t-s)/2,y:(i-s)/2+s},x2:{x:(t-s)/2+s,y:(i-s)/2},x3:{x:(t-s)/2,y:(i-s)/2},x4:{x:(t-s)/2+s,y:(i-s)/2+s}}}},Ti.internal.getWidth=function(r){var t=0;return Rr(r)==="object"&&(t=A5(r.Rect[2])),t},Ti.internal.getHeight=function(r){var t=0;return Rr(r)==="object"&&(t=A5(r.Rect[3])),t};bD=Bn.addField=function(r){if(yD(this,r),!(r instanceof gA))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=r).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};Bn.AcroFormChoiceField=ch,Bn.AcroFormListBox=uh,Bn.AcroFormComboBox=hh,Bn.AcroFormEditBox=Xf,Bn.AcroFormButton=ys,Bn.AcroFormPushButton=Yf,Bn.AcroFormRadioButton=gh,Bn.AcroFormCheckBox=jf,Bn.AcroFormTextField=nu,Bn.AcroFormPasswordField=qf,Bn.AcroFormAppearance=Ti,Bn.AcroForm={ChoiceField:ch,ListBox:uh,ComboBox:hh,EditBox:Xf,Button:ys,PushButton:Yf,RadioButton:gh,CheckBox:jf,TextField:nu,PasswordField:qf,Appearance:Ti},er.AcroForm={ChoiceField:ch,ListBox:uh,ComboBox:hh,EditBox:Xf,Button:ys,PushButton:Yf,RadioButton:gh,CheckBox:jf,TextField:nu,PasswordField:qf,Appearance:Ti};(function(r){r.__addimage__={};var t="UNKNOWN",i={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=r.__addimage__.getImageFileTypeByImageData=function(At,lt){var kt,_t,le,ie,ne,te=t;if((lt=lt||t)==="RGBA"||At.data!==void 0&&At.data instanceof Uint8ClampedArray&&"height"in At&&"width"in At)return"RGBA";if(Qt(At))for(ne in i)for(le=i[ne],kt=0;kt<le.length;kt+=1){for(ie=!0,_t=0;_t<le[kt].length;_t+=1)if(le[kt][_t]!==void 0&&le[kt][_t]!==At[_t]){ie=!1;break}if(ie===!0){te=ne;break}}else for(ne in i)for(le=i[ne],kt=0;kt<le.length;kt+=1){for(ie=!0,_t=0;_t<le[kt].length;_t+=1)if(le[kt][_t]!==void 0&&le[kt][_t]!==At.charCodeAt(_t)){ie=!1;break}if(ie===!0){te=ne;break}}return te===t&&lt!==t&&(te=lt),te},A=function At(lt){for(var kt=this.internal.write,_t=this.internal.putStream,le=(0,this.internal.getFilters)();le.indexOf("FlateEncode")!==-1;)le.splice(le.indexOf("FlateEncode"),1);lt.objectId=this.internal.newObject();var ie=[];if(ie.push({key:"Type",value:"/XObject"}),ie.push({key:"Subtype",value:"/Image"}),ie.push({key:"Width",value:lt.width}),ie.push({key:"Height",value:lt.height}),lt.colorSpace===$.INDEXED?ie.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(lt.palette.length/3-1)+" "+("sMask"in lt&&lt.sMask!==void 0?lt.objectId+2:lt.objectId+1)+" 0 R]"}):(ie.push({key:"ColorSpace",value:"/"+lt.colorSpace}),lt.colorSpace===$.DEVICE_CMYK&&ie.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ie.push({key:"BitsPerComponent",value:lt.bitsPerComponent}),"decodeParameters"in lt&&lt.decodeParameters!==void 0&&ie.push({key:"DecodeParms",value:"<<"+lt.decodeParameters+">>"}),"transparency"in lt&&Array.isArray(lt.transparency)){for(var ne="",te=0,wt=lt.transparency.length;te<wt;te++)ne+=lt.transparency[te]+" "+lt.transparency[te]+" ";ie.push({key:"Mask",value:"["+ne+"]"})}lt.sMask!==void 0&&ie.push({key:"SMask",value:lt.objectId+1+" 0 R"});var Ut=lt.filter!==void 0?["/"+lt.filter]:void 0;if(_t({data:lt.data,additionalKeyValues:ie,alreadyAppliedFilters:Ut,objectId:lt.objectId}),kt("endobj"),"sMask"in lt&&lt.sMask!==void 0){var fe="/Predictor "+lt.predictor+" /Colors 1 /BitsPerComponent "+lt.bitsPerComponent+" /Columns "+lt.width,j={width:lt.width,height:lt.height,colorSpace:"DeviceGray",bitsPerComponent:lt.bitsPerComponent,decodeParameters:fe,data:lt.sMask};"filter"in lt&&(j.filter=lt.filter),At.call(this,j)}if(lt.colorSpace===$.INDEXED){var bt=this.internal.newObject();_t({data:vt(new Uint8Array(lt.palette)),objectId:bt}),kt("endobj")}},o=function(){var At=this.internal.collections.addImage_images;for(var lt in At)A.call(this,At[lt])},g=function(){var At,lt=this.internal.collections.addImage_images,kt=this.internal.write;for(var _t in lt)kt("/I"+(At=lt[_t]).index,At.objectId,"0","R")},d=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",g))},C=function(){var At=this.internal.collections.addImage_images;return d.call(this),At},v=function(){return Object.keys(this.internal.collections.addImage_images).length},x=function(At){return typeof r["process"+At.toUpperCase()]=="function"},T=function(At){return Rr(At)==="object"&&At.nodeType===1},G=function(At,lt){if(At.nodeName==="IMG"&&At.hasAttribute("src")){var kt=""+At.getAttribute("src");if(kt.indexOf("data:image/")===0)return Vg(unescape(kt).split("base64,").pop());var _t=r.loadFile(kt,!0);if(_t!==void 0)return _t}if(At.nodeName==="CANVAS"){if(At.width===0||At.height===0)throw new Error("Given canvas must have data. Canvas width: "+At.width+", height: "+At.height);var le;switch(lt){case"PNG":le="image/png";break;case"WEBP":le="image/webp";break;case"JPEG":case"JPG":default:le="image/jpeg"}return Vg(At.toDataURL(le,1).split("base64,").pop())}},k=function(At){var lt=this.internal.collections.addImage_images;if(lt){for(var kt in lt)if(At===lt[kt].alias)return lt[kt]}},W=function(At,lt,kt){return At||lt||(At=-96,lt=-96),At<0&&(At=-1*kt.width*72/At/this.internal.scaleFactor),lt<0&&(lt=-1*kt.height*72/lt/this.internal.scaleFactor),At===0&&(At=lt*kt.width/kt.height),lt===0&&(lt=At*kt.height/kt.width),[At,lt]},K=function(At,lt,kt,_t,le,ie){var ne=W.call(this,kt,_t,le),te=this.internal.getCoordinateString,wt=this.internal.getVerticalCoordinateString,Ut=C.call(this);if(kt=ne[0],_t=ne[1],Ut[le.index]=le,ie){ie*=Math.PI/180;var fe=Math.cos(ie),j=Math.sin(ie),bt=function(Ht){return Ht.toFixed(4)},It=[bt(fe),bt(j),bt(-1*j),bt(fe),0,0,"cm"]}this.internal.write("q"),ie?(this.internal.write([1,"0","0",1,te(At),wt(lt+_t),"cm"].join(" ")),this.internal.write(It.join(" ")),this.internal.write([te(kt),"0","0",te(_t),"0","0","cm"].join(" "))):this.internal.write([te(kt),"0","0",te(_t),te(At),wt(lt+_t),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+le.index+" Do"),this.internal.write("Q")},$=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var O=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},tt=r.__addimage__.sHashCode=function(At){var lt,kt,_t=0;if(typeof At=="string")for(kt=At.length,lt=0;lt<kt;lt++)_t=(_t<<5)-_t+At.charCodeAt(lt),_t|=0;else if(Qt(At))for(kt=At.byteLength/2,lt=0;lt<kt;lt++)_t=(_t<<5)-_t+At[lt],_t|=0;return _t},at=r.__addimage__.validateStringAsBase64=function(At){(At=At||"").toString().trim();var lt=!0;return At.length===0&&(lt=!1),At.length%4!=0&&(lt=!1),/^[A-Za-z0-9+/]+$/.test(At.substr(0,At.length-2))===!1&&(lt=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(At.substr(-2))===!1&&(lt=!1),lt},Lt=r.__addimage__.extractImageFromDataUrl=function(At){var lt=(At=At||"").split("base64,"),kt=null;if(lt.length===2){var _t=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(lt[0]);Array.isArray(_t)&&(kt={mimeType:_t[1],charset:_t[2],data:lt[1]})}return kt},Tt=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(At){return Tt()&&At instanceof ArrayBuffer};var Qt=r.__addimage__.isArrayBufferView=function(At){return Tt()&&typeof Uint32Array<"u"&&(At instanceof Int8Array||At instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&At instanceof Uint8ClampedArray||At instanceof Int16Array||At instanceof Uint16Array||At instanceof Int32Array||At instanceof Uint32Array||At instanceof Float32Array||At instanceof Float64Array)},Ft=r.__addimage__.binaryStringToUint8Array=function(At){for(var lt=At.length,kt=new Uint8Array(lt),_t=0;_t<lt;_t++)kt[_t]=At.charCodeAt(_t);return kt},vt=r.__addimage__.arrayBufferToBinaryString=function(At){for(var lt="",kt=Qt(At)?At:new Uint8Array(At),_t=0;_t<kt.length;_t+=8192)lt+=String.fromCharCode.apply(null,kt.subarray(_t,_t+8192));return lt};r.addImage=function(){var At,lt,kt,_t,le,ie,ne,te,wt;if(typeof arguments[1]=="number"?(lt=t,kt=arguments[1],_t=arguments[2],le=arguments[3],ie=arguments[4],ne=arguments[5],te=arguments[6],wt=arguments[7]):(lt=arguments[1],kt=arguments[2],_t=arguments[3],le=arguments[4],ie=arguments[5],ne=arguments[6],te=arguments[7],wt=arguments[8]),Rr(At=arguments[0])==="object"&&!T(At)&&"imageData"in At){var Ut=At;At=Ut.imageData,lt=Ut.format||lt||t,kt=Ut.x||kt||0,_t=Ut.y||_t||0,le=Ut.w||Ut.width||le,ie=Ut.h||Ut.height||ie,ne=Ut.alias||ne,te=Ut.compression||te,wt=Ut.rotation||Ut.angle||wt}var fe=this.internal.getFilters();if(te===void 0&&fe.indexOf("FlateEncode")!==-1&&(te="SLOW"),isNaN(kt)||isNaN(_t))throw new Error("Invalid coordinates passed to jsPDF.addImage");d.call(this);var j=Jt.call(this,At,lt,ne,te);return K.call(this,kt,_t,le,ie,j,wt),this};var Jt=function(At,lt,kt,_t){var le,ie,ne;if(typeof At=="string"&&s(At)===t){At=unescape(At);var te=qt(At,!1);(te!==""||(te=r.loadFile(At,!0))!==void 0)&&(At=te)}if(T(At)&&(At=G(At,lt)),lt=s(At,lt),!x(lt))throw new Error("addImage does not support files of type '"+lt+"', please ensure that a plugin for '"+lt+"' support is added.");if(((ne=kt)==null||ne.length===0)&&(kt=function(wt){return typeof wt=="string"||Qt(wt)?tt(wt):Qt(wt.data)?tt(wt.data):null}(At)),(le=k.call(this,kt))||(Tt()&&(At instanceof Uint8Array||lt==="RGBA"||(ie=At,At=Ft(At))),le=this["process"+lt.toUpperCase()](At,v.call(this),kt,function(wt){return wt&&typeof wt=="string"&&(wt=wt.toUpperCase()),wt in r.image_compression?wt:O.NONE}(_t),ie)),!le)throw new Error("An unknown error occurred whilst processing the image.");return le},qt=r.__addimage__.convertBase64ToBinaryString=function(At,lt){var kt;lt=typeof lt!="boolean"||lt;var _t,le="";if(typeof At=="string"){_t=(kt=Lt(At))!==null?kt.data:At;try{le=Vg(_t)}catch(ie){if(lt)throw at(_t)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ie.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return le};r.getImageProperties=function(At){var lt,kt,_t="";if(T(At)&&(At=G(At)),typeof At=="string"&&s(At)===t&&((_t=qt(At,!1))===""&&(_t=r.loadFile(At)||""),At=_t),kt=s(At),!x(kt))throw new Error("addImage does not support files of type '"+kt+"', please ensure that a plugin for '"+kt+"' support is added.");if(!Tt()||At instanceof Uint8Array||(At=Ft(At)),!(lt=this["process"+kt.toUpperCase()](At)))throw new Error("An unknown error occurred whilst processing the image");return lt.fileType=kt,lt}})(er.API),function(r){var t=function(i){if(i!==void 0&&i!="")return!0};er.API.events.push(["addPage",function(i){this.internal.getPageInfo(i.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(i){for(var s,A,o,g=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString,C=this.internal.getPageInfoByObjId(i.objId),v=i.pageContext.annotations,x=!1,T=0;T<v.length&&!x;T++)switch((s=v[T]).type){case"link":(t(s.options.url)||t(s.options.pageNumber))&&(x=!0);break;case"reference":case"text":case"freetext":x=!0}if(x!=0){this.internal.write("/Annots [");for(var G=0;G<v.length;G++){s=v[G];var k=this.internal.pdfEscape,W=this.internal.getEncryptor(i.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var K=this.internal.newAdditionalObject(),$=this.internal.newAdditionalObject(),O=this.internal.getEncryptor(K.objId),tt=s.title||"Note";o="<</Type /Annot /Subtype /Text "+(A="/Rect ["+g(s.bounds.x)+" "+d(s.bounds.y+s.bounds.h)+" "+g(s.bounds.x+s.bounds.w)+" "+d(s.bounds.y)+"] ")+"/Contents ("+k(O(s.contents))+")",o+=" /Popup "+$.objId+" 0 R",o+=" /P "+C.objId+" 0 R",o+=" /T ("+k(O(tt))+") >>",K.content=o;var at=K.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(A="/Rect ["+g(s.bounds.x+30)+" "+d(s.bounds.y+s.bounds.h)+" "+g(s.bounds.x+s.bounds.w+30)+" "+d(s.bounds.y)+"] ")+" /Parent "+at,s.open&&(o+=" /Open true"),o+=" >>",$.content=o,this.internal.write(K.objId,"0 R",$.objId,"0 R");break;case"freetext":A="/Rect ["+g(s.bounds.x)+" "+d(s.bounds.y)+" "+g(s.bounds.x+s.bounds.w)+" "+d(s.bounds.y+s.bounds.h)+"] ";var Lt=s.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+A+"/Contents ("+k(W(s.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Lt+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(s.options.name){var Tt=this.annotations._nameMap[s.options.name];s.options.pageNumber=Tt.page,s.options.top=Tt.y}else s.options.top||(s.options.top=0);if(A="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",o="",s.options.url)o="<</Type /Annot /Subtype /Link "+A+"/Border [0 0 0] /A <</S /URI /URI ("+k(W(s.options.url))+") >>";else if(s.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+A+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,o+=" /FitV "+s.options.left+"]";break;case"XYZ":default:var Qt=d(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),o+=" /XYZ "+s.options.left+" "+Qt+" "+s.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),r.createAnnotation=function(i){var s=this.internal.getCurrentPageInfo();switch(i.type){case"link":this.link(i.bounds.x,i.bounds.y,i.bounds.w,i.bounds.h,i);break;case"text":case"freetext":s.pageContext.annotations.push(i)}},r.link=function(i,s,A,o,g){var d=this.internal.getCurrentPageInfo(),C=this.internal.getCoordinateString,v=this.internal.getVerticalCoordinateString;d.pageContext.annotations.push({finalBounds:{x:C(i),y:v(s),w:C(i+A),h:v(s+o)},options:g,type:"link"})},r.textWithLink=function(i,s,A,o){var g,d,C=this.getTextWidth(i),v=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){d=o.maxWidth;var x=this.splitTextToSize(i,d).length;g=Math.ceil(v*x)}else d=C,g=v;return this.text(i,s,A,o),A+=.2*v,o.align==="center"&&(s-=C/2),o.align==="right"&&(s-=C),this.link(s,A-v,d,g,o),C},r.getTextWidth=function(i){var s=this.internal.getFontSize();return this.getStringUnitWidth(i)*s/this.internal.scaleFactor}}(er.API),function(r){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},i={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},A=[1570,1571,1573,1575];r.__arabicParser__={};var o=r.__arabicParser__.isInArabicSubstitutionA=function(K){return t[K.charCodeAt(0)]!==void 0},g=r.__arabicParser__.isArabicLetter=function(K){return typeof K=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(K)},d=r.__arabicParser__.isArabicEndLetter=function(K){return g(K)&&o(K)&&t[K.charCodeAt(0)].length<=2},C=r.__arabicParser__.isArabicAlfLetter=function(K){return g(K)&&A.indexOf(K.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(K){return g(K)&&o(K)&&t[K.charCodeAt(0)].length>=1};var v=r.__arabicParser__.arabicLetterHasFinalForm=function(K){return g(K)&&o(K)&&t[K.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(K){return g(K)&&o(K)&&t[K.charCodeAt(0)].length>=3};var x=r.__arabicParser__.arabicLetterHasMedialForm=function(K){return g(K)&&o(K)&&t[K.charCodeAt(0)].length==4},T=r.__arabicParser__.resolveLigatures=function(K){var $=0,O=i,tt="",at=0;for($=0;$<K.length;$+=1)O[K.charCodeAt($)]!==void 0?(at++,typeof(O=O[K.charCodeAt($)])=="number"&&(tt+=String.fromCharCode(O),O=i,at=0),$===K.length-1&&(O=i,tt+=K.charAt($-(at-1)),$-=at-1,at=0)):(O=i,tt+=K.charAt($-at),$-=at,at=0);return tt};r.__arabicParser__.isArabicDiacritic=function(K){return K!==void 0&&s[K.charCodeAt(0)]!==void 0};var G=r.__arabicParser__.getCorrectForm=function(K,$,O){return g(K)?o(K)===!1?-1:!v(K)||!g($)&&!g(O)||!g(O)&&d($)||d(K)&&!g($)||d(K)&&C($)||d(K)&&d($)?0:x(K)&&g($)&&!d($)&&g(O)&&v(O)?3:d(K)||!g(O)?1:2:-1},k=function(K){var $=0,O=0,tt=0,at="",Lt="",Tt="",Qt=(K=K||"").split("\\s+"),Ft=[];for($=0;$<Qt.length;$+=1){for(Ft.push(""),O=0;O<Qt[$].length;O+=1)at=Qt[$][O],Lt=Qt[$][O-1],Tt=Qt[$][O+1],g(at)?(tt=G(at,Lt,Tt),Ft[$]+=tt!==-1?String.fromCharCode(t[at.charCodeAt(0)][tt]):at):Ft[$]+=at;Ft[$]=T(Ft[$])}return Ft.join(" ")},W=r.__arabicParser__.processArabic=r.processArabic=function(){var K,$=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,O=[];if(Array.isArray($)){var tt=0;for(O=[],tt=0;tt<$.length;tt+=1)Array.isArray($[tt])?O.push([k($[tt][0]),$[tt][1],$[tt][2]]):O.push([k($[tt])]);K=O}else K=k($);return typeof arguments[0]=="string"?K:(arguments[0].text=K,arguments[0])};r.events.push(["preProcessText",W])}(er.API),er.API.autoPrint=function(r){var t;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(r){var t=function(){var i=void 0;Object.defineProperty(this,"pdf",{get:function(){return i},set:function(d){i=d}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(d){s=isNaN(d)||Number.isInteger(d)===!1||d<0?150:d,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var A=300;Object.defineProperty(this,"height",{get:function(){return A},set:function(d){A=isNaN(d)||Number.isInteger(d)===!1||d<0?300:d,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=A+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(d){o=d}});var g={};Object.defineProperty(this,"style",{get:function(){return g},set:function(d){g=d}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(i,s){var A;if((i=i||"2d")!=="2d")return null;for(A in s)this.pdf.context2d.hasOwnProperty(A)&&(this.pdf.context2d[A]=s[A]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(er.API),function(r){var t={left:0,top:0,bottom:0,right:0},i=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),A.call(this))},A=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var C=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return C},set:function(K){C=K}});var v=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return v},set:function(K){v=K}});var x=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return x},set:function(K){x=K}});var T=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return T},set:function(K){T=K}});var G=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return G},set:function(K){G=K}});var k=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return k},set:function(K){k=K}});var W=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return W},set:function(K){W=K}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(C){return s.call(this),this.internal.__cell__.headerFunction=typeof C=="function"?C:void 0,this},r.getTextDimensions=function(C,v){s.call(this);var x=(v=v||{}).fontSize||this.getFontSize(),T=v.font||this.getFont(),G=v.scaleFactor||this.internal.scaleFactor,k=0,W=0,K=0,$=this;if(!Array.isArray(C)&&typeof C!="string"){if(typeof C!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");C=String(C)}var O=v.maxWidth;O>0?typeof C=="string"?C=this.splitTextToSize(C,O):Object.prototype.toString.call(C)==="[object Array]"&&(C=C.reduce(function(at,Lt){return at.concat($.splitTextToSize(Lt,O))},[])):C=Array.isArray(C)?C:[C];for(var tt=0;tt<C.length;tt++)k<(K=this.getStringUnitWidth(C[tt],{font:T})*x)&&(k=K);return k!==0&&(W=C.length),{w:k/=G,h:Math.max((W*x*this.getLineHeightFactor()-x*(this.getLineHeightFactor()-1))/G,0)}},r.cellAddPage=function(){s.call(this),this.addPage();var C=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new o(C.left,C.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var g=r.cell=function(){var C;C=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),s.call(this);var v=this.internal.__cell__.lastCell,x=this.internal.__cell__.padding,T=this.internal.__cell__.margins||t,G=this.internal.__cell__.tableHeaderRow,k=this.internal.__cell__.printHeaders;return v.lineNumber!==void 0&&(v.lineNumber===C.lineNumber?(C.x=(v.x||0)+(v.width||0),C.y=v.y||0):v.y+v.height+C.height+T.bottom>this.getPageHeight()?(this.cellAddPage(),C.y=T.top,k&&G&&(this.printHeaderRow(C.lineNumber,!0),C.y+=G[0].height)):C.y=v.y+v.height||C.y),C.text[0]!==void 0&&(this.rect(C.x,C.y,C.width,C.height,i===!0?"FD":void 0),C.align==="right"?this.text(C.text,C.x+C.width-x,C.y+x,{align:"right",baseline:"top"}):C.align==="center"?this.text(C.text,C.x+C.width/2,C.y+x,{align:"center",baseline:"top",maxWidth:C.width-x-x}):this.text(C.text,C.x+x,C.y+x,{align:"left",baseline:"top",maxWidth:C.width-x-x})),this.internal.__cell__.lastCell=C,this};r.table=function(C,v,x,T,G){if(s.call(this),!x)throw new Error("No data for PDF table.");var k,W,K,$,O=[],tt=[],at=[],Lt={},Tt={},Qt=[],Ft=[],vt=(G=G||{}).autoSize||!1,Jt=G.printHeaders!==!1,qt=G.css&&G.css["font-size"]!==void 0?16*G.css["font-size"]:G.fontSize||12,At=G.margins||Object.assign({width:this.getPageWidth()},t),lt=typeof G.padding=="number"?G.padding:3,kt=G.headerBackgroundColor||"#c8c8c8",_t=G.headerTextColor||"#000";if(A.call(this),this.internal.__cell__.printHeaders=Jt,this.internal.__cell__.margins=At,this.internal.__cell__.table_font_size=qt,this.internal.__cell__.padding=lt,this.internal.__cell__.headerBackgroundColor=kt,this.internal.__cell__.headerTextColor=_t,this.setFontSize(qt),T==null)tt=O=Object.keys(x[0]),at=O.map(function(){return"left"});else if(Array.isArray(T)&&Rr(T[0])==="object")for(O=T.map(function(Ut){return Ut.name}),tt=T.map(function(Ut){return Ut.prompt||Ut.name||""}),at=T.map(function(Ut){return Ut.align||"left"}),k=0;k<T.length;k+=1)Tt[T[k].name]=T[k].width*(19.049976/25.4);else Array.isArray(T)&&typeof T[0]=="string"&&(tt=O=T,at=O.map(function(){return"left"}));if(vt||Array.isArray(T)&&typeof T[0]=="string")for(k=0;k<O.length;k+=1){for(Lt[$=O[k]]=x.map(function(Ut){return Ut[$]}),this.setFont(void 0,"bold"),Qt.push(this.getTextDimensions(tt[k],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),W=Lt[$],this.setFont(void 0,"normal"),K=0;K<W.length;K+=1)Qt.push(this.getTextDimensions(W[K],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Tt[$]=Math.max.apply(null,Qt)+lt+lt,Qt=[]}if(Jt){var le={};for(k=0;k<O.length;k+=1)le[O[k]]={},le[O[k]].text=tt[k],le[O[k]].align=at[k];var ie=d.call(this,le,Tt);Ft=O.map(function(Ut){return new o(C,v,Tt[Ut],ie,le[Ut].text,void 0,le[Ut].align)}),this.setTableHeaderRow(Ft),this.printHeaderRow(1,!1)}var ne=T.reduce(function(Ut,fe){return Ut[fe.name]=fe.align,Ut},{});for(k=0;k<x.length;k+=1){"rowStart"in G&&G.rowStart instanceof Function&&G.rowStart({row:k,data:x[k]},this);var te=d.call(this,x[k],Tt);for(K=0;K<O.length;K+=1){var wt=x[k][O[K]];"cellStart"in G&&G.cellStart instanceof Function&&G.cellStart({row:k,col:K,data:wt},this),g.call(this,new o(C,v,Tt[O[K]],te,wt,k+2,ne[O[K]]))}}return this.internal.__cell__.table_x=C,this.internal.__cell__.table_y=v,this};var d=function(C,v){var x=this.internal.__cell__.padding,T=this.internal.__cell__.table_font_size,G=this.internal.scaleFactor;return Object.keys(C).map(function(k){var W=C[k];return this.splitTextToSize(W.hasOwnProperty("text")?W.text:W,v[k]-x-x)},this).map(function(k){return this.getLineHeightFactor()*k.length*T/G+x+x},this).reduce(function(k,W){return Math.max(k,W)},0)};r.setTableHeaderRow=function(C){s.call(this),this.internal.__cell__.tableHeaderRow=C},r.printHeaderRow=function(C,v){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var x;if(i=!0,typeof this.internal.__cell__.headerFunction=="function"){var T=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(T[0],T[1],T[2],T[3],void 0,-1)}this.setFont(void 0,"bold");for(var G=[],k=0;k<this.internal.__cell__.tableHeaderRow.length;k+=1){x=this.internal.__cell__.tableHeaderRow[k].clone(),v&&(x.y=this.internal.__cell__.margins.top||0,G.push(x)),x.lineNumber=C;var W=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),g.call(this,x),this.setTextColor(W)}G.length>0&&this.setTableHeaderRow(G),this.setFont(void 0,"normal"),i=!1}}(er.API);R5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},H5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Py=G5(H5),Z5=[100,200,300,400,500,600,700,800,900],vD=G5(Z5);wD={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},c5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};p5=["times"];(function(r){var t,i,s,A,o,g,d,C,v,x=function(j){return j=j||{},this.isStrokeTransparent=j.isStrokeTransparent||!1,this.strokeOpacity=j.strokeOpacity||1,this.strokeStyle=j.strokeStyle||"#000000",this.fillStyle=j.fillStyle||"#000000",this.isFillTransparent=j.isFillTransparent||!1,this.fillOpacity=j.fillOpacity||1,this.font=j.font||"10px sans-serif",this.textBaseline=j.textBaseline||"alphabetic",this.textAlign=j.textAlign||"left",this.lineWidth=j.lineWidth||1,this.lineJoin=j.lineJoin||"miter",this.lineCap=j.lineCap||"butt",this.path=j.path||[],this.transform=j.transform!==void 0?j.transform.clone():new C,this.globalCompositeOperation=j.globalCompositeOperation||"normal",this.globalAlpha=j.globalAlpha||1,this.clip_path=j.clip_path||[],this.currentPoint=j.currentPoint||new g,this.miterLimit=j.miterLimit||10,this.lastPoint=j.lastPoint||new g,this.lineDashOffset=j.lineDashOffset||0,this.lineDash=j.lineDash||[],this.margin=j.margin||[0,0,0,0],this.prevPageLastElemOffset=j.prevPageLastElemOffset||0,this.ignoreClearRect=typeof j.ignoreClearRect!="boolean"||j.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new T(this),t=this.internal.f2,i=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,A=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,g=this.internal.Point,d=this.internal.Rectangle,C=this.internal.Matrix,v=new x}]);var T=function(j){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var bt=j;Object.defineProperty(this,"pdf",{get:function(){return bt}});var It=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return It},set:function(xt){It=!!xt}});var Ht=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Ht},set:function(xt){Ht=!!xt}});var Ot=0;Object.defineProperty(this,"posX",{get:function(){return Ot},set:function(xt){isNaN(xt)||(Ot=xt)}});var Ae=0;Object.defineProperty(this,"posY",{get:function(){return Ae},set:function(xt){isNaN(xt)||(Ae=xt)}}),Object.defineProperty(this,"margin",{get:function(){return v.margin},set:function(xt){var Rt;typeof xt=="number"?Rt=[xt,xt,xt,xt]:((Rt=new Array(4))[0]=xt[0],Rt[1]=xt.length>=2?xt[1]:Rt[0],Rt[2]=xt.length>=3?xt[2]:Rt[0],Rt[3]=xt.length>=4?xt[3]:Rt[1]),v.margin=Rt}});var he=!1;Object.defineProperty(this,"autoPaging",{get:function(){return he},set:function(xt){he=xt}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(xt){de=xt}});var He=[];Object.defineProperty(this,"pageBreaks",{get:function(){return He},set:function(xt){He=xt}}),Object.defineProperty(this,"ctx",{get:function(){return v},set:function(xt){xt instanceof x&&(v=xt)}}),Object.defineProperty(this,"path",{get:function(){return v.path},set:function(xt){v.path=xt}});var Re=[];Object.defineProperty(this,"ctxStack",{get:function(){return Re},set:function(xt){Re=xt}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(xt){var Rt;Rt=G(xt),this.ctx.fillStyle=Rt.style,this.ctx.isFillTransparent=Rt.a===0,this.ctx.fillOpacity=Rt.a,this.pdf.setFillColor(Rt.r,Rt.g,Rt.b,{a:Rt.a}),this.pdf.setTextColor(Rt.r,Rt.g,Rt.b,{a:Rt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(xt){var Rt=G(xt);this.ctx.strokeStyle=Rt.style,this.ctx.isStrokeTransparent=Rt.a===0,this.ctx.strokeOpacity=Rt.a,Rt.a===0?this.pdf.setDrawColor(255,255,255):(Rt.a,this.pdf.setDrawColor(Rt.r,Rt.g,Rt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(xt){["butt","round","square"].indexOf(xt)!==-1&&(this.ctx.lineCap=xt,this.pdf.setLineCap(xt))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(xt){isNaN(xt)||(this.ctx.lineWidth=xt,this.pdf.setLineWidth(xt))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(xt){["bevel","round","miter"].indexOf(xt)!==-1&&(this.ctx.lineJoin=xt,this.pdf.setLineJoin(xt))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(xt){isNaN(xt)||(this.ctx.miterLimit=xt,this.pdf.setMiterLimit(xt))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(xt){this.ctx.textBaseline=xt}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(xt){["right","end","center","left","start"].indexOf(xt)!==-1&&(this.ctx.textAlign=xt)}});var je=null;function Me(xt,Rt){if(je===null){var Li=function(Ue){var Ee=[];return Object.keys(Ue).forEach(function(Ne){Ue[Ne].forEach(function(Je){var ze=null;switch(Je){case"bold":ze={family:Ne,weight:"bold"};break;case"italic":ze={family:Ne,style:"italic"};break;case"bolditalic":ze={family:Ne,weight:"bold",style:"italic"};break;case"":case"normal":ze={family:Ne}}ze!==null&&(ze.ref={name:Ne,style:Je},Ee.push(ze))})}),Ee}(xt.getFontList());je=function(Ue){for(var Ee={},Ne=0;Ne<Ue.length;++Ne){var Je=My(Ue[Ne]),ze=Je.family,ui=Je.stretch,hi=Je.style,Ei=Je.weight;Ee[ze]=Ee[ze]||{},Ee[ze][ui]=Ee[ze][ui]||{},Ee[ze][ui][hi]=Ee[ze][ui][hi]||{},Ee[ze][ui][hi][Ei]=Je}return Ee}(Li.concat(Rt))}return je}var gi=null;Object.defineProperty(this,"fontFaces",{get:function(){return gi},set:function(xt){je=null,gi=xt}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(xt){var Rt;if(this.ctx.font=xt,(Rt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(xt))!==null){var Li=Rt[1],Ue=(Rt[2],Rt[3]),Ee=Rt[4],Ne=(Rt[5],Rt[6]),Je=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ee)[2];Ee=Math.floor(Je==="px"?parseFloat(Ee)*this.pdf.internal.scaleFactor:Je==="em"?parseFloat(Ee)*this.pdf.getFontSize():parseFloat(Ee)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ee);var ze=function(mi){var Vi,We,Se=[],$e=mi.trim();if($e==="")return p5;if($e in c5)return[c5[$e]];for(;$e!=="";){switch(We=null,Vi=($e=h5($e)).charAt(0)){case'"':case"'":We=_D($e.substring(1),Vi);break;default:We=xD($e)}if(We===null||(Se.push(We[0]),($e=h5(We[1]))!==""&&$e.charAt(0)!==","))return p5;$e=$e.replace(/^,/,"")}return Se}(Ne);if(this.fontFaces){var ui=BD(Me(this.pdf,this.fontFaces),ze.map(function(mi){return{family:mi,stretch:"normal",weight:Ue,style:Li}}));this.pdf.setFont(ui.ref.name,ui.ref.style)}else{var hi="";(Ue==="bold"||parseInt(Ue,10)>=700||Li==="bold")&&(hi="bold"),Li==="italic"&&(hi+="italic"),hi.length===0&&(hi="normal");for(var Ei="",Pi={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ie=0;Ie<ze.length;Ie++){if(this.pdf.internal.getFont(ze[Ie],hi,{noFallback:!0,disableWarning:!0})!==void 0){Ei=ze[Ie];break}if(hi==="bolditalic"&&this.pdf.internal.getFont(ze[Ie],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ei=ze[Ie],hi="bold";else if(this.pdf.internal.getFont(ze[Ie],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ei=ze[Ie],hi="normal";break}}if(Ei===""){for(var Oi=0;Oi<ze.length;Oi++)if(Pi[ze[Oi]]){Ei=Pi[ze[Oi]];break}}Ei=Ei===""?"Times":Ei,this.pdf.setFont(Ei,hi)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(xt){this.ctx.globalCompositeOperation=xt}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(xt){this.ctx.globalAlpha=xt}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(xt){this.ctx.lineDashOffset=xt,fe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(xt){this.ctx.lineDash=xt,fe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(xt){this.ctx.ignoreClearRect=!!xt}})};T.prototype.setLineDash=function(j){this.lineDash=j},T.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},T.prototype.fill=function(){Lt.call(this,"fill",!1)},T.prototype.stroke=function(){Lt.call(this,"stroke",!1)},T.prototype.beginPath=function(){this.path=[{type:"begin"}]},T.prototype.moveTo=function(j,bt){if(isNaN(j)||isNaN(bt))throw sn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var It=this.ctx.transform.applyToPoint(new g(j,bt));this.path.push({type:"mt",x:It.x,y:It.y}),this.ctx.lastPoint=new g(j,bt)},T.prototype.closePath=function(){var j=new g(0,0),bt=0;for(bt=this.path.length-1;bt!==-1;bt--)if(this.path[bt].type==="begin"&&Rr(this.path[bt+1])==="object"&&typeof this.path[bt+1].x=="number"){j=new g(this.path[bt+1].x,this.path[bt+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new g(j.x,j.y)},T.prototype.lineTo=function(j,bt){if(isNaN(j)||isNaN(bt))throw sn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var It=this.ctx.transform.applyToPoint(new g(j,bt));this.path.push({type:"lt",x:It.x,y:It.y}),this.ctx.lastPoint=new g(It.x,It.y)},T.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Lt.call(this,null,!0)},T.prototype.quadraticCurveTo=function(j,bt,It,Ht){if(isNaN(It)||isNaN(Ht)||isNaN(j)||isNaN(bt))throw sn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ot=this.ctx.transform.applyToPoint(new g(It,Ht)),Ae=this.ctx.transform.applyToPoint(new g(j,bt));this.path.push({type:"qct",x1:Ae.x,y1:Ae.y,x:Ot.x,y:Ot.y}),this.ctx.lastPoint=new g(Ot.x,Ot.y)},T.prototype.bezierCurveTo=function(j,bt,It,Ht,Ot,Ae){if(isNaN(Ot)||isNaN(Ae)||isNaN(j)||isNaN(bt)||isNaN(It)||isNaN(Ht))throw sn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var he=this.ctx.transform.applyToPoint(new g(Ot,Ae)),de=this.ctx.transform.applyToPoint(new g(j,bt)),He=this.ctx.transform.applyToPoint(new g(It,Ht));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:He.x,y2:He.y,x:he.x,y:he.y}),this.ctx.lastPoint=new g(he.x,he.y)},T.prototype.arc=function(j,bt,It,Ht,Ot,Ae){if(isNaN(j)||isNaN(bt)||isNaN(It)||isNaN(Ht)||isNaN(Ot))throw sn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Ae=!!Ae,!this.ctx.transform.isIdentity){var he=this.ctx.transform.applyToPoint(new g(j,bt));j=he.x,bt=he.y;var de=this.ctx.transform.applyToPoint(new g(0,It)),He=this.ctx.transform.applyToPoint(new g(0,0));It=Math.sqrt(Math.pow(de.x-He.x,2)+Math.pow(de.y-He.y,2))}Math.abs(Ot-Ht)>=2*Math.PI&&(Ht=0,Ot=2*Math.PI),this.path.push({type:"arc",x:j,y:bt,radius:It,startAngle:Ht,endAngle:Ot,counterclockwise:Ae})},T.prototype.arcTo=function(j,bt,It,Ht,Ot){throw new Error("arcTo not implemented.")},T.prototype.rect=function(j,bt,It,Ht){if(isNaN(j)||isNaN(bt)||isNaN(It)||isNaN(Ht))throw sn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(j,bt),this.lineTo(j+It,bt),this.lineTo(j+It,bt+Ht),this.lineTo(j,bt+Ht),this.lineTo(j,bt),this.lineTo(j+It,bt),this.lineTo(j,bt)},T.prototype.fillRect=function(j,bt,It,Ht){if(isNaN(j)||isNaN(bt)||isNaN(It)||isNaN(Ht))throw sn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!k.call(this)){var Ot={};this.lineCap!=="butt"&&(Ot.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ot.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(j,bt,It,Ht),this.fill(),Ot.hasOwnProperty("lineCap")&&(this.lineCap=Ot.lineCap),Ot.hasOwnProperty("lineJoin")&&(this.lineJoin=Ot.lineJoin)}},T.prototype.strokeRect=function(j,bt,It,Ht){if(isNaN(j)||isNaN(bt)||isNaN(It)||isNaN(Ht))throw sn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");W.call(this)||(this.beginPath(),this.rect(j,bt,It,Ht),this.stroke())},T.prototype.clearRect=function(j,bt,It,Ht){if(isNaN(j)||isNaN(bt)||isNaN(It)||isNaN(Ht))throw sn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(j,bt,It,Ht))},T.prototype.save=function(j){j=typeof j!="boolean"||j;for(var bt=this.pdf.internal.getCurrentPageInfo().pageNumber,It=0;It<this.pdf.internal.getNumberOfPages();It++)this.pdf.setPage(It+1),this.pdf.internal.out("q");if(this.pdf.setPage(bt),j){this.ctx.fontSize=this.pdf.internal.getFontSize();var Ht=new x(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Ht}},T.prototype.restore=function(j){j=typeof j!="boolean"||j;for(var bt=this.pdf.internal.getCurrentPageInfo().pageNumber,It=0;It<this.pdf.internal.getNumberOfPages();It++)this.pdf.setPage(It+1),this.pdf.internal.out("Q");this.pdf.setPage(bt),j&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},T.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var G=function(j){var bt,It,Ht,Ot;if(j.isCanvasGradient===!0&&(j=j.getColor()),!j)return{r:0,g:0,b:0,a:0,style:j};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(j))bt=0,It=0,Ht=0,Ot=0;else{var Ae=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(j);if(Ae!==null)bt=parseInt(Ae[1]),It=parseInt(Ae[2]),Ht=parseInt(Ae[3]),Ot=1;else if((Ae=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(j))!==null)bt=parseInt(Ae[1]),It=parseInt(Ae[2]),Ht=parseInt(Ae[3]),Ot=parseFloat(Ae[4]);else{if(Ot=1,typeof j=="string"&&j.charAt(0)!=="#"){var he=new k5(j);j=he.ok?he.toHex():"#000000"}j.length===4?(bt=j.substring(1,2),bt+=bt,It=j.substring(2,3),It+=It,Ht=j.substring(3,4),Ht+=Ht):(bt=j.substring(1,3),It=j.substring(3,5),Ht=j.substring(5,7)),bt=parseInt(bt,16),It=parseInt(It,16),Ht=parseInt(Ht,16)}}return{r:bt,g:It,b:Ht,a:Ot,style:j}},k=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},W=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};T.prototype.fillText=function(j,bt,It,Ht){if(isNaN(bt)||isNaN(It)||typeof j!="string")throw sn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Ht=isNaN(Ht)?void 0:Ht,!k.call(this)){var Ot=te(this.ctx.transform.rotation),Ae=this.ctx.transform.scaleX;lt.call(this,{text:j,x:bt,y:It,scale:Ae,angle:Ot,align:this.textAlign,maxWidth:Ht})}},T.prototype.strokeText=function(j,bt,It,Ht){if(isNaN(bt)||isNaN(It)||typeof j!="string")throw sn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!W.call(this)){Ht=isNaN(Ht)?void 0:Ht;var Ot=te(this.ctx.transform.rotation),Ae=this.ctx.transform.scaleX;lt.call(this,{text:j,x:bt,y:It,scale:Ae,renderingMode:"stroke",angle:Ot,align:this.textAlign,maxWidth:Ht})}},T.prototype.measureText=function(j){if(typeof j!="string")throw sn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var bt=this.pdf,It=this.pdf.internal.scaleFactor,Ht=bt.internal.getFontSize(),Ot=bt.getStringUnitWidth(j)*Ht/bt.internal.scaleFactor,Ae=function(he){var de=(he=he||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this};return new Ae({width:Ot*=Math.round(96*It/72*1e4)/1e4})},T.prototype.scale=function(j,bt){if(isNaN(j)||isNaN(bt))throw sn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var It=new C(j,0,0,bt,0,0);this.ctx.transform=this.ctx.transform.multiply(It)},T.prototype.rotate=function(j){if(isNaN(j))throw sn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var bt=new C(Math.cos(j),Math.sin(j),-Math.sin(j),Math.cos(j),0,0);this.ctx.transform=this.ctx.transform.multiply(bt)},T.prototype.translate=function(j,bt){if(isNaN(j)||isNaN(bt))throw sn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var It=new C(1,0,0,1,j,bt);this.ctx.transform=this.ctx.transform.multiply(It)},T.prototype.transform=function(j,bt,It,Ht,Ot,Ae){if(isNaN(j)||isNaN(bt)||isNaN(It)||isNaN(Ht)||isNaN(Ot)||isNaN(Ae))throw sn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var he=new C(j,bt,It,Ht,Ot,Ae);this.ctx.transform=this.ctx.transform.multiply(he)},T.prototype.setTransform=function(j,bt,It,Ht,Ot,Ae){j=isNaN(j)?1:j,bt=isNaN(bt)?0:bt,It=isNaN(It)?0:It,Ht=isNaN(Ht)?1:Ht,Ot=isNaN(Ot)?0:Ot,Ae=isNaN(Ae)?0:Ae,this.ctx.transform=new C(j,bt,It,Ht,Ot,Ae)};var K=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};T.prototype.drawImage=function(j,bt,It,Ht,Ot,Ae,he,de,He){var Re=this.pdf.getImageProperties(j),je=1,Me=1,gi=1,xt=1;Ht!==void 0&&de!==void 0&&(gi=de/Ht,xt=He/Ot,je=Re.width/Ht*de/Ht,Me=Re.height/Ot*He/Ot),Ae===void 0&&(Ae=bt,he=It,bt=0,It=0),Ht!==void 0&&de===void 0&&(de=Ht,He=Ot),Ht===void 0&&de===void 0&&(de=Re.width,He=Re.height);for(var Rt,Li=this.ctx.transform.decompose(),Ue=te(Li.rotate.shx),Ee=new C,Ne=(Ee=(Ee=(Ee=Ee.multiply(Li.translate)).multiply(Li.skew)).multiply(Li.scale)).applyToRectangle(new d(Ae-bt*gi,he-It*xt,Ht*je,Ot*Me)),Je=$.call(this,Ne),ze=[],ui=0;ui<Je.length;ui+=1)ze.indexOf(Je[ui])===-1&&ze.push(Je[ui]);if(at(ze),this.autoPaging)for(var hi=ze[0],Ei=ze[ze.length-1],Pi=hi;Pi<Ei+1;Pi++){this.pdf.setPage(Pi);var Ie=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Oi=Pi===1?this.posY+this.margin[0]:this.margin[0],mi=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Vi=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],We=Pi===1?0:mi+(Pi-2)*Vi;if(this.ctx.clip_path.length!==0){var Se=this.path;Rt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=tt(Rt,this.posX+this.margin[3],-We+Oi+this.ctx.prevPageLastElemOffset),Tt.call(this,"fill",!0),this.path=Se}var $e=JSON.parse(JSON.stringify(Ne));$e=tt([$e],this.posX+this.margin[3],-We+Oi+this.ctx.prevPageLastElemOffset)[0];var di=(Pi>hi||Pi<Ei)&&K.call(this);di&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ie,Vi,null).clip().discardPath()),this.pdf.addImage(j,"JPEG",$e.x,$e.y,$e.w,$e.h,null,null,Ue),di&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(j,"JPEG",Ne.x,Ne.y,Ne.w,Ne.h,null,null,Ue)};var $=function(j,bt,It){var Ht=[];bt=bt||this.pdf.internal.pageSize.width,It=It||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ot=this.posY+this.ctx.prevPageLastElemOffset;switch(j.type){default:case"mt":case"lt":Ht.push(Math.floor((j.y+Ot)/It)+1);break;case"arc":Ht.push(Math.floor((j.y+Ot-j.radius)/It)+1),Ht.push(Math.floor((j.y+Ot+j.radius)/It)+1);break;case"qct":var Ae=wt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x,j.y);Ht.push(Math.floor((Ae.y+Ot)/It)+1),Ht.push(Math.floor((Ae.y+Ae.h+Ot)/It)+1);break;case"bct":var he=Ut(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x2,j.y2,j.x,j.y);Ht.push(Math.floor((he.y+Ot)/It)+1),Ht.push(Math.floor((he.y+he.h+Ot)/It)+1);break;case"rect":Ht.push(Math.floor((j.y+Ot)/It)+1),Ht.push(Math.floor((j.y+j.h+Ot)/It)+1)}for(var de=0;de<Ht.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<Ht[de];)O.call(this);return Ht},O=function(){var j=this.fillStyle,bt=this.strokeStyle,It=this.font,Ht=this.lineCap,Ot=this.lineWidth,Ae=this.lineJoin;this.pdf.addPage(),this.fillStyle=j,this.strokeStyle=bt,this.font=It,this.lineCap=Ht,this.lineWidth=Ot,this.lineJoin=Ae},tt=function(j,bt,It){for(var Ht=0;Ht<j.length;Ht++)switch(j[Ht].type){case"bct":j[Ht].x2+=bt,j[Ht].y2+=It;case"qct":j[Ht].x1+=bt,j[Ht].y1+=It;case"mt":case"lt":case"arc":default:j[Ht].x+=bt,j[Ht].y+=It}return j},at=function(j){return j.sort(function(bt,It){return bt-It})},Lt=function(j,bt){for(var It,Ht,Ot=this.fillStyle,Ae=this.strokeStyle,he=this.lineCap,de=this.lineWidth,He=Math.abs(de*this.ctx.transform.scaleX),Re=this.lineJoin,je=JSON.parse(JSON.stringify(this.path)),Me=JSON.parse(JSON.stringify(this.path)),gi=[],xt=0;xt<Me.length;xt++)if(Me[xt].x!==void 0)for(var Rt=$.call(this,Me[xt]),Li=0;Li<Rt.length;Li+=1)gi.indexOf(Rt[Li])===-1&&gi.push(Rt[Li]);for(var Ue=0;Ue<gi.length;Ue++)for(;this.pdf.internal.getNumberOfPages()<gi[Ue];)O.call(this);if(at(gi),this.autoPaging)for(var Ee=gi[0],Ne=gi[gi.length-1],Je=Ee;Je<Ne+1;Je++){this.pdf.setPage(Je),this.fillStyle=Ot,this.strokeStyle=Ae,this.lineCap=he,this.lineWidth=He,this.lineJoin=Re;var ze=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ui=Je===1?this.posY+this.margin[0]:this.margin[0],hi=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ei=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Pi=Je===1?0:hi+(Je-2)*Ei;if(this.ctx.clip_path.length!==0){var Ie=this.path;It=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=tt(It,this.posX+this.margin[3],-Pi+ui+this.ctx.prevPageLastElemOffset),Tt.call(this,j,!0),this.path=Ie}if(Ht=JSON.parse(JSON.stringify(je)),this.path=tt(Ht,this.posX+this.margin[3],-Pi+ui+this.ctx.prevPageLastElemOffset),bt===!1||Je===0){var Oi=(Je>Ee||Je<Ne)&&K.call(this);Oi&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ze,Ei,null).clip().discardPath()),Tt.call(this,j,bt),Oi&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=He,Tt.call(this,j,bt),this.lineWidth=de;this.path=je},Tt=function(j,bt){if((j!=="stroke"||bt||!W.call(this))&&(j==="stroke"||bt||!k.call(this))){for(var It,Ht,Ot=[],Ae=this.path,he=0;he<Ae.length;he++){var de=Ae[he];switch(de.type){case"begin":Ot.push({begin:!0});break;case"close":Ot.push({close:!0});break;case"mt":Ot.push({start:de,deltas:[],abs:[]});break;case"lt":var He=Ot.length;if(Ae[he-1]&&!isNaN(Ae[he-1].x)&&(It=[de.x-Ae[he-1].x,de.y-Ae[he-1].y],He>0)){for(;He>=0;He--)if(Ot[He-1].close!==!0&&Ot[He-1].begin!==!0){Ot[He-1].deltas.push(It),Ot[He-1].abs.push(de);break}}break;case"bct":It=[de.x1-Ae[he-1].x,de.y1-Ae[he-1].y,de.x2-Ae[he-1].x,de.y2-Ae[he-1].y,de.x-Ae[he-1].x,de.y-Ae[he-1].y],Ot[Ot.length-1].deltas.push(It);break;case"qct":var Re=Ae[he-1].x+2/3*(de.x1-Ae[he-1].x),je=Ae[he-1].y+2/3*(de.y1-Ae[he-1].y),Me=de.x+2/3*(de.x1-de.x),gi=de.y+2/3*(de.y1-de.y),xt=de.x,Rt=de.y;It=[Re-Ae[he-1].x,je-Ae[he-1].y,Me-Ae[he-1].x,gi-Ae[he-1].y,xt-Ae[he-1].x,Rt-Ae[he-1].y],Ot[Ot.length-1].deltas.push(It);break;case"arc":Ot.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ot[Ot.length-1].abs)&&Ot[Ot.length-1].abs.push(de)}}Ht=bt?null:j==="stroke"?"stroke":"fill";for(var Li=!1,Ue=0;Ue<Ot.length;Ue++)if(Ot[Ue].arc)for(var Ee=Ot[Ue].abs,Ne=0;Ne<Ee.length;Ne++){var Je=Ee[Ne];Je.type==="arc"?vt.call(this,Je.x,Je.y,Je.radius,Je.startAngle,Je.endAngle,Je.counterclockwise,void 0,bt,!Li):kt.call(this,Je.x,Je.y),Li=!0}else if(Ot[Ue].close===!0)this.pdf.internal.out("h"),Li=!1;else if(Ot[Ue].begin!==!0){var ze=Ot[Ue].start.x,ui=Ot[Ue].start.y;_t.call(this,Ot[Ue].deltas,ze,ui),Li=!0}Ht&&Jt.call(this,Ht),bt&&qt.call(this)}},Qt=function(j){var bt=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,It=bt*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return j-It;case"top":return j+bt-It;case"hanging":return j+bt-2*It;case"middle":return j+bt/2-It;case"ideographic":return j;case"alphabetic":default:return j}},Ft=function(j){return j+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};T.prototype.createLinearGradient=function(){var j=function(){};return j.colorStops=[],j.addColorStop=function(bt,It){this.colorStops.push([bt,It])},j.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},j.isCanvasGradient=!0,j},T.prototype.createPattern=function(){return this.createLinearGradient()},T.prototype.createRadialGradient=function(){return this.createLinearGradient()};var vt=function(j,bt,It,Ht,Ot,Ae,he,de,He){for(var Re=ie.call(this,It,Ht,Ot,Ae),je=0;je<Re.length;je++){var Me=Re[je];je===0&&(He?At.call(this,Me.x1+j,Me.y1+bt):kt.call(this,Me.x1+j,Me.y1+bt)),le.call(this,j,bt,Me.x2,Me.y2,Me.x3,Me.y3,Me.x4,Me.y4)}de?qt.call(this):Jt.call(this,he)},Jt=function(j){switch(j){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},qt=function(){this.pdf.clip(),this.pdf.discardPath()},At=function(j,bt){this.pdf.internal.out(i(j)+" "+s(bt)+" m")},lt=function(j){var bt;switch(j.align){case"right":case"end":bt="right";break;case"center":bt="center";break;case"left":case"start":default:bt="left"}var It=this.pdf.getTextDimensions(j.text),Ht=Qt.call(this,j.y),Ot=Ft.call(this,Ht)-It.h,Ae=this.ctx.transform.applyToPoint(new g(j.x,Ht)),he=this.ctx.transform.decompose(),de=new C;de=(de=(de=de.multiply(he.translate)).multiply(he.skew)).multiply(he.scale);for(var He,Re,je,Me=this.ctx.transform.applyToRectangle(new d(j.x,Ht,It.w,It.h)),gi=de.applyToRectangle(new d(j.x,Ot,It.w,It.h)),xt=$.call(this,gi),Rt=[],Li=0;Li<xt.length;Li+=1)Rt.indexOf(xt[Li])===-1&&Rt.push(xt[Li]);if(at(Rt),this.autoPaging)for(var Ue=Rt[0],Ee=Rt[Rt.length-1],Ne=Ue;Ne<Ee+1;Ne++){this.pdf.setPage(Ne);var Je=Ne===1?this.posY+this.margin[0]:this.margin[0],ze=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ui=this.pdf.internal.pageSize.height-this.margin[2],hi=ui-this.margin[0],Ei=this.pdf.internal.pageSize.width-this.margin[1],Pi=Ei-this.margin[3],Ie=Ne===1?0:ze+(Ne-2)*hi;if(this.ctx.clip_path.length!==0){var Oi=this.path;He=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=tt(He,this.posX+this.margin[3],-1*Ie+Je),Tt.call(this,"fill",!0),this.path=Oi}var mi=tt([JSON.parse(JSON.stringify(gi))],this.posX+this.margin[3],-Ie+Je+this.ctx.prevPageLastElemOffset)[0];j.scale>=.01&&(Re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Re*j.scale),je=this.lineWidth,this.lineWidth=je*j.scale);var Vi=this.autoPaging!=="text";if(Vi||mi.y+mi.h<=ui){if(Vi||mi.y>=Je&&mi.x<=Ei){var We=Vi?j.text:this.pdf.splitTextToSize(j.text,j.maxWidth||Ei-mi.x)[0],Se=tt([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-Ie+Je+this.ctx.prevPageLastElemOffset)[0],$e=Vi&&(Ne>Ue||Ne<Ee)&&K.call(this);$e&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pi,hi,null).clip().discardPath()),this.pdf.text(We,Se.x,Se.y,{angle:j.angle,align:bt,renderingMode:j.renderingMode}),$e&&this.pdf.restoreGraphicsState()}}else mi.y<ui&&(this.ctx.prevPageLastElemOffset+=ui-mi.y);j.scale>=.01&&(this.pdf.setFontSize(Re),this.lineWidth=je)}else j.scale>=.01&&(Re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Re*j.scale),je=this.lineWidth,this.lineWidth=je*j.scale),this.pdf.text(j.text,Ae.x+this.posX,Ae.y+this.posY,{angle:j.angle,align:bt,renderingMode:j.renderingMode,maxWidth:j.maxWidth}),j.scale>=.01&&(this.pdf.setFontSize(Re),this.lineWidth=je)},kt=function(j,bt,It,Ht){It=It||0,Ht=Ht||0,this.pdf.internal.out(i(j+It)+" "+s(bt+Ht)+" l")},_t=function(j,bt,It){return this.pdf.lines(j,bt,It,null,null)},le=function(j,bt,It,Ht,Ot,Ae,he,de){this.pdf.internal.out([t(A(It+j)),t(o(Ht+bt)),t(A(Ot+j)),t(o(Ae+bt)),t(A(he+j)),t(o(de+bt)),"c"].join(" "))},ie=function(j,bt,It,Ht){for(var Ot=2*Math.PI,Ae=Math.PI/2;bt>It;)bt-=Ot;var he=Math.abs(It-bt);he<Ot&&Ht&&(he=Ot-he);for(var de=[],He=Ht?-1:1,Re=bt;he>1e-5;){var je=Re+He*Math.min(he,Ae);de.push(ne.call(this,j,Re,je)),he-=Math.abs(je-Re),Re=je}return de},ne=function(j,bt,It){var Ht=(It-bt)/2,Ot=j*Math.cos(Ht),Ae=j*Math.sin(Ht),he=Ot,de=-Ae,He=he*he+de*de,Re=He+he*Ot+de*Ae,je=4/3*(Math.sqrt(2*He*Re)-Re)/(he*Ae-de*Ot),Me=he-je*de,gi=de+je*he,xt=Me,Rt=-gi,Li=Ht+bt,Ue=Math.cos(Li),Ee=Math.sin(Li);return{x1:j*Math.cos(bt),y1:j*Math.sin(bt),x2:Me*Ue-gi*Ee,y2:Me*Ee+gi*Ue,x3:xt*Ue-Rt*Ee,y3:xt*Ee+Rt*Ue,x4:j*Math.cos(It),y4:j*Math.sin(It)}},te=function(j){return 180*j/Math.PI},wt=function(j,bt,It,Ht,Ot,Ae){var he=j+.5*(It-j),de=bt+.5*(Ht-bt),He=Ot+.5*(It-Ot),Re=Ae+.5*(Ht-Ae),je=Math.min(j,Ot,he,He),Me=Math.max(j,Ot,he,He),gi=Math.min(bt,Ae,de,Re),xt=Math.max(bt,Ae,de,Re);return new d(je,gi,Me-je,xt-gi)},Ut=function(j,bt,It,Ht,Ot,Ae,he,de){var He,Re,je,Me,gi,xt,Rt,Li,Ue,Ee,Ne,Je,ze,ui,hi=It-j,Ei=Ht-bt,Pi=Ot-It,Ie=Ae-Ht,Oi=he-Ot,mi=de-Ae;for(Re=0;Re<41;Re++)Ue=(Rt=(je=j+(He=Re/40)*hi)+He*((gi=It+He*Pi)-je))+He*(gi+He*(Ot+He*Oi-gi)-Rt),Ee=(Li=(Me=bt+He*Ei)+He*((xt=Ht+He*Ie)-Me))+He*(xt+He*(Ae+He*mi-xt)-Li),Re==0?(Ne=Ue,Je=Ee,ze=Ue,ui=Ee):(Ne=Math.min(Ne,Ue),Je=Math.min(Je,Ee),ze=Math.max(ze,Ue),ui=Math.max(ui,Ee));return new d(Math.round(Ne),Math.round(Je),Math.round(ze-Ne),Math.round(ui-Je))},fe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var j,bt,It=(j=this.ctx.lineDash,bt=this.ctx.lineDashOffset,JSON.stringify({lineDash:j,lineDashOffset:bt}));this.prevLineDash!==It&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=It)}}})(er.API),function(r){var t=function(o){var g,d,C,v,x,T,G,k,W,K;for(d=[],C=0,v=(o+=g="\0\0\0\0".slice(o.length%4||4)).length;v>C;C+=4)(x=(o.charCodeAt(C)<<24)+(o.charCodeAt(C+1)<<16)+(o.charCodeAt(C+2)<<8)+o.charCodeAt(C+3))!==0?(T=(x=((x=((x=((x=(x-(K=x%85))/85)-(W=x%85))/85)-(k=x%85))/85)-(G=x%85))/85)%85,d.push(T+33,G+33,k+33,W+33,K+33)):d.push(122);return function($,O){for(var tt=O;tt>0;tt--)$.pop()}(d,g.length),String.fromCharCode.apply(String,d)+"~>"},i=function(o){var g,d,C,v,x,T=String,G="length",k=255,W="charCodeAt",K="slice",$="replace";for(o[K](-2),o=o[K](0,-2)[$](/\s/g,"")[$]("z","!!!!!"),C=[],v=0,x=(o+=g="uuuuu"[K](o[G]%5||5))[G];x>v;v+=5)d=52200625*(o[W](v)-33)+614125*(o[W](v+1)-33)+7225*(o[W](v+2)-33)+85*(o[W](v+3)-33)+(o[W](v+4)-33),C.push(k&d>>24,k&d>>16,k&d>>8,k&d);return function(O,tt){for(var at=tt;at>0;at--)O.pop()}(C,g[G]),T.fromCharCode.apply(T,C)},s=function(o){var g=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),g.test(o)===!1)return"";for(var d="",C=0;C<o.length;C+=2)d+=String.fromCharCode("0x"+(o[C]+o[C+1]));return d},A=function(o){for(var g=new Uint8Array(o.length),d=o.length;d--;)g[d]=o.charCodeAt(d);return o=(g=Uy(g)).reduce(function(C,v){return C+String.fromCharCode(v)},"")};r.processDataByFilters=function(o,g){var d=0,C=o||"",v=[];for(typeof(g=g||[])=="string"&&(g=[g]),d=0;d<g.length;d+=1)switch(g[d]){case"ASCII85Decode":case"/ASCII85Decode":C=i(C),v.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":C=t(C),v.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":C=s(C),v.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":C=C.split("").map(function(x){return("0"+x.charCodeAt().toString(16)).slice(-2)}).join("")+">",v.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":C=A(C),v.push("/FlateDecode");break;default:throw new Error('The filter: "'+g[d]+'" is not implemented')}return{data:C,reverseChain:v.reverse().join(" ")}}}(er.API),function(r){r.loadFile=function(t,i,s){return function(A,o,g){o=o!==!1,g=typeof g=="function"?g:function(){};var d=void 0;try{d=function(C,v,x){var T=new XMLHttpRequest,G=0,k=function(W){var K=W.length,$=[],O=String.fromCharCode;for(G=0;G<K;G+=1)$.push(O(255&W.charCodeAt(G)));return $.join("")};if(T.open("GET",C,!v),T.overrideMimeType("text/plain; charset=x-user-defined"),v===!1&&(T.onload=function(){T.status===200?x(k(this.responseText)):x(void 0)}),T.send(null),v&&T.status===200)return k(T.responseText)}(A,o,g)}catch{}return d}(t,i,s)},r.loadImageFile=r.loadFile}(er.API),function(r){function t(){return(ir.html2canvas?Promise.resolve(ir.html2canvas):Promise.resolve().then(()=>(Y2(),X2))).catch(function(g){return Promise.reject(new Error("Could not load html2canvas: "+g))}).then(function(g){return g.default?g.default:g})}function i(){return(ir.DOMPurify?Promise.resolve(ir.DOMPurify):Promise.resolve().then(()=>(ow(),sw))).catch(function(g){return Promise.reject(new Error("Could not load dompurify: "+g))}).then(function(g){return g.default?g.default:g})}var s=function(g){var d=Rr(g);return d==="undefined"?"undefined":d==="string"||g instanceof String?"string":d==="number"||g instanceof Number?"number":d==="function"||g instanceof Function?"function":g&&g.constructor===Array?"array":g&&g.nodeType===1?"element":d==="object"?"object":"unknown"},A=function(g,d){var C=document.createElement(g);for(var v in d.className&&(C.className=d.className),d.innerHTML&&d.dompurify&&(C.innerHTML=d.dompurify.sanitize(d.innerHTML)),d.style)C.style[v]=d.style[v];return C},o=function g(d){var C=Object.assign(g.convert(Promise.resolve()),JSON.parse(JSON.stringify(g.template))),v=g.convert(Promise.resolve(),C);return v=(v=v.setProgress(1,g,1,[g])).set(d)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(g,d){return g.__proto__=d||o.prototype,g},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(g,d){return this.then(function(){switch(d=d||function(C){switch(s(C)){case"string":return"string";case"element":return C.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(g)){case"string":return this.then(i).then(function(C){return this.set({src:A("div",{innerHTML:g,dompurify:C})})});case"element":return this.set({src:g});case"canvas":return this.set({canvas:g});case"img":return this.set({img:g});default:return this.error("Unknown source type.")}})},o.prototype.to=function(g){switch(g){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var g={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},d=function C(v,x){for(var T=v.nodeType===3?document.createTextNode(v.nodeValue):v.cloneNode(!1),G=v.firstChild;G;G=G.nextSibling)x!==!0&&G.nodeType===1&&G.nodeName==="SCRIPT"||T.appendChild(C(G,x));return v.nodeType===1&&(v.nodeName==="CANVAS"?(T.width=v.width,T.height=v.height,T.getContext("2d").drawImage(v,0,0)):v.nodeName!=="TEXTAREA"&&v.nodeName!=="SELECT"||(T.value=v.value),T.addEventListener("load",function(){T.scrollTop=v.scrollTop,T.scrollLeft=v.scrollLeft},!0)),T}(this.prop.src,this.opt.html2canvas.javascriptEnabled);d.tagName==="BODY"&&(g.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=A("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=A("div",{className:"html2pdf__container",style:g}),this.prop.container.appendChild(d),this.prop.container.firstChild.appendChild(A("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var g=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(g).then(t).then(function(d){var C=Object.assign({},this.opt.html2canvas);return delete C.onrendered,d(this.prop.container,C)}).then(function(d){(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var g=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(g).then(t).then(function(d){var C=this.opt.jsPDF,v=this.opt.fontFaces,x=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,T=Object.assign({async:!0,allowTaint:!0,scale:x,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete T.onrendered,C.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,C.context2d.posX=this.opt.x,C.context2d.posY=this.opt.y,C.context2d.margin=this.opt.margin,C.context2d.fontFaces=v,v)for(var G=0;G<v.length;++G){var k=v[G],W=k.src.find(function(K){return K.format==="truetype"});W&&C.addFont(W.url,k.ref.name,k.ref.style)}return T.windowHeight=T.windowHeight||0,T.windowHeight=T.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):T.windowHeight,C.context2d.save(!0),d(this.prop.container,T)}).then(function(d){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(d),this.prop.canvas=d,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var g=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=g})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(g,d,C){return(C=C||"pdf").toLowerCase()==="img"||C.toLowerCase()==="image"?this.outputImg(g,d):this.outputPdf(g,d)},o.prototype.outputPdf=function(g,d){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(g,d)})},o.prototype.outputImg=function(g){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(g){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+g+'" is not supported.'}})},o.prototype.save=function(g){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(g?{filename:g}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(g){if(s(g)!=="object")return this;var d=Object.keys(g||{}).map(function(C){if(C in o.template.prop)return function(){this.prop[C]=g[C]};switch(C){case"margin":return this.setMargin.bind(this,g.margin);case"jsPDF":return function(){return this.opt.jsPDF=g.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,g.pageSize);default:return function(){this.opt[C]=g[C]}}},this);return this.then(function(){return this.thenList(d)})},o.prototype.get=function(g,d){return this.then(function(){var C=g in o.template.prop?this.prop[g]:this.opt[g];return d?d(C):C})},o.prototype.setMargin=function(g){return this.then(function(){switch(s(g)){case"number":g=[g,g,g,g];case"array":if(g.length===2&&(g=[g[0],g[1],g[0],g[1]]),g.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=g}).then(this.setPageSize)},o.prototype.setPageSize=function(g){function d(C,v){return Math.floor(C*v/72*96)}return this.then(function(){(g=g||er.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(g.inner={width:g.width-this.opt.margin[1]-this.opt.margin[3],height:g.height-this.opt.margin[0]-this.opt.margin[2]},g.inner.px={width:d(g.inner.width,g.k),height:d(g.inner.height,g.k)},g.inner.ratio=g.inner.height/g.inner.width),this.prop.pageSize=g})},o.prototype.setProgress=function(g,d,C,v){return g!=null&&(this.progress.val=g),d!=null&&(this.progress.state=d),C!=null&&(this.progress.n=C),v!=null&&(this.progress.stack=v),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(g,d,C,v){return this.setProgress(g?this.progress.val+g:null,d||null,C?this.progress.n+C:null,v?this.progress.stack.concat(v):null)},o.prototype.then=function(g,d){var C=this;return this.thenCore(g,d,function(v,x){return C.updateProgress(null,null,1,[v]),Promise.prototype.then.call(this,function(T){return C.updateProgress(null,v),T}).then(v,x).then(function(T){return C.updateProgress(1),T})})},o.prototype.thenCore=function(g,d,C){C=C||Promise.prototype.then,g&&(g=g.bind(this)),d&&(d=d.bind(this));var v=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:o.convert(Object.assign({},this),Promise.prototype),x=C.call(v,g,d);return o.convert(x,this.__proto__)},o.prototype.thenExternal=function(g,d){return Promise.prototype.then.call(this,g,d)},o.prototype.thenList=function(g){var d=this;return g.forEach(function(C){d=d.thenCore(C)}),d},o.prototype.catch=function(g){g&&(g=g.bind(this));var d=Promise.prototype.catch.call(this,g);return o.convert(d,this)},o.prototype.catchExternal=function(g){return Promise.prototype.catch.call(this,g)},o.prototype.error=function(g){return this.then(function(){throw new Error(g)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,er.getPageSize=function(g,d,C){if(Rr(g)==="object"){var v=g;g=v.orientation,d=v.unit||d,C=v.format||C}d=d||"mm",C=C||"a4",g=(""+(g||"P")).toLowerCase();var x,T=(""+C).toLowerCase(),G={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(d){case"pt":x=1;break;case"mm":x=72/25.4;break;case"cm":x=72/2.54;break;case"in":x=72;break;case"px":x=.75;break;case"pc":case"em":x=12;break;case"ex":x=6;break;default:throw"Invalid unit: "+d}var k,W=0,K=0;if(G.hasOwnProperty(T))W=G[T][1]/x,K=G[T][0]/x;else try{W=C[1],K=C[0]}catch{throw new Error("Invalid format: "+C)}if(g==="p"||g==="portrait")g="p",K>W&&(k=K,K=W,W=k);else{if(g!=="l"&&g!=="landscape")throw"Invalid orientation: "+g;g="l",W>K&&(k=K,K=W,W=k)}return{width:K,height:W,unit:d,k:x,orientation:g}},r.html=function(g,d){(d=d||{}).callback=d.callback||function(){},d.html2canvas=d.html2canvas||{},d.html2canvas.canvas=d.html2canvas.canvas||this.canvas,d.jsPDF=d.jsPDF||this,d.fontFaces=d.fontFaces?d.fontFaces.map(My):null;var C=new o(d);return d.worker?C:C.from(g).doCallback()}}(er.API),er.API.addJS=function(r){return d5=r,this.internal.events.subscribe("postPutResources",function(){Of=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Of+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),g5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+d5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Of!==void 0&&g5!==void 0&&this.internal.out("/Names <</JavaScript "+Of+" 0 R>>")}),this},function(r){var t;r.events.push(["postPutResources",function(){var i=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var A=i.outline.render().split(/\r\n/),o=0;o<A.length;o++){var g=A[o],d=s.exec(g);if(d!=null){var C=d[1];i.internal.newObjectDeferredBegin(C,!1)}i.internal.write(g)}if(this.outline.createNamedDestinations){var v=this.internal.pages.length,x=[];for(o=0;o<v;o++){var T=i.internal.newObject();x.push(T);var G=i.internal.getPageInfo(o+1);i.internal.write("<< /D["+G.objId+" 0 R /XYZ null null null]>> endobj")}var k=i.internal.newObject();for(i.internal.write("<< /Names [ "),o=0;o<x.length;o++)i.internal.write("(page_"+(o+1)+")"+x[o]+" 0 R");i.internal.write(" ] >>","endobj"),t=i.internal.newObject(),i.internal.write("<< /Dests "+k+" 0 R"),i.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),r.events.push(["initialized",function(){var i=this;i.outline={createNamedDestinations:!1,root:{children:[]}},i.outline.add=function(s,A,o){var g={title:A,options:o,children:[]};return s==null&&(s=this.root),s.children.push(g),g},i.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=i,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},i.outline.genIds_r=function(s){s.id=i.internal.newObjectDeferred();for(var A=0;A<s.children.length;A++)this.genIds_r(s.children[A])},i.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},i.outline.renderItems=function(s){for(var A=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<s.children.length;o++){var g=s.children[o];this.objStart(g),this.line("/Title "+this.makeString(g.title)),this.line("/Parent "+this.makeRef(s)),o>0&&this.line("/Prev "+this.makeRef(s.children[o-1])),o<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[o+1])),g.children.length>0&&(this.line("/First "+this.makeRef(g.children[0])),this.line("/Last "+this.makeRef(g.children[g.children.length-1])));var d=this.count=this.count_r({count:0},g);if(d>0&&this.line("/Count "+d),g.options&&g.options.pageNumber){var C=i.internal.getPageInfo(g.options.pageNumber);this.line("/Dest ["+C.objId+" 0 R /XYZ 0 "+A(0)+" 0]")}this.objEnd()}for(var v=0;v<s.children.length;v++)this.renderItems(s.children[v])},i.outline.line=function(s){this.ctx.val+=s+`\r
`},i.outline.makeRef=function(s){return s.id+" 0 R"},i.outline.makeString=function(s){return"("+i.internal.pdfEscape(s)+")"},i.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},i.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},i.outline.count_r=function(s,A){for(var o=0;o<A.children.length;o++)s.count++,this.count_r(s,A.children[o]);return s.count}}])}(er.API),function(r){var t=[192,193,194,195,196,197,198,199];r.processJPEG=function(i,s,A,o,g,d){var C,v=this.decode.DCT_DECODE,x=null;if(typeof i=="string"||this.__addimage__.isArrayBuffer(i)||this.__addimage__.isArrayBufferView(i)){switch(i=g||i,i=this.__addimage__.isArrayBuffer(i)?new Uint8Array(i):i,(C=function(T){for(var G,k=256*T.charCodeAt(4)+T.charCodeAt(5),W=T.length,K={width:0,height:0,numcomponents:1},$=4;$<W;$+=2){if($+=k,t.indexOf(T.charCodeAt($+1))!==-1){G=256*T.charCodeAt($+5)+T.charCodeAt($+6),K={width:256*T.charCodeAt($+7)+T.charCodeAt($+8),height:G,numcomponents:T.charCodeAt($+9)};break}k=256*T.charCodeAt($+2)+T.charCodeAt($+3)}return K}(i=this.__addimage__.isArrayBufferView(i)?this.__addimage__.arrayBufferToBinaryString(i):i)).numcomponents){case 1:d=this.color_spaces.DEVICE_GRAY;break;case 4:d=this.color_spaces.DEVICE_CMYK;break;case 3:d=this.color_spaces.DEVICE_RGB}x={data:i,width:C.width,height:C.height,colorSpace:d,bitsPerComponent:8,filter:v,index:s,alias:A}}return x}}(er.API);SD=function(){var r,t,i;function s(o){var g,d,C,v,x,T,G,k,W,K,$,O,tt,at;for(this.data=o,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},T=null;;){switch(g=this.readUInt32(),W=function(){var Lt,Tt;for(Tt=[],Lt=0;Lt<4;++Lt)Tt.push(String.fromCharCode(this.data[this.pos++]));return Tt}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(g);break;case"fcTL":T&&this.animation.frames.push(T),this.pos+=4,T={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},x=this.readUInt16(),v=this.readUInt16()||100,T.delay=1e3*x/v,T.disposeOp=this.data[this.pos++],T.blendOp=this.data[this.pos++],T.data=[];break;case"IDAT":case"fdAT":for(W==="fdAT"&&(this.pos+=4,g-=4),o=T?.data||this.imgData,O=0;0<=g?O<g:O>g;0<=g?++O:--O)o.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(C=this.palette.length/3,this.transparency.indexed=this.read(g),this.transparency.indexed.length>C)throw new Error("More transparent colors than palette size");if((K=C-this.transparency.indexed.length)>0)for(tt=0;0<=K?tt<K:tt>K;0<=K?++tt:--tt)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(g)[0];break;case 2:this.transparency.rgb=this.read(g)}break;case"tEXt":G=($=this.read(g)).indexOf(0),k=String.fromCharCode.apply(String,$.slice(0,G)),this.text[k]=String.fromCharCode.apply(String,$.slice(G+1));break;case"IEND":return T&&this.animation.frames.push(T),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(at=this.colorType)===4||at===6,d=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*d,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=g}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}s.prototype.read=function(o){var g,d;for(d=[],g=0;0<=o?g<o:g>o;0<=o?++g:--g)d.push(this.data[this.pos++]);return d},s.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},s.prototype.decodePixels=function(o){var g=this.pixelBitlength/8,d=new Uint8Array(this.width*this.height*g),C=0,v=this;if(o==null&&(o=this.imgData),o.length===0)return new Uint8Array(0);function x(T,G,k,W){var K,$,O,tt,at,Lt,Tt,Qt,Ft,vt,Jt,qt,At,lt,kt,_t,le,ie,ne,te,wt,Ut=Math.ceil((v.width-T)/k),fe=Math.ceil((v.height-G)/W),j=v.width==Ut&&v.height==fe;for(lt=g*Ut,qt=j?d:new Uint8Array(lt*fe),Lt=o.length,At=0,$=0;At<fe&&C<Lt;){switch(o[C++]){case 0:for(tt=le=0;le<lt;tt=le+=1)qt[$++]=o[C++];break;case 1:for(tt=ie=0;ie<lt;tt=ie+=1)K=o[C++],at=tt<g?0:qt[$-g],qt[$++]=(K+at)%256;break;case 2:for(tt=ne=0;ne<lt;tt=ne+=1)K=o[C++],O=(tt-tt%g)/g,kt=At&&qt[(At-1)*lt+O*g+tt%g],qt[$++]=(kt+K)%256;break;case 3:for(tt=te=0;te<lt;tt=te+=1)K=o[C++],O=(tt-tt%g)/g,at=tt<g?0:qt[$-g],kt=At&&qt[(At-1)*lt+O*g+tt%g],qt[$++]=(K+Math.floor((at+kt)/2))%256;break;case 4:for(tt=wt=0;wt<lt;tt=wt+=1)K=o[C++],O=(tt-tt%g)/g,at=tt<g?0:qt[$-g],At===0?kt=_t=0:(kt=qt[(At-1)*lt+O*g+tt%g],_t=O&&qt[(At-1)*lt+(O-1)*g+tt%g]),Tt=at+kt-_t,Qt=Math.abs(Tt-at),vt=Math.abs(Tt-kt),Jt=Math.abs(Tt-_t),Ft=Qt<=vt&&Qt<=Jt?at:vt<=Jt?kt:_t,qt[$++]=(K+Ft)%256;break;default:throw new Error("Invalid filter algorithm: "+o[C-1])}if(!j){var bt=((G+At*W)*v.width+T)*g,It=At*lt;for(tt=0;tt<Ut;tt+=1){for(var Ht=0;Ht<g;Ht+=1)d[bt++]=qt[It++];bt+=(k-1)*g}}At++}}return o=aD(o),v.interlaceMethod==1?(x(0,0,8,8),x(4,0,8,8),x(0,4,4,8),x(2,0,4,4),x(0,2,2,4),x(1,0,2,2),x(0,1,1,2)):x(0,0,1,1),d},s.prototype.decodePalette=function(){var o,g,d,C,v,x,T,G,k;for(d=this.palette,x=this.transparency.indexed||[],v=new Uint8Array((x.length||0)+d.length),C=0,o=0,g=T=0,G=d.length;T<G;g=T+=3)v[C++]=d[g],v[C++]=d[g+1],v[C++]=d[g+2],v[C++]=(k=x[o++])!=null?k:255;return v},s.prototype.copyToImageData=function(o,g){var d,C,v,x,T,G,k,W,K,$,O;if(C=this.colors,K=null,d=this.hasAlphaChannel,this.palette.length&&(K=(O=this._decodedPalette)!=null?O:this._decodedPalette=this.decodePalette(),C=4,d=!0),W=(v=o.data||o).length,T=K||g,x=G=0,C===1)for(;x<W;)k=K?4*g[x/4]:G,$=T[k++],v[x++]=$,v[x++]=$,v[x++]=$,v[x++]=d?T[k++]:255,G=k;else for(;x<W;)k=K?4*g[x/4]:G,v[x++]=T[k++],v[x++]=T[k++],v[x++]=T[k++],v[x++]=d?T[k++]:255,G=k},s.prototype.decode=function(){var o;return o=new Uint8Array(this.width*this.height*4),this.copyToImageData(o,this.decodePixels()),o};var A=function(){if(Object.prototype.toString.call(ir)==="[object Window]"){try{t=ir.document.createElement("canvas"),i=t.getContext("2d")}catch{return!1}return!0}return!1};return A(),r=function(o){var g;if(A()===!0)return i.width=o.width,i.height=o.height,i.clearRect(0,0,o.width,o.height),i.putImageData(o,0,0),(g=new Image).src=t.toDataURL(),g;throw new Error("This method requires a Browser with Canvas-capability.")},s.prototype.decodeFrames=function(o){var g,d,C,v,x,T,G,k;if(this.animation){for(k=[],d=x=0,T=(G=this.animation.frames).length;x<T;d=++x)g=G[d],C=o.createImageData(g.width,g.height),v=this.decodePixels(new Uint8Array(g.data)),this.copyToImageData(C,v),g.imageData=C,k.push(g.image=r(C));return k}},s.prototype.renderFrame=function(o,g){var d,C,v;return d=(C=this.animation.frames)[g],v=C[g-1],g===0&&o.clearRect(0,0,this.width,this.height),v?.disposeOp===1?o.clearRect(v.xOffset,v.yOffset,v.width,v.height):v?.disposeOp===2&&o.putImageData(v.imageData,v.xOffset,v.yOffset),d.blendOp===0&&o.clearRect(d.xOffset,d.yOffset,d.width,d.height),o.drawImage(d.image,d.xOffset,d.yOffset)},s.prototype.animate=function(o){var g,d,C,v,x,T,G=this;return d=0,T=this.animation,v=T.numFrames,C=T.frames,x=T.numPlays,(g=function(){var k,W;if(k=d++%v,W=C[k],G.renderFrame(o,k),v>1&&d/v<x)return G.animation._timeout=setTimeout(g,W.delay)})()},s.prototype.stopAnimation=function(){var o;return clearTimeout((o=this.animation)!=null?o._timeout:void 0)},s.prototype.render=function(o){var g,d;return o._png&&o._png.stopAnimation(),o._png=this,o.width=this.width,o.height=this.height,g=o.getContext("2d"),this.animation?(this.decodeFrames(g),this.animate(g)):(d=g.createImageData(this.width,this.height),this.copyToImageData(d,this.decodePixels()),g.putImageData(d,0,0))},s}();(function(r){var t=function(){return typeof Uy=="function"},i=function(G,k,W,K){var $=4,O=g;switch(K){case r.image_compression.FAST:$=1,O=o;break;case r.image_compression.MEDIUM:$=6,O=d;break;case r.image_compression.SLOW:$=9,O=C}G=s(G,k,W,O);var tt=Uy(G,{level:$});return r.__addimage__.arrayBufferToBinaryString(tt)},s=function(G,k,W,K){for(var $,O,tt,at=G.length/k,Lt=new Uint8Array(G.length+at),Tt=x(),Qt=0;Qt<at;Qt+=1){if(tt=Qt*k,$=G.subarray(tt,tt+k),K)Lt.set(K($,W,O),tt+Qt);else{for(var Ft,vt=Tt.length,Jt=[];Ft<vt;Ft+=1)Jt[Ft]=Tt[Ft]($,W,O);var qt=T(Jt.concat());Lt.set(Jt[qt],tt+Qt)}O=$}return Lt},A=function(G){var k=Array.apply([],G);return k.unshift(0),k},o=function(G,k){var W,K=[],$=G.length;K[0]=1;for(var O=0;O<$;O+=1)W=G[O-k]||0,K[O+1]=G[O]-W+256&255;return K},g=function(G,k,W){var K,$=[],O=G.length;$[0]=2;for(var tt=0;tt<O;tt+=1)K=W&&W[tt]||0,$[tt+1]=G[tt]-K+256&255;return $},d=function(G,k,W){var K,$,O=[],tt=G.length;O[0]=3;for(var at=0;at<tt;at+=1)K=G[at-k]||0,$=W&&W[at]||0,O[at+1]=G[at]+256-(K+$>>>1)&255;return O},C=function(G,k,W){var K,$,O,tt,at=[],Lt=G.length;at[0]=4;for(var Tt=0;Tt<Lt;Tt+=1)K=G[Tt-k]||0,$=W&&W[Tt]||0,O=W&&W[Tt-k]||0,tt=v(K,$,O),at[Tt+1]=G[Tt]-tt+256&255;return at},v=function(G,k,W){if(G===k&&k===W)return G;var K=Math.abs(k-W),$=Math.abs(G-W),O=Math.abs(G+k-W-W);return K<=$&&K<=O?G:$<=O?k:W},x=function(){return[A,o,g,d,C]},T=function(G){var k=G.map(function(W){return W.reduce(function(K,$){return K+Math.abs($)},0)});return k.indexOf(Math.min.apply(null,k))};r.processPNG=function(G,k,W,K){var $,O,tt,at,Lt,Tt,Qt,Ft,vt,Jt,qt,At,lt,kt,_t,le=this.decode.FLATE_DECODE,ie="";if(this.__addimage__.isArrayBuffer(G)&&(G=new Uint8Array(G)),this.__addimage__.isArrayBufferView(G)){if(G=(tt=new SD(G)).imgData,O=tt.bits,$=tt.colorSpace,Lt=tt.colors,[4,6].indexOf(tt.colorType)!==-1){if(tt.bits===8){vt=(Ft=tt.pixelBitlength==32?new Uint32Array(tt.decodePixels().buffer):tt.pixelBitlength==16?new Uint16Array(tt.decodePixels().buffer):new Uint8Array(tt.decodePixels().buffer)).length,qt=new Uint8Array(vt*tt.colors),Jt=new Uint8Array(vt);var ne,te=tt.pixelBitlength-tt.bits;for(kt=0,_t=0;kt<vt;kt++){for(lt=Ft[kt],ne=0;ne<te;)qt[_t++]=lt>>>ne&255,ne+=tt.bits;Jt[kt]=lt>>>ne&255}}if(tt.bits===16){vt=(Ft=new Uint32Array(tt.decodePixels().buffer)).length,qt=new Uint8Array(vt*(32/tt.pixelBitlength)*tt.colors),Jt=new Uint8Array(vt*(32/tt.pixelBitlength)),At=tt.colors>1,kt=0,_t=0;for(var wt=0;kt<vt;)lt=Ft[kt++],qt[_t++]=lt>>>0&255,At&&(qt[_t++]=lt>>>16&255,lt=Ft[kt++],qt[_t++]=lt>>>0&255),Jt[wt++]=lt>>>16&255;O=8}K!==r.image_compression.NONE&&t()?(G=i(qt,tt.width*tt.colors,tt.colors,K),Qt=i(Jt,tt.width,1,K)):(G=qt,Qt=Jt,le=void 0)}if(tt.colorType===3&&($=this.color_spaces.INDEXED,Tt=tt.palette,tt.transparency.indexed)){var Ut=tt.transparency.indexed,fe=0;for(kt=0,vt=Ut.length;kt<vt;++kt)fe+=Ut[kt];if((fe/=255)===vt-1&&Ut.indexOf(0)!==-1)at=[Ut.indexOf(0)];else if(fe!==vt){for(Ft=tt.decodePixels(),Jt=new Uint8Array(Ft.length),kt=0,vt=Ft.length;kt<vt;kt++)Jt[kt]=Ut[Ft[kt]];Qt=i(Jt,tt.width,1)}}var j=function(bt){var It;switch(bt){case r.image_compression.FAST:It=11;break;case r.image_compression.MEDIUM:It=13;break;case r.image_compression.SLOW:It=14;break;default:It=12}return It}(K);return le===this.decode.FLATE_DECODE&&(ie="/Predictor "+j+" "),ie+="/Colors "+Lt+" /BitsPerComponent "+O+" /Columns "+tt.width,(this.__addimage__.isArrayBuffer(G)||this.__addimage__.isArrayBufferView(G))&&(G=this.__addimage__.arrayBufferToBinaryString(G)),(Qt&&this.__addimage__.isArrayBuffer(Qt)||this.__addimage__.isArrayBufferView(Qt))&&(Qt=this.__addimage__.arrayBufferToBinaryString(Qt)),{alias:W,data:G,index:k,filter:le,decodeParameters:ie,transparency:at,palette:Tt,sMask:Qt,predictor:j,width:tt.width,height:tt.height,bitsPerComponent:O,colorSpace:$}}}})(er.API),function(r){r.processGIF89A=function(t,i,s,A){var o=new FD(t),g=o.width,d=o.height,C=[];o.decodeAndBlitFrameRGBA(0,C);var v={data:C,width:g,height:d},x=new ky(100).encode(v,100);return r.processJPEG.call(this,x,i,s,A)},r.processGIF87A=r.processGIF89A}(er.API),hA.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var t=0;t<r;t++){var i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:A,green:s,blue:i,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},hA.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[r]()}catch(i){sn.log("bit decode error:"+i)}},hA.prototype.bit1=function(){var r,t=Math.ceil(this.width/8),i=t%4;for(r=this.height-1;r>=0;r--){for(var s=this.bottom_up?r:this.height-1-r,A=0;A<t;A++)for(var o=this.datav.getUint8(this.pos++,!0),g=s*this.width*4+8*A*4,d=0;d<8&&8*A+d<this.width;d++){var C=this.palette[o>>7-d&1];this.data[g+4*d]=C.blue,this.data[g+4*d+1]=C.green,this.data[g+4*d+2]=C.red,this.data[g+4*d+3]=255}i!==0&&(this.pos+=4-i)}},hA.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),t=r%4,i=this.height-1;i>=0;i--){for(var s=this.bottom_up?i:this.height-1-i,A=0;A<r;A++){var o=this.datav.getUint8(this.pos++,!0),g=s*this.width*4+2*A*4,d=o>>4,C=15&o,v=this.palette[d];if(this.data[g]=v.blue,this.data[g+1]=v.green,this.data[g+2]=v.red,this.data[g+3]=255,2*A+1>=this.width)break;v=this.palette[C],this.data[g+4]=v.blue,this.data[g+4+1]=v.green,this.data[g+4+2]=v.red,this.data[g+4+3]=255}t!==0&&(this.pos+=4-t)}},hA.prototype.bit8=function(){for(var r=this.width%4,t=this.height-1;t>=0;t--){for(var i=this.bottom_up?t:this.height-1-t,s=0;s<this.width;s++){var A=this.datav.getUint8(this.pos++,!0),o=i*this.width*4+4*s;if(A<this.palette.length){var g=this.palette[A];this.data[o]=g.red,this.data[o+1]=g.green,this.data[o+2]=g.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}r!==0&&(this.pos+=4-r)}},hA.prototype.bit15=function(){for(var r=this.width%3,t=parseInt("11111",2),i=this.height-1;i>=0;i--){for(var s=this.bottom_up?i:this.height-1-i,A=0;A<this.width;A++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var g=(o&t)/t*255|0,d=(o>>5&t)/t*255|0,C=(o>>10&t)/t*255|0,v=o>>15?255:0,x=s*this.width*4+4*A;this.data[x]=C,this.data[x+1]=d,this.data[x+2]=g,this.data[x+3]=v}this.pos+=r}},hA.prototype.bit16=function(){for(var r=this.width%3,t=parseInt("11111",2),i=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var A=this.bottom_up?s:this.height-1-s,o=0;o<this.width;o++){var g=this.datav.getUint16(this.pos,!0);this.pos+=2;var d=(g&t)/t*255|0,C=(g>>5&i)/i*255|0,v=(g>>11)/t*255|0,x=A*this.width*4+4*o;this.data[x]=v,this.data[x+1]=C,this.data[x+2]=d,this.data[x+3]=255}this.pos+=r}},hA.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var t=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),g=t*this.width*4+4*i;this.data[g]=o,this.data[g+1]=A,this.data[g+2]=s,this.data[g+3]=255}this.pos+=this.width%4}},hA.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var t=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),g=this.datav.getUint8(this.pos++,!0),d=t*this.width*4+4*i;this.data[d]=o,this.data[d+1]=A,this.data[d+2]=s,this.data[d+3]=g}},hA.prototype.getData=function(){return this.data},function(r){r.processBMP=function(t,i,s,A){var o=new hA(t,!1),g=o.width,d=o.height,C={data:o.getData(),width:g,height:d},v=new ky(100).encode(C,100);return r.processJPEG.call(this,v,i,s,A)}}(er.API),y5.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(t,i,s,A){var o=new y5(t),g=o.width,d=o.height,C={data:o.getData(),width:g,height:d},v=new ky(100).encode(C,100);return r.processJPEG.call(this,v,i,s,A)}}(er.API),er.API.processRGBA=function(r,t,i){for(var s=r.data,A=s.length,o=new Uint8Array(A/4*3),g=new Uint8Array(A/4),d=0,C=0,v=0;v<A;v+=4){var x=s[v],T=s[v+1],G=s[v+2],k=s[v+3];o[d++]=x,o[d++]=T,o[d++]=G,g[C++]=k}var W=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(g),data:W,index:t,alias:i,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},er.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},sh=er.API,zf=sh.getCharWidthsArray=function(r,t){var i,s,A=(t=t||{}).font||this.internal.getFont(),o=t.fontSize||this.internal.getFontSize(),g=t.charSpace||this.internal.getCharSpace(),d=t.widths?t.widths:A.metadata.Unicode.widths,C=d.fof?d.fof:1,v=t.kerning?t.kerning:A.metadata.Unicode.kerning,x=v.fof?v.fof:1,T=t.doKerning!==!1,G=0,k=r.length,W=0,K=d[0]||C,$=[];for(i=0;i<k;i++)s=r.charCodeAt(i),typeof A.metadata.widthOfString=="function"?$.push((A.metadata.widthOfGlyph(A.metadata.characterToGlyph(s))+g*(1e3/o)||0)/1e3):(G=T&&Rr(v[s])==="object"&&!isNaN(parseInt(v[s][W],10))?v[s][W]/x:0,$.push((d[s]||K)/C+G)),W=s;return $},f5=sh.getStringUnitWidth=function(r,t){var i=(t=t||{}).fontSize||this.internal.getFontSize(),s=t.font||this.internal.getFont(),A=t.charSpace||this.internal.getCharSpace();return sh.processArabic&&(r=sh.processArabic(r)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(r,i,A)/i:zf.apply(this,arguments).reduce(function(o,g){return o+g},0)},m5=function(r,t,i,s){for(var A=[],o=0,g=r.length,d=0;o!==g&&d+t[o]<i;)d+=t[o],o++;A.push(r.slice(0,o));var C=o;for(d=0;o!==g;)d+t[o]>s&&(A.push(r.slice(C,o)),d=0,C=o),d+=t[o],o++;return C!==o&&A.push(r.slice(C,o)),A},C5=function(r,t,i){i||(i={});var s,A,o,g,d,C,v,x=[],T=[x],G=i.textIndent||0,k=0,W=0,K=r.split(" "),$=zf.apply(this,[" ",i])[0];if(C=i.lineIndent===-1?K[0].length+2:i.lineIndent||0){var O=Array(C).join(" "),tt=[];K.map(function(Lt){(Lt=Lt.split(/\s*\n/)).length>1?tt=tt.concat(Lt.map(function(Tt,Qt){return(Qt&&Tt.length?`
`:"")+Tt})):tt.push(Lt[0])}),K=tt,C=f5.apply(this,[O,i])}for(o=0,g=K.length;o<g;o++){var at=0;if(s=K[o],C&&s[0]==`
`&&(s=s.substr(1),at=1),G+k+(W=(A=zf.apply(this,[s,i])).reduce(function(Lt,Tt){return Lt+Tt},0))>t||at){if(W>t){for(d=m5.apply(this,[s,A,t-(G+k),t]),x.push(d.shift()),x=[d.pop()];d.length;)T.push([d.shift()]);W=A.slice(s.length-(x[0]?x[0].length:0)).reduce(function(Lt,Tt){return Lt+Tt},0)}else x=[s];T.push(x),G=W+C,k=$}else x.push(s),G+=k+W,k=$}return v=C?function(Lt,Tt){return(Tt?O:"")+Lt.join(" ")}:function(Lt){return Lt.join(" ")},T.map(v)},sh.splitTextToSize=function(r,t,i){var s,A=(i=i||{}).fontSize||this.internal.getFontSize(),o=function(x){if(x.widths&&x.kerning)return{widths:x.widths,kerning:x.kerning};var T=this.internal.getFont(x.fontName,x.fontStyle);return T.metadata.Unicode?{widths:T.metadata.Unicode.widths||{0:1},kerning:T.metadata.Unicode.kerning||{}}:{font:T.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,i);s=Array.isArray(r)?r:String(r).split(/\r?\n/);var g=1*this.internal.scaleFactor*t/A;o.textIndent=i.textIndent?1*i.textIndent*this.internal.scaleFactor/A:0,o.lineIndent=i.lineIndent;var d,C,v=[];for(d=0,C=s.length;d<C;d++)v=v.concat(C5.apply(this,[s[d],g,o]));return v},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",i={},s={},A=0;A<t.length;A++)i[t[A]]="0123456789abcdef"[A],s["0123456789abcdef"[A]]=t[A];var o=function(T){return"0x"+parseInt(T,10).toString(16)},g=r.__fontmetrics__.compress=function(T){var G,k,W,K,$=["{"];for(var O in T){if(G=T[O],isNaN(parseInt(O,10))?k="'"+O+"'":(O=parseInt(O,10),k=(k=o(O).slice(2)).slice(0,-1)+s[k.slice(-1)]),typeof G=="number")G<0?(W=o(G).slice(3),K="-"):(W=o(G).slice(2),K=""),W=K+W.slice(0,-1)+s[W.slice(-1)];else{if(Rr(G)!=="object")throw new Error("Don't know what to do with value type "+Rr(G)+".");W=g(G)}$.push(k+W)}return $.push("}"),$.join("")},d=r.__fontmetrics__.uncompress=function(T){if(typeof T!="string")throw new Error("Invalid argument passed to uncompress.");for(var G,k,W,K,$={},O=1,tt=$,at=[],Lt="",Tt="",Qt=T.length-1,Ft=1;Ft<Qt;Ft+=1)(K=T[Ft])=="'"?G?(W=G.join(""),G=void 0):G=[]:G?G.push(K):K=="{"?(at.push([tt,W]),tt={},W=void 0):K=="}"?((k=at.pop())[0][k[1]]=tt,W=void 0,tt=k[0]):K=="-"?O=-1:W===void 0?i.hasOwnProperty(K)?(Lt+=i[K],W=parseInt(Lt,16)*O,O=1,Lt=""):Lt+=K:i.hasOwnProperty(K)?(Tt+=i[K],tt[W]=parseInt(Tt,16)*O,O=1,W=void 0,Tt=""):Tt+=K;return $},C={codePages:["WinAnsiEncoding"],WinAnsiEncoding:d("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},v={Unicode:{Courier:C,"Courier-Bold":C,"Courier-BoldOblique":C,"Courier-Oblique":C,Helvetica:C,"Helvetica-Bold":C,"Helvetica-BoldOblique":C,"Helvetica-Oblique":C,"Times-Roman":C,"Times-Bold":C,"Times-BoldItalic":C,"Times-Italic":C}},x={Unicode:{"Courier-Oblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":d("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":d("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:d("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":d("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:d("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":d("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":d("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":d("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":d("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(T){var G=T.font,k=x.Unicode[G.postScriptName];k&&(G.metadata.Unicode={},G.metadata.Unicode.widths=k.widths,G.metadata.Unicode.kerning=k.kerning);var W=v.Unicode[G.postScriptName];W&&(G.metadata.Unicode.encoding=W,G.encoding=W.codePages[0])}])}(er.API),function(r){var t=function(i){for(var s=i.length,A=new Uint8Array(s),o=0;o<s;o++)A[o]=i.charCodeAt(o);return A};r.API.events.push(["addFont",function(i){var s=void 0,A=i.font,o=i.instance;if(!A.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+A.postScriptName+"').");if(typeof(s=o.existsFileInVFS(A.postScriptName)===!1?o.loadFile(A.postScriptName):o.getFileFromVFS(A.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+A.postScriptName+"').");(function(g,d){d=/^\x00\x01\x00\x00/.test(d)?t(d):t(Vg(d)),g.metadata=r.API.TTFFont.open(d),g.metadata.Unicode=g.metadata.Unicode||{encoding:{},kerning:{},widths:[]},g.metadata.glyIdsUsed=[0]})(A,s)}}])}(er),function(r){function t(){return(ir.canvg?Promise.resolve(ir.canvg):Promise.resolve().then(()=>(t5(),$x))).catch(function(i){return Promise.reject(new Error("Could not load canvg: "+i))}).then(function(i){return i.default?i.default:i})}er.API.addSvgAsImage=function(i,s,A,o,g,d,C,v){if(isNaN(s)||isNaN(A))throw sn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(o)||isNaN(g))throw sn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var x=document.createElement("canvas");x.width=o,x.height=g;var T=x.getContext("2d");T.fillStyle="#fff",T.fillRect(0,0,x.width,x.height);var G={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},k=this;return t().then(function(W){return W.fromString(T,i,G)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(W){return W.render(G)}).then(function(){k.addImage(x.toDataURL("image/jpeg",1),s,A,o,g,C,v)})}}(),er.API.putTotalPages=function(r){var t,i=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(r,"g"),i=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),i=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var A=0;A<this.internal.pages[s].length;A++)this.internal.pages[s][A]=this.internal.pages[s][A].replace(t,i);return this},er.API.viewerPreferences=function(r,t){var i;r=r||{},t=t||!1;var s,A,o,g={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},d=Object.keys(g),C=[],v=0,x=0,T=0;function G(W,K){var $,O=!1;for($=0;$<W.length;$+=1)W[$]===K&&(O=!0);return O}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(g)),this.internal.viewerpreferences.isSubscribed=!1),i=this.internal.viewerpreferences.configuration,r==="reset"||t===!0){var k=d.length;for(T=0;T<k;T+=1)i[d[T]].value=i[d[T]].defaultValue,i[d[T]].explicitSet=!1}if(Rr(r)==="object"){for(A in r)if(o=r[A],G(d,A)&&o!==void 0){if(i[A].type==="boolean"&&typeof o=="boolean")i[A].value=o;else if(i[A].type==="name"&&G(i[A].valueSet,o))i[A].value=o;else if(i[A].type==="integer"&&Number.isInteger(o))i[A].value=o;else if(i[A].type==="array"){for(v=0;v<o.length;v+=1)if(s=!0,o[v].length===1&&typeof o[v][0]=="number")C.push(String(o[v]-1));else if(o[v].length>1){for(x=0;x<o[v].length;x+=1)typeof o[v][x]!="number"&&(s=!1);s===!0&&C.push([o[v][0]-1,o[v][1]-1].join(" "))}i[A].value="["+C.join(" ")+"]"}else i[A].value=i[A].defaultValue;i[A].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var W,K=[];for(W in i)i[W].explicitSet===!0&&(i[W].type==="name"?K.push("/"+W+" /"+i[W].value):K.push("/"+W+" "+i[W].value));K.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+K.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=i,this},function(r){var t=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',A=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(s)),g=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),d=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),C=unescape(encodeURIComponent("</x:xmpmeta>")),v=o.length+g.length+d.length+A.length+C.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+v+" >>"),this.internal.write("stream"),this.internal.write(A+o+g+d+C),this.internal.write("endstream"),this.internal.write("endobj")},i=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(s,A){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:A||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",i),this.internal.events.subscribe("postPutResources",t)),this}}(er.API),function(r){var t=r.API,i=t.pdfEscape16=function(o,g){for(var d,C=g.metadata.Unicode.widths,v=["","0","00","000","0000"],x=[""],T=0,G=o.length;T<G;++T){if(d=g.metadata.characterToGlyph(o.charCodeAt(T)),g.metadata.glyIdsUsed.push(d),g.metadata.toUnicode[d]=o.charCodeAt(T),C.indexOf(d)==-1&&(C.push(d),C.push([parseInt(g.metadata.widthOfGlyph(d),10)])),d=="0")return x.join("");d=d.toString(16),x.push(v[4-d.length],d)}return x.join("")},s=function(o){var g,d,C,v,x,T,G;for(x=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,C=[],T=0,G=(d=Object.keys(o).sort(function(k,W){return k-W})).length;T<G;T++)g=d[T],C.length>=100&&(x+=`
`+C.length+` beginbfchar
`+C.join(`
`)+`
endbfchar`,C=[]),o[g]!==void 0&&o[g]!==null&&typeof o[g].toString=="function"&&(v=("0000"+o[g].toString(16)).slice(-4),g=("0000"+(+g).toString(16)).slice(-4),C.push("<"+g+"><"+v+">"));return C.length&&(x+=`
`+C.length+` beginbfchar
`+C.join(`
`)+`
endbfchar
`),x+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(o){(function(g){var d=g.font,C=g.out,v=g.newObject,x=g.putStream;if(d.metadata instanceof r.API.TTFFont&&d.encoding==="Identity-H"){for(var T=d.metadata.Unicode.widths,G=d.metadata.subset.encode(d.metadata.glyIdsUsed,1),k="",W=0;W<G.length;W++)k+=String.fromCharCode(G[W]);var K=v();x({data:k,addLength1:!0,objectId:K}),C("endobj");var $=v();x({data:s(d.metadata.toUnicode),addLength1:!0,objectId:$}),C("endobj");var O=v();C("<<"),C("/Type /FontDescriptor"),C("/FontName /"+ah(d.fontName)),C("/FontFile2 "+K+" 0 R"),C("/FontBBox "+r.API.PDFObject.convert(d.metadata.bbox)),C("/Flags "+d.metadata.flags),C("/StemV "+d.metadata.stemV),C("/ItalicAngle "+d.metadata.italicAngle),C("/Ascent "+d.metadata.ascender),C("/Descent "+d.metadata.decender),C("/CapHeight "+d.metadata.capHeight),C(">>"),C("endobj");var tt=v();C("<<"),C("/Type /Font"),C("/BaseFont /"+ah(d.fontName)),C("/FontDescriptor "+O+" 0 R"),C("/W "+r.API.PDFObject.convert(T)),C("/CIDToGIDMap /Identity"),C("/DW 1000"),C("/Subtype /CIDFontType2"),C("/CIDSystemInfo"),C("<<"),C("/Supplement 0"),C("/Registry (Adobe)"),C("/Ordering ("+d.encoding+")"),C(">>"),C(">>"),C("endobj"),d.objectNumber=v(),C("<<"),C("/Type /Font"),C("/Subtype /Type0"),C("/ToUnicode "+$+" 0 R"),C("/BaseFont /"+ah(d.fontName)),C("/Encoding /"+d.encoding),C("/DescendantFonts ["+tt+" 0 R]"),C(">>"),C("endobj"),d.isAlreadyPutted=!0}})(o)}]),t.events.push(["putFont",function(o){(function(g){var d=g.font,C=g.out,v=g.newObject,x=g.putStream;if(d.metadata instanceof r.API.TTFFont&&d.encoding==="WinAnsiEncoding"){for(var T=d.metadata.rawData,G="",k=0;k<T.length;k++)G+=String.fromCharCode(T[k]);var W=v();x({data:G,addLength1:!0,objectId:W}),C("endobj");var K=v();x({data:s(d.metadata.toUnicode),addLength1:!0,objectId:K}),C("endobj");var $=v();C("<<"),C("/Descent "+d.metadata.decender),C("/CapHeight "+d.metadata.capHeight),C("/StemV "+d.metadata.stemV),C("/Type /FontDescriptor"),C("/FontFile2 "+W+" 0 R"),C("/Flags 96"),C("/FontBBox "+r.API.PDFObject.convert(d.metadata.bbox)),C("/FontName /"+ah(d.fontName)),C("/ItalicAngle "+d.metadata.italicAngle),C("/Ascent "+d.metadata.ascender),C(">>"),C("endobj"),d.objectNumber=v();for(var O=0;O<d.metadata.hmtx.widths.length;O++)d.metadata.hmtx.widths[O]=parseInt(d.metadata.hmtx.widths[O]*(1e3/d.metadata.head.unitsPerEm));C("<</Subtype/TrueType/Type/Font/ToUnicode "+K+" 0 R/BaseFont/"+ah(d.fontName)+"/FontDescriptor "+$+" 0 R/Encoding/"+d.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(d.metadata.hmtx.widths)+">>"),C("endobj"),d.isAlreadyPutted=!0}})(o)}]);var A=function(o){var g,d=o.text||"",C=o.x,v=o.y,x=o.options||{},T=o.mutex||{},G=T.pdfEscape,k=T.activeFontKey,W=T.fonts,K=k,$="",O=0,tt="",at=W[K].encoding;if(W[K].encoding!=="Identity-H")return{text:d,x:C,y:v,options:x,mutex:T};for(tt=d,K=k,Array.isArray(d)&&(tt=d[0]),O=0;O<tt.length;O+=1)W[K].metadata.hasOwnProperty("cmap")&&(g=W[K].metadata.cmap.unicode.codeMap[tt[O].charCodeAt(0)]),g||tt[O].charCodeAt(0)<256&&W[K].metadata.hasOwnProperty("Unicode")?$+=tt[O]:$+="";var Lt="";return parseInt(K.slice(1))<14||at==="WinAnsiEncoding"?Lt=G($,K).split("").map(function(Tt){return Tt.charCodeAt(0).toString(16)}).join(""):at==="Identity-H"&&(Lt=i($,W[K])),T.isHex=!0,{text:Lt,x:C,y:v,options:x,mutex:T}};t.events.push(["postProcessText",function(o){var g=o.text||"",d=[],C={text:g,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(g)){var v=0;for(v=0;v<g.length;v+=1)Array.isArray(g[v])&&g[v].length===3?d.push([A(Object.assign({},C,{text:g[v][0]})).text,g[v][1],g[v][2]]):d.push(A(Object.assign({},C,{text:g[v]})).text);o.text=d}else o.text=A(Object.assign({},C,{text:g})).text}])}(er),function(r){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(i){return t.call(this),this.internal.vFS[i]!==void 0},r.addFileToVFS=function(i,s){return t.call(this),this.internal.vFS[i]=s,this},r.getFileFromVFS=function(i){return t.call(this),this.internal.vFS[i]!==void 0?this.internal.vFS[i]:null}}(er.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(s){var A,o,g,d,C,v,x,T=t,G=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],k=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],W={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},K={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},$=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],O=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),tt=!1,at=0;this.__bidiEngine__={};var Lt=function(At){var lt=At.charCodeAt(),kt=lt>>8,_t=K[kt];return _t!==void 0?T[256*_t+(255&lt)]:kt===252||kt===253?"AL":O.test(kt)?"L":kt===8?"R":"N"},Tt=function(At){for(var lt,kt=0;kt<At.length;kt++){if((lt=Lt(At.charAt(kt)))==="L")return!1;if(lt==="R")return!0}return!1},Qt=function(At,lt,kt,_t){var le,ie,ne,te,wt=lt[_t];switch(wt){case"L":case"R":tt=!1;break;case"N":case"AN":break;case"EN":tt&&(wt="AN");break;case"AL":tt=!0,wt="R";break;case"WS":wt="N";break;case"CS":_t<1||_t+1>=lt.length||(le=kt[_t-1])!=="EN"&&le!=="AN"||(ie=lt[_t+1])!=="EN"&&ie!=="AN"?wt="N":tt&&(ie="AN"),wt=ie===le?ie:"N";break;case"ES":wt=(le=_t>0?kt[_t-1]:"B")==="EN"&&_t+1<lt.length&&lt[_t+1]==="EN"?"EN":"N";break;case"ET":if(_t>0&&kt[_t-1]==="EN"){wt="EN";break}if(tt){wt="N";break}for(ne=_t+1,te=lt.length;ne<te&&lt[ne]==="ET";)ne++;wt=ne<te&&lt[ne]==="EN"?"EN":"N";break;case"NSM":if(g&&!d){for(te=lt.length,ne=_t+1;ne<te&&lt[ne]==="NSM";)ne++;if(ne<te){var Ut=At[_t],fe=Ut>=1425&&Ut<=2303||Ut===64286;if(le=lt[ne],fe&&(le==="R"||le==="AL")){wt="R";break}}}wt=_t<1||(le=lt[_t-1])==="B"?"N":kt[_t-1];break;case"B":tt=!1,A=!0,wt=at;break;case"S":o=!0,wt="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":tt=!1;break;case"BN":wt="N"}return wt},Ft=function(At,lt,kt){var _t=At.split("");return kt&&vt(_t,kt,{hiLevel:at}),_t.reverse(),lt&&lt.reverse(),_t.join("")},vt=function(At,lt,kt){var _t,le,ie,ne,te,wt=-1,Ut=At.length,fe=0,j=[],bt=at?k:G,It=[];for(tt=!1,A=!1,o=!1,le=0;le<Ut;le++)It[le]=Lt(At[le]);for(ie=0;ie<Ut;ie++){if(te=fe,j[ie]=Qt(At,It,j,ie),_t=240&(fe=bt[te][W[j[ie]]]),fe&=15,lt[ie]=ne=bt[fe][5],_t>0)if(_t===16){for(le=wt;le<ie;le++)lt[le]=1;wt=-1}else wt=-1;if(bt[fe][6])wt===-1&&(wt=ie);else if(wt>-1){for(le=wt;le<ie;le++)lt[le]=ne;wt=-1}It[ie]==="B"&&(lt[ie]=0),kt.hiLevel|=ne}o&&function(Ht,Ot,Ae){for(var he=0;he<Ae;he++)if(Ht[he]==="S"){Ot[he]=at;for(var de=he-1;de>=0&&Ht[de]==="WS";de--)Ot[de]=at}}(It,lt,Ut)},Jt=function(At,lt,kt,_t,le){if(!(le.hiLevel<At)){if(At===1&&at===1&&!A)return lt.reverse(),void(kt&&kt.reverse());for(var ie,ne,te,wt,Ut=lt.length,fe=0;fe<Ut;){if(_t[fe]>=At){for(te=fe+1;te<Ut&&_t[te]>=At;)te++;for(wt=fe,ne=te-1;wt<ne;wt++,ne--)ie=lt[wt],lt[wt]=lt[ne],lt[ne]=ie,kt&&(ie=kt[wt],kt[wt]=kt[ne],kt[ne]=ie);fe=te}fe++}}},qt=function(At,lt,kt){var _t=At.split(""),le={hiLevel:at};return kt||(kt=[]),vt(_t,kt,le),function(ie,ne,te){if(te.hiLevel!==0&&x)for(var wt,Ut=0;Ut<ie.length;Ut++)ne[Ut]===1&&(wt=$.indexOf(ie[Ut]))>=0&&(ie[Ut]=$[wt+1])}(_t,kt,le),Jt(2,_t,lt,kt,le),Jt(1,_t,lt,kt,le),_t.join("")};return this.__bidiEngine__.doBidiReorder=function(At,lt,kt){if(function(le,ie){if(ie)for(var ne=0;ne<le.length;ne++)ie[ne]=ne;d===void 0&&(d=Tt(le)),v===void 0&&(v=Tt(le))}(At,lt),g||!C||v)if(g&&C&&d^v)at=d?1:0,At=Ft(At,lt,kt);else if(!g&&C&&v)at=d?1:0,At=qt(At,lt,kt),At=Ft(At,lt);else if(!g||d||C||v){if(g&&!C&&d^v)At=Ft(At,lt),d?(at=0,At=qt(At,lt,kt)):(at=1,At=qt(At,lt,kt),At=Ft(At,lt));else if(g&&d&&!C&&v)at=1,At=qt(At,lt,kt),At=Ft(At,lt);else if(!g&&!C&&d^v){var _t=x;d?(at=1,At=qt(At,lt,kt),at=0,x=!1,At=qt(At,lt,kt),x=_t):(at=0,At=qt(At,lt,kt),At=Ft(At,lt),at=1,x=!1,At=qt(At,lt,kt),x=_t,At=Ft(At,lt))}}else at=0,At=qt(At,lt,kt);else at=d?1:0,At=qt(At,lt,kt);return At},this.__bidiEngine__.setOptions=function(At){At&&(g=At.isInputVisual,C=At.isOutputVisual,d=At.isInputRtl,v=At.isOutputRtl,x=At.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],i=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(s){var A=s.text,o=(s.x,s.y,s.options||{}),g=(s.mutex,o.lang,[]);if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,i.setOptions(o),Object.prototype.toString.call(A)==="[object Array]"){var d=0;for(g=[],d=0;d<A.length;d+=1)Object.prototype.toString.call(A[d])==="[object Array]"?g.push([i.doBidiReorder(A[d][0]),A[d][1],A[d][2]]):g.push([i.doBidiReorder(A[d])]);s.text=g}else s.text=i.doBidiReorder(A);i.setOptions({isInputVisual:!0})}])}(er),er.API.TTFFont=function(){function r(t){var i;if(this.rawData=t,i=this.contents=new Cc(t),this.contents.pos=4,i.readString(4)==="ttcf")throw new Error("TTCF not supported.");i.pos=0,this.parse(),this.subset=new DD(this),this.registerTTF()}return r.open=function(t){return new r(t)},r.prototype.parse=function(){return this.directory=new kD(this.contents),this.head=new ED(this),this.name=new RD(this),this.cmap=new P5(this),this.toUnicode={},this.hhea=new TD(this),this.maxp=new HD(this),this.hmtx=new ZD(this),this.post=new UD(this),this.os2=new QD(this),this.loca=new VD(this),this.glyf=new PD(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var t,i,s,A,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var g,d,C,v;for(v=[],g=0,d=(C=this.bbox).length;g<d;g++)t=C[g],v.push(Math.round(t*this.scaleFactor));return v}.call(this),this.stemV=0,this.post.exists?(s=255&(A=this.post.italic_angle),32768&(i=A>>16)&&(i=-(1+(65535^i))),this.italicAngle=+(i+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(t){var i;return((i=this.cmap.unicode)!=null?i.codeMap[t]:void 0)||0},r.prototype.widthOfGlyph=function(t){var i;return i=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*i},r.prototype.widthOfString=function(t,i,s){var A,o,g,d;for(g=0,o=0,d=(t=""+t).length;0<=d?o<d:o>d;o=0<=d?++o:--o)A=t.charCodeAt(o),g+=this.widthOfGlyph(this.characterToGlyph(A))+s*(1e3/i)||0;return g*(i/1e3)},r.prototype.lineHeight=function(t,i){var s;return i==null&&(i=!1),s=i?this.lineGap:0,(this.ascender+s-this.decender)/1e3*t},r}();Cc=function(){function r(t){this.data=t??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(t){return this.data[this.pos++]=t},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},r.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},r.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},r.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},r.prototype.readString=function(t){var i,s;for(s=[],i=0;0<=t?i<t:i>t;i=0<=t?++i:--i)s[i]=String.fromCharCode(this.readByte());return s.join("")},r.prototype.writeString=function(t){var i,s,A;for(A=[],i=0,s=t.length;0<=s?i<s:i>s;i=0<=s?++i:--i)A.push(this.writeByte(t.charCodeAt(i)));return A},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(t){return this.writeInt16(t)},r.prototype.readLongLong=function(){var t,i,s,A,o,g,d,C;return t=this.readByte(),i=this.readByte(),s=this.readByte(),A=this.readByte(),o=this.readByte(),g=this.readByte(),d=this.readByte(),C=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^i)+1099511627776*(255^s)+4294967296*(255^A)+16777216*(255^o)+65536*(255^g)+256*(255^d)+(255^C)+1):72057594037927940*t+281474976710656*i+1099511627776*s+4294967296*A+16777216*o+65536*g+256*d+C},r.prototype.writeLongLong=function(t){var i,s;return i=Math.floor(t/4294967296),s=4294967295&t,this.writeByte(i>>24&255),this.writeByte(i>>16&255),this.writeByte(i>>8&255),this.writeByte(255&i),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(t){return this.writeInt32(t)},r.prototype.read=function(t){var i,s;for(i=[],s=0;0<=t?s<t:s>t;s=0<=t?++s:--s)i.push(this.readByte());return i},r.prototype.write=function(t){var i,s,A,o;for(o=[],s=0,A=t.length;s<A;s++)i=t[s],o.push(this.writeByte(i));return o},r}(),kD=function(){var r;function t(i){var s,A,o;for(this.scalarType=i.readInt(),this.tableCount=i.readShort(),this.searchRange=i.readShort(),this.entrySelector=i.readShort(),this.rangeShift=i.readShort(),this.tables={},A=0,o=this.tableCount;0<=o?A<o:A>o;A=0<=o?++A:--A)s={tag:i.readString(4),checksum:i.readInt(),offset:i.readInt(),length:i.readInt()},this.tables[s.tag]=s}return t.prototype.encode=function(i){var s,A,o,g,d,C,v,x,T,G,k,W,K;for(K in k=Object.keys(i).length,C=Math.log(2),T=16*Math.floor(Math.log(k)/C),g=Math.floor(T/C),x=16*k-T,(A=new Cc).writeInt(this.scalarType),A.writeShort(k),A.writeShort(T),A.writeShort(g),A.writeShort(x),o=16*k,v=A.pos+o,d=null,W=[],i)for(G=i[K],A.writeString(K),A.writeInt(r(G)),A.writeInt(v),A.writeInt(G.length),W=W.concat(G),K==="head"&&(d=v),v+=G.length;v%4;)W.push(0),v++;return A.write(W),s=2981146554-r(A.data),A.pos=d+8,A.writeUInt32(s),A.data},r=function(i){var s,A,o,g;for(i=M5.call(i);i.length%4;)i.push(0);for(o=new Cc(i),A=0,s=0,g=i.length;s<g;s=s+=4)A+=o.readUInt32();return 4294967295&A},t}(),LD={}.hasOwnProperty,tl=function(r,t){for(var i in t)LD.call(t,i)&&(r[i]=t[i]);function s(){this.constructor=r}return s.prototype=t.prototype,r.prototype=new s,r.__super__=t.prototype,r};dA=function(){function r(t){var i;this.file=t,i=this.file.directory.tables[this.tag],this.exists=!!i,i&&(this.offset=i.offset,this.length=i.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();ED=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="head",t.prototype.parse=function(i){return i.pos=this.offset,this.version=i.readInt(),this.revision=i.readInt(),this.checkSumAdjustment=i.readInt(),this.magicNumber=i.readInt(),this.flags=i.readShort(),this.unitsPerEm=i.readShort(),this.created=i.readLongLong(),this.modified=i.readLongLong(),this.xMin=i.readShort(),this.yMin=i.readShort(),this.xMax=i.readShort(),this.yMax=i.readShort(),this.macStyle=i.readShort(),this.lowestRecPPEM=i.readShort(),this.fontDirectionHint=i.readShort(),this.indexToLocFormat=i.readShort(),this.glyphDataFormat=i.readShort()},t.prototype.encode=function(i){var s;return(s=new Cc).writeInt(this.version),s.writeInt(this.revision),s.writeInt(this.checkSumAdjustment),s.writeInt(this.magicNumber),s.writeShort(this.flags),s.writeShort(this.unitsPerEm),s.writeLongLong(this.created),s.writeLongLong(this.modified),s.writeShort(this.xMin),s.writeShort(this.yMin),s.writeShort(this.xMax),s.writeShort(this.yMax),s.writeShort(this.macStyle),s.writeShort(this.lowestRecPPEM),s.writeShort(this.fontDirectionHint),s.writeShort(i),s.writeShort(this.glyphDataFormat),s.data},t}(),b5=function(){function r(t,i){var s,A,o,g,d,C,v,x,T,G,k,W,K,$,O,tt,at;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=i+t.readInt(),T=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(C=0;C<256;++C)this.codeMap[C]=t.readByte();break;case 4:for(k=t.readUInt16(),G=k/2,t.pos+=6,o=function(){var Lt,Tt;for(Tt=[],C=Lt=0;0<=G?Lt<G:Lt>G;C=0<=G?++Lt:--Lt)Tt.push(t.readUInt16());return Tt}(),t.pos+=2,K=function(){var Lt,Tt;for(Tt=[],C=Lt=0;0<=G?Lt<G:Lt>G;C=0<=G?++Lt:--Lt)Tt.push(t.readUInt16());return Tt}(),v=function(){var Lt,Tt;for(Tt=[],C=Lt=0;0<=G?Lt<G:Lt>G;C=0<=G?++Lt:--Lt)Tt.push(t.readUInt16());return Tt}(),x=function(){var Lt,Tt;for(Tt=[],C=Lt=0;0<=G?Lt<G:Lt>G;C=0<=G?++Lt:--Lt)Tt.push(t.readUInt16());return Tt}(),A=(this.length-t.pos+this.offset)/2,d=function(){var Lt,Tt;for(Tt=[],C=Lt=0;0<=A?Lt<A:Lt>A;C=0<=A?++Lt:--Lt)Tt.push(t.readUInt16());return Tt}(),C=O=0,at=o.length;O<at;C=++O)for($=o[C],s=tt=W=K[C];W<=$?tt<=$:tt>=$;s=W<=$?++tt:--tt)x[C]===0?g=s+v[C]:(g=d[x[C]/2+(s-W)-(G-C)]||0)!==0&&(g+=v[C]),this.codeMap[s]=65535&g}t.pos=T}return r.encode=function(t,i){var s,A,o,g,d,C,v,x,T,G,k,W,K,$,O,tt,at,Lt,Tt,Qt,Ft,vt,Jt,qt,At,lt,kt,_t,le,ie,ne,te,wt,Ut,fe,j,bt,It,Ht,Ot,Ae,he,de,He,Re,je;switch(_t=new Cc,g=Object.keys(t).sort(function(Me,gi){return Me-gi}),i){case"macroman":for(K=0,$=function(){var Me=[];for(W=0;W<256;++W)Me.push(0);return Me}(),tt={0:0},o={},le=0,wt=g.length;le<wt;le++)tt[de=t[A=g[le]]]==null&&(tt[de]=++K),o[A]={old:t[A],new:tt[t[A]]},$[A]=tt[t[A]];return _t.writeUInt16(1),_t.writeUInt16(0),_t.writeUInt32(12),_t.writeUInt16(0),_t.writeUInt16(262),_t.writeUInt16(0),_t.write($),{charMap:o,subtable:_t.data,maxGlyphID:K+1};case"unicode":for(lt=[],T=[],at=0,tt={},s={},O=v=null,ie=0,Ut=g.length;ie<Ut;ie++)tt[Tt=t[A=g[ie]]]==null&&(tt[Tt]=++at),s[A]={old:Tt,new:tt[Tt]},d=tt[Tt]-A,O!=null&&d===v||(O&&T.push(O),lt.push(A),v=d),O=A;for(O&&T.push(O),T.push(65535),lt.push(65535),qt=2*(Jt=lt.length),vt=2*Math.pow(Math.log(Jt)/Math.LN2,2),G=Math.log(vt/2)/Math.LN2,Ft=2*Jt-vt,C=[],Qt=[],k=[],W=ne=0,fe=lt.length;ne<fe;W=++ne){if(At=lt[W],x=T[W],At===65535){C.push(0),Qt.push(0);break}if(At-(kt=s[At].new)>=32768)for(C.push(0),Qt.push(2*(k.length+Jt-W)),A=te=At;At<=x?te<=x:te>=x;A=At<=x?++te:--te)k.push(s[A].new);else C.push(kt-At),Qt.push(0)}for(_t.writeUInt16(3),_t.writeUInt16(1),_t.writeUInt32(12),_t.writeUInt16(4),_t.writeUInt16(16+8*Jt+2*k.length),_t.writeUInt16(0),_t.writeUInt16(qt),_t.writeUInt16(vt),_t.writeUInt16(G),_t.writeUInt16(Ft),Ae=0,j=T.length;Ae<j;Ae++)A=T[Ae],_t.writeUInt16(A);for(_t.writeUInt16(0),he=0,bt=lt.length;he<bt;he++)A=lt[he],_t.writeUInt16(A);for(He=0,It=C.length;He<It;He++)d=C[He],_t.writeUInt16(d);for(Re=0,Ht=Qt.length;Re<Ht;Re++)Lt=Qt[Re],_t.writeUInt16(Lt);for(je=0,Ot=k.length;je<Ot;je++)K=k[je],_t.writeUInt16(K);return{charMap:s,subtable:_t.data,maxGlyphID:at+1}}},r}(),P5=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="cmap",t.prototype.parse=function(i){var s,A,o;for(i.pos=this.offset,this.version=i.readUInt16(),o=i.readUInt16(),this.tables=[],this.unicode=null,A=0;0<=o?A<o:A>o;A=0<=o?++A:--A)s=new b5(i,this.offset),this.tables.push(s),s.isUnicode&&this.unicode==null&&(this.unicode=s);return!0},t.encode=function(i,s){var A,o;return s==null&&(s="macroman"),A=b5.encode(i,s),(o=new Cc).writeUInt16(0),o.writeUInt16(1),A.table=o.data.concat(A.subtable),A},t}(),TD=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="hhea",t.prototype.parse=function(i){return i.pos=this.offset,this.version=i.readInt(),this.ascender=i.readShort(),this.decender=i.readShort(),this.lineGap=i.readShort(),this.advanceWidthMax=i.readShort(),this.minLeftSideBearing=i.readShort(),this.minRightSideBearing=i.readShort(),this.xMaxExtent=i.readShort(),this.caretSlopeRise=i.readShort(),this.caretSlopeRun=i.readShort(),this.caretOffset=i.readShort(),i.pos+=8,this.metricDataFormat=i.readShort(),this.numberOfMetrics=i.readUInt16()},t}(),QD=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="OS/2",t.prototype.parse=function(i){if(i.pos=this.offset,this.version=i.readUInt16(),this.averageCharWidth=i.readShort(),this.weightClass=i.readUInt16(),this.widthClass=i.readUInt16(),this.type=i.readShort(),this.ySubscriptXSize=i.readShort(),this.ySubscriptYSize=i.readShort(),this.ySubscriptXOffset=i.readShort(),this.ySubscriptYOffset=i.readShort(),this.ySuperscriptXSize=i.readShort(),this.ySuperscriptYSize=i.readShort(),this.ySuperscriptXOffset=i.readShort(),this.ySuperscriptYOffset=i.readShort(),this.yStrikeoutSize=i.readShort(),this.yStrikeoutPosition=i.readShort(),this.familyClass=i.readShort(),this.panose=function(){var s,A;for(A=[],s=0;s<10;++s)A.push(i.readByte());return A}(),this.charRange=function(){var s,A;for(A=[],s=0;s<4;++s)A.push(i.readInt());return A}(),this.vendorID=i.readString(4),this.selection=i.readShort(),this.firstCharIndex=i.readShort(),this.lastCharIndex=i.readShort(),this.version>0&&(this.ascent=i.readShort(),this.descent=i.readShort(),this.lineGap=i.readShort(),this.winAscent=i.readShort(),this.winDescent=i.readShort(),this.codePageRange=function(){var s,A;for(A=[],s=0;s<2;s=++s)A.push(i.readInt());return A}(),this.version>1))return this.xHeight=i.readShort(),this.capHeight=i.readShort(),this.defaultChar=i.readShort(),this.breakChar=i.readShort(),this.maxContext=i.readShort()},t}(),UD=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="post",t.prototype.parse=function(i){var s,A,o;switch(i.pos=this.offset,this.format=i.readInt(),this.italicAngle=i.readInt(),this.underlinePosition=i.readShort(),this.underlineThickness=i.readShort(),this.isFixedPitch=i.readInt(),this.minMemType42=i.readInt(),this.maxMemType42=i.readInt(),this.minMemType1=i.readInt(),this.maxMemType1=i.readInt(),this.format){case 65536:break;case 131072:var g;for(A=i.readUInt16(),this.glyphNameIndex=[],g=0;0<=A?g<A:g>A;g=0<=A?++g:--g)this.glyphNameIndex.push(i.readUInt16());for(this.names=[],o=[];i.pos<this.offset+this.length;)s=i.readByte(),o.push(this.names.push(i.readString(s)));return o;case 151552:return A=i.readUInt16(),this.offsets=i.read(A);case 196608:break;case 262144:return this.map=function(){var d,C,v;for(v=[],g=d=0,C=this.file.maxp.numGlyphs;0<=C?d<C:d>C;g=0<=C?++d:--d)v.push(i.readUInt32());return v}.call(this)}},t}(),GD=function(r,t){this.raw=r,this.length=r.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},RD=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="name",t.prototype.parse=function(i){var s,A,o,g,d,C,v,x,T,G,k;for(i.pos=this.offset,i.readShort(),s=i.readShort(),C=i.readShort(),A=[],g=0;0<=s?g<s:g>s;g=0<=s?++g:--g)A.push({platformID:i.readShort(),encodingID:i.readShort(),languageID:i.readShort(),nameID:i.readShort(),length:i.readShort(),offset:this.offset+C+i.readShort()});for(v={},g=T=0,G=A.length;T<G;g=++T)o=A[g],i.pos=o.offset,x=i.readString(o.length),d=new GD(x,o),v[k=o.nameID]==null&&(v[k]=[]),v[o.nameID].push(d);this.strings=v,this.copyright=v[0],this.fontFamily=v[1],this.fontSubfamily=v[2],this.uniqueSubfamily=v[3],this.fontName=v[4],this.version=v[5];try{this.postscriptName=v[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=v[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=v[7],this.manufacturer=v[8],this.designer=v[9],this.description=v[10],this.vendorUrl=v[11],this.designerUrl=v[12],this.license=v[13],this.licenseUrl=v[14],this.preferredFamily=v[15],this.preferredSubfamily=v[17],this.compatibleFull=v[18],this.sampleText=v[19]},t}(),HD=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="maxp",t.prototype.parse=function(i){return i.pos=this.offset,this.version=i.readInt(),this.numGlyphs=i.readUInt16(),this.maxPoints=i.readUInt16(),this.maxContours=i.readUInt16(),this.maxCompositePoints=i.readUInt16(),this.maxComponentContours=i.readUInt16(),this.maxZones=i.readUInt16(),this.maxTwilightPoints=i.readUInt16(),this.maxStorage=i.readUInt16(),this.maxFunctionDefs=i.readUInt16(),this.maxInstructionDefs=i.readUInt16(),this.maxStackElements=i.readUInt16(),this.maxSizeOfInstructions=i.readUInt16(),this.maxComponentElements=i.readUInt16(),this.maxComponentDepth=i.readUInt16()},t}(),ZD=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="hmtx",t.prototype.parse=function(i){var s,A,o,g,d,C,v;for(i.pos=this.offset,this.metrics=[],s=0,C=this.file.hhea.numberOfMetrics;0<=C?s<C:s>C;s=0<=C?++s:--s)this.metrics.push({advance:i.readUInt16(),lsb:i.readInt16()});for(o=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var x,T;for(T=[],s=x=0;0<=o?x<o:x>o;s=0<=o?++x:--x)T.push(i.readInt16());return T}(),this.widths=function(){var x,T,G,k;for(k=[],x=0,T=(G=this.metrics).length;x<T;x++)g=G[x],k.push(g.advance);return k}.call(this),A=this.widths[this.widths.length-1],v=[],s=d=0;0<=o?d<o:d>o;s=0<=o?++d:--d)v.push(this.widths.push(A));return v},t.prototype.forGlyph=function(i){return i in this.metrics?this.metrics[i]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[i-this.metrics.length]}},t}(),M5=[].slice,PD=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(i){var s,A,o,g,d,C,v,x,T,G;return i in this.cache?this.cache[i]:(g=this.file.loca,s=this.file.contents,A=g.indexOf(i),(o=g.lengthOf(i))===0?this.cache[i]=null:(s.pos=this.offset+A,d=(C=new Cc(s.read(o))).readShort(),x=C.readShort(),G=C.readShort(),v=C.readShort(),T=C.readShort(),this.cache[i]=d===-1?new ND(C,x,G,v,T):new MD(C,d,x,G,v,T),this.cache[i]))},t.prototype.encode=function(i,s,A){var o,g,d,C,v;for(d=[],g=[],C=0,v=s.length;C<v;C++)o=i[s[C]],g.push(d.length),o&&(d=d.concat(o.encode(A)));return g.push(d.length),{table:d,offsets:g}},t}(),MD=function(){function r(t,i,s,A,o,g){this.raw=t,this.numberOfContours=i,this.xMin=s,this.yMin=A,this.xMax=o,this.yMax=g,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),ND=function(){function r(t,i,s,A,o){var g,d;for(this.raw=t,this.xMin=i,this.yMin=s,this.xMax=A,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],g=this.raw;d=g.readShort(),this.glyphOffsets.push(g.pos),this.glyphIDs.push(g.readUInt16()),32&d;)g.pos+=1&d?4:2,128&d?g.pos+=8:64&d?g.pos+=4:8&d&&(g.pos+=2)}return r.prototype.encode=function(){var t,i,s;for(i=new Cc(M5.call(this.raw.data)),t=0,s=this.glyphIDs.length;t<s;++t)i.pos=this.glyphOffsets[t];return i.data},r}(),VD=function(r){function t(){return t.__super__.constructor.apply(this,arguments)}return tl(t,dA),t.prototype.tag="loca",t.prototype.parse=function(i){var s,A;return i.pos=this.offset,s=this.file.head.indexToLocFormat,this.offsets=s===0?function(){var o,g;for(g=[],A=0,o=this.length;A<o;A+=2)g.push(2*i.readUInt16());return g}.call(this):function(){var o,g;for(g=[],A=0,o=this.length;A<o;A+=4)g.push(i.readUInt32());return g}.call(this)},t.prototype.indexOf=function(i){return this.offsets[i]},t.prototype.lengthOf=function(i){return this.offsets[i+1]-this.offsets[i]},t.prototype.encode=function(i,s){for(var A=new Uint32Array(this.offsets.length),o=0,g=0,d=0;d<A.length;++d)if(A[d]=o,g<s.length&&s[g]==d){++g,A[d]=o;var C=this.offsets[d],v=this.offsets[d+1]-C;v>0&&(o+=v)}for(var x=new Array(4*A.length),T=0;T<A.length;++T)x[4*T+3]=255&A[T],x[4*T+2]=(65280&A[T])>>8,x[4*T+1]=(16711680&A[T])>>16,x[4*T]=(4278190080&A[T])>>24;return x},t}(),DD=function(){function r(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var t,i,s,A,o;for(i in A=this.font.cmap.tables[0].codeMap,t={},o=this.subset)s=o[i],t[i]=A[s];return t},r.prototype.glyphsFor=function(t){var i,s,A,o,g,d,C;for(A={},g=0,d=t.length;g<d;g++)A[o=t[g]]=this.font.glyf.glyphFor(o);for(o in i=[],A)(s=A[o])!=null&&s.compound&&i.push.apply(i,s.glyphIDs);if(i.length>0)for(o in C=this.glyphsFor(i))s=C[o],A[o]=s;return A},r.prototype.encode=function(t,i){var s,A,o,g,d,C,v,x,T,G,k,W,K,$,O;for(A in s=P5.encode(this.generateCmap(),"unicode"),g=this.glyphsFor(t),k={0:0},O=s.charMap)k[(C=O[A]).old]=C.new;for(W in G=s.maxGlyphID,g)W in k||(k[W]=G++);return x=function(tt){var at,Lt;for(at in Lt={},tt)Lt[tt[at]]=at;return Lt}(k),T=Object.keys(x).sort(function(tt,at){return tt-at}),K=function(){var tt,at,Lt;for(Lt=[],tt=0,at=T.length;tt<at;tt++)d=T[tt],Lt.push(x[d]);return Lt}(),o=this.font.glyf.encode(g,K,k),v=this.font.loca.encode(o.offsets,K),$={cmap:this.font.cmap.raw(),glyf:o.table,loca:v,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(i)},this.font.os2.exists&&($["OS/2"]=this.font.os2.raw()),this.font.directory.encode($)},r}();er.API.PDFObject=function(){var r;function t(){}return r=function(i,s){return(Array(s+1).join("0")+i).slice(-s)},t.convert=function(i){var s,A,o,g;if(Array.isArray(i))return"["+function(){var d,C,v;for(v=[],d=0,C=i.length;d<C;d++)s=i[d],v.push(t.convert(s));return v}().join(" ")+"]";if(typeof i=="string")return"/"+i;if(i!=null&&i.isString)return"("+i+")";if(i instanceof Date)return"(D:"+r(i.getUTCFullYear(),4)+r(i.getUTCMonth(),2)+r(i.getUTCDate(),2)+r(i.getUTCHours(),2)+r(i.getUTCMinutes(),2)+r(i.getUTCSeconds(),2)+"Z)";if({}.toString.call(i)==="[object Object]"){for(A in o=["<<"],i)g=i[A],o.push("/"+A+" "+t.convert(g));return o.push(">>"),o.join(`
`)}return""+i},t}();(function(r){var t={};function i(s){if(t[s])return t[s].exports;var A=t[s]={i:s,l:!1,exports:{}};return r[s].call(A.exports,A,A.exports,i),A.l=!0,A.exports}i.m=r,i.c=t,i.d=function(s,A,o){i.o(s,A)||Object.defineProperty(s,A,{enumerable:!0,get:o})},i.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.t=function(s,A){if(1&A&&(s=i(s)),8&A||4&A&&typeof s=="object"&&s&&s.__esModule)return s;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:s}),2&A&&typeof s!="string")for(var g in s)i.d(o,g,function(d){return s[d]}.bind(null,g));return o},i.n=function(s){var A=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(A,"a",A),A},i.o=function(s,A){return Object.prototype.hasOwnProperty.call(s,A)},i.p="",i(i.s=0)})([function(r,t,i){r.exports=i(1)},function(r,t){function i(A,o){for(var g=0;g<o.length;g++){var d=o[g];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(A,d.key,d)}}var s=function(){function A(){(function(d,C){if(!(d instanceof C))throw new TypeError("Cannot call a class as a function")})(this,A),this.options={overlayBackgroundColor:"#666666",overlayOpacity:.6,spinnerIcon:"ball-circus",spinnerColor:"#000",spinnerSize:"3x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetY:0,offsetX:0,lockScroll:!1,containerID:null,spinnerZIndex:99999,overlayZIndex:99998},this.stylesheetBaseURL="https://cdn.jsdelivr.net/npm/load-awesome@1.1.0/css/",this.spinner=null,this.spinnerStylesheetURL=null,this.numberOfEmptyDivForSpinner={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":1,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1}}var o,g;return o=A,(g=[{key:"show",value:function(d){this.setOptions(d),this.addSpinnerStylesheet(),this.generateSpinnerElement(),this.options.lockScroll&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),this.generateAndAddOverlayElement()}},{key:"hide",value:function(){this.options.lockScroll&&(document.body.style.overflow="",document.documentElement.style.overflow="");var d=document.getElementById("loading-overlay-stylesheet");d&&(d.disabled=!0,d.parentNode.removeChild(d),document.getElementById(this.options.overlayIDName).remove(),document.getElementById(this.options.spinnerIDName).remove())}},{key:"setOptions",value:function(d){if(d!==void 0)for(var C in d)this.options[C]=d[C]}},{key:"generateAndAddOverlayElement",value:function(){var d="50%";this.options.offsetX!==0&&(d="calc(50% + "+this.options.offsetX+")");var C="50%";if(this.options.offsetY!==0&&(C="calc(50% + "+this.options.offsetY+")"),this.options.containerID&&document.body.contains(document.getElementById(this.options.containerID))){var v='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: absolute; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,'; z-index: 50; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: absolute; top: ').concat(C,"; left: ").concat(d,'; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: 9999;">').concat(this.spinner,"</div>"),x=document.getElementById(this.options.containerID);return x.style.position="relative",void x.insertAdjacentHTML("beforeend",v)}var T='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: fixed; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,"; z-index: ").concat(this.options.overlayZIndex,'; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: fixed; top: ').concat(C,"; left: ").concat(d,"; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: ").concat(this.options.spinnerZIndex,';">').concat(this.spinner,"</div>");document.body.insertAdjacentHTML("beforeend",T)}},{key:"generateSpinnerElement",value:function(){var d=this,C=Object.keys(this.numberOfEmptyDivForSpinner).find(function(x){return x===d.options.spinnerIcon}),v=this.generateEmptyDivElement(this.numberOfEmptyDivForSpinner[C]);this.spinner='<div style="color: '.concat(this.options.spinnerColor,'" class="la-').concat(this.options.spinnerIcon," la-").concat(this.options.spinnerSize,'">').concat(v,"</div>")}},{key:"addSpinnerStylesheet",value:function(){this.setSpinnerStylesheetURL();var d=document.createElement("link");d.setAttribute("id","loading-overlay-stylesheet"),d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href",this.spinnerStylesheetURL),document.getElementsByTagName("head")[0].appendChild(d)}},{key:"setSpinnerStylesheetURL",value:function(){this.spinnerStylesheetURL=this.stylesheetBaseURL+this.options.spinnerIcon+".min.css"}},{key:"generateEmptyDivElement",value:function(d){for(var C="",v=1;v<=d;v++)C+="<div></div>";return C}}])&&i(o.prototype,g),A}();window.JsLoadingOverlay=new s,r.exports=JsLoadingOverlay}]);pc={JPEG:"jpg",PNG:"png",PDF:"pdf",SVG:"svg"},Wg={in:"in",mm:"mm"},lh={LETTER:[279,216],A2:[594,420],A3:[420,297],A4:[297,210],A5:[210,148],A6:[148,105],B2:[707,500],B3:[500,353],B4:[353,250],B5:[250,176],B6:[176,125]},Ng={Landscape:"landscape",Portrait:"portrait"},Ny={72:72,96:96,200:200,300:300,400:400},Vy=class{constructor(t,i=lh.A4,s=300,A=pc.PNG.toString(),o=Wg.mm,g="map"){on(this,"map"),on(this,"width"),on(this,"height"),on(this,"dpi"),on(this,"format"),on(this,"unit"),on(this,"fileName"),this.map=t,this.width=i[0],this.height=i[1],this.dpi=s,this.format=A,this.unit=o,this.fileName=g}generate(){let t=this;JsLoadingOverlay.show({overlayBackgroundColor:"#5D5959",overlayOpacity:"0.6",spinnerIcon:"ball-spin",spinnerColor:"#2400FD",spinnerSize:"2x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetX:0,offsetY:0,containerID:null,lockScroll:!1,overlayZIndex:9998,spinnerZIndex:9999});let i=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get(){return t.dpi/96}});let s=document.createElement("div");s.className="hidden-map",document.body.appendChild(s);let A=document.createElement("div");A.style.width=this.toPixels(this.width),A.style.height=this.toPixels(this.height),s.appendChild(A);let o=this.map.getStyle();if(o&&o.sources){let d=o.sources;Object.keys(d).forEach(C=>{let v=d[C];Object.keys(v).forEach(x=>{v[x]||delete v[x]})})}let g=new w5.Map({container:A,style:o,center:this.map.getCenter(),zoom:this.map.getZoom(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,transformRequest:this.map._requestManager._transformRequestFn});g.once("idle",()=>{var d;let C=g.getCanvas(),v=`${this.fileName}.${t.format}`;switch(t.format){case pc.PNG:t.toPNG(C,v);break;case pc.JPEG:t.toJPEG(C,v);break;case pc.PDF:t.toPDF(g,v);break;case pc.SVG:t.toSVG(C,v);break;default:console.error(`Invalid file format: ${t.format}`);break}g.remove(),(d=s.parentNode)==null||d.removeChild(s),Object.defineProperty(window,"devicePixelRatio",{get(){return i}}),s.remove(),JsLoadingOverlay.hide()})}toPNG(t,i){let s=document.createElement("a");s.href=t.toDataURL(),s.download=i,s.click(),s.remove()}toJPEG(t,i){let s=t.toDataURL("image/jpeg",.85),A=document.createElement("a");A.href=s,A.download=i,A.click(),A.remove()}toPDF(t,i){let s=t.getCanvas(),A=new er({orientation:this.width>this.height?"l":"p",unit:this.unit,compress:!0,format:[this.width,this.height]});A.addImage(s.toDataURL("image/png"),"png",0,0,this.width,this.height,void 0,"FAST");let{lng:o,lat:g}=t.getCenter();A.setProperties({title:t.getStyle().name,subject:`center: [${o}, ${g}], zoom: ${t.getZoom()}`,creator:"Mapbox GL Export Plugin",author:"(c)Mapbox, (c)OpenStreetMap"}),A.save(i)}toSVG(t,i){let s=t.toDataURL("image/png"),A=Number(this.toPixels(this.width,this.dpi).replace("px","")),o=Number(this.toPixels(this.height,this.dpi).replace("px","")),g=`
    <svg xmlns="http://www.w3.org/2000/svg" 
      xmlns:xlink="http://www.w3.org/1999/xlink" 
      version="1.1" 
      width="${A}" 
      height="${o}" 
      viewBox="0 0 ${A} ${o}" 
      xml:space="preserve">
        <image style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;"  
      xlink:href="${s}" width="${A}" height="${o}"></image>
    </svg>`,d=document.createElement("a");d.href=`data:application/xml,${encodeURIComponent(g)}`,d.download=i,d.click(),d.remove()}toPixels(t,i=96){return this.unit===Wg.mm&&(i/=25.4),`${i*t}px`}},im=class{constructor(t){on(this,"map"),on(this,"width"),on(this,"height"),on(this,"unit"),on(this,"svgCanvas"),on(this,"svgPath");var i,s,A;if(this.map=t,this.map===void 0)return;this.mapResize=this.mapResize.bind(this),this.map.on("resize",this.mapResize);let o=(i=this.map)==null?void 0:i.getCanvas().clientWidth,g=(s=this.map)==null?void 0:s.getCanvas().clientHeight,d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.style.position="absolute",d.style.top="0px",d.style.left="0px",d.setAttribute("width",`${o}px`),d.setAttribute("height",`${g}px`);let C=document.createElementNS("http://www.w3.org/2000/svg","path");C.setAttribute("style","fill:#888888;stroke-width:0"),C.setAttribute("fill-opacity","0.5"),d.append(C),(A=this.map)==null||A.getCanvasContainer().appendChild(d),this.svgCanvas=d,this.svgPath=C}mapResize(){this.generateCutOut()}updateArea(t,i){this.width=t,this.height=i,this.unit=Wg.mm,this.generateCutOut()}generateCutOut(){var t,i;if(this.map===void 0||this.svgCanvas===void 0||this.svgPath===void 0)return;let s=this.toPixels(this.width),A=this.toPixels(this.height),o=(t=this.map)==null?void 0:t.getCanvas().clientWidth,g=(i=this.map)==null?void 0:i.getCanvas().clientHeight,d=o/2-s/2,C=d+s,v=g/2-A/2,x=v+A;this.svgCanvas.setAttribute("width",`${o}px`),this.svgCanvas.setAttribute("height",`${g}px`),this.svgPath.setAttribute("d",`M 0 0 L ${o} 0 L ${o} ${g} L 0 ${g} M ${d} ${v} L ${d} ${x} L ${C} ${x} L ${C} ${v}`)}destroy(){this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map=void 0)}toPixels(t,i=96){return this.unit===Wg.mm&&(i/=25.4),i*t}},v5={PageSize:"Page Size",PageOrientation:"Page Orientation",Format:"Format",DPI:"DPI",Generate:"Generate",LanguageName:"English"},KD={PageSize:"Taille de page",PageOrientation:"Orientation de la page",Format:"Format",DPI:"DPI",Generate:"G\xE9n\xE9rer",LanguageName:"French"},WD={PageSize:"Sivukoko",PageOrientation:"Sivun suunta",Format:"Muoto",DPI:"DPI",Generate:"Generoi",LanguageName:"Finish"},OD={PageSize:"Papierformat",PageOrientation:"Papierausrichtung",Format:"Dateiformat",DPI:"Druckaufl\xF6sung",Generate:"Erstellen",LanguageName:"German"},zD={PageSize:"Sidstorlek",PageOrientation:"Sidorientering",Format:"Format",DPI:"DPI",Generate:"Generera",LanguageName:"Swedish"},JD={PageSize:"Tama\xF1o de p\xE1gina",PageOrientation:"Orientaci\xF3n de p\xE1gina",Format:"Formato",DPI:"DPI",Generate:"Generar",LanguageName:"Spanish"},XD={PageSize:"K\xEDch th\u01B0\u1EDBc trang",PageOrientation:"Lo\u1EA1i trang",Format:"\u0110\u1ECBnh d\u1EA1ng",DPI:"M\u1EADt \u0111\u1ED9 \u0111i\u1EC3m \u1EA3nh (DPI)",Generate:"T\u1EA1o",LanguageName:"Vietnam"},YD={PageSize:"\u0420\u043E\u0437\u043C\u0456\u0440 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438",PageOrientation:"\u041E\u0440\u0456\u0454\u043D\u0442\u0430\u0446\u0456\u044F \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438",Format:"\u0424\u043E\u0440\u043C\u0430\u0442",DPI:"DPI",Generate:"\u0417\u0433\u0435\u043D\u0435\u0440\u0443\u0432\u0430\u0442\u0438",LanguageName:"Ukranian"},jD={PageSize:"\u9875\u9762\u5927\u5C0F",PageOrientation:"\u9875\u9762\u65B9\u5411",Format:"\u683C\u5F0F",DPI:"\u50CF\u7D20",Generate:"\u5BFC\u51FA",LanguageName:"Chinese simplified"},qD={PageSize:"\u9801\u9762\u5927\u5C0F",PageOrientation:"\u9801\u9762\u65B9\u5411",Format:"\u683C\u5F0F",DPI:"\u50CF\u7D20",Generate:"\u5C0E\u51FA",LanguageName:"Chinese traditional"},$D={PageSize:"\u30DA\u30FC\u30B8\u30B5\u30A4\u30BA",PageOrientation:"\u30DA\u30FC\u30B8\u65B9\u5411",Format:"\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8",DPI:"DPI\uFF08\u89E3\u50CF\u5EA6\uFF09",Generate:"\u51FA\u529B",LanguageName:"Japanese"},N5=r=>{switch(r){case"de":return OD;case"en":return v5;case"fr":return KD;case"fi":return WD;case"sv":return zD;case"es":return JD;case"vi":return XD;case"uk":return YD;case"zhHans":return jD;case"zhHant":return qD;case"ja":return $D;default:return v5}},Og=class{constructor(t){on(this,"controlContainer"),on(this,"exportContainer"),on(this,"crosshair"),on(this,"printableArea"),on(this,"map"),on(this,"exportButton"),on(this,"options",{PageSize:lh.A4,PageOrientation:Ng.Landscape,Format:pc.PDF,DPI:Ny[300],Crosshair:!1,PrintableArea:!1,Local:"en",AllowedSizes:Object.keys(lh),Filename:"map"}),t&&(this.options=Object.assign(this.options,t)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}getTranslation(){let t=this.options.Local??"en";return N5(t)}onAdd(t){var i;this.map=t,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("maplibregl-ctrl"),this.controlContainer.classList.add("maplibregl-ctrl-group"),this.exportContainer=document.createElement("div"),this.exportContainer.classList.add("maplibregl-export-list"),this.exportButton=document.createElement("button"),this.exportButton.classList.add("maplibregl-ctrl-icon"),this.exportButton.classList.add("maplibregl-export-control"),this.exportButton.type="button",this.exportButton.addEventListener("click",()=>{this.exportButton.style.display="none",this.exportContainer.style.display="block",this.toggleCrosshair(!0),this.togglePrintableArea(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.exportButton),this.controlContainer.appendChild(this.exportContainer);let s=document.createElement("TABLE");s.className="print-table";let A={};(i=this.options.AllowedSizes)==null||i.forEach(x=>{lh[x]&&(A[x]=lh[x])});let o=this.createSelection(A,this.getTranslation().PageSize,"page-size",this.options.PageSize,(x,T)=>JSON.stringify(x[T]));s.appendChild(o);let g=this.createSelection(Ng,this.getTranslation().PageOrientation,"page-orientation",this.options.PageOrientation,(x,T)=>x[T]);s.appendChild(g);let d=this.createSelection(pc,this.getTranslation().Format,"format-type",this.options.Format,(x,T)=>x[T]);s.appendChild(d);let C=this.createSelection(Ny,this.getTranslation().DPI,"dpi-type",this.options.DPI,(x,T)=>x[T]);s.appendChild(C),this.exportContainer.appendChild(s);let v=document.createElement("button");return v.type="button",v.textContent=this.getTranslation().Generate,v.classList.add("generate-button"),v.addEventListener("click",()=>{let x=document.getElementById("mapbox-gl-export-page-size"),T=document.getElementById("mapbox-gl-export-page-orientation"),G=document.getElementById("mapbox-gl-export-format-type"),k=document.getElementById("mapbox-gl-export-dpi-type"),W=T.value,K=JSON.parse(x.value);W===Ng.Portrait&&(K=K.reverse()),new Vy(t,K,Number(k.value),G.value,Wg.mm,this.options.Filename).generate()}),this.exportContainer.appendChild(v),this.controlContainer}createSelection(t,i,s,A,o){let g=document.createElement("label");g.textContent=i;let d=document.createElement("select");d.setAttribute("id",`mapbox-gl-export-${s}`),d.style.width="100%",Object.keys(t).forEach(T=>{let G=document.createElement("option");G.setAttribute("value",o(t,T)),G.appendChild(document.createTextNode(T)),G.setAttribute("name",s),A===t[T]&&(G.selected=!0),d.appendChild(G)}),d.addEventListener("change",()=>{this.updatePrintableArea()});let C=document.createElement("TR"),v=document.createElement("TD"),x=document.createElement("TD");return v.appendChild(g),x.appendChild(d),C.appendChild(v),C.appendChild(x),C}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.exportButton||(this.exportButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0),this.map=void 0)}onDocumentClick(t){this.controlContainer&&!this.controlContainer.contains(t.target)&&this.exportContainer&&this.exportButton&&(this.exportContainer.style.display="none",this.exportButton.style.display="block",this.toggleCrosshair(!1),this.togglePrintableArea(!1))}toggleCrosshair(t){this.options.Crosshair===!0&&(t===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new $f(this.map),this.crosshair.create()))}togglePrintableArea(t){this.options.PrintableArea===!0&&(t===!1?this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0):(this.printableArea=new im(this.map),this.updatePrintableArea()))}updatePrintableArea(){if(this.printableArea===void 0)return;let t=document.getElementById("mapbox-gl-export-page-size"),i=document.getElementById("mapbox-gl-export-page-orientation").value,s=JSON.parse(t.value);i===Ng.Portrait&&(s=s.reverse()),this.printableArea.updateArea(s[0],s[1])}}});var bs=pd(Xm()),V5=pd(lb()),D5=pd(Wb());by();function YK(r,t){r.importCSS("main.css"),r.root.innerHTML=`
    <div id='map' style='width: 896px; height: 400px;'></div>
  `;let i="map",s=t.spec,{markers:A=[],clusters:o=[],controls:g=[],locate:d=[],terrain:C=[],geocode:v=[],fullscreen:x=[],scale:T=[],export_map:G=[],hover:k=[],center:W=[],info:K=[],images:$=[],jumps:O=[],fit_bounds:tt=[]}=t.events,at=new bs.Map({container:i,style:s});V5.default.addProtocols(bs),at.on("load",function(){A.forEach(({location:wt,options:Ut})=>{Lt({location:wt,options:Ut})}),o.forEach(wt=>{ie(wt)}),g.forEach(({position:wt,options:Ut})=>{Tt({position:wt,options:Ut})}),d.forEach(({high_accuracy:wt,options:Ut})=>{Qt({high_accuracy:wt,options:Ut})}),C.forEach(()=>{Ft()}),v.forEach(()=>{vt()}),x.forEach(()=>{Jt()}),T.forEach(wt=>{qt(wt)}),G.forEach(wt=>{At(wt)}),k.forEach(wt=>{le(wt)}),W.forEach(wt=>{kt(wt)}),K.forEach(({layer:wt,property:Ut})=>{_t({layer:wt,property:Ut})}),$.forEach(({name:wt,url:Ut,options:fe})=>{lt({name:wt,url:Ut,options:fe})}),O.forEach(({location:wt,options:Ut})=>{at.easeTo({center:wt,...Ut})}),tt.forEach(({bounds:wt,options:Ut})=>{at.fitBounds(wt,Ut)})}),r.handleEvent("add_markers",wt=>{wt.forEach(({location:Ut,options:fe})=>{Lt({location:Ut,options:fe})})}),r.handleEvent("add_marker",({location:wt,options:Ut})=>{Lt({location:wt,options:Ut})}),r.handleEvent("add_nav_controls",({position:wt,options:Ut})=>{Tt({position:wt,options:Ut})}),r.handleEvent("add_locate",({high_accuracy:wt,options:Ut})=>{Qt({high_accuracy:wt,options:Ut})}),r.handleEvent("add_terrain",()=>{Ft()}),r.handleEvent("add_geocode",()=>{vt()}),r.handleEvent("add_fullscreen",()=>{Jt()}),r.handleEvent("add_scale",wt=>{qt(wt)}),r.handleEvent("add_export_map",wt=>{At(wt)}),r.handleEvent("clusters_expansion",wt=>{ie(wt)}),r.handleEvent("add_hover",wt=>{le(wt)}),r.handleEvent("center_on_click",wt=>{kt(wt)}),r.handleEvent("info_on_click",({layer:wt,property:Ut})=>{_t({layer:wt,property:Ut})}),r.handleEvent("add_custom_image",({name:wt,url:Ut,options:fe})=>{lt({name:wt,url:Ut,options:fe})}),r.handleEvent("jump_to",({location:wt,options:Ut})=>{at.easeTo({center:wt,...Ut})}),r.handleEvent("fit_bounds",({bounds:wt,options:Ut})=>{at.fitBounds(wt,Ut)});function Lt({location:wt,options:Ut}){new bs.Marker(Ut).setLngLat(wt).addTo(at)}function Tt({position:wt,options:Ut}){let fe=new bs.NavigationControl(Ut);at.addControl(fe,wt)}function Qt({high_accuracy:wt,options:Ut}){let fe=new bs.GeolocateControl({positionOptions:{enableHighAccuracy:wt,maximumAge:0,timeout:6e3},...Ut});at.addControl(fe)}function Ft(){let wt=at.getTerrain(),Ut=new bs.TerrainControl(wt);at.addControl(Ut)}function vt(){at.addControl(te())}function Jt(){let wt=new bs.FullscreenControl;at.addControl(wt)}function qt(wt){let Ut=new bs.ScaleControl(wt);at.addControl(Ut)}function At({filename:wt,options:Ut}){let fe=new Og({Filename:wt,...Ut});at.addControl(fe)}async function lt({name:wt,url:Ut,options:fe}){let j=await at.loadImage(Ut);at.addImage(wt,j.data,fe)}function kt(wt){at.on("click",wt,Ut=>{let fe=Ut.features[0].geometry.coordinates;at.easeTo({center:fe})})}function _t({layer:wt,property:Ut}){at.on("click",wt,fe=>{new bs.Popup().setLngLat(fe.lngLat).setHTML(fe.features[0].properties[Ut]).addTo(at)}),ne(wt)}function le(wt){let Ut=null,fe=at.getLayer(wt).source;at.on("mousemove",wt,j=>{j.features.length>0&&(Ut&&at.setFeatureState({source:fe,id:Ut},{hover:!1}),Ut=j.features[0].id,at.setFeatureState({source:fe,id:Ut},{hover:!0}))}),at.on("mouseleave",wt,()=>{Ut&&at.setFeatureState({source:fe,id:Ut},{hover:!1}),Ut=null})}function ie(wt){at.on("click",wt,Ut=>{let fe=at.getLayer(wt).source,j=at.queryRenderedFeatures(Ut.point,{layers:[wt]}),bt=j[0].properties.cluster_id;at.getSource(fe).getClusterExpansionZoom(bt,(It,Ht)=>{It||at.easeTo({center:j[0].geometry.coordinates,zoom:Ht})})}),ne(wt)}function ne(wt){at.on("mouseenter",wt,()=>{at.getCanvas().style.cursor="pointer"}),at.on("mouseleave",wt,()=>{at.getCanvas().style.cursor=""})}function te(){let wt={forwardGeocode:async Ut=>{let fe=[];try{let j=`https://nominatim.openstreetmap.org/search?q=${Ut.query}&format=geojson&polygon_geojson=1&addressdetails=1`,It=await(await fetch(j)).json();for(let Ht of It.features){let Ot=[Ht.bbox[0]+(Ht.bbox[2]-Ht.bbox[0])/2,Ht.bbox[1]+(Ht.bbox[3]-Ht.bbox[1])/2],Ae={type:"Feature",geometry:{type:"Point",coordinates:Ot},place_name:Ht.properties.display_name,properties:Ht.properties,text:Ht.properties.display_name,place_type:["place"],center:Ot};fe.push(Ae)}}catch(j){console.error(`Failed to forwardGeocode with error: ${j}`)}return{features:fe}}};return new D5.default(wt,{maplibregl:bs})}}export{YK as init};
/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */
/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */
/**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */
/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */
/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */
/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */
/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */
/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.1.2/LICENSE.txt
 */
/** @license
 *
 * jsPDF - PDF Document creation from JavaScript
 * Version 2.5.1 Built on 2022-01-28T15:37:57.791Z
 *                      CommitID 00000000
 *
 * Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
 *               2015-2021 yWorks GmbH, http://www.yworks.com
 *               2015-2021 Lukas Holländer <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
 *               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
 *               2010 Aaron Spike, https://github.com/acspike
 *               2012 Willow Systems Corporation, https://github.com/willowsystems
 *               2012 Pablo Hess, https://github.com/pablohess
 *               2012 Florian Jenett, https://github.com/fjenett
 *               2013 Warren Weckesser, https://github.com/warrenweckesser
 *               2013 Youssef Beddad, https://github.com/lifof
 *               2013 Lee Driscoll, https://github.com/lsdriscoll
 *               2013 Stefan Slonevskiy, https://github.com/stefslon
 *               2013 Jeremy Morel, https://github.com/jmorel
 *               2013 Christoph Hartmann, https://github.com/chris-rock
 *               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
 *               2014 James Makes, https://github.com/dollaruw
 *               2014 Diego Casorran, https://github.com/diegocr
 *               2014 Steven Spungin, https://github.com/Flamenco
 *               2014 Kenneth Glassey, https://github.com/Gavvers
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * Contributor(s):
 *    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
 *    kim3er, mfo, alnorth, Flamenco
 */
