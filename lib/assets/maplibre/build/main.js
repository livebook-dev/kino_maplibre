var WF=Object.create;var $m=Object.defineProperty;var JF=Object.getOwnPropertyDescriptor;var XF=Object.getOwnPropertyNames;var YF=Object.getPrototypeOf,jF=Object.prototype.hasOwnProperty;var vd=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+n+'" is not supported')});var wd=(n,t)=>()=>(n&&(t=n(n=0)),t);var ua=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),tC=(n,t)=>{for(var r in t)$m(n,r,{get:t[r],enumerable:!0})},qF=(n,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let A of XF(t))!jF.call(n,A)&&A!==r&&$m(n,A,{get:()=>t[A],enumerable:!(o=JF(t,A))||o.enumerable});return n};var Bd=(n,t,r)=>(r=n!=null?WF(YF(n)):{},qF(t||!n||!n.__esModule?$m(r,"default",{value:n,enumerable:!0}):r,n));var rC=ua((eC,iC)=>{(function(n,t){typeof eC=="object"&&typeof iC<"u"?iC.exports=t():typeof define=="function"&&define.amd?define(t):(n=typeof globalThis<"u"?globalThis:n||self,n.maplibregl=t())})(eC,function(){"use strict";var n={},t={};function r(A,s,d){if(t[A]=d,A==="index"){var f="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",I={};return t.shared(I),t.index(n,I),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))),n}}r("shared",["exports"],function(A){"use strict";function s(a,e,l,h){return new(l||(l=Promise))(function(C,w){function B(Z){try{T(h.next(Z))}catch(M){w(M)}}function F(Z){try{T(h.throw(Z))}catch(M){w(M)}}function T(Z){var M;Z.done?C(Z.value):(M=Z.value,M instanceof l?M:new l(function(D){D(M)})).then(B,F)}T((h=h.apply(a,e||[])).next())})}function d(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}typeof SuppressedError=="function"&&SuppressedError;var f=I;function I(a,e){this.x=a,this.y=e}I.prototype={clone:function(){return new I(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,e){return this.clone()._rotateAround(a,e)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var e=a.x-this.x,l=a.y-this.y;return e*e+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,e){return Math.atan2(this.x*e-this.y*a,this.x*a+this.y*e)},_matMult:function(a){var e=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=e,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var e=Math.cos(a),l=Math.sin(a),h=l*this.x+e*this.y;return this.x=e*this.x-l*this.y,this.y=h,this},_rotateAround:function(a,e){var l=Math.cos(a),h=Math.sin(a),C=e.y+h*(this.x-e.x)+l*(this.y-e.y);return this.x=e.x+l*(this.x-e.x)-h*(this.y-e.y),this.y=C,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},I.convert=function(a){return a instanceof I?a:Array.isArray(a)?new I(a[0],a[1]):a};var _=d(f),S=U;function U(a,e,l,h){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(h-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=e,this.p2x=l,this.p2y=h}U.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,e){if(e===void 0&&(e=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,h=0;h<8;h++){var C=this.sampleCurveX(l)-a;if(Math.abs(C)<e)return l;var w=this.sampleCurveDerivativeX(l);if(Math.abs(w)<1e-6)break;l-=C/w}var B=0,F=1;for(l=a,h=0;h<20&&(C=this.sampleCurveX(l),!(Math.abs(C-a)<e));h++)a>C?B=l:F=l,l=.5*(F-B)+B;return l},solve:function(a,e){return this.sampleCurveY(this.solveCurveX(a,e))}};var G=d(S);let L,K;function V(){return L==null&&(L=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),L}function q(){if(K==null&&(K=!1,V())){let e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let h=0;h<5*5;h++){let C=4*h;e.fillStyle=`rgb(${C},${C+1},${C+2})`,e.fillRect(h%5,Math.floor(h/5),1,1)}let l=e.getImageData(0,0,5,5).data;for(let h=0;h<5*5*4;h++)if(h%4!=3&&l[h]!==h){K=!0;break}}}return K||!1}function z(a,e,l,h){let C=new G(a,e,l,h);return w=>C.solve(w)}let it=z(.25,.1,.25,1);function At(a,e,l){return Math.min(l,Math.max(e,a))}function _t(a,e,l){let h=l-e,C=((a-e)%h+h)%h+e;return C===e?l:C}function Lt(a,...e){for(let l of e)for(let h in l)a[h]=l[h];return a}let Et=1;function xt(a,e,l){let h={};for(let C in a)h[C]=e.call(this,a[C],C,a);return h}function It(a,e,l){let h={};for(let C in a)e.call(this,a[C],C,a)&&(h[C]=a[C]);return h}function Nt(a){return Array.isArray(a)?a.map(Nt):typeof a=="object"&&a?xt(a,Nt):a}let ie={};function lt(a){ie[a]||(typeof console<"u"&&console.warn(a),ie[a]=!0)}function at(a,e,l){return(l.y-a.y)*(e.x-a.x)>(e.y-a.y)*(l.x-a.x)}function St(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let Bt=null;function se(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}let ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function qt(a,e,l,h,C){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let w=new VideoFrame(a,{timestamp:0});try{let B=w?.format;if(!B||!B.startsWith("BGR")&&!B.startsWith("RGB"))throw new Error(`Unrecognized format ${B}`);let F=B.startsWith("BGR"),T=new Uint8ClampedArray(h*C*4);if(yield w.copyTo(T,function(Z,M,D,J,$){let st=4*Math.max(-M,0),ut=(Math.max(0,D)-D)*J*4+st,Ft=4*J,Gt=Math.max(0,M),Ae=Math.max(0,D);return{rect:{x:Gt,y:Ae,width:Math.min(Z.width,M+J)-Gt,height:Math.min(Z.height,D+$)-Ae},layout:[{offset:ut,stride:Ft}]}}(a,e,l,h,C)),F)for(let Z=0;Z<T.length;Z+=4){let M=T[Z];T[Z]=T[Z+2],T[Z+2]=M}return T}finally{w.close()}})}let Xt,vt,Tt="AbortError";function pe(){return new Error(Tt)}let j={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function mt(a){return j.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}let yt="global-dispatcher";class Qt extends Error{constructor(e,l,h,C){super(`AJAXError: ${l} (${e}): ${h}`),this.status=e,this.statusText=l,this.url=h,this.body=C}}let Ht=()=>St(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,ae=function(a,e){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){let h=mt(a.url);if(h)return h(a,e);if(St(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:yt},e)}if(!(/^file:/.test(l=a.url)||/^file:/.test(Ht())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(h,C){return s(this,void 0,void 0,function*(){let w=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:Ht(),signal:C.signal});h.type!=="json"||w.headers.has("Accept")||w.headers.set("Accept","application/json");let B=yield fetch(w);if(!B.ok){let Z=yield B.blob();throw new Qt(B.status,B.statusText,h.url,Z)}let F;F=h.type==="arrayBuffer"||h.type==="image"?B.arrayBuffer():h.type==="json"?B.json():B.text();let T=yield F;if(C.signal.aborted)throw pe();return{data:T,cacheControl:B.headers.get("Cache-Control"),expires:B.headers.get("Expires")}})}(a,e);if(St(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:yt},e)}var l;return function(h,C){return new Promise((w,B)=>{var F;let T=new XMLHttpRequest;T.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(T.responseType="arraybuffer");for(let Z in h.headers)T.setRequestHeader(Z,h.headers[Z]);h.type==="json"&&(T.responseType="text",!((F=h.headers)===null||F===void 0)&&F.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=h.credentials==="include",T.onerror=()=>{B(new Error(T.statusText))},T.onload=()=>{if(!C.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let Z=T.response;if(h.type==="json")try{Z=JSON.parse(T.response)}catch(M){return void B(M)}w({data:Z,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{let Z=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});B(new Qt(T.status,T.statusText,h.url,Z))}},C.signal.addEventListener("abort",()=>{T.abort(),B(pe())}),T.send(h.body)})}(a,e)};function ge(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;let e=new URL(a),l=window.location;return e.protocol===l.protocol&&e.host===l.host}function de(a,e,l){l[a]&&l[a].indexOf(e)!==-1||(l[a]=l[a]||[],l[a].push(e))}function Ze(a,e,l){if(l&&l[a]){let h=l[a].indexOf(e);h!==-1&&l[a].splice(h,1)}}class Re{constructor(e,l={}){Lt(this,l),this.type=e}}class Je extends Re{constructor(e,l={}){super("error",Lt({error:e},l))}}class Xe{on(e,l){return this._listeners=this._listeners||{},de(e,l,this._listeners),this}off(e,l){return Ze(e,l,this._listeners),Ze(e,l,this._oneTimeListeners),this}once(e,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},de(e,l,this._oneTimeListeners),this):new Promise(h=>this.once(e,h))}fire(e,l){typeof e=="string"&&(e=new Re(e,l||{}));let h=e.type;if(this.listens(h)){e.target=this;let C=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(let F of C)F.call(this,e);let w=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(let F of w)Ze(h,F,this._oneTimeListeners),F.call(this,e);let B=this._eventedParent;B&&(Lt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),B.fire(e))}else e instanceof Je&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,l){return this._eventedParent=e,this._eventedParentData=l,this}}var Kt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let Ce=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ut(a,e){let l={};for(let h in a)h!=="ref"&&(l[h]=a[h]);return Ce.forEach(h=>{h in e&&(l[h]=e[h])}),l}function Ye(a,e){if(Array.isArray(a)){if(!Array.isArray(e)||a.length!==e.length)return!1;for(let l=0;l<a.length;l++)if(!Ye(a[l],e[l]))return!1;return!0}if(typeof a=="object"&&a!==null&&e!==null){if(typeof e!="object"||Object.keys(a).length!==Object.keys(e).length)return!1;for(let l in a)if(!Ye(a[l],e[l]))return!1;return!0}return a===e}function Oe(a,e){a.push(e)}function Qe(a,e,l){Oe(l,{command:"addSource",args:[a,e[a]]})}function Ne(a,e,l){Oe(e,{command:"removeSource",args:[a]}),l[a]=!0}function ze(a,e,l,h){Ne(a,l,h),Qe(a,e,l)}function We(a,e,l){let h;for(h in a[l])if(Object.prototype.hasOwnProperty.call(a[l],h)&&h!=="data"&&!Ye(a[l][h],e[l][h]))return!1;for(h in e[l])if(Object.prototype.hasOwnProperty.call(e[l],h)&&h!=="data"&&!Ye(a[l][h],e[l][h]))return!1;return!0}function ri(a,e,l,h,C,w){a=a||{},e=e||{};for(let B in a)Object.prototype.hasOwnProperty.call(a,B)&&(Ye(a[B],e[B])||l.push({command:w,args:[h,B,e[B],C]}));for(let B in e)Object.prototype.hasOwnProperty.call(e,B)&&!Object.prototype.hasOwnProperty.call(a,B)&&(Ye(a[B],e[B])||l.push({command:w,args:[h,B,e[B],C]}))}function hi(a){return a.id}function Ti(a,e){return a[e.id]=e,a}class fe{constructor(e,l,h,C){this.message=(e?`${e}: `:"")+h,C&&(this.identifier=C),l!=null&&l.__line__&&(this.line=l.__line__)}}function Ni(a,...e){for(let l of e)for(let h in l)a[h]=l[h];return a}class Di extends Error{constructor(e,l){super(l),this.message=l,this.key=e}}class mi{constructor(e,l=[]){this.parent=e,this.bindings={};for(let[h,C]of l)this.bindings[h]=C}concat(e){return new mi(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}let Gi={kind:"null"},le={kind:"number"},gi={kind:"string"},Ke={kind:"boolean"},or={kind:"color"},Ki={kind:"object"},ii={kind:"value"},br={kind:"collator"},Ji={kind:"formatted"},wr={kind:"padding"},ar={kind:"resolvedImage"},wt={kind:"variableAnchorOffsetCollection"};function W(a,e){return{kind:"array",itemType:a,N:e}}function X(a){if(a.kind==="array"){let e=X(a.itemType);return typeof a.N=="number"?`array<${e}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${e}>`}return a.kind}let rt=[Gi,le,gi,Ke,or,Ji,Ki,W(ii),wr,ar,wt];function ft(a,e){if(e.kind==="error")return null;if(a.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ft(a.itemType,e.itemType))&&(typeof a.N!="number"||a.N===e.N))return null}else{if(a.kind===e.kind)return null;if(a.kind==="value"){for(let l of rt)if(!ft(l,e))return null}}return`Expected ${X(a)} but found ${X(e)} instead.`}function Mt(a,e){return e.some(l=>l.kind===a.kind)}function Vt(a,e){return e.some(l=>l==="null"?a===null:l==="array"?Array.isArray(a):l==="object"?a&&!Array.isArray(a)&&typeof a=="object":l===typeof a)}function Yt(a,e){return a.kind==="array"&&e.kind==="array"?a.itemType.kind===e.itemType.kind&&typeof a.N=="number":a.kind===e.kind}let Rt=.96422,Wt=.82521,be=4/29,he=6/29,Le=3*he*he,je=he*he*he,ti=Math.PI/180,_i=180/Math.PI;function $i(a){return(a%=360)<0&&(a+=360),a}function xi([a,e,l,h]){let C,w,B=hr((.2225045*(a=zi(a))+.7168786*(e=zi(e))+.0606169*(l=zi(l)))/1);a===e&&e===l?C=w=B:(C=hr((.4360747*a+.3850649*e+.1430804*l)/Rt),w=hr((.0139322*a+.0971045*e+.7141733*l)/Wt));let F=116*B-16;return[F<0?0:F,500*(C-B),200*(B-w),h]}function zi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function hr(a){return a>je?Math.pow(a,1/3):a/Le+be}function fr([a,e,l,h]){let C=(a+16)/116,w=isNaN(e)?C:C+e/500,B=isNaN(l)?C:C-l/200;return C=1*Wi(C),w=Rt*Wi(w),B=Wt*Wi(B),[Hi(3.1338561*w-1.6168667*C-.4906146*B),Hi(-.9787684*w+1.9161415*C+.033454*B),Hi(.0719453*w-.2289914*C+1.4052427*B),h]}function Hi(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Wi(a){return a>he?a*a*a:Le*(a-be)}function Ar(a){return parseInt(a.padEnd(2,a),16)/255}function Zt(a,e){return De(e?a/100:a,0,1)}function De(a,e,l){return Math.min(Math.max(e,a),l)}function Te(a){return!a.some(Number.isNaN)}let tr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ui{constructor(e,l,h,C=1,w=!0){this.r=e,this.g=l,this.b=h,this.a=C,w||(this.r*=C,this.g*=C,this.b*=C,C||this.overwriteGetter("rgb",[e,l,h,C]))}static parse(e){if(e instanceof Ui)return e;if(typeof e!="string")return;let l=function(h){if((h=h.toLowerCase().trim())==="transparent")return[0,0,0,0];let C=tr[h];if(C){let[B,F,T]=C;return[B/255,F/255,T/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){let B=h.length<6?1:2,F=1;return[Ar(h.slice(F,F+=B)),Ar(h.slice(F,F+=B)),Ar(h.slice(F,F+=B)),Ar(h.slice(F,F+B)||"ff")]}if(h.startsWith("rgb")){let B=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(B){let[F,T,Z,M,D,J,$,st,ut,Ft,Gt,Ae]=B,Ot=[M||" ",$||" ",Ft].join("");if(Ot==="  "||Ot==="  /"||Ot===",,"||Ot===",,,"){let te=[Z,J,ut].join(""),me=te==="%%%"?100:te===""?255:0;if(me){let Pe=[De(+T/me,0,1),De(+D/me,0,1),De(+st/me,0,1),Gt?Zt(+Gt,Ae):1];if(Te(Pe))return Pe}}return}}let w=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){let[B,F,T,Z,M,D,J,$,st]=w,ut=[T||" ",M||" ",J].join("");if(ut==="  "||ut==="  /"||ut===",,"||ut===",,,"){let Ft=[+F,De(+Z,0,100),De(+D,0,100),$?Zt(+$,st):1];if(Te(Ft))return function([Gt,Ae,Ot,te]){function me(Pe){let oi=(Pe+Gt/30)%12,Pi=Ae*Math.min(Ot,1-Ot);return Ot-Pi*Math.max(-1,Math.min(oi-3,9-oi,1))}return Gt=$i(Gt),Ae/=100,Ot/=100,[me(0),me(8),me(4),te]}(Ft)}}}(e);return l?new Ui(...l,!1):void 0}get rgb(){let{r:e,g:l,b:h,a:C}=this,w=C||1/0;return this.overwriteGetter("rgb",[e/w,l/w,h/w,C])}get hcl(){return this.overwriteGetter("hcl",function(e){let[l,h,C,w]=xi(e),B=Math.sqrt(h*h+C*C);return[Math.round(1e4*B)?$i(Math.atan2(C,h)*_i):NaN,B,l,w]}(this.rgb))}get lab(){return this.overwriteGetter("lab",xi(this.rgb))}overwriteGetter(e,l){return Object.defineProperty(this,e,{value:l}),l}toString(){let[e,l,h,C]=this.rgb;return`rgba(${[e,l,h].map(w=>Math.round(255*w)).join(",")},${C})`}}Ui.black=new Ui(0,0,0,1),Ui.white=new Ui(1,1,1,1),Ui.transparent=new Ui(0,0,0,0),Ui.red=new Ui(1,0,0,1);class an{constructor(e,l,h){this.sensitivity=e?l?"variant":"case":l?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,l){return this.collator.compare(e,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Fr{constructor(e,l,h,C,w){this.text=e,this.image=l,this.scale=h,this.fontStack=C,this.textColor=w}}class $r{constructor(e){this.sections=e}static fromString(e){return new $r([new Fr(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof $r?e:$r.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class Ir{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ir)return e;if(typeof e=="number")return new Ir([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let l of e)if(typeof l!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Ir(e)}}toString(){return JSON.stringify(this.values)}}let hn=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class pn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof pn)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let l=0;l<e.length;l+=2){let h=e[l],C=e[l+1];if(typeof h!="string"||!hn.has(h)||!Array.isArray(C)||C.length!==2||typeof C[0]!="number"||typeof C[1]!="number")return}return new pn(e)}}toString(){return JSON.stringify(this.values)}}class An{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new An({name:e,available:!1}):null}}function pa(a,e,l,h){return typeof a=="number"&&a>=0&&a<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof l=="number"&&l>=0&&l<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[a,e,l,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[a,e,l,h]:[a,e,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Rs(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Ui||a instanceof an||a instanceof $r||a instanceof Ir||a instanceof pn||a instanceof An)return!0;if(Array.isArray(a)){for(let e of a)if(!Rs(e))return!1;return!0}if(typeof a=="object"){for(let e in a)if(!Rs(a[e]))return!1;return!0}return!1}function Or(a){if(a===null)return Gi;if(typeof a=="string")return gi;if(typeof a=="boolean")return Ke;if(typeof a=="number")return le;if(a instanceof Ui)return or;if(a instanceof an)return br;if(a instanceof $r)return Ji;if(a instanceof Ir)return wr;if(a instanceof pn)return wt;if(a instanceof An)return ar;if(Array.isArray(a)){let e=a.length,l;for(let h of a){let C=Or(h);if(l){if(l===C)continue;l=ii;break}l=C}return W(l||ii,e)}return Ki}function vn(a){let e=typeof a;return a===null?"":e==="string"||e==="number"||e==="boolean"?String(a):a instanceof Ui||a instanceof $r||a instanceof Ir||a instanceof pn||a instanceof An?a.toString():JSON.stringify(a)}class io{constructor(e,l){this.type=e,this.value=l}static parse(e,l){if(e.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Rs(e[1]))return l.error("invalid value");let h=e[1],C=Or(h),w=l.expectedType;return C.kind!=="array"||C.N!==0||!w||w.kind!=="array"||typeof w.N=="number"&&w.N!==0||(C=w),new io(C,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ir{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}let ro={string:gi,number:le,boolean:Ke,object:Ki};class wn{constructor(e,l){this.type=e,this.args=l}static parse(e,l){if(e.length<2)return l.error("Expected at least one argument.");let h,C=1,w=e[0];if(w==="array"){let F,T;if(e.length>2){let Z=e[1];if(typeof Z!="string"||!(Z in ro)||Z==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);F=ro[Z],C++}else F=ii;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return l.error('The length argument to "array" must be a positive integer literal',2);T=e[2],C++}h=W(F,T)}else{if(!ro[w])throw new Error(`Types doesn't contain name = ${w}`);h=ro[w]}let B=[];for(;C<e.length;C++){let F=l.parse(e[C],C,ii);if(!F)return null;B.push(F)}return new wn(h,B)}evaluate(e){for(let l=0;l<this.args.length;l++){let h=this.args[l].evaluate(e);if(!ft(this.type,Or(h)))return h;if(l===this.args.length-1)throw new ir(`Expected value to be of type ${X(this.type)}, but found ${X(Or(h))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}let no={"to-boolean":Ke,"to-color":or,"to-number":le,"to-string":gi};class ns{constructor(e,l){this.type=e,this.args=l}static parse(e,l){if(e.length<2)return l.error("Expected at least one argument.");let h=e[0];if(!no[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&e.length!==2)return l.error("Expected one argument.");let C=no[h],w=[];for(let B=1;B<e.length;B++){let F=l.parse(e[B],B,ii);if(!F)return null;w.push(F)}return new ns(C,w)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let l,h;for(let C of this.args){if(l=C.evaluate(e),h=null,l instanceof Ui)return l;if(typeof l=="string"){let w=e.parseColor(l);if(w)return w}else if(Array.isArray(l)&&(h=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:pa(l[0],l[1],l[2],l[3]),!h))return new Ui(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new ir(h||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(let h of this.args){l=h.evaluate(e);let C=Ir.parse(l);if(C)return C}throw new ir(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(let h of this.args){l=h.evaluate(e);let C=pn.parse(l);if(C)return C}throw new ir(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(let h of this.args){if(l=h.evaluate(e),l===null)return 0;let C=Number(l);if(!isNaN(C))return C}throw new ir(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return $r.fromString(vn(this.args[0].evaluate(e)));case"resolvedImage":return An.fromString(vn(this.args[0].evaluate(e)));default:return vn(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}let ht=["Unknown","Point","LineString","Polygon"];class Ct{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ht[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let l=this._parseColorCache[e];return l||(l=this._parseColorCache[e]=Ui.parse(e)),l}}class ct{constructor(e,l,h=[],C,w=new mi,B=[]){this.registry=e,this.path=h,this.key=h.map(F=>`[${F}]`).join(""),this.scope=w,this.errors=B,this.expectedType=C,this._isConstant=l}parse(e,l,h,C,w={}){return l?this.concat(l,h,C)._parse(e,w):this._parse(e,w)}_parse(e,l){function h(C,w,B){return B==="assert"?new wn(w,[C]):B==="coerce"?new ns(w,[C]):C}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let C=e[0];if(typeof C!="string")return this.error(`Expression name must be a string, but found ${typeof C} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let w=this.registry[C];if(w){let B=w.parse(e,this);if(!B)return null;if(this.expectedType){let F=this.expectedType,T=B.type;if(F.kind!=="string"&&F.kind!=="number"&&F.kind!=="boolean"&&F.kind!=="object"&&F.kind!=="array"||T.kind!=="value")if(F.kind!=="color"&&F.kind!=="formatted"&&F.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(F.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(F.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(F,T))return null}else B=h(B,F,l.typeAnnotation||"coerce");else B=h(B,F,l.typeAnnotation||"coerce");else B=h(B,F,l.typeAnnotation||"coerce");else B=h(B,F,l.typeAnnotation||"assert")}if(!(B instanceof io)&&B.type.kind!=="resolvedImage"&&this._isConstant(B)){let F=new Ct;try{B=new io(B.type,B.evaluate(F))}catch(T){return this.error(T.message),null}}return B}return this.error(`Unknown expression "${C}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,l,h){let C=typeof e=="number"?this.path.concat(e):this.path,w=h?this.scope.concat(h):this.scope;return new ct(this.registry,this._isConstant,C,l||null,w,this.errors)}error(e,...l){let h=`${this.key}${l.map(C=>`[${C}]`).join("")}`;this.errors.push(new Di(h,e))}checkSubtype(e,l){let h=ft(e,l);return h&&this.error(h),h}}class bt{constructor(e,l){this.type=l.type,this.bindings=[].concat(e),this.result=l}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let l of this.bindings)e(l[1]);e(this.result)}static parse(e,l){if(e.length<4)return l.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);let h=[];for(let w=1;w<e.length-1;w+=2){let B=e[w];if(typeof B!="string")return l.error(`Expected string, but found ${typeof B} instead.`,w);if(/[^a-zA-Z0-9_]/.test(B))return l.error("Variable names must contain only alphanumeric characters or '_'.",w);let F=l.parse(e[w+1],w+1);if(!F)return null;h.push([B,F])}let C=l.parse(e[e.length-1],e.length-1,l.expectedType,h);return C?new bt(h,C):null}outputDefined(){return this.result.outputDefined()}}class Pt{constructor(e,l){this.type=l.type,this.name=e,this.boundExpression=l}static parse(e,l){if(e.length!==2||typeof e[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");let h=e[1];return l.scope.has(h)?new Pt(h,l.scope.get(h)):l.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Jt{constructor(e,l,h){this.type=e,this.index=l,this.input=h}static parse(e,l){if(e.length!==3)return l.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let h=l.parse(e[1],1,le),C=l.parse(e[2],2,W(l.expectedType||ii));return h&&C?new Jt(C.type.itemType,h,C):null}evaluate(e){let l=this.index.evaluate(e),h=this.input.evaluate(e);if(l<0)throw new ir(`Array index out of bounds: ${l} < 0.`);if(l>=h.length)throw new ir(`Array index out of bounds: ${l} > ${h.length-1}.`);if(l!==Math.floor(l))throw new ir(`Array index must be an integer, but found ${l} instead.`);return h[l]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class re{constructor(e,l){this.type=Ke,this.needle=e,this.haystack=l}static parse(e,l){if(e.length!==3)return l.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let h=l.parse(e[1],1,ii),C=l.parse(e[2],2,ii);return h&&C?Mt(h.type,[Ke,gi,le,Gi,ii])?new re(h,C):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(h.type)} instead`):null}evaluate(e){let l=this.needle.evaluate(e),h=this.haystack.evaluate(e);if(!h)return!1;if(!Vt(l,["boolean","string","number","null"]))throw new ir(`Expected first argument to be of type boolean, string, number or null, but found ${X(Or(l))} instead.`);if(!Vt(h,["string","array"]))throw new ir(`Expected second argument to be of type array or string, but found ${X(Or(h))} instead.`);return h.indexOf(l)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class _e{constructor(e,l,h){this.type=le,this.needle=e,this.haystack=l,this.fromIndex=h}static parse(e,l){if(e.length<=2||e.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let h=l.parse(e[1],1,ii),C=l.parse(e[2],2,ii);if(!h||!C)return null;if(!Mt(h.type,[Ke,gi,le,Gi,ii]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(h.type)} instead`);if(e.length===4){let w=l.parse(e[3],3,le);return w?new _e(h,C,w):null}return new _e(h,C)}evaluate(e){let l=this.needle.evaluate(e),h=this.haystack.evaluate(e);if(!Vt(l,["boolean","string","number","null"]))throw new ir(`Expected first argument to be of type boolean, string, number or null, but found ${X(Or(l))} instead.`);if(!Vt(h,["string","array"]))throw new ir(`Expected second argument to be of type array or string, but found ${X(Or(h))} instead.`);if(this.fromIndex){let C=this.fromIndex.evaluate(e);return h.indexOf(l,C)}return h.indexOf(l)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Be{constructor(e,l,h,C,w,B){this.inputType=e,this.type=l,this.input=h,this.cases=C,this.outputs=w,this.otherwise=B}static parse(e,l){if(e.length<5)return l.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return l.error("Expected an even number of arguments.");let h,C;l.expectedType&&l.expectedType.kind!=="value"&&(C=l.expectedType);let w={},B=[];for(let Z=2;Z<e.length-1;Z+=2){let M=e[Z],D=e[Z+1];Array.isArray(M)||(M=[M]);let J=l.concat(Z);if(M.length===0)return J.error("Expected at least one branch label.");for(let st of M){if(typeof st!="number"&&typeof st!="string")return J.error("Branch labels must be numbers or strings.");if(typeof st=="number"&&Math.abs(st)>Number.MAX_SAFE_INTEGER)return J.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof st=="number"&&Math.floor(st)!==st)return J.error("Numeric branch labels must be integer values.");if(h){if(J.checkSubtype(h,Or(st)))return null}else h=Or(st);if(w[String(st)]!==void 0)return J.error("Branch labels must be unique.");w[String(st)]=B.length}let $=l.parse(D,Z,C);if(!$)return null;C=C||$.type,B.push($)}let F=l.parse(e[1],1,ii);if(!F)return null;let T=l.parse(e[e.length-1],e.length-1,C);return T?F.type.kind!=="value"&&l.concat(1).checkSubtype(h,F.type)?null:new Be(h,C,F,w,B,T):null}evaluate(e){let l=this.input.evaluate(e);return(Or(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Ie{constructor(e,l,h){this.type=e,this.branches=l,this.otherwise=h}static parse(e,l){if(e.length<4)return l.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return l.error("Expected an odd number of arguments.");let h;l.expectedType&&l.expectedType.kind!=="value"&&(h=l.expectedType);let C=[];for(let B=1;B<e.length-1;B+=2){let F=l.parse(e[B],B,Ke);if(!F)return null;let T=l.parse(e[B+1],B+1,h);if(!T)return null;C.push([F,T]),h=h||T.type}let w=l.parse(e[e.length-1],e.length-1,h);if(!w)return null;if(!h)throw new Error("Can't infer output type");return new Ie(h,C,w)}evaluate(e){for(let[l,h]of this.branches)if(l.evaluate(e))return h.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[l,h]of this.branches)e(l),e(h);e(this.otherwise)}outputDefined(){return this.branches.every(([e,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class ne{constructor(e,l,h,C){this.type=e,this.input=l,this.beginIndex=h,this.endIndex=C}static parse(e,l){if(e.length<=2||e.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let h=l.parse(e[1],1,ii),C=l.parse(e[2],2,le);if(!h||!C)return null;if(!Mt(h.type,[W(ii),gi,ii]))return l.error(`Expected first argument to be of type array or string, but found ${X(h.type)} instead`);if(e.length===4){let w=l.parse(e[3],3,le);return w?new ne(h.type,h,C,w):null}return new ne(h.type,h,C)}evaluate(e){let l=this.input.evaluate(e),h=this.beginIndex.evaluate(e);if(!Vt(l,["string","array"]))throw new ir(`Expected first argument to be of type array or string, but found ${X(Or(l))} instead.`);if(this.endIndex){let C=this.endIndex.evaluate(e);return l.slice(h,C)}return l.slice(h)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function ye(a,e){let l=a.length-1,h,C,w=0,B=l,F=0;for(;w<=B;)if(F=Math.floor((w+B)/2),h=a[F],C=a[F+1],h<=e){if(F===l||e<C)return F;w=F+1}else{if(!(h>e))throw new ir("Input is not a number.");B=F-1}return 0}class ve{constructor(e,l,h){this.type=e,this.input=l,this.labels=[],this.outputs=[];for(let[C,w]of h)this.labels.push(C),this.outputs.push(w)}static parse(e,l){if(e.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return l.error("Expected an even number of arguments.");let h=l.parse(e[1],1,le);if(!h)return null;let C=[],w=null;l.expectedType&&l.expectedType.kind!=="value"&&(w=l.expectedType);for(let B=1;B<e.length;B+=2){let F=B===1?-1/0:e[B],T=e[B+1],Z=B,M=B+1;if(typeof F!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(C.length&&C[C.length-1][0]>=F)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Z);let D=l.parse(T,M,w);if(!D)return null;w=w||D.type,C.push([F,D])}return new ve(w,h,C)}evaluate(e){let l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(e);let C=this.input.evaluate(e);if(C<=l[0])return h[0].evaluate(e);let w=l.length;return C>=l[w-1]?h[w-1].evaluate(e):h[ye(l,C)].evaluate(e)}eachChild(e){e(this.input);for(let l of this.outputs)e(l)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Ge(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ri=Qi;function Qi(a,e,l,h){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(h-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=e,this.p2x=l,this.p2y=h}Qi.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,e){if(e===void 0&&(e=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,h=0;h<8;h++){var C=this.sampleCurveX(l)-a;if(Math.abs(C)<e)return l;var w=this.sampleCurveDerivativeX(l);if(Math.abs(w)<1e-6)break;l-=C/w}var B=0,F=1;for(l=a,h=0;h<20&&(C=this.sampleCurveX(l),!(Math.abs(C-a)<e));h++)a>C?B=l:F=l,l=.5*(F-B)+B;return l},solve:function(a,e){return this.sampleCurveY(this.solveCurveX(a,e))}};var He=Ge(Ri);function Ee(a,e,l){return a+l*(e-a)}function si(a,e,l){return a.map((h,C)=>Ee(h,e[C],l))}let ci={number:Ee,color:function(a,e,l,h="rgb"){switch(h){case"rgb":{let[C,w,B,F]=si(a.rgb,e.rgb,l);return new Ui(C,w,B,F,!1)}case"hcl":{let[C,w,B,F]=a.hcl,[T,Z,M,D]=e.hcl,J,$;if(isNaN(C)||isNaN(T))isNaN(C)?isNaN(T)?J=NaN:(J=T,B!==1&&B!==0||($=Z)):(J=C,M!==1&&M!==0||($=w));else{let Ae=T-C;T>C&&Ae>180?Ae-=360:T<C&&C-T>180&&(Ae+=360),J=C+l*Ae}let[st,ut,Ft,Gt]=function([Ae,Ot,te,me]){return Ae=isNaN(Ae)?0:Ae*ti,fr([te,Math.cos(Ae)*Ot,Math.sin(Ae)*Ot,me])}([J,$??Ee(w,Z,l),Ee(B,M,l),Ee(F,D,l)]);return new Ui(st,ut,Ft,Gt,!1)}case"lab":{let[C,w,B,F]=fr(si(a.lab,e.lab,l));return new Ui(C,w,B,F,!1)}}},array:si,padding:function(a,e,l){return new Ir(si(a.values,e.values,l))},variableAnchorOffsetCollection:function(a,e,l){let h=a.values,C=e.values;if(h.length!==C.length)throw new ir(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${e.toString()}`);let w=[];for(let B=0;B<h.length;B+=2){if(h[B]!==C[B])throw new ir(`Cannot interpolate values containing mismatched anchors. from[${B}]: ${h[B]}, to[${B}]: ${C[B]}`);w.push(h[B]);let[F,T]=h[B+1],[Z,M]=C[B+1];w.push([Ee(F,Z,l),Ee(T,M,l)])}return new pn(w)}};class Fi{constructor(e,l,h,C,w){this.type=e,this.operator=l,this.interpolation=h,this.input=C,this.labels=[],this.outputs=[];for(let[B,F]of w)this.labels.push(B),this.outputs.push(F)}static interpolationFactor(e,l,h,C){let w=0;if(e.name==="exponential")w=lr(l,e.base,h,C);else if(e.name==="linear")w=lr(l,1,h,C);else if(e.name==="cubic-bezier"){let B=e.controlPoints;w=new He(B[0],B[1],B[2],B[3]).solve(lr(l,1,h,C))}return w}static parse(e,l){let[h,C,w,...B]=e;if(!Array.isArray(C)||C.length===0)return l.error("Expected an interpolation type expression.",1);if(C[0]==="linear")C={name:"linear"};else if(C[0]==="exponential"){let Z=C[1];if(typeof Z!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);C={name:"exponential",base:Z}}else{if(C[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(C[0])}`,1,0);{let Z=C.slice(1);if(Z.length!==4||Z.some(M=>typeof M!="number"||M<0||M>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);C={name:"cubic-bezier",controlPoints:Z}}}if(e.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(w=l.parse(w,2,le),!w)return null;let F=[],T=null;h==="interpolate-hcl"||h==="interpolate-lab"?T=or:l.expectedType&&l.expectedType.kind!=="value"&&(T=l.expectedType);for(let Z=0;Z<B.length;Z+=2){let M=B[Z],D=B[Z+1],J=Z+3,$=Z+4;if(typeof M!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',J);if(F.length&&F[F.length-1][0]>=M)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',J);let st=l.parse(D,$,T);if(!st)return null;T=T||st.type,F.push([M,st])}return Yt(T,le)||Yt(T,or)||Yt(T,wr)||Yt(T,wt)||Yt(T,W(le))?new Fi(T,h,C,w,F):l.error(`Type ${X(T)} is not interpolatable.`)}evaluate(e){let l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(e);let C=this.input.evaluate(e);if(C<=l[0])return h[0].evaluate(e);let w=l.length;if(C>=l[w-1])return h[w-1].evaluate(e);let B=ye(l,C),F=Fi.interpolationFactor(this.interpolation,C,l[B],l[B+1]),T=h[B].evaluate(e),Z=h[B+1].evaluate(e);switch(this.operator){case"interpolate":return ci[this.type.kind](T,Z,F);case"interpolate-hcl":return ci.color(T,Z,F,"hcl");case"interpolate-lab":return ci.color(T,Z,F,"lab")}}eachChild(e){e(this.input);for(let l of this.outputs)e(l)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function lr(a,e,l,h){let C=h-l,w=a-l;return C===0?0:e===1?w/C:(Math.pow(e,w)-1)/(Math.pow(e,C)-1)}class ai{constructor(e,l){this.type=e,this.args=l}static parse(e,l){if(e.length<2)return l.error("Expectected at least one argument.");let h=null,C=l.expectedType;C&&C.kind!=="value"&&(h=C);let w=[];for(let F of e.slice(1)){let T=l.parse(F,1+w.length,h,void 0,{typeAnnotation:"omit"});if(!T)return null;h=h||T.type,w.push(T)}if(!h)throw new Error("No output type");let B=C&&w.some(F=>ft(C,F.type));return new ai(B?ii:h,w)}evaluate(e){let l,h=null,C=0;for(let w of this.args)if(C++,h=w.evaluate(e),h&&h instanceof An&&!h.available&&(l||(l=h.name),h=null,C===this.args.length&&(h=l)),h!==null)break;return h}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function Br(a,e){return a==="=="||a==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function ln(a,e,l,h){return h.compare(e,l)===0}function yr(a,e,l){let h=a!=="=="&&a!=="!=";return class _b{constructor(w,B,F){this.type=Ke,this.lhs=w,this.rhs=B,this.collator=F,this.hasUntypedArgument=w.type.kind==="value"||B.type.kind==="value"}static parse(w,B){if(w.length!==3&&w.length!==4)return B.error("Expected two or three arguments.");let F=w[0],T=B.parse(w[1],1,ii);if(!T)return null;if(!Br(F,T.type))return B.concat(1).error(`"${F}" comparisons are not supported for type '${X(T.type)}'.`);let Z=B.parse(w[2],2,ii);if(!Z)return null;if(!Br(F,Z.type))return B.concat(2).error(`"${F}" comparisons are not supported for type '${X(Z.type)}'.`);if(T.type.kind!==Z.type.kind&&T.type.kind!=="value"&&Z.type.kind!=="value")return B.error(`Cannot compare types '${X(T.type)}' and '${X(Z.type)}'.`);h&&(T.type.kind==="value"&&Z.type.kind!=="value"?T=new wn(Z.type,[T]):T.type.kind!=="value"&&Z.type.kind==="value"&&(Z=new wn(T.type,[Z])));let M=null;if(w.length===4){if(T.type.kind!=="string"&&Z.type.kind!=="string"&&T.type.kind!=="value"&&Z.type.kind!=="value")return B.error("Cannot use collator to compare non-string types.");if(M=B.parse(w[3],3,br),!M)return null}return new _b(T,Z,M)}evaluate(w){let B=this.lhs.evaluate(w),F=this.rhs.evaluate(w);if(h&&this.hasUntypedArgument){let T=Or(B),Z=Or(F);if(T.kind!==Z.kind||T.kind!=="string"&&T.kind!=="number")throw new ir(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${Z.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){let T=Or(B),Z=Or(F);if(T.kind!=="string"||Z.kind!=="string")return e(w,B,F)}return this.collator?l(w,B,F,this.collator.evaluate(w)):e(w,B,F)}eachChild(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)}outputDefined(){return!0}}}let ss=yr("==",function(a,e,l){return e===l},ln),$n=yr("!=",function(a,e,l){return e!==l},function(a,e,l,h){return!ln(0,e,l,h)}),zo=yr("<",function(a,e,l){return e<l},function(a,e,l,h){return h.compare(e,l)<0}),yA=yr(">",function(a,e,l){return e>l},function(a,e,l,h){return h.compare(e,l)>0}),Ql=yr("<=",function(a,e,l){return e<=l},function(a,e,l,h){return h.compare(e,l)<=0}),Ic=yr(">=",function(a,e,l){return e>=l},function(a,e,l,h){return h.compare(e,l)>=0});class bA{constructor(e,l,h){this.type=br,this.locale=h,this.caseSensitive=e,this.diacriticSensitive=l}static parse(e,l){if(e.length!==2)return l.error("Expected one argument.");let h=e[1];if(typeof h!="object"||Array.isArray(h))return l.error("Collator options argument must be an object.");let C=l.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Ke);if(!C)return null;let w=l.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Ke);if(!w)return null;let B=null;return h.locale&&(B=l.parse(h.locale,1,gi),!B)?null:new bA(C,w,B)}evaluate(e){return new an(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Ma{constructor(e,l,h,C,w){this.type=gi,this.number=e,this.locale=l,this.currency=h,this.minFractionDigits=C,this.maxFractionDigits=w}static parse(e,l){if(e.length!==3)return l.error("Expected two arguments.");let h=l.parse(e[1],1,le);if(!h)return null;let C=e[2];if(typeof C!="object"||Array.isArray(C))return l.error("NumberFormat options argument must be an object.");let w=null;if(C.locale&&(w=l.parse(C.locale,1,gi),!w))return null;let B=null;if(C.currency&&(B=l.parse(C.currency,1,gi),!B))return null;let F=null;if(C["min-fraction-digits"]&&(F=l.parse(C["min-fraction-digits"],1,le),!F))return null;let T=null;return C["max-fraction-digits"]&&(T=l.parse(C["max-fraction-digits"],1,le),!T)?null:new Ma(h,w,B,F,T)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Lo{constructor(e){this.type=Ji,this.sections=e}static parse(e,l){if(e.length<2)return l.error("Expected at least one argument.");let h=e[1];if(!Array.isArray(h)&&typeof h=="object")return l.error("First argument must be an image or text section.");let C=[],w=!1;for(let B=1;B<=e.length-1;++B){let F=e[B];if(w&&typeof F=="object"&&!Array.isArray(F)){w=!1;let T=null;if(F["font-scale"]&&(T=l.parse(F["font-scale"],1,le),!T))return null;let Z=null;if(F["text-font"]&&(Z=l.parse(F["text-font"],1,W(gi)),!Z))return null;let M=null;if(F["text-color"]&&(M=l.parse(F["text-color"],1,or),!M))return null;let D=C[C.length-1];D.scale=T,D.font=Z,D.textColor=M}else{let T=l.parse(e[B],1,ii);if(!T)return null;let Z=T.type.kind;if(Z!=="string"&&Z!=="value"&&Z!=="null"&&Z!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,C.push({content:T,scale:null,font:null,textColor:null})}}return new Lo(C)}evaluate(e){return new $r(this.sections.map(l=>{let h=l.content.evaluate(e);return Or(h)===ar?new Fr("",h,null,null,null):new Fr(vn(h),null,l.scale?l.scale.evaluate(e):null,l.font?l.font.evaluate(e).join(","):null,l.textColor?l.textColor.evaluate(e):null)}))}eachChild(e){for(let l of this.sections)e(l.content),l.scale&&e(l.scale),l.font&&e(l.font),l.textColor&&e(l.textColor)}outputDefined(){return!1}}class Eo{constructor(e){this.type=ar,this.input=e}static parse(e,l){if(e.length!==2)return l.error("Expected two arguments.");let h=l.parse(e[1],1,gi);return h?new Eo(h):l.error("No image name provided.")}evaluate(e){let l=this.input.evaluate(e),h=An.fromString(l);return h&&e.availableImages&&(h.available=e.availableImages.indexOf(l)>-1),h}eachChild(e){e(this.input)}outputDefined(){return!1}}class rl{constructor(e){this.type=le,this.input=e}static parse(e,l){if(e.length!==2)return l.error(`Expected 1 argument, but found ${e.length-1} instead.`);let h=l.parse(e[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${X(h.type)} instead.`):new rl(h):null}evaluate(e){let l=this.input.evaluate(e);if(typeof l=="string"||Array.isArray(l))return l.length;throw new ir(`Expected value to be of type string or array, but found ${X(Or(l))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}let Kn=8192;function Na(a,e){let l=(180+a[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,C=Math.pow(2,e.z);return[Math.round(l*C*Kn),Math.round(h*C*Kn)]}function so(a,e){let l=Math.pow(2,e.z);return[(C=(a[0]/Kn+e.x)/l,360*C-180),(h=(a[1]/Kn+e.y)/l,360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90)];var h,C}function ur(a,e){a[0]=Math.min(a[0],e[0]),a[1]=Math.min(a[1],e[1]),a[2]=Math.max(a[2],e[0]),a[3]=Math.max(a[3],e[1])}function fa(a,e){return!(a[0]<=e[0]||a[2]>=e[2]||a[1]<=e[1]||a[3]>=e[3])}function Rl(a,e,l){let h=a[0]-e[0],C=a[1]-e[1],w=a[0]-l[0],B=a[1]-l[1];return h*B-w*C==0&&h*w<=0&&C*B<=0}function Va(a,e,l,h){return(C=[h[0]-l[0],h[1]-l[1]])[0]*(w=[e[0]-a[0],e[1]-a[1]])[1]-C[1]*w[0]!=0&&!(!vA(a,e,l,h)||!vA(l,h,a,e));var C,w}function Oo(a,e,l){for(let h of l)for(let C=0;C<h.length-1;++C)if(Va(a,e,h[C],h[C+1]))return!0;return!1}function Is(a,e,l=!1){let h=!1;for(let F of e)for(let T=0;T<F.length-1;T++){if(Rl(a,F[T],F[T+1]))return l;(w=F[T])[1]>(C=a)[1]!=(B=F[T+1])[1]>C[1]&&C[0]<(B[0]-w[0])*(C[1]-w[1])/(B[1]-w[1])+w[0]&&(h=!h)}var C,w,B;return h}function yc(a,e){for(let l of e)if(Is(a,l))return!0;return!1}function Wo(a,e){for(let l of a)if(!Is(l,e))return!1;for(let l=0;l<a.length-1;++l)if(Oo(a[l],a[l+1],e))return!1;return!0}function oo(a,e){for(let l of e)if(Wo(a,l))return!0;return!1}function vA(a,e,l,h){let C=h[0]-l[0],w=h[1]-l[1],B=(a[0]-l[0])*w-C*(a[1]-l[1]),F=(e[0]-l[0])*w-C*(e[1]-l[1]);return B>0&&F<0||B<0&&F>0}function Jo(a,e,l){let h=[];for(let C=0;C<a.length;C++){let w=[];for(let B=0;B<a[C].length;B++){let F=Na(a[C][B],l);ur(e,F),w.push(F)}h.push(w)}return h}function Gl(a,e,l){let h=[];for(let C=0;C<a.length;C++){let w=Jo(a[C],e,l);h.push(w)}return h}function Da(a,e,l,h){if(a[0]<l[0]||a[0]>l[2]){let C=.5*h,w=a[0]-l[0]>C?-h:l[0]-a[0]>C?h:0;w===0&&(w=a[0]-l[2]>C?-h:l[2]-a[0]>C?h:0),a[0]+=w}ur(e,a)}function Zl(a,e,l,h){let C=Math.pow(2,h.z)*Kn,w=[h.x*Kn,h.y*Kn],B=[];for(let F of a)for(let T of F){let Z=[T.x+w[0],T.y+w[1]];Da(Z,e,l,C),B.push(Z)}return B}function wA(a,e,l,h){let C=Math.pow(2,h.z)*Kn,w=[h.x*Kn,h.y*Kn],B=[];for(let T of a){let Z=[];for(let M of T){let D=[M.x+w[0],M.y+w[1]];ur(e,D),Z.push(D)}B.push(Z)}if(e[2]-e[0]<=C/2){(F=e)[0]=F[1]=1/0,F[2]=F[3]=-1/0;for(let T of B)for(let Z of T)Da(Z,e,l,C)}var F;return B}class ao{constructor(e,l){this.type=Ke,this.geojson=e,this.geometries=l}static parse(e,l){if(e.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Rs(e[1])){let h=e[1];if(h.type==="FeatureCollection"){let C=[];for(let w of h.features){let{type:B,coordinates:F}=w.geometry;B==="Polygon"&&C.push(F),B==="MultiPolygon"&&C.push(...F)}if(C.length)return new ao(h,{type:"MultiPolygon",coordinates:C})}else if(h.type==="Feature"){let C=h.geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new ao(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new ao(h,h)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(l,h){let C=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],B=l.canonicalID();if(h.type==="Polygon"){let F=Jo(h.coordinates,w,B),T=Zl(l.geometry(),C,w,B);if(!fa(C,w))return!1;for(let Z of T)if(!Is(Z,F))return!1}if(h.type==="MultiPolygon"){let F=Gl(h.coordinates,w,B),T=Zl(l.geometry(),C,w,B);if(!fa(C,w))return!1;for(let Z of T)if(!yc(Z,F))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(l,h){let C=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],B=l.canonicalID();if(h.type==="Polygon"){let F=Jo(h.coordinates,w,B),T=wA(l.geometry(),C,w,B);if(!fa(C,w))return!1;for(let Z of T)if(!Wo(Z,F))return!1}if(h.type==="MultiPolygon"){let F=Gl(h.coordinates,w,B),T=wA(l.geometry(),C,w,B);if(!fa(C,w))return!1;for(let Z of T)if(!oo(Z,F))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let nl=class{constructor(a=[],e=BA){if(this.data=a,this.length=this.data.length,this.compare=e,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let a=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),a}peek(){return this.data[0]}_up(a){let{data:e,compare:l}=this,h=e[a];for(;a>0;){let C=a-1>>1,w=e[C];if(l(h,w)>=0)break;e[a]=w,a=C}e[a]=h}_down(a){let{data:e,compare:l}=this,h=this.length>>1,C=e[a];for(;a<h;){let w=1+(a<<1),B=e[w],F=w+1;if(F<this.length&&l(e[F],B)<0&&(w=F,B=e[F]),l(B,C)>=0)break;e[a]=B,a=w}e[a]=C}};function BA(a,e){return a<e?-1:a>e?1:0}function sl(a,e,l,h,C){_A(a,e,l,h||a.length-1,C||bc)}function _A(a,e,l,h,C){for(;h>l;){if(h-l>600){var w=h-l+1,B=e-l+1,F=Math.log(w),T=.5*Math.exp(2*F/3),Z=.5*Math.sqrt(F*T*(w-T)/w)*(B-w/2<0?-1:1);_A(a,e,Math.max(l,Math.floor(e-B*T/w+Z)),Math.min(h,Math.floor(e+(w-B)*T/w+Z)),C)}var M=a[e],D=l,J=h;for(ma(a,l,e),C(a[h],M)>0&&ma(a,l,h);D<J;){for(ma(a,D,J),D++,J--;C(a[D],M)<0;)D++;for(;C(a[J],M)>0;)J--}C(a[l],M)===0?ma(a,l,J):ma(a,++J,h),J<=e&&(l=J+1),e<=J&&(h=J-1)}}function ma(a,e,l){var h=a[e];a[e]=a[l],a[l]=h}function bc(a,e){return a<e?-1:a>e?1:0}function Xo(a,e){if(a.length<=1)return[a];let l=[],h,C;for(let w of a){let B=ol(w);B!==0&&(w.area=Math.abs(B),C===void 0&&(C=B<0),C===B<0?(h&&l.push(h),h=[w]):h.push(w))}if(h&&l.push(h),e>1)for(let w=0;w<l.length;w++)l[w].length<=e||(sl(l[w],e,1,l[w].length-1,Ka),l[w]=l[w].slice(0,e));return l}function Ka(a,e){return e.area-a.area}function ol(a){let e=0;for(let l,h,C=0,w=a.length,B=w-1;C<w;B=C++)l=a[C],h=a[B],e+=(h.x-l.x)*(l.y+h.y);return e}let Yo=1/298.257223563,xA=Yo*(2-Yo),Q=Math.PI/180;class tt{constructor(e){let l=6378.137*Q*1e3,h=Math.cos(e*Q),C=1/(1-xA*(1-h*h)),w=Math.sqrt(C);this.kx=l*w*h,this.ky=l*w*C*(1-xA)}distance(e,l){let h=this.wrap(e[0]-l[0])*this.kx,C=(e[1]-l[1])*this.ky;return Math.sqrt(h*h+C*C)}pointOnLine(e,l){let h,C,w,B,F=1/0;for(let T=0;T<e.length-1;T++){let Z=e[T][0],M=e[T][1],D=this.wrap(e[T+1][0]-Z)*this.kx,J=(e[T+1][1]-M)*this.ky,$=0;D===0&&J===0||($=(this.wrap(l[0]-Z)*this.kx*D+(l[1]-M)*this.ky*J)/(D*D+J*J),$>1?(Z=e[T+1][0],M=e[T+1][1]):$>0&&(Z+=D/this.kx*$,M+=J/this.ky*$)),D=this.wrap(l[0]-Z)*this.kx,J=(l[1]-M)*this.ky;let st=D*D+J*J;st<F&&(F=st,h=Z,C=M,w=T,B=$)}return{point:[h,C],index:w,t:Math.max(0,Math.min(1,B))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function kt(a,e){return e[0]-a[0]}function zt(a){return a[1]-a[0]+1}function oe(a,e){return a[1]>=a[0]&&a[1]<e}function we(a,e){if(a[0]>a[1])return[null,null];let l=zt(a);if(e){if(l===2)return[a,null];let C=Math.floor(l/2);return[[a[0],a[0]+C],[a[0]+C,a[1]]]}if(l===1)return[a,null];let h=Math.floor(l/2)-1;return[[a[0],a[0]+h],[a[0]+h+1,a[1]]]}function Me(a,e){if(!oe(e,a.length))return[1/0,1/0,-1/0,-1/0];let l=[1/0,1/0,-1/0,-1/0];for(let h=e[0];h<=e[1];++h)ur(l,a[h]);return l}function ui(a){let e=[1/0,1/0,-1/0,-1/0];for(let l of a)for(let h of l)ur(e,h);return e}function Mi(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function Xi(a,e,l){if(!Mi(a)||!Mi(e))return NaN;let h=0,C=0;return a[2]<e[0]&&(h=e[0]-a[2]),a[0]>e[2]&&(h=a[0]-e[2]),a[1]>e[3]&&(C=a[1]-e[3]),a[3]<e[1]&&(C=e[1]-a[3]),l.distance([0,0],[h,C])}function Ii(a,e,l){let h=l.pointOnLine(e,a);return l.distance(a,h.point)}function gr(a,e,l,h,C){let w=Math.min(Ii(a,[l,h],C),Ii(e,[l,h],C)),B=Math.min(Ii(l,[a,e],C),Ii(h,[a,e],C));return Math.min(w,B)}function ki(a,e,l,h,C){if(!oe(e,a.length)||!oe(h,l.length))return 1/0;let w=1/0;for(let B=e[0];B<e[1];++B){let F=a[B],T=a[B+1];for(let Z=h[0];Z<h[1];++Z){let M=l[Z],D=l[Z+1];if(Va(F,T,M,D))return 0;w=Math.min(w,gr(F,T,M,D,C))}}return w}function tn(a,e,l,h,C){if(!oe(e,a.length)||!oe(h,l.length))return NaN;let w=1/0;for(let B=e[0];B<=e[1];++B)for(let F=h[0];F<=h[1];++F)if(w=Math.min(w,C.distance(a[B],l[F])),w===0)return w;return w}function er(a,e,l){if(Is(a,e,!0))return 0;let h=1/0;for(let C of e){let w=C[0],B=C[C.length-1];if(w!==B&&(h=Math.min(h,Ii(a,[B,w],l)),h===0))return h;let F=l.pointOnLine(C,a);if(h=Math.min(h,l.distance(a,F.point)),h===0)return h}return h}function nr(a,e,l,h){if(!oe(e,a.length))return NaN;for(let w=e[0];w<=e[1];++w)if(Is(a[w],l,!0))return 0;let C=1/0;for(let w=e[0];w<e[1];++w){let B=a[w],F=a[w+1];for(let T of l)for(let Z=0,M=T.length,D=M-1;Z<M;D=Z++){let J=T[D],$=T[Z];if(Va(B,F,J,$))return 0;C=Math.min(C,gr(B,F,J,$,h))}}return C}function cn(a,e){for(let l of a)for(let h of l)if(Is(h,e,!0))return!0;return!1}function Gs(a,e,l,h=1/0){let C=ui(a),w=ui(e);if(h!==1/0&&Xi(C,w,l)>=h)return h;if(fa(C,w)){if(cn(a,e))return 0}else if(cn(e,a))return 0;let B=1/0;for(let F of a)for(let T=0,Z=F.length,M=Z-1;T<Z;M=T++){let D=F[M],J=F[T];for(let $ of e)for(let st=0,ut=$.length,Ft=ut-1;st<ut;Ft=st++){let Gt=$[Ft],Ae=$[st];if(Va(D,J,Gt,Ae))return 0;B=Math.min(B,gr(D,J,Gt,Ae,l))}}return B}function os(a,e,l,h,C,w){if(!w)return;let B=Xi(Me(h,w),C,l);B<e&&a.push([B,w,[0,0]])}function Zs(a,e,l,h,C,w,B){if(!w||!B)return;let F=Xi(Me(h,w),Me(C,B),l);F<e&&a.push([F,w,B])}function za(a,e,l,h,C=1/0){let w=Math.min(h.distance(a[0],l[0][0]),C);if(w===0)return w;let B=new nl([[0,[0,a.length-1],[0,0]]],kt),F=ui(l);for(;B.length>0;){let T=B.pop();if(T[0]>=w)continue;let Z=T[1],M=e?50:100;if(zt(Z)<=M){if(!oe(Z,a.length))return NaN;if(e){let D=nr(a,Z,l,h);if(isNaN(D)||D===0)return D;w=Math.min(w,D)}else for(let D=Z[0];D<=Z[1];++D){let J=er(a[D],l,h);if(w=Math.min(w,J),w===0)return 0}}else{let D=we(Z,e);os(B,w,h,a,F,D[0]),os(B,w,h,a,F,D[1])}}return w}function Ca(a,e,l,h,C,w=1/0){let B=Math.min(w,C.distance(a[0],l[0]));if(B===0)return B;let F=new nl([[0,[0,a.length-1],[0,l.length-1]]],kt);for(;F.length>0;){let T=F.pop();if(T[0]>=B)continue;let Z=T[1],M=T[2],D=e?50:100,J=h?50:100;if(zt(Z)<=D&&zt(M)<=J){if(!oe(Z,a.length)&&oe(M,l.length))return NaN;let $;if(e&&h)$=ki(a,Z,l,M,C),B=Math.min(B,$);else if(e&&!h){let st=a.slice(Z[0],Z[1]+1);for(let ut=M[0];ut<=M[1];++ut)if($=Ii(l[ut],st,C),B=Math.min(B,$),B===0)return B}else if(!e&&h){let st=l.slice(M[0],M[1]+1);for(let ut=Z[0];ut<=Z[1];++ut)if($=Ii(a[ut],st,C),B=Math.min(B,$),B===0)return B}else $=tn(a,Z,l,M,C),B=Math.min(B,$)}else{let $=we(Z,e),st=we(M,h);Zs(F,B,C,a,l,$[0],st[0]),Zs(F,B,C,a,l,$[0],st[1]),Zs(F,B,C,a,l,$[1],st[0]),Zs(F,B,C,a,l,$[1],st[1])}}return B}function Oa(a){return a.type==="MultiPolygon"?a.coordinates.map(e=>({type:"Polygon",coordinates:e})):a.type==="MultiLineString"?a.coordinates.map(e=>({type:"LineString",coordinates:e})):a.type==="MultiPoint"?a.coordinates.map(e=>({type:"Point",coordinates:e})):[a]}class ys{constructor(e,l){this.type=le,this.geojson=e,this.geometries=l}static parse(e,l){if(e.length!==2)return l.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Rs(e[1])){let h=e[1];if(h.type==="FeatureCollection")return new ys(h,h.features.map(C=>Oa(C.geometry)).flat());if(h.type==="Feature")return new ys(h,Oa(h.geometry));if("type"in h&&"coordinates"in h)return new ys(h,Oa(h))}return l.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(l,h){let C=l.geometry(),w=C.flat().map(T=>so([T.x,T.y],l.canonical));if(C.length===0)return NaN;let B=new tt(w[0][1]),F=1/0;for(let T of h){switch(T.type){case"Point":F=Math.min(F,Ca(w,!1,[T.coordinates],!1,B,F));break;case"LineString":F=Math.min(F,Ca(w,!1,T.coordinates,!0,B,F));break;case"Polygon":F=Math.min(F,za(w,!1,T.coordinates,B,F))}if(F===0)return F}return F}(e,this.geometries);if(e.geometryType()==="LineString")return function(l,h){let C=l.geometry(),w=C.flat().map(T=>so([T.x,T.y],l.canonical));if(C.length===0)return NaN;let B=new tt(w[0][1]),F=1/0;for(let T of h){switch(T.type){case"Point":F=Math.min(F,Ca(w,!0,[T.coordinates],!1,B,F));break;case"LineString":F=Math.min(F,Ca(w,!0,T.coordinates,!0,B,F));break;case"Polygon":F=Math.min(F,za(w,!0,T.coordinates,B,F))}if(F===0)return F}return F}(e,this.geometries);if(e.geometryType()==="Polygon")return function(l,h){let C=l.geometry();if(C.length===0||C[0].length===0)return NaN;let w=Xo(C,0).map(T=>T.map(Z=>Z.map(M=>so([M.x,M.y],l.canonical)))),B=new tt(w[0][0][0][1]),F=1/0;for(let T of h)for(let Z of w){switch(T.type){case"Point":F=Math.min(F,za([T.coordinates],!1,Z,B,F));break;case"LineString":F=Math.min(F,za(T.coordinates,!0,Z,B,F));break;case"Polygon":F=Math.min(F,Gs(Z,T.coordinates,B,F))}if(F===0)return F}return F}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}let Ao={"==":ss,"!=":$n,">":yA,"<":zo,">=":Ic,"<=":Ql,array:wn,at:Jt,boolean:wn,case:Ie,coalesce:ai,collator:bA,format:Lo,image:Eo,in:re,"index-of":_e,interpolate:Fi,"interpolate-hcl":Fi,"interpolate-lab":Fi,length:rl,let:bt,literal:io,match:Be,number:wn,"number-format":Ma,object:wn,slice:ne,step:ve,string:wn,"to-boolean":ns,"to-color":ns,"to-number":ns,"to-string":ns,var:Pt,within:ao,distance:ys};class Fn{constructor(e,l,h,C){this.name=e,this.type=l,this._evaluate=h,this.args=C}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,l){let h=e[0],C=Fn.definitions[h];if(!C)return l.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);let w=Array.isArray(C)?C[0]:C.type,B=Array.isArray(C)?[[C[1],C[2]]]:C.overloads,F=B.filter(([Z])=>!Array.isArray(Z)||Z.length===e.length-1),T=null;for(let[Z,M]of F){T=new ct(l.registry,jo,l.path,null,l.scope);let D=[],J=!1;for(let $=1;$<e.length;$++){let st=e[$],ut=Array.isArray(Z)?Z[$-1]:Z.type,Ft=T.parse(st,1+D.length,ut);if(!Ft){J=!0;break}D.push(Ft)}if(!J)if(Array.isArray(Z)&&Z.length!==D.length)T.error(`Expected ${Z.length} arguments, but found ${D.length} instead.`);else{for(let $=0;$<D.length;$++){let st=Array.isArray(Z)?Z[$]:Z.type,ut=D[$];T.concat($+1).checkSubtype(st,ut.type)}if(T.errors.length===0)return new Fn(h,w,M,D)}}if(F.length===1)l.errors.push(...T.errors);else{let Z=(F.length?F:B).map(([D])=>{return J=D,Array.isArray(J)?`(${J.map(X).join(", ")})`:`(${X(J.type)}...)`;var J}).join(" | "),M=[];for(let D=1;D<e.length;D++){let J=l.parse(e[D],1+M.length);if(!J)return null;M.push(X(J.type))}l.error(`Expected arguments of type ${Z}, but found (${M.join(", ")}) instead.`)}return null}static register(e,l){Fn.definitions=l;for(let h in l)e[h]=Fn}}function Ia(a,[e,l,h,C]){e=e.evaluate(a),l=l.evaluate(a),h=h.evaluate(a);let w=C?C.evaluate(a):1,B=pa(e,l,h,w);if(B)throw new ir(B);return new Ui(e/255,l/255,h/255,w,!1)}function kn(a,e){return a in e}function ya(a,e){let l=e[a];return l===void 0?null:l}function Ps(a){return{type:a}}function jo(a){if(a instanceof Pt)return jo(a.boundExpression);if(a instanceof Fn&&a.name==="error"||a instanceof bA||a instanceof ao||a instanceof ys)return!1;let e=a instanceof ns||a instanceof wn,l=!0;return a.eachChild(h=>{l=e?l&&jo(h):l&&h instanceof io}),!!l&&ba(a)&&SA(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ba(a){if(a instanceof Fn&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof ao||a instanceof ys)return!1;let e=!0;return a.eachChild(l=>{e&&!ba(l)&&(e=!1)}),e}function Bn(a){if(a instanceof Fn&&a.name==="feature-state")return!1;let e=!0;return a.eachChild(l=>{e&&!Bn(l)&&(e=!1)}),e}function SA(a,e){if(a instanceof Fn&&e.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(h=>{l&&!SA(h,e)&&(l=!1)}),l}function FA(a){return{result:"success",value:a}}function qo(a){return{result:"error",value:a}}function Ln(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Wa(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function va(a){return!!a.expression&&a.expression.interpolated}function dr(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function Hs(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function bs(a){return a}function Ms(a,e){let l=e.type==="color",h=a.stops&&typeof a.stops[0][0]=="object",C=h||!(h||a.property!==void 0),w=a.type||(va(e)?"exponential":"interval");if(l||e.type==="padding"){let M=l?Ui.parse:Ir.parse;(a=Ni({},a)).stops&&(a.stops=a.stops.map(D=>[D[0],M(D[1])])),a.default=M(a.default?a.default:e.default)}if(a.colorSpace&&(B=a.colorSpace)!=="rgb"&&B!=="hcl"&&B!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var B;let F,T,Z;if(w==="exponential")F=wa;else if(w==="interval")F=Ns;else if(w==="categorical"){F=vs,T=Object.create(null);for(let M of a.stops)T[M[0]]=M[1];Z=typeof a.stops[0][0]}else{if(w!=="identity")throw new Error(`Unknown function type "${w}"`);F=ws}if(h){let M={},D=[];for(let st=0;st<a.stops.length;st++){let ut=a.stops[st],Ft=ut[0].zoom;M[Ft]===void 0&&(M[Ft]={zoom:Ft,type:a.type,property:a.property,default:a.default,stops:[]},D.push(Ft)),M[Ft].stops.push([ut[0].value,ut[1]])}let J=[];for(let st of D)J.push([M[st].zoom,Ms(M[st],e)]);let $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:Fi.interpolationFactor.bind(void 0,$),zoomStops:J.map(st=>st[0]),evaluate:({zoom:st},ut)=>wa({stops:J,base:a.base},e,st).evaluate(st,ut)}}if(C){let M=w==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Fi.interpolationFactor.bind(void 0,M),zoomStops:a.stops.map(D=>D[0]),evaluate:({zoom:D})=>F(a,e,D,T,Z)}}return{kind:"source",evaluate(M,D){let J=D&&D.properties?D.properties[a.property]:void 0;return J===void 0?as(a.default,e.default):F(a,e,J,T,Z)}}}function as(a,e,l){return a!==void 0?a:e!==void 0?e:l!==void 0?l:void 0}function vs(a,e,l,h,C){return as(typeof l===C?h[l]:void 0,a.default,e.default)}function Ns(a,e,l){if(dr(l)!=="number")return as(a.default,e.default);let h=a.stops.length;if(h===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[h-1][0])return a.stops[h-1][1];let C=ye(a.stops.map(w=>w[0]),l);return a.stops[C][1]}function wa(a,e,l){let h=a.base!==void 0?a.base:1;if(dr(l)!=="number")return as(a.default,e.default);let C=a.stops.length;if(C===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[C-1][0])return a.stops[C-1][1];let w=ye(a.stops.map(M=>M[0]),l),B=function(M,D,J,$){let st=$-J,ut=M-J;return st===0?0:D===1?ut/st:(Math.pow(D,ut)-1)/(Math.pow(D,st)-1)}(l,h,a.stops[w][0],a.stops[w+1][0]),F=a.stops[w][1],T=a.stops[w+1][1],Z=ci[e.type]||bs;return typeof F.evaluate=="function"?{evaluate(...M){let D=F.evaluate.apply(void 0,M),J=T.evaluate.apply(void 0,M);if(D!==void 0&&J!==void 0)return Z(D,J,B,a.colorSpace)}}:Z(F,T,B,a.colorSpace)}function ws(a,e,l){switch(e.type){case"color":l=Ui.parse(l);break;case"formatted":l=$r.fromString(l.toString());break;case"resolvedImage":l=An.fromString(l.toString());break;case"padding":l=Ir.parse(l);break;default:dr(l)===e.type||e.type==="enum"&&e.values[l]||(l=void 0)}return as(l,a.default,e.default)}Fn.register(Ao,{error:[{kind:"error"},[gi],(a,[e])=>{throw new ir(e.evaluate(a))}],typeof:[gi,[ii],(a,[e])=>X(Or(e.evaluate(a)))],"to-rgba":[W(le,4),[or],(a,[e])=>{let[l,h,C,w]=e.evaluate(a).rgb;return[255*l,255*h,255*C,w]}],rgb:[or,[le,le,le],Ia],rgba:[or,[le,le,le,le],Ia],has:{type:Ke,overloads:[[[gi],(a,[e])=>kn(e.evaluate(a),a.properties())],[[gi,Ki],(a,[e,l])=>kn(e.evaluate(a),l.evaluate(a))]]},get:{type:ii,overloads:[[[gi],(a,[e])=>ya(e.evaluate(a),a.properties())],[[gi,Ki],(a,[e,l])=>ya(e.evaluate(a),l.evaluate(a))]]},"feature-state":[ii,[gi],(a,[e])=>ya(e.evaluate(a),a.featureState||{})],properties:[Ki,[],a=>a.properties()],"geometry-type":[gi,[],a=>a.geometryType()],id:[ii,[],a=>a.id()],zoom:[le,[],a=>a.globals.zoom],"heatmap-density":[le,[],a=>a.globals.heatmapDensity||0],"line-progress":[le,[],a=>a.globals.lineProgress||0],accumulated:[ii,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[le,Ps(le),(a,e)=>{let l=0;for(let h of e)l+=h.evaluate(a);return l}],"*":[le,Ps(le),(a,e)=>{let l=1;for(let h of e)l*=h.evaluate(a);return l}],"-":{type:le,overloads:[[[le,le],(a,[e,l])=>e.evaluate(a)-l.evaluate(a)],[[le],(a,[e])=>-e.evaluate(a)]]},"/":[le,[le,le],(a,[e,l])=>e.evaluate(a)/l.evaluate(a)],"%":[le,[le,le],(a,[e,l])=>e.evaluate(a)%l.evaluate(a)],ln2:[le,[],()=>Math.LN2],pi:[le,[],()=>Math.PI],e:[le,[],()=>Math.E],"^":[le,[le,le],(a,[e,l])=>Math.pow(e.evaluate(a),l.evaluate(a))],sqrt:[le,[le],(a,[e])=>Math.sqrt(e.evaluate(a))],log10:[le,[le],(a,[e])=>Math.log(e.evaluate(a))/Math.LN10],ln:[le,[le],(a,[e])=>Math.log(e.evaluate(a))],log2:[le,[le],(a,[e])=>Math.log(e.evaluate(a))/Math.LN2],sin:[le,[le],(a,[e])=>Math.sin(e.evaluate(a))],cos:[le,[le],(a,[e])=>Math.cos(e.evaluate(a))],tan:[le,[le],(a,[e])=>Math.tan(e.evaluate(a))],asin:[le,[le],(a,[e])=>Math.asin(e.evaluate(a))],acos:[le,[le],(a,[e])=>Math.acos(e.evaluate(a))],atan:[le,[le],(a,[e])=>Math.atan(e.evaluate(a))],min:[le,Ps(le),(a,e)=>Math.min(...e.map(l=>l.evaluate(a)))],max:[le,Ps(le),(a,e)=>Math.max(...e.map(l=>l.evaluate(a)))],abs:[le,[le],(a,[e])=>Math.abs(e.evaluate(a))],round:[le,[le],(a,[e])=>{let l=e.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[le,[le],(a,[e])=>Math.floor(e.evaluate(a))],ceil:[le,[le],(a,[e])=>Math.ceil(e.evaluate(a))],"filter-==":[Ke,[gi,ii],(a,[e,l])=>a.properties()[e.value]===l.value],"filter-id-==":[Ke,[ii],(a,[e])=>a.id()===e.value],"filter-type-==":[Ke,[gi],(a,[e])=>a.geometryType()===e.value],"filter-<":[Ke,[gi,ii],(a,[e,l])=>{let h=a.properties()[e.value],C=l.value;return typeof h==typeof C&&h<C}],"filter-id-<":[Ke,[ii],(a,[e])=>{let l=a.id(),h=e.value;return typeof l==typeof h&&l<h}],"filter->":[Ke,[gi,ii],(a,[e,l])=>{let h=a.properties()[e.value],C=l.value;return typeof h==typeof C&&h>C}],"filter-id->":[Ke,[ii],(a,[e])=>{let l=a.id(),h=e.value;return typeof l==typeof h&&l>h}],"filter-<=":[Ke,[gi,ii],(a,[e,l])=>{let h=a.properties()[e.value],C=l.value;return typeof h==typeof C&&h<=C}],"filter-id-<=":[Ke,[ii],(a,[e])=>{let l=a.id(),h=e.value;return typeof l==typeof h&&l<=h}],"filter->=":[Ke,[gi,ii],(a,[e,l])=>{let h=a.properties()[e.value],C=l.value;return typeof h==typeof C&&h>=C}],"filter-id->=":[Ke,[ii],(a,[e])=>{let l=a.id(),h=e.value;return typeof l==typeof h&&l>=h}],"filter-has":[Ke,[ii],(a,[e])=>e.value in a.properties()],"filter-has-id":[Ke,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Ke,[W(gi)],(a,[e])=>e.value.indexOf(a.geometryType())>=0],"filter-id-in":[Ke,[W(ii)],(a,[e])=>e.value.indexOf(a.id())>=0],"filter-in-small":[Ke,[gi,W(ii)],(a,[e,l])=>l.value.indexOf(a.properties()[e.value])>=0],"filter-in-large":[Ke,[gi,W(ii)],(a,[e,l])=>function(h,C,w,B){for(;w<=B;){let F=w+B>>1;if(C[F]===h)return!0;C[F]>h?B=F-1:w=F+1}return!1}(a.properties()[e.value],l.value,0,l.value.length-1)],all:{type:Ke,overloads:[[[Ke,Ke],(a,[e,l])=>e.evaluate(a)&&l.evaluate(a)],[Ps(Ke),(a,e)=>{for(let l of e)if(!l.evaluate(a))return!1;return!0}]]},any:{type:Ke,overloads:[[[Ke,Ke],(a,[e,l])=>e.evaluate(a)||l.evaluate(a)],[Ps(Ke),(a,e)=>{for(let l of e)if(l.evaluate(a))return!0;return!1}]]},"!":[Ke,[Ke],(a,[e])=>!e.evaluate(a)],"is-supported-script":[Ke,[gi],(a,[e])=>{let l=a.globals&&a.globals.isSupportedScript;return!l||l(e.evaluate(a))}],upcase:[gi,[gi],(a,[e])=>e.evaluate(a).toUpperCase()],downcase:[gi,[gi],(a,[e])=>e.evaluate(a).toLowerCase()],concat:[gi,Ps(ii),(a,e)=>e.map(l=>vn(l.evaluate(a))).join("")],"resolved-locale":[gi,[br],(a,[e])=>e.evaluate(a).resolvedLocale()]});class $o{constructor(e,l){var h;this.expression=e,this._warningHistory={},this._evaluator=new Ct,this._defaultValue=l?(h=l).type==="color"&&Hs(h.default)?new Ui(0,0,0,0):h.type==="color"?Ui.parse(h.default)||null:h.type==="padding"?Ir.parse(h.default)||null:h.type==="variableAnchorOffsetCollection"?pn.parse(h.default)||null:h.default===void 0?null:h.default:null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(e,l,h,C,w,B){return this._evaluator.globals=e,this._evaluator.feature=l,this._evaluator.featureState=h,this._evaluator.canonical=C,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=B,this.expression.evaluate(this._evaluator)}evaluate(e,l,h,C,w,B){this._evaluator.globals=e,this._evaluator.feature=l||null,this._evaluator.featureState=h||null,this._evaluator.canonical=C,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=B||null;try{let F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new ir(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(F.message)),this._defaultValue}}}function ta(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Ao}function As(a,e){let l=new ct(Ao,jo,[],e?function(C){let w={color:or,string:gi,number:le,enum:gi,boolean:Ke,formatted:Ji,padding:wr,resolvedImage:ar,variableAnchorOffsetCollection:wt};return C.type==="array"?W(w[C.value]||ii,C.length):w[C.type]}(e):void 0),h=l.parse(a,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?FA(new $o(h,e)):qo(l.errors)}class Bs{constructor(e,l){this.kind=e,this._styleExpression=l,this.isStateDependent=e!=="constant"&&!Bn(l.expression)}evaluateWithoutErrorHandling(e,l,h,C,w,B){return this._styleExpression.evaluateWithoutErrorHandling(e,l,h,C,w,B)}evaluate(e,l,h,C,w,B){return this._styleExpression.evaluate(e,l,h,C,w,B)}}class lo{constructor(e,l,h,C){this.kind=e,this.zoomStops=h,this._styleExpression=l,this.isStateDependent=e!=="camera"&&!Bn(l.expression),this.interpolationType=C}evaluateWithoutErrorHandling(e,l,h,C,w,B){return this._styleExpression.evaluateWithoutErrorHandling(e,l,h,C,w,B)}evaluate(e,l,h,C,w,B){return this._styleExpression.evaluate(e,l,h,C,w,B)}interpolationFactor(e,l,h){return this.interpolationType?Fi.interpolationFactor(this.interpolationType,e,l,h):0}}function Ba(a,e){let l=As(a,e);if(l.result==="error")return l;let h=l.value.expression,C=ba(h);if(!C&&!Ln(e))return qo([new Di("","data expressions not supported")]);let w=SA(h,["zoom"]);if(!w&&!Wa(e))return qo([new Di("","zoom expressions not supported")]);let B=To(h);return B||w?B instanceof Di?qo([B]):B instanceof Fi&&!va(e)?qo([new Di("",'"interpolate" expressions cannot be used with this property')]):FA(B?new lo(C?"camera":"composite",l.value,B.labels,B instanceof Fi?B.interpolation:void 0):new Bs(C?"constant":"source",l.value)):qo([new Di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ea{constructor(e,l){this._parameters=e,this._specification=l,Ni(this,Ms(this._parameters,this._specification))}static deserialize(e){return new ea(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function To(a){let e=null;if(a instanceof bt)e=To(a.result);else if(a instanceof ai){for(let l of a.args)if(e=To(l),e)break}else(a instanceof ve||a instanceof Fi)&&a.input instanceof Fn&&a.input.name==="zoom"&&(e=a);return e instanceof Di||a.eachChild(l=>{let h=To(l);h instanceof Di?e=h:!e&&h?e=new Di("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&h&&e!==h&&(e=new Di("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function _s(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(let e of a.slice(1))if(!_s(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}let _a={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Vr(a){if(a==null)return{filter:()=>!0,needGeometry:!1};_s(a)||(a=_r(a));let e=As(a,_a);if(e.result==="error")throw new Error(e.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,h,C)=>e.value.evaluate(l,h,{},C),needGeometry:kr(a)}}function xs(a,e){return a<e?-1:a>e?1:0}function kr(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let e=1;e<a.length;e++)if(kr(a[e]))return!0;return!1}function _r(a){if(!a)return!0;let e=a[0];return a.length<=1?e!=="any":e==="=="?en(a[1],a[2],"=="):e==="!="?Ss(en(a[1],a[2],"==")):e==="<"||e===">"||e==="<="||e===">="?en(a[1],a[2],e):e==="any"?(l=a.slice(1),["any"].concat(l.map(_r))):e==="all"?["all"].concat(a.slice(1).map(_r)):e==="none"?["all"].concat(a.slice(1).map(_r).map(Ss)):e==="in"?Wr(a[1],a.slice(2)):e==="!in"?Ss(Wr(a[1],a.slice(2))):e==="has"?co(a[1]):e!=="!has"||Ss(co(a[1]));var l}function en(a,e,l){switch(a){case"$type":return[`filter-type-${l}`,e];case"$id":return[`filter-id-${l}`,e];default:return[`filter-${l}`,a,e]}}function Wr(a,e){if(e.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(l=>typeof l!=typeof e[0])?["filter-in-large",a,["literal",e.sort(xs)]]:["filter-in-small",a,["literal",e]]}}function co(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Ss(a){return["!",a]}function xa(a){let e=typeof a;if(e==="number"||e==="boolean"||e==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let C="[";for(let w of a)C+=`${xa(w)},`;return`${C}]`}let l=Object.keys(a).sort(),h="{";for(let C=0;C<l.length;C++)h+=`${JSON.stringify(l[C])}:${xa(a[l[C]])},`;return`${h}}`}function kA(a){let e="";for(let l of Ce)e+=`/${xa(a[l])}`;return e}function vc(a){let e=a.value;return e?[new fe(a.key,e,"constants have been deprecated as of v8")]:[]}function Qr(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Sa(a){if(Array.isArray(a))return a.map(Sa);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){let e={};for(let l in a)e[l]=Sa(a[l]);return e}return Qr(a)}function ts(a){let e=a.key,l=a.value,h=a.valueSpec||{},C=a.objectElementValidators||{},w=a.style,B=a.styleSpec,F=a.validateSpec,T=[],Z=dr(l);if(Z!=="object")return[new fe(e,l,`object expected, ${Z} found`)];for(let M in l){let D=M.split(".")[0],J=h[D]||h["*"],$;if(C[D])$=C[D];else if(h[D])$=F;else if(C["*"])$=C["*"];else{if(!h["*"]){T.push(new fe(e,l[M],`unknown property "${M}"`));continue}$=F}T=T.concat($({key:(e&&`${e}.`)+M,value:l[M],valueSpec:J,style:w,styleSpec:B,object:l,objectKey:M,validateSpec:F},l))}for(let M in h)C[M]||h[M].required&&h[M].default===void 0&&l[M]===void 0&&T.push(new fe(e,l,`missing required property "${M}"`));return T}function al(a){let e=a.value,l=a.valueSpec,h=a.style,C=a.styleSpec,w=a.key,B=a.arrayElementValidator||a.validateSpec;if(dr(e)!=="array")return[new fe(w,e,`array expected, ${dr(e)} found`)];if(l.length&&e.length!==l.length)return[new fe(w,e,`array length ${l.length} expected, length ${e.length} found`)];if(l["min-length"]&&e.length<l["min-length"])return[new fe(w,e,`array length at least ${l["min-length"]} expected, length ${e.length} found`)];let F={type:l.value,values:l.values};C.$version<7&&(F.function=l.function),dr(l.value)==="object"&&(F=l.value);let T=[];for(let Z=0;Z<e.length;Z++)T=T.concat(B({array:e,arrayIndex:Z,value:e[Z],valueSpec:F,validateSpec:a.validateSpec,style:h,styleSpec:C,key:`${w}[${Z}]`}));return T}function LA(a){let e=a.key,l=a.value,h=a.valueSpec,C=dr(l);return C==="number"&&l!=l&&(C="NaN"),C!=="number"?[new fe(e,l,`number expected, ${C} found`)]:"minimum"in h&&l<h.minimum?[new fe(e,l,`${l} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&l>h.maximum?[new fe(e,l,`${l} is greater than the maximum value ${h.maximum}`)]:[]}function Al(a){let e=a.valueSpec,l=Qr(a.value.type),h,C,w,B={},F=l!=="categorical"&&a.value.property===void 0,T=!F,Z=dr(a.value.stops)==="array"&&dr(a.value.stops[0])==="array"&&dr(a.value.stops[0][0])==="object",M=ts({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function($){if(l==="identity")return[new fe($.key,$.value,'identity function may not have a "stops" property')];let st=[],ut=$.value;return st=st.concat(al({key:$.key,value:ut,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:D})),dr(ut)==="array"&&ut.length===0&&st.push(new fe($.key,ut,"array must have at least one stop")),st},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:e,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return l==="identity"&&F&&M.push(new fe(a.key,a.value,'missing required property "property"')),l==="identity"||a.value.stops||M.push(new fe(a.key,a.value,'missing required property "stops"')),l==="exponential"&&a.valueSpec.expression&&!va(a.valueSpec)&&M.push(new fe(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(T&&!Ln(a.valueSpec)?M.push(new fe(a.key,a.value,"property functions not supported")):F&&!Wa(a.valueSpec)&&M.push(new fe(a.key,a.value,"zoom functions not supported"))),l!=="categorical"&&!Z||a.value.property!==void 0||M.push(new fe(a.key,a.value,'"property" property is required')),M;function D($){let st=[],ut=$.value,Ft=$.key;if(dr(ut)!=="array")return[new fe(Ft,ut,`array expected, ${dr(ut)} found`)];if(ut.length!==2)return[new fe(Ft,ut,`array length 2 expected, length ${ut.length} found`)];if(Z){if(dr(ut[0])!=="object")return[new fe(Ft,ut,`object expected, ${dr(ut[0])} found`)];if(ut[0].zoom===void 0)return[new fe(Ft,ut,"object stop key must have zoom")];if(ut[0].value===void 0)return[new fe(Ft,ut,"object stop key must have value")];if(w&&w>Qr(ut[0].zoom))return[new fe(Ft,ut[0].zoom,"stop zoom values must appear in ascending order")];Qr(ut[0].zoom)!==w&&(w=Qr(ut[0].zoom),C=void 0,B={}),st=st.concat(ts({key:`${Ft}[0]`,value:ut[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:LA,value:J}}))}else st=st.concat(J({key:`${Ft}[0]`,value:ut[0],valueSpec:{},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},ut));return ta(Sa(ut[1]))?st.concat([new fe(`${Ft}[1]`,ut[1],"expressions are not allowed in function stops.")]):st.concat($.validateSpec({key:`${Ft}[1]`,value:ut[1],valueSpec:e,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function J($,st){let ut=dr($.value),Ft=Qr($.value),Gt=$.value!==null?$.value:st;if(h){if(ut!==h)return[new fe($.key,Gt,`${ut} stop domain type must match previous stop domain type ${h}`)]}else h=ut;if(ut!=="number"&&ut!=="string"&&ut!=="boolean")return[new fe($.key,Gt,"stop domain value must be a number, string, or boolean")];if(ut!=="number"&&l!=="categorical"){let Ae=`number expected, ${ut} found`;return Ln(e)&&l===void 0&&(Ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new fe($.key,Gt,Ae)]}return l!=="categorical"||ut!=="number"||isFinite(Ft)&&Math.floor(Ft)===Ft?l!=="categorical"&&ut==="number"&&C!==void 0&&Ft<C?[new fe($.key,Gt,"stop domain values must appear in ascending order")]:(C=Ft,l==="categorical"&&Ft in B?[new fe($.key,Gt,"stop domain values must be unique")]:(B[Ft]=!0,[])):[new fe($.key,Gt,`integer expected, found ${Ft}`)]}}function Uo(a){let e=(a.expressionContext==="property"?Ba:As)(Sa(a.value),a.valueSpec);if(e.result==="error")return e.value.map(h=>new fe(`${a.key}${h.key}`,a.value,h.message));let l=e.value.expression||e.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!l.outputDefined())return[new fe(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Bn(l))return[new fe(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Bn(l))return[new fe(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!SA(l,["zoom","feature-state"]))return[new fe(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!ba(l))return[new fe(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function En(a){let e=a.key,l=a.value,h=a.valueSpec,C=[];return Array.isArray(h.values)?h.values.indexOf(Qr(l))===-1&&C.push(new fe(e,l,`expected one of [${h.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(h.values).indexOf(Qr(l))===-1&&C.push(new fe(e,l,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(l)} found`)),C}function zn(a){return _s(Sa(a.value))?Uo(Ni({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Fa(a)}function Fa(a){let e=a.value,l=a.key;if(dr(e)!=="array")return[new fe(l,e,`array expected, ${dr(e)} found`)];let h=a.styleSpec,C,w=[];if(e.length<1)return[new fe(l,e,"filter array must have at least 1 element")];switch(w=w.concat(En({key:`${l}[0]`,value:e[0],valueSpec:h.filter_operator,style:a.style,styleSpec:a.styleSpec})),Qr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Qr(e[1])==="$type"&&w.push(new fe(l,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&w.push(new fe(l,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(C=dr(e[1]),C!=="string"&&w.push(new fe(`${l}[1]`,e[1],`string expected, ${C} found`)));for(let B=2;B<e.length;B++)C=dr(e[B]),Qr(e[1])==="$type"?w=w.concat(En({key:`${l}[${B}]`,value:e[B],valueSpec:h.geometry_type,style:a.style,styleSpec:a.styleSpec})):C!=="string"&&C!=="number"&&C!=="boolean"&&w.push(new fe(`${l}[${B}]`,e[B],`string, number, or boolean expected, ${C} found`));break;case"any":case"all":case"none":for(let B=1;B<e.length;B++)w=w.concat(Fa({key:`${l}[${B}]`,value:e[B],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":C=dr(e[1]),e.length!==2?w.push(new fe(l,e,`filter array for "${e[0]}" operator must have 2 elements`)):C!=="string"&&w.push(new fe(`${l}[1]`,e[1],`string expected, ${C} found`))}return w}function EA(a,e){let l=a.key,h=a.validateSpec,C=a.style,w=a.styleSpec,B=a.value,F=a.objectKey,T=w[`${e}_${a.layerType}`];if(!T)return[];let Z=F.match(/^(.*)-transition$/);if(e==="paint"&&Z&&T[Z[1]]&&T[Z[1]].transition)return h({key:l,value:B,valueSpec:w.transition,style:C,styleSpec:w});let M=a.valueSpec||T[F];if(!M)return[new fe(l,B,`unknown property "${F}"`)];let D;if(dr(B)==="string"&&Ln(M)&&!M.tokens&&(D=/^{([^}]+)}$/.exec(B)))return[new fe(l,B,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];let J=[];return a.layerType==="symbol"&&(F==="text-field"&&C&&!C.glyphs&&J.push(new fe(l,B,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&Hs(Sa(B))&&Qr(B.type)==="identity"&&J.push(new fe(l,B,'"text-font" does not support identity functions'))),J.concat(h({key:a.key,value:B,valueSpec:M,style:C,styleSpec:w,expressionContext:"property",propertyType:e,propertyKey:F}))}function Pl(a){return EA(a,"paint")}function TA(a){return EA(a,"layout")}function UA(a){let e=[],l=a.value,h=a.key,C=a.style,w=a.styleSpec;l.type||l.ref||e.push(new fe(h,l,'either "type" or "ref" is required'));let B=Qr(l.type),F=Qr(l.ref);if(l.id){let T=Qr(l.id);for(let Z=0;Z<a.arrayIndex;Z++){let M=C.layers[Z];Qr(M.id)===T&&e.push(new fe(h,l.id,`duplicate layer id "${l.id}", previously used at line ${M.id.__line__}`))}}if("ref"in l){let T;["type","source","source-layer","filter","layout"].forEach(Z=>{Z in l&&e.push(new fe(h,l[Z],`"${Z}" is prohibited for ref layers`))}),C.layers.forEach(Z=>{Qr(Z.id)===F&&(T=Z)}),T?T.ref?e.push(new fe(h,l.ref,"ref cannot reference another ref layer")):B=Qr(T.type):e.push(new fe(h,l.ref,`ref layer "${F}" not found`))}else if(B!=="background")if(l.source){let T=C.sources&&C.sources[l.source],Z=T&&Qr(T.type);T?Z==="vector"&&B==="raster"?e.push(new fe(h,l.source,`layer "${l.id}" requires a raster source`)):Z!=="raster-dem"&&B==="hillshade"?e.push(new fe(h,l.source,`layer "${l.id}" requires a raster-dem source`)):Z==="raster"&&B!=="raster"?e.push(new fe(h,l.source,`layer "${l.id}" requires a vector source`)):Z!=="vector"||l["source-layer"]?Z==="raster-dem"&&B!=="hillshade"?e.push(new fe(h,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):B!=="line"||!l.paint||!l.paint["line-gradient"]||Z==="geojson"&&T.lineMetrics||e.push(new fe(h,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new fe(h,l,`layer "${l.id}" must specify a "source-layer"`)):e.push(new fe(h,l.source,`source "${l.source}" not found`))}else e.push(new fe(h,l,'missing required property "source"'));return e=e.concat(ts({key:h,value:l,valueSpec:w.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${h}.type`,value:l.type,valueSpec:w.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:l,objectKey:"type"}),filter:zn,layout:T=>ts({layer:l,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":Z=>TA(Ni({layerType:B},Z))}}),paint:T=>ts({layer:l,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":Z=>Pl(Ni({layerType:B},Z))}})}})),e}function uo(a){let e=a.value,l=a.key,h=dr(e);return h!=="string"?[new fe(l,e,`string expected, ${h} found`)]:[]}let Hl={promoteId:function({key:a,value:e}){if(dr(e)==="string")return uo({key:a,value:e});{let l=[];for(let h in e)l.push(...uo({key:`${a}.${h}`,value:e[h]}));return l}}};function Ml(a){let e=a.value,l=a.key,h=a.styleSpec,C=a.style,w=a.validateSpec;if(!e.type)return[new fe(l,e,'"type" is required')];let B=Qr(e.type),F;switch(B){case"vector":case"raster":return F=ts({key:l,value:e,valueSpec:h[`source_${B.replace("-","_")}`],style:a.style,styleSpec:h,objectElementValidators:Hl,validateSpec:w}),F;case"raster-dem":return F=function(T){var Z;let M=(Z=T.sourceName)!==null&&Z!==void 0?Z:"",D=T.value,J=T.styleSpec,$=J.source_raster_dem,st=T.style,ut=[],Ft=dr(D);if(D===void 0)return ut;if(Ft!=="object")return ut.push(new fe("source_raster_dem",D,`object expected, ${Ft} found`)),ut;let Gt=Qr(D.encoding)==="custom",Ae=["redFactor","greenFactor","blueFactor","baseShift"],Ot=T.value.encoding?`"${T.value.encoding}"`:"Default";for(let te in D)!Gt&&Ae.includes(te)?ut.push(new fe(te,D[te],`In "${M}": "${te}" is only valid when "encoding" is set to "custom". ${Ot} encoding found`)):$[te]?ut=ut.concat(T.validateSpec({key:te,value:D[te],valueSpec:$[te],validateSpec:T.validateSpec,style:st,styleSpec:J})):ut.push(new fe(te,D[te],`unknown property "${te}"`));return ut}({sourceName:l,value:e,style:a.style,styleSpec:h,validateSpec:w}),F;case"geojson":if(F=ts({key:l,value:e,valueSpec:h.source_geojson,style:C,styleSpec:h,validateSpec:w,objectElementValidators:Hl}),e.cluster)for(let T in e.clusterProperties){let[Z,M]=e.clusterProperties[T],D=typeof Z=="string"?[Z,["accumulated"],["get",T]]:Z;F.push(...Uo({key:`${l}.${T}.map`,value:M,validateSpec:w,expressionContext:"cluster-map"})),F.push(...Uo({key:`${l}.${T}.reduce`,value:D,validateSpec:w,expressionContext:"cluster-reduce"}))}return F;case"video":return ts({key:l,value:e,valueSpec:h.source_video,style:C,validateSpec:w,styleSpec:h});case"image":return ts({key:l,value:e,valueSpec:h.source_image,style:C,validateSpec:w,styleSpec:h});case"canvas":return[new fe(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return En({key:`${l}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:C,validateSpec:w,styleSpec:h})}}function ll(a){let e=a.value,l=a.styleSpec,h=l.light,C=a.style,w=[],B=dr(e);if(e===void 0)return w;if(B!=="object")return w=w.concat([new fe("light",e,`object expected, ${B} found`)]),w;for(let F in e){let T=F.match(/^(.*)-transition$/);w=w.concat(T&&h[T[1]]&&h[T[1]].transition?a.validateSpec({key:F,value:e[F],valueSpec:l.transition,validateSpec:a.validateSpec,style:C,styleSpec:l}):h[F]?a.validateSpec({key:F,value:e[F],valueSpec:h[F],validateSpec:a.validateSpec,style:C,styleSpec:l}):[new fe(F,e[F],`unknown property "${F}"`)])}return w}function cl(a){let e=a.value,l=a.styleSpec,h=l.sky,C=a.style,w=dr(e);if(e===void 0)return[];if(w!=="object")return[new fe("sky",e,`object expected, ${w} found`)];let B=[];for(let F in e)B=B.concat(h[F]?a.validateSpec({key:F,value:e[F],valueSpec:h[F],style:C,styleSpec:l}):[new fe(F,e[F],`unknown property "${F}"`)]);return B}function ul(a){let e=a.value,l=a.styleSpec,h=l.terrain,C=a.style,w=[],B=dr(e);if(e===void 0)return w;if(B!=="object")return w=w.concat([new fe("terrain",e,`object expected, ${B} found`)]),w;for(let F in e)w=w.concat(h[F]?a.validateSpec({key:F,value:e[F],valueSpec:h[F],validateSpec:a.validateSpec,style:C,styleSpec:l}):[new fe(F,e[F],`unknown property "${F}"`)]);return w}function wc(a){let e=[],l=a.value,h=a.key;if(Array.isArray(l)){let C=[],w=[];for(let B in l)l[B].id&&C.includes(l[B].id)&&e.push(new fe(h,l,`all the sprites' ids must be unique, but ${l[B].id} is duplicated`)),C.push(l[B].id),l[B].url&&w.includes(l[B].url)&&e.push(new fe(h,l,`all the sprites' URLs must be unique, but ${l[B].url} is duplicated`)),w.push(l[B].url),e=e.concat(ts({key:`${h}[${B}]`,value:l[B],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return e}return uo({key:h,value:l})}let Bc={"*":()=>[],array:al,boolean:function(a){let e=a.value,l=a.key,h=dr(e);return h!=="boolean"?[new fe(l,e,`boolean expected, ${h} found`)]:[]},number:LA,color:function(a){let e=a.key,l=a.value,h=dr(l);return h!=="string"?[new fe(e,l,`color expected, ${h} found`)]:Ui.parse(String(l))?[]:[new fe(e,l,`color expected, "${l}" found`)]},constants:vc,enum:En,filter:zn,function:Al,layer:UA,object:ts,source:Ml,light:ll,sky:cl,terrain:ul,projection:function(a){let e=a.value,l=a.styleSpec,h=l.projection,C=a.style,w=dr(e);if(e===void 0)return[];if(w!=="object")return[new fe("projection",e,`object expected, ${w} found`)];let B=[];for(let F in e)B=B.concat(h[F]?a.validateSpec({key:F,value:e[F],valueSpec:h[F],style:C,styleSpec:l}):[new fe(F,e[F],`unknown property "${F}"`)]);return B},string:uo,formatted:function(a){return uo(a).length===0?[]:Uo(a)},resolvedImage:function(a){return uo(a).length===0?[]:Uo(a)},padding:function(a){let e=a.key,l=a.value;if(dr(l)==="array"){if(l.length<1||l.length>4)return[new fe(e,l,`padding requires 1 to 4 values; ${l.length} values found`)];let h={type:"number"},C=[];for(let w=0;w<l.length;w++)C=C.concat(a.validateSpec({key:`${e}[${w}]`,value:l[w],validateSpec:a.validateSpec,valueSpec:h}));return C}return LA({key:e,value:l,valueSpec:{}})},variableAnchorOffsetCollection:function(a){let e=a.key,l=a.value,h=dr(l),C=a.styleSpec;if(h!=="array"||l.length<1||l.length%2!=0)return[new fe(e,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let w=[];for(let B=0;B<l.length;B+=2)w=w.concat(En({key:`${e}[${B}]`,value:l[B],valueSpec:C.layout_symbol["text-anchor"]})),w=w.concat(al({key:`${e}[${B+1}]`,value:l[B+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:C}));return w},sprite:wc};function QA(a){let e=a.value,l=a.valueSpec,h=a.styleSpec;return a.validateSpec=QA,l.expression&&Hs(Qr(e))?Al(a):l.expression&&ta(Sa(e))?Uo(a):l.type&&Bc[l.type]?Bc[l.type](a):ts(Ni({},a,{valueSpec:l.type?h[l.type]:l}))}function lu(a){let e=a.value,l=a.key,h=uo(a);return h.length||(e.indexOf("{fontstack}")===-1&&h.push(new fe(l,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&h.push(new fe(l,e,'"glyphs" url must include a "{range}" token'))),h}function Vs(a,e=Kt){let l=[];return l=l.concat(QA({key:"",value:a,valueSpec:e.$root,styleSpec:e,style:a,validateSpec:QA,objectElementValidators:{glyphs:lu,"*":()=>[]}})),a.constants&&(l=l.concat(vc({key:"constants",value:a.constants,style:a,styleSpec:e,validateSpec:QA}))),_c(l)}function ho(a){return function(e){return a({...e,validateSpec:QA})}}function _c(a){return[].concat(a).sort((e,l)=>e.line-l.line)}function go(a){return function(...e){return _c(a.apply(this,e))}}Vs.source=go(ho(Ml)),Vs.sprite=go(ho(wc)),Vs.glyphs=go(ho(lu)),Vs.light=go(ho(ll)),Vs.sky=go(ho(cl)),Vs.terrain=go(ho(ul)),Vs.layer=go(ho(UA)),Vs.filter=go(ho(zn)),Vs.paintProperty=go(ho(Pl)),Vs.layoutProperty=go(ho(TA));let po=Vs,xc=po.light,Ja=po.sky,vh=po.paintProperty,wh=po.layoutProperty;function Nl(a,e){let l=!1;if(e&&e.length)for(let h of e)a.fire(new Je(new Error(h.message))),l=!0;return l}class RA{constructor(e,l,h){let C=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let B=new Int32Array(this.arrayBuffer);e=B[0],this.d=(l=B[1])+2*(h=B[2]);for(let T=0;T<this.d*this.d;T++){let Z=B[3+T],M=B[3+T+1];C.push(Z===M?null:B.subarray(Z,M))}let F=B[3+C.length+1];this.keys=B.subarray(B[3+C.length],F),this.bboxes=B.subarray(F),this.insert=this._insertReadonly}else{this.d=l+2*h;for(let B=0;B<this.d*this.d;B++)C.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=e,this.padding=h,this.scale=l/e,this.uid=0;let w=h/l*e;this.min=-w,this.max=e+w}insert(e,l,h,C,w){this._forEachCell(l,h,C,w,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(C),this.bboxes.push(w)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,l,h,C,w,B){this.cells[w].push(B)}query(e,l,h,C,w){let B=this.min,F=this.max;if(e<=B&&l<=B&&F<=h&&F<=C&&!w)return Array.prototype.slice.call(this.keys);{let T=[];return this._forEachCell(e,l,h,C,this._queryCell,T,{},w),T}}_queryCell(e,l,h,C,w,B,F,T){let Z=this.cells[w];if(Z!==null){let M=this.keys,D=this.bboxes;for(let J=0;J<Z.length;J++){let $=Z[J];if(F[$]===void 0){let st=4*$;(T?T(D[st+0],D[st+1],D[st+2],D[st+3]):e<=D[st+2]&&l<=D[st+3]&&h>=D[st+0]&&C>=D[st+1])?(F[$]=!0,B.push(M[$])):F[$]=!1}}}}_forEachCell(e,l,h,C,w,B,F,T){let Z=this._convertToCellCoord(e),M=this._convertToCellCoord(l),D=this._convertToCellCoord(h),J=this._convertToCellCoord(C);for(let $=Z;$<=D;$++)for(let st=M;st<=J;st++){let ut=this.d*st+$;if((!T||T(this._convertFromCellCoord($),this._convertFromCellCoord(st),this._convertFromCellCoord($+1),this._convertFromCellCoord(st+1)))&&w.call(this,e,l,h,C,ut,B,F,T))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,l=3+this.cells.length+1+1,h=0;for(let B=0;B<this.cells.length;B++)h+=this.cells[B].length;let C=new Int32Array(l+h+this.keys.length+this.bboxes.length);C[0]=this.extent,C[1]=this.n,C[2]=this.padding;let w=l;for(let B=0;B<e.length;B++){let F=e[B];C[3+B]=w,C.set(F,w),w+=F.length}return C[3+e.length]=w,C.set(this.keys,w),w+=this.keys.length,C[3+e.length+1]=w,C.set(this.bboxes,w),w+=this.bboxes.length,C.buffer}static serialize(e,l){let h=e.toArrayBuffer();return l&&l.push(h),{buffer:h}}static deserialize(e){return new RA(e.buffer)}}let Qo={};function Ai(a,e,l={}){if(Qo[a])throw new Error(`${a} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:a,writeable:!1}),Qo[a]={klass:e,omit:l.omit||[],shallow:l.shallow||[]}}Ai("Object",Object),Ai("TransferableGridIndex",RA),Ai("Color",Ui),Ai("Error",Error),Ai("AJAXError",Qt),Ai("ResolvedImage",An),Ai("StylePropertyFunction",ea),Ai("StyleExpression",$o,{omit:["_evaluator"]}),Ai("ZoomDependentExpression",lo),Ai("ZoomConstantExpression",Bs),Ai("CompoundExpression",Fn,{omit:["_evaluate"]});for(let a in Ao)Ao[a]._classRegistryKey||Ai(`Expression_${a}`,Ao[a]);function cu(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Ro(a){return a.$name||a.constructor._classRegistryKey}function Ds(a){return!function(e){if(e===null||typeof e!="object")return!1;let l=Ro(e);return!(!l||l==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||cu(a)||se(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function Fs(a,e){if(Ds(a))return(cu(a)||se(a))&&e&&e.push(a),ArrayBuffer.isView(a)&&e&&e.push(a.buffer),a instanceof ImageData&&e&&e.push(a.data.buffer),a;if(Array.isArray(a)){let w=[];for(let B of a)w.push(Fs(B,e));return w}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);let l=Ro(a);if(!l)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!Qo[l])throw new Error(`${l} is not registered.`);let{klass:h}=Qo[l],C=h.serialize?h.serialize(a,e):{};if(h.serialize){if(e&&C===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let w in a){if(!a.hasOwnProperty(w)||Qo[l].omit.indexOf(w)>=0)continue;let B=a[w];C[w]=Qo[l].shallow.indexOf(w)>=0?B:Fs(B,e)}a instanceof Error&&(C.message=a.message)}if(C.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(C.$name=l),C}function Go(a){if(Ds(a))return a;if(Array.isArray(a))return a.map(Go);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);let e=Ro(a)||"Object";if(!Qo[e])throw new Error(`can't deserialize unregistered class ${e}`);let{klass:l}=Qo[e];if(!l)throw new Error(`can't deserialize unregistered class ${e}`);if(l.deserialize)return l.deserialize(a);let h=Object.create(l.prototype);for(let C of Object.keys(a)){if(C==="$name")continue;let w=a[C];h[C]=Qo[e].shallow.indexOf(C)>=0?w:Go(w)}return h}class Sc{constructor(){this.first=!0}update(e,l){let h=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=l),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=h,!0))}}let qe={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function ls(a){for(let e of a)if(Vl(e.charCodeAt(0)))return!0;return!1}function Bh(a){for(let e of a)if(!uu(e.charCodeAt(0)))return!1;return!0}function uu(a){return!(qe.Arabic(a)||qe["Arabic Supplement"](a)||qe["Arabic Extended-A"](a)||qe["Arabic Presentation Forms-A"](a)||qe["Arabic Presentation Forms-B"](a))}function Vl(a){return!(a!==746&&a!==747&&(a<4352||!(qe["Bopomofo Extended"](a)||qe.Bopomofo(a)||qe["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||qe["CJK Compatibility Ideographs"](a)||qe["CJK Compatibility"](a)||qe["CJK Radicals Supplement"](a)||qe["CJK Strokes"](a)||!(!qe["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||qe["CJK Unified Ideographs Extension A"](a)||qe["CJK Unified Ideographs"](a)||qe["Enclosed CJK Letters and Months"](a)||qe["Hangul Compatibility Jamo"](a)||qe["Hangul Jamo Extended-A"](a)||qe["Hangul Jamo Extended-B"](a)||qe["Hangul Jamo"](a)||qe["Hangul Syllables"](a)||qe.Hiragana(a)||qe["Ideographic Description Characters"](a)||qe.Kanbun(a)||qe["Kangxi Radicals"](a)||qe["Katakana Phonetic Extensions"](a)||qe.Katakana(a)&&a!==12540||!(!qe["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!qe["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||qe["Unified Canadian Aboriginal Syllabics"](a)||qe["Unified Canadian Aboriginal Syllabics Extended"](a)||qe["Vertical Forms"](a)||qe["Yijing Hexagram Symbols"](a)||qe["Yi Syllables"](a)||qe["Yi Radicals"](a))))}function Fc(a){return!(Vl(a)||function(e){return!!(qe["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||qe["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||qe["Letterlike Symbols"](e)||qe["Number Forms"](e)||qe["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||qe["Control Pictures"](e)&&e!==9251||qe["Optical Character Recognition"](e)||qe["Enclosed Alphanumerics"](e)||qe["Geometric Shapes"](e)||qe["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||qe["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||qe["CJK Symbols and Punctuation"](e)||qe.Katakana(e)||qe["Private Use Area"](e)||qe["CJK Compatibility Forms"](e)||qe["Small Form Variants"](e)||qe["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(a))}function ia(a){return a>=1424&&a<=2303||qe["Arabic Presentation Forms-A"](a)||qe["Arabic Presentation Forms-B"](a)}function kc(a,e){return!(!e&&ia(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||qe.Khmer(a))}function Lc(a){for(let e of a)if(ia(e.charCodeAt(0)))return!0;return!1}let fo=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class vr{constructor(e,l){this.zoom=e,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Sc,this.transition={})}isSupportedScript(e){return function(l,h){for(let C of l)if(!kc(C.charCodeAt(0),h))return!1;return!0}(e,fo.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,l=e-Math.floor(e),h=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*l}}}class ka{constructor(e,l){this.property=e,this.value=l,this.expression=function(h,C){if(Hs(h))return new ea(h,C);if(ta(h)){let w=Ba(h,C);if(w.result==="error")throw new Error(w.value.map(B=>`${B.key}: ${B.message}`).join(", "));return w.value}{let w=h;return C.type==="color"&&typeof h=="string"?w=Ui.parse(h):C.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?C.type==="variableAnchorOffsetCollection"&&Array.isArray(h)&&(w=pn.parse(h)):w=Ir.parse(h),{kind:"constant",evaluate:()=>w}}}(l===void 0?e.specification.default:l,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,l,h){return this.property.possiblyEvaluate(this,e,l,h)}}class La{constructor(e){this.property=e,this.value=new ka(e,void 0)}transitioned(e,l){return new hu(this.property,this.value,l,Lt({},e.transition,this.transition),e.now)}untransitioned(){return new hu(this.property,this.value,null,{},0)}}class Xa{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Nt(this._values[e].value.value)}setValue(e,l){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new La(this._values[e].property)),this._values[e].value=new ka(this._values[e].property,l===null?void 0:Nt(l))}getTransition(e){return Nt(this._values[e].transition)}setTransition(e,l){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new La(this._values[e].property)),this._values[e].transition=Nt(l)||void 0}serialize(){let e={};for(let l of Object.keys(this._values)){let h=this.getValue(l);h!==void 0&&(e[l]=h);let C=this.getTransition(l);C!==void 0&&(e[`${l}-transition`]=C)}return e}transitioned(e,l){let h=new Dl(this._properties);for(let C of Object.keys(this._values))h._values[C]=this._values[C].transitioned(e,l._values[C]);return h}untransitioned(){let e=new Dl(this._properties);for(let l of Object.keys(this._values))e._values[l]=this._values[l].untransitioned();return e}}class hu{constructor(e,l,h,C,w){this.property=e,this.value=l,this.begin=w+C.delay||0,this.end=this.begin+C.duration||0,e.specification.transition&&(C.delay||C.duration)&&(this.prior=h)}possiblyEvaluate(e,l,h){let C=e.now||0,w=this.value.possiblyEvaluate(e,l,h),B=this.prior;if(B){if(C>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(C<this.begin)return B.possiblyEvaluate(e,l,h);{let F=(C-this.begin)/(this.end-this.begin);return this.property.interpolate(B.possiblyEvaluate(e,l,h),w,function(T){if(T<=0)return 0;if(T>=1)return 1;let Z=T*T,M=Z*T;return 4*(T<.5?M:3*(T-Z)+M-.75)}(F))}}return w}}class Dl{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,l,h){let C=new Kl(this._properties);for(let w of Object.keys(this._values))C._values[w]=this._values[w].possiblyEvaluate(e,l,h);return C}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class hl{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Nt(this._values[e].value)}setValue(e,l){this._values[e]=new ka(this._values[e].property,l===null?void 0:Nt(l))}serialize(){let e={};for(let l of Object.keys(this._values)){let h=this.getValue(l);h!==void 0&&(e[l]=h)}return e}possiblyEvaluate(e,l,h){let C=new Kl(this._properties);for(let w of Object.keys(this._values))C._values[w]=this._values[w].possiblyEvaluate(e,l,h);return C}}class Zo{constructor(e,l,h){this.property=e,this.value=l,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,l,h,C){return this.property.evaluate(this.value,this.parameters,e,l,h,C)}}class Kl{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class yi{constructor(e){this.specification=e}possiblyEvaluate(e,l){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(l)}interpolate(e,l,h){let C=ci[this.specification.type];return C?C(e,l,h):e}}class Zi{constructor(e,l){this.specification=e,this.overrides=l}possiblyEvaluate(e,l,h,C){return new Zo(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(l,null,{},h,C)}:e.expression,l)}interpolate(e,l,h){if(e.value.kind!=="constant"||l.value.kind!=="constant")return e;if(e.value.value===void 0||l.value.value===void 0)return new Zo(this,{kind:"constant",value:void 0},e.parameters);let C=ci[this.specification.type];if(C){let w=C(e.value.value,l.value.value,h);return new Zo(this,{kind:"constant",value:w},e.parameters)}return e}evaluate(e,l,h,C,w,B){return e.kind==="constant"?e.value:e.evaluate(l,h,C,w,B)}}class v extends Zi{possiblyEvaluate(e,l,h,C){if(e.value===void 0)return new Zo(this,{kind:"constant",value:void 0},l);if(e.expression.kind==="constant"){let w=e.expression.evaluate(l,null,{},h,C),B=e.property.specification.type==="resolvedImage"&&typeof w!="string"?w.name:w,F=this._calculate(B,B,B,l);return new Zo(this,{kind:"constant",value:F},l)}if(e.expression.kind==="camera"){let w=this._calculate(e.expression.evaluate({zoom:l.zoom-1}),e.expression.evaluate({zoom:l.zoom}),e.expression.evaluate({zoom:l.zoom+1}),l);return new Zo(this,{kind:"constant",value:w},l)}return new Zo(this,e.expression,l)}evaluate(e,l,h,C,w,B){if(e.kind==="source"){let F=e.evaluate(l,h,C,w,B);return this._calculate(F,F,F,l)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(l.zoom)-1},h,C),e.evaluate({zoom:Math.floor(l.zoom)},h,C),e.evaluate({zoom:Math.floor(l.zoom)+1},h,C),l):e.value}_calculate(e,l,h,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:e,to:l}:{from:h,to:l}}interpolate(e){return e}}class i{constructor(e){this.specification=e}possiblyEvaluate(e,l,h,C){if(e.value!==void 0){if(e.expression.kind==="constant"){let w=e.expression.evaluate(l,null,{},h,C);return this._calculate(w,w,w,l)}return this._calculate(e.expression.evaluate(new vr(Math.floor(l.zoom-1),l)),e.expression.evaluate(new vr(Math.floor(l.zoom),l)),e.expression.evaluate(new vr(Math.floor(l.zoom+1),l)),l)}}_calculate(e,l,h,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:e,to:l}:{from:h,to:l}}interpolate(e){return e}}class c{constructor(e){this.specification=e}possiblyEvaluate(e,l,h,C){return!!e.expression.evaluate(l,null,{},h,C)}interpolate(){return!1}}class p{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let l in e){let h=e[l];h.specification.overridable&&this.overridableProperties.push(l);let C=this.defaultPropertyValues[l]=new ka(h,void 0),w=this.defaultTransitionablePropertyValues[l]=new La(h);this.defaultTransitioningPropertyValues[l]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=C.possiblyEvaluate({})}}}Ai("DataDrivenProperty",Zi),Ai("DataConstantProperty",yi),Ai("CrossFadedDataDrivenProperty",v),Ai("CrossFadedProperty",i),Ai("ColorRampProperty",c);let m="-transition";class b extends Xe{constructor(e,l){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),l.layout&&(this._unevaluatedLayout=new hl(l.layout)),l.paint)){this._transitionablePaint=new Xa(l.paint);for(let h in e.paint)this.setPaintProperty(h,e.paint[h],{validate:!1});for(let h in e.layout)this.setLayoutProperty(h,e.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Kl(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,l,h={}){l!=null&&this._validate(wh,`layers.${this.id}.layout.${e}`,e,l,h)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,l):this.visibility=l)}getPaintProperty(e){return e.endsWith(m)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,l,h={}){if(l!=null&&this._validate(vh,`layers.${this.id}.paint.${e}`,e,l,h))return!1;if(e.endsWith(m))return this._transitionablePaint.setTransition(e.slice(0,-11),l||void 0),!1;{let C=this._transitionablePaint._values[e],w=C.property.specification["property-type"]==="cross-faded-data-driven",B=C.value.isDataDriven(),F=C.value;this._transitionablePaint.setValue(e,l),this._handleSpecialPaintPropertyUpdate(e);let T=this._transitionablePaint._values[e].value;return T.isDataDriven()||B||w||this._handleOverridablePaintPropertyUpdate(e,F,T)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,l,h){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,l){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,l)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),It(e,(l,h)=>!(l===void 0||h==="layout"&&!Object.keys(l).length||h==="paint"&&!Object.keys(l).length))}_validate(e,l,h,C,w={}){return(!w||w.validate!==!1)&&Nl(this,e.call(po,{key:l,layerType:this.type,objectKey:h,value:C,styleSpec:Kt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let l=this.paint.get(e);if(l instanceof Zo&&Ln(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}let u={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class g{constructor(e,l){this._structArray=e,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class y{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,l){return e._trim(),l&&(e.isTransferred=!0,l.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let l=Object.create(this.prototype);return l.arrayBuffer=e.arrayBuffer,l.length=e.length,l.capacity=e.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function x(a,e=1){let l=0,h=0;return{members:a.map(C=>{let w=u[C.type].BYTES_PER_ELEMENT,B=l=k(l,Math.max(e,w)),F=C.components||1;return h=Math.max(h,w),l+=w*F,{name:C.name,type:C.type,components:F,offset:B}}),size:k(l,Math.max(h,e)),alignment:e}}function k(a,e){return Math.ceil(a/e)*e}class E extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l){let h=this.length;return this.resize(h+1),this.emplace(h,e,l)}emplace(e,l,h){let C=2*e;return this.int16[C+0]=l,this.int16[C+1]=h,e}}E.prototype.bytesPerElement=4,Ai("StructArrayLayout2i4",E);class R extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,h){let C=this.length;return this.resize(C+1),this.emplace(C,e,l,h)}emplace(e,l,h,C){let w=3*e;return this.int16[w+0]=l,this.int16[w+1]=h,this.int16[w+2]=C,e}}R.prototype.bytesPerElement=6,Ai("StructArrayLayout3i6",R);class P extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,h,C){let w=this.length;return this.resize(w+1),this.emplace(w,e,l,h,C)}emplace(e,l,h,C,w){let B=4*e;return this.int16[B+0]=l,this.int16[B+1]=h,this.int16[B+2]=C,this.int16[B+3]=w,e}}P.prototype.bytesPerElement=8,Ai("StructArrayLayout4i8",P);class H extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w,B){let F=this.length;return this.resize(F+1),this.emplace(F,e,l,h,C,w,B)}emplace(e,l,h,C,w,B,F){let T=6*e;return this.int16[T+0]=l,this.int16[T+1]=h,this.int16[T+2]=C,this.int16[T+3]=w,this.int16[T+4]=B,this.int16[T+5]=F,e}}H.prototype.bytesPerElement=12,Ai("StructArrayLayout2i4i12",H);class N extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w,B){let F=this.length;return this.resize(F+1),this.emplace(F,e,l,h,C,w,B)}emplace(e,l,h,C,w,B,F){let T=4*e,Z=8*e;return this.int16[T+0]=l,this.int16[T+1]=h,this.uint8[Z+4]=C,this.uint8[Z+5]=w,this.uint8[Z+6]=B,this.uint8[Z+7]=F,e}}N.prototype.bytesPerElement=8,Ai("StructArrayLayout2i4ub8",N);class O extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l){let h=this.length;return this.resize(h+1),this.emplace(h,e,l)}emplace(e,l,h){let C=2*e;return this.float32[C+0]=l,this.float32[C+1]=h,e}}O.prototype.bytesPerElement=8,Ai("StructArrayLayout2f8",O);class et extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w,B,F,T,Z,M){let D=this.length;return this.resize(D+1),this.emplace(D,e,l,h,C,w,B,F,T,Z,M)}emplace(e,l,h,C,w,B,F,T,Z,M,D){let J=10*e;return this.uint16[J+0]=l,this.uint16[J+1]=h,this.uint16[J+2]=C,this.uint16[J+3]=w,this.uint16[J+4]=B,this.uint16[J+5]=F,this.uint16[J+6]=T,this.uint16[J+7]=Z,this.uint16[J+8]=M,this.uint16[J+9]=D,e}}et.prototype.bytesPerElement=20,Ai("StructArrayLayout10ui20",et);class nt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w,B,F,T,Z,M,D,J){let $=this.length;return this.resize($+1),this.emplace($,e,l,h,C,w,B,F,T,Z,M,D,J)}emplace(e,l,h,C,w,B,F,T,Z,M,D,J,$){let st=12*e;return this.int16[st+0]=l,this.int16[st+1]=h,this.int16[st+2]=C,this.int16[st+3]=w,this.uint16[st+4]=B,this.uint16[st+5]=F,this.uint16[st+6]=T,this.uint16[st+7]=Z,this.int16[st+8]=M,this.int16[st+9]=D,this.int16[st+10]=J,this.int16[st+11]=$,e}}nt.prototype.bytesPerElement=24,Ai("StructArrayLayout4i4ui4i24",nt);class Y extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,h){let C=this.length;return this.resize(C+1),this.emplace(C,e,l,h)}emplace(e,l,h,C){let w=3*e;return this.float32[w+0]=l,this.float32[w+1]=h,this.float32[w+2]=C,e}}Y.prototype.bytesPerElement=12,Ai("StructArrayLayout3f12",Y);class dt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let l=this.length;return this.resize(l+1),this.emplace(l,e)}emplace(e,l){return this.uint32[1*e+0]=l,e}}dt.prototype.bytesPerElement=4,Ai("StructArrayLayout1ul4",dt);class gt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w,B,F,T,Z){let M=this.length;return this.resize(M+1),this.emplace(M,e,l,h,C,w,B,F,T,Z)}emplace(e,l,h,C,w,B,F,T,Z,M){let D=10*e,J=5*e;return this.int16[D+0]=l,this.int16[D+1]=h,this.int16[D+2]=C,this.int16[D+3]=w,this.int16[D+4]=B,this.int16[D+5]=F,this.uint32[J+3]=T,this.uint16[D+8]=Z,this.uint16[D+9]=M,e}}gt.prototype.bytesPerElement=20,Ai("StructArrayLayout6i1ul2ui20",gt);class ot extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w,B){let F=this.length;return this.resize(F+1),this.emplace(F,e,l,h,C,w,B)}emplace(e,l,h,C,w,B,F){let T=6*e;return this.int16[T+0]=l,this.int16[T+1]=h,this.int16[T+2]=C,this.int16[T+3]=w,this.int16[T+4]=B,this.int16[T+5]=F,e}}ot.prototype.bytesPerElement=12,Ai("StructArrayLayout2i2i2i12",ot);class pt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w){let B=this.length;return this.resize(B+1),this.emplace(B,e,l,h,C,w)}emplace(e,l,h,C,w,B){let F=4*e,T=8*e;return this.float32[F+0]=l,this.float32[F+1]=h,this.float32[F+2]=C,this.int16[T+6]=w,this.int16[T+7]=B,e}}pt.prototype.bytesPerElement=16,Ai("StructArrayLayout2f1f2i16",pt);class Dt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w,B){let F=this.length;return this.resize(F+1),this.emplace(F,e,l,h,C,w,B)}emplace(e,l,h,C,w,B,F){let T=16*e,Z=4*e,M=8*e;return this.uint8[T+0]=l,this.uint8[T+1]=h,this.float32[Z+1]=C,this.float32[Z+2]=w,this.int16[M+6]=B,this.int16[M+7]=F,e}}Dt.prototype.bytesPerElement=16,Ai("StructArrayLayout2ub2f2i16",Dt);class $t extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,h){let C=this.length;return this.resize(C+1),this.emplace(C,e,l,h)}emplace(e,l,h,C){let w=3*e;return this.uint16[w+0]=l,this.uint16[w+1]=h,this.uint16[w+2]=C,e}}$t.prototype.bytesPerElement=6,Ai("StructArrayLayout3ui6",$t);class jt extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w,B,F,T,Z,M,D,J,$,st,ut,Ft,Gt){let Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,e,l,h,C,w,B,F,T,Z,M,D,J,$,st,ut,Ft,Gt)}emplace(e,l,h,C,w,B,F,T,Z,M,D,J,$,st,ut,Ft,Gt,Ae){let Ot=24*e,te=12*e,me=48*e;return this.int16[Ot+0]=l,this.int16[Ot+1]=h,this.uint16[Ot+2]=C,this.uint16[Ot+3]=w,this.uint32[te+2]=B,this.uint32[te+3]=F,this.uint32[te+4]=T,this.uint16[Ot+10]=Z,this.uint16[Ot+11]=M,this.uint16[Ot+12]=D,this.float32[te+7]=J,this.float32[te+8]=$,this.uint8[me+36]=st,this.uint8[me+37]=ut,this.uint8[me+38]=Ft,this.uint32[te+10]=Gt,this.int16[Ot+22]=Ae,e}}jt.prototype.bytesPerElement=48,Ai("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",jt);class ue extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,h,C,w,B,F,T,Z,M,D,J,$,st,ut,Ft,Gt,Ae,Ot,te,me,Pe,oi,Pi,ni,ei,wi,di){let li=this.length;return this.resize(li+1),this.emplace(li,e,l,h,C,w,B,F,T,Z,M,D,J,$,st,ut,Ft,Gt,Ae,Ot,te,me,Pe,oi,Pi,ni,ei,wi,di)}emplace(e,l,h,C,w,B,F,T,Z,M,D,J,$,st,ut,Ft,Gt,Ae,Ot,te,me,Pe,oi,Pi,ni,ei,wi,di,li){let Se=32*e,Si=16*e;return this.int16[Se+0]=l,this.int16[Se+1]=h,this.int16[Se+2]=C,this.int16[Se+3]=w,this.int16[Se+4]=B,this.int16[Se+5]=F,this.int16[Se+6]=T,this.int16[Se+7]=Z,this.uint16[Se+8]=M,this.uint16[Se+9]=D,this.uint16[Se+10]=J,this.uint16[Se+11]=$,this.uint16[Se+12]=st,this.uint16[Se+13]=ut,this.uint16[Se+14]=Ft,this.uint16[Se+15]=Gt,this.uint16[Se+16]=Ae,this.uint16[Se+17]=Ot,this.uint16[Se+18]=te,this.uint16[Se+19]=me,this.uint16[Se+20]=Pe,this.uint16[Se+21]=oi,this.uint16[Se+22]=Pi,this.uint32[Si+12]=ni,this.float32[Si+13]=ei,this.float32[Si+14]=wi,this.uint16[Se+30]=di,this.uint16[Se+31]=li,e}}ue.prototype.bytesPerElement=64,Ai("StructArrayLayout8i15ui1ul2f2ui64",ue);class ce extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let l=this.length;return this.resize(l+1),this.emplace(l,e)}emplace(e,l){return this.float32[1*e+0]=l,e}}ce.prototype.bytesPerElement=4,Ai("StructArrayLayout1f4",ce);class Fe extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,h){let C=this.length;return this.resize(C+1),this.emplace(C,e,l,h)}emplace(e,l,h,C){let w=3*e;return this.uint16[6*e+0]=l,this.float32[w+1]=h,this.float32[w+2]=C,e}}Fe.prototype.bytesPerElement=12,Ai("StructArrayLayout1ui2f12",Fe);class xe extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l,h){let C=this.length;return this.resize(C+1),this.emplace(C,e,l,h)}emplace(e,l,h,C){let w=4*e;return this.uint32[2*e+0]=l,this.uint16[w+2]=h,this.uint16[w+3]=C,e}}xe.prototype.bytesPerElement=8,Ai("StructArrayLayout1ul2ui8",xe);class ke extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,l){let h=this.length;return this.resize(h+1),this.emplace(h,e,l)}emplace(e,l,h){let C=2*e;return this.uint16[C+0]=l,this.uint16[C+1]=h,e}}ke.prototype.bytesPerElement=4,Ai("StructArrayLayout2ui4",ke);class Ue extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let l=this.length;return this.resize(l+1),this.emplace(l,e)}emplace(e,l){return this.uint16[1*e+0]=l,e}}Ue.prototype.bytesPerElement=2,Ai("StructArrayLayout1ui2",Ue);class $e extends y{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,l,h,C){let w=this.length;return this.resize(w+1),this.emplace(w,e,l,h,C)}emplace(e,l,h,C,w){let B=4*e;return this.float32[B+0]=l,this.float32[B+1]=h,this.float32[B+2]=C,this.float32[B+3]=w,e}}$e.prototype.bytesPerElement=16,Ai("StructArrayLayout4f16",$e);class Li extends g{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new _(this.anchorPointX,this.anchorPointY)}}Li.prototype.size=20;class pi extends gt{get(e){return new Li(this,e)}}Ai("CollisionBoxArray",pi);class bi extends g{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}bi.prototype.size=48;class Ci extends jt{get(e){return new bi(this,e)}}Ai("PlacedSymbolArray",Ci);class mr extends g{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}mr.prototype.size=64;class Jr extends ue{get(e){return new mr(this,e)}}Ai("SymbolInstanceArray",Jr);class Yi extends ce{getoffsetX(e){return this.float32[1*e+0]}}Ai("GlyphOffsetArray",Yi);class Rr extends R{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Ai("SymbolLineVertexArray",Rr);class rr extends g{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}rr.prototype.size=12;class Lr extends Fe{get(e){return new rr(this,e)}}Ai("TextAnchorOffsetArray",Lr);class Er extends g{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Er.prototype.size=8;class Tr extends xe{get(e){return new Er(this,e)}}Ai("FeatureIndexArray",Tr);class rn extends E{}class _n extends E{}class Tn extends E{}class On extends H{}class gn extends N{}class mo extends O{}class nn extends et{}class Wn extends nt{}class es extends Y{}class Gr extends dt{}class xn extends ot{}class Un extends Dt{}class yn extends $t{}class Zr extends ke{}let Po=x([{name:"a_pos",components:2,type:"Int16"}],4),{members:GA}=Po;class xr{constructor(e=[]){this.segments=e}prepareSegment(e,l,h,C){let w=this.segments[this.segments.length-1];return e>xr.MAX_VERTEX_ARRAY_LENGTH&&lt(`Max vertices per segment is ${xr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!w||w.vertexLength+e>xr.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==C)&&(w={vertexOffset:l.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},C!==void 0&&(w.sortKey=C),this.segments.push(w)),w}get(){return this.segments}destroy(){for(let e of this.segments)for(let l in e.vaos)e.vaos[l].destroy()}static simpleSegment(e,l,h,C){return new xr([{vertexOffset:e,primitiveOffset:l,vertexLength:h,primitiveLength:C,vaos:{},sortKey:0}])}}function Ya(a,e){return 256*(a=At(Math.floor(a),0,255))+At(Math.floor(e),0,255)}xr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ai("SegmentVector",xr);let ra=x([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var gl={exports:{}},Co={exports:{}};Co.exports=function(a,e){var l,h,C,w,B,F,T,Z;for(h=a.length-(l=3&a.length),C=e,B=3432918353,F=461845907,Z=0;Z<h;)T=255&a.charCodeAt(Z)|(255&a.charCodeAt(++Z))<<8|(255&a.charCodeAt(++Z))<<16|(255&a.charCodeAt(++Z))<<24,++Z,C=27492+(65535&(w=5*(65535&(C=(C^=T=(65535&(T=(T=(65535&T)*B+(((T>>>16)*B&65535)<<16)&4294967295)<<15|T>>>17))*F+(((T>>>16)*F&65535)<<16)&4294967295)<<13|C>>>19))+((5*(C>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(T=0,l){case 3:T^=(255&a.charCodeAt(Z+2))<<16;case 2:T^=(255&a.charCodeAt(Z+1))<<8;case 1:C^=T=(65535&(T=(T=(65535&(T^=255&a.charCodeAt(Z)))*B+(((T>>>16)*B&65535)<<16)&4294967295)<<15|T>>>17))*F+(((T>>>16)*F&65535)<<16)&4294967295}return C^=a.length,C=2246822507*(65535&(C^=C>>>16))+((2246822507*(C>>>16)&65535)<<16)&4294967295,C=3266489909*(65535&(C^=C>>>13))+((3266489909*(C>>>16)&65535)<<16)&4294967295,(C^=C>>>16)>>>0};var Ec=Co.exports,ZA={exports:{}};ZA.exports=function(a,e){for(var l,h=a.length,C=e^h,w=0;h>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(w)|(255&a.charCodeAt(++w))<<8|(255&a.charCodeAt(++w))<<16|(255&a.charCodeAt(++w))<<24))+((1540483477*(l>>>16)&65535)<<16),C=1540483477*(65535&C)+((1540483477*(C>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),h-=4,++w;switch(h){case 3:C^=(255&a.charCodeAt(w+2))<<16;case 2:C^=(255&a.charCodeAt(w+1))<<8;case 1:C=1540483477*(65535&(C^=255&a.charCodeAt(w)))+((1540483477*(C>>>16)&65535)<<16)}return C=1540483477*(65535&(C^=C>>>13))+((1540483477*(C>>>16)&65535)<<16),(C^=C>>>15)>>>0};var dl=Ec,PA=ZA.exports;gl.exports=dl,gl.exports.murmur3=dl,gl.exports.murmur2=PA;var Ea=d(gl.exports);class HA{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,l,h,C){this.ids.push(ed(e)),this.positions.push(l,h,C)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let l=ed(e),h=0,C=this.ids.length-1;for(;h<C;){let B=h+C>>1;this.ids[B]>=l?C=B:h=B+1}let w=[];for(;this.ids[h]===l;)w.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return w}static serialize(e,l){let h=new Float64Array(e.ids),C=new Uint32Array(e.positions);return Tc(h,C,0,h.length-1),l&&l.push(h.buffer,C.buffer),{ids:h,positions:C}}static deserialize(e){let l=new HA;return l.ids=e.ids,l.positions=e.positions,l.indexed=!0,l}}function ed(a){let e=+a;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Ea(String(a))}function Tc(a,e,l,h){for(;l<h;){let C=a[l+h>>1],w=l-1,B=h+1;for(;;){do w++;while(a[w]<C);do B--;while(a[B]>C);if(w>=B)break;na(a,w,B),na(e,3*w,3*B),na(e,3*w+1,3*B+1),na(e,3*w+2,3*B+2)}B-l<h-B?(Tc(a,e,l,B),l=B+1):(Tc(a,e,B+1,h),h=B)}}function na(a,e,l){let h=a[e];a[e]=a[l],a[l]=h}Ai("FeaturePositionMap",HA);class pl{constructor(e,l){this.gl=e.gl,this.location=l}}class gu extends pl{constructor(e,l){super(e,l),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class id extends pl{constructor(e,l){super(e,l),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class _h extends pl{constructor(e,l){super(e,l),this.current=Ui.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}let du=new Float32Array(16);function pu(a){return[Ya(255*a.r,255*a.g),Ya(255*a.b,255*a.a)]}class zl{constructor(e,l,h){this.value=e,this.uniformNames=l.map(C=>`u_${C}`),this.type=h}setUniform(e,l,h){e.set(h.constantOr(this.value))}getBinding(e,l,h){return this.type==="color"?new _h(e,l):new gu(e,l)}}class ja{constructor(e,l){this.uniformNames=l.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=e.tlbr}setUniform(e,l,h,C){let w=C==="u_pattern_to"?this.patternTo:C==="u_pattern_from"?this.patternFrom:C==="u_pixel_ratio_to"?this.pixelRatioTo:C==="u_pixel_ratio_from"?this.pixelRatioFrom:null;w&&e.set(w)}getBinding(e,l,h){return h.substr(0,9)==="u_pattern"?new id(e,l):new gu(e,l)}}class sa{constructor(e,l,h,C){this.expression=e,this.type=h,this.maxValue=0,this.paintVertexAttributes=l.map(w=>({name:`a_${w}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new C}populatePaintArray(e,l,h,C,w){let B=this.paintVertexArray.length,F=this.expression.evaluate(new vr(0),l,{},C,[],w);this.paintVertexArray.resize(e),this._setPaintValue(B,e,F)}updatePaintArray(e,l,h,C){let w=this.expression.evaluate({zoom:0},h,C);this._setPaintValue(e,l,w)}_setPaintValue(e,l,h){if(this.type==="color"){let C=pu(h);for(let w=e;w<l;w++)this.paintVertexArray.emplace(w,C[0],C[1])}else{for(let C=e;C<l;C++)this.paintVertexArray.emplace(C,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ks{constructor(e,l,h,C,w,B){this.expression=e,this.uniformNames=l.map(F=>`u_${F}_t`),this.type=h,this.useIntegerZoom=C,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=l.map(F=>({name:`a_${F}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new B}populatePaintArray(e,l,h,C,w){let B=this.expression.evaluate(new vr(this.zoom),l,{},C,[],w),F=this.expression.evaluate(new vr(this.zoom+1),l,{},C,[],w),T=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(T,e,B,F)}updatePaintArray(e,l,h,C){let w=this.expression.evaluate({zoom:this.zoom},h,C),B=this.expression.evaluate({zoom:this.zoom+1},h,C);this._setPaintValue(e,l,w,B)}_setPaintValue(e,l,h,C){if(this.type==="color"){let w=pu(h),B=pu(C);for(let F=e;F<l;F++)this.paintVertexArray.emplace(F,w[0],w[1],B[0],B[1])}else{for(let w=e;w<l;w++)this.paintVertexArray.emplace(w,h,C);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(C))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,l){let h=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,C=At(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);e.set(C)}getBinding(e,l,h){return new gu(e,l)}}class qa{constructor(e,l,h,C,w,B){this.expression=e,this.type=l,this.useIntegerZoom=h,this.zoom=C,this.layerId=B,this.zoomInPaintVertexArray=new w,this.zoomOutPaintVertexArray=new w}populatePaintArray(e,l,h){let C=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(C,e,l.patterns&&l.patterns[this.layerId],h)}updatePaintArray(e,l,h,C,w){this._setPaintValues(e,l,h.patterns&&h.patterns[this.layerId],w)}_setPaintValues(e,l,h,C){if(!C||!h)return;let{min:w,mid:B,max:F}=h,T=C[w],Z=C[B],M=C[F];if(T&&Z&&M)for(let D=e;D<l;D++)this.zoomInPaintVertexArray.emplace(D,Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],Z.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],Z.pixelRatio,M.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,ra.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,ra.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class rd{constructor(e,l,h){this.binders={},this._buffers=[];let C=[];for(let w in e.paint._values){if(!h(w))continue;let B=e.paint.get(w);if(!(B instanceof Zo&&Ln(B.property.specification)))continue;let F=nd(w,e.type),T=B.value,Z=B.property.specification.type,M=B.property.useIntegerZoom,D=B.property.specification["property-type"],J=D==="cross-faded"||D==="cross-faded-data-driven";if(T.kind==="constant")this.binders[w]=J?new ja(T.value,F):new zl(T.value,F,Z),C.push(`/u_${w}`);else if(T.kind==="source"||J){let $=fu(w,Z,"source");this.binders[w]=J?new qa(T,Z,M,l,$,e.id):new sa(T,F,Z,$),C.push(`/a_${w}`)}else{let $=fu(w,Z,"composite");this.binders[w]=new ks(T,F,Z,M,l,$),C.push(`/z_${w}`)}}this.cacheKey=C.sort().join("")}getMaxValue(e){let l=this.binders[e];return l instanceof sa||l instanceof ks?l.maxValue:0}populatePaintArrays(e,l,h,C,w){for(let B in this.binders){let F=this.binders[B];(F instanceof sa||F instanceof ks||F instanceof qa)&&F.populatePaintArray(e,l,h,C,w)}}setConstantPatternPositions(e,l){for(let h in this.binders){let C=this.binders[h];C instanceof ja&&C.setConstantPatternPositions(e,l)}}updatePaintArrays(e,l,h,C,w){let B=!1;for(let F in e){let T=l.getPositions(F);for(let Z of T){let M=h.feature(Z.index);for(let D in this.binders){let J=this.binders[D];if((J instanceof sa||J instanceof ks||J instanceof qa)&&J.expression.isStateDependent===!0){let $=C.paint.get(D);J.expression=$.value,J.updatePaintArray(Z.start,Z.end,M,e[F],w),B=!0}}}}return B}defines(){let e=[];for(let l in this.binders){let h=this.binders[l];(h instanceof zl||h instanceof ja)&&e.push(...h.uniformNames.map(C=>`#define HAS_UNIFORM_${C}`))}return e}getBinderAttributes(){let e=[];for(let l in this.binders){let h=this.binders[l];if(h instanceof sa||h instanceof ks)for(let C=0;C<h.paintVertexAttributes.length;C++)e.push(h.paintVertexAttributes[C].name);else if(h instanceof qa)for(let C=0;C<ra.members.length;C++)e.push(ra.members[C].name)}return e}getBinderUniforms(){let e=[];for(let l in this.binders){let h=this.binders[l];if(h instanceof zl||h instanceof ja||h instanceof ks)for(let C of h.uniformNames)e.push(C)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,l){let h=[];for(let C in this.binders){let w=this.binders[C];if(w instanceof zl||w instanceof ja||w instanceof ks){for(let B of w.uniformNames)if(l[B]){let F=w.getBinding(e,l[B],B);h.push({name:B,property:C,binding:F})}}}return h}setUniforms(e,l,h,C){for(let{name:w,property:B,binding:F}of l)this.binders[B].setUniform(F,C,h.get(B),w)}updatePaintBuffers(e){this._buffers=[];for(let l in this.binders){let h=this.binders[l];if(e&&h instanceof qa){let C=e.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;C&&this._buffers.push(C)}else(h instanceof sa||h instanceof ks)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(e){for(let l in this.binders){let h=this.binders[l];(h instanceof sa||h instanceof ks||h instanceof qa)&&h.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let l=this.binders[e];(l instanceof sa||l instanceof ks||l instanceof qa)&&l.destroy()}}}class Ta{constructor(e,l,h=()=>!0){this.programConfigurations={};for(let C of e)this.programConfigurations[C.id]=new rd(C,l,h);this.needsUpload=!1,this._featureMap=new HA,this._bufferOffset=0}populatePaintArrays(e,l,h,C,w,B){for(let F in this.programConfigurations)this.programConfigurations[F].populatePaintArrays(e,l,C,w,B);l.id!==void 0&&this._featureMap.add(l.id,h,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,l,h,C){for(let w of h)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(e,this._featureMap,l,w,C)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let l in this.programConfigurations)this.programConfigurations[l].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}}function nd(a,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${e}-`,"").replace(/-/g,"_")]}function fu(a,e,l){let h={color:{source:O,composite:$e},number:{source:ce,composite:O}},C=function(w){return{"line-pattern":{source:nn,composite:nn},"fill-pattern":{source:nn,composite:nn},"fill-extrusion-pattern":{source:nn,composite:nn}}[w]}(a);return C&&C[l]||h[e][l]}Ai("ConstantBinder",zl),Ai("CrossFadedConstantBinder",ja),Ai("SourceExpressionBinder",sa),Ai("CrossFadedCompositeBinder",qa),Ai("CompositeExpressionBinder",ks),Ai("ProgramConfiguration",rd,{omit:["_buffers"]}),Ai("ProgramConfigurationSet",Ta);let Pr=8192,mu=Math.pow(2,14)-1,xh=-mu-1;function fl(a){let e=Pr/a.extent,l=a.loadGeometry();for(let h=0;h<l.length;h++){let C=l[h];for(let w=0;w<C.length;w++){let B=C[w],F=Math.round(B.x*e),T=Math.round(B.y*e);B.x=At(F,xh,mu),B.y=At(T,xh,mu),(F<B.x||F>B.x+1||T<B.y||T>B.y+1)&&lt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function MA(a,e){return{type:a.type,id:a.id,properties:a.properties,geometry:e?fl(a):[]}}function $a(a,e,l,h,C){a.emplaceBack(2*e+(h+1)/2,2*l+(C+1)/2)}class Sh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new _n,this.indexArray=new yn,this.segments=new xr,this.programConfigurations=new Ta(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(e,l,h){let C=this.layers[0],w=[],B=null,F=!1;C.type==="circle"&&(B=C.layout.get("circle-sort-key"),F=!B.isConstant());for(let{feature:T,id:Z,index:M,sourceLayerIndex:D}of e){let J=this.layers[0]._featureFilter.needGeometry,$=MA(T,J);if(!this.layers[0]._featureFilter.filter(new vr(this.zoom),$,h))continue;let st=F?B.evaluate($,{},h):void 0,ut={id:Z,properties:T.properties,type:T.type,sourceLayerIndex:D,index:M,geometry:J?$.geometry:fl(T),patterns:{},sortKey:st};w.push(ut)}F&&w.sort((T,Z)=>T.sortKey-Z.sortKey);for(let T of w){let{geometry:Z,index:M,sourceLayerIndex:D}=T,J=e[M].feature;this.addFeature(T,Z,M,h),l.featureIndex.insert(J,Z,M,D,this.index)}}update(e,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,l,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,GA),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,l,h,C){for(let w of l)for(let B of w){let F=B.x,T=B.y;if(F<0||F>=Pr||T<0||T>=Pr)continue;let Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),M=Z.vertexLength;$a(this.layoutVertexArray,F,T,-1,-1),$a(this.layoutVertexArray,F,T,1,-1),$a(this.layoutVertexArray,F,T,1,1),$a(this.layoutVertexArray,F,T,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+3,M+2),Z.vertexLength+=4,Z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,{},C)}}function Fh(a,e){for(let l=0;l<a.length;l++)if(Io(e,a[l]))return!0;for(let l=0;l<e.length;l++)if(Io(a,e[l]))return!0;return!!ml(a,e)}function pm(a,e,l){return!!Io(a,e)||!!Ol(e,a,l)}function kh(a,e){if(a.length===1)return tA(e,a[0]);for(let l=0;l<e.length;l++){let h=e[l];for(let C=0;C<h.length;C++)if(Io(a,h[C]))return!0}for(let l=0;l<a.length;l++)if(tA(e,a[l]))return!0;for(let l=0;l<e.length;l++)if(ml(a,e[l]))return!0;return!1}function fm(a,e,l){if(a.length>1){if(ml(a,e))return!0;for(let h=0;h<e.length;h++)if(Ol(e[h],a,l))return!0}for(let h=0;h<a.length;h++)if(Ol(a[h],e,l))return!0;return!1}function ml(a,e){if(a.length===0||e.length===0)return!1;for(let l=0;l<a.length-1;l++){let h=a[l],C=a[l+1];for(let w=0;w<e.length-1;w++)if(Lh(h,C,e[w],e[w+1]))return!0}return!1}function Lh(a,e,l,h){return at(a,l,h)!==at(e,l,h)&&at(a,e,l)!==at(a,e,h)}function Ol(a,e,l){let h=l*l;if(e.length===1)return a.distSqr(e[0])<h;for(let C=1;C<e.length;C++)if(Ua(a,e[C-1],e[C])<h)return!0;return!1}function Ua(a,e,l){let h=e.distSqr(l);if(h===0)return a.distSqr(e);let C=((a.x-e.x)*(l.x-e.x)+(a.y-e.y)*(l.y-e.y))/h;return a.distSqr(C<0?e:C>1?l:l.sub(e)._mult(C)._add(e))}function tA(a,e){let l,h,C,w=!1;for(let B=0;B<a.length;B++){l=a[B];for(let F=0,T=l.length-1;F<l.length;T=F++)h=l[F],C=l[T],h.y>e.y!=C.y>e.y&&e.x<(C.x-h.x)*(e.y-h.y)/(C.y-h.y)+h.x&&(w=!w)}return w}function Io(a,e){let l=!1;for(let h=0,C=a.length-1;h<a.length;C=h++){let w=a[h],B=a[C];w.y>e.y!=B.y>e.y&&e.x<(B.x-w.x)*(e.y-w.y)/(B.y-w.y)+w.x&&(l=!l)}return l}function Cu(a,e,l){let h=l[0],C=l[2];if(a.x<h.x&&e.x<h.x||a.x>C.x&&e.x>C.x||a.y<h.y&&e.y<h.y||a.y>C.y&&e.y>C.y)return!1;let w=at(a,e,l[0]);return w!==at(a,e,l[1])||w!==at(a,e,l[2])||w!==at(a,e,l[3])}function Cl(a,e,l){let h=e.paint.get(a).value;return h.kind==="constant"?h.value:l.programConfigurations.get(e.id).getMaxValue(a)}function Uc(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Iu(a,e,l,h,C){if(!e[0]&&!e[1])return a;let w=_.convert(e)._mult(C);l==="viewport"&&w._rotate(-h);let B=[];for(let F=0;F<a.length;F++)B.push(a[F].sub(w));return B}let yu,bu;Ai("CircleBucket",Sh,{omit:["layers"]});var aS={get paint(){return bu=bu||new p({"circle-radius":new Zi(Kt.paint_circle["circle-radius"]),"circle-color":new Zi(Kt.paint_circle["circle-color"]),"circle-blur":new Zi(Kt.paint_circle["circle-blur"]),"circle-opacity":new Zi(Kt.paint_circle["circle-opacity"]),"circle-translate":new yi(Kt.paint_circle["circle-translate"]),"circle-translate-anchor":new yi(Kt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new yi(Kt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new yi(Kt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Zi(Kt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Zi(Kt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Zi(Kt.paint_circle["circle-stroke-opacity"])})},get layout(){return yu=yu||new p({"circle-sort-key":new Zi(Kt.layout_circle["circle-sort-key"])})}},Ks=1e-6,vu=typeof Float32Array<"u"?Float32Array:Array;function mm(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function $y(a,e,l){var h=e[0],C=e[1],w=e[2],B=e[3],F=e[4],T=e[5],Z=e[6],M=e[7],D=e[8],J=e[9],$=e[10],st=e[11],ut=e[12],Ft=e[13],Gt=e[14],Ae=e[15],Ot=l[0],te=l[1],me=l[2],Pe=l[3];return a[0]=Ot*h+te*F+me*D+Pe*ut,a[1]=Ot*C+te*T+me*J+Pe*Ft,a[2]=Ot*w+te*Z+me*$+Pe*Gt,a[3]=Ot*B+te*M+me*st+Pe*Ae,a[4]=(Ot=l[4])*h+(te=l[5])*F+(me=l[6])*D+(Pe=l[7])*ut,a[5]=Ot*C+te*T+me*J+Pe*Ft,a[6]=Ot*w+te*Z+me*$+Pe*Gt,a[7]=Ot*B+te*M+me*st+Pe*Ae,a[8]=(Ot=l[8])*h+(te=l[9])*F+(me=l[10])*D+(Pe=l[11])*ut,a[9]=Ot*C+te*T+me*J+Pe*Ft,a[10]=Ot*w+te*Z+me*$+Pe*Gt,a[11]=Ot*B+te*M+me*st+Pe*Ae,a[12]=(Ot=l[12])*h+(te=l[13])*F+(me=l[14])*D+(Pe=l[15])*ut,a[13]=Ot*C+te*T+me*J+Pe*Ft,a[14]=Ot*w+te*Z+me*$+Pe*Gt,a[15]=Ot*B+te*M+me*st+Pe*Ae,a}Math.hypot||(Math.hypot=function(){for(var a=0,e=arguments.length;e--;)a+=arguments[e]*arguments[e];return Math.sqrt(a)});var Eh,AS=$y;function sd(a,e,l){var h=e[0],C=e[1],w=e[2],B=e[3];return a[0]=l[0]*h+l[4]*C+l[8]*w+l[12]*B,a[1]=l[1]*h+l[5]*C+l[9]*w+l[13]*B,a[2]=l[2]*h+l[6]*C+l[10]*w+l[14]*B,a[3]=l[3]*h+l[7]*C+l[11]*w+l[15]*B,a}Eh=new vu(4),vu!=Float32Array&&(Eh[0]=0,Eh[1]=0,Eh[2]=0,Eh[3]=0);class lS extends b{constructor(e){super(e,aS)}createBucket(e){return new Sh(e)}queryRadius(e){let l=e;return Cl("circle-radius",this,l)+Cl("circle-stroke-width",this,l)+Uc(this.paint.get("circle-translate"))}queryIntersectsFeature(e,l,h,C,w,B,F,T){let Z=Iu(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),B.angle,F),M=this.paint.get("circle-radius").evaluate(l,h)+this.paint.get("circle-stroke-width").evaluate(l,h),D=this.paint.get("circle-pitch-alignment")==="map",J=D?Z:function(st,ut){return st.map(Ft=>t1(Ft,ut))}(Z,T),$=D?M*F:M;for(let st of C)for(let ut of st){let Ft=D?ut:t1(ut,T),Gt=$,Ae=sd([],[ut.x,ut.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Gt*=Ae[3]/B.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Gt*=B.cameraToCenterDistance/Ae[3]),pm(J,Ft,Gt))return!0}return!1}}function t1(a,e){let l=sd([],[a.x,a.y,0,1],e);return new _(l[0]/l[3],l[1]/l[3])}class e1 extends Sh{}let i1;Ai("HeatmapBucket",e1,{omit:["layers"]});var cS={get paint(){return i1=i1||new p({"heatmap-radius":new Zi(Kt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Zi(Kt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new yi(Kt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new c(Kt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new yi(Kt.paint_heatmap["heatmap-opacity"])})}};function Cm(a,{width:e,height:l},h,C){if(C){if(C instanceof Uint8ClampedArray)C=new Uint8Array(C.buffer);else if(C.length!==e*l*h)throw new RangeError(`mismatched image size. expected: ${C.length} but got: ${e*l*h}`)}else C=new Uint8Array(e*l*h);return a.width=e,a.height=l,a.data=C,a}function r1(a,{width:e,height:l},h){if(e===a.width&&l===a.height)return;let C=Cm({},{width:e,height:l},h);Im(a,C,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,e),height:Math.min(a.height,l)},h),a.width=e,a.height=l,a.data=C.data}function Im(a,e,l,h,C,w){if(C.width===0||C.height===0)return e;if(C.width>a.width||C.height>a.height||l.x>a.width-C.width||l.y>a.height-C.height)throw new RangeError("out of range source coordinates for image copy");if(C.width>e.width||C.height>e.height||h.x>e.width-C.width||h.y>e.height-C.height)throw new RangeError("out of range destination coordinates for image copy");let B=a.data,F=e.data;if(B===F)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<C.height;T++){let Z=((l.y+T)*a.width+l.x)*w,M=((h.y+T)*e.width+h.x)*w;for(let D=0;D<C.width*w;D++)F[M+D]=B[Z+D]}return e}class Th{constructor(e,l){Cm(this,e,1,l)}resize(e){r1(this,e,1)}clone(){return new Th({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,l,h,C,w){Im(e,l,h,C,w,1)}}class oa{constructor(e,l){Cm(this,e,4,l)}resize(e){r1(this,e,4)}replace(e,l){l?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new oa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,l,h,C,w){Im(e,l,h,C,w,4)}}function n1(a){let e={},l=a.resolution||256,h=a.clips?a.clips.length:1,C=a.image||new oa({width:l,height:h});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);let w=(B,F,T)=>{e[a.evaluationKey]=T;let Z=a.expression.evaluate(e);C.data[B+F+0]=Math.floor(255*Z.r/Z.a),C.data[B+F+1]=Math.floor(255*Z.g/Z.a),C.data[B+F+2]=Math.floor(255*Z.b/Z.a),C.data[B+F+3]=Math.floor(255*Z.a)};if(a.clips)for(let B=0,F=0;B<h;++B,F+=4*l)for(let T=0,Z=0;T<l;T++,Z+=4){let M=T/(l-1),{start:D,end:J}=a.clips[B];w(F,Z,D*(1-M)+J*M)}else for(let B=0,F=0;B<l;B++,F+=4)w(0,F,B/(l-1));return C}Ai("AlphaImage",Th),Ai("RGBAImage",oa);class uS extends b{createBucket(e){return new e1(e)}constructor(e){super(e,cS),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=n1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let s1;var hS={get paint(){return s1=s1||new p({"hillshade-illumination-direction":new yi(Kt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new yi(Kt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new yi(Kt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new yi(Kt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new yi(Kt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new yi(Kt.paint_hillshade["hillshade-accent-color"])})}};class gS extends b{constructor(e){super(e,hS)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let dS=x([{name:"a_pos",components:2,type:"Int16"}],4),{members:pS}=dS;function o1(a,e,l=2){let h=e&&e.length,C=h?e[0]*l:a.length,w=a1(a,0,C,l,!0),B=[];if(!w||w.next===w.prev)return B;let F,T,Z;if(h&&(w=function(M,D,J,$){let st=[];for(let ut=0,Ft=D.length;ut<Ft;ut++){let Gt=a1(M,D[ut]*$,ut<Ft-1?D[ut+1]*$:M.length,$,!1);Gt===Gt.next&&(Gt.steiner=!0),st.push(wS(Gt))}st.sort(yS);for(let ut=0;ut<st.length;ut++)J=bS(st[ut],J);return J}(a,e,w,l)),a.length>80*l){F=1/0,T=1/0;let M=-1/0,D=-1/0;for(let J=l;J<C;J+=l){let $=a[J],st=a[J+1];$<F&&(F=$),st<T&&(T=st),$>M&&(M=$),st>D&&(D=st)}Z=Math.max(M-F,D-T),Z=Z!==0?32767/Z:0}return Uh(w,B,l,F,T,Z,0),B}function a1(a,e,l,h,C){let w;if(C===function(B,F,T,Z){let M=0;for(let D=F,J=T-Z;D<T;D+=Z)M+=(B[J]-B[D])*(B[D+1]+B[J+1]),J=D;return M}(a,e,l,h)>0)for(let B=e;B<l;B+=h)w=c1(B/h|0,a[B],a[B+1],w);else for(let B=l-h;B>=e;B-=h)w=c1(B/h|0,a[B],a[B+1],w);return w&&od(w,w.next)&&(Rh(w),w=w.next),w}function Qc(a,e){if(!a)return a;e||(e=a);let l,h=a;do if(l=!1,h.steiner||!od(h,h.next)&&bn(h.prev,h,h.next)!==0)h=h.next;else{if(Rh(h),h=e=h.prev,h===h.next)break;l=!0}while(l||h!==e);return e}function Uh(a,e,l,h,C,w,B){if(!a)return;!B&&w&&function(T,Z,M,D){let J=T;do J.z===0&&(J.z=ym(J.x,J.y,Z,M,D)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==T);J.prevZ.nextZ=null,J.prevZ=null,function($){let st,ut=1;do{let Ft,Gt=$;$=null;let Ae=null;for(st=0;Gt;){st++;let Ot=Gt,te=0;for(let Pe=0;Pe<ut&&(te++,Ot=Ot.nextZ,Ot);Pe++);let me=ut;for(;te>0||me>0&&Ot;)te!==0&&(me===0||!Ot||Gt.z<=Ot.z)?(Ft=Gt,Gt=Gt.nextZ,te--):(Ft=Ot,Ot=Ot.nextZ,me--),Ae?Ae.nextZ=Ft:$=Ft,Ft.prevZ=Ae,Ae=Ft;Gt=Ot}Ae.nextZ=null,ut*=2}while(st>1)}(J)}(a,h,C,w);let F=a;for(;a.prev!==a.next;){let T=a.prev,Z=a.next;if(w?mS(a,h,C,w):fS(a))e.push(T.i,a.i,Z.i),Rh(a),a=Z.next,F=Z.next;else if((a=Z)===F){B?B===1?Uh(a=CS(Qc(a),e),e,l,h,C,w,2):B===2&&IS(a,e,l,h,C,w):Uh(Qc(a),e,l,h,C,w,1);break}}}function fS(a){let e=a.prev,l=a,h=a.next;if(bn(e,l,h)>=0)return!1;let C=e.x,w=l.x,B=h.x,F=e.y,T=l.y,Z=h.y,M=C<w?C<B?C:B:w<B?w:B,D=F<T?F<Z?F:Z:T<Z?T:Z,J=C>w?C>B?C:B:w>B?w:B,$=F>T?F>Z?F:Z:T>Z?T:Z,st=h.next;for(;st!==e;){if(st.x>=M&&st.x<=J&&st.y>=D&&st.y<=$&&wu(C,F,w,T,B,Z,st.x,st.y)&&bn(st.prev,st,st.next)>=0)return!1;st=st.next}return!0}function mS(a,e,l,h){let C=a.prev,w=a,B=a.next;if(bn(C,w,B)>=0)return!1;let F=C.x,T=w.x,Z=B.x,M=C.y,D=w.y,J=B.y,$=F<T?F<Z?F:Z:T<Z?T:Z,st=M<D?M<J?M:J:D<J?D:J,ut=F>T?F>Z?F:Z:T>Z?T:Z,Ft=M>D?M>J?M:J:D>J?D:J,Gt=ym($,st,e,l,h),Ae=ym(ut,Ft,e,l,h),Ot=a.prevZ,te=a.nextZ;for(;Ot&&Ot.z>=Gt&&te&&te.z<=Ae;){if(Ot.x>=$&&Ot.x<=ut&&Ot.y>=st&&Ot.y<=Ft&&Ot!==C&&Ot!==B&&wu(F,M,T,D,Z,J,Ot.x,Ot.y)&&bn(Ot.prev,Ot,Ot.next)>=0||(Ot=Ot.prevZ,te.x>=$&&te.x<=ut&&te.y>=st&&te.y<=Ft&&te!==C&&te!==B&&wu(F,M,T,D,Z,J,te.x,te.y)&&bn(te.prev,te,te.next)>=0))return!1;te=te.nextZ}for(;Ot&&Ot.z>=Gt;){if(Ot.x>=$&&Ot.x<=ut&&Ot.y>=st&&Ot.y<=Ft&&Ot!==C&&Ot!==B&&wu(F,M,T,D,Z,J,Ot.x,Ot.y)&&bn(Ot.prev,Ot,Ot.next)>=0)return!1;Ot=Ot.prevZ}for(;te&&te.z<=Ae;){if(te.x>=$&&te.x<=ut&&te.y>=st&&te.y<=Ft&&te!==C&&te!==B&&wu(F,M,T,D,Z,J,te.x,te.y)&&bn(te.prev,te,te.next)>=0)return!1;te=te.nextZ}return!0}function CS(a,e){let l=a;do{let h=l.prev,C=l.next.next;!od(h,C)&&A1(h,l,l.next,C)&&Qh(h,C)&&Qh(C,h)&&(e.push(h.i,l.i,C.i),Rh(l),Rh(l.next),l=a=C),l=l.next}while(l!==a);return Qc(l)}function IS(a,e,l,h,C,w){let B=a;do{let F=B.next.next;for(;F!==B.prev;){if(B.i!==F.i&&BS(B,F)){let T=l1(B,F);return B=Qc(B,B.next),T=Qc(T,T.next),Uh(B,e,l,h,C,w,0),void Uh(T,e,l,h,C,w,0)}F=F.next}B=B.next}while(B!==a)}function yS(a,e){return a.x-e.x}function bS(a,e){let l=function(C,w){let B=w,F=C.x,T=C.y,Z,M=-1/0;do{if(T<=B.y&&T>=B.next.y&&B.next.y!==B.y){let ut=B.x+(T-B.y)*(B.next.x-B.x)/(B.next.y-B.y);if(ut<=F&&ut>M&&(M=ut,Z=B.x<B.next.x?B:B.next,ut===F))return Z}B=B.next}while(B!==w);if(!Z)return null;let D=Z,J=Z.x,$=Z.y,st=1/0;B=Z;do{if(F>=B.x&&B.x>=J&&F!==B.x&&wu(T<$?F:M,T,J,$,T<$?M:F,T,B.x,B.y)){let ut=Math.abs(T-B.y)/(F-B.x);Qh(B,C)&&(ut<st||ut===st&&(B.x>Z.x||B.x===Z.x&&vS(Z,B)))&&(Z=B,st=ut)}B=B.next}while(B!==D);return Z}(a,e);if(!l)return e;let h=l1(l,a);return Qc(h,h.next),Qc(l,l.next)}function vS(a,e){return bn(a.prev,a,e.prev)<0&&bn(e.next,a,a.next)<0}function ym(a,e,l,h,C){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*C|0)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-h)*C|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wS(a){let e=a,l=a;do(e.x<l.x||e.x===l.x&&e.y<l.y)&&(l=e),e=e.next;while(e!==a);return l}function wu(a,e,l,h,C,w,B,F){return(C-B)*(e-F)>=(a-B)*(w-F)&&(a-B)*(h-F)>=(l-B)*(e-F)&&(l-B)*(w-F)>=(C-B)*(h-F)}function BS(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!function(l,h){let C=l;do{if(C.i!==l.i&&C.next.i!==l.i&&C.i!==h.i&&C.next.i!==h.i&&A1(C,C.next,l,h))return!0;C=C.next}while(C!==l);return!1}(a,e)&&(Qh(a,e)&&Qh(e,a)&&function(l,h){let C=l,w=!1,B=(l.x+h.x)/2,F=(l.y+h.y)/2;do C.y>F!=C.next.y>F&&C.next.y!==C.y&&B<(C.next.x-C.x)*(F-C.y)/(C.next.y-C.y)+C.x&&(w=!w),C=C.next;while(C!==l);return w}(a,e)&&(bn(a.prev,a,e.prev)||bn(a,e.prev,e))||od(a,e)&&bn(a.prev,a,a.next)>0&&bn(e.prev,e,e.next)>0)}function bn(a,e,l){return(e.y-a.y)*(l.x-e.x)-(e.x-a.x)*(l.y-e.y)}function od(a,e){return a.x===e.x&&a.y===e.y}function A1(a,e,l,h){let C=Ad(bn(a,e,l)),w=Ad(bn(a,e,h)),B=Ad(bn(l,h,a)),F=Ad(bn(l,h,e));return C!==w&&B!==F||!(C!==0||!ad(a,l,e))||!(w!==0||!ad(a,h,e))||!(B!==0||!ad(l,a,h))||!(F!==0||!ad(l,e,h))}function ad(a,e,l){return e.x<=Math.max(a.x,l.x)&&e.x>=Math.min(a.x,l.x)&&e.y<=Math.max(a.y,l.y)&&e.y>=Math.min(a.y,l.y)}function Ad(a){return a>0?1:a<0?-1:0}function Qh(a,e){return bn(a.prev,a,a.next)<0?bn(a,e,a.next)>=0&&bn(a,a.prev,e)>=0:bn(a,e,a.prev)<0||bn(a,a.next,e)<0}function l1(a,e){let l=bm(a.i,a.x,a.y),h=bm(e.i,e.x,e.y),C=a.next,w=e.prev;return a.next=e,e.prev=a,l.next=C,C.prev=l,h.next=l,l.prev=h,w.next=h,h.prev=w,h}function c1(a,e,l,h){let C=bm(a,e,l);return h?(C.next=h.next,C.prev=h,h.next.prev=C,h.next=C):(C.prev=C,C.next=C),C}function Rh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function bm(a,e,l){return{i:a,x:e,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function vm(a,e,l){let h=l.patternDependencies,C=!1;for(let w of e){let B=w.paint.get(`${a}-pattern`);B.isConstant()||(C=!0);let F=B.constantOr(null);F&&(C=!0,h[F.to]=!0,h[F.from]=!0)}return C}function wm(a,e,l,h,C){let w=C.patternDependencies;for(let B of e){let F=B.paint.get(`${a}-pattern`).value;if(F.kind!=="constant"){let T=F.evaluate({zoom:h-1},l,{},C.availableImages),Z=F.evaluate({zoom:h},l,{},C.availableImages),M=F.evaluate({zoom:h+1},l,{},C.availableImages);T=T&&T.name?T.name:T,Z=Z&&Z.name?Z.name:Z,M=M&&M.name?M.name:M,w[T]=!0,w[Z]=!0,w[M]=!0,l.patterns[B.id]={min:T,mid:Z,max:M}}}return l}class Bm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Tn,this.indexArray=new yn,this.indexArray2=new Zr,this.programConfigurations=new Ta(e.layers,e.zoom),this.segments=new xr,this.segments2=new xr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(e,l,h){this.hasPattern=vm("fill",this.layers,l);let C=this.layers[0].layout.get("fill-sort-key"),w=!C.isConstant(),B=[];for(let{feature:F,id:T,index:Z,sourceLayerIndex:M}of e){let D=this.layers[0]._featureFilter.needGeometry,J=MA(F,D);if(!this.layers[0]._featureFilter.filter(new vr(this.zoom),J,h))continue;let $=w?C.evaluate(J,{},h,l.availableImages):void 0,st={id:T,properties:F.properties,type:F.type,sourceLayerIndex:M,index:Z,geometry:D?J.geometry:fl(F),patterns:{},sortKey:$};B.push(st)}w&&B.sort((F,T)=>F.sortKey-T.sortKey);for(let F of B){let{geometry:T,index:Z,sourceLayerIndex:M}=F;if(this.hasPattern){let D=wm("fill",this.layers,F,this.zoom,l);this.patternFeatures.push(D)}else this.addFeature(F,T,Z,h,{});l.featureIndex.insert(e[Z].feature,T,Z,M,this.index)}}update(e,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,l,this.stateDependentLayers,h)}addFeatures(e,l,h){for(let C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,pS),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,l,h,C,w){for(let B of Xo(l,500)){let F=0;for(let $ of B)F+=$.length;let T=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray),Z=T.vertexLength,M=[],D=[];for(let $ of B){if($.length===0)continue;$!==B[0]&&D.push(M.length/2);let st=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),ut=st.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(ut+$.length-1,ut),M.push($[0].x),M.push($[0].y);for(let Ft=1;Ft<$.length;Ft++)this.layoutVertexArray.emplaceBack($[Ft].x,$[Ft].y),this.indexArray2.emplaceBack(ut+Ft-1,ut+Ft),M.push($[Ft].x),M.push($[Ft].y);st.vertexLength+=$.length,st.primitiveLength+=$.length}let J=o1(M,D);for(let $=0;$<J.length;$+=3)this.indexArray.emplaceBack(Z+J[$],Z+J[$+1],Z+J[$+2]);T.vertexLength+=F,T.primitiveLength+=J.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,w,C)}}let u1,h1;Ai("FillBucket",Bm,{omit:["layers","patternFeatures"]});var _S={get paint(){return h1=h1||new p({"fill-antialias":new yi(Kt.paint_fill["fill-antialias"]),"fill-opacity":new Zi(Kt.paint_fill["fill-opacity"]),"fill-color":new Zi(Kt.paint_fill["fill-color"]),"fill-outline-color":new Zi(Kt.paint_fill["fill-outline-color"]),"fill-translate":new yi(Kt.paint_fill["fill-translate"]),"fill-translate-anchor":new yi(Kt.paint_fill["fill-translate-anchor"]),"fill-pattern":new v(Kt.paint_fill["fill-pattern"])})},get layout(){return u1=u1||new p({"fill-sort-key":new Zi(Kt.layout_fill["fill-sort-key"])})}};class xS extends b{constructor(e){super(e,_S)}recalculate(e,l){super.recalculate(e,l);let h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Bm(e)}queryRadius(){return Uc(this.paint.get("fill-translate"))}queryIntersectsFeature(e,l,h,C,w,B,F){return kh(Iu(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),B.angle,F),C)}isTileClipped(){return!0}}let SS=x([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),FS=x([{name:"a_centroid",components:2,type:"Int16"}],4),{members:kS}=SS;var Wl={},LS=f,g1=Bu;function Bu(a,e,l,h,C){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=h,this._values=C,a.readFields(ES,this,e)}function ES(a,e,l){a==1?e.id=l.readVarint():a==2?function(h,C){for(var w=h.readVarint()+h.pos;h.pos<w;){var B=C._keys[h.readVarint()],F=C._values[h.readVarint()];C.properties[B]=F}}(l,e):a==3?e.type=l.readVarint():a==4&&(e._geometry=l.pos)}function TS(a){for(var e,l,h=0,C=0,w=a.length,B=w-1;C<w;B=C++)h+=((l=a[B]).x-(e=a[C]).x)*(e.y+l.y);return h}Bu.types=["Unknown","Point","LineString","Polygon"],Bu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var e,l=a.readVarint()+a.pos,h=1,C=0,w=0,B=0,F=[];a.pos<l;){if(C<=0){var T=a.readVarint();h=7&T,C=T>>3}if(C--,h===1||h===2)w+=a.readSVarint(),B+=a.readSVarint(),h===1&&(e&&F.push(e),e=[]),e.push(new LS(w,B));else{if(h!==7)throw new Error("unknown command "+h);e&&e.push(e[0].clone())}}return e&&F.push(e),F},Bu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var e=a.readVarint()+a.pos,l=1,h=0,C=0,w=0,B=1/0,F=-1/0,T=1/0,Z=-1/0;a.pos<e;){if(h<=0){var M=a.readVarint();l=7&M,h=M>>3}if(h--,l===1||l===2)(C+=a.readSVarint())<B&&(B=C),C>F&&(F=C),(w+=a.readSVarint())<T&&(T=w),w>Z&&(Z=w);else if(l!==7)throw new Error("unknown command "+l)}return[B,T,F,Z]},Bu.prototype.toGeoJSON=function(a,e,l){var h,C,w=this.extent*Math.pow(2,l),B=this.extent*a,F=this.extent*e,T=this.loadGeometry(),Z=Bu.types[this.type];function M($){for(var st=0;st<$.length;st++){var ut=$[st];$[st]=[360*(ut.x+B)/w-180,360/Math.PI*Math.atan(Math.exp((180-360*(ut.y+F)/w)*Math.PI/180))-90]}}switch(this.type){case 1:var D=[];for(h=0;h<T.length;h++)D[h]=T[h][0];M(T=D);break;case 2:for(h=0;h<T.length;h++)M(T[h]);break;case 3:for(T=function($){var st=$.length;if(st<=1)return[$];for(var ut,Ft,Gt=[],Ae=0;Ae<st;Ae++){var Ot=TS($[Ae]);Ot!==0&&(Ft===void 0&&(Ft=Ot<0),Ft===Ot<0?(ut&&Gt.push(ut),ut=[$[Ae]]):ut.push($[Ae]))}return ut&&Gt.push(ut),Gt}(T),h=0;h<T.length;h++)for(C=0;C<T[h].length;C++)M(T[h][C])}T.length===1?T=T[0]:Z="Multi"+Z;var J={type:"Feature",geometry:{type:Z,coordinates:T},properties:this.properties};return"id"in this&&(J.id=this.id),J};var US=g1,d1=p1;function p1(a,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(QS,this,e),this.length=this._features.length}function QS(a,e,l){a===15?e.version=l.readVarint():a===1?e.name=l.readString():a===5?e.extent=l.readVarint():a===2?e._features.push(l.pos):a===3?e._keys.push(l.readString()):a===4&&e._values.push(function(h){for(var C=null,w=h.readVarint()+h.pos;h.pos<w;){var B=h.readVarint()>>3;C=B===1?h.readString():B===2?h.readFloat():B===3?h.readDouble():B===4?h.readVarint64():B===5?h.readVarint():B===6?h.readSVarint():B===7?h.readBoolean():null}return C}(l))}p1.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var e=this._pbf.readVarint()+this._pbf.pos;return new US(this._pbf,e,this.extent,this._keys,this._values)};var RS=d1;function GS(a,e,l){if(a===3){var h=new RS(l,l.readVarint()+l.pos);h.length&&(e[h.name]=h)}}Wl.VectorTile=function(a,e){this.layers=a.readFields(GS,{},e)},Wl.VectorTileFeature=g1,Wl.VectorTileLayer=d1;let ZS=Wl.VectorTileFeature.types,_m=Math.pow(2,13);function Gh(a,e,l,h,C,w,B,F){a.emplaceBack(e,l,2*Math.floor(h*_m)+B,C*_m*2,w*_m*2,Math.round(F))}class xm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new On,this.centroidVertexArray=new rn,this.indexArray=new yn,this.programConfigurations=new Ta(e.layers,e.zoom),this.segments=new xr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(e,l,h){this.features=[],this.hasPattern=vm("fill-extrusion",this.layers,l);for(let{feature:C,id:w,index:B,sourceLayerIndex:F}of e){let T=this.layers[0]._featureFilter.needGeometry,Z=MA(C,T);if(!this.layers[0]._featureFilter.filter(new vr(this.zoom),Z,h))continue;let M={id:w,sourceLayerIndex:F,index:B,geometry:T?Z.geometry:fl(C),properties:C.properties,type:C.type,patterns:{}};this.hasPattern?this.features.push(wm("fill-extrusion",this.layers,M,this.zoom,l)):this.addFeature(M,M.geometry,B,h,{}),l.featureIndex.insert(C,M.geometry,B,F,this.index,!0)}}addFeatures(e,l,h){for(let C of this.features){let{geometry:w}=C;this.addFeature(C,w,C.index,l,h)}}update(e,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,l,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kS),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,FS.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,l,h,C,w){for(let B of Xo(l,500)){let F={x:0,y:0,vertexCount:0},T=0;for(let st of B)T+=st.length;let Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let st of B){if(st.length===0||HS(st))continue;let ut=0;for(let Ft=0;Ft<st.length;Ft++){let Gt=st[Ft];if(Ft>=1){let Ae=st[Ft-1];if(!PS(Gt,Ae)){Z.vertexLength+4>xr.MAX_VERTEX_ARRAY_LENGTH&&(Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let Ot=Gt.sub(Ae)._perp()._unit(),te=Ae.dist(Gt);ut+te>32768&&(ut=0),Gh(this.layoutVertexArray,Gt.x,Gt.y,Ot.x,Ot.y,0,0,ut),Gh(this.layoutVertexArray,Gt.x,Gt.y,Ot.x,Ot.y,0,1,ut),F.x+=2*Gt.x,F.y+=2*Gt.y,F.vertexCount+=2,ut+=te,Gh(this.layoutVertexArray,Ae.x,Ae.y,Ot.x,Ot.y,0,0,ut),Gh(this.layoutVertexArray,Ae.x,Ae.y,Ot.x,Ot.y,0,1,ut),F.x+=2*Ae.x,F.y+=2*Ae.y,F.vertexCount+=2;let me=Z.vertexLength;this.indexArray.emplaceBack(me,me+2,me+1),this.indexArray.emplaceBack(me+1,me+2,me+3),Z.vertexLength+=4,Z.primitiveLength+=2}}}}if(Z.vertexLength+T>xr.MAX_VERTEX_ARRAY_LENGTH&&(Z=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),ZS[e.type]!=="Polygon")continue;let M=[],D=[],J=Z.vertexLength;for(let st of B)if(st.length!==0){st!==B[0]&&D.push(M.length/2);for(let ut=0;ut<st.length;ut++){let Ft=st[ut];Gh(this.layoutVertexArray,Ft.x,Ft.y,0,0,1,1,0),F.x+=Ft.x,F.y+=Ft.y,F.vertexCount+=1,M.push(Ft.x),M.push(Ft.y)}}let $=o1(M,D);for(let st=0;st<$.length;st+=3)this.indexArray.emplaceBack(J+$[st],J+$[st+2],J+$[st+1]);Z.primitiveLength+=$.length/3,Z.vertexLength+=T;for(let st=0;st<F.vertexCount;st++){let ut=Math.floor(F.x/F.vertexCount),Ft=Math.floor(F.y/F.vertexCount);this.centroidVertexArray.emplaceBack(ut,Ft)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,w,C)}}function PS(a,e){return a.x===e.x&&(a.x<0||a.x>Pr)||a.y===e.y&&(a.y<0||a.y>Pr)}function HS(a){return a.every(e=>e.x<0)||a.every(e=>e.x>Pr)||a.every(e=>e.y<0)||a.every(e=>e.y>Pr)}let f1;Ai("FillExtrusionBucket",xm,{omit:["layers","features"]});var MS={get paint(){return f1=f1||new p({"fill-extrusion-opacity":new yi(Kt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Zi(Kt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new yi(Kt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new yi(Kt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new v(Kt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Zi(Kt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Zi(Kt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new yi(Kt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class NS extends b{constructor(e){super(e,MS)}createBucket(e){return new xm(e)}queryRadius(){return Uc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,l,h,C,w,B,F,T){let Z=Iu(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),B.angle,F),M=this.paint.get("fill-extrusion-height").evaluate(l,h),D=this.paint.get("fill-extrusion-base").evaluate(l,h),J=function(st,ut,Ft,Gt){let Ae=[];for(let Ot of st){let te=[Ot.x,Ot.y,0,1];sd(te,te,ut),Ae.push(new _(te[0]/te[3],te[1]/te[3]))}return Ae}(Z,T),$=function(st,ut,Ft,Gt){let Ae=[],Ot=[],te=Gt[8]*ut,me=Gt[9]*ut,Pe=Gt[10]*ut,oi=Gt[11]*ut,Pi=Gt[8]*Ft,ni=Gt[9]*Ft,ei=Gt[10]*Ft,wi=Gt[11]*Ft;for(let di of st){let li=[],Se=[];for(let Si of di){let vi=Si.x,Oi=Si.y,Dr=Gt[0]*vi+Gt[4]*Oi+Gt[12],Mr=Gt[1]*vi+Gt[5]*Oi+Gt[13],Jn=Gt[2]*vi+Gt[6]*Oi+Gt[14],Qa=Gt[3]*vi+Gt[7]*Oi+Gt[15],us=Jn+Pe,fn=Qa+oi,zs=Dr+Pi,Os=Mr+ni,Ws=Jn+ei,mn=Qa+wi,Xn=new _((Dr+te)/fn,(Mr+me)/fn);Xn.z=us/fn,li.push(Xn);let Ls=new _(zs/mn,Os/mn);Ls.z=Ws/mn,Se.push(Ls)}Ae.push(li),Ot.push(Se)}return[Ae,Ot]}(C,D,M,T);return function(st,ut,Ft){let Gt=1/0;kh(Ft,ut)&&(Gt=m1(Ft,ut[0]));for(let Ae=0;Ae<ut.length;Ae++){let Ot=ut[Ae],te=st[Ae];for(let me=0;me<Ot.length-1;me++){let Pe=Ot[me],oi=[Pe,Ot[me+1],te[me+1],te[me],Pe];Fh(Ft,oi)&&(Gt=Math.min(Gt,m1(Ft,oi)))}}return Gt!==1/0&&Gt}($[0],$[1],J)}}function Zh(a,e){return a.x*e.x+a.y*e.y}function m1(a,e){if(a.length===1){let l=0,h=e[l++],C;for(;!C||h.equals(C);)if(C=e[l++],!C)return 1/0;for(;l<e.length;l++){let w=e[l],B=a[0],F=C.sub(h),T=w.sub(h),Z=B.sub(h),M=Zh(F,F),D=Zh(F,T),J=Zh(T,T),$=Zh(Z,F),st=Zh(Z,T),ut=M*J-D*D,Ft=(J*$-D*st)/ut,Gt=(M*st-D*$)/ut,Ae=h.z*(1-Ft-Gt)+C.z*Ft+w.z*Gt;if(isFinite(Ae))return Ae}return 1/0}{let l=1/0;for(let h of e)l=Math.min(l,h.z);return l}}let VS=x([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:DS}=VS,KS=x([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:zS}=KS,OS=Wl.VectorTileFeature.types,WS=Math.cos(Math.PI/180*37.5),C1=Math.pow(2,14)/.5;class Sm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(l=>l.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new gn,this.layoutVertexArray2=new mo,this.indexArray=new yn,this.programConfigurations=new Ta(e.layers,e.zoom),this.segments=new xr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(e,l,h){this.hasPattern=vm("line",this.layers,l);let C=this.layers[0].layout.get("line-sort-key"),w=!C.isConstant(),B=[];for(let{feature:F,id:T,index:Z,sourceLayerIndex:M}of e){let D=this.layers[0]._featureFilter.needGeometry,J=MA(F,D);if(!this.layers[0]._featureFilter.filter(new vr(this.zoom),J,h))continue;let $=w?C.evaluate(J,{},h):void 0,st={id:T,properties:F.properties,type:F.type,sourceLayerIndex:M,index:Z,geometry:D?J.geometry:fl(F),patterns:{},sortKey:$};B.push(st)}w&&B.sort((F,T)=>F.sortKey-T.sortKey);for(let F of B){let{geometry:T,index:Z,sourceLayerIndex:M}=F;if(this.hasPattern){let D=wm("line",this.layers,F,this.zoom,l);this.patternFeatures.push(D)}else this.addFeature(F,T,Z,h,{});l.featureIndex.insert(e[Z].feature,T,Z,M,this.index)}}update(e,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,l,this.stateDependentLayers,h)}addFeatures(e,l,h){for(let C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,zS)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,DS),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,l,h,C,w){let B=this.layers[0].layout,F=B.get("line-join").evaluate(e,{}),T=B.get("line-cap"),Z=B.get("line-miter-limit"),M=B.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let D of l)this.addLine(D,e,F,T,Z,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,h,w,C)}addLine(e,l,h,C,w,B){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Gt=0;Gt<e.length-1;Gt++)this.totalDistance+=e[Gt].dist(e[Gt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let F=OS[l.type]==="Polygon",T=e.length;for(;T>=2&&e[T-1].equals(e[T-2]);)T--;let Z=0;for(;Z<T-1&&e[Z].equals(e[Z+1]);)Z++;if(T<(F?3:2))return;h==="bevel"&&(w=1.05);let M=this.overscaling<=16?15*Pr/(512*this.overscaling):0,D=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray),J,$,st,ut,Ft;this.e1=this.e2=-1,F&&(J=e[T-2],Ft=e[Z].sub(J)._unit()._perp());for(let Gt=Z;Gt<T;Gt++){if(st=Gt===T-1?F?e[Z+1]:void 0:e[Gt+1],st&&e[Gt].equals(st))continue;Ft&&(ut=Ft),J&&($=J),J=e[Gt],Ft=st?st.sub(J)._unit()._perp():ut,ut=ut||Ft;let Ae=ut.add(Ft);Ae.x===0&&Ae.y===0||Ae._unit();let Ot=ut.x*Ft.x+ut.y*Ft.y,te=Ae.x*Ft.x+Ae.y*Ft.y,me=te!==0?1/te:1/0,Pe=2*Math.sqrt(2-2*te),oi=te<WS&&$&&st,Pi=ut.x*Ft.y-ut.y*Ft.x>0;if(oi&&Gt>Z){let wi=J.dist($);if(wi>2*M){let di=J.sub(J.sub($)._mult(M/wi)._round());this.updateDistance($,di),this.addCurrentVertex(di,ut,0,0,D),$=di}}let ni=$&&st,ei=ni?h:F?"butt":C;if(ni&&ei==="round"&&(me<B?ei="miter":me<=2&&(ei="fakeround")),ei==="miter"&&me>w&&(ei="bevel"),ei==="bevel"&&(me>2&&(ei="flipbevel"),me<w&&(ei="miter")),$&&this.updateDistance($,J),ei==="miter")Ae._mult(me),this.addCurrentVertex(J,Ae,0,0,D);else if(ei==="flipbevel"){if(me>100)Ae=Ft.mult(-1);else{let wi=me*ut.add(Ft).mag()/ut.sub(Ft).mag();Ae._perp()._mult(wi*(Pi?-1:1))}this.addCurrentVertex(J,Ae,0,0,D),this.addCurrentVertex(J,Ae.mult(-1),0,0,D)}else if(ei==="bevel"||ei==="fakeround"){let wi=-Math.sqrt(me*me-1),di=Pi?wi:0,li=Pi?0:wi;if($&&this.addCurrentVertex(J,ut,di,li,D),ei==="fakeround"){let Se=Math.round(180*Pe/Math.PI/20);for(let Si=1;Si<Se;Si++){let vi=Si/Se;if(vi!==.5){let Dr=vi-.5;vi+=vi*Dr*(vi-1)*((1.0904+Ot*(Ot*(3.55645-1.43519*Ot)-3.2452))*Dr*Dr+(.848013+Ot*(.215638*Ot-1.06021)))}let Oi=Ft.sub(ut)._mult(vi)._add(ut)._unit()._mult(Pi?-1:1);this.addHalfVertex(J,Oi.x,Oi.y,!1,Pi,0,D)}}st&&this.addCurrentVertex(J,Ft,-di,-li,D)}else if(ei==="butt")this.addCurrentVertex(J,Ae,0,0,D);else if(ei==="square"){let wi=$?1:-1;this.addCurrentVertex(J,Ae,wi,wi,D)}else ei==="round"&&($&&(this.addCurrentVertex(J,ut,0,0,D),this.addCurrentVertex(J,ut,1,1,D,!0)),st&&(this.addCurrentVertex(J,Ft,-1,-1,D,!0),this.addCurrentVertex(J,Ft,0,0,D)));if(oi&&Gt<T-1){let wi=J.dist(st);if(wi>2*M){let di=J.add(st.sub(J)._mult(M/wi)._round());this.updateDistance(J,di),this.addCurrentVertex(di,Ft,0,0,D),J=di}}}}addCurrentVertex(e,l,h,C,w,B=!1){let F=l.y*C-l.x,T=-l.y-l.x*C;this.addHalfVertex(e,l.x+l.y*h,l.y-l.x*h,B,!1,h,w),this.addHalfVertex(e,F,T,B,!0,-C,w),this.distance>C1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,l,h,C,w,B))}addHalfVertex({x:e,y:l},h,C,w,B,F,T){let Z=.5*(this.lineClips?this.scaledDistance*(C1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(w?1:0),(l<<1)+(B?1:0),Math.round(63*h)+128,Math.round(63*C)+128,1+(F===0?0:F<0?-1:1)|(63&Z)<<2,Z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let M=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),T.primitiveLength++),B?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,l){this.distance+=e.dist(l),this.updateScaledDistance()}}let I1,y1;Ai("LineBucket",Sm,{omit:["layers","patternFeatures"]});var b1={get paint(){return y1=y1||new p({"line-opacity":new Zi(Kt.paint_line["line-opacity"]),"line-color":new Zi(Kt.paint_line["line-color"]),"line-translate":new yi(Kt.paint_line["line-translate"]),"line-translate-anchor":new yi(Kt.paint_line["line-translate-anchor"]),"line-width":new Zi(Kt.paint_line["line-width"]),"line-gap-width":new Zi(Kt.paint_line["line-gap-width"]),"line-offset":new Zi(Kt.paint_line["line-offset"]),"line-blur":new Zi(Kt.paint_line["line-blur"]),"line-dasharray":new i(Kt.paint_line["line-dasharray"]),"line-pattern":new v(Kt.paint_line["line-pattern"]),"line-gradient":new c(Kt.paint_line["line-gradient"])})},get layout(){return I1=I1||new p({"line-cap":new yi(Kt.layout_line["line-cap"]),"line-join":new Zi(Kt.layout_line["line-join"]),"line-miter-limit":new yi(Kt.layout_line["line-miter-limit"]),"line-round-limit":new yi(Kt.layout_line["line-round-limit"]),"line-sort-key":new Zi(Kt.layout_line["line-sort-key"])})}};class JS extends Zi{possiblyEvaluate(e,l){return l=new vr(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(e,l)}evaluate(e,l,h,C){return l=Lt({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(e,l,h,C)}}let ld;class XS extends b{constructor(e){super(e,b1),this.gradientVersion=0,ld||(ld=new JS(b1.paint.properties["line-width"].specification),ld.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let l=this.gradientExpression();this.stepInterpolant=!!function(h){return h._styleExpression!==void 0}(l)&&l._styleExpression.expression instanceof ve,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,l){super.recalculate(e,l),this.paint._values["line-floorwidth"]=ld.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Sm(e)}queryRadius(e){let l=e,h=v1(Cl("line-width",this,l),Cl("line-gap-width",this,l)),C=Cl("line-offset",this,l);return h/2+Math.abs(C)+Uc(this.paint.get("line-translate"))}queryIntersectsFeature(e,l,h,C,w,B,F){let T=Iu(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),B.angle,F),Z=F/2*v1(this.paint.get("line-width").evaluate(l,h),this.paint.get("line-gap-width").evaluate(l,h)),M=this.paint.get("line-offset").evaluate(l,h);return M&&(C=function(D,J){let $=[];for(let st=0;st<D.length;st++){let ut=D[st],Ft=[];for(let Gt=0;Gt<ut.length;Gt++){let Ae=ut[Gt-1],Ot=ut[Gt],te=ut[Gt+1],me=Gt===0?new _(0,0):Ot.sub(Ae)._unit()._perp(),Pe=Gt===ut.length-1?new _(0,0):te.sub(Ot)._unit()._perp(),oi=me._add(Pe)._unit(),Pi=oi.x*Pe.x+oi.y*Pe.y;Pi!==0&&oi._mult(1/Pi),Ft.push(oi._mult(J)._add(Ot))}$.push(Ft)}return $}(C,M*F)),function(D,J,$){for(let st=0;st<J.length;st++){let ut=J[st];if(D.length>=3){for(let Ft=0;Ft<ut.length;Ft++)if(Io(D,ut[Ft]))return!0}if(fm(D,ut,$))return!0}return!1}(T,C,Z)}isTileClipped(){return!0}}function v1(a,e){return e>0?e+2*a:a}let YS=x([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),jS=x([{name:"a_projected_pos",components:3,type:"Float32"}],4);x([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let qS=x([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);x([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let w1=x([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$S=x([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function tF(a,e,l){return a.sections.forEach(h=>{h.text=function(C,w,B){let F=w.layout.get("text-transform").evaluate(B,{});return F==="uppercase"?C=C.toLocaleUpperCase():F==="lowercase"&&(C=C.toLocaleLowerCase()),fo.applyArabicShaping&&(C=fo.applyArabicShaping(C)),C}(h.text,e,l)}),a}x([{name:"triangle",components:3,type:"Uint16"}]),x([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),x([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),x([{type:"Float32",name:"offsetX"}]),x([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),x([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let Ph={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var Qn=24,B1=Hr,_1=function(a,e,l,h,C){var w,B,F=8*C-h-1,T=(1<<F)-1,Z=T>>1,M=-7,D=l?C-1:0,J=l?-1:1,$=a[e+D];for(D+=J,w=$&(1<<-M)-1,$>>=-M,M+=F;M>0;w=256*w+a[e+D],D+=J,M-=8);for(B=w&(1<<-M)-1,w>>=-M,M+=h;M>0;B=256*B+a[e+D],D+=J,M-=8);if(w===0)w=1-Z;else{if(w===T)return B?NaN:1/0*($?-1:1);B+=Math.pow(2,h),w-=Z}return($?-1:1)*B*Math.pow(2,w-h)},x1=function(a,e,l,h,C,w){var B,F,T,Z=8*w-C-1,M=(1<<Z)-1,D=M>>1,J=C===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=h?0:w-1,st=h?1:-1,ut=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(F=isNaN(e)?1:0,B=M):(B=Math.floor(Math.log(e)/Math.LN2),e*(T=Math.pow(2,-B))<1&&(B--,T*=2),(e+=B+D>=1?J/T:J*Math.pow(2,1-D))*T>=2&&(B++,T/=2),B+D>=M?(F=0,B=M):B+D>=1?(F=(e*T-1)*Math.pow(2,C),B+=D):(F=e*Math.pow(2,D-1)*Math.pow(2,C),B=0));C>=8;a[l+$]=255&F,$+=st,F/=256,C-=8);for(B=B<<C|F,Z+=C;Z>0;a[l+$]=255&B,$+=st,B/=256,Z-=8);a[l+$-st]|=128*ut};function Hr(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Hr.Varint=0,Hr.Fixed64=1,Hr.Bytes=2,Hr.Fixed32=5;var Fm=4294967296,S1=1/Fm,F1=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Il(a){return a.type===Hr.Bytes?a.readVarint()+a.pos:a.pos+1}function _u(a,e,l){return l?4294967296*e+(a>>>0):4294967296*(e>>>0)+(a>>>0)}function k1(a,e,l){var h=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));l.realloc(h);for(var C=l.pos-1;C>=a;C--)l.buf[C+h]=l.buf[C]}function eF(a,e){for(var l=0;l<a.length;l++)e.writeVarint(a[l])}function iF(a,e){for(var l=0;l<a.length;l++)e.writeSVarint(a[l])}function rF(a,e){for(var l=0;l<a.length;l++)e.writeFloat(a[l])}function nF(a,e){for(var l=0;l<a.length;l++)e.writeDouble(a[l])}function sF(a,e){for(var l=0;l<a.length;l++)e.writeBoolean(a[l])}function oF(a,e){for(var l=0;l<a.length;l++)e.writeFixed32(a[l])}function aF(a,e){for(var l=0;l<a.length;l++)e.writeSFixed32(a[l])}function AF(a,e){for(var l=0;l<a.length;l++)e.writeFixed64(a[l])}function lF(a,e){for(var l=0;l<a.length;l++)e.writeSFixed64(a[l])}function cd(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+16777216*a[e+3]}function xu(a,e,l){a[l]=e,a[l+1]=e>>>8,a[l+2]=e>>>16,a[l+3]=e>>>24}function L1(a,e){return(a[e]|a[e+1]<<8|a[e+2]<<16)+(a[e+3]<<24)}Hr.prototype={destroy:function(){this.buf=null},readFields:function(a,e,l){for(l=l||this.length;this.pos<l;){var h=this.readVarint(),C=h>>3,w=this.pos;this.type=7&h,a(C,e,this),this.pos===w&&this.skip(h)}return e},readMessage:function(a,e){return this.readFields(a,e,this.readVarint()+this.pos)},readFixed32:function(){var a=cd(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=L1(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=cd(this.buf,this.pos)+cd(this.buf,this.pos+4)*Fm;return this.pos+=8,a},readSFixed64:function(){var a=cd(this.buf,this.pos)+L1(this.buf,this.pos+4)*Fm;return this.pos+=8,a},readFloat:function(){var a=_1(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=_1(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var e,l,h=this.buf;return e=127&(l=h[this.pos++]),l<128?e:(e|=(127&(l=h[this.pos++]))<<7,l<128?e:(e|=(127&(l=h[this.pos++]))<<14,l<128?e:(e|=(127&(l=h[this.pos++]))<<21,l<128?e:function(C,w,B){var F,T,Z=B.buf;if(F=(112&(T=Z[B.pos++]))>>4,T<128||(F|=(127&(T=Z[B.pos++]))<<3,T<128)||(F|=(127&(T=Z[B.pos++]))<<10,T<128)||(F|=(127&(T=Z[B.pos++]))<<17,T<128)||(F|=(127&(T=Z[B.pos++]))<<24,T<128)||(F|=(1&(T=Z[B.pos++]))<<31,T<128))return _u(C,F,w);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(l=h[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,e=this.pos;return this.pos=a,a-e>=12&&F1?function(l,h,C){return F1.decode(l.subarray(h,C))}(this.buf,e,a):function(l,h,C){for(var w="",B=h;B<C;){var F,T,Z,M=l[B],D=null,J=M>239?4:M>223?3:M>191?2:1;if(B+J>C)break;J===1?M<128&&(D=M):J===2?(192&(F=l[B+1]))==128&&(D=(31&M)<<6|63&F)<=127&&(D=null):J===3?(T=l[B+2],(192&(F=l[B+1]))==128&&(192&T)==128&&((D=(15&M)<<12|(63&F)<<6|63&T)<=2047||D>=55296&&D<=57343)&&(D=null)):J===4&&(T=l[B+2],Z=l[B+3],(192&(F=l[B+1]))==128&&(192&T)==128&&(192&Z)==128&&((D=(15&M)<<18|(63&F)<<12|(63&T)<<6|63&Z)<=65535||D>=1114112)&&(D=null)),D===null?(D=65533,J=1):D>65535&&(D-=65536,w+=String.fromCharCode(D>>>10&1023|55296),D=56320|1023&D),w+=String.fromCharCode(D),B+=J}return w}(this.buf,e,a)},readBytes:function(){var a=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,a);return this.pos=a,e},readPackedVarint:function(a,e){if(this.type!==Hr.Bytes)return a.push(this.readVarint(e));var l=Il(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(e));return a},readPackedSVarint:function(a){if(this.type!==Hr.Bytes)return a.push(this.readSVarint());var e=Il(this);for(a=a||[];this.pos<e;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Hr.Bytes)return a.push(this.readBoolean());var e=Il(this);for(a=a||[];this.pos<e;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Hr.Bytes)return a.push(this.readFloat());var e=Il(this);for(a=a||[];this.pos<e;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Hr.Bytes)return a.push(this.readDouble());var e=Il(this);for(a=a||[];this.pos<e;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Hr.Bytes)return a.push(this.readFixed32());var e=Il(this);for(a=a||[];this.pos<e;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Hr.Bytes)return a.push(this.readSFixed32());var e=Il(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Hr.Bytes)return a.push(this.readFixed64());var e=Il(this);for(a=a||[];this.pos<e;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Hr.Bytes)return a.push(this.readSFixed64());var e=Il(this);for(a=a||[];this.pos<e;)a.push(this.readSFixed64());return a},skip:function(a){var e=7&a;if(e===Hr.Varint)for(;this.buf[this.pos++]>127;);else if(e===Hr.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Hr.Fixed32)this.pos+=4;else{if(e!==Hr.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(a,e){this.writeVarint(a<<3|e)},realloc:function(a){for(var e=this.length||16;e<this.pos+a;)e*=2;if(e!==this.length){var l=new Uint8Array(e);l.set(this.buf),this.buf=l,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),xu(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),xu(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),xu(this.buf,-1&a,this.pos),xu(this.buf,Math.floor(a*S1),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),xu(this.buf,-1&a,this.pos),xu(this.buf,Math.floor(a*S1),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(e,l){var h,C;if(e>=0?(h=e%4294967296|0,C=e/4294967296|0):(C=~(-e/4294967296),4294967295^(h=~(-e%4294967296))?h=h+1|0:(h=0,C=C+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(w,B,F){F.buf[F.pos++]=127&w|128,w>>>=7,F.buf[F.pos++]=127&w|128,w>>>=7,F.buf[F.pos++]=127&w|128,w>>>=7,F.buf[F.pos++]=127&w|128,F.buf[F.pos]=127&(w>>>=7)}(h,0,l),function(w,B){var F=(7&w)<<4;B.buf[B.pos++]|=F|((w>>>=3)?128:0),w&&(B.buf[B.pos++]=127&w|((w>>>=7)?128:0),w&&(B.buf[B.pos++]=127&w|((w>>>=7)?128:0),w&&(B.buf[B.pos++]=127&w|((w>>>=7)?128:0),w&&(B.buf[B.pos++]=127&w|((w>>>=7)?128:0),w&&(B.buf[B.pos++]=127&w)))))}(C,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var e=this.pos;this.pos=function(h,C,w){for(var B,F,T=0;T<C.length;T++){if((B=C.charCodeAt(T))>55295&&B<57344){if(!F){B>56319||T+1===C.length?(h[w++]=239,h[w++]=191,h[w++]=189):F=B;continue}if(B<56320){h[w++]=239,h[w++]=191,h[w++]=189,F=B;continue}B=F-55296<<10|B-56320|65536,F=null}else F&&(h[w++]=239,h[w++]=191,h[w++]=189,F=null);B<128?h[w++]=B:(B<2048?h[w++]=B>>6|192:(B<65536?h[w++]=B>>12|224:(h[w++]=B>>18|240,h[w++]=B>>12&63|128),h[w++]=B>>6&63|128),h[w++]=63&B|128)}return w}(this.buf,a,this.pos);var l=this.pos-e;l>=128&&k1(e,l,this),this.pos=e-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),x1(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),x1(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var e=a.length;this.writeVarint(e),this.realloc(e);for(var l=0;l<e;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,e){this.pos++;var l=this.pos;a(e,this);var h=this.pos-l;h>=128&&k1(l,h,this),this.pos=l-1,this.writeVarint(h),this.pos+=h},writeMessage:function(a,e,l){this.writeTag(a,Hr.Bytes),this.writeRawMessage(e,l)},writePackedVarint:function(a,e){e.length&&this.writeMessage(a,eF,e)},writePackedSVarint:function(a,e){e.length&&this.writeMessage(a,iF,e)},writePackedBoolean:function(a,e){e.length&&this.writeMessage(a,sF,e)},writePackedFloat:function(a,e){e.length&&this.writeMessage(a,rF,e)},writePackedDouble:function(a,e){e.length&&this.writeMessage(a,nF,e)},writePackedFixed32:function(a,e){e.length&&this.writeMessage(a,oF,e)},writePackedSFixed32:function(a,e){e.length&&this.writeMessage(a,aF,e)},writePackedFixed64:function(a,e){e.length&&this.writeMessage(a,AF,e)},writePackedSFixed64:function(a,e){e.length&&this.writeMessage(a,lF,e)},writeBytesField:function(a,e){this.writeTag(a,Hr.Bytes),this.writeBytes(e)},writeFixed32Field:function(a,e){this.writeTag(a,Hr.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(a,e){this.writeTag(a,Hr.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(a,e){this.writeTag(a,Hr.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(a,e){this.writeTag(a,Hr.Fixed64),this.writeSFixed64(e)},writeVarintField:function(a,e){this.writeTag(a,Hr.Varint),this.writeVarint(e)},writeSVarintField:function(a,e){this.writeTag(a,Hr.Varint),this.writeSVarint(e)},writeStringField:function(a,e){this.writeTag(a,Hr.Bytes),this.writeString(e)},writeFloatField:function(a,e){this.writeTag(a,Hr.Fixed32),this.writeFloat(e)},writeDoubleField:function(a,e){this.writeTag(a,Hr.Fixed64),this.writeDouble(e)},writeBooleanField:function(a,e){this.writeVarintField(a,Boolean(e))}};var km=d(B1);let Lm=3;function cF(a,e,l){a===1&&l.readMessage(uF,e)}function uF(a,e,l){if(a===3){let{id:h,bitmap:C,width:w,height:B,left:F,top:T,advance:Z}=l.readMessage(hF,{});e.push({id:h,bitmap:new Th({width:w+2*Lm,height:B+2*Lm},C),metrics:{width:w,height:B,left:F,top:T,advance:Z}})}}function hF(a,e,l){a===1?e.id=l.readVarint():a===2?e.bitmap=l.readBytes():a===3?e.width=l.readVarint():a===4?e.height=l.readVarint():a===5?e.left=l.readSVarint():a===6?e.top=l.readSVarint():a===7&&(e.advance=l.readVarint())}let E1=Lm;function T1(a){let e=0,l=0;for(let B of a)e+=B.w*B.h,l=Math.max(l,B.w);a.sort((B,F)=>F.h-B.h);let h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),l),h:1/0}],C=0,w=0;for(let B of a)for(let F=h.length-1;F>=0;F--){let T=h[F];if(!(B.w>T.w||B.h>T.h)){if(B.x=T.x,B.y=T.y,w=Math.max(w,B.y+B.h),C=Math.max(C,B.x+B.w),B.w===T.w&&B.h===T.h){let Z=h.pop();F<h.length&&(h[F]=Z)}else B.h===T.h?(T.x+=B.w,T.w-=B.w):B.w===T.w?(T.y+=B.h,T.h-=B.h):(h.push({x:T.x+B.w,y:T.y,w:T.w-B.w,h:B.h}),T.y+=B.h,T.h-=B.h);break}}return{w:C,h:w,fill:e/(C*w)||0}}let yo=1;class Em{constructor(e,{pixelRatio:l,version:h,stretchX:C,stretchY:w,content:B,textFitWidth:F,textFitHeight:T}){this.paddedRect=e,this.pixelRatio=l,this.stretchX=C,this.stretchY=w,this.content=B,this.version=h,this.textFitWidth=F,this.textFitHeight=T}get tl(){return[this.paddedRect.x+yo,this.paddedRect.y+yo]}get br(){return[this.paddedRect.x+this.paddedRect.w-yo,this.paddedRect.y+this.paddedRect.h-yo]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*yo)/this.pixelRatio,(this.paddedRect.h-2*yo)/this.pixelRatio]}}class U1{constructor(e,l){let h={},C={};this.haveRenderCallbacks=[];let w=[];this.addImages(e,h,w),this.addImages(l,C,w);let{w:B,h:F}=T1(w),T=new oa({width:B||1,height:F||1});for(let Z in e){let M=e[Z],D=h[Z].paddedRect;oa.copy(M.data,T,{x:0,y:0},{x:D.x+yo,y:D.y+yo},M.data)}for(let Z in l){let M=l[Z],D=C[Z].paddedRect,J=D.x+yo,$=D.y+yo,st=M.data.width,ut=M.data.height;oa.copy(M.data,T,{x:0,y:0},{x:J,y:$},M.data),oa.copy(M.data,T,{x:0,y:ut-1},{x:J,y:$-1},{width:st,height:1}),oa.copy(M.data,T,{x:0,y:0},{x:J,y:$+ut},{width:st,height:1}),oa.copy(M.data,T,{x:st-1,y:0},{x:J-1,y:$},{width:1,height:ut}),oa.copy(M.data,T,{x:0,y:0},{x:J+st,y:$},{width:1,height:ut})}this.image=T,this.iconPositions=h,this.patternPositions=C}addImages(e,l,h){for(let C in e){let w=e[C],B={x:0,y:0,w:w.data.width+2*yo,h:w.data.height+2*yo};h.push(B),l[C]=new Em(B,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(C)}}patchUpdatedImages(e,l){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let h in e.updatedImages)this.patchUpdatedImage(this.iconPositions[h],e.getImage(h),l),this.patchUpdatedImage(this.patternPositions[h],e.getImage(h),l)}patchUpdatedImage(e,l,h){if(!e||!l||e.version===l.version)return;e.version=l.version;let[C,w]=e.tl;h.update(l.data,void 0,{x:C,y:w})}}var Jl;Ai("ImagePosition",Em),Ai("ImageAtlas",U1),A.ai=void 0,(Jl=A.ai||(A.ai={}))[Jl.none=0]="none",Jl[Jl.horizontal=1]="horizontal",Jl[Jl.vertical=2]="vertical",Jl[Jl.horizontalOnly=3]="horizontalOnly";let Hh=-17;class Mh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,l){let h=new Mh;return h.scale=e||1,h.fontStack=l,h}static forImage(e){let l=new Mh;return l.imageName=e,l}}class Su{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,l){let h=new Su;for(let C=0;C<e.sections.length;C++){let w=e.sections[C];w.image?h.addImageSection(w):h.addTextSection(w,l)}return h}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let l="";for(let h=0;h<e.length;h++){let C=e.charCodeAt(h+1)||null,w=e.charCodeAt(h-1)||null;l+=C&&Fc(C)&&!Ph[e[h+1]]||w&&Fc(w)&&!Ph[e[h-1]]||!Ph[e[h]]?e[h]:Ph[e[h]]}return l}(this.text)}trim(){let e=0;for(let h=0;h<this.text.length&&hd[this.text.charCodeAt(h)];h++)e++;let l=this.text.length;for(let h=this.text.length-1;h>=0&&h>=e&&hd[this.text.charCodeAt(h)];h--)l--;this.text=this.text.substring(e,l),this.sectionIndex=this.sectionIndex.slice(e,l)}substring(e,l){let h=new Su;return h.text=this.text.substring(e,l),h.sectionIndex=this.sectionIndex.slice(e,l),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,l)=>Math.max(e,this.sections[l].scale),0)}addTextSection(e,l){this.text+=e.text,this.sections.push(Mh.forText(e.scale,e.fontStack||l));let h=this.sections.length-1;for(let C=0;C<e.text.length;++C)this.sectionIndex.push(h)}addImageSection(e){let l=e.image?e.image.name:"";if(l.length===0)return void lt("Can't add FormattedSection with an empty image.");let h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(Mh.forImage(l)),this.sectionIndex.push(this.sections.length-1)):lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ud(a,e,l,h,C,w,B,F,T,Z,M,D,J,$,st){let ut=Su.fromFeature(a,C),Ft;D===A.ai.vertical&&ut.verticalizePunctuation();let{processBidirectionalText:Gt,processStyledBidirectionalText:Ae}=fo;if(Gt&&ut.sections.length===1){Ft=[];let me=Gt(ut.toString(),Tm(ut,Z,w,e,h,$));for(let Pe of me){let oi=new Su;oi.text=Pe,oi.sections=ut.sections;for(let Pi=0;Pi<Pe.length;Pi++)oi.sectionIndex.push(0);Ft.push(oi)}}else if(Ae){Ft=[];let me=Ae(ut.text,ut.sectionIndex,Tm(ut,Z,w,e,h,$));for(let Pe of me){let oi=new Su;oi.text=Pe[0],oi.sectionIndex=Pe[1],oi.sections=ut.sections,Ft.push(oi)}}else Ft=function(me,Pe){let oi=[],Pi=me.text,ni=0;for(let ei of Pe)oi.push(me.substring(ni,ei)),ni=ei;return ni<Pi.length&&oi.push(me.substring(ni,Pi.length)),oi}(ut,Tm(ut,Z,w,e,h,$));let Ot=[],te={positionedLines:Ot,text:ut.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:D,iconsInText:!1,verticalizable:!1};return function(me,Pe,oi,Pi,ni,ei,wi,di,li,Se,Si,vi){let Oi=0,Dr=Hh,Mr=0,Jn=0,Qa=di==="right"?1:di==="left"?0:.5,us=0;for(let mn of ni){mn.trim();let Xn=mn.getMaxScale(),Ls=(Xn-1)*Qn,hs={positionedGlyphs:[],lineOffset:0};me.positionedLines[us]=hs;let Js=hs.positionedGlyphs,gs=0;if(!mn.length()){Dr+=ei,++us;continue}for(let bo=0;bo<mn.length();bo++){let Cr=mn.getSection(bo),zr=mn.getSectionIndex(bo),Xr=mn.getCharCode(bo),Ho=0,dn=null,Eu=null,VA=null,DA=Qn,Ra=!(li===A.ai.horizontal||!Si&&!Vl(Xr)||Si&&(hd[Xr]||(fn=Xr,qe.Arabic(fn)||qe["Arabic Supplement"](fn)||qe["Arabic Extended-A"](fn)||qe["Arabic Presentation Forms-A"](fn)||qe["Arabic Presentation Forms-B"](fn))));if(Cr.imageName){let la=Pi[Cr.imageName];if(!la)continue;VA=Cr.imageName,me.iconsInText=me.iconsInText||!0,Eu=la.paddedRect;let is=la.displaySize;Cr.scale=Cr.scale*Qn/vi,dn={width:is[0],height:is[1],left:yo,top:-E1,advance:Ra?is[1]:is[0]},Ho=Ls+(Qn-is[1]*Cr.scale),DA=dn.advance;let yl=Ra?is[0]*Cr.scale-Qn*Xn:is[1]*Cr.scale-Qn*Xn;yl>0&&yl>gs&&(gs=yl)}else{let la=oi[Cr.fontStack],is=la&&la[Xr];if(is&&is.rect)Eu=is.rect,dn=is.metrics;else{let yl=Pe[Cr.fontStack],zh=yl&&yl[Xr];if(!zh)continue;dn=zh.metrics}Ho=(Xn-Cr.scale)*Qn}Ra?(me.verticalizable=!0,Js.push({glyph:Xr,imageName:VA,x:Oi,y:Dr+Ho,vertical:Ra,scale:Cr.scale,fontStack:Cr.fontStack,sectionIndex:zr,metrics:dn,rect:Eu}),Oi+=DA*Cr.scale+Se):(Js.push({glyph:Xr,imageName:VA,x:Oi,y:Dr+Ho,vertical:Ra,scale:Cr.scale,fontStack:Cr.fontStack,sectionIndex:zr,metrics:dn,rect:Eu}),Oi+=dn.advance*Cr.scale+Se)}Js.length!==0&&(Mr=Math.max(Oi-Se,Mr),fF(Js,0,Js.length-1,Qa,gs)),Oi=0;let Aa=ei*Xn+gs;hs.lineOffset=Math.max(gs,Ls),Dr+=Aa,Jn=Math.max(Aa,Jn),++us}var fn;let zs=Dr-Hh,{horizontalAlign:Os,verticalAlign:Ws}=Um(wi);(function(mn,Xn,Ls,hs,Js,gs,Aa,bo,Cr){let zr=(Xn-Ls)*Js,Xr=0;Xr=gs!==Aa?-bo*hs-Hh:(-hs*Cr+.5)*Aa;for(let Ho of mn)for(let dn of Ho.positionedGlyphs)dn.x+=zr,dn.y+=Xr})(me.positionedLines,Qa,Os,Ws,Mr,Jn,ei,zs,ni.length),me.top+=-Ws*zs,me.bottom=me.top+zs,me.left+=-Os*Mr,me.right=me.left+Mr}(te,e,l,h,Ft,B,F,T,D,Z,J,st),!function(me){for(let Pe of me)if(Pe.positionedGlyphs.length!==0)return!1;return!0}(Ot)&&te}let hd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},gF={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},dF={40:!0};function Q1(a,e,l,h,C,w){if(e.imageName){let B=h[e.imageName];return B?B.displaySize[0]*e.scale*Qn/w+C:0}{let B=l[e.fontStack],F=B&&B[a];return F?F.metrics.advance*e.scale+C:0}}function R1(a,e,l,h){let C=Math.pow(a-e,2);return h?a<e?C/2:2*C:C+Math.abs(l)*l}function pF(a,e,l){let h=0;return a===10&&(h-=1e4),l&&(h+=150),a!==40&&a!==65288||(h+=50),e!==41&&e!==65289||(h+=50),h}function G1(a,e,l,h,C,w){let B=null,F=R1(e,l,C,w);for(let T of h){let Z=R1(e-T.x,l,C,w)+T.badness;Z<=F&&(B=T,F=Z)}return{index:a,x:e,priorBreak:B,badness:F}}function Z1(a){return a?Z1(a.priorBreak).concat(a.index):[]}function Tm(a,e,l,h,C,w){if(!a)return[];let B=[],F=function(D,J,$,st,ut,Ft){let Gt=0;for(let Ae=0;Ae<D.length();Ae++){let Ot=D.getSection(Ae);Gt+=Q1(D.getCharCode(Ae),Ot,st,ut,J,Ft)}return Gt/Math.max(1,Math.ceil(Gt/$))}(a,e,l,h,C,w),T=a.text.indexOf("\u200B")>=0,Z=0;for(let D=0;D<a.length();D++){let J=a.getSection(D),$=a.getCharCode(D);if(hd[$]||(Z+=Q1($,J,h,C,e,w)),D<a.length()-1){let st=!((M=$)<11904||!(qe["Bopomofo Extended"](M)||qe.Bopomofo(M)||qe["CJK Compatibility Forms"](M)||qe["CJK Compatibility Ideographs"](M)||qe["CJK Compatibility"](M)||qe["CJK Radicals Supplement"](M)||qe["CJK Strokes"](M)||qe["CJK Symbols and Punctuation"](M)||qe["CJK Unified Ideographs Extension A"](M)||qe["CJK Unified Ideographs"](M)||qe["Enclosed CJK Letters and Months"](M)||qe["Halfwidth and Fullwidth Forms"](M)||qe.Hiragana(M)||qe["Ideographic Description Characters"](M)||qe["Kangxi Radicals"](M)||qe["Katakana Phonetic Extensions"](M)||qe.Katakana(M)||qe["Vertical Forms"](M)||qe["Yi Radicals"](M)||qe["Yi Syllables"](M)));(gF[$]||st||J.imageName||D!==a.length()-2&&dF[a.getCharCode(D+1)])&&B.push(G1(D+1,Z,F,B,pF($,a.getCharCode(D+1),st&&T),!1))}}var M;return Z1(G1(a.length(),Z,F,B,0,!0))}function Um(a){let e=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:e,verticalAlign:l}}function fF(a,e,l,h,C){if(!h&&!C)return;let w=a[l],B=(a[l].x+w.metrics.advance*w.scale)*h;for(let F=e;F<=l;F++)a[F].x-=B,a[F].y+=C}function mF(a,e,l){let{horizontalAlign:h,verticalAlign:C}=Um(l),w=e[0]-a.displaySize[0]*h,B=e[1]-a.displaySize[1]*C;return{image:a,top:B,bottom:B+a.displaySize[1],left:w,right:w+a.displaySize[0]}}function P1(a){var e,l;let h=a.left,C=a.top,w=a.right-h,B=a.bottom-C,F=(e=a.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",T=(l=a.image.textFitHeight)!==null&&l!==void 0?l:"stretchOrShrink",Z=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(T==="proportional"){if(F==="stretchOnly"&&w/B<Z||F==="proportional"){let M=Math.ceil(B*Z);h*=M/w,w=M}}else if(F==="proportional"&&T==="stretchOnly"&&Z!==0&&w/B>Z){let M=Math.ceil(w/Z);C*=M/B,B=M}return{x1:h,y1:C,x2:h+w,y2:C+B}}function H1(a,e,l,h,C,w){let B=a.image,F;if(B.content){let Ft=B.content,Gt=B.pixelRatio||1;F=[Ft[0]/Gt,Ft[1]/Gt,B.displaySize[0]-Ft[2]/Gt,B.displaySize[1]-Ft[3]/Gt]}let T=e.left*w,Z=e.right*w,M,D,J,$;l==="width"||l==="both"?($=C[0]+T-h[3],D=C[0]+Z+h[1]):($=C[0]+(T+Z-B.displaySize[0])/2,D=$+B.displaySize[0]);let st=e.top*w,ut=e.bottom*w;return l==="height"||l==="both"?(M=C[1]+st-h[0],J=C[1]+ut+h[2]):(M=C[1]+(st+ut-B.displaySize[1])/2,J=M+B.displaySize[1]),{image:B,top:M,right:D,bottom:J,left:$,collisionPadding:F}}let Nh=255,NA=128,Xl=Nh*NA;function M1(a,e){let{expression:l}=e;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new vr(a+1))};if(l.kind==="source")return{kind:"source"};{let{zoomStops:h,interpolationType:C}=l,w=0;for(;w<h.length&&h[w]<=a;)w++;w=Math.max(0,w-1);let B=w;for(;B<h.length&&h[B]<a+1;)B++;B=Math.min(h.length-1,B);let F=h[w],T=h[B];return l.kind==="composite"?{kind:"composite",minZoom:F,maxZoom:T,interpolationType:C}:{kind:"camera",minZoom:F,maxZoom:T,minSize:l.evaluate(new vr(F)),maxSize:l.evaluate(new vr(T)),interpolationType:C}}}function Qm(a,e,l){let h="never",C=a.get(e);return C?h=C:a.get(l)&&(h="always"),h}let CF=Wl.VectorTileFeature.types,IF=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gd(a,e,l,h,C,w,B,F,T,Z,M,D,J){let $=F?Math.min(Xl,Math.round(F[0])):0,st=F?Math.min(Xl,Math.round(F[1])):0;a.emplaceBack(e,l,Math.round(32*h),Math.round(32*C),w,B,($<<1)+(T?1:0),st,16*Z,16*M,256*D,256*J)}function Rm(a,e,l){a.emplaceBack(e.x,e.y,l),a.emplaceBack(e.x,e.y,l),a.emplaceBack(e.x,e.y,l),a.emplaceBack(e.x,e.y,l)}function yF(a){for(let e of a.sections)if(Lc(e.text))return!0;return!1}class Gm{constructor(e){this.layoutVertexArray=new Wn,this.indexArray=new yn,this.programConfigurations=e,this.segments=new xr,this.dynamicLayoutVertexArray=new es,this.opacityVertexArray=new Gr,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ci}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,l,h,C){this.isEmpty()||(h&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,YS.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,jS.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,IF,!0),this.opacityVertexBuffer.itemSize=1),(h||C)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ai("SymbolBuffers",Gm);class Zm{constructor(e,l,h){this.layoutVertexArray=new e,this.layoutAttributes=l,this.indexArray=new h,this.segments=new xr,this.collisionVertexArray=new Un}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,qS.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ai("CollisionBuffers",Zm);class Fu{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(B=>B.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=mm([]),this.placementViewportMatrix=mm([]);let l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=M1(this.zoom,l["text-size"]),this.iconSizeData=M1(this.zoom,l["icon-size"]);let h=this.layers[0].layout,C=h.get("symbol-sort-key"),w=h.get("symbol-z-order");this.canOverlap=Qm(h,"text-overlap","text-allow-overlap")!=="never"||Qm(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=w!=="viewport-y"&&!C.isConstant(),this.sortFeaturesByY=(w==="viewport-y"||w==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(B=>A.ai[B])),this.stateDependentLayerIds=this.layers.filter(B=>B.isStateDependent()).map(B=>B.id),this.sourceID=e.sourceID}createArrays(){this.text=new Gm(new Ta(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Gm(new Ta(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Yi,this.lineVertexArray=new Rr,this.symbolInstances=new Jr,this.textAnchorOffsets=new Lr}calculateGlyphDependencies(e,l,h,C,w){for(let B=0;B<e.length;B++)if(l[e.charCodeAt(B)]=!0,(h||C)&&w){let F=Ph[e.charAt(B)];F&&(l[F.charCodeAt(0)]=!0)}}populate(e,l,h){let C=this.layers[0],w=C.layout,B=w.get("text-font"),F=w.get("text-field"),T=w.get("icon-image"),Z=(F.value.kind!=="constant"||F.value.value instanceof $r&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(B.value.kind!=="constant"||B.value.value.length>0),M=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,D=w.get("symbol-sort-key");if(this.features=[],!Z&&!M)return;let J=l.iconDependencies,$=l.glyphDependencies,st=l.availableImages,ut=new vr(this.zoom);for(let{feature:Ft,id:Gt,index:Ae,sourceLayerIndex:Ot}of e){let te=C._featureFilter.needGeometry,me=MA(Ft,te);if(!C._featureFilter.filter(ut,me,h))continue;let Pe,oi;if(te||(me.geometry=fl(Ft)),Z){let ni=C.getValueAndResolveTokens("text-field",me,h,st),ei=$r.factory(ni),wi=this.hasRTLText=this.hasRTLText||yF(ei);(!wi||fo.getRTLTextPluginStatus()==="unavailable"||wi&&fo.isParsed())&&(Pe=tF(ei,C,me))}if(M){let ni=C.getValueAndResolveTokens("icon-image",me,h,st);oi=ni instanceof An?ni:An.fromString(ni)}if(!Pe&&!oi)continue;let Pi=this.sortFeaturesByKey?D.evaluate(me,{},h):void 0;if(this.features.push({id:Gt,text:Pe,icon:oi,index:Ae,sourceLayerIndex:Ot,geometry:me.geometry,properties:Ft.properties,type:CF[Ft.type],sortKey:Pi}),oi&&(J[oi.name]=!0),Pe){let ni=B.evaluate(me,{},h).join(","),ei=w.get("text-rotation-alignment")!=="viewport"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(A.ai.vertical)>=0;for(let wi of Pe.sections)if(wi.image)J[wi.image.name]=!0;else{let di=ls(Pe.toString()),li=wi.fontStack||ni,Se=$[li]=$[li]||{};this.calculateGlyphDependencies(wi.text,Se,ei,this.allowVerticalPlacement,di)}}}w.get("symbol-placement")==="line"&&(this.features=function(Ft){let Gt={},Ae={},Ot=[],te=0;function me(ni){Ot.push(Ft[ni]),te++}function Pe(ni,ei,wi){let di=Ae[ni];return delete Ae[ni],Ae[ei]=di,Ot[di].geometry[0].pop(),Ot[di].geometry[0]=Ot[di].geometry[0].concat(wi[0]),di}function oi(ni,ei,wi){let di=Gt[ei];return delete Gt[ei],Gt[ni]=di,Ot[di].geometry[0].shift(),Ot[di].geometry[0]=wi[0].concat(Ot[di].geometry[0]),di}function Pi(ni,ei,wi){let di=wi?ei[0][ei[0].length-1]:ei[0][0];return`${ni}:${di.x}:${di.y}`}for(let ni=0;ni<Ft.length;ni++){let ei=Ft[ni],wi=ei.geometry,di=ei.text?ei.text.toString():null;if(!di){me(ni);continue}let li=Pi(di,wi),Se=Pi(di,wi,!0);if(li in Ae&&Se in Gt&&Ae[li]!==Gt[Se]){let Si=oi(li,Se,wi),vi=Pe(li,Se,Ot[Si].geometry);delete Gt[li],delete Ae[Se],Ae[Pi(di,Ot[vi].geometry,!0)]=vi,Ot[Si].geometry=null}else li in Ae?Pe(li,Se,wi):Se in Gt?oi(li,Se,wi):(me(ni),Gt[li]=te-1,Ae[Se]=te-1)}return Ot.filter(ni=>ni.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ft,Gt)=>Ft.sortKey-Gt.sortKey)}update(e,l,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,l,this.layers,h),this.icon.programConfigurations.updatePaintArrays(e,l,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,l){let h=this.lineVertexArray.length;if(e.segment!==void 0){let C=e.dist(l[e.segment+1]),w=e.dist(l[e.segment]),B={};for(let F=e.segment+1;F<l.length;F++)B[F]={x:l[F].x,y:l[F].y,tileUnitDistanceFromAnchor:C},F<l.length-1&&(C+=l[F+1].dist(l[F]));for(let F=e.segment||0;F>=0;F--)B[F]={x:l[F].x,y:l[F].y,tileUnitDistanceFromAnchor:w},F>0&&(w+=l[F-1].dist(l[F]));for(let F=0;F<l.length;F++){let T=B[F];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(e,l,h,C,w,B,F,T,Z,M,D,J){let $=e.indexArray,st=e.layoutVertexArray,ut=e.segments.prepareSegment(4*l.length,st,$,this.canOverlap?B.sortKey:void 0),Ft=this.glyphOffsetArray.length,Gt=ut.vertexLength,Ae=this.allowVerticalPlacement&&F===A.ai.vertical?Math.PI/2:0,Ot=B.text&&B.text.sections;for(let te=0;te<l.length;te++){let{tl:me,tr:Pe,bl:oi,br:Pi,tex:ni,pixelOffsetTL:ei,pixelOffsetBR:wi,minFontScaleX:di,minFontScaleY:li,glyphOffset:Se,isSDF:Si,sectionIndex:vi}=l[te],Oi=ut.vertexLength,Dr=Se[1];gd(st,T.x,T.y,me.x,Dr+me.y,ni.x,ni.y,h,Si,ei.x,ei.y,di,li),gd(st,T.x,T.y,Pe.x,Dr+Pe.y,ni.x+ni.w,ni.y,h,Si,wi.x,ei.y,di,li),gd(st,T.x,T.y,oi.x,Dr+oi.y,ni.x,ni.y+ni.h,h,Si,ei.x,wi.y,di,li),gd(st,T.x,T.y,Pi.x,Dr+Pi.y,ni.x+ni.w,ni.y+ni.h,h,Si,wi.x,wi.y,di,li),Rm(e.dynamicLayoutVertexArray,T,Ae),$.emplaceBack(Oi,Oi+1,Oi+2),$.emplaceBack(Oi+1,Oi+2,Oi+3),ut.vertexLength+=4,ut.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Se[0]),te!==l.length-1&&vi===l[te+1].sectionIndex||e.programConfigurations.populatePaintArrays(st.length,B,B.index,{},J,Ot&&Ot[vi])}e.placedSymbolArray.emplaceBack(T.x,T.y,Ft,this.glyphOffsetArray.length-Ft,Gt,Z,M,T.segment,h?h[0]:0,h?h[1]:0,C[0],C[1],F,0,!1,0,D)}_addCollisionDebugVertex(e,l,h,C,w,B){return l.emplaceBack(0,0),e.emplaceBack(h.x,h.y,C,w,Math.round(B.x),Math.round(B.y))}addCollisionDebugVertices(e,l,h,C,w,B,F){let T=w.segments.prepareSegment(4,w.layoutVertexArray,w.indexArray),Z=T.vertexLength,M=w.layoutVertexArray,D=w.collisionVertexArray,J=F.anchorX,$=F.anchorY;this._addCollisionDebugVertex(M,D,B,J,$,new _(e,l)),this._addCollisionDebugVertex(M,D,B,J,$,new _(h,l)),this._addCollisionDebugVertex(M,D,B,J,$,new _(h,C)),this._addCollisionDebugVertex(M,D,B,J,$,new _(e,C)),T.vertexLength+=4;let st=w.indexArray;st.emplaceBack(Z,Z+1),st.emplaceBack(Z+1,Z+2),st.emplaceBack(Z+2,Z+3),st.emplaceBack(Z+3,Z),T.primitiveLength+=4}addDebugCollisionBoxes(e,l,h,C){for(let w=e;w<l;w++){let B=this.collisionBoxArray.get(w);this.addCollisionDebugVertices(B.x1,B.y1,B.x2,B.y2,C?this.textCollisionBox:this.iconCollisionBox,B.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Zm(xn,w1.members,Zr),this.iconCollisionBox=new Zm(xn,w1.members,Zr);for(let e=0;e<this.symbolInstances.length;e++){let l=this.symbolInstances.get(e);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(e,l,h,C,w,B,F,T,Z){let M={};for(let D=l;D<h;D++){let J=e.get(D);M.textBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},M.textFeatureIndex=J.featureIndex;break}for(let D=C;D<w;D++){let J=e.get(D);M.verticalTextBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},M.verticalTextFeatureIndex=J.featureIndex;break}for(let D=B;D<F;D++){let J=e.get(D);M.iconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},M.iconFeatureIndex=J.featureIndex;break}for(let D=T;D<Z;D++){let J=e.get(D);M.verticalIconBox={x1:J.x1,y1:J.y1,x2:J.x2,y2:J.y2,anchorPointX:J.anchorPointX,anchorPointY:J.anchorPointY},M.verticalIconFeatureIndex=J.featureIndex;break}return M}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){let h=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,l){let h=e.placedSymbolArray.get(l),C=h.vertexStartIndex+4*h.numGlyphs;for(let w=h.vertexStartIndex;w<C;w+=4)e.indexArray.emplaceBack(w,w+1,w+2),e.indexArray.emplaceBack(w+1,w+2,w+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let l=Math.sin(e),h=Math.cos(e),C=[],w=[],B=[];for(let F=0;F<this.symbolInstances.length;++F){B.push(F);let T=this.symbolInstances.get(F);C.push(0|Math.round(l*T.anchorX+h*T.anchorY)),w.push(T.featureIndex)}return B.sort((F,T)=>C[F]-C[T]||w[T]-w[F]),B}addToSortKeyRanges(e,l){let h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===l?h.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let l of this.symbolInstanceIndexes){let h=this.symbolInstances.get(l);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((C,w,B)=>{C>=0&&B.indexOf(C)===w&&this.addIndicesForPlacedSymbol(this.text,C)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let N1,V1;Ai("SymbolBucket",Fu,{omit:["layers","collisionBoxArray","features","compareText"]}),Fu.MAX_GLYPHS=65535,Fu.addDynamicAttributes=Rm;var Pm={get paint(){return V1=V1||new p({"icon-opacity":new Zi(Kt.paint_symbol["icon-opacity"]),"icon-color":new Zi(Kt.paint_symbol["icon-color"]),"icon-halo-color":new Zi(Kt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Zi(Kt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Zi(Kt.paint_symbol["icon-halo-blur"]),"icon-translate":new yi(Kt.paint_symbol["icon-translate"]),"icon-translate-anchor":new yi(Kt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Zi(Kt.paint_symbol["text-opacity"]),"text-color":new Zi(Kt.paint_symbol["text-color"],{runtimeType:or,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Zi(Kt.paint_symbol["text-halo-color"]),"text-halo-width":new Zi(Kt.paint_symbol["text-halo-width"]),"text-halo-blur":new Zi(Kt.paint_symbol["text-halo-blur"]),"text-translate":new yi(Kt.paint_symbol["text-translate"]),"text-translate-anchor":new yi(Kt.paint_symbol["text-translate-anchor"])})},get layout(){return N1=N1||new p({"symbol-placement":new yi(Kt.layout_symbol["symbol-placement"]),"symbol-spacing":new yi(Kt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new yi(Kt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Zi(Kt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new yi(Kt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new yi(Kt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new yi(Kt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new yi(Kt.layout_symbol["icon-ignore-placement"]),"icon-optional":new yi(Kt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new yi(Kt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Zi(Kt.layout_symbol["icon-size"]),"icon-text-fit":new yi(Kt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new yi(Kt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Zi(Kt.layout_symbol["icon-image"]),"icon-rotate":new Zi(Kt.layout_symbol["icon-rotate"]),"icon-padding":new Zi(Kt.layout_symbol["icon-padding"]),"icon-keep-upright":new yi(Kt.layout_symbol["icon-keep-upright"]),"icon-offset":new Zi(Kt.layout_symbol["icon-offset"]),"icon-anchor":new Zi(Kt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new yi(Kt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new yi(Kt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new yi(Kt.layout_symbol["text-rotation-alignment"]),"text-field":new Zi(Kt.layout_symbol["text-field"]),"text-font":new Zi(Kt.layout_symbol["text-font"]),"text-size":new Zi(Kt.layout_symbol["text-size"]),"text-max-width":new Zi(Kt.layout_symbol["text-max-width"]),"text-line-height":new yi(Kt.layout_symbol["text-line-height"]),"text-letter-spacing":new Zi(Kt.layout_symbol["text-letter-spacing"]),"text-justify":new Zi(Kt.layout_symbol["text-justify"]),"text-radial-offset":new Zi(Kt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new yi(Kt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Zi(Kt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Zi(Kt.layout_symbol["text-anchor"]),"text-max-angle":new yi(Kt.layout_symbol["text-max-angle"]),"text-writing-mode":new yi(Kt.layout_symbol["text-writing-mode"]),"text-rotate":new Zi(Kt.layout_symbol["text-rotate"]),"text-padding":new yi(Kt.layout_symbol["text-padding"]),"text-keep-upright":new yi(Kt.layout_symbol["text-keep-upright"]),"text-transform":new Zi(Kt.layout_symbol["text-transform"]),"text-offset":new Zi(Kt.layout_symbol["text-offset"]),"text-allow-overlap":new yi(Kt.layout_symbol["text-allow-overlap"]),"text-overlap":new yi(Kt.layout_symbol["text-overlap"]),"text-ignore-placement":new yi(Kt.layout_symbol["text-ignore-placement"]),"text-optional":new yi(Kt.layout_symbol["text-optional"])})}};class D1{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Gi,this.defaultValue=e}evaluate(e){if(e.formattedSection){let l=this.defaultValue.property.overrides;if(l&&l.hasOverride(e.formattedSection))return l.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ai("FormatSectionOverride",D1,{omit:["defaultValue"]});class dd extends b{constructor(e){super(e,Pm)}recalculate(e,l){if(super.recalculate(e,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let h=this.layout.get("text-writing-mode");if(h){let C=[];for(let w of h)C.indexOf(w)<0&&C.push(w);this.layout._values["text-writing-mode"]=C}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,l,h,C){let w=this.layout.get(e).evaluate(l,{},h,C),B=this._unevaluatedLayout._values[e];return B.isDataDriven()||ta(B.value)||!w?w:function(F,T){return T.replace(/{([^{}]+)}/g,(Z,M)=>F&&M in F?String(F[M]):"")}(l.properties,w)}createBucket(e){return new Fu(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of Pm.paint.overridableProperties){if(!dd.hasPaintOverride(this.layout,e))continue;let l=this.paint.get(e),h=new D1(l),C=new $o(h,l.property.specification),w=null;w=l.value.kind==="constant"||l.value.kind==="source"?new Bs("source",C):new lo("composite",C,l.value.zoomStops),this.paint._values[e]=new Zo(l.property,w,l.parameters)}}_handleOverridablePaintPropertyUpdate(e,l,h){return!(!this.layout||l.isDataDriven()||h.isDataDriven())&&dd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,l){let h=e.get("text-field"),C=Pm.paint.properties[l],w=!1,B=F=>{for(let T of F)if(C.overrides&&C.overrides.hasOverride(T))return void(w=!0)};if(h.value.kind==="constant"&&h.value.value instanceof $r)B(h.value.value.sections);else if(h.value.kind==="source"){let F=Z=>{w||(Z instanceof io&&Or(Z.value)===Ji?B(Z.value.sections):Z instanceof Lo?B(Z.sections):Z.eachChild(F))},T=h.value;T._styleExpression&&F(T._styleExpression.expression)}return w}}let K1;var bF={get paint(){return K1=K1||new p({"background-color":new yi(Kt.paint_background["background-color"]),"background-pattern":new i(Kt.paint_background["background-pattern"]),"background-opacity":new yi(Kt.paint_background["background-opacity"])})}};class vF extends b{constructor(e){super(e,bF)}}let z1;var wF={get paint(){return z1=z1||new p({"raster-opacity":new yi(Kt.paint_raster["raster-opacity"]),"raster-hue-rotate":new yi(Kt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new yi(Kt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new yi(Kt.paint_raster["raster-brightness-max"]),"raster-saturation":new yi(Kt.paint_raster["raster-saturation"]),"raster-contrast":new yi(Kt.paint_raster["raster-contrast"]),"raster-resampling":new yi(Kt.paint_raster["raster-resampling"]),"raster-fade-duration":new yi(Kt.paint_raster["raster-fade-duration"])})}};class BF extends b{constructor(e){super(e,wF)}}class _F extends b{constructor(e){super(e,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class xF{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}let Hm=63710088e-1;class Yl{constructor(e,l){if(isNaN(e)||isNaN(l))throw new Error(`Invalid LngLat object: (${e}, ${l})`);if(this.lng=+e,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Yl(_t(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){let l=Math.PI/180,h=this.lat*l,C=e.lat*l,w=Math.sin(h)*Math.sin(C)+Math.cos(h)*Math.cos(C)*Math.cos((e.lng-this.lng)*l);return Hm*Math.acos(Math.min(w,1))}static convert(e){if(e instanceof Yl)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Yl(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Yl(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let O1=2*Math.PI*Hm;function W1(a){return O1*Math.cos(a*Math.PI/180)}function J1(a){return(180+a)/360}function X1(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Y1(a,e){return a/W1(e)}function Mm(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class pd{constructor(e,l,h=0){this.x=+e,this.y=+l,this.z=+h}static fromLngLat(e,l=0){let h=Yl.convert(e);return new pd(J1(h.lng),X1(h.lat),Y1(l,h.lat))}toLngLat(){return new Yl(360*this.x-180,Mm(this.y))}toAltitude(){return this.z*W1(Mm(this.y))}meterInMercatorCoordinateUnits(){return 1/O1*(e=Mm(this.y),1/Math.cos(e*Math.PI/180));var e}}function j1(a,e,l){var h=2*Math.PI*6378137/256/Math.pow(2,l);return[a*h-2*Math.PI*6378137/2,e*h-2*Math.PI*6378137/2]}class Nm{constructor(e,l,h){if(e<0||e>25||h<0||h>=Math.pow(2,e)||l<0||l>=Math.pow(2,e))throw new Error(`x=${l}, y=${h}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=l,this.y=h,this.key=Vh(0,e,e,l,h)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,l,h){let C=(B=this.y,F=this.z,T=j1(256*(w=this.x),256*(B=Math.pow(2,F)-B-1),F),Z=j1(256*(w+1),256*(B+1),F),T[0]+","+T[1]+","+Z[0]+","+Z[1]);var w,B,F,T,Z;let M=function(D,J,$){let st,ut="";for(let Ft=D;Ft>0;Ft--)st=1<<Ft-1,ut+=(J&st?1:0)+($&st?2:0);return ut}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,C)}isChildOf(e){let l=this.z-e.z;return l>0&&e.x===this.x>>l&&e.y===this.y>>l}getTilePoint(e){let l=Math.pow(2,this.z);return new _((e.x*l-this.x)*Pr,(e.y*l-this.y)*Pr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class q1{constructor(e,l){this.wrap=e,this.canonical=l,this.key=Vh(e,l.z,l.z,l.x,l.y)}}class aa{constructor(e,l,h,C,w){if(e<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${h}`);this.overscaledZ=e,this.wrap=l,this.canonical=new Nm(h,+C,+w),this.key=Vh(l,e,h,C,w)}clone(){return new aa(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let l=this.canonical.z-e;return e>this.canonical.z?new aa(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new aa(e,this.wrap,e,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(e,l){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let h=this.canonical.z-e;return e>this.canonical.z?Vh(this.wrap*+l,e,this.canonical.z,this.canonical.x,this.canonical.y):Vh(this.wrap*+l,e,e,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let l=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>l&&e.canonical.y===this.canonical.y>>l}children(e){if(this.overscaledZ>=e)return[new aa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let l=this.canonical.z+1,h=2*this.canonical.x,C=2*this.canonical.y;return[new aa(l,this.wrap,l,h,C),new aa(l,this.wrap,l,h+1,C),new aa(l,this.wrap,l,h,C+1),new aa(l,this.wrap,l,h+1,C+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new aa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new aa(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new q1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new pd(e.x-this.wrap,e.y))}}function Vh(a,e,l,h,C){(a*=2)<0&&(a=-1*a-1);let w=1<<l;return(w*w*a+w*C+h).toString(36)+l.toString(36)+e.toString(36)}Ai("CanonicalTileID",Nm),Ai("OverscaledTileID",aa,{omit:["posMatrix"]});class $1{constructor(e,l,h,C=1,w=1,B=1,F=0){if(this.uid=e,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(h&&!["mapbox","terrarium","custom"].includes(h))return void lt(`"${h}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;let T=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),h){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=C,this.greenFactor=w,this.blueFactor=B,this.baseShift=F;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Z=0;Z<T;Z++)this.data[this._idx(-1,Z)]=this.data[this._idx(0,Z)],this.data[this._idx(T,Z)]=this.data[this._idx(T-1,Z)],this.data[this._idx(Z,-1)]=this.data[this._idx(Z,0)],this.data[this._idx(Z,T)]=this.data[this._idx(Z,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Z=0;Z<T;Z++)for(let M=0;M<T;M++){let D=this.get(Z,M);D>this.max&&(this.max=D),D<this.min&&(this.min=D)}}get(e,l){let h=new Uint8Array(this.data.buffer),C=4*this._idx(e,l);return this.unpack(h[C],h[C+1],h[C+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,l){if(e<-1||e>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(e+1)}unpack(e,l,h){return e*this.redFactor+l*this.greenFactor+h*this.blueFactor-this.baseShift}getPixels(){return new oa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,l,h){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let C=l*this.dim,w=l*this.dim+this.dim,B=h*this.dim,F=h*this.dim+this.dim;switch(l){case-1:C=w-1;break;case 1:w=C+1}switch(h){case-1:B=F-1;break;case 1:F=B+1}let T=-l*this.dim,Z=-h*this.dim;for(let M=B;M<F;M++)for(let D=C;D<w;D++)this.data[this._idx(D,M)]=e.data[this._idx(D+T,M+Z)]}}Ai("DEMData",$1);class tb{constructor(e){this._stringToNumber={},this._numberToString=[];for(let l=0;l<e.length;l++){let h=e[l];this._stringToNumber[h]=l,this._numberToString[l]=h}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class eb{constructor(e,l,h,C,w){this.type="Feature",this._vectorTileFeature=e,e._z=l,e._x=h,e._y=C,this.properties=e.properties,this.id=w}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(e[l]=this[l]);return e}}class ib{constructor(e,l){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new RA(Pr,16,0),this.grid3D=new RA(Pr,16,0),this.featureIndexArray=new Tr,this.promoteId=l}insert(e,l,h,C,w,B){let F=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,C,w);let T=B?this.grid3D:this.grid;for(let Z=0;Z<l.length;Z++){let M=l[Z],D=[1/0,1/0,-1/0,-1/0];for(let J=0;J<M.length;J++){let $=M[J];D[0]=Math.min(D[0],$.x),D[1]=Math.min(D[1],$.y),D[2]=Math.max(D[2],$.x),D[3]=Math.max(D[3],$.y)}D[0]<Pr&&D[1]<Pr&&D[2]>=0&&D[3]>=0&&T.insert(F,D[0],D[1],D[2],D[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Wl.VectorTile(new km(this.rawTileData)).layers,this.sourceLayerCoder=new tb(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,l,h,C){this.loadVTLayers();let w=e.params||{},B=Pr/e.tileSize/e.scale,F=Vr(w.filter),T=e.queryGeometry,Z=e.queryPadding*B,M=nb(T),D=this.grid.query(M.minX-Z,M.minY-Z,M.maxX+Z,M.maxY+Z),J=nb(e.cameraQueryGeometry),$=this.grid3D.query(J.minX-Z,J.minY-Z,J.maxX+Z,J.maxY+Z,(Ft,Gt,Ae,Ot)=>function(te,me,Pe,oi,Pi){for(let ei of te)if(me<=ei.x&&Pe<=ei.y&&oi>=ei.x&&Pi>=ei.y)return!0;let ni=[new _(me,Pe),new _(me,Pi),new _(oi,Pi),new _(oi,Pe)];if(te.length>2){for(let ei of ni)if(Io(te,ei))return!0}for(let ei=0;ei<te.length-1;ei++)if(Cu(te[ei],te[ei+1],ni))return!0;return!1}(e.cameraQueryGeometry,Ft-Z,Gt-Z,Ae+Z,Ot+Z));for(let Ft of $)D.push(Ft);D.sort(SF);let st={},ut;for(let Ft=0;Ft<D.length;Ft++){let Gt=D[Ft];if(Gt===ut)continue;ut=Gt;let Ae=this.featureIndexArray.get(Gt),Ot=null;this.loadMatchingFeature(st,Ae.bucketIndex,Ae.sourceLayerIndex,Ae.featureIndex,F,w.layers,w.availableImages,l,h,C,(te,me,Pe)=>(Ot||(Ot=fl(te)),me.queryIntersectsFeature(T,te,Pe,Ot,this.z,e.transform,B,e.pixelPosMatrix)))}return st}loadMatchingFeature(e,l,h,C,w,B,F,T,Z,M,D){let J=this.bucketLayerIDs[l];if(B&&!function(Ft,Gt){for(let Ae=0;Ae<Ft.length;Ae++)if(Gt.indexOf(Ft[Ae])>=0)return!0;return!1}(B,J))return;let $=this.sourceLayerCoder.decode(h),st=this.vtLayers[$].feature(C);if(w.needGeometry){let Ft=MA(st,!0);if(!w.filter(new vr(this.tileID.overscaledZ),Ft,this.tileID.canonical))return}else if(!w.filter(new vr(this.tileID.overscaledZ),st))return;let ut=this.getId(st,$);for(let Ft=0;Ft<J.length;Ft++){let Gt=J[Ft];if(B&&B.indexOf(Gt)<0)continue;let Ae=T[Gt];if(!Ae)continue;let Ot={};ut&&M&&(Ot=M.getState(Ae.sourceLayer||"_geojsonTileLayer",ut));let te=Lt({},Z[Gt]);te.paint=rb(te.paint,Ae.paint,st,Ot,F),te.layout=rb(te.layout,Ae.layout,st,Ot,F);let me=!D||D(st,Ae,Ot);if(!me)continue;let Pe=new eb(st,this.z,this.x,this.y,ut);Pe.layer=te;let oi=e[Gt];oi===void 0&&(oi=e[Gt]=[]),oi.push({featureIndex:C,feature:Pe,intersectionZ:me})}}lookupSymbolFeatures(e,l,h,C,w,B,F,T){let Z={};this.loadVTLayers();let M=Vr(w);for(let D of e)this.loadMatchingFeature(Z,h,C,D,M,B,F,T,l);return Z}hasLayer(e){for(let l of this.bucketLayerIDs)for(let h of l)if(e===h)return!0;return!1}getId(e,l){let h=e.id;return this.promoteId&&(h=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof h=="boolean"&&(h=Number(h))),h}}function rb(a,e,l,h,C){return xt(a,(w,B)=>{let F=e instanceof Kl?e.get(B):null;return F&&F.evaluate?F.evaluate(l,h,C):F})}function nb(a){let e=1/0,l=1/0,h=-1/0,C=-1/0;for(let w of a)e=Math.min(e,w.x),l=Math.min(l,w.y),h=Math.max(h,w.x),C=Math.max(C,w.y);return{minX:e,minY:l,maxX:h,maxY:C}}function SF(a,e){return e-a}function sb(a,e,l,h,C){let w=[];for(let B=0;B<a.length;B++){let F=a[B],T;for(let Z=0;Z<F.length-1;Z++){let M=F[Z],D=F[Z+1];M.x<e&&D.x<e||(M.x<e?M=new _(e,M.y+(e-M.x)/(D.x-M.x)*(D.y-M.y))._round():D.x<e&&(D=new _(e,M.y+(e-M.x)/(D.x-M.x)*(D.y-M.y))._round()),M.y<l&&D.y<l||(M.y<l?M=new _(M.x+(l-M.y)/(D.y-M.y)*(D.x-M.x),l)._round():D.y<l&&(D=new _(M.x+(l-M.y)/(D.y-M.y)*(D.x-M.x),l)._round()),M.x>=h&&D.x>=h||(M.x>=h?M=new _(h,M.y+(h-M.x)/(D.x-M.x)*(D.y-M.y))._round():D.x>=h&&(D=new _(h,M.y+(h-M.x)/(D.x-M.x)*(D.y-M.y))._round()),M.y>=C&&D.y>=C||(M.y>=C?M=new _(M.x+(C-M.y)/(D.y-M.y)*(D.x-M.x),C)._round():D.y>=C&&(D=new _(M.x+(C-M.y)/(D.y-M.y)*(D.x-M.x),C)._round()),T&&M.equals(T[T.length-1])||(T=[M],w.push(T)),T.push(D)))))}}return w}Ai("FeatureIndex",ib,{omit:["rawTileData","sourceLayerCoder"]});class jl extends _{constructor(e,l,h,C){super(e,l),this.angle=h,C!==void 0&&(this.segment=C)}clone(){return new jl(this.x,this.y,this.angle,this.segment)}}function ob(a,e,l,h,C){if(e.segment===void 0||l===0)return!0;let w=e,B=e.segment+1,F=0;for(;F>-l/2;){if(B--,B<0)return!1;F-=a[B].dist(w),w=a[B]}F+=a[B].dist(a[B+1]),B++;let T=[],Z=0;for(;F<l/2;){let M=a[B],D=a[B+1];if(!D)return!1;let J=a[B-1].angleTo(M)-M.angleTo(D);for(J=Math.abs((J+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:F,angleDelta:J}),Z+=J;F-T[0].distance>h;)Z-=T.shift().angleDelta;if(Z>C)return!1;B++,F+=M.dist(D)}return!0}function ab(a){let e=0;for(let l=0;l<a.length-1;l++)e+=a[l].dist(a[l+1]);return e}function Ab(a,e,l){return a?.6*e*l:0}function lb(a,e){return Math.max(a?a.right-a.left:0,e?e.right-e.left:0)}function FF(a,e,l,h,C,w){let B=Ab(l,C,w),F=lb(l,h)*w,T=0,Z=ab(a)/2;for(let M=0;M<a.length-1;M++){let D=a[M],J=a[M+1],$=D.dist(J);if(T+$>Z){let st=(Z-T)/$,ut=ci.number(D.x,J.x,st),Ft=ci.number(D.y,J.y,st),Gt=new jl(ut,Ft,J.angleTo(D),M);return Gt._round(),!B||ob(a,Gt,F,B,e)?Gt:void 0}T+=$}}function kF(a,e,l,h,C,w,B,F,T){let Z=Ab(h,w,B),M=lb(h,C),D=M*B,J=a[0].x===0||a[0].x===T||a[0].y===0||a[0].y===T;return e-D<e/4&&(e=D+e/4),cb(a,J?e/2*F%e:(M/2+2*w)*B*F%e,e,Z,l,D,J,!1,T)}function cb(a,e,l,h,C,w,B,F,T){let Z=w/2,M=ab(a),D=0,J=e-l,$=[];for(let st=0;st<a.length-1;st++){let ut=a[st],Ft=a[st+1],Gt=ut.dist(Ft),Ae=Ft.angleTo(ut);for(;J+l<D+Gt;){J+=l;let Ot=(J-D)/Gt,te=ci.number(ut.x,Ft.x,Ot),me=ci.number(ut.y,Ft.y,Ot);if(te>=0&&te<T&&me>=0&&me<T&&J-Z>=0&&J+Z<=M){let Pe=new jl(te,me,Ae,st);Pe._round(),h&&!ob(a,Pe,w,h,C)||$.push(Pe)}}D+=Gt}return F||$.length||B||($=cb(a,D/2,l,h,C,w,B,!0,T)),$}Ai("Anchor",jl);let ku=yo;function ub(a,e,l,h){let C=[],w=a.image,B=w.pixelRatio,F=w.paddedRect.w-2*ku,T=w.paddedRect.h-2*ku,Z={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom},M=w.stretchX||[[0,F]],D=w.stretchY||[[0,T]],J=(Se,Si)=>Se+Si[1]-Si[0],$=M.reduce(J,0),st=D.reduce(J,0),ut=F-$,Ft=T-st,Gt=0,Ae=$,Ot=0,te=st,me=0,Pe=ut,oi=0,Pi=Ft;if(w.content&&h){let Se=w.content,Si=Se[2]-Se[0],vi=Se[3]-Se[1];(w.textFitWidth||w.textFitHeight)&&(Z=P1(a)),Gt=fd(M,0,Se[0]),Ot=fd(D,0,Se[1]),Ae=fd(M,Se[0],Se[2]),te=fd(D,Se[1],Se[3]),me=Se[0]-Gt,oi=Se[1]-Ot,Pe=Si-Ae,Pi=vi-te}let ni=Z.x1,ei=Z.y1,wi=Z.x2-ni,di=Z.y2-ei,li=(Se,Si,vi,Oi)=>{let Dr=md(Se.stretch-Gt,Ae,wi,ni),Mr=Cd(Se.fixed-me,Pe,Se.stretch,$),Jn=md(Si.stretch-Ot,te,di,ei),Qa=Cd(Si.fixed-oi,Pi,Si.stretch,st),us=md(vi.stretch-Gt,Ae,wi,ni),fn=Cd(vi.fixed-me,Pe,vi.stretch,$),zs=md(Oi.stretch-Ot,te,di,ei),Os=Cd(Oi.fixed-oi,Pi,Oi.stretch,st),Ws=new _(Dr,Jn),mn=new _(us,Jn),Xn=new _(us,zs),Ls=new _(Dr,zs),hs=new _(Mr/B,Qa/B),Js=new _(fn/B,Os/B),gs=e*Math.PI/180;if(gs){let Cr=Math.sin(gs),zr=Math.cos(gs),Xr=[zr,-Cr,Cr,zr];Ws._matMult(Xr),mn._matMult(Xr),Ls._matMult(Xr),Xn._matMult(Xr)}let Aa=Se.stretch+Se.fixed,bo=Si.stretch+Si.fixed;return{tl:Ws,tr:mn,bl:Ls,br:Xn,tex:{x:w.paddedRect.x+ku+Aa,y:w.paddedRect.y+ku+bo,w:vi.stretch+vi.fixed-Aa,h:Oi.stretch+Oi.fixed-bo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:hs,pixelOffsetBR:Js,minFontScaleX:Pe/B/wi,minFontScaleY:Pi/B/di,isSDF:l}};if(h&&(w.stretchX||w.stretchY)){let Se=hb(M,ut,$),Si=hb(D,Ft,st);for(let vi=0;vi<Se.length-1;vi++){let Oi=Se[vi],Dr=Se[vi+1];for(let Mr=0;Mr<Si.length-1;Mr++)C.push(li(Oi,Si[Mr],Dr,Si[Mr+1]))}}else C.push(li({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:F+1},{fixed:0,stretch:T+1}));return C}function fd(a,e,l){let h=0;for(let C of a)h+=Math.max(e,Math.min(l,C[1]))-Math.max(e,Math.min(l,C[0]));return h}function hb(a,e,l){let h=[{fixed:-ku,stretch:0}];for(let[C,w]of a){let B=h[h.length-1];h.push({fixed:C-B.stretch,stretch:B.stretch}),h.push({fixed:C-B.stretch,stretch:B.stretch+(w-C)})}return h.push({fixed:e+ku,stretch:l}),h}function md(a,e,l,h){return a/e*l+h}function Cd(a,e,l,h){return a-e*l/h}class Id{constructor(e,l,h,C,w,B,F,T,Z,M){var D;if(this.boxStartIndex=e.length,Z){let J=B.top,$=B.bottom,st=B.collisionPadding;st&&(J-=st[1],$+=st[3]);let ut=$-J;ut>0&&(ut=Math.max(10,ut),this.circleDiameter=ut)}else{let J=((D=B.image)===null||D===void 0?void 0:D.content)&&(B.image.textFitWidth||B.image.textFitHeight)?P1(B):{x1:B.left,y1:B.top,x2:B.right,y2:B.bottom};J.y1=J.y1*F-T[0],J.y2=J.y2*F+T[2],J.x1=J.x1*F-T[3],J.x2=J.x2*F+T[1];let $=B.collisionPadding;if($&&(J.x1-=$[0]*F,J.y1-=$[1]*F,J.x2+=$[2]*F,J.y2+=$[3]*F),M){let st=new _(J.x1,J.y1),ut=new _(J.x2,J.y1),Ft=new _(J.x1,J.y2),Gt=new _(J.x2,J.y2),Ae=M*Math.PI/180;st._rotate(Ae),ut._rotate(Ae),Ft._rotate(Ae),Gt._rotate(Ae),J.x1=Math.min(st.x,ut.x,Ft.x,Gt.x),J.x2=Math.max(st.x,ut.x,Ft.x,Gt.x),J.y1=Math.min(st.y,ut.y,Ft.y,Gt.y),J.y2=Math.max(st.y,ut.y,Ft.y,Gt.y)}e.emplaceBack(l.x,l.y,J.x1,J.y1,J.x2,J.y2,h,C,w)}this.boxEndIndex=e.length}}class LF{constructor(e=[],l=(h,C)=>h<C?-1:h>C?1:0){if(this.data=e,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:l,compare:h}=this,C=l[e];for(;e>0;){let w=e-1>>1,B=l[w];if(h(C,B)>=0)break;l[e]=B,e=w}l[e]=C}_down(e){let{data:l,compare:h}=this,C=this.length>>1,w=l[e];for(;e<C;){let B=1+(e<<1),F=B+1;if(F<this.length&&h(l[F],l[B])<0&&(B=F),h(l[B],w)>=0)break;l[e]=l[B],e=B}l[e]=w}}function EF(a,e=1,l=!1){let h=1/0,C=1/0,w=-1/0,B=-1/0,F=a[0];for(let $=0;$<F.length;$++){let st=F[$];(!$||st.x<h)&&(h=st.x),(!$||st.y<C)&&(C=st.y),(!$||st.x>w)&&(w=st.x),(!$||st.y>B)&&(B=st.y)}let T=Math.min(w-h,B-C),Z=T/2,M=new LF([],TF);if(T===0)return new _(h,C);for(let $=h;$<w;$+=T)for(let st=C;st<B;st+=T)M.push(new Lu($+Z,st+Z,Z,a));let D=function($){let st=0,ut=0,Ft=0,Gt=$[0];for(let Ae=0,Ot=Gt.length,te=Ot-1;Ae<Ot;te=Ae++){let me=Gt[Ae],Pe=Gt[te],oi=me.x*Pe.y-Pe.x*me.y;ut+=(me.x+Pe.x)*oi,Ft+=(me.y+Pe.y)*oi,st+=3*oi}return new Lu(ut/st,Ft/st,0,$)}(a),J=M.length;for(;M.length;){let $=M.pop();($.d>D.d||!D.d)&&(D=$,l&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,J)),$.max-D.d<=e||(Z=$.h/2,M.push(new Lu($.p.x-Z,$.p.y-Z,Z,a)),M.push(new Lu($.p.x+Z,$.p.y-Z,Z,a)),M.push(new Lu($.p.x-Z,$.p.y+Z,Z,a)),M.push(new Lu($.p.x+Z,$.p.y+Z,Z,a)),J+=4)}return l&&(console.log(`num probes: ${J}`),console.log(`best distance: ${D.d}`)),D.p}function TF(a,e){return e.max-a.max}function Lu(a,e,l,h){this.p=new _(a,e),this.h=l,this.d=function(C,w){let B=!1,F=1/0;for(let T=0;T<w.length;T++){let Z=w[T];for(let M=0,D=Z.length,J=D-1;M<D;J=M++){let $=Z[M],st=Z[J];$.y>C.y!=st.y>C.y&&C.x<(st.x-$.x)*(C.y-$.y)/(st.y-$.y)+$.x&&(B=!B),F=Math.min(F,Ua(C,$,st))}}return(B?1:-1)*Math.sqrt(F)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}var cs;A.ar=void 0,(cs=A.ar||(A.ar={}))[cs.center=1]="center",cs[cs.left=2]="left",cs[cs.right=3]="right",cs[cs.top=4]="top",cs[cs.bottom=5]="bottom",cs[cs["top-left"]=6]="top-left",cs[cs["top-right"]=7]="top-right",cs[cs["bottom-left"]=8]="bottom-left",cs[cs["bottom-right"]=9]="bottom-right";let ql=7,Vm=Number.POSITIVE_INFINITY;function gb(a,e){return e[1]!==Vm?function(l,h,C){let w=0,B=0;switch(h=Math.abs(h),C=Math.abs(C),l){case"top-right":case"top-left":case"top":B=C-ql;break;case"bottom-right":case"bottom-left":case"bottom":B=-C+ql}switch(l){case"top-right":case"bottom-right":case"right":w=-h;break;case"top-left":case"bottom-left":case"left":w=h}return[w,B]}(a,e[0],e[1]):function(l,h){let C=0,w=0;h<0&&(h=0);let B=h/Math.SQRT2;switch(l){case"top-right":case"top-left":w=B-ql;break;case"bottom-right":case"bottom-left":w=-B+ql;break;case"bottom":w=-h+ql;break;case"top":w=h-ql}switch(l){case"top-right":case"bottom-right":C=-B;break;case"top-left":case"bottom-left":C=B;break;case"left":C=h;break;case"right":C=-h}return[C,w]}(a,e[0])}function db(a,e,l){var h;let C=a.layout,w=(h=C.get("text-variable-anchor-offset"))===null||h===void 0?void 0:h.evaluate(e,{},l);if(w){let F=w.values,T=[];for(let Z=0;Z<F.length;Z+=2){let M=T[Z]=F[Z],D=F[Z+1].map(J=>J*Qn);M.startsWith("top")?D[1]-=ql:M.startsWith("bottom")&&(D[1]+=ql),T[Z+1]=D}return new pn(T)}let B=C.get("text-variable-anchor");if(B){let F;F=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[C.get("text-radial-offset").evaluate(e,{},l)*Qn,Vm]:C.get("text-offset").evaluate(e,{},l).map(Z=>Z*Qn);let T=[];for(let Z of B)T.push(Z,gb(Z,F));return new pn(T)}return null}function Dm(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function UF(a,e,l,h,C,w,B,F,T,Z,M){let D=w.textMaxSize.evaluate(e,{});D===void 0&&(D=B);let J=a.layers[0].layout,$=J.get("icon-offset").evaluate(e,{},M),st=fb(l.horizontal),ut=B/24,Ft=a.tilePixelRatio*ut,Gt=a.tilePixelRatio*D/24,Ae=a.tilePixelRatio*F,Ot=a.tilePixelRatio*J.get("symbol-spacing"),te=J.get("text-padding")*a.tilePixelRatio,me=function(Se,Si,vi,Oi=1){let Dr=Se.get("icon-padding").evaluate(Si,{},vi),Mr=Dr&&Dr.values;return[Mr[0]*Oi,Mr[1]*Oi,Mr[2]*Oi,Mr[3]*Oi]}(J,e,M,a.tilePixelRatio),Pe=J.get("text-max-angle")/180*Math.PI,oi=J.get("text-rotation-alignment")!=="viewport"&&J.get("symbol-placement")!=="point",Pi=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",ni=J.get("symbol-placement"),ei=Ot/2,wi=J.get("icon-text-fit"),di;h&&wi!=="none"&&(a.allowVerticalPlacement&&l.vertical&&(di=H1(h,l.vertical,wi,J.get("icon-text-fit-padding"),$,ut)),st&&(h=H1(h,st,wi,J.get("icon-text-fit-padding"),$,ut)));let li=(Se,Si)=>{Si.x<0||Si.x>=Pr||Si.y<0||Si.y>=Pr||function(vi,Oi,Dr,Mr,Jn,Qa,us,fn,zs,Os,Ws,mn,Xn,Ls,hs,Js,gs,Aa,bo,Cr,zr,Xr,Ho,dn,Eu){let VA=vi.addToLineVertexArray(Oi,Dr),DA,Ra,la,is,yl=0,zh=0,yb=0,bb=0,jm=-1,qm=-1,bl={},vb=Ea("");if(vi.allowVerticalPlacement&&Mr.vertical){let Es=fn.layout.get("text-rotate").evaluate(zr,{},dn)+90;la=new Id(zs,Oi,Os,Ws,mn,Mr.vertical,Xn,Ls,hs,Es),us&&(is=new Id(zs,Oi,Os,Ws,mn,us,gs,Aa,hs,Es))}if(Jn){let Es=fn.layout.get("icon-rotate").evaluate(zr,{}),ca=fn.layout.get("icon-text-fit")!=="none",Rc=ub(Jn,Es,Ho,ca),iA=us?ub(us,Es,Ho,ca):void 0;Ra=new Id(zs,Oi,Os,Ws,mn,Jn,gs,Aa,!1,Es),yl=4*Rc.length;let Gc=vi.iconSizeData,KA=null;Gc.kind==="source"?(KA=[NA*fn.layout.get("icon-size").evaluate(zr,{})],KA[0]>Xl&&lt(`${vi.layerIds[0]}: Value for "icon-size" is >= ${Nh}. Reduce your "icon-size".`)):Gc.kind==="composite"&&(KA=[NA*Xr.compositeIconSizes[0].evaluate(zr,{},dn),NA*Xr.compositeIconSizes[1].evaluate(zr,{},dn)],(KA[0]>Xl||KA[1]>Xl)&&lt(`${vi.layerIds[0]}: Value for "icon-size" is >= ${Nh}. Reduce your "icon-size".`)),vi.addSymbols(vi.icon,Rc,KA,Cr,bo,zr,A.ai.none,Oi,VA.lineStartIndex,VA.lineLength,-1,dn),jm=vi.icon.placedSymbolArray.length-1,iA&&(zh=4*iA.length,vi.addSymbols(vi.icon,iA,KA,Cr,bo,zr,A.ai.vertical,Oi,VA.lineStartIndex,VA.lineLength,-1,dn),qm=vi.icon.placedSymbolArray.length-1)}let wb=Object.keys(Mr.horizontal);for(let Es of wb){let ca=Mr.horizontal[Es];if(!DA){vb=Ea(ca.text);let iA=fn.layout.get("text-rotate").evaluate(zr,{},dn);DA=new Id(zs,Oi,Os,Ws,mn,ca,Xn,Ls,hs,iA)}let Rc=ca.positionedLines.length===1;if(yb+=pb(vi,Oi,ca,Qa,fn,hs,zr,Js,VA,Mr.vertical?A.ai.horizontal:A.ai.horizontalOnly,Rc?wb:[Es],bl,jm,Xr,dn),Rc)break}Mr.vertical&&(bb+=pb(vi,Oi,Mr.vertical,Qa,fn,hs,zr,Js,VA,A.ai.vertical,["vertical"],bl,qm,Xr,dn));let GF=DA?DA.boxStartIndex:vi.collisionBoxArray.length,ZF=DA?DA.boxEndIndex:vi.collisionBoxArray.length,PF=la?la.boxStartIndex:vi.collisionBoxArray.length,HF=la?la.boxEndIndex:vi.collisionBoxArray.length,MF=Ra?Ra.boxStartIndex:vi.collisionBoxArray.length,NF=Ra?Ra.boxEndIndex:vi.collisionBoxArray.length,VF=is?is.boxStartIndex:vi.collisionBoxArray.length,DF=is?is.boxEndIndex:vi.collisionBoxArray.length,eA=-1,bd=(Es,ca)=>Es&&Es.circleDiameter?Math.max(Es.circleDiameter,ca):ca;eA=bd(DA,eA),eA=bd(la,eA),eA=bd(Ra,eA),eA=bd(is,eA);let Bb=eA>-1?1:0;Bb&&(eA*=Eu/Qn),vi.glyphOffsetArray.length>=Fu.MAX_GLYPHS&&lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zr.sortKey!==void 0&&vi.addToSortKeyRanges(vi.symbolInstances.length,zr.sortKey);let KF=db(fn,zr,dn),[zF,OF]=function(Es,ca){let Rc=Es.length,iA=ca?.values;if(iA?.length>0)for(let Gc=0;Gc<iA.length;Gc+=2){let KA=iA[Gc+1];Es.emplaceBack(A.ar[iA[Gc]],KA[0],KA[1])}return[Rc,Es.length]}(vi.textAnchorOffsets,KF);vi.symbolInstances.emplaceBack(Oi.x,Oi.y,bl.right>=0?bl.right:-1,bl.center>=0?bl.center:-1,bl.left>=0?bl.left:-1,bl.vertical||-1,jm,qm,vb,GF,ZF,PF,HF,MF,NF,VF,DF,Os,yb,bb,yl,zh,Bb,0,Xn,eA,zF,OF)}(a,Si,Se,l,h,C,di,a.layers[0],a.collisionBoxArray,e.index,e.sourceLayerIndex,a.index,Ft,[te,te,te,te],oi,T,Ae,me,Pi,$,e,w,Z,M,B)};if(ni==="line")for(let Se of sb(e.geometry,0,0,Pr,Pr)){let Si=kF(Se,Ot,Pe,l.vertical||st,h,24,Gt,a.overscaling,Pr);for(let vi of Si)st&&QF(a,st.text,ei,vi)||li(Se,vi)}else if(ni==="line-center"){for(let Se of e.geometry)if(Se.length>1){let Si=FF(Se,Pe,l.vertical||st,h,24,Gt);Si&&li(Se,Si)}}else if(e.type==="Polygon")for(let Se of Xo(e.geometry,0)){let Si=EF(Se,16);li(Se[0],new jl(Si.x,Si.y,0))}else if(e.type==="LineString")for(let Se of e.geometry)li(Se,new jl(Se[0].x,Se[0].y,0));else if(e.type==="Point")for(let Se of e.geometry)for(let Si of Se)li([Si],new jl(Si.x,Si.y,0))}function pb(a,e,l,h,C,w,B,F,T,Z,M,D,J,$,st){let ut=function(Ae,Ot,te,me,Pe,oi,Pi,ni){let ei=me.layout.get("text-rotate").evaluate(oi,{})*Math.PI/180,wi=[];for(let di of Ot.positionedLines)for(let li of di.positionedGlyphs){if(!li.rect)continue;let Se=li.rect||{},Si=E1+1,vi=!0,Oi=1,Dr=0,Mr=(Pe||ni)&&li.vertical,Jn=li.metrics.advance*li.scale/2;if(ni&&Ot.verticalizable&&(Dr=di.lineOffset/2-(li.imageName?-(Qn-li.metrics.width*li.scale)/2:(li.scale-1)*Qn)),li.imageName){let Cr=Pi[li.imageName];vi=Cr.sdf,Oi=Cr.pixelRatio,Si=yo/Oi}let Qa=Pe?[li.x+Jn,li.y]:[0,0],us=Pe?[0,0]:[li.x+Jn+te[0],li.y+te[1]-Dr],fn=[0,0];Mr&&(fn=us,us=[0,0]);let zs=li.metrics.isDoubleResolution?2:1,Os=(li.metrics.left-Si)*li.scale-Jn+us[0],Ws=(-li.metrics.top-Si)*li.scale+us[1],mn=Os+Se.w/zs*li.scale/Oi,Xn=Ws+Se.h/zs*li.scale/Oi,Ls=new _(Os,Ws),hs=new _(mn,Ws),Js=new _(Os,Xn),gs=new _(mn,Xn);if(Mr){let Cr=new _(-Jn,Jn-Hh),zr=-Math.PI/2,Xr=Qn/2-Jn,Ho=new _(5-Hh-Xr,-(li.imageName?Xr:0)),dn=new _(...fn);Ls._rotateAround(zr,Cr)._add(Ho)._add(dn),hs._rotateAround(zr,Cr)._add(Ho)._add(dn),Js._rotateAround(zr,Cr)._add(Ho)._add(dn),gs._rotateAround(zr,Cr)._add(Ho)._add(dn)}if(ei){let Cr=Math.sin(ei),zr=Math.cos(ei),Xr=[zr,-Cr,Cr,zr];Ls._matMult(Xr),hs._matMult(Xr),Js._matMult(Xr),gs._matMult(Xr)}let Aa=new _(0,0),bo=new _(0,0);wi.push({tl:Ls,tr:hs,bl:Js,br:gs,tex:Se,writingMode:Ot.writingMode,glyphOffset:Qa,sectionIndex:li.sectionIndex,isSDF:vi,pixelOffsetTL:Aa,pixelOffsetBR:bo,minFontScaleX:0,minFontScaleY:0})}return wi}(0,l,F,C,w,B,h,a.allowVerticalPlacement),Ft=a.textSizeData,Gt=null;Ft.kind==="source"?(Gt=[NA*C.layout.get("text-size").evaluate(B,{})],Gt[0]>Xl&&lt(`${a.layerIds[0]}: Value for "text-size" is >= ${Nh}. Reduce your "text-size".`)):Ft.kind==="composite"&&(Gt=[NA*$.compositeTextSizes[0].evaluate(B,{},st),NA*$.compositeTextSizes[1].evaluate(B,{},st)],(Gt[0]>Xl||Gt[1]>Xl)&&lt(`${a.layerIds[0]}: Value for "text-size" is >= ${Nh}. Reduce your "text-size".`)),a.addSymbols(a.text,ut,Gt,F,w,B,Z,e,T.lineStartIndex,T.lineLength,J,st);for(let Ae of M)D[Ae]=a.text.placedSymbolArray.length-1;return 4*ut.length}function fb(a){for(let e in a)return a[e];return null}function QF(a,e,l,h){let C=a.compareText;if(e in C){let w=C[e];for(let B=w.length-1;B>=0;B--)if(h.dist(w[B])<l)return!0}else C[e]=[];return C[e].push(h),!1}let mb=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Km{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[l,h]=new Uint8Array(e,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");let C=h>>4;if(C!==1)throw new Error(`Got v${C} data when expected v1.`);let w=mb[15&h];if(!w)throw new Error("Unrecognized array type.");let[B]=new Uint16Array(e,2,1),[F]=new Uint32Array(e,4,1);return new Km(F,B,w,e)}constructor(e,l=64,h=Float64Array,C){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=h,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let w=mb.indexOf(this.ArrayType),B=2*e*this.ArrayType.BYTES_PER_ELEMENT,F=e*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-F%8)%8;if(w<0)throw new Error(`Unexpected typed array class: ${h}.`);C&&C instanceof ArrayBuffer?(this.data=C,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+F+T,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+B+F+T),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+F+T,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+w]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=e)}add(e,l){let h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=e,this.coords[this._pos++]=l,h}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return zm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,l,h,C){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:w,coords:B,nodeSize:F}=this,T=[0,w.length-1,0],Z=[];for(;T.length;){let M=T.pop()||0,D=T.pop()||0,J=T.pop()||0;if(D-J<=F){for(let Ft=J;Ft<=D;Ft++){let Gt=B[2*Ft],Ae=B[2*Ft+1];Gt>=e&&Gt<=h&&Ae>=l&&Ae<=C&&Z.push(w[Ft])}continue}let $=J+D>>1,st=B[2*$],ut=B[2*$+1];st>=e&&st<=h&&ut>=l&&ut<=C&&Z.push(w[$]),(M===0?e<=st:l<=ut)&&(T.push(J),T.push($-1),T.push(1-M)),(M===0?h>=st:C>=ut)&&(T.push($+1),T.push(D),T.push(1-M))}return Z}within(e,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:C,coords:w,nodeSize:B}=this,F=[0,C.length-1,0],T=[],Z=h*h;for(;F.length;){let M=F.pop()||0,D=F.pop()||0,J=F.pop()||0;if(D-J<=B){for(let Ft=J;Ft<=D;Ft++)Ib(w[2*Ft],w[2*Ft+1],e,l)<=Z&&T.push(C[Ft]);continue}let $=J+D>>1,st=w[2*$],ut=w[2*$+1];Ib(st,ut,e,l)<=Z&&T.push(C[$]),(M===0?e-h<=st:l-h<=ut)&&(F.push(J),F.push($-1),F.push(1-M)),(M===0?e+h>=st:l+h>=ut)&&(F.push($+1),F.push(D),F.push(1-M))}return T}}function zm(a,e,l,h,C,w){if(C-h<=l)return;let B=h+C>>1;Cb(a,e,B,h,C,w),zm(a,e,l,h,B-1,1-w),zm(a,e,l,B+1,C,1-w)}function Cb(a,e,l,h,C,w){for(;C>h;){if(C-h>600){let Z=C-h+1,M=l-h+1,D=Math.log(Z),J=.5*Math.exp(2*D/3),$=.5*Math.sqrt(D*J*(Z-J)/Z)*(M-Z/2<0?-1:1);Cb(a,e,l,Math.max(h,Math.floor(l-M*J/Z+$)),Math.min(C,Math.floor(l+(Z-M)*J/Z+$)),w)}let B=e[2*l+w],F=h,T=C;for(Dh(a,e,h,l),e[2*C+w]>B&&Dh(a,e,h,C);F<T;){for(Dh(a,e,F,T),F++,T--;e[2*F+w]<B;)F++;for(;e[2*T+w]>B;)T--}e[2*h+w]===B?Dh(a,e,h,T):(T++,Dh(a,e,T,C)),T<=l&&(h=T+1),l<=T&&(C=T-1)}}function Dh(a,e,l,h){Om(a,l,h),Om(e,2*l,2*h),Om(e,2*l+1,2*h+1)}function Om(a,e,l){let h=a[e];a[e]=a[l],a[l]=h}function Ib(a,e,l,h){let C=a-l,w=e-h;return C*C+w*w}var Wm;A.bf=void 0,(Wm=A.bf||(A.bf={})).create="create",Wm.load="load",Wm.fullLoad="fullLoad";let yd=null,Kh=[],Jm=1e3/60,Xm="loadTime",Ym="fullLoadTime",RF={mark(a){performance.mark(a)},frame(a){let e=a;yd!=null&&Kh.push(e-yd),yd=e},clearMetrics(){yd=null,Kh=[],performance.clearMeasures(Xm),performance.clearMeasures(Ym);for(let a in A.bf)performance.clearMarks(A.bf[a])},getPerformanceMetrics(){performance.measure(Xm,A.bf.create,A.bf.load),performance.measure(Ym,A.bf.create,A.bf.fullLoad);let a=performance.getEntriesByName(Xm)[0].duration,e=performance.getEntriesByName(Ym)[0].duration,l=Kh.length,h=1/(Kh.reduce((w,B)=>w+B,0)/l/1e3),C=Kh.filter(w=>w>Jm).reduce((w,B)=>w+(B-Jm)/Jm,0);return{loadTime:a,fullLoadTime:e,fps:h,percentDroppedFrames:C/(l+C)*100,totalFrames:l}}};A.$=class extends P{},A.A=vu,A.B=Ja,A.C=function(a){if(Bt==null){let e=a.navigator?a.navigator.userAgent:null;Bt=!!a.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Bt},A.D=yi,A.E=Xe,A.F=class{constructor(a,e){this.target=a,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new xF(()=>this.process()),this.subscription=function(l,h,C,w){return l.addEventListener(h,C,!1),{unsubscribe:()=>{l.removeEventListener(h,C,!1)}}}(this.target,"message",l=>this.receive(l)),this.globalScope=St(self)?a:window}registerMessageHandler(a,e){this.messageHandlers[a]=e}sendAsync(a,e){return new Promise((l,h)=>{let C=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[C]={resolve:l,reject:h},e&&e.signal.addEventListener("abort",()=>{delete this.resolveRejects[C];let F={id:C,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(F)},{once:!0});let w=[],B=Object.assign(Object.assign({},a),{id:C,sourceMapId:this.mapId,origin:location.origin,data:Fs(a.data,w)});this.target.postMessage(B,{transfer:w})})}receive(a){let e=a.data,l=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[l];let h=this.abortControllers[l];return delete this.abortControllers[l],void(h&&h.abort())}if(St(self)||e.mustQueue)return this.tasks[l]=e,this.taskQueue.push(l),void this.invoker.trigger();this.processTask(l,e)}}process(){if(this.taskQueue.length===0)return;let a=this.taskQueue.shift(),e=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(a,e)}processTask(a,e){return s(this,void 0,void 0,function*(){if(e.type==="<response>"){let C=this.resolveRejects[a];return delete this.resolveRejects[a],C?void(e.error?C.reject(Go(e.error)):C.resolve(Go(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));let l=Go(e.data),h=new AbortController;this.abortControllers[a]=h;try{let C=yield this.messageHandlers[e.type](e.sourceMapId,l,h);this.completeTask(a,null,C)}catch(C){this.completeTask(a,C)}})}completeTask(a,e,l){let h=[];delete this.abortControllers[a];let C={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?Fs(e):null,data:Fs(l,h)};this.target.postMessage(C,{transfer:h})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},A.G=yt,A.H=function(){var a=new vu(16);return vu!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},A.I=Em,A.J=function(a,e,l){var h,C,w,B,F,T,Z,M,D,J,$,st,ut=l[0],Ft=l[1],Gt=l[2];return e===a?(a[12]=e[0]*ut+e[4]*Ft+e[8]*Gt+e[12],a[13]=e[1]*ut+e[5]*Ft+e[9]*Gt+e[13],a[14]=e[2]*ut+e[6]*Ft+e[10]*Gt+e[14],a[15]=e[3]*ut+e[7]*Ft+e[11]*Gt+e[15]):(C=e[1],w=e[2],B=e[3],F=e[4],T=e[5],Z=e[6],M=e[7],D=e[8],J=e[9],$=e[10],st=e[11],a[0]=h=e[0],a[1]=C,a[2]=w,a[3]=B,a[4]=F,a[5]=T,a[6]=Z,a[7]=M,a[8]=D,a[9]=J,a[10]=$,a[11]=st,a[12]=h*ut+F*Ft+D*Gt+e[12],a[13]=C*ut+T*Ft+J*Gt+e[13],a[14]=w*ut+Z*Ft+$*Gt+e[14],a[15]=B*ut+M*Ft+st*Gt+e[15]),a},A.K=function(a,e,l){var h=l[0],C=l[1],w=l[2];return a[0]=e[0]*h,a[1]=e[1]*h,a[2]=e[2]*h,a[3]=e[3]*h,a[4]=e[4]*C,a[5]=e[5]*C,a[6]=e[6]*C,a[7]=e[7]*C,a[8]=e[8]*w,a[9]=e[9]*w,a[10]=e[10]*w,a[11]=e[11]*w,a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},A.L=$y,A.M=function(a,e){let l={};for(let h=0;h<e.length;h++){let C=e[h];C in a&&(l[C]=a[C])}return l},A.N=Yl,A.O=J1,A.P=_,A.Q=X1,A.R=oa,A.S=aa,A.T=Xa,A.U=V,A.V=q,A.W=qt,A.X=Pr,A.Y=x,A.Z=pd,A._=s,A.a=j,A.a$=function(a,e){var l=a[0],h=a[1],C=a[2],w=a[3],B=a[4],F=a[5],T=a[6],Z=a[7],M=a[8],D=a[9],J=a[10],$=a[11],st=a[12],ut=a[13],Ft=a[14],Gt=a[15],Ae=e[0],Ot=e[1],te=e[2],me=e[3],Pe=e[4],oi=e[5],Pi=e[6],ni=e[7],ei=e[8],wi=e[9],di=e[10],li=e[11],Se=e[12],Si=e[13],vi=e[14],Oi=e[15];return Math.abs(l-Ae)<=Ks*Math.max(1,Math.abs(l),Math.abs(Ae))&&Math.abs(h-Ot)<=Ks*Math.max(1,Math.abs(h),Math.abs(Ot))&&Math.abs(C-te)<=Ks*Math.max(1,Math.abs(C),Math.abs(te))&&Math.abs(w-me)<=Ks*Math.max(1,Math.abs(w),Math.abs(me))&&Math.abs(B-Pe)<=Ks*Math.max(1,Math.abs(B),Math.abs(Pe))&&Math.abs(F-oi)<=Ks*Math.max(1,Math.abs(F),Math.abs(oi))&&Math.abs(T-Pi)<=Ks*Math.max(1,Math.abs(T),Math.abs(Pi))&&Math.abs(Z-ni)<=Ks*Math.max(1,Math.abs(Z),Math.abs(ni))&&Math.abs(M-ei)<=Ks*Math.max(1,Math.abs(M),Math.abs(ei))&&Math.abs(D-wi)<=Ks*Math.max(1,Math.abs(D),Math.abs(wi))&&Math.abs(J-di)<=Ks*Math.max(1,Math.abs(J),Math.abs(di))&&Math.abs($-li)<=Ks*Math.max(1,Math.abs($),Math.abs(li))&&Math.abs(st-Se)<=Ks*Math.max(1,Math.abs(st),Math.abs(Se))&&Math.abs(ut-Si)<=Ks*Math.max(1,Math.abs(ut),Math.abs(Si))&&Math.abs(Ft-vi)<=Ks*Math.max(1,Math.abs(Ft),Math.abs(vi))&&Math.abs(Gt-Oi)<=Ks*Math.max(1,Math.abs(Gt),Math.abs(Oi))},A.a0=xr,A.a1=Nm,A.a2=fe,A.a3=a=>{let e=window.document.createElement("video");return e.muted=!0,new Promise(l=>{e.onloadstart=()=>{l(e)};for(let h of a){let C=window.document.createElement("source");ge(h)||(e.crossOrigin="Anonymous"),C.src=h,e.appendChild(C)}})},A.a4=function(){return Et++},A.a5=pi,A.a6=Fu,A.a7=Vr,A.a8=MA,A.a9=vr,A.aA=function(a){a=a.slice();let e=Object.create(null);for(let l=0;l<a.length;l++)e[a[l].id]=a[l];for(let l=0;l<a.length;l++)"ref"in a[l]&&(a[l]=Ut(a[l],e[a[l].ref]));return a},A.aB=function(a){if(a.type==="custom")return new _F(a);switch(a.type){case"background":return new vF(a);case"circle":return new lS(a);case"fill":return new xS(a);case"fill-extrusion":return new NS(a);case"heatmap":return new uS(a);case"hillshade":return new gS(a);case"line":return new XS(a);case"raster":return new BF(a);case"symbol":return new dd(a)}},A.aC=Nt,A.aD=function(a,e){if(!a)return[{command:"setStyle",args:[e]}];let l=[];try{if(!Ye(a.version,e.version))return[{command:"setStyle",args:[e]}];Ye(a.center,e.center)||l.push({command:"setCenter",args:[e.center]}),Ye(a.zoom,e.zoom)||l.push({command:"setZoom",args:[e.zoom]}),Ye(a.bearing,e.bearing)||l.push({command:"setBearing",args:[e.bearing]}),Ye(a.pitch,e.pitch)||l.push({command:"setPitch",args:[e.pitch]}),Ye(a.sprite,e.sprite)||l.push({command:"setSprite",args:[e.sprite]}),Ye(a.glyphs,e.glyphs)||l.push({command:"setGlyphs",args:[e.glyphs]}),Ye(a.transition,e.transition)||l.push({command:"setTransition",args:[e.transition]}),Ye(a.light,e.light)||l.push({command:"setLight",args:[e.light]}),Ye(a.terrain,e.terrain)||l.push({command:"setTerrain",args:[e.terrain]}),Ye(a.sky,e.sky)||l.push({command:"setSky",args:[e.sky]}),Ye(a.projection,e.projection)||l.push({command:"setProjection",args:[e.projection]});let h={},C=[];(function(B,F,T,Z){let M;for(M in F=F||{},B=B||{})Object.prototype.hasOwnProperty.call(B,M)&&(Object.prototype.hasOwnProperty.call(F,M)||Ne(M,T,Z));for(M in F)Object.prototype.hasOwnProperty.call(F,M)&&(Object.prototype.hasOwnProperty.call(B,M)?Ye(B[M],F[M])||(B[M].type==="geojson"&&F[M].type==="geojson"&&We(B,F,M)?Oe(T,{command:"setGeoJSONSourceData",args:[M,F[M].data]}):ze(M,F,T,Z)):Qe(M,F,T))})(a.sources,e.sources,C,h);let w=[];a.layers&&a.layers.forEach(B=>{"source"in B&&h[B.source]?l.push({command:"removeLayer",args:[B.id]}):w.push(B)}),l=l.concat(C),function(B,F,T){F=F||[];let Z=(B=B||[]).map(hi),M=F.map(hi),D=B.reduce(Ti,{}),J=F.reduce(Ti,{}),$=Z.slice(),st=Object.create(null),ut,Ft,Gt,Ae,Ot;for(let te=0,me=0;te<Z.length;te++)ut=Z[te],Object.prototype.hasOwnProperty.call(J,ut)?me++:(Oe(T,{command:"removeLayer",args:[ut]}),$.splice($.indexOf(ut,me),1));for(let te=0,me=0;te<M.length;te++)ut=M[M.length-1-te],$[$.length-1-te]!==ut&&(Object.prototype.hasOwnProperty.call(D,ut)?(Oe(T,{command:"removeLayer",args:[ut]}),$.splice($.lastIndexOf(ut,$.length-me),1)):me++,Ae=$[$.length-te],Oe(T,{command:"addLayer",args:[J[ut],Ae]}),$.splice($.length-te,0,ut),st[ut]=!0);for(let te=0;te<M.length;te++)if(ut=M[te],Ft=D[ut],Gt=J[ut],!st[ut]&&!Ye(Ft,Gt))if(Ye(Ft.source,Gt.source)&&Ye(Ft["source-layer"],Gt["source-layer"])&&Ye(Ft.type,Gt.type)){for(Ot in ri(Ft.layout,Gt.layout,T,ut,null,"setLayoutProperty"),ri(Ft.paint,Gt.paint,T,ut,null,"setPaintProperty"),Ye(Ft.filter,Gt.filter)||Oe(T,{command:"setFilter",args:[ut,Gt.filter]}),Ye(Ft.minzoom,Gt.minzoom)&&Ye(Ft.maxzoom,Gt.maxzoom)||Oe(T,{command:"setLayerZoomRange",args:[ut,Gt.minzoom,Gt.maxzoom]}),Ft)Object.prototype.hasOwnProperty.call(Ft,Ot)&&Ot!=="layout"&&Ot!=="paint"&&Ot!=="filter"&&Ot!=="metadata"&&Ot!=="minzoom"&&Ot!=="maxzoom"&&(Ot.indexOf("paint.")===0?ri(Ft[Ot],Gt[Ot],T,ut,Ot.slice(6),"setPaintProperty"):Ye(Ft[Ot],Gt[Ot])||Oe(T,{command:"setLayerProperty",args:[ut,Ot,Gt[Ot]]}));for(Ot in Gt)Object.prototype.hasOwnProperty.call(Gt,Ot)&&!Object.prototype.hasOwnProperty.call(Ft,Ot)&&Ot!=="layout"&&Ot!=="paint"&&Ot!=="filter"&&Ot!=="metadata"&&Ot!=="minzoom"&&Ot!=="maxzoom"&&(Ot.indexOf("paint.")===0?ri(Ft[Ot],Gt[Ot],T,ut,Ot.slice(6),"setPaintProperty"):Ye(Ft[Ot],Gt[Ot])||Oe(T,{command:"setLayerProperty",args:[ut,Ot,Gt[Ot]]}))}else Oe(T,{command:"removeLayer",args:[ut]}),Ae=$[$.lastIndexOf(ut)+1],Oe(T,{command:"addLayer",args:[Gt,Ae]})}(w,e.layers,l)}catch(h){console.warn("Unable to compute style diff:",h),l=[{command:"setStyle",args:[e]}]}return l},A.aE=function(a){let e=[],l=a.id;return l===void 0&&e.push({message:`layers.${l}: missing required property "id"`}),a.render===void 0&&e.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&e.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),e},A.aF=function a(e,l){if(Array.isArray(e)){if(!Array.isArray(l)||e.length!==l.length)return!1;for(let h=0;h<e.length;h++)if(!a(e[h],l[h]))return!1;return!0}if(typeof e=="object"&&e!==null&&l!==null){if(typeof l!="object"||Object.keys(e).length!==Object.keys(l).length)return!1;for(let h in e)if(!a(e[h],l[h]))return!1;return!0}return e===l},A.aG=xt,A.aH=It,A.aI=class extends pl{constructor(a,e){super(a,e),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},A.aJ=gu,A.aK=class extends pl{constructor(a,e){super(a,e),this.current=du}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let e=1;e<16;e++)if(a[e]!==this.current[e]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},A.aL=id,A.aM=_h,A.aN=Ui,A.aO=class extends pl{constructor(a,e){super(a,e),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},A.aP=class extends pl{constructor(a,e){super(a,e),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},A.aQ=function(a,e,l,h,C,w,B){var F=1/(e-l),T=1/(h-C),Z=1/(w-B);return a[0]=-2*F,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*Z,a[11]=0,a[12]=(e+l)*F,a[13]=(C+h)*T,a[14]=(B+w)*Z,a[15]=1,a},A.aR=AS,A.aS=class extends pt{},A.aT=$S,A.aU=class extends $t{},A.aV=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},A.aW=n1,A.aX=rn,A.aY=yn,A.aZ=class extends Ue{},A.a_=function(a,e){return a[0]===e[0]&&a[1]===e[1]&&a[2]===e[2]&&a[3]===e[3]&&a[4]===e[4]&&a[5]===e[5]&&a[6]===e[6]&&a[7]===e[7]&&a[8]===e[8]&&a[9]===e[9]&&a[10]===e[10]&&a[11]===e[11]&&a[12]===e[12]&&a[13]===e[13]&&a[14]===e[14]&&a[15]===e[15]},A.aa=eb,A.ab=function(a){let e={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,h,C,w)=>{let B=C||w;return e[h]=!B||B.toLowerCase(),""}),e["max-age"]){let l=parseInt(e["max-age"],10);isNaN(l)?delete e["max-age"]:e["max-age"]=l}return e},A.ac=function(a,e){let l=[];for(let h in a)h in e||l.push(h);return l},A.ad=At,A.ae=function(a,e,l){var h=Math.sin(l),C=Math.cos(l),w=e[0],B=e[1],F=e[2],T=e[3],Z=e[4],M=e[5],D=e[6],J=e[7];return e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=w*C+Z*h,a[1]=B*C+M*h,a[2]=F*C+D*h,a[3]=T*C+J*h,a[4]=Z*C-w*h,a[5]=M*C-B*h,a[6]=D*C-F*h,a[7]=J*C-T*h,a},A.af=function(a){var e=new vu(16);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[4]=a[4],e[5]=a[5],e[6]=a[6],e[7]=a[7],e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15],e},A.ag=sd,A.ah=function(a,e){let l=0,h=0;if(a.kind==="constant")h=a.layoutSize;else if(a.kind!=="source"){let{interpolationType:C,minZoom:w,maxZoom:B}=a,F=C?At(Fi.interpolationFactor(C,e,w,B),0,1):0;a.kind==="camera"?h=ci.number(a.minSize,a.maxSize,F):l=F}return{uSizeT:l,uSize:h}},A.aj=function(a,{uSize:e,uSizeT:l},{lowerSize:h,upperSize:C}){return a.kind==="source"?h/NA:a.kind==="composite"?ci.number(h/NA,C/NA,l):e},A.ak=Rm,A.al=function(a,e,l,h){let C=e.y-a.y,w=e.x-a.x,B=h.y-l.y,F=h.x-l.x,T=B*w-F*C;if(T===0)return null;let Z=(F*(a.y-l.y)-B*(a.x-l.x))/T;return new _(a.x+Z*w,a.y+Z*C)},A.am=sb,A.an=Fh,A.ao=mm,A.ap=function(a){let e=1/0,l=1/0,h=-1/0,C=-1/0;for(let w of a)e=Math.min(e,w.x),l=Math.min(l,w.y),h=Math.max(h,w.x),C=Math.max(C,w.y);return[e,l,h,C]},A.aq=Qn,A.as=Qm,A.at=function(a,e){var l=e[0],h=e[1],C=e[2],w=e[3],B=e[4],F=e[5],T=e[6],Z=e[7],M=e[8],D=e[9],J=e[10],$=e[11],st=e[12],ut=e[13],Ft=e[14],Gt=e[15],Ae=l*F-h*B,Ot=l*T-C*B,te=l*Z-w*B,me=h*T-C*F,Pe=h*Z-w*F,oi=C*Z-w*T,Pi=M*ut-D*st,ni=M*Ft-J*st,ei=M*Gt-$*st,wi=D*Ft-J*ut,di=D*Gt-$*ut,li=J*Gt-$*Ft,Se=Ae*li-Ot*di+te*wi+me*ei-Pe*ni+oi*Pi;return Se?(a[0]=(F*li-T*di+Z*wi)*(Se=1/Se),a[1]=(C*di-h*li-w*wi)*Se,a[2]=(ut*oi-Ft*Pe+Gt*me)*Se,a[3]=(J*Pe-D*oi-$*me)*Se,a[4]=(T*ei-B*li-Z*ni)*Se,a[5]=(l*li-C*ei+w*ni)*Se,a[6]=(Ft*te-st*oi-Gt*Ot)*Se,a[7]=(M*oi-J*te+$*Ot)*Se,a[8]=(B*di-F*ei+Z*Pi)*Se,a[9]=(h*ei-l*di-w*Pi)*Se,a[10]=(st*Pe-ut*te+Gt*Ae)*Se,a[11]=(D*te-M*Pe-$*Ae)*Se,a[12]=(F*ni-B*wi-T*Pi)*Se,a[13]=(l*wi-h*ni+C*Pi)*Se,a[14]=(ut*Ot-st*me-Ft*Ae)*Se,a[15]=(M*me-D*Ot+J*Ae)*Se,a):null},A.au=Dm,A.av=Um,A.aw=Km,A.ax=function(){let a={},e=Kt.$version;for(let l in Kt.$root){let h=Kt.$root[l];if(h.required){let C=null;C=l==="version"?e:h.type==="array"?[]:{},C!=null&&(a[l]=C)}}return a},A.ay=Sc,A.az=Ht,A.b=se,A.b0=function(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},A.b1=function(a,e,l){return a[0]=e[0]*l[0],a[1]=e[1]*l[1],a[2]=e[2]*l[2],a[3]=e[3]*l[3],a},A.b2=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]*e[3]},A.b3=_t,A.b4=q1,A.b5=Y1,A.b6=function(a,e,l,h,C){var w,B=1/Math.tan(e/2);return a[0]=B/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=B,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,C!=null&&C!==1/0?(a[10]=(C+h)*(w=1/(h-C)),a[14]=2*C*h*w):(a[10]=-1,a[14]=-2*h),a},A.b7=function(a,e,l){var h=Math.sin(l),C=Math.cos(l),w=e[4],B=e[5],F=e[6],T=e[7],Z=e[8],M=e[9],D=e[10],J=e[11];return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[4]=w*C+Z*h,a[5]=B*C+M*h,a[6]=F*C+D*h,a[7]=T*C+J*h,a[8]=Z*C-w*h,a[9]=M*C-B*h,a[10]=D*C-F*h,a[11]=J*C-T*h,a},A.b8=z,A.b9=it,A.bA=function(a){return a.message===Tt},A.bB=As,A.bC=fo,A.ba=function(a){return a*Math.PI/180},A.bb=function(a,e){return a[0]=e[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=e[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},A.bc=class extends R{},A.bd=Hm,A.be=RF,A.bg=Qt,A.bh=function(a,e){j.REGISTERED_PROTOCOLS[a]=e},A.bi=function(a){delete j.REGISTERED_PROTOCOLS[a]},A.bj=function(a,e){let l={};for(let C=0;C<a.length;C++){let w=e&&e[a[C].id]||kA(a[C]);e&&(e[a[C].id]=w);let B=l[w];B||(B=l[w]=[]),B.push(a[C])}let h=[];for(let C in l)h.push(l[C]);return h},A.bk=Ai,A.bl=tb,A.bm=ib,A.bn=U1,A.bo=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Pr/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;let e=a.bucket.layers[0],l=e.layout,h=e._unevaluatedLayout._values,C={layoutIconSize:h["icon-size"].possiblyEvaluate(new vr(a.bucket.zoom+1),a.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new vr(a.bucket.zoom+1),a.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new vr(18))};if(a.bucket.textSizeData.kind==="composite"){let{minZoom:Z,maxZoom:M}=a.bucket.textSizeData;C.compositeTextSizes=[h["text-size"].possiblyEvaluate(new vr(Z),a.canonical),h["text-size"].possiblyEvaluate(new vr(M),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){let{minZoom:Z,maxZoom:M}=a.bucket.iconSizeData;C.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new vr(Z),a.canonical),h["icon-size"].possiblyEvaluate(new vr(M),a.canonical)]}let w=l.get("text-line-height")*Qn,B=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",F=l.get("text-keep-upright"),T=l.get("text-size");for(let Z of a.bucket.features){let M=l.get("text-font").evaluate(Z,{},a.canonical).join(","),D=T.evaluate(Z,{},a.canonical),J=C.layoutTextSize.evaluate(Z,{},a.canonical),$=C.layoutIconSize.evaluate(Z,{},a.canonical),st={horizontal:{},vertical:void 0},ut=Z.text,Ft,Gt=[0,0];if(ut){let te=ut.toString(),me=l.get("text-letter-spacing").evaluate(Z,{},a.canonical)*Qn,Pe=Bh(te)?me:0,oi=l.get("text-anchor").evaluate(Z,{},a.canonical),Pi=db(e,Z,a.canonical);if(!Pi){let di=l.get("text-radial-offset").evaluate(Z,{},a.canonical);Gt=di?gb(oi,[di*Qn,Vm]):l.get("text-offset").evaluate(Z,{},a.canonical).map(li=>li*Qn)}let ni=B?"center":l.get("text-justify").evaluate(Z,{},a.canonical),ei=l.get("symbol-placement")==="point"?l.get("text-max-width").evaluate(Z,{},a.canonical)*Qn:1/0,wi=()=>{a.bucket.allowVerticalPlacement&&ls(te)&&(st.vertical=ud(ut,a.glyphMap,a.glyphPositions,a.imagePositions,M,ei,w,oi,"left",Pe,Gt,A.ai.vertical,!0,J,D))};if(!B&&Pi){let di=new Set;if(ni==="auto")for(let Se=0;Se<Pi.values.length;Se+=2)di.add(Dm(Pi.values[Se]));else di.add(ni);let li=!1;for(let Se of di)if(!st.horizontal[Se])if(li)st.horizontal[Se]=st.horizontal[0];else{let Si=ud(ut,a.glyphMap,a.glyphPositions,a.imagePositions,M,ei,w,"center",Se,Pe,Gt,A.ai.horizontal,!1,J,D);Si&&(st.horizontal[Se]=Si,li=Si.positionedLines.length===1)}wi()}else{ni==="auto"&&(ni=Dm(oi));let di=ud(ut,a.glyphMap,a.glyphPositions,a.imagePositions,M,ei,w,oi,ni,Pe,Gt,A.ai.horizontal,!1,J,D);di&&(st.horizontal[ni]=di),wi(),ls(te)&&B&&F&&(st.vertical=ud(ut,a.glyphMap,a.glyphPositions,a.imagePositions,M,ei,w,oi,ni,Pe,Gt,A.ai.vertical,!1,J,D))}}let Ae=!1;if(Z.icon&&Z.icon.name){let te=a.imageMap[Z.icon.name];te&&(Ft=mF(a.imagePositions[Z.icon.name],l.get("icon-offset").evaluate(Z,{},a.canonical),l.get("icon-anchor").evaluate(Z,{},a.canonical)),Ae=!!te.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=Ae:a.bucket.sdfIcons!==Ae&&lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(te.pixelRatio!==a.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}let Ot=fb(st.horizontal)||st.vertical;a.bucket.iconsInText=!!Ot&&Ot.iconsInText,(Ot||Ft)&&UF(a.bucket,Z,st,Ft,a.imageMap,C,J,$,Gt,Ae,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},A.bp=Sm,A.bq=Bm,A.br=xm,A.bs=Wl,A.bt=km,A.bu=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},A.bv=function(a,e,l,h,C){return s(this,void 0,void 0,function*(){if(q())try{return yield qt(a,e,l,h,C)}catch{}return function(w,B,F,T,Z){let M=w.width,D=w.height;Xt&&vt||(Xt=new OffscreenCanvas(M,D),vt=Xt.getContext("2d",{willReadFrequently:!0})),Xt.width=M,Xt.height=D,vt.drawImage(w,0,0,M,D);let J=vt.getImageData(B,F,T,Z);return vt.clearRect(0,0,M,D),J.data}(a,e,l,h,C)})},A.bw=$1,A.bx=d,A.by=f,A.bz=B1,A.c=pe,A.d=a=>s(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));let e=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(e)}catch(l){throw new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),A.e=Lt,A.f=a=>new Promise((e,l)=>{let h=new Image;h.onload=()=>{e(h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame(()=>{h.src=ee})},h.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let C=new Blob([new Uint8Array(a)],{type:"image/png"});h.src=a.byteLength?URL.createObjectURL(C):ee}),A.g=mt,A.h=(a,e)=>ae(Lt(a,{type:"json"}),e),A.i=St,A.j=Je,A.k=Re,A.l=(a,e)=>ae(Lt(a,{type:"arrayBuffer"}),e),A.m=ae,A.n=function(a){return new km(a).readFields(cF,[])},A.o=Th,A.p=T1,A.q=p,A.r=xc,A.s=ge,A.t=Nl,A.u=qe,A.v=Kt,A.w=lt,A.x=po,A.y=function([a,e,l]){return e+=90,e*=Math.PI/180,l*=Math.PI/180,{x:a*Math.cos(e)*Math.sin(l),y:a*Math.sin(e)*Math.sin(l),z:a*Math.cos(l)}},A.z=ci}),r("worker",["./shared"],function(A){"use strict";class s{constructor(W){this.keyCache={},W&&this.replace(W)}replace(W){this._layerConfigs={},this._layers={},this.update(W,[])}update(W,X){for(let ft of W){this._layerConfigs[ft.id]=ft;let Mt=this._layers[ft.id]=A.aB(ft);Mt._featureFilter=A.a7(Mt.filter),this.keyCache[ft.id]&&delete this.keyCache[ft.id]}for(let ft of X)delete this.keyCache[ft],delete this._layerConfigs[ft],delete this._layers[ft];this.familiesBySource={};let rt=A.bj(Object.values(this._layerConfigs),this.keyCache);for(let ft of rt){let Mt=ft.map(he=>this._layers[he.id]),Vt=Mt[0];if(Vt.visibility==="none")continue;let Yt=Vt.source||"",Rt=this.familiesBySource[Yt];Rt||(Rt=this.familiesBySource[Yt]={});let Wt=Vt.sourceLayer||"_geojsonTileLayer",be=Rt[Wt];be||(be=Rt[Wt]=[]),be.push(Mt)}}}class d{constructor(W){let X={},rt=[];for(let Yt in W){let Rt=W[Yt],Wt=X[Yt]={};for(let be in Rt){let he=Rt[+be];if(!he||he.bitmap.width===0||he.bitmap.height===0)continue;let Le={x:0,y:0,w:he.bitmap.width+2,h:he.bitmap.height+2};rt.push(Le),Wt[be]={rect:Le,metrics:he.metrics}}}let{w:ft,h:Mt}=A.p(rt),Vt=new A.o({width:ft||1,height:Mt||1});for(let Yt in W){let Rt=W[Yt];for(let Wt in Rt){let be=Rt[+Wt];if(!be||be.bitmap.width===0||be.bitmap.height===0)continue;let he=X[Yt][Wt].rect;A.o.copy(be.bitmap,Vt,{x:0,y:0},{x:he.x+1,y:he.y+1},be.bitmap)}}this.image=Vt,this.positions=X}}A.bk("GlyphAtlas",d);class f{constructor(W){this.tileID=new A.S(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId,this.inFlightDependencies=[]}parse(W,X,rt,ft){return A._(this,void 0,void 0,function*(){this.status="parsing",this.data=W,this.collisionBoxArray=new A.a5;let Mt=new A.bl(Object.keys(W.layers).sort()),Vt=new A.bm(this.tileID,this.promoteId);Vt.bucketLayerIDs=[];let Yt={},Rt={featureIndex:Vt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:rt},Wt=X.familiesBySource[this.source];for(let Hi in Wt){let Wi=W.layers[Hi];if(!Wi)continue;Wi.version===1&&A.w(`Vector tile source "${this.source}" layer "${Hi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let Ar=Mt.encode(Hi),Zt=[];for(let De=0;De<Wi.length;De++){let Te=Wi.feature(De),tr=Vt.getId(Te,Hi);Zt.push({feature:Te,id:tr,index:De,sourceLayerIndex:Ar})}for(let De of Wt[Hi]){let Te=De[0];Te.source!==this.source&&A.w(`layer.source = ${Te.source} does not equal this.source = ${this.source}`),Te.minzoom&&this.zoom<Math.floor(Te.minzoom)||Te.maxzoom&&this.zoom>=Te.maxzoom||Te.visibility!=="none"&&(I(De,this.zoom,rt),(Yt[Te.id]=Te.createBucket({index:Vt.bucketLayerIDs.length,layers:De,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ar,sourceID:this.source})).populate(Zt,Rt,this.tileID.canonical),Vt.bucketLayerIDs.push(De.map(tr=>tr.id)))}}let be=A.aG(Rt.glyphDependencies,Hi=>Object.keys(Hi).map(Number));this.inFlightDependencies.forEach(Hi=>Hi?.abort()),this.inFlightDependencies=[];let he=Promise.resolve({});if(Object.keys(be).length){let Hi=new AbortController;this.inFlightDependencies.push(Hi),he=ft.sendAsync({type:"GG",data:{stacks:be,source:this.source,tileID:this.tileID,type:"glyphs"}},Hi)}let Le=Object.keys(Rt.iconDependencies),je=Promise.resolve({});if(Le.length){let Hi=new AbortController;this.inFlightDependencies.push(Hi),je=ft.sendAsync({type:"GI",data:{icons:Le,source:this.source,tileID:this.tileID,type:"icons"}},Hi)}let ti=Object.keys(Rt.patternDependencies),_i=Promise.resolve({});if(ti.length){let Hi=new AbortController;this.inFlightDependencies.push(Hi),_i=ft.sendAsync({type:"GI",data:{icons:ti,source:this.source,tileID:this.tileID,type:"patterns"}},Hi)}let[$i,xi,zi]=yield Promise.all([he,je,_i]),hr=new d($i),fr=new A.bn(xi,zi);for(let Hi in Yt){let Wi=Yt[Hi];Wi instanceof A.a6?(I(Wi.layers,this.zoom,rt),A.bo({bucket:Wi,glyphMap:$i,glyphPositions:hr.positions,imageMap:xi,imagePositions:fr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Wi.hasPattern&&(Wi instanceof A.bp||Wi instanceof A.bq||Wi instanceof A.br)&&(I(Wi.layers,this.zoom,rt),Wi.addFeatures(Rt,this.tileID.canonical,fr.patternPositions))}return this.status="done",{buckets:Object.values(Yt).filter(Hi=>!Hi.isEmpty()),featureIndex:Vt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:hr.image,imageAtlas:fr,glyphMap:this.returnDependencies?$i:null,iconMap:this.returnDependencies?xi:null,glyphPositions:this.returnDependencies?hr.positions:null}})}}function I(wt,W,X){let rt=new A.a9(W);for(let ft of wt)ft.recalculate(rt,X)}class _{constructor(W,X,rt){this.actor=W,this.layerIndex=X,this.availableImages=rt,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(W,X){return A._(this,void 0,void 0,function*(){let rt=yield A.l(W.request,X);try{return{vectorTile:new A.bs.VectorTile(new A.bt(rt.data)),rawData:rt.data,cacheControl:rt.cacheControl,expires:rt.expires}}catch(ft){let Mt=new Uint8Array(rt.data),Vt=`Unable to parse the tile at ${W.request.url}, `;throw Vt+=Mt[0]===31&&Mt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ft.message}`,new Error(Vt)}})}loadTile(W){return A._(this,void 0,void 0,function*(){let X=W.uid,rt=!!(W&&W.request&&W.request.collectResourceTiming)&&new A.bu(W.request),ft=new f(W);this.loading[X]=ft;let Mt=new AbortController;ft.abort=Mt;try{let Vt=yield this.loadVectorTile(W,Mt);if(delete this.loading[X],!Vt)return null;let Yt=Vt.rawData,Rt={};Vt.expires&&(Rt.expires=Vt.expires),Vt.cacheControl&&(Rt.cacheControl=Vt.cacheControl);let Wt={};if(rt){let he=rt.finish();he&&(Wt.resourceTiming=JSON.parse(JSON.stringify(he)))}ft.vectorTile=Vt.vectorTile;let be=ft.parse(Vt.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[X]=ft,this.fetching[X]={rawTileData:Yt,cacheControl:Rt,resourceTiming:Wt};try{let he=yield be;return A.e({rawTileData:Yt.slice(0)},he,Rt,Wt)}finally{delete this.fetching[X]}}catch(Vt){throw delete this.loading[X],ft.status="done",this.loaded[X]=ft,Vt}})}reloadTile(W){return A._(this,void 0,void 0,function*(){let X=W.uid;if(!this.loaded||!this.loaded[X])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let rt=this.loaded[X];if(rt.showCollisionBoxes=W.showCollisionBoxes,rt.status==="parsing"){let ft=yield rt.parse(rt.vectorTile,this.layerIndex,this.availableImages,this.actor),Mt;if(this.fetching[X]){let{rawTileData:Vt,cacheControl:Yt,resourceTiming:Rt}=this.fetching[X];delete this.fetching[X],Mt=A.e({rawTileData:Vt.slice(0)},ft,Yt,Rt)}else Mt=ft;return Mt}if(rt.status==="done"&&rt.vectorTile)return rt.parse(rt.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(W){return A._(this,void 0,void 0,function*(){let X=this.loading,rt=W.uid;X&&X[rt]&&X[rt].abort&&(X[rt].abort.abort(),delete X[rt])})}removeTile(W){return A._(this,void 0,void 0,function*(){this.loaded&&this.loaded[W.uid]&&delete this.loaded[W.uid]})}}class S{constructor(){this.loaded={}}loadTile(W){return A._(this,void 0,void 0,function*(){let{uid:X,encoding:rt,rawImageData:ft,redFactor:Mt,greenFactor:Vt,blueFactor:Yt,baseShift:Rt}=W,Wt=ft.width+2,be=ft.height+2,he=A.b(ft)?new A.R({width:Wt,height:be},yield A.bv(ft,-1,-1,Wt,be)):ft,Le=new A.bw(X,he,rt,Mt,Vt,Yt,Rt);return this.loaded=this.loaded||{},this.loaded[X]=Le,Le})}removeTile(W){let X=this.loaded,rt=W.uid;X&&X[rt]&&delete X[rt]}}function U(wt,W){if(wt.length!==0){G(wt[0],W);for(var X=1;X<wt.length;X++)G(wt[X],!W)}}function G(wt,W){for(var X=0,rt=0,ft=0,Mt=wt.length,Vt=Mt-1;ft<Mt;Vt=ft++){var Yt=(wt[ft][0]-wt[Vt][0])*(wt[Vt][1]+wt[ft][1]),Rt=X+Yt;rt+=Math.abs(X)>=Math.abs(Yt)?X-Rt+Yt:Yt-Rt+X,X=Rt}X+rt>=0!=!!W&&wt.reverse()}var L=A.bx(function wt(W,X){var rt,ft=W&&W.type;if(ft==="FeatureCollection")for(rt=0;rt<W.features.length;rt++)wt(W.features[rt],X);else if(ft==="GeometryCollection")for(rt=0;rt<W.geometries.length;rt++)wt(W.geometries[rt],X);else if(ft==="Feature")wt(W.geometry,X);else if(ft==="Polygon")U(W.coordinates,X);else if(ft==="MultiPolygon")for(rt=0;rt<W.coordinates.length;rt++)U(W.coordinates[rt],X);return W});let K=A.bs.VectorTileFeature.prototype.toGeoJSON;var V={exports:{}},q=A.by,z=A.bs.VectorTileFeature,it=At;function At(wt,W){this.options=W||{},this.features=wt,this.length=wt.length}function _t(wt,W){this.id=typeof wt.id=="number"?wt.id:void 0,this.type=wt.type,this.rawGeometry=wt.type===1?[wt.geometry]:wt.geometry,this.properties=wt.tags,this.extent=W||4096}At.prototype.feature=function(wt){return new _t(this.features[wt],this.options.extent)},_t.prototype.loadGeometry=function(){var wt=this.rawGeometry;this.geometry=[];for(var W=0;W<wt.length;W++){for(var X=wt[W],rt=[],ft=0;ft<X.length;ft++)rt.push(new q(X[ft][0],X[ft][1]));this.geometry.push(rt)}return this.geometry},_t.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var wt=this.geometry,W=1/0,X=-1/0,rt=1/0,ft=-1/0,Mt=0;Mt<wt.length;Mt++)for(var Vt=wt[Mt],Yt=0;Yt<Vt.length;Yt++){var Rt=Vt[Yt];W=Math.min(W,Rt.x),X=Math.max(X,Rt.x),rt=Math.min(rt,Rt.y),ft=Math.max(ft,Rt.y)}return[W,rt,X,ft]},_t.prototype.toGeoJSON=z.prototype.toGeoJSON;var Lt=A.bz,Et=it;function xt(wt){var W=new Lt;return function(X,rt){for(var ft in X.layers)rt.writeMessage(3,It,X.layers[ft])}(wt,W),W.finish()}function It(wt,W){var X;W.writeVarintField(15,wt.version||1),W.writeStringField(1,wt.name||""),W.writeVarintField(5,wt.extent||4096);var rt={keys:[],values:[],keycache:{},valuecache:{}};for(X=0;X<wt.length;X++)rt.feature=wt.feature(X),W.writeMessage(2,Nt,rt);var ft=rt.keys;for(X=0;X<ft.length;X++)W.writeStringField(3,ft[X]);var Mt=rt.values;for(X=0;X<Mt.length;X++)W.writeMessage(4,Bt,Mt[X])}function Nt(wt,W){var X=wt.feature;X.id!==void 0&&W.writeVarintField(1,X.id),W.writeMessage(2,ie,wt),W.writeVarintField(3,X.type),W.writeMessage(4,St,X)}function ie(wt,W){var X=wt.feature,rt=wt.keys,ft=wt.values,Mt=wt.keycache,Vt=wt.valuecache;for(var Yt in X.properties){var Rt=X.properties[Yt],Wt=Mt[Yt];if(Rt!==null){Wt===void 0&&(rt.push(Yt),Mt[Yt]=Wt=rt.length-1),W.writeVarint(Wt);var be=typeof Rt;be!=="string"&&be!=="boolean"&&be!=="number"&&(Rt=JSON.stringify(Rt));var he=be+":"+Rt,Le=Vt[he];Le===void 0&&(ft.push(Rt),Vt[he]=Le=ft.length-1),W.writeVarint(Le)}}}function lt(wt,W){return(W<<3)+(7&wt)}function at(wt){return wt<<1^wt>>31}function St(wt,W){for(var X=wt.loadGeometry(),rt=wt.type,ft=0,Mt=0,Vt=X.length,Yt=0;Yt<Vt;Yt++){var Rt=X[Yt],Wt=1;rt===1&&(Wt=Rt.length),W.writeVarint(lt(1,Wt));for(var be=rt===3?Rt.length-1:Rt.length,he=0;he<be;he++){he===1&&rt!==1&&W.writeVarint(lt(2,be-1));var Le=Rt[he].x-ft,je=Rt[he].y-Mt;W.writeVarint(at(Le)),W.writeVarint(at(je)),ft+=Le,Mt+=je}rt===3&&W.writeVarint(lt(7,1))}}function Bt(wt,W){var X=typeof wt;X==="string"?W.writeStringField(1,wt):X==="boolean"?W.writeBooleanField(7,wt):X==="number"&&(wt%1!=0?W.writeDoubleField(3,wt):wt<0?W.writeSVarintField(6,wt):W.writeVarintField(5,wt))}V.exports=xt,V.exports.fromVectorTileJs=xt,V.exports.fromGeojsonVt=function(wt,W){W=W||{};var X={};for(var rt in wt)X[rt]=new Et(wt[rt].features,W),X[rt].name=rt,X[rt].version=W.version,X[rt].extent=W.extent;return xt({layers:X})},V.exports.GeoJSONWrapper=Et;var se=A.bx(V.exports);let ee={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:wt=>wt},qt=Math.fround||(Xt=new Float32Array(1),wt=>(Xt[0]=+wt,Xt[0]));var Xt;let vt=3,Tt=5,pe=6;class j{constructor(W){this.options=Object.assign(Object.create(ee),W),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(W){let{log:X,minZoom:rt,maxZoom:ft}=this.options;X&&console.time("total time");let Mt=`prepare ${W.length} points`;X&&console.time(Mt),this.points=W;let Vt=[];for(let Rt=0;Rt<W.length;Rt++){let Wt=W[Rt];if(!Wt.geometry)continue;let[be,he]=Wt.geometry.coordinates,Le=qt(Qt(be)),je=qt(Ht(he));Vt.push(Le,je,1/0,Rt,-1,1),this.options.reduce&&Vt.push(0)}let Yt=this.trees[ft+1]=this._createTree(Vt);X&&console.timeEnd(Mt);for(let Rt=ft;Rt>=rt;Rt--){let Wt=+Date.now();Yt=this.trees[Rt]=this._createTree(this._cluster(Yt,Rt)),X&&console.log("z%d: %d clusters in %dms",Rt,Yt.numItems,+Date.now()-Wt)}return X&&console.timeEnd("total time"),this}getClusters(W,X){let rt=((W[0]+180)%360+360)%360-180,ft=Math.max(-90,Math.min(90,W[1])),Mt=W[2]===180?180:((W[2]+180)%360+360)%360-180,Vt=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)rt=-180,Mt=180;else if(rt>Mt){let he=this.getClusters([rt,ft,180,Vt],X),Le=this.getClusters([-180,ft,Mt,Vt],X);return he.concat(Le)}let Yt=this.trees[this._limitZoom(X)],Rt=Yt.range(Qt(rt),Ht(Vt),Qt(Mt),Ht(ft)),Wt=Yt.data,be=[];for(let he of Rt){let Le=this.stride*he;be.push(Wt[Le+Tt]>1?mt(Wt,Le,this.clusterProps):this.points[Wt[Le+vt]])}return be}getChildren(W){let X=this._getOriginId(W),rt=this._getOriginZoom(W),ft="No cluster with the specified id.",Mt=this.trees[rt];if(!Mt)throw new Error(ft);let Vt=Mt.data;if(X*this.stride>=Vt.length)throw new Error(ft);let Yt=this.options.radius/(this.options.extent*Math.pow(2,rt-1)),Rt=Mt.within(Vt[X*this.stride],Vt[X*this.stride+1],Yt),Wt=[];for(let be of Rt){let he=be*this.stride;Vt[he+4]===W&&Wt.push(Vt[he+Tt]>1?mt(Vt,he,this.clusterProps):this.points[Vt[he+vt]])}if(Wt.length===0)throw new Error(ft);return Wt}getLeaves(W,X,rt){let ft=[];return this._appendLeaves(ft,W,X=X||10,rt=rt||0,0),ft}getTile(W,X,rt){let ft=this.trees[this._limitZoom(W)],Mt=Math.pow(2,W),{extent:Vt,radius:Yt}=this.options,Rt=Yt/Vt,Wt=(rt-Rt)/Mt,be=(rt+1+Rt)/Mt,he={features:[]};return this._addTileFeatures(ft.range((X-Rt)/Mt,Wt,(X+1+Rt)/Mt,be),ft.data,X,rt,Mt,he),X===0&&this._addTileFeatures(ft.range(1-Rt/Mt,Wt,1,be),ft.data,Mt,rt,Mt,he),X===Mt-1&&this._addTileFeatures(ft.range(0,Wt,Rt/Mt,be),ft.data,-1,rt,Mt,he),he.features.length?he:null}getClusterExpansionZoom(W){let X=this._getOriginZoom(W)-1;for(;X<=this.options.maxZoom;){let rt=this.getChildren(W);if(X++,rt.length!==1)break;W=rt[0].properties.cluster_id}return X}_appendLeaves(W,X,rt,ft,Mt){let Vt=this.getChildren(X);for(let Yt of Vt){let Rt=Yt.properties;if(Rt&&Rt.cluster?Mt+Rt.point_count<=ft?Mt+=Rt.point_count:Mt=this._appendLeaves(W,Rt.cluster_id,rt,ft,Mt):Mt<ft?Mt++:W.push(Yt),W.length===rt)break}return Mt}_createTree(W){let X=new A.aw(W.length/this.stride|0,this.options.nodeSize,Float32Array);for(let rt=0;rt<W.length;rt+=this.stride)X.add(W[rt],W[rt+1]);return X.finish(),X.data=W,X}_addTileFeatures(W,X,rt,ft,Mt,Vt){for(let Yt of W){let Rt=Yt*this.stride,Wt=X[Rt+Tt]>1,be,he,Le;if(Wt)be=yt(X,Rt,this.clusterProps),he=X[Rt],Le=X[Rt+1];else{let _i=this.points[X[Rt+vt]];be=_i.properties;let[$i,xi]=_i.geometry.coordinates;he=Qt($i),Le=Ht(xi)}let je={type:1,geometry:[[Math.round(this.options.extent*(he*Mt-rt)),Math.round(this.options.extent*(Le*Mt-ft))]],tags:be},ti;ti=Wt||this.options.generateId?X[Rt+vt]:this.points[X[Rt+vt]].id,ti!==void 0&&(je.id=ti),Vt.features.push(je)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))}_cluster(W,X){let{radius:rt,extent:ft,reduce:Mt,minPoints:Vt}=this.options,Yt=rt/(ft*Math.pow(2,X)),Rt=W.data,Wt=[],be=this.stride;for(let he=0;he<Rt.length;he+=be){if(Rt[he+2]<=X)continue;Rt[he+2]=X;let Le=Rt[he],je=Rt[he+1],ti=W.within(Rt[he],Rt[he+1],Yt),_i=Rt[he+Tt],$i=_i;for(let xi of ti){let zi=xi*be;Rt[zi+2]>X&&($i+=Rt[zi+Tt])}if($i>_i&&$i>=Vt){let xi,zi=Le*_i,hr=je*_i,fr=-1,Hi=((he/be|0)<<5)+(X+1)+this.points.length;for(let Wi of ti){let Ar=Wi*be;if(Rt[Ar+2]<=X)continue;Rt[Ar+2]=X;let Zt=Rt[Ar+Tt];zi+=Rt[Ar]*Zt,hr+=Rt[Ar+1]*Zt,Rt[Ar+4]=Hi,Mt&&(xi||(xi=this._map(Rt,he,!0),fr=this.clusterProps.length,this.clusterProps.push(xi)),Mt(xi,this._map(Rt,Ar)))}Rt[he+4]=Hi,Wt.push(zi/$i,hr/$i,1/0,Hi,-1,$i),Mt&&Wt.push(fr)}else{for(let xi=0;xi<be;xi++)Wt.push(Rt[he+xi]);if($i>1)for(let xi of ti){let zi=xi*be;if(!(Rt[zi+2]<=X)){Rt[zi+2]=X;for(let hr=0;hr<be;hr++)Wt.push(Rt[zi+hr])}}}}return Wt}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,X,rt){if(W[X+Tt]>1){let Vt=this.clusterProps[W[X+pe]];return rt?Object.assign({},Vt):Vt}let ft=this.points[W[X+vt]].properties,Mt=this.options.map(ft);return rt&&Mt===ft?Object.assign({},Mt):Mt}}function mt(wt,W,X){return{type:"Feature",id:wt[W+vt],properties:yt(wt,W,X),geometry:{type:"Point",coordinates:[(rt=wt[W],360*(rt-.5)),ae(wt[W+1])]}};var rt}function yt(wt,W,X){let rt=wt[W+Tt],ft=rt>=1e4?`${Math.round(rt/1e3)}k`:rt>=1e3?Math.round(rt/100)/10+"k":rt,Mt=wt[W+pe],Vt=Mt===-1?{}:Object.assign({},X[Mt]);return Object.assign(Vt,{cluster:!0,cluster_id:wt[W+vt],point_count:rt,point_count_abbreviated:ft})}function Qt(wt){return wt/360+.5}function Ht(wt){let W=Math.sin(wt*Math.PI/180),X=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return X<0?0:X>1?1:X}function ae(wt){let W=(180-360*wt)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function ge(wt,W,X,rt){let ft=rt,Mt=W+(X-W>>1),Vt,Yt=X-W,Rt=wt[W],Wt=wt[W+1],be=wt[X],he=wt[X+1];for(let Le=W+3;Le<X;Le+=3){let je=de(wt[Le],wt[Le+1],Rt,Wt,be,he);if(je>ft)Vt=Le,ft=je;else if(je===ft){let ti=Math.abs(Le-Mt);ti<Yt&&(Vt=Le,Yt=ti)}}ft>rt&&(Vt-W>3&&ge(wt,W,Vt,rt),wt[Vt+2]=ft,X-Vt>3&&ge(wt,Vt,X,rt))}function de(wt,W,X,rt,ft,Mt){let Vt=ft-X,Yt=Mt-rt;if(Vt!==0||Yt!==0){let Rt=((wt-X)*Vt+(W-rt)*Yt)/(Vt*Vt+Yt*Yt);Rt>1?(X=ft,rt=Mt):Rt>0&&(X+=Vt*Rt,rt+=Yt*Rt)}return Vt=wt-X,Yt=W-rt,Vt*Vt+Yt*Yt}function Ze(wt,W,X,rt){let ft={id:wt??null,type:W,geometry:X,tags:rt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(W==="Point"||W==="MultiPoint"||W==="LineString")Re(ft,X);else if(W==="Polygon")Re(ft,X[0]);else if(W==="MultiLineString")for(let Mt of X)Re(ft,Mt);else if(W==="MultiPolygon")for(let Mt of X)Re(ft,Mt[0]);return ft}function Re(wt,W){for(let X=0;X<W.length;X+=3)wt.minX=Math.min(wt.minX,W[X]),wt.minY=Math.min(wt.minY,W[X+1]),wt.maxX=Math.max(wt.maxX,W[X]),wt.maxY=Math.max(wt.maxY,W[X+1])}function Je(wt,W,X,rt){if(!W.geometry)return;let ft=W.geometry.coordinates;if(ft&&ft.length===0)return;let Mt=W.geometry.type,Vt=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2),Yt=[],Rt=W.id;if(X.promoteId?Rt=W.properties[X.promoteId]:X.generateId&&(Rt=rt||0),Mt==="Point")Xe(ft,Yt);else if(Mt==="MultiPoint")for(let Wt of ft)Xe(Wt,Yt);else if(Mt==="LineString")Kt(ft,Yt,Vt,!1);else if(Mt==="MultiLineString"){if(X.lineMetrics){for(let Wt of ft)Yt=[],Kt(Wt,Yt,Vt,!1),wt.push(Ze(Rt,"LineString",Yt,W.properties));return}Ce(ft,Yt,Vt,!1)}else if(Mt==="Polygon")Ce(ft,Yt,Vt,!0);else{if(Mt!=="MultiPolygon"){if(Mt==="GeometryCollection"){for(let Wt of W.geometry.geometries)Je(wt,{id:Rt,geometry:Wt,properties:W.properties},X,rt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let Wt of ft){let be=[];Ce(Wt,be,Vt,!0),Yt.push(be)}}wt.push(Ze(Rt,Mt,Yt,W.properties))}function Xe(wt,W){W.push(Ut(wt[0]),Ye(wt[1]),0)}function Kt(wt,W,X,rt){let ft,Mt,Vt=0;for(let Rt=0;Rt<wt.length;Rt++){let Wt=Ut(wt[Rt][0]),be=Ye(wt[Rt][1]);W.push(Wt,be,0),Rt>0&&(Vt+=rt?(ft*be-Wt*Mt)/2:Math.sqrt(Math.pow(Wt-ft,2)+Math.pow(be-Mt,2))),ft=Wt,Mt=be}let Yt=W.length-3;W[2]=1,ge(W,0,Yt,X),W[Yt+2]=1,W.size=Math.abs(Vt),W.start=0,W.end=W.size}function Ce(wt,W,X,rt){for(let ft=0;ft<wt.length;ft++){let Mt=[];Kt(wt[ft],Mt,X,rt),W.push(Mt)}}function Ut(wt){return wt/360+.5}function Ye(wt){let W=Math.sin(wt*Math.PI/180),X=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return X<0?0:X>1?1:X}function Oe(wt,W,X,rt,ft,Mt,Vt,Yt){if(rt/=W,Mt>=(X/=W)&&Vt<rt)return wt;if(Vt<X||Mt>=rt)return null;let Rt=[];for(let Wt of wt){let be=Wt.geometry,he=Wt.type,Le=ft===0?Wt.minX:Wt.minY,je=ft===0?Wt.maxX:Wt.maxY;if(Le>=X&&je<rt){Rt.push(Wt);continue}if(je<X||Le>=rt)continue;let ti=[];if(he==="Point"||he==="MultiPoint")Qe(be,ti,X,rt,ft);else if(he==="LineString")Ne(be,ti,X,rt,ft,!1,Yt.lineMetrics);else if(he==="MultiLineString")We(be,ti,X,rt,ft,!1);else if(he==="Polygon")We(be,ti,X,rt,ft,!0);else if(he==="MultiPolygon")for(let _i of be){let $i=[];We(_i,$i,X,rt,ft,!0),$i.length&&ti.push($i)}if(ti.length){if(Yt.lineMetrics&&he==="LineString"){for(let _i of ti)Rt.push(Ze(Wt.id,he,_i,Wt.tags));continue}he!=="LineString"&&he!=="MultiLineString"||(ti.length===1?(he="LineString",ti=ti[0]):he="MultiLineString"),he!=="Point"&&he!=="MultiPoint"||(he=ti.length===3?"Point":"MultiPoint"),Rt.push(Ze(Wt.id,he,ti,Wt.tags))}}return Rt.length?Rt:null}function Qe(wt,W,X,rt,ft){for(let Mt=0;Mt<wt.length;Mt+=3){let Vt=wt[Mt+ft];Vt>=X&&Vt<=rt&&ri(W,wt[Mt],wt[Mt+1],wt[Mt+2])}}function Ne(wt,W,X,rt,ft,Mt,Vt){let Yt=ze(wt),Rt=ft===0?hi:Ti,Wt,be,he=wt.start;for(let $i=0;$i<wt.length-3;$i+=3){let xi=wt[$i],zi=wt[$i+1],hr=wt[$i+2],fr=wt[$i+3],Hi=wt[$i+4],Wi=ft===0?xi:zi,Ar=ft===0?fr:Hi,Zt=!1;Vt&&(Wt=Math.sqrt(Math.pow(xi-fr,2)+Math.pow(zi-Hi,2))),Wi<X?Ar>X&&(be=Rt(Yt,xi,zi,fr,Hi,X),Vt&&(Yt.start=he+Wt*be)):Wi>rt?Ar<rt&&(be=Rt(Yt,xi,zi,fr,Hi,rt),Vt&&(Yt.start=he+Wt*be)):ri(Yt,xi,zi,hr),Ar<X&&Wi>=X&&(be=Rt(Yt,xi,zi,fr,Hi,X),Zt=!0),Ar>rt&&Wi<=rt&&(be=Rt(Yt,xi,zi,fr,Hi,rt),Zt=!0),!Mt&&Zt&&(Vt&&(Yt.end=he+Wt*be),W.push(Yt),Yt=ze(wt)),Vt&&(he+=Wt)}let Le=wt.length-3,je=wt[Le],ti=wt[Le+1],_i=ft===0?je:ti;_i>=X&&_i<=rt&&ri(Yt,je,ti,wt[Le+2]),Le=Yt.length-3,Mt&&Le>=3&&(Yt[Le]!==Yt[0]||Yt[Le+1]!==Yt[1])&&ri(Yt,Yt[0],Yt[1],Yt[2]),Yt.length&&W.push(Yt)}function ze(wt){let W=[];return W.size=wt.size,W.start=wt.start,W.end=wt.end,W}function We(wt,W,X,rt,ft,Mt){for(let Vt of wt)Ne(Vt,W,X,rt,ft,Mt,!1)}function ri(wt,W,X,rt){wt.push(W,X,rt)}function hi(wt,W,X,rt,ft,Mt){let Vt=(Mt-W)/(rt-W);return ri(wt,Mt,X+(ft-X)*Vt,1),Vt}function Ti(wt,W,X,rt,ft,Mt){let Vt=(Mt-X)/(ft-X);return ri(wt,W+(rt-W)*Vt,Mt,1),Vt}function fe(wt,W){let X=[];for(let rt=0;rt<wt.length;rt++){let ft=wt[rt],Mt=ft.type,Vt;if(Mt==="Point"||Mt==="MultiPoint"||Mt==="LineString")Vt=Ni(ft.geometry,W);else if(Mt==="MultiLineString"||Mt==="Polygon"){Vt=[];for(let Yt of ft.geometry)Vt.push(Ni(Yt,W))}else if(Mt==="MultiPolygon"){Vt=[];for(let Yt of ft.geometry){let Rt=[];for(let Wt of Yt)Rt.push(Ni(Wt,W));Vt.push(Rt)}}X.push(Ze(ft.id,Mt,Vt,ft.tags))}return X}function Ni(wt,W){let X=[];X.size=wt.size,wt.start!==void 0&&(X.start=wt.start,X.end=wt.end);for(let rt=0;rt<wt.length;rt+=3)X.push(wt[rt]+W,wt[rt+1],wt[rt+2]);return X}function Di(wt,W){if(wt.transformed)return wt;let X=1<<wt.z,rt=wt.x,ft=wt.y;for(let Mt of wt.features){let Vt=Mt.geometry,Yt=Mt.type;if(Mt.geometry=[],Yt===1)for(let Rt=0;Rt<Vt.length;Rt+=2)Mt.geometry.push(mi(Vt[Rt],Vt[Rt+1],W,X,rt,ft));else for(let Rt=0;Rt<Vt.length;Rt++){let Wt=[];for(let be=0;be<Vt[Rt].length;be+=2)Wt.push(mi(Vt[Rt][be],Vt[Rt][be+1],W,X,rt,ft));Mt.geometry.push(Wt)}}return wt.transformed=!0,wt}function mi(wt,W,X,rt,ft,Mt){return[Math.round(X*(wt*rt-ft)),Math.round(X*(W*rt-Mt))]}function Gi(wt,W,X,rt,ft){let Mt=W===ft.maxZoom?0:ft.tolerance/((1<<W)*ft.extent),Vt={features:[],numPoints:0,numSimplified:0,numFeatures:wt.length,source:null,x:X,y:rt,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let Yt of wt)le(Vt,Yt,Mt,ft);return Vt}function le(wt,W,X,rt){let ft=W.geometry,Mt=W.type,Vt=[];if(wt.minX=Math.min(wt.minX,W.minX),wt.minY=Math.min(wt.minY,W.minY),wt.maxX=Math.max(wt.maxX,W.maxX),wt.maxY=Math.max(wt.maxY,W.maxY),Mt==="Point"||Mt==="MultiPoint")for(let Yt=0;Yt<ft.length;Yt+=3)Vt.push(ft[Yt],ft[Yt+1]),wt.numPoints++,wt.numSimplified++;else if(Mt==="LineString")gi(Vt,ft,wt,X,!1,!1);else if(Mt==="MultiLineString"||Mt==="Polygon")for(let Yt=0;Yt<ft.length;Yt++)gi(Vt,ft[Yt],wt,X,Mt==="Polygon",Yt===0);else if(Mt==="MultiPolygon")for(let Yt=0;Yt<ft.length;Yt++){let Rt=ft[Yt];for(let Wt=0;Wt<Rt.length;Wt++)gi(Vt,Rt[Wt],wt,X,!0,Wt===0)}if(Vt.length){let Yt=W.tags||null;if(Mt==="LineString"&&rt.lineMetrics){Yt={};for(let Wt in W.tags)Yt[Wt]=W.tags[Wt];Yt.mapbox_clip_start=ft.start/ft.size,Yt.mapbox_clip_end=ft.end/ft.size}let Rt={geometry:Vt,type:Mt==="Polygon"||Mt==="MultiPolygon"?3:Mt==="LineString"||Mt==="MultiLineString"?2:1,tags:Yt};W.id!==null&&(Rt.id=W.id),wt.features.push(Rt)}}function gi(wt,W,X,rt,ft,Mt){let Vt=rt*rt;if(rt>0&&W.size<(ft?Vt:rt))return void(X.numPoints+=W.length/3);let Yt=[];for(let Rt=0;Rt<W.length;Rt+=3)(rt===0||W[Rt+2]>Vt)&&(X.numSimplified++,Yt.push(W[Rt],W[Rt+1])),X.numPoints++;ft&&function(Rt,Wt){let be=0;for(let he=0,Le=Rt.length,je=Le-2;he<Le;je=he,he+=2)be+=(Rt[he]-Rt[je])*(Rt[he+1]+Rt[je+1]);if(be>0===Wt)for(let he=0,Le=Rt.length;he<Le/2;he+=2){let je=Rt[he],ti=Rt[he+1];Rt[he]=Rt[Le-2-he],Rt[he+1]=Rt[Le-1-he],Rt[Le-2-he]=je,Rt[Le-1-he]=ti}}(Yt,Mt),wt.push(Yt)}let Ke={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class or{constructor(W,X){let rt=(X=this.options=function(Mt,Vt){for(let Yt in Vt)Mt[Yt]=Vt[Yt];return Mt}(Object.create(Ke),X)).debug;if(rt&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");let ft=function(Mt,Vt){let Yt=[];if(Mt.type==="FeatureCollection")for(let Rt=0;Rt<Mt.features.length;Rt++)Je(Yt,Mt.features[Rt],Vt,Rt);else Je(Yt,Mt.type==="Feature"?Mt:{geometry:Mt},Vt);return Yt}(W,X);this.tiles={},this.tileCoords=[],rt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ft=function(Mt,Vt){let Yt=Vt.buffer/Vt.extent,Rt=Mt,Wt=Oe(Mt,1,-1-Yt,Yt,0,-1,2,Vt),be=Oe(Mt,1,1-Yt,2+Yt,0,-1,2,Vt);return(Wt||be)&&(Rt=Oe(Mt,1,-Yt,1+Yt,0,-1,2,Vt)||[],Wt&&(Rt=fe(Wt,1).concat(Rt)),be&&(Rt=Rt.concat(fe(be,-1)))),Rt}(ft,X),ft.length&&this.splitTile(ft,0,0,0),rt&&(ft.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(W,X,rt,ft,Mt,Vt,Yt){let Rt=[W,X,rt,ft],Wt=this.options,be=Wt.debug;for(;Rt.length;){ft=Rt.pop(),rt=Rt.pop(),X=Rt.pop(),W=Rt.pop();let he=1<<X,Le=Ki(X,rt,ft),je=this.tiles[Le];if(!je&&(be>1&&console.time("creation"),je=this.tiles[Le]=Gi(W,X,rt,ft,Wt),this.tileCoords.push({z:X,x:rt,y:ft}),be)){be>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,rt,ft,je.numFeatures,je.numPoints,je.numSimplified),console.timeEnd("creation"));let Zt=`z${X}`;this.stats[Zt]=(this.stats[Zt]||0)+1,this.total++}if(je.source=W,Mt==null){if(X===Wt.indexMaxZoom||je.numPoints<=Wt.indexMaxPoints)continue}else{if(X===Wt.maxZoom||X===Mt)continue;if(Mt!=null){let Zt=Mt-X;if(rt!==Vt>>Zt||ft!==Yt>>Zt)continue}}if(je.source=null,W.length===0)continue;be>1&&console.time("clipping");let ti=.5*Wt.buffer/Wt.extent,_i=.5-ti,$i=.5+ti,xi=1+ti,zi=null,hr=null,fr=null,Hi=null,Wi=Oe(W,he,rt-ti,rt+$i,0,je.minX,je.maxX,Wt),Ar=Oe(W,he,rt+_i,rt+xi,0,je.minX,je.maxX,Wt);W=null,Wi&&(zi=Oe(Wi,he,ft-ti,ft+$i,1,je.minY,je.maxY,Wt),hr=Oe(Wi,he,ft+_i,ft+xi,1,je.minY,je.maxY,Wt),Wi=null),Ar&&(fr=Oe(Ar,he,ft-ti,ft+$i,1,je.minY,je.maxY,Wt),Hi=Oe(Ar,he,ft+_i,ft+xi,1,je.minY,je.maxY,Wt),Ar=null),be>1&&console.timeEnd("clipping"),Rt.push(zi||[],X+1,2*rt,2*ft),Rt.push(hr||[],X+1,2*rt,2*ft+1),Rt.push(fr||[],X+1,2*rt+1,2*ft),Rt.push(Hi||[],X+1,2*rt+1,2*ft+1)}}getTile(W,X,rt){W=+W,X=+X,rt=+rt;let ft=this.options,{extent:Mt,debug:Vt}=ft;if(W<0||W>24)return null;let Yt=1<<W,Rt=Ki(W,X=X+Yt&Yt-1,rt);if(this.tiles[Rt])return Di(this.tiles[Rt],Mt);Vt>1&&console.log("drilling down to z%d-%d-%d",W,X,rt);let Wt,be=W,he=X,Le=rt;for(;!Wt&&be>0;)be--,he>>=1,Le>>=1,Wt=this.tiles[Ki(be,he,Le)];return Wt&&Wt.source?(Vt>1&&(console.log("found parent tile z%d-%d-%d",be,he,Le),console.time("drilling down")),this.splitTile(Wt.source,be,he,Le,W,X,rt),Vt>1&&console.timeEnd("drilling down"),this.tiles[Rt]?Di(this.tiles[Rt],Mt):null):null}}function Ki(wt,W,X){return 32*((1<<wt)*X+W)+wt}function ii(wt,W){return W?wt.properties[W]:wt.id}function br(wt,W){if(wt==null)return!0;if(wt.type==="Feature")return ii(wt,W)!=null;if(wt.type==="FeatureCollection"){let X=new Set;for(let rt of wt.features){let ft=ii(rt,W);if(ft==null||X.has(ft))return!1;X.add(ft)}return!0}return!1}function Ji(wt,W){let X=new Map;if(wt!=null)if(wt.type==="Feature")X.set(ii(wt,W),wt);else for(let rt of wt.features)X.set(ii(rt,W),rt);return X}class wr extends _{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(W,X){return A._(this,void 0,void 0,function*(){let rt=W.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let ft=this._geoJSONIndex.getTile(rt.z,rt.x,rt.y);if(!ft)return null;let Mt=new class{constructor(Yt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=A.X,this.length=Yt.length,this._features=Yt}feature(Yt){return new class{constructor(Rt){this._feature=Rt,this.extent=A.X,this.type=Rt.type,this.properties=Rt.tags,"id"in Rt&&!isNaN(Rt.id)&&(this.id=parseInt(Rt.id,10))}loadGeometry(){if(this._feature.type===1){let Rt=[];for(let Wt of this._feature.geometry)Rt.push([new A.P(Wt[0],Wt[1])]);return Rt}{let Rt=[];for(let Wt of this._feature.geometry){let be=[];for(let he of Wt)be.push(new A.P(he[0],he[1]));Rt.push(be)}return Rt}}toGeoJSON(Rt,Wt,be){return K.call(this,Rt,Wt,be)}}(this._features[Yt])}}(ft.features),Vt=se(Mt);return Vt.byteOffset===0&&Vt.byteLength===Vt.buffer.byteLength||(Vt=new Uint8Array(Vt)),{vectorTile:Mt,rawData:Vt.buffer}})}loadData(W){return A._(this,void 0,void 0,function*(){var X;(X=this._pendingRequest)===null||X===void 0||X.abort();let rt=!!(W&&W.request&&W.request.collectResourceTiming)&&new A.bu(W.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(W,this._pendingRequest),this._geoJSONIndex=W.cluster?new j(function({superclusterOptions:Vt,clusterProperties:Yt}){if(!Yt||!Vt)return Vt;let Rt={},Wt={},be={accumulated:null,zoom:0},he={properties:null},Le=Object.keys(Yt);for(let je of Le){let[ti,_i]=Yt[je],$i=A.bB(_i),xi=A.bB(typeof ti=="string"?[ti,["accumulated"],["get",je]]:ti);Rt[je]=$i.value,Wt[je]=xi.value}return Vt.map=je=>{he.properties=je;let ti={};for(let _i of Le)ti[_i]=Rt[_i].evaluate(be,he);return ti},Vt.reduce=(je,ti)=>{he.properties=ti;for(let _i of Le)be.accumulated=je[_i],je[_i]=Wt[_i].evaluate(be,he)},Vt}(W)).load((yield this._pendingData).features):(ft=yield this._pendingData,new or(ft,W.geojsonVtOptions)),this.loaded={};let Mt={};if(rt){let Vt=rt.finish();Vt&&(Mt.resourceTiming={},Mt.resourceTiming[W.source]=JSON.parse(JSON.stringify(Vt)))}return Mt}catch(Mt){if(delete this._pendingRequest,A.bA(Mt))return{abandoned:!0};throw Mt}var ft})}getData(){return A._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(W){let X=this.loaded;return X&&X[W.uid]?super.reloadTile(W):this.loadTile(W)}loadAndProcessGeoJSON(W,X){return A._(this,void 0,void 0,function*(){let rt=yield this.loadGeoJSON(W,X);if(delete this._pendingRequest,typeof rt!="object")throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(L(rt,!0),W.filter){let ft=A.bB(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ft.result==="error")throw new Error(ft.value.map(Vt=>`${Vt.key}: ${Vt.message}`).join(", "));rt={type:"FeatureCollection",features:rt.features.filter(Vt=>ft.value.evaluate({zoom:0},Vt))}}return rt})}loadGeoJSON(W,X){return A._(this,void 0,void 0,function*(){let{promoteId:rt}=W;if(W.request){let ft=yield A.h(W.request,X);return this._dataUpdateable=br(ft.data,rt)?Ji(ft.data,rt):void 0,ft.data}if(typeof W.data=="string")try{let ft=JSON.parse(W.data);return this._dataUpdateable=br(ft,rt)?Ji(ft,rt):void 0,ft}catch{throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`)}if(!W.dataDiff)throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${W.source}`);return function(ft,Mt,Vt){var Yt,Rt,Wt,be;if(Mt.removeAll&&ft.clear(),Mt.remove)for(let he of Mt.remove)ft.delete(he);if(Mt.add)for(let he of Mt.add){let Le=ii(he,Vt);Le!=null&&ft.set(Le,he)}if(Mt.update)for(let he of Mt.update){let Le=ft.get(he.id);if(Le==null)continue;let je=!he.removeAllProperties&&(((Yt=he.removeProperties)===null||Yt===void 0?void 0:Yt.length)>0||((Rt=he.addOrUpdateProperties)===null||Rt===void 0?void 0:Rt.length)>0);if((he.newGeometry||he.removeAllProperties||je)&&(Le=Object.assign({},Le),ft.set(he.id,Le),je&&(Le.properties=Object.assign({},Le.properties))),he.newGeometry&&(Le.geometry=he.newGeometry),he.removeAllProperties)Le.properties={};else if(((Wt=he.removeProperties)===null||Wt===void 0?void 0:Wt.length)>0)for(let ti of he.removeProperties)Object.prototype.hasOwnProperty.call(Le.properties,ti)&&delete Le.properties[ti];if(((be=he.addOrUpdateProperties)===null||be===void 0?void 0:be.length)>0)for(let{key:ti,value:_i}of he.addOrUpdateProperties)Le.properties[ti]=_i}}(this._dataUpdateable,W.dataDiff,rt),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(W){return A._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(W){return this._geoJSONIndex.getClusterExpansionZoom(W.clusterId)}getClusterChildren(W){return this._geoJSONIndex.getChildren(W.clusterId)}getClusterLeaves(W){return this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset)}}class ar{constructor(W){this.self=W,this.actor=new A.F(W),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(X,rt)=>{if(this.externalWorkerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.externalWorkerSourceTypes[X]=rt},this.self.addProtocol=A.bh,this.self.removeProtocol=A.bi,this.self.registerRTLTextPlugin=X=>{if(A.bC.isParsed())throw new Error("RTL text plugin already registered.");A.bC.setMethods(X)},this.actor.registerMessageHandler("LDT",(X,rt)=>this._getDEMWorkerSource(X,rt.source).loadTile(rt)),this.actor.registerMessageHandler("RDT",(X,rt)=>A._(this,void 0,void 0,function*(){this._getDEMWorkerSource(X,rt.source).removeTile(rt)})),this.actor.registerMessageHandler("GCEZ",(X,rt)=>A._(this,void 0,void 0,function*(){return this._getWorkerSource(X,rt.type,rt.source).getClusterExpansionZoom(rt)})),this.actor.registerMessageHandler("GCC",(X,rt)=>A._(this,void 0,void 0,function*(){return this._getWorkerSource(X,rt.type,rt.source).getClusterChildren(rt)})),this.actor.registerMessageHandler("GCL",(X,rt)=>A._(this,void 0,void 0,function*(){return this._getWorkerSource(X,rt.type,rt.source).getClusterLeaves(rt)})),this.actor.registerMessageHandler("LD",(X,rt)=>this._getWorkerSource(X,rt.type,rt.source).loadData(rt)),this.actor.registerMessageHandler("GD",(X,rt)=>this._getWorkerSource(X,rt.type,rt.source).getData()),this.actor.registerMessageHandler("LT",(X,rt)=>this._getWorkerSource(X,rt.type,rt.source).loadTile(rt)),this.actor.registerMessageHandler("RT",(X,rt)=>this._getWorkerSource(X,rt.type,rt.source).reloadTile(rt)),this.actor.registerMessageHandler("AT",(X,rt)=>this._getWorkerSource(X,rt.type,rt.source).abortTile(rt)),this.actor.registerMessageHandler("RMT",(X,rt)=>this._getWorkerSource(X,rt.type,rt.source).removeTile(rt)),this.actor.registerMessageHandler("RS",(X,rt)=>A._(this,void 0,void 0,function*(){if(!this.workerSources[X]||!this.workerSources[X][rt.type]||!this.workerSources[X][rt.type][rt.source])return;let ft=this.workerSources[X][rt.type][rt.source];delete this.workerSources[X][rt.type][rt.source],ft.removeSource!==void 0&&ft.removeSource(rt)})),this.actor.registerMessageHandler("RM",X=>A._(this,void 0,void 0,function*(){delete this.layerIndexes[X],delete this.availableImages[X],delete this.workerSources[X],delete this.demWorkerSources[X]})),this.actor.registerMessageHandler("SR",(X,rt)=>A._(this,void 0,void 0,function*(){this.referrer=rt})),this.actor.registerMessageHandler("SRPS",(X,rt)=>this._syncRTLPluginState(X,rt)),this.actor.registerMessageHandler("IS",(X,rt)=>A._(this,void 0,void 0,function*(){this.self.importScripts(rt)})),this.actor.registerMessageHandler("SI",(X,rt)=>this._setImages(X,rt)),this.actor.registerMessageHandler("UL",(X,rt)=>A._(this,void 0,void 0,function*(){this._getLayerIndex(X).update(rt.layers,rt.removedIds)})),this.actor.registerMessageHandler("SL",(X,rt)=>A._(this,void 0,void 0,function*(){this._getLayerIndex(X).replace(rt)}))}_setImages(W,X){return A._(this,void 0,void 0,function*(){this.availableImages[W]=X;for(let rt in this.workerSources[W]){let ft=this.workerSources[W][rt];for(let Mt in ft)ft[Mt].availableImages=X}})}_syncRTLPluginState(W,X){return A._(this,void 0,void 0,function*(){if(A.bC.isParsed())return A.bC.getState();if(X.pluginStatus!=="loading")return A.bC.setState(X),X;let rt=X.pluginURL;if(this.self.importScripts(rt),A.bC.isParsed()){let ft={pluginStatus:"loaded",pluginURL:rt};return A.bC.setState(ft),ft}throw A.bC.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${rt}`)})}_getAvailableImages(W){let X=this.availableImages[W];return X||(X=[]),X}_getLayerIndex(W){let X=this.layerIndexes[W];return X||(X=this.layerIndexes[W]=new s),X}_getWorkerSource(W,X,rt){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][X]||(this.workerSources[W][X]={}),!this.workerSources[W][X][rt]){let ft={sendAsync:(Mt,Vt)=>(Mt.targetMapId=W,this.actor.sendAsync(Mt,Vt))};switch(X){case"vector":this.workerSources[W][X][rt]=new _(ft,this._getLayerIndex(W),this._getAvailableImages(W));break;case"geojson":this.workerSources[W][X][rt]=new wr(ft,this._getLayerIndex(W),this._getAvailableImages(W));break;default:this.workerSources[W][X][rt]=new this.externalWorkerSourceTypes[X](ft,this._getLayerIndex(W),this._getAvailableImages(W))}}return this.workerSources[W][X][rt]}_getDEMWorkerSource(W,X){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][X]||(this.demWorkerSources[W][X]=new S),this.demWorkerSources[W][X]}}return A.i(self)&&(self.worker=new ar(self)),ar}),r("index",["exports","./shared"],function(A,s){"use strict";var d="4.5.2";let f,I,_={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:v=>new Promise((i,c)=>{let p=requestAnimationFrame(i);v.signal.addEventListener("abort",()=>{cancelAnimationFrame(p),c(s.c())})}),getImageData(v,i=0){return this.getImageCanvasContext(v).getImageData(-i,-i,v.width+2*i,v.height+2*i)},getImageCanvasContext(v){let i=window.document.createElement("canvas"),c=i.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return i.width=v.width,i.height=v.height,c.drawImage(v,0,0,v.width,v.height),c},resolveURL:v=>(f||(f=document.createElement("a")),f.href=v,f.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(I==null&&(I=matchMedia("(prefers-reduced-motion: reduce)")),I.matches)}};class S{static testProp(i){if(!S.docStyle)return i[0];for(let c=0;c<i.length;c++)if(i[c]in S.docStyle)return i[c];return i[0]}static create(i,c,p){let m=window.document.createElement(i);return c!==void 0&&(m.className=c),p&&p.appendChild(m),m}static createNS(i,c){return window.document.createElementNS(i,c)}static disableDrag(){S.docStyle&&S.selectProp&&(S.userSelect=S.docStyle[S.selectProp],S.docStyle[S.selectProp]="none")}static enableDrag(){S.docStyle&&S.selectProp&&(S.docStyle[S.selectProp]=S.userSelect)}static setTransform(i,c){i.style[S.transformProp]=c}static addEventListener(i,c,p,m={}){i.addEventListener(c,p,"passive"in m?m:m.capture)}static removeEventListener(i,c,p,m={}){i.removeEventListener(c,p,"passive"in m?m:m.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",S.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",S.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",S.suppressClickInternal,!0)},0)}static getScale(i){let c=i.getBoundingClientRect();return{x:c.width/i.offsetWidth||1,y:c.height/i.offsetHeight||1,boundingClientRect:c}}static getPoint(i,c,p){let m=c.boundingClientRect;return new s.P((p.clientX-m.left)/c.x-i.clientLeft,(p.clientY-m.top)/c.y-i.clientTop)}static mousePos(i,c){let p=S.getScale(i);return S.getPoint(i,p,c)}static touchPos(i,c){let p=[],m=S.getScale(i);for(let b=0;b<c.length;b++)p.push(S.getPoint(i,m,c[b]));return p}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}S.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,S.selectProp=S.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),S.transformProp=S.testProp(["transform","WebkitTransform"]);let U={supported:!1,testSupport:function(v){!K&&L&&(V?q(v):G=v)}},G,L,K=!1,V=!1;function q(v){let i=v.createTexture();v.bindTexture(v.TEXTURE_2D,i);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,L),v.isContextLost())return;U.supported=!0}catch{}v.deleteTexture(i),K=!0}var z;typeof document<"u"&&(L=document.createElement("img"),L.onload=()=>{G&&q(G),G=null,V=!0},L.onerror=()=>{K=!0,G=null},L.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let i,c,p,m;v.resetRequestQueue=()=>{i=[],c=0,p=0,m={}},v.addThrottleControl=y=>{let x=p++;return m[x]=y,x},v.removeThrottleControl=y=>{delete m[y],u()},v.getImage=(y,x,k=!0)=>new Promise((E,R)=>{U.supported&&(y.headers||(y.headers={}),y.headers.accept="image/webp,*/*"),s.e(y,{type:"image"}),i.push({abortController:x,requestParameters:y,supportImageRefresh:k,state:"queued",onError:P=>{R(P)},onSuccess:P=>{E(P)}}),u()});let b=y=>s._(this,void 0,void 0,function*(){y.state="running";let{requestParameters:x,supportImageRefresh:k,onError:E,onSuccess:R,abortController:P}=y,H=k===!1&&!s.i(self)&&!s.g(x.url)&&(!x.headers||Object.keys(x.headers).reduce((et,nt)=>et&&nt==="accept",!0));c++;let N=H?g(x,P):s.m(x,P);try{let et=yield N;delete y.abortController,y.state="completed",et.data instanceof HTMLImageElement||s.b(et.data)?R(et):et.data&&R({data:yield(O=et.data,typeof createImageBitmap=="function"?s.d(O):s.f(O)),cacheControl:et.cacheControl,expires:et.expires})}catch(et){delete y.abortController,E(et)}finally{c--,u()}var O}),u=()=>{let y=(()=>{for(let x of Object.keys(m))if(m[x]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let x=c;x<y&&i.length>0;x++){let k=i.shift();k.abortController.signal.aborted?x--:b(k)}},g=(y,x)=>new Promise((k,E)=>{let R=new Image,P=y.url,H=y.credentials;H&&H==="include"?R.crossOrigin="use-credentials":(H&&H==="same-origin"||!s.s(P))&&(R.crossOrigin="anonymous"),x.signal.addEventListener("abort",()=>{R.src="",E(s.c())}),R.fetchPriority="high",R.onload=()=>{R.onerror=R.onload=null,k({data:R})},R.onerror=()=>{R.onerror=R.onload=null,x.signal.aborted||E(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},R.src=P})}(z||(z={})),z.resetRequestQueue();class it{constructor(i){this._transformRequestFn=i}transformRequest(i,c){return this._transformRequestFn&&this._transformRequestFn(i,c)||{url:i}}setTransformRequest(i){this._transformRequestFn=i}}function At(v){var i=new s.A(3);return i[0]=v[0],i[1]=v[1],i[2]=v[2],i}var _t,Lt=function(v,i,c){return v[0]=i[0]-c[0],v[1]=i[1]-c[1],v[2]=i[2]-c[2],v};_t=new s.A(3),s.A!=Float32Array&&(_t[0]=0,_t[1]=0,_t[2]=0);var Et=function(v){var i=v[0],c=v[1];return i*i+c*c};function xt(v){let i=[];if(typeof v=="string")i.push({id:"default",url:v});else if(v&&v.length>0){let c=[];for(let{id:p,url:m}of v){let b=`${p}${m}`;c.indexOf(b)===-1&&(c.push(b),i.push({id:p,url:m}))}}return i}function It(v,i,c){let p=v.split("?");return p[0]+=`${i}${c}`,p.join("?")}(function(){var v=new s.A(2);s.A!=Float32Array&&(v[0]=0,v[1]=0)})();class Nt{constructor(i,c,p,m){this.context=i,this.format=p,this.texture=i.gl.createTexture(),this.update(c,m)}update(i,c,p){let{width:m,height:b}=i,u=!(this.size&&this.size[0]===m&&this.size[1]===b||p),{context:g}=this,{gl:y}=g;if(this.useMipmap=Boolean(c&&c.useMipmap),y.bindTexture(y.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!c||c.premultiply!==!1)),u)this.size=[m,b],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||s.b(i)?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,i):y.texImage2D(y.TEXTURE_2D,0,this.format,m,b,0,this.format,y.UNSIGNED_BYTE,i.data);else{let{x,y:k}=p||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||s.b(i)?y.texSubImage2D(y.TEXTURE_2D,0,x,k,y.RGBA,y.UNSIGNED_BYTE,i):y.texSubImage2D(y.TEXTURE_2D,0,x,k,m,b,y.RGBA,y.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&y.generateMipmap(y.TEXTURE_2D)}bind(i,c,p){let{context:m}=this,{gl:b}=m;b.bindTexture(b.TEXTURE_2D,this.texture),p!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=b.LINEAR),i!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,i),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,p||i),this.filter=i),c!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,c),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function ie(v){let{userImage:i}=v;return!!(i&&i.render&&i.render())&&(v.data.replace(new Uint8Array(i.data.buffer)),!0)}class lt extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(let{ids:c,promiseResolve:p}of this.requestors)p(this._getImagesForIds(c));this.requestors=[]}}getImage(i){let c=this.images[i];if(c&&!c.data&&c.spriteData){let p=c.spriteData;c.data=new s.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),c.spriteData=null}return c}addImage(i,c){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,c)&&(this.images[i]=c)}_validate(i,c){let p=!0,m=c.data||c.spriteData;return this._validateStretch(c.stretchX,m&&m.width)||(this.fire(new s.j(new Error(`Image "${i}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,m&&m.height)||(this.fire(new s.j(new Error(`Image "${i}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new s.j(new Error(`Image "${i}" has invalid "content" value`))),p=!1),p}_validateStretch(i,c){if(!i)return!0;let p=0;for(let m of i){if(m[0]<p||m[1]<m[0]||c<m[1])return!1;p=m[1]}return!0}_validateContent(i,c){if(!i)return!0;if(i.length!==4)return!1;let p=c.spriteData,m=p&&p.width||c.data.width,b=p&&p.height||c.data.height;return!(i[0]<0||m<i[0]||i[1]<0||b<i[1]||i[2]<0||m<i[2]||i[3]<0||b<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,c,p=!0){let m=this.getImage(i);if(p&&(m.data.width!==c.data.width||m.data.height!==c.data.height))throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${c.data.width}x${c.data.height}).`);c.version=m.version+1,this.images[i]=c,this.updatedImages[i]=!0}removeImage(i){let c=this.images[i];delete this.images[i],delete this.patterns[i],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i){return new Promise((c,p)=>{let m=!0;if(!this.isLoaded())for(let b of i)this.images[b]||(m=!1);this.isLoaded()||m?c(this._getImagesForIds(i)):this.requestors.push({ids:i,promiseResolve:c})})}_getImagesForIds(i){let c={};for(let p of i){let m=this.getImage(p);m||(this.fire(new s.k("styleimagemissing",{id:p})),m=this.getImage(p)),m?c[p]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,textFitWidth:m.textFitWidth,textFitHeight:m.textFitHeight,hasRenderCallback:Boolean(m.userImage&&m.userImage.render)}:s.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return c}getPixelSize(){let{width:i,height:c}=this.atlasImage;return{width:i,height:c}}getPattern(i){let c=this.patterns[i],p=this.getImage(i);if(!p)return null;if(c&&c.position.version===p.version)return c.position;if(c)c.position.version=p.version;else{let m={w:p.data.width+2,h:p.data.height+2,x:0,y:0},b=new s.I(m,p);this.patterns[i]={bin:m,position:b}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){let c=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Nt(i,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){let i=[];for(let b in this.patterns)i.push(this.patterns[b].bin);let{w:c,h:p}=s.p(i),m=this.atlasImage;m.resize({width:c||1,height:p||1});for(let b in this.patterns){let{bin:u}=this.patterns[b],g=u.x+1,y=u.y+1,x=this.getImage(b).data,k=x.width,E=x.height;s.R.copy(x,m,{x:0,y:0},{x:g,y},{width:k,height:E}),s.R.copy(x,m,{x:0,y:E-1},{x:g,y:y-1},{width:k,height:1}),s.R.copy(x,m,{x:0,y:0},{x:g,y:y+E},{width:k,height:1}),s.R.copy(x,m,{x:k-1,y:0},{x:g-1,y},{width:1,height:E}),s.R.copy(x,m,{x:0,y:0},{x:g+k,y},{width:1,height:E})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(let c of i){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;let p=this.getImage(c);p||s.w(`Image with ID: "${c}" was not found`),ie(p)&&this.updateImage(c,p)}}}let at=1e20;function St(v,i,c,p,m,b,u,g,y){for(let x=i;x<i+p;x++)Bt(v,c*b+x,b,m,u,g,y);for(let x=c;x<c+m;x++)Bt(v,x*b+i,1,p,u,g,y)}function Bt(v,i,c,p,m,b,u){b[0]=0,u[0]=-at,u[1]=at,m[0]=v[i];for(let g=1,y=0,x=0;g<p;g++){m[g]=v[i+g*c];let k=g*g;do{let E=b[y];x=(m[g]-m[E]+k-E*E)/(g-E)/2}while(x<=u[y]&&--y>-1);y++,b[y]=g,u[y]=x,u[y+1]=at}for(let g=0,y=0;g<p;g++){for(;u[y+1]<g;)y++;let x=b[y],k=g-x;v[i+g*c]=m[x]+k*k}}class se{constructor(i,c){this.requestManager=i,this.localIdeographFontFamily=c,this.entries={}}setURL(i){this.url=i}getGlyphs(i){return s._(this,void 0,void 0,function*(){let c=[];for(let b in i)for(let u of i[b])c.push(this._getAndCacheGlyphsPromise(b,u));let p=yield Promise.all(c),m={};for(let{stack:b,id:u,glyph:g}of p)m[b]||(m[b]={}),m[b][u]=g&&{id:g.id,bitmap:g.bitmap.clone(),metrics:g.metrics};return m})}_getAndCacheGlyphsPromise(i,c){return s._(this,void 0,void 0,function*(){let p=this.entries[i];p||(p=this.entries[i]={glyphs:{},requests:{},ranges:{}});let m=p.glyphs[c];if(m!==void 0)return{stack:i,id:c,glyph:m};if(m=this._tinySDF(p,i,c),m)return p.glyphs[c]=m,{stack:i,id:c,glyph:m};let b=Math.floor(c/256);if(256*b>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[b])return{stack:i,id:c,glyph:m};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[b]){let g=se.loadGlyphRange(i,b,this.url,this.requestManager);p.requests[b]=g}let u=yield p.requests[b];for(let g in u)this._doesCharSupportLocalGlyph(+g)||(p.glyphs[+g]=u[+g]);return p.ranges[b]=!0,{stack:i,id:c,glyph:u[c]||null}})}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(s.u["CJK Unified Ideographs"](i)||s.u["Hangul Syllables"](i)||s.u.Hiragana(i)||s.u.Katakana(i))}_tinySDF(i,c,p){let m=this.localIdeographFontFamily;if(!m||!this._doesCharSupportLocalGlyph(p))return;let b=i.tinySDF;if(!b){let g="400";/bold/i.test(c)?g="900":/medium/i.test(c)?g="500":/light/i.test(c)&&(g="200"),b=i.tinySDF=new se.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:m,fontWeight:g})}let u=b.draw(String.fromCharCode(p));return{id:p,bitmap:new s.o({width:u.width||60,height:u.height||60},u.data),metrics:{width:u.glyphWidth/2||24,height:u.glyphHeight/2||24,left:u.glyphLeft/2+.5||0,top:u.glyphTop/2-27.5||-8,advance:u.glyphAdvance/2||24,isDoubleResolution:!0}}}}se.loadGlyphRange=function(v,i,c,p){return s._(this,void 0,void 0,function*(){let m=256*i,b=m+255,u=p.transformRequest(c.replace("{fontstack}",v).replace("{range}",`${m}-${b}`),"Glyphs"),g=yield s.l(u,new AbortController);if(!g||!g.data)throw new Error(`Could not load glyph range. range: ${i}, ${m}-${b}`);let y={};for(let x of s.n(g.data))y[x.id]=x;return y})},se.TinySDF=class{constructor({fontSize:v=24,buffer:i=3,radius:c=8,cutoff:p=.25,fontFamily:m="sans-serif",fontWeight:b="normal",fontStyle:u="normal"}={}){this.buffer=i,this.cutoff=p,this.radius=c;let g=this.size=v+4*i,y=this._createCanvas(g),x=this.ctx=y.getContext("2d",{willReadFrequently:!0});x.font=`${u} ${b} ${v}px ${m}`,x.textBaseline="alphabetic",x.textAlign="left",x.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(v){let i=document.createElement("canvas");return i.width=i.height=v,i}draw(v){let{width:i,actualBoundingBoxAscent:c,actualBoundingBoxDescent:p,actualBoundingBoxLeft:m,actualBoundingBoxRight:b}=this.ctx.measureText(v),u=Math.ceil(c),g=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-m))),y=Math.min(this.size-this.buffer,u+Math.ceil(p)),x=g+2*this.buffer,k=y+2*this.buffer,E=Math.max(x*k,0),R=new Uint8ClampedArray(E),P={data:R,width:x,height:k,glyphWidth:g,glyphHeight:y,glyphTop:u,glyphLeft:0,glyphAdvance:i};if(g===0||y===0)return P;let{ctx:H,buffer:N,gridInner:O,gridOuter:et}=this;H.clearRect(N,N,g,y),H.fillText(v,N,N+u);let nt=H.getImageData(N,N,g,y);et.fill(at,0,E),O.fill(0,0,E);for(let Y=0;Y<y;Y++)for(let dt=0;dt<g;dt++){let gt=nt.data[4*(Y*g+dt)+3]/255;if(gt===0)continue;let ot=(Y+N)*x+dt+N;if(gt===1)et[ot]=0,O[ot]=at;else{let pt=.5-gt;et[ot]=pt>0?pt*pt:0,O[ot]=pt<0?pt*pt:0}}St(et,0,0,x,k,x,this.f,this.v,this.z),St(O,N,N,g,y,x,this.f,this.v,this.z);for(let Y=0;Y<E;Y++){let dt=Math.sqrt(et[Y])-Math.sqrt(O[Y]);R[Y]=Math.round(255-255*(dt/this.radius+this.cutoff))}return P}};class ee{constructor(){this.specification=s.v.light.position}possiblyEvaluate(i,c){return s.y(i.expression.evaluate(c))}interpolate(i,c,p){return{x:s.z.number(i.x,c.x,p),y:s.z.number(i.y,c.y,p),z:s.z.number(i.z,c.z,p)}}}let qt;class Xt extends s.E{constructor(i){super(),qt=qt||new s.q({anchor:new s.D(s.v.light.anchor),position:new ee,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.T(qt),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,c={}){if(!this._validate(s.r,i,c))for(let p in i){let m=i[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),m):this._transitionable.setValue(p,m)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p){return(!p||p.validate!==!1)&&s.t(this,i.call(s.x,{value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}let vt=new s.q({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class Tt extends s.E{constructor(i){super(),this._transitionable=new s.T(vt),this.setSky(i),this._transitioning=this._transitionable.untransitioned()}setSky(i,c={}){if(!this._validate(s.B,i,c))for(let p in i){let m=i[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),m):this._transitionable.setValue(p,m)}}getSky(){return this._transitionable.serialize()}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p={}){return p?.validate!==!1&&s.t(this,i.call(s.x,s.e({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(i){return i<60?0:i<70?(i-60)/10:1}}class pe{constructor(i,c){this.width=i,this.height=c,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,c){let p=i.join(",")+String(c);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(i,c)),this.dashEntry[p]}getDashRanges(i,c,p){let m=[],b=i.length%2==1?-i[i.length-1]*p:0,u=i[0]*p,g=!0;m.push({left:b,right:u,isDash:g,zeroLength:i[0]===0});let y=i[0];for(let x=1;x<i.length;x++){g=!g;let k=i[x];b=y*p,y+=k,u=y*p,m.push({left:b,right:u,isDash:g,zeroLength:k===0})}return m}addRoundDash(i,c,p){let m=c/2;for(let b=-p;b<=p;b++){let u=this.width*(this.nextRow+p+b),g=0,y=i[g];for(let x=0;x<this.width;x++){x/y.right>1&&(y=i[++g]);let k=Math.abs(x-y.left),E=Math.abs(x-y.right),R=Math.min(k,E),P,H=b/p*(m+1);if(y.isDash){let N=m-Math.abs(H);P=Math.sqrt(R*R+N*N)}else P=m-Math.sqrt(R*R+H*H);this.data[u+x]=Math.max(0,Math.min(255,P+128))}}}addRegularDash(i){for(let g=i.length-1;g>=0;--g){let y=i[g],x=i[g+1];y.zeroLength?i.splice(g,1):x&&x.isDash===y.isDash&&(x.left=y.left,i.splice(g,1))}let c=i[0],p=i[i.length-1];c.isDash===p.isDash&&(c.left=p.left-this.width,p.right=c.right+this.width);let m=this.width*this.nextRow,b=0,u=i[b];for(let g=0;g<this.width;g++){g/u.right>1&&(u=i[++b]);let y=Math.abs(g-u.left),x=Math.abs(g-u.right),k=Math.min(y,x);this.data[m+g]=Math.max(0,Math.min(255,(u.isDash?k:-k)+128))}}addDash(i,c){let p=c?7:0,m=2*p+1;if(this.nextRow+m>this.height)return s.w("LineAtlas out of space"),null;let b=0;for(let g=0;g<i.length;g++)b+=i[g];if(b!==0){let g=this.width/b,y=this.getDashRanges(i,this.width,g);c?this.addRoundDash(y,g,p):this.addRegularDash(y)}let u={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:b};return this.nextRow+=m,this.dirty=!0,u}bind(i){let c=i.gl;this.texture?(c.bindTexture(c.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,c.texSubImage2D(c.TEXTURE_2D,0,0,0,this.width,this.height,c.ALPHA,c.UNSIGNED_BYTE,this.data))):(this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.ALPHA,this.width,this.height,0,c.ALPHA,c.UNSIGNED_BYTE,this.data))}}let j="maplibre_preloaded_worker_pool";class mt{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<mt.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[j]}numActive(){return Object.keys(this.active).length}}let yt=Math.floor(_.hardwareConcurrency/2),Qt,Ht;function ae(){return Qt||(Qt=new mt),Qt}mt.workerCount=s.C(globalThis)?Math.max(Math.min(yt,3),1):1;class ge{constructor(i,c){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=c;let p=this.workerPool.acquire(c);for(let m=0;m<p.length;m++){let b=new s.F(p[m],c);b.name=`Worker ${m}`,this.actors.push(b)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,c){let p=[];for(let m of this.actors)p.push(m.sendAsync({type:i,data:c}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach(c=>{c.remove()}),this.actors=[],i&&this.workerPool.release(this.id)}registerMessageHandler(i,c){for(let p of this.actors)p.registerMessageHandler(i,c)}}function de(){return Ht||(Ht=new ge(ae(),s.G),Ht.registerMessageHandler("GR",(v,i,c)=>s.m(i,c))),Ht}function Ze(v,i){let c=s.H();return s.J(c,c,[1,1,0]),s.K(c,c,[.5*v.width,.5*v.height,1]),s.L(c,c,v.calculatePosMatrix(i.toUnwrapped()))}function Re(v,i,c,p,m,b){let u=function(E,R,P){if(E)for(let H of E){let N=R[H];if(N&&N.source===P&&N.type==="fill-extrusion")return!0}else for(let H in R){let N=R[H];if(N.source===P&&N.type==="fill-extrusion")return!0}return!1}(m&&m.layers,i,v.id),g=b.maxPitchScaleFactor(),y=v.tilesIn(p,g,u);y.sort(Je);let x=[];for(let E of y)x.push({wrappedTileID:E.tileID.wrapped().key,queryResults:E.tile.queryRenderedFeatures(i,c,v._state,E.queryGeometry,E.cameraQueryGeometry,E.scale,m,b,g,Ze(v.transform,E.tileID))});let k=function(E){let R={},P={};for(let H of E){let N=H.queryResults,O=H.wrappedTileID,et=P[O]=P[O]||{};for(let nt in N){let Y=N[nt],dt=et[nt]=et[nt]||{},gt=R[nt]=R[nt]||[];for(let ot of Y)dt[ot.featureIndex]||(dt[ot.featureIndex]=!0,gt.push(ot))}}return R}(x);for(let E in k)k[E].forEach(R=>{let P=R.feature,H=v.getFeatureState(P.layer["source-layer"],P.id);P.source=P.layer.source,P.layer["source-layer"]&&(P.sourceLayer=P.layer["source-layer"]),P.state=H});return k}function Je(v,i){let c=v.tileID,p=i.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function Xe(v,i,c){return s._(this,void 0,void 0,function*(){let p=v;if(v.url?p=(yield s.h(i.transformRequest(v.url,"Source"),c)).data:yield _.frameAsync(c),!p)return null;let m=s.M(s.e(p,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(m.vectorLayerIds=p.vector_layers.map(b=>b.id)),m})}class Kt{constructor(i,c){i&&(c?this.setSouthWest(i).setNorthEast(c):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof s.N?new s.N(i.lng,i.lat):s.N.convert(i),this}setSouthWest(i){return this._sw=i instanceof s.N?new s.N(i.lng,i.lat):s.N.convert(i),this}extend(i){let c=this._sw,p=this._ne,m,b;if(i instanceof s.N)m=i,b=i;else{if(!(i instanceof Kt))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Kt.convert(i)):this.extend(s.N.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(s.N.convert(i)):this;if(m=i._sw,b=i._ne,!m||!b)return this}return c||p?(c.lng=Math.min(m.lng,c.lng),c.lat=Math.min(m.lat,c.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new s.N(m.lng,m.lat),this._ne=new s.N(b.lng,b.lat)),this}getCenter(){return new s.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.N(this.getWest(),this.getNorth())}getSouthEast(){return new s.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){let{lng:c,lat:p}=s.N.convert(i),m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&m}static convert(i){return i instanceof Kt?i:i&&new Kt(i)}static fromLngLat(i,c=0){let p=360*c/40075017,m=p/Math.cos(Math.PI/180*i.lat);return new Kt(new s.N(i.lng-m,i.lat-p),new s.N(i.lng+m,i.lat+p))}}class Ce{constructor(i,c,p){this.bounds=Kt.convert(this.validateBounds(i)),this.minzoom=c||0,this.maxzoom=p||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){let c=Math.pow(2,i.z),p=Math.floor(s.O(this.bounds.getWest())*c),m=Math.floor(s.Q(this.bounds.getNorth())*c),b=Math.ceil(s.O(this.bounds.getEast())*c),u=Math.ceil(s.Q(this.bounds.getSouth())*c);return i.x>=p&&i.x<b&&i.y>=m&&i.y<u}}class Ut extends s.E{constructor(i,c,p,m){if(super(),this.id=i,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.M(c,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let i=yield Xe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i&&(s.e(this,i),i.bounds&&(this.tileBounds=new Ce(i.bounds,this.minzoom,this.maxzoom)),this.fire(new s.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new s.j(i))}})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.abort(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(i){return s._(this,void 0,void 0,function*(){let c=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(c,"Tile"),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};p.request.collectResourceTiming=this._collectResourceTiming;let m="RT";if(i.actor&&i.state!=="expired"){if(i.state==="loading")return new Promise((b,u)=>{i.reloadPromise={resolve:b,reject:u}})}else i.actor=this.dispatcher.getActor(),m="LT";i.abortController=new AbortController;try{let b=yield i.actor.sendAsync({type:m,data:p},i.abortController);if(delete i.abortController,i.aborted)return;this._afterTileLoadWorkerResponse(i,b)}catch(b){if(delete i.abortController,i.aborted)return;if(b&&b.status!==404)throw b;this._afterTileLoadWorkerResponse(i,null)}})}_afterTileLoadWorkerResponse(i,c){if(c&&c.resourceTiming&&(i.resourceTiming=c.resourceTiming),c&&this.map._refreshExpiredTiles&&i.setExpiryData(c),i.loadVectorData(c,this.map.painter),i.reloadPromise){let p=i.reloadPromise;i.reloadPromise=null,this.loadTile(i).then(p.resolve).catch(p.reject)}}abortTile(i){return s._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.actor&&(yield i.actor.sendAsync({type:"AT",data:{uid:i.uid,type:this.type,source:this.id}}))})}unloadTile(i){return s._(this,void 0,void 0,function*(){i.unloadVectorData(),i.actor&&(yield i.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ye extends s.E{constructor(i,c,p,m){super(),this.id=i,this.dispatcher=p,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},c),s.e(this,s.M(c,["url","scheme","tileSize"]))}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let i=yield Xe(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,i&&(s.e(this,i),i.bounds&&(this.tileBounds=new Ce(i.bounds,this.minzoom,this.maxzoom)),this.fire(new s.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.k("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new s.j(i))}})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}serialize(){return s.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i){return s._(this,void 0,void 0,function*(){let c=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.abortController=new AbortController;try{let p=yield z.getImage(this.map._requestManager.transformRequest(c,"Tile"),i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&p.cacheControl&&p.expires&&i.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});let m=this.map.painter.context,b=m.gl,u=p.data;i.texture=this.map.painter.getTileTexture(u.width),i.texture?i.texture.update(u,{useMipmap:!0}):(i.texture=new Nt(m,u,b.RGBA,{useMipmap:!0}),i.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST)),i.state="loaded"}}catch(p){if(delete i.abortController,i.aborted)i.state="unloaded";else if(p)throw i.state="errored",p}})}abortTile(i){return s._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController)})}unloadTile(i){return s._(this,void 0,void 0,function*(){i.texture&&this.map.painter.saveTileTexture(i.texture)})}hasTransition(){return!1}}class Oe extends Ye{constructor(i,c,p,m){super(i,c,p,m),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox",this.redFactor=c.redFactor,this.greenFactor=c.greenFactor,this.blueFactor=c.blueFactor,this.baseShift=c.baseShift}loadTile(i){return s._(this,void 0,void 0,function*(){let c=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(c,"Tile");i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.abortController=new AbortController;try{let m=yield z.getImage(p,i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(m&&m.data){let b=m.data;this.map._refreshExpiredTiles&&m.cacheControl&&m.expires&&i.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});let u=s.b(b)&&s.U()?b:yield this.readImageNow(b),g={type:this.type,uid:i.uid,source:this.id,rawImageData:u,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!i.actor||i.state==="expired"){i.actor=this.dispatcher.getActor();let y=yield i.actor.sendAsync({type:"LDT",data:g});i.dem=y,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded"}}}catch(m){if(delete i.abortController,i.aborted)i.state="unloaded";else if(m)throw i.state="errored",m}})}readImageNow(i){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.V()){let c=i.width+2,p=i.height+2;try{return new s.R({width:c,height:p},yield s.W(i,-1,-1,c,p))}catch{}}return _.getImageData(i,1)})}_getNeighboringTiles(i){let c=i.canonical,p=Math.pow(2,c.z),m=(c.x-1+p)%p,b=c.x===0?i.wrap-1:i.wrap,u=(c.x+1+p)%p,g=c.x+1===p?i.wrap+1:i.wrap,y={};return y[new s.S(i.overscaledZ,b,c.z,m,c.y).key]={backfilled:!1},y[new s.S(i.overscaledZ,g,c.z,u,c.y).key]={backfilled:!1},c.y>0&&(y[new s.S(i.overscaledZ,b,c.z,m,c.y-1).key]={backfilled:!1},y[new s.S(i.overscaledZ,i.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},y[new s.S(i.overscaledZ,g,c.z,u,c.y-1).key]={backfilled:!1}),c.y+1<p&&(y[new s.S(i.overscaledZ,b,c.z,m,c.y+1).key]={backfilled:!1},y[new s.S(i.overscaledZ,i.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},y[new s.S(i.overscaledZ,g,c.z,u,c.y+1).key]={backfilled:!1}),y}unloadTile(i){return s._(this,void 0,void 0,function*(){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&(yield i.actor.sendAsync({type:"RDT",data:{type:this.type,uid:i.uid,source:this.id}}))})}}class Qe extends s.E{constructor(i,c,p,m){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(m),this._data=c.data,this._options=s.e({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;let b=s.X/this.tileSize;this.workerOptions=s.e({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*b,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*b,extent:s.X,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:s.X,radius:(c.clusterRadius||50)*b,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData(),this}updateData(i){return this._updateWorkerData(i),this}getData(){return s._(this,void 0,void 0,function*(){let i=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:i})})}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=i.clusterRadius),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=i.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(i){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:i,source:this.id}})}getClusterChildren(i){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:i,source:this.id}})}getClusterLeaves(i,c,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:i,limit:c,offset:p}})}_updateWorkerData(i){return s._(this,void 0,void 0,function*(){let c=s.e({type:this.type},this.workerOptions);i?c.dataDiff=i:typeof this._data=="string"?(c.request=this.map._requestManager.transformRequest(_.resolveURL(this._data),"Source"),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new s.k("dataloading",{dataType:"source"}));try{let p=yield this.actor.sendAsync({type:"LD",data:c});if(this._pendingLoads--,this._removed||p.abandoned)return void this.fire(new s.k("dataabort",{dataType:"source"}));let m=null;p.resourceTiming&&p.resourceTiming[this.id]&&(m=p.resourceTiming[this.id].slice(0));let b={dataType:"source"};this._collectResourceTiming&&m&&m.length>0&&s.e(b,{resourceTiming:m}),this.fire(new s.k("data",Object.assign(Object.assign({},b),{sourceDataType:"metadata"}))),this.fire(new s.k("data",Object.assign(Object.assign({},b),{sourceDataType:"content"})))}catch(p){if(this._pendingLoads--,this._removed)return void this.fire(new s.k("dataabort",{dataType:"source"}));this.fire(new s.j(p))}})}loaded(){return this._pendingLoads===0}loadTile(i){return s._(this,void 0,void 0,function*(){let c=i.actor?"RT":"LT";i.actor=this.actor;let p={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.abortController=new AbortController;let m=yield this.actor.sendAsync({type:c,data:p},i.abortController);delete i.abortController,i.unloadVectorData(),i.aborted||i.loadVectorData(m,this.map.painter,c==="RT")})}abortTile(i){return s._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.aborted=!0})}unloadTile(i){return s._(this,void 0,void 0,function*(){i.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ne=s.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ze extends s.E{constructor(i,c,p,m){super(),this.id=i,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=c}load(i){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let c=yield z.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,c&&c.data&&(this.image=c.data,i&&(this.coordinates=i),this._finishLoading())}catch(c){this._request=null,this._loaded=!0,this.fire(new s.j(c))}})}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=i.url,this.load(i.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(i){this.coordinates=i;let c=i.map(s.Z.fromLngLat);this.tileID=function(m){let b=1/0,u=1/0,g=-1/0,y=-1/0;for(let R of m)b=Math.min(b,R.x),u=Math.min(u,R.y),g=Math.max(g,R.x),y=Math.max(y,R.y);let x=Math.max(g-b,y-u),k=Math.max(0,Math.floor(-Math.log(x)/Math.LN2)),E=Math.pow(2,k);return new s.a1(k,Math.floor((b+g)/2*E),Math.floor((u+y)/2*E))}(c),this.minzoom=this.maxzoom=this.tileID.z;let p=c.map(m=>this.tileID.getTilePoint(m)._round());return this._boundsArray=new s.$,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,s.X,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,s.X),this._boundsArray.emplaceBack(p[2].x,p[2].y,s.X,s.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let i=this.map.painter.context,c=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=s.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Nt(i,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let p=!1;for(let m in this.tiles){let b=this.tiles[m];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,p=!0)}p&&this.fire(new s.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(i){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class We extends ze{constructor(i,c,p,m){super(i,c,p,m),this.roundZoom=!0,this.type="video",this.options=c}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;let i=this.options;this.urls=[];for(let c of i.urls)this.urls.push(this.map._requestManager.transformRequest(c,"Source").url);try{let c=yield s.a3(this.urls);if(this._loaded=!0,!c)return;this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(c){this.fire(new s.j(c))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){let c=this.video.seekable;i<c.start(0)||i>c.end(0)?this.fire(new s.j(new s.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let i=this.map.painter.context,c=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=s.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new Nt(i,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let p=!1;for(let m in this.tiles){let b=this.tiles[m];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,p=!0)}p&&this.fire(new s.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ri extends ze{constructor(i,c,p,m){super(i,c,p,m),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(u=>typeof u!="number"))||this.fire(new s.j(new s.a2(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.j(new s.a2(`sources.${i}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new s.j(new s.a2(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof HTMLCanvasElement||this.fire(new s.j(new s.a2(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.j(new s.a2(`sources.${i}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let c=this.map.painter.context,p=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=s.a0.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Nt(c,this.canvas,p.RGBA,{premultiply:!0});let m=!1;for(let b in this.tiles){let u=this.tiles[b];u.state!=="loaded"&&(u.state="loaded",u.texture=this.texture,m=!0)}m&&this.fire(new s.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}let hi={},Ti=v=>{switch(v){case"geojson":return Qe;case"image":return ze;case"raster":return Ye;case"raster-dem":return Oe;case"vector":return Ut;case"video":return We;case"canvas":return ri}return hi[v]},fe="RTLPluginLoaded";class Ni extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=de()}_syncState(i){return this.status=i,this.dispatcher.broadcast("SRPS",{pluginStatus:i,pluginURL:this.url}).catch(c=>{throw this.status="error",c})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(i){return s._(this,arguments,void 0,function*(c,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=_.resolveURL(c),!this.url)throw new Error(`requested url ${c} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.k(fe))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Di=null;function mi(){return Di||(Di=new Ni),Di}class Gi{constructor(i,c){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=s.a4(),this.uses=0,this.tileSize=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){let c=i+this.timeAdded;c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,c,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(m,b){let u={};if(!b)return u;for(let g of m){let y=g.layerIds.map(x=>b.getLayer(x)).filter(Boolean);if(y.length!==0){g.layers=y,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(x=>y.filter(k=>k.id===x)[0]));for(let x of y)u[x.id]=g}}return u}(i.buckets,c.style),this.hasSymbolBuckets=!1;for(let m in this.buckets){let b=this.buckets[m];if(b instanceof s.a6){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let m in this.buckets){let b=this.buckets[m];if(b instanceof s.a6&&b.hasRTLText){this.hasRTLText=!0,mi().lazyLoad();break}}this.queryPadding=0;for(let m in this.buckets){let b=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(m).queryRadius(b))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new s.a5}unloadVectorData(){for(let i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(let p in this.buckets){let m=this.buckets[p];m.uploadPending()&&m.upload(i)}let c=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Nt(i,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Nt(i,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,c,p,m,b,u,g,y,x,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:b,scale:u,tileSize:this.tileSize,pixelPosMatrix:k,transform:y,params:g,queryPadding:this.queryPadding*x},i,c,p):{}}querySourceFeatures(i,c){let p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;let m=p.loadVTLayers(),b=c&&c.sourceLayer?c.sourceLayer:"",u=m._geojsonTileLayer||m[b];if(!u)return;let g=s.a7(c&&c.filter),{z:y,x,y:k}=this.tileID.canonical,E={z:y,x,y:k};for(let R=0;R<u.length;R++){let P=u.feature(R);if(g.needGeometry){let O=s.a8(P,!0);if(!g.filter(new s.a9(this.tileID.overscaledZ),O,this.tileID.canonical))continue}else if(!g.filter(new s.a9(this.tileID.overscaledZ),P))continue;let H=p.getId(P,b),N=new s.aa(P,y,x,k,H);N.tile=E,i.push(N)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){let c=this.expirationTime;if(i.cacheControl){let p=s.ab(i.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){let p=Date.now(),m=!1;if(this.expirationTime>p)m=!1;else if(c)if(this.expirationTime<c)m=!0;else{let b=this.expirationTime-c;b?this.expirationTime=p+Math.max(b,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;let p=this.latestFeatureIndex.loadVTLayers();for(let m in this.buckets){if(!c.style.hasLayer(m))continue;let b=this.buckets[m],u=b.layers[0].sourceLayer||"_geojsonTileLayer",g=p[u],y=i[u];if(!g||!y||Object.keys(y).length===0)continue;b.update(y,g,this.imageAtlas&&this.imageAtlas.patternPositions||{});let x=c&&c.style&&c.style.getLayer(m);x&&(this.queryPadding=Math.max(this.queryPadding,x.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=_.now()+i}setDependencies(i,c){let p={};for(let m of c)p[m]=!0;this.dependencies[i]=p}hasDependency(i,c){for(let p of i){let m=this.dependencies[p];if(m){for(let b of c)if(m[b])return!0}}return!1}}class le{constructor(i,c){this.max=i,this.onRemove=c,this.reset()}reset(){for(let i in this.data)for(let c of this.data[i])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(i,c,p){let m=i.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);let b={value:c,timeout:void 0};if(p!==void 0&&(b.timeout=setTimeout(()=>{this.remove(i,b)},p)),this.data[m].push(b),this.order.push(m),this.order.length>this.max){let u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){let c=this.data[i].shift();return c.timeout&&clearTimeout(c.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),c.value}getByKey(i){let c=this.data[i];return c?c[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,c){if(!this.has(i))return this;let p=i.wrapped().key,m=c===void 0?0:this.data[p].indexOf(c),b=this.data[p][m];return this.data[p].splice(m,1),b.timeout&&clearTimeout(b.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){let c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(i){let c=[];for(let p in this.data)for(let m of this.data[p])i(m.value)||c.push(m);for(let p of c)this.remove(p.value.tileID,p)}}class gi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,c,p){let m=String(c);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][m]=this.stateChanges[i][m]||{},s.e(this.stateChanges[i][m],p),this.deletedStates[i]===null){this.deletedStates[i]={};for(let b in this.state[i])b!==m&&(this.deletedStates[i][b]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][m]===null){this.deletedStates[i][m]={};for(let b in this.state[i][m])p[b]||(this.deletedStates[i][m][b]=null)}else for(let b in p)this.deletedStates[i]&&this.deletedStates[i][m]&&this.deletedStates[i][m][b]===null&&delete this.deletedStates[i][m][b]}removeFeatureState(i,c,p){if(this.deletedStates[i]===null)return;let m=String(c);if(this.deletedStates[i]=this.deletedStates[i]||{},p&&c!==void 0)this.deletedStates[i][m]!==null&&(this.deletedStates[i][m]=this.deletedStates[i][m]||{},this.deletedStates[i][m][p]=null);else if(c!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][m])for(p in this.deletedStates[i][m]={},this.stateChanges[i][m])this.deletedStates[i][m][p]=null;else this.deletedStates[i][m]=null;else this.deletedStates[i]=null}getState(i,c){let p=String(c),m=s.e({},(this.state[i]||{})[p],(this.stateChanges[i]||{})[p]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){let b=this.deletedStates[i][c];if(b===null)return{};for(let u in b)delete m[u]}return m}initializeTileState(i,c){i.setFeatureState(this.state,c)}coalesceChanges(i,c){let p={};for(let m in this.stateChanges){this.state[m]=this.state[m]||{};let b={};for(let u in this.stateChanges[m])this.state[m][u]||(this.state[m][u]={}),s.e(this.state[m][u],this.stateChanges[m][u]),b[u]=this.state[m][u];p[m]=b}for(let m in this.deletedStates){this.state[m]=this.state[m]||{};let b={};if(this.deletedStates[m]===null)for(let u in this.state[m])b[u]={},this.state[m][u]={};else for(let u in this.deletedStates[m]){if(this.deletedStates[m][u]===null)this.state[m][u]={};else for(let g of Object.keys(this.deletedStates[m][u]))delete this.state[m][u][g];b[u]=this.state[m][u]}p[m]=p[m]||{},s.e(p[m],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(let m in i)i[m].setFeatureState(p,c)}}class Ke extends s.E{constructor(i,c,p){super(),this.id=i,this.dispatcher=p,this.on("data",m=>this._dataHandler(m)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((m,b,u,g)=>{let y=new(Ti(b.type))(m,b,u,g);if(y.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${y.id}`);return y})(i,c,p,this),this._tiles={},this._cache=new le(0,m=>this._unloadTile(m)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new gi,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let i in this._tiles){let c=this._tiles[i];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,c,p){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(i),this._tileLoaded(i,c,p)}catch(m){i.state="errored",m.status!==404?this._source.fire(new s.j(m,{tile:i})):this.update(this.transform,this.terrain)}})}_unloadTile(i){this._source.unloadTile&&this._source.unloadTile(i)}_abortTile(i){this._source.abortTile&&this._source.abortTile(i),this._source.fire(new s.k("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let c in this._tiles){let p=this._tiles[c];p.upload(i),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(or).map(i=>i.key)}getRenderableIds(i){let c=[];for(let p in this._tiles)this._isIdRenderable(p,i)&&c.push(this._tiles[p]);return i?c.sort((p,m)=>{let b=p.tileID,u=m.tileID,g=new s.P(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),y=new s.P(u.canonical.x,u.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-u.overscaledZ||y.y-g.y||y.x-g.x}).map(p=>p.tileID.key):c.map(p=>p.tileID).sort(or).map(p=>p.key)}hasRenderableParent(i){let c=this.findLoadedParent(i,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(i,c){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(c||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,c){return s._(this,void 0,void 0,function*(){let p=this._tiles[i];p&&(p.state!=="loading"&&(p.state=c),yield this._loadTile(p,i,c))})}_tileLoaded(i,c,p){i.timeAdded=_.now(),p==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(c,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new s.k("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){let c=this.getRenderableIds();for(let m=0;m<c.length;m++){let b=c[m];if(i.neighboringTiles&&i.neighboringTiles[b]){let u=this.getTileByID(b);p(i,u),p(u,i)}}function p(m,b){m.needsHillshadePrepare=!0,m.needsTerrainPrepare=!0;let u=b.tileID.canonical.x-m.tileID.canonical.x,g=b.tileID.canonical.y-m.tileID.canonical.y,y=Math.pow(2,m.tileID.canonical.z),x=b.tileID.key;u===0&&g===0||Math.abs(g)>1||(Math.abs(u)>1&&(Math.abs(u+y)===1?u+=y:Math.abs(u-y)===1&&(u-=y)),b.dem&&m.dem&&(m.dem.backfillBorder(b.dem,u,g),m.neighboringTiles&&m.neighboringTiles[x]&&(m.neighboringTiles[x].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,c,p,m){for(let b in this._tiles){let u=this._tiles[b];if(m[b]||!u.hasData()||u.tileID.overscaledZ<=c||u.tileID.overscaledZ>p)continue;let g=u.tileID;for(;u&&u.tileID.overscaledZ>c+1;){let x=u.tileID.scaledTo(u.tileID.overscaledZ-1);u=this._tiles[x.key],u&&u.hasData()&&(g=x)}let y=g;for(;y.overscaledZ>c;)if(y=y.scaledTo(y.overscaledZ-1),i[y.key]){m[g.key]=g;break}}}findLoadedParent(i,c){if(i.key in this._loadedParentTiles){let p=this._loadedParentTiles[i.key];return p&&p.tileID.overscaledZ>=c?p:null}for(let p=i.overscaledZ-1;p>=c;p--){let m=i.scaledTo(p),b=this._getLoadedTile(m);if(b)return b}}findLoadedSibling(i){return this._getLoadedTile(i)}_getLoadedTile(i){let c=this._tiles[i.key];return c&&c.hasData()?c:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){let c=Math.ceil(i.width/this._source.tileSize)+1,p=Math.ceil(i.height/this._source.tileSize)+1,m=Math.floor(c*p*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(b)}handleWrapJump(i){let c=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,c){let p={};for(let m in this._tiles){let b=this._tiles[m];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+c),p[b.tileID.key]=b}this._tiles=p;for(let m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(let m in this._tiles)this._setTileReloadTimer(m,this._tiles[m])}}_updateCoveredAndRetainedTiles(i,c,p,m,b,u){let g={},y={},x=Object.keys(i),k=_.now();for(let E of x){let R=i[E],P=this._tiles[E];if(!P||P.fadeEndTime!==0&&P.fadeEndTime<=k)continue;let H=this.findLoadedParent(R,c),N=this.findLoadedSibling(R),O=H||N||null;O&&(this._addTile(O.tileID),g[O.tileID.key]=O.tileID),y[E]=R}this._retainLoadedChildren(y,m,p,i);for(let E in g)i[E]||(this._coveredTiles[E]=!0,i[E]=g[E]);if(u){let E={},R={};for(let P of b)this._tiles[P.key].hasData()?E[P.key]=P:R[P.key]=P;for(let P in R){let H=R[P].children(this._source.maxzoom);this._tiles[H[0].key]&&this._tiles[H[1].key]&&this._tiles[H[2].key]&&this._tiles[H[3].key]&&(E[H[0].key]=i[H[0].key]=H[0],E[H[1].key]=i[H[1].key]=H[1],E[H[2].key]=i[H[2].key]=H[2],E[H[3].key]=i[H[3].key]=H[3],delete R[P])}for(let P in R){let H=R[P],N=this.findLoadedParent(H,this._source.minzoom),O=this.findLoadedSibling(H),et=N||O||null;if(et){E[et.tileID.key]=i[et.tileID.key]=et.tileID;for(let nt in E)E[nt].isChildOf(et.tileID)&&delete E[nt]}}for(let P in this._tiles)E[P]||(this._coveredTiles[P]=!0)}}update(i,c){if(!this._sourceLoaded||this._paused)return;let p;this.transform=i,this.terrain=c,this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new s.S(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(p=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:c}),this._source.hasTile&&(p=p.filter(k=>this._source.hasTile(k)))):p=[];let m=i.coveringZoomLevel(this._source),b=Math.max(m-Ke.maxOverzooming,this._source.minzoom),u=Math.max(m+Ke.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let k={};for(let E of p)if(E.canonical.z>this._source.minzoom){let R=E.scaledTo(E.canonical.z-1);k[R.key]=R;let P=E.scaledTo(Math.max(this._source.minzoom,Math.min(E.canonical.z,5)));k[P.key]=P}p=p.concat(Object.values(k))}let g=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,g&&this.fire(new s.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let y=this._updateRetainedTiles(p,m);Ki(this._source.type)&&this._updateCoveredAndRetainedTiles(y,b,u,m,p,c);for(let k in y)this._tiles[k].clearFadeHold();let x=s.ac(this._tiles,y);for(let k of x){let E=this._tiles[k];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(let i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,c){var p;let m={},b={},u=Math.max(c-Ke.maxOverzooming,this._source.minzoom),g=Math.max(c+Ke.maxUnderzooming,this._source.minzoom),y={};for(let x of i){let k=this._addTile(x);m[x.key]=x,k.hasData()||c<this._source.maxzoom&&(y[x.key]=x)}this._retainLoadedChildren(y,c,g,m);for(let x of i){let k=this._tiles[x.key];if(k.hasData())continue;if(c+1>this._source.maxzoom){let R=x.children(this._source.maxzoom)[0],P=this.getTile(R);if(P&&P.hasData()){m[R.key]=R;continue}}else{let R=x.children(this._source.maxzoom);if(m[R[0].key]&&m[R[1].key]&&m[R[2].key]&&m[R[3].key])continue}let E=k.wasRequested();for(let R=x.overscaledZ-1;R>=u;--R){let P=x.scaledTo(R);if(b[P.key])break;if(b[P.key]=!0,k=this.getTile(P),!k&&E&&(k=this._addTile(P)),k){let H=k.hasData();if((H||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||E)&&(m[P.key]=P),E=k.wasRequested(),H)break}}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let i in this._tiles){let c=[],p,m=this._tiles[i].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){p=this._loadedParentTiles[m.key];break}c.push(m.key);let b=m.scaledTo(m.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;m=b}for(let b of c)this._loadedParentTiles[b]=p}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(let i in this._tiles){let c=this._tiles[i].tileID,p=this._getLoadedTile(c);this._loadedSiblingTiles[c.key]=p}}_addTile(i){let c=this._tiles[i.key];if(c)return c;c=this._cache.getAndRemove(i),c&&(this._setTileReloadTimer(i.key,c),c.tileID=i,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,c)));let p=c;return c||(c=new Gi(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(c,i.key,c.state)),c.uses++,this._tiles[i.key]=c,p||this._source.fire(new s.k("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(i,c){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);let p=c.getExpiryTimeout();p&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},p))}_removeTile(i){let c=this._tiles[i];c&&(c.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}_dataHandler(i){let c=i.sourceDataType;i.dataType==="source"&&c==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&i.dataType==="source"&&c==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,c,p){let m=[],b=this.transform;if(!b)return m;let u=p?b.getCameraQueryGeometry(i):i,g=i.map(H=>b.pointCoordinate(H,this.terrain)),y=u.map(H=>b.pointCoordinate(H,this.terrain)),x=this.getIds(),k=1/0,E=1/0,R=-1/0,P=-1/0;for(let H of y)k=Math.min(k,H.x),E=Math.min(E,H.y),R=Math.max(R,H.x),P=Math.max(P,H.y);for(let H=0;H<x.length;H++){let N=this._tiles[x[H]];if(N.holdingForFade())continue;let O=N.tileID,et=Math.pow(2,b.zoom-N.tileID.overscaledZ),nt=c*N.queryPadding*s.X/N.tileSize/et,Y=[O.getTilePoint(new s.Z(k,E)),O.getTilePoint(new s.Z(R,P))];if(Y[0].x-nt<s.X&&Y[0].y-nt<s.X&&Y[1].x+nt>=0&&Y[1].y+nt>=0){let dt=g.map(ot=>O.getTilePoint(ot)),gt=y.map(ot=>O.getTilePoint(ot));m.push({tile:N,tileID:O,queryGeometry:dt,cameraQueryGeometry:gt,scale:et})}}return m}getVisibleCoordinates(i){let c=this.getRenderableIds(i).map(p=>this._tiles[p].tileID);for(let p of c)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(Ki(this._source.type)){let i=_.now();for(let c in this._tiles)if(this._tiles[c].fadeEndTime>=i)return!0}return!1}setFeatureState(i,c,p){this._state.updateState(i=i||"_geojsonTileLayer",c,p)}removeFeatureState(i,c,p){this._state.removeFeatureState(i=i||"_geojsonTileLayer",c,p)}getFeatureState(i,c){return this._state.getState(i=i||"_geojsonTileLayer",c)}setDependencies(i,c,p){let m=this._tiles[i];m&&m.setDependencies(c,p)}reloadTilesForDependencies(i,c){for(let p in this._tiles)this._tiles[p].hasDependency(i,c)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(i,c))}}function or(v,i){let c=Math.abs(2*v.wrap)-+(v.wrap<0),p=Math.abs(2*i.wrap)-+(i.wrap<0);return v.overscaledZ-i.overscaledZ||p-c||i.canonical.y-v.canonical.y||i.canonical.x-v.canonical.x}function Ki(v){return v==="raster"||v==="image"||v==="video"}Ke.maxOverzooming=10,Ke.maxUnderzooming=3;class ii{constructor(i,c){this.reset(i,c)}reset(i,c){this.points=i||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=s.ad(i,0,1);let c=1,p=this._distances[c],m=i*this.paddedLength+this.padding;for(;p<m&&c<this._distances.length;)p=this._distances[++c];let b=c-1,u=this._distances[b],g=p-u,y=g>0?(m-u)/g:0;return this.points[b].mult(1-y).add(this.points[c].mult(y))}}function br(v,i){let c=!0;return v==="always"||v!=="never"&&i!=="never"||(c=!1),c}class Ji{constructor(i,c,p){let m=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(i/p),this.yCellCount=Math.ceil(c/p);for(let u=0;u<this.xCellCount*this.yCellCount;u++)m.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=c,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,c,p,m,b){this._forEachCell(c,p,m,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(m),this.bboxes.push(b)}insertCircle(i,c,p,m){this._forEachCell(c-m,p-m,c+m,p+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(c),this.circles.push(p),this.circles.push(m)}_insertBoxCell(i,c,p,m,b,u){this.boxCells[b].push(u)}_insertCircleCell(i,c,p,m,b,u){this.circleCells[b].push(u)}_query(i,c,p,m,b,u,g){if(p<0||i>this.width||m<0||c>this.height)return[];let y=[];if(i<=0&&c<=0&&this.width<=p&&this.height<=m){if(b)return[{key:null,x1:i,y1:c,x2:p,y2:m}];for(let x=0;x<this.boxKeys.length;x++)y.push({key:this.boxKeys[x],x1:this.bboxes[4*x],y1:this.bboxes[4*x+1],x2:this.bboxes[4*x+2],y2:this.bboxes[4*x+3]});for(let x=0;x<this.circleKeys.length;x++){let k=this.circles[3*x],E=this.circles[3*x+1],R=this.circles[3*x+2];y.push({key:this.circleKeys[x],x1:k-R,y1:E-R,x2:k+R,y2:E+R})}}else this._forEachCell(i,c,p,m,this._queryCell,y,{hitTest:b,overlapMode:u,seenUids:{box:{},circle:{}}},g);return y}query(i,c,p,m){return this._query(i,c,p,m,!1,null)}hitTest(i,c,p,m,b,u){return this._query(i,c,p,m,!0,b,u).length>0}hitTestCircle(i,c,p,m,b){let u=i-p,g=i+p,y=c-p,x=c+p;if(g<0||u>this.width||x<0||y>this.height)return!1;let k=[];return this._forEachCell(u,y,g,x,this._queryCellCircle,k,{hitTest:!0,overlapMode:m,circle:{x:i,y:c,radius:p},seenUids:{box:{},circle:{}}},b),k.length>0}_queryCell(i,c,p,m,b,u,g,y){let{seenUids:x,hitTest:k,overlapMode:E}=g,R=this.boxCells[b];if(R!==null){let H=this.bboxes;for(let N of R)if(!x.box[N]){x.box[N]=!0;let O=4*N,et=this.boxKeys[N];if(i<=H[O+2]&&c<=H[O+3]&&p>=H[O+0]&&m>=H[O+1]&&(!y||y(et))&&(!k||!br(E,et.overlapMode))&&(u.push({key:et,x1:H[O],y1:H[O+1],x2:H[O+2],y2:H[O+3]}),k))return!0}}let P=this.circleCells[b];if(P!==null){let H=this.circles;for(let N of P)if(!x.circle[N]){x.circle[N]=!0;let O=3*N,et=this.circleKeys[N];if(this._circleAndRectCollide(H[O],H[O+1],H[O+2],i,c,p,m)&&(!y||y(et))&&(!k||!br(E,et.overlapMode))){let nt=H[O],Y=H[O+1],dt=H[O+2];if(u.push({key:et,x1:nt-dt,y1:Y-dt,x2:nt+dt,y2:Y+dt}),k)return!0}}}return!1}_queryCellCircle(i,c,p,m,b,u,g,y){let{circle:x,seenUids:k,overlapMode:E}=g,R=this.boxCells[b];if(R!==null){let H=this.bboxes;for(let N of R)if(!k.box[N]){k.box[N]=!0;let O=4*N,et=this.boxKeys[N];if(this._circleAndRectCollide(x.x,x.y,x.radius,H[O+0],H[O+1],H[O+2],H[O+3])&&(!y||y(et))&&!br(E,et.overlapMode))return u.push(!0),!0}}let P=this.circleCells[b];if(P!==null){let H=this.circles;for(let N of P)if(!k.circle[N]){k.circle[N]=!0;let O=3*N,et=this.circleKeys[N];if(this._circlesCollide(H[O],H[O+1],H[O+2],x.x,x.y,x.radius)&&(!y||y(et))&&!br(E,et.overlapMode))return u.push(!0),!0}}}_forEachCell(i,c,p,m,b,u,g,y){let x=this._convertToXCellCoord(i),k=this._convertToYCellCoord(c),E=this._convertToXCellCoord(p),R=this._convertToYCellCoord(m);for(let P=x;P<=E;P++)for(let H=k;H<=R;H++)if(b.call(this,i,c,p,m,this.xCellCount*H+P,u,g,y))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,c,p,m,b,u){let g=m-i,y=b-c,x=p+u;return x*x>g*g+y*y}_circleAndRectCollide(i,c,p,m,b,u,g){let y=(u-m)/2,x=Math.abs(i-(m+y));if(x>y+p)return!1;let k=(g-b)/2,E=Math.abs(c-(b+k));if(E>k+p)return!1;if(x<=y||E<=k)return!0;let R=x-y,P=E-k;return R*R+P*P<=p*p}}function wr(v,i,c,p,m){let b=s.H();return i?(s.K(b,b,[1/m,1/m,1]),c||s.ae(b,b,p.angle)):s.L(b,p.labelPlaneMatrix,v),b}function ar(v,i,c,p,m){if(i){let b=s.af(v);return s.K(b,b,[m,m,1]),c||s.ae(b,b,-p.angle),b}return p.glCoordMatrix}function wt(v,i,c){let p;c?(p=[v.x,v.y,c(v.x,v.y),1],s.ag(p,p,i)):(p=[v.x,v.y,0,1],function(b,u,g){let y=u[0],x=u[1];b[0]=g[0]*y+g[4]*x+g[12],b[1]=g[1]*y+g[5]*x+g[13],b[3]=g[3]*y+g[7]*x+g[15]}(p,p,i));let m=p[3];return{point:new s.P(p[0]/m,p[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function W(v,i){return .5+v/i*.5}function X(v,i){return v.x>=-i[0]&&v.x<=i[0]&&v.y>=-i[1]&&v.y<=i[1]}function rt(v,i,c,p,m,b,u,g,y,x,k,E,R,P,H){let N=p?v.textSizeData:v.iconSizeData,O=s.ah(N,c.transform.zoom),et=[256/c.width*2+1,256/c.height*2+1],nt=p?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;nt.clear();let Y=v.lineVertexArray,dt=p?v.text.placedSymbolArray:v.icon.placedSymbolArray,gt=c.transform.width/c.transform.height,ot=!1;for(let pt=0;pt<dt.length;pt++){let Dt=dt.get(pt);if(Dt.hidden||Dt.writingMode===s.ai.vertical&&!ot){ti(Dt.numGlyphs,nt);continue}ot=!1;let $t=wt(new s.P(Dt.anchorX,Dt.anchorY),i,H);if(!X($t.point,et)){ti(Dt.numGlyphs,nt);continue}let jt=W(c.transform.cameraToCenterDistance,$t.signedDistanceFromCamera),ue=s.aj(N,O,Dt),ce=u?ue/jt:ue*jt,Fe={getElevation:H,labelPlaneMatrix:m,lineVertexArray:Y,pitchWithMap:u,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:x,tileAnchorPoint:new s.P(Dt.anchorX,Dt.anchorY),unwrappedTileID:k,width:E,height:R,translation:P},xe=Vt(Fe,Dt,ce,!1,g,i,b,v.glyphOffsetArray,nt,gt,y);ot=xe.useVertical,(xe.notEnoughRoom||ot||xe.needsFlipping&&Vt(Fe,Dt,ce,!0,g,i,b,v.glyphOffsetArray,nt,gt,y).notEnoughRoom)&&ti(Dt.numGlyphs,nt)}p?v.text.dynamicLayoutVertexBuffer.updateData(nt):v.icon.dynamicLayoutVertexBuffer.updateData(nt)}function ft(v,i,c,p,m,b,u,g){let y=b.glyphStartIndex+b.numGlyphs,x=b.lineStartIndex,k=b.lineStartIndex+b.lineLength,E=i.getoffsetX(b.glyphStartIndex),R=i.getoffsetX(y-1),P=Le(v*E,c,p,m,b.segment,x,k,g,u);if(!P)return null;let H=Le(v*R,c,p,m,b.segment,x,k,g,u);return H?g.projectionCache.anyProjectionOccluded?null:{first:P,last:H}:null}function Mt(v,i,c,p){return v===s.ai.horizontal&&Math.abs(c.y-i.y)>Math.abs(c.x-i.x)*p?{useVertical:!0}:(v===s.ai.vertical?i.y<c.y:i.x>c.x)?{needsFlipping:!0}:null}function Vt(v,i,c,p,m,b,u,g,y,x,k){let E=c/24,R=i.lineOffsetX*E,P=i.lineOffsetY*E,H;if(i.numGlyphs>1){let N=i.glyphStartIndex+i.numGlyphs,O=i.lineStartIndex,et=i.lineStartIndex+i.lineLength,nt=ft(E,g,R,P,p,i,k,v);if(!nt)return{notEnoughRoom:!0};let Y=wt(nt.first.point,u,v.getElevation).point,dt=wt(nt.last.point,u,v.getElevation).point;if(m&&!p){let gt=Mt(i.writingMode,Y,dt,x);if(gt)return gt}H=[nt.first];for(let gt=i.glyphStartIndex+1;gt<N-1;gt++)H.push(Le(E*g.getoffsetX(gt),R,P,p,i.segment,O,et,v,k));H.push(nt.last)}else{if(m&&!p){let O=wt(v.tileAnchorPoint,b,v.getElevation).point,et=i.lineStartIndex+i.segment+1,nt=new s.P(v.lineVertexArray.getx(et),v.lineVertexArray.gety(et)),Y=wt(nt,b,v.getElevation),dt=Y.signedDistanceFromCamera>0?Y.point:function(ot,pt,Dt,$t,jt,ue){return Yt(ot,pt,Dt,1,jt,ue)}(v.tileAnchorPoint,nt,O,0,b,v),gt=Mt(i.writingMode,O,dt,x);if(gt)return gt}let N=Le(E*g.getoffsetX(i.glyphStartIndex),R,P,p,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,v,k);if(!N||v.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};H=[N]}for(let N of H)s.ak(y,N.point,N.angle);return{}}function Yt(v,i,c,p,m,b){let u=v.add(v.sub(i)._unit()),g=m!==void 0?wt(u,m,b.getElevation).point:Wt(u.x,u.y,b).point,y=c.sub(g);return c.add(y._mult(p/y.mag()))}function Rt(v,i,c){let p=i.projectionCache;if(p.projections[v])return p.projections[v];let m=new s.P(i.lineVertexArray.getx(v),i.lineVertexArray.gety(v)),b=Wt(m.x,m.y,i);if(b.signedDistanceFromCamera>0)return p.projections[v]=b.point,p.anyProjectionOccluded=p.anyProjectionOccluded||b.isOccluded,b.point;let u=v-c.direction;return function(g,y,x,k,E){return Yt(g,y,x,k,void 0,E)}(c.distanceFromAnchor===0?i.tileAnchorPoint:new s.P(i.lineVertexArray.getx(u),i.lineVertexArray.gety(u)),m,c.previousVertex,c.absOffsetX-c.distanceFromAnchor+1,i)}function Wt(v,i,c){let p=v+c.translation[0],m=i+c.translation[1],b;return!c.pitchWithMap&&c.projection.useSpecialProjectionForSymbols?(b=c.projection.projectTileCoordinates(p,m,c.unwrappedTileID,c.getElevation),b.point.x=(.5*b.point.x+.5)*c.width,b.point.y=(.5*-b.point.y+.5)*c.height):(b=wt(new s.P(p,m),c.labelPlaneMatrix,c.getElevation),b.isOccluded=!1),b}function be(v,i,c){return v._unit()._perp()._mult(i*c)}function he(v,i,c,p,m,b,u,g,y){if(g.projectionCache.offsets[v])return g.projectionCache.offsets[v];let x=c.add(i);if(v+y.direction<p||v+y.direction>=m)return g.projectionCache.offsets[v]=x,x;let k=Rt(v+y.direction,g,y),E=be(k.sub(c),u,y.direction),R=c.add(E),P=k.add(E);return g.projectionCache.offsets[v]=s.al(b,x,R,P)||x,g.projectionCache.offsets[v]}function Le(v,i,c,p,m,b,u,g,y){let x=p?v-i:v+i,k=x>0?1:-1,E=0;p&&(k*=-1,E=Math.PI),k<0&&(E+=Math.PI);let R,P=k>0?b+m:b+m+1;g.projectionCache.cachedAnchorPoint?R=g.projectionCache.cachedAnchorPoint:(R=Wt(g.tileAnchorPoint.x,g.tileAnchorPoint.y,g).point,g.projectionCache.cachedAnchorPoint=R);let H,N,O=R,et=R,nt=0,Y=0,dt=Math.abs(x),gt=[],ot;for(;nt+Y<=dt;){if(P+=k,P<b||P>=u)return null;nt+=Y,et=O,N=H;let $t={absOffsetX:dt,direction:k,distanceFromAnchor:nt,previousVertex:et};if(O=Rt(P,g,$t),c===0)gt.push(et),ot=O.sub(et);else{let jt,ue=O.sub(et);jt=ue.mag()===0?be(Rt(P+k,g,$t).sub(O),c,k):be(ue,c,k),N||(N=et.add(jt)),H=he(P,jt,O,b,u,N,c,g,$t),gt.push(N),ot=H.sub(N)}Y=ot.mag()}let pt=ot._mult((dt-nt)/Y)._add(N||et),Dt=E+Math.atan2(O.y-et.y,O.x-et.x);return gt.push(pt),{point:pt,angle:y?Dt:0,path:gt}}let je=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ti(v,i){for(let c=0;c<v;c++){let p=i.length;i.resize(p+4),i.float32.set(je,3*p)}}let _i=100;class $i{constructor(i,c,p=new Ji(i.width+200,i.height+200,25),m=new Ji(i.width+200,i.height+200,25)){this.transform=i,this.mapProjection=c,this.grid=p,this.ignoredGrid=m,this.pitchFactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+_i,this.screenBottomBoundary=i.height+_i,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,c,p,m,b,u,g,y,x,k,E){let R=i.anchorPointX+y[0],P=i.anchorPointY+y[1],H=this.projectAndGetPerspectiveRatio(m,R,P,b,k),N=this._projectCollisionBox(i,p,m,b,u,g,y,H,k,E),[O,et,nt,Y]=N.box;return this.mapProjection.useSpecialProjectionForSymbols&&(u?N.allPointsOccluded:this.mapProjection.isOccluded(R,P,b))||H.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(O,et,nt,Y)||c!=="always"&&this.grid.hitTest(O,et,nt,Y,c,x)?{box:[O,et,nt,Y],placeable:!1,offscreen:!1}:{box:[O,et,nt,Y],placeable:!0,offscreen:this.isOffscreen(O,et,nt,Y)}}placeCollisionCircles(i,c,p,m,b,u,g,y,x,k,E,R,P,H,N,O){let et=[],nt=new s.P(c.anchorX,c.anchorY),Y=this.getPerspectiveRatio(u,nt.x,nt.y,g,O),dt=(E?b/Y:b*Y)/s.aq,gt={getElevation:O,labelPlaneMatrix:y,lineVertexArray:p,pitchWithMap:E,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:nt,unwrappedTileID:g,width:this.transform.width,height:this.transform.height,translation:N},ot=ft(dt,m,c.lineOffsetX*dt,c.lineOffsetY*dt,!1,c,!1,gt),pt=!1,Dt=!1,$t=!0;if(ot){let jt=.5*P*Y+H,ue=new s.P(-100,-100),ce=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Fe=new ii,xe=ot.first,ke=ot.last,Ue=[];for(let pi=xe.path.length-1;pi>=1;pi--)Ue.push(xe.path[pi]);for(let pi=1;pi<ke.path.length;pi++)Ue.push(ke.path[pi]);let $e=2.5*jt;if(x){let pi=this.projectPathToScreenSpace(Ue,gt,x);Ue=pi.some(bi=>bi.signedDistanceFromCamera<=0)?[]:pi.map(bi=>bi.point)}let Li=[];if(Ue.length>0){let pi=Ue[0].clone(),bi=Ue[0].clone();for(let Ci=1;Ci<Ue.length;Ci++)pi.x=Math.min(pi.x,Ue[Ci].x),pi.y=Math.min(pi.y,Ue[Ci].y),bi.x=Math.max(bi.x,Ue[Ci].x),bi.y=Math.max(bi.y,Ue[Ci].y);Li=pi.x>=ue.x&&bi.x<=ce.x&&pi.y>=ue.y&&bi.y<=ce.y?[Ue]:bi.x<ue.x||pi.x>ce.x||bi.y<ue.y||pi.y>ce.y?[]:s.am([Ue],ue.x,ue.y,ce.x,ce.y)}for(let pi of Li){Fe.reset(pi,.25*jt);let bi=0;bi=Fe.length<=.5*jt?1:Math.ceil(Fe.paddedLength/$e)+1;for(let Ci=0;Ci<bi;Ci++){let mr=Ci/Math.max(bi-1,1),Jr=Fe.lerp(mr),Yi=Jr.x+_i,Rr=Jr.y+_i;et.push(Yi,Rr,jt,0);let rr=Yi-jt,Lr=Rr-jt,Er=Yi+jt,Tr=Rr+jt;if($t=$t&&this.isOffscreen(rr,Lr,Er,Tr),Dt=Dt||this.isInsideGrid(rr,Lr,Er,Tr),i!=="always"&&this.grid.hitTestCircle(Yi,Rr,jt,i,R)&&(pt=!0,!k))return{circles:[],offscreen:!1,collisionDetected:pt}}}}return{circles:!k&&pt||!Dt||Y<this.perspectiveRatioCutoff?[]:et,offscreen:$t,collisionDetected:pt}}projectPathToScreenSpace(i,c,p){return i.map(m=>wt(m,p,c.getElevation))}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let c=[],p=1/0,m=1/0,b=-1/0,u=-1/0;for(let k of i){let E=new s.P(k.x+_i,k.y+_i);p=Math.min(p,E.x),m=Math.min(m,E.y),b=Math.max(b,E.x),u=Math.max(u,E.y),c.push(E)}let g=this.grid.query(p,m,b,u).concat(this.ignoredGrid.query(p,m,b,u)),y={},x={};for(let k of g){let E=k.key;if(y[E.bucketInstanceId]===void 0&&(y[E.bucketInstanceId]={}),y[E.bucketInstanceId][E.featureIndex])continue;let R=[new s.P(k.x1,k.y1),new s.P(k.x2,k.y1),new s.P(k.x2,k.y2),new s.P(k.x1,k.y2)];s.an(c,R)&&(y[E.bucketInstanceId][E.featureIndex]=!0,x[E.bucketInstanceId]===void 0&&(x[E.bucketInstanceId]=[]),x[E.bucketInstanceId].push(E.featureIndex))}return x}insertCollisionBox(i,c,p,m,b,u){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:b,collisionGroupID:u,overlapMode:c},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,c,p,m,b,u){let g=p?this.ignoredGrid:this.grid,y={bucketInstanceId:m,featureIndex:b,collisionGroupID:u,overlapMode:c};for(let x=0;x<i.length;x+=4)g.insertCircle(y,i[x],i[x+1],i[x+2])}projectAndGetPerspectiveRatio(i,c,p,m,b){let u=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(c,p,m,b):wt(new s.P(c,p),i,b);return{point:new s.P((u.point.x+1)/2*this.transform.width+_i,(1-u.point.y)/2*this.transform.height+_i),perspectiveRatio:.5+this.transform.cameraToCenterDistance/u.signedDistanceFromCamera*.5,isOccluded:u.isOccluded,signedDistanceFromCamera:u.signedDistanceFromCamera}}getPerspectiveRatio(i,c,p,m,b){let u=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(c,p,m,b):wt(new s.P(c,p),i,b);return .5+this.transform.cameraToCenterDistance/u.signedDistanceFromCamera*.5}isOffscreen(i,c,p,m){return p<_i||i>=this.screenRightBoundary||m<_i||c>this.screenBottomBoundary}isInsideGrid(i,c,p,m){return p>=0&&i<this.gridRightBoundary&&m>=0&&c<this.gridBottomBoundary}getViewportMatrix(){let i=s.ao([]);return s.J(i,i,[-100,-100,0]),i}_projectCollisionBox(i,c,p,m,b,u,g,y,x,k){let E=c*y.perspectiveRatio,R=new s.P(1,0),P=new s.P(0,1),H=new s.P(i.anchorPointX+g[0],i.anchorPointY+g[1]);if(u&&!b){let jt=this.projectAndGetPerspectiveRatio(p,H.x+1,H.y,m,x).point.sub(y.point).unit(),ue=Math.atan(jt.y/jt.x)+(jt.x<0?Math.PI:0),ce=Math.sin(ue),Fe=Math.cos(ue);R=new s.P(Fe,ce),P=new s.P(-ce,Fe)}else if(!u&&b){let jt=-this.transform.angle,ue=Math.sin(jt),ce=Math.cos(jt);R=new s.P(ce,ue),P=new s.P(-ue,ce)}let N=y.point,O=E;if(b){N=H;let jt=this.transform.zoom-Math.floor(this.transform.zoom);O=Math.pow(2,-jt),O*=this.mapProjection.getPitchedTextCorrection(this.transform,H,m),k||(O*=s.ad(.5+y.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}k&&(N=N.add(R.mult(k.x*O)).add(P.mult(k.y*O)));let et=i.x1*O,nt=i.x2*O,Y=(et+nt)/2,dt=i.y1*O,gt=i.y2*O,ot=(dt+gt)/2,pt=[{offsetX:et,offsetY:dt},{offsetX:Y,offsetY:dt},{offsetX:nt,offsetY:dt},{offsetX:nt,offsetY:ot},{offsetX:nt,offsetY:gt},{offsetX:Y,offsetY:gt},{offsetX:et,offsetY:gt},{offsetX:et,offsetY:ot}],Dt=[];for(let{offsetX:jt,offsetY:ue}of pt)Dt.push(new s.P(N.x+R.x*jt+P.x*ue,N.y+R.y*jt+P.y*ue));let $t=!1;if(b){let jt=Dt.map(ue=>this.projectAndGetPerspectiveRatio(p,ue.x,ue.y,m,x));$t=jt.some(ue=>!ue.isOccluded),Dt=jt.map(ue=>ue.point)}else $t=!0;return{box:s.ap(Dt),allPointsOccluded:!$t}}}function xi(v,i,c){return i*(s.X/(v.tileSize*Math.pow(2,c-v.tileID.overscaledZ)))}class zi{constructor(i,c,p,m){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?c:-c))):m&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class hr{constructor(i,c,p,m,b){this.text=new zi(i?i.text:null,c,p,b),this.icon=new zi(i?i.icon:null,c,m,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class fr{constructor(i,c,p){this.text=i,this.icon=c,this.skipFade=p}}class Hi{constructor(){this.invProjMatrix=s.H(),this.viewportMatrix=s.H(),this.circles=[]}}class Wi{constructor(i,c,p,m,b){this.bucketInstanceId=i,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=m,this.tileID=b}}class Ar{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){let c=++this.maxGroupID;this.collisionGroups[i]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[i]}}function Zt(v,i,c,p,m){let{horizontalAlign:b,verticalAlign:u}=s.av(v);return new s.P(-(b-.5)*i+p[0]*m,-(u-.5)*c+p[1]*m)}class De{constructor(i,c,p,m,b,u){this.transform=i.clone(),this.terrain=p,this.collisionIndex=new $i(this.transform,c),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new Ar(b),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(i){let c=this.terrain;return c?(p,m)=>c.getElevation(i,p,m):null}getBucketParts(i,c,p,m){let b=p.getBucket(c),u=p.latestFeatureIndex;if(!b||!u||c.id!==b.layerIds[0])return;let g=p.collisionBoxArray,y=b.layers[0].layout,x=b.layers[0].paint,k=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),E=p.tileSize/s.X,R=p.tileID.toUnwrapped(),P=this.transform.calculatePosMatrix(R),H=y.get("text-pitch-alignment")==="map",N=y.get("text-rotation-alignment")==="map",O=xi(p,1,this.transform.zoom),et=this.collisionIndex.mapProjection.translatePosition(this.transform,p,x.get("text-translate"),x.get("text-translate-anchor")),nt=this.collisionIndex.mapProjection.translatePosition(this.transform,p,x.get("icon-translate"),x.get("icon-translate-anchor")),Y=wr(P,H,N,this.transform,O),dt=null;if(H){let ot=ar(P,H,N,this.transform,O);dt=s.L([],this.transform.labelPlaneMatrix,ot)}this.retainedQueryData[b.bucketInstanceId]=new Wi(b.bucketInstanceId,u,b.sourceLayerIndex,b.index,p.tileID);let gt={bucket:b,layout:y,translationText:et,translationIcon:nt,posMatrix:P,unwrappedTileID:R,textLabelPlaneMatrix:Y,labelToScreenMatrix:dt,scale:k,textPixelRatio:E,holdingForFade:p.holdingForFade(),collisionBoxArray:g,partiallyEvaluatedTextSize:s.ah(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(m)for(let ot of b.sortKeyRanges){let{sortKey:pt,symbolInstanceStart:Dt,symbolInstanceEnd:$t}=ot;i.push({sortKey:pt,symbolInstanceStart:Dt,symbolInstanceEnd:$t,parameters:gt})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:gt})}attemptAnchorPlacement(i,c,p,m,b,u,g,y,x,k,E,R,P,H,N,O,et,nt,Y){let dt=s.ar[i.textAnchor],gt=[i.textOffset0,i.textOffset1],ot=Zt(dt,p,m,gt,b),pt=this.collisionIndex.placeCollisionBox(c,R,y,x,k,g,u,O,E.predicate,Y,ot);if((!nt||this.collisionIndex.placeCollisionBox(nt,R,y,x,k,g,u,et,E.predicate,Y,ot).placeable)&&pt.placeable){let Dt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[P.crossTileID]&&this.prevPlacement.placements[P.crossTileID]&&this.prevPlacement.placements[P.crossTileID].text&&(Dt=this.prevPlacement.variableOffsets[P.crossTileID].anchor),P.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[P.crossTileID]={textOffset:gt,width:p,height:m,anchor:dt,textBoxScale:b,prevAnchor:Dt},this.markUsedJustification(H,dt,P,N),H.allowVerticalPlacement&&(this.markUsedOrientation(H,N,P),this.placedOrientations[P.crossTileID]=N),{shift:ot,placedGlyphBoxes:pt}}}placeLayerBucketPart(i,c,p){let{bucket:m,layout:b,translationText:u,translationIcon:g,posMatrix:y,unwrappedTileID:x,textLabelPlaneMatrix:k,labelToScreenMatrix:E,textPixelRatio:R,holdingForFade:P,collisionBoxArray:H,partiallyEvaluatedTextSize:N,collisionGroup:O}=i.parameters,et=b.get("text-optional"),nt=b.get("icon-optional"),Y=s.as(b,"text-overlap","text-allow-overlap"),dt=Y==="always",gt=s.as(b,"icon-overlap","icon-allow-overlap"),ot=gt==="always",pt=b.get("text-rotation-alignment")==="map",Dt=b.get("text-pitch-alignment")==="map",$t=b.get("icon-text-fit")!=="none",jt=b.get("symbol-z-order")==="viewport-y",ue=dt&&(ot||!m.hasIconData()||nt),ce=ot&&(dt||!m.hasTextData()||et);!m.collisionArrays&&H&&m.deserializeCollisionBoxes(H);let Fe=this._getTerrainElevationFunc(this.retainedQueryData[m.bucketInstanceId].tileID),xe=(ke,Ue,$e)=>{var Li,pi;if(c[ke.crossTileID])return;if(P)return void(this.placements[ke.crossTileID]=new fr(!1,!1,!1));let bi=!1,Ci=!1,mr=!0,Jr=null,Yi={box:null,placeable:!1,offscreen:null},Rr={box:null,placeable:!1,offscreen:null},rr=null,Lr=null,Er=null,Tr=0,rn=0,_n=0;Ue.textFeatureIndex?Tr=Ue.textFeatureIndex:ke.useRuntimeCollisionCircles&&(Tr=ke.featureIndex),Ue.verticalTextFeatureIndex&&(rn=Ue.verticalTextFeatureIndex);let Tn=Ue.textBox;if(Tn){let nn=xn=>{let Un=s.ai.horizontal;if(m.allowVerticalPlacement&&!xn&&this.prevPlacement){let yn=this.prevPlacement.placedOrientations[ke.crossTileID];yn&&(this.placedOrientations[ke.crossTileID]=yn,Un=yn,this.markUsedOrientation(m,Un,ke))}return Un},Wn=(xn,Un)=>{if(m.allowVerticalPlacement&&ke.numVerticalGlyphVertices>0&&Ue.verticalTextBox){for(let yn of m.writingModes)if(yn===s.ai.vertical?(Yi=Un(),Rr=Yi):Yi=xn(),Yi&&Yi.placeable)break}else Yi=xn()},es=ke.textAnchorOffsetStartIndex,Gr=ke.textAnchorOffsetEndIndex;if(Gr===es){let xn=(Un,yn)=>{let Zr=this.collisionIndex.placeCollisionBox(Un,Y,R,y,x,Dt,pt,u,O.predicate,Fe);return Zr&&Zr.placeable&&(this.markUsedOrientation(m,yn,ke),this.placedOrientations[ke.crossTileID]=yn),Zr};Wn(()=>xn(Tn,s.ai.horizontal),()=>{let Un=Ue.verticalTextBox;return m.allowVerticalPlacement&&ke.numVerticalGlyphVertices>0&&Un?xn(Un,s.ai.vertical):{box:null,offscreen:null}}),nn(Yi&&Yi.placeable)}else{let xn=s.ar[(pi=(Li=this.prevPlacement)===null||Li===void 0?void 0:Li.variableOffsets[ke.crossTileID])===null||pi===void 0?void 0:pi.anchor],Un=(Zr,Po,GA)=>{let xr=Zr.x2-Zr.x1,Ya=Zr.y2-Zr.y1,ra=ke.textBoxScale,gl=$t&&gt==="never"?Po:null,Co=null,Ec=Y==="never"?1:2,ZA="never";xn&&Ec++;for(let dl=0;dl<Ec;dl++){for(let PA=es;PA<Gr;PA++){let Ea=m.textAnchorOffsets.get(PA);if(xn&&Ea.textAnchor!==xn)continue;let HA=this.attemptAnchorPlacement(Ea,Zr,xr,Ya,ra,pt,Dt,R,y,x,O,ZA,ke,m,GA,u,g,gl,Fe);if(HA&&(Co=HA.placedGlyphBoxes,Co&&Co.placeable))return bi=!0,Jr=HA.shift,Co}xn?xn=null:ZA=Y}return p&&!Co&&(Co={box:this.collisionIndex.placeCollisionBox(Tn,"always",R,y,x,Dt,pt,u,O.predicate,Fe,new s.P(0,0)).box,offscreen:!1,placeable:!1}),Co};Wn(()=>Un(Tn,Ue.iconBox,s.ai.horizontal),()=>{let Zr=Ue.verticalTextBox;return m.allowVerticalPlacement&&(!Yi||!Yi.placeable)&&ke.numVerticalGlyphVertices>0&&Zr?Un(Zr,Ue.verticalIconBox,s.ai.vertical):{box:null,occluded:!0,offscreen:null}}),Yi&&(bi=Yi.placeable,mr=Yi.offscreen);let yn=nn(Yi&&Yi.placeable);if(!bi&&this.prevPlacement){let Zr=this.prevPlacement.variableOffsets[ke.crossTileID];Zr&&(this.variableOffsets[ke.crossTileID]=Zr,this.markUsedJustification(m,Zr.anchor,ke,yn))}}}if(rr=Yi,bi=rr&&rr.placeable,mr=rr&&rr.offscreen,ke.useRuntimeCollisionCircles){let nn=m.text.placedSymbolArray.get(ke.centerJustifiedTextSymbolIndex),Wn=s.aj(m.textSizeData,N,nn),es=b.get("text-padding");Lr=this.collisionIndex.placeCollisionCircles(Y,nn,m.lineVertexArray,m.glyphOffsetArray,Wn,y,x,k,E,p,Dt,O.predicate,ke.collisionCircleDiameter,es,u,Fe),Lr.circles.length&&Lr.collisionDetected&&!p&&s.w("Collisions detected, but collision boxes are not shown"),bi=dt||Lr.circles.length>0&&!Lr.collisionDetected,mr=mr&&Lr.offscreen}if(Ue.iconFeatureIndex&&(_n=Ue.iconFeatureIndex),Ue.iconBox){let nn=Wn=>this.collisionIndex.placeCollisionBox(Wn,gt,R,y,x,Dt,pt,g,O.predicate,Fe,$t&&Jr?Jr:void 0);Rr&&Rr.placeable&&Ue.verticalIconBox?(Er=nn(Ue.verticalIconBox),Ci=Er.placeable):(Er=nn(Ue.iconBox),Ci=Er.placeable),mr=mr&&Er.offscreen}let On=et||ke.numHorizontalGlyphVertices===0&&ke.numVerticalGlyphVertices===0,gn=nt||ke.numIconVertices===0;On||gn?gn?On||(Ci=Ci&&bi):bi=Ci&&bi:Ci=bi=Ci&&bi;let mo=Ci&&Er.placeable;if(bi&&rr.placeable&&this.collisionIndex.insertCollisionBox(rr.box,Y,b.get("text-ignore-placement"),m.bucketInstanceId,Rr&&Rr.placeable&&rn?rn:Tr,O.ID),mo&&this.collisionIndex.insertCollisionBox(Er.box,gt,b.get("icon-ignore-placement"),m.bucketInstanceId,_n,O.ID),Lr&&bi&&this.collisionIndex.insertCollisionCircles(Lr.circles,Y,b.get("text-ignore-placement"),m.bucketInstanceId,Tr,O.ID),p&&this.storeCollisionData(m.bucketInstanceId,$e,Ue,rr,Er,Lr),ke.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(m.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ke.crossTileID]=new fr(bi||ue,Ci||ce,mr||m.justReloaded),c[ke.crossTileID]=!0};if(jt){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let ke=m.getSortedSymbolIndexes(this.transform.angle);for(let Ue=ke.length-1;Ue>=0;--Ue){let $e=ke[Ue];xe(m.symbolInstances.get($e),m.collisionArrays[$e],$e)}}else for(let ke=i.symbolInstanceStart;ke<i.symbolInstanceEnd;ke++)xe(m.symbolInstances.get(ke),m.collisionArrays[ke],ke);if(p&&m.bucketInstanceId in this.collisionCircleArrays){let ke=this.collisionCircleArrays[m.bucketInstanceId];s.at(ke.invProjMatrix,y),ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}m.justReloaded=!1}storeCollisionData(i,c,p,m,b,u){if(p.textBox||p.iconBox){let g,y;this.collisionBoxArrays.has(i)?g=this.collisionBoxArrays.get(i):(g=new Map,this.collisionBoxArrays.set(i,g)),g.has(c)?y=g.get(c):(y={text:null,icon:null},g.set(c,y)),p.textBox&&(y.text=m.box),p.iconBox&&(y.icon=b.box)}if(u){let g=this.collisionCircleArrays[i];g===void 0&&(g=this.collisionCircleArrays[i]=new Hi);for(let y=0;y<u.circles.length;y+=4)g.circles.push(u.circles[y+0]),g.circles.push(u.circles[y+1]),g.circles.push(u.circles[y+2]),g.circles.push(u.collisionDetected?1:0)}}markUsedJustification(i,c,p,m){let b;b=m===s.ai.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[s.au(c)];let u=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(let g of u)g>=0&&(i.text.placedSymbolArray.get(g).crossTileID=b>=0&&g!==b?0:p.crossTileID)}markUsedOrientation(i,c,p){let m=c===s.ai.horizontal||c===s.ai.horizontalOnly?c:0,b=c===s.ai.vertical?c:0,u=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(let g of u)i.text.placedSymbolArray.get(g).placedOrientation=m;p.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;let c=this.prevPlacement,p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;let m=c?c.symbolFadeChange(i):1,b=c?c.opacities:{},u=c?c.variableOffsets:{},g=c?c.placedOrientations:{};for(let y in this.placements){let x=this.placements[y],k=b[y];k?(this.opacities[y]=new hr(k,m,x.text,x.icon),p=p||x.text!==k.text.placed||x.icon!==k.icon.placed):(this.opacities[y]=new hr(null,m,x.text,x.icon,x.skipFade),p=p||x.text||x.icon)}for(let y in b){let x=b[y];if(!this.opacities[y]){let k=new hr(x,m,!1,!1);k.isHidden()||(this.opacities[y]=k,p=p||x.text.placed||x.icon.placed)}}for(let y in u)this.variableOffsets[y]||!this.opacities[y]||this.opacities[y].isHidden()||(this.variableOffsets[y]=u[y]);for(let y in g)this.placedOrientations[y]||!this.opacities[y]||this.opacities[y].isHidden()||(this.placedOrientations[y]=g[y]);if(c&&c.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:i)}updateLayerOpacities(i,c){let p={};for(let m of c){let b=m.getBucket(i);b&&m.latestFeatureIndex&&i.id===b.layerIds[0]&&this.updateBucketOpacities(b,m.tileID,p,m.collisionBoxArray)}}updateBucketOpacities(i,c,p,m){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();let b=i.layers[0],u=b.layout,g=new hr(null,0,!1,!1,!0),y=u.get("text-allow-overlap"),x=u.get("icon-allow-overlap"),k=b._unevaluatedLayout.hasValue("text-variable-anchor")||b._unevaluatedLayout.hasValue("text-variable-anchor-offset"),E=u.get("text-rotation-alignment")==="map",R=u.get("text-pitch-alignment")==="map",P=u.get("icon-text-fit")!=="none",H=new hr(null,0,y&&(x||!i.hasIconData()||u.get("icon-optional")),x&&(y||!i.hasTextData()||u.get("text-optional")),!0);!i.collisionArrays&&m&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(m);let N=(et,nt,Y)=>{for(let dt=0;dt<nt/4;dt++)et.opacityVertexArray.emplaceBack(Y);et.hasVisibleVertices=et.hasVisibleVertices||Y!==An},O=this.collisionBoxArrays.get(i.bucketInstanceId);for(let et=0;et<i.symbolInstances.length;et++){let nt=i.symbolInstances.get(et),{numHorizontalGlyphVertices:Y,numVerticalGlyphVertices:dt,crossTileID:gt}=nt,ot=this.opacities[gt];p[gt]?ot=g:ot||(ot=H,this.opacities[gt]=ot),p[gt]=!0;let pt=nt.numIconVertices>0,Dt=this.placedOrientations[nt.crossTileID],$t=Dt===s.ai.vertical,jt=Dt===s.ai.horizontal||Dt===s.ai.horizontalOnly;if(Y>0||dt>0){let ce=pn(ot.text);N(i.text,Y,$t?An:ce),N(i.text,dt,jt?An:ce);let Fe=ot.text.isHidden();[nt.rightJustifiedTextSymbolIndex,nt.centerJustifiedTextSymbolIndex,nt.leftJustifiedTextSymbolIndex].forEach(Ue=>{Ue>=0&&(i.text.placedSymbolArray.get(Ue).hidden=Fe||$t?1:0)}),nt.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(nt.verticalPlacedTextSymbolIndex).hidden=Fe||jt?1:0);let xe=this.variableOffsets[nt.crossTileID];xe&&this.markUsedJustification(i,xe.anchor,nt,Dt);let ke=this.placedOrientations[nt.crossTileID];ke&&(this.markUsedJustification(i,"left",nt,ke),this.markUsedOrientation(i,ke,nt))}if(pt){let ce=pn(ot.icon),Fe=!(P&&nt.verticalPlacedIconSymbolIndex&&$t);nt.placedIconSymbolIndex>=0&&(N(i.icon,nt.numIconVertices,Fe?ce:An),i.icon.placedSymbolArray.get(nt.placedIconSymbolIndex).hidden=ot.icon.isHidden()),nt.verticalPlacedIconSymbolIndex>=0&&(N(i.icon,nt.numVerticalIconVertices,Fe?An:ce),i.icon.placedSymbolArray.get(nt.verticalPlacedIconSymbolIndex).hidden=ot.icon.isHidden())}let ue=O&&O.has(et)?O.get(et):{text:null,icon:null};if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){let ce=i.collisionArrays[et];if(ce){let Fe=new s.P(0,0);if(ce.textBox||ce.verticalTextBox){let xe=!0;if(k){let ke=this.variableOffsets[gt];ke?(Fe=Zt(ke.anchor,ke.width,ke.height,ke.textOffset,ke.textBoxScale),E&&Fe._rotate(R?this.transform.angle:-this.transform.angle)):xe=!1}if(ce.textBox||ce.verticalTextBox){let ke;ce.textBox&&(ke=$t),ce.verticalTextBox&&(ke=jt),Te(i.textCollisionBox.collisionVertexArray,ot.text.placed,!xe||ke,ue.text,Fe.x,Fe.y)}}if(ce.iconBox||ce.verticalIconBox){let xe=Boolean(!jt&&ce.verticalIconBox),ke;ce.iconBox&&(ke=xe),ce.verticalIconBox&&(ke=!xe),Te(i.iconCollisionBox.collisionVertexArray,ot.icon.placed,ke,ue.icon,P?Fe.x:0,P?Fe.y:0)}}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){let et=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=et.invProjMatrix,i.placementViewportMatrix=et.viewportMatrix,i.collisionCircleArray=et.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,c){let p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>i}setStale(){this.stale=!0}}function Te(v,i,c,p,m,b){p&&p.length!==0||(p=[0,0,0,0]);let u=p[0]-_i,g=p[1]-_i,y=p[2]-_i,x=p[3]-_i;v.emplaceBack(i?1:0,c?1:0,m||0,b||0,u,g),v.emplaceBack(i?1:0,c?1:0,m||0,b||0,y,g),v.emplaceBack(i?1:0,c?1:0,m||0,b||0,y,x),v.emplaceBack(i?1:0,c?1:0,m||0,b||0,u,x)}let tr=Math.pow(2,25),Ui=Math.pow(2,24),an=Math.pow(2,17),Fr=Math.pow(2,16),$r=Math.pow(2,9),Ir=Math.pow(2,8),hn=Math.pow(2,1);function pn(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;let i=v.placed?1:0,c=Math.floor(127*v.opacity);return c*tr+i*Ui+c*an+i*Fr+c*$r+i*Ir+c*hn+i}let An=0;function pa(){return{isOccluded:(v,i,c)=>!1,getPitchedTextCorrection:(v,i,c)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(v,i,c,p){throw new Error("Not implemented.")},translatePosition:(v,i,c,p)=>function(m,b,u,g,y=!1){if(!u[0]&&!u[1])return[0,0];let x=y?g==="map"?m.angle:0:g==="viewport"?-m.angle:0;if(x){let k=Math.sin(x),E=Math.cos(x);u=[u[0]*E-u[1]*k,u[0]*k+u[1]*E]}return[y?u[0]:xi(b,u[0],m.zoom),y?u[1]:xi(b,u[1],m.zoom)]}(v,i,c,p),getCircleRadiusCorrection:v=>1}}class Rs{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,c,p,m,b){let u=this._bucketParts;for(;this._currentTileIndex<i.length;)if(c.getBucketParts(u,m,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,u.sort((g,y)=>g.sortKey-y.sortKey));this._currentPartIndex<u.length;)if(c.placeLayerBucketPart(u[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,b())return!0;return!1}}class Or{constructor(i,c,p,m,b,u,g,y){this.placement=new De(i,pa(),c,u,g,y),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(i,c,p){let m=_.now(),b=()=>!this._forceFullPlacement&&_.now()-m>2;for(;this._currentPlacementIndex>=0;){let u=c[i[this._currentPlacementIndex]],g=this.placement.collisionIndex.transform.zoom;if(u.type==="symbol"&&(!u.minzoom||u.minzoom<=g)&&(!u.maxzoom||u.maxzoom>g)){if(this._inProgressLayer||(this._inProgressLayer=new Rs(u)),this._inProgressLayer.continuePlacement(p[u.source],this.placement,this._showCollisionBoxes,u,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}let vn=512/s.X/2;class io{constructor(i,c,p){this.tileID=i,this.bucketInstanceId=p,this._symbolsByKey={};let m=new Map;for(let b=0;b<c.length;b++){let u=c.get(b),g=u.key,y=m.get(g);y?y.push(u):m.set(g,[u])}for(let[b,u]of m){let g={positions:u.map(y=>({x:Math.floor(y.anchorX*vn),y:Math.floor(y.anchorY*vn)})),crossTileIDs:u.map(y=>y.crossTileID)};if(g.positions.length>128){let y=new s.aw(g.positions.length,16,Uint16Array);for(let{x,y:k}of g.positions)y.add(x,k);y.finish(),delete g.positions,g.index=y}this._symbolsByKey[b]=g}}getScaledCoordinates(i,c){let{x:p,y:m,z:b}=this.tileID.canonical,{x:u,y:g,z:y}=c.canonical,x=vn/Math.pow(2,y-b),k=(g*s.X+i.anchorY)*x,E=m*s.X*vn;return{x:Math.floor((u*s.X+i.anchorX)*x-p*s.X*vn),y:Math.floor(k-E)}}findMatches(i,c,p){let m=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let b=0;b<i.length;b++){let u=i.get(b);if(u.crossTileID)continue;let g=this._symbolsByKey[u.key];if(!g)continue;let y=this.getScaledCoordinates(u,c);if(g.index){let x=g.index.range(y.x-m,y.y-m,y.x+m,y.y+m).sort();for(let k of x){let E=g.crossTileIDs[k];if(!p[E]){p[E]=!0,u.crossTileID=E;break}}}else if(g.positions)for(let x=0;x<g.positions.length;x++){let k=g.positions[x],E=g.crossTileIDs[x];if(Math.abs(k.x-y.x)<=m&&Math.abs(k.y-y.y)<=m&&!p[E]){p[E]=!0,u.crossTileID=E;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:i})=>i)}}class ir{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ro{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){let c=Math.round((i-this.lng)/360);if(c!==0)for(let p in this.indexes){let m=this.indexes[p],b={};for(let u in m){let g=m[u];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+c),b[g.tileID.key]=g}this.indexes[p]=b}this.lng=i}addBucket(i,c,p){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let b=0;b<c.symbolInstances.length;b++)c.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});let m=this.usedCrossTileIDs[i.overscaledZ];for(let b in this.indexes){let u=this.indexes[b];if(Number(b)>i.overscaledZ)for(let g in u){let y=u[g];y.tileID.isChildOf(i)&&y.findMatches(c.symbolInstances,i,m)}else{let g=u[i.scaledTo(Number(b)).key];g&&g.findMatches(c.symbolInstances,i,m)}}for(let b=0;b<c.symbolInstances.length;b++){let u=c.symbolInstances.get(b);u.crossTileID||(u.crossTileID=p.generate(),m[u.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new io(i,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(i,c){for(let p of c.getCrossTileIDsLists())for(let m of p)delete this.usedCrossTileIDs[i][m]}removeStaleBuckets(i){let c=!1;for(let p in this.indexes){let m=this.indexes[p];for(let b in m)i[m[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,m[b]),delete m[b],c=!0)}return c}}class wn{constructor(){this.layerIndexes={},this.crossTileIDs=new ir,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,c,p){let m=this.layerIndexes[i.id];m===void 0&&(m=this.layerIndexes[i.id]=new ro);let b=!1,u={};m.handleWrapJump(p);for(let g of c){let y=g.getBucket(i);y&&i.id===y.layerIds[0]&&(y.bucketInstanceId||(y.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(g.tileID,y,this.crossTileIDs)&&(b=!0),u[y.bucketInstanceId]=!0)}return m.removeStaleBuckets(u)&&(b=!0),b}pruneUnusedLayers(i){let c={};i.forEach(p=>{c[p]=!0});for(let p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}let no=(v,i)=>s.t(v,i&&i.filter(c=>c.identifier!=="source.canvas")),ns=s.ax();class ht extends s.E{constructor(i,c={}){super(),this._rtlPluginLoaded=()=>{for(let p in this.sourceCaches){let m=this.sourceCaches[p].getSource().type;m!=="vector"&&m!=="geojson"||this.sourceCaches[p].reload()}},this.map=i,this.dispatcher=new ge(ae(),i._getMapId()),this.dispatcher.registerMessageHandler("GG",(p,m)=>this.getGlyphs(p,m)),this.dispatcher.registerMessageHandler("GI",(p,m)=>this.getImages(p,m)),this.imageManager=new lt,this.imageManager.setEventedParent(this),this.glyphManager=new se(i._requestManager,c.localIdeographFontFamily),this.lineAtlas=new pe(256,512),this.crossTileSymbolIndex=new wn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",s.az()),mi().on(fe,this._rtlPluginLoaded),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;let m=this.sourceCaches[p.sourceId];if(!m)return;let b=m.getSource();if(b&&b.vectorLayerIds)for(let u in this._layers){let g=this._layers[u];g.source===b.id&&this._validateLayer(g)}})}loadURL(i,c={},p){this.fire(new s.k("dataloading",{dataType:"style"})),c.validate=typeof c.validate!="boolean"||c.validate;let m=this.map._requestManager.transformRequest(i,"Style");this._loadStyleRequest=new AbortController;let b=this._loadStyleRequest;s.h(m,this._loadStyleRequest).then(u=>{this._loadStyleRequest=null,this._load(u.data,c,p)}).catch(u=>{this._loadStyleRequest=null,u&&!b.signal.aborted&&this.fire(new s.j(u))})}loadJSON(i,c={},p){this.fire(new s.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,_.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,c.validate=c.validate!==!1,this._load(i,c,p)}).catch(()=>{})}loadEmpty(){this.fire(new s.k("dataloading",{dataType:"style"})),this._load(ns,{validate:!1})}_load(i,c,p){var m;let b=c.transformStyle?c.transformStyle(p,i):i;if(!c.validate||!no(this,s.x(b))){this._loaded=!0,this.stylesheet=b;for(let u in b.sources)this.addSource(u,b.sources[u],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new Xt(this.stylesheet.light),this.sky=new Tt(this.stylesheet.sky),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new s.k("data",{dataType:"style"})),this.fire(new s.k("style.load"))}}_createLayers(){let i=s.aA(this.stylesheet.layers);this.dispatcher.broadcast("SL",i),this._order=i.map(c=>c.id),this._layers={},this._serializedLayers=null;for(let c of i){let p=s.aB(c);p.setEventedParent(this,{layer:{id:c.id}}),this._layers[c.id]=p}}_loadSprite(i,c=!1,p=void 0){let m;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(b,u,g,y){return s._(this,void 0,void 0,function*(){let x=xt(b),k=g>1?"@2x":"",E={},R={};for(let{id:P,url:H}of x){let N=u.transformRequest(It(H,k,".json"),"SpriteJSON");E[P]=s.h(N,y);let O=u.transformRequest(It(H,k,".png"),"SpriteImage");R[P]=z.getImage(O,y)}return yield Promise.all([...Object.values(E),...Object.values(R)]),function(P,H){return s._(this,void 0,void 0,function*(){let N={};for(let O in P){N[O]={};let et=_.getImageCanvasContext((yield H[O]).data),nt=(yield P[O]).data;for(let Y in nt){let{width:dt,height:gt,x:ot,y:pt,sdf:Dt,pixelRatio:$t,stretchX:jt,stretchY:ue,content:ce,textFitWidth:Fe,textFitHeight:xe}=nt[Y];N[O][Y]={data:null,pixelRatio:$t,sdf:Dt,stretchX:jt,stretchY:ue,content:ce,textFitWidth:Fe,textFitHeight:xe,spriteData:{width:dt,height:gt,x:ot,y:pt,context:et}}}}return N})}(E,R)})}(i,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(b=>{if(this._spriteRequest=null,b)for(let u in b){this._spritesImagesIds[u]=[];let g=this._spritesImagesIds[u]?this._spritesImagesIds[u].filter(y=>!(y in b)):[];for(let y of g)this.imageManager.removeImage(y),this._changedImages[y]=!0;for(let y in b[u]){let x=u==="default"?y:`${u}:${y}`;this._spritesImagesIds[u].push(x),x in this.imageManager.images?this.imageManager.updateImage(x,b[u][y],!1):this.imageManager.addImage(x,b[u][y]),c&&(this._changedImages[x]=!0)}}}).catch(b=>{this._spriteRequest=null,m=b,this.fire(new s.j(m))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),c&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.k("data",{dataType:"style"})),p&&p(m)})}_unloadSprite(){for(let i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.k("data",{dataType:"style"}))}_validateLayer(i){let c=this.sourceCaches[i.source];if(!c)return;let p=i.sourceLayer;if(!p)return;let m=c.getSource();(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(p)===-1)&&this.fire(new s.j(new Error(`Source layer "${p}" does not exist on source "${m.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i){let c=this._serializedAllLayers();if(!i||i.length===0)return Object.values(c);let p=[];for(let m of i)c[m]&&p.push(c[m]);return p}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};let c=Object.keys(this._layers);for(let p of c){let m=this._layers[p];m.type!=="custom"&&(i[p]=m.serialize())}return i}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(let i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(let i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;let c=this._changed;if(c){let m=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(m.length||b.length)&&this._updateWorkerLayers(m,b);for(let u in this._updatedSources){let g=this._updatedSources[u];if(g==="reload")this._reloadSource(u);else{if(g!=="clear")throw new Error(`Invalid action ${g}`);this._clearSource(u)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let u in this._updatedPaintProps)this._layers[u].updateTransitions(i);this.light.updateTransitions(i),this.sky.updateTransitions(i),this._resetUpdates()}let p={};for(let m in this.sourceCaches){let b=this.sourceCaches[m];p[m]=b.used,b.used=!1}for(let m of this._order){let b=this._layers[m];b.recalculate(i,this._availableImages),!b.isHidden(i.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(let m in p){let b=this.sourceCaches[m];!!p[m]!=!!b.used&&b.fire(new s.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:m}))}this.light.recalculate(i),this.sky.recalculate(i),this.z=i.zoom,c&&this.fire(new s.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){let i=Object.keys(this._changedImages);if(i.length){for(let c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,c){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(i),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,c={}){var p;this._checkLoaded();let m=this.serialize();if(i=c.transformStyle?c.transformStyle(m,i):i,((p=c.validate)===null||p===void 0||p)&&no(this,s.x(i)))return!1;(i=s.aC(i)).layers=s.aA(i.layers);let b=s.aD(m,i),u=this._getOperationsToPerform(b);if(u.unimplemented.length>0)throw new Error(`Unimplemented: ${u.unimplemented.join(", ")}.`);if(u.operations.length===0)return!1;for(let g of u.operations)g();return this.stylesheet=i,this._serializedLayers=null,!0}_getOperationsToPerform(i){let c=[],p=[];for(let m of i)switch(m.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":c.push(()=>this.addLayer.apply(this,m.args));break;case"removeLayer":c.push(()=>this.removeLayer.apply(this,m.args));break;case"setPaintProperty":c.push(()=>this.setPaintProperty.apply(this,m.args));break;case"setLayoutProperty":c.push(()=>this.setLayoutProperty.apply(this,m.args));break;case"setFilter":c.push(()=>this.setFilter.apply(this,m.args));break;case"addSource":c.push(()=>this.addSource.apply(this,m.args));break;case"removeSource":c.push(()=>this.removeSource.apply(this,m.args));break;case"setLayerZoomRange":c.push(()=>this.setLayerZoomRange.apply(this,m.args));break;case"setLight":c.push(()=>this.setLight.apply(this,m.args));break;case"setGeoJSONSourceData":c.push(()=>this.setGeoJSONSourceData.apply(this,m.args));break;case"setGlyphs":c.push(()=>this.setGlyphs.apply(this,m.args));break;case"setSprite":c.push(()=>this.setSprite.apply(this,m.args));break;case"setSky":c.push(()=>this.setSky.apply(this,m.args));break;case"setTerrain":c.push(()=>this.map.setTerrain.apply(this,m.args));break;case"setTransition":c.push(()=>{});break;default:p.push(m.command)}return{operations:c,unimplemented:p}}addImage(i,c){if(this.getImage(i))return this.fire(new s.j(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,c),this._afterImageUpdated(i)}updateImage(i,c){this.imageManager.updateImage(i,c)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new s.j(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,c,p={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.x.source,`sources.${i}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);let m=this.sourceCaches[i]=new Ke(i,c,this.dispatcher);m.style=this,m.setEventedParent(this,()=>({isSourceLoaded:m.loaded(),source:m.serialize(),sourceId:i})),m.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(let p in this._layers)if(this._layers[p].source===i)return this.fire(new s.j(new Error(`Source "${i}" cannot be removed while layer "${p}" is using it.`)));let c=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],c.fire(new s.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),c.setEventedParent(null),c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,c){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);let p=this.sourceCaches[i].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(c),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,c,p={}){this._checkLoaded();let m=i.id;if(this.getLayer(m))return void this.fire(new s.j(new Error(`Layer "${m}" already exists on this map.`)));let b;if(i.type==="custom"){if(no(this,s.aE(i)))return;b=s.aB(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(m,i.source),i=s.aC(i),i=s.e(i,{source:m})),this._validate(s.x.layer,`layers.${m}`,i,{arrayIndex:-1},p))return;b=s.aB(i),this._validateLayer(b),b.setEventedParent(this,{layer:{id:m}})}let u=c?this._order.indexOf(c):this._order.length;if(c&&u===-1)this.fire(new s.j(new Error(`Cannot add layer "${m}" before non-existing layer "${c}".`)));else{if(this._order.splice(u,0,m),this._layerOrderChanged=!0,this._layers[m]=b,this._removedLayers[m]&&b.source&&b.type!=="custom"){let g=this._removedLayers[m];delete this._removedLayers[m],g.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(i,c){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new s.j(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===c)return;let p=this._order.indexOf(i);this._order.splice(p,1);let m=c?this._order.indexOf(c):this._order.length;c&&m===-1?this.fire(new s.j(new Error(`Cannot move layer "${i}" before non-existing layer "${c}".`))):(this._order.splice(m,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();let c=this._layers[i];if(!c)return void this.fire(new s.j(new Error(`Cannot remove non-existing layer "${i}".`)));c.setEventedParent(null);let p=this._order.indexOf(i);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=c,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],c.onRemove&&c.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,c,p){this._checkLoaded();let m=this.getLayer(i);m?m.minzoom===c&&m.maxzoom===p||(c!=null&&(m.minzoom=c),p!=null&&(m.maxzoom=p),this._updateLayer(m)):this.fire(new s.j(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,c,p={}){this._checkLoaded();let m=this.getLayer(i);if(m){if(!s.aF(m.filter,c))return c==null?(m.filter=void 0,void this._updateLayer(m)):void(this._validate(s.x.filter,`layers.${m.id}.filter`,c,null,p)||(m.filter=s.aC(c),this._updateLayer(m)))}else this.fire(new s.j(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return s.aC(this.getLayer(i).filter)}setLayoutProperty(i,c,p,m={}){this._checkLoaded();let b=this.getLayer(i);b?s.aF(b.getLayoutProperty(c),p)||(b.setLayoutProperty(c,p,m),this._updateLayer(b)):this.fire(new s.j(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,c){let p=this.getLayer(i);if(p)return p.getLayoutProperty(c);this.fire(new s.j(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,c,p,m={}){this._checkLoaded();let b=this.getLayer(i);b?s.aF(b.getPaintProperty(c),p)||(b.setPaintProperty(c,p,m)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[i]=!0,this._serializedLayers=null):this.fire(new s.j(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,c){return this.getLayer(i).getPaintProperty(c)}setFeatureState(i,c){this._checkLoaded();let p=i.source,m=i.sourceLayer,b=this.sourceCaches[p];if(b===void 0)return void this.fire(new s.j(new Error(`The source '${p}' does not exist in the map's style.`)));let u=b.getSource().type;u==="geojson"&&m?this.fire(new s.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):u!=="vector"||m?(i.id===void 0&&this.fire(new s.j(new Error("The feature id parameter must be provided."))),b.setFeatureState(m,i.id,c)):this.fire(new s.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,c){this._checkLoaded();let p=i.source,m=this.sourceCaches[p];if(m===void 0)return void this.fire(new s.j(new Error(`The source '${p}' does not exist in the map's style.`)));let b=m.getSource().type,u=b==="vector"?i.sourceLayer:void 0;b!=="vector"||u?c&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new s.j(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(u,i.id,c):this.fire(new s.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();let c=i.source,p=i.sourceLayer,m=this.sourceCaches[c];if(m!==void 0)return m.getSource().type!=="vector"||p?(i.id===void 0&&this.fire(new s.j(new Error("The feature id parameter must be provided."))),m.getFeatureState(p,i.id)):void this.fire(new s.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.j(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let i=s.aG(this.sourceCaches,b=>b.serialize()),c=this._serializeByIds(this._order),p=this.map.getTerrain()||void 0,m=this.stylesheet;return s.aH({version:m.version,name:m.name,metadata:m.metadata,light:m.light,sky:m.sky,center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,sprite:m.sprite,glyphs:m.glyphs,transition:m.transition,sources:i,layers:c,terrain:p},b=>b!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){let c=u=>this._layers[u].type==="fill-extrusion",p={},m=[];for(let u=this._order.length-1;u>=0;u--){let g=this._order[u];if(c(g)){p[g]=u;for(let y of i){let x=y[g];if(x)for(let k of x)m.push(k)}}}m.sort((u,g)=>g.intersectionZ-u.intersectionZ);let b=[];for(let u=this._order.length-1;u>=0;u--){let g=this._order[u];if(c(g))for(let y=m.length-1;y>=0;y--){let x=m[y].feature;if(p[x.layer.id]<u)break;b.push(x),m.pop()}else for(let y of i){let x=y[g];if(x)for(let k of x)b.push(k.feature)}}return b}queryRenderedFeatures(i,c,p){c&&c.filter&&this._validate(s.x.filter,"queryRenderedFeatures.filter",c.filter,null,c);let m={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.j(new Error("parameters.layers must be an Array."))),[];for(let g of c.layers){let y=this._layers[g];if(!y)return this.fire(new s.j(new Error(`The layer '${g}' does not exist in the map's style and cannot be queried for features.`))),[];m[y.source]=!0}}let b=[];c.availableImages=this._availableImages;let u=this._serializedAllLayers();for(let g in this.sourceCaches)c.layers&&!m[g]||b.push(Re(this.sourceCaches[g],this._layers,u,i,c,p));return this.placement&&b.push(function(g,y,x,k,E,R,P){let H={},N=R.queryRenderedSymbols(k),O=[];for(let et of Object.keys(N).map(Number))O.push(P[et]);O.sort(Je);for(let et of O){let nt=et.featureIndex.lookupSymbolFeatures(N[et.bucketInstanceId],y,et.bucketIndex,et.sourceLayerIndex,E.filter,E.layers,E.availableImages,g);for(let Y in nt){let dt=H[Y]=H[Y]||[],gt=nt[Y];gt.sort((ot,pt)=>{let Dt=et.featureSortOrder;if(Dt){let $t=Dt.indexOf(ot.featureIndex);return Dt.indexOf(pt.featureIndex)-$t}return pt.featureIndex-ot.featureIndex});for(let ot of gt)dt.push(ot)}}for(let et in H)H[et].forEach(nt=>{let Y=nt.feature,dt=x[g[et].source].getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=dt});return H}(this._layers,u,this.sourceCaches,i,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(i,c){c&&c.filter&&this._validate(s.x.filter,"querySourceFeatures.filter",c.filter,null,c);let p=this.sourceCaches[i];return p?function(m,b){let u=m.getRenderableIds().map(x=>m.getTileByID(x)),g=[],y={};for(let x=0;x<u.length;x++){let k=u[x],E=k.tileID.canonical.key;y[E]||(y[E]=!0,k.querySourceFeatures(g,b))}return g}(p,c):[]}getLight(){return this.light.getLight()}setLight(i,c={}){this._checkLoaded();let p=this.light.getLight(),m=!1;for(let u in i)if(!s.aF(i[u],p[u])){m=!0;break}if(!m)return;let b={now:_.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,c),this.light.updateTransitions(b)}getSky(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.sky}setSky(i,c={}){let p=this.sky.getSky(),m=!1;i||p&&(m=!0);for(let u in i)if(!s.aF(i[u],p[u])){m=!0;break}if(!m)return;let b={now:_.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=i,this.sky.setSky(i,c),this.sky.updateTransitions(b)}_validate(i,c,p,m,b={}){return(!b||b.validate!==!1)&&no(this,i.call(s.x,s.e({key:c,style:this.serialize(),value:p,styleSpec:s.v},m)))}_remove(i=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),mi().off(fe,this._rtlPluginLoaded);for(let c in this._layers)this._layers[c].setEventedParent(null);for(let c in this.sourceCaches){let p=this.sourceCaches[c];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),i&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(let c in this.sourceCaches)this.sourceCaches[c].update(i,this.map.terrain)}_generateCollisionBoxes(){for(let i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,c,p,m,b=!1){let u=!1,g=!1,y={};for(let x of this._order){let k=this._layers[x];if(k.type!=="symbol")continue;if(!y[k.source]){let R=this.sourceCaches[k.source];y[k.source]=R.getRenderableIds(!0).map(P=>R.getTileByID(P)).sort((P,H)=>H.tileID.overscaledZ-P.tileID.overscaledZ||(P.tileID.isLessThan(H.tileID)?-1:1))}let E=this.crossTileSymbolIndex.addLayer(k,y[k.source],i.center.lng);u=u||E}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(_.now(),i.zoom))&&(this.pauseablePlacement=new Or(i,this.map.terrain,this._order,b,c,p,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,y),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(_.now()),g=!0),u&&this.pauseablePlacement.placement.setStale()),g||u)for(let x of this._order){let k=this._layers[x];k.type==="symbol"&&this.placement.updateLayerOpacities(k,y[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(_.now())}_releaseSymbolFadeTiles(){for(let i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,c){return s._(this,void 0,void 0,function*(){let p=yield this.imageManager.getImages(c.icons);this._updateTilesForChangedImages();let m=this.sourceCaches[c.source];return m&&m.setDependencies(c.tileID.key,c.type,c.icons),p})}getGlyphs(i,c){return s._(this,void 0,void 0,function*(){let p=yield this.glyphManager.getGlyphs(c.stacks),m=this.sourceCaches[c.source];return m&&m.setDependencies(c.tileID.key,c.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,c={}){this._checkLoaded(),i&&this._validate(s.x.glyphs,"glyphs",i,null,c)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,c,p={},m){this._checkLoaded();let b=[{id:i,url:c}],u=[...xt(this.stylesheet.sprite),...b];this._validate(s.x.sprite,"sprite",u,null,p)||(this.stylesheet.sprite=u,this._loadSprite(b,!0,m))}removeSprite(i){this._checkLoaded();let c=xt(this.stylesheet.sprite);if(c.find(p=>p.id===i)){if(this._spritesImagesIds[i])for(let p of this._spritesImagesIds[i])this.imageManager.removeImage(p),this._changedImages[p]=!0;c.splice(c.findIndex(p=>p.id===i),1),this.stylesheet.sprite=c.length>0?c:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.k("data",{dataType:"style"}))}else this.fire(new s.j(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return xt(this.stylesheet.sprite)}setSprite(i,c={},p){this._checkLoaded(),i&&this._validate(s.x.sprite,"sprite",i,null,c)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,p):(this._unloadSprite(),p&&p(null)))}}var Ct=s.Y([{name:"a_pos",type:"Int16",components:2}]);let ct={prelude:bt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:bt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:bt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:bt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:bt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:bt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:bt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:bt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:bt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:bt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:bt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:bt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:bt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:bt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:bt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:bt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:bt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:bt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:bt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:bt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:bt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:bt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:bt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:bt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:bt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:bt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:bt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:bt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:bt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:bt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function bt(v,i){let c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=i.match(/attribute ([\w]+) ([\w]+)/g),m=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),u=b?b.concat(m):m,g={};return{fragmentSource:v=v.replace(c,(y,x,k,E,R)=>(g[R]=!0,x==="define"?`
#ifndef HAS_UNIFORM_u_${R}
varying ${k} ${E} ${R};
#else
uniform ${k} ${E} u_${R};
#endif
`:`
#ifdef HAS_UNIFORM_u_${R}
    ${k} ${E} ${R} = u_${R};
#endif
`)),vertexSource:i=i.replace(c,(y,x,k,E,R)=>{let P=E==="float"?"vec2":"vec4",H=R.match(/color/)?"color":P;return g[R]?x==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${k} ${P} a_${R};
varying ${k} ${E} ${R};
#else
uniform ${k} ${E} u_${R};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = a_${R};
#else
    ${k} ${E} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = unpack_mix_${H}(a_${R}, u_${R}_t);
#else
    ${k} ${E} ${R} = u_${R};
#endif
`:x==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${k} ${P} a_${R};
#else
uniform ${k} ${E} u_${R};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${k} ${E} ${R} = a_${R};
#else
    ${k} ${E} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${k} ${E} ${R} = unpack_mix_${H}(a_${R}, u_${R}_t);
#else
    ${k} ${E} ${R} = u_${R};
#endif
`}),staticAttributes:p,staticUniforms:u}}class Pt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,c,p,m,b,u,g,y,x){this.context=i;let k=this.boundPaintVertexBuffers.length!==m.length;for(let E=0;!k&&E<m.length;E++)this.boundPaintVertexBuffers[E]!==m[E]&&(k=!0);!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==p||k||this.boundIndexBuffer!==b||this.boundVertexOffset!==u||this.boundDynamicVertexBuffer!==g||this.boundDynamicVertexBuffer2!==y||this.boundDynamicVertexBuffer3!==x?this.freshBind(c,p,m,b,u,g,y,x):(i.bindVertexArray.set(this.vao),g&&g.bind(),b&&b.dynamicDraw&&b.bind(),y&&y.bind(),x&&x.bind())}freshBind(i,c,p,m,b,u,g,y){let x=i.numAttributes,k=this.context,E=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=m,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=u,this.boundDynamicVertexBuffer2=g,this.boundDynamicVertexBuffer3=y,c.enableAttributes(E,i);for(let R of p)R.enableAttributes(E,i);u&&u.enableAttributes(E,i),g&&g.enableAttributes(E,i),y&&y.enableAttributes(E,i),c.bind(),c.setVertexAttribPointers(E,i,b);for(let R of p)R.bind(),R.setVertexAttribPointers(E,i,b);u&&(u.bind(),u.setVertexAttribPointers(E,i,b)),m&&m.bind(),g&&(g.bind(),g.setVertexAttribPointers(E,i,b)),y&&(y.bind(),y.setVertexAttribPointers(E,i,b)),k.currentNumAttributes=x}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}let Jt=(v,i,c,p,m)=>({u_matrix:v,u_texture:0,u_ele_delta:i,u_fog_matrix:c,u_fog_color:p?p.properties.get("fog-color"):s.aN.white,u_fog_ground_blend:p?p.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:p?p.calculateFogBlendOpacity(m):0,u_horizon_color:p?p.properties.get("horizon-color"):s.aN.white,u_horizon_fog_blend:p?p.properties.get("horizon-fog-blend"):1});function re(v){let i=[];for(let c=0;c<v.length;c++){if(v[c]===null)continue;let p=v[c].split(" ");i.push(p.pop())}return i}class _e{constructor(i,c,p,m,b,u){let g=i.gl;this.program=g.createProgram();let y=re(c.staticAttributes),x=p?p.getBinderAttributes():[],k=y.concat(x),E=ct.prelude.staticUniforms?re(ct.prelude.staticUniforms):[],R=c.staticUniforms?re(c.staticUniforms):[],P=p?p.getBinderUniforms():[],H=E.concat(R).concat(P),N=[];for(let ot of H)N.indexOf(ot)<0&&N.push(ot);let O=p?p.defines():[];b&&O.push("#define OVERDRAW_INSPECTOR;"),u&&O.push("#define TERRAIN3D;");let et=O.concat(ct.prelude.fragmentSource,c.fragmentSource).join(`
`),nt=O.concat(ct.prelude.vertexSource,c.vertexSource).join(`
`),Y=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())return void(this.failedToCreate=!0);if(g.shaderSource(Y,et),g.compileShader(Y),!g.getShaderParameter(Y,g.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${g.getShaderInfoLog(Y)}`);g.attachShader(this.program,Y);let dt=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())return void(this.failedToCreate=!0);if(g.shaderSource(dt,nt),g.compileShader(dt),!g.getShaderParameter(dt,g.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${g.getShaderInfoLog(dt)}`);g.attachShader(this.program,dt),this.attributes={};let gt={};this.numAttributes=k.length;for(let ot=0;ot<this.numAttributes;ot++)k[ot]&&(g.bindAttribLocation(this.program,ot,k[ot]),this.attributes[k[ot]]=ot);if(g.linkProgram(this.program),!g.getProgramParameter(this.program,g.LINK_STATUS))throw new Error(`Program failed to link: ${g.getProgramInfoLog(this.program)}`);g.deleteShader(dt),g.deleteShader(Y);for(let ot=0;ot<N.length;ot++){let pt=N[ot];if(pt&&!gt[pt]){let Dt=g.getUniformLocation(this.program,pt);Dt&&(gt[pt]=Dt)}}this.fixedUniforms=m(i,gt),this.terrainUniforms=((ot,pt)=>({u_depth:new s.aI(ot,pt.u_depth),u_terrain:new s.aI(ot,pt.u_terrain),u_terrain_dim:new s.aJ(ot,pt.u_terrain_dim),u_terrain_matrix:new s.aK(ot,pt.u_terrain_matrix),u_terrain_unpack:new s.aL(ot,pt.u_terrain_unpack),u_terrain_exaggeration:new s.aJ(ot,pt.u_terrain_exaggeration)}))(i,gt),this.binderUniforms=p?p.getUniforms(i,gt):[]}draw(i,c,p,m,b,u,g,y,x,k,E,R,P,H,N,O,et,nt){let Y=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(p),i.setStencilMode(m),i.setColorMode(b),i.setCullFace(u),y){i.activeTexture.set(Y.TEXTURE2),Y.bindTexture(Y.TEXTURE_2D,y.depthTexture),i.activeTexture.set(Y.TEXTURE3),Y.bindTexture(Y.TEXTURE_2D,y.texture);for(let gt in this.terrainUniforms)this.terrainUniforms[gt].set(y[gt])}for(let gt in this.fixedUniforms)this.fixedUniforms[gt].set(g[gt]);N&&N.setUniforms(i,this.binderUniforms,P,{zoom:H});let dt=0;switch(c){case Y.LINES:dt=2;break;case Y.TRIANGLES:dt=3;break;case Y.LINE_STRIP:dt=1}for(let gt of R.get()){let ot=gt.vaos||(gt.vaos={});(ot[x]||(ot[x]=new Pt)).bind(i,this,k,N?N.getPaintVertexBuffers():[],E,gt.vertexOffset,O,et,nt),Y.drawElements(c,gt.primitiveLength*dt,Y.UNSIGNED_SHORT,gt.primitiveOffset*dt*2)}}}function Be(v,i,c){let p=1/xi(c,1,i.transform.tileZoom),m=Math.pow(2,c.tileID.overscaledZ),b=c.tileSize*Math.pow(2,i.transform.tileZoom)/m,u=b*(c.tileID.canonical.x+c.tileID.wrap*m),g=b*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[p,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[u>>16,g>>16],u_pixel_coord_lower:[65535&u,65535&g]}}let Ie=(v,i,c,p)=>{let m=i.style.light,b=m.properties.get("position"),u=[b.x,b.y,b.z],g=function(){var x=new s.A(9);return s.A!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[5]=0,x[6]=0,x[7]=0),x[0]=1,x[4]=1,x[8]=1,x}();m.properties.get("anchor")==="viewport"&&function(x,k){var E=Math.sin(k),R=Math.cos(k);x[0]=R,x[1]=E,x[2]=0,x[3]=-E,x[4]=R,x[5]=0,x[6]=0,x[7]=0,x[8]=1}(g,-i.transform.angle),function(x,k,E){var R=k[0],P=k[1],H=k[2];x[0]=R*E[0]+P*E[3]+H*E[6],x[1]=R*E[1]+P*E[4]+H*E[7],x[2]=R*E[2]+P*E[5]+H*E[8]}(u,u,g);let y=m.properties.get("color");return{u_matrix:v,u_lightpos:u,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[y.r,y.g,y.b],u_vertical_gradient:+c,u_opacity:p}},ne=(v,i,c,p,m,b,u)=>s.e(Ie(v,i,c,p),Be(b,i,u),{u_height_factor:-Math.pow(2,m.overscaledZ)/u.tileSize/8}),ye=v=>({u_matrix:v}),ve=(v,i,c,p)=>s.e(ye(v),Be(c,i,p)),Ge=(v,i)=>({u_matrix:v,u_world:i}),Ri=(v,i,c,p,m)=>s.e(ve(v,i,c,p),{u_world:m}),Qi=(v,i,c,p)=>{let m=v.transform,b,u;if(p.paint.get("circle-pitch-alignment")==="map"){let g=xi(c,1,m.zoom);b=!0,u=[g,g]}else b=!1,u=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:v.translatePosMatrix(i.posMatrix,c,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:u}},He=(v,i,c)=>({u_matrix:v,u_inv_matrix:i,u_camera_to_center_distance:c.cameraToCenterDistance,u_viewport_size:[c.width,c.height]}),Ee=(v,i,c=1)=>({u_matrix:v,u_color:i,u_overlay:0,u_overlay_scale:c}),si=v=>({u_matrix:v}),ci=(v,i,c,p)=>({u_matrix:v,u_extrude_scale:xi(i,1,c),u_intensity:p});function Fi(v,i){let c=Math.pow(2,i.canonical.z),p=i.canonical.y;return[new s.Z(0,p/c).toLngLat().lat,new s.Z(0,(p+1)/c).toLngLat().lat]}let lr=(v,i,c,p)=>{let m=v.transform;return{u_matrix:ss(v,i,c,p),u_ratio:1/xi(i,1,m.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},ai=(v,i,c,p,m)=>s.e(lr(v,i,c,m),{u_image:0,u_image_height:p}),Br=(v,i,c,p,m)=>{let b=v.transform,u=yr(i,b);return{u_matrix:ss(v,i,c,m),u_texsize:i.imageAtlasTexture.size,u_ratio:1/xi(i,1,b.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[u,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},ln=(v,i,c,p,m,b)=>{let u=v.lineAtlas,g=yr(i,v.transform),y=c.layout.get("line-cap")==="round",x=u.getDash(p.from,y),k=u.getDash(p.to,y),E=x.width*m.fromScale,R=k.width*m.toScale;return s.e(lr(v,i,c,b),{u_patternscale_a:[g/E,-x.height/2],u_patternscale_b:[g/R,-k.height/2],u_sdfgamma:u.width/(256*Math.min(E,R)*v.pixelRatio)/2,u_image:0,u_tex_y_a:x.y,u_tex_y_b:k.y,u_mix:m.t})};function yr(v,i){return 1/xi(v,1,i.tileZoom)}function ss(v,i,c,p){return v.translatePosMatrix(p?p.posMatrix:i.tileID.posMatrix,i,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}let $n=(v,i,c,p,m)=>{return{u_matrix:v,u_tl_parent:i,u_scale_parent:c,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(u=m.paint.get("raster-saturation"),u>0?1-1/(1.001-u):-u),u_contrast_factor:(b=m.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:zo(m.paint.get("raster-hue-rotate"))};var b,u};function zo(v){v*=Math.PI/180;let i=Math.sin(v),c=Math.cos(v);return[(2*c+1)/3,(-Math.sqrt(3)*i-c+1)/3,(Math.sqrt(3)*i-c+1)/3]}let yA=(v,i,c,p,m,b,u,g,y,x,k,E,R,P)=>{let H=u.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:H.cameraToCenterDistance,u_pitch:H.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:H.width/H.height,u_fade_change:u.options.fadeDuration?u.symbolFadeChange:1,u_matrix:g,u_label_plane_matrix:y,u_coord_matrix:x,u_is_text:+E,u_pitch_with_map:+p,u_is_along_line:m,u_is_variable_anchor:b,u_texsize:R,u_texture:0,u_translation:k,u_pitched_scale:P}},Ql=(v,i,c,p,m,b,u,g,y,x,k,E,R,P,H)=>{let N=u.transform;return s.e(yA(v,i,c,p,m,b,u,g,y,x,k,E,R,H),{u_gamma_scale:p?Math.cos(N._pitch)*N.cameraToCenterDistance:1,u_device_pixel_ratio:u.pixelRatio,u_is_halo:+P})},Ic=(v,i,c,p,m,b,u,g,y,x,k,E,R,P)=>s.e(Ql(v,i,c,p,m,b,u,g,y,x,k,!0,E,!0,P),{u_texsize_icon:R,u_texture_icon:1}),bA=(v,i,c)=>({u_matrix:v,u_opacity:i,u_color:c}),Ma=(v,i,c,p,m,b)=>s.e(function(u,g,y,x){let k=y.imageManager.getPattern(u.from.toString()),E=y.imageManager.getPattern(u.to.toString()),{width:R,height:P}=y.imageManager.getPixelSize(),H=Math.pow(2,x.tileID.overscaledZ),N=x.tileSize*Math.pow(2,y.transform.tileZoom)/H,O=N*(x.tileID.canonical.x+x.tileID.wrap*H),et=N*x.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:E.tl,u_pattern_br_b:E.br,u_texsize:[R,P],u_mix:g.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:E.displaySize,u_scale_a:g.fromScale,u_scale_b:g.toScale,u_tile_units_to_pixels:1/xi(x,1,y.transform.tileZoom),u_pixel_coord_upper:[O>>16,et>>16],u_pixel_coord_lower:[65535&O,65535&et]}}(p,b,c,m),{u_matrix:v,u_opacity:i}),Lo={fillExtrusion:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_lightpos:new s.aO(v,i.u_lightpos),u_lightintensity:new s.aJ(v,i.u_lightintensity),u_lightcolor:new s.aO(v,i.u_lightcolor),u_vertical_gradient:new s.aJ(v,i.u_vertical_gradient),u_opacity:new s.aJ(v,i.u_opacity)}),fillExtrusionPattern:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_lightpos:new s.aO(v,i.u_lightpos),u_lightintensity:new s.aJ(v,i.u_lightintensity),u_lightcolor:new s.aO(v,i.u_lightcolor),u_vertical_gradient:new s.aJ(v,i.u_vertical_gradient),u_height_factor:new s.aJ(v,i.u_height_factor),u_image:new s.aI(v,i.u_image),u_texsize:new s.aP(v,i.u_texsize),u_pixel_coord_upper:new s.aP(v,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.aP(v,i.u_pixel_coord_lower),u_scale:new s.aO(v,i.u_scale),u_fade:new s.aJ(v,i.u_fade),u_opacity:new s.aJ(v,i.u_opacity)}),fill:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix)}),fillPattern:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_image:new s.aI(v,i.u_image),u_texsize:new s.aP(v,i.u_texsize),u_pixel_coord_upper:new s.aP(v,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.aP(v,i.u_pixel_coord_lower),u_scale:new s.aO(v,i.u_scale),u_fade:new s.aJ(v,i.u_fade)}),fillOutline:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_world:new s.aP(v,i.u_world)}),fillOutlinePattern:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_world:new s.aP(v,i.u_world),u_image:new s.aI(v,i.u_image),u_texsize:new s.aP(v,i.u_texsize),u_pixel_coord_upper:new s.aP(v,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.aP(v,i.u_pixel_coord_lower),u_scale:new s.aO(v,i.u_scale),u_fade:new s.aJ(v,i.u_fade)}),circle:(v,i)=>({u_camera_to_center_distance:new s.aJ(v,i.u_camera_to_center_distance),u_scale_with_map:new s.aI(v,i.u_scale_with_map),u_pitch_with_map:new s.aI(v,i.u_pitch_with_map),u_extrude_scale:new s.aP(v,i.u_extrude_scale),u_device_pixel_ratio:new s.aJ(v,i.u_device_pixel_ratio),u_matrix:new s.aK(v,i.u_matrix)}),collisionBox:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_pixel_extrude_scale:new s.aP(v,i.u_pixel_extrude_scale)}),collisionCircle:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_inv_matrix:new s.aK(v,i.u_inv_matrix),u_camera_to_center_distance:new s.aJ(v,i.u_camera_to_center_distance),u_viewport_size:new s.aP(v,i.u_viewport_size)}),debug:(v,i)=>({u_color:new s.aM(v,i.u_color),u_matrix:new s.aK(v,i.u_matrix),u_overlay:new s.aI(v,i.u_overlay),u_overlay_scale:new s.aJ(v,i.u_overlay_scale)}),clippingMask:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix)}),heatmap:(v,i)=>({u_extrude_scale:new s.aJ(v,i.u_extrude_scale),u_intensity:new s.aJ(v,i.u_intensity),u_matrix:new s.aK(v,i.u_matrix)}),heatmapTexture:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_world:new s.aP(v,i.u_world),u_image:new s.aI(v,i.u_image),u_color_ramp:new s.aI(v,i.u_color_ramp),u_opacity:new s.aJ(v,i.u_opacity)}),hillshade:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_image:new s.aI(v,i.u_image),u_latrange:new s.aP(v,i.u_latrange),u_light:new s.aP(v,i.u_light),u_shadow:new s.aM(v,i.u_shadow),u_highlight:new s.aM(v,i.u_highlight),u_accent:new s.aM(v,i.u_accent)}),hillshadePrepare:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_image:new s.aI(v,i.u_image),u_dimension:new s.aP(v,i.u_dimension),u_zoom:new s.aJ(v,i.u_zoom),u_unpack:new s.aL(v,i.u_unpack)}),line:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_ratio:new s.aJ(v,i.u_ratio),u_device_pixel_ratio:new s.aJ(v,i.u_device_pixel_ratio),u_units_to_pixels:new s.aP(v,i.u_units_to_pixels)}),lineGradient:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_ratio:new s.aJ(v,i.u_ratio),u_device_pixel_ratio:new s.aJ(v,i.u_device_pixel_ratio),u_units_to_pixels:new s.aP(v,i.u_units_to_pixels),u_image:new s.aI(v,i.u_image),u_image_height:new s.aJ(v,i.u_image_height)}),linePattern:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_texsize:new s.aP(v,i.u_texsize),u_ratio:new s.aJ(v,i.u_ratio),u_device_pixel_ratio:new s.aJ(v,i.u_device_pixel_ratio),u_image:new s.aI(v,i.u_image),u_units_to_pixels:new s.aP(v,i.u_units_to_pixels),u_scale:new s.aO(v,i.u_scale),u_fade:new s.aJ(v,i.u_fade)}),lineSDF:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_ratio:new s.aJ(v,i.u_ratio),u_device_pixel_ratio:new s.aJ(v,i.u_device_pixel_ratio),u_units_to_pixels:new s.aP(v,i.u_units_to_pixels),u_patternscale_a:new s.aP(v,i.u_patternscale_a),u_patternscale_b:new s.aP(v,i.u_patternscale_b),u_sdfgamma:new s.aJ(v,i.u_sdfgamma),u_image:new s.aI(v,i.u_image),u_tex_y_a:new s.aJ(v,i.u_tex_y_a),u_tex_y_b:new s.aJ(v,i.u_tex_y_b),u_mix:new s.aJ(v,i.u_mix)}),raster:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_tl_parent:new s.aP(v,i.u_tl_parent),u_scale_parent:new s.aJ(v,i.u_scale_parent),u_buffer_scale:new s.aJ(v,i.u_buffer_scale),u_fade_t:new s.aJ(v,i.u_fade_t),u_opacity:new s.aJ(v,i.u_opacity),u_image0:new s.aI(v,i.u_image0),u_image1:new s.aI(v,i.u_image1),u_brightness_low:new s.aJ(v,i.u_brightness_low),u_brightness_high:new s.aJ(v,i.u_brightness_high),u_saturation_factor:new s.aJ(v,i.u_saturation_factor),u_contrast_factor:new s.aJ(v,i.u_contrast_factor),u_spin_weights:new s.aO(v,i.u_spin_weights)}),symbolIcon:(v,i)=>({u_is_size_zoom_constant:new s.aI(v,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.aI(v,i.u_is_size_feature_constant),u_size_t:new s.aJ(v,i.u_size_t),u_size:new s.aJ(v,i.u_size),u_camera_to_center_distance:new s.aJ(v,i.u_camera_to_center_distance),u_pitch:new s.aJ(v,i.u_pitch),u_rotate_symbol:new s.aI(v,i.u_rotate_symbol),u_aspect_ratio:new s.aJ(v,i.u_aspect_ratio),u_fade_change:new s.aJ(v,i.u_fade_change),u_matrix:new s.aK(v,i.u_matrix),u_label_plane_matrix:new s.aK(v,i.u_label_plane_matrix),u_coord_matrix:new s.aK(v,i.u_coord_matrix),u_is_text:new s.aI(v,i.u_is_text),u_pitch_with_map:new s.aI(v,i.u_pitch_with_map),u_is_along_line:new s.aI(v,i.u_is_along_line),u_is_variable_anchor:new s.aI(v,i.u_is_variable_anchor),u_texsize:new s.aP(v,i.u_texsize),u_texture:new s.aI(v,i.u_texture),u_translation:new s.aP(v,i.u_translation),u_pitched_scale:new s.aJ(v,i.u_pitched_scale)}),symbolSDF:(v,i)=>({u_is_size_zoom_constant:new s.aI(v,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.aI(v,i.u_is_size_feature_constant),u_size_t:new s.aJ(v,i.u_size_t),u_size:new s.aJ(v,i.u_size),u_camera_to_center_distance:new s.aJ(v,i.u_camera_to_center_distance),u_pitch:new s.aJ(v,i.u_pitch),u_rotate_symbol:new s.aI(v,i.u_rotate_symbol),u_aspect_ratio:new s.aJ(v,i.u_aspect_ratio),u_fade_change:new s.aJ(v,i.u_fade_change),u_matrix:new s.aK(v,i.u_matrix),u_label_plane_matrix:new s.aK(v,i.u_label_plane_matrix),u_coord_matrix:new s.aK(v,i.u_coord_matrix),u_is_text:new s.aI(v,i.u_is_text),u_pitch_with_map:new s.aI(v,i.u_pitch_with_map),u_is_along_line:new s.aI(v,i.u_is_along_line),u_is_variable_anchor:new s.aI(v,i.u_is_variable_anchor),u_texsize:new s.aP(v,i.u_texsize),u_texture:new s.aI(v,i.u_texture),u_gamma_scale:new s.aJ(v,i.u_gamma_scale),u_device_pixel_ratio:new s.aJ(v,i.u_device_pixel_ratio),u_is_halo:new s.aI(v,i.u_is_halo),u_translation:new s.aP(v,i.u_translation),u_pitched_scale:new s.aJ(v,i.u_pitched_scale)}),symbolTextAndIcon:(v,i)=>({u_is_size_zoom_constant:new s.aI(v,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.aI(v,i.u_is_size_feature_constant),u_size_t:new s.aJ(v,i.u_size_t),u_size:new s.aJ(v,i.u_size),u_camera_to_center_distance:new s.aJ(v,i.u_camera_to_center_distance),u_pitch:new s.aJ(v,i.u_pitch),u_rotate_symbol:new s.aI(v,i.u_rotate_symbol),u_aspect_ratio:new s.aJ(v,i.u_aspect_ratio),u_fade_change:new s.aJ(v,i.u_fade_change),u_matrix:new s.aK(v,i.u_matrix),u_label_plane_matrix:new s.aK(v,i.u_label_plane_matrix),u_coord_matrix:new s.aK(v,i.u_coord_matrix),u_is_text:new s.aI(v,i.u_is_text),u_pitch_with_map:new s.aI(v,i.u_pitch_with_map),u_is_along_line:new s.aI(v,i.u_is_along_line),u_is_variable_anchor:new s.aI(v,i.u_is_variable_anchor),u_texsize:new s.aP(v,i.u_texsize),u_texsize_icon:new s.aP(v,i.u_texsize_icon),u_texture:new s.aI(v,i.u_texture),u_texture_icon:new s.aI(v,i.u_texture_icon),u_gamma_scale:new s.aJ(v,i.u_gamma_scale),u_device_pixel_ratio:new s.aJ(v,i.u_device_pixel_ratio),u_is_halo:new s.aI(v,i.u_is_halo),u_translation:new s.aP(v,i.u_translation),u_pitched_scale:new s.aJ(v,i.u_pitched_scale)}),background:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_opacity:new s.aJ(v,i.u_opacity),u_color:new s.aM(v,i.u_color)}),backgroundPattern:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_opacity:new s.aJ(v,i.u_opacity),u_image:new s.aI(v,i.u_image),u_pattern_tl_a:new s.aP(v,i.u_pattern_tl_a),u_pattern_br_a:new s.aP(v,i.u_pattern_br_a),u_pattern_tl_b:new s.aP(v,i.u_pattern_tl_b),u_pattern_br_b:new s.aP(v,i.u_pattern_br_b),u_texsize:new s.aP(v,i.u_texsize),u_mix:new s.aJ(v,i.u_mix),u_pattern_size_a:new s.aP(v,i.u_pattern_size_a),u_pattern_size_b:new s.aP(v,i.u_pattern_size_b),u_scale_a:new s.aJ(v,i.u_scale_a),u_scale_b:new s.aJ(v,i.u_scale_b),u_pixel_coord_upper:new s.aP(v,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.aP(v,i.u_pixel_coord_lower),u_tile_units_to_pixels:new s.aJ(v,i.u_tile_units_to_pixels)}),terrain:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_texture:new s.aI(v,i.u_texture),u_ele_delta:new s.aJ(v,i.u_ele_delta),u_fog_matrix:new s.aK(v,i.u_fog_matrix),u_fog_color:new s.aM(v,i.u_fog_color),u_fog_ground_blend:new s.aJ(v,i.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.aJ(v,i.u_fog_ground_blend_opacity),u_horizon_color:new s.aM(v,i.u_horizon_color),u_horizon_fog_blend:new s.aJ(v,i.u_horizon_fog_blend)}),terrainDepth:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_ele_delta:new s.aJ(v,i.u_ele_delta)}),terrainCoords:(v,i)=>({u_matrix:new s.aK(v,i.u_matrix),u_texture:new s.aI(v,i.u_texture),u_terrain_coords_id:new s.aJ(v,i.u_terrain_coords_id),u_ele_delta:new s.aJ(v,i.u_ele_delta)}),sky:(v,i)=>({u_sky_color:new s.aM(v,i.u_sky_color),u_horizon_color:new s.aM(v,i.u_horizon_color),u_horizon:new s.aJ(v,i.u_horizon),u_sky_horizon_blend:new s.aJ(v,i.u_sky_horizon_blend)})};class Eo{constructor(i,c,p){this.context=i;let m=i.gl;this.buffer=m.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){let c=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let rl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Kn{constructor(i,c,p,m){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=m,this.context=i;let b=i.gl;this.buffer=b.createBuffer(),i.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);let c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,c){for(let p=0;p<this.attributes.length;p++){let m=c.attributes[this.attributes[p].name];m!==void 0&&i.enableVertexAttribArray(m)}}setVertexAttribPointers(i,c,p){for(let m=0;m<this.attributes.length;m++){let b=this.attributes[m],u=c.attributes[b.name];u!==void 0&&i.vertexAttribPointer(u,b.components,i[rl[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let Na=new WeakMap;function so(v){var i;if(Na.has(v))return Na.get(v);{let c=(i=v.getParameter(v.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return Na.set(v,c),c}}class ur{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class fa extends ur{getDefault(){return s.aN.transparent}set(i){let c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Rl extends ur{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class Va extends ur{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Oo extends ur{getDefault(){return[!0,!0,!0,!0]}set(i){let c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Is extends ur{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class yc extends ur{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Wo extends ur{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){let c=this.current;(i.func!==c.func||i.ref!==c.ref||i.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class oo extends ur{getDefault(){let i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){let c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class vA extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;i?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=i,this.dirty=!1}}class Jo extends ur{getDefault(){return[0,1]}set(i){let c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Gl extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;i?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=i,this.dirty=!1}}class Da extends ur{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Zl extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;i?c.enable(c.BLEND):c.disable(c.BLEND),this.current=i,this.dirty=!1}}class wA extends ur{getDefault(){let i=this.gl;return[i.ONE,i.ZERO]}set(i){let c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class ao extends ur{getDefault(){return s.aN.transparent}set(i){let c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class nl extends ur{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class BA extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;i?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=i,this.dirty=!1}}class sl extends ur{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class _A extends ur{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class ma extends ur{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class bc extends ur{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Xo extends ur{getDefault(){let i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){let c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Ka extends ur{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class ol extends ur{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Yo extends ur{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;c.bindTexture(c.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class xA extends ur{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Q extends ur{getDefault(){return null}set(i){let c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class tt extends ur{getDefault(){return null}set(i){var c;if(i===this.current&&!this.dirty)return;let p=this.gl;so(p)?p.bindVertexArray(i):(c=p.getExtension("OES_vertex_array_object"))===null||c===void 0||c.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class kt extends ur{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class zt extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class oe extends ur{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class we extends ur{constructor(i,c){super(i),this.context=i,this.parent=c}getDefault(){return null}}class Me extends we{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class ui extends we{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Mi extends we{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Xi{constructor(i,c,p,m,b){this.context=i,this.width=c,this.height=p;let u=i.gl,g=this.framebuffer=u.createFramebuffer();if(this.colorAttachment=new Me(i,g),m)this.depthAttachment=b?new Mi(i,g):new ui(i,g);else if(b)throw new Error("Stencil cannot be set without depth");if(u.checkFramebufferStatus(u.FRAMEBUFFER)!==u.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let i=this.context.gl,c=this.colorAttachment.get();if(c&&i.deleteTexture(c),this.depthAttachment){let p=this.depthAttachment.get();p&&i.deleteRenderbuffer(p)}i.deleteFramebuffer(this.framebuffer)}}class Ii{constructor(i,c,p){this.blendFunction=i,this.blendColor=c,this.mask=p}}Ii.Replace=[1,0],Ii.disabled=new Ii(Ii.Replace,s.aN.transparent,[!1,!1,!1,!1]),Ii.unblended=new Ii(Ii.Replace,s.aN.transparent,[!0,!0,!0,!0]),Ii.alphaBlended=new Ii([1,771],s.aN.transparent,[!0,!0,!0,!0]);class gr{constructor(i){var c,p;if(this.gl=i,this.clearColor=new fa(this),this.clearDepth=new Rl(this),this.clearStencil=new Va(this),this.colorMask=new Oo(this),this.depthMask=new Is(this),this.stencilMask=new yc(this),this.stencilFunc=new Wo(this),this.stencilOp=new oo(this),this.stencilTest=new vA(this),this.depthRange=new Jo(this),this.depthTest=new Gl(this),this.depthFunc=new Da(this),this.blend=new Zl(this),this.blendFunc=new wA(this),this.blendColor=new ao(this),this.blendEquation=new nl(this),this.cullFace=new BA(this),this.cullFaceSide=new sl(this),this.frontFace=new _A(this),this.program=new ma(this),this.activeTexture=new bc(this),this.viewport=new Xo(this),this.bindFramebuffer=new Ka(this),this.bindRenderbuffer=new ol(this),this.bindTexture=new Yo(this),this.bindVertexBuffer=new xA(this),this.bindElementBuffer=new Q(this),this.bindVertexArray=new tt(this),this.pixelStoreUnpack=new kt(this),this.pixelStoreUnpackPremultiplyAlpha=new zt(this),this.pixelStoreUnpackFlipY=new oe(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),so(i)){this.HALF_FLOAT=i.HALF_FLOAT;let m=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(c=i.RGBA16F)!==null&&c!==void 0?c:m?.RGBA16F_EXT,this.RGB16F=(p=i.RGB16F)!==null&&p!==void 0?p:m?.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");let m=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=m?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,c){return new Eo(this,i,c)}createVertexBuffer(i,c,p){return new Kn(this,i,c,p)}createRenderbuffer(i,c,p){let m=this.gl,b=m.createRenderbuffer();return this.bindRenderbuffer.set(b),m.renderbufferStorage(m.RENDERBUFFER,i,c,p),this.bindRenderbuffer.set(null),b}createFramebuffer(i,c,p,m){return new Xi(this,i,c,p,m)}clear({color:i,depth:c,stencil:p}){let m=this.gl,b=0;i&&(b|=m.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(b|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),p!==void 0&&(b|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),m.clear(b)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){s.aF(i.blendFunction,Ii.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return so(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var c;return so(this.gl)?this.gl.deleteVertexArray(i):(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}class ki{constructor(i,c,p){this.func=i,this.mask=c,this.range=p}}ki.ReadOnly=!1,ki.ReadWrite=!0,ki.disabled=new ki(519,ki.ReadOnly,[0,1]);let tn=7680;class er{constructor(i,c,p,m,b,u){this.test=i,this.ref=c,this.mask=p,this.fail=m,this.depthFail=b,this.pass=u}}er.disabled=new er({func:519,mask:0},0,0,tn,tn,tn);class nr{constructor(i,c,p){this.enable=i,this.mode=c,this.frontFace=p}}let cn;function Gs(v,i,c,p,m){let b=v.context,u=b.gl,g=v.useProgram("collisionBox"),y=[],x=0,k=0;for(let et=0;et<p.length;et++){let nt=p[et],Y=i.getTile(nt).getBucket(c);if(!Y)continue;let dt=m?Y.textCollisionBox:Y.iconCollisionBox,gt=Y.collisionCircleArray;if(gt.length>0){let ot=s.H();s.aR(ot,Y.placementInvProjMatrix,v.transform.glCoordMatrix),s.aR(ot,ot,Y.placementViewportMatrix),y.push({circleArray:gt,circleOffset:k,transform:nt.posMatrix,invTransform:ot,coord:nt}),x+=gt.length/4,k=x}dt&&g.draw(b,u.LINES,ki.disabled,er.disabled,v.colorModeForRenderPass(),nr.disabled,{u_matrix:nt.posMatrix,u_pixel_extrude_scale:[1/(E=v.transform).width,1/E.height]},v.style.map.terrain&&v.style.map.terrain.getTerrainData(nt),c.id,dt.layoutVertexBuffer,dt.indexBuffer,dt.segments,null,v.transform.zoom,null,null,dt.collisionVertexBuffer)}var E;if(!m||!y.length)return;let R=v.useProgram("collisionCircle"),P=new s.aS;P.resize(4*x),P._trim();let H=0;for(let et of y)for(let nt=0;nt<et.circleArray.length/4;nt++){let Y=4*nt,dt=et.circleArray[Y+0],gt=et.circleArray[Y+1],ot=et.circleArray[Y+2],pt=et.circleArray[Y+3];P.emplace(H++,dt,gt,ot,pt,0),P.emplace(H++,dt,gt,ot,pt,1),P.emplace(H++,dt,gt,ot,pt,2),P.emplace(H++,dt,gt,ot,pt,3)}(!cn||cn.length<2*x)&&(cn=function(et){let nt=2*et,Y=new s.aU;Y.resize(nt),Y._trim();for(let dt=0;dt<nt;dt++){let gt=6*dt;Y.uint16[gt+0]=4*dt+0,Y.uint16[gt+1]=4*dt+1,Y.uint16[gt+2]=4*dt+2,Y.uint16[gt+3]=4*dt+2,Y.uint16[gt+4]=4*dt+3,Y.uint16[gt+5]=4*dt+0}return Y}(x));let N=b.createIndexBuffer(cn,!0),O=b.createVertexBuffer(P,s.aT.members,!0);for(let et of y){let nt=He(et.transform,et.invTransform,v.transform);R.draw(b,u.TRIANGLES,ki.disabled,er.disabled,v.colorModeForRenderPass(),nr.disabled,nt,v.style.map.terrain&&v.style.map.terrain.getTerrainData(et.coord),c.id,O,N,s.a0.simpleSegment(0,2*et.circleOffset,et.circleArray.length,et.circleArray.length/2),null,v.transform.zoom,null,null,null)}O.destroy(),N.destroy()}nr.disabled=new nr(!1,1029,2305),nr.backCCW=new nr(!0,1029,2305);let os=s.ao(new Float32Array(16));function Zs(v,i,c,p,m,b){let{horizontalAlign:u,verticalAlign:g}=s.av(v);return new s.P((-(u-.5)*i/m+p[0])*b,(-(g-.5)*c/m+p[1])*b)}function za(v,i,c,p,m,b){let u=i.tileAnchorPoint.add(new s.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let g=p.mult(b);return c||(g=g.rotate(-m)),wt(u.add(g),i.labelPlaneMatrix,i.getElevation).point}if(c){let g=Wt(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(v),y=Math.atan(g.y/g.x)+(g.x<0?Math.PI:0);return v.add(p.rotate(y))}return v.add(p)}function Ca(v,i,c,p,m,b,u,g,y,x,k,E,R,P){let H=v.text.placedSymbolArray,N=v.text.dynamicLayoutVertexArray,O=v.icon.dynamicLayoutVertexArray,et={};N.clear();for(let nt=0;nt<H.length;nt++){let Y=H.get(nt),dt=Y.hidden||!Y.crossTileID||v.allowVerticalPlacement&&!Y.placedOrientation?null:p[Y.crossTileID];if(dt){let gt=new s.P(Y.anchorX,Y.anchorY),ot={getElevation:P,width:m.width,height:m.height,labelPlaneMatrix:b,lineVertexArray:null,pitchWithMap:c,projection:k,projectionCache:null,tileAnchorPoint:gt,translation:E,unwrappedTileID:R},pt=c?wt(gt,u,P):Wt(gt.x,gt.y,ot),Dt=W(m.cameraToCenterDistance,pt.signedDistanceFromCamera),$t=s.aj(v.textSizeData,y,Y)*Dt/s.aq;c&&($t*=v.tilePixelRatio/g);let{width:jt,height:ue,anchor:ce,textOffset:Fe,textBoxScale:xe}=dt,ke=Zs(ce,jt,ue,Fe,xe,$t),Ue=k.getPitchedTextCorrection(m,gt.add(new s.P(E[0],E[1])),R),$e=za(pt.point,ot,i,ke,m.angle,Ue),Li=v.allowVerticalPlacement&&Y.placedOrientation===s.ai.vertical?Math.PI/2:0;for(let pi=0;pi<Y.numGlyphs;pi++)s.ak(N,$e,Li);x&&Y.associatedIconIndex>=0&&(et[Y.associatedIconIndex]={shiftedAnchor:$e,angle:Li})}else ti(Y.numGlyphs,N)}if(x){O.clear();let nt=v.icon.placedSymbolArray;for(let Y=0;Y<nt.length;Y++){let dt=nt.get(Y);if(dt.hidden)ti(dt.numGlyphs,O);else{let gt=et[Y];if(gt)for(let ot=0;ot<dt.numGlyphs;ot++)s.ak(O,gt.shiftedAnchor,gt.angle);else ti(dt.numGlyphs,O)}}v.icon.dynamicLayoutVertexBuffer.updateData(O)}v.text.dynamicLayoutVertexBuffer.updateData(N)}function Oa(v,i,c){return c.iconsInText&&i?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function ys(v,i,c,p,m,b,u,g,y,x,k,E){let R=v.context,P=R.gl,H=v.transform,N=pa(),O=g==="map",et=y==="map",nt=g!=="viewport"&&c.layout.get("symbol-placement")!=="point",Y=O&&!et&&!nt,dt=!et&&nt,gt=!c.layout.get("symbol-sort-key").isConstant(),ot=!1,pt=v.depthModeForSublayer(0,ki.ReadOnly),Dt=c._unevaluatedLayout.hasValue("text-variable-anchor")||c._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$t=[],jt=N.getCircleRadiusCorrection(H);for(let ue of p){let ce=i.getTile(ue),Fe=ce.getBucket(c);if(!Fe)continue;let xe=m?Fe.text:Fe.icon;if(!xe||!xe.segments.get().length||!xe.hasVisibleVertices)continue;let ke=xe.programConfigurations.get(c.id),Ue=m||Fe.sdfIcons,$e=m?Fe.textSizeData:Fe.iconSizeData,Li=et||H.pitch!==0,pi=v.useProgram(Oa(Ue,m,Fe),ke),bi=s.ah($e,H.zoom),Ci=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ue),mr,Jr,Yi,Rr,rr=[0,0],Lr=null;if(m)Jr=ce.glyphAtlasTexture,Yi=P.LINEAR,mr=ce.glyphAtlasTexture.size,Fe.iconsInText&&(rr=ce.imageAtlasTexture.size,Lr=ce.imageAtlasTexture,Rr=Li||v.options.rotating||v.options.zooming||$e.kind==="composite"||$e.kind==="camera"?P.LINEAR:P.NEAREST);else{let Zr=c.layout.get("icon-size").constantOr(0)!==1||Fe.iconsNeedLinear;Jr=ce.imageAtlasTexture,Yi=Ue||v.options.rotating||v.options.zooming||Zr||Li?P.LINEAR:P.NEAREST,mr=ce.imageAtlasTexture.size}let Er=xi(ce,1,v.transform.zoom),Tr=dt?ue.posMatrix:os,rn=wr(Tr,et,O,v.transform,Er),_n=ar(Tr,et,O,v.transform,Er),Tn=ar(ue.posMatrix,et,O,v.transform,Er),On=N.translatePosition(v.transform,ce,b,u),gn=Dt&&Fe.hasTextData(),mo=c.layout.get("icon-text-fit")!=="none"&&gn&&Fe.hasIconData();if(nt){let Zr=v.style.map.terrain?(GA,xr)=>v.style.map.terrain.getElevation(ue,GA,xr):null,Po=c.layout.get("text-rotation-alignment")==="map";rt(Fe,ue.posMatrix,v,m,rn,Tn,et,x,Po,N,ue.toUnwrapped(),H.width,H.height,On,Zr)}let nn=ue.posMatrix,Wn=m&&Dt||mo,es=nt||Wn?os:rn,Gr=_n,xn=Ue&&c.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Un;Un=Ue?Fe.iconsInText?Ic($e.kind,bi,Y,et,nt,Wn,v,nn,es,Gr,On,mr,rr,jt):Ql($e.kind,bi,Y,et,nt,Wn,v,nn,es,Gr,On,m,mr,!0,jt):yA($e.kind,bi,Y,et,nt,Wn,v,nn,es,Gr,On,m,mr,jt);let yn={program:pi,buffers:xe,uniformValues:Un,atlasTexture:Jr,atlasTextureIcon:Lr,atlasInterpolation:Yi,atlasInterpolationIcon:Rr,isSDF:Ue,hasHalo:xn};if(gt&&Fe.canOverlap){ot=!0;let Zr=xe.segments.get();for(let Po of Zr)$t.push({segments:new s.a0([Po]),sortKey:Po.sortKey,state:yn,terrainData:Ci})}else $t.push({segments:xe.segments,sortKey:0,state:yn,terrainData:Ci})}ot&&$t.sort((ue,ce)=>ue.sortKey-ce.sortKey);for(let ue of $t){let ce=ue.state;if(R.activeTexture.set(P.TEXTURE0),ce.atlasTexture.bind(ce.atlasInterpolation,P.CLAMP_TO_EDGE),ce.atlasTextureIcon&&(R.activeTexture.set(P.TEXTURE1),ce.atlasTextureIcon&&ce.atlasTextureIcon.bind(ce.atlasInterpolationIcon,P.CLAMP_TO_EDGE)),ce.isSDF){let Fe=ce.uniformValues;ce.hasHalo&&(Fe.u_is_halo=1,Ao(ce.buffers,ue.segments,c,v,ce.program,pt,k,E,Fe,ue.terrainData)),Fe.u_is_halo=0}Ao(ce.buffers,ue.segments,c,v,ce.program,pt,k,E,ce.uniformValues,ue.terrainData)}}function Ao(v,i,c,p,m,b,u,g,y,x){let k=p.context;m.draw(k,k.gl.TRIANGLES,b,u,g,nr.disabled,y,x,c.id,v.layoutVertexBuffer,v.indexBuffer,i,c.paint,p.transform.zoom,v.programConfigurations.get(c.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function Fn(v,i,c,p,m){if(!c||!p||!p.imageAtlas)return;let b=p.imageAtlas.patternPositions,u=b[c.to.toString()],g=b[c.from.toString()];if(!u&&g&&(u=g),!g&&u&&(g=u),!u||!g){let y=m.getPaintProperty(i);u=b[y],g=b[y]}u&&g&&v.setConstantPatternPositions(u,g)}function Ia(v,i,c,p,m,b,u){let g=v.context.gl,y="fill-pattern",x=c.paint.get(y),k=x&&x.constantOr(1),E=c.getCrossfadeParameters(),R,P,H,N,O;u?(P=k&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=g.LINES):(P=k?"fillPattern":"fill",R=g.TRIANGLES);let et=x.constantOr(null);for(let nt of p){let Y=i.getTile(nt);if(k&&!Y.patternsLoaded())continue;let dt=Y.getBucket(c);if(!dt)continue;let gt=dt.programConfigurations.get(c.id),ot=v.useProgram(P,gt),pt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(nt);k&&(v.context.activeTexture.set(g.TEXTURE0),Y.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),gt.updatePaintBuffers(E)),Fn(gt,y,et,Y,c);let Dt=pt?nt:null,$t=v.translatePosMatrix(Dt?Dt.posMatrix:nt.posMatrix,Y,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(u){N=dt.indexBuffer2,O=dt.segments2;let jt=[g.drawingBufferWidth,g.drawingBufferHeight];H=P==="fillOutlinePattern"&&k?Ri($t,v,E,Y,jt):Ge($t,jt)}else N=dt.indexBuffer,O=dt.segments,H=k?ve($t,v,E,Y):ye($t);ot.draw(v.context,R,m,v.stencilModeForClipping(nt),b,nr.disabled,H,pt,c.id,dt.layoutVertexBuffer,N,O,c.paint,v.transform.zoom,gt)}}function kn(v,i,c,p,m,b,u){let g=v.context,y=g.gl,x="fill-extrusion-pattern",k=c.paint.get(x),E=k.constantOr(1),R=c.getCrossfadeParameters(),P=c.paint.get("fill-extrusion-opacity"),H=k.constantOr(null);for(let N of p){let O=i.getTile(N),et=O.getBucket(c);if(!et)continue;let nt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(N),Y=et.programConfigurations.get(c.id),dt=v.useProgram(E?"fillExtrusionPattern":"fillExtrusion",Y);E&&(v.context.activeTexture.set(y.TEXTURE0),O.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),Y.updatePaintBuffers(R)),Fn(Y,x,H,O,c);let gt=v.translatePosMatrix(N.posMatrix,O,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),ot=c.paint.get("fill-extrusion-vertical-gradient"),pt=E?ne(gt,v,ot,P,N,R,O):Ie(gt,v,ot,P);dt.draw(g,g.gl.TRIANGLES,m,b,u,nr.backCCW,pt,nt,c.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,c.paint,v.transform.zoom,Y,v.style.map.terrain&&et.centroidVertexBuffer)}}function ya(v,i,c,p,m,b,u){let g=v.context,y=g.gl,x=c.fbo;if(!x)return;let k=v.useProgram("hillshade"),E=v.style.map.terrain&&v.style.map.terrain.getTerrainData(i);g.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,x.colorAttachment.get()),k.draw(g,y.TRIANGLES,m,b,u,nr.disabled,((R,P,H,N)=>{let O=H.paint.get("hillshade-shadow-color"),et=H.paint.get("hillshade-highlight-color"),nt=H.paint.get("hillshade-accent-color"),Y=H.paint.get("hillshade-illumination-direction")*(Math.PI/180);H.paint.get("hillshade-illumination-anchor")==="viewport"&&(Y-=R.transform.angle);let dt=!R.options.moving;return{u_matrix:N?N.posMatrix:R.transform.calculatePosMatrix(P.tileID.toUnwrapped(),dt),u_image:0,u_latrange:Fi(0,P.tileID),u_light:[H.paint.get("hillshade-exaggeration"),Y],u_shadow:O,u_highlight:et,u_accent:nt}})(v,c,p,E?i:null),E,p.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}function Ps(v,i,c,p,m,b){let u=v.context,g=u.gl,y=i.dem;if(y&&y.data){let x=y.dim,k=y.stride,E=y.getPixels();if(u.activeTexture.set(g.TEXTURE1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||v.getTileTexture(k),i.demTexture){let P=i.demTexture;P.update(E,{premultiply:!1}),P.bind(g.NEAREST,g.CLAMP_TO_EDGE)}else i.demTexture=new Nt(u,E,g.RGBA,{premultiply:!1}),i.demTexture.bind(g.NEAREST,g.CLAMP_TO_EDGE);u.activeTexture.set(g.TEXTURE0);let R=i.fbo;if(!R){let P=new Nt(u,{width:x,height:x,data:null},g.RGBA);P.bind(g.LINEAR,g.CLAMP_TO_EDGE),R=i.fbo=u.createFramebuffer(x,x,!0,!1),R.colorAttachment.set(P.texture)}u.bindFramebuffer.set(R.framebuffer),u.viewport.set([0,0,x,x]),v.useProgram("hillshadePrepare").draw(u,g.TRIANGLES,p,m,b,nr.disabled,((P,H)=>{let N=H.stride,O=s.H();return s.aQ(O,0,s.X,-s.X,0,0,1),s.J(O,O,[0,-s.X,0]),{u_matrix:O,u_image:1,u_dimension:[N,N],u_zoom:P.overscaledZ,u_unpack:H.getUnpackVector()}})(i.tileID,y),null,c.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function jo(v,i,c,p,m,b){let u=p.paint.get("raster-fade-duration");if(!b&&u>0){let g=_.now(),y=(g-v.timeAdded)/u,x=i?(g-i.timeAdded)/u:-1,k=c.getSource(),E=m.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),R=!i||Math.abs(i.tileID.overscaledZ-E)>Math.abs(v.tileID.overscaledZ-E),P=R&&v.refreshedUponExpiration?1:s.ad(R?y:1-x,0,1);return v.refreshedUponExpiration&&y>=1&&(v.refreshedUponExpiration=!1),i?{opacity:1,mix:1-P}:{opacity:P,mix:0}}return{opacity:1,mix:0}}let ba=new s.aN(1,0,0,1),Bn=new s.aN(0,1,0,1),SA=new s.aN(0,0,1,1),FA=new s.aN(1,0,1,1),qo=new s.aN(0,1,1,1);function Ln(v,i,c,p){va(v,0,i+c/2,v.transform.width,c,p)}function Wa(v,i,c,p){va(v,i-c/2,0,c,v.transform.height,p)}function va(v,i,c,p,m,b){let u=v.context,g=u.gl;g.enable(g.SCISSOR_TEST),g.scissor(i*v.pixelRatio,c*v.pixelRatio,p*v.pixelRatio,m*v.pixelRatio),u.clear({color:b}),g.disable(g.SCISSOR_TEST)}function dr(v,i,c){let p=v.context,m=p.gl,b=c.posMatrix,u=v.useProgram("debug"),g=ki.disabled,y=er.disabled,x=v.colorModeForRenderPass(),k="$debug",E=v.style.map.terrain&&v.style.map.terrain.getTerrainData(c);p.activeTexture.set(m.TEXTURE0);let R=i.getTileByID(c.key).latestRawTileData,P=Math.floor((R&&R.byteLength||0)/1024),H=i.getTile(c).tileSize,N=512/Math.min(H,512)*(c.overscaledZ/v.transform.zoom)*.5,O=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(O+=` => ${c.overscaledZ}`),function(et,nt){et.initDebugOverlayCanvas();let Y=et.debugOverlayCanvas,dt=et.context.gl,gt=et.debugOverlayCanvas.getContext("2d");gt.clearRect(0,0,Y.width,Y.height),gt.shadowColor="white",gt.shadowBlur=2,gt.lineWidth=1.5,gt.strokeStyle="white",gt.textBaseline="top",gt.font="bold 36px Open Sans, sans-serif",gt.fillText(nt,5,5),gt.strokeText(nt,5,5),et.debugOverlayTexture.update(Y),et.debugOverlayTexture.bind(dt.LINEAR,dt.CLAMP_TO_EDGE)}(v,`${O} ${P}kB`),u.draw(p,m.TRIANGLES,g,y,Ii.alphaBlended,nr.disabled,Ee(b,s.aN.transparent,N),null,k,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),u.draw(p,m.LINE_STRIP,g,y,x,nr.disabled,Ee(b,s.aN.red),E,k,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function Hs(v,i,c){let p=v.context,m=p.gl,b=v.colorModeForRenderPass(),u=new ki(m.LEQUAL,ki.ReadWrite,v.depthRangeFor3D),g=v.useProgram("terrain"),y=i.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,v.width,v.height]);for(let x of c){let k=v.renderToTexture.getTexture(x),E=i.getTerrainData(x.tileID);p.activeTexture.set(m.TEXTURE0),m.bindTexture(m.TEXTURE_2D,k.texture);let R=v.transform.calculatePosMatrix(x.tileID.toUnwrapped()),P=i.getMeshFrameDelta(v.transform.zoom),H=v.transform.calculateFogMatrix(x.tileID.toUnwrapped()),N=Jt(R,P,H,v.style.sky,v.transform.pitch);g.draw(p,m.TRIANGLES,u,er.disabled,b,nr.backCCW,N,E,"terrain",y.vertexBuffer,y.indexBuffer,y.segments)}}class bs{constructor(i,c,p){this.vertexBuffer=i,this.indexBuffer=c,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Ms{constructor(i,c){this.context=new gr(i),this.transform=c,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.ao(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ke.maxUnderzooming+Ke.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new wn}resize(i,c,p){if(this.width=Math.floor(i*p),this.height=Math.floor(c*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let m of this.style._order)this.style._layers[m].resize()}setup(){let i=this.context,c=new s.aX;c.emplaceBack(0,0),c.emplaceBack(s.X,0),c.emplaceBack(0,s.X),c.emplaceBack(s.X,s.X),this.tileExtentBuffer=i.createVertexBuffer(c,Ct.members),this.tileExtentSegments=s.a0.simpleSegment(0,0,4,2);let p=new s.aX;p.emplaceBack(0,0),p.emplaceBack(s.X,0),p.emplaceBack(0,s.X),p.emplaceBack(s.X,s.X),this.debugBuffer=i.createVertexBuffer(p,Ct.members),this.debugSegments=s.a0.simpleSegment(0,0,4,5);let m=new s.$;m.emplaceBack(0,0,0,0),m.emplaceBack(s.X,0,s.X,0),m.emplaceBack(0,s.X,0,s.X),m.emplaceBack(s.X,s.X,s.X,s.X),this.rasterBoundsBuffer=i.createVertexBuffer(m,Ne.members),this.rasterBoundsSegments=s.a0.simpleSegment(0,0,4,2);let b=new s.aX;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(b,Ct.members),this.viewportSegments=s.a0.simpleSegment(0,0,4,2);let u=new s.aZ;u.emplaceBack(0),u.emplaceBack(1),u.emplaceBack(3),u.emplaceBack(2),u.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(u);let g=new s.aY;g.emplaceBack(0,1,2),g.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(g);let y=this.context.gl;this.stencilClearMode=new er({func:y.ALWAYS,mask:0},0,255,y.ZERO,y.ZERO,y.ZERO)}clearStencil(){let i=this.context,c=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let p=s.H();s.aQ(p,0,this.width,this.height,0,0,1),s.K(p,p,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,c.TRIANGLES,ki.disabled,this.stencilClearMode,Ii.disabled,nr.disabled,si(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,c){if(this.currentStencilSource===i.source||!i.isTileClipped()||!c||!c.length)return;this.currentStencilSource=i.source;let p=this.context,m=p.gl;this.nextStencilID+c.length>256&&this.clearStencil(),p.setColorMode(Ii.disabled),p.setDepthMode(ki.disabled);let b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let u of c){let g=this._tileClippingMaskIDs[u.key]=this.nextStencilID++,y=this.style.map.terrain&&this.style.map.terrain.getTerrainData(u);b.draw(p,m.TRIANGLES,ki.disabled,new er({func:m.ALWAYS,mask:0},g,255,m.KEEP,m.KEEP,m.REPLACE),Ii.disabled,nr.disabled,si(u.posMatrix),y,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let i=this.nextStencilID++,c=this.context.gl;return new er({func:c.NOTEQUAL,mask:255},i,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(i){let c=this.context.gl;return new er({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(i){let c=this.context.gl,p=i.sort((u,g)=>g.overscaledZ-u.overscaledZ),m=p[p.length-1].overscaledZ,b=p[0].overscaledZ-m+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();let u={};for(let g=0;g<b;g++)u[g+m]=new er({func:c.GEQUAL,mask:255},g+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=b,[u,p]}return[{[m]:er.disabled},p]}colorModeForRenderPass(){let i=this.context.gl;return this._showOverdrawInspector?new Ii([i.CONSTANT_COLOR,i.ONE],new s.aN(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ii.unblended:Ii.alphaBlended}depthModeForSublayer(i,c,p){if(!this.opaquePassEnabledForLayer())return ki.disabled;let m=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new ki(p||this.context.gl.LEQUAL,c,[m,m])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,c){var p;this.style=i,this.options=c,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(_.now()),this.imageManager.beginFrame();let m=this.style._order,b=this.style.sourceCaches,u={},g={},y={};for(let x in b){let k=b[x];k.used&&k.prepare(this.context),u[x]=k.getVisibleCoordinates(),g[x]=u[x].slice().reverse(),y[x]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let x=0;x<m.length;x++)if(this.style._layers[m[x]].is3D()){this.opaquePassCutoff=x;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let x of m){let k=this.style._layers[x];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;let E=g[k.source];(k.type==="custom"||E.length)&&this.renderLayer(this,b[k.source],k,E)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?s.aN.black:s.aN.transparent,depth:1}),this.clearStencil(),!((p=this.style.stylesheet)===null||p===void 0)&&p.sky&&function(x,k){let E=x.context,R=E.gl,P=((nt,Y,dt)=>({u_sky_color:nt.properties.get("sky-color"),u_horizon_color:nt.properties.get("horizon-color"),u_horizon:(Y.height/2+Y.getHorizon())*dt,u_sky_horizon_blend:nt.properties.get("sky-horizon-blend")*Y.height/2*dt}))(k,x.style.map.transform,x.pixelRatio),H=new ki(R.LEQUAL,ki.ReadWrite,[0,1]),N=er.disabled,O=x.colorModeForRenderPass(),et=x.useProgram("sky");if(!k.mesh){let nt=new s.aX;nt.emplaceBack(-1,-1),nt.emplaceBack(1,-1),nt.emplaceBack(1,1),nt.emplaceBack(-1,1);let Y=new s.aY;Y.emplaceBack(0,1,2),Y.emplaceBack(0,2,3),k.mesh=new bs(E.createVertexBuffer(nt,Ct.members),E.createIndexBuffer(Y),s.a0.simpleSegment(0,0,nt.length,Y.length))}et.draw(E,R.TRIANGLES,H,N,O,nr.disabled,P,void 0,"sky",k.mesh.vertexBuffer,k.mesh.indexBuffer,k.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){let x=this.style._layers[m[this.currentLayer]],k=b[x.source],E=u[x.source];this._renderTileClippingMasks(x,E),this.renderLayer(this,k,x,E)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){let x=this.style._layers[m[this.currentLayer]],k=b[x.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(x))continue;let E=(x.type==="symbol"?y:g)[x.source];this._renderTileClippingMasks(x,u[x.source]),this.renderLayer(this,k,x,E)}if(this.options.showTileBoundaries){let x=function(k,E){let R=null,P=Object.values(k._layers).flatMap(et=>et.source&&!et.isHidden(E)?[k.sourceCaches[et.source]]:[]),H=P.filter(et=>et.getSource().type==="vector"),N=P.filter(et=>et.getSource().type!=="vector"),O=et=>{(!R||R.getSource().maxzoom<et.getSource().maxzoom)&&(R=et)};return H.forEach(et=>O(et)),R||N.forEach(et=>O(et)),R}(this.style,this.transform.zoom);x&&function(k,E,R){for(let P=0;P<R.length;P++)dr(k,E,R[P])}(this,x,x.getVisibleCoordinates())}this.options.showPadding&&function(x){let k=x.transform.padding;Ln(x,x.transform.height-(k.top||0),3,ba),Ln(x,k.bottom||0,3,Bn),Wa(x,k.left||0,3,SA),Wa(x,x.transform.width-(k.right||0),3,FA);let E=x.transform.centerPoint;(function(R,P,H,N){va(R,P-1,H-10,2,20,N),va(R,P-10,H-1,20,2,N)})(x,E.x,x.transform.height-E.y,qo)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(i){if(!this.style||!this.style.map||!this.style.map.terrain)return;let c=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix,m=this.terrainFacilitator.dirty;m||(m=i?!s.a_(c,p):!s.a$(c,p)),m||(m=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),m&&(s.b0(c,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(b,u){let g=b.context,y=g.gl,x=Ii.unblended,k=new ki(y.LEQUAL,ki.ReadWrite,[0,1]),E=u.getTerrainMesh(),R=u.sourceCache.getRenderableTiles(),P=b.useProgram("terrainDepth");g.bindFramebuffer.set(u.getFramebuffer("depth").framebuffer),g.viewport.set([0,0,b.width/devicePixelRatio,b.height/devicePixelRatio]),g.clear({color:s.aN.transparent,depth:1});for(let H of R){let N=u.getTerrainData(H.tileID),O={u_matrix:b.transform.calculatePosMatrix(H.tileID.toUnwrapped()),u_ele_delta:u.getMeshFrameDelta(b.transform.zoom)};P.draw(g,y.TRIANGLES,k,er.disabled,x,nr.backCCW,O,N,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}g.bindFramebuffer.set(null),g.viewport.set([0,0,b.width,b.height])}(this,this.style.map.terrain),function(b,u){let g=b.context,y=g.gl,x=Ii.unblended,k=new ki(y.LEQUAL,ki.ReadWrite,[0,1]),E=u.getTerrainMesh(),R=u.getCoordsTexture(),P=u.sourceCache.getRenderableTiles(),H=b.useProgram("terrainCoords");g.bindFramebuffer.set(u.getFramebuffer("coords").framebuffer),g.viewport.set([0,0,b.width/devicePixelRatio,b.height/devicePixelRatio]),g.clear({color:s.aN.transparent,depth:1}),u.coordsIndex=[];for(let N of P){let O=u.getTerrainData(N.tileID);g.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,R.texture);let et={u_matrix:b.transform.calculatePosMatrix(N.tileID.toUnwrapped()),u_terrain_coords_id:(255-u.coordsIndex.length)/255,u_texture:0,u_ele_delta:u.getMeshFrameDelta(b.transform.zoom)};H.draw(g,y.TRIANGLES,k,er.disabled,x,nr.backCCW,et,O,"terrain",E.vertexBuffer,E.indexBuffer,E.segments),u.coordsIndex.push(N.tileID.key)}g.bindFramebuffer.set(null),g.viewport.set([0,0,b.width,b.height])}(this,this.style.map.terrain))}renderLayer(i,c,p,m){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(m||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(b,u,g,y,x){if(b.renderPass!=="translucent")return;let k=er.disabled,E=b.colorModeForRenderPass();(g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(R,P,H,N,O,et,nt,Y,dt){let gt=P.transform,ot=pa(),pt=O==="map",Dt=et==="map";for(let $t of R){let jt=N.getTile($t),ue=jt.getBucket(H);if(!ue||!ue.text||!ue.text.segments.get().length)continue;let ce=s.ah(ue.textSizeData,gt.zoom),Fe=xi(jt,1,P.transform.zoom),xe=wr($t.posMatrix,Dt,pt,P.transform,Fe),ke=H.layout.get("icon-text-fit")!=="none"&&ue.hasIconData();if(ce){let Ue=Math.pow(2,gt.zoom-jt.tileID.overscaledZ),$e=P.style.map.terrain?(pi,bi)=>P.style.map.terrain.getElevation($t,pi,bi):null,Li=ot.translatePosition(gt,jt,nt,Y);Ca(ue,pt,Dt,dt,gt,xe,$t.posMatrix,Ue,ce,ke,ot,Li,$t.toUnwrapped(),$e)}}}(y,b,g,u,g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),x),g.paint.get("icon-opacity").constantOr(1)!==0&&ys(b,u,g,y,!1,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),g.layout.get("icon-rotation-alignment"),g.layout.get("icon-pitch-alignment"),g.layout.get("icon-keep-upright"),k,E),g.paint.get("text-opacity").constantOr(1)!==0&&ys(b,u,g,y,!0,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),g.layout.get("text-keep-upright"),k,E),u.map.showCollisionBoxes&&(Gs(b,u,g,y,!0),Gs(b,u,g,y,!1))})(i,c,p,m,this.style.placement.variableOffsets);break;case"circle":(function(b,u,g,y){if(b.renderPass!=="translucent")return;let x=g.paint.get("circle-opacity"),k=g.paint.get("circle-stroke-width"),E=g.paint.get("circle-stroke-opacity"),R=!g.layout.get("circle-sort-key").isConstant();if(x.constantOr(1)===0&&(k.constantOr(1)===0||E.constantOr(1)===0))return;let P=b.context,H=P.gl,N=b.depthModeForSublayer(0,ki.ReadOnly),O=er.disabled,et=b.colorModeForRenderPass(),nt=[];for(let Y=0;Y<y.length;Y++){let dt=y[Y],gt=u.getTile(dt),ot=gt.getBucket(g);if(!ot)continue;let pt=ot.programConfigurations.get(g.id),Dt=b.useProgram("circle",pt),$t=ot.layoutVertexBuffer,jt=ot.indexBuffer,ue=b.style.map.terrain&&b.style.map.terrain.getTerrainData(dt),ce={programConfiguration:pt,program:Dt,layoutVertexBuffer:$t,indexBuffer:jt,uniformValues:Qi(b,dt,gt,g),terrainData:ue};if(R){let Fe=ot.segments.get();for(let xe of Fe)nt.push({segments:new s.a0([xe]),sortKey:xe.sortKey,state:ce})}else nt.push({segments:ot.segments,sortKey:0,state:ce})}R&&nt.sort((Y,dt)=>Y.sortKey-dt.sortKey);for(let Y of nt){let{programConfiguration:dt,program:gt,layoutVertexBuffer:ot,indexBuffer:pt,uniformValues:Dt,terrainData:$t}=Y.state;gt.draw(P,H.TRIANGLES,N,O,et,nr.disabled,Dt,$t,g.id,ot,pt,Y.segments,g.paint,b.transform.zoom,dt)}})(i,c,p,m);break;case"heatmap":(function(b,u,g,y){if(g.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){let x=b.context,k=x.gl,E=er.disabled,R=new Ii([k.ONE,k.ONE],s.aN.transparent,[!0,!0,!0,!0]);(function(P,H,N){let O=P.gl;P.activeTexture.set(O.TEXTURE1),P.viewport.set([0,0,H.width/4,H.height/4]);let et=N.heatmapFbo;if(et)O.bindTexture(O.TEXTURE_2D,et.colorAttachment.get()),P.bindFramebuffer.set(et.framebuffer);else{let nt=O.createTexture();O.bindTexture(O.TEXTURE_2D,nt),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_S,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_WRAP_T,O.CLAMP_TO_EDGE),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MIN_FILTER,O.LINEAR),O.texParameteri(O.TEXTURE_2D,O.TEXTURE_MAG_FILTER,O.LINEAR),et=N.heatmapFbo=P.createFramebuffer(H.width/4,H.height/4,!1,!1),function(Y,dt,gt,ot){var pt,Dt;let $t=Y.gl,jt=(pt=Y.HALF_FLOAT)!==null&&pt!==void 0?pt:$t.UNSIGNED_BYTE,ue=(Dt=Y.RGBA16F)!==null&&Dt!==void 0?Dt:$t.RGBA;$t.texImage2D($t.TEXTURE_2D,0,ue,dt.width/4,dt.height/4,0,$t.RGBA,jt,null),ot.colorAttachment.set(gt)}(P,H,nt,et)}})(x,b,g),x.clear({color:s.aN.transparent});for(let P=0;P<y.length;P++){let H=y[P];if(u.hasRenderableParent(H))continue;let N=u.getTile(H),O=N.getBucket(g);if(!O)continue;let et=O.programConfigurations.get(g.id),nt=b.useProgram("heatmap",et),{zoom:Y}=b.transform;nt.draw(x,k.TRIANGLES,ki.disabled,E,R,nr.disabled,ci(H.posMatrix,N,Y,g.paint.get("heatmap-intensity")),null,g.id,O.layoutVertexBuffer,O.indexBuffer,O.segments,g.paint,b.transform.zoom,et)}x.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(x,k){let E=x.context,R=E.gl,P=k.heatmapFbo;if(!P)return;E.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,P.colorAttachment.get()),E.activeTexture.set(R.TEXTURE1);let H=k.colorRampTexture;H||(H=k.colorRampTexture=new Nt(E,k.colorRamp,R.RGBA)),H.bind(R.LINEAR,R.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(E,R.TRIANGLES,ki.disabled,er.disabled,x.colorModeForRenderPass(),nr.disabled,((N,O,et,nt)=>{let Y=s.H();s.aQ(Y,0,N.width,N.height,0,0,1);let dt=N.context.gl;return{u_matrix:Y,u_world:[dt.drawingBufferWidth,dt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:O.paint.get("heatmap-opacity")}})(x,k),null,k.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,k.paint,x.transform.zoom)}(b,g))})(i,c,p,m);break;case"line":(function(b,u,g,y){if(b.renderPass!=="translucent")return;let x=g.paint.get("line-opacity"),k=g.paint.get("line-width");if(x.constantOr(1)===0||k.constantOr(1)===0)return;let E=b.depthModeForSublayer(0,ki.ReadOnly),R=b.colorModeForRenderPass(),P=g.paint.get("line-dasharray"),H=g.paint.get("line-pattern"),N=H.constantOr(1),O=g.paint.get("line-gradient"),et=g.getCrossfadeParameters(),nt=N?"linePattern":P?"lineSDF":O?"lineGradient":"line",Y=b.context,dt=Y.gl,gt=!0;for(let ot of y){let pt=u.getTile(ot);if(N&&!pt.patternsLoaded())continue;let Dt=pt.getBucket(g);if(!Dt)continue;let $t=Dt.programConfigurations.get(g.id),jt=b.context.program.get(),ue=b.useProgram(nt,$t),ce=gt||ue.program!==jt,Fe=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ot),xe=H.constantOr(null);if(xe&&pt.imageAtlas){let $e=pt.imageAtlas,Li=$e.patternPositions[xe.to.toString()],pi=$e.patternPositions[xe.from.toString()];Li&&pi&&$t.setConstantPatternPositions(Li,pi)}let ke=Fe?ot:null,Ue=N?Br(b,pt,g,et,ke):P?ln(b,pt,g,P,et,ke):O?ai(b,pt,g,Dt.lineClipsArray.length,ke):lr(b,pt,g,ke);if(N)Y.activeTexture.set(dt.TEXTURE0),pt.imageAtlasTexture.bind(dt.LINEAR,dt.CLAMP_TO_EDGE),$t.updatePaintBuffers(et);else if(P&&(ce||b.lineAtlas.dirty))Y.activeTexture.set(dt.TEXTURE0),b.lineAtlas.bind(Y);else if(O){let $e=Dt.gradients[g.id],Li=$e.texture;if(g.gradientVersion!==$e.version){let pi=256;if(g.stepInterpolant){let bi=u.getSource().maxzoom,Ci=ot.canonical.z===bi?Math.ceil(1<<b.transform.maxZoom-ot.canonical.z):1;pi=s.ad(s.aV(Dt.maxLineLength/s.X*1024*Ci),256,Y.maxTextureSize)}$e.gradient=s.aW({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:pi,image:$e.gradient||void 0,clips:Dt.lineClipsArray}),$e.texture?$e.texture.update($e.gradient):$e.texture=new Nt(Y,$e.gradient,dt.RGBA),$e.version=g.gradientVersion,Li=$e.texture}Y.activeTexture.set(dt.TEXTURE0),Li.bind(g.stepInterpolant?dt.NEAREST:dt.LINEAR,dt.CLAMP_TO_EDGE)}ue.draw(Y,dt.TRIANGLES,E,b.stencilModeForClipping(ot),R,nr.disabled,Ue,Fe,g.id,Dt.layoutVertexBuffer,Dt.indexBuffer,Dt.segments,g.paint,b.transform.zoom,$t,Dt.layoutVertexBuffer2),gt=!1}})(i,c,p,m);break;case"fill":(function(b,u,g,y){let x=g.paint.get("fill-color"),k=g.paint.get("fill-opacity");if(k.constantOr(1)===0)return;let E=b.colorModeForRenderPass(),R=g.paint.get("fill-pattern"),P=b.opaquePassEnabledForLayer()&&!R.constantOr(1)&&x.constantOr(s.aN.transparent).a===1&&k.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===P){let H=b.depthModeForSublayer(1,b.renderPass==="opaque"?ki.ReadWrite:ki.ReadOnly);Ia(b,u,g,y,H,E,!1)}if(b.renderPass==="translucent"&&g.paint.get("fill-antialias")){let H=b.depthModeForSublayer(g.getPaintProperty("fill-outline-color")?2:0,ki.ReadOnly);Ia(b,u,g,y,H,E,!0)}})(i,c,p,m);break;case"fill-extrusion":(function(b,u,g,y){let x=g.paint.get("fill-extrusion-opacity");if(x!==0&&b.renderPass==="translucent"){let k=new ki(b.context.gl.LEQUAL,ki.ReadWrite,b.depthRangeFor3D);if(x!==1||g.paint.get("fill-extrusion-pattern").constantOr(1))kn(b,u,g,y,k,er.disabled,Ii.disabled),kn(b,u,g,y,k,b.stencilModeFor3D(),b.colorModeForRenderPass());else{let E=b.colorModeForRenderPass();kn(b,u,g,y,k,er.disabled,E)}}})(i,c,p,m);break;case"hillshade":(function(b,u,g,y){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;let x=b.context,k=b.depthModeForSublayer(0,ki.ReadOnly),E=b.colorModeForRenderPass(),[R,P]=b.renderPass==="translucent"?b.stencilConfigForOverlap(y):[{},y];for(let H of P){let N=u.getTile(H);N.needsHillshadePrepare!==void 0&&N.needsHillshadePrepare&&b.renderPass==="offscreen"?Ps(b,N,g,k,er.disabled,E):b.renderPass==="translucent"&&ya(b,H,N,g,k,R[H.overscaledZ],E)}x.viewport.set([0,0,b.width,b.height])})(i,c,p,m);break;case"raster":(function(b,u,g,y){if(b.renderPass!=="translucent"||g.paint.get("raster-opacity")===0||!y.length)return;let x=b.context,k=x.gl,E=u.getSource(),R=b.useProgram("raster"),P=b.colorModeForRenderPass(),[H,N]=E instanceof ze?[{},y]:b.stencilConfigForOverlap(y),O=N[N.length-1].overscaledZ,et=!b.options.moving;for(let nt of N){let Y=b.depthModeForSublayer(nt.overscaledZ-O,g.paint.get("raster-opacity")===1?ki.ReadWrite:ki.ReadOnly,k.LESS),dt=u.getTile(nt);dt.registerFadeDuration(g.paint.get("raster-fade-duration"));let gt=u.findLoadedParent(nt,0),ot=u.findLoadedSibling(nt),pt=jo(dt,gt||ot||null,u,g,b.transform,b.style.map.terrain),Dt,$t,jt=g.paint.get("raster-resampling")==="nearest"?k.NEAREST:k.LINEAR;x.activeTexture.set(k.TEXTURE0),dt.texture.bind(jt,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),x.activeTexture.set(k.TEXTURE1),gt?(gt.texture.bind(jt,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),Dt=Math.pow(2,gt.tileID.overscaledZ-dt.tileID.overscaledZ),$t=[dt.tileID.canonical.x*Dt%1,dt.tileID.canonical.y*Dt%1]):dt.texture.bind(jt,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),dt.texture.useMipmap&&x.extTextureFilterAnisotropic&&b.transform.pitch>20&&k.texParameterf(k.TEXTURE_2D,x.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,x.extTextureFilterAnisotropicMax);let ue=b.style.map.terrain&&b.style.map.terrain.getTerrainData(nt),ce=ue?nt:null,Fe=ce?ce.posMatrix:b.transform.calculatePosMatrix(nt.toUnwrapped(),et),xe=$n(Fe,$t||[0,0],Dt||1,pt,g);E instanceof ze?R.draw(x,k.TRIANGLES,Y,er.disabled,P,nr.disabled,xe,ue,g.id,E.boundsBuffer,b.quadTriangleIndexBuffer,E.boundsSegments):R.draw(x,k.TRIANGLES,Y,H[nt.overscaledZ],P,nr.disabled,xe,ue,g.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments)}})(i,c,p,m);break;case"background":(function(b,u,g,y){let x=g.paint.get("background-color"),k=g.paint.get("background-opacity");if(k===0)return;let E=b.context,R=E.gl,P=b.transform,H=P.tileSize,N=g.paint.get("background-pattern");if(b.isPatternMissing(N))return;let O=!N&&x.a===1&&k===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==O)return;let et=er.disabled,nt=b.depthModeForSublayer(0,O==="opaque"?ki.ReadWrite:ki.ReadOnly),Y=b.colorModeForRenderPass(),dt=b.useProgram(N?"backgroundPattern":"background"),gt=y||P.coveringTiles({tileSize:H,terrain:b.style.map.terrain});N&&(E.activeTexture.set(R.TEXTURE0),b.imageManager.bind(b.context));let ot=g.getCrossfadeParameters();for(let pt of gt){let Dt=y?pt.posMatrix:b.transform.calculatePosMatrix(pt.toUnwrapped()),$t=N?Ma(Dt,k,b,N,{tileID:pt,tileSize:H},ot):bA(Dt,k,x),jt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(pt);dt.draw(E,R.TRIANGLES,nt,et,Y,nr.disabled,$t,jt,g.id,b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}})(i,0,p,m);break;case"custom":(function(b,u,g){let y=b.context,x=g.implementation;if(b.renderPass==="offscreen"){let k=x.prerender;k&&(b.setCustomLayerDefaults(),y.setColorMode(b.colorModeForRenderPass()),k.call(x,y.gl,b.transform.customLayerMatrix()),y.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),y.setColorMode(b.colorModeForRenderPass()),y.setStencilMode(er.disabled);let k=x.renderingMode==="3d"?new ki(b.context.gl.LEQUAL,ki.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,ki.ReadOnly);y.setDepthMode(k),x.render(y.gl,b.transform.customLayerMatrix(),{farZ:b.transform.farZ,nearZ:b.transform.nearZ,fov:b.transform._fov,modelViewProjectionMatrix:b.transform.modelViewProjectionMatrix,projectionMatrix:b.transform.projectionMatrix}),y.setDirty(),b.setBaseState(),y.bindFramebuffer.set(null)}})(i,0,p)}}translatePosMatrix(i,c,p,m,b){if(!p[0]&&!p[1])return i;let u=b?m==="map"?this.transform.angle:0:m==="viewport"?-this.transform.angle:0;if(u){let x=Math.sin(u),k=Math.cos(u);p=[p[0]*k-p[1]*x,p[0]*x+p[1]*k]}let g=[b?p[0]:xi(c,p[0],this.transform.zoom),b?p[1]:xi(c,p[1],this.transform.zoom),0],y=new Float32Array(16);return s.J(y,i,g),y}saveTileTexture(i){let c=this._tileTextures[i.size[0]];c?c.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){let c=this._tileTextures[i];return c&&c.length>0?c.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;let c=this.imageManager.getPattern(i.from.toString()),p=this.imageManager.getPattern(i.to.toString());return!c||!p}useProgram(i,c){this.cache=this.cache||{};let p=i+(c?c.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new _e(this.context,ct[i],c,Lo[i],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Nt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:i,drawingBufferHeight:c}=this.context.gl;return this.width!==i||this.height!==c}}class as{constructor(i,c){this.points=i,this.planes=c}static fromInvProjectionMatrix(i,c,p){let m=Math.pow(2,p),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(g=>{let y=1/(g=s.ag([],g,i))[3]/c*m;return s.b1(g,g,[y,y,1/g[3],y])}),u=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(g=>{let y=function(R,P){var H=P[0],N=P[1],O=P[2],et=H*H+N*N+O*O;return et>0&&(et=1/Math.sqrt(et)),R[0]=P[0]*et,R[1]=P[1]*et,R[2]=P[2]*et,R}([],function(R,P,H){var N=P[0],O=P[1],et=P[2],nt=H[0],Y=H[1],dt=H[2];return R[0]=O*dt-et*Y,R[1]=et*nt-N*dt,R[2]=N*Y-O*nt,R}([],Lt([],b[g[0]],b[g[1]]),Lt([],b[g[2]],b[g[1]]))),x=-((k=y)[0]*(E=b[g[1]])[0]+k[1]*E[1]+k[2]*E[2]);var k,E;return y.concat(x)});return new as(b,u)}}class vs{constructor(i,c){this.min=i,this.max=c,this.center=function(p,m,b){return p[0]=.5*m[0],p[1]=.5*m[1],p[2]=.5*m[2],p}([],function(p,m,b){return p[0]=m[0]+b[0],p[1]=m[1]+b[1],p[2]=m[2]+b[2],p}([],this.min,this.max))}quadrant(i){let c=[i%2==0,i<2],p=At(this.min),m=At(this.max);for(let b=0;b<c.length;b++)p[b]=c[b]?this.min[b]:this.center[b],m[b]=c[b]?this.center[b]:this.max[b];return m[2]=this.max[2],new vs(p,m)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){let c=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],p=!0;for(let m=0;m<i.planes.length;m++){let b=i.planes[m],u=0;for(let g=0;g<c.length;g++)s.b2(b,c[g])>=0&&u++;if(u===0)return 0;u!==c.length&&(p=!1)}if(p)return 2;for(let m=0;m<3;m++){let b=Number.MAX_VALUE,u=-Number.MAX_VALUE;for(let g=0;g<i.points.length;g++){let y=i.points[g][m]-this.min[m];b=Math.min(b,y),u=Math.max(u,y)}if(u<0||b>this.max[m]-this.min[m])return 0}return 1}}class Ns{constructor(i=0,c=0,p=0,m=0){if(isNaN(i)||i<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=c,this.left=p,this.right=m}interpolate(i,c,p){return c.top!=null&&i.top!=null&&(this.top=s.z.number(i.top,c.top,p)),c.bottom!=null&&i.bottom!=null&&(this.bottom=s.z.number(i.bottom,c.bottom,p)),c.left!=null&&i.left!=null&&(this.left=s.z.number(i.left,c.left,p)),c.right!=null&&i.right!=null&&(this.right=s.z.number(i.right,c.right,p)),this}getCenter(i,c){let p=s.ad((this.left+i-this.right)/2,0,i),m=s.ad((this.top+c-this.bottom)/2,0,c);return new s.P(p,m)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Ns(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}let wa=85.051129;class ws{constructor(i,c,p,m,b){this.tileSize=512,this._renderWorldCopies=b===void 0||!!b,this._minZoom=i||0,this._maxZoom=c||22,this._minPitch=p??0,this._maxPitch=m??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ns,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){let i=new ws(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.apply(this),i}apply(i){this.tileSize=i.tileSize,this.latRange=i.latRange,this.width=i.width,this.height=i.height,this._center=i._center,this._elevation=i._elevation,this.minElevationForCurrentTile=i.minElevationForCurrentTile,this.zoom=i.zoom,this.angle=i.angle,this._fov=i._fov,this._pitch=i._pitch,this._unmodified=i._unmodified,this._edgeInsets=i._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){let c=-s.b3(i,-180,180)*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=function(){var p=new s.A(4);return s.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,m,b){var u=m[0],g=m[1],y=m[2],x=m[3],k=Math.sin(b),E=Math.cos(b);p[0]=u*E+y*k,p[1]=g*E+x*k,p[2]=u*-k+y*E,p[3]=g*-k+x*E}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){let c=s.ad(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){let c=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._zoom=c,this.tileZoom=Math.max(0,Math.floor(c)),this.scale=this.zoomScale(c),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,c,p){this._unmodified=!1,this._edgeInsets.interpolate(i,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){let c=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(i){let c=[new s.b4(0,i)];if(this._renderWorldCopies){let p=this.pointCoordinate(new s.P(0,0)),m=this.pointCoordinate(new s.P(this.width,0)),b=this.pointCoordinate(new s.P(this.width,this.height)),u=this.pointCoordinate(new s.P(0,this.height)),g=Math.floor(Math.min(p.x,m.x,b.x,u.x)),y=Math.floor(Math.max(p.x,m.x,b.x,u.x)),x=1;for(let k=g-x;k<=y+x;k++)k!==0&&c.push(new s.b4(k,i))}return c}coveringTiles(i){var c,p;let m=this.coveringZoomLevel(i),b=m;if(i.minzoom!==void 0&&m<i.minzoom)return[];i.maxzoom!==void 0&&m>i.maxzoom&&(m=i.maxzoom);let u=this.pointCoordinate(this.getCameraPoint()),g=s.Z.fromLngLat(this.center),y=Math.pow(2,m),x=[y*u.x,y*u.y,0],k=[y*g.x,y*g.y,0],E=as.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,m),R=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(R=m);let P=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,H=Y=>({aabb:new vs([Y*y,0,0],[(Y+1)*y,y,0]),zoom:0,x:0,y:0,wrap:Y,fullyVisible:!1}),N=[],O=[],et=m,nt=i.reparseOverscaled?b:m;if(this._renderWorldCopies)for(let Y=1;Y<=3;Y++)N.push(H(-Y)),N.push(H(Y));for(N.push(H(0));N.length>0;){let Y=N.pop(),dt=Y.x,gt=Y.y,ot=Y.fullyVisible;if(!ot){let ue=Y.aabb.intersects(E);if(ue===0)continue;ot=ue===2}let pt=i.terrain?x:k,Dt=Y.aabb.distanceX(pt),$t=Y.aabb.distanceY(pt),jt=Math.max(Math.abs(Dt),Math.abs($t));if(Y.zoom===et||jt>P+(1<<et-Y.zoom)-2&&Y.zoom>=R){let ue=et-Y.zoom,ce=x[0]-.5-(dt<<ue),Fe=x[1]-.5-(gt<<ue);O.push({tileID:new s.S(Y.zoom===et?nt:Y.zoom,Y.wrap,Y.zoom,dt,gt),distanceSq:Et([k[0]-.5-dt,k[1]-.5-gt]),tileDistanceToCamera:Math.sqrt(ce*ce+Fe*Fe)})}else for(let ue=0;ue<4;ue++){let ce=(dt<<1)+ue%2,Fe=(gt<<1)+(ue>>1),xe=Y.zoom+1,ke=Y.aabb.quadrant(ue);if(i.terrain){let Ue=new s.S(xe,Y.wrap,xe,ce,Fe),$e=i.terrain.getMinMaxElevation(Ue),Li=(c=$e.minElevation)!==null&&c!==void 0?c:this.elevation,pi=(p=$e.maxElevation)!==null&&p!==void 0?p:this.elevation;ke=new vs([ke.min[0],ke.min[1],Li],[ke.max[0],ke.max[1],pi])}N.push({aabb:ke,zoom:xe,x:ce,y:Fe,wrap:Y.wrap,fullyVisible:ot})}}return O.sort((Y,dt)=>Y.distanceSq-dt.distanceSq).map(Y=>Y.tileID)}resize(i,c){this.width=i,this.height=c,this.pixelsToGLUnits=[2/i,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){let c=s.ad(i.lat,-85.051129,wa);return new s.P(s.O(i.lng)*this.worldSize,s.Q(c)*this.worldSize)}unproject(i){return new s.Z(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){let c=this.elevation,p=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,m=this.pointLocation(this.centerPoint,i),b=i.getElevationForLngLatZoom(m,this.tileZoom);if(!(this.elevation-b))return;let u=p+c-b,g=Math.cos(this._pitch)*this.cameraToCenterDistance/u/s.b5(1,m.lat),y=this.scaleZoom(g/this.tileSize);this._elevation=b,this._center=m,this.zoom=y}setLocationAtPoint(i,c){let p=this.pointCoordinate(c),m=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(i),u=new s.Z(b.x-(p.x-m.x),b.y-(p.y-m.y));this.center=this.coordinateLocation(u),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,c){return c?this.coordinatePoint(this.locationCoordinate(i),c.getElevationForLngLatZoom(i,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,c){return this.coordinateLocation(this.pointCoordinate(i,c))}locationCoordinate(i){return s.Z.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,c){if(c){let R=c.pointCoordinate(i);if(R!=null)return R}let p=[i.x,i.y,0,1],m=[i.x,i.y,1,1];s.ag(p,p,this.pixelMatrixInverse),s.ag(m,m,this.pixelMatrixInverse);let b=p[3],u=m[3],g=p[1]/b,y=m[1]/u,x=p[2]/b,k=m[2]/u,E=x===k?0:(0-x)/(k-x);return new s.Z(s.z.number(p[0]/b,m[0]/u,E)/this.worldSize,s.z.number(g,y,E)/this.worldSize)}coordinatePoint(i,c=0,p=this.pixelMatrix){let m=[i.x*this.worldSize,i.y*this.worldSize,c,1];return s.ag(m,m,p),new s.P(m[0]/m[3],m[1]/m[3])}getBounds(){let i=Math.max(0,this.height/2-this.getHorizon());return new Kt().extend(this.pointLocation(new s.P(0,i))).extend(this.pointLocation(new s.P(this.width,i))).extend(this.pointLocation(new s.P(this.width,this.height))).extend(this.pointLocation(new s.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Kt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,wa])}calculateTileMatrix(i){let c=i.canonical,p=this.worldSize/this.zoomScale(c.z),m=c.x+Math.pow(2,c.z)*i.wrap,b=s.ao(new Float64Array(16));return s.J(b,b,[m*p,c.y*p,0]),s.K(b,b,[p/s.X,p/s.X,1]),b}calculatePosMatrix(i,c=!1){let p=i.key,m=c?this._alignedPosMatrixCache:this._posMatrixCache;if(m[p])return m[p];let b=this.calculateTileMatrix(i);return s.L(b,c?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,b),m[p]=new Float32Array(b),m[p]}calculateFogMatrix(i){let c=i.key,p=this._fogMatrixCache;if(p[c])return p[c];let m=this.calculateTileMatrix(i);return s.L(m,this.fogMatrix,m),p[c]=new Float32Array(m),p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(i,c){c=s.ad(+c,this.minZoom,this.maxZoom);let p={center:new s.N(i.lng,i.lat),zoom:c},m=this.lngRange;if(!this._renderWorldCopies&&m===null){let Y=179.9999999999;m=[-Y,Y]}let b=this.tileSize*this.zoomScale(p.zoom),u=0,g=b,y=0,x=b,k=0,E=0,{x:R,y:P}=this.size;if(this.latRange){let Y=this.latRange;u=s.Q(Y[1])*b,g=s.Q(Y[0])*b,g-u<P&&(k=P/(g-u))}m&&(y=s.b3(s.O(m[0])*b,0,b),x=s.b3(s.O(m[1])*b,0,b),x<y&&(x+=b),x-y<R&&(E=R/(x-y)));let{x:H,y:N}=this.project.call({worldSize:b},i),O,et,nt=Math.max(E||0,k||0);if(nt){let Y=new s.P(E?(x+y)/2:H,k?(g+u)/2:N);return p.center=this.unproject.call({worldSize:b},Y).wrap(),p.zoom+=this.scaleZoom(nt),p}if(this.latRange){let Y=P/2;N-Y<u&&(et=u+Y),N+Y>g&&(et=g-Y)}if(m){let Y=(y+x)/2,dt=H;this._renderWorldCopies&&(dt=s.b3(H,Y-b/2,Y+b/2));let gt=R/2;dt-gt<y&&(O=y+gt),dt+gt>x&&(O=x-gt)}if(O!==void 0||et!==void 0){let Y=new s.P(O??H,et??N);p.center=this.unproject.call({worldSize:b},Y).wrap()}return p}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let i=this._unmodified,{center:c,zoom:p}=this.getConstrained(this.center,this.zoom);this.center=c,this.zoom=p,this._unmodified=i,this._constraining=!1}_calcMatrices(){if(!this.height)return;let i=this.centerOffset,c=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=s.b5(1,this.center.lat)*this.worldSize;let m=s.ao(new Float64Array(16));s.K(m,m,[this.width/2,-this.height/2,1]),s.J(m,m,[1,-1,0]),this.labelPlaneMatrix=m,m=s.ao(new Float64Array(16)),s.K(m,m,[1,-1,1]),s.J(m,m,[-1,-1,0]),s.K(m,m,[2/this.width,2/this.height,1]),this.glCoordMatrix=m;let b=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),u=Math.min(this.elevation,this.minElevationForCurrentTile),g=b-u*this._pixelPerMeter/Math.cos(this._pitch),y=u<0?g:b,x=Math.PI/2+this._pitch,k=this._fov*(.5+i.y/this.height),E=Math.sin(k)*y/Math.sin(s.ad(Math.PI-x-k,.01,Math.PI-.01)),R=this.getHorizon(),P=2*Math.atan(R/this.cameraToCenterDistance)*(.5+i.y/(2*R)),H=Math.sin(P)*y/Math.sin(s.ad(Math.PI-x-P,.01,Math.PI-.01)),N=Math.min(E,H);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*N+y),this.nearZ=this.height/50,m=new Float64Array(16),s.b6(m,this._fov,this.width/this.height,this.nearZ,this.farZ),m[8]=2*-i.x/this.width,m[9]=2*i.y/this.height,this.projectionMatrix=s.af(m),s.K(m,m,[1,-1,1]),s.J(m,m,[0,0,-this.cameraToCenterDistance]),s.b7(m,m,this._pitch),s.ae(m,m,this.angle),s.J(m,m,[-c,-p,0]),this.mercatorMatrix=s.K([],m,[this.worldSize,this.worldSize,this.worldSize]),s.K(m,m,[1,1,this._pixelPerMeter]),this.pixelMatrix=s.L(new Float64Array(16),this.labelPlaneMatrix,m),s.J(m,m,[0,0,-this.elevation]),this.modelViewProjectionMatrix=m,this.invModelViewProjectionMatrix=s.at([],m),this.fogMatrix=new Float64Array(16),s.b6(this.fogMatrix,this._fov,this.width/this.height,b,this.farZ),this.fogMatrix[8]=2*-i.x/this.width,this.fogMatrix[9]=2*i.y/this.height,s.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),s.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),s.b7(this.fogMatrix,this.fogMatrix,this._pitch),s.ae(this.fogMatrix,this.fogMatrix,this.angle),s.J(this.fogMatrix,this.fogMatrix,[-c,-p,0]),s.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),s.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=s.L(new Float64Array(16),this.labelPlaneMatrix,m);let O=this.width%2/2,et=this.height%2/2,nt=Math.cos(this.angle),Y=Math.sin(this.angle),dt=c-Math.round(c)+nt*O+Y*et,gt=p-Math.round(p)+nt*et+Y*O,ot=new Float64Array(m);if(s.J(ot,ot,[dt>.5?dt-1:dt,gt>.5?gt-1:gt,0]),this.alignedModelViewProjectionMatrix=ot,m=s.at(new Float64Array(16),this.pixelMatrix),!m)throw new Error("failed to invert matrix");this.pixelMatrixInverse=m,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let i=this.pointCoordinate(new s.P(0,0)),c=[i.x*this.worldSize,i.y*this.worldSize,0,1];return s.ag(c,c,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(0,i))}getCameraQueryGeometry(i){let c=this.getCameraPoint();if(i.length===1)return[i[0],c];{let p=c.x,m=c.y,b=c.x,u=c.y;for(let g of i)p=Math.min(p,g.x),m=Math.min(m,g.y),b=Math.max(b,g.x),u=Math.max(u,g.y);return[new s.P(p,m),new s.P(b,m),new s.P(b,u),new s.P(p,u),new s.P(p,m)]}}lngLatToCameraDepth(i,c){let p=this.locationCoordinate(i),m=[p.x*this.worldSize,p.y*this.worldSize,c,1];return s.ag(m,m,this.modelViewProjectionMatrix),m[2]/m[3]}}function $o(v,i){let c,p=!1,m=null,b=null,u=()=>{m=null,p&&(v.apply(b,c),m=setTimeout(u,i),p=!1)};return(...g)=>(p=!0,b=this,c=g,m||u(),m)}class ta{constructor(i){this._getCurrentHash=()=>{let c=window.location.hash.replace("#","");if(this._hashName){let p;return c.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(p=m)}),(p&&p[1]||"").split("/")}return c.split("/")},this._onHashChange=()=>{let c=this._getCurrentHash();if(c.length>=3&&!c.some(p=>isNaN(p))){let p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{let c=window.location.href.replace(/(#.+)?$/,this.getHashString());window.history.replaceState(window.history.state,null,c)},this._removeHash=()=>{let c=this._getCurrentHash();if(c.length===0)return;let p=c.join("/"),m=p;m.split("&").length>0&&(m=m.split("&")[0]),this._hashName&&(m=`${this._hashName}=${p}`);let b=window.location.hash.replace(m,"");b.startsWith("#&")?b=b.slice(0,1)+b.slice(2):b==="#"&&(b="");let u=window.location.href.replace(/(#.+)?$/,b);u=u.replace("&&","&"),window.history.replaceState(window.history.state,null,u)},this._updateHash=$o(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(i){let c=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,m=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,m),u=Math.round(c.lng*b)/b,g=Math.round(c.lat*b)/b,y=this._map.getBearing(),x=this._map.getPitch(),k="";if(k+=i?`/${u}/${g}/${p}`:`${p}/${g}/${u}`,(y||x)&&(k+="/"+Math.round(10*y)/10),x&&(k+=`/${Math.round(x)}`),this._hashName){let E=this._hashName,R=!1,P=window.location.hash.slice(1).split("&").map(H=>{let N=H.split("=")[0];return N===E?(R=!0,`${N}=${k}`):H}).filter(H=>H);return R||P.push(`${E}=${k}`),`#${P.join("&")}`}return`#${k}`}}let As={linearity:.3,easing:s.b8(0,0,.3,1)},Bs=s.e({deceleration:2500,maxSpeed:1400},As),lo=s.e({deceleration:20,maxSpeed:1400},As),Ba=s.e({deceleration:1e3,maxSpeed:360},As),ea=s.e({deceleration:1e3,maxSpeed:90},As);class To{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:_.now(),settings:i})}_drainInertiaBuffer(){let i=this._inertiaBuffer,c=_.now();for(;i.length>0&&c-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let c={zoom:0,bearing:0,pitch:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:b}of this._inertiaBuffer)c.zoom+=b.zoomDelta||0,c.bearing+=b.bearingDelta||0,c.pitch+=b.pitchDelta||0,b.panDelta&&c.pan._add(b.panDelta),b.around&&(c.around=b.around),b.pinchAround&&(c.pinchAround=b.pinchAround);let p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,m={};if(c.pan.mag()){let b=_a(c.pan.mag(),p,s.e({},Bs,i||{}));m.offset=c.pan.mult(b.amount/c.pan.mag()),m.center=this._map.transform.center,_s(m,b)}if(c.zoom){let b=_a(c.zoom,p,lo);m.zoom=this._map.transform.zoom+b.amount,_s(m,b)}if(c.bearing){let b=_a(c.bearing,p,Ba);m.bearing=this._map.transform.bearing+s.ad(b.amount,-179,179),_s(m,b)}if(c.pitch){let b=_a(c.pitch,p,ea);m.pitch=this._map.transform.pitch+b.amount,_s(m,b)}if(m.zoom||m.bearing){let b=c.pinchAround===void 0?c.around:c.pinchAround;m.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),s.e(m,{noMoveStart:!0})}}function _s(v,i){(!v.duration||v.duration<i.duration)&&(v.duration=i.duration,v.easing=i.easing)}function _a(v,i,c){let{maxSpeed:p,linearity:m,deceleration:b}=c,u=s.ad(v*m/(i/1e3),-p,p),g=Math.abs(u)/(b*m);return{easing:c.easing,duration:1e3*g,amount:u*(g/2)}}class Vr extends s.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p,m={}){let b=S.mousePos(c.getCanvas(),p),u=c.unproject(b);super(i,s.e({point:b,lngLat:u,originalEvent:p},m)),this._defaultPrevented=!1,this.target=c}}class xs extends s.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p){let m=i==="touchend"?p.changedTouches:p.touches,b=S.touchPos(c.getCanvasContainer(),m),u=b.map(y=>c.unproject(y)),g=b.reduce((y,x,k,E)=>y.add(x.div(E.length)),new s.P(0,0));super(i,{points:b,point:g,lngLats:u,lngLat:c.unproject(g),originalEvent:p}),this._defaultPrevented=!1}}class kr extends s.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p){super(i,{originalEvent:p}),this._defaultPrevented=!1}}class _r{constructor(i,c){this._map=i,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new kr(i.type,this._map,i))}mousedown(i,c){return this._mousedownPos=c,this._firePreventable(new Vr(i.type,this._map,i))}mouseup(i){this._map.fire(new Vr(i.type,this._map,i))}click(i,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||this._map.fire(new Vr(i.type,this._map,i))}dblclick(i){return this._firePreventable(new Vr(i.type,this._map,i))}mouseover(i){this._map.fire(new Vr(i.type,this._map,i))}mouseout(i){this._map.fire(new Vr(i.type,this._map,i))}touchstart(i){return this._firePreventable(new xs(i.type,this._map,i))}touchmove(i){this._map.fire(new xs(i.type,this._map,i))}touchend(i){this._map.fire(new xs(i.type,this._map,i))}touchcancel(i){this._map.fire(new xs(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class en{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new Vr(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Vr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new Vr(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wr{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.pointLocation(s.P.convert(i),this._map.terrain)}}class co{constructor(i,c){this._map=i,this._tr=new Wr(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,c){this.isEnabled()&&i.shiftKey&&i.button===0&&(S.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(i,c){if(!this._active)return;let p=c;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;let m=this._startPos;this._lastPos=p,this._box||(this._box=S.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));let b=Math.min(m.x,p.x),u=Math.max(m.x,p.x),g=Math.min(m.y,p.y),y=Math.max(m.y,p.y);S.setTransform(this._box,`translate(${b}px,${g}px)`),this._box.style.width=u-b+"px",this._box.style.height=y-g+"px"}mouseupWindow(i,c){if(!this._active||i.button!==0)return;let p=this._startPos,m=c;if(this.reset(),S.suppressClick(),p.x!==m.x||p.y!==m.y)return this._map.fire(new s.k("boxzoomend",{originalEvent:i})),{cameraAnimation:b=>b.fitScreenCoordinates(p,m,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(S.remove(this._box),this._box=null),S.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,c){return this._map.fire(new s.k(i,{originalEvent:c}))}}function Ss(v,i){if(v.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${i.length}`);let c={};for(let p=0;p<v.length;p++)c[v[p].identifier]=i[p];return c}class xa{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),p.length===this.numTouches&&(this.centroid=function(m){let b=new s.P(0,0);for(let u of m)b._add(u);return b.div(m.length)}(c),this.touches=Ss(p,c)))}touchmove(i,c,p){if(this.aborted||!this.centroid)return;let m=Ss(p,c);for(let b in this.touches){let u=m[b];(!u||u.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(i,c,p){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){let m=!this.aborted&&this.centroid;if(this.reset(),m)return m}}}class kA{constructor(i){this.singleTap=new xa(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,c,p){this.singleTap.touchstart(i,c,p)}touchmove(i,c,p){this.singleTap.touchmove(i,c,p)}touchend(i,c,p){let m=this.singleTap.touchend(i,c,p);if(m){let b=i.timeStamp-this.lastTime<500,u=!this.lastTap||this.lastTap.dist(m)<30;if(b&&u||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}}}class vc{constructor(i){this._tr=new Wr(i),this._zoomIn=new kA({numTouches:1,numTaps:2}),this._zoomOut=new kA({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,c,p){this._zoomIn.touchstart(i,c,p),this._zoomOut.touchstart(i,c,p)}touchmove(i,c,p){this._zoomIn.touchmove(i,c,p),this._zoomOut.touchmove(i,c,p)}touchend(i,c,p){let m=this._zoomIn.touchend(i,c,p),b=this._zoomOut.touchend(i,c,p),u=this._tr;return m?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:g=>g.easeTo({duration:300,zoom:u.zoom+1,around:u.unproject(m)},{originalEvent:i})}):b?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:g=>g.easeTo({duration:300,zoom:u.zoom-1,around:u.unproject(b)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qr{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){let c=this._moveFunction(...i);if(c.bearingDelta||c.pitchDelta||c.around||c.panDelta)return this._active=!0,c}dragStart(i,c){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=c.length?c[0]:c,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,c){if(!this.isEnabled())return;let p=this._lastPoint;if(!p)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);let m=c.length?c[0]:c;return!this._moved&&m.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=m,this._move(p,m))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&S.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let Sa={0:1,2:2};class ts{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){let c=S.mouseButton(i);this._eventButton=c}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!function(c,p){let m=Sa[p];return c.buttons===void 0||(c.buttons&m)!==m}(i,this._eventButton)}isValidEndEvent(i){return S.mouseButton(i)===this._eventButton}}class al{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}let LA=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=i=>{i.preventDefault()}},Al=({enable:v,clickTolerance:i,bearingDegreesPerPixelMoved:c=.8})=>{let p=new ts({checkCorrectEvent:m=>S.mouseButton(m)===0&&m.ctrlKey||S.mouseButton(m)===2});return new Qr({clickTolerance:i,move:(m,b)=>({bearingDelta:(b.x-m.x)*c}),moveStateManager:p,enable:v,assignEvents:LA})},Uo=({enable:v,clickTolerance:i,pitchDegreesPerPixelMoved:c=-.5})=>{let p=new ts({checkCorrectEvent:m=>S.mouseButton(m)===0&&m.ctrlKey||S.mouseButton(m)===2});return new Qr({clickTolerance:i,move:(m,b)=>({pitchDelta:(b.y-m.y)*c}),moveStateManager:p,enable:v,assignEvents:LA})};class En{constructor(i,c){this._clickTolerance=i.clickTolerance||1,this._map=c,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(i){return i<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(i,c,p){return this._calculateTransform(i,c,p)}touchmove(i,c,p){if(this._active){if(!this._shouldBePrevented(p.length))return i.preventDefault(),this._calculateTransform(i,c,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",i)}}touchend(i,c,p){this._calculateTransform(i,c,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,c,p){p.length>0&&(this._active=!0);let m=Ss(p,c),b=new s.P(0,0),u=new s.P(0,0),g=0;for(let x in m){let k=m[x],E=this._touches[x];E&&(b._add(k),u._add(k.sub(E)),g++,m[x]=k)}if(this._touches=m,this._shouldBePrevented(g)||!u.mag())return;let y=u.div(g);return this._sum._add(y),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(g),panDelta:y}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zn{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(i,c,p){if(!this._firstTwoTouches)return;i.preventDefault();let[m,b]=this._firstTwoTouches,u=Fa(p,c,m),g=Fa(p,c,b);if(!u||!g)return;let y=this._aroundCenter?null:u.add(g).div(2);return this._move([u,g],y,i)}touchend(i,c,p){if(!this._firstTwoTouches)return;let[m,b]=this._firstTwoTouches,u=Fa(p,c,m),g=Fa(p,c,b);u&&g||(this._active&&S.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Fa(v,i,c){for(let p=0;p<v.length;p++)if(v[p].identifier===c)return i[p]}function EA(v,i){return Math.log(v/i)/Math.LN2}class Pl extends zn{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,c){let p=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(EA(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:EA(this._distance,p),pinchAround:c}}}function TA(v,i){return 180*v.angleWith(i)/Math.PI}class UA extends zn{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,c,p){let m=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:TA(this._vector,m),pinchAround:c}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());let c=25/(Math.PI*this._minDiameter)*360,p=TA(i,this._startVector);return Math.abs(p)<c}}function uo(v){return Math.abs(v.y)>Math.abs(v.x)}class Hl extends zn{constructor(i){super(),this._currentTouchCount=0,this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,c,p){super.touchstart(i,c,p),this._currentTouchCount=p.length}_start(i){this._lastPoints=i,uo(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,c,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let m=i[0].sub(this._lastPoints[0]),b=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(m,b,p.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(m.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(i,c,p){if(this._valid!==void 0)return this._valid;let m=i.mag()>=2,b=c.mag()>=2;if(!m&&!b)return;if(!m||!b)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;let u=i.y>0==c.y>0;return uo(i)&&uo(c)&&u}}let Ml={panStep:100,bearingStep:15,pitchStep:10};class ll{constructor(i){this._tr=new Wr(i);let c=Ml;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let c=0,p=0,m=0,b=0,u=0;switch(i.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:i.shiftKey?p=-1:(i.preventDefault(),b=-1);break;case 39:i.shiftKey?p=1:(i.preventDefault(),b=1);break;case 38:i.shiftKey?m=1:(i.preventDefault(),u=-1);break;case 40:i.shiftKey?m=-1:(i.preventDefault(),u=1);break;default:return}return this._rotationDisabled&&(p=0,m=0),{cameraAnimation:g=>{let y=this._tr;g.easeTo({duration:300,easeId:"keyboardHandler",easing:cl,zoom:c?Math.round(y.zoom)+c*(i.shiftKey?2:1):y.zoom,bearing:y.bearing+p*this._bearingStep,pitch:y.pitch+m*this._pitchStep,offset:[-b*this._panStep,-u*this._panStep],center:y.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cl(v){return v*(2-v)}let ul=4.000244140625;class wc{constructor(i,c){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=i,this._tr=new Wr(i),this._triggerRenderFrame=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(i){return!!this._map.cooperativeGestures.isEnabled()&&!(i.ctrlKey||this._map.cooperativeGestures.isBypassed(i))}wheel(i){if(!this.isEnabled())return;if(this._shouldBePrevented(i))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",i);let c=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY,p=_.now(),m=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,c!==0&&c%ul==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(m*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),i.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=i,this._delta-=c,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let c=S.mousePos(this._map.getCanvas(),i),p=this._tr;this._around=c.y>p.transform.height/2-p.transform.getHorizon()?s.N.convert(this._aroundCenter?p.center:p.unproject(c)):s.N.convert(p.center),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let i=this._tr.transform;if(this._delta!==0){let y=this._type==="wheel"&&Math.abs(this._delta)>ul?this._wheelZoomRate:this._defaultZoomRate,x=2/(1+Math.exp(-Math.abs(this._delta*y)));this._delta<0&&x!==0&&(x=1/x);let k=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(k*x))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let c=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,p=this._startZoom,m=this._easing,b,u=!1,g=_.now()-this._lastWheelEventTime;if(this._type==="wheel"&&p&&m&&g){let y=Math.min(g/200,1),x=m(y);b=s.z.number(p,c,x),y<1?this._frameId||(this._frameId=!0):u=!0}else b=c,u=!0;return this._active=!0,u&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!u,zoomDelta:b-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let c=s.b9;if(this._prevEase){let p=this._prevEase,m=(_.now()-p.start)/p.duration,b=p.easing(m+.01)-p.easing(m),u=.27/Math.sqrt(b*b+1e-4)*.01,g=Math.sqrt(.0729-u*u);c=s.b8(u,g,.25,1)}return this._prevEase={start:_.now(),duration:i,easing:c},c}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Bc{constructor(i,c){this._clickZoom=i,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class QA{constructor(i){this._tr=new Wr(i),this.reset()}reset(){this._active=!1}dblclick(i,c){return i.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(c)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lu{constructor(){this._tap=new kA({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,c,p){if(!this._swipePoint)if(this._tapTime){let m=c[0],b=i.timeStamp-this._tapTime<500,u=this._tapPoint.dist(m)<30;b&&u?p.length>0&&(this._swipePoint=m,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(i,c,p)}touchmove(i,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;let m=c[0],b=m.y-this._swipePoint.y;return this._swipePoint=m,i.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(i,c,p)}touchend(i,c,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{let m=this._tap.touchend(i,c,p);m&&(this._tapTime=i.timeStamp,this._tapPoint=m)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vs{constructor(i,c,p){this._el=i,this._mousePan=c,this._touchPan=p}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ho{constructor(i,c,p){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class _c{constructor(i,c,p,m){this._el=i,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class go{constructor(i,c){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=i,this._options=c,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let i=this._map.getCanvasContainer();i.classList.add("maplibregl-cooperative-gestures"),this._container=S.create("div","maplibregl-cooperative-gesture-screen",i);let c=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(c=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),m=document.createElement("div");m.className="maplibregl-desktop-message",m.textContent=c,this._container.appendChild(m);let b=document.createElement("div");b.className="maplibregl-mobile-message",b.textContent=p,this._container.appendChild(b),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(S.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(i){return i[this._bypassKey]}notifyGestureBlocked(i,c){this._enabled&&(this._map.fire(new s.k("cooperativegestureprevented",{gestureType:i,originalEvent:c})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}let po=v=>v.zoom||v.drag||v.pitch||v.rotate;class xc extends s.k{}function Ja(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class vh{constructor(i,c){this.handleWindowEvent=m=>{this.handleEvent(m,`${m.type}Window`)},this.handleEvent=(m,b)=>{if(m.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let u=m.type==="renderFrame"?void 0:m,g={needsRenderFrame:!1},y={},x={},k=m.touches,E=k?this._getMapTouches(k):void 0,R=E?S.touchPos(this._map.getCanvas(),E):S.mousePos(this._map.getCanvas(),m);for(let{handlerName:N,handler:O,allowed:et}of this._handlers){if(!O.isEnabled())continue;let nt;this._blockedByActive(x,et,N)?O.reset():O[b||m.type]&&(nt=O[b||m.type](m,R,E),this.mergeHandlerResult(g,y,nt,N,u),nt&&nt.needsRenderFrame&&this._triggerRenderFrame()),(nt||O.isActive())&&(x[N]=O)}let P={};for(let N in this._previousActiveHandlers)x[N]||(P[N]=u);this._previousActiveHandlers=x,(Object.keys(P).length||Ja(g))&&(this._changes.push([g,y,P]),this._triggerRenderFrame()),(Object.keys(x).length||Ja(g))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:H}=g;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new To(i),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(c);let p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(let[m,b,u]of this._listeners)S.addEventListener(m,b,m===document?this.handleWindowEvent:this.handleEvent,u)}destroy(){for(let[i,c,p]of this._listeners)S.removeEventListener(i,c,i===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(i){let c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new _r(c,i));let m=c.boxZoom=new co(c,i);this._add("boxZoom",m),i.interactive&&i.boxZoom&&m.enable();let b=c.cooperativeGestures=new go(c,i.cooperativeGestures);this._add("cooperativeGestures",b),i.cooperativeGestures&&b.enable();let u=new vc(c),g=new QA(c);c.doubleClickZoom=new Bc(g,u),this._add("tapZoom",u),this._add("clickZoom",g),i.interactive&&i.doubleClickZoom&&c.doubleClickZoom.enable();let y=new lu;this._add("tapDragZoom",y);let x=c.touchPitch=new Hl(c);this._add("touchPitch",x),i.interactive&&i.touchPitch&&c.touchPitch.enable(i.touchPitch);let k=Al(i),E=Uo(i);c.dragRotate=new ho(i,k,E),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",E,["mouseRotate"]),i.interactive&&i.dragRotate&&c.dragRotate.enable();let R=(({enable:nt,clickTolerance:Y})=>{let dt=new ts({checkCorrectEvent:gt=>S.mouseButton(gt)===0&&!gt.ctrlKey});return new Qr({clickTolerance:Y,move:(gt,ot)=>({around:ot,panDelta:ot.sub(gt)}),activateOnStart:!0,moveStateManager:dt,enable:nt,assignEvents:LA})})(i),P=new En(i,c);c.dragPan=new Vs(p,R,P),this._add("mousePan",R),this._add("touchPan",P,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&c.dragPan.enable(i.dragPan);let H=new UA,N=new Pl;c.touchZoomRotate=new _c(p,N,H,y),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",N,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&c.touchZoomRotate.enable(i.touchZoomRotate);let O=c.scrollZoom=new wc(c,()=>this._triggerRenderFrame());this._add("scrollZoom",O,["mousePan"]),i.interactive&&i.scrollZoom&&c.scrollZoom.enable(i.scrollZoom);let et=c.keyboard=new ll(c);this._add("keyboard",et),i.interactive&&i.keyboard&&c.keyboard.enable(),this._add("blockableMapEvent",new en(c))}_add(i,c,p){this._handlers.push({handlerName:i,handler:c,allowed:p}),this._handlersById[i]=c}stop(i){if(!this._updatingCamera){for(let{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(let{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(po(this._eventsInProgress))||this.isZooming()}_blockedByActive(i,c,p){for(let m in i)if(m!==p&&(!c||c.indexOf(m)<0))return!0;return!1}_getMapTouches(i){let c=[];for(let p of i)this._el.contains(p.target)&&c.push(p);return c}mergeHandlerResult(i,c,p,m,b){if(!p)return;s.e(i,p);let u={handlerName:m,originalEvent:p.originalEvent||b};p.zoomDelta!==void 0&&(c.zoom=u),p.panDelta!==void 0&&(c.drag=u),p.pitchDelta!==void 0&&(c.pitch=u),p.bearingDelta!==void 0&&(c.rotate=u)}_applyChanges(){let i={},c={},p={};for(let[m,b,u]of this._changes)m.panDelta&&(i.panDelta=(i.panDelta||new s.P(0,0))._add(m.panDelta)),m.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+m.zoomDelta),m.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+m.bearingDelta),m.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+m.pitchDelta),m.around!==void 0&&(i.around=m.around),m.pinchAround!==void 0&&(i.pinchAround=m.pinchAround),m.noInertia&&(i.noInertia=m.noInertia),s.e(c,b),s.e(p,u);this._updateMapTransform(i,c,p),this._changes=[]}_updateMapTransform(i,c,p){let m=this._map,b=m._getTransformForUpdate(),u=m.terrain;if(!(Ja(i)||u&&this._terrainMovement))return this._fireEvents(c,p,!0);let{panDelta:g,zoomDelta:y,bearingDelta:x,pitchDelta:k,around:E,pinchAround:R}=i;R!==void 0&&(E=R),m._stop(!0),E=E||m.transform.centerPoint;let P=b.pointLocation(g?E.sub(g):E);x&&(b.bearing+=x),k&&(b.pitch+=k),y&&(b.zoom+=y),u?this._terrainMovement||!c.drag&&!c.zoom?c.drag&&this._terrainMovement?b.center=b.pointLocation(b.centerPoint.sub(g)):b.setLocationAtPoint(P,E):(this._terrainMovement=!0,this._map._elevationFreeze=!0,b.setLocationAtPoint(P,E)):b.setLocationAtPoint(P,E),m._applyUpdatedTransform(b),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(c,p,!0)}_fireEvents(i,c,p){let m=po(this._eventsInProgress),b=po(i),u={};for(let E in i){let{originalEvent:R}=i[E];this._eventsInProgress[E]||(u[`${E}start`]=R),this._eventsInProgress[E]=i[E]}!m&&b&&this._fireEvent("movestart",b.originalEvent);for(let E in u)this._fireEvent(E,u[E]);b&&this._fireEvent("move",b.originalEvent);for(let E in i){let{originalEvent:R}=i[E];this._fireEvent(E,R)}let g={},y;for(let E in this._eventsInProgress){let{handlerName:R,originalEvent:P}=this._eventsInProgress[E];this._handlersById[R].isActive()||(delete this._eventsInProgress[E],y=c[R]||P,g[`${E}end`]=y)}for(let E in g)this._fireEvent(E,g[E]);let x=po(this._eventsInProgress),k=(m||b)&&!x;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;let E=this._map._getTransformForUpdate();E.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(E)}if(p&&k){this._updatingCamera=!0;let E=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),R=P=>P!==0&&-this._bearingSnap<P&&P<this._bearingSnap;!E||!E.essential&&_.prefersReducedMotion?(this._map.fire(new s.k("moveend",{originalEvent:y})),R(this._map.getBearing())&&this._map.resetNorth()):(R(E.bearing||this._map.getBearing())&&(E.bearing=0),E.freezeElevation=!0,this._map.easeTo(E,{originalEvent:y})),this._updatingCamera=!1}}_fireEvent(i,c){this._map.fire(new s.k(i,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new xc("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class wh extends s.E{constructor(i,c){super(),this._renderFrameCallback=()=>{let p=Math.min((_.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=c.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new s.N(this.transform.center.lng,this.transform.center.lat)}setCenter(i,c){return this.jumpTo({center:i},c)}panBy(i,c,p){return i=s.P.convert(i).mult(-1),this.panTo(this.transform.center,s.e({offset:i},c),p)}panTo(i,c,p){return this.easeTo(s.e({center:i},c),p)}getZoom(){return this.transform.zoom}setZoom(i,c){return this.jumpTo({zoom:i},c),this}zoomTo(i,c,p){return this.easeTo(s.e({zoom:i},c),p)}zoomIn(i,c){return this.zoomTo(this.getZoom()+1,i,c),this}zoomOut(i,c){return this.zoomTo(this.getZoom()-1,i,c),this}getBearing(){return this.transform.bearing}setBearing(i,c){return this.jumpTo({bearing:i},c),this}getPadding(){return this.transform.padding}setPadding(i,c){return this.jumpTo({padding:i},c),this}rotateTo(i,c,p){return this.easeTo(s.e({bearing:i},c),p)}resetNorth(i,c){return this.rotateTo(0,s.e({duration:1e3},i),c),this}resetNorthPitch(i,c){return this.easeTo(s.e({bearing:0,pitch:0,duration:1e3},i),c),this}snapToNorth(i,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,c):this}getPitch(){return this.transform.pitch}setPitch(i,c){return this.jumpTo({pitch:i},c),this}cameraForBounds(i,c){i=Kt.convert(i);let p=c&&c.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),p,c)}_cameraForBoxAndBearing(i,c,p,m){let b={top:0,bottom:0,right:0,left:0};if(typeof(m=s.e({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){let ue=m.padding;m.padding={top:ue,bottom:ue,right:ue,left:ue}}m.padding=s.e(b,m.padding);let u=this.transform,g=u.padding,y=new Kt(i,c),x=u.project(y.getNorthWest()),k=u.project(y.getNorthEast()),E=u.project(y.getSouthEast()),R=u.project(y.getSouthWest()),P=s.ba(-p),H=x.rotate(P),N=k.rotate(P),O=E.rotate(P),et=R.rotate(P),nt=new s.P(Math.max(H.x,N.x,et.x,O.x),Math.max(H.y,N.y,et.y,O.y)),Y=new s.P(Math.min(H.x,N.x,et.x,O.x),Math.min(H.y,N.y,et.y,O.y)),dt=nt.sub(Y),gt=(u.width-(g.left+g.right+m.padding.left+m.padding.right))/dt.x,ot=(u.height-(g.top+g.bottom+m.padding.top+m.padding.bottom))/dt.y;if(ot<0||gt<0)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");let pt=Math.min(u.scaleZoom(u.scale*Math.min(gt,ot)),m.maxZoom),Dt=s.P.convert(m.offset),$t=new s.P((m.padding.left-m.padding.right)/2,(m.padding.top-m.padding.bottom)/2).rotate(s.ba(p)),jt=Dt.add($t).mult(u.scale/u.zoomScale(pt));return{center:u.unproject(x.add(E).div(2).sub(jt)),zoom:pt,bearing:p}}fitBounds(i,c,p){return this._fitInternal(this.cameraForBounds(i,c),c,p)}fitScreenCoordinates(i,c,p,m,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.P.convert(i)),this.transform.pointLocation(s.P.convert(c)),p,m),m,b)}_fitInternal(i,c,p){return i?(delete(c=s.e(i,c)).padding,c.linear?this.easeTo(c,p):this.flyTo(c,p)):this}jumpTo(i,c){this.stop();let p=this._getTransformForUpdate(),m=!1,b=!1,u=!1;return"zoom"in i&&p.zoom!==+i.zoom&&(m=!0,p.zoom=+i.zoom),i.center!==void 0&&(p.center=s.N.convert(i.center)),"bearing"in i&&p.bearing!==+i.bearing&&(b=!0,p.bearing=+i.bearing),"pitch"in i&&p.pitch!==+i.pitch&&(u=!0,p.pitch=+i.pitch),i.padding==null||p.isPaddingEqual(i.padding)||(p.padding=i.padding),this._applyUpdatedTransform(p),this.fire(new s.k("movestart",c)).fire(new s.k("move",c)),m&&this.fire(new s.k("zoomstart",c)).fire(new s.k("zoom",c)).fire(new s.k("zoomend",c)),b&&this.fire(new s.k("rotatestart",c)).fire(new s.k("rotate",c)).fire(new s.k("rotateend",c)),u&&this.fire(new s.k("pitchstart",c)).fire(new s.k("pitch",c)).fire(new s.k("pitchend",c)),this.fire(new s.k("moveend",c))}calculateCameraOptionsFromTo(i,c,p,m=0){let b=s.Z.fromLngLat(i,c),u=s.Z.fromLngLat(p,m),g=u.x-b.x,y=u.y-b.y,x=u.z-b.z,k=Math.hypot(g,y,x);if(k===0)throw new Error("Can't calculate camera options with same From and To");let E=Math.hypot(g,y),R=this.transform.scaleZoom(this.transform.cameraToCenterDistance/k/this.transform.tileSize),P=180*Math.atan2(g,-y)/Math.PI,H=180*Math.acos(E/k)/Math.PI;return H=x<0?90-H:90+H,{center:u.toLngLat(),zoom:R,pitch:H,bearing:P}}easeTo(i,c){var p;this._stop(!1,i.easeId),((i=s.e({offset:[0,0],duration:500,easing:s.b9},i)).animate===!1||!i.essential&&_.prefersReducedMotion)&&(i.duration=0);let m=this._getTransformForUpdate(),b=m.zoom,u=m.bearing,g=m.pitch,y=m.padding,x="bearing"in i?this._normalizeBearing(i.bearing,u):u,k="pitch"in i?+i.pitch:g,E="padding"in i?i.padding:m.padding,R=s.P.convert(i.offset),P=m.centerPoint.add(R),H=m.pointLocation(P),{center:N,zoom:O}=m.getConstrained(s.N.convert(i.center||H),(p=i.zoom)!==null&&p!==void 0?p:b);this._normalizeCenter(N,m);let et=m.project(H),nt=m.project(N).sub(et),Y=m.zoomScale(O-b),dt,gt;i.around&&(dt=s.N.convert(i.around),gt=m.locationPoint(dt));let ot={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||O!==b,this._rotating=this._rotating||u!==x,this._pitching=this._pitching||k!==g,this._padding=!m.isPaddingEqual(E),this._easeId=i.easeId,this._prepareEase(c,i.noMoveStart,ot),this.terrain&&this._prepareElevation(N),this._ease(pt=>{if(this._zooming&&(m.zoom=s.z.number(b,O,pt)),this._rotating&&(m.bearing=s.z.number(u,x,pt)),this._pitching&&(m.pitch=s.z.number(g,k,pt)),this._padding&&(m.interpolatePadding(y,E,pt),P=m.centerPoint.add(R)),this.terrain&&!i.freezeElevation&&this._updateElevation(pt),dt)m.setLocationAtPoint(dt,gt);else{let Dt=m.zoomScale(m.zoom-b),$t=O>b?Math.min(2,Y):Math.max(.5,Y),jt=Math.pow($t,1-pt),ue=m.unproject(et.add(nt.mult(pt*jt)).mult(Dt));m.setLocationAtPoint(m.renderWorldCopies?ue.wrap():ue,P)}this._applyUpdatedTransform(m),this._fireMoveEvents(c)},pt=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(c,pt)},i),this}_prepareEase(i,c,p={}){this._moving=!0,c||p.moving||this.fire(new s.k("movestart",i)),this._zooming&&!p.zooming&&this.fire(new s.k("zoomstart",i)),this._rotating&&!p.rotating&&this.fire(new s.k("rotatestart",i)),this._pitching&&!p.pitching&&this.fire(new s.k("pitchstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let c=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&c!==this._elevationTarget){let p=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(p-(c-(p*i+this._elevationStart))/(1-i)),this._elevationTarget=c}this.transform.elevation=s.z.number(this._elevationStart,this._elevationTarget,i)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(i){let c=i.getCameraPosition(),p=this.terrain.getElevationForLngLatZoom(c.lngLat,i.zoom);if(c.altitude<p){let m=this.calculateCameraOptionsFromTo(c.lngLat,p,i.center,i.elevation);return{pitch:m.pitch,zoom:m.zoom}}return{}}_applyUpdatedTransform(i){let c=[];if(this.terrain&&c.push(m=>this._elevateCameraIfInsideTerrain(m)),this.transformCameraUpdate&&c.push(m=>this.transformCameraUpdate(m)),!c.length)return;let p=i.clone();for(let m of c){let b=p.clone(),{center:u,zoom:g,pitch:y,bearing:x,elevation:k}=m(b);u&&(b.center=u),g!==void 0&&(b.zoom=g),y!==void 0&&(b.pitch=y),x!==void 0&&(b.bearing=x),k!==void 0&&(b.elevation=k),p.apply(b)}this.transform.apply(p)}_fireMoveEvents(i){this.fire(new s.k("move",i)),this._zooming&&this.fire(new s.k("zoom",i)),this._rotating&&this.fire(new s.k("rotate",i)),this._pitching&&this.fire(new s.k("pitch",i))}_afterEase(i,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId;let p=this._zooming,m=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new s.k("zoomend",i)),m&&this.fire(new s.k("rotateend",i)),b&&this.fire(new s.k("pitchend",i)),this.fire(new s.k("moveend",i))}flyTo(i,c){var p;if(!i.essential&&_.prefersReducedMotion){let Ue=s.M(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ue,c)}this.stop(),i=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.b9},i);let m=this._getTransformForUpdate(),b=m.zoom,u=m.bearing,g=m.pitch,y=m.padding,x="bearing"in i?this._normalizeBearing(i.bearing,u):u,k="pitch"in i?+i.pitch:g,E="padding"in i?i.padding:m.padding,R=s.P.convert(i.offset),P=m.centerPoint.add(R),H=m.pointLocation(P),{center:N,zoom:O}=m.getConstrained(s.N.convert(i.center||H),(p=i.zoom)!==null&&p!==void 0?p:b);this._normalizeCenter(N,m);let et=m.zoomScale(O-b),nt=m.project(H),Y=m.project(N).sub(nt),dt=i.curve,gt=Math.max(m.width,m.height),ot=gt/et,pt=Y.mag();if("minZoom"in i){let Ue=s.ad(Math.min(i.minZoom,b,O),m.minZoom,m.maxZoom),$e=gt/m.zoomScale(Ue-b);dt=Math.sqrt($e/pt*2)}let Dt=dt*dt;function $t(Ue){let $e=(ot*ot-gt*gt+(Ue?-1:1)*Dt*Dt*pt*pt)/(2*(Ue?ot:gt)*Dt*pt);return Math.log(Math.sqrt($e*$e+1)-$e)}function jt(Ue){return(Math.exp(Ue)-Math.exp(-Ue))/2}function ue(Ue){return(Math.exp(Ue)+Math.exp(-Ue))/2}let ce=$t(!1),Fe=function(Ue){return ue(ce)/ue(ce+dt*Ue)},xe=function(Ue){return gt*((ue(ce)*(jt($e=ce+dt*Ue)/ue($e))-jt(ce))/Dt)/pt;var $e},ke=($t(!0)-ce)/dt;if(Math.abs(pt)<1e-6||!isFinite(ke)){if(Math.abs(gt-ot)<1e-6)return this.easeTo(i,c);let Ue=ot<gt?-1:1;ke=Math.abs(Math.log(ot/gt))/dt,xe=()=>0,Fe=$e=>Math.exp(Ue*dt*$e)}return i.duration="duration"in i?+i.duration:1e3*ke/("screenSpeed"in i?+i.screenSpeed/dt:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=u!==x,this._pitching=k!==g,this._padding=!m.isPaddingEqual(E),this._prepareEase(c,!1),this.terrain&&this._prepareElevation(N),this._ease(Ue=>{let $e=Ue*ke,Li=1/Fe($e);m.zoom=Ue===1?O:b+m.scaleZoom(Li),this._rotating&&(m.bearing=s.z.number(u,x,Ue)),this._pitching&&(m.pitch=s.z.number(g,k,Ue)),this._padding&&(m.interpolatePadding(y,E,Ue),P=m.centerPoint.add(R)),this.terrain&&!i.freezeElevation&&this._updateElevation(Ue);let pi=Ue===1?N:m.unproject(nt.add(Y.mult(xe($e))).mult(Li));m.setLocationAtPoint(m.renderWorldCopies?pi.wrap():pi,P),this._applyUpdatedTransform(m),this._fireMoveEvents(c)},()=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(c)},i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,c){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,c)}return i||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(i,c,p){p.animate===!1||p.duration===0?(i(1),c()):(this._easeStart=_.now(),this._easeOptions=p,this._onEaseFrame=i,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,c){i=s.b3(i,-180,180);let p=Math.abs(i-c);return Math.abs(i-360-c)<p&&(i-=360),Math.abs(i+360-c)<p&&(i+=360),i}_normalizeCenter(i,c){if(!c.renderWorldCopies||c.lngRange)return;let p=i.lng-c.center.lng;i.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(s.N.convert(i),this.transform.tileZoom)-this.transform.elevation:null}}let Nl={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class RA{constructor(i=Nl){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=c=>{!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options.compact,this._container=S.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=S.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=S.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){S.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,c){let p=this._map._getUIString(`AttributionControl.${c}`);i.title=p,i.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(m=>typeof m!="string"?"":m)):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){let m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}let c=this._map.style.sourceCaches;for(let m in c){let b=c[m];if(b.used||b.usedForTerrain){let u=b.getSource();u.attribution&&i.indexOf(u.attribution)<0&&i.push(u.attribution)}}i=i.filter(m=>String(m).trim()),i.sort((m,b)=>m.length-b.length),i=i.filter((m,b)=>{for(let u=b+1;u<i.length;u++)if(i[u].indexOf(m)>=0)return!1;return!0});let p=i.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,i.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Qo{constructor(i={}){this._updateCompact=()=>{let c=this._container.children;if(c.length){let p=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=S.create("div","maplibregl-ctrl");let c=S.create("a","maplibregl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://maplibre.org/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){S.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ai{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){let c=++this._id;return this._queue.push({callback:i,id:c,cancelled:!1}),c}remove(i){let c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(let m of p)if(m.id===i)return void(m.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let c=this._currentlyRunning=this._queue;this._queue=[];for(let p of c)if(!p.cancelled&&(p.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var cu=s.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Ro extends s.E{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,c){this.sourceCache.update(i,c),this._renderableTilesKeys=[];let p={};for(let m of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:c}))p[m.key]=!0,this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.posMatrix=new Float64Array(16),s.aQ(m.posMatrix,0,s.X,0,s.X,0,1),this._tiles[m.key]=new Gi(m,this.tileSize));for(let m in this._tiles)p[m]||delete this._tiles[m]}freeRtt(i){for(let c in this._tiles){let p=this._tiles[c];(!i||p.tileID.equals(i)||p.tileID.isChildOf(i)||i.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){let c={};for(let p of this._renderableTilesKeys){let m=this._tiles[p].tileID;if(m.canonical.equals(i.canonical)){let b=i.clone();b.posMatrix=new Float64Array(16),s.aQ(b.posMatrix,0,s.X,0,s.X,0,1),c[p]=b}else if(m.canonical.isChildOf(i.canonical)){let b=i.clone();b.posMatrix=new Float64Array(16);let u=m.canonical.z-i.canonical.z,g=m.canonical.x-(m.canonical.x>>u<<u),y=m.canonical.y-(m.canonical.y>>u<<u),x=s.X>>u;s.aQ(b.posMatrix,0,x,0,x,0,1),s.J(b.posMatrix,b.posMatrix,[-g*x,-y*x,0]),c[p]=b}else if(i.canonical.isChildOf(m.canonical)){let b=i.clone();b.posMatrix=new Float64Array(16);let u=i.canonical.z-m.canonical.z,g=i.canonical.x-(i.canonical.x>>u<<u),y=i.canonical.y-(i.canonical.y>>u<<u),x=s.X>>u;s.aQ(b.posMatrix,0,s.X,0,s.X,0,1),s.J(b.posMatrix,b.posMatrix,[g*x,y*x,0]),s.K(b.posMatrix,b.posMatrix,[1/2**u,1/2**u,0]),c[p]=b}}return c}getSourceTile(i,c){let p=this.sourceCache._source,m=i.overscaledZ-this.deltaZoom;if(m>p.maxzoom&&(m=p.maxzoom),m<p.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(m).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!b||!b.dem)&&c)for(;m>=p.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(i.scaledTo(m--).key);return b}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter(c=>c.timeAdded>=i)}}class Ds{constructor(i,c,p){this.painter=i,this.sourceCache=new Ro(c),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,c,p,m=s.X){var b;if(!(c>=0&&c<m&&p>=0&&p<m))return 0;let u=this.getTerrainData(i),g=(b=u.tile)===null||b===void 0?void 0:b.dem;if(!g)return 0;let y=function(H,N,O){var et=N[0],nt=N[1];return H[0]=O[0]*et+O[4]*nt+O[12],H[1]=O[1]*et+O[5]*nt+O[13],H}([],[c/m*s.X,p/m*s.X],u.u_terrain_matrix),x=[y[0]*g.dim,y[1]*g.dim],k=Math.floor(x[0]),E=Math.floor(x[1]),R=x[0]-k,P=x[1]-E;return g.get(k,E)*(1-R)*(1-P)+g.get(k+1,E)*R*(1-P)+g.get(k,E+1)*(1-R)*P+g.get(k+1,E+1)*R*P}getElevationForLngLatZoom(i,c){let{tileID:p,mercatorX:m,mercatorY:b}=this._getOverscaledTileIDFromLngLatZoom(i,c);return this.getElevation(p,m%s.X,b%s.X,s.X)}getElevation(i,c,p,m=s.X){return this.getDEMElevation(i,c,p,m)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){let m=this.painter.context,b=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Nt(m,b,m.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Nt(m,new s.R({width:1,height:1}),m.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.ao([])}let c=this.sourceCache.getSourceTile(i,!0);if(c&&c.dem&&(!c.demTexture||c.needsTerrainPrepare)){let m=this.painter.context;c.demTexture=this.painter.getTileTexture(c.dem.stride),c.demTexture?c.demTexture.update(c.dem.getPixels(),{premultiply:!1}):c.demTexture=new Nt(m,c.dem.getPixels(),m.gl.RGBA,{premultiply:!1}),c.demTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),c.needsTerrainPrepare=!1}let p=c&&c+c.tileID.key+i.key;if(p&&!this._demMatrixCache[p]){let m=this.sourceCache.sourceCache._source.maxzoom,b=i.canonical.z-c.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=m?b=i.canonical.z-m:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let u=i.canonical.x-(i.canonical.x>>b<<b),g=i.canonical.y-(i.canonical.y>>b<<b),y=s.bb(new Float64Array(16),[1/(s.X<<b),1/(s.X<<b),0]);s.J(y,y,[u*s.X,g*s.X,0]),this._demMatrixCache[i.key]={matrix:y,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:c&&c.dem&&c.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:c&&c.dem&&c.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(c&&c.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:c}}getFramebuffer(i){let c=this.painter,p=c.width/devicePixelRatio,m=c.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===m||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Nt(c.context,{width:p,height:m,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Nt(c.context,{width:p,height:m,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=c.context.createFramebuffer(p,m,!0,!1),this._fbo.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,p,m))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let c=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,u=0;b<this._coordsTextureSize;b++)for(let g=0;g<this._coordsTextureSize;g++,u+=4)c[u+0]=255&g,c[u+1]=255&b,c[u+2]=g>>8<<4|b>>8,c[u+3]=0;let p=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(c.buffer)),m=new Nt(i,p,i.gl.RGBA,{premultiply:!1});return m.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=m,m}pointCoordinate(i){this.painter.maybeDrawDepthAndCoords(!0);let c=new Uint8Array(4),p=this.painter.context,m=p.gl,b=Math.round(i.x*this.painter.pixelRatio/devicePixelRatio),u=Math.round(i.y*this.painter.pixelRatio/devicePixelRatio),g=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),m.readPixels(b,g-u-1,1,1,m.RGBA,m.UNSIGNED_BYTE,c),p.bindFramebuffer.set(null);let y=c[0]+(c[2]>>4<<8),x=c[1]+((15&c[2])<<8),k=this.coordsIndex[255-c[3]],E=k&&this.sourceCache.getTileByID(k);if(!E)return null;let R=this._coordsTextureSize,P=(1<<E.tileID.canonical.z)*R;return new s.Z((E.tileID.canonical.x*R+y)/P+E.tileID.wrap,(E.tileID.canonical.y*R+x)/P,this.getElevation(E.tileID,y,x,R))}depthAtPoint(i){let c=new Uint8Array(4),p=this.painter.context,m=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),m.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,m.RGBA,m.UNSIGNED_BYTE,c),p.bindFramebuffer.set(null),(c[0]/16777216+c[1]/65536+c[2]/256+c[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;let i=this.painter.context,c=new s.bc,p=new s.aY,m=this.meshSize,b=s.X/m,u=m*m;for(let E=0;E<=m;E++)for(let R=0;R<=m;R++)c.emplaceBack(R*b,E*b,0);for(let E=0;E<u;E+=m+1)for(let R=0;R<m;R++)p.emplaceBack(R+E,m+R+E+1,m+R+E+2),p.emplaceBack(R+E,m+R+E+2,R+E+1);let g=c.length,y=g+2*(m+1);for(let E of[0,1])for(let R=0;R<=m;R++)for(let P of[0,1])c.emplaceBack(R*b,E*s.X,P);for(let E=0;E<2*m;E+=2)p.emplaceBack(y+E,y+E+1,y+E+3),p.emplaceBack(y+E,y+E+3,y+E+2),p.emplaceBack(g+E,g+E+3,g+E+1),p.emplaceBack(g+E,g+E+2,g+E+3);let x=c.length,k=x+2*(m+1);for(let E of[0,1])for(let R=0;R<=m;R++)for(let P of[0,1])c.emplaceBack(E*s.X,R*b,P);for(let E=0;E<2*m;E+=2)p.emplaceBack(x+E,x+E+1,x+E+3),p.emplaceBack(x+E,x+E+3,x+E+2),p.emplaceBack(k+E,k+E+3,k+E+1),p.emplaceBack(k+E,k+E+2,k+E+3);return this._mesh=new bs(i.createVertexBuffer(c,cu.members),i.createIndexBuffer(p),s.a0.simpleSegment(0,0,c.length,p.length)),this._mesh}getMeshFrameDelta(i){return 2*Math.PI*s.bd/Math.pow(2,i)/5}getMinTileElevationForLngLatZoom(i,c){var p;let{tileID:m}=this._getOverscaledTileIDFromLngLatZoom(i,c);return(p=this.getMinMaxElevation(m).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(i){let c=this.getTerrainData(i).tile,p={minElevation:null,maxElevation:null};return c&&c.dem&&(p.minElevation=c.dem.min*this.exaggeration,p.maxElevation=c.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(i,c){let p=s.Z.fromLngLat(i.wrap()),m=(1<<c)*s.X,b=p.x*m,u=p.y*m,g=Math.floor(b/s.X),y=Math.floor(u/s.X);return{tileID:new s.S(c,0,c,g,y),mercatorX:b,mercatorY:u}}}class Fs{constructor(i,c,p){this._context=i,this._size=c,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){let c=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new Nt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),c.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),c.colorAttachment.set(p.texture),{id:i,fbo:c,texture:p,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(c=>i.id!==c),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(let c of this._recentlyUsed)if(!this._objects[c].inUse)return this._objects[c];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(let i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(i=>!i.inUse)===!1}}let Go={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Sc{constructor(i,c){this.painter=i,this.terrain=c,this.pool=new Fs(i.context,30,c.sourceCache.tileSize*c.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,c){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter(p=>!i._layers[p].isHidden(c)),this._coordsDescendingInv={};for(let p in i.sourceCaches){this._coordsDescendingInv[p]={};let m=i.sourceCaches[p].getVisibleCoordinates();for(let b of m){let u=this.terrain.sourceCache.getTerrainCoords(b);for(let g in u)this._coordsDescendingInv[p][g]||(this._coordsDescendingInv[p][g]=[]),this._coordsDescendingInv[p][g].push(u[g])}}this._coordsDescendingInvStr={};for(let p of i._order){let m=i._layers[p],b=m.source;if(Go[m.type]&&!this._coordsDescendingInvStr[b]){this._coordsDescendingInvStr[b]={};for(let u in this._coordsDescendingInv[b])this._coordsDescendingInvStr[b][u]=this._coordsDescendingInv[b][u].map(g=>g.key).sort().join()}}for(let p of this._renderableTiles)for(let m in this._coordsDescendingInvStr){let b=this._coordsDescendingInvStr[m][p.tileID.key];b&&b!==p.rttCoords[m]&&(p.rtt=[])}}renderLayer(i){if(i.isHidden(this.painter.transform.zoom))return!1;let c=i.type,p=this.painter,m=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if(Go[c]&&(this._prevType&&Go[this._prevType]||this._stacks.push([]),this._prevType=c,this._stacks[this._stacks.length-1].push(i.id),!m))return!0;if(Go[this._prevType]||Go[c]&&m){this._prevType=c;let b=this._stacks.length-1,u=this._stacks[b]||[];for(let g of this._renderableTiles){if(this.pool.isFull()&&(Hs(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(g),g.rtt[b]){let x=this.pool.getObjectForId(g.rtt[b].id);if(x.stamp===g.rtt[b].stamp){this.pool.useObject(x);continue}}let y=this.pool.getOrCreateFreeObject();this.pool.useObject(y),this.pool.stampObject(y),g.rtt[b]={id:y.id,stamp:y.stamp},p.context.bindFramebuffer.set(y.fbo.framebuffer),p.context.clear({color:s.aN.transparent,stencil:0}),p.currentStencilSource=void 0;for(let x=0;x<u.length;x++){let k=p.style._layers[u[x]],E=k.source?this._coordsDescendingInv[k.source][g.tileID.key]:[g.tileID];p.context.viewport.set([0,0,y.fbo.width,y.fbo.height]),p._renderTileClippingMasks(k,E),p.renderLayer(p,p.style.sourceCaches[k.source],k,E),k.source&&(g.rttCoords[k.source]=this._coordsDescendingInvStr[k.source][g.tileID.key])}}return Hs(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Go[c]}return!1}}let qe={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ls=d,Bh={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Nl,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},uu=v=>{v.touchstart=v.dragStart,v.touchmoveWindow=v.dragMove,v.touchend=v.dragEnd},Vl={showCompass:!0,showZoom:!0,visualizePitch:!1};class Fc{constructor(i,c,p=!1){this.mousedown=u=>{this.startMouse(s.e({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),S.mousePos(this.element,u)),S.addEventListener(window,"mousemove",this.mousemove),S.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=u=>{this.moveMouse(u,S.mousePos(this.element,u))},this.mouseup=u=>{this.mouseRotate.dragEnd(u),this.mousePitch&&this.mousePitch.dragEnd(u),this.offTemp()},this.touchstart=u=>{u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=S.touchPos(this.element,u.targetTouches)[0],this.startTouch(u,this._startPos),S.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.addEventListener(window,"touchend",this.touchend))},this.touchmove=u=>{u.targetTouches.length!==1?this.reset():(this._lastPos=S.touchPos(this.element,u.targetTouches)[0],this.moveTouch(u,this._lastPos))},this.touchend=u=>{u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;let m=i.dragRotate._mouseRotate.getClickTolerance(),b=i.dragRotate._mousePitch.getClickTolerance();this.element=c,this.mouseRotate=Al({clickTolerance:m,enable:!0}),this.touchRotate=(({enable:u,clickTolerance:g,bearingDegreesPerPixelMoved:y=.8})=>{let x=new al;return new Qr({clickTolerance:g,move:(k,E)=>({bearingDelta:(E.x-k.x)*y}),moveStateManager:x,enable:u,assignEvents:uu})})({clickTolerance:m,enable:!0}),this.map=i,p&&(this.mousePitch=Uo({clickTolerance:b,enable:!0}),this.touchPitch=(({enable:u,clickTolerance:g,pitchDegreesPerPixelMoved:y=-.5})=>{let x=new al;return new Qr({clickTolerance:g,move:(k,E)=>({pitchDelta:(E.y-k.y)*y}),moveStateManager:x,enable:u,assignEvents:uu})})({clickTolerance:b,enable:!0})),S.addEventListener(c,"mousedown",this.mousedown),S.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),S.addEventListener(c,"touchcancel",this.reset)}startMouse(i,c){this.mouseRotate.dragStart(i,c),this.mousePitch&&this.mousePitch.dragStart(i,c),S.disableDrag()}startTouch(i,c){this.touchRotate.dragStart(i,c),this.touchPitch&&this.touchPitch.dragStart(i,c),S.disableDrag()}moveMouse(i,c){let p=this.map,{bearingDelta:m}=this.mouseRotate.dragMove(i,c)||{};if(m&&p.setBearing(p.getBearing()+m),this.mousePitch){let{pitchDelta:b}=this.mousePitch.dragMove(i,c)||{};b&&p.setPitch(p.getPitch()+b)}}moveTouch(i,c){let p=this.map,{bearingDelta:m}=this.touchRotate.dragMove(i,c)||{};if(m&&p.setBearing(p.getBearing()+m),this.touchPitch){let{pitchDelta:b}=this.touchPitch.dragMove(i,c)||{};b&&p.setPitch(p.getPitch()+b)}}off(){let i=this.element;S.removeEventListener(i,"mousedown",this.mousedown),S.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend),S.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){S.enableDrag(),S.removeEventListener(window,"mousemove",this.mousemove),S.removeEventListener(window,"mouseup",this.mouseup),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend)}}let ia;function kc(v,i,c){let p=new s.N(v.lng,v.lat);if(v=new s.N(v.lng,v.lat),i){let m=new s.N(v.lng-360,v.lat),b=new s.N(v.lng+360,v.lat),u=c.locationPoint(v).distSqr(i);c.locationPoint(m).distSqr(i)<u?v=m:c.locationPoint(b).distSqr(i)<u&&(v=b)}for(;Math.abs(v.lng-c.center.lng)>180;){let m=c.locationPoint(v);if(m.x>=0&&m.y>=0&&m.x<=c.width&&m.y<=c.height)break;v.lng>c.center.lng?v.lng-=360:v.lng+=360}return v.lng!==p.lng&&c.locationPoint(v).y>c.height/2-c.getHorizon()?v:p}let Lc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function fo(v,i,c){let p=v.classList;for(let m in Lc)p.remove(`maplibregl-${c}-anchor-${m}`);p.add(`maplibregl-${c}-anchor-${i}`)}class vr extends s.E{constructor(i){if(super(),this._onKeyPress=c=>{let p=c.code,m=c.charCode||c.keyCode;p!=="Space"&&p!=="Enter"&&m!==32&&m!==13||this.togglePopup()},this._onMapClick=c=>{let p=c.originalEvent.target,m=this._element;this._popup&&(p===m||m.contains(p))&&this.togglePopup()},this._update=c=>{var p;if(!this._map)return;let m=this._map.loaded()&&!this._map.isMoving();(c?.type==="terrain"||c?.type==="render"&&!m)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?kc(this._lngLat,this._flatPos,this._map.transform):(p=this._lngLat)===null||p===void 0?void 0:p.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let b="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?b=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(b=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let u="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?u="rotateX(0deg)":this._pitchAlignment==="map"&&(u=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||c&&c.type!=="moveend"||(this._pos=this._pos.round()),S.setTransform(this._element,`${Lc[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${u} ${b}`),_.frameAsync(new AbortController).then(()=>{this._updateOpacity(c&&c.type==="moveend")}).catch(()=>{})},this._onMove=c=>{if(!this._isDragging){let p=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.k("dragstart"))),this.fire(new s.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.k("dragend")),this._state="inactive"},this._addDragHandler=c=>{this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._subpixelPositioning=i&&i.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(i?.opacity,i?.opacityWhenCovered),i&&i.element)this._element=i.element,this._offset=s.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=S.create("div");let c=S.createNS("http://www.w3.org/2000/svg","svg"),p=41,m=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${p}px`),c.setAttributeNS(null,"width",`${m}px`),c.setAttributeNS(null,"viewBox",`0 0 ${m} ${p}`);let b=S.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"stroke","none"),b.setAttributeNS(null,"stroke-width","1"),b.setAttributeNS(null,"fill","none"),b.setAttributeNS(null,"fill-rule","evenodd");let u=S.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill-rule","nonzero");let g=S.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(3.0, 29.0)"),g.setAttributeNS(null,"fill","#000000");let y=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let et of y){let nt=S.createNS("http://www.w3.org/2000/svg","ellipse");nt.setAttributeNS(null,"opacity","0.04"),nt.setAttributeNS(null,"cx","10.5"),nt.setAttributeNS(null,"cy","5.80029008"),nt.setAttributeNS(null,"rx",et.rx),nt.setAttributeNS(null,"ry",et.ry),g.appendChild(nt)}let x=S.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill",this._color);let k=S.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),x.appendChild(k);let E=S.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"opacity","0.25"),E.setAttributeNS(null,"fill","#000000");let R=S.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),E.appendChild(R);let P=S.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"transform","translate(6.0, 7.0)"),P.setAttributeNS(null,"fill","#FFFFFF");let H=S.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(8.0, 8.0)");let N=S.createNS("http://www.w3.org/2000/svg","circle");N.setAttributeNS(null,"fill","#000000"),N.setAttributeNS(null,"opacity","0.25"),N.setAttributeNS(null,"cx","5.5"),N.setAttributeNS(null,"cy","5.5"),N.setAttributeNS(null,"r","5.4999962");let O=S.createNS("http://www.w3.org/2000/svg","circle");O.setAttributeNS(null,"fill","#FFFFFF"),O.setAttributeNS(null,"cx","5.5"),O.setAttributeNS(null,"cy","5.5"),O.setAttributeNS(null,"r","5.4999962"),H.appendChild(N),H.appendChild(O),u.appendChild(g),u.appendChild(x),u.appendChild(E),u.appendChild(P),u.appendChild(H),c.appendChild(u),c.setAttributeNS(null,"height",p*this._scale+"px"),c.setAttributeNS(null,"width",m*this._scale+"px"),this._element.appendChild(c),this._offset=s.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),fo(this._element,this._anchor,"marker"),i&&i.className)for(let c of i.className.split(" "))this._element.classList.add(c);this._popup=null}addTo(i){return this.remove(),this._map=i,this._element.setAttribute("aria-label",i._getUIString("Marker.Title")),i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),S.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=s.N.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){let m=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(38.1-13.5+m)],"bottom-right":[-m,-1*(38.1-13.5+m)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(i){return this._subpixelPositioning=i,this}getPopup(){return this._popup}togglePopup(){let i=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:i?(i.isOpen()?i.remove():(i.setLngLat(this._lngLat),i.addTo(this._map)),this):this}_updateOpacity(i=!1){var c,p;if(!(!((c=this._map)===null||c===void 0)&&c.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(i)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let m=this._map,b=m.terrain.depthAtPoint(this._pos),u=m.terrain.getElevationForLngLatZoom(this._lngLat,m.transform.tileZoom);if(m.transform.lngLatToCameraDepth(this._lngLat,u)-b<.006)return void(this._element.style.opacity=this._opacity);let g=-this._offset.y/m.transform._pixelPerMeter,y=Math.sin(m.getPitch()*Math.PI/180)*g,x=m.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),k=m.transform.lngLatToCameraDepth(this._lngLat,u+y)-x>.006;((p=this._popup)===null||p===void 0?void 0:p.isOpen())&&k&&this._popup.remove(),this._element.style.opacity=k?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(i){return this._offset=s.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(i,c){return i===void 0&&c===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),i!==void 0&&(this._opacity=i),c!==void 0&&(this._opacityWhenCovered=c),this._map&&this._updateOpacity(!0),this}}let ka={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},La=0,Xa=!1,hu={maxWidth:100,unit:"metric"};function Dl(v,i,c){let p=c&&c.maxWidth||100,m=v._container.clientHeight/2,b=v.unproject([0,m]),u=v.unproject([p,m]),g=b.distanceTo(u);if(c&&c.unit==="imperial"){let y=3.2808*g;y>5280?hl(i,p,y/5280,v._getUIString("ScaleControl.Miles")):hl(i,p,y,v._getUIString("ScaleControl.Feet"))}else c&&c.unit==="nautical"?hl(i,p,g/1852,v._getUIString("ScaleControl.NauticalMiles")):g>=1e3?hl(i,p,g/1e3,v._getUIString("ScaleControl.Kilometers")):hl(i,p,g,v._getUIString("ScaleControl.Meters"))}function hl(v,i,c,p){let m=function(b){let u=Math.pow(10,`${Math.floor(b)}`.length-1),g=b/u;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(y){let x=Math.pow(10,Math.ceil(-Math.log(y)/Math.LN10));return Math.round(y*x)/x}(g),u*g}(c);v.style.width=i*(m/c)+"px",v.innerHTML=`${m}&nbsp;${p}`}let Zo={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Kl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function yi(v){if(v){if(typeof v=="number"){let i=Math.round(Math.abs(v)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,v),"top-left":new s.P(i,i),"top-right":new s.P(-i,i),bottom:new s.P(0,-v),"bottom-left":new s.P(i,-i),"bottom-right":new s.P(-i,-i),left:new s.P(v,0),right:new s.P(-v,0)}}if(v instanceof s.P||Array.isArray(v)){let i=s.P.convert(v);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:s.P.convert(v.center||[0,0]),top:s.P.convert(v.top||[0,0]),"top-left":s.P.convert(v["top-left"]||[0,0]),"top-right":s.P.convert(v["top-right"]||[0,0]),bottom:s.P.convert(v.bottom||[0,0]),"bottom-left":s.P.convert(v["bottom-left"]||[0,0]),"bottom-right":s.P.convert(v["bottom-right"]||[0,0]),left:s.P.convert(v.left||[0,0]),right:s.P.convert(v.right||[0,0])}}return yi(new s.P(0,0))}let Zi=d;A.AJAXError=s.bg,A.Evented=s.E,A.LngLat=s.N,A.MercatorCoordinate=s.Z,A.Point=s.P,A.addProtocol=s.bh,A.config=s.a,A.removeProtocol=s.bi,A.AttributionControl=RA,A.BoxZoomHandler=co,A.CanvasSource=ri,A.CooperativeGesturesHandler=go,A.DoubleClickZoomHandler=Bc,A.DragPanHandler=Vs,A.DragRotateHandler=ho,A.EdgeInsets=Ns,A.FullscreenControl=class extends s.E{constructor(v={}){super(),this._onFullscreenChange=()=>{var i;let c=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((i=c?.shadowRoot)===null||i===void 0)&&i.fullscreenElement;)c=c.shadowRoot.fullscreenElement;c===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){S.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let v=this._fullscreenButton=S.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);S.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},A.GeoJSONSource=Qe,A.GeolocateControl=class extends s.E{constructor(v){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new s.k("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.k("geolocate",i)),this._finish()}},this._updateCamera=i=>{let c=new s.N(i.coords.longitude,i.coords.latitude),p=i.coords.accuracy,m=this._map.getBearing(),b=s.e({bearing:m},this.options.fitBoundsOptions),u=Kt.fromLngLat(c,p);this._map.fitBounds(u,b,{geolocateSource:!0})},this._updateMarker=i=>{if(i){let c=new s.N(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&Xa)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.k("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=S.create("button","maplibregl-ctrl-geolocate",this._container),S.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=i=>{if(this._map){if(i===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");let c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{let c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=S.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new vr({element:this._dotElement}),this._circleElement=S.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new vr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.k("trackuserlocationend")),this.fire(new s.k("userlocationlostfocus")))})}},this.options=s.e({},ka,v)}onAdd(v){return this._map=v,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(i=!1){if(ia!==void 0&&!i)return ia;if(window.navigator.permissions===void 0)return ia=!!window.navigator.geolocation,ia;try{ia=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ia=!!window.navigator.geolocation}return ia})}().then(i=>this._finishSetupUI(i)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),S.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,La=0,Xa=!1}_isOutOfMapMaxBounds(v){let i=this._map.getMaxBounds(),c=v.coords;return i&&(c.longitude<i.getWest()||c.longitude>i.getEast()||c.latitude<i.getSouth()||c.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let v=this._map.getBounds(),i=v.getSouthEast(),c=v.getNorthEast(),p=i.distanceTo(c),m=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":La--,Xa=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.k("trackuserlocationstart")),this.fire(new s.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),La++,La>1?(v={maximumAge:6e5,timeout:0},Xa=!0):(v=this.options.positionOptions,Xa=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},A.Hash=ta,A.ImageSource=ze,A.KeyboardHandler=ll,A.LngLatBounds=Kt,A.LogoControl=Qo,A.Map=class extends wh{constructor(v){s.be.mark(s.bf.create);let i=Object.assign(Object.assign({},Bh),v);if(i.minZoom!=null&&i.maxZoom!=null&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(i.minPitch!=null&&i.maxPitch!=null&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(i.minPitch!=null&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(i.maxPitch!=null&&i.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ws(i.minZoom,i.maxZoom,i.minPitch,i.maxPitch,i.renderWorldCopies),{bearingSnap:i.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ai,this._controls=[],this._mapId=s.a4(),this._contextLost=c=>{c.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.k("webglcontextlost",{originalEvent:c}))},this._contextRestored=c=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.k("webglcontextrestored",{originalEvent:c}))},this._onMapScroll=c=>{if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=i.interactive,this._maxTileCacheSize=i.maxTileCacheSize,this._maxTileCacheZoomLevels=i.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=i.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=i.preserveDrawingBuffer===!0,this._antialias=i.antialias===!0,this._trackResize=i.trackResize===!0,this._bearingSnap=i.bearingSnap,this._refreshExpiredTiles=i.refreshExpiredTiles===!0,this._fadeDuration=i.fadeDuration,this._crossSourceCollisions=i.crossSourceCollisions===!0,this._collectResourceTiming=i.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},qe),i.locale),this._clickTolerance=i.clickTolerance,this._overridePixelRatio=i.pixelRatio,this._maxCanvasSize=i.maxCanvasSize,this.transformCameraUpdate=i.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=i.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=z.addThrottleControl(()=>this.isMoving()),this._requestManager=new it(i.transformRequest),typeof i.container=="string"){if(this._container=document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container}' not found.`)}else{if(!(i.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(i.maxBounds&&this.setMaxBounds(i.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let c=!1,p=$o(m=>{this._trackResize&&!this._removed&&this.resize(m)._update()},50);this._resizeObserver=new ResizeObserver(m=>{c?p(m):c=!0}),this._resizeObserver.observe(this._container)}this.handlers=new vh(this,i),this._hash=i.hash&&new ta(typeof i.hash=="string"&&i.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch}),i.bounds&&(this.resize(),this.fitBounds(i.bounds,s.e({},i.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=i.localIdeographFontFamily,this._validateStyle=i.validateStyle,i.style&&this.setStyle(i.style,{localIdeographFontFamily:i.localIdeographFontFamily}),i.attributionControl&&this.addControl(new RA(typeof i.attributionControl=="boolean"?void 0:i.attributionControl)),i.maplibreLogo&&this.addControl(new Qo,i.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new s.k(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new s.k(`${c.dataType}dataloading`,c))}),this.on("dataabort",c=>{this.fire(new s.k("sourcedataabort",c))})}_getMapId(){return this._mapId}addControl(v,i){if(i===void 0&&(i=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new s.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let c=v.onAdd(this);this._controls.push(v);let p=this._controlPositions[i];return i.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new s.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let i=this._controls.indexOf(v);return i>-1&&this._controls.splice(i,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}calculateCameraOptionsFromTo(v,i,c,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(c,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,i,c,p)}resize(v){var i;let c=this._containerDimensions(),p=c[0],m=c[1],b=this._getClampedPixelRatio(p,m);if(this._resizeCanvas(p,m,b),this.painter.resize(p,m,b),this.painter.overLimit()){let g=this.painter.context.gl;this._maxCanvasSize=[g.drawingBufferWidth,g.drawingBufferHeight];let y=this._getClampedPixelRatio(p,m);this._resizeCanvas(p,m,y),this.painter.resize(p,m,y)}this.transform.resize(p,m),(i=this._requestedCameraState)===null||i===void 0||i.resize(p,m);let u=!this._moving;return u&&(this.stop(),this.fire(new s.k("movestart",v)).fire(new s.k("move",v))),this.fire(new s.k("resize",v)),u&&this.fire(new s.k("moveend",v)),this}_getClampedPixelRatio(v,i){let{0:c,1:p}=this._maxCanvasSize,m=this.getPixelRatio(),b=v*m,u=i*m;return Math.min(b>c?c/b:1,u>p?p/u:1)*m}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(Kt.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this._update()}project(v){return this.transform.locationPoint(s.N.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.pointLocation(s.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,i,c){if(v==="mouseenter"||v==="mouseover"){let p=!1;return{layer:i,listener:c,delegates:{mousemove:b=>{let u=this.getLayer(i)?this.queryRenderedFeatures(b.point,{layers:[i]}):[];u.length?p||(p=!0,c.call(this,new Vr(v,this,b.originalEvent,{features:u}))):p=!1},mouseout:()=>{p=!1}}}}if(v==="mouseleave"||v==="mouseout"){let p=!1;return{layer:i,listener:c,delegates:{mousemove:u=>{(this.getLayer(i)?this.queryRenderedFeatures(u.point,{layers:[i]}):[]).length?p=!0:p&&(p=!1,c.call(this,new Vr(v,this,u.originalEvent)))},mouseout:u=>{p&&(p=!1,c.call(this,new Vr(v,this,u.originalEvent)))}}}}{let p=m=>{let b=this.getLayer(i)?this.queryRenderedFeatures(m.point,{layers:[i]}):[];b.length&&(m.features=b,c.call(this,m),delete m.features)};return{layer:i,listener:c,delegates:{[v]:p}}}}on(v,i,c){if(c===void 0)return super.on(v,i);let p=this._createDelegatedListener(v,i,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(p);for(let m in p.delegates)this.on(m,p.delegates[m]);return this}once(v,i,c){if(c===void 0)return super.once(v,i);let p=this._createDelegatedListener(v,i,c);for(let m in p.delegates)this.once(m,p.delegates[m]);return this}off(v,i,c){return c===void 0?super.off(v,i):(this._delegatedListeners&&this._delegatedListeners[v]&&(p=>{let m=this._delegatedListeners[v];for(let b=0;b<m.length;b++){let u=m[b];if(u.layer===i&&u.listener===c){for(let g in u.delegates)this.off(g,u.delegates[g]);return m.splice(b,1),this}}})(),this)}queryRenderedFeatures(v,i){if(!this.style)return[];let c,p=v instanceof s.P||Array.isArray(v),m=p?v:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(p?{}:v)||{},m instanceof s.P||typeof m[0]=="number")c=[s.P.convert(m)];else{let b=s.P.convert(m[0]),u=s.P.convert(m[1]);c=[b,new s.P(u.x,b.y),u,new s.P(b.x,u.y),b]}return this.style.queryRenderedFeatures(c,i,this.transform)}querySourceFeatures(v,i){return this.style.querySourceFeatures(v,i)}setStyle(v,i){return(i=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(v,i))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){let i=this._locale[v];if(i==null)throw new Error(`Missing UI string '${v}'`);return i}_updateStyle(v,i){if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,i));let c=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new ht(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,i,c):this.style.loadJSON(v,i,c),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ht(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,i){if(typeof v=="string"){let c=this._requestManager.transformRequest(v,"Style");s.h(c,new AbortController).then(p=>{this._updateDiff(p.data,i)}).catch(p=>{p&&this.fire(new s.j(p))})}else typeof v=="object"&&this._updateDiff(v,i)}_updateDiff(v,i){try{this.style.setState(v,i)&&this._update(!0)}catch(c){s.w(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(v,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(v,i){return this._lazyInitEmptyStyle(),this.style.addSource(v,i),this._update(!0)}isSourceLoaded(v){let i=this.style&&this.style.sourceCaches[v];if(i!==void 0)return i.loaded();this.fire(new s.j(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){let i=this.style.sourceCaches[v.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);this.terrain===null&&i.reload();for(let c in this.style._layers){let p=this.style._layers[c];p.type==="hillshade"&&p.source===v.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ds(this.painter,i,v),this.painter.renderToTexture=new Sc(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=c=>{c.dataType==="style"?this.terrain.sourceCache.freeRtt():c.dataType==="source"&&c.tile&&(c.sourceId!==v.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(c.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new s.k("terrain",{terrain:v})),this}getTerrain(){var v,i;return(i=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&i!==void 0?i:null}areTilesLoaded(){let v=this.style&&this.style.sourceCaches;for(let i in v){let c=v[i]._tiles;for(let p in c){let m=c[p];if(m.state!=="loaded"&&m.state!=="errored")return!1}}return!0}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,i,c={}){let{pixelRatio:p=1,sdf:m=!1,stretchX:b,stretchY:u,content:g,textFitWidth:y,textFitHeight:x}=c;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||s.b(i))){if(i.width===void 0||i.height===void 0)return this.fire(new s.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:k,height:E,data:R}=i,P=i;return this.style.addImage(v,{data:new s.R({width:k,height:E},new Uint8Array(R)),pixelRatio:p,stretchX:b,stretchY:u,content:g,textFitWidth:y,textFitHeight:x,sdf:m,version:0,userImage:P}),P.onAdd&&P.onAdd(this,v),this}}{let{width:k,height:E,data:R}=_.getImageData(i);this.style.addImage(v,{data:new s.R({width:k,height:E},R),pixelRatio:p,stretchX:b,stretchY:u,content:g,textFitWidth:y,textFitHeight:x,sdf:m,version:0})}}updateImage(v,i){let c=this.style.getImage(v);if(!c)return this.fire(new s.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let p=i instanceof HTMLImageElement||s.b(i)?_.getImageData(i):i,{width:m,height:b,data:u}=p;if(m===void 0||b===void 0)return this.fire(new s.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(m!==c.data.width||b!==c.data.height)return this.fire(new s.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));let g=!(i instanceof HTMLImageElement||s.b(i));return c.data.replace(u,g),this.style.updateImage(v,c),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new s.j(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v){return z.getImage(this._requestManager.transformRequest(v,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(v,i){return this._lazyInitEmptyStyle(),this.style.addLayer(v,i),this._update(!0)}moveLayer(v,i){return this.style.moveLayer(v,i),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,i,c){return this.style.setLayerZoomRange(v,i,c),this._update(!0)}setFilter(v,i,c={}){return this.style.setFilter(v,i,c),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,i,c,p={}){return this.style.setPaintProperty(v,i,c,p),this._update(!0)}getPaintProperty(v,i){return this.style.getPaintProperty(v,i)}setLayoutProperty(v,i,c,p={}){return this.style.setLayoutProperty(v,i,c,p),this._update(!0)}getLayoutProperty(v,i){return this.style.getLayoutProperty(v,i)}setGlyphs(v,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,i,c={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,i,c,p=>{p||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,i,c=>{c||this._update(!0)}),this}setLight(v,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,i),this._update(!0)}getLight(){return this.style.getLight()}setSky(v){return this._lazyInitEmptyStyle(),this.style.setSky(v),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(v,i){return this.style.setFeatureState(v,i),this._update()}removeFeatureState(v,i){return this.style.removeFeatureState(v,i),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,i=0;return this._container&&(v=this._container.clientWidth||400,i=this._container.clientHeight||300),[v,i]}_setupContainer(){let v=this._container;v.classList.add("maplibregl-map");let i=this._canvasContainer=S.create("div","maplibregl-canvas-container",v);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=S.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");let c=this._containerDimensions(),p=this._getClampedPixelRatio(c[0],c[1]);this._resizeCanvas(c[0],c[1],p);let m=this._controlContainer=S.create("div","maplibregl-control-container",v),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(u=>{b[u]=S.create("div",`maplibregl-ctrl-${u} `,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,i,c){this._canvas.width=Math.floor(c*v),this._canvas.height=Math.floor(c*i),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${i}px`}_setupPainter(){let v={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},i=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{i={requestedAttributes:v},p&&(i.statusMessage=p.statusMessage,i.type=p.type)},{once:!0});let c=this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v);if(!c){let p="Failed to initialize WebGL";throw i?(i.message=p,new Error(JSON.stringify(i))):new Error(p)}this.painter=new Ms(c,this.transform),U.testSupport(c)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){let i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let c=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let m=this.transform.zoom,b=_.now();this.style.zoomHistory.update(m,b);let u=new s.a9(m,{now:b,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),g=u.crossFadingFactor();g===1&&g===this._crossFadingFactor||(c=!0,this._crossFadingFactor=g),this.style.update(u)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new s.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.be.mark(s.bf.load),this.fire(new s.k("load"))),this.style&&(this.style.hasTransitions()||c)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.k("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,s.be.mark(s.bf.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(let c of this._controls)c.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),z.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();let i=this.painter.context.gl.getExtension("WEBGL_lose_context");i?.loseContext&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),S.remove(this._canvasContainer),S.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),s.be.clearMetrics(),this._removed=!0,this.fire(new s.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,_.frameAsync(this._frameRequest).then(v=>{s.be.frame(v),this._frameRequest=null,this._render(v)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return ls}getCameraTargetElevation(){return this.transform.elevation}},A.MapMouseEvent=Vr,A.MapTouchEvent=xs,A.MapWheelEvent=kr,A.Marker=vr,A.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{let i=this._map.getZoom(),c=i===this._map.getMaxZoom(),p=i===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{let i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=i},this._setButtonTitle=(i,c)=>{let p=this._map._getUIString(`NavigationControl.${c}`);i.title=p,i.setAttribute("aria-label",p)},this.options=s.e({},Vl,v),this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),S.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),S.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=S.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Fc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){S.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,i){let c=S.create("button",v,this._container);return c.type="button",c.addEventListener("click",i),c}},A.Popup=class extends s.E{constructor(v){super(),this.remove=()=>(this._content&&S.remove(this._content),this._container&&(S.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.k("close"))),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{var c;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=S.create("div","maplibregl-popup",this._map.getContainer()),this._tip=S.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let g of this.options.className.split(" "))this._container.classList.add(g);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?kc(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._trackPointer&&!i)return;let p=this._flatPos=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&i?i:this._map.transform.locationPoint(this._lngLat));let m=this.options.anchor,b=yi(this.options.offset);if(!m){let g=this._container.offsetWidth,y=this._container.offsetHeight,x;x=p.y+b.bottom.y<y?["top"]:p.y>this._map.transform.height-y?["bottom"]:[],p.x<g/2?x.push("left"):p.x>this._map.transform.width-g/2&&x.push("right"),m=x.length===0?"bottom":x.join("-")}let u=p.add(b[m]);this.options.subpixelPositioning||(u=u.round()),S.setTransform(this._container,`${Lc[m]} translate(${u.x}px,${u.y}px)`),fo(this._container,m,"popup")},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(Zo),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=s.N.convert(v),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){let i=document.createDocumentFragment(),c=document.createElement("body"),p;for(c.innerHTML=v;p=c.firstChild,p;)i.appendChild(p);return this.setDOMContent(i)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=S.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){return this._container&&this._container.classList.add(v),this}removeClassName(v){return this._container&&this._container.classList.remove(v),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}setSubpixelPositioning(v){this.options.subpixelPositioning=v}_createCloseButton(){this.options.closeButton&&(this._closeButton=S.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let v=this._container.querySelector(Kl);v&&v.focus()}},A.RasterDEMTileSource=Oe,A.RasterTileSource=Ye,A.ScaleControl=class{constructor(v){this._onMove=()=>{Dl(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,Dl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},hu),v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){S.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},A.ScrollZoomHandler=wc,A.Style=ht,A.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=v}onAdd(v){return this._map=v,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=S.create("button","maplibregl-ctrl-terrain",this._container),S.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){S.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},A.TwoFingersTouchPitchHandler=Hl,A.TwoFingersTouchRotateHandler=UA,A.TwoFingersTouchZoomHandler=Pl,A.TwoFingersTouchZoomRotateHandler=_c,A.VectorTileSource=Ut,A.VideoSource=We,A.addSourceType=(v,i)=>s._(void 0,void 0,void 0,function*(){if(Ti(v))throw new Error(`A source type called "${v}" already exists.`);((c,p)=>{hi[c]=p})(v,i)}),A.clearPrewarmedResources=function(){let v=Qt;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(j),Qt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},A.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},A.getRTLTextPluginStatus=function(){return mi().getRTLTextPluginStatus()},A.getVersion=function(){return Zi},A.getWorkerCount=function(){return mt.workerCount},A.getWorkerUrl=function(){return s.a.WORKER_URL},A.importScriptInWorkers=function(v){return de().broadcast("IS",v)},A.prewarm=function(){ae().acquire(j)},A.setMaxParallelImageRequests=function(v){s.a.MAX_PARALLEL_IMAGE_REQUESTS=v},A.setRTLTextPlugin=function(v,i){return mi().setRTLTextPlugin(v,i)},A.setWorkerCount=function(v){mt.workerCount=v},A.setWorkerUrl=function(v){s.a.WORKER_URL=v}});var o=n;return o})});var xb=ua((_d,xd)=>{(function(n,t){typeof _d=="object"&&typeof xd<"u"?t(_d):typeof define=="function"&&define.amd?define(["exports"],t):t((n=typeof globalThis<"u"?globalThis:n||self).VectorTextProtocol={})})(_d,function(n){"use strict";function t(ht){return ht&&ht.__esModule&&Object.prototype.hasOwnProperty.call(ht,"default")?ht.default:ht}function r(ht){if(ht.__esModule)return ht;var Ct=ht.default;if(typeof Ct=="function"){var ct=function bt(){return this instanceof bt?Reflect.construct(Ct,arguments,this.constructor):Ct.apply(this,arguments)};ct.prototype=Ct.prototype}else ct={};return Object.defineProperty(ct,"__esModule",{value:!0}),Object.keys(ht).forEach(function(bt){var Pt=Object.getOwnPropertyDescriptor(ht,bt);Object.defineProperty(ct,bt,Pt.get?Pt:{enumerable:!0,get:function(){return ht[bt]}})}),ct}function o(ht){return new Function("d","return {"+ht.map(function(Ct,ct){return JSON.stringify(Ct)+": d["+ct+"]"}).join(",")+"}")}function A(ht){var Ct=new RegExp('["'+ht+`
]`),ct=ht.charCodeAt(0);function bt(re,_e){var Be,Ie,ne={},ye={},ve=[],Ge=re.length,Ri=0,Qi=0;function He(){if(Ri>=Ge)return ye;if(Ie)return Ie=!1,ne;var si,ci=Ri;if(re.charCodeAt(ci)===34){for(var Fi=ci;Fi++<Ge;)if(re.charCodeAt(Fi)===34){if(re.charCodeAt(Fi+1)!==34)break;++Fi}return Ri=Fi+2,(si=re.charCodeAt(Fi+1))===13?(Ie=!0,re.charCodeAt(Fi+2)===10&&++Ri):si===10&&(Ie=!0),re.slice(ci+1,Fi).replace(/""/g,'"')}for(;Ri<Ge;){var lr=1;if((si=re.charCodeAt(Ri++))===10)Ie=!0;else if(si===13)Ie=!0,re.charCodeAt(Ri)===10&&(++Ri,++lr);else if(si!==ct)continue;return re.slice(ci,Ri-lr)}return re.slice(ci)}for(;(Be=He())!==ye;){for(var Ee=[];Be!==ne&&Be!==ye;)Ee.push(Be),Be=He();_e&&(Ee=_e(Ee,Qi++))==null||ve.push(Ee)}return ve}function Pt(re){return re.map(Jt).join(ht)}function Jt(re){return re==null?"":Ct.test(re+="")?'"'+re.replace(/\"/g,'""')+'"':re}return{parse:function(re,_e){var Be,Ie,ne=bt(re,function(ye,ve){if(Be)return Be(ye,ve-1);Ie=ye,Be=_e?function(Ge,Ri){var Qi=o(Ge);return function(He,Ee){return Ri(Qi(He),Ee,Ge)}}(ye,_e):o(ye)});return ne.columns=Ie,ne},parseRows:bt,format:function(re,_e){return _e==null&&(_e=function(Be){var Ie=Object.create(null),ne=[];return Be.forEach(function(ye){for(var ve in ye)ve in Ie||ne.push(Ie[ve]=ve)}),ne}(re)),[_e.map(Jt).join(ht)].concat(re.map(function(Be){return _e.map(function(Ie){return Jt(Be[Ie])}).join(ht)})).join(`
`)},formatRows:function(re){return re.map(Pt).join(`
`)}}}var s=A(","),d=s.parse,f=s.parseRows,I=s.format,_=s.formatRows,S=A("	"),U=S.parse,G=S.parseRows,L=S.format,K=S.formatRows,V=r(Object.freeze({__proto__:null,csvFormat:I,csvFormatRows:_,csvParse:d,csvParseRows:f,dsvFormat:A,tsvFormat:L,tsvFormatRows:K,tsvParse:U,tsvParseRows:G})),q={exports:{}};function z(ht,Ct){var ct=it(ht,Ct);return ct.whole+"\xB0 "+(ct.minutes?ct.minutes+"' ":"")+(ct.seconds?ct.seconds+'" ':"")+ct.dir}function it(ht,Ct){var ct=({lat:["N","S"],lon:["E","W"]}[Ct]||"")[ht>=0?0:1],bt=Math.abs(ht),Pt=Math.floor(bt),Jt=60*(bt-Pt),re=Math.floor(Jt);return{whole:Pt,minutes:re,seconds:Math.floor(60*(Jt-re)),dir:ct}}function At(ht,Ct){if(Ct||(Ct="NSEW"),typeof ht!="string")return null;var ct=(ht=ht.toUpperCase()).match(/^[\s\,]*([NSEW])?\s*([\-|—|―]?[0-9.]+)[°º˚]?\s*(?:([0-9.]+)['’′‘]\s*)?(?:([0-9.]+)(?:''|"|”|″)\s*)?([NSEW])?/);if(!ct)return null;var bt,Pt=ct[0];if(ct[1]&&ct[5]?(bt=ct[1],Pt=Pt.slice(0,-1)):bt=ct[1]||ct[5],bt&&Ct.indexOf(bt)===-1)return null;var Jt=ct[2]?parseFloat(ct[2]):0,re=ct[3]?parseFloat(ct[3])/60:0,_e=ct[4]?parseFloat(ct[4])/3600:0,Be=Jt<0?-1:1;return bt!=="S"&&bt!=="W"||(Be*=-1),{val:(Math.abs(Jt)+re+_e)*Be,dim:bt,matched:Pt,remain:ht.slice(Pt.length)}}q.exports=function(ht,Ct){var ct=At(ht,Ct);return ct===null?null:ct.val},q.exports.pair=function(ht,Ct){var ct=At(ht=ht.trim(),Ct);if(!ct)return null;var bt=At(ht=ct.remain.trim(),Ct);return!bt||bt.remain?null:ct.dim?function(Pt,Jt,re){if(re==="N"||re==="S")return[Pt,Jt];if(re==="W"||re==="E")return[Jt,Pt]}(ct.val,bt.val,ct.dim):[ct.val,bt.val]},q.exports.format=z,q.exports.formatPair=function(ht){return z(ht.lat,"lat")+" "+z(ht.lon,"lon")},q.exports.coordToDMS=it;var _t=q.exports,Lt=V,Et=_t,xt=/(Lat)(itude)?/gi,It=/(L)(on|ng)(gitude)?/i;function Nt(ht,Ct){var ct,bt,Pt;for(var Jt in ht)(bt=Jt.match(Ct))&&(!ct||bt[0].length/Jt.length>Pt)&&(Pt=bt[0].length/Jt.length,ct=Jt);return ct}function ie(ht){return Nt(ht,xt)}function lt(ht){return Nt(ht,It)}function at(ht){return typeof ht=="object"?Object.keys(ht).length:0}function St(ht){var Ct=[];return[",",";","	","|"].forEach(function(ct){var bt=Lt.dsvFormat(ct).parse(ht);if(bt.length>=1){for(var Pt=at(bt[0]),Jt=0;Jt<bt.length;Jt++)if(at(bt[Jt])!==Pt)return;Ct.push({delimiter:ct,arity:Object.keys(bt[0]).length})}}),Ct.length?Ct.sort(function(ct,bt){return bt.arity-ct.arity})[0].delimiter:null}var Bt={isLon:function(ht){return!!ht.match(It)},isLat:function(ht){return!!ht.match(xt)},guessLatHeader:ie,guessLonHeader:lt,csv:Lt.csvParse,tsv:Lt.tsvParse,dsv:Lt,auto:function(ht){var Ct=St(ht);return Ct?function(ct){return delete ct.columns,ct}(Lt.dsvFormat(Ct).parse(ht)):null},csv2geojson:function(ht,Ct,ct){ct||(ct=Ct,Ct={}),Ct.delimiter=Ct.delimiter||",";var bt=Ct.latfield||"",Pt=Ct.lonfield||"",Jt=Ct.crs||"",re=[],_e={type:"FeatureCollection",features:re};if(Jt!==""&&(_e.crs={type:"name",properties:{name:Jt}}),Ct.delimiter!=="auto"||typeof ht!="string"||(Ct.delimiter=St(ht),Ct.delimiter)){var Be=Ct.numericFields?Ct.numericFields.split(","):null,Ie=typeof ht=="string"?Lt.dsvFormat(Ct.delimiter).parse(ht,function(Ee){if(Be)for(var si in Ee)Be.includes(si)&&(Ee[si]=+Ee[si]);return Ee}):ht;if(Ie.length){var ne,ye=[];if(bt||(bt=ie(Ie[0])),Pt||(Pt=lt(Ie[0])),!bt||!Pt){for(ne=0;ne<Ie.length;ne++)re.push({type:"Feature",properties:Ie[ne],geometry:null});ct(ye.length?ye:null,_e)}else{for(ne=0;ne<Ie.length;ne++)if(Ie[ne][Pt]!==void 0&&Ie[ne][bt]!==void 0){var ve,Ge,Ri,Qi=Ie[ne][Pt],He=Ie[ne][bt];(Ri=Et(Qi,"EW"))&&(Qi=Ri),(Ri=Et(He,"NS"))&&(He=Ri),ve=parseFloat(Qi),Ge=parseFloat(He),isNaN(ve)||isNaN(Ge)?ye.push({message:"A row contained an invalid value for latitude or longitude",row:Ie[ne],index:ne}):(Ct.includeLatLon||(delete Ie[ne][Pt],delete Ie[ne][bt]),re.push({type:"Feature",properties:Ie[ne],geometry:{type:"Point",coordinates:[parseFloat(ve),parseFloat(Ge)]}}))}ct(ye.length?ye:null,_e)}}else ct(null,_e)}else ct({type:"Error",message:"Could not autodetect delimiter"})},toLine:function(ht){for(var Ct=ht.features,ct={type:"Feature",geometry:{type:"LineString",coordinates:[]}},bt=0;bt<Ct.length;bt++)ct.geometry.coordinates.push(Ct[bt].geometry.coordinates);return ct.properties=Ct.reduce(function(Pt,Jt){for(var re in Jt.properties)Pt[re]||(Pt[re]=[]),Pt[re].push(Jt.properties[re]);return Pt},{}),{type:"FeatureCollection",features:[ct]}},toPolygon:function(ht){for(var Ct=ht.features,ct={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},bt=0;bt<Ct.length;bt++)ct.geometry.coordinates[0].push(Ct[bt].geometry.coordinates);return ct.properties=Ct.reduce(function(Pt,Jt){for(var re in Jt.properties)Pt[re]||(Pt[re]=[]),Pt[re].push(Jt.properties[re]);return Pt},{}),{type:"FeatureCollection",features:[ct]}}};function se(ht){return ht}function ee(ht,Ct){var ct=Ct.id,bt=Ct.bbox,Pt=Ct.properties==null?{}:Ct.properties,Jt=function(re,_e){var Be=function(He){if(He==null)return se;var Ee,si,ci=He.scale[0],Fi=He.scale[1],lr=He.translate[0],ai=He.translate[1];return function(Br,ln){ln||(Ee=si=0);var yr=2,ss=Br.length,$n=new Array(ss);for($n[0]=(Ee+=Br[0])*ci+lr,$n[1]=(si+=Br[1])*Fi+ai;yr<ss;)$n[yr]=Br[yr],++yr;return $n}}(re.transform),Ie=re.arcs;function ne(He,Ee){Ee.length&&Ee.pop();for(var si=Ie[He<0?~He:He],ci=0,Fi=si.length;ci<Fi;++ci)Ee.push(Be(si[ci],ci));He<0&&function(lr,ai){for(var Br,ln=lr.length,yr=ln-ai;yr<--ln;)Br=lr[yr],lr[yr++]=lr[ln],lr[ln]=Br}(Ee,Fi)}function ye(He){return Be(He)}function ve(He){for(var Ee=[],si=0,ci=He.length;si<ci;++si)ne(He[si],Ee);return Ee.length<2&&Ee.push(Ee[0]),Ee}function Ge(He){for(var Ee=ve(He);Ee.length<4;)Ee.push(Ee[0]);return Ee}function Ri(He){return He.map(Ge)}function Qi(He){var Ee,si=He.type;switch(si){case"GeometryCollection":return{type:si,geometries:He.geometries.map(Qi)};case"Point":Ee=ye(He.coordinates);break;case"MultiPoint":Ee=He.coordinates.map(ye);break;case"LineString":Ee=ve(He.arcs);break;case"MultiLineString":Ee=He.arcs.map(ve);break;case"Polygon":Ee=Ri(He.arcs);break;case"MultiPolygon":Ee=He.arcs.map(Ri);break;default:return null}return{type:si,coordinates:Ee}}return Qi(_e)}(ht,Ct);return ct==null&&bt==null?{type:"Feature",properties:Pt,geometry:Jt}:bt==null?{type:"Feature",id:ct,properties:Pt,geometry:Jt}:{type:"Feature",id:ct,bbox:bt,properties:Pt,geometry:Jt}}function qt(ht,Ct){return Array.from(ht.getElementsByTagName(Ct))}function Xt(ht){return ht[0]==="#"?ht:`#${ht}`}function vt(ht){return ht?.normalize(),ht&&ht.textContent||""}function Tt(ht,Ct,ct){let bt=ht.getElementsByTagName(Ct),Pt=bt.length?bt[0]:null;return Pt&&ct&&ct(Pt),Pt}function pe(ht,Ct,ct){let bt={};if(!ht)return bt;let Pt=ht.getElementsByTagName(Ct),Jt=Pt.length?Pt[0]:null;return Jt&&ct?ct(Jt,bt):bt}function j(ht,Ct,ct){let bt=vt(Tt(ht,Ct));return bt&&ct&&ct(bt)||{}}function mt(ht,Ct,ct){let bt=parseFloat(vt(Tt(ht,Ct)));if(!isNaN(bt))return bt&&ct&&ct(bt)||{}}function yt(ht,Ct,ct){let bt=parseFloat(vt(Tt(ht,Ct)));if(!isNaN(bt))return ct&&ct(bt),bt}function Qt(ht,Ct){let ct={};for(let bt of Ct)j(ht,bt,Pt=>{ct[bt]=Pt});return ct}function Ht(ht){return ht?.nodeType===1}function ae(ht){return pe(ht,"line",Ct=>Object.assign({},j(Ct,"color",ct=>({stroke:`#${ct}`})),mt(Ct,"opacity",ct=>({"stroke-opacity":ct})),mt(Ct,"width",ct=>({"stroke-width":96*ct/25.4}))))}function ge(ht){let Ct=[];if(ht===null)return Ct;for(let ct of Array.from(ht.childNodes)){if(!Ht(ct))continue;let bt=de(ct.nodeName);if(bt==="gpxtpx:TrackPointExtension")Ct=Ct.concat(ge(ct));else{let Pt=vt(ct);Ct.push([bt,Ze(Pt)])}}return Ct}function de(ht){return["heart","gpxtpx:hr","hr"].includes(ht)?"heart":ht}function Ze(ht){let Ct=parseFloat(ht);return isNaN(Ct)?ht:Ct}function Re(ht){let Ct=[parseFloat(ht.getAttribute("lon")||""),parseFloat(ht.getAttribute("lat")||"")];if(isNaN(Ct[0])||isNaN(Ct[1]))return null;yt(ht,"ele",bt=>{Ct.push(bt)});let ct=Tt(ht,"time");return{coordinates:Ct,time:ct?vt(ct):null,extendedValues:ge(Tt(ht,"extensions"))}}function Je(ht){let Ct=Qt(ht,["name","cmt","desc","type","time","keywords"]),ct=Array.from(ht.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/GpxExtensions/v3","*"));for(let Pt of ct)Pt.parentNode?.parentNode===ht&&(Ct[Pt.tagName.replace(":","_")]=vt(Pt));let bt=qt(ht,"link");return bt.length&&(Ct.links=bt.map(Pt=>Object.assign({href:Pt.getAttribute("href")},Qt(Pt,["text","type"])))),Ct}function Xe(ht,Ct){let ct=qt(ht,Ct),bt=[],Pt=[],Jt={};for(let re=0;re<ct.length;re++){let _e=Re(ct[re]);if(_e){bt.push(_e.coordinates),_e.time&&Pt.push(_e.time);for(let[Be,Ie]of _e.extendedValues){let ne=Be==="heart"?Be:Be.replace("gpxtpx:","")+"s";Jt[ne]||(Jt[ne]=Array(ct.length).fill(null)),Jt[ne][re]=Ie}}}if(!(bt.length<2))return{line:bt,times:Pt,extendedValues:Jt}}function Kt(ht){let Ct=Xe(ht,"rtept");if(Ct)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},Je(ht),ae(Tt(ht,"extensions"))),geometry:{type:"LineString",coordinates:Ct.line}}}function Ce(ht){let Ct=qt(ht,"trkseg"),ct=[],bt=[],Pt=[];for(let _e of Ct){let Be=Xe(_e,"trkpt");Be&&(Pt.push(Be),Be.times&&Be.times.length&&bt.push(Be.times))}if(Pt.length===0)return null;let Jt=Pt.length>1,re=Object.assign({_gpxType:"trk"},Je(ht),ae(Tt(ht,"extensions")),bt.length?{coordinateProperties:{times:Jt?bt:bt[0]}}:{});for(let _e of Pt){ct.push(_e.line),re.coordinateProperties||(re.coordinateProperties={});let Be=re.coordinateProperties,Ie=Object.entries(_e.extendedValues);for(let ne=0;ne<Ie.length;ne++){let[ye,ve]=Ie[ne];Jt?(Be[ye]||(Be[ye]=Pt.map(Ge=>new Array(Ge.line.length).fill(null))),Be[ye][ne]=ve):Be[ye]=ve}}return{type:"Feature",properties:re,geometry:Jt?{type:"MultiLineString",coordinates:ct}:{type:"LineString",coordinates:ct[0]}}}function Ut(ht){let Ct=Object.assign(Je(ht),Qt(ht,["sym"])),ct=Re(ht);return ct?{type:"Feature",properties:Ct,geometry:{type:"Point",coordinates:ct.coordinates}}:null}function*Ye(ht){for(let Ct of qt(ht,"trk")){let ct=Ce(Ct);ct&&(yield ct)}for(let Ct of qt(ht,"rte")){let ct=Kt(Ct);ct&&(yield ct)}for(let Ct of qt(ht,"wpt")){let ct=Ut(Ct);ct&&(yield ct)}}let Oe="http://www.garmin.com/xmlschemas/ActivityExtension/v2",Qe=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],Ne=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function ze(ht,Ct){let ct=[];for(let[bt,Pt]of Ct){let Jt=Tt(ht,bt);if(!Jt){let _e=ht.getElementsByTagNameNS(Oe,bt);_e.length&&(Jt=_e[0])}let re=parseFloat(vt(Jt));isNaN(re)||ct.push([Pt,re])}return ct}function We(ht){let Ct=[yt(ht,"LongitudeDegrees"),yt(ht,"LatitudeDegrees")];if(Ct[0]===void 0||isNaN(Ct[0])||Ct[1]===void 0||isNaN(Ct[1]))return null;let ct=Tt(ht,"HeartRateBpm"),bt=vt(Tt(ht,"Time"));return Tt(ht,"AltitudeMeters",Pt=>{let Jt=parseFloat(vt(Pt));isNaN(Jt)||Ct.push(Jt)}),{coordinates:Ct,time:bt||null,heartRate:ct?parseFloat(vt(ct)):null,extensions:ze(ht,Qe)}}function ri(ht){let Ct=qt(ht,"Trackpoint"),ct=[],bt=[],Pt=[];if(Ct.length<2)return null;let Jt={},re={extendedProperties:Jt};for(let _e=0;_e<Ct.length;_e++){let Be=We(Ct[_e]);if(Be===null)continue;ct.push(Be.coordinates);let{time:Ie,heartRate:ne,extensions:ye}=Be;Ie&&bt.push(Ie),ne&&Pt.push(ne);for(let[ve,Ge]of ye)Jt[ve]||(Jt[ve]=Array(Ct.length).fill(null)),Jt[ve][_e]=Ge}return ct.length<2?null:Object.assign(re,{line:ct,times:bt,heartRates:Pt})}function hi(ht){let Ct=qt(ht,"Track"),ct=[],bt=[],Pt=[],Jt=[],re,_e=Object.assign(Object.fromEntries(ze(ht,Ne)),pe(ht,"Name",Be=>({name:vt(Be)})));for(let Be of Ct)re=ri(Be),re&&(ct.push(re.line),re.times.length&&bt.push(re.times),re.heartRates.length&&Pt.push(re.heartRates),Jt.push(re.extendedProperties));for(let Be=0;Be<Jt.length;Be++){let Ie=Jt[Be];for(let ne in Ie)Ct.length===1?re&&(_e[ne]=re.extendedProperties[ne]):(_e[ne]||(_e[ne]=ct.map(ye=>Array(ye.length).fill(null))),_e[ne][Be]=Ie[ne])}return ct.length===0?null:((bt.length||Pt.length)&&(_e.coordinateProperties=Object.assign(bt.length?{times:ct.length===1?bt[0]:bt}:{},Pt.length?{heart:ct.length===1?Pt[0]:Pt}:{})),{type:"Feature",properties:_e,geometry:ct.length===1?{type:"LineString",coordinates:ct[0]}:{type:"MultiLineString",coordinates:ct}})}function*Ti(ht){for(let Ct of qt(ht,"Lap")){let ct=hi(Ct);ct&&(yield ct)}for(let Ct of qt(ht,"Courses")){let ct=hi(Ct);ct&&(yield ct)}}function fe(ht,Ct){let ct={},bt=Ct=="stroke"||Ct==="fill"?Ct:Ct+"-color";return ht[0]==="#"&&(ht=ht.substring(1)),ht.length===6||ht.length===3?ct[bt]="#"+ht:ht.length===8&&(ct[Ct+"-opacity"]=parseInt(ht.substring(0,2),16)/255,ct[bt]="#"+ht.substring(6,8)+ht.substring(4,6)+ht.substring(2,4)),ct}function Ni(ht,Ct,ct){let bt={};return yt(ht,Ct,Pt=>{bt[ct]=Pt}),bt}function Di(ht,Ct){return pe(ht,"color",ct=>fe(vt(ct),Ct))}function mi(ht){return pe(ht,"Icon",(Ct,ct)=>(j(Ct,"href",bt=>{ct.icon=bt}),ct))}function Gi(ht){return Object.assign({},function(Ct){return pe(Ct,"PolyStyle",(ct,bt)=>Object.assign(bt,pe(ct,"color",Pt=>fe(vt(Pt),"fill")),j(ct,"fill",Pt=>{if(Pt==="0")return{"fill-opacity":0}}),j(ct,"outline",Pt=>{if(Pt==="0")return{"stroke-opacity":0}})))}(ht),function(Ct){return pe(Ct,"LineStyle",ct=>Object.assign(Di(ct,"stroke"),Ni(ct,"width","stroke-width")))}(ht),function(Ct){return pe(Ct,"LabelStyle",ct=>Object.assign(Di(ct,"label"),Ni(ct,"scale","label-scale")))}(ht),function(Ct){return pe(Ct,"IconStyle",ct=>Object.assign(Di(ct,"icon"),Ni(ct,"scale","icon-scale"),Ni(ct,"heading","icon-heading"),pe(ct,"hotSpot",bt=>{let Pt=parseFloat(bt.getAttribute("x")||""),Jt=parseFloat(bt.getAttribute("y")||""),re=bt.getAttribute("xunits")||"",_e=bt.getAttribute("yunits")||"";return isNaN(Pt)||isNaN(Jt)?{}:{"icon-offset":[Pt,Jt],"icon-offset-units":[re,_e]}}),mi(ct)))}(ht))}let le=ht=>Number(ht),gi={string:ht=>ht,int:le,uint:le,short:le,ushort:le,float:le,double:le,bool:ht=>Boolean(ht)};function Ke(ht,Ct){return pe(ht,"ExtendedData",(ct,bt)=>{for(let Pt of qt(ct,"Data"))bt[Pt.getAttribute("name")||""]=vt(Tt(Pt,"value"));for(let Pt of qt(ct,"SimpleData")){let Jt=Pt.getAttribute("name")||"",re=Ct[Jt]||gi.string;bt[Jt]=re(vt(Pt))}return bt})}function or(ht){let Ct=Tt(ht,"description");for(let ct of Array.from(Ct?.childNodes||[]))if(ct.nodeType===4)return{description:{"@type":"html",value:vt(ct)}};return{}}function Ki(ht){return pe(ht,"TimeSpan",Ct=>({timespan:{begin:vt(Tt(Ct,"begin")),end:vt(Tt(Ct,"end"))}}))}function ii(ht){return pe(ht,"TimeStamp",Ct=>({timestamp:vt(Tt(Ct,"when"))}))}function br(ht,Ct){return j(ht,"styleUrl",ct=>(ct=Xt(ct),Ct[ct]?Object.assign({styleUrl:ct},Ct[ct]):{styleUrl:ct}))}let Ji=/\s*/g,wr=/^\s*|\s*$/g,ar=/\s+/;function wt(ht){return ht.replace(Ji,"").split(",").map(parseFloat).filter(Ct=>!isNaN(Ct)).slice(0,3)}function W(ht){return ht.replace(wr,"").split(ar).map(wt).filter(Ct=>Ct.length>=2)}function X(ht){let Ct=qt(ht,"coord");Ct.length===0&&(Ct=function(bt,Pt,Jt){return Array.from(bt.getElementsByTagNameNS(Jt,Pt))}(ht,"coord","*"));let ct=Ct.map(bt=>vt(bt).split(" ").map(parseFloat));return ct.length===0?null:{geometry:ct.length>2?{type:"LineString",coordinates:ct}:{type:"Point",coordinates:ct[0]},times:qt(ht,"when").map(bt=>vt(bt))}}function rt(ht){if(ht.length===0)return ht;let Ct=ht[0],ct=ht[ht.length-1],bt=!0;for(let Pt=0;Pt<Math.max(Ct.length,ct.length);Pt++)if(Ct[Pt]!==ct[Pt]){bt=!1;break}return bt?ht:ht.concat([ht[0]])}function ft(ht){return vt(Tt(ht,"coordinates"))}function Mt(ht){let Ct=[],ct=[];for(let bt=0;bt<ht.childNodes.length;bt++){let Pt=ht.childNodes.item(bt);if(Ht(Pt))switch(Pt.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{let Jt=Mt(Pt);Ct=Ct.concat(Jt.geometries),ct=ct.concat(Jt.coordTimes);break}case"Point":{let Jt=wt(ft(Pt));Jt.length>=2&&Ct.push({type:"Point",coordinates:Jt});break}case"LinearRing":case"LineString":{let Jt=W(ft(Pt));Jt.length>=2&&Ct.push({type:"LineString",coordinates:Jt});break}case"Polygon":{let Jt=[];for(let re of qt(Pt,"LinearRing")){let _e=rt(W(ft(re)));_e.length>=4&&Jt.push(_e)}Jt.length&&Ct.push({type:"Polygon",coordinates:Jt});break}case"Track":case"gx:Track":{let Jt=X(Pt);if(!Jt)break;let{times:re,geometry:_e}=Jt;Ct.push(_e),re.length&&ct.push(re);break}}}return{geometries:Ct,coordTimes:ct}}function Vt(ht,Ct,ct,bt){let{coordTimes:Pt,geometries:Jt}=Mt(ht),re=function(Ie){return Ie.length===0?null:Ie.length===1?Ie[0]:{type:"GeometryCollection",geometries:Ie}}(Jt);if(!re&&bt.skipNullGeometry)return null;let _e={type:"Feature",geometry:re,properties:Object.assign(Qt(ht,["name","address","visibility","open","phoneNumber","description"]),or(ht),br(ht,Ct),Gi(ht),Ke(ht,ct),Ki(ht),ii(ht),Pt.length?{coordinateProperties:{times:Pt.length===1?Pt[0]:Pt}}:{})};_e.properties?.visibility!==void 0&&(_e.properties.visibility=_e.properties.visibility!=="0");let Be=ht.getAttribute("id");return Be!==null&&Be!==""&&(_e.id=Be),_e}function Yt(ht){return Tt(ht,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[rt(W(ft(ht)))]}}:function(Ct){let ct=Tt(Ct,"LatLonBox");if(ct){let bt=yt(ct,"north"),Pt=yt(ct,"west"),Jt=yt(ct,"east"),re=yt(ct,"south"),_e=yt(ct,"rotation");if(typeof bt=="number"&&typeof re=="number"&&typeof Pt=="number"&&typeof Jt=="number"){let Be=[Pt,re,Jt,bt],Ie=[[[Pt,bt],[Jt,bt],[Jt,re],[Pt,re],[Pt,bt]]];return typeof _e=="number"&&(Ie=function(ne,ye,ve){let Ge=[(ne[0]+ne[2])/2,(ne[1]+ne[3])/2];return[ye[0].map(Ri=>{let Qi=Ri[1]-Ge[1],He=Ri[0]-Ge[0],Ee=Math.sqrt(Math.pow(Qi,2)+Math.pow(He,2)),si=Math.atan2(Qi,He)+ve*Rt;return[Ge[0]+Math.cos(si)*Ee,Ge[1]+Math.sin(si)*Ee]})]}(Be,Ie,_e)),{bbox:Be,geometry:{type:"Polygon",coordinates:Ie}}}}return null}(ht)}let Rt=Math.PI/180;function Wt(ht,Ct,ct,bt){let Pt=Yt(ht),Jt=Pt?.geometry||null;if(!Jt&&bt.skipNullGeometry)return null;let re={type:"Feature",geometry:Jt,properties:Object.assign({"@geometry-type":"groundoverlay"},Qt(ht,["name","address","visibility","open","phoneNumber","description"]),or(ht),br(ht,Ct),Gi(ht),mi(ht),Ke(ht,ct),Ki(ht),ii(ht))};Pt?.bbox&&(re.bbox=Pt.bbox),re.properties?.visibility!==void 0&&(re.properties.visibility=re.properties.visibility!=="0");let _e=ht.getAttribute("id");return _e!==null&&_e!==""&&(re.id=_e),re}function be(ht){let Ct=ht.getAttribute("id"),ct=ht.parentNode;return!Ct&&Ht(ct)&&ct.localName==="CascadingStyle"&&(Ct=ct.getAttribute("kml:id")||ct.getAttribute("id")),Xt(Ct||"")}function he(ht){let Ct={};for(let ct of qt(ht,"Style"))Ct[be(ct)]=Gi(ct);for(let ct of qt(ht,"StyleMap")){let bt=Xt(ct.getAttribute("id")||"");j(ct,"styleUrl",Pt=>{Pt=Xt(Pt),Ct[Pt]&&(Ct[bt]=Ct[Pt])})}return Ct}function Le(ht){let Ct={};for(let ct of qt(ht,"SimpleField"))Ct[ct.getAttribute("name")||""]=gi[ct.getAttribute("type")||""]||gi.string;return Ct}let je=["name","visibility","open","address","description","phoneNumber","visibility"];function*ti(ht,Ct={skipNullGeometry:!1}){let ct=he(ht),bt=Le(ht);for(let Pt of qt(ht,"Placemark")){let Jt=Vt(Pt,ct,bt,Ct);Jt&&(yield Jt)}for(let Pt of qt(ht,"GroundOverlay")){let Jt=Wt(Pt,ct,bt,Ct);Jt&&(yield Jt)}}var _i=Object.freeze({__proto__:null,gpx:function(ht){return{type:"FeatureCollection",features:Array.from(Ye(ht))}},gpxGen:Ye,kml:function(ht,Ct={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(ti(ht,Ct))}},kmlGen:ti,kmlWithFolders:function(ht,Ct={skipNullGeometry:!1}){let ct=he(ht),bt=Le(ht),Pt={type:"root",children:[]};return function Jt(re,_e,Be){if(Ht(re))switch(re.tagName){case"GroundOverlay":{let Ie=Wt(re,ct,bt,Be);Ie&&_e.children.push(Ie);break}case"Placemark":{let Ie=Vt(re,ct,bt,Be);Ie&&_e.children.push(Ie);break}case"Folder":{let Ie=function(ne){let ye={};for(let ve of Array.from(ne.childNodes))Ht(ve)&&je.includes(ve.tagName)&&(ye[ve.tagName]=vt(ve));return{type:"folder",meta:ye,children:[]}}(re);_e.children.push(Ie),_e=Ie;break}}if(re.childNodes)for(let Ie=0;Ie<re.childNodes.length;Ie++)Jt(re.childNodes[Ie],_e,Be)}(ht,Pt,Ct),Pt},tcx:function(ht){return{type:"FeatureCollection",features:Array.from(Ti(ht))}},tcxGen:Ti}),$i={exports:{}};(function(ht){var Ct={};function ct(Jt){return Math.floor(Math.abs(Jt)+.5)*(Jt>=0?1:-1)}function bt(Jt,re,_e){var Be=2*((Jt=ct(Jt*_e))-(re=ct(re*_e)));Be<0&&(Be=-Be-1);for(var Ie="";Be>=32;)Ie+=String.fromCharCode(63+(32|31&Be)),Be/=32;return Ie+=String.fromCharCode(63+(0|Be))}function Pt(Jt){for(var re=[],_e=0;_e<Jt.length;_e++){var Be=Jt[_e].slice();re.push([Be[1],Be[0]])}return re}Ct.decode=function(Jt,re){for(var _e,Be=0,Ie=0,ne=0,ye=[],ve=0,Ge=0,Ri=null,Qi=Math.pow(10,Number.isInteger(re)?re:5);Be<Jt.length;){Ri=null,ve=1,Ge=0;do Ge+=(31&(Ri=Jt.charCodeAt(Be++)-63))*ve,ve*=32;while(Ri>=32);_e=1&Ge?(-Ge-1)/2:Ge/2,ve=1,Ge=0;do Ge+=(31&(Ri=Jt.charCodeAt(Be++)-63))*ve,ve*=32;while(Ri>=32);Ie+=_e,ne+=1&Ge?(-Ge-1)/2:Ge/2,ye.push([Ie/Qi,ne/Qi])}return ye},Ct.encode=function(Jt,re){if(!Jt.length)return"";for(var _e=Math.pow(10,Number.isInteger(re)?re:5),Be=bt(Jt[0][0],0,_e)+bt(Jt[0][1],0,_e),Ie=1;Ie<Jt.length;Ie++){var ne=Jt[Ie],ye=Jt[Ie-1];Be+=bt(ne[0],ye[0],_e),Be+=bt(ne[1],ye[1],_e)}return Be},Ct.fromGeoJSON=function(Jt,re){if(Jt&&Jt.type==="Feature"&&(Jt=Jt.geometry),!Jt||Jt.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return Ct.encode(Pt(Jt.coordinates),re)},Ct.toGeoJSON=function(Jt,re){return{type:"LineString",coordinates:Pt(Ct.decode(Jt,re))}},ht.exports&&(ht.exports=Ct)})($i);var xi=$i.exports,zi=(()=>{let ht=ne=>ne[0],Ct=ne=>ne[ne.length-1],ct=ne=>ne.join(","),bt=(ne,ye,ve)=>{let Ge=ne[ye];Ge?Ge.push(ve):ne[ye]=[ve]},Pt=(ne,ye,ve)=>{let Ge=ne[ye],Ri=null;Ge&&(Ri=Ge.indexOf(ve))>=0&&Ge.splice(Ri,1)},Jt=(ne,ye)=>{let ve=ne[ye];return ve&&ve.length>0?ve[0]:null},re=ne=>ne.length>3&&ct(ht(ne))===ct(Ct(ne)),_e=(ne,ye,ve)=>{ye=ye||0,ve=ve||1;let Ge=ne.reduce((lr,ai,Br)=>ne[lr][ye]>ai[ye]?lr:Br,0),Ri=Ge<=0?ne.length-2:Ge-1,Qi=Ge>=ne.length-1?1:Ge+1,He=ne[Ri][ye],Ee=ne[Ge][ye],si=ne[Qi][ye],ci=ne[Ri][ve],Fi=ne[Ge][ve];return(Ee-He)*(ne[Qi][ve]-ci)-(si-He)*(Fi-ci)<0?"clockwise":"counterclockwise"},Be=ne=>ne instanceof Array?ne.map(Be):parseFloat(ne);class Ie extends Map{constructor(){super(),this.binders=[]}add(ye,ve){this.has(ye)||this.set(ye,ve)}addBinder(ye){this.binders.push(ye)}bindAll(){this.binders.forEach(ye=>ye.bind())}}return{purgeProps:(ne,ye)=>{if(ne){let ve=Object.assign({},ne);if(ye)for(let Ge of ye)delete ve[Ge];return ve}return{}},mergeProps:(ne,ye)=>(ne=ne||{},ye=ye||{},Object.assign(ne,ye)),first:ht,last:Ct,coordsToKey:ct,addToMap:bt,removeFromMap:Pt,getFirstFromMap:Jt,isRing:re,ringDirection:_e,ptInsidePolygon:(ne,ye,ve,Ge)=>{ve=ve||0,Ge=Ge||1;let Ri=!1;for(let Qi=0,He=ye.length-1;Qi<ye.length;He=Qi++)(ye[Qi][ve]<=ne[ve]&&ne[ve]<ye[He][ve]||ye[He][ve]<=ne[ve]&&ne[ve]<ye[Qi][ve])&&ne[Ge]<(ye[He][Ge]-ye[Qi][Ge])*(ne[ve]-ye[Qi][ve])/(ye[He][ve]-ye[Qi][ve])+ye[Qi][Ge]&&(Ri=!Ri);return Ri},strToFloat:Be,RefElements:Ie,LateBinder:class{constructor(ne,ye,ve,Ge){this.container=ne,this.valueFunc=ye,this.ctx=ve,this.args=Ge}bind(){let ne=this.valueFunc.apply(this.ctx,this.args);if(this.container instanceof Array){let ye=this.container.indexOf(this);if(ye>=0){let ve=[ye,1];ne&&ve.push(ne),[].splice.apply(this.container,ve)}}else if(typeof this.container=="object"){let ye=Object.keys(this.container).find(ve=>this.container[ve]===this);ye&&(ne?this.container[ye]=ne:delete this.container[ye])}}},WayCollection:class extends Array{constructor(){super(),this.firstMap={},this.lastMap={}}addWay(ne){(ne=ne.toCoordsArray()).length>0&&(this.push(ne),bt(this.firstMap,ct(ht(ne)),ne),bt(this.lastMap,ct(Ct(ne)),ne))}toStrings(){let ne=[],ye=null;for(;ye=this.shift();){Pt(this.firstMap,ct(ht(ye)),ye),Pt(this.lastMap,ct(Ct(ye)),ye);let ve=ye,Ge=null;do{let Ri=ct(Ct(ve)),Qi=!1;Ge=Jt(this.firstMap,Ri),Ge||(Ge=Jt(this.lastMap,Ri),Qi=!0),Ge&&(this.splice(this.indexOf(Ge),1),Pt(this.firstMap,ct(ht(Ge)),Ge),Pt(this.lastMap,ct(Ct(Ge)),Ge),Qi&&(Ge.length>ve.length&&([ve,Ge]=[Ge,ve]),Ge.reverse()),ve=ve.concat(Ge.slice(1)))}while(Ge);ne.push(Be(ve))}return ne}toRings(ne){let ye=this.toStrings(),ve=[],Ge=null;for(;Ge=ye.shift();)re(Ge)&&(_e(Ge)!==ne&&Ge.reverse(),ve.push(Ge));return ve}}}})(),hr={building:{},highway:{whitelist:["services","rest_area","escape","elevator"]},natural:{blacklist:["coastline","cliff","ridge","arete","tree_row"]},landuse:{},waterway:{whitelist:["riverbank","dock","boatyard","dam"]},amenity:{},leisure:{},barrier:{whitelist:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},railway:{whitelist:["station","turntable","roundhouse","platform"]},area:{},boundary:{},man_made:{blacklist:["cutline","embankment","pipeline"]},power:{whitelist:["plant","substation","generator","transformer"]},place:{},shop:{},aeroway:{blacklist:["taxiway"]},tourism:{},historic:{},public_transport:{},office:{},"building:part":{},military:{},ruins:{},"area:highway":{},craft:{},golf:{},indoor:{}},fr=(()=>{let{first:ht,last:Ct,coordsToKey:ct,addToMap:bt,removeFromMap:Pt,getFirstFromMap:Jt,isRing:re,ringDirection:_e,ptInsidePolygon:Be,strToFloat:Ie,LateBinder:ne,WayCollection:ye}=zi,ve=hr;class Ge{constructor(Ee,si,ci){this.type=Ee,this.id=si,this.refElems=ci,this.tags={},this.props={id:this.getCompositeId()},this.refCount=0,this.hasTag=!1,ci&&ci.add(this.getCompositeId(),this)}addTags(Ee){this.tags=Object.assign(this.tags,Ee),this.hasTag=!!Ee}addTag(Ee,si){this.tags[Ee]=si,this.hasTag=!!Ee}addProp(Ee,si){this.props[Ee]=si}addProps(Ee){this.props=Object.assign(this.props,Ee)}getCompositeId(){return`${this.type}/${this.id}`}getProps(){return Object.assign(this.props,this.tags)}toFeatureArray(){return[]}}class Ri extends Ge{constructor(Ee,si){super("node",Ee,si),this.latLng=null}setLatLng(Ee){this.latLng=Ee}toFeatureArray(){return this.latLng?[{type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"Point",coordinates:Ie([this.latLng.lon,this.latLng.lat])}}]:[]}getLatLng(){return this.latLng}}class Qi extends Ge{constructor(Ee,si){super("way",Ee,si),this.latLngArray=[],this.isPolygon=!1}addLatLng(Ee){this.latLngArray.push(Ee)}setLatLngArray(Ee){this.latLngArray=Ee}addNodeRef(Ee){let si=new ne(this.latLngArray,function(ci){let Fi=this.refElems.get(`node/${ci}`);if(Fi)return Fi.refCount++,Fi.getLatLng()},this,[Ee]);this.latLngArray.push(si),this.refElems.addBinder(si)}analyzeGeometryType(Ee,si){let ci=ve[Ee];ci&&(this.isPolygon=!0,ci.whitelist?this.isPolygon=ci.whitelist.indexOf(si)>=0:ci.blacklist&&(this.isPolygon=!(ci.blacklist.indexOf(si)>=0)))}addTags(Ee){super.addTags(Ee);for(let[si,ci]of Object.entries(Ee))this.analyzeGeometryType(si,ci)}addTag(Ee,si){super.addTag(Ee,si),this.analyzeGeometryType(Ee,si)}toCoordsArray(){return this.latLngArray.map(Ee=>[Ee.lon,Ee.lat])}toFeatureArray(){let Ee=this.toCoordsArray();if(Ee.length>1){Ee=Ie(Ee);let si={type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"LineString",coordinates:Ee}};return this.isPolygon&&re(Ee)?(_e(Ee)!=="counterclockwise"&&Ee.reverse(),si.geometry={type:"Polygon",coordinates:[Ee]},[si]):[si]}return[]}}return{Node:Ri,Way:Qi,Relation:class extends Ge{constructor(He,Ee){super("relation",He,Ee),this.relations=[],this.nodes=[],this.bounds=null}setBounds(He){this.bounds=He}addMember(He){switch(He.type){case"relation":let Ee=new ne(this.relations,function(Fi){let lr=this.refElems.get(`relation/${Fi}`);if(lr)return lr.refCount++,lr},this,[He.ref]);this.relations.push(Ee),this.refElems.addBinder(Ee);break;case"way":He.role||(He.role="");let si=this[He.role];if(si||(si=this[He.role]=[]),He.geometry){let Fi=new Qi(He.ref,this.refElems);Fi.setLatLngArray(He.geometry),Fi.refCount++,si.push(Fi)}else if(He.nodes){let Fi=new Qi(He.ref,this.refElems);for(let lr of He.nodes)Fi.addNodeRef(lr);Fi.refCount++,si.push(Fi)}else{let Fi=new ne(si,function(lr){let ai=this.refElems.get(`way/${lr}`);if(ai)return ai.refCount++,ai},this,[He.ref]);si.push(Fi),this.refElems.addBinder(Fi)}break;case"node":let ci=null;if(He.lat&&He.lon){ci=new Ri(He.ref,this.refElems),ci.setLatLng({lon:He.lon,lat:He.lat}),He.tags&&ci.addTags(He.tags);for(let[Fi,lr]of Object.entries(He))["id","type","lat","lon"].indexOf(Fi)<0&&ci.addProp(Fi,lr);ci.refCount++,this.nodes.push(ci)}else{let Fi=new ne(this.nodes,function(lr){let ai=this.refElems.get(`node/${lr}`);if(ai)return ai.refCount++,ai},this,[He.ref]);this.nodes.push(Fi),this.refElems.addBinder(Fi)}}}toFeatureArray(){let He=[],Ee=[],si=[],ci=["outer","inner",""];for(let ai of this.relations)if(ai)for(let Br of ci){let ln=ai[Br];if(ln){let yr=this[Br];yr?[].splice.apply(yr,[yr.length,0].concat(ln)):this[Br]=ln}}for(let ai of ci){let Br=this[ai];if(Br){this[ai]=new ye;for(let ln of Br)this[ai].addWay(ln)}}let Fi=null,lr={type:"Feature",id:this.getCompositeId(),bbox:this.bounds,properties:this.getProps()};this.bounds||delete lr.bbox,this.outer?(Fi=((ai,Br)=>{let ln=ai?ai.toRings("counterclockwise"):[],yr=Br?Br.toRings("clockwise"):[];if(ln.length>0){let ss=[],$n=null;for($n of ln)ss.push([$n]);for(;$n=yr.shift();)for(let zo in ln)if(Be(ht($n),ln[zo])){ss[zo].push($n);break}return ss.length===1?{type:"Polygon",coordinates:ss[0]}:{type:"MultiPolygon",coordinates:ss}}return null})(this.outer,this.inner),Fi&&(lr.geometry=Fi,He.push(lr))):this[""]&&(Fi=(ai=>{let Br=ai?ai.toStrings():[];return Br.length>0?Br.length===1?{type:"LineString",coordinates:Br[0]}:{type:"MultiLineString",coordinates:Br}:null})(this[""]),Fi&&(lr.geometry=Fi,Ee.push(lr)));for(let ai of this.nodes)si=si.concat(ai.toFeatureArray());return He.concat(Ee).concat(si)}}}})(),Hi=(()=>{function ht(ct){return ct.match(/^(.+?)\[(.+?)\]>$/g)!=null}function Ct(ct){let bt=/^(.+?)\[(.+?)\]>$/g.exec(ct);return bt?{evt:bt[1]+">",exp:bt[2]}:{evt:ct}}return class{constructor(ct){ct&&(this.queryParent=!!ct.queryParent,this.progressive=ct.progressive,this.queryParent&&(this.parentMap=new WeakMap)),this.evtListeners={}}parse(ct,bt,Pt){Pt=Pt?Pt+".":"";let Jt=/<([^ >\/]+)(.*?)>/gm,re=null,_e=[];for(;re=Jt.exec(ct);){let Be=re[1],Ie={$tag:Be},ne=Pt+Be,ye=re[2].trim(),ve=!1;(ye.endsWith("/")||Be.startsWith("?")||Be.startsWith("!"))&&(ve=!0);let Ge=/([^ ]+?)="(.+?)"/g,Ri=/([^ ]+?)='(.+?)'/g,Qi=null,He=!1;for(;Qi=Ge.exec(ye);)He=!0,Ie[Qi[1]]=Qi[2];if(!He)for(;Qi=Ri.exec(ye);)He=!0,Ie[Qi[1]]=Qi[2];if(He||ye===""||(Ie.text=ye),this.progressive&&this.emit(`<${ne}>`,Ie,bt),!ve){let Ee=new RegExp(`([^]+?)</${Be}>`,"g");Ee.lastIndex=Jt.lastIndex;let si=Ee.exec(ct);if(si&&si[1]){Jt.lastIndex=Ee.lastIndex;let ci=this.parse(si[1],Ie,ne);ci.length>0?Ie.$innerNodes=ci:Ie.$innerText=si[1]}}this.queryParent&&bt&&this.parentMap.set(Ie,bt),this.progressive&&this.emit(`</${ne}>`,Ie,bt),_e.push(Ie)}return _e}getParent(ct){return this.queryParent?this.parentMap.get(ct):null}#t(ct,bt){let Pt=this.evtListeners[ct];Pt?Pt.push(bt):this.evtListeners[ct]=[bt]}addListener(ct,bt){ht(ct)&&(ct=Ct(ct),bt.condition=function(Pt){let Jt="return "+Pt.replace(/(\$.+?)(?=[=!.])/g,"node.$&")+";";return new Function("node",Jt)}(ct.exp),ct=ct.evt),this.#t(ct,bt)}#e(ct,bt){let Pt=this.evtListeners[ct],Jt=null;Pt&&(Jt=Pt.indexOf(bt))>=0&&Pt.splice(Jt,1)}removeListener(ct,bt){ht(ct)&&(ct=(ct=Ct(ct)).evt),this.#e(ct,bt)}emit(ct,...bt){let Pt=this.evtListeners[ct];if(Pt)for(let Jt of Pt)Jt.condition?Jt.condition.apply(null,bt)===!0&&Jt.apply(null,bt):Jt.apply(null,bt)}on(ct,bt){this.addListener(ct,bt)}off(ct,bt){this.removeListener(ct,bt)}}})();let{Node:Wi,Way:Ar,Relation:Zt}=fr,{purgeProps:De,RefElements:Te}=zi,tr=Hi;var Ui=(ht,Ct)=>{let ct=!1,bt=!1,Pt=!0;(Be=>{if(Be){ct=!(!Be.completeFeature&&!Be.allFeatures),bt=!!Be.renderTagged;let Ie=Be.suppressWay||Be.excludeWay;Ie===void 0||Ie||(Pt=!1)}})(Ct);let Jt=(Be=>Be.elements?"json":Be.indexOf("<osm")>=0?"xml":Be.trim().startsWith("{")?"json-raw":"invalid")(ht),re=new Te,_e=[];Jt==="json-raw"&&(Jt=(ht=JSON.parse(ht)).elements?"json":"invalid"),Jt==="json"?(Be=>{for(let Ie of Be.elements)switch(Ie.type){case"node":let ne=new Wi(Ie.id,re);Ie.tags&&ne.addTags(Ie.tags),ne.addProps(De(Ie,["id","type","tags","lat","lon"])),ne.setLatLng(Ie);break;case"way":let ye=new Ar(Ie.id,re);if(Ie.tags&&ye.addTags(Ie.tags),ye.addProps(De(Ie,["id","type","tags","nodes","geometry"])),Ie.nodes)for(let Ge of Ie.nodes)ye.addNodeRef(Ge);else Ie.geometry&&ye.setLatLngArray(Ie.geometry);break;case"relation":let ve=new Zt(Ie.id,re);if(Ie.bounds&&ve.setBounds([parseFloat(Ie.bounds.minlon),parseFloat(Ie.bounds.minlat),parseFloat(Ie.bounds.maxlon),parseFloat(Ie.bounds.maxlat)]),Ie.tags&&ve.addTags(Ie.tags),ve.addProps(De(Ie,["id","type","tags","bounds","members"])),Ie.members)for(let Ge of Ie.members)ve.addMember(Ge)}})(ht):Jt==="xml"&&(Be=>{let Ie=new tr({progressive:!0});Ie.on("</osm.node>",ne=>{let ye=new Wi(ne.id,re);for(let[ve,Ge]of Object.entries(ne))!ve.startsWith("$")&&["id","lon","lat"].indexOf(ve)<0&&ye.addProp(ve,Ge);if(ye.setLatLng(ne),ne.$innerNodes)for(let ve of ne.$innerNodes)ve.$tag==="tag"&&ye.addTag(ve.k,ve.v)}),Ie.on("</osm.way>",ne=>{let ye=new Ar(ne.id,re);for(let[ve,Ge]of Object.entries(ne))!ve.startsWith("$")&&["id"].indexOf(ve)<0&&ye.addProp(ve,Ge);if(ne.$innerNodes)for(let ve of ne.$innerNodes)ve.$tag==="nd"?ve.lon&&ve.lat?ye.addLatLng(ve):ve.ref&&ye.addNodeRef(ve.ref):ve.$tag==="tag"&&ye.addTag(ve.k,ve.v)}),Ie.on("<osm.relation>",ne=>{new Zt(ne.id,re)}),Ie.on("</osm.relation.member>",(ne,ye)=>{let ve=re.get(`relation/${ye.id}`),Ge={type:ne.type,role:ne.role?ne.role:"",ref:ne.ref};if(ne.lat&&ne.lon){Ge.lat=ne.lat,Ge.lon=ne.lon,Ge.tags={};for(let[Ri,Qi]of Object.entries(ne))!Ri.startsWith("$")&&["type","lat","lon"].indexOf(Ri)<0&&(Ge[Ri]=Qi)}if(ne.$innerNodes){let Ri=[],Qi=[];for(let He of ne.$innerNodes)He.lat&&He.lon?Ri.push(He):Qi.push(He.ref);Ri.length>0?Ge.geometry=Ri:Qi.length>0&&(Ge.nodes=Qi)}ve.addMember(Ge)}),Ie.on("</osm.relation.bounds>",(ne,ye)=>{re.get(`relation/${ye.id}`).setBounds([parseFloat(ne.minlon),parseFloat(ne.minlat),parseFloat(ne.maxlon),parseFloat(ne.maxlat)])}),Ie.on("</osm.relation.tag>",(ne,ye)=>{re.get(`relation/${ye.id}`).addTag(ne.k,ne.v)}),Ie.parse(Be)})(ht),re.bindAll();for(let Be of re.values())if(Be.refCount<=0||Be.hasTag&&bt&&!(Be instanceof Ar&&Pt)){let Ie=Be.toFeatureArray();if(Be instanceof Zt&&!ct&&Ie.length>0)return Ie[0].geometry;_e=_e.concat(Ie)}return{type:"FeatureCollection",features:_e}},an=t(Ui);let Fr=["topojson","osm","kml","gpx","tcx","csv","tsv","polyline"];class $r{constructor(Ct,ct,bt={}){this.blankGeoJSON=()=>({type:"FeatureCollection",features:[]}),this._rawData=ct,this._format=Ct,this._options=bt;let Pt={topojson:this.loadTopoJson,osm:this.loadOsm,kml:this.loadXml,gpx:this.loadXml,tcx:this.loadXml,csv:this.loadCsv,tsv:this.loadCsv,polyline:this.loadPolyline};this._conversionFn=Pt[Ct]}async convert(){return this._conversionFn?this._conversionFn():new Promise((Ct,ct)=>ct(`No converter exists for ${this._format}`))}async loadXml(){return _i[this._format](new DOMParser().parseFromString(this._rawData,"text/xml"))}async loadCsv(){let Ct=this._options.csvOptions||{};return this._format==="tsv"&&(Ct.delimiter="	"),await new Promise((ct,bt)=>{Bt.csv2geojson(this._rawData,Ct,(Pt,Jt)=>{Pt?bt(Pt):ct(Jt)})})}async loadTopoJson(){let Ct={};try{Ct=JSON.parse(this._rawData)}catch{throw"Invalid TopoJson"}let ct=this.blankGeoJSON();return Ct.type==="Topology"&&Ct.objects!==void 0&&(ct={type:"FeatureCollection",features:ct.features=Object.keys(Ct.objects).map(bt=>{return Pt=Ct,typeof(Jt=bt)=="string"&&(Jt=Pt.objects[Jt]),Jt.type==="GeometryCollection"?{type:"FeatureCollection",features:Jt.geometries.map(function(re){return ee(Pt,re)})}:ee(Pt,Jt);var Pt,Jt}).reduce((bt,Pt)=>[...bt,...Pt.features],[])}),ct}async loadOsm(){return an(this._rawData)}async loadPolyline(){let Ct=this._options.polylineOptions||{};return await new Promise((ct,bt)=>{try{let Pt=xi.toGeoJSON(this._rawData,Ct.precision),Jt=Pt;Ct.type==="point"?Pt.coordinates.length===1?Jt={type:"Point",coordinates:Pt.coordinates[0]}:console.warn("Cannot convert polyline to "+Ct.type):Ct.type==="polygon"&&(Pt.coordinates[0][0]===Pt.coordinates[Pt.coordinates.length-1][0]&&Pt.coordinates[0][1]===Pt.coordinates[Pt.coordinates.length-1][1]?Jt={type:"Polygon",coordinates:[Pt.coordinates]}:console.warn("Cannot convert polyline to "+Ct.type)),ct({type:"FeatureCollection",features:[{type:"Feature",geometry:Jt,properties:Ct.properties||{}}]})}catch(Pt){bt(Pt)}})}}var Ir=null;try{var hn=typeof xd<"u"&&typeof xd.require=="function"&&vd("worker_threads")||typeof __non_webpack_require__=="function"&&__non_webpack_require__("worker_threads")||typeof vd=="function"&&vd("worker_threads");Ir=hn.Worker}catch{}function pn(ht,Ct,ct){var bt=function(re,_e){return Buffer.from(re,"base64").toString("utf8")}(ht),Pt=bt.indexOf(`
`,10)+1,Jt=bt.substring(Pt)+"";return function(re){return new Ir(Jt,Object.assign({},re,{eval:!0}))}}function An(ht,Ct,ct){var bt=function(_e,Be){return atob(_e)}(ht),Pt=bt.indexOf(`
`,10)+1,Jt=bt.substring(Pt)+"",re=new Blob([Jt],{type:"application/javascript"});return URL.createObjectURL(re)}var pa=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",Rs,Or=(Rs="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCWZ1bmN0aW9uIGdldERlZmF1bHRFeHBvcnRGcm9tQ2pzICh4KSB7CgkJcmV0dXJuIHggJiYgeC5fX2VzTW9kdWxlICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh4LCAnZGVmYXVsdCcpID8geFsnZGVmYXVsdCddIDogeDsKCX0KCglmdW5jdGlvbiBnZXRBdWdtZW50ZWROYW1lc3BhY2UobikgewoJICBpZiAobi5fX2VzTW9kdWxlKSByZXR1cm4gbjsKCSAgdmFyIGYgPSBuLmRlZmF1bHQ7CgkJaWYgKHR5cGVvZiBmID09ICJmdW5jdGlvbiIpIHsKCQkJdmFyIGEgPSBmdW5jdGlvbiBhICgpIHsKCQkJCWlmICh0aGlzIGluc3RhbmNlb2YgYSkgewoJICAgICAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoZiwgYXJndW1lbnRzLCB0aGlzLmNvbnN0cnVjdG9yKTsKCQkJCX0KCQkJCXJldHVybiBmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgkJCX07CgkJCWEucHJvdG90eXBlID0gZi5wcm90b3R5cGU7CgkgIH0gZWxzZSBhID0ge307CgkgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCAnX19lc01vZHVsZScsIHt2YWx1ZTogdHJ1ZX0pOwoJCU9iamVjdC5rZXlzKG4pLmZvckVhY2goZnVuY3Rpb24gKGspIHsKCQkJdmFyIGQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sIGspOwoJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoYSwgaywgZC5nZXQgPyBkIDogewoJCQkJZW51bWVyYWJsZTogdHJ1ZSwKCQkJCWdldDogZnVuY3Rpb24gKCkgewoJCQkJCXJldHVybiBuW2tdOwoJCQkJfQoJCQl9KTsKCQl9KTsKCQlyZXR1cm4gYTsKCX0KCglmdW5jdGlvbiBvYmplY3RDb252ZXJ0ZXIoY29sdW1ucykgewoJICByZXR1cm4gbmV3IEZ1bmN0aW9uKCJkIiwgInJldHVybiB7IiArIGNvbHVtbnMubWFwKGZ1bmN0aW9uKG5hbWUsIGkpIHsKCSAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobmFtZSkgKyAiOiBkWyIgKyBpICsgIl0iOwoJICB9KS5qb2luKCIsIikgKyAifSIpOwoJfQoKCWZ1bmN0aW9uIGN1c3RvbUNvbnZlcnRlcihjb2x1bW5zLCBmKSB7CgkgIHZhciBvYmplY3QgPSBvYmplY3RDb252ZXJ0ZXIoY29sdW1ucyk7CgkgIHJldHVybiBmdW5jdGlvbihyb3csIGkpIHsKCSAgICByZXR1cm4gZihvYmplY3Qocm93KSwgaSwgY29sdW1ucyk7CgkgIH07Cgl9CgoJLy8gQ29tcHV0ZSB1bmlxdWUgY29sdW1ucyBpbiBvcmRlciBvZiBkaXNjb3ZlcnkuCglmdW5jdGlvbiBpbmZlckNvbHVtbnMocm93cykgewoJICB2YXIgY29sdW1uU2V0ID0gT2JqZWN0LmNyZWF0ZShudWxsKSwKCSAgICAgIGNvbHVtbnMgPSBbXTsKCgkgIHJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpIHsKCSAgICBmb3IgKHZhciBjb2x1bW4gaW4gcm93KSB7CgkgICAgICBpZiAoIShjb2x1bW4gaW4gY29sdW1uU2V0KSkgewoJICAgICAgICBjb2x1bW5zLnB1c2goY29sdW1uU2V0W2NvbHVtbl0gPSBjb2x1bW4pOwoJICAgICAgfQoJICAgIH0KCSAgfSk7CgoJICByZXR1cm4gY29sdW1uczsKCX0KCglmdW5jdGlvbiBkc3YkMShkZWxpbWl0ZXIpIHsKCSAgdmFyIHJlRm9ybWF0ID0gbmV3IFJlZ0V4cCgiW1wiIiArIGRlbGltaXRlciArICJcbl0iKSwKCSAgICAgIGRlbGltaXRlckNvZGUgPSBkZWxpbWl0ZXIuY2hhckNvZGVBdCgwKTsKCgkgIGZ1bmN0aW9uIHBhcnNlKHRleHQsIGYpIHsKCSAgICB2YXIgY29udmVydCwgY29sdW1ucywgcm93cyA9IHBhcnNlUm93cyh0ZXh0LCBmdW5jdGlvbihyb3csIGkpIHsKCSAgICAgIGlmIChjb252ZXJ0KSByZXR1cm4gY29udmVydChyb3csIGkgLSAxKTsKCSAgICAgIGNvbHVtbnMgPSByb3csIGNvbnZlcnQgPSBmID8gY3VzdG9tQ29udmVydGVyKHJvdywgZikgOiBvYmplY3RDb252ZXJ0ZXIocm93KTsKCSAgICB9KTsKCSAgICByb3dzLmNvbHVtbnMgPSBjb2x1bW5zOwoJICAgIHJldHVybiByb3dzOwoJICB9CgoJICBmdW5jdGlvbiBwYXJzZVJvd3ModGV4dCwgZikgewoJICAgIHZhciBFT0wgPSB7fSwgLy8gc2VudGluZWwgdmFsdWUgZm9yIGVuZC1vZi1saW5lCgkgICAgICAgIEVPRiA9IHt9LCAvLyBzZW50aW5lbCB2YWx1ZSBmb3IgZW5kLW9mLWZpbGUKCSAgICAgICAgcm93cyA9IFtdLCAvLyBvdXRwdXQgcm93cwoJICAgICAgICBOID0gdGV4dC5sZW5ndGgsCgkgICAgICAgIEkgPSAwLCAvLyBjdXJyZW50IGNoYXJhY3RlciBpbmRleAoJICAgICAgICBuID0gMCwgLy8gdGhlIGN1cnJlbnQgbGluZSBudW1iZXIKCSAgICAgICAgdCwgLy8gdGhlIGN1cnJlbnQgdG9rZW4KCSAgICAgICAgZW9sOyAvLyBpcyB0aGUgY3VycmVudCB0b2tlbiBmb2xsb3dlZCBieSBFT0w/CgoJICAgIGZ1bmN0aW9uIHRva2VuKCkgewoJICAgICAgaWYgKEkgPj0gTikgcmV0dXJuIEVPRjsgLy8gc3BlY2lhbCBjYXNlOiBlbmQgb2YgZmlsZQoJICAgICAgaWYgKGVvbCkgcmV0dXJuIGVvbCA9IGZhbHNlLCBFT0w7IC8vIHNwZWNpYWwgY2FzZTogZW5kIG9mIGxpbmUKCgkgICAgICAvLyBzcGVjaWFsIGNhc2U6IHF1b3RlcwoJICAgICAgdmFyIGogPSBJLCBjOwoJICAgICAgaWYgKHRleHQuY2hhckNvZGVBdChqKSA9PT0gMzQpIHsKCSAgICAgICAgdmFyIGkgPSBqOwoJICAgICAgICB3aGlsZSAoaSsrIDwgTikgewoJICAgICAgICAgIGlmICh0ZXh0LmNoYXJDb2RlQXQoaSkgPT09IDM0KSB7CgkgICAgICAgICAgICBpZiAodGV4dC5jaGFyQ29kZUF0KGkgKyAxKSAhPT0gMzQpIGJyZWFrOwoJICAgICAgICAgICAgKytpOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBJID0gaSArIDI7CgkgICAgICAgIGMgPSB0ZXh0LmNoYXJDb2RlQXQoaSArIDEpOwoJICAgICAgICBpZiAoYyA9PT0gMTMpIHsKCSAgICAgICAgICBlb2wgPSB0cnVlOwoJICAgICAgICAgIGlmICh0ZXh0LmNoYXJDb2RlQXQoaSArIDIpID09PSAxMCkgKytJOwoJICAgICAgICB9IGVsc2UgaWYgKGMgPT09IDEwKSB7CgkgICAgICAgICAgZW9sID0gdHJ1ZTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGV4dC5zbGljZShqICsgMSwgaSkucmVwbGFjZSgvIiIvZywgIlwiIik7CgkgICAgICB9CgoJICAgICAgLy8gY29tbW9uIGNhc2U6IGZpbmQgbmV4dCBkZWxpbWl0ZXIgb3IgbmV3bGluZQoJICAgICAgd2hpbGUgKEkgPCBOKSB7CgkgICAgICAgIHZhciBrID0gMTsKCSAgICAgICAgYyA9IHRleHQuY2hhckNvZGVBdChJKyspOwoJICAgICAgICBpZiAoYyA9PT0gMTApIGVvbCA9IHRydWU7IC8vIFxuCgkgICAgICAgIGVsc2UgaWYgKGMgPT09IDEzKSB7IGVvbCA9IHRydWU7IGlmICh0ZXh0LmNoYXJDb2RlQXQoSSkgPT09IDEwKSArK0ksICsrazsgfSAvLyBccnxcclxuCgkgICAgICAgIGVsc2UgaWYgKGMgIT09IGRlbGltaXRlckNvZGUpIGNvbnRpbnVlOwoJICAgICAgICByZXR1cm4gdGV4dC5zbGljZShqLCBJIC0gayk7CgkgICAgICB9CgoJICAgICAgLy8gc3BlY2lhbCBjYXNlOiBsYXN0IHRva2VuIGJlZm9yZSBFT0YKCSAgICAgIHJldHVybiB0ZXh0LnNsaWNlKGopOwoJICAgIH0KCgkgICAgd2hpbGUgKCh0ID0gdG9rZW4oKSkgIT09IEVPRikgewoJICAgICAgdmFyIGEgPSBbXTsKCSAgICAgIHdoaWxlICh0ICE9PSBFT0wgJiYgdCAhPT0gRU9GKSB7CgkgICAgICAgIGEucHVzaCh0KTsKCSAgICAgICAgdCA9IHRva2VuKCk7CgkgICAgICB9CgkgICAgICBpZiAoZiAmJiAoYSA9IGYoYSwgbisrKSkgPT0gbnVsbCkgY29udGludWU7CgkgICAgICByb3dzLnB1c2goYSk7CgkgICAgfQoKCSAgICByZXR1cm4gcm93czsKCSAgfQoKCSAgZnVuY3Rpb24gZm9ybWF0KHJvd3MsIGNvbHVtbnMpIHsKCSAgICBpZiAoY29sdW1ucyA9PSBudWxsKSBjb2x1bW5zID0gaW5mZXJDb2x1bW5zKHJvd3MpOwoJICAgIHJldHVybiBbY29sdW1ucy5tYXAoZm9ybWF0VmFsdWUpLmpvaW4oZGVsaW1pdGVyKV0uY29uY2F0KHJvd3MubWFwKGZ1bmN0aW9uKHJvdykgewoJICAgICAgcmV0dXJuIGNvbHVtbnMubWFwKGZ1bmN0aW9uKGNvbHVtbikgewoJICAgICAgICByZXR1cm4gZm9ybWF0VmFsdWUocm93W2NvbHVtbl0pOwoJICAgICAgfSkuam9pbihkZWxpbWl0ZXIpOwoJICAgIH0pKS5qb2luKCJcbiIpOwoJICB9CgoJICBmdW5jdGlvbiBmb3JtYXRSb3dzKHJvd3MpIHsKCSAgICByZXR1cm4gcm93cy5tYXAoZm9ybWF0Um93KS5qb2luKCJcbiIpOwoJICB9CgoJICBmdW5jdGlvbiBmb3JtYXRSb3cocm93KSB7CgkgICAgcmV0dXJuIHJvdy5tYXAoZm9ybWF0VmFsdWUpLmpvaW4oZGVsaW1pdGVyKTsKCSAgfQoKCSAgZnVuY3Rpb24gZm9ybWF0VmFsdWUodGV4dCkgewoJICAgIHJldHVybiB0ZXh0ID09IG51bGwgPyAiIgoJICAgICAgICA6IHJlRm9ybWF0LnRlc3QodGV4dCArPSAiIikgPyAiXCIiICsgdGV4dC5yZXBsYWNlKC9cIi9nLCAiXCJcIiIpICsgIlwiIgoJICAgICAgICA6IHRleHQ7CgkgIH0KCgkgIHJldHVybiB7CgkgICAgcGFyc2U6IHBhcnNlLAoJICAgIHBhcnNlUm93czogcGFyc2VSb3dzLAoJICAgIGZvcm1hdDogZm9ybWF0LAoJICAgIGZvcm1hdFJvd3M6IGZvcm1hdFJvd3MKCSAgfTsKCX0KCgl2YXIgY3N2ID0gZHN2JDEoIiwiKTsKCgl2YXIgY3N2UGFyc2UgPSBjc3YucGFyc2U7Cgl2YXIgY3N2UGFyc2VSb3dzID0gY3N2LnBhcnNlUm93czsKCXZhciBjc3ZGb3JtYXQgPSBjc3YuZm9ybWF0OwoJdmFyIGNzdkZvcm1hdFJvd3MgPSBjc3YuZm9ybWF0Um93czsKCgl2YXIgdHN2ID0gZHN2JDEoIlx0Iik7CgoJdmFyIHRzdlBhcnNlID0gdHN2LnBhcnNlOwoJdmFyIHRzdlBhcnNlUm93cyA9IHRzdi5wYXJzZVJvd3M7Cgl2YXIgdHN2Rm9ybWF0ID0gdHN2LmZvcm1hdDsKCXZhciB0c3ZGb3JtYXRSb3dzID0gdHN2LmZvcm1hdFJvd3M7CgoJdmFyIGQzRHN2ID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoewoJCV9fcHJvdG9fXzogbnVsbCwKCQljc3ZGb3JtYXQ6IGNzdkZvcm1hdCwKCQljc3ZGb3JtYXRSb3dzOiBjc3ZGb3JtYXRSb3dzLAoJCWNzdlBhcnNlOiBjc3ZQYXJzZSwKCQljc3ZQYXJzZVJvd3M6IGNzdlBhcnNlUm93cywKCQlkc3ZGb3JtYXQ6IGRzdiQxLAoJCXRzdkZvcm1hdDogdHN2Rm9ybWF0LAoJCXRzdkZvcm1hdFJvd3M6IHRzdkZvcm1hdFJvd3MsCgkJdHN2UGFyc2U6IHRzdlBhcnNlLAoJCXRzdlBhcnNlUm93czogdHN2UGFyc2VSb3dzCgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoZDNEc3YpOwoKCXZhciBzZXhhZ2VzaW1hbCQxID0ge2V4cG9ydHM6IHt9fTsKCglzZXhhZ2VzaW1hbCQxLmV4cG9ydHMgPSBlbGVtZW50OwoJc2V4YWdlc2ltYWwkMS5leHBvcnRzLnBhaXIgPSBwYWlyOwoJc2V4YWdlc2ltYWwkMS5leHBvcnRzLmZvcm1hdCA9IGZvcm1hdDsKCXNleGFnZXNpbWFsJDEuZXhwb3J0cy5mb3JtYXRQYWlyID0gZm9ybWF0UGFpcjsKCXNleGFnZXNpbWFsJDEuZXhwb3J0cy5jb29yZFRvRE1TID0gY29vcmRUb0RNUzsKCgoJZnVuY3Rpb24gZWxlbWVudChpbnB1dCwgZGltcykgewoJICB2YXIgcmVzdWx0ID0gc2VhcmNoKGlucHV0LCBkaW1zKTsKCSAgcmV0dXJuIChyZXN1bHQgPT09IG51bGwpID8gbnVsbCA6IHJlc3VsdC52YWw7Cgl9CgoKCWZ1bmN0aW9uIGZvcm1hdFBhaXIoaW5wdXQpIHsKCSAgcmV0dXJuIGZvcm1hdChpbnB1dC5sYXQsICdsYXQnKSArICcgJyArIGZvcm1hdChpbnB1dC5sb24sICdsb24nKTsKCX0KCgoJLy8gSXMgMCBOb3J0aCBvciBTb3V0aD8KCWZ1bmN0aW9uIGZvcm1hdChpbnB1dCwgZGltKSB7CgkgIHZhciBkbXMgPSBjb29yZFRvRE1TKGlucHV0LCBkaW0pOwoJICByZXR1cm4gZG1zLndob2xlICsgJ8KwICcgKwoJICAgIChkbXMubWludXRlcyA/IGRtcy5taW51dGVzICsgJ1wnICcgOiAnJykgKwoJICAgIChkbXMuc2Vjb25kcyA/IGRtcy5zZWNvbmRzICsgJyIgJyA6ICcnKSArIGRtcy5kaXI7Cgl9CgoKCWZ1bmN0aW9uIGNvb3JkVG9ETVMoaW5wdXQsIGRpbSkgewoJICB2YXIgZGlycyA9IHsgbGF0OiBbJ04nLCAnUyddLCBsb246IFsnRScsICdXJ10gfVtkaW1dIHx8ICcnOwoJICB2YXIgZGlyID0gZGlyc1tpbnB1dCA+PSAwID8gMCA6IDFdOwoJICB2YXIgYWJzID0gTWF0aC5hYnMoaW5wdXQpOwoJICB2YXIgd2hvbGUgPSBNYXRoLmZsb29yKGFicyk7CgkgIHZhciBmcmFjdGlvbiA9IGFicyAtIHdob2xlOwoJICB2YXIgZnJhY3Rpb25NaW51dGVzID0gZnJhY3Rpb24gKiA2MDsKCSAgdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKGZyYWN0aW9uTWludXRlcyk7CgkgIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcigoZnJhY3Rpb25NaW51dGVzIC0gbWludXRlcykgKiA2MCk7CgoJICByZXR1cm4gewoJICAgIHdob2xlOiB3aG9sZSwKCSAgICBtaW51dGVzOiBtaW51dGVzLAoJICAgIHNlY29uZHM6IHNlY29uZHMsCgkgICAgZGlyOiBkaXIKCSAgfTsKCX0KCgoJZnVuY3Rpb24gc2VhcmNoKGlucHV0LCBkaW1zKSB7CgkgIGlmICghZGltcykgZGltcyA9ICdOU0VXJzsKCSAgaWYgKHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycpIHJldHVybiBudWxsOwoKCSAgaW5wdXQgPSBpbnB1dC50b1VwcGVyQ2FzZSgpOwoJICB2YXIgcmVnZXggPSAvXltcc1wsXSooW05TRVddKT9ccyooW1wtfFzigJR8XOKAlV0/WzAtOS5dKylbwrDCusuaXT9ccyooPzooWzAtOS5dKylbJ+KAmeKAsuKAmF1ccyopPyg/OihbMC05Ll0rKSg/OicnfCJ84oCdfOKAsylccyopPyhbTlNFV10pPy87CgoJICB2YXIgbSA9IGlucHV0Lm1hdGNoKHJlZ2V4KTsKCSAgaWYgKCFtKSByZXR1cm4gbnVsbDsgIC8vIG5vIG1hdGNoCgoJICB2YXIgbWF0Y2hlZCA9IG1bMF07CgoJICAvLyBleHRyYWN0IGRpbWVuc2lvbi4uIG1bMV0gPSBsZWFkaW5nLCBtWzVdID0gdHJhaWxpbmcKCSAgdmFyIGRpbTsKCSAgaWYgKG1bMV0gJiYgbVs1XSkgeyAgICAgICAgICAgICAgICAgLy8gaWYgbWF0Y2hlZCBib3RoLi4KCSAgICBkaW0gPSBtWzFdOyAgICAgICAgICAgICAgICAgICAgICAgLy8ga2VlcCBsZWFkaW5nCgkgICAgbWF0Y2hlZCA9IG1hdGNoZWQuc2xpY2UoMCwgLTEpOyAgIC8vIHJlbW92ZSB0cmFpbGluZyBkaW1lbnNpb24gZnJvbSBtYXRjaAoJICB9IGVsc2UgewoJICAgIGRpbSA9IG1bMV0gfHwgbVs1XTsKCSAgfQoKCSAgLy8gaWYgdW5yZWNvZ25pemVkIGRpbWVuc2lvbgoJICBpZiAoZGltICYmIGRpbXMuaW5kZXhPZihkaW0pID09PSAtMSkgcmV0dXJuIG51bGw7CgoJICAvLyBleHRyYWN0IERNUwoJICB2YXIgZGVnID0gbVsyXSA/IHBhcnNlRmxvYXQobVsyXSkgOiAwOwoJICB2YXIgbWluID0gbVszXSA/IHBhcnNlRmxvYXQobVszXSkgLyA2MCA6IDA7CgkgIHZhciBzZWMgPSBtWzRdID8gcGFyc2VGbG9hdChtWzRdKSAvIDM2MDAgOiAwOwoJICB2YXIgc2lnbiA9IChkZWcgPCAwKSA/IC0xIDogMTsKCSAgaWYgKGRpbSA9PT0gJ1MnIHx8IGRpbSA9PT0gJ1cnKSBzaWduICo9IC0xOwoKCSAgcmV0dXJuIHsKCSAgICB2YWw6IChNYXRoLmFicyhkZWcpICsgbWluICsgc2VjKSAqIHNpZ24sCgkgICAgZGltOiBkaW0sCgkgICAgbWF0Y2hlZDogbWF0Y2hlZCwKCSAgICByZW1haW46IGlucHV0LnNsaWNlKG1hdGNoZWQubGVuZ3RoKQoJICB9OwoJfQoKCglmdW5jdGlvbiBwYWlyKGlucHV0LCBkaW1zKSB7CgkgIGlucHV0ID0gaW5wdXQudHJpbSgpOwoJICB2YXIgb25lID0gc2VhcmNoKGlucHV0LCBkaW1zKTsKCSAgaWYgKCFvbmUpIHJldHVybiBudWxsOwoKCSAgaW5wdXQgPSBvbmUucmVtYWluLnRyaW0oKTsKCSAgdmFyIHR3byA9IHNlYXJjaChpbnB1dCwgZGltcyk7CgkgIGlmICghdHdvIHx8IHR3by5yZW1haW4pIHJldHVybiBudWxsOwoKCSAgaWYgKG9uZS5kaW0pIHsKCSAgICByZXR1cm4gc3dhcGRpbShvbmUudmFsLCB0d28udmFsLCBvbmUuZGltKTsKCSAgfSBlbHNlIHsKCSAgICByZXR1cm4gW29uZS52YWwsIHR3by52YWxdOwoJICB9Cgl9CgoKCWZ1bmN0aW9uIHN3YXBkaW0oYSwgYiwgZGltKSB7CgkgIGlmIChkaW0gPT09ICdOJyB8fCBkaW0gPT09ICdTJykgcmV0dXJuIFthLCBiXTsKCSAgaWYgKGRpbSA9PT0gJ1cnIHx8IGRpbSA9PT0gJ0UnKSByZXR1cm4gW2IsIGFdOwoJfQoKCXZhciBzZXhhZ2VzaW1hbEV4cG9ydHMgPSBzZXhhZ2VzaW1hbCQxLmV4cG9ydHM7CgoJdmFyIGRzdiA9IHJlcXVpcmUkJDAsCgkgICAgc2V4YWdlc2ltYWwgPSBzZXhhZ2VzaW1hbEV4cG9ydHM7CgoJdmFyIGxhdFJlZ2V4ID0gLyhMYXQpKGl0dWRlKT8vZ2ksCgkgICAgbG9uUmVnZXggPSAvKEwpKG9ufG5nKShnaXR1ZGUpPy9pOwoKCWZ1bmN0aW9uIGd1ZXNzSGVhZGVyKHJvdywgcmVnZXhwKSB7CgkgICAgdmFyIG5hbWUsIG1hdGNoLCBzY29yZTsKCSAgICBmb3IgKHZhciBmIGluIHJvdykgewoJICAgICAgICBtYXRjaCA9IGYubWF0Y2gocmVnZXhwKTsKCSAgICAgICAgaWYgKG1hdGNoICYmICghbmFtZSB8fCBtYXRjaFswXS5sZW5ndGggLyBmLmxlbmd0aCA+IHNjb3JlKSkgewoJICAgICAgICAgICAgc2NvcmUgPSBtYXRjaFswXS5sZW5ndGggLyBmLmxlbmd0aDsKCSAgICAgICAgICAgIG5hbWUgPSBmOwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiBuYW1lOwoJfQoKCWZ1bmN0aW9uIGd1ZXNzTGF0SGVhZGVyKHJvdykgeyByZXR1cm4gZ3Vlc3NIZWFkZXIocm93LCBsYXRSZWdleCk7IH0KCWZ1bmN0aW9uIGd1ZXNzTG9uSGVhZGVyKHJvdykgeyByZXR1cm4gZ3Vlc3NIZWFkZXIocm93LCBsb25SZWdleCk7IH0KCglmdW5jdGlvbiBpc0xhdChmKSB7IHJldHVybiAhIWYubWF0Y2gobGF0UmVnZXgpOyB9CglmdW5jdGlvbiBpc0xvbihmKSB7IHJldHVybiAhIWYubWF0Y2gobG9uUmVnZXgpOyB9CgoJZnVuY3Rpb24ga2V5Q291bnQobykgewoJICAgIHJldHVybiAodHlwZW9mIG8gPT0gJ29iamVjdCcpID8gT2JqZWN0LmtleXMobykubGVuZ3RoIDogMDsKCX0KCglmdW5jdGlvbiBhdXRvRGVsaW1pdGVyKHgpIHsKCSAgICB2YXIgZGVsaW1pdGVycyA9IFsnLCcsICc7JywgJ1x0JywgJ3wnXTsKCSAgICB2YXIgcmVzdWx0cyA9IFtdOwoKCSAgICBkZWxpbWl0ZXJzLmZvckVhY2goZnVuY3Rpb24gKGRlbGltaXRlcikgewoJICAgICAgICB2YXIgcmVzID0gZHN2LmRzdkZvcm1hdChkZWxpbWl0ZXIpLnBhcnNlKHgpOwoJICAgICAgICBpZiAocmVzLmxlbmd0aCA+PSAxKSB7CgkgICAgICAgICAgICB2YXIgY291bnQgPSBrZXlDb3VudChyZXNbMF0pOwoJICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoa2V5Q291bnQocmVzW2ldKSAhPT0gY291bnQpIHJldHVybjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7CgkgICAgICAgICAgICAgICAgZGVsaW1pdGVyOiBkZWxpbWl0ZXIsCgkgICAgICAgICAgICAgICAgYXJpdHk6IE9iamVjdC5rZXlzKHJlc1swXSkubGVuZ3RoLAoJICAgICAgICAgICAgfSk7CgkgICAgICAgIH0KCSAgICB9KTsKCgkgICAgaWYgKHJlc3VsdHMubGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiByZXN1bHRzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKCSAgICAgICAgICAgIHJldHVybiBiLmFyaXR5IC0gYS5hcml0eTsKCSAgICAgICAgfSlbMF0uZGVsaW1pdGVyOwoJICAgIH0gZWxzZSB7CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH0KCX0KCgkvKioKCSAqIFNpbGx5IHN0b3BnYXAgZm9yIGRzdiB0byBkMy1kc3YgdXBncmFkZQoJICoKCSAqIEBwYXJhbSB7QXJyYXl9IHggZHN2IG91dHB1dAoJICogQHJldHVybnMge0FycmF5fSBhcnJheSB3aXRob3V0IGNvbHVtbnMgbWVtYmVyCgkgKi8KCWZ1bmN0aW9uIGRlbGV0ZUNvbHVtbnMoeCkgewoJICAgIGRlbGV0ZSB4LmNvbHVtbnM7CgkgICAgcmV0dXJuIHg7Cgl9CgoJZnVuY3Rpb24gYXV0byh4KSB7CgkgICAgdmFyIGRlbGltaXRlciA9IGF1dG9EZWxpbWl0ZXIoeCk7CgkgICAgaWYgKCFkZWxpbWl0ZXIpIHJldHVybiBudWxsOwoJICAgIHJldHVybiBkZWxldGVDb2x1bW5zKGRzdi5kc3ZGb3JtYXQoZGVsaW1pdGVyKS5wYXJzZSh4KSk7Cgl9CgoJZnVuY3Rpb24gY3N2Mmdlb2pzb24oeCwgb3B0aW9ucywgY2FsbGJhY2spIHsKCgkgICAgaWYgKCFjYWxsYmFjaykgewoJICAgICAgICBjYWxsYmFjayA9IG9wdGlvbnM7CgkgICAgICAgIG9wdGlvbnMgPSB7fTsKCSAgICB9CgoJICAgIG9wdGlvbnMuZGVsaW1pdGVyID0gb3B0aW9ucy5kZWxpbWl0ZXIgfHwgJywnOwoKCSAgICB2YXIgbGF0ZmllbGQgPSBvcHRpb25zLmxhdGZpZWxkIHx8ICcnLAoJICAgICAgICBsb25maWVsZCA9IG9wdGlvbnMubG9uZmllbGQgfHwgJycsCgkgICAgICAgIGNycyA9IG9wdGlvbnMuY3JzIHx8ICcnOwoKCSAgICB2YXIgZmVhdHVyZXMgPSBbXSwKCSAgICAgICAgZmVhdHVyZWNvbGxlY3Rpb24gPSB7dHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywgZmVhdHVyZXM6IGZlYXR1cmVzfTsKCgkgICAgaWYgKGNycyAhPT0gJycpIHsKCSAgICAgICAgZmVhdHVyZWNvbGxlY3Rpb24uY3JzID0ge3R5cGU6ICduYW1lJywgcHJvcGVydGllczoge25hbWU6IGNyc319OwoJICAgIH0KCgkgICAgaWYgKG9wdGlvbnMuZGVsaW1pdGVyID09PSAnYXV0bycgJiYgdHlwZW9mIHggPT0gJ3N0cmluZycpIHsKCSAgICAgICAgb3B0aW9ucy5kZWxpbWl0ZXIgPSBhdXRvRGVsaW1pdGVyKHgpOwoJICAgICAgICBpZiAoIW9wdGlvbnMuZGVsaW1pdGVyKSB7CgkgICAgICAgICAgICBjYWxsYmFjayh7CgkgICAgICAgICAgICAgICAgdHlwZTogJ0Vycm9yJywKCSAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQ291bGQgbm90IGF1dG9kZXRlY3QgZGVsaW1pdGVyJwoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICByZXR1cm47CgkgICAgICAgIH0KCSAgICB9CgoJICAgIHZhciBudW1lcmljRmllbGRzID0gb3B0aW9ucy5udW1lcmljRmllbGRzID8gb3B0aW9ucy5udW1lcmljRmllbGRzLnNwbGl0KCcsJykgOiBudWxsOwoKCSAgICB2YXIgcGFyc2VkID0gKHR5cGVvZiB4ID09ICdzdHJpbmcnKSA/CgkgICAgICAgIGRzdi5kc3ZGb3JtYXQob3B0aW9ucy5kZWxpbWl0ZXIpLnBhcnNlKHgsIGZ1bmN0aW9uIChkKSB7CgkgICAgICAgICAgICBpZiAobnVtZXJpY0ZpZWxkcykgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChudW1lcmljRmllbGRzLmluY2x1ZGVzKGtleSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGRba2V5XSA9ICtkW2tleV07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXR1cm4gZDsKCSAgICAgICAgfSkgOiB4OwoKCSAgICBpZiAoIXBhcnNlZC5sZW5ndGgpIHsKCSAgICAgICAgY2FsbGJhY2sobnVsbCwgZmVhdHVyZWNvbGxlY3Rpb24pOwoJICAgICAgICByZXR1cm47CgkgICAgfQoKCSAgICB2YXIgZXJyb3JzID0gW107CgkgICAgdmFyIGk7CgoKCSAgICBpZiAoIWxhdGZpZWxkKSBsYXRmaWVsZCA9IGd1ZXNzTGF0SGVhZGVyKHBhcnNlZFswXSk7CgkgICAgaWYgKCFsb25maWVsZCkgbG9uZmllbGQgPSBndWVzc0xvbkhlYWRlcihwYXJzZWRbMF0pOwoJICAgIHZhciBub0dlb21ldHJ5ID0gKCFsYXRmaWVsZCB8fCAhbG9uZmllbGQpOwoKCSAgICBpZiAobm9HZW9tZXRyeSkgewoJICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGFyc2VkLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICBmZWF0dXJlcy5wdXNoKHsKCSAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgICAgICAgICAgcHJvcGVydGllczogcGFyc2VkW2ldLAoJICAgICAgICAgICAgICAgIGdlb21ldHJ5OiBudWxsCgkgICAgICAgICAgICB9KTsKCSAgICAgICAgfQoJICAgICAgICBjYWxsYmFjayhlcnJvcnMubGVuZ3RoID8gZXJyb3JzIDogbnVsbCwgZmVhdHVyZWNvbGxlY3Rpb24pOwoJICAgICAgICByZXR1cm47CgkgICAgfQoKCSAgICBmb3IgKGkgPSAwOyBpIDwgcGFyc2VkLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGlmIChwYXJzZWRbaV1bbG9uZmllbGRdICE9PSB1bmRlZmluZWQgJiYKCSAgICAgICAgICAgIHBhcnNlZFtpXVtsYXRmaWVsZF0gIT09IHVuZGVmaW5lZCkgewoKCSAgICAgICAgICAgIHZhciBsb25rID0gcGFyc2VkW2ldW2xvbmZpZWxkXSwKCSAgICAgICAgICAgICAgICBsYXRrID0gcGFyc2VkW2ldW2xhdGZpZWxkXSwKCSAgICAgICAgICAgICAgICBsb25mLCBsYXRmLAoJICAgICAgICAgICAgICAgIGE7CgoJICAgICAgICAgICAgYSA9IHNleGFnZXNpbWFsKGxvbmssICdFVycpOwoJICAgICAgICAgICAgaWYgKGEpIGxvbmsgPSBhOwoJICAgICAgICAgICAgYSA9IHNleGFnZXNpbWFsKGxhdGssICdOUycpOwoJICAgICAgICAgICAgaWYgKGEpIGxhdGsgPSBhOwoKCSAgICAgICAgICAgIGxvbmYgPSBwYXJzZUZsb2F0KGxvbmspOwoJICAgICAgICAgICAgbGF0ZiA9IHBhcnNlRmxvYXQobGF0ayk7CgoJICAgICAgICAgICAgaWYgKGlzTmFOKGxvbmYpIHx8CgkgICAgICAgICAgICAgICAgaXNOYU4obGF0ZikpIHsKCSAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7CgkgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdBIHJvdyBjb250YWluZWQgYW4gaW52YWxpZCB2YWx1ZSBmb3IgbGF0aXR1ZGUgb3IgbG9uZ2l0dWRlJywKCSAgICAgICAgICAgICAgICAgICAgcm93OiBwYXJzZWRbaV0sCgkgICAgICAgICAgICAgICAgICAgIGluZGV4OiBpCgkgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy5pbmNsdWRlTGF0TG9uKSB7CgkgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwYXJzZWRbaV1bbG9uZmllbGRdOwoJICAgICAgICAgICAgICAgICAgICBkZWxldGUgcGFyc2VkW2ldW2xhdGZpZWxkXTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIGZlYXR1cmVzLnB1c2goewoJICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHBhcnNlZFtpXSwKCSAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnk6IHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogWwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQobG9uZiksCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChsYXRmKQoJICAgICAgICAgICAgICAgICAgICAgICAgXQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGNhbGxiYWNrKGVycm9ycy5sZW5ndGggPyBlcnJvcnMgOiBudWxsLCBmZWF0dXJlY29sbGVjdGlvbik7Cgl9CgoJZnVuY3Rpb24gdG9MaW5lKGdqKSB7CgkgICAgdmFyIGZlYXR1cmVzID0gZ2ouZmVhdHVyZXM7CgkgICAgdmFyIGxpbmUgPSB7CgkgICAgICAgIHR5cGU6ICdGZWF0dXJlJywKCSAgICAgICAgZ2VvbWV0cnk6IHsKCSAgICAgICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJywKCSAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbXQoJICAgICAgICB9CgkgICAgfTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMucHVzaChmZWF0dXJlc1tpXS5nZW9tZXRyeS5jb29yZGluYXRlcyk7CgkgICAgfQoJICAgIGxpbmUucHJvcGVydGllcyA9IGZlYXR1cmVzLnJlZHVjZShmdW5jdGlvbiAoYWdncmVnYXRlZFByb3BlcnRpZXMsIG5ld0ZlYXR1cmUpIHsKCSAgICAgICAgZm9yICh2YXIga2V5IGluIG5ld0ZlYXR1cmUucHJvcGVydGllcykgewoJICAgICAgICAgICAgaWYgKCFhZ2dyZWdhdGVkUHJvcGVydGllc1trZXldKSB7CgkgICAgICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XSA9IFtdOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XS5wdXNoKG5ld0ZlYXR1cmUucHJvcGVydGllc1trZXldKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYWdncmVnYXRlZFByb3BlcnRpZXM7CgkgICAgfSwge30pOwoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCgkgICAgICAgIGZlYXR1cmVzOiBbbGluZV0KCSAgICB9OwoJfQoKCWZ1bmN0aW9uIHRvUG9seWdvbihnaikgewoJICAgIHZhciBmZWF0dXJlcyA9IGdqLmZlYXR1cmVzOwoJICAgIHZhciBwb2x5ID0gewoJICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICB0eXBlOiAnUG9seWdvbicsCgkgICAgICAgICAgICBjb29yZGluYXRlczogW1tdXQoJICAgICAgICB9CgkgICAgfTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIHBvbHkuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0ucHVzaChmZWF0dXJlc1tpXS5nZW9tZXRyeS5jb29yZGluYXRlcyk7CgkgICAgfQoJICAgIHBvbHkucHJvcGVydGllcyA9IGZlYXR1cmVzLnJlZHVjZShmdW5jdGlvbiAoYWdncmVnYXRlZFByb3BlcnRpZXMsIG5ld0ZlYXR1cmUpIHsKCSAgICAgICAgZm9yICh2YXIga2V5IGluIG5ld0ZlYXR1cmUucHJvcGVydGllcykgewoJICAgICAgICAgICAgaWYgKCFhZ2dyZWdhdGVkUHJvcGVydGllc1trZXldKSB7CgkgICAgICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XSA9IFtdOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XS5wdXNoKG5ld0ZlYXR1cmUucHJvcGVydGllc1trZXldKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYWdncmVnYXRlZFByb3BlcnRpZXM7CgkgICAgfSwge30pOwoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCgkgICAgICAgIGZlYXR1cmVzOiBbcG9seV0KCSAgICB9OwoJfQoKCXZhciBjc3YyZ2VvanNvbl8xID0gewoJICAgIGlzTG9uOiBpc0xvbiwKCSAgICBpc0xhdDogaXNMYXQsCgkgICAgZ3Vlc3NMYXRIZWFkZXI6IGd1ZXNzTGF0SGVhZGVyLAoJICAgIGd1ZXNzTG9uSGVhZGVyOiBndWVzc0xvbkhlYWRlciwKCSAgICBjc3Y6IGRzdi5jc3ZQYXJzZSwKCSAgICB0c3Y6IGRzdi50c3ZQYXJzZSwKCSAgICBkc3Y6IGRzdiwKCSAgICBhdXRvOiBhdXRvLAoJICAgIGNzdjJnZW9qc29uOiBjc3YyZ2VvanNvbiwKCSAgICB0b0xpbmU6IHRvTGluZSwKCSAgICB0b1BvbHlnb246IHRvUG9seWdvbgoJfTsKCglmdW5jdGlvbiBpZGVudGl0eSh4KSB7CgkgIHJldHVybiB4OwoJfQoKCWZ1bmN0aW9uIHRyYW5zZm9ybSh0cmFuc2Zvcm0pIHsKCSAgaWYgKHRyYW5zZm9ybSA9PSBudWxsKSByZXR1cm4gaWRlbnRpdHk7CgkgIHZhciB4MCwKCSAgICAgIHkwLAoJICAgICAga3ggPSB0cmFuc2Zvcm0uc2NhbGVbMF0sCgkgICAgICBreSA9IHRyYW5zZm9ybS5zY2FsZVsxXSwKCSAgICAgIGR4ID0gdHJhbnNmb3JtLnRyYW5zbGF0ZVswXSwKCSAgICAgIGR5ID0gdHJhbnNmb3JtLnRyYW5zbGF0ZVsxXTsKCSAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBpKSB7CgkgICAgaWYgKCFpKSB4MCA9IHkwID0gMDsKCSAgICB2YXIgaiA9IDIsIG4gPSBpbnB1dC5sZW5ndGgsIG91dHB1dCA9IG5ldyBBcnJheShuKTsKCSAgICBvdXRwdXRbMF0gPSAoeDAgKz0gaW5wdXRbMF0pICoga3ggKyBkeDsKCSAgICBvdXRwdXRbMV0gPSAoeTAgKz0gaW5wdXRbMV0pICoga3kgKyBkeTsKCSAgICB3aGlsZSAoaiA8IG4pIG91dHB1dFtqXSA9IGlucHV0W2pdLCArK2o7CgkgICAgcmV0dXJuIG91dHB1dDsKCSAgfTsKCX0KCglmdW5jdGlvbiByZXZlcnNlKGFycmF5LCBuKSB7CgkgIHZhciB0LCBqID0gYXJyYXkubGVuZ3RoLCBpID0gaiAtIG47CgkgIHdoaWxlIChpIDwgLS1qKSB0ID0gYXJyYXlbaV0sIGFycmF5W2krK10gPSBhcnJheVtqXSwgYXJyYXlbal0gPSB0OwoJfQoKCWZ1bmN0aW9uIHRvcG9qc29uRmVhdHVyZSh0b3BvbG9neSwgbykgewoJICBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSBvID0gdG9wb2xvZ3kub2JqZWN0c1tvXTsKCSAgcmV0dXJuIG8udHlwZSA9PT0gIkdlb21ldHJ5Q29sbGVjdGlvbiIKCSAgICAgID8ge3R5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsIGZlYXR1cmVzOiBvLmdlb21ldHJpZXMubWFwKGZ1bmN0aW9uKG8pIHsgcmV0dXJuIGZlYXR1cmUodG9wb2xvZ3ksIG8pOyB9KX0KCSAgICAgIDogZmVhdHVyZSh0b3BvbG9neSwgbyk7Cgl9CgoJZnVuY3Rpb24gZmVhdHVyZSh0b3BvbG9neSwgbykgewoJICB2YXIgaWQgPSBvLmlkLAoJICAgICAgYmJveCA9IG8uYmJveCwKCSAgICAgIHByb3BlcnRpZXMgPSBvLnByb3BlcnRpZXMgPT0gbnVsbCA/IHt9IDogby5wcm9wZXJ0aWVzLAoJICAgICAgZ2VvbWV0cnkgPSBvYmplY3QodG9wb2xvZ3ksIG8pOwoJICByZXR1cm4gaWQgPT0gbnVsbCAmJiBiYm94ID09IG51bGwgPyB7dHlwZTogIkZlYXR1cmUiLCBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLCBnZW9tZXRyeTogZ2VvbWV0cnl9CgkgICAgICA6IGJib3ggPT0gbnVsbCA/IHt0eXBlOiAiRmVhdHVyZSIsIGlkOiBpZCwgcHJvcGVydGllczogcHJvcGVydGllcywgZ2VvbWV0cnk6IGdlb21ldHJ5fQoJICAgICAgOiB7dHlwZTogIkZlYXR1cmUiLCBpZDogaWQsIGJib3g6IGJib3gsIHByb3BlcnRpZXM6IHByb3BlcnRpZXMsIGdlb21ldHJ5OiBnZW9tZXRyeX07Cgl9CgoJZnVuY3Rpb24gb2JqZWN0KHRvcG9sb2d5LCBvKSB7CgkgIHZhciB0cmFuc2Zvcm1Qb2ludCA9IHRyYW5zZm9ybSh0b3BvbG9neS50cmFuc2Zvcm0pLAoJICAgICAgYXJjcyA9IHRvcG9sb2d5LmFyY3M7CgoJICBmdW5jdGlvbiBhcmMoaSwgcG9pbnRzKSB7CgkgICAgaWYgKHBvaW50cy5sZW5ndGgpIHBvaW50cy5wb3AoKTsKCSAgICBmb3IgKHZhciBhID0gYXJjc1tpIDwgMCA/IH5pIDogaV0sIGsgPSAwLCBuID0gYS5sZW5ndGg7IGsgPCBuOyArK2spIHsKCSAgICAgIHBvaW50cy5wdXNoKHRyYW5zZm9ybVBvaW50KGFba10sIGspKTsKCSAgICB9CgkgICAgaWYgKGkgPCAwKSByZXZlcnNlKHBvaW50cywgbik7CgkgIH0KCgkgIGZ1bmN0aW9uIHBvaW50KHApIHsKCSAgICByZXR1cm4gdHJhbnNmb3JtUG9pbnQocCk7CgkgIH0KCgkgIGZ1bmN0aW9uIGxpbmUoYXJjcykgewoJICAgIHZhciBwb2ludHMgPSBbXTsKCSAgICBmb3IgKHZhciBpID0gMCwgbiA9IGFyY3MubGVuZ3RoOyBpIDwgbjsgKytpKSBhcmMoYXJjc1tpXSwgcG9pbnRzKTsKCSAgICBpZiAocG9pbnRzLmxlbmd0aCA8IDIpIHBvaW50cy5wdXNoKHBvaW50c1swXSk7IC8vIFRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiBwZXIgdGhlIHNwZWNpZmljYXRpb24uCgkgICAgcmV0dXJuIHBvaW50czsKCSAgfQoKCSAgZnVuY3Rpb24gcmluZyhhcmNzKSB7CgkgICAgdmFyIHBvaW50cyA9IGxpbmUoYXJjcyk7CgkgICAgd2hpbGUgKHBvaW50cy5sZW5ndGggPCA0KSBwb2ludHMucHVzaChwb2ludHNbMF0pOyAvLyBUaGlzIG1heSBoYXBwZW4gaWYgYW4gYXJjIGhhcyBvbmx5IHR3byBwb2ludHMuCgkgICAgcmV0dXJuIHBvaW50czsKCSAgfQoKCSAgZnVuY3Rpb24gcG9seWdvbihhcmNzKSB7CgkgICAgcmV0dXJuIGFyY3MubWFwKHJpbmcpOwoJICB9CgoJICBmdW5jdGlvbiBnZW9tZXRyeShvKSB7CgkgICAgdmFyIHR5cGUgPSBvLnR5cGUsIGNvb3JkaW5hdGVzOwoJICAgIHN3aXRjaCAodHlwZSkgewoJICAgICAgY2FzZSAiR2VvbWV0cnlDb2xsZWN0aW9uIjogcmV0dXJuIHt0eXBlOiB0eXBlLCBnZW9tZXRyaWVzOiBvLmdlb21ldHJpZXMubWFwKGdlb21ldHJ5KX07CgkgICAgICBjYXNlICJQb2ludCI6IGNvb3JkaW5hdGVzID0gcG9pbnQoby5jb29yZGluYXRlcyk7IGJyZWFrOwoJICAgICAgY2FzZSAiTXVsdGlQb2ludCI6IGNvb3JkaW5hdGVzID0gby5jb29yZGluYXRlcy5tYXAocG9pbnQpOyBicmVhazsKCSAgICAgIGNhc2UgIkxpbmVTdHJpbmciOiBjb29yZGluYXRlcyA9IGxpbmUoby5hcmNzKTsgYnJlYWs7CgkgICAgICBjYXNlICJNdWx0aUxpbmVTdHJpbmciOiBjb29yZGluYXRlcyA9IG8uYXJjcy5tYXAobGluZSk7IGJyZWFrOwoJICAgICAgY2FzZSAiUG9seWdvbiI6IGNvb3JkaW5hdGVzID0gcG9seWdvbihvLmFyY3MpOyBicmVhazsKCSAgICAgIGNhc2UgIk11bHRpUG9seWdvbiI6IGNvb3JkaW5hdGVzID0gby5hcmNzLm1hcChwb2x5Z29uKTsgYnJlYWs7CgkgICAgICBkZWZhdWx0OiByZXR1cm4gbnVsbDsKCSAgICB9CgkgICAgcmV0dXJuIHt0eXBlOiB0eXBlLCBjb29yZGluYXRlczogY29vcmRpbmF0ZXN9OwoJICB9CgoJICByZXR1cm4gZ2VvbWV0cnkobyk7Cgl9CgoJZnVuY3Rpb24gJChlbGVtZW50LCB0YWdOYW1lKSB7CgkgICAgcmV0dXJuIEFycmF5LmZyb20oZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKSk7Cgl9CglmdW5jdGlvbiBub3JtYWxpemVJZChpZCkgewoJICAgIHJldHVybiBpZFswXSA9PT0gIiMiID8gaWQgOiBgIyR7aWR9YDsKCX0KCWZ1bmN0aW9uICRucyhlbGVtZW50LCB0YWdOYW1lLCBucykgewoJICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhucywgdGFnTmFtZSkpOwoJfQoJLyoqCgkgKiBnZXQgdGhlIGNvbnRlbnQgb2YgYSB0ZXh0IG5vZGUsIGlmIGFueQoJICovCglmdW5jdGlvbiBub2RlVmFsKG5vZGUpIHsKCSAgICBub2RlPy5ub3JtYWxpemUoKTsKCSAgICByZXR1cm4gKG5vZGUgJiYgbm9kZS50ZXh0Q29udGVudCkgfHwgIiI7Cgl9CgkvKioKCSAqIEdldCBvbmUgWSBjaGlsZCBvZiBYLCBpZiBhbnksIG90aGVyd2lzZSBudWxsCgkgKi8KCWZ1bmN0aW9uIGdldDEobm9kZSwgdGFnTmFtZSwgY2FsbGJhY2spIHsKCSAgICBjb25zdCBuID0gbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKTsKCSAgICBjb25zdCByZXN1bHQgPSBuLmxlbmd0aCA/IG5bMF0gOiBudWxsOwoJICAgIGlmIChyZXN1bHQgJiYgY2FsbGJhY2spCgkgICAgICAgIGNhbGxiYWNrKHJlc3VsdCk7CgkgICAgcmV0dXJuIHJlc3VsdDsKCX0KCWZ1bmN0aW9uIGdldChub2RlLCB0YWdOYW1lLCBjYWxsYmFjaykgewoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7fTsKCSAgICBpZiAoIW5vZGUpCgkgICAgICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJICAgIGNvbnN0IG4gPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZ05hbWUpOwoJICAgIGNvbnN0IHJlc3VsdCA9IG4ubGVuZ3RoID8gblswXSA6IG51bGw7CgkgICAgaWYgKHJlc3VsdCAmJiBjYWxsYmFjaykgewoJICAgICAgICByZXR1cm4gY2FsbGJhY2socmVzdWx0LCBwcm9wZXJ0aWVzKTsKCSAgICB9CgkgICAgcmV0dXJuIHByb3BlcnRpZXM7Cgl9CglmdW5jdGlvbiB2YWwxKG5vZGUsIHRhZ05hbWUsIGNhbGxiYWNrKSB7CgkgICAgY29uc3QgdmFsID0gbm9kZVZhbChnZXQxKG5vZGUsIHRhZ05hbWUpKTsKCSAgICBpZiAodmFsICYmIGNhbGxiYWNrKQoJICAgICAgICByZXR1cm4gY2FsbGJhY2sodmFsKSB8fCB7fTsKCSAgICByZXR1cm4ge307Cgl9CglmdW5jdGlvbiAkbnVtKG5vZGUsIHRhZ05hbWUsIGNhbGxiYWNrKSB7CgkgICAgY29uc3QgdmFsID0gcGFyc2VGbG9hdChub2RlVmFsKGdldDEobm9kZSwgdGFnTmFtZSkpKTsKCSAgICBpZiAoaXNOYU4odmFsKSkKCSAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCSAgICBpZiAodmFsICYmIGNhbGxiYWNrKQoJICAgICAgICByZXR1cm4gY2FsbGJhY2sodmFsKSB8fCB7fTsKCSAgICByZXR1cm4ge307Cgl9CglmdW5jdGlvbiBudW0xKG5vZGUsIHRhZ05hbWUsIGNhbGxiYWNrKSB7CgkgICAgY29uc3QgdmFsID0gcGFyc2VGbG9hdChub2RlVmFsKGdldDEobm9kZSwgdGFnTmFtZSkpKTsKCSAgICBpZiAoaXNOYU4odmFsKSkKCSAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCSAgICBpZiAoY2FsbGJhY2spCgkgICAgICAgIGNhbGxiYWNrKHZhbCk7CgkgICAgcmV0dXJuIHZhbDsKCX0KCWZ1bmN0aW9uIGdldE11bHRpKG5vZGUsIHByb3BlcnR5TmFtZXMpIHsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0ge307CgkgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBvZiBwcm9wZXJ0eU5hbWVzKSB7CgkgICAgICAgIHZhbDEobm9kZSwgcHJvcGVydHksICh2YWwpID0+IHsKCSAgICAgICAgICAgIHByb3BlcnRpZXNbcHJvcGVydHldID0gdmFsOwoJICAgICAgICB9KTsKCSAgICB9CgkgICAgcmV0dXJuIHByb3BlcnRpZXM7Cgl9CglmdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkgewoJICAgIHJldHVybiBub2RlPy5ub2RlVHlwZSA9PT0gMTsKCX0KCglmdW5jdGlvbiBnZXRMaW5lU3R5bGUobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgImxpbmUiLCAobGluZVN0eWxlKSA9PiB7CgkgICAgICAgIGNvbnN0IHZhbCA9IE9iamVjdC5hc3NpZ24oe30sIHZhbDEobGluZVN0eWxlLCAiY29sb3IiLCAoY29sb3IpID0+IHsKCSAgICAgICAgICAgIHJldHVybiB7IHN0cm9rZTogYCMke2NvbG9yfWAgfTsKCSAgICAgICAgfSksICRudW0obGluZVN0eWxlLCAib3BhY2l0eSIsIChvcGFjaXR5KSA9PiB7CgkgICAgICAgICAgICByZXR1cm4geyAic3Ryb2tlLW9wYWNpdHkiOiBvcGFjaXR5IH07CgkgICAgICAgIH0pLCAkbnVtKGxpbmVTdHlsZSwgIndpZHRoIiwgKHdpZHRoKSA9PiB7CgkgICAgICAgICAgICAvLyBHUFggd2lkdGggaXMgaW4gbW0sIGNvbnZlcnQgdG8gcHggd2l0aCA5NiBweCBwZXIgaW5jaAoJICAgICAgICAgICAgcmV0dXJuIHsgInN0cm9rZS13aWR0aCI6ICh3aWR0aCAqIDk2KSAvIDI1LjQgfTsKCSAgICAgICAgfSkpOwoJICAgICAgICByZXR1cm4gdmFsOwoJICAgIH0pOwoJfQoKCWZ1bmN0aW9uIGdldEV4dGVuc2lvbnMobm9kZSkgewoJICAgIGxldCB2YWx1ZXMgPSBbXTsKCSAgICBpZiAobm9kZSA9PT0gbnVsbCkKCSAgICAgICAgcmV0dXJuIHZhbHVlczsKCSAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIEFycmF5LmZyb20obm9kZS5jaGlsZE5vZGVzKSkgewoJICAgICAgICBpZiAoIWlzRWxlbWVudChjaGlsZCkpCgkgICAgICAgICAgICBjb250aW51ZTsKCSAgICAgICAgY29uc3QgbmFtZSA9IGFiYnJldmlhdGVOYW1lKGNoaWxkLm5vZGVOYW1lKTsKCSAgICAgICAgaWYgKG5hbWUgPT09ICJncHh0cHg6VHJhY2tQb2ludEV4dGVuc2lvbiIpIHsKCSAgICAgICAgICAgIC8vIGxvb3AgYWdhaW4gZm9yIG5lc3RlZCBnYXJtaW4gZXh0ZW5zaW9ucyAoZWcuICJncHh0cHg6aHIiKQoJICAgICAgICAgICAgdmFsdWVzID0gdmFsdWVzLmNvbmNhdChnZXRFeHRlbnNpb25zKGNoaWxkKSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBwdXNoIGN1c3RvbSBleHRlbnNpb24gKGVnLiAicG93ZXIiKQoJICAgICAgICAgICAgY29uc3QgdmFsID0gbm9kZVZhbChjaGlsZCk7CgkgICAgICAgICAgICB2YWx1ZXMucHVzaChbbmFtZSwgcGFyc2VOdW1lcmljKHZhbCldKTsKCSAgICAgICAgfQoJICAgIH0KCSAgICByZXR1cm4gdmFsdWVzOwoJfQoJZnVuY3Rpb24gYWJicmV2aWF0ZU5hbWUobmFtZSkgewoJICAgIHJldHVybiBbImhlYXJ0IiwgImdweHRweDpociIsICJociJdLmluY2x1ZGVzKG5hbWUpID8gImhlYXJ0IiA6IG5hbWU7Cgl9CglmdW5jdGlvbiBwYXJzZU51bWVyaWModmFsKSB7CgkgICAgY29uc3QgbnVtID0gcGFyc2VGbG9hdCh2YWwpOwoJICAgIHJldHVybiBpc05hTihudW0pID8gdmFsIDogbnVtOwoJfQoKCWZ1bmN0aW9uIGNvb3JkUGFpciQxKG5vZGUpIHsKCSAgICBjb25zdCBsbCA9IFsKCSAgICAgICAgcGFyc2VGbG9hdChub2RlLmdldEF0dHJpYnV0ZSgibG9uIikgfHwgIiIpLAoJICAgICAgICBwYXJzZUZsb2F0KG5vZGUuZ2V0QXR0cmlidXRlKCJsYXQiKSB8fCAiIiksCgkgICAgXTsKCSAgICBpZiAoaXNOYU4obGxbMF0pIHx8IGlzTmFOKGxsWzFdKSkgewoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9CgkgICAgbnVtMShub2RlLCAiZWxlIiwgKHZhbCkgPT4gewoJICAgICAgICBsbC5wdXNoKHZhbCk7CgkgICAgfSk7CgkgICAgY29uc3QgdGltZSA9IGdldDEobm9kZSwgInRpbWUiKTsKCSAgICByZXR1cm4gewoJICAgICAgICBjb29yZGluYXRlczogbGwsCgkgICAgICAgIHRpbWU6IHRpbWUgPyBub2RlVmFsKHRpbWUpIDogbnVsbCwKCSAgICAgICAgZXh0ZW5kZWRWYWx1ZXM6IGdldEV4dGVuc2lvbnMoZ2V0MShub2RlLCAiZXh0ZW5zaW9ucyIpKSwKCSAgICB9OwoJfQoKCWZ1bmN0aW9uIGV4dHJhY3RQcm9wZXJ0aWVzKG5vZGUpIHsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0gZ2V0TXVsdGkobm9kZSwgWwoJICAgICAgICAibmFtZSIsCgkgICAgICAgICJjbXQiLAoJICAgICAgICAiZGVzYyIsCgkgICAgICAgICJ0eXBlIiwKCSAgICAgICAgInRpbWUiLAoJICAgICAgICAia2V5d29yZHMiLAoJICAgIF0pOwoJICAgIGNvbnN0IGV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUygiaHR0cDovL3d3dy5nYXJtaW4uY29tL3htbHNjaGVtYXMvR3B4RXh0ZW5zaW9ucy92MyIsICIqIikpOwoJICAgIGZvciAoY29uc3QgY2hpbGQgb2YgZXh0ZW5zaW9ucykgewoJICAgICAgICBpZiAoY2hpbGQucGFyZW50Tm9kZT8ucGFyZW50Tm9kZSA9PT0gbm9kZSkgewoJICAgICAgICAgICAgcHJvcGVydGllc1tjaGlsZC50YWdOYW1lLnJlcGxhY2UoIjoiLCAiXyIpXSA9IG5vZGVWYWwoY2hpbGQpOwoJICAgICAgICB9CgkgICAgfQoJICAgIGNvbnN0IGxpbmtzID0gJChub2RlLCAibGluayIpOwoJICAgIGlmIChsaW5rcy5sZW5ndGgpIHsKCSAgICAgICAgcHJvcGVydGllcy5saW5rcyA9IGxpbmtzLm1hcCgobGluaykgPT4gT2JqZWN0LmFzc2lnbih7IGhyZWY6IGxpbmsuZ2V0QXR0cmlidXRlKCJocmVmIikgfSwgZ2V0TXVsdGkobGluaywgWyJ0ZXh0IiwgInR5cGUiXSkpKTsKCSAgICB9CgkgICAgcmV0dXJuIHByb3BlcnRpZXM7Cgl9CgoJLyoqCgkgKiBFeHRyYWN0IHBvaW50cyBmcm9tIGEgdHJrc2VnIG9yIHJ0ZSBlbGVtZW50LgoJICovCglmdW5jdGlvbiBnZXRQb2ludHMkMShub2RlLCBwb2ludG5hbWUpIHsKCSAgICBjb25zdCBwdHMgPSAkKG5vZGUsIHBvaW50bmFtZSk7CgkgICAgY29uc3QgbGluZSA9IFtdOwoJICAgIGNvbnN0IHRpbWVzID0gW107CgkgICAgY29uc3QgZXh0ZW5kZWRWYWx1ZXMgPSB7fTsKCSAgICBmb3IgKGxldCBpID0gMDsgaSA8IHB0cy5sZW5ndGg7IGkrKykgewoJICAgICAgICBjb25zdCBjID0gY29vcmRQYWlyJDEocHRzW2ldKTsKCSAgICAgICAgaWYgKCFjKSB7CgkgICAgICAgICAgICBjb250aW51ZTsKCSAgICAgICAgfQoJICAgICAgICBsaW5lLnB1c2goYy5jb29yZGluYXRlcyk7CgkgICAgICAgIGlmIChjLnRpbWUpCgkgICAgICAgICAgICB0aW1lcy5wdXNoKGMudGltZSk7CgkgICAgICAgIGZvciAoY29uc3QgW25hbWUsIHZhbF0gb2YgYy5leHRlbmRlZFZhbHVlcykgewoJICAgICAgICAgICAgY29uc3QgcGx1cmFsID0gbmFtZSA9PT0gImhlYXJ0IiA/IG5hbWUgOiBuYW1lLnJlcGxhY2UoImdweHRweDoiLCAiIikgKyAicyI7CgkgICAgICAgICAgICBpZiAoIWV4dGVuZGVkVmFsdWVzW3BsdXJhbF0pIHsKCSAgICAgICAgICAgICAgICBleHRlbmRlZFZhbHVlc1twbHVyYWxdID0gQXJyYXkocHRzLmxlbmd0aCkuZmlsbChudWxsKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGV4dGVuZGVkVmFsdWVzW3BsdXJhbF1baV0gPSB2YWw7CgkgICAgICAgIH0KCSAgICB9CgkgICAgaWYgKGxpbmUubGVuZ3RoIDwgMikKCSAgICAgICAgcmV0dXJuOyAvLyBJbnZhbGlkIGxpbmUgaW4gR2VvSlNPTgoJICAgIHJldHVybiB7CgkgICAgICAgIGxpbmU6IGxpbmUsCgkgICAgICAgIHRpbWVzOiB0aW1lcywKCSAgICAgICAgZXh0ZW5kZWRWYWx1ZXM6IGV4dGVuZGVkVmFsdWVzLAoJICAgIH07Cgl9CgkvKioKCSAqIEV4dHJhY3QgYSBMaW5lU3RyaW5nIGdlb21ldHJ5IGZyb20gYSBydGUKCSAqIGVsZW1lbnQuCgkgKi8KCWZ1bmN0aW9uIGdldFJvdXRlKG5vZGUpIHsKCSAgICBjb25zdCBsaW5lID0gZ2V0UG9pbnRzJDEobm9kZSwgInJ0ZXB0Iik7CgkgICAgaWYgKCFsaW5lKQoJICAgICAgICByZXR1cm47CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmUiLAoJICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKHsgX2dweFR5cGU6ICJydGUiIH0sIGV4dHJhY3RQcm9wZXJ0aWVzKG5vZGUpLCBnZXRMaW5lU3R5bGUoZ2V0MShub2RlLCAiZXh0ZW5zaW9ucyIpKSksCgkgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICB0eXBlOiAiTGluZVN0cmluZyIsCgkgICAgICAgICAgICBjb29yZGluYXRlczogbGluZS5saW5lLAoJICAgICAgICB9LAoJICAgIH07Cgl9CglmdW5jdGlvbiBnZXRUcmFjayhub2RlKSB7CgkgICAgY29uc3Qgc2VnbWVudHMgPSAkKG5vZGUsICJ0cmtzZWciKTsKCSAgICBjb25zdCB0cmFjayA9IFtdOwoJICAgIGNvbnN0IHRpbWVzID0gW107CgkgICAgY29uc3QgZXh0cmFjdGVkTGluZXMgPSBbXTsKCSAgICBmb3IgKGNvbnN0IHNlZ21lbnQgb2Ygc2VnbWVudHMpIHsKCSAgICAgICAgY29uc3QgbGluZSA9IGdldFBvaW50cyQxKHNlZ21lbnQsICJ0cmtwdCIpOwoJICAgICAgICBpZiAobGluZSkgewoJICAgICAgICAgICAgZXh0cmFjdGVkTGluZXMucHVzaChsaW5lKTsKCSAgICAgICAgICAgIGlmIChsaW5lLnRpbWVzICYmIGxpbmUudGltZXMubGVuZ3RoKQoJICAgICAgICAgICAgICAgIHRpbWVzLnB1c2gobGluZS50aW1lcyk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgaWYgKGV4dHJhY3RlZExpbmVzLmxlbmd0aCA9PT0gMCkKCSAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgY29uc3QgbXVsdGkgPSBleHRyYWN0ZWRMaW5lcy5sZW5ndGggPiAxOwoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSBPYmplY3QuYXNzaWduKHsgX2dweFR5cGU6ICJ0cmsiIH0sIGV4dHJhY3RQcm9wZXJ0aWVzKG5vZGUpLCBnZXRMaW5lU3R5bGUoZ2V0MShub2RlLCAiZXh0ZW5zaW9ucyIpKSwgdGltZXMubGVuZ3RoCgkgICAgICAgID8gewoJICAgICAgICAgICAgY29vcmRpbmF0ZVByb3BlcnRpZXM6IHsKCSAgICAgICAgICAgICAgICB0aW1lczogbXVsdGkgPyB0aW1lcyA6IHRpbWVzWzBdLAoJICAgICAgICAgICAgfSwKCSAgICAgICAgfQoJICAgICAgICA6IHt9KTsKCSAgICBmb3IgKGNvbnN0IGxpbmUgb2YgZXh0cmFjdGVkTGluZXMpIHsKCSAgICAgICAgdHJhY2sucHVzaChsaW5lLmxpbmUpOwoJICAgICAgICBpZiAoIXByb3BlcnRpZXMuY29vcmRpbmF0ZVByb3BlcnRpZXMpIHsKCSAgICAgICAgICAgIHByb3BlcnRpZXMuY29vcmRpbmF0ZVByb3BlcnRpZXMgPSB7fTsKCSAgICAgICAgfQoJICAgICAgICBjb25zdCBwcm9wcyA9IHByb3BlcnRpZXMuY29vcmRpbmF0ZVByb3BlcnRpZXM7CgkgICAgICAgIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhsaW5lLmV4dGVuZGVkVmFsdWVzKTsKCSAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbnRyaWVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICBjb25zdCBbbmFtZSwgdmFsXSA9IGVudHJpZXNbaV07CgkgICAgICAgICAgICBpZiAobXVsdGkpIHsKCSAgICAgICAgICAgICAgICBpZiAoIXByb3BzW25hbWVdKSB7CgkgICAgICAgICAgICAgICAgICAgIHByb3BzW25hbWVdID0gZXh0cmFjdGVkTGluZXMubWFwKChsaW5lKSA9PiBuZXcgQXJyYXkobGluZS5saW5lLmxlbmd0aCkuZmlsbChudWxsKSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHByb3BzW25hbWVdW2ldID0gdmFsOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgcHJvcHNbbmFtZV0gPSB2YWw7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmUiLAoJICAgICAgICBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLAoJICAgICAgICBnZW9tZXRyeTogbXVsdGkKCSAgICAgICAgICAgID8gewoJICAgICAgICAgICAgICAgIHR5cGU6ICJNdWx0aUxpbmVTdHJpbmciLAoJICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiB0cmFjaywKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIDogewoJICAgICAgICAgICAgICAgIHR5cGU6ICJMaW5lU3RyaW5nIiwKCSAgICAgICAgICAgICAgICBjb29yZGluYXRlczogdHJhY2tbMF0sCgkgICAgICAgICAgICB9LAoJICAgIH07Cgl9CgkvKioKCSAqIEV4dHJhY3QgYSBwb2ludCwgaWYgcG9zc2libGUsIGZyb20gYSBnaXZlbiBub2RlLAoJICogd2hpY2ggaXMgdXN1YWxseSBhIHdwdCBvciB0cmtwdAoJICovCglmdW5jdGlvbiBnZXRQb2ludChub2RlKSB7CgkgICAgY29uc3QgcHJvcGVydGllcyA9IE9iamVjdC5hc3NpZ24oZXh0cmFjdFByb3BlcnRpZXMobm9kZSksIGdldE11bHRpKG5vZGUsIFsic3ltIl0pKTsKCSAgICBjb25zdCBwYWlyID0gY29vcmRQYWlyJDEobm9kZSk7CgkgICAgaWYgKCFwYWlyKQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICByZXR1cm4gewoJICAgICAgICB0eXBlOiAiRmVhdHVyZSIsCgkgICAgICAgIHByb3BlcnRpZXMsCgkgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICB0eXBlOiAiUG9pbnQiLAoJICAgICAgICAgICAgY29vcmRpbmF0ZXM6IHBhaXIuY29vcmRpbmF0ZXMsCgkgICAgICAgIH0sCgkgICAgfTsKCX0KCS8qKgoJICogQ29udmVydCBHUFggdG8gR2VvSlNPTiBpbmNyZW1lbnRhbGx5LCByZXR1cm5pbmcKCSAqIGEgW0dlbmVyYXRvcl0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9HdWlkZS9JdGVyYXRvcnNfYW5kX0dlbmVyYXRvcnMpCgkgKiB0aGF0IHlpZWxkcyBvdXRwdXQgZmVhdHVyZSBieSBmZWF0dXJlLgoJICovCglmdW5jdGlvbiogZ3B4R2VuKG5vZGUpIHsKCSAgICBmb3IgKGNvbnN0IHRyYWNrIG9mICQobm9kZSwgInRyayIpKSB7CgkgICAgICAgIGNvbnN0IGZlYXR1cmUgPSBnZXRUcmFjayh0cmFjayk7CgkgICAgICAgIGlmIChmZWF0dXJlKQoJICAgICAgICAgICAgeWllbGQgZmVhdHVyZTsKCSAgICB9CgkgICAgZm9yIChjb25zdCByb3V0ZSBvZiAkKG5vZGUsICJydGUiKSkgewoJICAgICAgICBjb25zdCBmZWF0dXJlID0gZ2V0Um91dGUocm91dGUpOwoJICAgICAgICBpZiAoZmVhdHVyZSkKCSAgICAgICAgICAgIHlpZWxkIGZlYXR1cmU7CgkgICAgfQoJICAgIGZvciAoY29uc3Qgd2F5cG9pbnQgb2YgJChub2RlLCAid3B0IikpIHsKCSAgICAgICAgY29uc3QgcG9pbnQgPSBnZXRQb2ludCh3YXlwb2ludCk7CgkgICAgICAgIGlmIChwb2ludCkKCSAgICAgICAgICAgIHlpZWxkIHBvaW50OwoJICAgIH0KCX0KCS8qKgoJICoKCSAqIENvbnZlcnQgYSBHUFggZG9jdW1lbnQgdG8gR2VvSlNPTi4gVGhlIGZpcnN0IGFyZ3VtZW50LCBgZG9jYCwgbXVzdCBiZSBhIEdQWAoJICogZG9jdW1lbnQgYXMgYW4gWE1MIERPTSAtIG5vdCBhcyBhIHN0cmluZy4gWW91IGNhbiBnZXQgdGhpcyB1c2luZyBqUXVlcnkncyBkZWZhdWx0CgkgKiBgLmFqYXhgIGZ1bmN0aW9uIG9yIHVzaW5nIGEgYmFyZSBYTUxIdHRwUmVxdWVzdCB3aXRoIHRoZSBgLnJlc3BvbnNlYCBwcm9wZXJ0eQoJICogaG9sZGluZyBhbiBYTUwgRE9NLgoJICoKCSAqIFRoZSBvdXRwdXQgaXMgYSBKYXZhU2NyaXB0IG9iamVjdCBvZiBHZW9KU09OIGRhdGEsIHNhbWUgYXMgYC5rbWxgIG91dHB1dHMsIHdpdGggdGhlCgkgKiBhZGRpdGlvbiBvZiBhIGBfZ3B4VHlwZWAgcHJvcGVydHkgb24gZWFjaCBgTGluZVN0cmluZ2AgZmVhdHVyZSB0aGF0IGluZGljYXRlcyB3aGV0aGVyCgkgKiB0aGUgZmVhdHVyZSB3YXMgZW5jb2RlZCBhcyBhIHJvdXRlIChgcnRlYCkgb3IgdHJhY2sgKGB0cmtgKSBpbiB0aGUgR1BYIGRvY3VtZW50LgoJICovCglmdW5jdGlvbiBncHgobm9kZSkgewoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsCgkgICAgICAgIGZlYXR1cmVzOiBBcnJheS5mcm9tKGdweEdlbihub2RlKSksCgkgICAgfTsKCX0KCgljb25zdCBFWFRFTlNJT05TX05TID0gImh0dHA6Ly93d3cuZ2FybWluLmNvbS94bWxzY2hlbWFzL0FjdGl2aXR5RXh0ZW5zaW9uL3YyIjsKCWNvbnN0IFRSQUNLUE9JTlRfQVRUUklCVVRFUyA9IFsKCSAgICBbImhlYXJ0UmF0ZSIsICJoZWFydFJhdGVzIl0sCgkgICAgWyJDYWRlbmNlIiwgImNhZGVuY2VzIl0sCgkgICAgLy8gRXh0ZW5kZWQgVHJhY2twb2ludCBhdHRyaWJ1dGVzCgkgICAgWyJTcGVlZCIsICJzcGVlZHMiXSwKCSAgICBbIldhdHRzIiwgIndhdHRzIl0sCgldOwoJY29uc3QgTEFQX0FUVFJJQlVURVMgPSBbCgkgICAgWyJUb3RhbFRpbWVTZWNvbmRzIiwgInRvdGFsVGltZVNlY29uZHMiXSwKCSAgICBbIkRpc3RhbmNlTWV0ZXJzIiwgImRpc3RhbmNlTWV0ZXJzIl0sCgkgICAgWyJNYXhpbXVtU3BlZWQiLCAibWF4U3BlZWQiXSwKCSAgICBbIkF2ZXJhZ2VIZWFydFJhdGVCcG0iLCAiYXZnSGVhcnRSYXRlIl0sCgkgICAgWyJNYXhpbXVtSGVhcnRSYXRlQnBtIiwgIm1heEhlYXJ0UmF0ZSJdLAoJICAgIC8vIEV4dGVuZGVkIExhcCBhdHRyaWJ1dGVzCgkgICAgWyJBdmdTcGVlZCIsICJhdmdTcGVlZCJdLAoJICAgIFsiQXZnV2F0dHMiLCAiYXZnV2F0dHMiXSwKCSAgICBbIk1heFdhdHRzIiwgIm1heFdhdHRzIl0sCgldOwoJZnVuY3Rpb24gZ2V0UHJvcGVydGllcyhub2RlLCBhdHRyaWJ1dGVOYW1lcykgewoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSBbXTsKCSAgICBmb3IgKGNvbnN0IFt0YWcsIGFsaWFzXSBvZiBhdHRyaWJ1dGVOYW1lcykgewoJICAgICAgICBsZXQgZWxlbSA9IGdldDEobm9kZSwgdGFnKTsKCSAgICAgICAgaWYgKCFlbGVtKSB7CgkgICAgICAgICAgICBjb25zdCBlbGVtZW50cyA9IG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhFWFRFTlNJT05TX05TLCB0YWcpOwoJICAgICAgICAgICAgaWYgKGVsZW1lbnRzLmxlbmd0aCkgewoJICAgICAgICAgICAgICAgIGVsZW0gPSBlbGVtZW50c1swXTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjb25zdCB2YWwgPSBwYXJzZUZsb2F0KG5vZGVWYWwoZWxlbSkpOwoJICAgICAgICBpZiAoIWlzTmFOKHZhbCkpIHsKCSAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbYWxpYXMsIHZhbF0pOwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJfQoJZnVuY3Rpb24gY29vcmRQYWlyKG5vZGUpIHsKCSAgICBjb25zdCBsbCA9IFtudW0xKG5vZGUsICJMb25naXR1ZGVEZWdyZWVzIiksIG51bTEobm9kZSwgIkxhdGl0dWRlRGVncmVlcyIpXTsKCSAgICBpZiAobGxbMF0gPT09IHVuZGVmaW5lZCB8fAoJICAgICAgICBpc05hTihsbFswXSkgfHwKCSAgICAgICAgbGxbMV0gPT09IHVuZGVmaW5lZCB8fAoJICAgICAgICBpc05hTihsbFsxXSkpIHsKCSAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgfQoJICAgIGNvbnN0IGhlYXJ0UmF0ZSA9IGdldDEobm9kZSwgIkhlYXJ0UmF0ZUJwbSIpOwoJICAgIGNvbnN0IHRpbWUgPSBub2RlVmFsKGdldDEobm9kZSwgIlRpbWUiKSk7CgkgICAgZ2V0MShub2RlLCAiQWx0aXR1ZGVNZXRlcnMiLCAoYWx0KSA9PiB7CgkgICAgICAgIGNvbnN0IGEgPSBwYXJzZUZsb2F0KG5vZGVWYWwoYWx0KSk7CgkgICAgICAgIGlmICghaXNOYU4oYSkpIHsKCSAgICAgICAgICAgIGxsLnB1c2goYSk7CgkgICAgICAgIH0KCSAgICB9KTsKCSAgICByZXR1cm4gewoJICAgICAgICBjb29yZGluYXRlczogbGwsCgkgICAgICAgIHRpbWU6IHRpbWUgfHwgbnVsbCwKCSAgICAgICAgaGVhcnRSYXRlOiBoZWFydFJhdGUgPyBwYXJzZUZsb2F0KG5vZGVWYWwoaGVhcnRSYXRlKSkgOiBudWxsLAoJICAgICAgICBleHRlbnNpb25zOiBnZXRQcm9wZXJ0aWVzKG5vZGUsIFRSQUNLUE9JTlRfQVRUUklCVVRFUyksCgkgICAgfTsKCX0KCWZ1bmN0aW9uIGdldFBvaW50cyhub2RlKSB7CgkgICAgY29uc3QgcHRzID0gJChub2RlLCAiVHJhY2twb2ludCIpOwoJICAgIGNvbnN0IGxpbmUgPSBbXTsKCSAgICBjb25zdCB0aW1lcyA9IFtdOwoJICAgIGNvbnN0IGhlYXJ0UmF0ZXMgPSBbXTsKCSAgICBpZiAocHRzLmxlbmd0aCA8IDIpCgkgICAgICAgIHJldHVybiBudWxsOyAvLyBJbnZhbGlkIGxpbmUgaW4gR2VvSlNPTgoJICAgIGNvbnN0IGV4dGVuZGVkUHJvcGVydGllcyA9IHt9OwoJICAgIGNvbnN0IHJlc3VsdCA9IHsgZXh0ZW5kZWRQcm9wZXJ0aWVzIH07CgkgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwdHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgY29uc3QgYyA9IGNvb3JkUGFpcihwdHNbaV0pOwoJICAgICAgICBpZiAoYyA9PT0gbnVsbCkKCSAgICAgICAgICAgIGNvbnRpbnVlOwoJICAgICAgICBsaW5lLnB1c2goYy5jb29yZGluYXRlcyk7CgkgICAgICAgIGNvbnN0IHsgdGltZSwgaGVhcnRSYXRlLCBleHRlbnNpb25zIH0gPSBjOwoJICAgICAgICBpZiAodGltZSkKCSAgICAgICAgICAgIHRpbWVzLnB1c2godGltZSk7CgkgICAgICAgIGlmIChoZWFydFJhdGUpCgkgICAgICAgICAgICBoZWFydFJhdGVzLnB1c2goaGVhcnRSYXRlKTsKCSAgICAgICAgZm9yIChjb25zdCBbYWxpYXMsIHZhbHVlXSBvZiBleHRlbnNpb25zKSB7CgkgICAgICAgICAgICBpZiAoIWV4dGVuZGVkUHJvcGVydGllc1thbGlhc10pIHsKCSAgICAgICAgICAgICAgICBleHRlbmRlZFByb3BlcnRpZXNbYWxpYXNdID0gQXJyYXkocHRzLmxlbmd0aCkuZmlsbChudWxsKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGV4dGVuZGVkUHJvcGVydGllc1thbGlhc11baV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH0KCSAgICBpZiAobGluZS5sZW5ndGggPCAyKQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihyZXN1bHQsIHsKCSAgICAgICAgbGluZTogbGluZSwKCSAgICAgICAgdGltZXM6IHRpbWVzLAoJICAgICAgICBoZWFydFJhdGVzOiBoZWFydFJhdGVzLAoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZ2V0TGFwKG5vZGUpIHsKCSAgICBjb25zdCBzZWdtZW50cyA9ICQobm9kZSwgIlRyYWNrIik7CgkgICAgY29uc3QgdHJhY2sgPSBbXTsKCSAgICBjb25zdCB0aW1lcyA9IFtdOwoJICAgIGNvbnN0IGhlYXJ0UmF0ZXMgPSBbXTsKCSAgICBjb25zdCBhbGxFeHRlbmRlZFByb3BlcnRpZXMgPSBbXTsKCSAgICBsZXQgbGluZTsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0gT2JqZWN0LmFzc2lnbihPYmplY3QuZnJvbUVudHJpZXMoZ2V0UHJvcGVydGllcyhub2RlLCBMQVBfQVRUUklCVVRFUykpLCBnZXQobm9kZSwgIk5hbWUiLCAobmFtZUVsZW1lbnQpID0+IHsKCSAgICAgICAgcmV0dXJuIHsgbmFtZTogbm9kZVZhbChuYW1lRWxlbWVudCkgfTsKCSAgICB9KSk7CgkgICAgZm9yIChjb25zdCBzZWdtZW50IG9mIHNlZ21lbnRzKSB7CgkgICAgICAgIGxpbmUgPSBnZXRQb2ludHMoc2VnbWVudCk7CgkgICAgICAgIGlmIChsaW5lKSB7CgkgICAgICAgICAgICB0cmFjay5wdXNoKGxpbmUubGluZSk7CgkgICAgICAgICAgICBpZiAobGluZS50aW1lcy5sZW5ndGgpCgkgICAgICAgICAgICAgICAgdGltZXMucHVzaChsaW5lLnRpbWVzKTsKCSAgICAgICAgICAgIGlmIChsaW5lLmhlYXJ0UmF0ZXMubGVuZ3RoKQoJICAgICAgICAgICAgICAgIGhlYXJ0UmF0ZXMucHVzaChsaW5lLmhlYXJ0UmF0ZXMpOwoJICAgICAgICAgICAgYWxsRXh0ZW5kZWRQcm9wZXJ0aWVzLnB1c2gobGluZS5leHRlbmRlZFByb3BlcnRpZXMpOwoJICAgICAgICB9CgkgICAgfQoJICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsRXh0ZW5kZWRQcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGNvbnN0IGV4dGVuZGVkUHJvcGVydGllcyA9IGFsbEV4dGVuZGVkUHJvcGVydGllc1tpXTsKCSAgICAgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBpbiBleHRlbmRlZFByb3BlcnRpZXMpIHsKCSAgICAgICAgICAgIGlmIChzZWdtZW50cy5sZW5ndGggPT09IDEpIHsKCSAgICAgICAgICAgICAgICBpZiAobGluZSkgewoJICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzW3Byb3BlcnR5XSA9IGxpbmUuZXh0ZW5kZWRQcm9wZXJ0aWVzW3Byb3BlcnR5XTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICBpZiAoIXByb3BlcnRpZXNbcHJvcGVydHldKSB7CgkgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNbcHJvcGVydHldID0gdHJhY2subWFwKCh0cmFjaykgPT4gQXJyYXkodHJhY2subGVuZ3RoKS5maWxsKG51bGwpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcHJvcGVydGllc1twcm9wZXJ0eV1baV0gPSBleHRlbmRlZFByb3BlcnRpZXNbcHJvcGVydHldOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoJICAgIGlmICh0cmFjay5sZW5ndGggPT09IDApCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIGlmICh0aW1lcy5sZW5ndGggfHwgaGVhcnRSYXRlcy5sZW5ndGgpIHsKCSAgICAgICAgcHJvcGVydGllcy5jb29yZGluYXRlUHJvcGVydGllcyA9IE9iamVjdC5hc3NpZ24odGltZXMubGVuZ3RoCgkgICAgICAgICAgICA/IHsKCSAgICAgICAgICAgICAgICB0aW1lczogdHJhY2subGVuZ3RoID09PSAxID8gdGltZXNbMF0gOiB0aW1lcywKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIDoge30sIGhlYXJ0UmF0ZXMubGVuZ3RoCgkgICAgICAgICAgICA/IHsKCSAgICAgICAgICAgICAgICBoZWFydDogdHJhY2subGVuZ3RoID09PSAxID8gaGVhcnRSYXRlc1swXSA6IGhlYXJ0UmF0ZXMsCgkgICAgICAgICAgICB9CgkgICAgICAgICAgICA6IHt9KTsKCSAgICB9CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmUiLAoJICAgICAgICBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLAoJICAgICAgICBnZW9tZXRyeTogdHJhY2subGVuZ3RoID09PSAxCgkgICAgICAgICAgICA/IHsKCSAgICAgICAgICAgICAgICB0eXBlOiAiTGluZVN0cmluZyIsCgkgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IHRyYWNrWzBdLAoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgOiB7CgkgICAgICAgICAgICAgICAgdHlwZTogIk11bHRpTGluZVN0cmluZyIsCgkgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IHRyYWNrLAoJICAgICAgICAgICAgfSwKCSAgICB9OwoJfQoJLyoqCgkgKiBJbmNyZW1lbnRhbGx5IGNvbnZlcnQgYSBUQ1ggZG9jdW1lbnQgdG8gR2VvSlNPTi4gVGhlCgkgKiBmaXJzdCBhcmd1bWVudCwgYGRvY2AsIG11c3QgYmUgYSBUQ1gKCSAqIGRvY3VtZW50IGFzIGFuIFhNTCBET00gLSBub3QgYXMgYSBzdHJpbmcuCgkgKi8KCWZ1bmN0aW9uKiB0Y3hHZW4obm9kZSkgewoJICAgIGZvciAoY29uc3QgbGFwIG9mICQobm9kZSwgIkxhcCIpKSB7CgkgICAgICAgIGNvbnN0IGZlYXR1cmUgPSBnZXRMYXAobGFwKTsKCSAgICAgICAgaWYgKGZlYXR1cmUpCgkgICAgICAgICAgICB5aWVsZCBmZWF0dXJlOwoJICAgIH0KCSAgICBmb3IgKGNvbnN0IGNvdXJzZSBvZiAkKG5vZGUsICJDb3Vyc2VzIikpIHsKCSAgICAgICAgY29uc3QgZmVhdHVyZSA9IGdldExhcChjb3Vyc2UpOwoJICAgICAgICBpZiAoZmVhdHVyZSkKCSAgICAgICAgICAgIHlpZWxkIGZlYXR1cmU7CgkgICAgfQoJfQoJLyoqCgkgKiBDb252ZXJ0IGEgVENYIGRvY3VtZW50IHRvIEdlb0pTT04uIFRoZSBmaXJzdCBhcmd1bWVudCwgYGRvY2AsIG11c3QgYmUgYSBUQ1gKCSAqIGRvY3VtZW50IGFzIGFuIFhNTCBET00gLSBub3QgYXMgYSBzdHJpbmcuCgkgKi8KCWZ1bmN0aW9uIHRjeChub2RlKSB7CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmVDb2xsZWN0aW9uIiwKCSAgICAgICAgZmVhdHVyZXM6IEFycmF5LmZyb20odGN4R2VuKG5vZGUpKSwKCSAgICB9OwoJfQoKCWZ1bmN0aW9uIGZpeENvbG9yKHYsIHByZWZpeCkgewoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7fTsKCSAgICBjb25zdCBjb2xvclByb3AgPSBwcmVmaXggPT0gInN0cm9rZSIgfHwgcHJlZml4ID09PSAiZmlsbCIgPyBwcmVmaXggOiBwcmVmaXggKyAiLWNvbG9yIjsKCSAgICBpZiAodlswXSA9PT0gIiMiKSB7CgkgICAgICAgIHYgPSB2LnN1YnN0cmluZygxKTsKCSAgICB9CgkgICAgaWYgKHYubGVuZ3RoID09PSA2IHx8IHYubGVuZ3RoID09PSAzKSB7CgkgICAgICAgIHByb3BlcnRpZXNbY29sb3JQcm9wXSA9ICIjIiArIHY7CgkgICAgfQoJICAgIGVsc2UgaWYgKHYubGVuZ3RoID09PSA4KSB7CgkgICAgICAgIHByb3BlcnRpZXNbcHJlZml4ICsgIi1vcGFjaXR5Il0gPSBwYXJzZUludCh2LnN1YnN0cmluZygwLCAyKSwgMTYpIC8gMjU1OwoJICAgICAgICBwcm9wZXJ0aWVzW2NvbG9yUHJvcF0gPQoJICAgICAgICAgICAgIiMiICsgdi5zdWJzdHJpbmcoNiwgOCkgKyB2LnN1YnN0cmluZyg0LCA2KSArIHYuc3Vic3RyaW5nKDIsIDQpOwoJICAgIH0KCSAgICByZXR1cm4gcHJvcGVydGllczsKCX0KCglmdW5jdGlvbiBudW1lcmljUHJvcGVydHkobm9kZSwgc291cmNlLCB0YXJnZXQpIHsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0ge307CgkgICAgbnVtMShub2RlLCBzb3VyY2UsICh2YWwpID0+IHsKCSAgICAgICAgcHJvcGVydGllc1t0YXJnZXRdID0gdmFsOwoJICAgIH0pOwoJICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJfQoJZnVuY3Rpb24gZ2V0Q29sb3Iobm9kZSwgb3V0cHV0KSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiY29sb3IiLCAoZWxlbSkgPT4gZml4Q29sb3Iobm9kZVZhbChlbGVtKSwgb3V0cHV0KSk7Cgl9CglmdW5jdGlvbiBleHRyYWN0SWNvbkhyZWYobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgIkljb24iLCAoaWNvbiwgcHJvcGVydGllcykgPT4gewoJICAgICAgICB2YWwxKGljb24sICJocmVmIiwgKGhyZWYpID0+IHsKCSAgICAgICAgICAgIHByb3BlcnRpZXMuaWNvbiA9IGhyZWY7CgkgICAgICAgIH0pOwoJICAgICAgICByZXR1cm4gcHJvcGVydGllczsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RJY29uKG5vZGUpIHsKCSAgICByZXR1cm4gZ2V0KG5vZGUsICJJY29uU3R5bGUiLCAoaWNvblN0eWxlKSA9PiB7CgkgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGdldENvbG9yKGljb25TdHlsZSwgImljb24iKSwgbnVtZXJpY1Byb3BlcnR5KGljb25TdHlsZSwgInNjYWxlIiwgImljb24tc2NhbGUiKSwgbnVtZXJpY1Byb3BlcnR5KGljb25TdHlsZSwgImhlYWRpbmciLCAiaWNvbi1oZWFkaW5nIiksIGdldChpY29uU3R5bGUsICJob3RTcG90IiwgKGhvdHNwb3QpID0+IHsKCSAgICAgICAgICAgIGNvbnN0IGxlZnQgPSBwYXJzZUZsb2F0KGhvdHNwb3QuZ2V0QXR0cmlidXRlKCJ4IikgfHwgIiIpOwoJICAgICAgICAgICAgY29uc3QgdG9wID0gcGFyc2VGbG9hdChob3RzcG90LmdldEF0dHJpYnV0ZSgieSIpIHx8ICIiKTsKCSAgICAgICAgICAgIGNvbnN0IHh1bml0cyA9IGhvdHNwb3QuZ2V0QXR0cmlidXRlKCJ4dW5pdHMiKSB8fCAiIjsKCSAgICAgICAgICAgIGNvbnN0IHl1bml0cyA9IGhvdHNwb3QuZ2V0QXR0cmlidXRlKCJ5dW5pdHMiKSB8fCAiIjsKCSAgICAgICAgICAgIGlmICghaXNOYU4obGVmdCkgJiYgIWlzTmFOKHRvcCkpCgkgICAgICAgICAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICAgICAgImljb24tb2Zmc2V0IjogW2xlZnQsIHRvcF0sCgkgICAgICAgICAgICAgICAgICAgICJpY29uLW9mZnNldC11bml0cyI6IFt4dW5pdHMsIHl1bml0c10sCgkgICAgICAgICAgICAgICAgfTsKCSAgICAgICAgICAgIHJldHVybiB7fTsKCSAgICAgICAgfSksIGV4dHJhY3RJY29uSHJlZihpY29uU3R5bGUpKTsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RMYWJlbChub2RlKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiTGFiZWxTdHlsZSIsIChsYWJlbFN0eWxlKSA9PiB7CgkgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGdldENvbG9yKGxhYmVsU3R5bGUsICJsYWJlbCIpLCBudW1lcmljUHJvcGVydHkobGFiZWxTdHlsZSwgInNjYWxlIiwgImxhYmVsLXNjYWxlIikpOwoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZXh0cmFjdExpbmUobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgIkxpbmVTdHlsZSIsIChsaW5lU3R5bGUpID0+IHsKCSAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZ2V0Q29sb3IobGluZVN0eWxlLCAic3Ryb2tlIiksIG51bWVyaWNQcm9wZXJ0eShsaW5lU3R5bGUsICJ3aWR0aCIsICJzdHJva2Utd2lkdGgiKSk7CgkgICAgfSk7Cgl9CglmdW5jdGlvbiBleHRyYWN0UG9seShub2RlKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiUG9seVN0eWxlIiwgKHBvbHlTdHlsZSwgcHJvcGVydGllcykgPT4gewoJICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwcm9wZXJ0aWVzLCBnZXQocG9seVN0eWxlLCAiY29sb3IiLCAoZWxlbSkgPT4gZml4Q29sb3Iobm9kZVZhbChlbGVtKSwgImZpbGwiKSksIHZhbDEocG9seVN0eWxlLCAiZmlsbCIsIChmaWxsKSA9PiB7CgkgICAgICAgICAgICBpZiAoZmlsbCA9PT0gIjAiKQoJICAgICAgICAgICAgICAgIHJldHVybiB7ICJmaWxsLW9wYWNpdHkiOiAwIH07CgkgICAgICAgIH0pLCB2YWwxKHBvbHlTdHlsZSwgIm91dGxpbmUiLCAob3V0bGluZSkgPT4gewoJICAgICAgICAgICAgaWYgKG91dGxpbmUgPT09ICIwIikKCSAgICAgICAgICAgICAgICByZXR1cm4geyAic3Ryb2tlLW9wYWNpdHkiOiAwIH07CgkgICAgICAgIH0pKTsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RTdHlsZShub2RlKSB7CgkgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGV4dHJhY3RQb2x5KG5vZGUpLCBleHRyYWN0TGluZShub2RlKSwgZXh0cmFjdExhYmVsKG5vZGUpLCBleHRyYWN0SWNvbihub2RlKSk7Cgl9CgoJY29uc3QgdG9OdW1iZXIgPSAoeCkgPT4gTnVtYmVyKHgpOwoJY29uc3QgdHlwZUNvbnZlcnRlcnMgPSB7CgkgICAgc3RyaW5nOiAoeCkgPT4geCwKCSAgICBpbnQ6IHRvTnVtYmVyLAoJICAgIHVpbnQ6IHRvTnVtYmVyLAoJICAgIHNob3J0OiB0b051bWJlciwKCSAgICB1c2hvcnQ6IHRvTnVtYmVyLAoJICAgIGZsb2F0OiB0b051bWJlciwKCSAgICBkb3VibGU6IHRvTnVtYmVyLAoJICAgIGJvb2w6ICh4KSA9PiBCb29sZWFuKHgpLAoJfTsKCWZ1bmN0aW9uIGV4dHJhY3RFeHRlbmRlZERhdGEobm9kZSwgc2NoZW1hKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiRXh0ZW5kZWREYXRhIiwgKGV4dGVuZGVkRGF0YSwgcHJvcGVydGllcykgPT4gewoJICAgICAgICBmb3IgKGNvbnN0IGRhdGEgb2YgJChleHRlbmRlZERhdGEsICJEYXRhIikpIHsKCSAgICAgICAgICAgIHByb3BlcnRpZXNbZGF0YS5nZXRBdHRyaWJ1dGUoIm5hbWUiKSB8fCAiIl0gPSBub2RlVmFsKGdldDEoZGF0YSwgInZhbHVlIikpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAoY29uc3Qgc2ltcGxlRGF0YSBvZiAkKGV4dGVuZGVkRGF0YSwgIlNpbXBsZURhdGEiKSkgewoJICAgICAgICAgICAgY29uc3QgbmFtZSA9IHNpbXBsZURhdGEuZ2V0QXR0cmlidXRlKCJuYW1lIikgfHwgIiI7CgkgICAgICAgICAgICBjb25zdCB0eXBlQ29udmVydGVyID0gc2NoZW1hW25hbWVdIHx8IHR5cGVDb252ZXJ0ZXJzLnN0cmluZzsKCSAgICAgICAgICAgIHByb3BlcnRpZXNbbmFtZV0gPSB0eXBlQ29udmVydGVyKG5vZGVWYWwoc2ltcGxlRGF0YSkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZ2V0TWF5YmVIVE1MRGVzY3JpcHRpb24obm9kZSkgewoJICAgIGNvbnN0IGRlc2NyaXB0aW9uTm9kZSA9IGdldDEobm9kZSwgImRlc2NyaXB0aW9uIik7CgkgICAgZm9yIChjb25zdCBjIG9mIEFycmF5LmZyb20oZGVzY3JpcHRpb25Ob2RlPy5jaGlsZE5vZGVzIHx8IFtdKSkgewoJICAgICAgICBpZiAoYy5ub2RlVHlwZSA9PT0gNCkgewoJICAgICAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogewoJICAgICAgICAgICAgICAgICAgICAiQHR5cGUiOiAiaHRtbCIsCgkgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBub2RlVmFsKGMpLAoJICAgICAgICAgICAgICAgIH0sCgkgICAgICAgICAgICB9OwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiB7fTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RUaW1lU3Bhbihub2RlKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiVGltZVNwYW4iLCAodGltZVNwYW4pID0+IHsKCSAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgIHRpbWVzcGFuOiB7CgkgICAgICAgICAgICAgICAgYmVnaW46IG5vZGVWYWwoZ2V0MSh0aW1lU3BhbiwgImJlZ2luIikpLAoJICAgICAgICAgICAgICAgIGVuZDogbm9kZVZhbChnZXQxKHRpbWVTcGFuLCAiZW5kIikpLAoJICAgICAgICAgICAgfSwKCSAgICAgICAgfTsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RUaW1lU3RhbXAobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgIlRpbWVTdGFtcCIsICh0aW1lU3RhbXApID0+IHsKCSAgICAgICAgcmV0dXJuIHsgdGltZXN0YW1wOiBub2RlVmFsKGdldDEodGltZVN0YW1wLCAid2hlbiIpKSB9OwoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZXh0cmFjdENhc2NhZGVkU3R5bGUobm9kZSwgc3R5bGVNYXApIHsKCSAgICByZXR1cm4gdmFsMShub2RlLCAic3R5bGVVcmwiLCAoc3R5bGVVcmwpID0+IHsKCSAgICAgICAgc3R5bGVVcmwgPSBub3JtYWxpemVJZChzdHlsZVVybCk7CgkgICAgICAgIGlmIChzdHlsZU1hcFtzdHlsZVVybF0pIHsKCSAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHsgc3R5bGVVcmwgfSwgc3R5bGVNYXBbc3R5bGVVcmxdKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBGb3IgYmFja3dhcmQtY29tcGF0aWJpbGl0eS4gU2hvdWxkIHdlIHN0aWxsIGluY2x1ZGUKCSAgICAgICAgLy8gc3R5bGVVcmwgZXZlbiBpZiBpdCdzIG5vdCByZXNvbHZlZD8KCSAgICAgICAgcmV0dXJuIHsgc3R5bGVVcmwgfTsKCSAgICB9KTsKCX0KCgljb25zdCByZW1vdmVTcGFjZSA9IC9ccyovZzsKCWNvbnN0IHRyaW1TcGFjZSA9IC9eXHMqfFxzKiQvZzsKCWNvbnN0IHNwbGl0U3BhY2UgPSAvXHMrLzsKCS8qKgoJICogR2V0IG9uZSBjb29yZGluYXRlIGZyb20gYSBjb29yZGluYXRlIGFycmF5LCBpZiBhbnkKCSAqLwoJZnVuY3Rpb24gY29vcmQxKHZhbHVlKSB7CgkgICAgcmV0dXJuIHZhbHVlCgkgICAgICAgIC5yZXBsYWNlKHJlbW92ZVNwYWNlLCAiIikKCSAgICAgICAgLnNwbGl0KCIsIikKCSAgICAgICAgLm1hcChwYXJzZUZsb2F0KQoJICAgICAgICAuZmlsdGVyKChudW0pID0+ICFpc05hTihudW0pKQoJICAgICAgICAuc2xpY2UoMCwgMyk7Cgl9CgkvKioKCSAqIEdldCBhbGwgY29vcmRpbmF0ZXMgZnJvbSBhIGNvb3JkaW5hdGUgYXJyYXkgYXMgW1tdLFtdXQoJICovCglmdW5jdGlvbiBjb29yZCh2YWx1ZSkgewoJICAgIHJldHVybiB2YWx1ZQoJICAgICAgICAucmVwbGFjZSh0cmltU3BhY2UsICIiKQoJICAgICAgICAuc3BsaXQoc3BsaXRTcGFjZSkKCSAgICAgICAgLm1hcChjb29yZDEpCgkgICAgICAgIC5maWx0ZXIoKGNvb3JkKSA9PiB7CgkgICAgICAgIHJldHVybiBjb29yZC5sZW5ndGggPj0gMjsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGd4Q29vcmRzKG5vZGUpIHsKCSAgICBsZXQgZWxlbXMgPSAkKG5vZGUsICJjb29yZCIpOwoJICAgIGlmIChlbGVtcy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgZWxlbXMgPSAkbnMobm9kZSwgImNvb3JkIiwgIioiKTsKCSAgICB9CgkgICAgY29uc3QgY29vcmRpbmF0ZXMgPSBlbGVtcy5tYXAoKGVsZW0pID0+IHsKCSAgICAgICAgcmV0dXJuIG5vZGVWYWwoZWxlbSkuc3BsaXQoIiAiKS5tYXAocGFyc2VGbG9hdCk7CgkgICAgfSk7CgkgICAgaWYgKGNvb3JkaW5hdGVzLmxlbmd0aCA9PT0gMCkgewoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9CgkgICAgcmV0dXJuIHsKCSAgICAgICAgZ2VvbWV0cnk6IGNvb3JkaW5hdGVzLmxlbmd0aCA+IDIKCSAgICAgICAgICAgID8gewoJICAgICAgICAgICAgICAgIHR5cGU6ICJMaW5lU3RyaW5nIiwKCSAgICAgICAgICAgICAgICBjb29yZGluYXRlcywKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIDogewoJICAgICAgICAgICAgICAgIHR5cGU6ICJQb2ludCIsCgkgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IGNvb3JkaW5hdGVzWzBdLAoJICAgICAgICAgICAgfSwKCSAgICAgICAgdGltZXM6ICQobm9kZSwgIndoZW4iKS5tYXAoKGVsZW0pID0+IG5vZGVWYWwoZWxlbSkpLAoJICAgIH07Cgl9CglmdW5jdGlvbiBmaXhSaW5nKHJpbmcpIHsKCSAgICBpZiAocmluZy5sZW5ndGggPT09IDApCgkgICAgICAgIHJldHVybiByaW5nOwoJICAgIGNvbnN0IGZpcnN0ID0gcmluZ1swXTsKCSAgICBjb25zdCBsYXN0ID0gcmluZ1tyaW5nLmxlbmd0aCAtIDFdOwoJICAgIGxldCBlcXVhbCA9IHRydWU7CgkgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLm1heChmaXJzdC5sZW5ndGgsIGxhc3QubGVuZ3RoKTsgaSsrKSB7CgkgICAgICAgIGlmIChmaXJzdFtpXSAhPT0gbGFzdFtpXSkgewoJICAgICAgICAgICAgZXF1YWwgPSBmYWxzZTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgfQoJICAgIGlmICghZXF1YWwpIHsKCSAgICAgICAgcmV0dXJuIHJpbmcuY29uY2F0KFtyaW5nWzBdXSk7CgkgICAgfQoJICAgIHJldHVybiByaW5nOwoJfQoJZnVuY3Rpb24gZ2V0Q29vcmRpbmF0ZXMobm9kZSkgewoJICAgIHJldHVybiBub2RlVmFsKGdldDEobm9kZSwgImNvb3JkaW5hdGVzIikpOwoJfQoJZnVuY3Rpb24gZ2V0R2VvbWV0cnkobm9kZSkgewoJICAgIGxldCBnZW9tZXRyaWVzID0gW107CgkgICAgbGV0IGNvb3JkVGltZXMgPSBbXTsKCSAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykgewoJICAgICAgICBjb25zdCBjaGlsZCA9IG5vZGUuY2hpbGROb2Rlcy5pdGVtKGkpOwoJICAgICAgICBpZiAoaXNFbGVtZW50KGNoaWxkKSkgewoJICAgICAgICAgICAgc3dpdGNoIChjaGlsZC50YWdOYW1lKSB7CgkgICAgICAgICAgICAgICAgY2FzZSAiTXVsdGlHZW9tZXRyeSI6CgkgICAgICAgICAgICAgICAgY2FzZSAiTXVsdGlUcmFjayI6CgkgICAgICAgICAgICAgICAgY2FzZSAiZ3g6TXVsdGlUcmFjayI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGRHZW9tZXRyaWVzID0gZ2V0R2VvbWV0cnkoY2hpbGQpOwoJICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzID0gZ2VvbWV0cmllcy5jb25jYXQoY2hpbGRHZW9tZXRyaWVzLmdlb21ldHJpZXMpOwoJICAgICAgICAgICAgICAgICAgICBjb29yZFRpbWVzID0gY29vcmRUaW1lcy5jb25jYXQoY2hpbGRHZW9tZXRyaWVzLmNvb3JkVGltZXMpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgY2FzZSAiUG9pbnQiOiB7CgkgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gY29vcmQxKGdldENvb3JkaW5hdGVzKGNoaWxkKSk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChjb29yZGluYXRlcy5sZW5ndGggPj0gMikgewoJICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cmllcy5wdXNoKHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiUG9pbnQiLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzLAoJICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhc2UgIkxpbmVhclJpbmciOgoJICAgICAgICAgICAgICAgIGNhc2UgIkxpbmVTdHJpbmciOiB7CgkgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gY29vcmQoZ2V0Q29vcmRpbmF0ZXMoY2hpbGQpKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNvb3JkaW5hdGVzLmxlbmd0aCA+PSAyKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzLnB1c2goewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJMaW5lU3RyaW5nIiwKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlcywKCSAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBjYXNlICJQb2x5Z29uIjogewoJICAgICAgICAgICAgICAgICAgICBjb25zdCBjb29yZHMgPSBbXTsKCSAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lYXJSaW5nIG9mICQoY2hpbGQsICJMaW5lYXJSaW5nIikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJpbmcgPSBmaXhSaW5nKGNvb3JkKGdldENvb3JkaW5hdGVzKGxpbmVhclJpbmcpKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmluZy5sZW5ndGggPj0gNCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3Jkcy5wdXNoKHJpbmcpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmIChjb29yZHMubGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzLnB1c2goewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQb2x5Z29uIiwKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogY29vcmRzLAoJICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhc2UgIlRyYWNrIjoKCSAgICAgICAgICAgICAgICBjYXNlICJneDpUcmFjayI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgZ3ggPSBneENvb3JkcyhjaGlsZCk7CgkgICAgICAgICAgICAgICAgICAgIGlmICghZ3gpCgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgeyB0aW1lcywgZ2VvbWV0cnkgfSA9IGd4OwoJICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzLnB1c2goZ2VvbWV0cnkpOwoJICAgICAgICAgICAgICAgICAgICBpZiAodGltZXMubGVuZ3RoKQoJICAgICAgICAgICAgICAgICAgICAgICAgY29vcmRUaW1lcy5wdXNoKHRpbWVzKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiB7CgkgICAgICAgIGdlb21ldHJpZXMsCgkgICAgICAgIGNvb3JkVGltZXMsCgkgICAgfTsKCX0KCglmdW5jdGlvbiBnZW9tZXRyeUxpc3RUb0dlb21ldHJ5KGdlb21ldHJpZXMpIHsKCSAgICByZXR1cm4gZ2VvbWV0cmllcy5sZW5ndGggPT09IDAKCSAgICAgICAgPyBudWxsCgkgICAgICAgIDogZ2VvbWV0cmllcy5sZW5ndGggPT09IDEKCSAgICAgICAgICAgID8gZ2VvbWV0cmllc1swXQoJICAgICAgICAgICAgOiB7CgkgICAgICAgICAgICAgICAgdHlwZTogIkdlb21ldHJ5Q29sbGVjdGlvbiIsCgkgICAgICAgICAgICAgICAgZ2VvbWV0cmllcywKCSAgICAgICAgICAgIH07Cgl9CglmdW5jdGlvbiBnZXRQbGFjZW1hcmsobm9kZSwgc3R5bGVNYXAsIHNjaGVtYSwgb3B0aW9ucykgewoJICAgIGNvbnN0IHsgY29vcmRUaW1lcywgZ2VvbWV0cmllcyB9ID0gZ2V0R2VvbWV0cnkobm9kZSk7CgkgICAgY29uc3QgZ2VvbWV0cnkgPSBnZW9tZXRyeUxpc3RUb0dlb21ldHJ5KGdlb21ldHJpZXMpOwoJICAgIGlmICghZ2VvbWV0cnkgJiYgb3B0aW9ucy5za2lwTnVsbEdlb21ldHJ5KSB7CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH0KCSAgICBjb25zdCBmZWF0dXJlID0gewoJICAgICAgICB0eXBlOiAiRmVhdHVyZSIsCgkgICAgICAgIGdlb21ldHJ5LAoJICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKGdldE11bHRpKG5vZGUsIFsKCSAgICAgICAgICAgICJuYW1lIiwKCSAgICAgICAgICAgICJhZGRyZXNzIiwKCSAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwKCSAgICAgICAgICAgICJvcGVuIiwKCSAgICAgICAgICAgICJwaG9uZU51bWJlciIsCgkgICAgICAgICAgICAiZGVzY3JpcHRpb24iLAoJICAgICAgICBdKSwgZ2V0TWF5YmVIVE1MRGVzY3JpcHRpb24obm9kZSksIGV4dHJhY3RDYXNjYWRlZFN0eWxlKG5vZGUsIHN0eWxlTWFwKSwgZXh0cmFjdFN0eWxlKG5vZGUpLCBleHRyYWN0RXh0ZW5kZWREYXRhKG5vZGUsIHNjaGVtYSksIGV4dHJhY3RUaW1lU3Bhbihub2RlKSwgZXh0cmFjdFRpbWVTdGFtcChub2RlKSwgY29vcmRUaW1lcy5sZW5ndGgKCSAgICAgICAgICAgID8gewoJICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVQcm9wZXJ0aWVzOiB7CgkgICAgICAgICAgICAgICAgICAgIHRpbWVzOiBjb29yZFRpbWVzLmxlbmd0aCA9PT0gMSA/IGNvb3JkVGltZXNbMF0gOiBjb29yZFRpbWVzLAoJICAgICAgICAgICAgICAgIH0sCgkgICAgICAgICAgICB9CgkgICAgICAgICAgICA6IHt9KSwKCSAgICB9OwoJICAgIGlmIChmZWF0dXJlLnByb3BlcnRpZXM/LnZpc2liaWxpdHkgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICBmZWF0dXJlLnByb3BlcnRpZXMudmlzaWJpbGl0eSA9IGZlYXR1cmUucHJvcGVydGllcy52aXNpYmlsaXR5ICE9PSAiMCI7CgkgICAgfQoJICAgIGNvbnN0IGlkID0gbm9kZS5nZXRBdHRyaWJ1dGUoImlkIik7CgkgICAgaWYgKGlkICE9PSBudWxsICYmIGlkICE9PSAiIikKCSAgICAgICAgZmVhdHVyZS5pZCA9IGlkOwoJICAgIHJldHVybiBmZWF0dXJlOwoJfQoKCWZ1bmN0aW9uIGdldEdyb3VuZE92ZXJsYXlCb3gobm9kZSkgewoJICAgIGNvbnN0IGxhdExvblF1YWQgPSBnZXQxKG5vZGUsICJneDpMYXRMb25RdWFkIik7CgkgICAgaWYgKGxhdExvblF1YWQpIHsKCSAgICAgICAgY29uc3QgcmluZyA9IGZpeFJpbmcoY29vcmQoZ2V0Q29vcmRpbmF0ZXMobm9kZSkpKTsKCSAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICAgICAgdHlwZTogIlBvbHlnb24iLAoJICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbcmluZ10sCgkgICAgICAgICAgICB9LAoJICAgICAgICB9OwoJICAgIH0KCSAgICByZXR1cm4gZ2V0TGF0TG9uQm94KG5vZGUpOwoJfQoJY29uc3QgREVHUkVFU19UT19SQURJQU5TID0gTWF0aC5QSSAvIDE4MDsKCWZ1bmN0aW9uIHJvdGF0ZUJveChiYm94LCBjb29yZGluYXRlcywgcm90YXRpb24pIHsKCSAgICBjb25zdCBjZW50ZXIgPSBbKGJib3hbMF0gKyBiYm94WzJdKSAvIDIsIChiYm94WzFdICsgYmJveFszXSkgLyAyXTsKCSAgICByZXR1cm4gWwoJICAgICAgICBjb29yZGluYXRlc1swXS5tYXAoKGNvb3JkaW5hdGUpID0+IHsKCSAgICAgICAgICAgIGNvbnN0IGR5ID0gY29vcmRpbmF0ZVsxXSAtIGNlbnRlclsxXTsKCSAgICAgICAgICAgIGNvbnN0IGR4ID0gY29vcmRpbmF0ZVswXSAtIGNlbnRlclswXTsKCSAgICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KE1hdGgucG93KGR5LCAyKSArIE1hdGgucG93KGR4LCAyKSk7CgkgICAgICAgICAgICBjb25zdCBhbmdsZSA9IE1hdGguYXRhbjIoZHksIGR4KSArIHJvdGF0aW9uICogREVHUkVFU19UT19SQURJQU5TOwoJICAgICAgICAgICAgcmV0dXJuIFsKCSAgICAgICAgICAgICAgICBjZW50ZXJbMF0gKyBNYXRoLmNvcyhhbmdsZSkgKiBkaXN0YW5jZSwKCSAgICAgICAgICAgICAgICBjZW50ZXJbMV0gKyBNYXRoLnNpbihhbmdsZSkgKiBkaXN0YW5jZSwKCSAgICAgICAgICAgIF07CgkgICAgICAgIH0pLAoJICAgIF07Cgl9CglmdW5jdGlvbiBnZXRMYXRMb25Cb3gobm9kZSkgewoJICAgIGNvbnN0IGxhdExvbkJveCA9IGdldDEobm9kZSwgIkxhdExvbkJveCIpOwoJICAgIGlmIChsYXRMb25Cb3gpIHsKCSAgICAgICAgY29uc3Qgbm9ydGggPSBudW0xKGxhdExvbkJveCwgIm5vcnRoIik7CgkgICAgICAgIGNvbnN0IHdlc3QgPSBudW0xKGxhdExvbkJveCwgIndlc3QiKTsKCSAgICAgICAgY29uc3QgZWFzdCA9IG51bTEobGF0TG9uQm94LCAiZWFzdCIpOwoJICAgICAgICBjb25zdCBzb3V0aCA9IG51bTEobGF0TG9uQm94LCAic291dGgiKTsKCSAgICAgICAgY29uc3Qgcm90YXRpb24gPSBudW0xKGxhdExvbkJveCwgInJvdGF0aW9uIik7CgkgICAgICAgIGlmICh0eXBlb2Ygbm9ydGggPT09ICJudW1iZXIiICYmCgkgICAgICAgICAgICB0eXBlb2Ygc291dGggPT09ICJudW1iZXIiICYmCgkgICAgICAgICAgICB0eXBlb2Ygd2VzdCA9PT0gIm51bWJlciIgJiYKCSAgICAgICAgICAgIHR5cGVvZiBlYXN0ID09PSAibnVtYmVyIikgewoJICAgICAgICAgICAgY29uc3QgYmJveCA9IFt3ZXN0LCBzb3V0aCwgZWFzdCwgbm9ydGhdOwoJICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVzID0gWwoJICAgICAgICAgICAgICAgIFsKCSAgICAgICAgICAgICAgICAgICAgW3dlc3QsIG5vcnRoXSwKCSAgICAgICAgICAgICAgICAgICAgW2Vhc3QsIG5vcnRoXSwKCSAgICAgICAgICAgICAgICAgICAgW2Vhc3QsIHNvdXRoXSwKCSAgICAgICAgICAgICAgICAgICAgW3dlc3QsIHNvdXRoXSwKCSAgICAgICAgICAgICAgICAgICAgW3dlc3QsIG5vcnRoXSwgLy8gdG9wIGxlZnQgKGFnYWluKQoJICAgICAgICAgICAgICAgIF0sCgkgICAgICAgICAgICBdOwoJICAgICAgICAgICAgaWYgKHR5cGVvZiByb3RhdGlvbiA9PT0gIm51bWJlciIpIHsKCSAgICAgICAgICAgICAgICBjb29yZGluYXRlcyA9IHJvdGF0ZUJveChiYm94LCBjb29yZGluYXRlcywgcm90YXRpb24pOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICBiYm94LAoJICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQb2x5Z29uIiwKCSAgICAgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXMsCgkgICAgICAgICAgICAgICAgfSwKCSAgICAgICAgICAgIH07CgkgICAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIG51bGw7Cgl9CglmdW5jdGlvbiBnZXRHcm91bmRPdmVybGF5KG5vZGUsIHN0eWxlTWFwLCBzY2hlbWEsIG9wdGlvbnMpIHsKCSAgICBjb25zdCBib3ggPSBnZXRHcm91bmRPdmVybGF5Qm94KG5vZGUpOwoJICAgIGNvbnN0IGdlb21ldHJ5ID0gYm94Py5nZW9tZXRyeSB8fCBudWxsOwoJICAgIGlmICghZ2VvbWV0cnkgJiYgb3B0aW9ucy5za2lwTnVsbEdlb21ldHJ5KSB7CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH0KCSAgICBjb25zdCBmZWF0dXJlID0gewoJICAgICAgICB0eXBlOiAiRmVhdHVyZSIsCgkgICAgICAgIGdlb21ldHJ5LAoJICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKAoJICAgICAgICAvKioKCSAgICAgICAgICogUmVsYXRlZCB0bwoJICAgICAgICAgKiBodHRwczovL2dpc3QuZ2l0aHViLmNvbS90bWN3LzAzN2ExY2I2NjYwZDc0YTM5MmU5ZGE3NDQ2NTQwZjQ2CgkgICAgICAgICAqLwoJICAgICAgICB7ICJAZ2VvbWV0cnktdHlwZSI6ICJncm91bmRvdmVybGF5IiB9LCBnZXRNdWx0aShub2RlLCBbCgkgICAgICAgICAgICAibmFtZSIsCgkgICAgICAgICAgICAiYWRkcmVzcyIsCgkgICAgICAgICAgICAidmlzaWJpbGl0eSIsCgkgICAgICAgICAgICAib3BlbiIsCgkgICAgICAgICAgICAicGhvbmVOdW1iZXIiLAoJICAgICAgICAgICAgImRlc2NyaXB0aW9uIiwKCSAgICAgICAgXSksIGdldE1heWJlSFRNTERlc2NyaXB0aW9uKG5vZGUpLCBleHRyYWN0Q2FzY2FkZWRTdHlsZShub2RlLCBzdHlsZU1hcCksIGV4dHJhY3RTdHlsZShub2RlKSwgZXh0cmFjdEljb25IcmVmKG5vZGUpLCBleHRyYWN0RXh0ZW5kZWREYXRhKG5vZGUsIHNjaGVtYSksIGV4dHJhY3RUaW1lU3Bhbihub2RlKSwgZXh0cmFjdFRpbWVTdGFtcChub2RlKSksCgkgICAgfTsKCSAgICBpZiAoYm94Py5iYm94KSB7CgkgICAgICAgIGZlYXR1cmUuYmJveCA9IGJveC5iYm94OwoJICAgIH0KCSAgICBpZiAoZmVhdHVyZS5wcm9wZXJ0aWVzPy52aXNpYmlsaXR5ICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgZmVhdHVyZS5wcm9wZXJ0aWVzLnZpc2liaWxpdHkgPSBmZWF0dXJlLnByb3BlcnRpZXMudmlzaWJpbGl0eSAhPT0gIjAiOwoJICAgIH0KCSAgICBjb25zdCBpZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCJpZCIpOwoJICAgIGlmIChpZCAhPT0gbnVsbCAmJiBpZCAhPT0gIiIpCgkgICAgICAgIGZlYXR1cmUuaWQgPSBpZDsKCSAgICByZXR1cm4gZmVhdHVyZTsKCX0KCglmdW5jdGlvbiBnZXRTdHlsZUlkKHN0eWxlKSB7CgkgICAgbGV0IGlkID0gc3R5bGUuZ2V0QXR0cmlidXRlKCJpZCIpOwoJICAgIGNvbnN0IHBhcmVudE5vZGUgPSBzdHlsZS5wYXJlbnROb2RlOwoJICAgIGlmICghaWQgJiYKCSAgICAgICAgaXNFbGVtZW50KHBhcmVudE5vZGUpICYmCgkgICAgICAgIHBhcmVudE5vZGUubG9jYWxOYW1lID09PSAiQ2FzY2FkaW5nU3R5bGUiKSB7CgkgICAgICAgIGlkID0gcGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoImttbDppZCIpIHx8IHBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCJpZCIpOwoJICAgIH0KCSAgICByZXR1cm4gbm9ybWFsaXplSWQoaWQgfHwgIiIpOwoJfQoJZnVuY3Rpb24gYnVpbGRTdHlsZU1hcChub2RlKSB7CgkgICAgY29uc3Qgc3R5bGVNYXAgPSB7fTsKCSAgICBmb3IgKGNvbnN0IHN0eWxlIG9mICQobm9kZSwgIlN0eWxlIikpIHsKCSAgICAgICAgc3R5bGVNYXBbZ2V0U3R5bGVJZChzdHlsZSldID0gZXh0cmFjdFN0eWxlKHN0eWxlKTsKCSAgICB9CgkgICAgZm9yIChjb25zdCBtYXAgb2YgJChub2RlLCAiU3R5bGVNYXAiKSkgewoJICAgICAgICBjb25zdCBpZCA9IG5vcm1hbGl6ZUlkKG1hcC5nZXRBdHRyaWJ1dGUoImlkIikgfHwgIiIpOwoJICAgICAgICB2YWwxKG1hcCwgInN0eWxlVXJsIiwgKHN0eWxlVXJsKSA9PiB7CgkgICAgICAgICAgICBzdHlsZVVybCA9IG5vcm1hbGl6ZUlkKHN0eWxlVXJsKTsKCSAgICAgICAgICAgIGlmIChzdHlsZU1hcFtzdHlsZVVybF0pIHsKCSAgICAgICAgICAgICAgICBzdHlsZU1hcFtpZF0gPSBzdHlsZU1hcFtzdHlsZVVybF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgIH0KCSAgICByZXR1cm4gc3R5bGVNYXA7Cgl9CglmdW5jdGlvbiBidWlsZFNjaGVtYShub2RlKSB7CgkgICAgY29uc3Qgc2NoZW1hID0ge307CgkgICAgZm9yIChjb25zdCBmaWVsZCBvZiAkKG5vZGUsICJTaW1wbGVGaWVsZCIpKSB7CgkgICAgICAgIHNjaGVtYVtmaWVsZC5nZXRBdHRyaWJ1dGUoIm5hbWUiKSB8fCAiIl0gPQoJICAgICAgICAgICAgdHlwZUNvbnZlcnRlcnNbZmllbGQuZ2V0QXR0cmlidXRlKCJ0eXBlIikgfHwgIiJdIHx8CgkgICAgICAgICAgICAgICAgdHlwZUNvbnZlcnRlcnNbInN0cmluZyJdOwoJICAgIH0KCSAgICByZXR1cm4gc2NoZW1hOwoJfQoJY29uc3QgRk9MREVSX1BST1BTID0gWwoJICAgICJuYW1lIiwKCSAgICAidmlzaWJpbGl0eSIsCgkgICAgIm9wZW4iLAoJICAgICJhZGRyZXNzIiwKCSAgICAiZGVzY3JpcHRpb24iLAoJICAgICJwaG9uZU51bWJlciIsCgkgICAgInZpc2liaWxpdHkiLAoJXTsKCWZ1bmN0aW9uIGdldEZvbGRlcihub2RlKSB7CgkgICAgY29uc3QgbWV0YSA9IHt9OwoJICAgIGZvciAoY29uc3QgY2hpbGQgb2YgQXJyYXkuZnJvbShub2RlLmNoaWxkTm9kZXMpKSB7CgkgICAgICAgIGlmIChpc0VsZW1lbnQoY2hpbGQpICYmIEZPTERFUl9QUk9QUy5pbmNsdWRlcyhjaGlsZC50YWdOYW1lKSkgewoJICAgICAgICAgICAgbWV0YVtjaGlsZC50YWdOYW1lXSA9IG5vZGVWYWwoY2hpbGQpOwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICJmb2xkZXIiLAoJICAgICAgICBtZXRhLAoJICAgICAgICBjaGlsZHJlbjogW10sCgkgICAgfTsKCX0KCS8qKgoJICogWWllbGQgYSBuZXN0ZWQgdHJlZSB3aXRoIEtNTCBmb2xkZXIgc3RydWN0dXJlCgkgKgoJICogVGhpcyBnZW5lcmF0ZXMgYSB0cmVlIHdpdGggdGhlIGdpdmVuIHN0cnVjdHVyZToKCSAqCgkgKiBgYGBqcwoJICogewoJICogICAidHlwZSI6ICJyb290IiwKCSAqICAgImNoaWxkcmVuIjogWwoJICogICAgIHsKCSAqICAgICAgICJ0eXBlIjogImZvbGRlciIsCgkgKiAgICAgICAibWV0YSI6IHsKCSAqICAgICAgICAgIm5hbWUiOiAiVGVzdCIKCSAqICAgICAgIH0sCgkgKiAgICAgICAiY2hpbGRyZW4iOiBbCgkgKiAgICAgICAgICAvLyAuLi5mZWF0dXJlcyBhbmQgZm9sZGVycwoJICogICAgICAgXQoJICogICAgIH0KCSAqICAgICAvLyAuLi5mZWF0dXJlcwoJICogICBdCgkgKiB9CgkgKiBgYGAKCSAqCgkgKiAjIyMgR3JvdW5kT3ZlcmxheQoJICoKCSAqIEdyb3VuZE92ZXJsYXkgZWxlbWVudHMgYXJlIGNvbnZlcnRlZCBpbnRvCgkgKiBgRmVhdHVyZWAgb2JqZWN0cyB3aXRoIGBQb2x5Z29uYCBnZW9tZXRyaWVzLAoJICogYSBwcm9wZXJ0eSBsaWtlOgoJICoKCSAqIGBgYGpzb24KCSAqIHsKCSAqICAgIkBnZW9tZXRyeS10eXBlIjogImdyb3VuZG92ZXJsYXkiCgkgKiB9CgkgKiBgYGAKCSAqCgkgKiBBbmQgdGhlIGdyb3VuZCBvdmVybGF5J3MgaW1hZ2UgVVJMIGluIHRoZSBgaHJlZmAKCSAqIHByb3BlcnR5LiBHcm91bmQgb3ZlcmxheXMgd2lsbCBuZWVkIHRvIGJlIGRpc3BsYXllZAoJICogd2l0aCBhIHNlcGFyYXRlIG1ldGhvZCB0byBvdGhlciBmZWF0dXJlcywgZGVwZW5kaW5nCgkgKiBvbiB3aGljaCBtYXAgZnJhbWV3b3JrIHlvdSdyZSB1c2luZy4KCSAqLwoJZnVuY3Rpb24ga21sV2l0aEZvbGRlcnMobm9kZSwgb3B0aW9ucyA9IHsKCSAgICBza2lwTnVsbEdlb21ldHJ5OiBmYWxzZSwKCX0pIHsKCSAgICBjb25zdCBzdHlsZU1hcCA9IGJ1aWxkU3R5bGVNYXAobm9kZSk7CgkgICAgY29uc3Qgc2NoZW1hID0gYnVpbGRTY2hlbWEobm9kZSk7CgkgICAgY29uc3QgdHJlZSA9IHsgdHlwZTogInJvb3QiLCBjaGlsZHJlbjogW10gfTsKCSAgICBmdW5jdGlvbiB0cmF2ZXJzZShub2RlLCBwb2ludGVyLCBvcHRpb25zKSB7CgkgICAgICAgIGlmIChpc0VsZW1lbnQobm9kZSkpIHsKCSAgICAgICAgICAgIHN3aXRjaCAobm9kZS50YWdOYW1lKSB7CgkgICAgICAgICAgICAgICAgY2FzZSAiR3JvdW5kT3ZlcmxheSI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgcGxhY2VtYXJrID0gZ2V0R3JvdW5kT3ZlcmxheShub2RlLCBzdHlsZU1hcCwgc2NoZW1hLCBvcHRpb25zKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHBsYWNlbWFyaykgewoJICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlci5jaGlsZHJlbi5wdXNoKHBsYWNlbWFyayk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhc2UgIlBsYWNlbWFyayI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgcGxhY2VtYXJrID0gZ2V0UGxhY2VtYXJrKG5vZGUsIHN0eWxlTWFwLCBzY2hlbWEsIG9wdGlvbnMpOwoJICAgICAgICAgICAgICAgICAgICBpZiAocGxhY2VtYXJrKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBwb2ludGVyLmNoaWxkcmVuLnB1c2gocGxhY2VtYXJrKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgY2FzZSAiRm9sZGVyIjogewoJICAgICAgICAgICAgICAgICAgICBjb25zdCBmb2xkZXIgPSBnZXRGb2xkZXIobm9kZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvaW50ZXIuY2hpbGRyZW4ucHVzaChmb2xkZXIpOwoJICAgICAgICAgICAgICAgICAgICBwb2ludGVyID0gZm9sZGVyOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG5vZGUuY2hpbGROb2RlcykgewoJICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2RlLmNoaWxkTm9kZXMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgICAgICB0cmF2ZXJzZShub2RlLmNoaWxkTm9kZXNbaV0sIHBvaW50ZXIsIG9wdGlvbnMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoJICAgIHRyYXZlcnNlKG5vZGUsIHRyZWUsIG9wdGlvbnMpOwoJICAgIHJldHVybiB0cmVlOwoJfQoJLyoqCgkgKiBDb252ZXJ0IEtNTCB0byBHZW9KU09OIGluY3JlbWVudGFsbHksIHJldHVybmluZwoJICogYSBbR2VuZXJhdG9yXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L0d1aWRlL0l0ZXJhdG9yc19hbmRfR2VuZXJhdG9ycykKCSAqIHRoYXQgeWllbGRzIG91dHB1dCBmZWF0dXJlIGJ5IGZlYXR1cmUuCgkgKi8KCWZ1bmN0aW9uKiBrbWxHZW4obm9kZSwgb3B0aW9ucyA9IHsKCSAgICBza2lwTnVsbEdlb21ldHJ5OiBmYWxzZSwKCX0pIHsKCSAgICBjb25zdCBzdHlsZU1hcCA9IGJ1aWxkU3R5bGVNYXAobm9kZSk7CgkgICAgY29uc3Qgc2NoZW1hID0gYnVpbGRTY2hlbWEobm9kZSk7CgkgICAgZm9yIChjb25zdCBwbGFjZW1hcmsgb2YgJChub2RlLCAiUGxhY2VtYXJrIikpIHsKCSAgICAgICAgY29uc3QgZmVhdHVyZSA9IGdldFBsYWNlbWFyayhwbGFjZW1hcmssIHN0eWxlTWFwLCBzY2hlbWEsIG9wdGlvbnMpOwoJICAgICAgICBpZiAoZmVhdHVyZSkKCSAgICAgICAgICAgIHlpZWxkIGZlYXR1cmU7CgkgICAgfQoJICAgIGZvciAoY29uc3QgZ3JvdW5kT3ZlcmxheSBvZiAkKG5vZGUsICJHcm91bmRPdmVybGF5IikpIHsKCSAgICAgICAgY29uc3QgZmVhdHVyZSA9IGdldEdyb3VuZE92ZXJsYXkoZ3JvdW5kT3ZlcmxheSwgc3R5bGVNYXAsIHNjaGVtYSwgb3B0aW9ucyk7CgkgICAgICAgIGlmIChmZWF0dXJlKQoJICAgICAgICAgICAgeWllbGQgZmVhdHVyZTsKCSAgICB9Cgl9CgkvKioKCSAqIENvbnZlcnQgYSBLTUwgZG9jdW1lbnQgdG8gR2VvSlNPTi4gVGhlIGZpcnN0IGFyZ3VtZW50LCBgZG9jYCwgbXVzdCBiZSBhIEtNTAoJICogZG9jdW1lbnQgYXMgYW4gWE1MIERPTSAtIG5vdCBhcyBhIHN0cmluZy4gWW91IGNhbiBnZXQgdGhpcyB1c2luZyBqUXVlcnkncyBkZWZhdWx0CgkgKiBgLmFqYXhgIGZ1bmN0aW9uIG9yIHVzaW5nIGEgYmFyZSBYTUxIdHRwUmVxdWVzdCB3aXRoIHRoZSBgLnJlc3BvbnNlYCBwcm9wZXJ0eQoJICogaG9sZGluZyBhbiBYTUwgRE9NLgoJICoKCSAqIFRoZSBvdXRwdXQgaXMgYSBKYXZhU2NyaXB0IG9iamVjdCBvZiBHZW9KU09OIGRhdGEuIFlvdSBjYW4gY29udmVydCBpdCB0byBhIHN0cmluZwoJICogd2l0aCBbSlNPTi5zdHJpbmdpZnldKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0pTT04vc3RyaW5naWZ5KQoJICogb3IgdXNlIGl0IGRpcmVjdGx5IGluIGxpYnJhcmllcy4KCSAqLwoJZnVuY3Rpb24ga21sKG5vZGUsIG9wdGlvbnMgPSB7CgkgICAgc2tpcE51bGxHZW9tZXRyeTogZmFsc2UsCgl9KSB7CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmVDb2xsZWN0aW9uIiwKCSAgICAgICAgZmVhdHVyZXM6IEFycmF5LmZyb20oa21sR2VuKG5vZGUsIG9wdGlvbnMpKSwKCSAgICB9OwoJfQoKCXZhciB0b0dlb0pzb24gPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7CgkJX19wcm90b19fOiBudWxsLAoJCWdweDogZ3B4LAoJCWdweEdlbjogZ3B4R2VuLAoJCWttbDoga21sLAoJCWttbEdlbjoga21sR2VuLAoJCWttbFdpdGhGb2xkZXJzOiBrbWxXaXRoRm9sZGVycywKCQl0Y3g6IHRjeCwKCQl0Y3hHZW46IHRjeEdlbgoJfSk7CgoJdmFyIHBvbHlsaW5lID0ge2V4cG9ydHM6IHt9fTsKCgkoZnVuY3Rpb24gKG1vZHVsZSkgewoKCQkvKioKCQkgKiBCYXNlZCBvZmYgb2YgW3RoZSBvZmZpY2FsIEdvb2dsZSBkb2N1bWVudF0oaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vbWFwcy9kb2N1bWVudGF0aW9uL3V0aWxpdGllcy9wb2x5bGluZWFsZ29yaXRobSkKCQkgKgoJCSAqIFNvbWUgcGFydHMgZnJvbSBbdGhpcyBpbXBsZW1lbnRhdGlvbl0oaHR0cDovL2ZhY3N0YWZmLnVuY2EuZWR1L21jbWNjbHVyL0dvb2dsZU1hcHMvRW5jb2RlUG9seWxpbmUvUG9seWxpbmVFbmNvZGVyLmpzKQoJCSAqIGJ5IFtNYXJrIE1jQ2x1cmVdKGh0dHA6Ly9mYWNzdGFmZi51bmNhLmVkdS9tY21jY2x1ci8pCgkJICoKCQkgKiBAbW9kdWxlIHBvbHlsaW5lCgkJICovCgoJCXZhciBwb2x5bGluZSA9IHt9OwoKCQlmdW5jdGlvbiBweTJfcm91bmQodmFsdWUpIHsKCQkgICAgLy8gR29vZ2xlJ3MgcG9seWxpbmUgYWxnb3JpdGhtIHVzZXMgdGhlIHNhbWUgcm91bmRpbmcgc3RyYXRlZ3kgYXMgUHl0aG9uIDIsIHdoaWNoIGlzIGRpZmZlcmVudCBmcm9tIEpTIGZvciBuZWdhdGl2ZSB2YWx1ZXMKCQkgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5hYnModmFsdWUpICsgMC41KSAqICh2YWx1ZSA+PSAwID8gMSA6IC0xKTsKCQl9CgoJCWZ1bmN0aW9uIGVuY29kZShjdXJyZW50LCBwcmV2aW91cywgZmFjdG9yKSB7CgkJICAgIGN1cnJlbnQgPSBweTJfcm91bmQoY3VycmVudCAqIGZhY3Rvcik7CgkJICAgIHByZXZpb3VzID0gcHkyX3JvdW5kKHByZXZpb3VzICogZmFjdG9yKTsKCQkgICAgdmFyIGNvb3JkaW5hdGUgPSAoY3VycmVudCAtIHByZXZpb3VzKSAqIDI7CgkJICAgIGlmIChjb29yZGluYXRlIDwgMCkgewoJCSAgICAgICAgY29vcmRpbmF0ZSA9IC1jb29yZGluYXRlIC0gMTsKCQkgICAgfQoJCSAgICB2YXIgb3V0cHV0ID0gJyc7CgkJICAgIHdoaWxlIChjb29yZGluYXRlID49IDB4MjApIHsKCQkgICAgICAgIG91dHB1dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgweDIwIHwgKGNvb3JkaW5hdGUgJiAweDFmKSkgKyA2Myk7CgkJICAgICAgICBjb29yZGluYXRlIC89IDMyOwoJCSAgICB9CgkJICAgIG91dHB1dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChjb29yZGluYXRlIHwgMCkgKyA2Myk7CgkJICAgIHJldHVybiBvdXRwdXQ7CgkJfQoKCQkvKioKCQkgKiBEZWNvZGVzIHRvIGEgW2xhdGl0dWRlLCBsb25naXR1ZGVdIGNvb3JkaW5hdGVzIGFycmF5LgoJCSAqCgkJICogVGhpcyBpcyBhZGFwdGVkIGZyb20gdGhlIGltcGxlbWVudGF0aW9uIGluIFByb2plY3QtT1NSTS4KCQkgKgoJCSAqIEBwYXJhbSB7U3RyaW5nfSBzdHIKCQkgKiBAcGFyYW0ge051bWJlcn0gcHJlY2lzaW9uCgkJICogQHJldHVybnMge0FycmF5fQoJCSAqCgkJICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vUHJvamVjdC1PU1JNL29zcm0tZnJvbnRlbmQvYmxvYi9tYXN0ZXIvV2ViQ29udGVudC9yb3V0aW5nL09TUk0uUm91dGluZ0dlb21ldHJ5LmpzCgkJICovCgkJcG9seWxpbmUuZGVjb2RlID0gZnVuY3Rpb24oc3RyLCBwcmVjaXNpb24pIHsKCQkgICAgdmFyIGluZGV4ID0gMCwKCQkgICAgICAgIGxhdCA9IDAsCgkJICAgICAgICBsbmcgPSAwLAoJCSAgICAgICAgY29vcmRpbmF0ZXMgPSBbXSwKCQkgICAgICAgIHNoaWZ0ID0gMCwKCQkgICAgICAgIHJlc3VsdCA9IDAsCgkJICAgICAgICBieXRlID0gbnVsbCwKCQkgICAgICAgIGxhdGl0dWRlX2NoYW5nZSwKCQkgICAgICAgIGxvbmdpdHVkZV9jaGFuZ2UsCgkJICAgICAgICBmYWN0b3IgPSBNYXRoLnBvdygxMCwgTnVtYmVyLmlzSW50ZWdlcihwcmVjaXNpb24pID8gcHJlY2lzaW9uIDogNSk7CgoJCSAgICAvLyBDb29yZGluYXRlcyBoYXZlIHZhcmlhYmxlIGxlbmd0aCB3aGVuIGVuY29kZWQsIHNvIGp1c3Qga2VlcAoJCSAgICAvLyB0cmFjayBvZiB3aGV0aGVyIHdlJ3ZlIGhpdCB0aGUgZW5kIG9mIHRoZSBzdHJpbmcuIEluIGVhY2gKCQkgICAgLy8gbG9vcCBpdGVyYXRpb24sIGEgc2luZ2xlIGNvb3JkaW5hdGUgaXMgZGVjb2RlZC4KCQkgICAgd2hpbGUgKGluZGV4IDwgc3RyLmxlbmd0aCkgewoKCQkgICAgICAgIC8vIFJlc2V0IHNoaWZ0LCByZXN1bHQsIGFuZCBieXRlCgkJICAgICAgICBieXRlID0gbnVsbDsKCQkgICAgICAgIHNoaWZ0ID0gMTsKCQkgICAgICAgIHJlc3VsdCA9IDA7CgoJCSAgICAgICAgZG8gewoJCSAgICAgICAgICAgIGJ5dGUgPSBzdHIuY2hhckNvZGVBdChpbmRleCsrKSAtIDYzOwoJCSAgICAgICAgICAgIHJlc3VsdCArPSAoYnl0ZSAmIDB4MWYpICogc2hpZnQ7CgkJICAgICAgICAgICAgc2hpZnQgKj0gMzI7CgkJICAgICAgICB9IHdoaWxlIChieXRlID49IDB4MjApOwoKCQkgICAgICAgIGxhdGl0dWRlX2NoYW5nZSA9IChyZXN1bHQgJiAxKSA/ICgoLXJlc3VsdCAtIDEpIC8gMikgOiAocmVzdWx0IC8gMik7CgoJCSAgICAgICAgc2hpZnQgPSAxOwoJCSAgICAgICAgcmVzdWx0ID0gMDsKCgkJICAgICAgICBkbyB7CgkJICAgICAgICAgICAgYnl0ZSA9IHN0ci5jaGFyQ29kZUF0KGluZGV4KyspIC0gNjM7CgkJICAgICAgICAgICAgcmVzdWx0ICs9IChieXRlICYgMHgxZikgKiBzaGlmdDsKCQkgICAgICAgICAgICBzaGlmdCAqPSAzMjsKCQkgICAgICAgIH0gd2hpbGUgKGJ5dGUgPj0gMHgyMCk7CgoJCSAgICAgICAgbG9uZ2l0dWRlX2NoYW5nZSA9IChyZXN1bHQgJiAxKSA/ICgoLXJlc3VsdCAtIDEpIC8gMikgOiAocmVzdWx0IC8gMik7CgoJCSAgICAgICAgbGF0ICs9IGxhdGl0dWRlX2NoYW5nZTsKCQkgICAgICAgIGxuZyArPSBsb25naXR1ZGVfY2hhbmdlOwoKCQkgICAgICAgIGNvb3JkaW5hdGVzLnB1c2goW2xhdCAvIGZhY3RvciwgbG5nIC8gZmFjdG9yXSk7CgkJICAgIH0KCgkJICAgIHJldHVybiBjb29yZGluYXRlczsKCQl9OwoKCQkvKioKCQkgKiBFbmNvZGVzIHRoZSBnaXZlbiBbbGF0aXR1ZGUsIGxvbmdpdHVkZV0gY29vcmRpbmF0ZXMgYXJyYXkuCgkJICoKCQkgKiBAcGFyYW0ge0FycmF5LjxBcnJheS48TnVtYmVyPj59IGNvb3JkaW5hdGVzCgkJICogQHBhcmFtIHtOdW1iZXJ9IHByZWNpc2lvbgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9CgkJICovCgkJcG9seWxpbmUuZW5jb2RlID0gZnVuY3Rpb24oY29vcmRpbmF0ZXMsIHByZWNpc2lvbikgewoJCSAgICBpZiAoIWNvb3JkaW5hdGVzLmxlbmd0aCkgeyByZXR1cm4gJyc7IH0KCgkJICAgIHZhciBmYWN0b3IgPSBNYXRoLnBvdygxMCwgTnVtYmVyLmlzSW50ZWdlcihwcmVjaXNpb24pID8gcHJlY2lzaW9uIDogNSksCgkJICAgICAgICBvdXRwdXQgPSBlbmNvZGUoY29vcmRpbmF0ZXNbMF1bMF0sIDAsIGZhY3RvcikgKyBlbmNvZGUoY29vcmRpbmF0ZXNbMF1bMV0sIDAsIGZhY3Rvcik7CgoJCSAgICBmb3IgKHZhciBpID0gMTsgaSA8IGNvb3JkaW5hdGVzLmxlbmd0aDsgaSsrKSB7CgkJICAgICAgICB2YXIgYSA9IGNvb3JkaW5hdGVzW2ldLCBiID0gY29vcmRpbmF0ZXNbaSAtIDFdOwoJCSAgICAgICAgb3V0cHV0ICs9IGVuY29kZShhWzBdLCBiWzBdLCBmYWN0b3IpOwoJCSAgICAgICAgb3V0cHV0ICs9IGVuY29kZShhWzFdLCBiWzFdLCBmYWN0b3IpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gb3V0cHV0OwoJCX07CgoJCWZ1bmN0aW9uIGZsaXBwZWQoY29vcmRzKSB7CgkJICAgIHZhciBmbGlwcGVkID0gW107CgkJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7CgkJICAgICAgICB2YXIgY29vcmQgPSBjb29yZHNbaV0uc2xpY2UoKTsKCQkgICAgICAgIGZsaXBwZWQucHVzaChbY29vcmRbMV0sIGNvb3JkWzBdXSk7CgkJICAgIH0KCQkgICAgcmV0dXJuIGZsaXBwZWQ7CgkJfQoKCQkvKioKCQkgKiBFbmNvZGVzIGEgR2VvSlNPTiBMaW5lU3RyaW5nIGZlYXR1cmUvZ2VvbWV0cnkuCgkJICoKCQkgKiBAcGFyYW0ge09iamVjdH0gZ2VvanNvbgoJCSAqIEBwYXJhbSB7TnVtYmVyfSBwcmVjaXNpb24KCQkgKiBAcmV0dXJucyB7U3RyaW5nfQoJCSAqLwoJCXBvbHlsaW5lLmZyb21HZW9KU09OID0gZnVuY3Rpb24oZ2VvanNvbiwgcHJlY2lzaW9uKSB7CgkJICAgIGlmIChnZW9qc29uICYmIGdlb2pzb24udHlwZSA9PT0gJ0ZlYXR1cmUnKSB7CgkJICAgICAgICBnZW9qc29uID0gZ2VvanNvbi5nZW9tZXRyeTsKCQkgICAgfQoJCSAgICBpZiAoIWdlb2pzb24gfHwgZ2VvanNvbi50eXBlICE9PSAnTGluZVN0cmluZycpIHsKCQkgICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgbXVzdCBiZSBhIEdlb0pTT04gTGluZVN0cmluZycpOwoJCSAgICB9CgkJICAgIHJldHVybiBwb2x5bGluZS5lbmNvZGUoZmxpcHBlZChnZW9qc29uLmNvb3JkaW5hdGVzKSwgcHJlY2lzaW9uKTsKCQl9OwoKCQkvKioKCQkgKiBEZWNvZGVzIHRvIGEgR2VvSlNPTiBMaW5lU3RyaW5nIGdlb21ldHJ5LgoJCSAqCgkJICogQHBhcmFtIHtTdHJpbmd9IHN0cgoJCSAqIEBwYXJhbSB7TnVtYmVyfSBwcmVjaXNpb24KCQkgKiBAcmV0dXJucyB7T2JqZWN0fQoJCSAqLwoJCXBvbHlsaW5lLnRvR2VvSlNPTiA9IGZ1bmN0aW9uKHN0ciwgcHJlY2lzaW9uKSB7CgkJICAgIHZhciBjb29yZHMgPSBwb2x5bGluZS5kZWNvZGUoc3RyLCBwcmVjaXNpb24pOwoJCSAgICByZXR1cm4gewoJCSAgICAgICAgdHlwZTogJ0xpbmVTdHJpbmcnLAoJCSAgICAgICAgY29vcmRpbmF0ZXM6IGZsaXBwZWQoY29vcmRzKQoJCSAgICB9OwoJCX07CgoJCWlmIChtb2R1bGUuZXhwb3J0cykgewoJCSAgICBtb2R1bGUuZXhwb3J0cyA9IHBvbHlsaW5lOwoJCX0gCgl9IChwb2x5bGluZSkpOwoKCXZhciBwb2x5bGluZUV4cG9ydHMgPSBwb2x5bGluZS5leHBvcnRzOwoKCXZhciB1dGlscyA9ICgoKSA9PiB7CgoJICAgIGNvbnN0IHB1cmdlUHJvcHMgPSAob2JqLCBibGFja2xpc3QpID0+IHsKCSAgICAgICAgaWYgKG9iaikgewoJICAgICAgICAgICAgbGV0IHJzID0gT2JqZWN0LmFzc2lnbih7fSwgb2JqKTsKCSAgICAgICAgICAgIGlmIChibGFja2xpc3QpIHsKCSAgICAgICAgICAgICAgICBmb3IgKGxldCBwcm9wIG9mIGJsYWNrbGlzdCkgewoJICAgICAgICAgICAgICAgICAgICBkZWxldGUgcnNbcHJvcF07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIHJzOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB7fTsKCSAgICB9OwoKCSAgICBjb25zdCBtZXJnZVByb3BzID0gKG9iajEsIG9iajIpID0+IHsKCSAgICAgICAgb2JqMSA9IG9iajEgPyBvYmoxIDoge307CgkgICAgICAgIG9iajIgPSBvYmoyID8gb2JqMiA6IHt9OwoJICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihvYmoxLCBvYmoyKTsKCSAgICB9OwoKCSAgICBjb25zdCBmaXJzdCA9IGEgPT4gYVswXTsKCSAgICBjb25zdCBsYXN0ID0gYSA9PiBhW2EubGVuZ3RoIC0gMV07CgkgICAgY29uc3QgY29vcmRzVG9LZXkgPSBhID0+IGEuam9pbignLCcpOwoKCSAgICBjb25zdCBhZGRUb01hcCA9IChtLCBrLCB2KSA9PiB7CgkgICAgICAgIGxldCBhID0gbVtrXTsKCSAgICAgICAgaWYgKGEpIHsKCSAgICAgICAgICAgIGEucHVzaCh2KTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIG1ba10gPSBbdl07CgkgICAgICAgIH0KCSAgICB9OwoKCSAgICBjb25zdCByZW1vdmVGcm9tTWFwID0gKG0sIGssIHYpID0+IHsKCSAgICAgICAgbGV0IGEgPSBtW2tdOwoJICAgICAgICBsZXQgaWR4ID0gbnVsbDsKCSAgICAgICAgaWYgKGEgJiYgKGlkeCA9IGEuaW5kZXhPZih2KSkgPj0gMCkgewoJICAgICAgICAgICAgYS5zcGxpY2UoaWR4LCAxKTsKCSAgICAgICAgfQoJICAgIH07CgoJICAgIGNvbnN0IGdldEZpcnN0RnJvbU1hcCA9IChtLCBrKSA9PiB7CgkgICAgICAgIGxldCBhID0gbVtrXTsKCSAgICAgICAgaWYgKGEgJiYgYS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICByZXR1cm4gYVswXTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoKCSAgICAvLyBuZWVkIDMrIGRpZmZlcmVudCBwb2ludHMgdG8gZm9ybSBhIHJpbmcsIGhlcmUgdXNpbmcgPiAzIGlzICdjb3ogYSB0aGUgZmlyc3QgYW5kIHRoZSBsYXN0IHBvaW50cyBhcmUgYWN0dWFsbHkgdGhlIHNhbWUKCSAgICBjb25zdCBpc1JpbmcgPSBhID0+IGEubGVuZ3RoID4gMyAmJiBjb29yZHNUb0tleShmaXJzdChhKSkgPT09IGNvb3Jkc1RvS2V5KGxhc3QoYSkpOwoKCSAgICBjb25zdCByaW5nRGlyZWN0aW9uID0gKGEsIHhJZHgsIHlJZHgpID0+IHsKCSAgICAgICAgeElkeCA9IHhJZHggfHwgMCwgeUlkeCA9IHlJZHggfHwgMTsKCSAgICAgICAgLy8gZ2V0IHRoZSBpbmRleCBvZiB0aGUgcG9pbnQgd2hpY2ggaGFzIHRoZSBtYXhpbXVtIHggdmFsdWUKCSAgICAgICAgbGV0IG0gPSBhLnJlZHVjZSgobWF4eElkeCwgdiwgaWR4KSA9PiBhW21heHhJZHhdW3hJZHhdID4gdlt4SWR4XSA/IG1heHhJZHggOiBpZHgsIDApOwoJICAgICAgICAvLyAnY296IHRoZSBmaXJzdCBwb2ludCBpcyB2aXJ0dWFsbHkgdGhlIHNhbWUgb25lIGFzIHRoZSBsYXN0IHBvaW50LCAKCSAgICAgICAgLy8gd2UgbmVlZCB0byBza2lwIGEubGVuZ3RoIC0gMSBmb3IgbGVmdCB3aGVuIG0gPSAwLAoJICAgICAgICAvLyBhbmQgc2tpcCAwIGZvciByaWdodCB3aGVuIG0gPSBhLmxlbmd0aCAtIDE7CgkgICAgICAgIGxldCBsID0gbSA8PSAwID8gYS5sZW5ndGggLSAyIDogbSAtIDEsIHIgPSBtID49IGEubGVuZ3RoIC0gMSA/IDEgOiBtICsgMTsKCSAgICAgICAgbGV0IHhhID0gYVtsXVt4SWR4XSwgeGIgPSBhW21dW3hJZHhdLCB4YyA9IGFbcl1beElkeF07CgkgICAgICAgIGxldCB5YSA9IGFbbF1beUlkeF0sIHliID0gYVttXVt5SWR4XSwgeWMgPSBhW3JdW3lJZHhdOwoJICAgICAgICBsZXQgZGV0ID0gKHhiIC0geGEpICogKHljIC0geWEpIC0gKHhjIC0geGEpICogKHliIC0geWEpOwoJICAgICAgICByZXR1cm4gZGV0IDwgMCA/ICdjbG9ja3dpc2UnIDogJ2NvdW50ZXJjbG9ja3dpc2UnOwoJICAgIH07CgoJICAgIGNvbnN0IHB0SW5zaWRlUG9seWdvbiA9IChwdCwgcG9seWdvbiwgeElkeCwgeUlkeCkgPT4gewoJICAgICAgICB4SWR4ID0geElkeCB8fCAwLCB5SWR4ID0geUlkeCB8fCAxOwoJICAgICAgICBsZXQgcmVzdWx0ID0gZmFsc2U7CgkgICAgICAgIGZvciAobGV0IGkgPSAwLCBqID0gcG9seWdvbi5sZW5ndGggLSAxOyBpIDwgcG9seWdvbi5sZW5ndGg7IGogPSBpKyspIHsKCSAgICAgICAgICAgIGlmICgocG9seWdvbltpXVt4SWR4XSA8PSBwdFt4SWR4XSAmJiBwdFt4SWR4XSA8IHBvbHlnb25bal1beElkeF0gfHwKCSAgICAgICAgICAgICAgICBwb2x5Z29uW2pdW3hJZHhdIDw9IHB0W3hJZHhdICYmIHB0W3hJZHhdIDwgcG9seWdvbltpXVt4SWR4XSkgJiYKCSAgICAgICAgICAgICAgICBwdFt5SWR4XSA8IChwb2x5Z29uW2pdW3lJZHhdIC0gcG9seWdvbltpXVt5SWR4XSkgKiAocHRbeElkeF0gLSBwb2x5Z29uW2ldW3hJZHhdKSAvIChwb2x5Z29uW2pdW3hJZHhdIC0gcG9seWdvbltpXVt4SWR4XSkgKyBwb2x5Z29uW2ldW3lJZHhdKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gIXJlc3VsdDsKCSAgICAgICAgICAgIH0KCgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoKCSAgICBjb25zdCBzdHJUb0Zsb2F0ID0gZWwgPT4gZWwgaW5zdGFuY2VvZiBBcnJheSA/IGVsLm1hcChzdHJUb0Zsb2F0KSA6IHBhcnNlRmxvYXQoZWwpOwoKCSAgICBjbGFzcyBSZWZFbGVtZW50cyBleHRlbmRzIE1hcCB7CgkgICAgICAgIGNvbnN0cnVjdG9yKCkgewoJICAgICAgICAgICAgc3VwZXIoKTsKCSAgICAgICAgICAgIHRoaXMuYmluZGVycyA9IFtdOwoJICAgICAgICB9CgoJICAgICAgICBhZGQoaywgdikgewoJICAgICAgICAgICAgaWYgKCF0aGlzLmhhcyhrKSkgewoJICAgICAgICAgICAgICAgIHRoaXMuc2V0KGssIHYpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gc3VwcHJlc3MgZHVwbGNhdGVkIGtleSBlcnJvcgoJICAgICAgICAgICAgLy8gZWxzZQoJICAgICAgICAgICAgLy8gdGhyb3cgYEVycm9yOiBhZGRpbmcgZHVwbGljYXRlZCBrZXkgJyR7a30nIHRvIFJlZkVsZW1lbnRzYDsKCSAgICAgICAgfQoKCSAgICAgICAgYWRkQmluZGVyKGJpbmRlcikgewoJICAgICAgICAgICAgdGhpcy5iaW5kZXJzLnB1c2goYmluZGVyKTsKCSAgICAgICAgfQoKCSAgICAgICAgYmluZEFsbCgpIHsKCSAgICAgICAgICAgIHRoaXMuYmluZGVycy5mb3JFYWNoKGJpbmRlciA9PiBiaW5kZXIuYmluZCgpKTsKCSAgICAgICAgfQoJICAgIH0KCgkgICAgY2xhc3MgTGF0ZUJpbmRlciB7CgkgICAgICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgdmFsdWVGdW5jLCBjdHgsIGFyZ3MpIHsKCSAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyOwoJICAgICAgICAgICAgdGhpcy52YWx1ZUZ1bmMgPSB2YWx1ZUZ1bmM7CgkgICAgICAgICAgICB0aGlzLmN0eCA9IGN0eDsKCSAgICAgICAgICAgIHRoaXMuYXJncyA9IGFyZ3M7CgkgICAgICAgIH0KCgkgICAgICAgIGJpbmQoKSB7CgkgICAgICAgICAgICBsZXQgdiA9IHRoaXMudmFsdWVGdW5jLmFwcGx5KHRoaXMuY3R4LCB0aGlzLmFyZ3MpOwoJICAgICAgICAgICAgaWYgKHRoaXMuY29udGFpbmVyIGluc3RhbmNlb2YgQXJyYXkpIHsKCSAgICAgICAgICAgICAgICBsZXQgaWR4ID0gdGhpcy5jb250YWluZXIuaW5kZXhPZih0aGlzKTsKCSAgICAgICAgICAgICAgICBpZiAoaWR4ID49IDApIHsKCSAgICAgICAgICAgICAgICAgICAgbGV0IGFyZ3MgPSBbaWR4LCAxXTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh2KTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBbXS5zcGxpY2UuYXBwbHkodGhpcy5jb250YWluZXIsIGFyZ3MpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuY29udGFpbmVyID09PSAnb2JqZWN0JykgewoJICAgICAgICAgICAgICAgIGxldCBrID0gT2JqZWN0LmtleXModGhpcy5jb250YWluZXIpLmZpbmQodiA9PiB0aGlzLmNvbnRhaW5lclt2XSA9PT0gdGhpcyk7CgkgICAgICAgICAgICAgICAgaWYgKGspIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyW2tdID0gdjsKCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNvbnRhaW5lcltrXTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCgkgICAgY2xhc3MgV2F5Q29sbGVjdGlvbiBleHRlbmRzIEFycmF5IHsKCSAgICAgICAgY29uc3RydWN0b3IoKSB7CgkgICAgICAgICAgICBzdXBlcigpOwoJICAgICAgICAgICAgdGhpcy5maXJzdE1hcCA9IHt9OwoJICAgICAgICAgICAgdGhpcy5sYXN0TWFwID0ge307CgkgICAgICAgIH0KCgkgICAgICAgIGFkZFdheSh3YXkpIHsKCSAgICAgICAgICAgIHdheSA9IHdheS50b0Nvb3Jkc0FycmF5KCk7CgkgICAgICAgICAgICBpZiAod2F5Lmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICB0aGlzLnB1c2god2F5KTsKCSAgICAgICAgICAgICAgICBhZGRUb01hcCh0aGlzLmZpcnN0TWFwLCBjb29yZHNUb0tleShmaXJzdCh3YXkpKSwgd2F5KTsKCSAgICAgICAgICAgICAgICBhZGRUb01hcCh0aGlzLmxhc3RNYXAsIGNvb3Jkc1RvS2V5KGxhc3Qod2F5KSksIHdheSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAgIHRvU3RyaW5ncygpIHsKCSAgICAgICAgICAgIGxldCBzdHJpbmdzID0gW10sIHdheSA9IG51bGw7CgkgICAgICAgICAgICB3aGlsZSAod2F5ID0gdGhpcy5zaGlmdCgpKSB7CgkgICAgICAgICAgICAgICAgcmVtb3ZlRnJvbU1hcCh0aGlzLmZpcnN0TWFwLCBjb29yZHNUb0tleShmaXJzdCh3YXkpKSwgd2F5KTsKCSAgICAgICAgICAgICAgICByZW1vdmVGcm9tTWFwKHRoaXMubGFzdE1hcCwgY29vcmRzVG9LZXkobGFzdCh3YXkpKSwgd2F5KTsKCSAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IHdheSwgbmV4dCA9IG51bGw7CgkgICAgICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gY29vcmRzVG9LZXkobGFzdChjdXJyZW50KSksIHNob3VsZFJldmVyc2UgPSBmYWxzZTsKCgkgICAgICAgICAgICAgICAgICAgIG5leHQgPSBnZXRGaXJzdEZyb21NYXAodGhpcy5maXJzdE1hcCwga2V5KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCFuZXh0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBuZXh0ID0gZ2V0Rmlyc3RGcm9tTWFwKHRoaXMubGFzdE1hcCwga2V5KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZFJldmVyc2UgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICBpZiAobmV4dCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpY2UodGhpcy5pbmRleE9mKG5leHQpLCAxKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZyb21NYXAodGhpcy5maXJzdE1hcCwgY29vcmRzVG9LZXkoZmlyc3QobmV4dCkpLCBuZXh0KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZyb21NYXAodGhpcy5sYXN0TWFwLCBjb29yZHNUb0tleShsYXN0KG5leHQpKSwgbmV4dCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdWxkUmV2ZXJzZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsd2F5cyByZXZlcnNlIHNob3J0ZXIgb25lIHRvIHNhdmUgdGltZQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0Lmxlbmd0aCA+IGN1cnJlbnQubGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtjdXJyZW50LCBuZXh0XSA9IFtuZXh0LCBjdXJyZW50XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dC5yZXZlcnNlKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQuY29uY2F0KG5leHQuc2xpY2UoMSkpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSB3aGlsZSAobmV4dCk7CgkgICAgICAgICAgICAgICAgc3RyaW5ncy5wdXNoKHN0clRvRmxvYXQoY3VycmVudCkpOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIHJldHVybiBzdHJpbmdzOwoJICAgICAgICB9CgoJICAgICAgICB0b1JpbmdzKGRpcmVjdGlvbikgewoJICAgICAgICAgICAgbGV0IHN0cmluZ3MgPSB0aGlzLnRvU3RyaW5ncygpOwoJICAgICAgICAgICAgbGV0IHJpbmdzID0gW10sIHN0cmluZyA9IG51bGw7CgkgICAgICAgICAgICB3aGlsZSAoc3RyaW5nID0gc3RyaW5ncy5zaGlmdCgpKSB7CgkgICAgICAgICAgICAgICAgaWYgKGlzUmluZyhzdHJpbmcpKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyaW5nRGlyZWN0aW9uKHN0cmluZykgIT09IGRpcmVjdGlvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nLnJldmVyc2UoKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByaW5ncy5wdXNoKHN0cmluZyk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIHJpbmdzOwoJICAgICAgICB9CgkgICAgfQoKCSAgICByZXR1cm4gewoJICAgICAgICBwdXJnZVByb3BzLCBtZXJnZVByb3BzLAoJICAgICAgICBmaXJzdCwgbGFzdCwgY29vcmRzVG9LZXksCgkgICAgICAgIGFkZFRvTWFwLCByZW1vdmVGcm9tTWFwLCBnZXRGaXJzdEZyb21NYXAsCgkgICAgICAgIGlzUmluZywgcmluZ0RpcmVjdGlvbiwgcHRJbnNpZGVQb2x5Z29uLCBzdHJUb0Zsb2F0LAoJICAgICAgICBSZWZFbGVtZW50cywgTGF0ZUJpbmRlciwgV2F5Q29sbGVjdGlvbgoJICAgIH07Cgl9KSgpOwoKCXZhciBidWlsZGluZyA9IHsKCX07Cgl2YXIgaGlnaHdheSA9IHsKCQl3aGl0ZWxpc3Q6IFsKCQkJInNlcnZpY2VzIiwKCQkJInJlc3RfYXJlYSIsCgkJCSJlc2NhcGUiLAoJCQkiZWxldmF0b3IiCgkJXQoJfTsKCXZhciBuYXR1cmFsID0gewoJCWJsYWNrbGlzdDogWwoJCQkiY29hc3RsaW5lIiwKCQkJImNsaWZmIiwKCQkJInJpZGdlIiwKCQkJImFyZXRlIiwKCQkJInRyZWVfcm93IgoJCV0KCX07Cgl2YXIgbGFuZHVzZSA9IHsKCX07Cgl2YXIgd2F0ZXJ3YXkgPSB7CgkJd2hpdGVsaXN0OiBbCgkJCSJyaXZlcmJhbmsiLAoJCQkiZG9jayIsCgkJCSJib2F0eWFyZCIsCgkJCSJkYW0iCgkJXQoJfTsKCXZhciBhbWVuaXR5ID0gewoJfTsKCXZhciBsZWlzdXJlID0gewoJfTsKCXZhciBiYXJyaWVyID0gewoJCXdoaXRlbGlzdDogWwoJCQkiY2l0eV93YWxsIiwKCQkJImRpdGNoIiwKCQkJImhlZGdlIiwKCQkJInJldGFpbmluZ193YWxsIiwKCQkJIndhbGwiLAoJCQkic3Bpa2VzIgoJCV0KCX07Cgl2YXIgcmFpbHdheSA9IHsKCQl3aGl0ZWxpc3Q6IFsKCQkJInN0YXRpb24iLAoJCQkidHVybnRhYmxlIiwKCQkJInJvdW5kaG91c2UiLAoJCQkicGxhdGZvcm0iCgkJXQoJfTsKCXZhciBhcmVhID0gewoJfTsKCXZhciBib3VuZGFyeSA9IHsKCX07Cgl2YXIgbWFuX21hZGUgPSB7CgkJYmxhY2tsaXN0OiBbCgkJCSJjdXRsaW5lIiwKCQkJImVtYmFua21lbnQiLAoJCQkicGlwZWxpbmUiCgkJXQoJfTsKCXZhciBwb3dlciA9IHsKCQl3aGl0ZWxpc3Q6IFsKCQkJInBsYW50IiwKCQkJInN1YnN0YXRpb24iLAoJCQkiZ2VuZXJhdG9yIiwKCQkJInRyYW5zZm9ybWVyIgoJCV0KCX07Cgl2YXIgcGxhY2UgPSB7Cgl9OwoJdmFyIHNob3AgPSB7Cgl9OwoJdmFyIGFlcm93YXkgPSB7CgkJYmxhY2tsaXN0OiBbCgkJCSJ0YXhpd2F5IgoJCV0KCX07Cgl2YXIgdG91cmlzbSA9IHsKCX07Cgl2YXIgaGlzdG9yaWMgPSB7Cgl9OwoJdmFyIHB1YmxpY190cmFuc3BvcnQgPSB7Cgl9OwoJdmFyIG9mZmljZSA9IHsKCX07Cgl2YXIgbWlsaXRhcnkgPSB7Cgl9OwoJdmFyIHJ1aW5zID0gewoJfTsKCXZhciBjcmFmdCA9IHsKCX07Cgl2YXIgZ29sZiA9IHsKCX07Cgl2YXIgaW5kb29yID0gewoJfTsKCXZhciByZXF1aXJlJCQxID0gewoJCWJ1aWxkaW5nOiBidWlsZGluZywKCQloaWdod2F5OiBoaWdod2F5LAoJCW5hdHVyYWw6IG5hdHVyYWwsCgkJbGFuZHVzZTogbGFuZHVzZSwKCQl3YXRlcndheTogd2F0ZXJ3YXksCgkJYW1lbml0eTogYW1lbml0eSwKCQlsZWlzdXJlOiBsZWlzdXJlLAoJCWJhcnJpZXI6IGJhcnJpZXIsCgkJcmFpbHdheTogcmFpbHdheSwKCQlhcmVhOiBhcmVhLAoJCWJvdW5kYXJ5OiBib3VuZGFyeSwKCQltYW5fbWFkZTogbWFuX21hZGUsCgkJcG93ZXI6IHBvd2VyLAoJCXBsYWNlOiBwbGFjZSwKCQlzaG9wOiBzaG9wLAoJCWFlcm93YXk6IGFlcm93YXksCgkJdG91cmlzbTogdG91cmlzbSwKCQloaXN0b3JpYzogaGlzdG9yaWMsCgkJcHVibGljX3RyYW5zcG9ydDogcHVibGljX3RyYW5zcG9ydCwKCQlvZmZpY2U6IG9mZmljZSwKCQkiYnVpbGRpbmc6cGFydCI6IHsKCX0sCgkJbWlsaXRhcnk6IG1pbGl0YXJ5LAoJCXJ1aW5zOiBydWlucywKCQkiYXJlYTpoaWdod2F5IjogewoJfSwKCQljcmFmdDogY3JhZnQsCgkJZ29sZjogZ29sZiwKCQlpbmRvb3I6IGluZG9vcgoJfTsKCgl2YXIgb3Ntb2JqcyA9ICgoKSA9PiB7CgoJICAgIGNvbnN0IHsgZmlyc3QsIGxhc3QsIGNvb3Jkc1RvS2V5LAoJICAgICAgICBhZGRUb01hcCwgcmVtb3ZlRnJvbU1hcCwgZ2V0Rmlyc3RGcm9tTWFwLAoJICAgICAgICBpc1JpbmcsIHJpbmdEaXJlY3Rpb24sIHB0SW5zaWRlUG9seWdvbiwgc3RyVG9GbG9hdCwKCSAgICAgICAgTGF0ZUJpbmRlciwgV2F5Q29sbGVjdGlvbiB9ID0gdXRpbHMsCgkgICAgICAgIHBvbHlnb25UYWdzID0gcmVxdWlyZSQkMTsKCgkgICAgY2xhc3MgT3NtT2JqZWN0IHsKCSAgICAgICAgY29uc3RydWN0b3IodHlwZSwgaWQsIHJlZkVsZW1zKSB7CgkgICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlOwoJICAgICAgICAgICAgdGhpcy5pZCA9IGlkOwoJICAgICAgICAgICAgdGhpcy5yZWZFbGVtcyA9IHJlZkVsZW1zOwoJICAgICAgICAgICAgdGhpcy50YWdzID0ge307CgkgICAgICAgICAgICB0aGlzLnByb3BzID0geyBpZDogdGhpcy5nZXRDb21wb3NpdGVJZCgpIH07CgkgICAgICAgICAgICB0aGlzLnJlZkNvdW50ID0gMDsKCSAgICAgICAgICAgIHRoaXMuaGFzVGFnID0gZmFsc2U7CgkgICAgICAgICAgICBpZiAocmVmRWxlbXMpIHsKCSAgICAgICAgICAgICAgICByZWZFbGVtcy5hZGQodGhpcy5nZXRDb21wb3NpdGVJZCgpLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgYWRkVGFncyh0YWdzKSB7CgkgICAgICAgICAgICB0aGlzLnRhZ3MgPSBPYmplY3QuYXNzaWduKHRoaXMudGFncywgdGFncyk7CgkgICAgICAgICAgICB0aGlzLmhhc1RhZyA9IHRhZ3MgPyB0cnVlIDogZmFsc2U7CgkgICAgICAgIH0KCgkgICAgICAgIGFkZFRhZyhrLCB2KSB7CgkgICAgICAgICAgICB0aGlzLnRhZ3Nba10gPSB2OwoJICAgICAgICAgICAgdGhpcy5oYXNUYWcgPSBrID8gdHJ1ZSA6IGZhbHNlOwoJICAgICAgICB9CgoJICAgICAgICBhZGRQcm9wKGssIHYpIHsKCSAgICAgICAgICAgIHRoaXMucHJvcHNba10gPSB2OwoJICAgICAgICB9CgoJICAgICAgICBhZGRQcm9wcyhwcm9wcykgewoJICAgICAgICAgICAgdGhpcy5wcm9wcyA9IE9iamVjdC5hc3NpZ24odGhpcy5wcm9wcywgcHJvcHMpOwoJICAgICAgICB9CgoJICAgICAgICBnZXRDb21wb3NpdGVJZCgpIHsKCSAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLnR5cGV9LyR7dGhpcy5pZH1gOwoJICAgICAgICB9CgoJICAgICAgICBnZXRQcm9wcygpIHsKCSAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHRoaXMucHJvcHMsIHRoaXMudGFncyk7CgkgICAgICAgIH0KCgkgICAgICAgIHRvRmVhdHVyZUFycmF5KCkgewoJICAgICAgICAgICAgcmV0dXJuIFtdOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBjbGFzcyBOb2RlIGV4dGVuZHMgT3NtT2JqZWN0IHsKCSAgICAgICAgY29uc3RydWN0b3IoaWQsIHJlZkVsZW1zKSB7CgkgICAgICAgICAgICBzdXBlcignbm9kZScsIGlkLCByZWZFbGVtcyk7CgkgICAgICAgICAgICB0aGlzLmxhdExuZyA9IG51bGw7CgkgICAgICAgIH0KCgkgICAgICAgIHNldExhdExuZyhsYXRMbmcpIHsKCSAgICAgICAgICAgIHRoaXMubGF0TG5nID0gbGF0TG5nOwoJICAgICAgICB9CgoJICAgICAgICB0b0ZlYXR1cmVBcnJheSgpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLmxhdExuZykgewoJICAgICAgICAgICAgICAgIHJldHVybiBbewoJICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLmdldENvbXBvc2l0ZUlkKCksCgkgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHRoaXMuZ2V0UHJvcHMoKSwKCSAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnk6IHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogc3RyVG9GbG9hdChbdGhpcy5sYXRMbmcubG9uLCB0aGlzLmxhdExuZy5sYXRdKQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfV07CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmV0dXJuIFtdOwoJICAgICAgICB9CgoJICAgICAgICBnZXRMYXRMbmcoKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sYXRMbmc7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGNsYXNzIFdheSBleHRlbmRzIE9zbU9iamVjdCB7CgkgICAgICAgIGNvbnN0cnVjdG9yKGlkLCByZWZFbGVtcykgewoJICAgICAgICAgICAgc3VwZXIoJ3dheScsIGlkLCByZWZFbGVtcyk7CgkgICAgICAgICAgICB0aGlzLmxhdExuZ0FycmF5ID0gW107CgkgICAgICAgICAgICB0aGlzLmlzUG9seWdvbiA9IGZhbHNlOwoJICAgICAgICB9CgoJICAgICAgICBhZGRMYXRMbmcobGF0TG5nKSB7CgkgICAgICAgICAgICB0aGlzLmxhdExuZ0FycmF5LnB1c2gobGF0TG5nKTsKCSAgICAgICAgfQoKCSAgICAgICAgc2V0TGF0TG5nQXJyYXkobGF0TG5nQXJyYXkpIHsKCSAgICAgICAgICAgIHRoaXMubGF0TG5nQXJyYXkgPSBsYXRMbmdBcnJheTsKCSAgICAgICAgfQoKCSAgICAgICAgYWRkTm9kZVJlZihyZWYpIHsKCSAgICAgICAgICAgIGxldCBiaW5kZXIgPSBuZXcgTGF0ZUJpbmRlcih0aGlzLmxhdExuZ0FycmF5LCBmdW5jdGlvbiAoaWQpIHsKCSAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IHRoaXMucmVmRWxlbXMuZ2V0KGBub2RlLyR7aWR9YCk7CgkgICAgICAgICAgICAgICAgaWYgKG5vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgbm9kZS5yZWZDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRMYXRMbmcoKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9LCB0aGlzLCBbcmVmXSk7CgoJICAgICAgICAgICAgdGhpcy5sYXRMbmdBcnJheS5wdXNoKGJpbmRlcik7CgkgICAgICAgICAgICB0aGlzLnJlZkVsZW1zLmFkZEJpbmRlcihiaW5kZXIpOwoJICAgICAgICB9CgoJICAgICAgICBhbmFseXplR2VvbWV0cnlUeXBlKGssIHYpIHsKCSAgICAgICAgICAgIGxldCBvID0gcG9seWdvblRhZ3Nba107CgkgICAgICAgICAgICBpZiAobykgewoJICAgICAgICAgICAgICAgIHRoaXMuaXNQb2x5Z29uID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICBpZiAoby53aGl0ZWxpc3QpIHsKCSAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1BvbHlnb24gPSBvLndoaXRlbGlzdC5pbmRleE9mKHYpID49IDAgPyB0cnVlIDogZmFsc2U7CgkgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvLmJsYWNrbGlzdCkgewoJICAgICAgICAgICAgICAgICAgICB0aGlzLmlzUG9seWdvbiA9IG8uYmxhY2tsaXN0LmluZGV4T2YodikgPj0gMCA/IGZhbHNlIDogdHJ1ZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAgIGFkZFRhZ3ModGFncykgewoJICAgICAgICAgICAgc3VwZXIuYWRkVGFncyh0YWdzKTsKCSAgICAgICAgICAgIGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyh0YWdzKSkgewoJICAgICAgICAgICAgICAgIHRoaXMuYW5hbHl6ZUdlb21ldHJ5VHlwZShrLCB2KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgYWRkVGFnKGssIHYpIHsKCSAgICAgICAgICAgIHN1cGVyLmFkZFRhZyhrLCB2KTsKCSAgICAgICAgICAgIHRoaXMuYW5hbHl6ZUdlb21ldHJ5VHlwZShrLCB2KTsKCSAgICAgICAgfQoKCSAgICAgICAgdG9Db29yZHNBcnJheSgpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmxhdExuZ0FycmF5Lm1hcChsYXRMbmcgPT4gW2xhdExuZy5sb24sIGxhdExuZy5sYXRdKTsKCSAgICAgICAgfQoKCSAgICAgICAgdG9GZWF0dXJlQXJyYXkoKSB7CgkgICAgICAgICAgICBsZXQgY29vcmRzQXJyYXkgPSB0aGlzLnRvQ29vcmRzQXJyYXkoKTsKCSAgICAgICAgICAgIGlmIChjb29yZHNBcnJheS5sZW5ndGggPiAxKSB7CgkgICAgICAgICAgICAgICAgY29vcmRzQXJyYXkgPSBzdHJUb0Zsb2F0KGNvb3Jkc0FycmF5KTsKCSAgICAgICAgICAgICAgICBsZXQgZmVhdHVyZSA9IHsKCSAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLAoJICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5nZXRDb21wb3NpdGVJZCgpLAoJICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB0aGlzLmdldFByb3BzKCksCgkgICAgICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTGluZVN0cmluZycsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogY29vcmRzQXJyYXkKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH07CgoJICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUG9seWdvbiAmJiBpc1JpbmcoY29vcmRzQXJyYXkpKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyaW5nRGlyZWN0aW9uKGNvb3Jkc0FycmF5KSAhPT0gJ2NvdW50ZXJjbG9ja3dpc2UnKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZHNBcnJheS5yZXZlcnNlKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIGZlYXR1cmUuZ2VvbWV0cnkgPSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnUG9seWdvbicsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogW2Nvb3Jkc0FycmF5XQoJICAgICAgICAgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtmZWF0dXJlXTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIHJldHVybiBbZmVhdHVyZV07CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmV0dXJuIFtdOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBjbGFzcyBSZWxhdGlvbiBleHRlbmRzIE9zbU9iamVjdCB7CgkgICAgICAgIGNvbnN0cnVjdG9yKGlkLCByZWZFbGVtcykgewoJICAgICAgICAgICAgc3VwZXIoJ3JlbGF0aW9uJywgaWQsIHJlZkVsZW1zKTsKCSAgICAgICAgICAgIHRoaXMucmVsYXRpb25zID0gW107CgkgICAgICAgICAgICB0aGlzLm5vZGVzID0gW107CgkgICAgICAgICAgICB0aGlzLmJvdW5kcyA9IG51bGw7CgkgICAgICAgIH0KCgkgICAgICAgIHNldEJvdW5kcyhib3VuZHMpIHsKCSAgICAgICAgICAgIHRoaXMuYm91bmRzID0gYm91bmRzOwoJICAgICAgICB9CgoJICAgICAgICBhZGRNZW1iZXIobWVtYmVyKSB7CgkgICAgICAgICAgICBzd2l0Y2ggKG1lbWJlci50eXBlKSB7CgkgICAgICAgICAgICAgICAgLy8gc3VwZXIgcmVsYXRpb24sIG5lZWQgdG8gZG8gY29tYmluYXRpb24KCSAgICAgICAgICAgICAgICBjYXNlICdyZWxhdGlvbic6CgkgICAgICAgICAgICAgICAgICAgIGxldCBiaW5kZXIgPSBuZXcgTGF0ZUJpbmRlcih0aGlzLnJlbGF0aW9ucywgZnVuY3Rpb24gKGlkKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVsYXRpb24gPSB0aGlzLnJlZkVsZW1zLmdldChgcmVsYXRpb24vJHtpZH1gKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxhdGlvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uLnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbGF0aW9uOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLCBbbWVtYmVyLnJlZl0pOwoJICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbGF0aW9ucy5wdXNoKGJpbmRlcik7CgkgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRWxlbXMuYWRkQmluZGVyKGJpbmRlcik7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKCSAgICAgICAgICAgICAgICBjYXNlICd3YXknOgoJICAgICAgICAgICAgICAgICAgICBpZiAoIW1lbWJlci5yb2xlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIucm9sZSA9ICcnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGxldCB3YXlzID0gdGhpc1ttZW1iZXIucm9sZV07CgkgICAgICAgICAgICAgICAgICAgIGlmICghd2F5cykgewoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5cyA9IHRoaXNbbWVtYmVyLnJvbGVdID0gW107CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgaWYgKG1lbWJlci5nZW9tZXRyeSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdheSA9IG5ldyBXYXkobWVtYmVyLnJlZiwgdGhpcy5yZWZFbGVtcyk7CgkgICAgICAgICAgICAgICAgICAgICAgICB3YXkuc2V0TGF0TG5nQXJyYXkobWVtYmVyLmdlb21ldHJ5KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdheS5yZWZDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5cy5wdXNoKHdheSk7CgkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVtYmVyLm5vZGVzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBsZXQgd2F5ID0gbmV3IFdheShtZW1iZXIucmVmLCB0aGlzLnJlZkVsZW1zKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG5pZCBvZiBtZW1iZXIubm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXkuYWRkTm9kZVJlZihuaWQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5LnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICB3YXlzLnB1c2god2F5KTsKCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGxldCBiaW5kZXIgPSBuZXcgTGF0ZUJpbmRlcih3YXlzLCBmdW5jdGlvbiAoaWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgd2F5ID0gdGhpcy5yZWZFbGVtcy5nZXQoYHdheS8ke2lkfWApOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3YXkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F5LnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3YXk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcywgW21lbWJlci5yZWZdKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdheXMucHVzaChiaW5kZXIpOwoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZFbGVtcy5hZGRCaW5kZXIoYmluZGVyKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCgkgICAgICAgICAgICAgICAgY2FzZSAnbm9kZSc6CgkgICAgICAgICAgICAgICAgICAgIGxldCBub2RlID0gbnVsbDsKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1lbWJlci5sYXQgJiYgbWVtYmVyLmxvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5ldyBOb2RlKG1lbWJlci5yZWYsIHRoaXMucmVmRWxlbXMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRMYXRMbmcoeyBsb246IG1lbWJlci5sb24sIGxhdDogbWVtYmVyLmxhdCB9KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZW1iZXIudGFncykgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYWRkVGFncyhtZW1iZXIudGFncyk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMobWVtYmVyKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChbJ2lkJywgJ3R5cGUnLCAnbGF0JywgJ2xvbiddLmluZGV4T2YoaykgPCAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYWRkUHJvcChrLCB2KTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5yZWZDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2Rlcy5wdXNoKG5vZGUpOwoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJpbmRlciA9IG5ldyBMYXRlQmluZGVyKHRoaXMubm9kZXMsIGZ1bmN0aW9uIChpZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBub2RlID0gdGhpcy5yZWZFbGVtcy5nZXQoYG5vZGUvJHtpZH1gKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMsIFttZW1iZXIucmVmXSk7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGVzLnB1c2goYmluZGVyKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRWxlbXMuYWRkQmluZGVyKGJpbmRlcik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAgIHRvRmVhdHVyZUFycmF5KCkgewoJICAgICAgICAgICAgY29uc3QgY29uc3RydWN0U3RyaW5nR2VvbWV0cnkgPSAod3MpID0+IHsKCSAgICAgICAgICAgICAgICBsZXQgc3RyaW5ncyA9IHdzID8gd3MudG9TdHJpbmdzKCkgOiBbXTsKCSAgICAgICAgICAgICAgICBpZiAoc3RyaW5ncy5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChzdHJpbmdzLmxlbmd0aCA9PT0gMSkgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJywKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBzdHJpbmdzWzBdCgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTXVsdGlMaW5lU3RyaW5nJywKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBzdHJpbmdzCgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgIGNvbnN0IGNvbnN0cnVjdFBvbHlnb25HZW9tZXRyeSA9IChvd3MsIGl3cykgPT4gewoJICAgICAgICAgICAgICAgIGxldCBvdXRlclJpbmdzID0gb3dzID8gb3dzLnRvUmluZ3MoJ2NvdW50ZXJjbG9ja3dpc2UnKSA6IFtdLAoJICAgICAgICAgICAgICAgICAgICBpbm5lclJpbmdzID0gaXdzID8gaXdzLnRvUmluZ3MoJ2Nsb2Nrd2lzZScpIDogW107CgoJICAgICAgICAgICAgICAgIGlmIChvdXRlclJpbmdzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICAgICAgbGV0IGNvbXBvc2l0UG9seW9ucyA9IFtdOwoKCSAgICAgICAgICAgICAgICAgICAgbGV0IHJpbmcgPSBudWxsOwoJICAgICAgICAgICAgICAgICAgICBmb3IgKHJpbmcgb2Ygb3V0ZXJSaW5ncykKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0UG9seW9ucy5wdXNoKFtyaW5nXSk7CgoJICAgICAgICAgICAgICAgICAgICAvLyBsaW5rIGlubmVyIHBvbHlnb25zIHRvIG91dGVyIGNvbnRhaW5lcnMKCSAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHJpbmcgPSBpbm5lclJpbmdzLnNoaWZ0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGlkeCBpbiBvdXRlclJpbmdzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHB0SW5zaWRlUG9seWdvbihmaXJzdChyaW5nKSwgb3V0ZXJSaW5nc1tpZHhdKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb3NpdFBvbHlvbnNbaWR4XS5wdXNoKHJpbmcpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIC8vIGNvbnN0cnVjdCB0aGUgUG9seWdvbi9NdWx0aVBvbHlnb24gZ2VvbWV0cnkKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvc2l0UG9seW9ucy5sZW5ndGggPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BvbHlnb24nLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBjb21wb3NpdFBvbHlvbnNbMF0KCSAgICAgICAgICAgICAgICAgICAgICAgIH07CgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTXVsdGlQb2x5Z29uJywKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBjb21wb3NpdFBvbHlvbnMKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgIGxldCBwb2x5Z29uRmVhdHVyZXMgPSBbXSwgc3RyaW5nRmVhdHVyZXMgPSBbXSwgcG9pbnRGZWF0dXJlcyA9IFtdOwoJICAgICAgICAgICAgY29uc3Qgd2F5c0ZpZWxkTmFtZXMgPSBbJ291dGVyJywgJ2lubmVyJywgJyddOwoJICAgICAgICAgICAgLy8gbmVlZCB0byBkbyBjb21iaW5hdGlvbiB3aGVuIHRoZXJlJ3JlIG5lc3RlZCByZWxhdGlvbnMKCSAgICAgICAgICAgIGZvciAobGV0IHJlbGF0aW9uIG9mIHRoaXMucmVsYXRpb25zKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlbGF0aW9uKSB7CgkgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGZpZWxkTmFtZSBvZiB3YXlzRmllbGROYW1lcykgewoJICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdheXMgPSByZWxhdGlvbltmaWVsZE5hbWVdOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdheXMpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGhpc1dheXMgPSB0aGlzW2ZpZWxkTmFtZV07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNXYXlzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtdLnNwbGljZS5hcHBseSh0aGlzV2F5cywgW3RoaXNXYXlzLmxlbmd0aCwgMF0uY29uY2F0KHdheXMpKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2ZpZWxkTmFtZV0gPSB3YXlzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICBmb3IgKGxldCBmaWVsZE5hbWUgb2Ygd2F5c0ZpZWxkTmFtZXMpIHsKCSAgICAgICAgICAgICAgICBsZXQgd2F5cyA9IHRoaXNbZmllbGROYW1lXTsKCSAgICAgICAgICAgICAgICBpZiAod2F5cykgewoJICAgICAgICAgICAgICAgICAgICB0aGlzW2ZpZWxkTmFtZV0gPSBuZXcgV2F5Q29sbGVjdGlvbigpOwoJICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB3YXkgb2Ygd2F5cykgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tmaWVsZE5hbWVdLmFkZFdheSh3YXkpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIGxldCBnZW9tZXRyeSA9IG51bGw7CgoJICAgICAgICAgICAgbGV0IGZlYXR1cmUgPSB7CgkgICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLAoJICAgICAgICAgICAgICAgIGlkOiB0aGlzLmdldENvbXBvc2l0ZUlkKCksCgkgICAgICAgICAgICAgICAgYmJveDogdGhpcy5ib3VuZHMsCgkgICAgICAgICAgICAgICAgcHJvcGVydGllczogdGhpcy5nZXRQcm9wcygpCgkgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgIGlmICghdGhpcy5ib3VuZHMpIHsKCSAgICAgICAgICAgICAgICBkZWxldGUgZmVhdHVyZS5iYm94OwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIGlmICh0aGlzLm91dGVyKSB7CgkgICAgICAgICAgICAgICAgZ2VvbWV0cnkgPSBjb25zdHJ1Y3RQb2x5Z29uR2VvbWV0cnkodGhpcy5vdXRlciwgdGhpcy5pbm5lcik7CgkgICAgICAgICAgICAgICAgaWYgKGdlb21ldHJ5KSB7CgkgICAgICAgICAgICAgICAgICAgIGZlYXR1cmUuZ2VvbWV0cnkgPSBnZW9tZXRyeTsKCSAgICAgICAgICAgICAgICAgICAgcG9seWdvbkZlYXR1cmVzLnB1c2goZmVhdHVyZSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAodGhpc1snJ10pIHsKCSAgICAgICAgICAgICAgICBnZW9tZXRyeSA9IGNvbnN0cnVjdFN0cmluZ0dlb21ldHJ5KHRoaXNbJyddKTsKCSAgICAgICAgICAgICAgICBpZiAoZ2VvbWV0cnkpIHsKCSAgICAgICAgICAgICAgICAgICAgZmVhdHVyZS5nZW9tZXRyeSA9IGdlb21ldHJ5OwoJICAgICAgICAgICAgICAgICAgICBzdHJpbmdGZWF0dXJlcy5wdXNoKGZlYXR1cmUpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICBmb3IgKGxldCBub2RlIG9mIHRoaXMubm9kZXMpIHsKCSAgICAgICAgICAgICAgICBwb2ludEZlYXR1cmVzID0gcG9pbnRGZWF0dXJlcy5jb25jYXQobm9kZS50b0ZlYXR1cmVBcnJheSgpKTsKCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICByZXR1cm4gcG9seWdvbkZlYXR1cmVzLmNvbmNhdChzdHJpbmdGZWF0dXJlcykuY29uY2F0KHBvaW50RmVhdHVyZXMpOwoJICAgICAgICB9CgkgICAgfQoKCSAgICByZXR1cm4geyBOb2RlLCBXYXksIFJlbGF0aW9uIH07Cgl9KSgpOwoKCXZhciB4bWxwYXJzZXIgPSAoKCkgPT4gewoKCSAgICBmdW5jdGlvbiBjb25kaXRpb25lZChldnQpIHsKCSAgICAgICAgcmV0dXJuIGV2dC5tYXRjaCgvXiguKz8pXFsoLis/KVxdPiQvZykgIT0gbnVsbDsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIHBhcnNlRXZlbnQoZXZ0KSB7CgkgICAgICAgIGxldCBtYXRjaCA9IC9eKC4rPylcWyguKz8pXF0+JC9nLmV4ZWMoZXZ0KTsKCSAgICAgICAgaWYgKG1hdGNoKSB7CgkgICAgICAgICAgICByZXR1cm4geyBldnQ6IG1hdGNoWzFdICsgJz4nLCBleHA6IG1hdGNoWzJdIH07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHsgZXZ0OiBldnQgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGdlbkNvbmRpdGlvbkZ1bmMoY29uZCkgewoJICAgICAgICBsZXQgYm9keSA9ICdyZXR1cm4gJyArIGNvbmQucmVwbGFjZSgvKFwkLis/KSg/PVs9IS5dKS9nLCAnbm9kZS4kJicpICsgJzsnOwoJICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCdub2RlJywgYm9keSk7CgkgICAgfQoKCSAgICByZXR1cm4gY2xhc3MgewoJICAgICAgICBjb25zdHJ1Y3RvcihvcHRzKSB7CgkgICAgICAgICAgICBpZiAob3B0cykgewoJICAgICAgICAgICAgICAgIHRoaXMucXVlcnlQYXJlbnQgPSBvcHRzLnF1ZXJ5UGFyZW50ID8gdHJ1ZSA6IGZhbHNlOwoJICAgICAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NpdmUgPSBvcHRzLnByb2dyZXNzaXZlOwoJICAgICAgICAgICAgICAgIGlmICh0aGlzLnF1ZXJ5UGFyZW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50TWFwID0gbmV3IFdlYWtNYXAoKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aGlzLmV2dExpc3RlbmVycyA9IHt9OwoJICAgICAgICB9CgoJICAgICAgICBwYXJzZSh4bWwsIHBhcmVudCwgZGlyKSB7CgkgICAgICAgICAgICBkaXIgPSBkaXIgPyBkaXIgKyAnLicgOiAnJzsKCSAgICAgICAgICAgIGxldCBub2RlUmVnRXggPSAvPChbXiA+XC9dKykoLio/KT4vbWcsIG5vZGVNYXRjaCA9IG51bGwsIG5vZGVzID0gW107CgkgICAgICAgICAgICB3aGlsZSAobm9kZU1hdGNoID0gbm9kZVJlZ0V4LmV4ZWMoeG1sKSkgewoJICAgICAgICAgICAgICAgIGxldCB0YWcgPSBub2RlTWF0Y2hbMV0sIG5vZGUgPSB7ICR0YWc6IHRhZyB9LCBmdWxsVGFnID0gZGlyICsgdGFnOwoKCSAgICAgICAgICAgICAgICBsZXQgYXR0clRleHQgPSBub2RlTWF0Y2hbMl0udHJpbSgpLCBjbG9zZWQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICBpZiAoYXR0clRleHQuZW5kc1dpdGgoJy8nKSB8fCB0YWcuc3RhcnRzV2l0aCgnPycpIHx8IHRhZy5zdGFydHNXaXRoKCchJykpIHsKCSAgICAgICAgICAgICAgICAgICAgY2xvc2VkID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIGxldCBhdHRSZWdFeDEgPSAvKFteIF0rPyk9IiguKz8pIi9nLCBhdHRSZWdFeDIgPSAvKFteIF0rPyk9JyguKz8pJy9nOwoJICAgICAgICAgICAgICAgIGxldCBhdHRNYXRjaCA9IG51bGwsIGhhc0F0dHJzID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgd2hpbGUgKGF0dE1hdGNoID0gYXR0UmVnRXgxLmV4ZWMoYXR0clRleHQpKSB7CgkgICAgICAgICAgICAgICAgICAgIGhhc0F0dHJzID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgbm9kZVthdHRNYXRjaFsxXV0gPSBhdHRNYXRjaFsyXTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFoYXNBdHRycykKCSAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGF0dE1hdGNoID0gYXR0UmVnRXgyLmV4ZWMoYXR0clRleHQpKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBoYXNBdHRycyA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICBub2RlW2F0dE1hdGNoWzFdXSA9IGF0dE1hdGNoWzJdOwoJICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIGlmICghaGFzQXR0cnMgJiYgYXR0clRleHQgIT09ICcnKSB7CgkgICAgICAgICAgICAgICAgICAgIG5vZGUudGV4dCA9IGF0dHJUZXh0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9ncmVzc2l2ZSkgewoJICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoYDwke2Z1bGxUYWd9PmAsIG5vZGUsIHBhcmVudCk7CgkgICAgICAgICAgICAgICAgfQoKCSAgICAgICAgICAgICAgICBpZiAoIWNsb3NlZCkgewoJICAgICAgICAgICAgICAgICAgICBsZXQgaW5uZXJSZWdFeCA9IG5ldyBSZWdFeHAoYChbXl0rPyk8XC8ke3RhZ30+YCwgJ2cnKTsKCSAgICAgICAgICAgICAgICAgICAgaW5uZXJSZWdFeC5sYXN0SW5kZXggPSBub2RlUmVnRXgubGFzdEluZGV4OwoJICAgICAgICAgICAgICAgICAgICBsZXQgaW5uZXJNYXRjaCA9IGlubmVyUmVnRXguZXhlYyh4bWwpOwoJICAgICAgICAgICAgICAgICAgICBpZiAoaW5uZXJNYXRjaCAmJiBpbm5lck1hdGNoWzFdKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBub2RlUmVnRXgubGFzdEluZGV4ID0gaW5uZXJSZWdFeC5sYXN0SW5kZXg7CgkgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5uZXJOb2RlcyA9IHRoaXMucGFyc2UoaW5uZXJNYXRjaFsxXSwgbm9kZSwgZnVsbFRhZyk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5uZXJOb2Rlcy5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS4kaW5uZXJOb2RlcyA9IGlubmVyTm9kZXM7CgkgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuJGlubmVyVGV4dCA9IGlubmVyTWF0Y2hbMV07CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlcnlQYXJlbnQgJiYgcGFyZW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50TWFwLnNldChub2RlLCBwYXJlbnQpOwoJICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NpdmUpIHsKCSAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KGA8LyR7ZnVsbFRhZ30+YCwgbm9kZSwgcGFyZW50KTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobm9kZSk7CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmV0dXJuIG5vZGVzOwoJICAgICAgICB9CgoJICAgICAgICBnZXRQYXJlbnQobm9kZSkgewoJICAgICAgICAgICAgaWYgKHRoaXMucXVlcnlQYXJlbnQpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnRNYXAuZ2V0KG5vZGUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCgkgICAgICAgICNhZGRMaXN0ZW5lcihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIGxldCBmdW5jcyA9IHRoaXMuZXZ0TGlzdGVuZXJzW2V2dF07CgkgICAgICAgICAgICBpZiAoZnVuY3MpIHsKCSAgICAgICAgICAgICAgICBmdW5jcy5wdXNoKGZ1bmMpOwoJICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmV2dExpc3RlbmVyc1tldnRdID0gW2Z1bmNdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICAvLyBzdXBwb3J0IGphdmFzY3JpcHQgY29uZGl0aW9uIGZvciB0aGUgbGFzdCB0YWcKCSAgICAgICAgYWRkTGlzdGVuZXIoZXZ0LCBmdW5jKSB7CgkgICAgICAgICAgICBpZiAoY29uZGl0aW9uZWQoZXZ0KSkgewoJICAgICAgICAgICAgICAgIC8vIGZ1bmMucHJvdG90eXBlID0gZXZ0OwoJICAgICAgICAgICAgICAgIGV2dCA9IHBhcnNlRXZlbnQoZXZ0KTsKCSAgICAgICAgICAgICAgICBmdW5jLmNvbmRpdGlvbiA9IGdlbkNvbmRpdGlvbkZ1bmMoZXZ0LmV4cCk7CgkgICAgICAgICAgICAgICAgZXZ0ID0gZXZ0LmV2dDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHRoaXMuI2FkZExpc3RlbmVyKGV2dCwgZnVuYyk7CgkgICAgICAgIH0KCgkgICAgICAgICNyZW1vdmVMaXN0ZW5lcihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIGxldCBmdW5jcyA9IHRoaXMuZXZ0TGlzdGVuZXJzW2V2dF07CgkgICAgICAgICAgICBsZXQgaWR4ID0gbnVsbDsKCSAgICAgICAgICAgIGlmIChmdW5jcyAmJiAoaWR4ID0gZnVuY3MuaW5kZXhPZihmdW5jKSkgPj0gMCkgewoJICAgICAgICAgICAgICAgIGZ1bmNzLnNwbGljZShpZHgsIDEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICByZW1vdmVMaXN0ZW5lcihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIGlmIChjb25kaXRpb25lZChldnQpKSB7CgkgICAgICAgICAgICAgICAgZXZ0ID0gcGFyc2VFdmVudChldnQpOwoJICAgICAgICAgICAgICAgIGV2dCA9IGV2dC5ldnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aGlzLiNyZW1vdmVMaXN0ZW5lcihldnQsIGZ1bmMpOwoJICAgICAgICB9CgoJICAgICAgICBlbWl0KGV2dCwgLi4uYXJncykgewoJICAgICAgICAgICAgbGV0IGZ1bmNzID0gdGhpcy5ldnRMaXN0ZW5lcnNbZXZ0XTsKCSAgICAgICAgICAgIGlmIChmdW5jcykgewoJICAgICAgICAgICAgICAgIGZvciAobGV0IGZ1bmMgb2YgZnVuY3MpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bmMuY29uZGl0aW9uKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuYy5jb25kaXRpb24uYXBwbHkobnVsbCwgYXJncykgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jLmFwcGx5KG51bGwsIGFyZ3MpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseShudWxsLCBhcmdzKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgb24oZXZ0LCBmdW5jKSB7CgkgICAgICAgICAgICB0aGlzLmFkZExpc3RlbmVyKGV2dCwgZnVuYyk7CgkgICAgICAgIH0KCgkgICAgICAgIG9mZihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoZXZ0LCBmdW5jKTsKCSAgICAgICAgfQoJICAgIH07Cgl9KSgpOwoKCWNvbnN0IHsgTm9kZSwgV2F5LCBSZWxhdGlvbiB9ID0gb3Ntb2JqcywKCSAgICB7IHB1cmdlUHJvcHMsIFJlZkVsZW1lbnRzIH0gPSB1dGlscywKCSAgICBYbWxQYXJzZXIgPSB4bWxwYXJzZXI7CgoJdmFyIGxpYiA9IChvc20sIG9wdHMpID0+IHsKCSAgICBsZXQgY29tcGxldGVGZWF0dXJlID0gZmFsc2UsIHJlbmRlclRhZ2dlZCA9IGZhbHNlLCBleGNsdWRlV2F5ID0gdHJ1ZTsKCgkgICAgY29uc3QgcGFyc2VPcHRzID0gb3B0cyA9PiB7CgkgICAgICAgIGlmIChvcHRzKSB7CgkgICAgICAgICAgICBjb21wbGV0ZUZlYXR1cmUgPSBvcHRzLmNvbXBsZXRlRmVhdHVyZSB8fCBvcHRzLmFsbEZlYXR1cmVzID8gdHJ1ZSA6IGZhbHNlOwoJICAgICAgICAgICAgcmVuZGVyVGFnZ2VkID0gb3B0cy5yZW5kZXJUYWdnZWQgPyB0cnVlIDogZmFsc2U7CgkgICAgICAgICAgICBsZXQgd2F5T3B0ID0gb3B0cy5zdXBwcmVzc1dheSB8fCBvcHRzLmV4Y2x1ZGVXYXk7CgkgICAgICAgICAgICBpZiAod2F5T3B0ICE9PSB1bmRlZmluZWQgJiYgIXdheU9wdCkgewoJICAgICAgICAgICAgICAgIGV4Y2x1ZGVXYXkgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgoJICAgIHBhcnNlT3B0cyhvcHRzKTsKCgkgICAgY29uc3QgZGV0ZWN0Rm9ybWF0ID0gb3NtID0+IHsKCSAgICAgICAgaWYgKG9zbS5lbGVtZW50cykgewoJICAgICAgICAgICAgcmV0dXJuICdqc29uJzsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3NtLmluZGV4T2YoJzxvc20nKSA+PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gJ3htbCc7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG9zbS50cmltKCkuc3RhcnRzV2l0aCgneycpKSB7CgkgICAgICAgICAgICByZXR1cm4gJ2pzb24tcmF3JzsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gJ2ludmFsaWQnOwoJICAgIH07CgoJICAgIGxldCBmb3JtYXQgPSBkZXRlY3RGb3JtYXQob3NtKTsKCgkgICAgbGV0IHJlZkVsZW1lbnRzID0gbmV3IFJlZkVsZW1lbnRzKCksIGZlYXR1cmVBcnJheSA9IFtdOwoKCSAgICBjb25zdCBhbmFseXplRmVhdHVyZXNGcm9tSnNvbiA9IG9zbSA9PiB7CgkgICAgICAgIGZvciAobGV0IGVsZW0gb2Ygb3NtLmVsZW1lbnRzKSB7CgkgICAgICAgICAgICBzd2l0Y2ggKGVsZW0udHlwZSkgewoJICAgICAgICAgICAgICAgIGNhc2UgJ25vZGUnOgoJICAgICAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IG5ldyBOb2RlKGVsZW0uaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0udGFncykgewoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5hZGRUYWdzKGVsZW0udGFncyk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgbm9kZS5hZGRQcm9wcyhwdXJnZVByb3BzKGVsZW0sIFsnaWQnLCAndHlwZScsICd0YWdzJywgJ2xhdCcsICdsb24nXSkpOwoJICAgICAgICAgICAgICAgICAgICBub2RlLnNldExhdExuZyhlbGVtKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgoJICAgICAgICAgICAgICAgIGNhc2UgJ3dheSc6CgkgICAgICAgICAgICAgICAgICAgIGxldCB3YXkgPSBuZXcgV2F5KGVsZW0uaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0udGFncykgewoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZFRhZ3MoZWxlbS50YWdzKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB3YXkuYWRkUHJvcHMocHVyZ2VQcm9wcyhlbGVtLCBbJ2lkJywgJ3R5cGUnLCAndGFncycsICdub2RlcycsICdnZW9tZXRyeSddKSk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLm5vZGVzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBuIG9mIGVsZW0ubm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXkuYWRkTm9kZVJlZihuKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtLmdlb21ldHJ5KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB3YXkuc2V0TGF0TG5nQXJyYXkoZWxlbS5nZW9tZXRyeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgoJICAgICAgICAgICAgICAgIGNhc2UgJ3JlbGF0aW9uJzoKCSAgICAgICAgICAgICAgICAgICAgbGV0IHJlbGF0aW9uID0gbmV3IFJlbGF0aW9uKGVsZW0uaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0uYm91bmRzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGlvbi5zZXRCb3VuZHMoW3BhcnNlRmxvYXQoZWxlbS5ib3VuZHMubWlubG9uKSwgcGFyc2VGbG9hdChlbGVtLmJvdW5kcy5taW5sYXQpLCBwYXJzZUZsb2F0KGVsZW0uYm91bmRzLm1heGxvbiksIHBhcnNlRmxvYXQoZWxlbS5ib3VuZHMubWF4bGF0KV0pOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLnRhZ3MpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uLmFkZFRhZ3MoZWxlbS50YWdzKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByZWxhdGlvbi5hZGRQcm9wcyhwdXJnZVByb3BzKGVsZW0sIFsnaWQnLCAndHlwZScsICd0YWdzJywgJ2JvdW5kcycsICdtZW1iZXJzJ10pKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0ubWVtYmVycykgewoJICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgbWVtYmVyIG9mIGVsZW0ubWVtYmVycykgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uLmFkZE1lbWJlcihtZW1iZXIpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCgkgICAgY29uc3QgYW5hbHl6ZUZlYXR1cmVzRnJvbVhtbCA9IG9zbSA9PiB7CgkgICAgICAgIGNvbnN0IHhtbFBhcnNlciA9IG5ldyBYbWxQYXJzZXIoeyBwcm9ncmVzc2l2ZTogdHJ1ZSB9KTsKCgkgICAgICAgIHhtbFBhcnNlci5vbignPC9vc20ubm9kZT4nLCBub2RlID0+IHsKCSAgICAgICAgICAgIGxldCBuZCA9IG5ldyBOb2RlKG5vZGUuaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgIGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhub2RlKSkKCSAgICAgICAgICAgICAgICBpZiAoIWsuc3RhcnRzV2l0aCgnJCcpICYmIFsnaWQnLCAnbG9uJywgJ2xhdCddLmluZGV4T2YoaykgPCAwKSB7CgkgICAgICAgICAgICAgICAgICAgIG5kLmFkZFByb3Aoaywgdik7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmQuc2V0TGF0TG5nKG5vZGUpOwoJICAgICAgICAgICAgaWYgKG5vZGUuJGlubmVyTm9kZXMpIHsKCSAgICAgICAgICAgICAgICBmb3IgKGxldCBpbmQgb2Ygbm9kZS4kaW5uZXJOb2RlcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW5kLiR0YWcgPT09ICd0YWcnKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBuZC5hZGRUYWcoaW5kLmssIGluZC52KTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfSk7CgoJICAgICAgICB4bWxQYXJzZXIub24oJzwvb3NtLndheT4nLCBub2RlID0+IHsKCSAgICAgICAgICAgIGxldCB3YXkgPSBuZXcgV2F5KG5vZGUuaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgIGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhub2RlKSkgewoJICAgICAgICAgICAgICAgIGlmICghay5zdGFydHNXaXRoKCckJykgJiYgWydpZCddLmluZGV4T2YoaykgPCAwKSB7CgkgICAgICAgICAgICAgICAgICAgIHdheS5hZGRQcm9wKGssIHYpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChub2RlLiRpbm5lck5vZGVzKSB7CgkgICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kIG9mIG5vZGUuJGlubmVyTm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGluZC4kdGFnID09PSAnbmQnKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kLmxvbiAmJiBpbmQubGF0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZExhdExuZyhpbmQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmQucmVmKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZE5vZGVSZWYoaW5kLnJlZik7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kLiR0YWcgPT09ICd0YWcnKQoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZFRhZyhpbmQuaywgaW5kLnYpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfSk7CgoJICAgICAgICB4bWxQYXJzZXIub24oJzxvc20ucmVsYXRpb24+Jywgbm9kZSA9PiB7CgkgICAgICAgICAgICBuZXcgUmVsYXRpb24obm9kZS5pZCwgcmVmRWxlbWVudHMpOwoJICAgICAgICB9KTsKCgkgICAgICAgIHhtbFBhcnNlci5vbignPC9vc20ucmVsYXRpb24ubWVtYmVyPicsIChub2RlLCBwYXJlbnQpID0+IHsKCSAgICAgICAgICAgIGxldCByZWxhdGlvbiA9IHJlZkVsZW1lbnRzLmdldChgcmVsYXRpb24vJHtwYXJlbnQuaWR9YCk7CgkgICAgICAgICAgICBsZXQgbWVtYmVyID0gewoJICAgICAgICAgICAgICAgIHR5cGU6IG5vZGUudHlwZSwKCSAgICAgICAgICAgICAgICByb2xlOiBub2RlLnJvbGUgPyBub2RlLnJvbGUgOiAnJywKCSAgICAgICAgICAgICAgICByZWY6IG5vZGUucmVmCgkgICAgICAgICAgICB9OwoJICAgICAgICAgICAgaWYgKG5vZGUubGF0ICYmIG5vZGUubG9uKSB7CgkgICAgICAgICAgICAgICAgbWVtYmVyLmxhdCA9IG5vZGUubGF0LCBtZW1iZXIubG9uID0gbm9kZS5sb24sIG1lbWJlci50YWdzID0ge307CgkgICAgICAgICAgICAgICAgZm9yIChsZXQgW2ssIHZdIG9mIE9iamVjdC5lbnRyaWVzKG5vZGUpKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICghay5zdGFydHNXaXRoKCckJykgJiYgWyd0eXBlJywgJ2xhdCcsICdsb24nXS5pbmRleE9mKGspIDwgMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyW2tdID0gdjsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChub2RlLiRpbm5lck5vZGVzKSB7CgkgICAgICAgICAgICAgICAgbGV0IGdlb21ldHJ5ID0gW107CgkgICAgICAgICAgICAgICAgbGV0IG5vZGVzID0gW107CgkgICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kIG9mIG5vZGUuJGlubmVyTm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGluZC5sYXQgJiYgaW5kLmxvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnkucHVzaChpbmQpOwoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChpbmQucmVmKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpZiAoZ2VvbWV0cnkubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICBtZW1iZXIuZ2VvbWV0cnkgPSBnZW9tZXRyeTsKCSAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGVzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICAgICAgbWVtYmVyLm5vZGVzID0gbm9kZXM7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVsYXRpb24uYWRkTWVtYmVyKG1lbWJlcik7CgkgICAgICAgIH0pOwoKCSAgICAgICAgeG1sUGFyc2VyLm9uKCc8L29zbS5yZWxhdGlvbi5ib3VuZHM+JywgKG5vZGUsIHBhcmVudCkgPT4gewoJICAgICAgICAgICAgcmVmRWxlbWVudHMuZ2V0KGByZWxhdGlvbi8ke3BhcmVudC5pZH1gKS5zZXRCb3VuZHMoW3BhcnNlRmxvYXQobm9kZS5taW5sb24pLCBwYXJzZUZsb2F0KG5vZGUubWlubGF0KSwgcGFyc2VGbG9hdChub2RlLm1heGxvbiksIHBhcnNlRmxvYXQobm9kZS5tYXhsYXQpXSk7CgkgICAgICAgIH0pOwoKCSAgICAgICAgeG1sUGFyc2VyLm9uKCc8L29zbS5yZWxhdGlvbi50YWc+JywgKG5vZGUsIHBhcmVudCkgPT4gewoJICAgICAgICAgICAgcmVmRWxlbWVudHMuZ2V0KGByZWxhdGlvbi8ke3BhcmVudC5pZH1gKS5hZGRUYWcobm9kZS5rLCBub2RlLnYpOwoJICAgICAgICB9KTsKCgkgICAgICAgIHhtbFBhcnNlci5wYXJzZShvc20pOwoJICAgIH07CgoJICAgIGlmIChmb3JtYXQgPT09ICdqc29uLXJhdycpIHsKCSAgICAgICAgb3NtID0gSlNPTi5wYXJzZShvc20pOwoJICAgICAgICBpZiAob3NtLmVsZW1lbnRzKSB7CgkgICAgICAgICAgICBmb3JtYXQgPSAnanNvbic7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBmb3JtYXQgPSAnaW52YWxpZCc7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykgewoJICAgICAgICBhbmFseXplRmVhdHVyZXNGcm9tSnNvbihvc20pOwoJICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAneG1sJykgewoJICAgICAgICBhbmFseXplRmVhdHVyZXNGcm9tWG1sKG9zbSk7CgkgICAgfQoKCSAgICByZWZFbGVtZW50cy5iaW5kQWxsKCk7CgoJICAgIGZvciAobGV0IHYgb2YgcmVmRWxlbWVudHMudmFsdWVzKCkpIHsKCSAgICAgICAgaWYgKHYucmVmQ291bnQgPD0gMCB8fCAodi5oYXNUYWcgJiYgcmVuZGVyVGFnZ2VkICYmICEodiBpbnN0YW5jZW9mIFdheSAmJiBleGNsdWRlV2F5KSkpIHsKCSAgICAgICAgICAgIGxldCBmZWF0dXJlcyA9IHYudG9GZWF0dXJlQXJyYXkoKTsKCSAgICAgICAgICAgIC8vIHJldHVybiB0aGUgZmlyc3QgZ2VvbWV0cnkgb2YgdGhlIGZpcnN0IHJlbGF0aW9uIGVsZW1lbnQKCSAgICAgICAgICAgIGlmICh2IGluc3RhbmNlb2YgUmVsYXRpb24gJiYgIWNvbXBsZXRlRmVhdHVyZSAmJiBmZWF0dXJlcy5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZlYXR1cmVzWzBdLmdlb21ldHJ5OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmVhdHVyZUFycmF5ID0gZmVhdHVyZUFycmF5LmNvbmNhdChmZWF0dXJlcyk7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIHJldHVybiB7IHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsIGZlYXR1cmVzOiBmZWF0dXJlQXJyYXkgfTsKCX07CgoJdmFyIG9zbTJnZW9qc29uID0gLypAX19QVVJFX18qL2dldERlZmF1bHRFeHBvcnRGcm9tQ2pzKGxpYik7CgoJY2xhc3MgQ29udmVydGVyIHsKCSAgICBjb25zdHJ1Y3Rvcihmb3JtYXQsIGRhdGEsIG9wdGlvbnMgPSB7fSkgewoJICAgICAgICAvKioKCSAgICAgICAgICogQ3JlYXRlcyBhIGJsYW5rIEdlb0pTT04gZmVhdHVyZSBjb2xsZWN0aW9uLgoJICAgICAgICAgKiBAcmV0dXJucyBBIG5ldyBHZW9KU09OIGZlYXR1cmUgY29sbGVjdGlvbiB3aXRoIG5vIGZlYXR1cmVzLgoJICAgICAgICAgKi8KCSAgICAgICAgdGhpcy5ibGFua0dlb0pTT04gPSAoKSA9PiAoewoJICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywKCSAgICAgICAgICAgIGZlYXR1cmVzOiBbXSwKCSAgICAgICAgfSk7CgkgICAgICAgIHRoaXMuX3Jhd0RhdGEgPSBkYXRhOwoJICAgICAgICB0aGlzLl9mb3JtYXQgPSBmb3JtYXQ7CgkgICAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zOwoJICAgICAgICBjb25zdCBjb252ZXJ0ZXJzID0gewoJICAgICAgICAgICAgJ3RvcG9qc29uJzogdGhpcy5sb2FkVG9wb0pzb24sCgkgICAgICAgICAgICAnb3NtJzogdGhpcy5sb2FkT3NtLAoJICAgICAgICAgICAgJ2ttbCc6IHRoaXMubG9hZFhtbCwKCSAgICAgICAgICAgICdncHgnOiB0aGlzLmxvYWRYbWwsCgkgICAgICAgICAgICAndGN4JzogdGhpcy5sb2FkWG1sLAoJICAgICAgICAgICAgJ2Nzdic6IHRoaXMubG9hZENzdiwKCSAgICAgICAgICAgICd0c3YnOiB0aGlzLmxvYWRDc3YsCgkgICAgICAgICAgICAncG9seWxpbmUnOiB0aGlzLmxvYWRQb2x5bGluZQoJICAgICAgICB9OwoJICAgICAgICB0aGlzLl9jb252ZXJzaW9uRm4gPSBjb252ZXJ0ZXJzW2Zvcm1hdF07CgkgICAgfQoJICAgIGFzeW5jIGNvbnZlcnQoKSB7CgkgICAgICAgIGlmICghdGhpcy5fY29udmVyc2lvbkZuKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKF8sIHJlaikgPT4gcmVqKGBObyBjb252ZXJ0ZXIgZXhpc3RzIGZvciAke3RoaXMuX2Zvcm1hdH1gKSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVyc2lvbkZuKCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogTG9hZCB0aGUgWE1MIGRhdGEgYXMgR2VvSlNPTgoJICAgICAqIEByZXR1cm5zIEEgcHJvbWlzZSByZXNvbHZpbmcgdG8gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZFhtbCgpIHsKCSAgICAgICAgLy8gVXNlIHRoZSBhcHByb3ByaWF0ZSBwYXJzZXIgYmFzZWQgb24gdGhlIGZvcm1hdAoJICAgICAgICBjb25zdCBnZW9qc29uID0gdG9HZW9Kc29uW3RoaXMuX2Zvcm1hdF0obmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh0aGlzLl9yYXdEYXRhLCAidGV4dC94bWwiKSk7CgkgICAgICAgIHJldHVybiBnZW9qc29uOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBMb2FkcyBhbmQgcGFyc2VzIENTViBkYXRhIGludG8gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uLgoJICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZENzdigpIHsKCSAgICAgICAgLy8gRGVmaW5lIG9wdGlvbnMgZm9yIHRoZSBjc3YyZ2VvanNvbiBsaWJyYXJ5CgkgICAgICAgIGxldCBvcHRpb25zID0gdGhpcy5fb3B0aW9ucy5jc3ZPcHRpb25zIHx8IHt9OyAvLyBUT0RPIGFsbG93IENTViBvcHRpb25zCgkgICAgICAgIGlmICh0aGlzLl9mb3JtYXQgPT09ICd0c3YnKSB7CgkgICAgICAgICAgICBvcHRpb25zLmRlbGltaXRlciA9ICdcdCc7CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIHRoZSBjc3YyZ2VvanNvbiBsaWJyYXJ5IHRvIGNvbnZlcnQgdGhlIENTViB0byBHZW9KU09OCgkgICAgICAgIGNvbnN0IGdlb2pzb24gPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CgkgICAgICAgICAgICBjc3YyZ2VvanNvbl8xLmNzdjJnZW9qc29uKHRoaXMuX3Jhd0RhdGEsIG9wdGlvbnMsIChlcnIsIGRhdGEpID0+IHsKCSAgICAgICAgICAgICAgICBpZiAoZXJyKSB7CgkgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9KTsKCSAgICAgICAgfSk7CgkgICAgICAgIHJldHVybiBnZW9qc29uOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBMb2FkcyBUb3BvSlNPTiBkYXRhIGFuZCBjb252ZXJ0cyBpdCBpbnRvIGEgR2VvSlNPTiBGZWF0dXJlQ29sbGVjdGlvbgoJICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZFRvcG9Kc29uKCkgewoJICAgICAgICBsZXQgdG9wb0pzb25EYXRhID0ge307CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB0b3BvSnNvbkRhdGEgPSBKU09OLnBhcnNlKHRoaXMuX3Jhd0RhdGEpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlKSB7CgkgICAgICAgICAgICB0aHJvdyAiSW52YWxpZCBUb3BvSnNvbiI7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udmVydCB0aGUgZGF0YQoJICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5ibGFua0dlb0pTT04oKTsKCSAgICAgICAgaWYgKHRvcG9Kc29uRGF0YS50eXBlID09PSAiVG9wb2xvZ3kiICYmIHRvcG9Kc29uRGF0YS5vYmplY3RzICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJlc3VsdCA9IHsKCSAgICAgICAgICAgICAgICB0eXBlOiAiRmVhdHVyZUNvbGxlY3Rpb24iLAoJICAgICAgICAgICAgICAgIGZlYXR1cmVzOiByZXN1bHQuZmVhdHVyZXMgPSBPYmplY3Qua2V5cyh0b3BvSnNvbkRhdGEub2JqZWN0cykubWFwKGtleSA9PiB0b3BvanNvbkZlYXR1cmUodG9wb0pzb25EYXRhLCBrZXkpKS5yZWR1Y2UoKGEsIHYpID0+IFsuLi5hLCAuLi52LmZlYXR1cmVzXSwgW10pCgkgICAgICAgICAgICB9OwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfQoJICAgIDsKCSAgICAvKioKCSAgICAgKiBMb2FkcyBPU00gZGF0YSBhbmQgY29udmVydHMgaXQgaW50byBhIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24KCSAgICAgKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uLgoJICAgICAqLwoJICAgIGFzeW5jIGxvYWRPc20oKSB7CgkgICAgICAgIHJldHVybiBvc20yZ2VvanNvbih0aGlzLl9yYXdEYXRhKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogTG9hZHMgYW5kIHBhcnNlcyBQb2x5bGluZSBkYXRhIGludG8gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uLgoJICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZFBvbHlsaW5lKCkgewoJICAgICAgICBsZXQgb3B0aW9ucyA9IHRoaXMuX29wdGlvbnMucG9seWxpbmVPcHRpb25zIHx8IHt9OwoJICAgICAgICAvLyBVc2UgdGhlIEBtYXBib3gvcG9seWxpbmUgbGlicmFyeSB0byBjb252ZXJ0IHRoZSBwb2x5bGluZSB0byBHZW9KU09OCgkgICAgICAgIGNvbnN0IGdlb2pzb24gPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVTdHJpbmcgPSBwb2x5bGluZUV4cG9ydHMudG9HZW9KU09OKHRoaXMuX3Jhd0RhdGEsIG9wdGlvbnMucHJlY2lzaW9uKTsKCSAgICAgICAgICAgICAgICBsZXQgZ2VvbWV0cnkgPSBsaW5lU3RyaW5nOwoJICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnR5cGUgPT09ICdwb2ludCcpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVTdHJpbmcuY29vcmRpbmF0ZXMubGVuZ3RoID09PSAxKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIGl0IGEgcG9pbnQKCSAgICAgICAgICAgICAgICAgICAgICAgIGdlb21ldHJ5ID0gewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJzogJ1BvaW50JywKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29vcmRpbmF0ZXMnOiBsaW5lU3RyaW5nLmNvb3JkaW5hdGVzWzBdCgkgICAgICAgICAgICAgICAgICAgICAgICB9OwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdDYW5ub3QgY29udmVydCBwb2x5bGluZSB0byAnICsgb3B0aW9ucy50eXBlKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChvcHRpb25zLnR5cGUgPT09ICdwb2x5Z29uJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAobGluZVN0cmluZy5jb29yZGluYXRlc1swXVswXSA9PT0gbGluZVN0cmluZy5jb29yZGluYXRlc1tsaW5lU3RyaW5nLmNvb3JkaW5hdGVzLmxlbmd0aCAtIDFdWzBdICYmCgkgICAgICAgICAgICAgICAgICAgICAgICBsaW5lU3RyaW5nLmNvb3JkaW5hdGVzWzBdWzFdID09PSBsaW5lU3RyaW5nLmNvb3JkaW5hdGVzW2xpbmVTdHJpbmcuY29vcmRpbmF0ZXMubGVuZ3RoIC0gMV1bMV0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgaXQgYSBwb2x5Z29uCgkgICAgICAgICAgICAgICAgICAgICAgICBnZW9tZXRyeSA9IHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZSc6ICdQb2x5Z29uJywKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29vcmRpbmF0ZXMnOiBbbGluZVN0cmluZy5jb29yZGluYXRlc10KCSAgICAgICAgICAgICAgICAgICAgICAgIH07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0Nhbm5vdCBjb252ZXJ0IHBvbHlsaW5lIHRvICcgKyBvcHRpb25zLnR5cGUpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHJlc29sdmUoewoJICAgICAgICAgICAgICAgICAgICB0eXBlOiAiRmVhdHVyZUNvbGxlY3Rpb24iLAoJICAgICAgICAgICAgICAgICAgICBmZWF0dXJlczogW3sKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAidHlwZSI6ICJGZWF0dXJlIiwKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZ2VvbWV0cnkiOiBnZW9tZXRyeSwKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAicHJvcGVydGllcyI6IG9wdGlvbnMucHJvcGVydGllcyB8fCB7fQoJICAgICAgICAgICAgICAgICAgICAgICAgfV0KCSAgICAgICAgICAgICAgICB9KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlcnIpIHsKCSAgICAgICAgICAgICAgICByZWplY3QoZXJyKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfSk7CgkgICAgICAgIHJldHVybiBnZW9qc29uOwoJICAgIH0KCX0KCgljb25zdCBsaWJyYXJpZXMgPSB7CgkgICAgJ0NvbnZlcnRlcic6IENvbnZlcnRlcgoJfTsKCWxldCBzdWJDbGFzczsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGUgPT4gewoJICAgIGNvbnN0IGRhdGEgPSAoZS5kYXRhIHx8IGUpOwoJICAgIGNvbnN0IHBvc3QgPSAoaWQsIGVyciwgcmVzLCB0eXBlKSA9PiB7CgkgICAgICAgIHBvc3RNZXNzYWdlKHsKCSAgICAgICAgICAgIHR5cGU6IHR5cGUgPyB0eXBlIDogKGVyciA/ICdlcnJvcicgOiAncmVzcG9uc2UnKSwKCSAgICAgICAgICAgIGlkOiBpZCwKCSAgICAgICAgICAgIG1lc3NhZ2U6IHJlcywKCSAgICAgICAgICAgIGVycm9yOiBlcnIKCSAgICAgICAgfSk7CgkgICAgfTsKCSAgICBjb25zdCBjb21tYW5kcyA9IHsKCSAgICAgICAgJ2luaXQnOiAobXNnKSA9PiB7CgkgICAgICAgICAgICBjb25zdCB7IGlkLCBjb21tYW5kLCBtZXNzYWdlIH0gPSBtc2c7CgkgICAgICAgICAgICBzdWJDbGFzcyA9IG5ldyBsaWJyYXJpZXNbY29tbWFuZF0obWVzc2FnZVswXSwgbWVzc2FnZVsxXSk7CgkgICAgICAgICAgICAvLyByZXR1cm4gdGhlIGNsYXNzJyBtZXRob2RzCgkgICAgICAgICAgICBjb25zdCBmbnMgPSBbCgkgICAgICAgICAgICAgICAgLi4uT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMobGlicmFyaWVzW2NvbW1hbmRdLnByb3RvdHlwZSksCgkgICAgICAgICAgICAgICAgLi4uT2JqZWN0LmtleXMoc3ViQ2xhc3MpCgkgICAgICAgICAgICBdLm1hcChrZXkgPT4gW2tleSwgdHlwZW9mIGxpYnJhcmllc1tjb21tYW5kXS5wcm90b3R5cGVba2V5XV0pCgkgICAgICAgICAgICAgICAgLnJlZHVjZSgoYSwgYykgPT4gKHsgLi4uYSwgLi4ueyBbY1swXV06IGNbMV0gfSB9KSwge30pOwoJICAgICAgICAgICAgcG9zdChpZCwgdW5kZWZpbmVkLCBmbnMsICdpbml0X3Jlc3BvbnNlJyk7CgkgICAgICAgIH0sCgkgICAgICAgICdnZXQnOiBmdW5jdGlvbiAobXNnKSB7CgkgICAgICAgICAgICBjb25zdCB7IGlkLCBjb21tYW5kIH0gPSBtc2c7CgkgICAgICAgICAgICBpZiAoc3ViQ2xhc3MgJiYgc3ViQ2xhc3NbY29tbWFuZF0pIHsKCSAgICAgICAgICAgICAgICBwb3N0KGlkLCB1bmRlZmluZWQsIHN1YkNsYXNzW2NvbW1hbmRdKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgIHBvc3QoaWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfSwKCSAgICAgICAgJ2V4ZWMnOiBmdW5jdGlvbiAobXNnKSB7CgkgICAgICAgICAgICBjb25zdCB7IGlkLCBjb21tYW5kLCBtZXNzYWdlIH0gPSBtc2c7CgkgICAgICAgICAgICBpZiAoc3ViQ2xhc3MgJiYgc3ViQ2xhc3NbY29tbWFuZF0gJiYgdHlwZW9mIHN1YkNsYXNzW2NvbW1hbmRdID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICAgICAgICAgICAgY29uc3QgY21kID0gc3ViQ2xhc3NbY29tbWFuZF0KCSAgICAgICAgICAgICAgICAgICAgLmFwcGx5KHN1YkNsYXNzLCBtZXNzYWdlKTsKCSAgICAgICAgICAgICAgICBpZiAoISFjbWQgJiYgdHlwZW9mIGNtZC50aGVuID09PSAnZnVuY3Rpb24nKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEl0J3MgYSBwcm9taXNlLCBzbyB3YWl0IGZvciBpdAoJICAgICAgICAgICAgICAgICAgICBjbWQKCSAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiBwb3N0KGlkLCB1bmRlZmluZWQsIHJlcykpCgkgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZSA9PiBwb3N0KGlkLCBlKSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAvLyBOb3QgYSBwcm9taXNlLCBqdXN0IHJldHVybiBpdAoJICAgICAgICAgICAgICAgICAgICBwb3N0KGlkLCB1bmRlZmluZWQsIGNtZCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gRXJyb3IKCSAgICAgICAgICAgICAgICBwb3N0KGlkLCBuZXcgRXJyb3IoYGNvbW1hbmQgIiR7Y29tbWFuZH0iIG5vdCBmb3VuZGApKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgaWYgKGNvbW1hbmRzW2RhdGEudHlwZV0pIHsKCSAgICAgICAgY29tbWFuZHNbZGF0YS50eXBlXShkYXRhKTsKCSAgICB9Cgl9KTsKCn0pKCk7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPXdvcmtlci5qcy5tYXAKCg==",pa?pn(Rs):function(ht,Ct,ct){var bt;return function(Pt){return bt=bt||An(ht),new Worker(bt,Pt)}}(Rs));let vn=()=>Math.random().toString(36).substring(2);class io{constructor(Ct,ct){this.initId=vn()+"-"+Ct,this.worker=new Or,this.handlers=new Map,this.worker.onmessage=bt=>{let Pt=bt.data,Jt=this.handlers.get(Pt.id),re=this;if(Jt){if(Pt.type==="response"&&Jt.resolve(Pt.message),Pt.type==="error"){let _e=Pt.error||new Error(`Unknown error with ${Ct}`);Jt.reject(_e)}Pt.type==="init_response"&&(this._=Object.keys(Pt.message).map(_e=>{let Be=typeof Pt.message[_e]=="function";return[_e,function(){return Be?re.exec(_e)(...arguments):re.get(_e)}]}).reduce((_e,Be)=>({..._e,[Be[0]]:Be[1]}),{}),Jt.resolve(this._))}},this.worker.postMessage({type:"init",id:this.initId,command:Ct,message:ct})}onLoad(){return new Promise(Ct=>{this._===void 0?this.handlers.set(this.initId,{resolve:Ct,reject:Ct}):Ct(this._)})}exec(Ct){let ct=this;return function(...bt){return new Promise((Pt,Jt)=>{let re=vn()+"-"+Ct;ct.handlers.set(re,{resolve:Pt,reject:Jt}),ct.worker.postMessage({type:"exec",id:re,command:Ct,message:[...bt]})})}}get(Ct){return new Promise((ct,bt)=>{let Pt=vn()+"-"+Ct;this.handlers.set(Pt,{resolve:ct,reject:bt}),this.worker.postMessage({type:"get",id:Pt,command:Ct,message:[]})})}}let ir=new URL("test://http://example.com").href!=="test://http://example.com";async function ro(ht,Ct,ct){let bt=await fetch(ht,ct?{signal:ct.signal}:void 0),Pt={},Jt=new URL(ht,window.location.href);if(Jt.hash.length){let re=Jt.hash,_e=decodeURIComponent(re.slice(1));try{Pt=JSON.parse(_e)}catch(Be){console.warn("Error parsing or reading URL:",Be)}}if(bt.status==200){let re=await bt.text(),_e;return["kml","tcx","gpx"].includes(Ct)||!(()=>{let Be=!1;try{Be=typeof window.Worker=="function"}catch{Be=!1}return Be})()?_e=new $r(Ct,re,Pt).convert():_e=new io("Converter",[Ct,re,Pt]).exec("convert")(),await _e}throw new Error(`Data fetch error: ${bt.statusText}`)}let wn=ht=>{let Ct=ht.split("://")[0],ct=ht.replace(new RegExp(`^${Ct}://`),""),bt=ir?(Pt=>{let Jt=new RegExp("^(https?)(//)");return Pt.replace(Jt,"$1:$2")})(ct):ct;return{prefix:Ct,url:bt}},no=(ht,Ct)=>Ct instanceof AbortController?(async(ct,bt)=>{let{prefix:Pt,url:Jt}=wn(ct.url);if(!Jt)throw new Error("Invalid URL: "+ct.url);try{return{data:await ro(Jt,Pt,bt)}}catch(re){throw new Error(re||"Unknown Error")}})(ht,Ct):((ct,bt)=>{let Pt=new AbortController,{prefix:Jt,url:re}=wn(ct.url);return re&&ro(re,Jt,Pt).then(_e=>bt(null,_e)).catch(_e=>bt(_e)),{cancel:()=>{Pt.abort()}}})(ht,Ct),ns=Fr;n.VectorTextProtocol=no,n.addOptions=(ht,Ct)=>{try{let ct=new URL(ht);return ct.hash=`#${encodeURIComponent(JSON.stringify(Ct))}`,ct.toString()}catch(ct){return console.error("Error parsing or updating URL:",ct),ht}},n.addProtocols=ht=>{Fr.forEach(Ct=>{ht.addProtocol(Ct,no)})},n.processData=ro,n.vectorFormats=ns})});var nC=ua((az,Sb)=>{Sb.exports=t3;var $F=Object.prototype.hasOwnProperty;function t3(){for(var n={},t=0;t<arguments.length;t++){var r=arguments[t];for(var o in r)$F.call(r,o)&&(n[o]=r[o])}return n}});var Lb=ua((Fb,kb)=>{(function(){var n=this,t={};typeof Fb<"u"?kb.exports=t:n.fuzzy=t,t.simpleFilter=function(r,o){return o.filter(function(A){return t.test(r,A)})},t.test=function(r,o){return t.match(r,o)!==null},t.match=function(r,o,A){A=A||{};var s=0,d=[],f=o.length,I=0,_=0,S=A.pre||"",U=A.post||"",G=A.caseSensitive&&o||o.toLowerCase(),L;r=A.caseSensitive&&r||r.toLowerCase();for(var K=0;K<f;K++)L=o[K],G[K]===r[s]?(L=S+L+U,s+=1,_+=1+_):_=0,I+=_,d[d.length]=L;return s===r.length?(I=G===r?1/0:I,{rendered:d.join(""),score:I}):null},t.filter=function(r,o,A){return!o||o.length===0?[]:typeof r!="string"?o:(A=A||{},o.reduce(function(s,d,f,I){var _=d;A.extract&&(_=A.extract(d));var S=t.match(r,_,A);return S!=null&&(s[s.length]={string:S.rendered,score:S.score,index:f,original:d}),s},[]).sort(function(s,d){var f=d.score-s.score;return f||s.index-d.index}))}})()});var Tb=ua((Az,Eb)=>{"use strict";var Mo=function(n){return this.component=n,this.items=[],this.active=n.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,n.el.parentNode.insertBefore(this.wrapper,n.el.nextSibling),this};Mo.prototype.show=function(){this.element.style.display="block"};Mo.prototype.hide=function(){this.element.style.display="none"};Mo.prototype.add=function(n){this.items.push(n)};Mo.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0};Mo.prototype.isEmpty=function(){return!this.items.length};Mo.prototype.isVisible=function(){return this.element.style.display==="block"};Mo.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var n=0;n<this.items.length;n++)this.drawItem(this.items[n],this.active===n);this.show()};Mo.prototype.drawItem=function(n,t){var r=document.createElement("li"),o=document.createElement("a");t&&(r.className+=" active"),o.innerHTML=n.string,r.appendChild(o),this.element.appendChild(r),r.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),r.addEventListener("mouseup",function(){this.handleMouseUp.call(this,n)}.bind(this))};Mo.prototype.handleMouseUp=function(n){this.selectingListItem=!1,this.component.value(n.original),this.clear(),this.draw()};Mo.prototype.move=function(n){this.active=n,this.draw()};Mo.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)};Mo.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)};Mo.prototype.drawError=function(n){var t=document.createElement("li");t.innerHTML=n,this.element.appendChild(t),this.show()};Eb.exports=Mo});var Qb=ua((lz,Ub)=>{"use strict";var e3=nC(),i3=Lb(),r3=Tb(),Xs=function(n,t,r){return r=r||{},this.options=e3({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},r),this.el=n,this.data=t||[],this.list=new r3(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(o){this.handleKeyUp(o.keyCode,o)}.bind(this),!1),this.el.addEventListener("keydown",function(o){this.handleKeyDown(o)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(o){this.handlePaste(o)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};Xs.prototype.handleKeyUp=function(n,t){if(!(n===40||n===38||n===27||n===9)){if(n===13){this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),t.stopPropagation());return}this.handleInputChange(this.el.value)}};Xs.prototype.handleKeyDown=function(n){switch(n.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&n.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};Xs.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};Xs.prototype.handlePaste=function(n){if(n.clipboardData)this.handleInputChange(n.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(n.target.value)},100)}};Xs.prototype.handleInputChange=function(n){if(this.query=this.normalize(n),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates(function(t){for(var r=0;r<t.length&&(this.list.add(t[r]),r!==this.options.limit-1);r++);this.list.draw()}.bind(this))};Xs.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};Xs.prototype.update=function(n){this.data=n,this.handleKeyUp()};Xs.prototype.clear=function(){this.data=[],this.list.clear()};Xs.prototype.normalize=function(n){return n=n.toLowerCase(),n};Xs.prototype.match=function(n,t){return n.indexOf(t)>-1};Xs.prototype.value=function(n){if(this.selected=n,this.el.value=this.getItemValue(n||{place_name:this.query}),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")};Xs.prototype.getCandidates=function(n){var t={pre:"<strong>",post:"</strong>",extract:function(o){return this.getItemValue(o)}.bind(this)},r;this.options.filter?(r=i3.filter(this.query,this.data,t),r=r.map(function(o){return{original:o.original,string:this.render(o.original,o.string)}}.bind(this))):r=this.data.map(function(o){var A=this.render(o);return{original:o,string:A}}.bind(this)),n(r)};Xs.prototype.getItemValue=function(n){return n};Xs.prototype.render=function(n,t){if(t)return t;for(var r=n.original?this.getItemValue(n.original):this.getItemValue(n),o=this.normalize(r),A=o.lastIndexOf(this.query);A>-1;){var s=A+this.query.length;r=r.slice(0,A)+"<strong>"+r.slice(A,s)+"</strong>"+r.slice(s),A=o.slice(0,A).lastIndexOf(this.query)}return r};Xs.prototype.renderError=function(n){this.list.drawError(n)};Ub.exports=Xs});var Zb=ua((cz,Gb)=>{"use strict";var Rb=Qb();Gb.exports=Rb;typeof window<"u"&&(window.Suggestions=Rb)});var Nb=ua((uz,Mb)=>{var n3="Expected a function",Pb=NaN,s3="[object Symbol]",o3=/^\s+|\s+$/g,a3=/^[-+]0x[0-9a-f]+$/i,A3=/^0b[01]+$/i,l3=/^0o[0-7]+$/i,c3=parseInt,u3=typeof global=="object"&&global&&global.Object===Object&&global,h3=typeof self=="object"&&self&&self.Object===Object&&self,g3=u3||h3||Function("return this")(),d3=Object.prototype,p3=d3.toString,f3=Math.max,m3=Math.min,sC=function(){return g3.Date.now()};function C3(n,t,r){var o,A,s,d,f,I,_=0,S=!1,U=!1,G=!0;if(typeof n!="function")throw new TypeError(n3);t=Hb(t)||0,oC(r)&&(S=!!r.leading,U="maxWait"in r,s=U?f3(Hb(r.maxWait)||0,t):s,G="trailing"in r?!!r.trailing:G);function L(Et){var xt=o,It=A;return o=A=void 0,_=Et,d=n.apply(It,xt),d}function K(Et){return _=Et,f=setTimeout(z,t),S?L(Et):d}function V(Et){var xt=Et-I,It=Et-_,Nt=t-xt;return U?m3(Nt,s-It):Nt}function q(Et){var xt=Et-I,It=Et-_;return I===void 0||xt>=t||xt<0||U&&It>=s}function z(){var Et=sC();if(q(Et))return it(Et);f=setTimeout(z,V(Et))}function it(Et){return f=void 0,G&&o?L(Et):(o=A=void 0,d)}function At(){f!==void 0&&clearTimeout(f),_=0,o=I=A=f=void 0}function _t(){return f===void 0?d:it(sC())}function Lt(){var Et=sC(),xt=q(Et);if(o=arguments,A=this,I=Et,xt){if(f===void 0)return K(I);if(U)return f=setTimeout(z,t),L(I)}return f===void 0&&(f=setTimeout(z,t)),d}return Lt.cancel=At,Lt.flush=_t,Lt}function oC(n){var t=typeof n;return!!n&&(t=="object"||t=="function")}function I3(n){return!!n&&typeof n=="object"}function y3(n){return typeof n=="symbol"||I3(n)&&p3.call(n)==s3}function Hb(n){if(typeof n=="number")return n;if(y3(n))return Pb;if(oC(n)){var t=typeof n.valueOf=="function"?n.valueOf():n;n=oC(t)?t+"":t}if(typeof n!="string")return n===0?n:+n;n=n.replace(o3,"");var r=A3.test(n);return r||l3.test(n)?c3(n.slice(2),r?2:8):a3.test(n)?Pb:+n}Mb.exports=C3});var qb=ua((hz,aC)=>{"use strict";var Tu=typeof Reflect=="object"?Reflect:null,Vb=Tu&&typeof Tu.apply=="function"?Tu.apply:function(t,r,o){return Function.prototype.apply.call(t,r,o)},Sd;Tu&&typeof Tu.ownKeys=="function"?Sd=Tu.ownKeys:Object.getOwnPropertySymbols?Sd=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Sd=function(t){return Object.getOwnPropertyNames(t)};function b3(n){console&&console.warn&&console.warn(n)}var Kb=Number.isNaN||function(t){return t!==t};function Yr(){Yr.init.call(this)}aC.exports=Yr;aC.exports.once=_3;Yr.EventEmitter=Yr;Yr.prototype._events=void 0;Yr.prototype._eventsCount=0;Yr.prototype._maxListeners=void 0;var Db=10;function Fd(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(Yr,"defaultMaxListeners",{enumerable:!0,get:function(){return Db},set:function(n){if(typeof n!="number"||n<0||Kb(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");Db=n}});Yr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Yr.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Kb(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function zb(n){return n._maxListeners===void 0?Yr.defaultMaxListeners:n._maxListeners}Yr.prototype.getMaxListeners=function(){return zb(this)};Yr.prototype.emit=function(t){for(var r=[],o=1;o<arguments.length;o++)r.push(arguments[o]);var A=t==="error",s=this._events;if(s!==void 0)A=A&&s.error===void 0;else if(!A)return!1;if(A){var d;if(r.length>0&&(d=r[0]),d instanceof Error)throw d;var f=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw f.context=d,f}var I=s[t];if(I===void 0)return!1;if(typeof I=="function")Vb(I,this,r);else for(var _=I.length,S=Yb(I,_),o=0;o<_;++o)Vb(S[o],this,r);return!0};function Ob(n,t,r,o){var A,s,d;if(Fd(r),s=n._events,s===void 0?(s=n._events=Object.create(null),n._eventsCount=0):(s.newListener!==void 0&&(n.emit("newListener",t,r.listener?r.listener:r),s=n._events),d=s[t]),d===void 0)d=s[t]=r,++n._eventsCount;else if(typeof d=="function"?d=s[t]=o?[r,d]:[d,r]:o?d.unshift(r):d.push(r),A=zb(n),A>0&&d.length>A&&!d.warned){d.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+d.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=n,f.type=t,f.count=d.length,b3(f)}return n}Yr.prototype.addListener=function(t,r){return Ob(this,t,r,!1)};Yr.prototype.on=Yr.prototype.addListener;Yr.prototype.prependListener=function(t,r){return Ob(this,t,r,!0)};function v3(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Wb(n,t,r){var o={fired:!1,wrapFn:void 0,target:n,type:t,listener:r},A=v3.bind(o);return A.listener=r,o.wrapFn=A,A}Yr.prototype.once=function(t,r){return Fd(r),this.on(t,Wb(this,t,r)),this};Yr.prototype.prependOnceListener=function(t,r){return Fd(r),this.prependListener(t,Wb(this,t,r)),this};Yr.prototype.removeListener=function(t,r){var o,A,s,d,f;if(Fd(r),A=this._events,A===void 0)return this;if(o=A[t],o===void 0)return this;if(o===r||o.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete A[t],A.removeListener&&this.emit("removeListener",t,o.listener||r));else if(typeof o!="function"){for(s=-1,d=o.length-1;d>=0;d--)if(o[d]===r||o[d].listener===r){f=o[d].listener,s=d;break}if(s<0)return this;s===0?o.shift():w3(o,s),o.length===1&&(A[t]=o[0]),A.removeListener!==void 0&&this.emit("removeListener",t,f||r)}return this};Yr.prototype.off=Yr.prototype.removeListener;Yr.prototype.removeAllListeners=function(t){var r,o,A;if(o=this._events,o===void 0)return this;if(o.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):o[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete o[t]),this;if(arguments.length===0){var s=Object.keys(o),d;for(A=0;A<s.length;++A)d=s[A],d!=="removeListener"&&this.removeAllListeners(d);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=o[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(A=r.length-1;A>=0;A--)this.removeListener(t,r[A]);return this};function Jb(n,t,r){var o=n._events;if(o===void 0)return[];var A=o[t];return A===void 0?[]:typeof A=="function"?r?[A.listener||A]:[A]:r?B3(A):Yb(A,A.length)}Yr.prototype.listeners=function(t){return Jb(this,t,!0)};Yr.prototype.rawListeners=function(t){return Jb(this,t,!1)};Yr.listenerCount=function(n,t){return typeof n.listenerCount=="function"?n.listenerCount(t):Xb.call(n,t)};Yr.prototype.listenerCount=Xb;function Xb(n){var t=this._events;if(t!==void 0){var r=t[n];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Yr.prototype.eventNames=function(){return this._eventsCount>0?Sd(this._events):[]};function Yb(n,t){for(var r=new Array(t),o=0;o<t;++o)r[o]=n[o];return r}function w3(n,t){for(;t+1<n.length;t++)n[t]=n[t+1];n.pop()}function B3(n){for(var t=new Array(n.length),r=0;r<t.length;++r)t[r]=n[r].listener||n[r];return t}function _3(n,t){return new Promise(function(r,o){function A(d){n.removeListener(t,s),o(d)}function s(){typeof n.removeListener=="function"&&n.removeListener("error",A),r([].slice.call(arguments))}jb(n,t,s,{once:!0}),t!=="error"&&x3(n,A,{once:!0})})}function x3(n,t,r){typeof n.on=="function"&&jb(n,"error",t,r)}function jb(n,t,r,o){if(typeof n.on=="function")o.once?n.once(t,r):n.on(t,r);else if(typeof n.addEventListener=="function")n.addEventListener(t,function A(s){o.once&&n.removeEventListener(t,A),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}});var tv=ua((gz,$b)=>{$b.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}});var iv=ua((dz,ev)=>{"use strict";var S3={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05DC\u05D7\u05E4\u05E9",ja:"\u30B5\u30FC\u30C1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041F\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641C\u7D22",cs:"Vyhled\xE1v\xE1n\xED",hu:"Keres\xE9s",ka:"\u10EB\u10D8\u10D4\u10D1\u10D0",nb:"S\xF8ke",sk:"Vyh\u013Ead\xE1vanie",th:"\u0E04\u0E49\u0E19\u0E2B\u0E32",fi:"Hae",is:"Leita",ko:"\uC218\uC0C9",pl:"Szukaj",sl:"Iskanje",fa:"\u062C\u0633\u062A\u062C\u0648",ru:"\u041F\u043E\u0438\u0441\u043A"};ev.exports={placeholder:S3}});var nv=ua((rv,kd)=>{(function(n,t,r){typeof kd<"u"&&kd.exports?kd.exports=r():n[t]=r()})(rv,"subtag",function(){var n="",t=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function r(f){return f.match(t)||[]}function o(f){return r(f).filter(function(I,_){return I&&_})}function A(f){return f=r(f),{language:f[1]||n,extlang:f[2]||n,script:f[3]||n,region:f[4]||n}}function s(f,I,_){Object.defineProperty(f,I,{value:_,enumerable:!0})}function d(f,I,_){function S(U){return r(U)[f]||n}s(S,"pattern",I),s(A,_,S)}return d(1,/^[a-zA-Z]{2,3}$/,"language"),d(2,/^[a-zA-Z]{3}$/,"extlang"),d(3,/^[a-zA-Z]{4}$/,"script"),d(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),s(A,"split",o),A})});var Av=ua((pz,av)=>{"use strict";var F3=Zb(),k3=Nb(),ha=nC(),L3=qb().EventEmitter,sv=tv(),E3=iv(),T3=nv();function ov(n,t){this._eventEmitter=new L3,this.options=ha({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geocoderApi=n}ov.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(n){return n.text!==void 0?n.text:n.place_name},render:function(n){if(n.geometry){var f=n.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--result maplibregl-ctrl-geocoder--result"><svg class="mapboxgl-ctrl-geocoder--result-icon maplibre-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="mapboxgl-ctrl-geocoder--result-title maplibregl-ctrl-geocoder--result-title">'+f[0]+'</div><div class="mapboxgl-ctrl-geocoder--result-address maplibregl-ctrl-geocoder--result-address">'+f.splice(1,f.length).join(",")+"</div></div></div>"}else{var t=n.text,r=t.toLowerCase().indexOf(this.query.toLowerCase()),o=this.query.length,A=t.substring(0,r),s=t.substring(r,r+o),d=t.substring(r+o);return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibregl-ctrl-geocoder--suggestion"><svg class="mapboxgl-ctrl-geocoder--suggestion-icon maplibre-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="mapboxgl-ctrl-geocoder--suggestion-info maplibregl-ctrl-geocoder--suggestion-info"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibregl-ctrl-geocoder--suggestion-title">'+A+'<span class="mapboxgl-ctrl-geocoder--suggestion-match maplibregl-ctrl-geocoder--suggestion-match">'+s+"</span>"+d+"</div></div></div>"}},popupRender:function(n){var t=n.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibre-ctrl-geocoder--suggestion popup-suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibre-ctrl-geocoder--suggestion-title popup-suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address maplibre-ctrl-geocoder--suggestion-address popup-suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},addTo:function(n){function t(o,A){if(!document.body.contains(A))throw new Error("Element provided to #addTo() exists, but is not in the DOM");var s=o.onAdd();A.appendChild(s)}if(n._controlContainer)n.addControl(this);else if(n instanceof HTMLElement)t(this,n);else if(typeof n=="string"){var r=document.querySelectorAll(n);if(r.length===0)throw new Error("Element ",n,"not found.");if(r.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,r[0])}else throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(n){if(n&&typeof n!="string"&&(this._map=n),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";var r=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",k3(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);var o=document.createElement("div");o.classList.add("mapboxgl-ctrl-geocoder--pin-right","maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button maplibregl-ctrl-geocoder--button";var A=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(A),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),o.appendChild(this._clearEl),o.appendChild(this._loadingEl),t.appendChild(r),t.appendChild(this._inputEl),t.appendChild(o),this._typeahead=new F3(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),t},createIcon:function(n,t){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+n+" maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+n),r.setAttribute("viewBox","0 0 18 18"),r.setAttribute("xml:space","preserve"),r.setAttribute("width",18),r.setAttribute("height",18),"innerHTML"in r)r.innerHTML=t;else{var o=document.createElement("div");o.innerHTML="<svg>"+t.valueOf().toString()+"</svg>";var A=o.firstChild,s=A.firstChild;r.appendChild(s)}return r},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(n){var t=(n.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t)},_onKeyDown:function(n){var t=27,r=9;if(n.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(n),this._inputEl.blur();var o=n.target&&n.target.shadowRoot?n.target.shadowRoot.activeElement:n.target,A=o?o.value:"";if(!A)return this.fresh=!0,n.keyCode!==r&&this.clear(n),this._clearEl.style.display="none";if(!(n.metaKey||[r,t,37,39,38,40].indexOf(n.keyCode)!==-1)){if(n.keyCode===13)if(!this.options.showResultsWhileTyping)this._typeahead.selected||this._geocode(o.value);else{this._typeahead.selected==null&&this.geocoderApi.getSuggestions?this._geocode(o.value,!0):this._typeahead.selected==null&&this.options.showResultMarkers&&this._fitBoundsForMarkers();return}o.value.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(o.value)}},_showButton:function(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(n){this.options.clearOnBlur&&this._clearOnBlur(n),this.options.collapsed&&this._collapse()},_onChange:function(){var n=this._typeahead.selected;if(n&&!n.geometry)n.placeId?this._geocode(n.placeId,!0,!0):this._geocode(n.text,!0);else if(n&&JSON.stringify(n)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){var t;if(this._removeResultMarkers(),n.properties&&sv[n.properties.short_code])t=ha({},this.options.flyTo),this._map&&this._map.fitBounds(sv[n.properties.short_code].bbox,t);else if(n.bbox){var r=n.bbox;t=ha({},this.options.flyTo),this._map&&this._map.fitBounds([[r[0],r[1]],[r[2],r[3]]],t)}else{var o={zoom:this.options.zoom};t=ha({},o,this.options.flyTo),n.center?t.center=n.center:n.geometry&&n.geometry.type&&n.geometry.type==="Point"&&n.geometry.coordinates&&(t.center=n.geometry.coordinates),this._map&&this._map.flyTo(t)}}this.options.marker&&this._maplibregl&&this._handleMarker(n),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(n),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:n})}},_getConfigForRequest:function(){var n=["bbox","limit","proximity","countries","types","language","reverseMode"],t=this,r=n.reduce(function(o,A){return t.options[A]&&(["countries","types","language"].indexOf(A)>-1?o[A]=t.options[A].split(/[\s,]+/):o[A]=t.options[A],A==="proximity"&&t.options[A]&&typeof t.options[A].longitude=="number"&&typeof t.options[A].latitude=="number"&&(o[A]=[t.options[A].longitude,t.options[A].latitude])),o},{});return r},_geocode:function(n,t,r){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:n}),this.inputString=n;var o=null,A=this._getConfigForRequest(),s;if(this.options.localGeocoderOnly)s=Promise.resolve();else if(this.options.reverseGeocode&&/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(n)){var d=n.split(/[\s(,)?]+/).map(function(_){return parseFloat(_,10)}).reverse();A.types&&A.types[0],A=ha(A,{query:d,limit:1}),"proximity"in A&&delete A.proximity,s=this.geocoderApi.reverseGeocode(A)}else A=ha(A,{query:n}),this.geocoderApi.getSuggestions?t?this.geocoderApi.searchByPlaceId&&r?s=this.geocoderApi.searchByPlaceId(A):s=this.geocoderApi.forwardGeocode(A):s=this.geocoderApi.getSuggestions(A):s=this.geocoderApi.forwardGeocode(A);var f=[];this.options.localGeocoder&&(f=this.options.localGeocoder(n),f||(f=[]));var I=[];return s.catch(function(_){o=_}.bind(this)).then(function(_){this._loadingEl.style.display="none";var S={};return _?S=_:S={type:"FeatureCollection",features:[]},S.config=A,this.fresh&&(this.fresh=!1),S.features=S.features?f.concat(S.features):f,this.options.externalGeocoder?(I=this.options.externalGeocoder(n,S.features,A)||[],I.then(function(U){return S.features=S.features?U.concat(S.features):U,S},function(){return S})):S}.bind(this)).then(function(_){if(o)throw o;this.options.filter&&_.features.length&&(_.features=_.features.filter(this.options.filter));var S=[];_.suggestions?S=_.suggestions:_.place?S=[_.place]:S=_.features,S.length?(this._clearEl.style.display="block",this._typeahead.update(S),(!this.options.showResultsWhileTyping||t)&&this.options.showResultMarkers&&(_.features.length>0||_.place)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",_)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",_))}.bind(this)).catch(function(_){this._loadingEl.style.display="none",f.length&&this.options.localGeocoder||I.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(f)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:f}),this._eventEmitter.emit("error",{error:_})}.bind(this)),s},_clear:function(n){n&&n.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(n){this._clear(n),this._inputEl.focus()},_clearOnBlur:function(n){var t=this;n.relatedTarget&&t._clear(n)},_onQueryResult:function(n){var t=n;if(!!t.features.length){var r=t.features[0];this._typeahead.selected=r,this._inputEl.value=r.place_name,this._onChange()}},_updateProximity:function(){if(!!this._map)if(this._map.getZoom()>9){var n=this._map.getCenter().wrap();this.setProximity({longitude:n.lng,latitude:n.lat})}else this.setProximity(null)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},query:function(n){return this._geocode(n).then(this._onQueryResult),this},_renderError:function(){var n="<div class='mapbox-gl-geocoder--error maplibre-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(n)},_renderNoResults:function(){var n="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>No results found</div>";this._renderMessage(n)},_renderMessage:function(n){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(n)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var n=this.options.language.split(",")[0],t=T3.language(n),r=E3.placeholder[t];if(r)return r}return"Search"},_fitBoundsForMarkers:function(){if(!(this._typeahead.data.length<1)){var n=this._typeahead.data.filter(function(A){return typeof A!="string"}).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){var t={padding:100},r=ha({},t,this.options.flyTo),o=new this._maplibregl.LngLatBounds;n.forEach(function(A){o.extend(A.geometry.coordinates)}),this._map.fitBounds(o.toArray(),r)}return n.length>0&&this._maplibregl&&this._handleResultMarkers(n),this}},setInput:function(n){return this._inputEl.value=n,this._typeahead.selected=null,this._typeahead.clear(),n.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(n),this},setProximity:function(n){return this.options.proximity=n,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(n){return n&&typeof n=="function"&&(this._typeahead.render=n),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(n){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=n||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(n){return this.options.zoom=n,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(n){return this.options.flyTo=n,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(n){return this.placeholder=n||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(n){return this.options.bbox=n,this},getCountries:function(){return this.options.countries},setCountries:function(n){return this.options.countries=n,this},getTypes:function(){return this.options.types},setTypes:function(n){return this.options.types=n,this},getMinLength:function(){return this.options.minLength},setMinLength:function(n){return this.options.minLength=n,this._typeahead&&(this._typeahead.options.minLength=n),this},getLimit:function(){return this.options.limit},setLimit:function(n){return this.options.limit=n,this._typeahead&&(this._typeahead.options.limit=n),this},getFilter:function(){return this.options.filter},setFilter:function(n){return this.options.filter=n,this},setGeocoderApi:function(n){return this.geocoderApi=n,this},getGeocoderApi:function(){return this.geocoderApi},_handleMarker:function(n){if(!!this._map){this._removeMarker();var t={color:"#4668F2"},r=ha({},t,this.options.marker);this.mapMarker=new this._maplibregl.Marker(r);var o;if(this.options.popup){var A={},s=ha({},A,this.options.popup);o=new this._maplibregl.Popup(s).setHTML(this.options.popupRender(n))}return n.center?(this.mapMarker.setLngLat(n.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)):n.geometry&&n.geometry.type&&n.geometry.type==="Point"&&n.geometry.coordinates&&(this.mapMarker.setLngLat(n.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},_handleResultMarkers:function(n){if(!!this._map){this._removeResultMarkers();var t={color:"#4668F2"},r=ha({},t,this.options.showResultMarkers);return n.forEach(function(o){if(this.options.showResultMarkers&&this.options.showResultMarkers.element){var A=this.options.showResultMarkers.element.cloneNode(!0);r=ha(r,{element:A})}var s=new this._maplibregl.Marker(ha({},r,{element:A})),d;if(this.options.popup){var f={},I=ha({},f,this.options.popup);d=new this._maplibregl.Popup(I).setHTML(this.options.popupRender(o))}o.center?(s.setLngLat(o.center).addTo(this._map),this.options.popup&&s.setPopup(d)):o.geometry&&o.geometry.type&&o.geometry.type==="Point"&&o.geometry.coordinates&&(s.setLngLat(o.geometry.coordinates).addTo(this._map),this.options.popup&&s.setPopup(d)),this.resultMarkers.push(s)}.bind(this)),this}},_removeResultMarkers:function(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(n){n.remove()}),this.resultMarkers=[])},on:function(n,t){return this._eventEmitter.on(n,t),this},off:function(n,t){return this._eventEmitter.removeListener(n,t),this}};av.exports=ov});var h2={};tC(h2,{default:()=>eU});function nA(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");FC(n,t);function r(){this.constructor=n}n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function wo(n,t,r,o){function A(s){return s instanceof r?s:new r(function(d){d(s)})}return new(r||(r=Promise))(function(s,d){function f(S){try{_(o.next(S))}catch(U){d(U)}}function I(S){try{_(o.throw(S))}catch(U){d(U)}}function _(S){S.done?s(S.value):A(S.value).then(f,I)}_((o=o.apply(n,t||[])).next())})}function Ys(n,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,A,s,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(_){return function(S){return I([_,S])}}function I(_){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,A&&(s=_[0]&2?A.return:_[0]?A.throw||((s=A.return)&&s.call(A),0):A.next)&&!(s=s.call(A,_[1])).done)return s;switch(A=0,s&&(_=[_[0]&2,s.value]),_[0]){case 0:case 1:s=_;break;case 4:return r.label++,{value:_[1],done:!1};case 5:r.label++,A=_[1],_=[0];continue;case 7:_=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(_[0]===6||_[0]===2)){r=0;continue}if(_[0]===3&&(!s||_[1]>s[0]&&_[1]<s[3])){r.label=_[1];break}if(_[0]===6&&r.label<s[1]){r.label=s[1],s=_;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(_);break}s[2]&&r.ops.pop(),r.trys.pop();continue}_=t.call(n,r)}catch(S){_=[6,S],A=0}finally{o=s=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}}function Ld(n,t,r){if(r||arguments.length===2)for(var o=0,A=t.length,s;o<A;o++)(s||!(o in t))&&(s||(s=Array.prototype.slice.call(t,0,o)),s[o]=t[o]);return n.concat(s||t)}function pC(n,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-n)*r*6+n:r<1/2?t:r<2/3?(t-n)*6*(2/3-r)+n:n}function Uk(n){return!(n.type===20&&n.value==="none")&&(n.type!==18||!!Mw[n.name])}var FC,kC,_l,Ap,U3,lp,Gn,lv,Q3,Oh,cv,eg,Wh,R3,G3,Z3,Mc,jC,AC,P3,lw,H3,lC,M3,N3,V3,D3,K3,z3,O3,W3,uv,J3,X3,Y3,hv,j3,Jh,q3,gv,$3,cw,uw,t4,e4,dv,hw,pv,ic,LC,fv,EC,i4,ig,TC,Ed,Xh,r4,mv,UC,Yh,cC,Uu,ga,rg,ng,Qu,n4,Nu,s4,Td,Ud,QC,RC,GC,gg,ZC,Jd,Xd,uC,gw,o4,a4,dw,vo,Qd,PC,vl,HC,pw,Cv,A4,Iv,l4,c4,hC,yv,u4,h4,g4,d4,p4,f4,fg,bv,qd,vv,Ag,m4,C4,Rd,jh,I4,y4,b4,Gd,Zd,qh,v4,No,w4,B4,_4,x4,S4,F4,k4,L4,Pd,E4,wv,T4,U4,Bv,gC,Pc,Q4,R4,G4,dg,Z4,P4,H4,M4,N4,V4,zA,fw,mw,Cw,D4,K4,z4,Iw,yw,bw,O4,W4,Bo,J4,Ru,X4,Y4,j4,q4,Hd,$d,_v,$4,ec,Md,dC,tk,ek,ik,rk,nk,sk,ok,ak,Ak,lk,ck,uk,Nd,hk,gk,dk,pk,fk,mk,Ck,Ik,MC,vw,ww,mg,zu,jr,yk,NC,Bw,Ku,OA,bk,ac,Yn,_w,Us,qC,rc,sg,un,xw,Sw,Fw,kw,cp,Lw,Ew,Za,sc,oc,ds,nc,xv,Sv,Fv,vk,lg,Bl,wk,Bk,up,kv,_k,xk,rA,Lv,Sk,Fk,Vd,kk,Tw,Uw,Qw,Rw,Gw,Zw,Pw,Hw,Lk,Dd,Ek,Tk,$C,Mw,Qk,Rk,Gk,Zk,Pk,Du,Hk,Mk,hp,Nk,Vk,Dk,Kk,gp,zk,Ok,Wk,Jk,dp,Xk,Yk,jk,qk,pp,$k,tL,eL,iL,rL,nL,sL,oL,aL,AL,tp,lL,cL,Ev,uL,hL,VC,fp,gL,dL,pL,fL,mL,CL,mp,IL,yL,bL,vL,wL,BL,_L,xL,SL,FL,kL,LL,Tv,EL,TL,UL,cg,QL,RL,Nw,GL,ZL,PL,HL,ML,NL,VL,DL,rs,KL,zL,OL,WL,JL,Uv,XL,YL,jL,qL,$L,tE,Qv,Bi,eE,iE,DC,WA,rE,Rv,og,$h,nE,sE,oE,Nc,t0,fC,aE,Vw,AE,mC,lE,cE,uE,hE,gE,dE,pE,fE,Gv,mE,CE,IE,Zv,yE,tg,bE,CC,IC,Pv,Hv,vE,Mv,yC,bC,Nv,Vv,Dv,Kv,vC,wE,BE,_E,Hc,zv,xE,SE,FE,kE,LE,EE,TE,UE,QE,Ov,RE,KC,Wv,Ts,ug,GE,ZE,Jv,e0,PE,HE,ME,NE,VE,DE,KE,zE,Dw,Kw,zw,Ow,zC,OE,WE,JE,XE,ep,ip,YE,Xv,i0,Ww,Jw,Xw,jE,Yd,Yw,jw,qE,$E,qw,Vu,OC,jd,tT,eT,iT,rT,$w,r0,t2,Yv,WC,e2,jv,nT,rp,np,i2,qv,sT,$v,tw,oT,aT,Gu,r2,Rn,Zc,Hu,$l,tc,ag,wl,ew,iw,rw,wC,pg,n2,nw,hg,AT,lT,cT,uT,hT,BC,gT,dT,pT,fT,mT,JC,XC,sw,CT,IT,s2,yT,bT,vT,wT,BT,_C,_T,xC,xT,fi,Zu,Kd,Ga,ST,Kr,Cn,sp,FT,op,kT,zd,LT,ET,o2,TT,ow,UT,a2,A2,YC,l2,QT,aw,RT,GT,ZT,Od,Pa,c2,ap,PT,HT,SC,Pu,Wd,MT,Mu,NT,VT,Aw,DT,u2,KT,zT,OT,WT,JT,XT,YT,jT,qT,$T,tU,eU,iU,rU,g2=wd(()=>{FC=function(n,t){return FC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var A in o)Object.prototype.hasOwnProperty.call(o,A)&&(r[A]=o[A])},FC(n,t)};kC=function(){return kC=Object.assign||function(n){for(var t,r=1,o=arguments.length;r<o;r++){t=arguments[r];for(var A in t)Object.prototype.hasOwnProperty.call(t,A)&&(n[A]=t[A])}return n},kC.apply(this,arguments)};_l=function(){function n(t,r,o,A){this.left=t,this.top=r,this.width=o,this.height=A}return n.prototype.add=function(t,r,o,A){return new n(this.left+t,this.top+r,this.width+o,this.height+A)},n.fromClientRect=function(t,r){return new n(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},n.fromDOMRectList=function(t,r){var o=Array.from(r).find(function(A){return A.width!==0});return o?new n(o.left+t.windowBounds.left,o.top+t.windowBounds.top,o.width,o.height):n.EMPTY},n.EMPTY=new n(0,0,0,0),n}(),Ap=function(n,t){return _l.fromClientRect(n,t.getBoundingClientRect())},U3=function(n){var t=n.body,r=n.documentElement;if(!t||!r)throw new Error("Unable to get document size");var o=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),A=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new _l(0,0,o,A)},lp=function(n){for(var t=[],r=0,o=n.length;r<o;){var A=n.charCodeAt(r++);if(A>=55296&&A<=56319&&r<o){var s=n.charCodeAt(r++);(s&64512)===56320?t.push(((A&1023)<<10)+(s&1023)+65536):(t.push(A),r--)}else t.push(A)}return t},Gn=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var r=n.length;if(!r)return"";for(var o=[],A=-1,s="";++A<r;){var d=n[A];d<=65535?o.push(d):(d-=65536,o.push((d>>10)+55296,d%1024+56320)),(A+1===r||o.length>16384)&&(s+=String.fromCharCode.apply(String,o),o.length=0)}return s},lv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q3=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Oh=0;Oh<lv.length;Oh++)Q3[lv.charCodeAt(Oh)]=Oh;cv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",eg=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Wh=0;Wh<cv.length;Wh++)eg[cv.charCodeAt(Wh)]=Wh;R3=function(n){var t=n.length*.75,r=n.length,o,A=0,s,d,f,I;n[n.length-1]==="="&&(t--,n[n.length-2]==="="&&t--);var _=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),S=Array.isArray(_)?_:new Uint8Array(_);for(o=0;o<r;o+=4)s=eg[n.charCodeAt(o)],d=eg[n.charCodeAt(o+1)],f=eg[n.charCodeAt(o+2)],I=eg[n.charCodeAt(o+3)],S[A++]=s<<2|d>>4,S[A++]=(d&15)<<4|f>>2,S[A++]=(f&3)<<6|I&63;return _},G3=function(n){for(var t=n.length,r=[],o=0;o<t;o+=2)r.push(n[o+1]<<8|n[o]);return r},Z3=function(n){for(var t=n.length,r=[],o=0;o<t;o+=4)r.push(n[o+3]<<24|n[o+2]<<16|n[o+1]<<8|n[o]);return r},Mc=5,jC=11,AC=2,P3=jC-Mc,lw=65536>>Mc,H3=1<<Mc,lC=H3-1,M3=1024>>Mc,N3=lw+M3,V3=N3,D3=32,K3=V3+D3,z3=65536>>jC,O3=1<<P3,W3=O3-1,uv=function(n,t,r){return n.slice?n.slice(t,r):new Uint16Array(Array.prototype.slice.call(n,t,r))},J3=function(n,t,r){return n.slice?n.slice(t,r):new Uint32Array(Array.prototype.slice.call(n,t,r))},X3=function(n,t){var r=R3(n),o=Array.isArray(r)?Z3(r):new Uint32Array(r),A=Array.isArray(r)?G3(r):new Uint16Array(r),s=24,d=uv(A,s/2,o[4]/2),f=o[5]===2?uv(A,(s+o[4])/2):J3(o,Math.ceil((s+o[4])/4));return new Y3(o[0],o[1],o[2],o[3],d,f)},Y3=function(){function n(t,r,o,A,s,d){this.initialValue=t,this.errorValue=r,this.highStart=o,this.highValueIndex=A,this.index=s,this.data=d}return n.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Mc],r=(r<<AC)+(t&lC),this.data[r];if(t<=65535)return r=this.index[lw+(t-55296>>Mc)],r=(r<<AC)+(t&lC),this.data[r];if(t<this.highStart)return r=K3-z3+(t>>jC),r=this.index[r],r+=t>>Mc&W3,r=this.index[r],r=(r<<AC)+(t&lC),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n}(),hv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",j3=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Jh=0;Jh<hv.length;Jh++)j3[hv.charCodeAt(Jh)]=Jh;q3="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",gv=50,$3=1,cw=2,uw=3,t4=4,e4=5,dv=7,hw=8,pv=9,ic=10,LC=11,fv=12,EC=13,i4=14,ig=15,TC=16,Ed=17,Xh=18,r4=19,mv=20,UC=21,Yh=22,cC=23,Uu=24,ga=25,rg=26,ng=27,Qu=28,n4=29,Nu=30,s4=31,Td=32,Ud=33,QC=34,RC=35,GC=36,gg=37,ZC=38,Jd=39,Xd=40,uC=41,gw=42,o4=43,a4=[9001,65288],dw="!",vo="\xD7",Qd="\xF7",PC=X3(q3),vl=[Nu,GC],HC=[$3,cw,uw,e4],pw=[ic,hw],Cv=[ng,rg],A4=HC.concat(pw),Iv=[ZC,Jd,Xd,QC,RC],l4=[ig,EC],c4=function(n,t){t===void 0&&(t="strict");var r=[],o=[],A=[];return n.forEach(function(s,d){var f=PC.get(s);if(f>gv?(A.push(!0),f-=gv):A.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return o.push(d),r.push(TC);if(f===t4||f===LC){if(d===0)return o.push(d),r.push(Nu);var I=r[d-1];return A4.indexOf(I)===-1?(o.push(o[d-1]),r.push(I)):(o.push(d),r.push(Nu))}if(o.push(d),f===s4)return r.push(t==="strict"?UC:gg);if(f===gw||f===n4)return r.push(Nu);if(f===o4)return s>=131072&&s<=196605||s>=196608&&s<=262141?r.push(gg):r.push(Nu);r.push(f)}),[o,r,A]},hC=function(n,t,r,o){var A=o[r];if(Array.isArray(n)?n.indexOf(A)!==-1:n===A)for(var s=r;s<=o.length;){s++;var d=o[s];if(d===t)return!0;if(d!==ic)break}if(A===ic)for(var s=r;s>0;){s--;var f=o[s];if(Array.isArray(n)?n.indexOf(f)!==-1:n===f)for(var I=r;I<=o.length;){I++;var d=o[I];if(d===t)return!0;if(d!==ic)break}if(f!==ic)break}return!1},yv=function(n,t){for(var r=n;r>=0;){var o=t[r];if(o===ic)r--;else return o}return 0},u4=function(n,t,r,o,A){if(r[o]===0)return vo;var s=o-1;if(Array.isArray(A)&&A[s]===!0)return vo;var d=s-1,f=s+1,I=t[s],_=d>=0?t[d]:0,S=t[f];if(I===cw&&S===uw)return vo;if(HC.indexOf(I)!==-1)return dw;if(HC.indexOf(S)!==-1||pw.indexOf(S)!==-1)return vo;if(yv(s,t)===hw)return Qd;if(PC.get(n[s])===LC||(I===Td||I===Ud)&&PC.get(n[f])===LC||I===dv||S===dv||I===pv||[ic,EC,ig].indexOf(I)===-1&&S===pv||[Ed,Xh,r4,Uu,Qu].indexOf(S)!==-1||yv(s,t)===Yh||hC(cC,Yh,s,t)||hC([Ed,Xh],UC,s,t)||hC(fv,fv,s,t))return vo;if(I===ic)return Qd;if(I===cC||S===cC)return vo;if(S===TC||I===TC)return Qd;if([EC,ig,UC].indexOf(S)!==-1||I===i4||_===GC&&l4.indexOf(I)!==-1||I===Qu&&S===GC||S===mv||vl.indexOf(S)!==-1&&I===ga||vl.indexOf(I)!==-1&&S===ga||I===ng&&[gg,Td,Ud].indexOf(S)!==-1||[gg,Td,Ud].indexOf(I)!==-1&&S===rg||vl.indexOf(I)!==-1&&Cv.indexOf(S)!==-1||Cv.indexOf(I)!==-1&&vl.indexOf(S)!==-1||[ng,rg].indexOf(I)!==-1&&(S===ga||[Yh,ig].indexOf(S)!==-1&&t[f+1]===ga)||[Yh,ig].indexOf(I)!==-1&&S===ga||I===ga&&[ga,Qu,Uu].indexOf(S)!==-1)return vo;if([ga,Qu,Uu,Ed,Xh].indexOf(S)!==-1)for(var U=s;U>=0;){var G=t[U];if(G===ga)return vo;if([Qu,Uu].indexOf(G)!==-1)U--;else break}if([ng,rg].indexOf(S)!==-1)for(var U=[Ed,Xh].indexOf(I)!==-1?d:s;U>=0;){var G=t[U];if(G===ga)return vo;if([Qu,Uu].indexOf(G)!==-1)U--;else break}if(ZC===I&&[ZC,Jd,QC,RC].indexOf(S)!==-1||[Jd,QC].indexOf(I)!==-1&&[Jd,Xd].indexOf(S)!==-1||[Xd,RC].indexOf(I)!==-1&&S===Xd||Iv.indexOf(I)!==-1&&[mv,rg].indexOf(S)!==-1||Iv.indexOf(S)!==-1&&I===ng||vl.indexOf(I)!==-1&&vl.indexOf(S)!==-1||I===Uu&&vl.indexOf(S)!==-1||vl.concat(ga).indexOf(I)!==-1&&S===Yh&&a4.indexOf(n[f])===-1||vl.concat(ga).indexOf(S)!==-1&&I===Xh)return vo;if(I===uC&&S===uC){for(var L=r[s],K=1;L>0&&(L--,t[L]===uC);)K++;if(K%2!==0)return vo}return I===Td&&S===Ud?vo:Qd},h4=function(n,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=c4(n,t.lineBreak),o=r[0],A=r[1],s=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(A=A.map(function(f){return[ga,Nu,gw].indexOf(f)!==-1?gg:f}));var d=t.wordBreak==="keep-all"?s.map(function(f,I){return f&&n[I]>=19968&&n[I]<=40959}):void 0;return[o,A,d]},g4=function(){function n(t,r,o,A){this.codePoints=t,this.required=r===dw,this.start=o,this.end=A}return n.prototype.slice=function(){return Gn.apply(void 0,this.codePoints.slice(this.start,this.end))},n}(),d4=function(n,t){var r=lp(n),o=h4(r,t),A=o[0],s=o[1],d=o[2],f=r.length,I=0,_=0;return{next:function(){if(_>=f)return{done:!0,value:null};for(var S=vo;_<f&&(S=u4(r,s,A,++_,d))===vo;);if(S!==vo||_===f){var U=new g4(r,S,I,_);return I=_,{value:U,done:!1}}return{done:!0,value:null}}}},p4=1,f4=2,fg=4,bv=8,qd=10,vv=47,Ag=92,m4=9,C4=32,Rd=34,jh=61,I4=35,y4=36,b4=37,Gd=39,Zd=40,qh=41,v4=95,No=45,w4=33,B4=60,_4=62,x4=64,S4=91,F4=93,k4=61,L4=123,Pd=63,E4=125,wv=124,T4=126,U4=128,Bv=65533,gC=42,Pc=43,Q4=44,R4=58,G4=59,dg=46,Z4=0,P4=8,H4=11,M4=14,N4=31,V4=127,zA=-1,fw=48,mw=97,Cw=101,D4=102,K4=117,z4=122,Iw=65,yw=69,bw=70,O4=85,W4=90,Bo=function(n){return n>=fw&&n<=57},J4=function(n){return n>=55296&&n<=57343},Ru=function(n){return Bo(n)||n>=Iw&&n<=bw||n>=mw&&n<=D4},X4=function(n){return n>=mw&&n<=z4},Y4=function(n){return n>=Iw&&n<=W4},j4=function(n){return X4(n)||Y4(n)},q4=function(n){return n>=U4},Hd=function(n){return n===qd||n===m4||n===C4},$d=function(n){return j4(n)||q4(n)||n===v4},_v=function(n){return $d(n)||Bo(n)||n===No},$4=function(n){return n>=Z4&&n<=P4||n===H4||n>=M4&&n<=N4||n===V4},ec=function(n,t){return n!==Ag?!1:t!==qd},Md=function(n,t,r){return n===No?$d(t)||ec(t,r):$d(n)?!0:!!(n===Ag&&ec(n,t))},dC=function(n,t,r){return n===Pc||n===No?Bo(t)?!0:t===dg&&Bo(r):Bo(n===dg?t:n)},tk=function(n){var t=0,r=1;(n[t]===Pc||n[t]===No)&&(n[t]===No&&(r=-1),t++);for(var o=[];Bo(n[t]);)o.push(n[t++]);var A=o.length?parseInt(Gn.apply(void 0,o),10):0;n[t]===dg&&t++;for(var s=[];Bo(n[t]);)s.push(n[t++]);var d=s.length,f=d?parseInt(Gn.apply(void 0,s),10):0;(n[t]===yw||n[t]===Cw)&&t++;var I=1;(n[t]===Pc||n[t]===No)&&(n[t]===No&&(I=-1),t++);for(var _=[];Bo(n[t]);)_.push(n[t++]);var S=_.length?parseInt(Gn.apply(void 0,_),10):0;return r*(A+f*Math.pow(10,-d))*Math.pow(10,I*S)},ek={type:2},ik={type:3},rk={type:4},nk={type:13},sk={type:8},ok={type:21},ak={type:9},Ak={type:10},lk={type:11},ck={type:12},uk={type:14},Nd={type:23},hk={type:1},gk={type:25},dk={type:24},pk={type:26},fk={type:27},mk={type:28},Ck={type:29},Ik={type:31},MC={type:32},vw=function(){function n(){this._value=[]}return n.prototype.write=function(t){this._value=this._value.concat(lp(t))},n.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==MC;)t.push(r),r=this.consumeToken();return t},n.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case Rd:return this.consumeStringToken(Rd);case I4:var r=this.peekCodePoint(0),o=this.peekCodePoint(1),A=this.peekCodePoint(2);if(_v(r)||ec(o,A)){var s=Md(r,o,A)?f4:p4,d=this.consumeName();return{type:5,value:d,flags:s}}break;case y4:if(this.peekCodePoint(0)===jh)return this.consumeCodePoint(),nk;break;case Gd:return this.consumeStringToken(Gd);case Zd:return ek;case qh:return ik;case gC:if(this.peekCodePoint(0)===jh)return this.consumeCodePoint(),uk;break;case Pc:if(dC(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case Q4:return rk;case No:var f=t,I=this.peekCodePoint(0),_=this.peekCodePoint(1);if(dC(f,I,_))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Md(f,I,_))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(I===No&&_===_4)return this.consumeCodePoint(),this.consumeCodePoint(),dk;break;case dg:if(dC(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case vv:if(this.peekCodePoint(0)===gC)for(this.consumeCodePoint();;){var S=this.consumeCodePoint();if(S===gC&&(S=this.consumeCodePoint(),S===vv))return this.consumeToken();if(S===zA)return this.consumeToken()}break;case R4:return pk;case G4:return fk;case B4:if(this.peekCodePoint(0)===w4&&this.peekCodePoint(1)===No&&this.peekCodePoint(2)===No)return this.consumeCodePoint(),this.consumeCodePoint(),gk;break;case x4:var U=this.peekCodePoint(0),G=this.peekCodePoint(1),L=this.peekCodePoint(2);if(Md(U,G,L)){var d=this.consumeName();return{type:7,value:d}}break;case S4:return mk;case Ag:if(ec(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case F4:return Ck;case k4:if(this.peekCodePoint(0)===jh)return this.consumeCodePoint(),sk;break;case L4:return lk;case E4:return ck;case K4:case O4:var K=this.peekCodePoint(0),V=this.peekCodePoint(1);return K===Pc&&(Ru(V)||V===Pd)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case wv:if(this.peekCodePoint(0)===jh)return this.consumeCodePoint(),ak;if(this.peekCodePoint(0)===wv)return this.consumeCodePoint(),ok;break;case T4:if(this.peekCodePoint(0)===jh)return this.consumeCodePoint(),Ak;break;case zA:return MC}return Hd(t)?(this.consumeWhiteSpace(),Ik):Bo(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):$d(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Gn(t)}},n.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},n.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},n.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},n.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Ru(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var o=!1;r===Pd&&t.length<6;)t.push(r),r=this.consumeCodePoint(),o=!0;if(o){var A=parseInt(Gn.apply(void 0,t.map(function(I){return I===Pd?fw:I})),16),s=parseInt(Gn.apply(void 0,t.map(function(I){return I===Pd?bw:I})),16);return{type:30,start:A,end:s}}var d=parseInt(Gn.apply(void 0,t),16);if(this.peekCodePoint(0)===No&&Ru(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var f=[];Ru(r)&&f.length<6;)f.push(r),r=this.consumeCodePoint();var s=parseInt(Gn.apply(void 0,f),16);return{type:30,start:d,end:s}}else return{type:30,start:d,end:d}},n.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===Zd?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Zd?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},n.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===zA)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Gd||r===Rd){var o=this.consumeStringToken(this.consumeCodePoint());return o.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===zA||this.peekCodePoint(0)===qh)?(this.consumeCodePoint(),{type:22,value:o.value}):(this.consumeBadUrlRemnants(),Nd)}for(;;){var A=this.consumeCodePoint();if(A===zA||A===qh)return{type:22,value:Gn.apply(void 0,t)};if(Hd(A))return this.consumeWhiteSpace(),this.peekCodePoint(0)===zA||this.peekCodePoint(0)===qh?(this.consumeCodePoint(),{type:22,value:Gn.apply(void 0,t)}):(this.consumeBadUrlRemnants(),Nd);if(A===Rd||A===Gd||A===Zd||$4(A))return this.consumeBadUrlRemnants(),Nd;if(A===Ag)if(ec(A,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Nd;else t.push(A)}},n.prototype.consumeWhiteSpace=function(){for(;Hd(this.peekCodePoint(0));)this.consumeCodePoint()},n.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===qh||t===zA)return;ec(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},n.prototype.consumeStringSlice=function(t){for(var r=5e4,o="";t>0;){var A=Math.min(r,t);o+=Gn.apply(void 0,this._value.splice(0,A)),t-=A}return this._value.shift(),o},n.prototype.consumeStringToken=function(t){var r="",o=0;do{var A=this._value[o];if(A===zA||A===void 0||A===t)return r+=this.consumeStringSlice(o),{type:0,value:r};if(A===qd)return this._value.splice(0,o),hk;if(A===Ag){var s=this._value[o+1];s!==zA&&s!==void 0&&(s===qd?(r+=this.consumeStringSlice(o),o=-1,this._value.shift()):ec(A,s)&&(r+=this.consumeStringSlice(o),r+=Gn(this.consumeEscapedCodePoint()),o=-1))}o++}while(!0)},n.prototype.consumeNumber=function(){var t=[],r=fg,o=this.peekCodePoint(0);for((o===Pc||o===No)&&t.push(this.consumeCodePoint());Bo(this.peekCodePoint(0));)t.push(this.consumeCodePoint());o=this.peekCodePoint(0);var A=this.peekCodePoint(1);if(o===dg&&Bo(A))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=bv;Bo(this.peekCodePoint(0));)t.push(this.consumeCodePoint());o=this.peekCodePoint(0),A=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((o===yw||o===Cw)&&((A===Pc||A===No)&&Bo(s)||Bo(A)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=bv;Bo(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[tk(t),r]},n.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],o=t[1],A=this.peekCodePoint(0),s=this.peekCodePoint(1),d=this.peekCodePoint(2);if(Md(A,s,d)){var f=this.consumeName();return{type:15,number:r,flags:o,unit:f}}return A===b4?(this.consumeCodePoint(),{type:16,number:r,flags:o}):{type:17,number:r,flags:o}},n.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Ru(t)){for(var r=Gn(t);Ru(this.peekCodePoint(0))&&r.length<6;)r+=Gn(this.consumeCodePoint());Hd(this.peekCodePoint(0))&&this.consumeCodePoint();var o=parseInt(r,16);return o===0||J4(o)||o>1114111?Bv:o}return t===zA?Bv:t},n.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(_v(r))t+=Gn(r);else if(ec(r,this.peekCodePoint(0)))t+=Gn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},n}(),ww=function(){function n(t){this._tokens=t}return n.create=function(t){var r=new vw;return r.write(t),new n(r.read())},n.parseValue=function(t){return n.create(t).parseComponentValue()},n.parseValues=function(t){return n.create(t).parseComponentValues()},n.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},n.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},n.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},n.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},o=this.consumeToken();;){if(o.type===32||bk(o,t))return r;this.reconsumeToken(o),r.values.push(this.consumeComponentValue()),o=this.consumeToken()}},n.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var o=this.consumeToken();if(o.type===32||o.type===3)return r;this.reconsumeToken(o),r.values.push(this.consumeComponentValue())}},n.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?MC:t},n.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},n}(),mg=function(n){return n.type===15},zu=function(n){return n.type===17},jr=function(n){return n.type===20},yk=function(n){return n.type===0},NC=function(n,t){return jr(n)&&n.value===t},Bw=function(n){return n.type!==31},Ku=function(n){return n.type!==31&&n.type!==4},OA=function(n){var t=[],r=[];return n.forEach(function(o){if(o.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}o.type!==31&&r.push(o)}),r.length&&t.push(r),t},bk=function(n,t){return t===11&&n.type===12||t===28&&n.type===29?!0:t===2&&n.type===3},ac=function(n){return n.type===17||n.type===15},Yn=function(n){return n.type===16||ac(n)},_w=function(n){return n.length>1?[n[0],n[1]]:[n[0]]},Us={type:17,number:0,flags:fg},qC={type:16,number:50,flags:fg},rc={type:16,number:100,flags:fg},sg=function(n,t,r){var o=n[0],A=n[1];return[un(o,t),un(typeof A<"u"?A:o,r)]},un=function(n,t){if(n.type===16)return n.number/100*t;if(mg(n))switch(n.unit){case"rem":case"em":return 16*n.number;case"px":default:return n.number}return n.number},xw="deg",Sw="grad",Fw="rad",kw="turn",cp={name:"angle",parse:function(n,t){if(t.type===15)switch(t.unit){case xw:return Math.PI*t.number/180;case Sw:return Math.PI/200*t.number;case Fw:return t.number;case kw:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},Lw=function(n){return n.type===15&&(n.unit===xw||n.unit===Sw||n.unit===Fw||n.unit===kw)},Ew=function(n){var t=n.filter(jr).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Us,Us];case"to top":case"bottom":return Za(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Us,rc];case"to right":case"left":return Za(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[rc,rc];case"to bottom":case"top":return Za(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[rc,Us];case"to left":case"right":return Za(270)}return 0},Za=function(n){return Math.PI*n/180},sc={name:"color",parse:function(n,t){if(t.type===18){var r=vk[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(n,t.values)}if(t.type===5){if(t.value.length===3){var o=t.value.substring(0,1),A=t.value.substring(1,2),s=t.value.substring(2,3);return nc(parseInt(o+o,16),parseInt(A+A,16),parseInt(s+s,16),1)}if(t.value.length===4){var o=t.value.substring(0,1),A=t.value.substring(1,2),s=t.value.substring(2,3),d=t.value.substring(3,4);return nc(parseInt(o+o,16),parseInt(A+A,16),parseInt(s+s,16),parseInt(d+d,16)/255)}if(t.value.length===6){var o=t.value.substring(0,2),A=t.value.substring(2,4),s=t.value.substring(4,6);return nc(parseInt(o,16),parseInt(A,16),parseInt(s,16),1)}if(t.value.length===8){var o=t.value.substring(0,2),A=t.value.substring(2,4),s=t.value.substring(4,6),d=t.value.substring(6,8);return nc(parseInt(o,16),parseInt(A,16),parseInt(s,16),parseInt(d,16)/255)}}if(t.type===20){var f=Bl[t.value.toUpperCase()];if(typeof f<"u")return f}return Bl.TRANSPARENT}},oc=function(n){return(255&n)===0},ds=function(n){var t=255&n,r=255&n>>8,o=255&n>>16,A=255&n>>24;return t<255?"rgba("+A+","+o+","+r+","+t/255+")":"rgb("+A+","+o+","+r+")"},nc=function(n,t,r,o){return(n<<24|t<<16|r<<8|Math.round(o*255)<<0)>>>0},xv=function(n,t){if(n.type===17)return n.number;if(n.type===16){var r=t===3?1:255;return t===3?n.number/100*r:Math.round(n.number/100*r)}return 0},Sv=function(n,t){var r=t.filter(Ku);if(r.length===3){var o=r.map(xv),A=o[0],s=o[1],d=o[2];return nc(A,s,d,1)}if(r.length===4){var f=r.map(xv),A=f[0],s=f[1],d=f[2],I=f[3];return nc(A,s,d,I)}return 0};Fv=function(n,t){var r=t.filter(Ku),o=r[0],A=r[1],s=r[2],d=r[3],f=(o.type===17?Za(o.number):cp.parse(n,o))/(Math.PI*2),I=Yn(A)?A.number/100:0,_=Yn(s)?s.number/100:0,S=typeof d<"u"&&Yn(d)?un(d,1):1;if(I===0)return nc(_*255,_*255,_*255,1);var U=_<=.5?_*(I+1):_+I-_*I,G=_*2-U,L=pC(G,U,f+1/3),K=pC(G,U,f),V=pC(G,U,f-1/3);return nc(L*255,K*255,V*255,S)},vk={hsl:Fv,hsla:Fv,rgb:Sv,rgba:Sv},lg=function(n,t){return sc.parse(n,ww.create(t).parseComponentValue())},Bl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},wk={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(n,t){return t.map(function(r){if(jr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Bk={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},up=function(n,t){var r=sc.parse(n,t[0]),o=t[1];return o&&Yn(o)?{color:r,stop:o}:{color:r,stop:null}},kv=function(n,t){var r=n[0],o=n[n.length-1];r.stop===null&&(r.stop=Us),o.stop===null&&(o.stop=rc);for(var A=[],s=0,d=0;d<n.length;d++){var f=n[d].stop;if(f!==null){var I=un(f,t);I>s?A.push(I):A.push(s),s=I}else A.push(null)}for(var _=null,d=0;d<A.length;d++){var S=A[d];if(S===null)_===null&&(_=d);else if(_!==null){for(var U=d-_,G=A[_-1],L=(S-G)/(U+1),K=1;K<=U;K++)A[_+K-1]=L*K;_=null}}return n.map(function(V,q){var z=V.color;return{color:z,stop:Math.max(Math.min(1,A[q]/t),0)}})},_k=function(n,t,r){var o=t/2,A=r/2,s=un(n[0],t)-o,d=A-un(n[1],r);return(Math.atan2(d,s)+Math.PI*2)%(Math.PI*2)},xk=function(n,t,r){var o=typeof n=="number"?n:_k(n,t,r),A=Math.abs(t*Math.sin(o))+Math.abs(r*Math.cos(o)),s=t/2,d=r/2,f=A/2,I=Math.sin(o-Math.PI/2)*f,_=Math.cos(o-Math.PI/2)*f;return[A,s-_,s+_,d-I,d+I]},rA=function(n,t){return Math.sqrt(n*n+t*t)},Lv=function(n,t,r,o,A){var s=[[0,0],[0,t],[n,0],[n,t]];return s.reduce(function(d,f){var I=f[0],_=f[1],S=rA(r-I,o-_);return(A?S<d.optimumDistance:S>d.optimumDistance)?{optimumCorner:f,optimumDistance:S}:d},{optimumDistance:A?1/0:-1/0,optimumCorner:null}).optimumCorner},Sk=function(n,t,r,o,A){var s=0,d=0;switch(n.size){case 0:n.shape===0?s=d=Math.min(Math.abs(t),Math.abs(t-o),Math.abs(r),Math.abs(r-A)):n.shape===1&&(s=Math.min(Math.abs(t),Math.abs(t-o)),d=Math.min(Math.abs(r),Math.abs(r-A)));break;case 2:if(n.shape===0)s=d=Math.min(rA(t,r),rA(t,r-A),rA(t-o,r),rA(t-o,r-A));else if(n.shape===1){var f=Math.min(Math.abs(r),Math.abs(r-A))/Math.min(Math.abs(t),Math.abs(t-o)),I=Lv(o,A,t,r,!0),_=I[0],S=I[1];s=rA(_-t,(S-r)/f),d=f*s}break;case 1:n.shape===0?s=d=Math.max(Math.abs(t),Math.abs(t-o),Math.abs(r),Math.abs(r-A)):n.shape===1&&(s=Math.max(Math.abs(t),Math.abs(t-o)),d=Math.max(Math.abs(r),Math.abs(r-A)));break;case 3:if(n.shape===0)s=d=Math.max(rA(t,r),rA(t,r-A),rA(t-o,r),rA(t-o,r-A));else if(n.shape===1){var f=Math.max(Math.abs(r),Math.abs(r-A))/Math.max(Math.abs(t),Math.abs(t-o)),U=Lv(o,A,t,r,!1),_=U[0],S=U[1];s=rA(_-t,(S-r)/f),d=f*s}break}return Array.isArray(n.size)&&(s=un(n.size[0],o),d=n.size.length===2?un(n.size[1],A):s),[s,d]},Fk=function(n,t){var r=Za(180),o=[];return OA(t).forEach(function(A,s){if(s===0){var d=A[0];if(d.type===20&&d.value==="to"){r=Ew(A);return}else if(Lw(d)){r=cp.parse(n,d);return}}var f=up(n,A);o.push(f)}),{angle:r,stops:o,type:1}},Vd=function(n,t){var r=Za(180),o=[];return OA(t).forEach(function(A,s){if(s===0){var d=A[0];if(d.type===20&&["top","left","right","bottom"].indexOf(d.value)!==-1){r=Ew(A);return}else if(Lw(d)){r=(cp.parse(n,d)+Za(270))%Za(360);return}}var f=up(n,A);o.push(f)}),{angle:r,stops:o,type:1}},kk=function(n,t){var r=Za(180),o=[],A=1,s=0,d=3,f=[];return OA(t).forEach(function(I,_){var S=I[0];if(_===0){if(jr(S)&&S.value==="linear"){A=1;return}else if(jr(S)&&S.value==="radial"){A=2;return}}if(S.type===18){if(S.name==="from"){var U=sc.parse(n,S.values[0]);o.push({stop:Us,color:U})}else if(S.name==="to"){var U=sc.parse(n,S.values[0]);o.push({stop:rc,color:U})}else if(S.name==="color-stop"){var G=S.values.filter(Ku);if(G.length===2){var U=sc.parse(n,G[1]),L=G[0];zu(L)&&o.push({stop:{type:16,number:L.number*100,flags:L.flags},color:U})}}}}),A===1?{angle:(r+Za(180))%Za(360),stops:o,type:A}:{size:d,shape:s,stops:o,position:f,type:A}},Tw="closest-side",Uw="farthest-side",Qw="closest-corner",Rw="farthest-corner",Gw="circle",Zw="ellipse",Pw="cover",Hw="contain",Lk=function(n,t){var r=0,o=3,A=[],s=[];return OA(t).forEach(function(d,f){var I=!0;if(f===0){var _=!1;I=d.reduce(function(U,G){if(_)if(jr(G))switch(G.value){case"center":return s.push(qC),U;case"top":case"left":return s.push(Us),U;case"right":case"bottom":return s.push(rc),U}else(Yn(G)||ac(G))&&s.push(G);else if(jr(G))switch(G.value){case Gw:return r=0,!1;case Zw:return r=1,!1;case"at":return _=!0,!1;case Tw:return o=0,!1;case Pw:case Uw:return o=1,!1;case Hw:case Qw:return o=2,!1;case Rw:return o=3,!1}else if(ac(G)||Yn(G))return Array.isArray(o)||(o=[]),o.push(G),!1;return U},I)}if(I){var S=up(n,d);A.push(S)}}),{size:o,shape:r,stops:A,position:s,type:2}},Dd=function(n,t){var r=0,o=3,A=[],s=[];return OA(t).forEach(function(d,f){var I=!0;if(f===0?I=d.reduce(function(S,U){if(jr(U))switch(U.value){case"center":return s.push(qC),!1;case"top":case"left":return s.push(Us),!1;case"right":case"bottom":return s.push(rc),!1}else if(Yn(U)||ac(U))return s.push(U),!1;return S},I):f===1&&(I=d.reduce(function(S,U){if(jr(U))switch(U.value){case Gw:return r=0,!1;case Zw:return r=1,!1;case Hw:case Tw:return o=0,!1;case Uw:return o=1,!1;case Qw:return o=2,!1;case Pw:case Rw:return o=3,!1}else if(ac(U)||Yn(U))return Array.isArray(o)||(o=[]),o.push(U),!1;return S},I)),I){var _=up(n,d);A.push(_)}}),{size:o,shape:r,stops:A,position:s,type:2}},Ek=function(n){return n.type===1},Tk=function(n){return n.type===2},$C={name:"image",parse:function(n,t){if(t.type===22){var r={url:t.value,type:0};return n.cache.addImage(t.value),r}if(t.type===18){var o=Mw[t.name];if(typeof o>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return o(n,t.values)}throw new Error("Unsupported image type "+t.type)}};Mw={"linear-gradient":Fk,"-moz-linear-gradient":Vd,"-ms-linear-gradient":Vd,"-o-linear-gradient":Vd,"-webkit-linear-gradient":Vd,"radial-gradient":Lk,"-moz-radial-gradient":Dd,"-ms-radial-gradient":Dd,"-o-radial-gradient":Dd,"-webkit-radial-gradient":Dd,"-webkit-gradient":kk},Qk={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(n,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(o){return Ku(o)&&Uk(o)}).map(function(o){return $C.parse(n,o)})}},Rk={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(n,t){return t.map(function(r){if(jr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Gk={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(n,t){return OA(t).map(function(r){return r.filter(Yn)}).map(_w)}},Zk={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(n,t){return OA(t).map(function(r){return r.filter(jr).map(function(o){return o.value}).join(" ")}).map(Pk)}},Pk=function(n){switch(n){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}};(function(n){n.AUTO="auto",n.CONTAIN="contain",n.COVER="cover"})(Du||(Du={}));Hk={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(n,t){return OA(t).map(function(r){return r.filter(Mk)})}},Mk=function(n){return jr(n)||Yn(n)},hp=function(n){return{name:"border-"+n+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Nk=hp("top"),Vk=hp("right"),Dk=hp("bottom"),Kk=hp("left"),gp=function(n){return{name:"border-radius-"+n,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return _w(r.filter(Yn))}}},zk=gp("top-left"),Ok=gp("top-right"),Wk=gp("bottom-right"),Jk=gp("bottom-left"),dp=function(n){return{name:"border-"+n+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Xk=dp("top"),Yk=dp("right"),jk=dp("bottom"),qk=dp("left"),pp=function(n){return{name:"border-"+n+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return mg(r)?r.number:0}}},$k=pp("top"),tL=pp("right"),eL=pp("bottom"),iL=pp("left"),rL={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},nL={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(n,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},sL={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(n,t){return t.filter(jr).reduce(function(r,o){return r|oL(o.value)},0)}},oL=function(n){switch(n){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},aL={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(n,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},AL={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(n,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}};(function(n){n.NORMAL="normal",n.STRICT="strict"})(tp||(tp={}));lL={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,t){switch(t){case"strict":return tp.STRICT;case"normal":default:return tp.NORMAL}}},cL={name:"line-height",initialValue:"normal",prefix:!1,type:4},Ev=function(n,t){return jr(n)&&n.value==="normal"?1.2*t:n.type===17?t*n.number:Yn(n)?un(n,t):t},uL={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(n,t){return t.type===20&&t.value==="none"?null:$C.parse(n,t)}},hL={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(n,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},VC={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(n,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},fp=function(n){return{name:"margin-"+n,initialValue:"0",prefix:!1,type:4}},gL=fp("top"),dL=fp("right"),pL=fp("bottom"),fL=fp("left"),mL={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(n,t){return t.filter(jr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},CL={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(n,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},mp=function(n){return{name:"padding-"+n,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},IL=mp("top"),yL=mp("right"),bL=mp("bottom"),vL=mp("left"),wL={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(n,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},BL={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(n,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},_L={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,t){return t.length===1&&NC(t[0],"none")?[]:OA(t).map(function(r){for(var o={color:Bl.TRANSPARENT,offsetX:Us,offsetY:Us,blur:Us},A=0,s=0;s<r.length;s++){var d=r[s];ac(d)?(A===0?o.offsetX=d:A===1?o.offsetY=d:o.blur=d,A++):o.color=sc.parse(n,d)}return o})}},xL={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(n,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},SL={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(n,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=LL[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},FL=function(n){var t=n.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},kL=function(n){var t=n.filter(function(I){return I.type===17}).map(function(I){return I.number}),r=t[0],o=t[1];t[2],t[3];var A=t[4],s=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var d=t[12],f=t[13];return t[14],t[15],t.length===16?[r,o,A,s,d,f]:null},LL={matrix:FL,matrix3d:kL},Tv={type:16,number:50,flags:fg},EL=[Tv,Tv],TL={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(n,t){var r=t.filter(Yn);return r.length!==2?EL:[r[0],r[1]]}},UL={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(n,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}};(function(n){n.NORMAL="normal",n.BREAK_ALL="break-all",n.KEEP_ALL="keep-all"})(cg||(cg={}));QL={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,t){switch(t){case"break-all":return cg.BREAK_ALL;case"keep-all":return cg.KEEP_ALL;case"normal":default:return cg.NORMAL}}},RL={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(n,t){if(t.type===20)return{auto:!0,order:0};if(zu(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},Nw={name:"time",parse:function(n,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},GL={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(n,t){return zu(t)?t.number:1}},ZL={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},PL={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(n,t){return t.filter(jr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},HL={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(n,t){var r=[],o=[];return t.forEach(function(A){switch(A.type){case 20:case 0:r.push(A.value);break;case 17:r.push(A.number.toString());break;case 4:o.push(r.join(" ")),r.length=0;break}}),r.length&&o.push(r.join(" ")),o.map(function(A){return A.indexOf(" ")===-1?A:"'"+A+"'"})}},ML={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},NL={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(n,t){if(zu(t))return t.number;if(jr(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},VL={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(n,t){return t.filter(jr).map(function(r){return r.value})}},DL={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(n,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},rs=function(n,t){return(n&t)!==0},KL={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(n,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},zL={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(n,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var o=[],A=t.filter(Bw),s=0;s<A.length;s++){var d=A[s],f=A[s+1];if(d.type===20){var I=f&&zu(f)?f.number:1;o.push({counter:d.value,increment:I})}}return o}},OL={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(n,t){if(t.length===0)return[];for(var r=[],o=t.filter(Bw),A=0;A<o.length;A++){var s=o[A],d=o[A+1];if(jr(s)&&s.value!=="none"){var f=d&&zu(d)?d.number:0;r.push({counter:s.value,reset:f})}}return r}},WL={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(n,t){return t.filter(mg).map(function(r){return Nw.parse(n,r)})}},JL={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(n,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var o=[],A=t.filter(yk);if(A.length%2!==0)return null;for(var s=0;s<A.length;s+=2){var d=A[s].value,f=A[s+1].value;o.push({open:d,close:f})}return o}},Uv=function(n,t,r){if(!n)return"";var o=n[Math.min(t,n.length-1)];return o?r?o.open:o.close:""},XL={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,t){return t.length===1&&NC(t[0],"none")?[]:OA(t).map(function(r){for(var o={color:255,offsetX:Us,offsetY:Us,blur:Us,spread:Us,inset:!1},A=0,s=0;s<r.length;s++){var d=r[s];NC(d,"inset")?o.inset=!0:ac(d)?(A===0?o.offsetX=d:A===1?o.offsetY=d:A===2?o.blur=d:o.spread=d,A++):o.color=sc.parse(n,d)}return o})}},YL={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(n,t){var r=[0,1,2],o=[];return t.filter(jr).forEach(function(A){switch(A.value){case"stroke":o.push(1);break;case"fill":o.push(0);break;case"markers":o.push(2);break}}),r.forEach(function(A){o.indexOf(A)===-1&&o.push(A)}),o}},jL={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},qL={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(n,t){return mg(t)?t.number:0}},$L=function(){function n(t,r){var o,A;this.animationDuration=Bi(t,WL,r.animationDuration),this.backgroundClip=Bi(t,wk,r.backgroundClip),this.backgroundColor=Bi(t,Bk,r.backgroundColor),this.backgroundImage=Bi(t,Qk,r.backgroundImage),this.backgroundOrigin=Bi(t,Rk,r.backgroundOrigin),this.backgroundPosition=Bi(t,Gk,r.backgroundPosition),this.backgroundRepeat=Bi(t,Zk,r.backgroundRepeat),this.backgroundSize=Bi(t,Hk,r.backgroundSize),this.borderTopColor=Bi(t,Nk,r.borderTopColor),this.borderRightColor=Bi(t,Vk,r.borderRightColor),this.borderBottomColor=Bi(t,Dk,r.borderBottomColor),this.borderLeftColor=Bi(t,Kk,r.borderLeftColor),this.borderTopLeftRadius=Bi(t,zk,r.borderTopLeftRadius),this.borderTopRightRadius=Bi(t,Ok,r.borderTopRightRadius),this.borderBottomRightRadius=Bi(t,Wk,r.borderBottomRightRadius),this.borderBottomLeftRadius=Bi(t,Jk,r.borderBottomLeftRadius),this.borderTopStyle=Bi(t,Xk,r.borderTopStyle),this.borderRightStyle=Bi(t,Yk,r.borderRightStyle),this.borderBottomStyle=Bi(t,jk,r.borderBottomStyle),this.borderLeftStyle=Bi(t,qk,r.borderLeftStyle),this.borderTopWidth=Bi(t,$k,r.borderTopWidth),this.borderRightWidth=Bi(t,tL,r.borderRightWidth),this.borderBottomWidth=Bi(t,eL,r.borderBottomWidth),this.borderLeftWidth=Bi(t,iL,r.borderLeftWidth),this.boxShadow=Bi(t,XL,r.boxShadow),this.color=Bi(t,rL,r.color),this.direction=Bi(t,nL,r.direction),this.display=Bi(t,sL,r.display),this.float=Bi(t,aL,r.cssFloat),this.fontFamily=Bi(t,HL,r.fontFamily),this.fontSize=Bi(t,ML,r.fontSize),this.fontStyle=Bi(t,DL,r.fontStyle),this.fontVariant=Bi(t,VL,r.fontVariant),this.fontWeight=Bi(t,NL,r.fontWeight),this.letterSpacing=Bi(t,AL,r.letterSpacing),this.lineBreak=Bi(t,lL,r.lineBreak),this.lineHeight=Bi(t,cL,r.lineHeight),this.listStyleImage=Bi(t,uL,r.listStyleImage),this.listStylePosition=Bi(t,hL,r.listStylePosition),this.listStyleType=Bi(t,VC,r.listStyleType),this.marginTop=Bi(t,gL,r.marginTop),this.marginRight=Bi(t,dL,r.marginRight),this.marginBottom=Bi(t,pL,r.marginBottom),this.marginLeft=Bi(t,fL,r.marginLeft),this.opacity=Bi(t,GL,r.opacity);var s=Bi(t,mL,r.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=Bi(t,CL,r.overflowWrap),this.paddingTop=Bi(t,IL,r.paddingTop),this.paddingRight=Bi(t,yL,r.paddingRight),this.paddingBottom=Bi(t,bL,r.paddingBottom),this.paddingLeft=Bi(t,vL,r.paddingLeft),this.paintOrder=Bi(t,YL,r.paintOrder),this.position=Bi(t,BL,r.position),this.textAlign=Bi(t,wL,r.textAlign),this.textDecorationColor=Bi(t,ZL,(o=r.textDecorationColor)!==null&&o!==void 0?o:r.color),this.textDecorationLine=Bi(t,PL,(A=r.textDecorationLine)!==null&&A!==void 0?A:r.textDecoration),this.textShadow=Bi(t,_L,r.textShadow),this.textTransform=Bi(t,xL,r.textTransform),this.transform=Bi(t,SL,r.transform),this.transformOrigin=Bi(t,TL,r.transformOrigin),this.visibility=Bi(t,UL,r.visibility),this.webkitTextStrokeColor=Bi(t,jL,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=Bi(t,qL,r.webkitTextStrokeWidth),this.wordBreak=Bi(t,QL,r.wordBreak),this.zIndex=Bi(t,RL,r.zIndex)}return n.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},n.prototype.isTransparent=function(){return oc(this.backgroundColor)},n.prototype.isTransformed=function(){return this.transform!==null},n.prototype.isPositioned=function(){return this.position!==0},n.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},n.prototype.isFloating=function(){return this.float!==0},n.prototype.isInlineLevel=function(){return rs(this.display,4)||rs(this.display,33554432)||rs(this.display,268435456)||rs(this.display,536870912)||rs(this.display,67108864)||rs(this.display,134217728)},n}(),tE=function(){function n(t,r){this.content=Bi(t,KL,r.content),this.quotes=Bi(t,JL,r.quotes)}return n}(),Qv=function(){function n(t,r){this.counterIncrement=Bi(t,zL,r.counterIncrement),this.counterReset=Bi(t,OL,r.counterReset)}return n}(),Bi=function(n,t,r){var o=new vw,A=r!==null&&typeof r<"u"?r.toString():t.initialValue;o.write(A);var s=new ww(o.read());switch(t.type){case 2:var d=s.parseComponentValue();return t.parse(n,jr(d)?d.value:t.initialValue);case 0:return t.parse(n,s.parseComponentValue());case 1:return t.parse(n,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(t.format){case"angle":return cp.parse(n,s.parseComponentValue());case"color":return sc.parse(n,s.parseComponentValue());case"image":return $C.parse(n,s.parseComponentValue());case"length":var f=s.parseComponentValue();return ac(f)?f:Us;case"length-percentage":var I=s.parseComponentValue();return Yn(I)?I:Us;case"time":return Nw.parse(n,s.parseComponentValue())}break}},eE="data-html2canvas-debug",iE=function(n){var t=n.getAttribute(eE);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},DC=function(n,t){var r=iE(n);return r===1||t===r},WA=function(){function n(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,DC(r,3))debugger;this.styles=new $L(t,window.getComputedStyle(r,null)),OC(r)&&(this.styles.animationDuration.some(function(o){return o>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=Ap(this.context,r),DC(r,4)&&(this.flags|=16)}return n}(),rE="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",Rv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",og=typeof Uint8Array>"u"?[]:new Uint8Array(256);for($h=0;$h<Rv.length;$h++)og[Rv.charCodeAt($h)]=$h;nE=function(n){var t=n.length*.75,r=n.length,o,A=0,s,d,f,I;n[n.length-1]==="="&&(t--,n[n.length-2]==="="&&t--);var _=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),S=Array.isArray(_)?_:new Uint8Array(_);for(o=0;o<r;o+=4)s=og[n.charCodeAt(o)],d=og[n.charCodeAt(o+1)],f=og[n.charCodeAt(o+2)],I=og[n.charCodeAt(o+3)],S[A++]=s<<2|d>>4,S[A++]=(d&15)<<4|f>>2,S[A++]=(f&3)<<6|I&63;return _},sE=function(n){for(var t=n.length,r=[],o=0;o<t;o+=2)r.push(n[o+1]<<8|n[o]);return r},oE=function(n){for(var t=n.length,r=[],o=0;o<t;o+=4)r.push(n[o+3]<<24|n[o+2]<<16|n[o+1]<<8|n[o]);return r},Nc=5,t0=11,fC=2,aE=t0-Nc,Vw=65536>>Nc,AE=1<<Nc,mC=AE-1,lE=1024>>Nc,cE=Vw+lE,uE=cE,hE=32,gE=uE+hE,dE=65536>>t0,pE=1<<aE,fE=pE-1,Gv=function(n,t,r){return n.slice?n.slice(t,r):new Uint16Array(Array.prototype.slice.call(n,t,r))},mE=function(n,t,r){return n.slice?n.slice(t,r):new Uint32Array(Array.prototype.slice.call(n,t,r))},CE=function(n,t){var r=nE(n),o=Array.isArray(r)?oE(r):new Uint32Array(r),A=Array.isArray(r)?sE(r):new Uint16Array(r),s=24,d=Gv(A,s/2,o[4]/2),f=o[5]===2?Gv(A,(s+o[4])/2):mE(o,Math.ceil((s+o[4])/4));return new IE(o[0],o[1],o[2],o[3],d,f)},IE=function(){function n(t,r,o,A,s,d){this.initialValue=t,this.errorValue=r,this.highStart=o,this.highValueIndex=A,this.index=s,this.data=d}return n.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Nc],r=(r<<fC)+(t&mC),this.data[r];if(t<=65535)return r=this.index[Vw+(t-55296>>Nc)],r=(r<<fC)+(t&mC),this.data[r];if(t<this.highStart)return r=gE-dE+(t>>t0),r=this.index[r],r+=t>>Nc&fE,r=this.index[r],r=(r<<fC)+(t&mC),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n}(),Zv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yE=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(tg=0;tg<Zv.length;tg++)yE[Zv.charCodeAt(tg)]=tg;bE=1,CC=2,IC=3,Pv=4,Hv=5,vE=7,Mv=8,yC=9,bC=10,Nv=11,Vv=12,Dv=13,Kv=14,vC=15,wE=function(n){for(var t=[],r=0,o=n.length;r<o;){var A=n.charCodeAt(r++);if(A>=55296&&A<=56319&&r<o){var s=n.charCodeAt(r++);(s&64512)===56320?t.push(((A&1023)<<10)+(s&1023)+65536):(t.push(A),r--)}else t.push(A)}return t},BE=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var r=n.length;if(!r)return"";for(var o=[],A=-1,s="";++A<r;){var d=n[A];d<=65535?o.push(d):(d-=65536,o.push((d>>10)+55296,d%1024+56320)),(A+1===r||o.length>16384)&&(s+=String.fromCharCode.apply(String,o),o.length=0)}return s},_E=CE(rE),Hc="\xD7",zv="\xF7",xE=function(n){return _E.get(n)},SE=function(n,t,r){var o=r-2,A=t[o],s=t[r-1],d=t[r];if(s===CC&&d===IC)return Hc;if(s===CC||s===IC||s===Pv||d===CC||d===IC||d===Pv)return zv;if(s===Mv&&[Mv,yC,Nv,Vv].indexOf(d)!==-1||(s===Nv||s===yC)&&(d===yC||d===bC)||(s===Vv||s===bC)&&d===bC||d===Dv||d===Hv||d===vE||s===bE)return Hc;if(s===Dv&&d===Kv){for(;A===Hv;)A=t[--o];if(A===Kv)return Hc}if(s===vC&&d===vC){for(var f=0;A===vC;)f++,A=t[--o];if(f%2===0)return Hc}return zv},FE=function(n){var t=wE(n),r=t.length,o=0,A=0,s=t.map(xE);return{next:function(){if(o>=r)return{done:!0,value:null};for(var d=Hc;o<r&&(d=SE(t,s,++o))===Hc;);if(d!==Hc||o===r){var f=BE.apply(null,t.slice(A,o));return A=o,{value:f,done:!1}}return{done:!0,value:null}}}},kE=function(n){for(var t=FE(n),r=[],o;!(o=t.next()).done;)o.value&&r.push(o.value.slice());return r},LE=function(n){var t=123;if(n.createRange){var r=n.createRange();if(r.getBoundingClientRect){var o=n.createElement("boundtest");o.style.height=t+"px",o.style.display="block",n.body.appendChild(o),r.selectNode(o);var A=r.getBoundingClientRect(),s=Math.round(A.height);if(n.body.removeChild(o),s===t)return!0}}return!1},EE=function(n){var t=n.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",n.body.appendChild(t);var r=n.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var o=t.firstChild,A=lp(o.data).map(function(I){return Gn(I)}),s=0,d={},f=A.every(function(I,_){r.setStart(o,s),r.setEnd(o,s+I.length);var S=r.getBoundingClientRect();s+=I.length;var U=S.x>d.x||S.y>d.y;return d=S,_===0?!0:U});return n.body.removeChild(t),f},TE=function(){return typeof new Image().crossOrigin<"u"},UE=function(){return typeof new XMLHttpRequest().responseType=="string"},QE=function(n){var t=new Image,r=n.createElement("canvas"),o=r.getContext("2d");if(!o)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{o.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},Ov=function(n){return n[0]===0&&n[1]===255&&n[2]===0&&n[3]===255},RE=function(n){var t=n.createElement("canvas"),r=100;t.width=r,t.height=r;var o=t.getContext("2d");if(!o)return Promise.reject(!1);o.fillStyle="rgb(0, 255, 0)",o.fillRect(0,0,r,r);var A=new Image,s=t.toDataURL();A.src=s;var d=KC(r,r,0,0,A);return o.fillStyle="red",o.fillRect(0,0,r,r),Wv(d).then(function(f){o.drawImage(f,0,0);var I=o.getImageData(0,0,r,r).data;o.fillStyle="red",o.fillRect(0,0,r,r);var _=n.createElement("div");return _.style.backgroundImage="url("+s+")",_.style.height=r+"px",Ov(I)?Wv(KC(r,r,0,0,_)):Promise.reject(!1)}).then(function(f){return o.drawImage(f,0,0),Ov(o.getImageData(0,0,r,r).data)}).catch(function(){return!1})},KC=function(n,t,r,o,A){var s="http://www.w3.org/2000/svg",d=document.createElementNS(s,"svg"),f=document.createElementNS(s,"foreignObject");return d.setAttributeNS(null,"width",n.toString()),d.setAttributeNS(null,"height",t.toString()),f.setAttributeNS(null,"width","100%"),f.setAttributeNS(null,"height","100%"),f.setAttributeNS(null,"x",r.toString()),f.setAttributeNS(null,"y",o.toString()),f.setAttributeNS(null,"externalResourcesRequired","true"),d.appendChild(f),f.appendChild(A),d},Wv=function(n){return new Promise(function(t,r){var o=new Image;o.onload=function(){return t(o)},o.onerror=r,o.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(n))})},Ts={get SUPPORT_RANGE_BOUNDS(){var n=LE(document);return Object.defineProperty(Ts,"SUPPORT_RANGE_BOUNDS",{value:n}),n},get SUPPORT_WORD_BREAKING(){var n=Ts.SUPPORT_RANGE_BOUNDS&&EE(document);return Object.defineProperty(Ts,"SUPPORT_WORD_BREAKING",{value:n}),n},get SUPPORT_SVG_DRAWING(){var n=QE(document);return Object.defineProperty(Ts,"SUPPORT_SVG_DRAWING",{value:n}),n},get SUPPORT_FOREIGNOBJECT_DRAWING(){var n=typeof Array.from=="function"&&typeof window.fetch=="function"?RE(document):Promise.resolve(!1);return Object.defineProperty(Ts,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:n}),n},get SUPPORT_CORS_IMAGES(){var n=TE();return Object.defineProperty(Ts,"SUPPORT_CORS_IMAGES",{value:n}),n},get SUPPORT_RESPONSE_TYPE(){var n=UE();return Object.defineProperty(Ts,"SUPPORT_RESPONSE_TYPE",{value:n}),n},get SUPPORT_CORS_XHR(){var n="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Ts,"SUPPORT_CORS_XHR",{value:n}),n},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var n=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Ts,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:n}),n}},ug=function(){function n(t,r){this.text=t,this.bounds=r}return n}(),GE=function(n,t,r,o){var A=HE(t,r),s=[],d=0;return A.forEach(function(f){if(r.textDecorationLine.length||f.trim().length>0)if(Ts.SUPPORT_RANGE_BOUNDS){var I=Jv(o,d,f.length).getClientRects();if(I.length>1){var _=e0(f),S=0;_.forEach(function(G){s.push(new ug(G,_l.fromDOMRectList(n,Jv(o,S+d,G.length).getClientRects()))),S+=G.length})}else s.push(new ug(f,_l.fromDOMRectList(n,I)))}else{var U=o.splitText(f.length);s.push(new ug(f,ZE(n,o))),o=U}else Ts.SUPPORT_RANGE_BOUNDS||(o=o.splitText(f.length));d+=f.length}),s},ZE=function(n,t){var r=t.ownerDocument;if(r){var o=r.createElement("html2canvaswrapper");o.appendChild(t.cloneNode(!0));var A=t.parentNode;if(A){A.replaceChild(o,t);var s=Ap(n,o);return o.firstChild&&A.replaceChild(o.firstChild,o),s}}return _l.EMPTY},Jv=function(n,t,r){var o=n.ownerDocument;if(!o)throw new Error("Node has no owner document");var A=o.createRange();return A.setStart(n,t),A.setEnd(n,t+r),A},e0=function(n){if(Ts.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(n)).map(function(r){return r.segment})}return kE(n)},PE=function(n,t){if(Ts.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(n)).map(function(o){return o.segment})}return NE(n,t)},HE=function(n,t){return t.letterSpacing!==0?e0(n):PE(n,t)},ME=[32,160,4961,65792,65793,4153,4241],NE=function(n,t){for(var r=d4(n,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),o=[],A,s=function(){if(A.value){var d=A.value.slice(),f=lp(d),I="";f.forEach(function(_){ME.indexOf(_)===-1?I+=Gn(_):(I.length&&o.push(I),o.push(Gn(_)),I="")}),I.length&&o.push(I)}};!(A=r.next()).done;)s();return o},VE=function(){function n(t,r,o){this.text=DE(r.data,o.textTransform),this.textBounds=GE(t,this.text,o,r)}return n}(),DE=function(n,t){switch(t){case 1:return n.toLowerCase();case 3:return n.replace(KE,zE);case 2:return n.toUpperCase();default:return n}},KE=/(^|\s|:|-|\(|\))([a-z])/g,zE=function(n,t,r){return n.length>0?t+r.toUpperCase():n},Dw=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this;return A.src=o.currentSrc||o.src,A.intrinsicWidth=o.naturalWidth,A.intrinsicHeight=o.naturalHeight,A.context.cache.addImage(A.src),A}return t}(WA),Kw=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this;return A.canvas=o,A.intrinsicWidth=o.width,A.intrinsicHeight=o.height,A}return t}(WA),zw=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this,s=new XMLSerializer,d=Ap(r,o);return o.setAttribute("width",d.width+"px"),o.setAttribute("height",d.height+"px"),A.svg="data:image/svg+xml,"+encodeURIComponent(s.serializeToString(o)),A.intrinsicWidth=o.width.baseVal.value,A.intrinsicHeight=o.height.baseVal.value,A.context.cache.addImage(A.svg),A}return t}(WA),Ow=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this;return A.value=o.value,A}return t}(WA),zC=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this;return A.start=o.start,A.reversed=typeof o.reversed=="boolean"&&o.reversed===!0,A}return t}(WA),OE=[{type:15,flags:0,unit:"px",number:3}],WE=[{type:16,flags:0,number:50}],JE=function(n){return n.width>n.height?new _l(n.left+(n.width-n.height)/2,n.top,n.height,n.height):n.width<n.height?new _l(n.left,n.top+(n.height-n.width)/2,n.width,n.width):n},XE=function(n){var t=n.type===YE?new Array(n.value.length+1).join("\u2022"):n.value;return t.length===0?n.placeholder||"":t},ep="checkbox",ip="radio",YE="password",Xv=707406591,i0=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this;switch(A.type=o.type.toLowerCase(),A.checked=o.checked,A.value=XE(o),(A.type===ep||A.type===ip)&&(A.styles.backgroundColor=3739148031,A.styles.borderTopColor=A.styles.borderRightColor=A.styles.borderBottomColor=A.styles.borderLeftColor=2779096575,A.styles.borderTopWidth=A.styles.borderRightWidth=A.styles.borderBottomWidth=A.styles.borderLeftWidth=1,A.styles.borderTopStyle=A.styles.borderRightStyle=A.styles.borderBottomStyle=A.styles.borderLeftStyle=1,A.styles.backgroundClip=[0],A.styles.backgroundOrigin=[0],A.bounds=JE(A.bounds)),A.type){case ep:A.styles.borderTopRightRadius=A.styles.borderTopLeftRadius=A.styles.borderBottomRightRadius=A.styles.borderBottomLeftRadius=OE;break;case ip:A.styles.borderTopRightRadius=A.styles.borderTopLeftRadius=A.styles.borderBottomRightRadius=A.styles.borderBottomLeftRadius=WE;break}return A}return t}(WA),Ww=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this,s=o.options[o.selectedIndex||0];return A.value=s&&s.text||"",A}return t}(WA),Jw=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this;return A.value=o.value,A}return t}(WA),Xw=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this;A.src=o.src,A.width=parseInt(o.width,10)||0,A.height=parseInt(o.height,10)||0,A.backgroundColor=A.styles.backgroundColor;try{if(o.contentWindow&&o.contentWindow.document&&o.contentWindow.document.documentElement){A.tree=jw(r,o.contentWindow.document.documentElement);var s=o.contentWindow.document.documentElement?lg(r,getComputedStyle(o.contentWindow.document.documentElement).backgroundColor):Bl.TRANSPARENT,d=o.contentWindow.document.body?lg(r,getComputedStyle(o.contentWindow.document.body).backgroundColor):Bl.TRANSPARENT;A.backgroundColor=oc(s)?oc(d)?A.styles.backgroundColor:d:s}}catch{}return A}return t}(WA),jE=["OL","UL","MENU"],Yd=function(n,t,r,o){for(var A=t.firstChild,s=void 0;A;A=s)if(s=A.nextSibling,qw(A)&&A.data.trim().length>0)r.textNodes.push(new VE(n,A,r.styles));else if(Vu(A))if(i2(A)&&A.assignedNodes)A.assignedNodes().forEach(function(f){return Yd(n,f,r,o)});else{var d=Yw(n,A);d.styles.isVisible()&&(qE(A,d,o)?d.flags|=4:$E(d.styles)&&(d.flags|=2),jE.indexOf(A.tagName)!==-1&&(d.flags|=8),r.elements.push(d),A.slot,A.shadowRoot?Yd(n,A.shadowRoot,d,o):!rp(A)&&!$w(A)&&!np(A)&&Yd(n,A,d,o))}},Yw=function(n,t){return WC(t)?new Dw(n,t):t2(t)?new Kw(n,t):$w(t)?new zw(n,t):tT(t)?new Ow(n,t):eT(t)?new zC(n,t):iT(t)?new i0(n,t):np(t)?new Ww(n,t):rp(t)?new Jw(n,t):e2(t)?new Xw(n,t):new WA(n,t)},jw=function(n,t){var r=Yw(n,t);return r.flags|=4,Yd(n,t,r,r),r},qE=function(n,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||r0(n)&&r.styles.isTransparent()},$E=function(n){return n.isPositioned()||n.isFloating()},qw=function(n){return n.nodeType===Node.TEXT_NODE},Vu=function(n){return n.nodeType===Node.ELEMENT_NODE},OC=function(n){return Vu(n)&&typeof n.style<"u"&&!jd(n)},jd=function(n){return typeof n.className=="object"},tT=function(n){return n.tagName==="LI"},eT=function(n){return n.tagName==="OL"},iT=function(n){return n.tagName==="INPUT"},rT=function(n){return n.tagName==="HTML"},$w=function(n){return n.tagName==="svg"},r0=function(n){return n.tagName==="BODY"},t2=function(n){return n.tagName==="CANVAS"},Yv=function(n){return n.tagName==="VIDEO"},WC=function(n){return n.tagName==="IMG"},e2=function(n){return n.tagName==="IFRAME"},jv=function(n){return n.tagName==="STYLE"},nT=function(n){return n.tagName==="SCRIPT"},rp=function(n){return n.tagName==="TEXTAREA"},np=function(n){return n.tagName==="SELECT"},i2=function(n){return n.tagName==="SLOT"},qv=function(n){return n.tagName.indexOf("-")>0},sT=function(){function n(){this.counters={}}return n.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},n.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},n.prototype.pop=function(t){var r=this;t.forEach(function(o){return r.counters[o].pop()})},n.prototype.parse=function(t){var r=this,o=t.counterIncrement,A=t.counterReset,s=!0;o!==null&&o.forEach(function(f){var I=r.counters[f.counter];I&&f.increment!==0&&(s=!1,I.length||I.push(1),I[Math.max(0,I.length-1)]+=f.increment)});var d=[];return s&&A.forEach(function(f){var I=r.counters[f.counter];d.push(f.counter),I||(I=r.counters[f.counter]=[]),I.push(f.reset)}),d},n}(),$v={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},tw={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},oT={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},aT={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},Gu=function(n,t,r,o,A,s){return n<t||n>r?pg(n,A,s.length>0):o.integers.reduce(function(d,f,I){for(;n>=f;)n-=f,d+=o.values[I];return d},"")+s},r2=function(n,t,r,o){var A="";do r||n--,A=o(n)+A,n/=t;while(n*t>=t);return A},Rn=function(n,t,r,o,A){var s=r-t+1;return(n<0?"-":"")+(r2(Math.abs(n),s,o,function(d){return Gn(Math.floor(d%s)+t)})+A)},Zc=function(n,t,r){r===void 0&&(r=". ");var o=t.length;return r2(Math.abs(n),o,!1,function(A){return t[Math.floor(A%o)]})+r},Hu=1,$l=2,tc=4,ag=8,wl=function(n,t,r,o,A,s){if(n<-9999||n>9999)return pg(n,4,A.length>0);var d=Math.abs(n),f=A;if(d===0)return t[0]+f;for(var I=0;d>0&&I<=4;I++){var _=d%10;_===0&&rs(s,Hu)&&f!==""?f=t[_]+f:_>1||_===1&&I===0||_===1&&I===1&&rs(s,$l)||_===1&&I===1&&rs(s,tc)&&n>100||_===1&&I>1&&rs(s,ag)?f=t[_]+(I>0?r[I-1]:"")+f:_===1&&I>0&&(f=r[I-1]+f),d=Math.floor(d/10)}return(n<0?o:"")+f},ew="\u5341\u767E\u5343\u842C",iw="\u62FE\u4F70\u4EDF\u842C",rw="\u30DE\u30A4\u30CA\u30B9",wC="\uB9C8\uC774\uB108\uC2A4",pg=function(n,t,r){var o=r?". ":"",A=r?"\u3001":"",s=r?", ":"",d=r?" ":"";switch(t){case 0:return"\u2022"+d;case 1:return"\u25E6"+d;case 2:return"\u25FE"+d;case 5:var f=Rn(n,48,57,!0,o);return f.length<4?"0"+f:f;case 4:return Zc(n,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",A);case 6:return Gu(n,1,3999,$v,3,o).toLowerCase();case 7:return Gu(n,1,3999,$v,3,o);case 8:return Rn(n,945,969,!1,o);case 9:return Rn(n,97,122,!1,o);case 10:return Rn(n,65,90,!1,o);case 11:return Rn(n,1632,1641,!0,o);case 12:case 49:return Gu(n,1,9999,tw,3,o);case 35:return Gu(n,1,9999,tw,3,o).toLowerCase();case 13:return Rn(n,2534,2543,!0,o);case 14:case 30:return Rn(n,6112,6121,!0,o);case 15:return Zc(n,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",A);case 16:return Zc(n,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",A);case 17:case 48:return wl(n,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",ew,"\u8CA0",A,$l|tc|ag);case 47:return wl(n,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",iw,"\u8CA0",A,Hu|$l|tc|ag);case 42:return wl(n,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",ew,"\u8D1F",A,$l|tc|ag);case 41:return wl(n,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",iw,"\u8D1F",A,Hu|$l|tc|ag);case 26:return wl(n,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",rw,A,0);case 25:return wl(n,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",rw,A,Hu|$l|tc);case 31:return wl(n,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",wC,s,Hu|$l|tc);case 33:return wl(n,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",wC,s,0);case 32:return wl(n,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",wC,s,Hu|$l|tc);case 18:return Rn(n,2406,2415,!0,o);case 20:return Gu(n,1,19999,aT,3,o);case 21:return Rn(n,2790,2799,!0,o);case 22:return Rn(n,2662,2671,!0,o);case 22:return Gu(n,1,10999,oT,3,o);case 23:return Zc(n,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case 24:return Zc(n,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case 27:return Rn(n,3302,3311,!0,o);case 28:return Zc(n,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",A);case 29:return Zc(n,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",A);case 34:return Rn(n,3792,3801,!0,o);case 37:return Rn(n,6160,6169,!0,o);case 38:return Rn(n,4160,4169,!0,o);case 39:return Rn(n,2918,2927,!0,o);case 40:return Rn(n,1776,1785,!0,o);case 43:return Rn(n,3046,3055,!0,o);case 44:return Rn(n,3174,3183,!0,o);case 45:return Rn(n,3664,3673,!0,o);case 46:return Rn(n,3872,3881,!0,o);case 3:default:return Rn(n,48,57,!0,o)}},n2="data-html2canvas-ignore",nw=function(){function n(t,r,o){if(this.context=t,this.options=o,this.scrolledElements=[],this.referenceElement=r,this.counters=new sT,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return n.prototype.toIFrame=function(t,r){var o=this,A=AT(t,r);if(!A.contentWindow)return Promise.reject("Unable to find iframe window");var s=t.defaultView.pageXOffset,d=t.defaultView.pageYOffset,f=A.contentWindow,I=f.document,_=uT(A).then(function(){return wo(o,void 0,void 0,function(){var S,U;return Ys(this,function(G){switch(G.label){case 0:return this.scrolledElements.forEach(pT),f&&(f.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(f.scrollY!==r.top||f.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(f.scrollX-r.left,f.scrollY-r.top,0,0))),S=this.options.onclone,U=this.clonedReferenceElement,typeof U>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:I.fonts&&I.fonts.ready?[4,I.fonts.ready]:[3,2];case 1:G.sent(),G.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,cT(I)]:[3,4];case 3:G.sent(),G.label=4;case 4:return typeof S=="function"?[2,Promise.resolve().then(function(){return S(I,U)}).then(function(){return A})]:[2,A]}})})});return I.open(),I.write(gT(document.doctype)+"<html></html>"),dT(this.referenceElement.ownerDocument,s,d),I.replaceChild(I.adoptNode(this.documentElement),I.documentElement),I.close(),_},n.prototype.createElementClone=function(t){if(DC(t,2))debugger;if(t2(t))return this.createCanvasClone(t);if(Yv(t))return this.createVideoClone(t);if(jv(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return WC(r)&&(WC(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),qv(r)?this.createCustomElementClone(r):r},n.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return BC(t.style,r),r},n.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var o=[].slice.call(r.cssRules,0).reduce(function(s,d){return d&&typeof d.cssText=="string"?s+d.cssText:s},""),A=t.cloneNode(!1);return A.textContent=o,A}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return t.cloneNode(!1)},n.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var o=t.ownerDocument.createElement("img");try{return o.src=t.toDataURL(),o}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var A=t.cloneNode(!1);try{A.width=t.width,A.height=t.height;var s=t.getContext("2d"),d=A.getContext("2d");if(d)if(!this.options.allowTaint&&s)d.putImageData(s.getImageData(0,0,t.width,t.height),0,0);else{var f=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(f){var I=f.getContextAttributes();I?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}d.drawImage(t,0,0)}return A}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return A},n.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var o=r.getContext("2d");try{return o&&(o.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||o.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var A=t.ownerDocument.createElement("canvas");return A.width=t.offsetWidth,A.height=t.offsetHeight,A},n.prototype.appendChildNode=function(t,r,o){(!Vu(r)||!nT(r)&&!r.hasAttribute(n2)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!Vu(r)||!jv(r))&&t.appendChild(this.cloneNode(r,o))},n.prototype.cloneChildNodes=function(t,r,o){for(var A=this,s=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;s;s=s.nextSibling)if(Vu(s)&&i2(s)&&typeof s.assignedNodes=="function"){var d=s.assignedNodes();d.length&&d.forEach(function(f){return A.appendChildNode(r,f,o)})}else this.appendChildNode(r,s,o)},n.prototype.cloneNode=function(t,r){if(qw(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var o=t.ownerDocument.defaultView;if(o&&Vu(t)&&(OC(t)||jd(t))){var A=this.createElementClone(t);A.style.transitionProperty="none";var s=o.getComputedStyle(t),d=o.getComputedStyle(t,":before"),f=o.getComputedStyle(t,":after");this.referenceElement===t&&OC(A)&&(this.clonedReferenceElement=A),r0(A)&&CT(A);var I=this.counters.parse(new Qv(this.context,s)),_=this.resolvePseudoContent(t,A,d,hg.BEFORE);qv(t)&&(r=!0),Yv(t)||this.cloneChildNodes(t,A,r),_&&A.insertBefore(_,A.firstChild);var S=this.resolvePseudoContent(t,A,f,hg.AFTER);return S&&A.appendChild(S),this.counters.pop(I),(s&&(this.options.copyStyles||jd(t))&&!e2(t)||r)&&BC(s,A),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([A,t.scrollLeft,t.scrollTop]),(rp(t)||np(t))&&(rp(A)||np(A))&&(A.value=t.value),A}return t.cloneNode(!1)},n.prototype.resolvePseudoContent=function(t,r,o,A){var s=this;if(o){var d=o.content,f=r.ownerDocument;if(!(!f||!d||d==="none"||d==="-moz-alt-content"||o.display==="none")){this.counters.parse(new Qv(this.context,o));var I=new tE(this.context,o),_=f.createElement("html2canvaspseudoelement");BC(o,_),I.content.forEach(function(U){if(U.type===0)_.appendChild(f.createTextNode(U.value));else if(U.type===22){var G=f.createElement("img");G.src=U.value,G.style.opacity="1",_.appendChild(G)}else if(U.type===18){if(U.name==="attr"){var L=U.values.filter(jr);L.length&&_.appendChild(f.createTextNode(t.getAttribute(L[0].value)||""))}else if(U.name==="counter"){var K=U.values.filter(Ku),V=K[0],q=K[1];if(V&&jr(V)){var z=s.counters.getCounterValue(V.value),it=q&&jr(q)?VC.parse(s.context,q.value):3;_.appendChild(f.createTextNode(pg(z,it,!1)))}}else if(U.name==="counters"){var At=U.values.filter(Ku),V=At[0],_t=At[1],q=At[2];if(V&&jr(V)){var Lt=s.counters.getCounterValues(V.value),Et=q&&jr(q)?VC.parse(s.context,q.value):3,xt=_t&&_t.type===0?_t.value:"",It=Lt.map(function(lt){return pg(lt,Et,!1)}).join(xt);_.appendChild(f.createTextNode(It))}}}else if(U.type===20)switch(U.value){case"open-quote":_.appendChild(f.createTextNode(Uv(I.quotes,s.quoteDepth++,!0)));break;case"close-quote":_.appendChild(f.createTextNode(Uv(I.quotes,--s.quoteDepth,!1)));break;default:_.appendChild(f.createTextNode(U.value))}}),_.className=JC+" "+XC;var S=A===hg.BEFORE?" "+JC:" "+XC;return jd(r)?r.className.baseValue+=S:r.className+=S,_}}},n.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},n}();(function(n){n[n.BEFORE=0]="BEFORE",n[n.AFTER=1]="AFTER"})(hg||(hg={}));AT=function(n,t){var r=n.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(n2,"true"),n.body.appendChild(r),r},lT=function(n){return new Promise(function(t){if(n.complete){t();return}if(!n.src){t();return}n.onload=t,n.onerror=t})},cT=function(n){return Promise.all([].slice.call(n.images,0).map(lT))},uT=function(n){return new Promise(function(t,r){var o=n.contentWindow;if(!o)return r("No window assigned for iframe");var A=o.document;o.onload=n.onload=function(){o.onload=n.onload=null;var s=setInterval(function(){A.body.childNodes.length>0&&A.readyState==="complete"&&(clearInterval(s),t(n))},50)}})},hT=["all","d","content"],BC=function(n,t){for(var r=n.length-1;r>=0;r--){var o=n.item(r);hT.indexOf(o)===-1&&t.style.setProperty(o,n.getPropertyValue(o))}return t},gT=function(n){var t="";return n&&(t+="<!DOCTYPE ",n.name&&(t+=n.name),n.internalSubset&&(t+=n.internalSubset),n.publicId&&(t+='"'+n.publicId+'"'),n.systemId&&(t+='"'+n.systemId+'"'),t+=">"),t},dT=function(n,t,r){n&&n.defaultView&&(t!==n.defaultView.pageXOffset||r!==n.defaultView.pageYOffset)&&n.defaultView.scrollTo(t,r)},pT=function(n){var t=n[0],r=n[1],o=n[2];t.scrollLeft=r,t.scrollTop=o},fT=":before",mT=":after",JC="___html2canvas___pseudoelement_before",XC="___html2canvas___pseudoelement_after",sw=`{
    content: "" !important;
    display: none !important;
}`,CT=function(n){IT(n,"."+JC+fT+sw+`
         .`+XC+mT+sw)},IT=function(n,t){var r=n.ownerDocument;if(r){var o=r.createElement("style");o.textContent=t,n.appendChild(o)}},s2=function(){function n(){}return n.getOrigin=function(t){var r=n._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},n.isSameOrigin=function(t){return n.getOrigin(t)===n._origin},n.setContext=function(t){n._link=t.document.createElement("a"),n._origin=n.getOrigin(t.location.href)},n._origin="about:blank",n}(),yT=function(){function n(t,r){this.context=t,this._options=r,this._cache={}}return n.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(xC(t)||BT(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},n.prototype.match=function(t){return this._cache[t]},n.prototype.loadImage=function(t){return wo(this,void 0,void 0,function(){var r,o,A,s,d=this;return Ys(this,function(f){switch(f.label){case 0:return r=s2.isSameOrigin(t),o=!_C(t)&&this._options.useCORS===!0&&Ts.SUPPORT_CORS_IMAGES&&!r,A=!_C(t)&&!r&&!xC(t)&&typeof this._options.proxy=="string"&&Ts.SUPPORT_CORS_XHR&&!o,!r&&this._options.allowTaint===!1&&!_C(t)&&!xC(t)&&!A&&!o?[2]:(s=t,A?[4,this.proxy(s)]:[3,2]);case 1:s=f.sent(),f.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(I,_){var S=new Image;S.onload=function(){return I(S)},S.onerror=_,(_T(s)||o)&&(S.crossOrigin="anonymous"),S.src=s,S.complete===!0&&setTimeout(function(){return I(S)},500),d._options.imageTimeout>0&&setTimeout(function(){return _("Timed out ("+d._options.imageTimeout+"ms) loading image")},d._options.imageTimeout)})];case 3:return[2,f.sent()]}})})},n.prototype.has=function(t){return typeof this._cache[t]<"u"},n.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},n.prototype.proxy=function(t){var r=this,o=this._options.proxy;if(!o)throw new Error("No proxy defined");var A=t.substring(0,256);return new Promise(function(s,d){var f=Ts.SUPPORT_RESPONSE_TYPE?"blob":"text",I=new XMLHttpRequest;I.onload=function(){if(I.status===200)if(f==="text")s(I.response);else{var U=new FileReader;U.addEventListener("load",function(){return s(U.result)},!1),U.addEventListener("error",function(G){return d(G)},!1),U.readAsDataURL(I.response)}else d("Failed to proxy resource "+A+" with status code "+I.status)},I.onerror=d;var _=o.indexOf("?")>-1?"&":"?";if(I.open("GET",""+o+_+"url="+encodeURIComponent(t)+"&responseType="+f),f!=="text"&&I instanceof XMLHttpRequest&&(I.responseType=f),r._options.imageTimeout){var S=r._options.imageTimeout;I.timeout=S,I.ontimeout=function(){return d("Timed out ("+S+"ms) proxying "+A)}}I.send()})},n}(),bT=/^data:image\/svg\+xml/i,vT=/^data:image\/.*;base64,/i,wT=/^data:image\/.*/i,BT=function(n){return Ts.SUPPORT_SVG_DRAWING||!xT(n)},_C=function(n){return wT.test(n)},_T=function(n){return vT.test(n)},xC=function(n){return n.substr(0,4)==="blob"},xT=function(n){return n.substr(-3).toLowerCase()==="svg"||bT.test(n)},fi=function(){function n(t,r){this.type=0,this.x=t,this.y=r}return n.prototype.add=function(t,r){return new n(this.x+t,this.y+r)},n}(),Zu=function(n,t,r){return new fi(n.x+(t.x-n.x)*r,n.y+(t.y-n.y)*r)},Kd=function(){function n(t,r,o,A){this.type=1,this.start=t,this.startControl=r,this.endControl=o,this.end=A}return n.prototype.subdivide=function(t,r){var o=Zu(this.start,this.startControl,t),A=Zu(this.startControl,this.endControl,t),s=Zu(this.endControl,this.end,t),d=Zu(o,A,t),f=Zu(A,s,t),I=Zu(d,f,t);return r?new n(this.start,o,d,I):new n(I,f,s,this.end)},n.prototype.add=function(t,r){return new n(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},n.prototype.reverse=function(){return new n(this.end,this.endControl,this.startControl,this.start)},n}(),Ga=function(n){return n.type===1},ST=function(){function n(t){var r=t.styles,o=t.bounds,A=sg(r.borderTopLeftRadius,o.width,o.height),s=A[0],d=A[1],f=sg(r.borderTopRightRadius,o.width,o.height),I=f[0],_=f[1],S=sg(r.borderBottomRightRadius,o.width,o.height),U=S[0],G=S[1],L=sg(r.borderBottomLeftRadius,o.width,o.height),K=L[0],V=L[1],q=[];q.push((s+I)/o.width),q.push((K+U)/o.width),q.push((d+V)/o.height),q.push((_+G)/o.height);var z=Math.max.apply(Math,q);z>1&&(s/=z,d/=z,I/=z,_/=z,U/=z,G/=z,K/=z,V/=z);var it=o.width-I,At=o.height-G,_t=o.width-U,Lt=o.height-V,Et=r.borderTopWidth,xt=r.borderRightWidth,It=r.borderBottomWidth,Nt=r.borderLeftWidth,ie=un(r.paddingTop,t.bounds.width),lt=un(r.paddingRight,t.bounds.width),at=un(r.paddingBottom,t.bounds.width),St=un(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||d>0?Cn(o.left+Nt/3,o.top+Et/3,s-Nt/3,d-Et/3,Kr.TOP_LEFT):new fi(o.left+Nt/3,o.top+Et/3),this.topRightBorderDoubleOuterBox=s>0||d>0?Cn(o.left+it,o.top+Et/3,I-xt/3,_-Et/3,Kr.TOP_RIGHT):new fi(o.left+o.width-xt/3,o.top+Et/3),this.bottomRightBorderDoubleOuterBox=U>0||G>0?Cn(o.left+_t,o.top+At,U-xt/3,G-It/3,Kr.BOTTOM_RIGHT):new fi(o.left+o.width-xt/3,o.top+o.height-It/3),this.bottomLeftBorderDoubleOuterBox=K>0||V>0?Cn(o.left+Nt/3,o.top+Lt,K-Nt/3,V-It/3,Kr.BOTTOM_LEFT):new fi(o.left+Nt/3,o.top+o.height-It/3),this.topLeftBorderDoubleInnerBox=s>0||d>0?Cn(o.left+Nt*2/3,o.top+Et*2/3,s-Nt*2/3,d-Et*2/3,Kr.TOP_LEFT):new fi(o.left+Nt*2/3,o.top+Et*2/3),this.topRightBorderDoubleInnerBox=s>0||d>0?Cn(o.left+it,o.top+Et*2/3,I-xt*2/3,_-Et*2/3,Kr.TOP_RIGHT):new fi(o.left+o.width-xt*2/3,o.top+Et*2/3),this.bottomRightBorderDoubleInnerBox=U>0||G>0?Cn(o.left+_t,o.top+At,U-xt*2/3,G-It*2/3,Kr.BOTTOM_RIGHT):new fi(o.left+o.width-xt*2/3,o.top+o.height-It*2/3),this.bottomLeftBorderDoubleInnerBox=K>0||V>0?Cn(o.left+Nt*2/3,o.top+Lt,K-Nt*2/3,V-It*2/3,Kr.BOTTOM_LEFT):new fi(o.left+Nt*2/3,o.top+o.height-It*2/3),this.topLeftBorderStroke=s>0||d>0?Cn(o.left+Nt/2,o.top+Et/2,s-Nt/2,d-Et/2,Kr.TOP_LEFT):new fi(o.left+Nt/2,o.top+Et/2),this.topRightBorderStroke=s>0||d>0?Cn(o.left+it,o.top+Et/2,I-xt/2,_-Et/2,Kr.TOP_RIGHT):new fi(o.left+o.width-xt/2,o.top+Et/2),this.bottomRightBorderStroke=U>0||G>0?Cn(o.left+_t,o.top+At,U-xt/2,G-It/2,Kr.BOTTOM_RIGHT):new fi(o.left+o.width-xt/2,o.top+o.height-It/2),this.bottomLeftBorderStroke=K>0||V>0?Cn(o.left+Nt/2,o.top+Lt,K-Nt/2,V-It/2,Kr.BOTTOM_LEFT):new fi(o.left+Nt/2,o.top+o.height-It/2),this.topLeftBorderBox=s>0||d>0?Cn(o.left,o.top,s,d,Kr.TOP_LEFT):new fi(o.left,o.top),this.topRightBorderBox=I>0||_>0?Cn(o.left+it,o.top,I,_,Kr.TOP_RIGHT):new fi(o.left+o.width,o.top),this.bottomRightBorderBox=U>0||G>0?Cn(o.left+_t,o.top+At,U,G,Kr.BOTTOM_RIGHT):new fi(o.left+o.width,o.top+o.height),this.bottomLeftBorderBox=K>0||V>0?Cn(o.left,o.top+Lt,K,V,Kr.BOTTOM_LEFT):new fi(o.left,o.top+o.height),this.topLeftPaddingBox=s>0||d>0?Cn(o.left+Nt,o.top+Et,Math.max(0,s-Nt),Math.max(0,d-Et),Kr.TOP_LEFT):new fi(o.left+Nt,o.top+Et),this.topRightPaddingBox=I>0||_>0?Cn(o.left+Math.min(it,o.width-xt),o.top+Et,it>o.width+xt?0:Math.max(0,I-xt),Math.max(0,_-Et),Kr.TOP_RIGHT):new fi(o.left+o.width-xt,o.top+Et),this.bottomRightPaddingBox=U>0||G>0?Cn(o.left+Math.min(_t,o.width-Nt),o.top+Math.min(At,o.height-It),Math.max(0,U-xt),Math.max(0,G-It),Kr.BOTTOM_RIGHT):new fi(o.left+o.width-xt,o.top+o.height-It),this.bottomLeftPaddingBox=K>0||V>0?Cn(o.left+Nt,o.top+Math.min(Lt,o.height-It),Math.max(0,K-Nt),Math.max(0,V-It),Kr.BOTTOM_LEFT):new fi(o.left+Nt,o.top+o.height-It),this.topLeftContentBox=s>0||d>0?Cn(o.left+Nt+St,o.top+Et+ie,Math.max(0,s-(Nt+St)),Math.max(0,d-(Et+ie)),Kr.TOP_LEFT):new fi(o.left+Nt+St,o.top+Et+ie),this.topRightContentBox=I>0||_>0?Cn(o.left+Math.min(it,o.width+Nt+St),o.top+Et+ie,it>o.width+Nt+St?0:I-Nt+St,_-(Et+ie),Kr.TOP_RIGHT):new fi(o.left+o.width-(xt+lt),o.top+Et+ie),this.bottomRightContentBox=U>0||G>0?Cn(o.left+Math.min(_t,o.width-(Nt+St)),o.top+Math.min(At,o.height+Et+ie),Math.max(0,U-(xt+lt)),G-(It+at),Kr.BOTTOM_RIGHT):new fi(o.left+o.width-(xt+lt),o.top+o.height-(It+at)),this.bottomLeftContentBox=K>0||V>0?Cn(o.left+Nt+St,o.top+Lt,Math.max(0,K-(Nt+St)),V-(It+at),Kr.BOTTOM_LEFT):new fi(o.left+Nt+St,o.top+o.height-(It+at))}return n}();(function(n){n[n.TOP_LEFT=0]="TOP_LEFT",n[n.TOP_RIGHT=1]="TOP_RIGHT",n[n.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",n[n.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Kr||(Kr={}));Cn=function(n,t,r,o,A){var s=4*((Math.sqrt(2)-1)/3),d=r*s,f=o*s,I=n+r,_=t+o;switch(A){case Kr.TOP_LEFT:return new Kd(new fi(n,_),new fi(n,_-f),new fi(I-d,t),new fi(I,t));case Kr.TOP_RIGHT:return new Kd(new fi(n,t),new fi(n+d,t),new fi(I,_-f),new fi(I,_));case Kr.BOTTOM_RIGHT:return new Kd(new fi(I,t),new fi(I,t+f),new fi(n+d,_),new fi(n,_));case Kr.BOTTOM_LEFT:default:return new Kd(new fi(I,_),new fi(I-d,_),new fi(n,t+f),new fi(n,t))}},sp=function(n){return[n.topLeftBorderBox,n.topRightBorderBox,n.bottomRightBorderBox,n.bottomLeftBorderBox]},FT=function(n){return[n.topLeftContentBox,n.topRightContentBox,n.bottomRightContentBox,n.bottomLeftContentBox]},op=function(n){return[n.topLeftPaddingBox,n.topRightPaddingBox,n.bottomRightPaddingBox,n.bottomLeftPaddingBox]},kT=function(){function n(t,r,o){this.offsetX=t,this.offsetY=r,this.matrix=o,this.type=0,this.target=6}return n}(),zd=function(){function n(t,r){this.path=t,this.target=r,this.type=1}return n}(),LT=function(){function n(t){this.opacity=t,this.type=2,this.target=6}return n}(),ET=function(n){return n.type===0},o2=function(n){return n.type===1},TT=function(n){return n.type===2},ow=function(n,t){return n.length===t.length?n.some(function(r,o){return r===t[o]}):!1},UT=function(n,t,r,o,A){return n.map(function(s,d){switch(d){case 0:return s.add(t,r);case 1:return s.add(t+o,r);case 2:return s.add(t+o,r+A);case 3:return s.add(t,r+A)}return s})},a2=function(){function n(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return n}(),A2=function(){function n(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new ST(this.container),this.container.styles.opacity<1&&this.effects.push(new LT(this.container.styles.opacity)),this.container.styles.transform!==null){var o=this.container.bounds.left+this.container.styles.transformOrigin[0].number,A=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new kT(o,A,s))}if(this.container.styles.overflowX!==0){var d=sp(this.curves),f=op(this.curves);ow(d,f)?this.effects.push(new zd(d,6)):(this.effects.push(new zd(d,2)),this.effects.push(new zd(f,4)))}}return n.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,o=this.parent,A=this.effects.slice(0);o;){var s=o.effects.filter(function(I){return!o2(I)});if(r||o.container.styles.position!==0||!o.parent){if(A.unshift.apply(A,s),r=[2,3].indexOf(o.container.styles.position)===-1,o.container.styles.overflowX!==0){var d=sp(o.curves),f=op(o.curves);ow(d,f)||A.unshift(new zd(f,6))}}else A.unshift.apply(A,s);o=o.parent}return A.filter(function(I){return rs(I.target,t)})},n}(),YC=function(n,t,r,o){n.container.elements.forEach(function(A){var s=rs(A.flags,4),d=rs(A.flags,2),f=new A2(A,n);rs(A.styles.display,2048)&&o.push(f);var I=rs(A.flags,8)?[]:o;if(s||d){var _=s||A.styles.isPositioned()?r:t,S=new a2(f);if(A.styles.isPositioned()||A.styles.opacity<1||A.styles.isTransformed()){var U=A.styles.zIndex.order;if(U<0){var G=0;_.negativeZIndex.some(function(K,V){return U>K.element.container.styles.zIndex.order?(G=V,!1):G>0}),_.negativeZIndex.splice(G,0,S)}else if(U>0){var L=0;_.positiveZIndex.some(function(K,V){return U>=K.element.container.styles.zIndex.order?(L=V+1,!1):L>0}),_.positiveZIndex.splice(L,0,S)}else _.zeroOrAutoZIndexOrTransformedOrOpacity.push(S)}else A.styles.isFloating()?_.nonPositionedFloats.push(S):_.nonPositionedInlineLevel.push(S);YC(f,S,s?S:r,I)}else A.styles.isInlineLevel()?t.inlineLevel.push(f):t.nonInlineLevel.push(f),YC(f,t,r,I);rs(A.flags,8)&&l2(A,I)})},l2=function(n,t){for(var r=n instanceof zC?n.start:1,o=n instanceof zC?n.reversed:!1,A=0;A<t.length;A++){var s=t[A];s.container instanceof Ow&&typeof s.container.value=="number"&&s.container.value!==0&&(r=s.container.value),s.listValue=pg(r,s.container.styles.listStyleType,!0),r+=o?-1:1}},QT=function(n){var t=new A2(n,null),r=new a2(t),o=[];return YC(t,r,r,o),l2(t.container,o),r},aw=function(n,t){switch(t){case 0:return Pa(n.topLeftBorderBox,n.topLeftPaddingBox,n.topRightBorderBox,n.topRightPaddingBox);case 1:return Pa(n.topRightBorderBox,n.topRightPaddingBox,n.bottomRightBorderBox,n.bottomRightPaddingBox);case 2:return Pa(n.bottomRightBorderBox,n.bottomRightPaddingBox,n.bottomLeftBorderBox,n.bottomLeftPaddingBox);case 3:default:return Pa(n.bottomLeftBorderBox,n.bottomLeftPaddingBox,n.topLeftBorderBox,n.topLeftPaddingBox)}},RT=function(n,t){switch(t){case 0:return Pa(n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox,n.topRightBorderBox,n.topRightBorderDoubleOuterBox);case 1:return Pa(n.topRightBorderBox,n.topRightBorderDoubleOuterBox,n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox);case 2:return Pa(n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox,n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox);case 3:default:return Pa(n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox,n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox)}},GT=function(n,t){switch(t){case 0:return Pa(n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox,n.topRightBorderDoubleInnerBox,n.topRightPaddingBox);case 1:return Pa(n.topRightBorderDoubleInnerBox,n.topRightPaddingBox,n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox);case 2:return Pa(n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox,n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox);case 3:default:return Pa(n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox,n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox)}},ZT=function(n,t){switch(t){case 0:return Od(n.topLeftBorderStroke,n.topRightBorderStroke);case 1:return Od(n.topRightBorderStroke,n.bottomRightBorderStroke);case 2:return Od(n.bottomRightBorderStroke,n.bottomLeftBorderStroke);case 3:default:return Od(n.bottomLeftBorderStroke,n.topLeftBorderStroke)}},Od=function(n,t){var r=[];return Ga(n)?r.push(n.subdivide(.5,!1)):r.push(n),Ga(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Pa=function(n,t,r,o){var A=[];return Ga(n)?A.push(n.subdivide(.5,!1)):A.push(n),Ga(r)?A.push(r.subdivide(.5,!0)):A.push(r),Ga(o)?A.push(o.subdivide(.5,!0).reverse()):A.push(o),Ga(t)?A.push(t.subdivide(.5,!1).reverse()):A.push(t),A},c2=function(n){var t=n.bounds,r=n.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},ap=function(n){var t=n.styles,r=n.bounds,o=un(t.paddingLeft,r.width),A=un(t.paddingRight,r.width),s=un(t.paddingTop,r.width),d=un(t.paddingBottom,r.width);return r.add(o+t.borderLeftWidth,s+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+o+A),-(t.borderTopWidth+t.borderBottomWidth+s+d))},PT=function(n,t){return n===0?t.bounds:n===2?ap(t):c2(t)},HT=function(n,t){return n===0?t.bounds:n===2?ap(t):c2(t)},SC=function(n,t,r){var o=PT(Mu(n.styles.backgroundOrigin,t),n),A=HT(Mu(n.styles.backgroundClip,t),n),s=MT(Mu(n.styles.backgroundSize,t),r,o),d=s[0],f=s[1],I=sg(Mu(n.styles.backgroundPosition,t),o.width-d,o.height-f),_=NT(Mu(n.styles.backgroundRepeat,t),I,s,o,A),S=Math.round(o.left+I[0]),U=Math.round(o.top+I[1]);return[_,S,U,d,f]},Pu=function(n){return jr(n)&&n.value===Du.AUTO},Wd=function(n){return typeof n=="number"},MT=function(n,t,r){var o=t[0],A=t[1],s=t[2],d=n[0],f=n[1];if(!d)return[0,0];if(Yn(d)&&f&&Yn(f))return[un(d,r.width),un(f,r.height)];var I=Wd(s);if(jr(d)&&(d.value===Du.CONTAIN||d.value===Du.COVER)){if(Wd(s)){var _=r.width/r.height;return _<s!=(d.value===Du.COVER)?[r.width,r.width/s]:[r.height*s,r.height]}return[r.width,r.height]}var S=Wd(o),U=Wd(A),G=S||U;if(Pu(d)&&(!f||Pu(f))){if(S&&U)return[o,A];if(!I&&!G)return[r.width,r.height];if(G&&I){var L=S?o:A*s,K=U?A:o/s;return[L,K]}var V=S?o:r.width,q=U?A:r.height;return[V,q]}if(I){var z=0,it=0;return Yn(d)?z=un(d,r.width):Yn(f)&&(it=un(f,r.height)),Pu(d)?z=it*s:(!f||Pu(f))&&(it=z/s),[z,it]}var At=null,_t=null;if(Yn(d)?At=un(d,r.width):f&&Yn(f)&&(_t=un(f,r.height)),At!==null&&(!f||Pu(f))&&(_t=S&&U?At/o*A:r.height),_t!==null&&Pu(d)&&(At=S&&U?_t/A*o:r.width),At!==null&&_t!==null)return[At,_t];throw new Error("Unable to calculate background-size for element")},Mu=function(n,t){var r=n[t];return typeof r>"u"?n[0]:r},NT=function(n,t,r,o,A){var s=t[0],d=t[1],f=r[0],I=r[1];switch(n){case 2:return[new fi(Math.round(o.left),Math.round(o.top+d)),new fi(Math.round(o.left+o.width),Math.round(o.top+d)),new fi(Math.round(o.left+o.width),Math.round(I+o.top+d)),new fi(Math.round(o.left),Math.round(I+o.top+d))];case 3:return[new fi(Math.round(o.left+s),Math.round(o.top)),new fi(Math.round(o.left+s+f),Math.round(o.top)),new fi(Math.round(o.left+s+f),Math.round(o.height+o.top)),new fi(Math.round(o.left+s),Math.round(o.height+o.top))];case 1:return[new fi(Math.round(o.left+s),Math.round(o.top+d)),new fi(Math.round(o.left+s+f),Math.round(o.top+d)),new fi(Math.round(o.left+s+f),Math.round(o.top+d+I)),new fi(Math.round(o.left+s),Math.round(o.top+d+I))];default:return[new fi(Math.round(A.left),Math.round(A.top)),new fi(Math.round(A.left+A.width),Math.round(A.top)),new fi(Math.round(A.left+A.width),Math.round(A.height+A.top)),new fi(Math.round(A.left),Math.round(A.height+A.top))]}},VT="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Aw="Hidden Text",DT=function(){function n(t){this._data={},this._document=t}return n.prototype.parseMetrics=function(t,r){var o=this._document.createElement("div"),A=this._document.createElement("img"),s=this._document.createElement("span"),d=this._document.body;o.style.visibility="hidden",o.style.fontFamily=t,o.style.fontSize=r,o.style.margin="0",o.style.padding="0",o.style.whiteSpace="nowrap",d.appendChild(o),A.src=VT,A.width=1,A.height=1,A.style.margin="0",A.style.padding="0",A.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=r,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(Aw)),o.appendChild(s),o.appendChild(A);var f=A.offsetTop-s.offsetTop+2;o.removeChild(s),o.appendChild(this._document.createTextNode(Aw)),o.style.lineHeight="normal",A.style.verticalAlign="super";var I=A.offsetTop-o.offsetTop+2;return d.removeChild(o),{baseline:f,middle:I}},n.prototype.getMetrics=function(t,r){var o=t+" "+r;return typeof this._data[o]>"u"&&(this._data[o]=this.parseMetrics(t,r)),this._data[o]},n}(),u2=function(){function n(t,r){this.context=t,this.options=r}return n}(),KT=1e4,zT=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this;return A._activeEffects=[],A.canvas=o.canvas?o.canvas:document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),o.canvas||(A.canvas.width=Math.floor(o.width*o.scale),A.canvas.height=Math.floor(o.height*o.scale),A.canvas.style.width=o.width+"px",A.canvas.style.height=o.height+"px"),A.fontMetrics=new DT(document),A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-o.x,-o.y),A.ctx.textBaseline="bottom",A._activeEffects=[],A.context.logger.debug("Canvas renderer initialized ("+o.width+"x"+o.height+") with scale "+o.scale),A}return t.prototype.applyEffects=function(r){for(var o=this;this._activeEffects.length;)this.popEffect();r.forEach(function(A){return o.applyEffect(A)})},t.prototype.applyEffect=function(r){this.ctx.save(),TT(r)&&(this.ctx.globalAlpha=r.opacity),ET(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),o2(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return wo(this,void 0,void 0,function(){var o;return Ys(this,function(A){switch(A.label){case 0:return o=r.element.container.styles,o.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:A.sent(),A.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return wo(this,void 0,void 0,function(){return Ys(this,function(o){switch(o.label){case 0:if(rs(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return o.sent(),[4,this.renderNodeContent(r)];case 2:o.sent(),o.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,o,A){var s=this;if(o===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+A);else{var d=e0(r.text);d.reduce(function(f,I){return s.ctx.fillText(I,f,r.bounds.top+A),f+s.ctx.measureText(I).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var o=r.fontVariant.filter(function(d){return d==="normal"||d==="small-caps"}).join(""),A=YT(r.fontFamily).join(", "),s=mg(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,o,r.fontWeight,s,A].join(" "),A,s]},t.prototype.renderTextNode=function(r,o){return wo(this,void 0,void 0,function(){var A,s,d,f,I,_,S,U,G=this;return Ys(this,function(L){return A=this.createFontStyle(o),s=A[0],d=A[1],f=A[2],this.ctx.font=s,this.ctx.direction=o.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",I=this.fontMetrics.getMetrics(d,f),_=I.baseline,S=I.middle,U=o.paintOrder,r.textBounds.forEach(function(K){U.forEach(function(V){switch(V){case 0:G.ctx.fillStyle=ds(o.color),G.renderTextWithLetterSpacing(K,o.letterSpacing,_);var q=o.textShadow;q.length&&K.text.trim().length&&(q.slice(0).reverse().forEach(function(z){G.ctx.shadowColor=ds(z.color),G.ctx.shadowOffsetX=z.offsetX.number*G.options.scale,G.ctx.shadowOffsetY=z.offsetY.number*G.options.scale,G.ctx.shadowBlur=z.blur.number,G.renderTextWithLetterSpacing(K,o.letterSpacing,_)}),G.ctx.shadowColor="",G.ctx.shadowOffsetX=0,G.ctx.shadowOffsetY=0,G.ctx.shadowBlur=0),o.textDecorationLine.length&&(G.ctx.fillStyle=ds(o.textDecorationColor||o.color),o.textDecorationLine.forEach(function(z){switch(z){case 1:G.ctx.fillRect(K.bounds.left,Math.round(K.bounds.top+_),K.bounds.width,1);break;case 2:G.ctx.fillRect(K.bounds.left,Math.round(K.bounds.top),K.bounds.width,1);break;case 3:G.ctx.fillRect(K.bounds.left,Math.ceil(K.bounds.top+S),K.bounds.width,1);break}}));break;case 1:o.webkitTextStrokeWidth&&K.text.trim().length&&(G.ctx.strokeStyle=ds(o.webkitTextStrokeColor),G.ctx.lineWidth=o.webkitTextStrokeWidth,G.ctx.lineJoin=window.chrome?"miter":"round",G.ctx.strokeText(K.text,K.bounds.left,K.bounds.top+_)),G.ctx.strokeStyle="",G.ctx.lineWidth=0,G.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,o,A){if(A&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var s=ap(r),d=op(o);this.path(d),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(A,0,0,r.intrinsicWidth,r.intrinsicHeight,s.left,s.top,s.width,s.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return wo(this,void 0,void 0,function(){var o,A,s,d,f,I,it,it,_,S,U,G,_t,L,K,Lt,V,q,z,it,At,_t,Lt;return Ys(this,function(Et){switch(Et.label){case 0:this.applyEffects(r.getEffects(4)),o=r.container,A=r.curves,s=o.styles,d=0,f=o.textNodes,Et.label=1;case 1:return d<f.length?(I=f[d],[4,this.renderTextNode(I,s)]):[3,4];case 2:Et.sent(),Et.label=3;case 3:return d++,[3,1];case 4:if(!(o instanceof Dw))return[3,8];Et.label=5;case 5:return Et.trys.push([5,7,,8]),[4,this.context.cache.match(o.src)];case 6:return it=Et.sent(),this.renderReplacedElement(o,A,it),[3,8];case 7:return Et.sent(),this.context.logger.error("Error loading image "+o.src),[3,8];case 8:if(o instanceof Kw&&this.renderReplacedElement(o,A,o.canvas),!(o instanceof zw))return[3,12];Et.label=9;case 9:return Et.trys.push([9,11,,12]),[4,this.context.cache.match(o.svg)];case 10:return it=Et.sent(),this.renderReplacedElement(o,A,it),[3,12];case 11:return Et.sent(),this.context.logger.error("Error loading svg "+o.svg.substring(0,255)),[3,12];case 12:return o instanceof Xw&&o.tree?(_=new t(this.context,{scale:this.options.scale,backgroundColor:o.backgroundColor,x:0,y:0,width:o.width,height:o.height}),[4,_.render(o.tree)]):[3,14];case 13:S=Et.sent(),o.width&&o.height&&this.ctx.drawImage(S,0,0,o.width,o.height,o.bounds.left,o.bounds.top,o.bounds.width,o.bounds.height),Et.label=14;case 14:if(o instanceof i0&&(U=Math.min(o.bounds.width,o.bounds.height),o.type===ep?o.checked&&(this.ctx.save(),this.path([new fi(o.bounds.left+U*.39363,o.bounds.top+U*.79),new fi(o.bounds.left+U*.16,o.bounds.top+U*.5549),new fi(o.bounds.left+U*.27347,o.bounds.top+U*.44071),new fi(o.bounds.left+U*.39694,o.bounds.top+U*.5649),new fi(o.bounds.left+U*.72983,o.bounds.top+U*.23),new fi(o.bounds.left+U*.84,o.bounds.top+U*.34085),new fi(o.bounds.left+U*.39363,o.bounds.top+U*.79)]),this.ctx.fillStyle=ds(Xv),this.ctx.fill(),this.ctx.restore()):o.type===ip&&o.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(o.bounds.left+U/2,o.bounds.top+U/2,U/4,0,Math.PI*2,!0),this.ctx.fillStyle=ds(Xv),this.ctx.fill(),this.ctx.restore())),OT(o)&&o.value.length){switch(G=this.createFontStyle(s),_t=G[0],L=G[1],K=this.fontMetrics.getMetrics(_t,L).baseline,this.ctx.font=_t,this.ctx.fillStyle=ds(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=JT(o.styles.textAlign),Lt=ap(o),V=0,o.styles.textAlign){case 1:V+=Lt.width/2;break;case 2:V+=Lt.width;break}q=Lt.add(V,0,0,-Lt.height/2+1),this.ctx.save(),this.path([new fi(Lt.left,Lt.top),new fi(Lt.left+Lt.width,Lt.top),new fi(Lt.left+Lt.width,Lt.top+Lt.height),new fi(Lt.left,Lt.top+Lt.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new ug(o.value,q),s.letterSpacing,K),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!rs(o.styles.display,2048))return[3,20];if(o.styles.listStyleImage===null)return[3,19];if(z=o.styles.listStyleImage,z.type!==0)return[3,18];it=void 0,At=z.url,Et.label=15;case 15:return Et.trys.push([15,17,,18]),[4,this.context.cache.match(At)];case 16:return it=Et.sent(),this.ctx.drawImage(it,o.bounds.left-(it.width+10),o.bounds.top),[3,18];case 17:return Et.sent(),this.context.logger.error("Error loading list-style-image "+At),[3,18];case 18:return[3,20];case 19:r.listValue&&o.styles.listStyleType!==-1&&(_t=this.createFontStyle(s)[0],this.ctx.font=_t,this.ctx.fillStyle=ds(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Lt=new _l(o.bounds.left,o.bounds.top+un(o.styles.paddingTop,o.bounds.width),o.bounds.width,Ev(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new ug(r.listValue,Lt),s.letterSpacing,Ev(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Et.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return wo(this,void 0,void 0,function(){var o,A,z,s,d,z,f,I,z,_,S,z,U,G,z,L,K,z,V,q,z;return Ys(this,function(it){switch(it.label){case 0:if(rs(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:it.sent(),o=0,A=r.negativeZIndex,it.label=2;case 2:return o<A.length?(z=A[o],[4,this.renderStack(z)]):[3,5];case 3:it.sent(),it.label=4;case 4:return o++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:it.sent(),s=0,d=r.nonInlineLevel,it.label=7;case 7:return s<d.length?(z=d[s],[4,this.renderNode(z)]):[3,10];case 8:it.sent(),it.label=9;case 9:return s++,[3,7];case 10:f=0,I=r.nonPositionedFloats,it.label=11;case 11:return f<I.length?(z=I[f],[4,this.renderStack(z)]):[3,14];case 12:it.sent(),it.label=13;case 13:return f++,[3,11];case 14:_=0,S=r.nonPositionedInlineLevel,it.label=15;case 15:return _<S.length?(z=S[_],[4,this.renderStack(z)]):[3,18];case 16:it.sent(),it.label=17;case 17:return _++,[3,15];case 18:U=0,G=r.inlineLevel,it.label=19;case 19:return U<G.length?(z=G[U],[4,this.renderNode(z)]):[3,22];case 20:it.sent(),it.label=21;case 21:return U++,[3,19];case 22:L=0,K=r.zeroOrAutoZIndexOrTransformedOrOpacity,it.label=23;case 23:return L<K.length?(z=K[L],[4,this.renderStack(z)]):[3,26];case 24:it.sent(),it.label=25;case 25:return L++,[3,23];case 26:V=0,q=r.positiveZIndex,it.label=27;case 27:return V<q.length?(z=q[V],[4,this.renderStack(z)]):[3,30];case 28:it.sent(),it.label=29;case 29:return V++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var o=this;r.forEach(function(A,s){var d=Ga(A)?A.start:A;s===0?o.ctx.moveTo(d.x,d.y):o.ctx.lineTo(d.x,d.y),Ga(A)&&o.ctx.bezierCurveTo(A.startControl.x,A.startControl.y,A.endControl.x,A.endControl.y,A.end.x,A.end.y)})},t.prototype.renderRepeat=function(r,o,A,s){this.path(r),this.ctx.fillStyle=o,this.ctx.translate(A,s),this.ctx.fill(),this.ctx.translate(-A,-s)},t.prototype.resizeImage=function(r,o,A){var s;if(r.width===o&&r.height===A)return r;var d=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,f=d.createElement("canvas");f.width=Math.max(1,o),f.height=Math.max(1,A);var I=f.getContext("2d");return I.drawImage(r,0,0,r.width,r.height,0,0,o,A),f},t.prototype.renderBackgroundImage=function(r){return wo(this,void 0,void 0,function(){var o,A,s,d,f,I;return Ys(this,function(_){switch(_.label){case 0:o=r.styles.backgroundImage.length-1,A=function(S){var U,G,L,ie,ee,qt,St,Bt,It,K,ie,ee,qt,St,Bt,V,q,z,it,At,_t,Lt,Et,xt,It,Nt,ie,lt,at,St,Bt,se,ee,qt,Xt,vt,Tt,pe,j,mt,yt,Qt;return Ys(this,function(Ht){switch(Ht.label){case 0:if(S.type!==0)return[3,5];U=void 0,G=S.url,Ht.label=1;case 1:return Ht.trys.push([1,3,,4]),[4,s.context.cache.match(G)];case 2:return U=Ht.sent(),[3,4];case 3:return Ht.sent(),s.context.logger.error("Error loading background-image "+G),[3,4];case 4:return U&&(L=SC(r,o,[U.width,U.height,U.width/U.height]),ie=L[0],ee=L[1],qt=L[2],St=L[3],Bt=L[4],It=s.ctx.createPattern(s.resizeImage(U,St,Bt),"repeat"),s.renderRepeat(ie,It,ee,qt)),[3,6];case 5:Ek(S)?(K=SC(r,o,[null,null,null]),ie=K[0],ee=K[1],qt=K[2],St=K[3],Bt=K[4],V=xk(S.angle,St,Bt),q=V[0],z=V[1],it=V[2],At=V[3],_t=V[4],Lt=document.createElement("canvas"),Lt.width=St,Lt.height=Bt,Et=Lt.getContext("2d"),xt=Et.createLinearGradient(z,At,it,_t),kv(S.stops,q).forEach(function(ae){return xt.addColorStop(ae.stop,ds(ae.color))}),Et.fillStyle=xt,Et.fillRect(0,0,St,Bt),St>0&&Bt>0&&(It=s.ctx.createPattern(Lt,"repeat"),s.renderRepeat(ie,It,ee,qt))):Tk(S)&&(Nt=SC(r,o,[null,null,null]),ie=Nt[0],lt=Nt[1],at=Nt[2],St=Nt[3],Bt=Nt[4],se=S.position.length===0?[qC]:S.position,ee=un(se[0],St),qt=un(se[se.length-1],Bt),Xt=Sk(S,ee,qt,St,Bt),vt=Xt[0],Tt=Xt[1],vt>0&&Tt>0&&(pe=s.ctx.createRadialGradient(lt+ee,at+qt,0,lt+ee,at+qt,vt),kv(S.stops,vt*2).forEach(function(ae){return pe.addColorStop(ae.stop,ds(ae.color))}),s.path(ie),s.ctx.fillStyle=pe,vt!==Tt?(j=r.bounds.left+.5*r.bounds.width,mt=r.bounds.top+.5*r.bounds.height,yt=Tt/vt,Qt=1/yt,s.ctx.save(),s.ctx.translate(j,mt),s.ctx.transform(1,0,0,yt,0,0),s.ctx.translate(-j,-mt),s.ctx.fillRect(lt,Qt*(at-mt)+mt,St,Bt*Qt),s.ctx.restore()):s.ctx.fill())),Ht.label=6;case 6:return o--,[2]}})},s=this,d=0,f=r.styles.backgroundImage.slice(0).reverse(),_.label=1;case 1:return d<f.length?(I=f[d],[5,A(I)]):[3,4];case 2:_.sent(),_.label=3;case 3:return d++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,o,A){return wo(this,void 0,void 0,function(){return Ys(this,function(s){return this.path(aw(A,o)),this.ctx.fillStyle=ds(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,o,A,s){return wo(this,void 0,void 0,function(){var d,f;return Ys(this,function(I){switch(I.label){case 0:return o<3?[4,this.renderSolidBorder(r,A,s)]:[3,2];case 1:return I.sent(),[2];case 2:return d=RT(s,A),this.path(d),this.ctx.fillStyle=ds(r),this.ctx.fill(),f=GT(s,A),this.path(f),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return wo(this,void 0,void 0,function(){var o,A,s,d,f,I,_,S,U=this;return Ys(this,function(G){switch(G.label){case 0:return this.applyEffects(r.getEffects(2)),o=r.container.styles,A=!oc(o.backgroundColor)||o.backgroundImage.length,s=[{style:o.borderTopStyle,color:o.borderTopColor,width:o.borderTopWidth},{style:o.borderRightStyle,color:o.borderRightColor,width:o.borderRightWidth},{style:o.borderBottomStyle,color:o.borderBottomColor,width:o.borderBottomWidth},{style:o.borderLeftStyle,color:o.borderLeftColor,width:o.borderLeftWidth}],d=WT(Mu(o.backgroundClip,0),r.curves),A||o.boxShadow.length?(this.ctx.save(),this.path(d),this.ctx.clip(),oc(o.backgroundColor)||(this.ctx.fillStyle=ds(o.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:G.sent(),this.ctx.restore(),o.boxShadow.slice(0).reverse().forEach(function(L){U.ctx.save();var K=sp(r.curves),V=L.inset?0:KT,q=UT(K,-V+(L.inset?1:-1)*L.spread.number,(L.inset?1:-1)*L.spread.number,L.spread.number*(L.inset?-2:2),L.spread.number*(L.inset?-2:2));L.inset?(U.path(K),U.ctx.clip(),U.mask(q)):(U.mask(K),U.ctx.clip(),U.path(q)),U.ctx.shadowOffsetX=L.offsetX.number+V,U.ctx.shadowOffsetY=L.offsetY.number,U.ctx.shadowColor=ds(L.color),U.ctx.shadowBlur=L.blur.number,U.ctx.fillStyle=L.inset?ds(L.color):"rgba(0,0,0,1)",U.ctx.fill(),U.ctx.restore()}),G.label=2;case 2:f=0,I=0,_=s,G.label=3;case 3:return I<_.length?(S=_[I],S.style!==0&&!oc(S.color)&&S.width>0?S.style!==2?[3,5]:[4,this.renderDashedDottedBorder(S.color,S.width,f,r.curves,2)]:[3,11]):[3,13];case 4:return G.sent(),[3,11];case 5:return S.style!==3?[3,7]:[4,this.renderDashedDottedBorder(S.color,S.width,f,r.curves,3)];case 6:return G.sent(),[3,11];case 7:return S.style!==4?[3,9]:[4,this.renderDoubleBorder(S.color,S.width,f,r.curves)];case 8:return G.sent(),[3,11];case 9:return[4,this.renderSolidBorder(S.color,f,r.curves)];case 10:G.sent(),G.label=11;case 11:f++,G.label=12;case 12:return I++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,o,A,s,d){return wo(this,void 0,void 0,function(){var f,I,_,S,U,G,L,K,V,q,z,it,At,_t,Lt,Et,Lt,Et;return Ys(this,function(xt){return this.ctx.save(),f=ZT(s,A),I=aw(s,A),d===2&&(this.path(I),this.ctx.clip()),Ga(I[0])?(_=I[0].start.x,S=I[0].start.y):(_=I[0].x,S=I[0].y),Ga(I[1])?(U=I[1].end.x,G=I[1].end.y):(U=I[1].x,G=I[1].y),A===0||A===2?L=Math.abs(_-U):L=Math.abs(S-G),this.ctx.beginPath(),d===3?this.formatPath(f):this.formatPath(I.slice(0,2)),K=o<3?o*3:o*2,V=o<3?o*2:o,d===3&&(K=o,V=o),q=!0,L<=K*2?q=!1:L<=K*2+V?(z=L/(2*K+V),K*=z,V*=z):(it=Math.floor((L+V)/(K+V)),At=(L-it*K)/(it-1),_t=(L-(it+1)*K)/it,V=_t<=0||Math.abs(V-At)<Math.abs(V-_t)?At:_t),q&&(d===3?this.ctx.setLineDash([0,K+V]):this.ctx.setLineDash([K,V])),d===3?(this.ctx.lineCap="round",this.ctx.lineWidth=o):this.ctx.lineWidth=o*2+1.1,this.ctx.strokeStyle=ds(r),this.ctx.stroke(),this.ctx.setLineDash([]),d===2&&(Ga(I[0])&&(Lt=I[3],Et=I[0],this.ctx.beginPath(),this.formatPath([new fi(Lt.end.x,Lt.end.y),new fi(Et.start.x,Et.start.y)]),this.ctx.stroke()),Ga(I[1])&&(Lt=I[1],Et=I[2],this.ctx.beginPath(),this.formatPath([new fi(Lt.end.x,Lt.end.y),new fi(Et.start.x,Et.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return wo(this,void 0,void 0,function(){var o;return Ys(this,function(A){switch(A.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=ds(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),o=QT(r),[4,this.renderStack(o)];case 1:return A.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(u2),OT=function(n){return n instanceof Jw||n instanceof Ww?!0:n instanceof i0&&n.type!==ip&&n.type!==ep},WT=function(n,t){switch(n){case 0:return sp(t);case 2:return FT(t);case 1:default:return op(t)}},JT=function(n){switch(n){case 1:return"center";case 2:return"right";case 0:default:return"left"}},XT=["-apple-system","system-ui"],YT=function(n){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?n.filter(function(t){return XT.indexOf(t)===-1}):n},jT=function(n){nA(t,n);function t(r,o){var A=n.call(this,r,o)||this;return A.canvas=o.canvas?o.canvas:document.createElement("canvas"),A.ctx=A.canvas.getContext("2d"),A.options=o,A.canvas.width=Math.floor(o.width*o.scale),A.canvas.height=Math.floor(o.height*o.scale),A.canvas.style.width=o.width+"px",A.canvas.style.height=o.height+"px",A.ctx.scale(A.options.scale,A.options.scale),A.ctx.translate(-o.x,-o.y),A.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+o.width+"x"+o.height+" at "+o.x+","+o.y+") with scale "+o.scale),A}return t.prototype.render=function(r){return wo(this,void 0,void 0,function(){var o,A;return Ys(this,function(s){switch(s.label){case 0:return o=KC(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,qT(o)];case 1:return A=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=ds(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(A,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(u2),qT=function(n){return new Promise(function(t,r){var o=new Image;o.onload=function(){t(o)},o.onerror=r,o.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(n))})},$T=function(){function n(t){var r=t.id,o=t.enabled;this.id=r,this.enabled=o,this.start=Date.now()}return n.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Ld([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},n.prototype.getTime=function(){return Date.now()-this.start},n.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Ld([this.id,this.getTime()+"ms"],t))},n.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Ld([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},n.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Ld([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},n.instances={},n}(),tU=function(){function n(t,r){var o;this.windowBounds=r,this.instanceName="#"+n.instanceCount++,this.logger=new $T({id:this.instanceName,enabled:t.logging}),this.cache=(o=t.cache)!==null&&o!==void 0?o:new yT(this,t)}return n.instanceCount=1,n}(),eU=function(n,t){return t===void 0&&(t={}),iU(n,t)};typeof window<"u"&&s2.setContext(window);iU=function(n,t){return wo(void 0,void 0,void 0,function(){var r,o,A,s,d,f,I,_,S,U,G,L,K,V,q,z,it,At,_t,Lt,xt,Et,xt,It,Nt,ie,lt,at,St,Bt,se,ee,qt,Xt,vt,Tt,pe,j,mt,yt;return Ys(this,function(Qt){switch(Qt.label){case 0:if(!n||typeof n!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=n.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(o=r.defaultView,!o)throw new Error("Document is not attached to a Window");return A={allowTaint:(It=t.allowTaint)!==null&&It!==void 0?It:!1,imageTimeout:(Nt=t.imageTimeout)!==null&&Nt!==void 0?Nt:15e3,proxy:t.proxy,useCORS:(ie=t.useCORS)!==null&&ie!==void 0?ie:!1},s=kC({logging:(lt=t.logging)!==null&&lt!==void 0?lt:!0,cache:t.cache},A),d={windowWidth:(at=t.windowWidth)!==null&&at!==void 0?at:o.innerWidth,windowHeight:(St=t.windowHeight)!==null&&St!==void 0?St:o.innerHeight,scrollX:(Bt=t.scrollX)!==null&&Bt!==void 0?Bt:o.pageXOffset,scrollY:(se=t.scrollY)!==null&&se!==void 0?se:o.pageYOffset},f=new _l(d.scrollX,d.scrollY,d.windowWidth,d.windowHeight),I=new tU(s,f),_=(ee=t.foreignObjectRendering)!==null&&ee!==void 0?ee:!1,S={allowTaint:(qt=t.allowTaint)!==null&&qt!==void 0?qt:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:_,copyStyles:_},I.logger.debug("Starting document clone with size "+f.width+"x"+f.height+" scrolled to "+-f.left+","+-f.top),U=new nw(I,n,S),G=U.clonedReferenceElement,G?[4,U.toIFrame(r,f)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return L=Qt.sent(),K=r0(G)||rT(G)?U3(G.ownerDocument):Ap(I,G),V=K.width,q=K.height,z=K.left,it=K.top,At=rU(I,G,t.backgroundColor),_t={canvas:t.canvas,backgroundColor:At,scale:(vt=(Xt=t.scale)!==null&&Xt!==void 0?Xt:o.devicePixelRatio)!==null&&vt!==void 0?vt:1,x:((Tt=t.x)!==null&&Tt!==void 0?Tt:0)+z,y:((pe=t.y)!==null&&pe!==void 0?pe:0)+it,width:(j=t.width)!==null&&j!==void 0?j:Math.ceil(V),height:(mt=t.height)!==null&&mt!==void 0?mt:Math.ceil(q)},_?(I.logger.debug("Document cloned, using foreign object rendering"),xt=new jT(I,_t),[4,xt.render(G)]):[3,3];case 2:return Lt=Qt.sent(),[3,5];case 3:return I.logger.debug("Document cloned, element located at "+z+","+it+" with size "+V+"x"+q+" using computed rendering"),I.logger.debug("Starting DOM parsing"),Et=jw(I,G),At===Et.styles.backgroundColor&&(Et.styles.backgroundColor=Bl.TRANSPARENT),I.logger.debug("Starting renderer for element at "+_t.x+","+_t.y+" with size "+_t.width+"x"+_t.height),xt=new zT(I,_t),[4,xt.render(Et)];case 4:Lt=Qt.sent(),Qt.label=5;case 5:return(!((yt=t.removeContainer)!==null&&yt!==void 0)||yt)&&(nw.destroy(L)||I.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),I.logger.debug("Finished rendering"),[2,Lt]}})})},rU=function(n,t,r){var o=t.ownerDocument,A=o.documentElement?lg(n,getComputedStyle(o.documentElement).backgroundColor):Bl.TRANSPARENT,s=o.body?lg(n,getComputedStyle(o.body).backgroundColor):Bl.TRANSPARENT,d=typeof r=="string"?lg(n,r):r===null?Bl.TRANSPARENT:4294967295;return t===o.documentElement?oc(A)?oc(s)?d:s:A:d}});var v2={};tC(v2,{default:()=>TU});function Ac(n){return Ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ac(n)}function c0(n,t){return c0=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},c0(n,t)}function nU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yp(n,t,r){return nU()?yp=Reflect.construct:yp=function(o,A,s){var d=[null];d.push.apply(d,A);var f=Function.bind.apply(o,d),I=new f;return s&&c0(I,s.prototype),I},yp.apply(null,arguments)}function oA(n){return sU(n)||oU(n)||aU(n)||AU()}function sU(n){if(Array.isArray(n))return u0(n)}function oU(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function aU(n,t){if(n){if(typeof n=="string")return u0(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor&&(r=n.constructor.name),r==="Map"||r==="Set")return Array.from(n);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u0(n,t)}}function u0(n,t){(t==null||t>n.length)&&(t=n.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=n[r];return o}function AU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ha(n){return function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),A=1;A<r;A++)o[A-1]=arguments[A];return vp(n,t,o)}}function CU(n){return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return h0(n,r)}}function pr(n,t,r){var o;r=(o=r)!==null&&o!==void 0?o:bp,d2&&d2(n,null);for(var A=t.length;A--;){var s=t[A];if(typeof s=="string"){var d=r(s);d!==s&&(cU(t)||(t[A]=d),s=d)}n[s]=!0}return n}function Vc(n){var t=gU(null),r;for(r in n)vp(lU,n,[r])===!0&&(t[r]=n[r]);return t}function Cp(n,t){for(;n!==null;){var r=hU(n,t);if(r){if(r.get)return Ha(r.get);if(typeof r.value=="function")return Ha(r.value)}n=uU(n)}function o(A){return console.warn("fallback value for",A),null}return o}function b2(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:LU(),t=function(Zt){return b2(Zt)};if(t.version="2.4.7",t.removed=[],!n||!n.document||n.document.nodeType!==9)return t.isSupported=!1,t;var r=n.document,o=n.document,A=n.DocumentFragment,s=n.HTMLTemplateElement,d=n.Node,f=n.Element,I=n.NodeFilter,_=n.NamedNodeMap,S=_===void 0?n.NamedNodeMap||n.MozNamedAttrMap:_,U=n.HTMLFormElement,G=n.DOMParser,L=n.trustedTypes,K=f.prototype,V=Cp(K,"cloneNode"),q=Cp(K,"nextSibling"),z=Cp(K,"childNodes"),it=Cp(K,"parentNode");if(typeof s=="function"){var At=o.createElement("template");At.content&&At.content.ownerDocument&&(o=At.content.ownerDocument)}var _t=EU(L,r),Lt=_t?_t.createHTML(""):"",Et=o,xt=Et.implementation,It=Et.createNodeIterator,Nt=Et.createDocumentFragment,ie=Et.getElementsByTagName,lt=r.importNode,at={};try{at=Vc(o).documentMode?o.documentMode:{}}catch{}var St={};t.isSupported=typeof it=="function"&&xt&&xt.createHTMLDocument!==void 0&&at!==9;var Bt=bU,se=vU,ee=wU,qt=BU,Xt=_U,vt=SU,Tt=FU,pe=xU,j=null,mt=pr({},[].concat(oA(f2),oA(o0),oA(a0),oA(A0),oA(m2))),yt=null,Qt=pr({},[].concat(oA(C2),oA(l0),oA(I2),oA(Ip))),Ht=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ae=null,ge=null,de=!0,Ze=!0,Re=!1,Je=!0,Xe=!1,Kt=!1,Ce=!1,Ut=!1,Ye=!1,Oe=!1,Qe=!1,Ne=!0,ze=!1,We="user-content-",ri=!0,hi=!1,Ti={},fe=null,Ni=pr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Di=null,mi=pr({},["audio","video","img","source","image","track"]),Gi=null,le=pr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),gi="http://www.w3.org/1998/Math/MathML",Ke="http://www.w3.org/2000/svg",or="http://www.w3.org/1999/xhtml",Ki=or,ii=!1,br=null,Ji=pr({},[gi,Ke,or],n0),wr,ar=["application/xhtml+xml","text/html"],wt="text/html",W,X=null,rt=o.createElement("form"),ft=function(Zt){return Zt instanceof RegExp||Zt instanceof Function},Mt=function(Zt){X&&X===Zt||((!Zt||Ac(Zt)!=="object")&&(Zt={}),Zt=Vc(Zt),wr=ar.indexOf(Zt.PARSER_MEDIA_TYPE)===-1?wr=wt:wr=Zt.PARSER_MEDIA_TYPE,W=wr==="application/xhtml+xml"?n0:bp,j="ALLOWED_TAGS"in Zt?pr({},Zt.ALLOWED_TAGS,W):mt,yt="ALLOWED_ATTR"in Zt?pr({},Zt.ALLOWED_ATTR,W):Qt,br="ALLOWED_NAMESPACES"in Zt?pr({},Zt.ALLOWED_NAMESPACES,n0):Ji,Gi="ADD_URI_SAFE_ATTR"in Zt?pr(Vc(le),Zt.ADD_URI_SAFE_ATTR,W):le,Di="ADD_DATA_URI_TAGS"in Zt?pr(Vc(mi),Zt.ADD_DATA_URI_TAGS,W):mi,fe="FORBID_CONTENTS"in Zt?pr({},Zt.FORBID_CONTENTS,W):Ni,ae="FORBID_TAGS"in Zt?pr({},Zt.FORBID_TAGS,W):{},ge="FORBID_ATTR"in Zt?pr({},Zt.FORBID_ATTR,W):{},Ti="USE_PROFILES"in Zt?Zt.USE_PROFILES:!1,de=Zt.ALLOW_ARIA_ATTR!==!1,Ze=Zt.ALLOW_DATA_ATTR!==!1,Re=Zt.ALLOW_UNKNOWN_PROTOCOLS||!1,Je=Zt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Xe=Zt.SAFE_FOR_TEMPLATES||!1,Kt=Zt.WHOLE_DOCUMENT||!1,Ye=Zt.RETURN_DOM||!1,Oe=Zt.RETURN_DOM_FRAGMENT||!1,Qe=Zt.RETURN_TRUSTED_TYPE||!1,Ut=Zt.FORCE_BODY||!1,Ne=Zt.SANITIZE_DOM!==!1,ze=Zt.SANITIZE_NAMED_PROPS||!1,ri=Zt.KEEP_CONTENT!==!1,hi=Zt.IN_PLACE||!1,pe=Zt.ALLOWED_URI_REGEXP||pe,Ki=Zt.NAMESPACE||or,Ht=Zt.CUSTOM_ELEMENT_HANDLING||{},Zt.CUSTOM_ELEMENT_HANDLING&&ft(Zt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ht.tagNameCheck=Zt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Zt.CUSTOM_ELEMENT_HANDLING&&ft(Zt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ht.attributeNameCheck=Zt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Zt.CUSTOM_ELEMENT_HANDLING&&typeof Zt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ht.allowCustomizedBuiltInElements=Zt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Xe&&(Ze=!1),Oe&&(Ye=!0),Ti&&(j=pr({},oA(m2)),yt=[],Ti.html===!0&&(pr(j,f2),pr(yt,C2)),Ti.svg===!0&&(pr(j,o0),pr(yt,l0),pr(yt,Ip)),Ti.svgFilters===!0&&(pr(j,a0),pr(yt,l0),pr(yt,Ip)),Ti.mathMl===!0&&(pr(j,A0),pr(yt,I2),pr(yt,Ip))),Zt.ADD_TAGS&&(j===mt&&(j=Vc(j)),pr(j,Zt.ADD_TAGS,W)),Zt.ADD_ATTR&&(yt===Qt&&(yt=Vc(yt)),pr(yt,Zt.ADD_ATTR,W)),Zt.ADD_URI_SAFE_ATTR&&pr(Gi,Zt.ADD_URI_SAFE_ATTR,W),Zt.FORBID_CONTENTS&&(fe===Ni&&(fe=Vc(fe)),pr(fe,Zt.FORBID_CONTENTS,W)),ri&&(j["#text"]=!0),Kt&&pr(j,["html","head","body"]),j.table&&(pr(j,["tbody"]),delete ae.tbody),xo&&xo(Zt),X=Zt)},Vt=pr({},["mi","mo","mn","ms","mtext"]),Yt=pr({},["foreignobject","desc","title","annotation-xml"]),Rt=pr({},["title","style","font","a","script"]),Wt=pr({},o0);pr(Wt,a0),pr(Wt,IU);var be=pr({},A0);pr(be,yU);var he=function(Zt){var De=it(Zt);(!De||!De.tagName)&&(De={namespaceURI:Ki,tagName:"template"});var Te=bp(Zt.tagName),tr=bp(De.tagName);return br[Zt.namespaceURI]?Zt.namespaceURI===Ke?De.namespaceURI===or?Te==="svg":De.namespaceURI===gi?Te==="svg"&&(tr==="annotation-xml"||Vt[tr]):!!Wt[Te]:Zt.namespaceURI===gi?De.namespaceURI===or?Te==="math":De.namespaceURI===Ke?Te==="math"&&Yt[tr]:!!be[Te]:Zt.namespaceURI===or?De.namespaceURI===Ke&&!Yt[tr]||De.namespaceURI===gi&&!Vt[tr]?!1:!be[Te]&&(Rt[Te]||!Wt[Te]):!!(wr==="application/xhtml+xml"&&br[Zt.namespaceURI]):!1},Le=function(Zt){Cg(t.removed,{element:Zt});try{Zt.parentNode.removeChild(Zt)}catch{try{Zt.outerHTML=Lt}catch{Zt.remove()}}},je=function(Zt,De){try{Cg(t.removed,{attribute:De.getAttributeNode(Zt),from:De})}catch{Cg(t.removed,{attribute:null,from:De})}if(De.removeAttribute(Zt),Zt==="is"&&!yt[Zt])if(Ye||Oe)try{Le(De)}catch{}else try{De.setAttribute(Zt,"")}catch{}},ti=function(Zt){var De,Te;if(Ut)Zt="<remove></remove>"+Zt;else{var tr=pU(Zt,/^[\r\n\t ]+/);Te=tr&&tr[0]}wr==="application/xhtml+xml"&&Ki===or&&(Zt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Zt+"</body></html>");var Ui=_t?_t.createHTML(Zt):Zt;if(Ki===or)try{De=new G().parseFromString(Ui,wr)}catch{}if(!De||!De.documentElement){De=xt.createDocument(Ki,"template",null);try{De.documentElement.innerHTML=ii?Lt:Ui}catch{}}var an=De.body||De.documentElement;return Zt&&Te&&an.insertBefore(o.createTextNode(Te),an.childNodes[0]||null),Ki===or?ie.call(De,Kt?"html":"body")[0]:Kt?De.documentElement:an},_i=function(Zt){return It.call(Zt.ownerDocument||Zt,Zt,I.SHOW_ELEMENT|I.SHOW_COMMENT|I.SHOW_TEXT,null,!1)},$i=function(Zt){return Zt instanceof U&&(typeof Zt.nodeName!="string"||typeof Zt.textContent!="string"||typeof Zt.removeChild!="function"||!(Zt.attributes instanceof S)||typeof Zt.removeAttribute!="function"||typeof Zt.setAttribute!="function"||typeof Zt.namespaceURI!="string"||typeof Zt.insertBefore!="function"||typeof Zt.hasChildNodes!="function")},xi=function(Zt){return Ac(d)==="object"?Zt instanceof d:Zt&&Ac(Zt)==="object"&&typeof Zt.nodeType=="number"&&typeof Zt.nodeName=="string"},zi=function(Zt,De,Te){St[Zt]&&dU(St[Zt],function(tr){tr.call(t,De,Te,X)})},hr=function(Zt){var De;if(zi("beforeSanitizeElements",Zt,null),$i(Zt)||_o(/[\u0080-\uFFFF]/,Zt.nodeName))return Le(Zt),!0;var Te=W(Zt.nodeName);if(zi("uponSanitizeElement",Zt,{tagName:Te,allowedTags:j}),Zt.hasChildNodes()&&!xi(Zt.firstElementChild)&&(!xi(Zt.content)||!xi(Zt.content.firstElementChild))&&_o(/<[/\w]/g,Zt.innerHTML)&&_o(/<[/\w]/g,Zt.textContent)||Te==="select"&&_o(/<template/i,Zt.innerHTML))return Le(Zt),!0;if(!j[Te]||ae[Te]){if(!ae[Te]&&Hi(Te)&&(Ht.tagNameCheck instanceof RegExp&&_o(Ht.tagNameCheck,Te)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(Te)))return!1;if(ri&&!fe[Te]){var tr=it(Zt)||Zt.parentNode,Ui=z(Zt)||Zt.childNodes;if(Ui&&tr)for(var an=Ui.length,Fr=an-1;Fr>=0;--Fr)tr.insertBefore(V(Ui[Fr],!0),q(Zt))}return Le(Zt),!0}return Zt instanceof f&&!he(Zt)||(Te==="noscript"||Te==="noembed"||Te==="noframes")&&_o(/<\/no(script|embed|frames)/i,Zt.innerHTML)?(Le(Zt),!0):(Xe&&Zt.nodeType===3&&(De=Zt.textContent,De=sA(De,Bt," "),De=sA(De,se," "),De=sA(De,ee," "),Zt.textContent!==De&&(Cg(t.removed,{element:Zt.cloneNode()}),Zt.textContent=De)),zi("afterSanitizeElements",Zt,null),!1)},fr=function(Zt,De,Te){if(Ne&&(De==="id"||De==="name")&&(Te in o||Te in rt))return!1;if(!(Ze&&!ge[De]&&_o(qt,De))&&!(de&&_o(Xt,De))){if(!yt[De]||ge[De]){if(!(Hi(Zt)&&(Ht.tagNameCheck instanceof RegExp&&_o(Ht.tagNameCheck,Zt)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(Zt))&&(Ht.attributeNameCheck instanceof RegExp&&_o(Ht.attributeNameCheck,De)||Ht.attributeNameCheck instanceof Function&&Ht.attributeNameCheck(De))||De==="is"&&Ht.allowCustomizedBuiltInElements&&(Ht.tagNameCheck instanceof RegExp&&_o(Ht.tagNameCheck,Te)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(Te))))return!1}else if(!Gi[De]&&!_o(pe,sA(Te,Tt,""))&&!((De==="src"||De==="xlink:href"||De==="href")&&Zt!=="script"&&fU(Te,"data:")===0&&Di[Zt])&&!(Re&&!_o(vt,sA(Te,Tt,"")))&&Te)return!1}return!0},Hi=function(Zt){return Zt.indexOf("-")>0},Wi=function(Zt){var De,Te,tr,Ui;zi("beforeSanitizeAttributes",Zt,null);var an=Zt.attributes;if(an){var Fr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:yt};for(Ui=an.length;Ui--;){De=an[Ui];var $r=De,Ir=$r.name,hn=$r.namespaceURI;if(Te=Ir==="value"?De.value:mU(De.value),tr=W(Ir),Fr.attrName=tr,Fr.attrValue=Te,Fr.keepAttr=!0,Fr.forceKeepAttr=void 0,zi("uponSanitizeAttribute",Zt,Fr),Te=Fr.attrValue,!Fr.forceKeepAttr&&(je(Ir,Zt),!!Fr.keepAttr)){if(!Je&&_o(/\/>/i,Te)){je(Ir,Zt);continue}Xe&&(Te=sA(Te,Bt," "),Te=sA(Te,se," "),Te=sA(Te,ee," "));var pn=W(Zt.nodeName);if(fr(pn,tr,Te)){if(ze&&(tr==="id"||tr==="name")&&(je(Ir,Zt),Te=We+Te),_t&&Ac(L)==="object"&&typeof L.getAttributeType=="function"&&!hn)switch(L.getAttributeType(pn,tr)){case"TrustedHTML":{Te=_t.createHTML(Te);break}case"TrustedScriptURL":{Te=_t.createScriptURL(Te);break}}try{hn?Zt.setAttributeNS(hn,Ir,Te):Zt.setAttribute(Ir,Te),p2(t.removed)}catch{}}}}zi("afterSanitizeAttributes",Zt,null)}},Ar=function Zt(De){var Te,tr=_i(De);for(zi("beforeSanitizeShadowDOM",De,null);Te=tr.nextNode();)zi("uponSanitizeShadowNode",Te,null),!hr(Te)&&(Te.content instanceof A&&Zt(Te.content),Wi(Te));zi("afterSanitizeShadowDOM",De,null)};return t.sanitize=function(Zt){var De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Te,tr,Ui,an,Fr;if(ii=!Zt,ii&&(Zt="<!-->"),typeof Zt!="string"&&!xi(Zt))if(typeof Zt.toString=="function"){if(Zt=Zt.toString(),typeof Zt!="string")throw s0("dirty is not a string, aborting")}else throw s0("toString is not a function");if(!t.isSupported){if(Ac(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof Zt=="string")return n.toStaticHTML(Zt);if(xi(Zt))return n.toStaticHTML(Zt.outerHTML)}return Zt}if(Ce||Mt(De),t.removed=[],typeof Zt=="string"&&(hi=!1),hi){if(Zt.nodeName){var $r=W(Zt.nodeName);if(!j[$r]||ae[$r])throw s0("root node is forbidden and cannot be sanitized in-place")}}else if(Zt instanceof d)Te=ti("<!---->"),tr=Te.ownerDocument.importNode(Zt,!0),tr.nodeType===1&&tr.nodeName==="BODY"||tr.nodeName==="HTML"?Te=tr:Te.appendChild(tr);else{if(!Ye&&!Xe&&!Kt&&Zt.indexOf("<")===-1)return _t&&Qe?_t.createHTML(Zt):Zt;if(Te=ti(Zt),!Te)return Ye?null:Qe?Lt:""}Te&&Ut&&Le(Te.firstChild);for(var Ir=_i(hi?Zt:Te);Ui=Ir.nextNode();)Ui.nodeType===3&&Ui===an||hr(Ui)||(Ui.content instanceof A&&Ar(Ui.content),Wi(Ui),an=Ui);if(an=null,hi)return Zt;if(Ye){if(Oe)for(Fr=Nt.call(Te.ownerDocument);Te.firstChild;)Fr.appendChild(Te.firstChild);else Fr=Te;return(yt.shadowroot||yt.shadowrootmod)&&(Fr=lt.call(r,Fr,!0)),Fr}var hn=Kt?Te.outerHTML:Te.innerHTML;return Kt&&j["!doctype"]&&Te.ownerDocument&&Te.ownerDocument.doctype&&Te.ownerDocument.doctype.name&&_o(kU,Te.ownerDocument.doctype.name)&&(hn="<!DOCTYPE "+Te.ownerDocument.doctype.name+`>
`+hn),Xe&&(hn=sA(hn,Bt," "),hn=sA(hn,se," "),hn=sA(hn,ee," ")),_t&&Qe?_t.createHTML(hn):hn},t.setConfig=function(Zt){Mt(Zt),Ce=!0},t.clearConfig=function(){X=null,Ce=!1},t.isValidAttribute=function(Zt,De,Te){X||Mt({});var tr=W(Zt),Ui=W(De);return fr(tr,Ui,Te)},t.addHook=function(Zt,De){typeof De=="function"&&(St[Zt]=St[Zt]||[],Cg(St[Zt],De))},t.removeHook=function(Zt){if(St[Zt])return p2(St[Zt])},t.removeHooks=function(Zt){St[Zt]&&(St[Zt]=[])},t.removeAllHooks=function(){St={}},t}var lU,d2,cU,uU,hU,xo,aA,gU,y2,vp,h0,dU,p2,Cg,bp,n0,pU,sA,fU,mU,_o,s0,f2,o0,a0,IU,A0,yU,m2,C2,l0,I2,Ip,bU,vU,wU,BU,_U,xU,SU,FU,kU,LU,EU,TU,w2=wd(()=>{lU=Object.hasOwnProperty,d2=Object.setPrototypeOf,cU=Object.isFrozen,uU=Object.getPrototypeOf,hU=Object.getOwnPropertyDescriptor,xo=Object.freeze,aA=Object.seal,gU=Object.create,y2=typeof Reflect<"u"&&Reflect,vp=y2.apply,h0=y2.construct;vp||(vp=function(n,t,r){return n.apply(t,r)});xo||(xo=function(n){return n});aA||(aA=function(n){return n});h0||(h0=function(n,t){return yp(n,oA(t))});dU=Ha(Array.prototype.forEach),p2=Ha(Array.prototype.pop),Cg=Ha(Array.prototype.push),bp=Ha(String.prototype.toLowerCase),n0=Ha(String.prototype.toString),pU=Ha(String.prototype.match),sA=Ha(String.prototype.replace),fU=Ha(String.prototype.indexOf),mU=Ha(String.prototype.trim),_o=Ha(RegExp.prototype.test),s0=CU(TypeError);f2=xo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),o0=xo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),a0=xo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),IU=xo(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),A0=xo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),yU=xo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),m2=xo(["#text"]),C2=xo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),l0=xo(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),I2=xo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ip=xo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),bU=aA(/\{\{[\w\W]*|[\w\W]*\}\}/gm),vU=aA(/<%[\w\W]*|[\w\W]*%>/gm),wU=aA(/\${[\w\W]*}/gm),BU=aA(/^data-[\-\w.\u00B7-\uFFFF]/),_U=aA(/^aria-[\-\w]+$/),xU=aA(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),SU=aA(/^(?:\w+script|data):/i),FU=aA(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),kU=aA(/^html$/i),LU=function(){return typeof window>"u"?null:window},EU=function(n,t){if(Ac(n)!=="object"||typeof n.createPolicy!="function")return null;var r=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(r=t.currentScript.getAttribute(o));var A="dompurify"+(r?"#"+r:"");try{return n.createPolicy(A,{createHTML:function(s){return s},createScriptURL:function(s){return s}})}catch{return console.warn("TrustedTypes policy "+A+" could not be created."),null}};TU=b2()});var f5={};tC(f5,{AElement:()=>Bf,AnimateColorElement:()=>Cf,AnimateElement:()=>Ah,AnimateTransformElement:()=>If,BoundingBox:()=>Do,CB1:()=>ZI,CB2:()=>PI,CB3:()=>HI,CB4:()=>MI,Canvg:()=>uc,CircleElement:()=>Af,ClipPathElement:()=>Lf,DefsElement:()=>df,DescElement:()=>Gf,Document:()=>hA,Element:()=>qr,EllipseElement:()=>lf,FeColorMatrixElement:()=>Hg,FeCompositeElement:()=>Uf,FeDropShadowElement:()=>Ef,FeGaussianBlurElement:()=>Qf,FeMorphologyElement:()=>Tf,FilterElement:()=>$c,Font:()=>ps,FontElement:()=>yf,FontFaceElement:()=>bf,GElement:()=>ah,GlyphElement:()=>Qg,GradientElement:()=>Zg,ImageElement:()=>xf,LineElement:()=>cf,LinearGradientElement:()=>pf,MarkerElement:()=>gf,MaskElement:()=>qc,Matrix:()=>Tg,MissingGlyphElement:()=>vf,Mouse:()=>tf,PSEUDO_ZERO:()=>Jc,Parser:()=>rh,PathElement:()=>Ur,PathParser:()=>sr,PatternElement:()=>hf,Point:()=>In,PolygonElement:()=>uf,PolylineElement:()=>Gg,Property:()=>Vi,QB1:()=>NI,QB2:()=>VI,QB3:()=>DI,RadialGradientElement:()=>ff,RectElement:()=>Rg,RenderedElement:()=>XA,Rotate:()=>rf,SVGElement:()=>gc,SVGFontLoader:()=>Ff,Scale:()=>nf,Screen:()=>Yc,Skew:()=>Ug,SkewX:()=>sf,SkewY:()=>of,StopElement:()=>mf,StyleElement:()=>Pg,SymbolElement:()=>Sf,TRefElement:()=>wf,TSpanElement:()=>jc,TextElement:()=>gA,TextPathElement:()=>_f,TitleElement:()=>Rf,Transform:()=>JA,Translate:()=>ef,UnknownElement:()=>af,UseElement:()=>kf,ViewPort:()=>$p,compressSpaces:()=>nu,default:()=>uc,getSelectorSpecificity:()=>g5,normalizeAttributeName:()=>u5,normalizeColor:()=>h5,parseExternalUrl:()=>Fy,presets:()=>tD,toNumbers:()=>Vo,trimLeft:()=>l5,trimRight:()=>c5,vectorMagnitude:()=>RI,vectorsAngle:()=>GI,vectorsRatio:()=>qp});function k_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function xB(n,t,r,o,A,s,d){try{var f=n[s](d),I=f.value}catch(_){r(_);return}f.done?t(I):Promise.resolve(I).then(o,A)}function kl(n){return function(){var t=this,r=arguments;return new Promise(function(o,A){var s=n.apply(t,r);function d(I){xB(s,o,A,d,f,"next",I)}function f(I){xB(s,o,A,d,f,"throw",I)}d(void 0)})}}function d9(n,t){if(Sr(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var o=r.call(n,t||"default");if(Sr(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function p9(n){var t=d9(n,"string");return Sr(t)=="symbol"?t:String(t)}function xy(n,t,r){return t=p9(t),t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function s5(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}n5(n,t),n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function L6(n){var t="";Array.isArray(n)||(n=[n]);for(var r=0;r<n.length;r++){var o=n[r];if(o.type===Ve.CLOSE_PATH)t+="z";else if(o.type===Ve.HORIZ_LINE_TO)t+=(o.relative?"h":"H")+o.x;else if(o.type===Ve.VERT_LINE_TO)t+=(o.relative?"v":"V")+o.y;else if(o.type===Ve.MOVE_TO)t+=(o.relative?"m":"M")+o.x+" "+o.y;else if(o.type===Ve.LINE_TO)t+=(o.relative?"l":"L")+o.x+" "+o.y;else if(o.type===Ve.CURVE_TO)t+=(o.relative?"c":"C")+o.x1+" "+o.y1+" "+o.x2+" "+o.y2+" "+o.x+" "+o.y;else if(o.type===Ve.SMOOTH_CURVE_TO)t+=(o.relative?"s":"S")+o.x2+" "+o.y2+" "+o.x+" "+o.y;else if(o.type===Ve.QUAD_TO)t+=(o.relative?"q":"Q")+o.x1+" "+o.y1+" "+o.x+" "+o.y;else if(o.type===Ve.SMOOTH_QUAD_TO)t+=(o.relative?"t":"T")+o.x+" "+o.y;else{if(o.type!==Ve.ARC)throw new Error('Unexpected command type "'+o.type+'" at index '+r+".");t+=(o.relative?"a":"A")+o.rX+" "+o.rY+" "+o.xRot+" "+ +o.lArcFlag+" "+ +o.sweepFlag+" "+o.x+" "+o.y}}return t}function QI(n,t){var r=n[0],o=n[1];return[r*Math.cos(t)-o*Math.sin(t),r*Math.sin(t)+o*Math.cos(t)]}function cA(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];for(var r=0;r<n.length;r++)if(typeof n[r]!="number")throw new Error("assertNumbers arguments["+r+"] is not a number. "+typeof n[r]+" == typeof "+n[r]);return!0}function oI(n,t,r){n.lArcFlag=n.lArcFlag===0?0:1,n.sweepFlag=n.sweepFlag===0?0:1;var o=n.rX,A=n.rY,s=n.x,d=n.y;o=Math.abs(n.rX),A=Math.abs(n.rY);var f=QI([(t-s)/2,(r-d)/2],-n.xRot/180*cc),I=f[0],_=f[1],S=Math.pow(I,2)/Math.pow(o,2)+Math.pow(_,2)/Math.pow(A,2);1<S&&(o*=Math.sqrt(S),A*=Math.sqrt(S)),n.rX=o,n.rY=A;var U=Math.pow(o,2)*Math.pow(_,2)+Math.pow(A,2)*Math.pow(I,2),G=(n.lArcFlag!==n.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(o,2)*Math.pow(A,2)-U)/U)),L=o*_/A*G,K=-A*I/o*G,V=QI([L,K],n.xRot/180*cc);n.cX=V[0]+(t+s)/2,n.cY=V[1]+(r+d)/2,n.phi1=Math.atan2((_-K)/A,(I-L)/o),n.phi2=Math.atan2((-_-K)/A,(-I-L)/o),n.sweepFlag===0&&n.phi2>n.phi1&&(n.phi2-=2*cc),n.sweepFlag===1&&n.phi2<n.phi1&&(n.phi2+=2*cc),n.phi1*=180/cc,n.phi2*=180/cc}function f_(n,t,r){cA(n,t,r);var o=n*n+t*t-r*r;if(0>o)return[];if(o===0)return[[n*r/(n*n+t*t),t*r/(n*n+t*t)]];var A=Math.sqrt(o);return[[(n*r+t*A)/(n*n+t*t),(t*r-n*A)/(n*n+t*t)],[(n*r-t*A)/(n*n+t*t),(t*r+n*A)/(n*n+t*t)]]}function m_(n,t,r){return(1-r)*n+r*t}function C_(n,t,r,o){return n+Math.cos(o/180*cc)*t+Math.sin(o/180*cc)*r}function I_(n,t,r,o){var A=1e-6,s=t-n,d=r-t,f=3*s+3*(o-r)-6*d,I=6*(d-s),_=3*s;return Math.abs(f)<A?[-_/I]:function(S,U,G){G===void 0&&(G=1e-6);var L=S*S/4-U;if(L<-G)return[];if(L<=G)return[-S/2];var K=Math.sqrt(L);return[-S/2-K,-S/2+K]}(I/f,_/f,A)}function y_(n,t,r,o,A){var s=1-A;return n*(s*s*s)+t*(3*s*s*A)+r*(3*s*A*A)+o*(A*A*A)}function zp(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zp=function(t){return typeof t}:zp=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zp(n)}function O6(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function X6(n,t,r,o,A){if(typeof n=="string"&&(n=document.getElementById(n)),!n||zp(n)!=="object"||!("getContext"in n))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var s=n.getContext("2d");try{return s.getImageData(t,r,o,A)}catch(d){throw new Error("unable to access image data: "+d)}}function Y6(n,t,r,o,A,s){if(!(isNaN(s)||s<1)){s|=0;var d=X6(n,t,r,o,A);d=j6(d,t,r,o,A,s),n.getContext("2d").putImageData(d,t,r)}}function j6(n,t,r,o,A,s){for(var d=n.data,f=2*s+1,I=o-1,_=A-1,S=s+1,U=S*(S+1)/2,G=new B_,L=G,K,V=1;V<f;V++)L=L.next=new B_,V===S&&(K=L);L.next=G;for(var q=null,z=null,it=0,At=0,_t=W6[s],Lt=J6[s],Et=0;Et<A;Et++){L=G;for(var xt=d[At],It=d[At+1],Nt=d[At+2],ie=d[At+3],lt=0;lt<S;lt++)L.r=xt,L.g=It,L.b=Nt,L.a=ie,L=L.next;for(var at=0,St=0,Bt=0,se=0,ee=S*xt,qt=S*It,Xt=S*Nt,vt=S*ie,Tt=U*xt,pe=U*It,j=U*Nt,mt=U*ie,yt=1;yt<S;yt++){var Qt=At+((I<yt?I:yt)<<2),Ht=d[Qt],ae=d[Qt+1],ge=d[Qt+2],de=d[Qt+3],Ze=S-yt;Tt+=(L.r=Ht)*Ze,pe+=(L.g=ae)*Ze,j+=(L.b=ge)*Ze,mt+=(L.a=de)*Ze,at+=Ht,St+=ae,Bt+=ge,se+=de,L=L.next}q=G,z=K;for(var Re=0;Re<o;Re++){var Je=mt*_t>>>Lt;if(d[At+3]=Je,Je!==0){var Xe=255/Je;d[At]=(Tt*_t>>>Lt)*Xe,d[At+1]=(pe*_t>>>Lt)*Xe,d[At+2]=(j*_t>>>Lt)*Xe}else d[At]=d[At+1]=d[At+2]=0;Tt-=ee,pe-=qt,j-=Xt,mt-=vt,ee-=q.r,qt-=q.g,Xt-=q.b,vt-=q.a;var Kt=Re+s+1;Kt=it+(Kt<I?Kt:I)<<2,at+=q.r=d[Kt],St+=q.g=d[Kt+1],Bt+=q.b=d[Kt+2],se+=q.a=d[Kt+3],Tt+=at,pe+=St,j+=Bt,mt+=se,q=q.next;var Ce=z,Ut=Ce.r,Ye=Ce.g,Oe=Ce.b,Qe=Ce.a;ee+=Ut,qt+=Ye,Xt+=Oe,vt+=Qe,at-=Ut,St-=Ye,Bt-=Oe,se-=Qe,z=z.next,At+=4}it+=o}for(var Ne=0;Ne<o;Ne++){At=Ne<<2;var ze=d[At],We=d[At+1],ri=d[At+2],hi=d[At+3],Ti=S*ze,fe=S*We,Ni=S*ri,Di=S*hi,mi=U*ze,Gi=U*We,le=U*ri,gi=U*hi;L=G;for(var Ke=0;Ke<S;Ke++)L.r=ze,L.g=We,L.b=ri,L.a=hi,L=L.next;for(var or=o,Ki=0,ii=0,br=0,Ji=0,wr=1;wr<=s;wr++){At=or+Ne<<2;var ar=S-wr;mi+=(L.r=ze=d[At])*ar,Gi+=(L.g=We=d[At+1])*ar,le+=(L.b=ri=d[At+2])*ar,gi+=(L.a=hi=d[At+3])*ar,Ji+=ze,Ki+=We,ii+=ri,br+=hi,L=L.next,wr<_&&(or+=o)}At=Ne,q=G,z=K;for(var wt=0;wt<A;wt++){var W=At<<2;d[W+3]=hi=gi*_t>>>Lt,hi>0?(hi=255/hi,d[W]=(mi*_t>>>Lt)*hi,d[W+1]=(Gi*_t>>>Lt)*hi,d[W+2]=(le*_t>>>Lt)*hi):d[W]=d[W+1]=d[W+2]=0,mi-=Ti,Gi-=fe,le-=Ni,gi-=Di,Ti-=q.r,fe-=q.g,Ni-=q.b,Di-=q.a,W=Ne+((W=wt+S)<_?W:_)*o<<2,mi+=Ji+=q.r=d[W],Gi+=Ki+=q.g=d[W+1],le+=ii+=q.b=d[W+2],gi+=br+=q.a=d[W+3],q=q.next,Ti+=ze=z.r,fe+=We=z.g,Ni+=ri=z.b,Di+=hi=z.a,Ji-=ze,Ki-=We,ii-=ri,br-=hi,z=z.next,At+=o}}return n}function q6(){var{DOMParser:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:n,createCanvas(r,o){return new OffscreenCanvas(r,o)},createImage(r){return kl(function*(){var o=yield fetch(r),A=yield o.blob(),s=yield createImageBitmap(A);return s})()}};return(typeof DOMParser<"u"||typeof n>"u")&&Reflect.deleteProperty(t,"DOMParser"),t}function $6(n){var{DOMParser:t,canvas:r,fetch:o}=n;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,fetch:o,createCanvas:r.createCanvas,createImage:r.loadImage}}function nu(n){return n.replace(/(?!\u3000)\s+/gm," ")}function l5(n){return n.replace(/^[\n \t]+/,"")}function c5(n){return n.replace(/[\n \t]+$/,"")}function Vo(n){var t=(n||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return t.map(parseFloat)}function u5(n){return eD.test(n)?n.toLowerCase():n}function Fy(n){var t=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(n)||[];return t[2]||t[3]||t[4]}function h5(n){if(!n.startsWith("rgb"))return n;var t=3,r=n.replace(/\d+(\.\d+)?/g,(o,A)=>t--&&A?String(Math.round(parseFloat(o))):o);return r}function zc(n,t){var r=t.exec(n);return r?[n.replace(t," "),r.length]:[n,0]}function g5(n){var t=[0,0,0],r=n.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),o=0;return[r,o]=zc(r,iD),t[1]+=o,[r,o]=zc(r,rD),t[0]+=o,[r,o]=zc(r,nD),t[1]+=o,[r,o]=zc(r,sD),t[2]+=o,[r,o]=zc(r,oD),t[1]+=o,[r,o]=zc(r,aD),t[1]+=o,r=r.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[r,o]=zc(r,AD),t[2]+=o,t.join("")}function RI(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2))}function qp(n,t){return(n[0]*t[0]+n[1]*t[1])/(RI(n)*RI(t))}function GI(n,t){return(n[0]*t[1]<n[1]*t[0]?-1:1)*Math.acos(qp(n,t))}function ZI(n){return n*n*n}function PI(n){return 3*n*n*(1-n)}function HI(n){return 3*n*(1-n)*(1-n)}function MI(n){return(1-n)*(1-n)*(1-n)}function NI(n){return n*n}function VI(n){return 2*n*(1-n)}function DI(n){return(1-n)*(1-n)}function uD(n){return nu(n).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function hD(n){var[t,r]=n.split("(");return[t.trim(),r.trim().replace(")","")]}function gD(n){var t=n.trim();return/^('|")/.test(t)?t:'"'.concat(t,'"')}function dD(n){return typeof process>"u"?n:n.trim().split(",").map(gD).join(",")}function pD(n){if(!n)return"";var t=n.trim().toLowerCase();switch(t){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return t;default:return/^oblique\s+(-|)\d+deg$/.test(t)?t:""}}function fD(n){if(!n)return"";var t=n.trim().toLowerCase();switch(t){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return t;default:return/^[\d.]+$/.test(t)?t:""}}function __(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter(function(A){return Object.getOwnPropertyDescriptor(n,A).enumerable})),r.push.apply(r,o)}return r}function Zp(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?__(Object(r),!0).forEach(function(o){xy(n,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):__(Object(r)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(r,o))})}return n}function Pp(n,t,r,o,A,s){return n[r*o*4+t*4+s]}function Hp(n,t,r,o,A,s,d){n[r*o*4+t*4+s]=d}function jn(n,t,r){var o=n[t];return o*r}function Sl(n,t,r,o){return t+Math.cos(n)*r+Math.sin(n)*o}function S_(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter(function(A){return Object.getOwnPropertyDescriptor(n,A).enumerable})),r.push.apply(r,o)}return r}function ID(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S_(Object(r),!0).forEach(function(o){xy(n,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):S_(Object(r)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(r,o))})}return n}function yD(n,t){var r=document.createElement("canvas");return r.width=n,r.height=t,r}function bD(n){return zI.apply(this,arguments)}function zI(){return zI=kl(function*(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=document.createElement("img");return t&&(r.crossOrigin="Anonymous"),new Promise((o,A)=>{r.onload=()=>{o(r)},r.onerror=(s,d,f,I,_)=>{A(_)},r.src=n})}),zI.apply(this,arguments)}function F_(n,t){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter(function(A){return Object.getOwnPropertyDescriptor(n,A).enumerable})),r.push.apply(r,o)}return r}function Oc(n){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F_(Object(r),!0).forEach(function(o){xy(n,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):F_(Object(r)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(r,o))})}return n}var ju,Ig,Zn,Mg,Pn,UU,dA,QU,Zf,RU,wp,Qs,L_,E_,T_,GU,OI,U_,Q_,aI,ZU,Hn,R_,PU,HU,tu,MU,NU,VU,g0,DU,G_,eu,KU,zU,YA,OU,WU,Ng,d0,Mn,JU,jA,p0,XU,YU,iu,jU,Pf,Hf,Z_,f0,B2,_2,x2,S2,uA,Op,WI,F2,qU,$U,tQ,P_,eQ,H_,iQ,rQ,nQ,sQ,oQ,M_,aQ,Mf,AQ,lQ,cQ,Ll,uQ,hQ,lh,m0,C0,I0,gQ,dQ,N_,k2,pQ,JI,fQ,mQ,L2,E2,XI,T2,YI,CQ,IQ,Nf,yQ,bQ,vQ,pA,wQ,BQ,_Q,xQ,V_,SQ,FQ,U2,kQ,LQ,EQ,qu,y0,TQ,fs,UQ,Q2,R2,QQ,RQ,GQ,ZQ,PQ,HQ,MQ,NQ,D_,VQ,G2,AI,DQ,Vf,KQ,zQ,OQ,K_,WQ,JQ,XQ,YQ,jQ,qQ,$Q,tR,Z2,El,eR,iR,z_,rR,nR,sR,js,oR,aR,AR,Bp,P2,lR,b0,cR,v0,w0,B0,uR,hR,gR,Vg,O_,lI,dR,W_,pR,jI,fR,mR,Df,CR,IR,cI,yR,qI,bR,vR,H2,wR,BR,_R,M2,$I,ty,xR,J_,SR,FR,_0,x0,kR,LR,N2,uI,ER,Wp,kg,Jp,TR,UR,AA,Dc,Kf,ey,QR,RR,_p,hI,GR,ZR,X_,PR,HR,V2,Mp,MR,NR,VR,DR,KR,zR,Y_,OR,WR,JR,XR,ru,j_,YR,jR,qR,$R,zf,tG,eG,iG,rG,nG,sG,ch,oG,iy,aG,AG,lG,D2,q_,cG,S0,uG,hG,gG,K2,$_,ry,dG,pG,fG,tx,mG,CG,IG,yG,bG,vG,wG,z2,BG,_G,xG,SG,FG,kG,LG,Dg,EG,TG,UG,QG,ex,xp,RG,GG,ZG,PG,HG,MG,So,NG,VG,Kg,DG,KG,zG,OG,WG,JG,XG,YG,jG,qG,$G,tZ,ix,eZ,iZ,rZ,O2,Of,W2,nZ,sZ,oZ,aZ,AZ,lZ,J2,cZ,uZ,hZ,gZ,dZ,pZ,rx,fZ,mZ,CZ,Np,IZ,yZ,bZ,vZ,wZ,ny,BZ,_Z,nx,xZ,SZ,FZ,sx,ox,sy,kZ,LZ,yg,ax,EZ,TZ,UZ,QZ,RZ,X2,GZ,ZZ,PZ,HZ,Ax,MZ,lx,Y2,j2,cx,NZ,VZ,Wf,q2,DZ,KZ,zZ,oy,OZ,ux,WZ,JZ,XZ,YZ,jZ,hx,da,qZ,$Z,$2,tP,gx,tB,eP,eB,iP,rP,nP,gI,dI,sP,F0,oP,iB,aP,k0,Sg,rB,Lg,Kc,L0,E0,ay,T0,nB,sB,dx,oB,AP,lP,cP,px,fx,uP,hP,gP,dP,nh,pP,aB,U0,fP,mP,CP,IP,Q0,AB,lB,cB,Sp,pI,Ou,R0,G0,Fp,uB,bg,vg,yP,bP,Ay,vP,Jf,mx,wP,BP,_P,xP,Fg,SP,FP,kP,LP,EP,TP,Z0,UP,fI,Cx,QP,zg,uh,hB,RP,GP,ZP,Xp,hc,sh,gB,dB,PP,HP,MP,Vp,NP,VP,DP,Ix,ly,KP,zP,OP,yx,Yp,cy,bx,Xf,vx,WP,JP,P0,XP,Yu,Wc,kp,wx,mI,uy,CI,YP,jP,Bx,qP,pB,_x,$P,hy,xx,Lp,fB,tH,mB,Sx,Fx,kx,Lx,eH,CB,iH,$u,eh,II,Og,rH,nH,sH,oH,aH,AH,IB,lH,cH,uH,hH,Ex,gH,dH,pH,fH,mH,CH,IH,yH,yB,bH,vH,wH,BH,_H,xH,SH,FH,bB,kH,LH,vB,EH,Dp,wB,Tx,TH,Ux,Qx,BB,H0,UH,QH,RH,GH,Rx,ZH,PH,HH,MH,NH,VH,DH,KH,zH,yI,OH,WH,JH,_B,M0,XH,YH,jH,qH,$H,tM,eM,iM,rM,nM,sM,oM,aM,AM,lM,cM,uM,hM,gM,dM,qA,pM,Gx,gy,fM,dy,py,mM,CM,Zx,Px,IM,yM,bM,vM,wM,BM,_M,xM,SM,FM,kM,SB,LM,EM,TM,UM,FB,kB,bI,vI,Hx,N0,Mx,LB,QM,Ep,Kp,fy,RM,GM,ZM,PM,HM,MM,NM,VM,th,Yf,DM,KM,zM,OM,WM,JM,XM,YM,jM,jp,wI,qM,$M,tN,V0,BI,Nx,_I,eN,my,iN,EB,TB,UB,rN,QB,Vx,nN,sN,D0,Cy,Iy,oN,aN,AN,lN,RB,cN,GB,uN,hN,yy,ZB,gN,dN,pN,fN,mN,by,CN,IN,yN,bN,vN,K0,wN,BN,_N,PB,vy,xN,SN,z0,FN,O0,kN,LN,EN,TN,HB,jf,UN,QN,RN,GN,ZN,PN,HN,Wu,MN,NN,VN,DN,KN,zN,xI,ON,WN,JN,W0,MB,NB,XN,YN,VB,jN,qN,$N,tV,eV,iV,rV,nV,wy,sV,oV,By,aV,AV,lV,cV,DB,uV,hV,gV,dV,pV,Dx,fV,mV,CV,IV,SI,FI,yV,bV,vV,wV,BV,_V,xV,SV,KB,kI,FV,Kx,kV,LV,EV,zB,TV,UV,LI,zx,Xc,J0,X0,QV,Ox,RV,GV,ZV,PV,HV,MV,NV,VV,DV,Wx,KV,zV,OB,WB,OV,WV,Y0,JV,XV,Jx,YV,jV,JB,Tp,wg,XB,Bg,YB,qV,$V,t9,e9,_y,jB,Xx,i9,r9,Up,n9,Yx,s9,o9,a9,qB,A9,l9,j0,$B,c9,t_,jx,u9,_g,e_,h9,g9,q0,$0,qx,Qp,f9,m9,C9,I9,i_,r_,n_,y9,b9,$x,v9,w9,B9,s_,_9,x9,S9,F9,k9,L9,E9,o_,T9,U9,Q9,R9,G9,t5,Z9,tI,e5,P9,H9,M9,N9,V9,D9,K9,a_,z9,A_,O9,W9,Ju,J9,X9,eI,iI,Y9,l_,qf,xg,j9,q9,Fl,Rp,ih,oh,Eg,Xu,Gp,rI,lc,c_,$9,nI,i5,t6,e6,i6,EI,u_,r6,n6,sI,s6,o6,a6,h_,g_,A6,l6,c6,u6,h6,TI,g6,d6,p6,f6,UI,r5,m6,C6,I6,y6,b6,d_,v6,w6,B6,_6,x6,S6,F6,k6,p_,n5,cc,qn,xl,lA,o5,E6,b_,T6,Ve,U6,Q6,R6,G6,Z6,v_,P6,H6,M6,N6,w_,V6,D6,Sy,a5,A5,K6,z6,W6,J6,B_,tD,eD,iD,rD,nD,sD,oD,aD,AD,Jc,Vi,$p,In,tf,d5,p5,Yc,lD,cD,rh,ef,rf,nf,Tg,Ug,sf,of,JA,qr,af,ps,Do,sr,XA,Ur,Qg,gA,jc,KI,gc,Rg,Af,lf,cf,Gg,uf,hf,gf,df,ah,Zg,pf,ff,mf,Ah,Cf,If,yf,bf,vf,wf,Bf,_f,mD,xf,Sf,Ff,Pg,kf,Hg,qc,x_,Lf,$c,Ef,Tf,Uf,Qf,Rf,Gf,CD,hA,uc,m5=wd(()=>{ky();ju=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};Ig=function(n){return n&&n.Math===Math&&n},Zn=Ig(typeof globalThis=="object"&&globalThis)||Ig(typeof window=="object"&&window)||Ig(typeof self=="object"&&self)||Ig(typeof ju=="object"&&ju)||Ig(typeof ju=="object"&&ju)||function(){return this}()||Function("return this")(),Mg={},Pn=function(n){try{return!!n()}catch{return!0}},UU=Pn,dA=!UU(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),QU=Pn,Zf=!QU(function(){var n=function(){}.bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),RU=Zf,wp=Function.prototype.call,Qs=RU?wp.bind(wp):function(){return wp.apply(wp,arguments)},L_={},E_={}.propertyIsEnumerable,T_=Object.getOwnPropertyDescriptor,GU=T_&&!E_.call({1:2},1);L_.f=GU?function(n){var t=T_(this,n);return!!t&&t.enumerable}:E_;OI=function(n,t){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:t}},U_=Zf,Q_=Function.prototype,aI=Q_.call,ZU=U_&&Q_.bind.bind(aI,aI),Hn=U_?ZU:function(n){return function(){return aI.apply(n,arguments)}},R_=Hn,PU=R_({}.toString),HU=R_("".slice),tu=function(n){return HU(PU(n),8,-1)},MU=Hn,NU=Pn,VU=tu,g0=Object,DU=MU("".split),G_=NU(function(){return!g0("z").propertyIsEnumerable(0)})?function(n){return VU(n)==="String"?DU(n,""):g0(n)}:g0,eu=function(n){return n==null},KU=eu,zU=TypeError,YA=function(n){if(KU(n))throw new zU("Can't call method on "+n);return n},OU=G_,WU=YA,Ng=function(n){return OU(WU(n))},d0=typeof document=="object"&&document.all,Mn=typeof d0>"u"&&d0!==void 0?function(n){return typeof n=="function"||n===d0}:function(n){return typeof n=="function"},JU=Mn,jA=function(n){return typeof n=="object"?n!==null:JU(n)},p0=Zn,XU=Mn,YU=function(n){return XU(n)?n:void 0},iu=function(n,t){return arguments.length<2?YU(p0[n]):p0[n]&&p0[n][t]},jU=Hn,Pf=jU({}.isPrototypeOf),Hf=typeof navigator<"u"&&String(navigator.userAgent)||"",Z_=Zn,f0=Hf,B2=Z_.process,_2=Z_.Deno,x2=B2&&B2.versions||_2&&_2.version,S2=x2&&x2.v8;S2&&(uA=S2.split("."),Op=uA[0]>0&&uA[0]<4?1:+(uA[0]+uA[1]));!Op&&f0&&(uA=f0.match(/Edge\/(\d+)/),(!uA||uA[1]>=74)&&(uA=f0.match(/Chrome\/(\d+)/),uA&&(Op=+uA[1])));WI=Op,F2=WI,qU=Pn,$U=Zn,tQ=$U.String,P_=!!Object.getOwnPropertySymbols&&!qU(function(){var n=Symbol("symbol detection");return!tQ(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&F2&&F2<41}),eQ=P_,H_=eQ&&!Symbol.sham&&typeof Symbol.iterator=="symbol",iQ=iu,rQ=Mn,nQ=Pf,sQ=H_,oQ=Object,M_=sQ?function(n){return typeof n=="symbol"}:function(n){var t=iQ("Symbol");return rQ(t)&&nQ(t.prototype,oQ(n))},aQ=String,Mf=function(n){try{return aQ(n)}catch{return"Object"}},AQ=Mn,lQ=Mf,cQ=TypeError,Ll=function(n){if(AQ(n))return n;throw new cQ(lQ(n)+" is not a function")},uQ=Ll,hQ=eu,lh=function(n,t){var r=n[t];return hQ(r)?void 0:uQ(r)},m0=Qs,C0=Mn,I0=jA,gQ=TypeError,dQ=function(n,t){var r,o;if(t==="string"&&C0(r=n.toString)&&!I0(o=m0(r,n))||C0(r=n.valueOf)&&!I0(o=m0(r,n))||t!=="string"&&C0(r=n.toString)&&!I0(o=m0(r,n)))return o;throw new gQ("Can't convert object to primitive value")},N_={exports:{}},k2=Zn,pQ=Object.defineProperty,JI=function(n,t){try{pQ(k2,n,{value:t,configurable:!0,writable:!0})}catch{k2[n]=t}return t},fQ=Zn,mQ=JI,L2="__core-js_shared__",E2=N_.exports=fQ[L2]||mQ(L2,{});(E2.versions||(E2.versions=[])).push({version:"3.36.0",mode:"global",copyright:"\xA9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.0/LICENSE",source:"https://github.com/zloirock/core-js"});XI=N_.exports,T2=XI,YI=function(n,t){return T2[n]||(T2[n]=t||{})},CQ=YA,IQ=Object,Nf=function(n){return IQ(CQ(n))},yQ=Hn,bQ=Nf,vQ=yQ({}.hasOwnProperty),pA=Object.hasOwn||function(n,t){return vQ(bQ(n),t)},wQ=Hn,BQ=0,_Q=Math.random(),xQ=wQ(1 .toString),V_=function(n){return"Symbol("+(n===void 0?"":n)+")_"+xQ(++BQ+_Q,36)},SQ=Zn,FQ=YI,U2=pA,kQ=V_,LQ=P_,EQ=H_,qu=SQ.Symbol,y0=FQ("wks"),TQ=EQ?qu.for||qu:qu&&qu.withoutSetter||kQ,fs=function(n){return U2(y0,n)||(y0[n]=LQ&&U2(qu,n)?qu[n]:TQ("Symbol."+n)),y0[n]},UQ=Qs,Q2=jA,R2=M_,QQ=lh,RQ=dQ,GQ=fs,ZQ=TypeError,PQ=GQ("toPrimitive"),HQ=function(n,t){if(!Q2(n)||R2(n))return n;var r=QQ(n,PQ),o;if(r){if(t===void 0&&(t="default"),o=UQ(r,n,t),!Q2(o)||R2(o))return o;throw new ZQ("Can't convert object to primitive value")}return t===void 0&&(t="number"),RQ(n,t)},MQ=HQ,NQ=M_,D_=function(n){var t=MQ(n,"string");return NQ(t)?t:t+""},VQ=Zn,G2=jA,AI=VQ.document,DQ=G2(AI)&&G2(AI.createElement),Vf=function(n){return DQ?AI.createElement(n):{}},KQ=dA,zQ=Pn,OQ=Vf,K_=!KQ&&!zQ(function(){return Object.defineProperty(OQ("div"),"a",{get:function(){return 7}}).a!==7}),WQ=dA,JQ=Qs,XQ=L_,YQ=OI,jQ=Ng,qQ=D_,$Q=pA,tR=K_,Z2=Object.getOwnPropertyDescriptor;Mg.f=WQ?Z2:function(n,t){if(n=jQ(n),t=qQ(t),tR)try{return Z2(n,t)}catch{}if($Q(n,t))return YQ(!JQ(XQ.f,n,t),n[t])};El={},eR=dA,iR=Pn,z_=eR&&iR(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),rR=jA,nR=String,sR=TypeError,js=function(n){if(rR(n))return n;throw new sR(nR(n)+" is not an object")},oR=dA,aR=K_,AR=z_,Bp=js,P2=D_,lR=TypeError,b0=Object.defineProperty,cR=Object.getOwnPropertyDescriptor,v0="enumerable",w0="configurable",B0="writable";El.f=oR?AR?function(n,t,r){if(Bp(n),t=P2(t),Bp(r),typeof n=="function"&&t==="prototype"&&"value"in r&&B0 in r&&!r[B0]){var o=cR(n,t);o&&o[B0]&&(n[t]=r.value,r={configurable:w0 in r?r[w0]:o[w0],enumerable:v0 in r?r[v0]:o[v0],writable:!1})}return b0(n,t,r)}:b0:function(n,t,r){if(Bp(n),t=P2(t),Bp(r),aR)try{return b0(n,t,r)}catch{}if("get"in r||"set"in r)throw new lR("Accessors not supported");return"value"in r&&(n[t]=r.value),n};uR=dA,hR=El,gR=OI,Vg=uR?function(n,t,r){return hR.f(n,t,gR(1,r))}:function(n,t,r){return n[t]=r,n},O_={exports:{}},lI=dA,dR=pA,W_=Function.prototype,pR=lI&&Object.getOwnPropertyDescriptor,jI=dR(W_,"name"),fR=jI&&function(){}.name==="something",mR=jI&&(!lI||lI&&pR(W_,"name").configurable),Df={EXISTS:jI,PROPER:fR,CONFIGURABLE:mR},CR=Hn,IR=Mn,cI=XI,yR=CR(Function.toString);IR(cI.inspectSource)||(cI.inspectSource=function(n){return yR(n)});qI=cI.inspectSource,bR=Zn,vR=Mn,H2=bR.WeakMap,wR=vR(H2)&&/native code/.test(String(H2)),BR=YI,_R=V_,M2=BR("keys"),$I=function(n){return M2[n]||(M2[n]=_R(n))},ty={},xR=wR,J_=Zn,SR=jA,FR=Vg,_0=pA,x0=XI,kR=$I,LR=ty,N2="Object already initialized",uI=J_.TypeError,ER=J_.WeakMap,TR=function(n){return Jp(n)?kg(n):Wp(n,{})},UR=function(n){return function(t){var r;if(!SR(t)||(r=kg(t)).type!==n)throw new uI("Incompatible receiver, "+n+" required");return r}};xR||x0.state?(AA=x0.state||(x0.state=new ER),AA.get=AA.get,AA.has=AA.has,AA.set=AA.set,Wp=function(n,t){if(AA.has(n))throw new uI(N2);return t.facade=n,AA.set(n,t),t},kg=function(n){return AA.get(n)||{}},Jp=function(n){return AA.has(n)}):(Dc=kR("state"),LR[Dc]=!0,Wp=function(n,t){if(_0(n,Dc))throw new uI(N2);return t.facade=n,FR(n,Dc,t),t},kg=function(n){return _0(n,Dc)?n[Dc]:{}},Jp=function(n){return _0(n,Dc)});Kf={set:Wp,get:kg,has:Jp,enforce:TR,getterFor:UR},ey=Hn,QR=Pn,RR=Mn,_p=pA,hI=dA,GR=Df.CONFIGURABLE,ZR=qI,X_=Kf,PR=X_.enforce,HR=X_.get,V2=String,Mp=Object.defineProperty,MR=ey("".slice),NR=ey("".replace),VR=ey([].join),DR=hI&&!QR(function(){return Mp(function(){},"length",{value:8}).length!==8}),KR=String(String).split("String"),zR=O_.exports=function(n,t,r){MR(V2(t),0,7)==="Symbol("&&(t="["+NR(V2(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!_p(n,"name")||GR&&n.name!==t)&&(hI?Mp(n,"name",{value:t,configurable:!0}):n.name=t),DR&&r&&_p(r,"arity")&&n.length!==r.arity&&Mp(n,"length",{value:r.arity});try{r&&_p(r,"constructor")&&r.constructor?hI&&Mp(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch{}var o=PR(n);return _p(o,"source")||(o.source=VR(KR,typeof t=="string"?t:"")),n};Function.prototype.toString=zR(function(){return RR(this)&&HR(this).source||ZR(this)},"toString");Y_=O_.exports,OR=Mn,WR=El,JR=Y_,XR=JI,ru=function(n,t,r,o){o||(o={});var A=o.enumerable,s=o.name!==void 0?o.name:t;if(OR(r)&&JR(r,s,o),o.global)A?n[t]=r:XR(t,r);else{try{o.unsafe?n[t]&&(A=!0):delete n[t]}catch{}A?n[t]=r:WR.f(n,t,{value:r,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return n},j_={},YR=Math.ceil,jR=Math.floor,qR=Math.trunc||function(n){var t=+n;return(t>0?jR:YR)(t)},$R=qR,zf=function(n){var t=+n;return t!==t||t===0?0:$R(t)},tG=zf,eG=Math.max,iG=Math.min,rG=function(n,t){var r=tG(n);return r<0?eG(r+t,0):iG(r,t)},nG=zf,sG=Math.min,ch=function(n){var t=nG(n);return t>0?sG(t,9007199254740991):0},oG=ch,iy=function(n){return oG(n.length)},aG=Ng,AG=rG,lG=iy,D2=function(n){return function(t,r,o){var A=aG(t),s=lG(A);if(s===0)return!n&&-1;var d=AG(o,s),f;if(n&&r!==r){for(;s>d;)if(f=A[d++],f!==f)return!0}else for(;s>d;d++)if((n||d in A)&&A[d]===r)return n||d||0;return!n&&-1}},q_={includes:D2(!0),indexOf:D2(!1)},cG=Hn,S0=pA,uG=Ng,hG=q_.indexOf,gG=ty,K2=cG([].push),$_=function(n,t){var r=uG(n),o=0,A=[],s;for(s in r)!S0(gG,s)&&S0(r,s)&&K2(A,s);for(;t.length>o;)S0(r,s=t[o++])&&(~hG(A,s)||K2(A,s));return A},ry=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],dG=$_,pG=ry,fG=pG.concat("length","prototype");j_.f=Object.getOwnPropertyNames||function(n){return dG(n,fG)};tx={};tx.f=Object.getOwnPropertySymbols;mG=iu,CG=Hn,IG=j_,yG=tx,bG=js,vG=CG([].concat),wG=mG("Reflect","ownKeys")||function(n){var t=IG.f(bG(n)),r=yG.f;return r?vG(t,r(n)):t},z2=pA,BG=wG,_G=Mg,xG=El,SG=function(n,t,r){for(var o=BG(t),A=xG.f,s=_G.f,d=0;d<o.length;d++){var f=o[d];!z2(n,f)&&!(r&&z2(r,f))&&A(n,f,s(t,f))}},FG=Pn,kG=Mn,LG=/#|\.prototype\./,Dg=function(n,t){var r=TG[EG(n)];return r===QG?!0:r===UG?!1:kG(t)?FG(t):!!t},EG=Dg.normalize=function(n){return String(n).replace(LG,".").toLowerCase()},TG=Dg.data={},UG=Dg.NATIVE="N",QG=Dg.POLYFILL="P",ex=Dg,xp=Zn,RG=Mg.f,GG=Vg,ZG=ru,PG=JI,HG=SG,MG=ex,So=function(n,t){var r=n.target,o=n.global,A=n.stat,s,d,f,I,_,S;if(o?d=xp:A?d=xp[r]||PG(r,{}):d=xp[r]&&xp[r].prototype,d)for(f in t){if(_=t[f],n.dontCallGetSet?(S=RG(d,f),I=S&&S.value):I=d[f],s=MG(o?f:r+(A?".":"#")+f,n.forced),!s&&I!==void 0){if(typeof _==typeof I)continue;HG(_,I)}(n.sham||I&&I.sham)&&GG(_,"sham",!0),ZG(d,f,_,n)}},NG=Zn,VG=tu,Kg=VG(NG.process)==="process",DG=Hn,KG=Ll,zG=function(n,t,r){try{return DG(KG(Object.getOwnPropertyDescriptor(n,t)[r]))}catch{}},OG=jA,WG=function(n){return OG(n)||n===null},JG=WG,XG=String,YG=TypeError,jG=function(n){if(JG(n))return n;throw new YG("Can't set "+XG(n)+" as a prototype")},qG=zG,$G=js,tZ=jG,ix=Object.setPrototypeOf||("__proto__"in{}?function(){var n=!1,t={},r;try{r=qG(Object.prototype,"__proto__","set"),r(t,[]),n=t instanceof Array}catch{}return function(o,A){return $G(o),tZ(A),n?r(o,A):o.__proto__=A,o}}():void 0),eZ=El.f,iZ=pA,rZ=fs,O2=rZ("toStringTag"),Of=function(n,t,r){n&&!r&&(n=n.prototype),n&&!iZ(n,O2)&&eZ(n,O2,{configurable:!0,value:t})},W2=Y_,nZ=El,sZ=function(n,t,r){return r.get&&W2(r.get,t,{getter:!0}),r.set&&W2(r.set,t,{setter:!0}),nZ.f(n,t,r)},oZ=iu,aZ=sZ,AZ=fs,lZ=dA,J2=AZ("species"),cZ=function(n){var t=oZ(n);lZ&&t&&!t[J2]&&aZ(t,J2,{configurable:!0,get:function(){return this}})},uZ=Pf,hZ=TypeError,gZ=function(n,t){if(uZ(t,n))return n;throw new hZ("Incorrect invocation")},dZ=fs,pZ=dZ("toStringTag"),rx={};rx[pZ]="z";fZ=String(rx)==="[object z]",mZ=fZ,CZ=Mn,Np=tu,IZ=fs,yZ=IZ("toStringTag"),bZ=Object,vZ=Np(function(){return arguments}())==="Arguments",wZ=function(n,t){try{return n[t]}catch{}},ny=mZ?Np:function(n){var t,r,o;return n===void 0?"Undefined":n===null?"Null":typeof(r=wZ(t=bZ(n),yZ))=="string"?r:vZ?Np(t):(o=Np(t))==="Object"&&CZ(t.callee)?"Arguments":o},BZ=Hn,_Z=Pn,nx=Mn,xZ=ny,SZ=iu,FZ=qI,sx=function(){},ox=SZ("Reflect","construct"),sy=/^\s*(?:class|function)\b/,kZ=BZ(sy.exec),LZ=!sy.test(sx),yg=function(n){if(!nx(n))return!1;try{return ox(sx,[],n),!0}catch{return!1}},ax=function(n){if(!nx(n))return!1;switch(xZ(n)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return LZ||!!kZ(sy,FZ(n))}catch{return!0}};ax.sham=!0;EZ=!ox||_Z(function(){var n;return yg(yg.call)||!yg(Object)||!yg(function(){n=!0})||n})?ax:yg,TZ=EZ,UZ=Mf,QZ=TypeError,RZ=function(n){if(TZ(n))return n;throw new QZ(UZ(n)+" is not a constructor")},X2=js,GZ=RZ,ZZ=eu,PZ=fs,HZ=PZ("species"),Ax=function(n,t){var r=X2(n).constructor,o;return r===void 0||ZZ(o=X2(r)[HZ])?t:GZ(o)},MZ=Zf,lx=Function.prototype,Y2=lx.apply,j2=lx.call,cx=typeof Reflect=="object"&&Reflect.apply||(MZ?j2.bind(Y2):function(){return j2.apply(Y2,arguments)}),NZ=tu,VZ=Hn,Wf=function(n){if(NZ(n)==="Function")return VZ(n)},q2=Wf,DZ=Ll,KZ=Zf,zZ=q2(q2.bind),oy=function(n,t){return DZ(n),t===void 0?n:KZ?zZ(n,t):function(){return n.apply(t,arguments)}},OZ=iu,ux=OZ("document","documentElement"),WZ=Hn,JZ=WZ([].slice),XZ=TypeError,YZ=function(n,t){if(n<t)throw new XZ("Not enough arguments");return n},jZ=Hf,hx=/(?:ipad|iphone|ipod).*applewebkit/i.test(jZ),da=Zn,qZ=cx,$Z=oy,$2=Mn,tP=pA,gx=Pn,tB=ux,eP=JZ,eB=Vf,iP=YZ,rP=hx,nP=Kg,gI=da.setImmediate,dI=da.clearImmediate,sP=da.process,F0=da.Dispatch,oP=da.Function,iB=da.MessageChannel,aP=da.String,k0=0,Sg={},rB="onreadystatechange";gx(function(){Lg=da.location});ay=function(n){if(tP(Sg,n)){var t=Sg[n];delete Sg[n],t()}},T0=function(n){return function(){ay(n)}},nB=function(n){ay(n.data)},sB=function(n){da.postMessage(aP(n),Lg.protocol+"//"+Lg.host)};(!gI||!dI)&&(gI=function(n){iP(arguments.length,1);var t=$2(n)?n:oP(n),r=eP(arguments,1);return Sg[++k0]=function(){qZ(t,void 0,r)},Kc(k0),k0},dI=function(n){delete Sg[n]},nP?Kc=function(n){sP.nextTick(T0(n))}:F0&&F0.now?Kc=function(n){F0.now(T0(n))}:iB&&!rP?(L0=new iB,E0=L0.port2,L0.port1.onmessage=nB,Kc=$Z(E0.postMessage,E0)):da.addEventListener&&$2(da.postMessage)&&!da.importScripts&&Lg&&Lg.protocol!=="file:"&&!gx(sB)?(Kc=sB,da.addEventListener("message",nB,!1)):rB in eB("script")?Kc=function(n){tB.appendChild(eB("script"))[rB]=function(){tB.removeChild(this),ay(n)}}:Kc=function(n){setTimeout(T0(n),0)});dx={set:gI,clear:dI},oB=Zn,AP=dA,lP=Object.getOwnPropertyDescriptor,cP=function(n){if(!AP)return oB[n];var t=lP(oB,n);return t&&t.value},px=function(){this.head=null,this.tail=null};px.prototype={add:function(n){var t={item:n,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var n=this.head;if(n){var t=this.head=n.next;return t===null&&(this.tail=null),n.item}}};fx=px,uP=Hf,hP=/ipad|iphone|ipod/i.test(uP)&&typeof Pebble<"u",gP=Hf,dP=/web0s(?!.*chrome)/i.test(gP),nh=Zn,pP=cP,aB=oy,U0=dx.set,fP=fx,mP=hx,CP=hP,IP=dP,Q0=Kg,AB=nh.MutationObserver||nh.WebKitMutationObserver,lB=nh.document,cB=nh.process,Sp=nh.Promise,pI=pP("queueMicrotask");pI||(bg=new fP,vg=function(){var n,t;for(Q0&&(n=cB.domain)&&n.exit();t=bg.get();)try{t()}catch(r){throw bg.head&&Ou(),r}n&&n.enter()},!mP&&!Q0&&!IP&&AB&&lB?(R0=!0,G0=lB.createTextNode(""),new AB(vg).observe(G0,{characterData:!0}),Ou=function(){G0.data=R0=!R0}):!CP&&Sp&&Sp.resolve?(Fp=Sp.resolve(void 0),Fp.constructor=Sp,uB=aB(Fp.then,Fp),Ou=function(){uB(vg)}):Q0?Ou=function(){cB.nextTick(vg)}:(U0=aB(U0,nh),Ou=function(){U0(vg)}),pI=function(n){bg.head||Ou(),bg.add(n)});yP=pI,bP=function(n,t){try{arguments.length===1?console.error(n):console.error(n,t)}catch{}},Ay=function(n){try{return{error:!1,value:n()}}catch(t){return{error:!0,value:t}}},vP=Zn,Jf=vP.Promise,mx=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",wP=mx,BP=Kg,_P=!wP&&!BP&&typeof window=="object"&&typeof document=="object",xP=Zn,Fg=Jf,SP=Mn,FP=ex,kP=qI,LP=fs,EP=_P,TP=mx,Z0=WI;Fg&&Fg.prototype;UP=LP("species"),fI=!1,Cx=SP(xP.PromiseRejectionEvent),QP=FP("Promise",function(){var n=kP(Fg),t=n!==String(Fg);if(!t&&Z0===66)return!0;if(!Z0||Z0<51||!/native code/.test(n)){var r=new Fg(function(s){s(1)}),o=function(s){s(function(){},function(){})},A=r.constructor={};if(A[UP]=o,fI=r.then(function(){})instanceof o,!fI)return!0}return!t&&(EP||TP)&&!Cx}),zg={CONSTRUCTOR:QP,REJECTION_EVENT:Cx,SUBCLASSING:fI},uh={},hB=Ll,RP=TypeError,GP=function(n){var t,r;this.promise=new n(function(o,A){if(t!==void 0||r!==void 0)throw new RP("Bad Promise constructor");t=o,r=A}),this.resolve=hB(t),this.reject=hB(r)};uh.f=function(n){return new GP(n)};ZP=So,Xp=Kg,hc=Zn,sh=Qs,gB=ru,dB=ix,PP=Of,HP=cZ,MP=Ll,Vp=Mn,NP=jA,VP=gZ,DP=Ax,Ix=dx.set,ly=yP,KP=bP,zP=Ay,OP=fx,yx=Kf,Yp=Jf,cy=zg,bx=uh,Xf="Promise",vx=cy.CONSTRUCTOR,WP=cy.REJECTION_EVENT,JP=cy.SUBCLASSING,P0=yx.getterFor(Xf),XP=yx.set,Yu=Yp&&Yp.prototype,Wc=Yp,kp=Yu,wx=hc.TypeError,mI=hc.document,uy=hc.process,CI=bx.f,YP=CI,jP=!!(mI&&mI.createEvent&&hc.dispatchEvent),Bx="unhandledrejection",qP="rejectionhandled",pB=0,_x=1,$P=2,hy=1,xx=2,Sx=function(n){var t;return NP(n)&&Vp(t=n.then)?t:!1},Fx=function(n,t){var r=t.value,o=t.state===_x,A=o?n.ok:n.fail,s=n.resolve,d=n.reject,f=n.domain,I,_,S;try{A?(o||(t.rejection===xx&&iH(t),t.rejection=hy),A===!0?I=r:(f&&f.enter(),I=A(r),f&&(f.exit(),S=!0)),I===n.promise?d(new wx("Promise-chain cycle")):(_=Sx(I))?sh(_,I,s,d):s(I)):d(r)}catch(U){f&&!S&&f.exit(),d(U)}},kx=function(n,t){n.notified||(n.notified=!0,ly(function(){for(var r=n.reactions,o;o=r.get();)Fx(o,n);n.notified=!1,t&&!n.rejection&&eH(n)}))},Lx=function(n,t,r){var o,A;jP?(o=mI.createEvent("Event"),o.promise=t,o.reason=r,o.initEvent(n,!1,!0),hc.dispatchEvent(o)):o={promise:t,reason:r},!WP&&(A=hc["on"+n])?A(o):n===Bx&&KP("Unhandled promise rejection",r)},eH=function(n){sh(Ix,hc,function(){var t=n.facade,r=n.value,o=CB(n),A;if(o&&(A=zP(function(){Xp?uy.emit("unhandledRejection",r,t):Lx(Bx,t,r)}),n.rejection=Xp||CB(n)?xx:hy,A.error))throw A.value})},CB=function(n){return n.rejection!==hy&&!n.parent},iH=function(n){sh(Ix,hc,function(){var t=n.facade;Xp?uy.emit("rejectionHandled",t):Lx(qP,t,n.value)})},$u=function(n,t,r){return function(o){n(t,o,r)}},eh=function(n,t,r){n.done||(n.done=!0,r&&(n=r),n.value=t,n.state=$P,kx(n,!0))},II=function(n,t,r){if(!n.done){n.done=!0,r&&(n=r);try{if(n.facade===t)throw new wx("Promise can't be resolved itself");var o=Sx(t);o?ly(function(){var A={done:!1};try{sh(o,t,$u(II,A,n),$u(eh,A,n))}catch(s){eh(A,s,n)}}):(n.value=t,n.state=_x,kx(n,!1))}catch(A){eh({done:!1},A,n)}}};if(vx&&(Wc=function(n){VP(this,kp),MP(n),sh(Lp,this);var t=P0(this);try{n($u(II,t),$u(eh,t))}catch(r){eh(t,r)}},kp=Wc.prototype,Lp=function(n){XP(this,{type:Xf,done:!1,notified:!1,parent:!1,reactions:new OP,rejection:!1,state:pB,value:void 0})},Lp.prototype=gB(kp,"then",function(n,t){var r=P0(this),o=CI(DP(this,Wc));return r.parent=!0,o.ok=Vp(n)?n:!0,o.fail=Vp(t)&&t,o.domain=Xp?uy.domain:void 0,r.state===pB?r.reactions.add(o):ly(function(){Fx(o,r)}),o.promise}),fB=function(){var n=new Lp,t=P0(n);this.promise=n,this.resolve=$u(II,t),this.reject=$u(eh,t)},bx.f=CI=function(n){return n===Wc||n===tH?new fB(n):YP(n)},Vp(Yp)&&Yu!==Object.prototype)){mB=Yu.then,JP||gB(Yu,"then",function(n,t){var r=this;return new Wc(function(o,A){sh(mB,r,o,A)}).then(n,t)},{unsafe:!0});try{delete Yu.constructor}catch{}dB&&dB(Yu,kp)}ZP({global:!0,constructor:!0,wrap:!0,forced:vx},{Promise:Wc});PP(Wc,Xf,!1);HP(Xf);Og={},rH=fs,nH=Og,sH=rH("iterator"),oH=Array.prototype,aH=function(n){return n!==void 0&&(nH.Array===n||oH[sH]===n)},AH=ny,IB=lh,lH=eu,cH=Og,uH=fs,hH=uH("iterator"),Ex=function(n){if(!lH(n))return IB(n,hH)||IB(n,"@@iterator")||cH[AH(n)]},gH=Qs,dH=Ll,pH=js,fH=Mf,mH=Ex,CH=TypeError,IH=function(n,t){var r=arguments.length<2?mH(n):t;if(dH(r))return pH(gH(r,n));throw new CH(fH(n)+" is not iterable")},yH=Qs,yB=js,bH=lh,vH=function(n,t,r){var o,A;yB(n);try{if(o=bH(n,"return"),!o){if(t==="throw")throw r;return r}o=yH(o,n)}catch(s){A=!0,o=s}if(t==="throw")throw r;if(A)throw o;return yB(o),r},wH=oy,BH=Qs,_H=js,xH=Mf,SH=aH,FH=iy,bB=Pf,kH=IH,LH=Ex,vB=vH,EH=TypeError,Dp=function(n,t){this.stopped=n,this.result=t},wB=Dp.prototype,Tx=function(n,t,r){var o=r&&r.that,A=!!(r&&r.AS_ENTRIES),s=!!(r&&r.IS_RECORD),d=!!(r&&r.IS_ITERATOR),f=!!(r&&r.INTERRUPTED),I=wH(t,o),_,S,U,G,L,K,V,q=function(it){return _&&vB(_,"normal",it),new Dp(!0,it)},z=function(it){return A?(_H(it),f?I(it[0],it[1],q):I(it[0],it[1])):f?I(it,q):I(it)};if(s)_=n.iterator;else if(d)_=n;else{if(S=LH(n),!S)throw new EH(xH(n)+" is not iterable");if(SH(S)){for(U=0,G=FH(n);G>U;U++)if(L=z(n[U]),L&&bB(wB,L))return L;return new Dp(!1)}_=kH(n,S)}for(K=s?n.next:_.next;!(V=BH(K,_)).done;){try{L=z(V.value)}catch(it){vB(_,"throw",it)}if(typeof L=="object"&&L&&bB(wB,L))return L}return new Dp(!1)},TH=fs,Ux=TH("iterator"),Qx=!1;try{BB=0,H0={next:function(){return{done:!!BB++}},return:function(){Qx=!0}},H0[Ux]=function(){return this},Array.from(H0,function(){throw 2})}catch{}UH=function(n,t){try{if(!t&&!Qx)return!1}catch{return!1}var r=!1;try{var o={};o[Ux]=function(){return{next:function(){return{done:r=!0}}}},n(o)}catch{}return r},QH=Jf,RH=UH,GH=zg.CONSTRUCTOR,Rx=GH||!RH(function(n){QH.all(n).then(void 0,function(){})}),ZH=So,PH=Qs,HH=Ll,MH=uh,NH=Ay,VH=Tx,DH=Rx;ZH({target:"Promise",stat:!0,forced:DH},{all:function(n){var t=this,r=MH.f(t),o=r.resolve,A=r.reject,s=NH(function(){var d=HH(t.resolve),f=[],I=0,_=1;VH(n,function(S){var U=I++,G=!1;_++,PH(d,t,S).then(function(L){G||(G=!0,f[U]=L,--_||o(f))},A)}),--_||o(f)});return s.error&&A(s.value),r.promise}});KH=So,zH=zg.CONSTRUCTOR,yI=Jf,OH=iu,WH=Mn,JH=ru,_B=yI&&yI.prototype;KH({target:"Promise",proto:!0,forced:zH,real:!0},{catch:function(n){return this.then(void 0,n)}});WH(yI)&&(M0=OH("Promise").prototype.catch,_B.catch!==M0&&JH(_B,"catch",M0,{unsafe:!0}));XH=So,YH=Qs,jH=Ll,qH=uh,$H=Ay,tM=Tx,eM=Rx;XH({target:"Promise",stat:!0,forced:eM},{race:function(n){var t=this,r=qH.f(t),o=r.reject,A=$H(function(){var s=jH(t.resolve);tM(n,function(d){YH(s,t,d).then(r.resolve,o)})});return A.error&&o(A.value),r.promise}});iM=So,rM=uh,nM=zg.CONSTRUCTOR;iM({target:"Promise",stat:!0,forced:nM},{reject:function(n){var t=rM.f(this),r=t.reject;return r(n),t.promise}});sM=js,oM=jA,aM=uh,AM=function(n,t){if(sM(n),oM(t)&&t.constructor===n)return t;var r=aM.f(n),o=r.resolve;return o(t),r.promise},lM=So,cM=iu,uM=zg.CONSTRUCTOR,hM=AM;cM("Promise");lM({target:"Promise",stat:!0,forced:uM},{resolve:function(n){return hM(this,n)}});gM=ny,dM=String,qA=function(n){if(gM(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return dM(n)},pM=js,Gx=function(){var n=pM(this),t="";return n.hasIndices&&(t+="d"),n.global&&(t+="g"),n.ignoreCase&&(t+="i"),n.multiline&&(t+="m"),n.dotAll&&(t+="s"),n.unicode&&(t+="u"),n.unicodeSets&&(t+="v"),n.sticky&&(t+="y"),t},gy=Pn,fM=Zn,dy=fM.RegExp,py=gy(function(){var n=dy("a","y");return n.lastIndex=2,n.exec("abcd")!==null}),mM=py||gy(function(){return!dy("a","y").sticky}),CM=py||gy(function(){var n=dy("^r","gy");return n.lastIndex=2,n.exec("str")!==null}),Zx={BROKEN_CARET:CM,MISSED_STICKY:mM,UNSUPPORTED_Y:py},Px={},IM=$_,yM=ry,bM=Object.keys||function(n){return IM(n,yM)},vM=dA,wM=z_,BM=El,_M=js,xM=Ng,SM=bM;Px.f=vM&&!wM?Object.defineProperties:function(n,t){_M(n);for(var r=xM(t),o=SM(t),A=o.length,s=0,d;A>s;)BM.f(n,d=o[s++],r[d]);return n};FM=js,kM=Px,SB=ry,LM=ty,EM=ux,TM=Vf,UM=$I,FB=">",kB="<",bI="prototype",vI="script",Hx=UM("IE_PROTO"),N0=function(){},Mx=function(n){return kB+vI+FB+n+kB+"/"+vI+FB},LB=function(n){n.write(Mx("")),n.close();var t=n.parentWindow.Object;return n=null,t},QM=function(){var n=TM("iframe"),t="java"+vI+":",r;return n.style.display="none",EM.appendChild(n),n.src=String(t),r=n.contentWindow.document,r.open(),r.write(Mx("document.F=Object")),r.close(),r.F},Kp=function(){try{Ep=new ActiveXObject("htmlfile")}catch{}Kp=typeof document<"u"?document.domain&&Ep?LB(Ep):QM():LB(Ep);for(var n=SB.length;n--;)delete Kp[bI][SB[n]];return Kp()};LM[Hx]=!0;fy=Object.create||function(n,t){var r;return n!==null?(N0[bI]=FM(n),r=new N0,N0[bI]=null,r[Hx]=n):r=Kp(),t===void 0?r:kM.f(r,t)},RM=Pn,GM=Zn,ZM=GM.RegExp,PM=RM(function(){var n=ZM(".","s");return!(n.dotAll&&n.test(`
`)&&n.flags==="s")}),HM=Pn,MM=Zn,NM=MM.RegExp,VM=HM(function(){var n=NM("(?<a>b)","g");return n.exec("b").groups.a!=="b"||"b".replace(n,"$<a>c")!=="bc"}),th=Qs,Yf=Hn,DM=qA,KM=Gx,zM=Zx,OM=YI,WM=fy,JM=Kf.get,XM=PM,YM=VM,jM=OM("native-string-replace",String.prototype.replace),jp=RegExp.prototype.exec,wI=jp,qM=Yf("".charAt),$M=Yf("".indexOf),tN=Yf("".replace),V0=Yf("".slice),BI=function(){var n=/a/,t=/b*/g;return th(jp,n,"a"),th(jp,t,"a"),n.lastIndex!==0||t.lastIndex!==0}(),Nx=zM.BROKEN_CARET,_I=/()??/.exec("")[1]!==void 0,eN=BI||_I||Nx||XM||YM;eN&&(wI=function(n){var t=this,r=JM(t),o=DM(n),A=r.raw,s,d,f,I,_,S,U;if(A)return A.lastIndex=t.lastIndex,s=th(wI,A,o),t.lastIndex=A.lastIndex,s;var G=r.groups,L=Nx&&t.sticky,K=th(KM,t),V=t.source,q=0,z=o;if(L&&(K=tN(K,"y",""),$M(K,"g")===-1&&(K+="g"),z=V0(o,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&qM(o,t.lastIndex-1)!==`
`)&&(V="(?: "+V+")",z=" "+z,q++),d=new RegExp("^(?:"+V+")",K)),_I&&(d=new RegExp("^"+V+"$(?!\\s)",K)),BI&&(f=t.lastIndex),I=th(jp,L?d:t,z),L?I?(I.input=V0(I.input,q),I[0]=V0(I[0],q),I.index=t.lastIndex,t.lastIndex+=I[0].length):t.lastIndex=0:BI&&I&&(t.lastIndex=t.global?I.index+I[0].length:f),_I&&I&&I.length>1&&th(jM,I[0],d,function(){for(_=1;_<arguments.length-2;_++)arguments[_]===void 0&&(I[_]=void 0)}),I&&G)for(I.groups=S=WM(null),_=0;_<G.length;_++)U=G[_],S[U[0]]=I[U[1]];return I});my=wI,iN=So,EB=my;iN({target:"RegExp",proto:!0,forced:/./.exec!==EB},{exec:EB});TB=Qs,UB=ru,rN=my,QB=Pn,Vx=fs,nN=Vg,sN=Vx("species"),D0=RegExp.prototype,Cy=function(n,t,r,o){var A=Vx(n),s=!QB(function(){var _={};return _[A]=function(){return 7},""[n](_)!==7}),d=s&&!QB(function(){var _=!1,S=/a/;return n==="split"&&(S={},S.constructor={},S.constructor[sN]=function(){return S},S.flags="",S[A]=/./[A]),S.exec=function(){return _=!0,null},S[A](""),!_});if(!s||!d||r){var f=/./[A],I=t(A,""[n],function(_,S,U,G,L){var K=S.exec;return K===rN||K===D0.exec?s&&!L?{done:!0,value:TB(f,S,U,G)}:{done:!0,value:TB(_,U,S,G)}:{done:!1}});UB(String.prototype,n,I[0]),UB(D0,A,I[1])}o&&nN(D0[A],"sham",!0)},Iy=Hn,oN=zf,aN=qA,AN=YA,lN=Iy("".charAt),RB=Iy("".charCodeAt),cN=Iy("".slice),GB=function(n){return function(t,r){var o=aN(AN(t)),A=oN(r),s=o.length,d,f;return A<0||A>=s?n?"":void 0:(d=RB(o,A),d<55296||d>56319||A+1===s||(f=RB(o,A+1))<56320||f>57343?n?lN(o,A):d:n?cN(o,A,A+2):(d-55296<<10)+(f-56320)+65536)}},uN={codeAt:GB(!1),charAt:GB(!0)},hN=uN.charAt,yy=function(n,t,r){return t+(r?hN(n,t).length:1)},ZB=Qs,gN=js,dN=Mn,pN=tu,fN=my,mN=TypeError,by=function(n,t){var r=n.exec;if(dN(r)){var o=ZB(r,n,t);return o!==null&&gN(o),o}if(pN(n)==="RegExp")return ZB(fN,n,t);throw new mN("RegExp#exec called on incompatible receiver")},CN=Qs,IN=Cy,yN=js,bN=eu,vN=ch,K0=qA,wN=YA,BN=lh,_N=yy,PB=by;IN("match",function(n,t,r){return[function(o){var A=wN(this),s=bN(o)?void 0:BN(o,n);return s?CN(s,o,A):new RegExp(o)[n](K0(A))},function(o){var A=yN(this),s=K0(o),d=r(t,A,s);if(d.done)return d.value;if(!A.global)return PB(A,s);var f=A.unicode;A.lastIndex=0;for(var I=[],_=0,S;(S=PB(A,s))!==null;){var U=K0(S[0]);I[_]=U,U===""&&(A.lastIndex=_N(s,vN(A.lastIndex),f)),_++}return _===0?null:I}]});vy=Hn,xN=Nf,SN=Math.floor,z0=vy("".charAt),FN=vy("".replace),O0=vy("".slice),kN=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,LN=/\$([$&'`]|\d{1,2})/g,EN=function(n,t,r,o,A,s){var d=r+n.length,f=o.length,I=LN;return A!==void 0&&(A=xN(A),I=kN),FN(s,I,function(_,S){var U;switch(z0(S,0)){case"$":return"$";case"&":return n;case"`":return O0(t,0,r);case"'":return O0(t,d);case"<":U=A[O0(S,1,-1)];break;default:var G=+S;if(G===0)return _;if(G>f){var L=SN(G/10);return L===0?_:L<=f?o[L-1]===void 0?z0(S,1):o[L-1]+z0(S,1):_}U=o[G-1]}return U===void 0?"":U})},TN=cx,HB=Qs,jf=Hn,UN=Cy,QN=Pn,RN=js,GN=Mn,ZN=eu,PN=zf,HN=ch,Wu=qA,MN=YA,NN=yy,VN=lh,DN=EN,KN=by,zN=fs,xI=zN("replace"),ON=Math.max,WN=Math.min,JN=jf([].concat),W0=jf([].push),MB=jf("".indexOf),NB=jf("".slice),XN=function(n){return n===void 0?n:String(n)},YN=function(){return"a".replace(/./,"$0")==="$0"}(),VB=function(){return/./[xI]?/./[xI]("a","$0")==="":!1}(),jN=!QN(function(){var n=/./;return n.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(n,"$<a>")!=="7"});UN("replace",function(n,t,r){var o=VB?"$":"$0";return[function(A,s){var d=MN(this),f=ZN(A)?void 0:VN(A,xI);return f?HB(f,A,d,s):HB(t,Wu(d),A,s)},function(A,s){var d=RN(this),f=Wu(A);if(typeof s=="string"&&MB(s,o)===-1&&MB(s,"$<")===-1){var I=r(t,d,f,s);if(I.done)return I.value}var _=GN(s);_||(s=Wu(s));var S=d.global,U;S&&(U=d.unicode,d.lastIndex=0);for(var G=[],L;L=KN(d,f),!(L===null||(W0(G,L),!S));){var K=Wu(L[0]);K===""&&(d.lastIndex=NN(f,HN(d.lastIndex),U))}for(var V="",q=0,z=0;z<G.length;z++){L=G[z];for(var it=Wu(L[0]),At=ON(WN(PN(L.index),f.length),0),_t=[],Lt,Et=1;Et<L.length;Et++)W0(_t,XN(L[Et]));var xt=L.groups;if(_){var It=JN([it],_t,At,f);xt!==void 0&&W0(It,xt),Lt=Wu(TN(s,void 0,It))}else Lt=DN(it,f,At,_t,xt,s);At>=q&&(V+=NB(f,q,At)+Lt,q=At+it.length)}return V+NB(f,q)}]},!jN||!YN||VB);qN=jA,$N=tu,tV=fs,eV=tV("match"),iV=function(n){var t;return qN(n)&&((t=n[eV])!==void 0?!!t:$N(n)==="RegExp")},rV=iV,nV=TypeError,wy=function(n){if(rV(n))throw new nV("The method doesn't accept regular expressions");return n},sV=fs,oV=sV("match"),By=function(n){var t=/./;try{"/./"[n](t)}catch{try{return t[oV]=!1,"/./"[n](t)}catch{}}return!1},aV=So,AV=Wf,lV=Mg.f,cV=ch,DB=qA,uV=wy,hV=YA,gV=By,dV=AV("".slice),pV=Math.min,Dx=gV("startsWith"),fV=!Dx&&!!function(){var n=lV(String.prototype,"startsWith");return n&&!n.writable}();aV({target:"String",proto:!0,forced:!fV&&!Dx},{startsWith:function(n){var t=DB(hV(this));uV(n);var r=cV(pV(arguments.length>1?arguments[1]:void 0,t.length)),o=DB(n);return dV(t,r,r+o.length)===o}});mV=fs,CV=fy,IV=El.f,SI=mV("unscopables"),FI=Array.prototype;FI[SI]===void 0&&IV(FI,SI,{configurable:!0,value:CV(null)});yV=function(n){FI[SI][n]=!0},bV=Pn,vV=!bV(function(){function n(){}return n.prototype.constructor=null,Object.getPrototypeOf(new n)!==n.prototype}),wV=pA,BV=Mn,_V=Nf,xV=$I,SV=vV,KB=xV("IE_PROTO"),kI=Object,FV=kI.prototype,Kx=SV?kI.getPrototypeOf:function(n){var t=_V(n);if(wV(t,KB))return t[KB];var r=t.constructor;return BV(r)&&t instanceof r?r.prototype:t instanceof kI?FV:null},kV=Pn,LV=Mn,EV=jA,zB=Kx,TV=ru,UV=fs,LI=UV("iterator"),zx=!1;[].keys&&(X0=[].keys(),"next"in X0?(J0=zB(zB(X0)),J0!==Object.prototype&&(Xc=J0)):zx=!0);QV=!EV(Xc)||kV(function(){var n={};return Xc[LI].call(n)!==n});QV&&(Xc={});LV(Xc[LI])||TV(Xc,LI,function(){return this});Ox={IteratorPrototype:Xc,BUGGY_SAFARI_ITERATORS:zx},RV=Ox.IteratorPrototype,GV=fy,ZV=OI,PV=Of,HV=Og,MV=function(){return this},NV=function(n,t,r,o){var A=t+" Iterator";return n.prototype=GV(RV,{next:ZV(+!o,r)}),PV(n,A,!1),HV[A]=MV,n},VV=So,DV=Qs,Wx=Df,KV=Mn,zV=NV,OB=Kx,WB=ix,OV=Of,WV=Vg,Y0=ru,JV=fs,XV=Og,Jx=Ox,YV=Wx.PROPER,jV=Wx.CONFIGURABLE,JB=Jx.IteratorPrototype,Tp=Jx.BUGGY_SAFARI_ITERATORS,wg=JV("iterator"),XB="keys",Bg="values",YB="entries",qV=function(){return this},$V=function(n,t,r,o,A,s,d){zV(r,t,o);var f=function(z){if(z===A&&G)return G;if(!Tp&&z&&z in S)return S[z];switch(z){case XB:return function(){return new r(this,z)};case Bg:return function(){return new r(this,z)};case YB:return function(){return new r(this,z)}}return function(){return new r(this)}},I=t+" Iterator",_=!1,S=n.prototype,U=S[wg]||S["@@iterator"]||A&&S[A],G=!Tp&&U||f(A),L=t==="Array"&&S.entries||U,K,V,q;if(L&&(K=OB(L.call(new n)),K!==Object.prototype&&K.next&&(OB(K)!==JB&&(WB?WB(K,JB):KV(K[wg])||Y0(K,wg,qV)),OV(K,I,!0))),YV&&A===Bg&&U&&U.name!==Bg&&(jV?WV(S,"name",Bg):(_=!0,G=function(){return DV(U,this)})),A)if(V={values:f(Bg),keys:s?G:f(XB),entries:f(YB)},d)for(q in V)(Tp||_||!(q in S))&&Y0(S,q,V[q]);else VV({target:t,proto:!0,forced:Tp||_},V);return S[wg]!==G&&Y0(S,wg,G,{name:A}),XV[t]=G,V},t9=function(n,t){return{value:n,done:t}},e9=Ng,_y=yV,jB=Og,Xx=Kf,i9=El.f,r9=$V,Up=t9,n9=dA,Yx="Array Iterator",s9=Xx.set,o9=Xx.getterFor(Yx),a9=r9(Array,"Array",function(n,t){s9(this,{type:Yx,target:e9(n),index:0,kind:t})},function(){var n=o9(this),t=n.target,r=n.index++;if(!t||r>=t.length)return n.target=void 0,Up(void 0,!0);switch(n.kind){case"keys":return Up(r,!1);case"values":return Up(t[r],!1)}return Up([r,t[r]],!1)},"values"),qB=jB.Arguments=jB.Array;_y("keys");_y("values");_y("entries");if(n9&&qB.name!=="values")try{i9(qB,"name",{value:"values"})}catch{}A9={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},l9=Vf,j0=l9("span").classList,$B=j0&&j0.constructor&&j0.constructor.prototype,c9=$B===Object.prototype?void 0:$B,t_=Zn,jx=A9,u9=c9,_g=a9,e_=Vg,h9=Of,g9=fs,q0=g9("iterator"),$0=_g.values,qx=function(n,t){if(n){if(n[q0]!==$0)try{e_(n,q0,$0)}catch{n[q0]=$0}if(h9(n,t,!0),jx[t]){for(var r in _g)if(n[r]!==_g[r])try{e_(n,r,_g[r])}catch{n[r]=_g[r]}}}};for(Qp in jx)qx(t_[Qp]&&t_[Qp].prototype,Qp);qx(u9,"DOMTokenList");f9=Ll,m9=Nf,C9=G_,I9=iy,i_=TypeError,r_="Reduce of empty array with no initial value",n_=function(n){return function(t,r,o,A){var s=m9(t),d=C9(s),f=I9(s);if(f9(r),f===0&&o<2)throw new i_(r_);var I=n?f-1:0,_=n?-1:1;if(o<2)for(;;){if(I in d){A=d[I],I+=_;break}if(I+=_,n?I<0:f<=I)throw new i_(r_)}for(;n?I>=0:f>I;I+=_)I in d&&(A=r(A,d[I],I,s));return A}},y9={left:n_(!1),right:n_(!0)},b9=Pn,$x=function(n,t){var r=[][n];return!!r&&b9(function(){r.call(null,t||function(){return 1},1)})},v9=So,w9=y9.left,B9=$x,s_=WI,_9=Kg,x9=!_9&&s_>79&&s_<83,S9=x9||!B9("reduce");v9({target:"Array",proto:!0,forced:S9},{reduce:function(n){var t=arguments.length;return w9(this,n,t,t>1?arguments[1]:void 0)}});F9=So,k9=Wf,L9=Mg.f,E9=ch,o_=qA,T9=wy,U9=YA,Q9=By,R9=k9("".slice),G9=Math.min,t5=Q9("endsWith"),Z9=!t5&&!!function(){var n=L9(String.prototype,"endsWith");return n&&!n.writable}();F9({target:"String",proto:!0,forced:!Z9&&!t5},{endsWith:function(n){var t=o_(U9(this));T9(n);var r=arguments.length>1?arguments[1]:void 0,o=t.length,A=r===void 0?o:G9(E9(r),o),s=o_(n);return R9(t,A-s.length,A)===s}});tI=Qs,e5=Hn,P9=Cy,H9=js,M9=eu,N9=YA,V9=Ax,D9=yy,K9=ch,a_=qA,z9=lh,A_=by,O9=Zx,W9=Pn,Ju=O9.UNSUPPORTED_Y,J9=4294967295,X9=Math.min,eI=e5([].push),iI=e5("".slice),Y9=!W9(function(){var n=/(?:)/,t=n.exec;n.exec=function(){return t.apply(this,arguments)};var r="ab".split(n);return r.length!==2||r[0]!=="a"||r[1]!=="b"}),l_="abbc".split(/(b)*/)[1]==="c"||"test".split(/(?:)/,-1).length!==4||"ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||".".split(/()()/).length>1||"".split(/.?/).length;P9("split",function(n,t,r){var o="0".split(void 0,0).length?function(A,s){return A===void 0&&s===0?[]:tI(t,this,A,s)}:t;return[function(A,s){var d=N9(this),f=M9(A)?void 0:z9(A,n);return f?tI(f,A,d,s):tI(o,a_(d),A,s)},function(A,s){var d=H9(this),f=a_(A);if(!l_){var I=r(o,d,f,s,o!==t);if(I.done)return I.value}var _=V9(d,RegExp),S=d.unicode,U=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(Ju?"g":"y"),G=new _(Ju?"^(?:"+d.source+")":d,U),L=s===void 0?J9:s>>>0;if(L===0)return[];if(f.length===0)return A_(G,f)===null?[f]:[];for(var K=0,V=0,q=[];V<f.length;){G.lastIndex=Ju?0:V;var z=A_(G,Ju?iI(f,V):f),it;if(z===null||(it=X9(K9(G.lastIndex+(Ju?V:0)),f.length))===K)V=D9(f,V,S);else{if(eI(q,iI(f,K,V)),q.length===L)return q;for(var At=1;At<=z.length-1;At++)if(eI(q,z[At]),q.length===L)return q;V=K=it}}return eI(q,iI(f,K)),q}]},l_||!Y9,Ju);qf={exports:{}},xg={exports:{}};(function(){var n,t,r,o,A,s;typeof performance<"u"&&performance!==null&&performance.now?xg.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(xg.exports=function(){return(n()-A)/1e6},t=process.hrtime,n=function(){var d;return d=t(),d[0]*1e9+d[1]},o=n(),s=process.uptime()*1e9,A=o-s):Date.now?(xg.exports=function(){return Date.now()-r},r=Date.now()):(xg.exports=function(){return new Date().getTime()-r},r=new Date().getTime())}).call(ju);j9=xg.exports,q9=j9,Fl=typeof window>"u"?ju:window,Rp=["moz","webkit"],ih="AnimationFrame",oh=Fl["request"+ih],Eg=Fl["cancel"+ih]||Fl["cancelRequest"+ih];for(Xu=0;!oh&&Xu<Rp.length;Xu++)oh=Fl[Rp[Xu]+"Request"+ih],Eg=Fl[Rp[Xu]+"Cancel"+ih]||Fl[Rp[Xu]+"CancelRequest"+ih];(!oh||!Eg)&&(Gp=0,rI=0,lc=[],c_=1e3/60,oh=function(n){if(lc.length===0){var t=q9(),r=Math.max(0,c_-(t-Gp));Gp=r+t,setTimeout(function(){var o=lc.slice(0);lc.length=0;for(var A=0;A<o.length;A++)if(!o[A].cancelled)try{o[A].callback(Gp)}catch(s){setTimeout(function(){throw s},0)}},Math.round(r))}return lc.push({handle:++rI,callback:n,cancelled:!1}),rI},Eg=function(n){for(var t=0;t<lc.length;t++)lc[t].handle===n&&(lc[t].cancelled=!0)});qf.exports=function(n){return oh.call(Fl,n)};qf.exports.cancel=function(){Eg.apply(Fl,arguments)};qf.exports.polyfill=function(n){n||(n=Fl),n.requestAnimationFrame=oh,n.cancelAnimationFrame=Eg};$9=qf.exports,nI=k_($9),i5=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,t6=Hn,e6=YA,i6=qA,EI=i5,u_=t6("".replace),r6=RegExp("^["+EI+"]+"),n6=RegExp("(^|[^"+EI+"])["+EI+"]+$"),sI=function(n){return function(t){var r=i6(e6(t));return n&1&&(r=u_(r,r6,"")),n&2&&(r=u_(r,n6,"$1")),r}},s6={start:sI(1),end:sI(2),trim:sI(3)},o6=Df.PROPER,a6=Pn,h_=i5,g_="\u200B\x85\u180E",A6=function(n){return a6(function(){return!!h_[n]()||g_[n]()!==g_||o6&&h_[n].name!==n})},l6=So,c6=s6.trim,u6=A6;l6({target:"String",proto:!0,forced:u6("trim")},{trim:function(){return c6(this)}});h6=function(n){this.ok=!1,this.alpha=1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n=n.replace(/ /g,""),n=n.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};n=t[n]||n;for(var r=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(I){return[parseInt(I[1]),parseInt(I[2]),parseInt(I[3]),parseFloat(I[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(I){return[parseInt(I[1]),parseInt(I[2]),parseInt(I[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(I){return[parseInt(I[1],16),parseInt(I[2],16),parseInt(I[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(I){return[parseInt(I[1]+I[1],16),parseInt(I[2]+I[2],16),parseInt(I[3]+I[3],16)]}}],o=0;o<r.length;o++){var A=r[o].re,s=r[o].process,d=A.exec(n);if(d){var f=s(d);this.r=f[0],this.g=f[1],this.b=f[2],f.length>3&&(this.alpha=f[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var I=this.r.toString(16),_=this.g.toString(16),S=this.b.toString(16);return I.length==1&&(I="0"+I),_.length==1&&(_="0"+_),S.length==1&&(S="0"+S),"#"+I+_+S},this.getHelpXML=function(){for(var I=new Array,_=0;_<r.length;_++)for(var S=r[_].example,U=0;U<S.length;U++)I[I.length]=S[U];for(var G in t)I[I.length]=G;var L=document.createElement("ul");L.setAttribute("id","rgbcolor-examples");for(var _=0;_<I.length;_++)try{var K=document.createElement("li"),V=new RGBColor(I[_]),q=document.createElement("div");q.style.cssText="margin: 3px; border: 1px solid black; background:"+V.toHex()+"; color:"+V.toHex(),q.appendChild(document.createTextNode("test"));var z=document.createTextNode(" "+I[_]+" -> "+V.toRGB()+" -> "+V.toHex());K.appendChild(q),K.appendChild(z),L.appendChild(K)}catch{}return L}},TI=k_(h6),g6=So,d6=Wf,p6=q_.indexOf,f6=$x,UI=d6([].indexOf),r5=!!UI&&1/UI([1],1,-0)<0,m6=r5||!f6("indexOf");g6({target:"Array",proto:!0,forced:m6},{indexOf:function(n){var t=arguments.length>1?arguments[1]:void 0;return r5?UI(this,n,t)||0:p6(this,n,t)}});C6=So,I6=Hn,y6=wy,b6=YA,d_=qA,v6=By,w6=I6("".indexOf);C6({target:"String",proto:!0,forced:!v6("includes")},{includes:function(n){return!!~w6(d_(b6(this)),d_(y6(n)),arguments.length>1?arguments[1]:void 0)}});B6=tu,_6=Array.isArray||function(n){return B6(n)==="Array"},x6=So,S6=Hn,F6=_6,k6=S6([].reverse),p_=[1,2];x6({target:"Array",proto:!0,forced:String(p_)===String(p_.reverse())},{reverse:function(){return F6(this)&&(this.length=this.length),k6(this)}});n5=function(n,t){return(n5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var A in o)Object.prototype.hasOwnProperty.call(o,A)&&(r[A]=o[A])})(n,t)};cc=Math.PI;xl=Math.PI/180;(function(n){function t(){return A(function(f,I,_){return f.relative&&(f.x1!==void 0&&(f.x1+=I),f.y1!==void 0&&(f.y1+=_),f.x2!==void 0&&(f.x2+=I),f.y2!==void 0&&(f.y2+=_),f.x!==void 0&&(f.x+=I),f.y!==void 0&&(f.y+=_),f.relative=!1),f})}function r(){var f=NaN,I=NaN,_=NaN,S=NaN;return A(function(U,G,L){return U.type&Ve.SMOOTH_CURVE_TO&&(U.type=Ve.CURVE_TO,f=isNaN(f)?G:f,I=isNaN(I)?L:I,U.x1=U.relative?G-f:2*G-f,U.y1=U.relative?L-I:2*L-I),U.type&Ve.CURVE_TO?(f=U.relative?G+U.x2:U.x2,I=U.relative?L+U.y2:U.y2):(f=NaN,I=NaN),U.type&Ve.SMOOTH_QUAD_TO&&(U.type=Ve.QUAD_TO,_=isNaN(_)?G:_,S=isNaN(S)?L:S,U.x1=U.relative?G-_:2*G-_,U.y1=U.relative?L-S:2*L-S),U.type&Ve.QUAD_TO?(_=U.relative?G+U.x1:U.x1,S=U.relative?L+U.y1:U.y1):(_=NaN,S=NaN),U})}function o(){var f=NaN,I=NaN;return A(function(_,S,U){if(_.type&Ve.SMOOTH_QUAD_TO&&(_.type=Ve.QUAD_TO,f=isNaN(f)?S:f,I=isNaN(I)?U:I,_.x1=_.relative?S-f:2*S-f,_.y1=_.relative?U-I:2*U-I),_.type&Ve.QUAD_TO){f=_.relative?S+_.x1:_.x1,I=_.relative?U+_.y1:_.y1;var G=_.x1,L=_.y1;_.type=Ve.CURVE_TO,_.x1=((_.relative?0:S)+2*G)/3,_.y1=((_.relative?0:U)+2*L)/3,_.x2=(_.x+2*G)/3,_.y2=(_.y+2*L)/3}else f=NaN,I=NaN;return _})}function A(f){var I=0,_=0,S=NaN,U=NaN;return function(G){if(isNaN(S)&&!(G.type&Ve.MOVE_TO))throw new Error("path must start with moveto");var L=f(G,I,_,S,U);return G.type&Ve.CLOSE_PATH&&(I=S,_=U),G.x!==void 0&&(I=G.relative?I+G.x:G.x),G.y!==void 0&&(_=G.relative?_+G.y:G.y),G.type&Ve.MOVE_TO&&(S=I,U=_),L}}function s(f,I,_,S,U,G){return cA(f,I,_,S,U,G),A(function(L,K,V,q){var z=L.x1,it=L.x2,At=L.relative&&!isNaN(q),_t=L.x!==void 0?L.x:At?0:K,Lt=L.y!==void 0?L.y:At?0:V;function Et(j){return j*j}L.type&Ve.HORIZ_LINE_TO&&I!==0&&(L.type=Ve.LINE_TO,L.y=L.relative?0:V),L.type&Ve.VERT_LINE_TO&&_!==0&&(L.type=Ve.LINE_TO,L.x=L.relative?0:K),L.x!==void 0&&(L.x=L.x*f+Lt*_+(At?0:U)),L.y!==void 0&&(L.y=_t*I+L.y*S+(At?0:G)),L.x1!==void 0&&(L.x1=L.x1*f+L.y1*_+(At?0:U)),L.y1!==void 0&&(L.y1=z*I+L.y1*S+(At?0:G)),L.x2!==void 0&&(L.x2=L.x2*f+L.y2*_+(At?0:U)),L.y2!==void 0&&(L.y2=it*I+L.y2*S+(At?0:G));var xt=f*S-I*_;if(L.xRot!==void 0&&(f!==1||I!==0||_!==0||S!==1))if(xt===0)delete L.rX,delete L.rY,delete L.xRot,delete L.lArcFlag,delete L.sweepFlag,L.type=Ve.LINE_TO;else{var It=L.xRot*Math.PI/180,Nt=Math.sin(It),ie=Math.cos(It),lt=1/Et(L.rX),at=1/Et(L.rY),St=Et(ie)*lt+Et(Nt)*at,Bt=2*Nt*ie*(lt-at),se=Et(Nt)*lt+Et(ie)*at,ee=St*S*S-Bt*I*S+se*I*I,qt=Bt*(f*S+I*_)-2*(St*_*S+se*f*I),Xt=St*_*_-Bt*f*_+se*f*f,vt=(Math.atan2(qt,ee-Xt)+Math.PI)%Math.PI/2,Tt=Math.sin(vt),pe=Math.cos(vt);L.rX=Math.abs(xt)/Math.sqrt(ee*Et(pe)+qt*Tt*pe+Xt*Et(Tt)),L.rY=Math.abs(xt)/Math.sqrt(ee*Et(Tt)-qt*Tt*pe+Xt*Et(pe)),L.xRot=180*vt/Math.PI}return L.sweepFlag!==void 0&&0>xt&&(L.sweepFlag=+!L.sweepFlag),L})}function d(){return function(f){var I={};for(var _ in f)I[_]=f[_];return I}}n.ROUND=function(f){function I(_){return Math.round(_*f)/f}return f===void 0&&(f=1e13),cA(f),function(_){return _.x1!==void 0&&(_.x1=I(_.x1)),_.y1!==void 0&&(_.y1=I(_.y1)),_.x2!==void 0&&(_.x2=I(_.x2)),_.y2!==void 0&&(_.y2=I(_.y2)),_.x!==void 0&&(_.x=I(_.x)),_.y!==void 0&&(_.y=I(_.y)),_.rX!==void 0&&(_.rX=I(_.rX)),_.rY!==void 0&&(_.rY=I(_.rY)),_}},n.TO_ABS=t,n.TO_REL=function(){return A(function(f,I,_){return f.relative||(f.x1!==void 0&&(f.x1-=I),f.y1!==void 0&&(f.y1-=_),f.x2!==void 0&&(f.x2-=I),f.y2!==void 0&&(f.y2-=_),f.x!==void 0&&(f.x-=I),f.y!==void 0&&(f.y-=_),f.relative=!0),f})},n.NORMALIZE_HVZ=function(f,I,_){return f===void 0&&(f=!0),I===void 0&&(I=!0),_===void 0&&(_=!0),A(function(S,U,G,L,K){if(isNaN(L)&&!(S.type&Ve.MOVE_TO))throw new Error("path must start with moveto");return I&&S.type&Ve.HORIZ_LINE_TO&&(S.type=Ve.LINE_TO,S.y=S.relative?0:G),_&&S.type&Ve.VERT_LINE_TO&&(S.type=Ve.LINE_TO,S.x=S.relative?0:U),f&&S.type&Ve.CLOSE_PATH&&(S.type=Ve.LINE_TO,S.x=S.relative?L-U:L,S.y=S.relative?K-G:K),S.type&Ve.ARC&&(S.rX===0||S.rY===0)&&(S.type=Ve.LINE_TO,delete S.rX,delete S.rY,delete S.xRot,delete S.lArcFlag,delete S.sweepFlag),S})},n.NORMALIZE_ST=r,n.QT_TO_C=o,n.INFO=A,n.SANITIZE=function(f){f===void 0&&(f=0),cA(f);var I=NaN,_=NaN,S=NaN,U=NaN;return A(function(G,L,K,V,q){var z=Math.abs,it=!1,At=0,_t=0;if(G.type&Ve.SMOOTH_CURVE_TO&&(At=isNaN(I)?0:L-I,_t=isNaN(_)?0:K-_),G.type&(Ve.CURVE_TO|Ve.SMOOTH_CURVE_TO)?(I=G.relative?L+G.x2:G.x2,_=G.relative?K+G.y2:G.y2):(I=NaN,_=NaN),G.type&Ve.SMOOTH_QUAD_TO?(S=isNaN(S)?L:2*L-S,U=isNaN(U)?K:2*K-U):G.type&Ve.QUAD_TO?(S=G.relative?L+G.x1:G.x1,U=G.relative?K+G.y1:G.y2):(S=NaN,U=NaN),G.type&Ve.LINE_COMMANDS||G.type&Ve.ARC&&(G.rX===0||G.rY===0||!G.lArcFlag)||G.type&Ve.CURVE_TO||G.type&Ve.SMOOTH_CURVE_TO||G.type&Ve.QUAD_TO||G.type&Ve.SMOOTH_QUAD_TO){var Lt=G.x===void 0?0:G.relative?G.x:G.x-L,Et=G.y===void 0?0:G.relative?G.y:G.y-K;At=isNaN(S)?G.x1===void 0?At:G.relative?G.x:G.x1-L:S-L,_t=isNaN(U)?G.y1===void 0?_t:G.relative?G.y:G.y1-K:U-K;var xt=G.x2===void 0?0:G.relative?G.x:G.x2-L,It=G.y2===void 0?0:G.relative?G.y:G.y2-K;z(Lt)<=f&&z(Et)<=f&&z(At)<=f&&z(_t)<=f&&z(xt)<=f&&z(It)<=f&&(it=!0)}return G.type&Ve.CLOSE_PATH&&z(L-V)<=f&&z(K-q)<=f&&(it=!0),it?[]:G})},n.MATRIX=s,n.ROTATE=function(f,I,_){I===void 0&&(I=0),_===void 0&&(_=0),cA(f,I,_);var S=Math.sin(f),U=Math.cos(f);return s(U,S,-S,U,I-I*U+_*S,_-I*S-_*U)},n.TRANSLATE=function(f,I){return I===void 0&&(I=0),cA(f,I),s(1,0,0,1,f,I)},n.SCALE=function(f,I){return I===void 0&&(I=f),cA(f,I),s(f,0,0,I,0,0)},n.SKEW_X=function(f){return cA(f),s(1,0,Math.atan(f),1,0,0)},n.SKEW_Y=function(f){return cA(f),s(1,Math.atan(f),0,1,0,0)},n.X_AXIS_SYMMETRY=function(f){return f===void 0&&(f=0),cA(f),s(-1,0,0,1,f,0)},n.Y_AXIS_SYMMETRY=function(f){return f===void 0&&(f=0),cA(f),s(1,0,0,-1,0,f)},n.A_TO_C=function(){return A(function(f,I,_){return Ve.ARC===f.type?function(S,U,G){var L,K,V,q;S.cX||oI(S,U,G);for(var z=Math.min(S.phi1,S.phi2),it=Math.max(S.phi1,S.phi2)-z,At=Math.ceil(it/90),_t=new Array(At),Lt=U,Et=G,xt=0;xt<At;xt++){var It=m_(S.phi1,S.phi2,xt/At),Nt=m_(S.phi1,S.phi2,(xt+1)/At),ie=Nt-It,lt=4/3*Math.tan(ie*xl/4),at=[Math.cos(It*xl)-lt*Math.sin(It*xl),Math.sin(It*xl)+lt*Math.cos(It*xl)],St=at[0],Bt=at[1],se=[Math.cos(Nt*xl),Math.sin(Nt*xl)],ee=se[0],qt=se[1],Xt=[ee+lt*Math.sin(Nt*xl),qt-lt*Math.cos(Nt*xl)],vt=Xt[0],Tt=Xt[1];_t[xt]={relative:S.relative,type:Ve.CURVE_TO};var pe=function(j,mt){var yt=QI([j*S.rX,mt*S.rY],S.xRot),Qt=yt[0],Ht=yt[1];return[S.cX+Qt,S.cY+Ht]};L=pe(St,Bt),_t[xt].x1=L[0],_t[xt].y1=L[1],K=pe(vt,Tt),_t[xt].x2=K[0],_t[xt].y2=K[1],V=pe(ee,qt),_t[xt].x=V[0],_t[xt].y=V[1],S.relative&&(_t[xt].x1-=Lt,_t[xt].y1-=Et,_t[xt].x2-=Lt,_t[xt].y2-=Et,_t[xt].x-=Lt,_t[xt].y-=Et),Lt=(q=[_t[xt].x,_t[xt].y])[0],Et=q[1]}return _t}(f,f.relative?0:I,f.relative?0:_):f})},n.ANNOTATE_ARCS=function(){return A(function(f,I,_){return f.relative&&(I=0,_=0),Ve.ARC===f.type&&oI(f,I,_),f})},n.CLONE=d,n.CALCULATE_BOUNDS=function(){var f=function(G){var L={};for(var K in G)L[K]=G[K];return L},I=t(),_=o(),S=r(),U=A(function(G,L,K){var V=S(_(I(f(G))));function q(Tt){Tt>U.maxX&&(U.maxX=Tt),Tt<U.minX&&(U.minX=Tt)}function z(Tt){Tt>U.maxY&&(U.maxY=Tt),Tt<U.minY&&(U.minY=Tt)}if(V.type&Ve.DRAWING_COMMANDS&&(q(L),z(K)),V.type&Ve.HORIZ_LINE_TO&&q(V.x),V.type&Ve.VERT_LINE_TO&&z(V.y),V.type&Ve.LINE_TO&&(q(V.x),z(V.y)),V.type&Ve.CURVE_TO){q(V.x),z(V.y);for(var it=0,At=I_(L,V.x1,V.x2,V.x);it<At.length;it++)0<(vt=At[it])&&1>vt&&q(y_(L,V.x1,V.x2,V.x,vt));for(var _t=0,Lt=I_(K,V.y1,V.y2,V.y);_t<Lt.length;_t++)0<(vt=Lt[_t])&&1>vt&&z(y_(K,V.y1,V.y2,V.y,vt))}if(V.type&Ve.ARC){q(V.x),z(V.y),oI(V,L,K);for(var Et=V.xRot/180*Math.PI,xt=Math.cos(Et)*V.rX,It=Math.sin(Et)*V.rX,Nt=-Math.sin(Et)*V.rY,ie=Math.cos(Et)*V.rY,lt=V.phi1<V.phi2?[V.phi1,V.phi2]:-180>V.phi2?[V.phi2+360,V.phi1+360]:[V.phi2,V.phi1],at=lt[0],St=lt[1],Bt=function(Tt){var pe=Tt[0],j=Tt[1],mt=180*Math.atan2(j,pe)/Math.PI;return mt<at?mt+360:mt},se=0,ee=f_(Nt,-xt,0).map(Bt);se<ee.length;se++)(vt=ee[se])>at&&vt<St&&q(C_(V.cX,xt,Nt,vt));for(var qt=0,Xt=f_(ie,-It,0).map(Bt);qt<Xt.length;qt++){var vt;(vt=Xt[qt])>at&&vt<St&&z(C_(V.cY,It,ie,vt))}}return G});return U.minX=1/0,U.maxX=-1/0,U.minY=1/0,U.maxY=-1/0,U}})(qn||(qn={}));o5=function(){function n(){}return n.prototype.round=function(t){return this.transform(qn.ROUND(t))},n.prototype.toAbs=function(){return this.transform(qn.TO_ABS())},n.prototype.toRel=function(){return this.transform(qn.TO_REL())},n.prototype.normalizeHVZ=function(t,r,o){return this.transform(qn.NORMALIZE_HVZ(t,r,o))},n.prototype.normalizeST=function(){return this.transform(qn.NORMALIZE_ST())},n.prototype.qtToC=function(){return this.transform(qn.QT_TO_C())},n.prototype.aToC=function(){return this.transform(qn.A_TO_C())},n.prototype.sanitize=function(t){return this.transform(qn.SANITIZE(t))},n.prototype.translate=function(t,r){return this.transform(qn.TRANSLATE(t,r))},n.prototype.scale=function(t,r){return this.transform(qn.SCALE(t,r))},n.prototype.rotate=function(t,r,o){return this.transform(qn.ROTATE(t,r,o))},n.prototype.matrix=function(t,r,o,A,s,d){return this.transform(qn.MATRIX(t,r,o,A,s,d))},n.prototype.skewX=function(t){return this.transform(qn.SKEW_X(t))},n.prototype.skewY=function(t){return this.transform(qn.SKEW_Y(t))},n.prototype.xSymmetry=function(t){return this.transform(qn.X_AXIS_SYMMETRY(t))},n.prototype.ySymmetry=function(t){return this.transform(qn.Y_AXIS_SYMMETRY(t))},n.prototype.annotateArcs=function(){return this.transform(qn.ANNOTATE_ARCS())},n}(),E6=function(n){return n===" "||n==="	"||n==="\r"||n===`
`},b_=function(n){return 48<=n.charCodeAt(0)&&n.charCodeAt(0)<=57},T6=function(n){function t(){var r=n.call(this)||this;return r.curNumber="",r.curCommandType=-1,r.curCommandRelative=!1,r.canParseCommandOrComma=!0,r.curNumberHasExp=!1,r.curNumberHasExpDigits=!1,r.curNumberHasDecimal=!1,r.curArgs=[],r}return s5(t,n),t.prototype.finish=function(r){if(r===void 0&&(r=[]),this.parse(" ",r),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return r},t.prototype.parse=function(r,o){var A=this;o===void 0&&(o=[]);for(var s=function(U){o.push(U),A.curArgs.length=0,A.canParseCommandOrComma=!0},d=0;d<r.length;d++){var f=r[d],I=!(this.curCommandType!==Ve.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),_=b_(f)&&(this.curNumber==="0"&&f==="0"||I);if(!b_(f)||_)if(f!=="e"&&f!=="E")if(f!=="-"&&f!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(f!=="."||this.curNumberHasExp||this.curNumberHasDecimal||I){if(this.curNumber&&this.curCommandType!==-1){var S=Number(this.curNumber);if(isNaN(S))throw new SyntaxError("Invalid number ending at "+d);if(this.curCommandType===Ve.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>S)throw new SyntaxError('Expected positive number, got "'+S+'" at index "'+d+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+d+'"')}this.curArgs.push(S),this.curArgs.length===U6[this.curCommandType]&&(Ve.HORIZ_LINE_TO===this.curCommandType?s({type:Ve.HORIZ_LINE_TO,relative:this.curCommandRelative,x:S}):Ve.VERT_LINE_TO===this.curCommandType?s({type:Ve.VERT_LINE_TO,relative:this.curCommandRelative,y:S}):this.curCommandType===Ve.MOVE_TO||this.curCommandType===Ve.LINE_TO||this.curCommandType===Ve.SMOOTH_QUAD_TO?(s({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),Ve.MOVE_TO===this.curCommandType&&(this.curCommandType=Ve.LINE_TO)):this.curCommandType===Ve.CURVE_TO?s({type:Ve.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===Ve.SMOOTH_CURVE_TO?s({type:Ve.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Ve.QUAD_TO?s({type:Ve.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Ve.ARC&&s({type:Ve.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!E6(f))if(f===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(f!=="+"&&f!=="-"&&f!==".")if(_)this.curNumber=f,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+d+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+f+'" at index '+d+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,f!=="z"&&f!=="Z")if(f==="h"||f==="H")this.curCommandType=Ve.HORIZ_LINE_TO,this.curCommandRelative=f==="h";else if(f==="v"||f==="V")this.curCommandType=Ve.VERT_LINE_TO,this.curCommandRelative=f==="v";else if(f==="m"||f==="M")this.curCommandType=Ve.MOVE_TO,this.curCommandRelative=f==="m";else if(f==="l"||f==="L")this.curCommandType=Ve.LINE_TO,this.curCommandRelative=f==="l";else if(f==="c"||f==="C")this.curCommandType=Ve.CURVE_TO,this.curCommandRelative=f==="c";else if(f==="s"||f==="S")this.curCommandType=Ve.SMOOTH_CURVE_TO,this.curCommandRelative=f==="s";else if(f==="q"||f==="Q")this.curCommandType=Ve.QUAD_TO,this.curCommandRelative=f==="q";else if(f==="t"||f==="T")this.curCommandType=Ve.SMOOTH_QUAD_TO,this.curCommandRelative=f==="t";else{if(f!=="a"&&f!=="A")throw new SyntaxError('Unexpected character "'+f+'" at index '+d+".");this.curCommandType=Ve.ARC,this.curCommandRelative=f==="a"}else o.push({type:Ve.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=f,this.curNumberHasDecimal=f==="."}else this.curNumber+=f,this.curNumberHasDecimal=!0;else this.curNumber+=f;else this.curNumber+=f,this.curNumberHasExp=!0;else this.curNumber+=f,this.curNumberHasExpDigits=this.curNumberHasExp}return o},t.prototype.transform=function(r){return Object.create(this,{parse:{value:function(o,A){A===void 0&&(A=[]);for(var s=0,d=Object.getPrototypeOf(this).parse.call(this,o);s<d.length;s++){var f=d[s],I=r(f);Array.isArray(I)?A.push.apply(A,I):A.push(I)}return A}}})},t}(o5),Ve=function(n){function t(r){var o=n.call(this)||this;return o.commands=typeof r=="string"?t.parse(r):r,o}return s5(t,n),t.prototype.encode=function(){return t.encode(this.commands)},t.prototype.getBounds=function(){var r=qn.CALCULATE_BOUNDS();return this.transform(r),r},t.prototype.transform=function(r){for(var o=[],A=0,s=this.commands;A<s.length;A++){var d=r(s[A]);Array.isArray(d)?o.push.apply(o,d):o.push(d)}return this.commands=o,this},t.encode=function(r){return L6(r)},t.parse=function(r){var o=new T6,A=[];return o.parse(r,A),o.finish(A),A},t.CLOSE_PATH=1,t.MOVE_TO=2,t.HORIZ_LINE_TO=4,t.VERT_LINE_TO=8,t.LINE_TO=16,t.CURVE_TO=32,t.SMOOTH_CURVE_TO=64,t.QUAD_TO=128,t.SMOOTH_QUAD_TO=256,t.ARC=512,t.LINE_COMMANDS=t.LINE_TO|t.HORIZ_LINE_TO|t.VERT_LINE_TO,t.DRAWING_COMMANDS=t.HORIZ_LINE_TO|t.VERT_LINE_TO|t.LINE_TO|t.CURVE_TO|t.SMOOTH_CURVE_TO|t.QUAD_TO|t.SMOOTH_QUAD_TO|t.ARC,t}(o5),U6=((lA={})[Ve.MOVE_TO]=2,lA[Ve.LINE_TO]=2,lA[Ve.HORIZ_LINE_TO]=1,lA[Ve.VERT_LINE_TO]=1,lA[Ve.CLOSE_PATH]=0,lA[Ve.QUAD_TO]=4,lA[Ve.SMOOTH_QUAD_TO]=2,lA[Ve.CURVE_TO]=6,lA[Ve.SMOOTH_CURVE_TO]=4,lA[Ve.ARC]=7,lA),Q6=Qs,R6=pA,G6=Pf,Z6=Gx,v_=RegExp.prototype,P6=function(n){var t=n.flags;return t===void 0&&!("flags"in v_)&&!R6(n,"flags")&&G6(v_,n)?Q6(Z6,n):t},H6=Df.PROPER,M6=ru,N6=js,w_=qA,V6=Pn,D6=P6,Sy="toString",a5=RegExp.prototype,A5=a5[Sy],K6=V6(function(){return A5.call({source:"a",flags:"b"})!=="/a/b"}),z6=H6&&A5.name!==Sy;(K6||z6)&&M6(a5,Sy,function(){var n=N6(this),t=w_(n.source),r=w_(D6(n));return"/"+t+"/"+r},{unsafe:!0});W6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],J6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];B_=function n(){O6(this,n),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};tD=Object.freeze({__proto__:null,offscreen:q6,node:$6});eD=/^[A-Z-]+$/;iD=/(\[[^\]]+\])/g,rD=/(#[^\s+>~.[:]+)/g,nD=/(\.[^\s+>~.[:]+)/g,sD=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,oD=/(:[\w-]+\([^)]*\))/gi,aD=/(:[^\s+>~.[:]+)/g,AD=/([^\s+>~.[:]+)/g;Jc=1e-8;Vi=class{constructor(t,r,o){this.document=t,this.name=r,this.value=o,this.isNormalizedColor=!1}static empty(t){return new Vi(t,"EMPTY","")}split(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:r,name:o}=this;return nu(this.getString()).trim().split(t).map(A=>new Vi(r,o,A))}hasValue(t){var{value:r}=this;return r!==null&&r!==""&&(t||r!==0)&&typeof r<"u"}isString(t){var{value:r}=this,o=typeof r=="string";return!o||!t?o:t.test(r)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return typeof t>"u"||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return typeof t>"u"?0:parseFloat(t);var{value:r}=this,o=parseFloat(r);return this.isString(/%$/)&&(o/=100),o}getString(t){return typeof t>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(t)}getColor(t){var r=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,r=h5(r),this.value=r),r}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[o,A]=typeof t=="boolean"?[void 0,t]:[t],{viewPort:s}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(s.computeSize("x"),s.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(s.computeSize("x"),s.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*s.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*s.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&A):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*s.computeSize(o);default:{var d=this.getNumber();return r&&d<1?d*s.computeSize(o):d}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var t=this.getString(),r=/#([^)'"]+)/.exec(t);return r&&(r=r[1]),r||(r=t),this.document.definitions[r]}getFillStyleDefinition(t,r){var o=this.getDefinition();if(!o)return null;if(typeof o.createGradient=="function")return o.createGradient(this.document.ctx,t,r);if(typeof o.createPattern=="function"){if(o.getHrefAttribute().hasValue()){var A=o.getAttribute("patternTransform");o=o.getHrefAttribute().getDefinition(),A.hasValue()&&o.getAttribute("patternTransform",!0).setValue(A.value)}return o.createPattern(this.document.ctx,t,r)}return null}getTextBaseline(){return this.hasValue()?Vi.textBaselineMapping[this.getString()]:null}addOpacity(t){for(var r=this.getColor(),o=r.length,A=0,s=0;s<o&&(r[s]===","&&A++,A!==3);s++);if(t.hasValue()&&this.isString()&&A!==3){var d=new TI(r);d.ok&&(d.alpha=t.getNumber(),r=d.toRGBA())}return new Vi(this.document,this.name,r)}};Vi.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};$p=class{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(t,r){this.viewPorts.push({width:t,height:r})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:t}=this;return t[t.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return typeof t=="number"?t:t==="x"?this.width:t==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}},In=class{constructor(t,r){this.x=t,this.y=r}static parse(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[o=r,A=r]=Vo(t);return new In(o,A)}static parseScale(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[o=r,A=o]=Vo(t);return new In(o,A)}static parsePath(t){for(var r=Vo(t),o=r.length,A=[],s=0;s<o;s+=2)A.push(new In(r[s],r[s+1]));return A}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){var{x:r,y:o}=this,A=r*t[0]+o*t[2]+t[4],s=r*t[1]+o*t[3]+t[5];this.x=A,this.y=s}},tf=class{constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:t,onClick:r,onMouseMove:o}=this,A=t.ctx.canvas;A.onclick=r,A.onmousemove=o,this.working=!0}}stop(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:t,events:r,eventElements:o}=this,{style:A}=t.ctx.canvas;A&&(A.cursor=""),r.forEach((s,d)=>{for(var{run:f}=s,I=o[d];I;)f(I),I=I.parent}),this.events=[],this.eventElements=[]}}checkPath(t,r){if(!(!this.working||!r)){var{events:o,eventElements:A}=this;o.forEach((s,d)=>{var{x:f,y:I}=s;!A[d]&&r.isPointInPath&&r.isPointInPath(f,I)&&(A[d]=t)})}}checkBoundingBox(t,r){if(!(!this.working||!r)){var{events:o,eventElements:A}=this;o.forEach((s,d)=>{var{x:f,y:I}=s;!A[d]&&r.isPointInBox(f,I)&&(A[d]=t)})}}mapXY(t,r){for(var{window:o,ctx:A}=this.screen,s=new In(t,r),d=A.canvas;d;)s.x-=d.offsetLeft,s.y-=d.offsetTop,d=d.offsetParent;return o.scrollX&&(s.x+=o.scrollX),o.scrollY&&(s.y+=o.scrollY),s}onClick(t){var{x:r,y:o}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:r,y:o,run(A){A.onClick&&A.onClick()}})}onMouseMove(t){var{x:r,y:o}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:r,y:o,run(A){A.onMouseMove&&A.onMouseMove()}})}},d5=typeof window<"u"?window:null,p5=typeof fetch<"u"?fetch.bind(void 0):null,Yc=class{constructor(t){var{fetch:r=p5,window:o=d5}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=t,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new $p,this.mouse=new tf(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=o,this.fetch=r}wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var t=this.waits.every(r=>r());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){var{document:r,ctx:o,aspectRatio:A,width:s,desiredWidth:d,height:f,desiredHeight:I,minX:_=0,minY:S=0,refX:U,refY:G,clip:L=!1,clipX:K=0,clipY:V=0}=t,q=nu(A).replace(/^defer\s/,""),[z,it]=q.split(" "),At=z||"xMidYMid",_t=it||"meet",Lt=s/d,Et=f/I,xt=Math.min(Lt,Et),It=Math.max(Lt,Et),Nt=d,ie=I;_t==="meet"&&(Nt*=xt,ie*=xt),_t==="slice"&&(Nt*=It,ie*=It);var lt=new Vi(r,"refX",U),at=new Vi(r,"refY",G),St=lt.hasValue()&&at.hasValue();if(St&&o.translate(-xt*lt.getPixels("x"),-xt*at.getPixels("y")),L){var Bt=xt*K,se=xt*V;o.beginPath(),o.moveTo(Bt,se),o.lineTo(s,se),o.lineTo(s,f),o.lineTo(Bt,f),o.closePath(),o.clip()}if(!St){var ee=_t==="meet"&&xt===Et,qt=_t==="slice"&&It===Et,Xt=_t==="meet"&&xt===Lt,vt=_t==="slice"&&It===Lt;At.startsWith("xMid")&&(ee||qt)&&o.translate(s/2-Nt/2,0),At.endsWith("YMid")&&(Xt||vt)&&o.translate(0,f/2-ie/2),At.startsWith("xMax")&&(ee||qt)&&o.translate(s-Nt,0),At.endsWith("YMax")&&(Xt||vt)&&o.translate(0,f-ie)}switch(!0){case At==="none":o.scale(Lt,Et);break;case _t==="meet":o.scale(xt,xt);break;case _t==="slice":o.scale(It,It);break}o.translate(-_,-S)}start(t){var{enableRedraw:r=!1,ignoreMouse:o=!1,ignoreAnimation:A=!1,ignoreDimensions:s=!1,ignoreClear:d=!1,forceRedraw:f,scaleWidth:I,scaleHeight:_,offsetX:S,offsetY:U}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:G,mouse:L}=this,K=1e3/G;if(this.frameDuration=K,this.readyPromise=new Promise(At=>{this.resolveReady=At}),this.isReady()&&this.render(t,s,d,I,_,S,U),!!r){var V=Date.now(),q=V,z=0,it=()=>{V=Date.now(),z=V-q,z>=K&&(q=V-z%K,this.shouldUpdate(A,f)&&(this.render(t,s,d,I,_,S,U),L.runEvents())),this.intervalId=nI(it)};o||L.start(),this.intervalId=nI(it)}}stop(){this.intervalId&&(nI.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,r){if(!t){var{frameDuration:o}=this,A=this.animations.reduce((s,d)=>d.update(o)||s,!1);if(A)return!0}return!!(typeof r=="function"&&r()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(t,r,o,A,s,d,f){var{CLIENT_WIDTH:I,CLIENT_HEIGHT:_,viewPort:S,ctx:U,isFirstRender:G}=this,L=U.canvas;S.clear(),L.width&&L.height?S.setCurrent(L.width,L.height):S.setCurrent(I,_);var K=t.getStyle("width"),V=t.getStyle("height");!r&&(G||typeof A!="number"&&typeof s!="number")&&(K.hasValue()&&(L.width=K.getPixels("x"),L.style&&(L.style.width="".concat(L.width,"px"))),V.hasValue()&&(L.height=V.getPixels("y"),L.style&&(L.style.height="".concat(L.height,"px"))));var q=L.clientWidth||L.width,z=L.clientHeight||L.height;if(r&&K.hasValue()&&V.hasValue()&&(q=K.getPixels("x"),z=V.getPixels("y")),S.setCurrent(q,z),typeof d=="number"&&t.getAttribute("x",!0).setValue(d),typeof f=="number"&&t.getAttribute("y",!0).setValue(f),typeof A=="number"||typeof s=="number"){var it=Vo(t.getAttribute("viewBox").getString()),At=0,_t=0;if(typeof A=="number"){var Lt=t.getStyle("width");Lt.hasValue()?At=Lt.getPixels("x")/A:isNaN(it[2])||(At=it[2]/A)}if(typeof s=="number"){var Et=t.getStyle("height");Et.hasValue()?_t=Et.getPixels("y")/s:isNaN(it[3])||(_t=it[3]/s)}At||(At=_t),_t||(_t=At),t.getAttribute("width",!0).setValue(A),t.getAttribute("height",!0).setValue(s);var xt=t.getStyle("transform",!0,!0);xt.setValue("".concat(xt.getString()," scale(").concat(1/At,", ").concat(1/_t,")"))}o||U.clearRect(0,0,q,z),t.render(U),G&&(this.isFirstRender=!1)}};Yc.defaultWindow=d5;Yc.defaultFetch=p5;({defaultFetch:lD}=Yc),cD=typeof DOMParser<"u"?DOMParser:null,rh=class{constructor(){var{fetch:t=lD,DOMParser:r=cD}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=t,this.DOMParser=r}parse(t){var r=this;return kl(function*(){return t.startsWith("<")?r.parseFromString(t):r.load(t)})()}parseFromString(t){var r=new this.DOMParser;try{return this.checkDocument(r.parseFromString(t,"image/svg+xml"))}catch{return this.checkDocument(r.parseFromString(t,"text/xml"))}}checkDocument(t){var r=t.getElementsByTagName("parsererror")[0];if(r)throw new Error(r.textContent);return t}load(t){var r=this;return kl(function*(){var o=yield r.fetch(t),A=yield o.text();return r.parseFromString(A)})()}},ef=class{constructor(t,r){this.type="translate",this.point=null,this.point=In.parse(r)}apply(t){var{x:r,y:o}=this.point;t.translate(r||0,o||0)}unapply(t){var{x:r,y:o}=this.point;t.translate(-1*r||0,-1*o||0)}applyToPoint(t){var{x:r,y:o}=this.point;t.applyTransform([1,0,0,1,r||0,o||0])}},rf=class{constructor(t,r,o){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var A=Vo(r);this.angle=new Vi(t,"angle",A[0]),this.originX=o[0],this.originY=o[1],this.cx=A[1]||0,this.cy=A[2]||0}apply(t){var{cx:r,cy:o,originX:A,originY:s,angle:d}=this,f=r+A.getPixels("x"),I=o+s.getPixels("y");t.translate(f,I),t.rotate(d.getRadians()),t.translate(-f,-I)}unapply(t){var{cx:r,cy:o,originX:A,originY:s,angle:d}=this,f=r+A.getPixels("x"),I=o+s.getPixels("y");t.translate(f,I),t.rotate(-1*d.getRadians()),t.translate(-f,-I)}applyToPoint(t){var{cx:r,cy:o,angle:A}=this,s=A.getRadians();t.applyTransform([1,0,0,1,r||0,o||0]),t.applyTransform([Math.cos(s),Math.sin(s),-Math.sin(s),Math.cos(s),0,0]),t.applyTransform([1,0,0,1,-r||0,-o||0])}},nf=class{constructor(t,r,o){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var A=In.parseScale(r);(A.x===0||A.y===0)&&(A.x=Jc,A.y=Jc),this.scale=A,this.originX=o[0],this.originY=o[1]}apply(t){var{scale:{x:r,y:o},originX:A,originY:s}=this,d=A.getPixels("x"),f=s.getPixels("y");t.translate(d,f),t.scale(r,o||r),t.translate(-d,-f)}unapply(t){var{scale:{x:r,y:o},originX:A,originY:s}=this,d=A.getPixels("x"),f=s.getPixels("y");t.translate(d,f),t.scale(1/r,1/o||r),t.translate(-d,-f)}applyToPoint(t){var{x:r,y:o}=this.scale;t.applyTransform([r||0,0,0,o||0,0,0])}},Tg=class{constructor(t,r,o){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=Vo(r),this.originX=o[0],this.originY=o[1]}apply(t){var{originX:r,originY:o,matrix:A}=this,s=r.getPixels("x"),d=o.getPixels("y");t.translate(s,d),t.transform(A[0],A[1],A[2],A[3],A[4],A[5]),t.translate(-s,-d)}unapply(t){var{originX:r,originY:o,matrix:A}=this,s=A[0],d=A[2],f=A[4],I=A[1],_=A[3],S=A[5],U=0,G=0,L=1,K=1/(s*(_*L-S*G)-d*(I*L-S*U)+f*(I*G-_*U)),V=r.getPixels("x"),q=o.getPixels("y");t.translate(V,q),t.transform(K*(_*L-S*G),K*(S*U-I*L),K*(f*G-d*L),K*(s*L-f*U),K*(d*S-f*_),K*(f*I-s*S)),t.translate(-V,-q)}applyToPoint(t){t.applyTransform(this.matrix)}},Ug=class extends Tg{constructor(t,r,o){super(t,r,o),this.type="skew",this.angle=null,this.angle=new Vi(t,"angle",r)}},sf=class extends Ug{constructor(t,r,o){super(t,r,o),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}},of=class extends Ug{constructor(t,r,o){super(t,r,o),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}};JA=class{constructor(t,r,o){this.document=t,this.transforms=[];var A=uD(r);A.forEach(s=>{if(s!=="none"){var[d,f]=hD(s),I=JA.transformTypes[d];typeof I<"u"&&this.transforms.push(new I(this.document,f,o))}})}static fromElement(t,r){var o=r.getStyle("transform",!1,!0),[A,s=A]=r.getStyle("transform-origin",!1,!0).split(),d=[A,s];return o.hasValue()?new JA(t,o.getString(),d):null}apply(t){for(var{transforms:r}=this,o=r.length,A=0;A<o;A++)r[A].apply(t)}unapply(t){for(var{transforms:r}=this,o=r.length,A=o-1;A>=0;A--)r[A].unapply(t)}applyToPoint(t){for(var{transforms:r}=this,o=r.length,A=0;A<o;A++)r[A].applyToPoint(t)}};JA.transformTypes={translate:ef,rotate:rf,scale:nf,matrix:Tg,skewX:sf,skewY:of};qr=class{constructor(t,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=t,this.node=r,this.captureTextNodes=o,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!r||r.nodeType!==1)){if(Array.from(r.attributes).forEach(f=>{var I=u5(f.nodeName);this.attributes[I]=new Vi(t,I,f.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var A=this.getAttribute("style").getString().split(";").map(f=>f.trim());A.forEach(f=>{if(f){var[I,_]=f.split(":").map(S=>S.trim());this.styles[I]=new Vi(t,I,_)}})}var{definitions:s}=t,d=this.getAttribute("id");d.hasValue()&&(s[d.getString()]||(s[d.getString()]=this)),Array.from(r.childNodes).forEach(f=>{if(f.nodeType===1)this.addChild(f);else if(o&&(f.nodeType===3||f.nodeType===4)){var I=t.createTextNode(f);I.getText().length>0&&this.addChild(I)}})}}getAttribute(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.attributes[t];if(!o&&r){var A=new Vi(this.document,t,"");return this.attributes[t]=A,A}return o||Vi.empty(this.document)}getHrefAttribute(){for(var t in this.attributes)if(t==="href"||t.endsWith(":href"))return this.attributes[t];return Vi.empty(this.document)}getStyle(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=this.styles[t];if(A)return A;var s=this.getAttribute(t);if(s!=null&&s.hasValue())return this.styles[t]=s,s;if(!o){var{parent:d}=this;if(d){var f=d.getStyle(t);if(f!=null&&f.hasValue())return f}}if(r){var I=new Vi(this.document,t,"");return this.styles[t]=I,I}return A||Vi.empty(this.document)}render(t){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(t.save(),this.getStyle("mask").hasValue()){var r=this.getStyle("mask").getDefinition();r&&(this.applyEffects(t),r.apply(t,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var o=this.getStyle("filter").getDefinition();o&&(this.applyEffects(t),o.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){var r=JA.fromElement(this.document,this);r&&r.apply(t);var o=this.getStyle("clip-path",!1,!0);if(o.hasValue()){var A=o.getDefinition();A&&A.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(r=>{r.render(t)})}addChild(t){var r=t instanceof qr?t:this.document.createElement(t);r.parent=this,qr.ignoreChildTypes.includes(r.type)||this.children.push(r)}matchesSelector(t){var r,{node:o}=this;if(typeof o.matches=="function")return o.matches(t);var A=(r=o.getAttribute)===null||r===void 0?void 0:r.call(o,"class");return!A||A===""?!1:A.split(" ").some(s=>".".concat(s)===t)}addStylesFromStyleDefinition(){var{styles:t,stylesSpecificity:r}=this.document;for(var o in t)if(!o.startsWith("@")&&this.matchesSelector(o)){var A=t[o],s=r[o];if(A)for(var d in A){var f=this.stylesSpecificity[d];typeof f>"u"&&(f="000"),s>=f&&(this.styles[d]=A[d],this.stylesSpecificity[d]=s)}}}removeStyles(t,r){var o=r.reduce((A,s)=>{var d=t.getStyle(s);if(!d.hasValue())return A;var f=d.getString();return d.setValue(""),[...A,[s,f]]},[]);return o}restoreStyles(t,r){r.forEach(o=>{var[A,s]=o;t.getStyle(A,!0).setValue(s)})}isFirstChild(){var t;return((t=this.parent)===null||t===void 0?void 0:t.children.indexOf(this))===0}};qr.ignoreChildTypes=["title"];af=class extends qr{constructor(t,r,o){super(t,r,o)}};ps=class{constructor(t,r,o,A,s,d){var f=d?typeof d=="string"?ps.parse(d):d:{};this.fontFamily=s||f.fontFamily,this.fontSize=A||f.fontSize,this.fontStyle=t||f.fontStyle,this.fontWeight=o||f.fontWeight,this.fontVariant=r||f.fontVariant}static parse(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,o="",A="",s="",d="",f="",I=nu(t).trim().split(" "),_={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return I.forEach(S=>{switch(!0){case(!_.fontStyle&&ps.styles.includes(S)):S!=="inherit"&&(o=S),_.fontStyle=!0;break;case(!_.fontVariant&&ps.variants.includes(S)):S!=="inherit"&&(A=S),_.fontStyle=!0,_.fontVariant=!0;break;case(!_.fontWeight&&ps.weights.includes(S)):S!=="inherit"&&(s=S),_.fontStyle=!0,_.fontVariant=!0,_.fontWeight=!0;break;case!_.fontSize:S!=="inherit"&&([d]=S.split("/")),_.fontStyle=!0,_.fontVariant=!0,_.fontWeight=!0,_.fontSize=!0;break;default:S!=="inherit"&&(f+=S)}}),new ps(o,A,s,d,f,r)}toString(){return[pD(this.fontStyle),this.fontVariant,fD(this.fontWeight),this.fontSize,dD(this.fontFamily)].join(" ").trim()}};ps.styles="normal|italic|oblique|inherit";ps.variants="normal|small-caps|inherit";ps.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";Do=class{constructor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,A=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=t,this.y1=r,this.x2=o,this.y2=A,this.addPoint(t,r),this.addPoint(o,A)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,r){typeof t<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof r<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=r,this.y2=r),r<this.y1&&(this.y1=r),r>this.y2&&(this.y2=r))}addX(t){this.addPoint(t,null)}addY(t){this.addPoint(null,t)}addBoundingBox(t){if(t){var{x1:r,y1:o,x2:A,y2:s}=t;this.addPoint(r,o),this.addPoint(A,s)}}sumCubic(t,r,o,A,s){return Math.pow(1-t,3)*r+3*Math.pow(1-t,2)*t*o+3*(1-t)*Math.pow(t,2)*A+Math.pow(t,3)*s}bezierCurveAdd(t,r,o,A,s){var d=6*r-12*o+6*A,f=-3*r+9*o-9*A+3*s,I=3*o-3*r;if(f===0){if(d===0)return;var _=-I/d;0<_&&_<1&&(t?this.addX(this.sumCubic(_,r,o,A,s)):this.addY(this.sumCubic(_,r,o,A,s)));return}var S=Math.pow(d,2)-4*I*f;if(!(S<0)){var U=(-d+Math.sqrt(S))/(2*f);0<U&&U<1&&(t?this.addX(this.sumCubic(U,r,o,A,s)):this.addY(this.sumCubic(U,r,o,A,s)));var G=(-d-Math.sqrt(S))/(2*f);0<G&&G<1&&(t?this.addX(this.sumCubic(G,r,o,A,s)):this.addY(this.sumCubic(G,r,o,A,s)))}}addBezierCurve(t,r,o,A,s,d,f,I){this.addPoint(t,r),this.addPoint(f,I),this.bezierCurveAdd(!0,t,o,s,f),this.bezierCurveAdd(!1,r,A,d,I)}addQuadraticCurve(t,r,o,A,s,d){var f=t+.6666666666666666*(o-t),I=r+2/3*(A-r),_=f+1/3*(s-t),S=I+1/3*(d-r);this.addBezierCurve(t,r,f,_,I,S,s,d)}isPointInBox(t,r){var{x1:o,y1:A,x2:s,y2:d}=this;return o<=t&&t<=s&&A<=r&&r<=d}},sr=class extends Ve{constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new In(0,0),this.control=new In(0,0),this.current=new In(0,0),this.points=[],this.angles=[]}isEnd(){var{i:t,commands:r}=this;return t>=r.length-1}next(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",o=new In(this.command[t],this.command[r]);return this.makeAbsolute(o)}getAsControlPoint(t,r){var o=this.getPoint(t,r);return this.control=o,o}getAsCurrentPoint(t,r){var o=this.getPoint(t,r);return this.current=o,o}getReflectedControlPoint(){var t=this.previousCommand.type;if(t!==Ve.CURVE_TO&&t!==Ve.SMOOTH_CURVE_TO&&t!==Ve.QUAD_TO&&t!==Ve.SMOOTH_QUAD_TO)return this.current;var{current:{x:r,y:o},control:{x:A,y:s}}=this,d=new In(2*r-A,2*o-s);return d}makeAbsolute(t){if(this.command.relative){var{x:r,y:o}=this.current;t.x+=r,t.y+=o}return t}addMarker(t,r,o){var{points:A,angles:s}=this;o&&s.length>0&&!s[s.length-1]&&(s[s.length-1]=A[A.length-1].angleTo(o)),this.addMarkerAngle(t,r?r.angleTo(t):null)}addMarkerAngle(t,r){this.points.push(t),this.angles.push(r)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:t}=this,r=t.length,o=0;o<r;o++)if(!t[o]){for(var A=o+1;A<r;A++)if(t[A]){t[o]=t[A];break}}return t}},XA=class extends qr{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var t=1,r=this;r;){var o=r.getStyle("opacity",!1,!0);o.hasValue(!0)&&(t*=o.getNumber()),r=r.parent}return t}setContext(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r){var o=this.getStyle("fill"),A=this.getStyle("fill-opacity"),s=this.getStyle("stroke"),d=this.getStyle("stroke-opacity");if(o.isUrlDefinition()){var f=o.getFillStyleDefinition(this,A);f&&(t.fillStyle=f)}else if(o.hasValue()){o.getString()==="currentColor"&&o.setValue(this.getStyle("color").getColor());var I=o.getColor();I!=="inherit"&&(t.fillStyle=I==="none"?"rgba(0,0,0,0)":I)}if(A.hasValue()){var _=new Vi(this.document,"fill",t.fillStyle).addOpacity(A).getColor();t.fillStyle=_}if(s.isUrlDefinition()){var S=s.getFillStyleDefinition(this,d);S&&(t.strokeStyle=S)}else if(s.hasValue()){s.getString()==="currentColor"&&s.setValue(this.getStyle("color").getColor());var U=s.getString();U!=="inherit"&&(t.strokeStyle=U==="none"?"rgba(0,0,0,0)":U)}if(d.hasValue()){var G=new Vi(this.document,"stroke",t.strokeStyle).addOpacity(d).getString();t.strokeStyle=G}var L=this.getStyle("stroke-width");if(L.hasValue()){var K=L.getPixels();t.lineWidth=K||Jc}var V=this.getStyle("stroke-linecap"),q=this.getStyle("stroke-linejoin"),z=this.getStyle("stroke-miterlimit"),it=this.getStyle("stroke-dasharray"),At=this.getStyle("stroke-dashoffset");if(V.hasValue()&&(t.lineCap=V.getString()),q.hasValue()&&(t.lineJoin=q.getString()),z.hasValue()&&(t.miterLimit=z.getNumber()),it.hasValue()&&it.getString()!=="none"){var _t=Vo(it.getString());typeof t.setLineDash<"u"?t.setLineDash(_t):typeof t.webkitLineDash<"u"?t.webkitLineDash=_t:typeof t.mozDash<"u"&&!(_t.length===1&&_t[0]===0)&&(t.mozDash=_t);var Lt=At.getPixels();typeof t.lineDashOffset<"u"?t.lineDashOffset=Lt:typeof t.webkitLineDashOffset<"u"?t.webkitLineDashOffset=Lt:typeof t.mozDashOffset<"u"&&(t.mozDashOffset=Lt)}}if(this.modifiedEmSizeStack=!1,typeof t.font<"u"){var Et=this.getStyle("font"),xt=this.getStyle("font-style"),It=this.getStyle("font-variant"),Nt=this.getStyle("font-weight"),ie=this.getStyle("font-size"),lt=this.getStyle("font-family"),at=new ps(xt.getString(),It.getString(),Nt.getString(),ie.hasValue()?"".concat(ie.getPixels(!0),"px"):"",lt.getString(),ps.parse(Et.getString(),t.font));xt.setValue(at.fontStyle),It.setValue(at.fontVariant),Nt.setValue(at.fontWeight),ie.setValue(at.fontSize),lt.setValue(at.fontFamily),t.font=at.toString(),ie.isPixels()&&(this.document.emSize=ie.getPixels(),this.modifiedEmSizeStack=!0)}r||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}},Ur=class extends XA{constructor(t,r,o){super(t,r,o),this.type="path",this.pathParser=null,this.pathParser=new sr(this.getAttribute("d").getString())}path(t){var{pathParser:r}=this,o=new Do;for(r.reset(),t&&t.beginPath();!r.isEnd();)switch(r.next().type){case sr.MOVE_TO:this.pathM(t,o);break;case sr.LINE_TO:this.pathL(t,o);break;case sr.HORIZ_LINE_TO:this.pathH(t,o);break;case sr.VERT_LINE_TO:this.pathV(t,o);break;case sr.CURVE_TO:this.pathC(t,o);break;case sr.SMOOTH_CURVE_TO:this.pathS(t,o);break;case sr.QUAD_TO:this.pathQ(t,o);break;case sr.SMOOTH_QUAD_TO:this.pathT(t,o);break;case sr.ARC:this.pathA(t,o);break;case sr.CLOSE_PATH:this.pathZ(t,o);break}return o}getBoundingBox(t){return this.path()}getMarkers(){var{pathParser:t}=this,r=t.getMarkerPoints(),o=t.getMarkerAngles(),A=r.map((s,d)=>[s,o[d]]);return A}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var r=this.getStyle("fill-rule");t.fillStyle!==""&&(r.getString("inherit")!=="inherit"?t.fill(r.getString()):t.fill()),t.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var o=this.getMarkers();if(o){var A=o.length-1,s=this.getStyle("marker-start"),d=this.getStyle("marker-mid"),f=this.getStyle("marker-end");if(s.isUrlDefinition()){var I=s.getDefinition(),[_,S]=o[0];I.render(t,_,S)}if(d.isUrlDefinition())for(var U=d.getDefinition(),G=1;G<A;G++){var[L,K]=o[G];U.render(t,L,K)}if(f.isUrlDefinition()){var V=f.getDefinition(),[q,z]=o[A];V.render(t,q,z)}}}static pathM(t){var r=t.getAsCurrentPoint();return t.start=t.current,{point:r}}pathM(t,r){var{pathParser:o}=this,{point:A}=Ur.pathM(o),{x:s,y:d}=A;o.addMarker(A),r.addPoint(s,d),t&&t.moveTo(s,d)}static pathL(t){var{current:r}=t,o=t.getAsCurrentPoint();return{current:r,point:o}}pathL(t,r){var{pathParser:o}=this,{current:A,point:s}=Ur.pathL(o),{x:d,y:f}=s;o.addMarker(s,A),r.addPoint(d,f),t&&t.lineTo(d,f)}static pathH(t){var{current:r,command:o}=t,A=new In((o.relative?r.x:0)+o.x,r.y);return t.current=A,{current:r,point:A}}pathH(t,r){var{pathParser:o}=this,{current:A,point:s}=Ur.pathH(o),{x:d,y:f}=s;o.addMarker(s,A),r.addPoint(d,f),t&&t.lineTo(d,f)}static pathV(t){var{current:r,command:o}=t,A=new In(r.x,(o.relative?r.y:0)+o.y);return t.current=A,{current:r,point:A}}pathV(t,r){var{pathParser:o}=this,{current:A,point:s}=Ur.pathV(o),{x:d,y:f}=s;o.addMarker(s,A),r.addPoint(d,f),t&&t.lineTo(d,f)}static pathC(t){var{current:r}=t,o=t.getPoint("x1","y1"),A=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:r,point:o,controlPoint:A,currentPoint:s}}pathC(t,r){var{pathParser:o}=this,{current:A,point:s,controlPoint:d,currentPoint:f}=Ur.pathC(o);o.addMarker(f,d,s),r.addBezierCurve(A.x,A.y,s.x,s.y,d.x,d.y,f.x,f.y),t&&t.bezierCurveTo(s.x,s.y,d.x,d.y,f.x,f.y)}static pathS(t){var{current:r}=t,o=t.getReflectedControlPoint(),A=t.getAsControlPoint("x2","y2"),s=t.getAsCurrentPoint();return{current:r,point:o,controlPoint:A,currentPoint:s}}pathS(t,r){var{pathParser:o}=this,{current:A,point:s,controlPoint:d,currentPoint:f}=Ur.pathS(o);o.addMarker(f,d,s),r.addBezierCurve(A.x,A.y,s.x,s.y,d.x,d.y,f.x,f.y),t&&t.bezierCurveTo(s.x,s.y,d.x,d.y,f.x,f.y)}static pathQ(t){var{current:r}=t,o=t.getAsControlPoint("x1","y1"),A=t.getAsCurrentPoint();return{current:r,controlPoint:o,currentPoint:A}}pathQ(t,r){var{pathParser:o}=this,{current:A,controlPoint:s,currentPoint:d}=Ur.pathQ(o);o.addMarker(d,s,s),r.addQuadraticCurve(A.x,A.y,s.x,s.y,d.x,d.y),t&&t.quadraticCurveTo(s.x,s.y,d.x,d.y)}static pathT(t){var{current:r}=t,o=t.getReflectedControlPoint();t.control=o;var A=t.getAsCurrentPoint();return{current:r,controlPoint:o,currentPoint:A}}pathT(t,r){var{pathParser:o}=this,{current:A,controlPoint:s,currentPoint:d}=Ur.pathT(o);o.addMarker(d,s,s),r.addQuadraticCurve(A.x,A.y,s.x,s.y,d.x,d.y),t&&t.quadraticCurveTo(s.x,s.y,d.x,d.y)}static pathA(t){var{current:r,command:o}=t,{rX:A,rY:s,xRot:d,lArcFlag:f,sweepFlag:I}=o,_=d*(Math.PI/180),S=t.getAsCurrentPoint(),U=new In(Math.cos(_)*(r.x-S.x)/2+Math.sin(_)*(r.y-S.y)/2,-Math.sin(_)*(r.x-S.x)/2+Math.cos(_)*(r.y-S.y)/2),G=Math.pow(U.x,2)/Math.pow(A,2)+Math.pow(U.y,2)/Math.pow(s,2);G>1&&(A*=Math.sqrt(G),s*=Math.sqrt(G));var L=(f===I?-1:1)*Math.sqrt((Math.pow(A,2)*Math.pow(s,2)-Math.pow(A,2)*Math.pow(U.y,2)-Math.pow(s,2)*Math.pow(U.x,2))/(Math.pow(A,2)*Math.pow(U.y,2)+Math.pow(s,2)*Math.pow(U.x,2)));isNaN(L)&&(L=0);var K=new In(L*A*U.y/s,L*-s*U.x/A),V=new In((r.x+S.x)/2+Math.cos(_)*K.x-Math.sin(_)*K.y,(r.y+S.y)/2+Math.sin(_)*K.x+Math.cos(_)*K.y),q=GI([1,0],[(U.x-K.x)/A,(U.y-K.y)/s]),z=[(U.x-K.x)/A,(U.y-K.y)/s],it=[(-U.x-K.x)/A,(-U.y-K.y)/s],At=GI(z,it);return qp(z,it)<=-1&&(At=Math.PI),qp(z,it)>=1&&(At=0),{currentPoint:S,rX:A,rY:s,sweepFlag:I,xAxisRotation:_,centp:V,a1:q,ad:At}}pathA(t,r){var{pathParser:o}=this,{currentPoint:A,rX:s,rY:d,sweepFlag:f,xAxisRotation:I,centp:_,a1:S,ad:U}=Ur.pathA(o),G=1-f?1:-1,L=S+G*(U/2),K=new In(_.x+s*Math.cos(L),_.y+d*Math.sin(L));if(o.addMarkerAngle(K,L-G*Math.PI/2),o.addMarkerAngle(A,L-G*Math.PI),r.addPoint(A.x,A.y),t&&!isNaN(S)&&!isNaN(U)){var V=s>d?s:d,q=s>d?1:s/d,z=s>d?d/s:1;t.translate(_.x,_.y),t.rotate(I),t.scale(q,z),t.arc(0,0,V,S,S+U,!!(1-f)),t.scale(1/q,1/z),t.rotate(-I),t.translate(-_.x,-_.y)}}static pathZ(t){t.current=t.start}pathZ(t,r){Ur.pathZ(this.pathParser),t&&r.x1!==r.x2&&r.y1!==r.y2&&t.closePath()}},Qg=class extends Ur{constructor(t,r,o){super(t,r,o),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}},gA=class extends XA{constructor(t,r,o){super(t,r,new.target===gA?!0:o),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(t,r);var o=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();o&&(t.textBaseline=o)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if(this.type!=="text")return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);var r=null;return this.children.forEach((o,A)=>{var s=this.getChildBoundingBox(t,this,this,A);r?r.addBoundingBox(s):r=s}),r}getFontSize(){var{document:t,parent:r}=this,o=ps.parse(t.ctx.font).fontSize,A=r.getStyle("font-size").getNumber(o);return A}getTElementBoundingBox(t){var r=this.getFontSize();return new Do(this.x,this.y-r,this.x+this.measureText(t),this.y)}getGlyph(t,r,o){var A=r[o],s=null;if(t.isArabic){var d=r.length,f=r[o-1],I=r[o+1],_="isolated";if((o===0||f===" ")&&o<d-1&&I!==" "&&(_="terminal"),o>0&&f!==" "&&o<d-1&&I!==" "&&(_="medial"),o>0&&f!==" "&&(o===d-1||I===" ")&&(_="initial"),typeof t.glyphs[A]<"u"){var S=t.glyphs[A];s=S instanceof Qg?S:S[_]}}else s=t.glyphs[A];return s||(s=t.missingGlyph),s}getText(){return""}getTextFromNode(t){var r=t||this.node,o=Array.from(r.parentNode.childNodes),A=o.indexOf(r),s=o.length-1,d=nu(r.textContent||"");return A===0&&(d=l5(d)),A===s&&(d=c5(d)),d}renderChildren(t){if(this.type!=="text"){this.renderTElementChildren(t);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((o,A)=>{this.renderChild(t,this,this,A)});var{mouse:r}=this.document.screen;r.isWorking()&&r.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){var{document:r,parent:o}=this,A=this.getText(),s=o.getStyle("font-family").getDefinition();if(s){for(var{unitsPerEm:d}=s.fontFace,f=ps.parse(r.ctx.font),I=o.getStyle("font-size").getNumber(f.fontSize),_=o.getStyle("font-style").getString(f.fontStyle),S=I/d,U=s.isRTL?A.split("").reverse().join(""):A,G=Vo(o.getAttribute("dx").getString()),L=U.length,K=0;K<L;K++){var V=this.getGlyph(s,U,K);t.translate(this.x,this.y),t.scale(S,-S);var q=t.lineWidth;t.lineWidth=t.lineWidth*d/I,_==="italic"&&t.transform(1,0,.4,1,0,0),V.render(t),_==="italic"&&t.transform(1,0,-.4,1,0,0),t.lineWidth=q,t.scale(1/S,-1/S),t.translate(-this.x,-this.y),this.x+=I*(V.horizAdvX||s.horizAdvX)/d,typeof G[K]<"u"&&!isNaN(G[K])&&(this.x+=G[K])}return}var{x:z,y:it}=this;t.fillStyle&&t.fillText(A,z,it),t.strokeStyle&&t.strokeText(A,z,it)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var t=this.leafTexts[this.textChunkStart],r=t.getStyle("text-anchor").getString("start"),o=!1,A=0;r==="start"&&!o||r==="end"&&o?A=t.x-this.minX:r==="end"&&!o||r==="start"&&o?A=t.x-this.maxX:A=t.x-(this.minX+this.maxX)/2;for(var s=this.textChunkStart;s<this.leafTexts.length;s++)this.leafTexts[s].x+=A;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(t){this.children.forEach((r,o)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,o)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,r,o,A){var s=o.children[A];s.children.length>0?s.children.forEach((d,f)=>{r.adjustChildCoordinatesRecursiveCore(t,r,s,f)}):this.adjustChildCoordinates(t,r,o,A)}adjustChildCoordinates(t,r,o,A){var s=o.children[A];if(typeof s.measureText!="function")return s;t.save(),s.setContext(t,!0);var d=s.getAttribute("x"),f=s.getAttribute("y"),I=s.getAttribute("dx"),_=s.getAttribute("dy"),S=s.getStyle("font-family").getDefinition(),U=!!S&&S.isRTL;A===0&&(d.hasValue()||d.setValue(s.getInheritedAttribute("x")),f.hasValue()||f.setValue(s.getInheritedAttribute("y")),I.hasValue()||I.setValue(s.getInheritedAttribute("dx")),_.hasValue()||_.setValue(s.getInheritedAttribute("dy")));var G=s.measureText(t);return U&&(r.x-=G),d.hasValue()?(r.applyAnchoring(),s.x=d.getPixels("x"),I.hasValue()&&(s.x+=I.getPixels("x"))):(I.hasValue()&&(r.x+=I.getPixels("x")),s.x=r.x),r.x=s.x,U||(r.x+=G),f.hasValue()?(s.y=f.getPixels("y"),_.hasValue()&&(s.y+=_.getPixels("y"))):(_.hasValue()&&(r.y+=_.getPixels("y")),s.y=r.y),r.y=s.y,r.leafTexts.push(s),r.minX=Math.min(r.minX,s.x,s.x+G),r.maxX=Math.max(r.maxX,s.x,s.x+G),s.clearContext(t),t.restore(),s}getChildBoundingBox(t,r,o,A){var s=o.children[A];if(typeof s.getBoundingBox!="function")return null;var d=s.getBoundingBox(t);return d?(s.children.forEach((f,I)=>{var _=r.getChildBoundingBox(t,r,s,I);d.addBoundingBox(_)}),d):null}renderChild(t,r,o,A){var s=o.children[A];s.render(t),s.children.forEach((d,f)=>{r.renderChild(t,r,s,f)})}measureText(t){var{measureCache:r}=this;if(~r)return r;var o=this.getText(),A=this.measureTargetText(t,o);return this.measureCache=A,A}measureTargetText(t,r){if(!r.length)return 0;var{parent:o}=this,A=o.getStyle("font-family").getDefinition();if(A){for(var s=this.getFontSize(),d=A.isRTL?r.split("").reverse().join(""):r,f=Vo(o.getAttribute("dx").getString()),I=d.length,_=0,S=0;S<I;S++){var U=this.getGlyph(A,d,S);_+=(U.horizAdvX||A.horizAdvX)*s/A.fontFace.unitsPerEm,typeof f[S]<"u"&&!isNaN(f[S])&&(_+=f[S])}return _}if(!t.measureText)return r.length*10;t.save(),this.setContext(t,!0);var{width:G}=t.measureText(r);return this.clearContext(t),t.restore(),G}getInheritedAttribute(t){for(var r=this;r instanceof gA&&r.isFirstChild();){var o=r.parent.getAttribute(t);if(o.hasValue(!0))return o.getValue("0");r=r.parent}return null}},jc=class extends gA{constructor(t,r,o){super(t,r,new.target===jc?!0:o),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}},KI=class extends jc{constructor(){super(...arguments),this.type="textNode"}},gc=class extends XA{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(t){var r,{document:o}=this,{screen:A,window:s}=o,d=t.canvas;if(A.setDefaults(t),d.style&&typeof t.font<"u"&&s&&typeof s.getComputedStyle<"u"){t.font=s.getComputedStyle(d).getPropertyValue("font");var f=new Vi(o,"fontSize",ps.parse(t.font).fontSize);f.hasValue()&&(o.rootEmSize=f.getPixels("y"),o.emSize=o.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:I,height:_}=A.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var S=this.getAttribute("refX"),U=this.getAttribute("refY"),G=this.getAttribute("viewBox"),L=G.hasValue()?Vo(G.getString()):null,K=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",V=0,q=0,z=0,it=0;L&&(V=L[0],q=L[1]),this.root||(I=this.getStyle("width").getPixels("x"),_=this.getStyle("height").getPixels("y"),this.type==="marker"&&(z=V,it=q,V=0,q=0)),A.viewPort.setCurrent(I,_),this.node&&(!this.parent||((r=this.node.parentNode)===null||r===void 0?void 0:r.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),L&&(I=L[2],_=L[3]),o.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:A.viewPort.width,desiredWidth:I,height:A.viewPort.height,desiredHeight:_,minX:V,minY:q,refX:S.getValue(),refY:U.getValue(),clip:K,clipX:z,clipY:it}),L&&(A.viewPort.removeCurrent(),A.viewPort.setCurrent(I,_))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=this.getAttribute("width",!0),s=this.getAttribute("height",!0),d=this.getAttribute("viewBox"),f=this.getAttribute("style"),I=A.getNumber(0),_=s.getNumber(0);if(o)if(typeof o=="string")this.getAttribute("preserveAspectRatio",!0).setValue(o);else{var S=this.getAttribute("preserveAspectRatio");S.hasValue()&&S.setValue(S.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(A.setValue(t),s.setValue(r),d.hasValue()||d.setValue("0 0 ".concat(I||t," ").concat(_||r)),f.hasValue()){var U=this.getStyle("width"),G=this.getStyle("height");U.hasValue()&&U.setValue("".concat(t,"px")),G.hasValue()&&G.setValue("".concat(r,"px"))}}},Rg=class extends Ur{constructor(){super(...arguments),this.type="rect"}path(t){var r=this.getAttribute("x").getPixels("x"),o=this.getAttribute("y").getPixels("y"),A=this.getStyle("width",!1,!0).getPixels("x"),s=this.getStyle("height",!1,!0).getPixels("y"),d=this.getAttribute("rx"),f=this.getAttribute("ry"),I=d.getPixels("x"),_=f.getPixels("y");if(d.hasValue()&&!f.hasValue()&&(_=I),f.hasValue()&&!d.hasValue()&&(I=_),I=Math.min(I,A/2),_=Math.min(_,s/2),t){var S=4*((Math.sqrt(2)-1)/3);t.beginPath(),s>0&&A>0&&(t.moveTo(r+I,o),t.lineTo(r+A-I,o),t.bezierCurveTo(r+A-I+S*I,o,r+A,o+_-S*_,r+A,o+_),t.lineTo(r+A,o+s-_),t.bezierCurveTo(r+A,o+s-_+S*_,r+A-I+S*I,o+s,r+A-I,o+s),t.lineTo(r+I,o+s),t.bezierCurveTo(r+I-S*I,o+s,r,o+s-_+S*_,r,o+s-_),t.lineTo(r,o+_),t.bezierCurveTo(r,o+_-S*_,r+I-S*I,o,r+I,o),t.closePath())}return new Do(r,o,r+A,o+s)}getMarkers(){return null}},Af=class extends Ur{constructor(){super(...arguments),this.type="circle"}path(t){var r=this.getAttribute("cx").getPixels("x"),o=this.getAttribute("cy").getPixels("y"),A=this.getAttribute("r").getPixels();return t&&A>0&&(t.beginPath(),t.arc(r,o,A,0,Math.PI*2,!1),t.closePath()),new Do(r-A,o-A,r+A,o+A)}getMarkers(){return null}},lf=class extends Ur{constructor(){super(...arguments),this.type="ellipse"}path(t){var r=4*((Math.sqrt(2)-1)/3),o=this.getAttribute("rx").getPixels("x"),A=this.getAttribute("ry").getPixels("y"),s=this.getAttribute("cx").getPixels("x"),d=this.getAttribute("cy").getPixels("y");return t&&o>0&&A>0&&(t.beginPath(),t.moveTo(s+o,d),t.bezierCurveTo(s+o,d+r*A,s+r*o,d+A,s,d+A),t.bezierCurveTo(s-r*o,d+A,s-o,d+r*A,s-o,d),t.bezierCurveTo(s-o,d-r*A,s-r*o,d-A,s,d-A),t.bezierCurveTo(s+r*o,d-A,s+o,d-r*A,s+o,d),t.closePath()),new Do(s-o,d-A,s+o,d+A)}getMarkers(){return null}},cf=class extends Ur{constructor(){super(...arguments),this.type="line"}getPoints(){return[new In(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new In(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){var[{x:r,y:o},{x:A,y:s}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(r,o),t.lineTo(A,s)),new Do(r,o,A,s)}getMarkers(){var[t,r]=this.getPoints(),o=t.angleTo(r);return[[t,o],[r,o]]}},Gg=class extends Ur{constructor(t,r,o){super(t,r,o),this.type="polyline",this.points=[],this.points=In.parsePath(this.getAttribute("points").getString())}path(t){var{points:r}=this,[{x:o,y:A}]=r,s=new Do(o,A);return t&&(t.beginPath(),t.moveTo(o,A)),r.forEach(d=>{var{x:f,y:I}=d;s.addPoint(f,I),t&&t.lineTo(f,I)}),s}getMarkers(){var{points:t}=this,r=t.length-1,o=[];return t.forEach((A,s)=>{s!==r&&o.push([A,A.angleTo(t[s+1])])}),o.length>0&&o.push([t[t.length-1],o[o.length-1][1]]),o}},uf=class extends Gg{constructor(){super(...arguments),this.type="polygon"}path(t){var r=super.path(t),[{x:o,y:A}]=this.points;return t&&(t.lineTo(o,A),t.closePath()),r}},hf=class extends qr{constructor(){super(...arguments),this.type="pattern"}createPattern(t,r,o){var A=this.getStyle("width").getPixels("x",!0),s=this.getStyle("height").getPixels("y",!0),d=new gc(this.document,null);d.attributes.viewBox=new Vi(this.document,"viewBox",this.getAttribute("viewBox").getValue()),d.attributes.width=new Vi(this.document,"width","".concat(A,"px")),d.attributes.height=new Vi(this.document,"height","".concat(s,"px")),d.attributes.transform=new Vi(this.document,"transform",this.getAttribute("patternTransform").getValue()),d.children=this.children;var f=this.document.createCanvas(A,s),I=f.getContext("2d"),_=this.getAttribute("x"),S=this.getAttribute("y");_.hasValue()&&S.hasValue()&&I.translate(_.getPixels("x",!0),S.getPixels("y",!0)),o.hasValue()?this.styles["fill-opacity"]=o:Reflect.deleteProperty(this.styles,"fill-opacity");for(var U=-1;U<=1;U++)for(var G=-1;G<=1;G++)I.save(),d.attributes.x=new Vi(this.document,"x",U*f.width),d.attributes.y=new Vi(this.document,"y",G*f.height),d.render(I),I.restore();var L=t.createPattern(f,"repeat");return L}},gf=class extends qr{constructor(){super(...arguments),this.type="marker"}render(t,r,o){if(r){var{x:A,y:s}=r,d=this.getAttribute("orient").getString("auto"),f=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(A,s),d==="auto"&&t.rotate(o),f==="strokeWidth"&&t.scale(t.lineWidth,t.lineWidth),t.save();var I=new gc(this.document,null);I.type=this.type,I.attributes.viewBox=new Vi(this.document,"viewBox",this.getAttribute("viewBox").getValue()),I.attributes.refX=new Vi(this.document,"refX",this.getAttribute("refX").getValue()),I.attributes.refY=new Vi(this.document,"refY",this.getAttribute("refY").getValue()),I.attributes.width=new Vi(this.document,"width",this.getAttribute("markerWidth").getValue()),I.attributes.height=new Vi(this.document,"height",this.getAttribute("markerHeight").getValue()),I.attributes.overflow=new Vi(this.document,"overflow",this.getAttribute("overflow").getValue()),I.attributes.fill=new Vi(this.document,"fill",this.getAttribute("fill").getColor("black")),I.attributes.stroke=new Vi(this.document,"stroke",this.getAttribute("stroke").getValue("none")),I.children=this.children,I.render(t),t.restore(),f==="strokeWidth"&&t.scale(1/t.lineWidth,1/t.lineWidth),d==="auto"&&t.rotate(-o),t.translate(-A,-s)}}},df=class extends qr{constructor(){super(...arguments),this.type="defs"}render(){}},ah=class extends XA{constructor(){super(...arguments),this.type="g"}getBoundingBox(t){var r=new Do;return this.children.forEach(o=>{r.addBoundingBox(o.getBoundingBox(t))}),r}},Zg=class extends qr{constructor(t,r,o){super(t,r,o),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:A,children:s}=this;s.forEach(d=>{d.type==="stop"&&A.push(d)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,r,o){var A=this;this.getHrefAttribute().hasValue()&&(A=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(A));var{stops:s}=A,d=this.getGradient(t,r);if(!d)return this.addParentOpacity(o,s[s.length-1].color);if(s.forEach(q=>{d.addColorStop(q.offset,this.addParentOpacity(o,q.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:f}=this,{MAX_VIRTUAL_PIXELS:I,viewPort:_}=f.screen,[S]=_.viewPorts,U=new Rg(f,null);U.attributes.x=new Vi(f,"x",-I/3),U.attributes.y=new Vi(f,"y",-I/3),U.attributes.width=new Vi(f,"width",I),U.attributes.height=new Vi(f,"height",I);var G=new ah(f,null);G.attributes.transform=new Vi(f,"transform",this.getAttribute("gradientTransform").getValue()),G.children=[U];var L=new gc(f,null);L.attributes.x=new Vi(f,"x",0),L.attributes.y=new Vi(f,"y",0),L.attributes.width=new Vi(f,"width",S.width),L.attributes.height=new Vi(f,"height",S.height),L.children=[G];var K=f.createCanvas(S.width,S.height),V=K.getContext("2d");return V.fillStyle=d,L.render(V),V.createPattern(K,"no-repeat")}return d}inheritStopContainer(t){this.attributesToInherit.forEach(r=>{!this.getAttribute(r).hasValue()&&t.getAttribute(r).hasValue()&&this.getAttribute(r,!0).setValue(t.getAttribute(r).getValue())})}addParentOpacity(t,r){if(t.hasValue()){var o=new Vi(this.document,"color",r);return o.addOpacity(t).getColor()}return r}},pf=class extends Zg{constructor(t,r,o){super(t,r,o),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(t,r){var o=this.getGradientUnits()==="objectBoundingBox",A=o?r.getBoundingBox(t):null;if(o&&!A)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var s=o?A.x+A.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),d=o?A.y+A.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),f=o?A.x+A.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),I=o?A.y+A.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return s===f&&d===I?null:t.createLinearGradient(s,d,f,I)}},ff=class extends Zg{constructor(t,r,o){super(t,r,o),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(t,r){var o=this.getGradientUnits()==="objectBoundingBox",A=r.getBoundingBox(t);if(o&&!A)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var s=o?A.x+A.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),d=o?A.y+A.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),f=s,I=d;this.getAttribute("fx").hasValue()&&(f=o?A.x+A.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(I=o?A.y+A.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var _=o?(A.width+A.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),S=this.getAttribute("fr").getPixels();return t.createRadialGradient(f,I,S,s,d,_)}},mf=class extends qr{constructor(t,r,o){super(t,r,o),this.type="stop";var A=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),s=this.getStyle("stop-opacity"),d=this.getStyle("stop-color",!0);d.getString()===""&&d.setValue("#000"),s.hasValue()&&(d=d.addOpacity(s)),this.offset=A,this.color=d.getColor()}},Ah=class extends qr{constructor(t,r,o){super(t,r,o),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Vi(t,"values",null);var A=this.getAttribute("values");A.hasValue()&&this.values.setValue(A.getString().split(";"))}getProperty(){var t=this.getAttribute("attributeType").getString(),r=this.getAttribute("attributeName").getString();return t==="CSS"?this.parent.getStyle(r,!0):this.parent.getAttribute(r,!0)}calcValue(){var{initialUnits:t}=this,{progress:r,from:o,to:A}=this.getProgress(),s=o.getNumber()+(A.getNumber()-o.getNumber())*r;return t==="%"&&(s*=100),"".concat(s).concat(t)}update(t){var{parent:r}=this,o=this.getProperty();if(this.initialValue||(this.initialValue=o.getString(),this.initialUnits=o.getUnits()),this.duration>this.maxDuration){var A=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(A==="freeze"&&!this.frozen)this.frozen=!0,r.animationFrozen=!0,r.animationFrozenValue=o.getString();else if(A==="remove"&&!this.removed)return this.removed=!0,o.setValue(r.animationFrozen?r.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=t;var s=!1;if(this.begin<this.duration){var d=this.calcValue(),f=this.getAttribute("type");if(f.hasValue()){var I=f.getString();d="".concat(I,"(").concat(d,")")}o.setValue(d),s=!0}return s}getProgress(){var{document:t,values:r}=this,o={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(r.hasValue()){var A=o.progress*(r.getValue().length-1),s=Math.floor(A),d=Math.ceil(A);o.from=new Vi(t,"from",parseFloat(r.getValue()[s])),o.to=new Vi(t,"to",parseFloat(r.getValue()[d])),o.progress=(A-s)/(d-s)}else o.from=this.from,o.to=this.to;return o}},Cf=class extends Ah{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:t,from:r,to:o}=this.getProgress(),A=new TI(r.getColor()),s=new TI(o.getColor());if(A.ok&&s.ok){var d=A.r+(s.r-A.r)*t,f=A.g+(s.g-A.g)*t,I=A.b+(s.b-A.b)*t;return"rgb(".concat(Math.floor(d),", ").concat(Math.floor(f),", ").concat(Math.floor(I),")")}return this.getAttribute("from").getColor()}},If=class extends Ah{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:t,from:r,to:o}=this.getProgress(),A=Vo(r.getString()),s=Vo(o.getString()),d=A.map((f,I)=>{var _=s[I];return f+(_-f)*t}).join(" ");return d}},yf=class extends qr{constructor(t,r,o){super(t,r,o),this.type="font",this.glyphs={},this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:A}=t,{children:s}=this;for(var d of s)switch(d.type){case"font-face":{this.fontFace=d;var f=d.getStyle("font-family");f.hasValue()&&(A[f.getString()]=this);break}case"missing-glyph":this.missingGlyph=d;break;case"glyph":{var I=d;I.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[I.unicode]>"u"&&(this.glyphs[I.unicode]={}),this.glyphs[I.unicode][I.arabicForm]=I):this.glyphs[I.unicode]=I;break}}}render(){}},bf=class extends qr{constructor(t,r,o){super(t,r,o),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}},vf=class extends Ur{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}},wf=class extends gA{constructor(){super(...arguments),this.type="tref"}getText(){var t=this.getHrefAttribute().getDefinition();if(t){var r=t.children[0];if(r)return r.getText()}return""}},Bf=class extends gA{constructor(t,r,o){super(t,r,o),this.type="a";var{childNodes:A}=r,s=A[0],d=A.length>0&&Array.from(A).every(f=>f.nodeType===3);this.hasText=d,this.text=d?this.getTextFromNode(s):""}getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);var{document:r,x:o,y:A}=this,{mouse:s}=r.screen,d=new Vi(r,"fontSize",ps.parse(r.ctx.font).fontSize);s.isWorking()&&s.checkBoundingBox(this,new Do(o,A-d.getPixels("y"),o+this.measureText(t),A))}else if(this.children.length>0){var f=new ah(this.document,null);f.children=this.children,f.parent=this,f.render(t)}}onClick(){var{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){var t=this.document.ctx;t.canvas.style.cursor="pointer"}};_f=class extends gA{constructor(t,r,o){super(t,r,o),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var A=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(A)}getText(){return this.text}path(t){var{dataArray:r}=this;t&&t.beginPath(),r.forEach(o=>{var{type:A,points:s}=o;switch(A){case sr.LINE_TO:t&&t.lineTo(s[0],s[1]);break;case sr.MOVE_TO:t&&t.moveTo(s[0],s[1]);break;case sr.CURVE_TO:t&&t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case sr.QUAD_TO:t&&t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case sr.ARC:{var[d,f,I,_,S,U,G,L]=s,K=I>_?I:_,V=I>_?1:I/_,q=I>_?_/I:1;t&&(t.translate(d,f),t.rotate(G),t.scale(V,q),t.arc(0,0,K,S,S+U,!!(1-L)),t.scale(1/V,1/q),t.rotate(-G),t.translate(-d,-f));break}case sr.CLOSE_PATH:t&&t.closePath();break}})}renderChildren(t){this.setTextData(t),t.save();var r=this.parent.getStyle("text-decoration").getString(),o=this.getFontSize(),{glyphInfo:A}=this,s=t.fillStyle;r==="underline"&&t.beginPath(),A.forEach((d,f)=>{var{p0:I,p1:_,rotation:S,text:U}=d;t.save(),t.translate(I.x,I.y),t.rotate(S),t.fillStyle&&t.fillText(U,0,0),t.strokeStyle&&t.strokeText(U,0,0),t.restore(),r==="underline"&&(f===0&&t.moveTo(I.x,I.y+o/8),t.lineTo(_.x,_.y+o/5))}),r==="underline"&&(t.lineWidth=o/20,t.strokeStyle=s,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,r,o,A,s,d,f,I,_){var S=d,U=this.measureText(t,I);I===" "&&r==="justify"&&o<A&&(U+=(A-o)/s),_>-1&&(S+=this.getLetterSpacingAt(_));var G=this.textHeight/20,L=this.getEquidistantPointOnPath(S,G,0),K=this.getEquidistantPointOnPath(S+U,G,0),V={p0:L,p1:K},q=L&&K?Math.atan2(K.y-L.y,K.x-L.x):0;if(f){var z=Math.cos(Math.PI/2+q)*f,it=Math.cos(-q)*f;V.p0=Zp(Zp({},L),{},{x:L.x+z,y:L.y+it}),V.p1=Zp(Zp({},K),{},{x:K.x+z,y:K.y+it})}return S+=U,{offset:S,segment:V,rotation:q}}measureText(t,r){var{measuresCache:o}=this,A=r||this.getText();if(o.has(A))return o.get(A);var s=this.measureTargetText(t,A);return o.set(A,s),s}setTextData(t){if(!this.glyphInfo){var r=this.getText(),o=r.split(""),A=r.split(" ").length-1,s=this.parent.getAttribute("dx").split().map(_t=>_t.getPixels("x")),d=this.parent.getAttribute("dy").getPixels("y"),f=this.parent.getStyle("text-anchor").getString("start"),I=this.getStyle("letter-spacing"),_=this.parent.getStyle("letter-spacing"),S=0;!I.hasValue()||I.getValue()==="inherit"?S=_.getPixels():I.hasValue()&&I.getValue()!=="initial"&&I.getValue()!=="unset"&&(S=I.getPixels());var U=[],G=r.length;this.letterSpacingCache=U;for(var L=0;L<G;L++)U.push(typeof s[L]<"u"?s[L]:S);var K=U.reduce((_t,Lt,Et)=>Et===0?0:_t+Lt||0,0),V=this.measureText(t),q=Math.max(V+K,0);this.textWidth=V,this.textHeight=this.getFontSize(),this.glyphInfo=[];var z=this.getPathLength(),it=this.getStyle("startOffset").getNumber(0)*z,At=0;(f==="middle"||f==="center")&&(At=-q/2),(f==="end"||f==="right")&&(At=-q),At+=it,o.forEach((_t,Lt)=>{var{offset:Et,segment:xt,rotation:It}=this.findSegmentToFitChar(t,f,q,z,A,At,d,_t,Lt);At=Et,!(!xt.p0||!xt.p1)&&this.glyphInfo.push({text:o[Lt],p0:xt.p0,p1:xt.p1,rotation:It})})}}parsePathData(t){if(this.pathLength=-1,!t)return[];var r=[],{pathParser:o}=t;for(o.reset();!o.isEnd();){var{current:A}=o,s=A?A.x:0,d=A?A.y:0,f=o.next(),I=f.type,_=[];switch(f.type){case sr.MOVE_TO:this.pathM(o,_);break;case sr.LINE_TO:I=this.pathL(o,_);break;case sr.HORIZ_LINE_TO:I=this.pathH(o,_);break;case sr.VERT_LINE_TO:I=this.pathV(o,_);break;case sr.CURVE_TO:this.pathC(o,_);break;case sr.SMOOTH_CURVE_TO:I=this.pathS(o,_);break;case sr.QUAD_TO:this.pathQ(o,_);break;case sr.SMOOTH_QUAD_TO:I=this.pathT(o,_);break;case sr.ARC:_=this.pathA(o);break;case sr.CLOSE_PATH:Ur.pathZ(o);break}f.type!==sr.CLOSE_PATH?r.push({type:I,points:_,start:{x:s,y:d},pathLength:this.calcLength(s,d,I,_)}):r.push({type:sr.CLOSE_PATH,points:[],pathLength:0})}return r}pathM(t,r){var{x:o,y:A}=Ur.pathM(t).point;r.push(o,A)}pathL(t,r){var{x:o,y:A}=Ur.pathL(t).point;return r.push(o,A),sr.LINE_TO}pathH(t,r){var{x:o,y:A}=Ur.pathH(t).point;return r.push(o,A),sr.LINE_TO}pathV(t,r){var{x:o,y:A}=Ur.pathV(t).point;return r.push(o,A),sr.LINE_TO}pathC(t,r){var{point:o,controlPoint:A,currentPoint:s}=Ur.pathC(t);r.push(o.x,o.y,A.x,A.y,s.x,s.y)}pathS(t,r){var{point:o,controlPoint:A,currentPoint:s}=Ur.pathS(t);return r.push(o.x,o.y,A.x,A.y,s.x,s.y),sr.CURVE_TO}pathQ(t,r){var{controlPoint:o,currentPoint:A}=Ur.pathQ(t);r.push(o.x,o.y,A.x,A.y)}pathT(t,r){var{controlPoint:o,currentPoint:A}=Ur.pathT(t);return r.push(o.x,o.y,A.x,A.y),sr.QUAD_TO}pathA(t){var{rX:r,rY:o,sweepFlag:A,xAxisRotation:s,centp:d,a1:f,ad:I}=Ur.pathA(t);return A===0&&I>0&&(I-=2*Math.PI),A===1&&I<0&&(I+=2*Math.PI),[d.x,d.y,r,o,f,I,s,A]}calcLength(t,r,o,A){var s=0,d=null,f=null,I=0;switch(o){case sr.LINE_TO:return this.getLineLength(t,r,A[0],A[1]);case sr.CURVE_TO:for(s=0,d=this.getPointOnCubicBezier(0,t,r,A[0],A[1],A[2],A[3],A[4],A[5]),I=.01;I<=1;I+=.01)f=this.getPointOnCubicBezier(I,t,r,A[0],A[1],A[2],A[3],A[4],A[5]),s+=this.getLineLength(d.x,d.y,f.x,f.y),d=f;return s;case sr.QUAD_TO:for(s=0,d=this.getPointOnQuadraticBezier(0,t,r,A[0],A[1],A[2],A[3]),I=.01;I<=1;I+=.01)f=this.getPointOnQuadraticBezier(I,t,r,A[0],A[1],A[2],A[3]),s+=this.getLineLength(d.x,d.y,f.x,f.y),d=f;return s;case sr.ARC:{s=0;var _=A[4],S=A[5],U=A[4]+S,G=Math.PI/180;if(Math.abs(_-U)<G&&(G=Math.abs(_-U)),d=this.getPointOnEllipticalArc(A[0],A[1],A[2],A[3],_,0),S<0)for(I=_-G;I>U;I-=G)f=this.getPointOnEllipticalArc(A[0],A[1],A[2],A[3],I,0),s+=this.getLineLength(d.x,d.y,f.x,f.y),d=f;else for(I=_+G;I<U;I+=G)f=this.getPointOnEllipticalArc(A[0],A[1],A[2],A[3],I,0),s+=this.getLineLength(d.x,d.y,f.x,f.y),d=f;return f=this.getPointOnEllipticalArc(A[0],A[1],A[2],A[3],U,0),s+=this.getLineLength(d.x,d.y,f.x,f.y),s}}return 0}getPointOnLine(t,r,o,A,s){var d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:r,f=arguments.length>6&&arguments[6]!==void 0?arguments[6]:o,I=(s-o)/(A-r+Jc),_=Math.sqrt(t*t/(1+I*I));A<r&&(_*=-1);var S=I*_,U=null;if(A===r)U={x:d,y:f+S};else if((f-o)/(d-r+Jc)===I)U={x:d+_,y:f+S};else{var G=0,L=0,K=this.getLineLength(r,o,A,s);if(K<Jc)return null;var V=(d-r)*(A-r)+(f-o)*(s-o);V/=K*K,G=r+V*(A-r),L=o+V*(s-o);var q=this.getLineLength(d,f,G,L),z=Math.sqrt(t*t-q*q);_=Math.sqrt(z*z/(1+I*I)),A<r&&(_*=-1),S=I*_,U={x:G+_,y:L+S}}return U}getPointOnPath(t){var r=this.getPathLength(),o=0,A=null;if(t<-5e-5||t-5e-5>r)return null;var{dataArray:s}=this;for(var d of s){if(d&&(d.pathLength<5e-5||o+d.pathLength+5e-5<t)){o+=d.pathLength;continue}var f=t-o,I=0;switch(d.type){case sr.LINE_TO:A=this.getPointOnLine(f,d.start.x,d.start.y,d.points[0],d.points[1],d.start.x,d.start.y);break;case sr.ARC:{var _=d.points[4],S=d.points[5],U=d.points[4]+S;if(I=_+f/d.pathLength*S,S<0&&I<U||S>=0&&I>U)break;A=this.getPointOnEllipticalArc(d.points[0],d.points[1],d.points[2],d.points[3],I,d.points[6]);break}case sr.CURVE_TO:I=f/d.pathLength,I>1&&(I=1),A=this.getPointOnCubicBezier(I,d.start.x,d.start.y,d.points[0],d.points[1],d.points[2],d.points[3],d.points[4],d.points[5]);break;case sr.QUAD_TO:I=f/d.pathLength,I>1&&(I=1),A=this.getPointOnQuadraticBezier(I,d.start.x,d.start.y,d.points[0],d.points[1],d.points[2],d.points[3]);break}if(A)return A;break}return null}getLineLength(t,r,o,A){return Math.sqrt((o-t)*(o-t)+(A-r)*(A-r))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((t,r)=>r.pathLength>0?t+r.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,r,o,A,s,d,f,I,_){var S=I*ZI(t)+d*PI(t)+A*HI(t)+r*MI(t),U=_*ZI(t)+f*PI(t)+s*HI(t)+o*MI(t);return{x:S,y:U}}getPointOnQuadraticBezier(t,r,o,A,s,d,f){var I=d*NI(t)+A*VI(t)+r*DI(t),_=f*NI(t)+s*VI(t)+o*DI(t);return{x:I,y:_}}getPointOnEllipticalArc(t,r,o,A,s,d){var f=Math.cos(d),I=Math.sin(d),_={x:o*Math.cos(s),y:A*Math.sin(s)};return{x:t+(_.x*f-_.y*I),y:r+(_.x*I+_.y*f)}}buildEquidistantCache(t,r){var o=this.getPathLength(),A=r||.25,s=t||o/100;if(!this.equidistantCache||this.equidistantCache.step!==s||this.equidistantCache.precision!==A){this.equidistantCache={step:s,precision:A,points:[]};for(var d=0,f=0;f<=o;f+=A){var I=this.getPointOnPath(f),_=this.getPointOnPath(f+A);!I||!_||(d+=this.getLineLength(I.x,I.y,_.x,_.y),d>=s&&(this.equidistantCache.points.push({x:I.x,y:I.y,distance:f}),d-=s))}}}getEquidistantPointOnPath(t,r,o){if(this.buildEquidistantCache(r,o),t<0||t-this.getPathLength()>5e-5)return null;var A=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[A]||null}},mD=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i,xf=class extends XA{constructor(t,r,o){super(t,r,o),this.type="image",this.loaded=!1;var A=this.getHrefAttribute().getString();if(A){var s=A.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(A);t.images.push(this),s?this.loadSvg(A):this.loadImage(A),this.isSvg=s}}loadImage(t){var r=this;return kl(function*(){try{var o=yield r.document.createImage(t);r.image=o}catch(A){console.error('Error while loading image "'.concat(t,'":'),A)}r.loaded=!0})()}loadSvg(t){var r=this;return kl(function*(){var o=mD.exec(t);if(o){var A=o[5];o[4]==="base64"?r.image=atob(A):r.image=decodeURIComponent(A)}else try{var s=yield r.document.fetch(t),d=yield s.text();r.image=d}catch(f){console.error('Error while loading image "'.concat(t,'":'),f)}r.loaded=!0})()}renderChildren(t){var{document:r,image:o,loaded:A}=this,s=this.getAttribute("x").getPixels("x"),d=this.getAttribute("y").getPixels("y"),f=this.getStyle("width").getPixels("x"),I=this.getStyle("height").getPixels("y");if(!(!A||!o||!f||!I)){if(t.save(),t.translate(s,d),this.isSvg){var _=r.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:f,scaleHeight:I});_.document.documentElement.parent=this,_.render()}else{var S=this.image;r.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:f,desiredWidth:S.width,height:I,desiredHeight:S.height}),this.loaded&&(typeof S.complete>"u"||S.complete)&&t.drawImage(S,0,0)}t.restore()}}getBoundingBox(){var t=this.getAttribute("x").getPixels("x"),r=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),A=this.getStyle("height").getPixels("y");return new Do(t,r,t+o,r+A)}},Sf=class extends XA{constructor(){super(...arguments),this.type="symbol"}render(t){}},Ff=class{constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}load(t,r){var o=this;return kl(function*(){try{var{document:A}=o,s=yield A.canvg.parser.load(r),d=s.getElementsByTagName("font");Array.from(d).forEach(f=>{var I=A.createElement(f);A.definitions[t]=I})}catch(f){console.error('Error while loading font "'.concat(r,'":'),f)}o.loaded=!0})()}},Pg=class extends qr{constructor(t,r,o){super(t,r,o),this.type="style";var A=nu(Array.from(r.childNodes).map(d=>d.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),s=A.split("}");s.forEach(d=>{var f=d.trim();if(f){var I=f.split("{"),_=I[0].split(","),S=I[1].split(";");_.forEach(U=>{var G=U.trim();if(G){var L=t.styles[G]||{};if(S.forEach(q=>{var z=q.indexOf(":"),it=q.substr(0,z).trim(),At=q.substr(z+1,q.length-z).trim();it&&At&&(L[it]=new Vi(t,it,At))}),t.styles[G]=L,t.stylesSpecificity[G]=g5(G),G==="@font-face"){var K=L["font-family"].getString().replace(/"|'/g,""),V=L.src.getString().split(",");V.forEach(q=>{if(q.indexOf('format("svg")')>0){var z=Fy(q);z&&new Ff(t).load(K,z)}})}}})}})}};Pg.parseExternalUrl=Fy;kf=class extends XA{constructor(){super(...arguments),this.type="use"}setContext(t){super.setContext(t);var r=this.getAttribute("x"),o=this.getAttribute("y");r.hasValue()&&t.translate(r.getPixels("x"),0),o.hasValue()&&t.translate(0,o.getPixels("y"))}path(t){var{element:r}=this;r&&r.path(t)}renderChildren(t){var{document:r,element:o}=this;if(o){var A=o;if(o.type==="symbol"&&(A=new gc(r,null),A.attributes.viewBox=new Vi(r,"viewBox",o.getAttribute("viewBox").getString()),A.attributes.preserveAspectRatio=new Vi(r,"preserveAspectRatio",o.getAttribute("preserveAspectRatio").getString()),A.attributes.overflow=new Vi(r,"overflow",o.getAttribute("overflow").getString()),A.children=o.children,o.styles.opacity=new Vi(r,"opacity",this.calculateOpacity())),A.type==="svg"){var s=this.getStyle("width",!1,!0),d=this.getStyle("height",!1,!0);s.hasValue()&&(A.attributes.width=new Vi(r,"width",s.getString())),d.hasValue()&&(A.attributes.height=new Vi(r,"height",d.getString()))}var f=A.parent;A.parent=this,A.render(t),A.parent=f}}getBoundingBox(t){var{element:r}=this;return r?r.getBoundingBox(t):null}elementTransform(){var{document:t,element:r}=this;return JA.fromElement(t,r)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}};Hg=class extends qr{constructor(t,r,o){super(t,r,o),this.type="feColorMatrix";var A=Vo(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var s=A[0];A=[.213+.787*s,.715-.715*s,.072-.072*s,0,0,.213-.213*s,.715+.285*s,.072-.072*s,0,0,.213-.213*s,.715-.715*s,.072+.928*s,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var d=A[0]*Math.PI/180;A=[Sl(d,.213,.787,-.213),Sl(d,.715,-.715,-.715),Sl(d,.072,-.072,.928),0,0,Sl(d,.213,-.213,.143),Sl(d,.715,.285,.14),Sl(d,.072,-.072,-.283),0,0,Sl(d,.213,-.213,-.787),Sl(d,.715,-.715,.715),Sl(d,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=A,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(t,r,o,A,s){for(var{includeOpacity:d,matrix:f}=this,I=t.getImageData(0,0,A,s),_=0;_<s;_++)for(var S=0;S<A;S++){var U=Pp(I.data,S,_,A,s,0),G=Pp(I.data,S,_,A,s,1),L=Pp(I.data,S,_,A,s,2),K=Pp(I.data,S,_,A,s,3),V=jn(f,0,U)+jn(f,1,G)+jn(f,2,L)+jn(f,3,K)+jn(f,4,1),q=jn(f,5,U)+jn(f,6,G)+jn(f,7,L)+jn(f,8,K)+jn(f,9,1),z=jn(f,10,U)+jn(f,11,G)+jn(f,12,L)+jn(f,13,K)+jn(f,14,1),it=jn(f,15,U)+jn(f,16,G)+jn(f,17,L)+jn(f,18,K)+jn(f,19,1);d&&(V=0,q=0,z=0,it*=K/255),Hp(I.data,S,_,A,s,0,V),Hp(I.data,S,_,A,s,1,q),Hp(I.data,S,_,A,s,2,z),Hp(I.data,S,_,A,s,3,it)}t.clearRect(0,0,A,s),t.putImageData(I,0,0)}},qc=class extends qr{constructor(){super(...arguments),this.type="mask"}apply(t,r){var{document:o}=this,A=this.getAttribute("x").getPixels("x"),s=this.getAttribute("y").getPixels("y"),d=this.getStyle("width").getPixels("x"),f=this.getStyle("height").getPixels("y");if(!d&&!f){var I=new Do;this.children.forEach(K=>{I.addBoundingBox(K.getBoundingBox(t))}),A=Math.floor(I.x1),s=Math.floor(I.y1),d=Math.floor(I.width),f=Math.floor(I.height)}var _=this.removeStyles(r,qc.ignoreStyles),S=o.createCanvas(A+d,s+f),U=S.getContext("2d");o.screen.setDefaults(U),this.renderChildren(U),new Hg(o,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(U,0,0,A+d,s+f);var G=o.createCanvas(A+d,s+f),L=G.getContext("2d");o.screen.setDefaults(L),r.render(L),L.globalCompositeOperation="destination-in",L.fillStyle=U.createPattern(S,"no-repeat"),L.fillRect(0,0,A+d,s+f),t.fillStyle=L.createPattern(G,"no-repeat"),t.fillRect(0,0,A+d,s+f),this.restoreStyles(r,_)}render(t){}};qc.ignoreStyles=["mask","transform","clip-path"];x_=()=>{},Lf=class extends qr{constructor(){super(...arguments),this.type="clipPath"}apply(t){var{document:r}=this,o=Reflect.getPrototypeOf(t),{beginPath:A,closePath:s}=t;o&&(o.beginPath=x_,o.closePath=x_),Reflect.apply(A,t,[]),this.children.forEach(d=>{if(!(typeof d.path>"u")){var f=typeof d.elementTransform<"u"?d.elementTransform():null;f||(f=JA.fromElement(r,d)),f&&f.apply(t),d.path(t),o&&(o.closePath=s),f&&f.unapply(t)}}),Reflect.apply(s,t,[]),t.clip(),o&&(o.beginPath=A,o.closePath=s)}render(t){}},$c=class extends qr{constructor(){super(...arguments),this.type="filter"}apply(t,r){var{document:o,children:A}=this,s=r.getBoundingBox(t);if(s){var d=0,f=0;A.forEach(z=>{var it=z.extraFilterDistance||0;d=Math.max(d,it),f=Math.max(f,it)});var I=Math.floor(s.width),_=Math.floor(s.height),S=I+2*d,U=_+2*f;if(!(S<1||U<1)){var G=Math.floor(s.x),L=Math.floor(s.y),K=this.removeStyles(r,$c.ignoreStyles),V=o.createCanvas(S,U),q=V.getContext("2d");o.screen.setDefaults(q),q.translate(-G+d,-L+f),r.render(q),A.forEach(z=>{typeof z.apply=="function"&&z.apply(q,0,0,S,U)}),t.drawImage(V,0,0,S,U,G-d,L-f,S,U),this.restoreStyles(r,K)}}}render(t){}};$c.ignoreStyles=["filter","transform","clip-path"];Ef=class extends qr{constructor(t,r,o){super(t,r,o),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(t,r,o,A,s){}},Tf=class extends qr{constructor(){super(...arguments),this.type="feMorphology"}apply(t,r,o,A,s){}},Uf=class extends qr{constructor(){super(...arguments),this.type="feComposite"}apply(t,r,o,A,s){}},Qf=class extends qr{constructor(t,r,o){super(t,r,o),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(t,r,o,A,s){var{document:d,blurRadius:f}=this,I=d.window?d.window.document.body:null,_=t.canvas;_.id=d.getUniqueId(),I&&(_.style.display="none",I.appendChild(_)),Y6(_,r,o,A,s,f),I&&I.removeChild(_)}},Rf=class extends qr{constructor(){super(...arguments),this.type="title"}},Gf=class extends qr{constructor(){super(...arguments),this.type="desc"}},CD={svg:gc,rect:Rg,circle:Af,ellipse:lf,line:cf,polyline:Gg,polygon:uf,path:Ur,pattern:hf,marker:gf,defs:df,linearGradient:pf,radialGradient:ff,stop:mf,animate:Ah,animateColor:Cf,animateTransform:If,font:yf,"font-face":bf,"missing-glyph":vf,glyph:Qg,text:gA,tspan:jc,tref:wf,a:Bf,textPath:_f,image:xf,g:ah,symbol:Sf,style:Pg,use:kf,mask:qc,clipPath:Lf,filter:$c,feDropShadow:Ef,feMorphology:Tf,feComposite:Uf,feColorMatrix:Hg,feGaussianBlur:Qf,title:Rf,desc:Gf};hA=class{constructor(t){var{rootEmSize:r=12,emSize:o=12,createCanvas:A=hA.createCanvas,createImage:s=hA.createImage,anonymousCrossOrigin:d}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=t,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=r,this.emSize=o,this.createCanvas=A,this.createImage=this.bindCreateImage(s,d),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(t,r){return typeof r=="boolean"?(o,A)=>t(o,typeof A=="boolean"?A:r):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:t}=this;return t[t.length-1]}set emSize(t){var{emSizeStack:r}=this;r.push(t)}popEmSize(){var{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){var r=this.createElement(t.documentElement);return r.root=!0,r.addStylesFromStyleDefinition(),this.documentElement=r,r}createElement(t){var r=t.nodeName.replace(/^[^:]+:/,""),o=hA.elementTypes[r];return typeof o<"u"?new o(this,t):new af(this,t)}createTextNode(t){return new KI(this,t)}setViewBox(t){this.screen.setViewBox(ID({document:this},t))}};hA.createCanvas=yD;hA.createImage=bD;hA.elementTypes=CD;uc=class{constructor(t,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new rh(o),this.screen=new Yc(t,o),this.options=o;var A=new hA(this,o),s=A.createDocumentElement(r);this.document=A,this.documentElement=s}static from(t,r){var o=arguments;return kl(function*(){var A=o.length>2&&o[2]!==void 0?o[2]:{},s=new rh(A),d=yield s.parse(r);return new uc(t,d,A)})()}static fromString(t,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},A=new rh(o),s=A.parseFromString(r);return new uc(t,s,o)}fork(t,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return uc.from(t,r,Oc(Oc({},this.options),o))}forkString(t,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return uc.fromString(t,r,Oc(Oc({},this.options),o))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var t=arguments,r=this;return kl(function*(){var o=t.length>0&&t[0]!==void 0?t[0]:{};r.start(Oc({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},o)),yield r.ready(),r.stop()})()}start(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:r,screen:o,options:A}=this;o.start(r,Oc(Oc({enableRedraw:!0},A),t))}stop(){this.screen.stop()}resize(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(t,r,o)}}});function Sr(n){return Sr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sr(n)}function Vy(n,t){t===void 0&&(t={});var r=UD();r.p(n);var o=QD(n,t,2,4);return GD(o,t),RD(o,o.length-4,r.d()),o}function PD(n,t){return kD((ZD(n),n.subarray(2,-4)),t)}function Uy(){qi.console&&typeof qi.console.log=="function"&&qi.console.log.apply(qi.console,arguments)}function Qy(n,t,r){var o=new XMLHttpRequest;o.open("GET",n),o.responseType="blob",o.onload=function(){su(o.response,t,r)},o.onerror=function(){sn.error("could not download file")},o.send()}function b5(n){var t=new XMLHttpRequest;t.open("HEAD",n,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function $f(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(t)}}function O5(n){var t;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(f){return[parseInt(f[1]),parseInt(f[2]),parseInt(f[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(f){return[parseInt(f[1],16),parseInt(f[2],16),parseInt(f[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(f){return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)]}}],o=0;o<r.length;o++){var A=r[o].re,s=r[o].process,d=A.exec(n);d&&(t=s(d),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var f=this.r.toString(16),I=this.g.toString(16),_=this.b.toString(16);return f.length==1&&(f="0"+f),I.length==1&&(I="0"+I),_.length==1&&(_="0"+_),"#"+f+I+_}}function Ry(n,t){var r=n[0],o=n[1],A=n[2],s=n[3];r=qs(r,o,A,s,t[0],7,-680876936),s=qs(s,r,o,A,t[1],12,-389564586),A=qs(A,s,r,o,t[2],17,606105819),o=qs(o,A,s,r,t[3],22,-1044525330),r=qs(r,o,A,s,t[4],7,-176418897),s=qs(s,r,o,A,t[5],12,1200080426),A=qs(A,s,r,o,t[6],17,-1473231341),o=qs(o,A,s,r,t[7],22,-45705983),r=qs(r,o,A,s,t[8],7,1770035416),s=qs(s,r,o,A,t[9],12,-1958414417),A=qs(A,s,r,o,t[10],17,-42063),o=qs(o,A,s,r,t[11],22,-1990404162),r=qs(r,o,A,s,t[12],7,1804603682),s=qs(s,r,o,A,t[13],12,-40341101),A=qs(A,s,r,o,t[14],17,-1502002290),r=$s(r,o=qs(o,A,s,r,t[15],22,1236535329),A,s,t[1],5,-165796510),s=$s(s,r,o,A,t[6],9,-1069501632),A=$s(A,s,r,o,t[11],14,643717713),o=$s(o,A,s,r,t[0],20,-373897302),r=$s(r,o,A,s,t[5],5,-701558691),s=$s(s,r,o,A,t[10],9,38016083),A=$s(A,s,r,o,t[15],14,-660478335),o=$s(o,A,s,r,t[4],20,-405537848),r=$s(r,o,A,s,t[9],5,568446438),s=$s(s,r,o,A,t[14],9,-1019803690),A=$s(A,s,r,o,t[3],14,-187363961),o=$s(o,A,s,r,t[8],20,1163531501),r=$s(r,o,A,s,t[13],5,-1444681467),s=$s(s,r,o,A,t[2],9,-51403784),A=$s(A,s,r,o,t[7],14,1735328473),r=to(r,o=$s(o,A,s,r,t[12],20,-1926607734),A,s,t[5],4,-378558),s=to(s,r,o,A,t[8],11,-2022574463),A=to(A,s,r,o,t[11],16,1839030562),o=to(o,A,s,r,t[14],23,-35309556),r=to(r,o,A,s,t[1],4,-1530992060),s=to(s,r,o,A,t[4],11,1272893353),A=to(A,s,r,o,t[7],16,-155497632),o=to(o,A,s,r,t[10],23,-1094730640),r=to(r,o,A,s,t[13],4,681279174),s=to(s,r,o,A,t[0],11,-358537222),A=to(A,s,r,o,t[3],16,-722521979),o=to(o,A,s,r,t[6],23,76029189),r=to(r,o,A,s,t[9],4,-640364487),s=to(s,r,o,A,t[12],11,-421815835),A=to(A,s,r,o,t[15],16,530742520),r=eo(r,o=to(o,A,s,r,t[2],23,-995338651),A,s,t[0],6,-198630844),s=eo(s,r,o,A,t[7],10,1126891415),A=eo(A,s,r,o,t[14],15,-1416354905),o=eo(o,A,s,r,t[5],21,-57434055),r=eo(r,o,A,s,t[12],6,1700485571),s=eo(s,r,o,A,t[3],10,-1894986606),A=eo(A,s,r,o,t[10],15,-1051523),o=eo(o,A,s,r,t[1],21,-2054922799),r=eo(r,o,A,s,t[8],6,1873313359),s=eo(s,r,o,A,t[15],10,-30611744),A=eo(A,s,r,o,t[6],15,-1560198380),o=eo(o,A,s,r,t[13],21,1309151649),r=eo(r,o,A,s,t[4],6,-145523070),s=eo(s,r,o,A,t[11],10,-1120210379),A=eo(A,s,r,o,t[2],15,718787259),o=eo(o,A,s,r,t[9],21,-343485551),n[0]=fc(r,n[0]),n[1]=fc(o,n[1]),n[2]=fc(A,n[2]),n[3]=fc(s,n[3])}function dm(n,t,r,o,A,s){return t=fc(fc(t,n),fc(o,s)),fc(t<<A|t>>>32-A,r)}function qs(n,t,r,o,A,s,d){return dm(t&r|~t&o,n,t,A,s,d)}function $s(n,t,r,o,A,s,d){return dm(t&o|r&~o,n,t,A,s,d)}function to(n,t,r,o,A,s,d){return dm(t^r^o,n,t,A,s,d)}function eo(n,t,r,o,A,s,d){return dm(r^(t|~o),n,t,A,s,d)}function W5(n){var t,r=n.length,o=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=n.length;t+=64)Ry(o,HD(n.substring(t-64,t)));n=n.substring(t-64);var A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<n.length;t++)A[t>>2]|=n.charCodeAt(t)<<(t%4<<3);if(A[t>>2]|=128<<(t%4<<3),t>55)for(Ry(o,A),t=0;t<16;t++)A[t]=0;return A[14]=8*r,Ry(o,A),o}function HD(n){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=n.charCodeAt(t)+(n.charCodeAt(t+1)<<8)+(n.charCodeAt(t+2)<<16)+(n.charCodeAt(t+3)<<24);return r}function MD(n){for(var t="",r=0;r<4;r++)t+=v5[n>>8*r+4&15]+v5[n>>8*r&15];return t}function ND(n){return String.fromCharCode((255&n)>>0,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function Ky(n){return W5(n).map(ND).join("")}function fc(n,t){if(VD){var r=(65535&n)+(65535&t);return(n>>16)+(t>>16)+(r>>16)<<16|65535&r}return n+t&4294967295}function zy(n,t){var r,o,A,s;if(n!==r){for(var d=(A=n,s=1+(256/n.length>>0),new Array(s+1).join(A)),f=[],I=0;I<256;I++)f[I]=I;var _=0;for(I=0;I<256;I++){var S=f[I];_=(_+S+d.charCodeAt(I))%256,f[I]=f[_],f[_]=S}r=n,o=f}else f=o;var U=t.length,G=0,L=0,K="";for(I=0;I<U;I++)L=(L+(S=f[G=(G+1)%256]))%256,f[G]=f[L],f[L]=S,d=f[(f[G]+f[L])%256],K+=String.fromCharCode(t.charCodeAt(I)^d);return K}function dh(n,t,r,o){this.v=1,this.r=2;var A=192;n.forEach(function(f){if(w5.perm!==void 0)throw new Error("Invalid permission: "+f);A+=w5[f]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var s=(t+this.padding).substr(0,32),d=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,d),this.P=-(1+(255^A)),this.encryptionKey=Ky(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(o)).substr(0,5),this.U=zy(this.encryptionKey,this.padding)}function ph(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var t="",r=n.length,o=0;o<r;o++){var A=n.charCodeAt(o);A<33||A===35||A===37||A===40||A===41||A===47||A===60||A===62||A===91||A===93||A===123||A===125||A>126?t+="#"+("0"+A.toString(16)).slice(-2):t+=n[o]}return t}function B5(n){if(Sr(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,o,A){if(A=A||!1,typeof r!="string"||typeof o!="function"||typeof A!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[o,!!A],s},this.unsubscribe=function(r){for(var o in t)if(t[o][r])return delete t[o][r],Object.keys(t[o]).length===0&&delete t[o],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var o=Array.prototype.slice.call(arguments,1),A=[];for(var s in t[r]){var d=t[r][s];try{d[0].apply(n,o)}catch(f){qi.console&&sn.error("jsPDF PubSub Error",f.message,f)}d[1]&&A.push(s)}A.length&&A.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function lm(n){if(!(this instanceof lm))return new lm(n);var t="opacity,stroke-opacity".split(",");for(var r in n)n.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=n[r]);this.id="",this.objectNumber=-1}function J5(n,t){this.gState=n,this.matrix=t,this.id="",this.objectNumber=-1}function ou(n,t,r,o,A){if(!(this instanceof ou))return new ou(n,t,r,o,A);this.type=n==="axial"?2:3,this.coords=t,this.colors=r,J5.call(this,o,A)}function fh(n,t,r,o,A){if(!(this instanceof fh))return new fh(n,t,r,o,A);this.boundingBox=n,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,J5.call(this,o,A)}function ji(n){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",o=arguments[1],A=arguments[2],s=arguments[3],d=[],f=1,I=16,_="S",S=null;Sr(n=n||{})==="object"&&(r=n.orientation,o=n.unit||o,A=n.format||A,s=n.compress||n.compressPdf||s,(S=n.encryption||null)!==null&&(S.userPassword=S.userPassword||"",S.ownerPassword=S.ownerPassword||"",S.userPermissions=S.userPermissions||[]),f=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(t=n.precision),n.floatPrecision!==void 0&&(I=n.floatPrecision),_=n.defaultPathOperation||"S"),d=n.filters||(s===!0?["FlateEncode"]:d),o=o||"mm",r=(""+(r||"P")).toLowerCase();var U=n.putOnlyUsedFonts||!1,G={},L={internal:{},__private__:{}};L.__private__.PubSub=B5;var K="1.3",V=L.__private__.getPdfVersion=function(){return K};L.__private__.setPdfVersion=function(Q){K=Q};var q={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};L.__private__.getPageFormats=function(){return q};var z=L.__private__.getPageFormat=function(Q){return q[Q]};A=A||"a4";var it={COMPAT:"compat",ADVANCED:"advanced"},At=it.COMPAT;function _t(){this.saveGraphicsState(),Ut(new Wt(le,0,0,-le,0,Yo()*le).toString()+" cm"),this.setFontSize(this.getFontSize()/le),_="n",At=it.ADVANCED}function Lt(){this.restoreGraphicsState(),_="S",At=it.COMPAT}var Et=L.__private__.combineFontStyleAndFontWeight=function(Q,tt){if(Q=="bold"&&tt=="normal"||Q=="bold"&&tt==400||Q=="normal"&&tt=="italic"||Q=="bold"&&tt=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return tt&&(Q=tt==400||tt==="normal"?Q==="italic"?"italic":"normal":tt!=700&&tt!=="bold"||Q!=="normal"?(tt==700?"bold":tt)+""+Q:"bold"),Q};L.advancedAPI=function(Q){var tt=At===it.COMPAT;return tt&&_t.call(this),typeof Q!="function"||(Q(this),tt&&Lt.call(this)),this},L.compatAPI=function(Q){var tt=At===it.ADVANCED;return tt&&Lt.call(this),typeof Q!="function"||(Q(this),tt&&_t.call(this)),this},L.isAdvancedAPI=function(){return At===it.ADVANCED};var xt,It=function(Q){if(At!==it.ADVANCED)throw new Error(Q+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Nt=L.roundToPrecision=L.__private__.roundToPrecision=function(Q,tt){var kt=t||tt;if(isNaN(Q)||isNaN(kt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return Q.toFixed(kt).replace(/0+$/,"")};xt=L.hpf=L.__private__.hpf=typeof I=="number"?function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.hpf");return Nt(Q,I)}:I==="smart"?function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.hpf");return Nt(Q,Q>-1&&Q<1?16:5)}:function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.hpf");return Nt(Q,16)};var ie=L.f2=L.__private__.f2=function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.f2");return Nt(Q,2)},lt=L.__private__.f3=function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.f3");return Nt(Q,3)},at=L.scale=L.__private__.scale=function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.scale");return At===it.COMPAT?Q*le:At===it.ADVANCED?Q:void 0},St=function(Q){return At===it.COMPAT?Yo()-Q:At===it.ADVANCED?Q:void 0},Bt=function(Q){return at(St(Q))};L.__private__.setPrecision=L.setPrecision=function(Q){typeof parseInt(Q,10)=="number"&&(t=parseInt(Q,10))};var se,ee="00000000000000000000000000000000",qt=L.__private__.getFileId=function(){return ee},Xt=L.__private__.setFileId=function(Q){return ee=Q!==void 0&&/^[a-fA-F0-9]{32}$/.test(Q)?Q.toUpperCase():ee.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),S!==null&&(ci=new dh(S.userPermissions,S.userPassword,S.ownerPassword,ee)),ee};L.setFileId=function(Q){return Xt(Q),this},L.getFileId=function(){return qt()};var vt=L.__private__.convertDateToPDFDate=function(Q){var tt=Q.getTimezoneOffset(),kt=tt<0?"+":"-",zt=Math.floor(Math.abs(tt/60)),oe=Math.abs(tt%60),we=[kt,yt(zt),"'",yt(oe),"'"].join("");return["D:",Q.getFullYear(),yt(Q.getMonth()+1),yt(Q.getDate()),yt(Q.getHours()),yt(Q.getMinutes()),yt(Q.getSeconds()),we].join("")},Tt=L.__private__.convertPDFDateToDate=function(Q){var tt=parseInt(Q.substr(2,4),10),kt=parseInt(Q.substr(6,2),10)-1,zt=parseInt(Q.substr(8,2),10),oe=parseInt(Q.substr(10,2),10),we=parseInt(Q.substr(12,2),10),Me=parseInt(Q.substr(14,2),10);return new Date(tt,kt,zt,oe,we,Me,0)},pe=L.__private__.setCreationDate=function(Q){var tt;if(Q===void 0&&(Q=new Date),Q instanceof Date)tt=vt(Q);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(Q))throw new Error("Invalid argument passed to jsPDF.setCreationDate");tt=Q}return se=tt},j=L.__private__.getCreationDate=function(Q){var tt=se;return Q==="jsDate"&&(tt=Tt(se)),tt};L.setCreationDate=function(Q){return pe(Q),this},L.getCreationDate=function(Q){return j(Q)};var mt,yt=L.__private__.padd2=function(Q){return("0"+parseInt(Q)).slice(-2)},Qt=L.__private__.padd2Hex=function(Q){return("00"+(Q=Q.toString())).substr(Q.length)},Ht=0,ae=[],ge=[],de=0,Ze=[],Re=[],Je=!1,Xe=ge,Kt=function(){Ht=0,de=0,ge=[],ae=[],Ze=[],xi=ti(),zi=ti()};L.__private__.setCustomOutputDestination=function(Q){Je=!0,Xe=Q};var Ce=function(Q){Je||(Xe=Q)};L.__private__.resetCustomOutputDestination=function(){Je=!1,Xe=ge};var Ut=L.__private__.out=function(Q){return Q=Q.toString(),de+=Q.length+1,Xe.push(Q),Xe},Ye=L.__private__.write=function(Q){return Ut(arguments.length===1?Q.toString():Array.prototype.join.call(arguments," "))},Oe=L.__private__.getArrayBuffer=function(Q){for(var tt=Q.length,kt=new ArrayBuffer(tt),zt=new Uint8Array(kt);tt--;)zt[tt]=Q.charCodeAt(tt);return kt},Qe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];L.__private__.getStandardFonts=function(){return Qe};var Ne=n.fontSize||16;L.__private__.setFontSize=L.setFontSize=function(Q){return Ne=At===it.ADVANCED?Q/le:Q,this};var ze,We=L.__private__.getFontSize=L.getFontSize=function(){return At===it.COMPAT?Ne:Ne*le},ri=n.R2L||!1;L.__private__.setR2L=L.setR2L=function(Q){return ri=Q,this},L.__private__.getR2L=L.getR2L=function(){return ri};var hi,Ti=L.__private__.setZoomMode=function(Q){var tt=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(Q))ze=Q;else if(isNaN(Q)){if(tt.indexOf(Q)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+Q+'" is not recognized.');ze=Q}else ze=parseInt(Q,10)};L.__private__.getZoomMode=function(){return ze};var fe,Ni=L.__private__.setPageMode=function(Q){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(Q)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+Q+'" is not recognized.');hi=Q};L.__private__.getPageMode=function(){return hi};var Di=L.__private__.setLayoutMode=function(Q){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(Q)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+Q+'" is not recognized.');fe=Q};L.__private__.getLayoutMode=function(){return fe},L.__private__.setDisplayMode=L.setDisplayMode=function(Q,tt,kt){return Ti(Q),Di(tt),Ni(kt),this};var mi={title:"",subject:"",author:"",keywords:"",creator:""};L.__private__.getDocumentProperty=function(Q){if(Object.keys(mi).indexOf(Q)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return mi[Q]},L.__private__.getDocumentProperties=function(){return mi},L.__private__.setDocumentProperties=L.setProperties=L.setDocumentProperties=function(Q){for(var tt in mi)mi.hasOwnProperty(tt)&&Q[tt]&&(mi[tt]=Q[tt]);return this},L.__private__.setDocumentProperty=function(Q,tt){if(Object.keys(mi).indexOf(Q)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return mi[Q]=tt};var Gi,le,gi,Ke,or,Ki={},ii={},br=[],Ji={},wr={},ar={},wt={},W=null,X=0,rt=[],ft=new B5(L),Mt=n.hotfixes||[],Vt={},Yt={},Rt=[],Wt=function Q(tt,kt,zt,oe,we,Me){if(!(this instanceof Q))return new Q(tt,kt,zt,oe,we,Me);isNaN(tt)&&(tt=1),isNaN(kt)&&(kt=0),isNaN(zt)&&(zt=0),isNaN(oe)&&(oe=1),isNaN(we)&&(we=0),isNaN(Me)&&(Me=0),this._matrix=[tt,kt,zt,oe,we,Me]};Object.defineProperty(Wt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(Q){this._matrix[0]=Q}}),Object.defineProperty(Wt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(Q){this._matrix[1]=Q}}),Object.defineProperty(Wt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(Q){this._matrix[2]=Q}}),Object.defineProperty(Wt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(Q){this._matrix[3]=Q}}),Object.defineProperty(Wt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(Q){this._matrix[4]=Q}}),Object.defineProperty(Wt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(Q){this._matrix[5]=Q}}),Object.defineProperty(Wt.prototype,"a",{get:function(){return this._matrix[0]},set:function(Q){this._matrix[0]=Q}}),Object.defineProperty(Wt.prototype,"b",{get:function(){return this._matrix[1]},set:function(Q){this._matrix[1]=Q}}),Object.defineProperty(Wt.prototype,"c",{get:function(){return this._matrix[2]},set:function(Q){this._matrix[2]=Q}}),Object.defineProperty(Wt.prototype,"d",{get:function(){return this._matrix[3]},set:function(Q){this._matrix[3]=Q}}),Object.defineProperty(Wt.prototype,"e",{get:function(){return this._matrix[4]},set:function(Q){this._matrix[4]=Q}}),Object.defineProperty(Wt.prototype,"f",{get:function(){return this._matrix[5]},set:function(Q){this._matrix[5]=Q}}),Object.defineProperty(Wt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Wt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Wt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Wt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Wt.prototype.join=function(Q){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(xt).join(Q)},Wt.prototype.multiply=function(Q){var tt=Q.sx*this.sx+Q.shy*this.shx,kt=Q.sx*this.shy+Q.shy*this.sy,zt=Q.shx*this.sx+Q.sy*this.shx,oe=Q.shx*this.shy+Q.sy*this.sy,we=Q.tx*this.sx+Q.ty*this.shx+this.tx,Me=Q.tx*this.shy+Q.ty*this.sy+this.ty;return new Wt(tt,kt,zt,oe,we,Me)},Wt.prototype.decompose=function(){var Q=this.sx,tt=this.shy,kt=this.shx,zt=this.sy,oe=this.tx,we=this.ty,Me=Math.sqrt(Q*Q+tt*tt),ui=(Q/=Me)*kt+(tt/=Me)*zt;kt-=Q*ui,zt-=tt*ui;var Mi=Math.sqrt(kt*kt+zt*zt);return ui/=Mi,Q*(zt/=Mi)<tt*(kt/=Mi)&&(Q=-Q,tt=-tt,ui=-ui,Me=-Me),{scale:new Wt(Me,0,0,Mi,0,0),translate:new Wt(1,0,0,1,oe,we),rotate:new Wt(Q,tt,-tt,Q,0,0),skew:new Wt(1,0,ui,1,0,0)}},Wt.prototype.toString=function(Q){return this.join(" ")},Wt.prototype.inversed=function(){var Q=this.sx,tt=this.shy,kt=this.shx,zt=this.sy,oe=this.tx,we=this.ty,Me=1/(Q*zt-tt*kt),ui=zt*Me,Mi=-tt*Me,Xi=-kt*Me,Ii=Q*Me;return new Wt(ui,Mi,Xi,Ii,-ui*oe-Xi*we,-Mi*oe-Ii*we)},Wt.prototype.applyToPoint=function(Q){var tt=Q.x*this.sx+Q.y*this.shx+this.tx,kt=Q.x*this.shy+Q.y*this.sy+this.ty;return new BA(tt,kt)},Wt.prototype.applyToRectangle=function(Q){var tt=this.applyToPoint(Q),kt=this.applyToPoint(new BA(Q.x+Q.w,Q.y+Q.h));return new sl(tt.x,tt.y,kt.x-tt.x,kt.y-tt.y)},Wt.prototype.clone=function(){var Q=this.sx,tt=this.shy,kt=this.shx,zt=this.sy,oe=this.tx,we=this.ty;return new Wt(Q,tt,kt,zt,oe,we)},L.Matrix=Wt;var be=L.matrixMult=function(Q,tt){return tt.multiply(Q)},he=new Wt(1,0,0,1,0,0);L.unitMatrix=L.identityMatrix=he;var Le=function(Q,tt){if(!wr[Q]){var kt=(tt instanceof ou?"Sh":"P")+(Object.keys(Ji).length+1).toString(10);tt.id=kt,wr[Q]=kt,Ji[kt]=tt,ft.publish("addPattern",tt)}};L.ShadingPattern=ou,L.TilingPattern=fh,L.addShadingPattern=function(Q,tt){return It("addShadingPattern()"),Le(Q,tt),this},L.beginTilingPattern=function(Q){It("beginTilingPattern()"),ma(Q.boundingBox[0],Q.boundingBox[1],Q.boundingBox[2]-Q.boundingBox[0],Q.boundingBox[3]-Q.boundingBox[1],Q.matrix)},L.endTilingPattern=function(Q,tt){It("endTilingPattern()"),tt.stream=Re[mt].join(`
`),Le(Q,tt),ft.publish("endTilingPattern",tt),Rt.pop().restore()};var je=L.__private__.newObject=function(){var Q=ti();return _i(Q,!0),Q},ti=L.__private__.newObjectDeferred=function(){return Ht++,ae[Ht]=function(){return de},Ht},_i=function(Q,tt){return tt=typeof tt=="boolean"&&tt,ae[Q]=de,tt&&Ut(Q+" 0 obj"),Q},$i=L.__private__.newAdditionalObject=function(){var Q={objId:ti(),content:""};return Ze.push(Q),Q},xi=ti(),zi=ti(),hr=L.__private__.decodeColorString=function(Q){var tt=Q.split(" ");if(tt.length!==2||tt[1]!=="g"&&tt[1]!=="G")tt.length===5&&(tt[4]==="k"||tt[4]==="K")&&(tt=[(1-tt[0])*(1-tt[3]),(1-tt[1])*(1-tt[3]),(1-tt[2])*(1-tt[3]),"r"]);else{var kt=parseFloat(tt[0]);tt=[kt,kt,kt,"r"]}for(var zt="#",oe=0;oe<3;oe++)zt+=("0"+Math.floor(255*parseFloat(tt[oe])).toString(16)).slice(-2);return zt},fr=L.__private__.encodeColorString=function(Q){var tt;typeof Q=="string"&&(Q={ch1:Q});var kt=Q.ch1,zt=Q.ch2,oe=Q.ch3,we=Q.ch4,Me=Q.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof kt=="string"&&kt.charAt(0)!=="#"){var ui=new O5(kt);if(ui.ok)kt=ui.toHex();else if(!/^\d*\.?\d*$/.test(kt))throw new Error('Invalid color "'+kt+'" passed to jsPDF.encodeColorString.')}if(typeof kt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(kt)&&(kt="#"+kt[1]+kt[1]+kt[2]+kt[2]+kt[3]+kt[3]),typeof kt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(kt)){var Mi=parseInt(kt.substr(1),16);kt=Mi>>16&255,zt=Mi>>8&255,oe=255&Mi}if(zt===void 0||we===void 0&&kt===zt&&zt===oe)if(typeof kt=="string")tt=kt+" "+Me[0];else switch(Q.precision){case 2:tt=ie(kt/255)+" "+Me[0];break;case 3:default:tt=lt(kt/255)+" "+Me[0]}else if(we===void 0||Sr(we)==="object"){if(we&&!isNaN(we.a)&&we.a===0)return tt=["1.","1.","1.",Me[1]].join(" ");if(typeof kt=="string")tt=[kt,zt,oe,Me[1]].join(" ");else switch(Q.precision){case 2:tt=[ie(kt/255),ie(zt/255),ie(oe/255),Me[1]].join(" ");break;default:case 3:tt=[lt(kt/255),lt(zt/255),lt(oe/255),Me[1]].join(" ")}}else if(typeof kt=="string")tt=[kt,zt,oe,we,Me[2]].join(" ");else switch(Q.precision){case 2:tt=[ie(kt),ie(zt),ie(oe),ie(we),Me[2]].join(" ");break;case 3:default:tt=[lt(kt),lt(zt),lt(oe),lt(we),Me[2]].join(" ")}return tt},Hi=L.__private__.getFilters=function(){return d},Wi=L.__private__.putStream=function(Q){var tt=(Q=Q||{}).data||"",kt=Q.filters||Hi(),zt=Q.alreadyAppliedFilters||[],oe=Q.addLength1||!1,we=tt.length,Me=Q.objectId,ui=function(nr){return nr};if(S!==null&&Me===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");S!==null&&(ui=ci.encryptor(Me,0));var Mi={};kt===!0&&(kt=["FlateEncode"]);var Xi=Q.additionalKeyValues||[],Ii=(Mi=ji.API.processDataByFilters!==void 0?ji.API.processDataByFilters(tt,kt):{data:tt,reverseChain:[]}).reverseChain+(Array.isArray(zt)?zt.join(" "):zt.toString());if(Mi.data.length!==0&&(Xi.push({key:"Length",value:Mi.data.length}),oe===!0&&Xi.push({key:"Length1",value:we})),Ii.length!=0)if(Ii.split("/").length-1==1)Xi.push({key:"Filter",value:Ii});else{Xi.push({key:"Filter",value:"["+Ii+"]"});for(var gr=0;gr<Xi.length;gr+=1)if(Xi[gr].key==="DecodeParms"){for(var ki=[],tn=0;tn<Mi.reverseChain.split("/").length-1;tn+=1)ki.push("null");ki.push(Xi[gr].value),Xi[gr].value="["+ki.join(" ")+"]"}}Ut("<<");for(var er=0;er<Xi.length;er++)Ut("/"+Xi[er].key+" "+Xi[er].value);Ut(">>"),Mi.data.length!==0&&(Ut("stream"),Ut(ui(Mi.data)),Ut("endstream"))},Ar=L.__private__.putPage=function(Q){var tt=Q.number,kt=Q.data,zt=Q.objId,oe=Q.contentsObjId;_i(zt,!0),Ut("<</Type /Page"),Ut("/Parent "+Q.rootDictionaryObjId+" 0 R"),Ut("/Resources "+Q.resourceDictionaryObjId+" 0 R"),Ut("/MediaBox ["+parseFloat(xt(Q.mediaBox.bottomLeftX))+" "+parseFloat(xt(Q.mediaBox.bottomLeftY))+" "+xt(Q.mediaBox.topRightX)+" "+xt(Q.mediaBox.topRightY)+"]"),Q.cropBox!==null&&Ut("/CropBox ["+xt(Q.cropBox.bottomLeftX)+" "+xt(Q.cropBox.bottomLeftY)+" "+xt(Q.cropBox.topRightX)+" "+xt(Q.cropBox.topRightY)+"]"),Q.bleedBox!==null&&Ut("/BleedBox ["+xt(Q.bleedBox.bottomLeftX)+" "+xt(Q.bleedBox.bottomLeftY)+" "+xt(Q.bleedBox.topRightX)+" "+xt(Q.bleedBox.topRightY)+"]"),Q.trimBox!==null&&Ut("/TrimBox ["+xt(Q.trimBox.bottomLeftX)+" "+xt(Q.trimBox.bottomLeftY)+" "+xt(Q.trimBox.topRightX)+" "+xt(Q.trimBox.topRightY)+"]"),Q.artBox!==null&&Ut("/ArtBox ["+xt(Q.artBox.bottomLeftX)+" "+xt(Q.artBox.bottomLeftY)+" "+xt(Q.artBox.topRightX)+" "+xt(Q.artBox.topRightY)+"]"),typeof Q.userUnit=="number"&&Q.userUnit!==1&&Ut("/UserUnit "+Q.userUnit),ft.publish("putPage",{objId:zt,pageContext:rt[tt],pageNumber:tt,page:kt}),Ut("/Contents "+oe+" 0 R"),Ut(">>"),Ut("endobj");var we=kt.join(`
`);return At===it.ADVANCED&&(we+=`
Q`),_i(oe,!0),Wi({data:we,filters:Hi(),objectId:oe}),Ut("endobj"),zt},Zt=L.__private__.putPages=function(){var Q,tt,kt=[];for(Q=1;Q<=X;Q++)rt[Q].objId=ti(),rt[Q].contentsObjId=ti();for(Q=1;Q<=X;Q++)kt.push(Ar({number:Q,data:Re[Q],objId:rt[Q].objId,contentsObjId:rt[Q].contentsObjId,mediaBox:rt[Q].mediaBox,cropBox:rt[Q].cropBox,bleedBox:rt[Q].bleedBox,trimBox:rt[Q].trimBox,artBox:rt[Q].artBox,userUnit:rt[Q].userUnit,rootDictionaryObjId:xi,resourceDictionaryObjId:zi}));_i(xi,!0),Ut("<</Type /Pages");var zt="/Kids [";for(tt=0;tt<X;tt++)zt+=kt[tt]+" 0 R ";Ut(zt+"]"),Ut("/Count "+X),Ut(">>"),Ut("endobj"),ft.publish("postPutPages")},De=function(Q){ft.publish("putFont",{font:Q,out:Ut,newObject:je,putStream:Wi}),Q.isAlreadyPutted!==!0&&(Q.objectNumber=je(),Ut("<<"),Ut("/Type /Font"),Ut("/BaseFont /"+ph(Q.postScriptName)),Ut("/Subtype /Type1"),typeof Q.encoding=="string"&&Ut("/Encoding /"+Q.encoding),Ut("/FirstChar 32"),Ut("/LastChar 255"),Ut(">>"),Ut("endobj"))},Te=function(){for(var Q in Ki)Ki.hasOwnProperty(Q)&&(U===!1||U===!0&&G.hasOwnProperty(Q))&&De(Ki[Q])},tr=function(Q){Q.objectNumber=je();var tt=[];tt.push({key:"Type",value:"/XObject"}),tt.push({key:"Subtype",value:"/Form"}),tt.push({key:"BBox",value:"["+[xt(Q.x),xt(Q.y),xt(Q.x+Q.width),xt(Q.y+Q.height)].join(" ")+"]"}),tt.push({key:"Matrix",value:"["+Q.matrix.toString()+"]"});var kt=Q.pages[1].join(`
`);Wi({data:kt,additionalKeyValues:tt,objectId:Q.objectNumber}),Ut("endobj")},Ui=function(){for(var Q in Vt)Vt.hasOwnProperty(Q)&&tr(Vt[Q])},an=function(Q,tt){var kt,zt=[],oe=1/(tt-1);for(kt=0;kt<1;kt+=oe)zt.push(kt);if(zt.push(1),Q[0].offset!=0){var we={offset:0,color:Q[0].color};Q.unshift(we)}if(Q[Q.length-1].offset!=1){var Me={offset:1,color:Q[Q.length-1].color};Q.push(Me)}for(var ui="",Mi=0,Xi=0;Xi<zt.length;Xi++){for(kt=zt[Xi];kt>Q[Mi+1].offset;)Mi++;var Ii=Q[Mi].offset,gr=(kt-Ii)/(Q[Mi+1].offset-Ii),ki=Q[Mi].color,tn=Q[Mi+1].color;ui+=Qt(Math.round((1-gr)*ki[0]+gr*tn[0]).toString(16))+Qt(Math.round((1-gr)*ki[1]+gr*tn[1]).toString(16))+Qt(Math.round((1-gr)*ki[2]+gr*tn[2]).toString(16))}return ui.trim()},Fr=function(Q,tt){tt||(tt=21);var kt=je(),zt=an(Q.colors,tt),oe=[];oe.push({key:"FunctionType",value:"0"}),oe.push({key:"Domain",value:"[0.0 1.0]"}),oe.push({key:"Size",value:"["+tt+"]"}),oe.push({key:"BitsPerSample",value:"8"}),oe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),oe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Wi({data:zt,additionalKeyValues:oe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:kt}),Ut("endobj"),Q.objectNumber=je(),Ut("<< /ShadingType "+Q.type),Ut("/ColorSpace /DeviceRGB");var we="/Coords ["+xt(parseFloat(Q.coords[0]))+" "+xt(parseFloat(Q.coords[1]))+" ";Q.type===2?we+=xt(parseFloat(Q.coords[2]))+" "+xt(parseFloat(Q.coords[3])):we+=xt(parseFloat(Q.coords[2]))+" "+xt(parseFloat(Q.coords[3]))+" "+xt(parseFloat(Q.coords[4]))+" "+xt(parseFloat(Q.coords[5])),Ut(we+="]"),Q.matrix&&Ut("/Matrix ["+Q.matrix.toString()+"]"),Ut("/Function "+kt+" 0 R"),Ut("/Extend [true true]"),Ut(">>"),Ut("endobj")},$r=function(Q,tt){var kt=ti(),zt=je();tt.push({resourcesOid:kt,objectOid:zt}),Q.objectNumber=zt;var oe=[];oe.push({key:"Type",value:"/Pattern"}),oe.push({key:"PatternType",value:"1"}),oe.push({key:"PaintType",value:"1"}),oe.push({key:"TilingType",value:"1"}),oe.push({key:"BBox",value:"["+Q.boundingBox.map(xt).join(" ")+"]"}),oe.push({key:"XStep",value:xt(Q.xStep)}),oe.push({key:"YStep",value:xt(Q.yStep)}),oe.push({key:"Resources",value:kt+" 0 R"}),Q.matrix&&oe.push({key:"Matrix",value:"["+Q.matrix.toString()+"]"}),Wi({data:Q.stream,additionalKeyValues:oe,objectId:Q.objectNumber}),Ut("endobj")},Ir=function(Q){var tt;for(tt in Ji)Ji.hasOwnProperty(tt)&&(Ji[tt]instanceof ou?Fr(Ji[tt]):Ji[tt]instanceof fh&&$r(Ji[tt],Q))},hn=function(Q){for(var tt in Q.objectNumber=je(),Ut("<<"),Q)switch(tt){case"opacity":Ut("/ca "+ie(Q[tt]));break;case"stroke-opacity":Ut("/CA "+ie(Q[tt]))}Ut(">>"),Ut("endobj")},pn=function(){var Q;for(Q in ar)ar.hasOwnProperty(Q)&&hn(ar[Q])},An=function(){for(var Q in Ut("/XObject <<"),Vt)Vt.hasOwnProperty(Q)&&Vt[Q].objectNumber>=0&&Ut("/"+Q+" "+Vt[Q].objectNumber+" 0 R");ft.publish("putXobjectDict"),Ut(">>")},pa=function(){ci.oid=je(),Ut("<<"),Ut("/Filter /Standard"),Ut("/V "+ci.v),Ut("/R "+ci.r),Ut("/U <"+ci.toHexString(ci.U)+">"),Ut("/O <"+ci.toHexString(ci.O)+">"),Ut("/P "+ci.P),Ut(">>"),Ut("endobj")},Rs=function(){for(var Q in Ut("/Font <<"),Ki)Ki.hasOwnProperty(Q)&&(U===!1||U===!0&&G.hasOwnProperty(Q))&&Ut("/"+Q+" "+Ki[Q].objectNumber+" 0 R");Ut(">>")},Or=function(){if(Object.keys(Ji).length>0){for(var Q in Ut("/Shading <<"),Ji)Ji.hasOwnProperty(Q)&&Ji[Q]instanceof ou&&Ji[Q].objectNumber>=0&&Ut("/"+Q+" "+Ji[Q].objectNumber+" 0 R");ft.publish("putShadingPatternDict"),Ut(">>")}},vn=function(Q){if(Object.keys(Ji).length>0){for(var tt in Ut("/Pattern <<"),Ji)Ji.hasOwnProperty(tt)&&Ji[tt]instanceof L.TilingPattern&&Ji[tt].objectNumber>=0&&Ji[tt].objectNumber<Q&&Ut("/"+tt+" "+Ji[tt].objectNumber+" 0 R");ft.publish("putTilingPatternDict"),Ut(">>")}},io=function(){if(Object.keys(ar).length>0){var Q;for(Q in Ut("/ExtGState <<"),ar)ar.hasOwnProperty(Q)&&ar[Q].objectNumber>=0&&Ut("/"+Q+" "+ar[Q].objectNumber+" 0 R");ft.publish("putGStateDict"),Ut(">>")}},ir=function(Q){_i(Q.resourcesOid,!0),Ut("<<"),Ut("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Rs(),Or(),vn(Q.objectOid),io(),An(),Ut(">>"),Ut("endobj")},ro=function(){var Q=[];Te(),pn(),Ui(),Ir(Q),ft.publish("putResources"),Q.forEach(ir),ir({resourcesOid:zi,objectOid:Number.MAX_SAFE_INTEGER}),ft.publish("postPutResources")},wn=function(){ft.publish("putAdditionalObjects");for(var Q=0;Q<Ze.length;Q++){var tt=Ze[Q];_i(tt.objId,!0),Ut(tt.content),Ut("endobj")}ft.publish("postPutAdditionalObjects")},no=function(Q){ii[Q.fontName]=ii[Q.fontName]||{},ii[Q.fontName][Q.fontStyle]=Q.id},ns=function(Q,tt,kt,zt,oe){var we={id:"F"+(Object.keys(Ki).length+1).toString(10),postScriptName:Q,fontName:tt,fontStyle:kt,encoding:zt,isStandardFont:oe||!1,metadata:{}};return ft.publish("addFont",{font:we,instance:this}),Ki[we.id]=we,no(we),we.id},ht=function(Q){for(var tt=0,kt=Qe.length;tt<kt;tt++){var zt=ns.call(this,Q[tt][0],Q[tt][1],Q[tt][2],Qe[tt][3],!0);U===!1&&(G[zt]=!0);var oe=Q[tt][0].split("-");no({id:zt,fontName:oe[0],fontStyle:oe[1]||""})}ft.publish("addFonts",{fonts:Ki,dictionary:ii})},Ct=function(Q){return Q.foo=function(){try{return Q.apply(this,arguments)}catch(zt){var tt=zt.stack||"";~tt.indexOf(" at ")&&(tt=tt.split(" at ")[1]);var kt="Error in function "+tt.split(`
`)[0].split("<")[0]+": "+zt.message;if(!qi.console)throw new Error(kt);qi.console.error(kt,zt),qi.alert&&alert(kt)}},Q.foo.bar=Q,Q.foo},ct=function(Q,tt){var kt,zt,oe,we,Me,ui,Mi,Xi,Ii;if(oe=(tt=tt||{}).sourceEncoding||"Unicode",Me=tt.outputEncoding,(tt.autoencode||Me)&&Ki[Gi].metadata&&Ki[Gi].metadata[oe]&&Ki[Gi].metadata[oe].encoding&&(we=Ki[Gi].metadata[oe].encoding,!Me&&Ki[Gi].encoding&&(Me=Ki[Gi].encoding),!Me&&we.codePages&&(Me=we.codePages[0]),typeof Me=="string"&&(Me=we[Me]),Me)){for(Mi=!1,ui=[],kt=0,zt=Q.length;kt<zt;kt++)(Xi=Me[Q.charCodeAt(kt)])?ui.push(String.fromCharCode(Xi)):ui.push(Q[kt]),ui[kt].charCodeAt(0)>>8&&(Mi=!0);Q=ui.join("")}for(kt=Q.length;Mi===void 0&&kt!==0;)Q.charCodeAt(kt-1)>>8&&(Mi=!0),kt--;if(!Mi)return Q;for(ui=tt.noBOM?[]:[254,255],kt=0,zt=Q.length;kt<zt;kt++){if((Ii=(Xi=Q.charCodeAt(kt))>>8)>>8)throw new Error("Character at position "+kt+" of string '"+Q+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ui.push(Ii),ui.push(Xi-(Ii<<8))}return String.fromCharCode.apply(void 0,ui)},bt=L.__private__.pdfEscape=L.pdfEscape=function(Q,tt){return ct(Q,tt).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Pt=L.__private__.beginPage=function(Q){Re[++X]=[],rt[X]={objId:0,contentsObjId:0,userUnit:Number(f),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(Q[0]),topRightY:Number(Q[1])}},_e(X),Ce(Re[mt])},Jt=function(Q,tt){var kt,zt,oe;switch(r=tt||r,typeof Q=="string"&&(kt=z(Q.toLowerCase()),Array.isArray(kt)&&(zt=kt[0],oe=kt[1])),Array.isArray(Q)&&(zt=Q[0]*le,oe=Q[1]*le),isNaN(zt)&&(zt=A[0],oe=A[1]),(zt>14400||oe>14400)&&(sn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),zt=Math.min(14400,zt),oe=Math.min(14400,oe)),A=[zt,oe],r.substr(0,1)){case"l":oe>zt&&(A=[oe,zt]);break;case"p":zt>oe&&(A=[oe,zt])}Pt(A),ur(Na),Ut(oo),wA!==0&&Ut(wA+" J"),ao!==0&&Ut(ao+" j"),ft.publish("addPage",{pageNumber:X})},re=function(Q){Q>0&&Q<=X&&(Re.splice(Q,1),rt.splice(Q,1),X--,mt>X&&(mt=X),this.setPage(mt))},_e=function(Q){Q>0&&Q<=X&&(mt=Q)},Be=L.__private__.getNumberOfPages=L.getNumberOfPages=function(){return Re.length-1},Ie=function(Q,tt,kt){var zt,oe=void 0;return kt=kt||{},Q=Q!==void 0?Q:Ki[Gi].fontName,tt=tt!==void 0?tt:Ki[Gi].fontStyle,zt=Q.toLowerCase(),ii[zt]!==void 0&&ii[zt][tt]!==void 0?oe=ii[zt][tt]:ii[Q]!==void 0&&ii[Q][tt]!==void 0?oe=ii[Q][tt]:kt.disableWarning===!1&&sn.warn("Unable to look up font label for font '"+Q+"', '"+tt+"'. Refer to getFontList() for available fonts."),oe||kt.noFallback||(oe=ii.times[tt])==null&&(oe=ii.times.normal),oe},ne=L.__private__.putInfo=function(){var Q=je(),tt=function(zt){return zt};for(var kt in S!==null&&(tt=ci.encryptor(Q,0)),Ut("<<"),Ut("/Producer ("+bt(tt("jsPDF "+ji.version))+")"),mi)mi.hasOwnProperty(kt)&&mi[kt]&&Ut("/"+kt.substr(0,1).toUpperCase()+kt.substr(1)+" ("+bt(tt(mi[kt]))+")");Ut("/CreationDate ("+bt(tt(se))+")"),Ut(">>"),Ut("endobj")},ye=L.__private__.putCatalog=function(Q){var tt=(Q=Q||{}).rootDictionaryObjId||xi;switch(je(),Ut("<<"),Ut("/Type /Catalog"),Ut("/Pages "+tt+" 0 R"),ze||(ze="fullwidth"),ze){case"fullwidth":Ut("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Ut("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Ut("/OpenAction [3 0 R /Fit]");break;case"original":Ut("/OpenAction [3 0 R /XYZ null null 1]");break;default:var kt=""+ze;kt.substr(kt.length-1)==="%"&&(ze=parseInt(ze)/100),typeof ze=="number"&&Ut("/OpenAction [3 0 R /XYZ null null "+ie(ze)+"]")}switch(fe||(fe="continuous"),fe){case"continuous":Ut("/PageLayout /OneColumn");break;case"single":Ut("/PageLayout /SinglePage");break;case"two":case"twoleft":Ut("/PageLayout /TwoColumnLeft");break;case"tworight":Ut("/PageLayout /TwoColumnRight")}hi&&Ut("/PageMode /"+hi),ft.publish("putCatalog"),Ut(">>"),Ut("endobj")},ve=L.__private__.putTrailer=function(){Ut("trailer"),Ut("<<"),Ut("/Size "+(Ht+1)),Ut("/Root "+Ht+" 0 R"),Ut("/Info "+(Ht-1)+" 0 R"),S!==null&&Ut("/Encrypt "+ci.oid+" 0 R"),Ut("/ID [ <"+ee+"> <"+ee+"> ]"),Ut(">>")},Ge=L.__private__.putHeader=function(){Ut("%PDF-"+K),Ut("%\xBA\xDF\xAC\xE0")},Ri=L.__private__.putXRef=function(){var Q="0000000000";Ut("xref"),Ut("0 "+(Ht+1)),Ut("0000000000 65535 f ");for(var tt=1;tt<=Ht;tt++)typeof ae[tt]=="function"?Ut((Q+ae[tt]()).slice(-10)+" 00000 n "):ae[tt]!==void 0?Ut((Q+ae[tt]).slice(-10)+" 00000 n "):Ut("0000000000 00000 n ")},Qi=L.__private__.buildDocument=function(){Kt(),Ce(ge),ft.publish("buildDocument"),Ge(),Zt(),wn(),ro(),S!==null&&pa(),ne(),ye();var Q=de;return Ri(),ve(),Ut("startxref"),Ut(""+Q),Ut("%%EOF"),Ce(Re[mt]),ge.join(`
`)},He=L.__private__.getBlob=function(Q){return new Blob([Oe(Q)],{type:"application/pdf"})},Ee=L.output=L.__private__.output=Ct(function(Q,tt){switch(typeof(tt=tt||{})=="string"?tt={filename:tt}:tt.filename=tt.filename||"generated.pdf",Q){case void 0:return Qi();case"save":L.save(tt.filename);break;case"arraybuffer":return Oe(Qi());case"blob":return He(Qi());case"bloburi":case"bloburl":if(qi.URL!==void 0&&typeof qi.URL.createObjectURL=="function")return qi.URL&&qi.URL.createObjectURL(He(Qi()))||void 0;sn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var kt="",zt=Qi();try{kt=Dy(zt)}catch{kt=Dy(unescape(encodeURIComponent(zt)))}return"data:application/pdf;filename="+tt.filename+";base64,"+kt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(qi)==="[object Window]"){var oe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",we=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';tt.pdfObjectUrl&&(oe=tt.pdfObjectUrl,we="");var Me='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+oe+'"'+we+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(tt)+");<\/script></body></html>",ui=qi.open();return ui!==null&&ui.document.write(Me),ui}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(qi)==="[object Window]"){var Mi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(tt.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+tt.filename+'" width="500px" height="400px" /></body></html>',Xi=qi.open();if(Xi!==null){Xi.document.write(Mi);var Ii=this;Xi.document.documentElement.querySelector("#pdfViewer").onload=function(){Xi.document.title=tt.filename,Xi.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ii.output("bloburl"))}}return Xi}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(qi)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var gr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",tt)+'"></iframe></body></html>',ki=qi.open();if(ki!==null&&(ki.document.write(gr),ki.document.title=tt.filename),ki||typeof safari>"u")return ki;break;case"datauri":case"dataurl":return qi.document.location.href=this.output("datauristring",tt);default:return null}}),si=function(Q){return Array.isArray(Mt)===!0&&Mt.indexOf(Q)>-1};switch(o){case"pt":le=1;break;case"mm":le=72/25.4;break;case"cm":le=72/2.54;break;case"in":le=72;break;case"px":le=si("px_scaling")==1?.75:96/72;break;case"pc":case"em":le=12;break;case"ex":le=6;break;default:if(typeof o!="number")throw new Error("Invalid unit: "+o);le=o}var ci=null;pe(),Xt();var Fi=function(Q){return S!==null?ci.encryptor(Q,0):function(tt){return tt}},lr=L.__private__.getPageInfo=L.getPageInfo=function(Q){if(isNaN(Q)||Q%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:rt[Q].objId,pageNumber:Q,pageContext:rt[Q]}},ai=L.__private__.getPageInfoByObjId=function(Q){if(isNaN(Q)||Q%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var tt in rt)if(rt[tt].objId===Q)break;return lr(tt)},Br=L.__private__.getCurrentPageInfo=L.getCurrentPageInfo=function(){return{objId:rt[mt].objId,pageNumber:mt,pageContext:rt[mt]}};L.addPage=function(){return Jt.apply(this,arguments),this},L.setPage=function(){return _e.apply(this,arguments),Ce.call(this,Re[mt]),this},L.insertPage=function(Q){return this.addPage(),this.movePage(mt,Q),this},L.movePage=function(Q,tt){var kt,zt;if(Q>tt){kt=Re[Q],zt=rt[Q];for(var oe=Q;oe>tt;oe--)Re[oe]=Re[oe-1],rt[oe]=rt[oe-1];Re[tt]=kt,rt[tt]=zt,this.setPage(tt)}else if(Q<tt){kt=Re[Q],zt=rt[Q];for(var we=Q;we<tt;we++)Re[we]=Re[we+1],rt[we]=rt[we+1];Re[tt]=kt,rt[tt]=zt,this.setPage(tt)}return this},L.deletePage=function(){return re.apply(this,arguments),this},L.__private__.text=L.text=function(Q,tt,kt,zt,oe){var we,Me,ui,Mi,Xi,Ii,gr,ki,tn,er=(zt=zt||{}).scope||this;if(typeof Q=="number"&&typeof tt=="number"&&(typeof kt=="string"||Array.isArray(kt))){var nr=kt;kt=tt,tt=Q,Q=nr}if(arguments[3]instanceof Wt?(It("The transform parameter of text() with a Matrix value"),tn=oe):(ui=arguments[4],Mi=arguments[5],Sr(gr=arguments[3])==="object"&&gr!==null||(typeof ui=="string"&&(Mi=ui,ui=null),typeof gr=="string"&&(Mi=gr,gr=null),typeof gr=="number"&&(ui=gr,gr=null),zt={flags:gr,angle:ui,align:Mi})),isNaN(tt)||isNaN(kt)||Q==null)throw new Error("Invalid arguments passed to jsPDF.text");if(Q.length===0)return er;var cn="",Gs=!1,os=typeof zt.lineHeightFactor=="number"?zt.lineHeightFactor:Kn,Zs=er.internal.scaleFactor;function za(kr){return kr=kr.split("	").join(Array(zt.TabLen||9).join(" ")),bt(kr,gr)}function Ca(kr){for(var _r,en=kr.concat(),Wr=[],co=en.length;co--;)typeof(_r=en.shift())=="string"?Wr.push(_r):Array.isArray(kr)&&(_r.length===1||_r[1]===void 0&&_r[2]===void 0)?Wr.push(_r[0]):Wr.push([_r[0],_r[1],_r[2]]);return Wr}function Oa(kr,_r){var en;if(typeof kr=="string")en=_r(kr)[0];else if(Array.isArray(kr)){for(var Wr,co,Ss=kr.concat(),xa=[],kA=Ss.length;kA--;)typeof(Wr=Ss.shift())=="string"?xa.push(_r(Wr)[0]):Array.isArray(Wr)&&typeof Wr[0]=="string"&&(co=_r(Wr[0],Wr[1],Wr[2]),xa.push([co[0],co[1],co[2]]));en=xa}return en}var ys=!1,Ao=!0;if(typeof Q=="string")ys=!0;else if(Array.isArray(Q)){var Fn=Q.concat();Me=[];for(var Ia,kn=Fn.length;kn--;)(typeof(Ia=Fn.shift())!="string"||Array.isArray(Ia)&&typeof Ia[0]!="string")&&(Ao=!1);ys=Ao}if(ys===!1)throw new Error('Type of text must be string or Array. "'+Q+'" is not recognized.');typeof Q=="string"&&(Q=Q.match(/[\r?\n]/)?Q.split(/\r\n|\r|\n/g):[Q]);var ya=Ne/er.internal.scaleFactor,Ps=ya*(os-1);switch(zt.baseline){case"bottom":kt-=Ps;break;case"top":kt+=ya-Ps;break;case"hanging":kt+=ya-2*Ps;break;case"middle":kt+=ya/2-Ps}if((Ii=zt.maxWidth||0)>0&&(typeof Q=="string"?Q=er.splitTextToSize(Q,Ii):Object.prototype.toString.call(Q)==="[object Array]"&&(Q=Q.reduce(function(kr,_r){return kr.concat(er.splitTextToSize(_r,Ii))},[]))),we={text:Q,x:tt,y:kt,options:zt,mutex:{pdfEscape:bt,activeFontKey:Gi,fonts:Ki,activeFontSize:Ne}},ft.publish("preProcessText",we),Q=we.text,ui=(zt=we.options).angle,!(tn instanceof Wt)&&ui&&typeof ui=="number"){ui*=Math.PI/180,zt.rotationDirection===0&&(ui=-ui),At===it.ADVANCED&&(ui=-ui);var jo=Math.cos(ui),ba=Math.sin(ui);tn=new Wt(jo,ba,-ba,jo,0,0)}else ui&&ui instanceof Wt&&(tn=ui);At!==it.ADVANCED||tn||(tn=he),(Xi=zt.charSpace||Da)!==void 0&&(cn+=xt(at(Xi))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ki=zt.horizontalScale)!==void 0&&(cn+=xt(100*ki)+` Tz
`),zt.lang;var Bn=-1,SA=zt.renderingMode!==void 0?zt.renderingMode:zt.stroke,FA=er.internal.getCurrentPageInfo().pageContext;switch(SA){case 0:case!1:case"fill":Bn=0;break;case 1:case!0:case"stroke":Bn=1;break;case 2:case"fillThenStroke":Bn=2;break;case 3:case"invisible":Bn=3;break;case 4:case"fillAndAddForClipping":Bn=4;break;case 5:case"strokeAndAddPathForClipping":Bn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Bn=6;break;case 7:case"addToPathForClipping":Bn=7}var qo=FA.usedRenderingMode!==void 0?FA.usedRenderingMode:-1;Bn!==-1?cn+=Bn+` Tr
`:qo!==-1&&(cn+=`0 Tr
`),Bn!==-1&&(FA.usedRenderingMode=Bn),Mi=zt.align||"left";var Ln,Wa=Ne*os,va=er.internal.pageSize.getWidth(),dr=Ki[Gi];Xi=zt.charSpace||Da,Ii=zt.maxWidth||0,gr=Object.assign({autoencode:!0,noBOM:!0},zt.flags);var Hs=[];if(Object.prototype.toString.call(Q)==="[object Array]"){var bs;Me=Ca(Q),Mi!=="left"&&(Ln=Me.map(function(kr){return er.getStringUnitWidth(kr,{font:dr,charSpace:Xi,fontSize:Ne,doKerning:!1})*Ne/Zs}));var Ms,as=0;if(Mi==="right"){tt-=Ln[0],Q=[],kn=Me.length;for(var vs=0;vs<kn;vs++)vs===0?(Ms=Oo(tt),bs=Is(kt)):(Ms=at(as-Ln[vs]),bs=-Wa),Q.push([Me[vs],Ms,bs]),as=Ln[vs]}else if(Mi==="center"){tt-=Ln[0]/2,Q=[],kn=Me.length;for(var Ns=0;Ns<kn;Ns++)Ns===0?(Ms=Oo(tt),bs=Is(kt)):(Ms=at((as-Ln[Ns])/2),bs=-Wa),Q.push([Me[Ns],Ms,bs]),as=Ln[Ns]}else if(Mi==="left"){Q=[],kn=Me.length;for(var wa=0;wa<kn;wa++)Q.push(Me[wa])}else{if(Mi!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');Q=[],kn=Me.length,Ii=Ii!==0?Ii:va;for(var ws=0;ws<kn;ws++)bs=ws===0?Is(kt):-Wa,Ms=ws===0?Oo(tt):0,ws<kn-1?Hs.push(xt(at((Ii-Ln[ws])/(Me[ws].split(" ").length-1)))):Hs.push(0),Q.push([Me[ws],Ms,bs])}}var $o=typeof zt.R2L=="boolean"?zt.R2L:ri;$o===!0&&(Q=Oa(Q,function(kr,_r,en){return[kr.split("").reverse().join(""),_r,en]})),we={text:Q,x:tt,y:kt,options:zt,mutex:{pdfEscape:bt,activeFontKey:Gi,fonts:Ki,activeFontSize:Ne}},ft.publish("postProcessText",we),Q=we.text,Gs=we.mutex.isHex||!1;var ta=Ki[Gi].encoding;ta!=="WinAnsiEncoding"&&ta!=="StandardEncoding"||(Q=Oa(Q,function(kr,_r,en){return[za(kr),_r,en]})),Me=Ca(Q),Q=[];for(var As,Bs,lo,Ba=0,ea=1,To=Array.isArray(Me[0])?ea:Ba,_s="",_a=function(kr,_r,en){var Wr="";return en instanceof Wt?(en=typeof zt.angle=="number"?be(en,new Wt(1,0,0,1,kr,_r)):be(new Wt(1,0,0,1,kr,_r),en),At===it.ADVANCED&&(en=be(new Wt(1,0,0,-1,0,0),en)),Wr=en.join(" ")+` Tm
`):Wr=xt(kr)+" "+xt(_r)+` Td
`,Wr},Vr=0;Vr<Me.length;Vr++){switch(_s="",To){case ea:lo=(Gs?"<":"(")+Me[Vr][0]+(Gs?">":")"),As=parseFloat(Me[Vr][1]),Bs=parseFloat(Me[Vr][2]);break;case Ba:lo=(Gs?"<":"(")+Me[Vr]+(Gs?">":")"),As=Oo(tt),Bs=Is(kt)}Hs!==void 0&&Hs[Vr]!==void 0&&(_s=Hs[Vr]+` Tw
`),Vr===0?Q.push(_s+_a(As,Bs,tn)+lo):To===Ba?Q.push(_s+lo):To===ea&&Q.push(_s+_a(As,Bs,tn)+lo)}Q=To===Ba?Q.join(` Tj
T* `):Q.join(` Tj
`),Q+=` Tj
`;var xs=`BT
/`;return xs+=Gi+" "+Ne+` Tf
`,xs+=xt(Ne*os)+` TL
`,xs+=Jo+`
`,xs+=cn,xs+=Q,Ut(xs+="ET"),G[Gi]=!0,er};var ln=L.__private__.clip=L.clip=function(Q){return Ut(Q==="evenodd"?"W*":"W"),this};L.clipEvenOdd=function(){return ln("evenodd")},L.__private__.discardPath=L.discardPath=function(){return Ut("n"),this};var yr=L.__private__.isValidStyle=function(Q){var tt=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(Q)!==-1&&(tt=!0),tt};L.__private__.setDefaultPathOperation=L.setDefaultPathOperation=function(Q){return yr(Q)&&(_=Q),this};var ss=L.__private__.getStyle=L.getStyle=function(Q){var tt=_;switch(Q){case"D":case"S":tt="S";break;case"F":tt="f";break;case"FD":case"DF":tt="B";break;case"f":case"f*":case"B":case"B*":tt=Q}return tt},$n=L.close=function(){return Ut("h"),this};L.stroke=function(){return Ut("S"),this},L.fill=function(Q){return zo("f",Q),this},L.fillEvenOdd=function(Q){return zo("f*",Q),this},L.fillStroke=function(Q){return zo("B",Q),this},L.fillStrokeEvenOdd=function(Q){return zo("B*",Q),this};var zo=function(Q,tt){Sr(tt)==="object"?Ic(tt,Q):Ut(Q)},yA=function(Q){Q===null||At===it.ADVANCED&&Q===void 0||(Q=ss(Q),Ut(Q))};function Ql(Q,tt,kt,zt,oe){var we=new fh(tt||this.boundingBox,kt||this.xStep,zt||this.yStep,this.gState,oe||this.matrix);we.stream=this.stream;var Me=Q+"$$"+this.cloneIndex+++"$$";return Le(Me,we),we}var Ic=function(Q,tt){var kt=wr[Q.key],zt=Ji[kt];if(zt instanceof ou)Ut("q"),Ut(bA(tt)),zt.gState&&L.setGState(zt.gState),Ut(Q.matrix.toString()+" cm"),Ut("/"+kt+" sh"),Ut("Q");else if(zt instanceof fh){var oe=new Wt(1,0,0,-1,0,Yo());Q.matrix&&(oe=oe.multiply(Q.matrix||he),kt=Ql.call(zt,Q.key,Q.boundingBox,Q.xStep,Q.yStep,oe).id),Ut("q"),Ut("/Pattern cs"),Ut("/"+kt+" scn"),zt.gState&&L.setGState(zt.gState),Ut(tt),Ut("Q")}},bA=function(Q){switch(Q){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ma=L.moveTo=function(Q,tt){return Ut(xt(at(Q))+" "+xt(Bt(tt))+" m"),this},Lo=L.lineTo=function(Q,tt){return Ut(xt(at(Q))+" "+xt(Bt(tt))+" l"),this},Eo=L.curveTo=function(Q,tt,kt,zt,oe,we){return Ut([xt(at(Q)),xt(Bt(tt)),xt(at(kt)),xt(Bt(zt)),xt(at(oe)),xt(Bt(we)),"c"].join(" ")),this};L.__private__.line=L.line=function(Q,tt,kt,zt,oe){if(isNaN(Q)||isNaN(tt)||isNaN(kt)||isNaN(zt)||!yr(oe))throw new Error("Invalid arguments passed to jsPDF.line");return At===it.COMPAT?this.lines([[kt-Q,zt-tt]],Q,tt,[1,1],oe||"S"):this.lines([[kt-Q,zt-tt]],Q,tt,[1,1]).stroke()},L.__private__.lines=L.lines=function(Q,tt,kt,zt,oe,we){var Me,ui,Mi,Xi,Ii,gr,ki,tn,er,nr,cn,Gs;if(typeof Q=="number"&&(Gs=kt,kt=tt,tt=Q,Q=Gs),zt=zt||[1,1],we=we||!1,isNaN(tt)||isNaN(kt)||!Array.isArray(Q)||!Array.isArray(zt)||!yr(oe)||typeof we!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ma(tt,kt),Me=zt[0],ui=zt[1],Xi=Q.length,nr=tt,cn=kt,Mi=0;Mi<Xi;Mi++)(Ii=Q[Mi]).length===2?(nr=Ii[0]*Me+nr,cn=Ii[1]*ui+cn,Lo(nr,cn)):(gr=Ii[0]*Me+nr,ki=Ii[1]*ui+cn,tn=Ii[2]*Me+nr,er=Ii[3]*ui+cn,nr=Ii[4]*Me+nr,cn=Ii[5]*ui+cn,Eo(gr,ki,tn,er,nr,cn));return we&&$n(),yA(oe),this},L.path=function(Q){for(var tt=0;tt<Q.length;tt++){var kt=Q[tt],zt=kt.c;switch(kt.op){case"m":Ma(zt[0],zt[1]);break;case"l":Lo(zt[0],zt[1]);break;case"c":Eo.apply(this,zt);break;case"h":$n()}}return this},L.__private__.rect=L.rect=function(Q,tt,kt,zt,oe){if(isNaN(Q)||isNaN(tt)||isNaN(kt)||isNaN(zt)||!yr(oe))throw new Error("Invalid arguments passed to jsPDF.rect");return At===it.COMPAT&&(zt=-zt),Ut([xt(at(Q)),xt(Bt(tt)),xt(at(kt)),xt(at(zt)),"re"].join(" ")),yA(oe),this},L.__private__.triangle=L.triangle=function(Q,tt,kt,zt,oe,we,Me){if(isNaN(Q)||isNaN(tt)||isNaN(kt)||isNaN(zt)||isNaN(oe)||isNaN(we)||!yr(Me))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[kt-Q,zt-tt],[oe-kt,we-zt],[Q-oe,tt-we]],Q,tt,[1,1],Me,!0),this},L.__private__.roundedRect=L.roundedRect=function(Q,tt,kt,zt,oe,we,Me){if(isNaN(Q)||isNaN(tt)||isNaN(kt)||isNaN(zt)||isNaN(oe)||isNaN(we)||!yr(Me))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ui=4/3*(Math.SQRT2-1);return oe=Math.min(oe,.5*kt),we=Math.min(we,.5*zt),this.lines([[kt-2*oe,0],[oe*ui,0,oe,we-we*ui,oe,we],[0,zt-2*we],[0,we*ui,-oe*ui,we,-oe,we],[2*oe-kt,0],[-oe*ui,0,-oe,-we*ui,-oe,-we],[0,2*we-zt],[0,-we*ui,oe*ui,-we,oe,-we]],Q+oe,tt,[1,1],Me,!0),this},L.__private__.ellipse=L.ellipse=function(Q,tt,kt,zt,oe){if(isNaN(Q)||isNaN(tt)||isNaN(kt)||isNaN(zt)||!yr(oe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var we=4/3*(Math.SQRT2-1)*kt,Me=4/3*(Math.SQRT2-1)*zt;return Ma(Q+kt,tt),Eo(Q+kt,tt-Me,Q+we,tt-zt,Q,tt-zt),Eo(Q-we,tt-zt,Q-kt,tt-Me,Q-kt,tt),Eo(Q-kt,tt+Me,Q-we,tt+zt,Q,tt+zt),Eo(Q+we,tt+zt,Q+kt,tt+Me,Q+kt,tt),yA(oe),this},L.__private__.circle=L.circle=function(Q,tt,kt,zt){if(isNaN(Q)||isNaN(tt)||isNaN(kt)||!yr(zt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(Q,tt,kt,kt,zt)},L.setFont=function(Q,tt,kt){return kt&&(tt=Et(tt,kt)),Gi=Ie(Q,tt,{disableWarning:!1}),this};var rl=L.__private__.getFont=L.getFont=function(){return Ki[Ie.apply(L,arguments)]};L.__private__.getFontList=L.getFontList=function(){var Q,tt,kt={};for(Q in ii)if(ii.hasOwnProperty(Q))for(tt in kt[Q]=[],ii[Q])ii[Q].hasOwnProperty(tt)&&kt[Q].push(tt);return kt},L.addFont=function(Q,tt,kt,zt,oe){var we=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&we.indexOf(arguments[3])!==-1?oe=arguments[3]:arguments[3]&&we.indexOf(arguments[3])==-1&&(kt=Et(kt,zt)),oe=oe||"Identity-H",ns.call(this,Q,tt,kt,oe)};var Kn,Na=n.lineWidth||.200025,so=L.__private__.getLineWidth=L.getLineWidth=function(){return Na},ur=L.__private__.setLineWidth=L.setLineWidth=function(Q){return Na=Q,Ut(xt(at(Q))+" w"),this};L.__private__.setLineDash=ji.API.setLineDash=ji.API.setLineDashPattern=function(Q,tt){if(Q=Q||[],tt=tt||0,isNaN(tt)||!Array.isArray(Q))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return Q=Q.map(function(kt){return xt(at(kt))}).join(" "),tt=xt(at(tt)),Ut("["+Q+"] "+tt+" d"),this};var fa=L.__private__.getLineHeight=L.getLineHeight=function(){return Ne*Kn};L.__private__.getLineHeight=L.getLineHeight=function(){return Ne*Kn};var Rl=L.__private__.setLineHeightFactor=L.setLineHeightFactor=function(Q){return typeof(Q=Q||1.15)=="number"&&(Kn=Q),this},Va=L.__private__.getLineHeightFactor=L.getLineHeightFactor=function(){return Kn};Rl(n.lineHeight);var Oo=L.__private__.getHorizontalCoordinate=function(Q){return at(Q)},Is=L.__private__.getVerticalCoordinate=function(Q){return At===it.ADVANCED?Q:rt[mt].mediaBox.topRightY-rt[mt].mediaBox.bottomLeftY-at(Q)},yc=L.__private__.getHorizontalCoordinateString=L.getHorizontalCoordinateString=function(Q){return xt(Oo(Q))},Wo=L.__private__.getVerticalCoordinateString=L.getVerticalCoordinateString=function(Q){return xt(Is(Q))},oo=n.strokeColor||"0 G";L.__private__.getStrokeColor=L.getDrawColor=function(){return hr(oo)},L.__private__.setStrokeColor=L.setDrawColor=function(Q,tt,kt,zt){return oo=fr({ch1:Q,ch2:tt,ch3:kt,ch4:zt,pdfColorType:"draw",precision:2}),Ut(oo),this};var vA=n.fillColor||"0 g";L.__private__.getFillColor=L.getFillColor=function(){return hr(vA)},L.__private__.setFillColor=L.setFillColor=function(Q,tt,kt,zt){return vA=fr({ch1:Q,ch2:tt,ch3:kt,ch4:zt,pdfColorType:"fill",precision:2}),Ut(vA),this};var Jo=n.textColor||"0 g",Gl=L.__private__.getTextColor=L.getTextColor=function(){return hr(Jo)};L.__private__.setTextColor=L.setTextColor=function(Q,tt,kt,zt){return Jo=fr({ch1:Q,ch2:tt,ch3:kt,ch4:zt,pdfColorType:"text",precision:3}),this};var Da=n.charSpace,Zl=L.__private__.getCharSpace=L.getCharSpace=function(){return parseFloat(Da||0)};L.__private__.setCharSpace=L.setCharSpace=function(Q){if(isNaN(Q))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Da=Q,this};var wA=0;L.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},L.__private__.setLineCap=L.setLineCap=function(Q){var tt=L.CapJoinStyles[Q];if(tt===void 0)throw new Error("Line cap style of '"+Q+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return wA=tt,Ut(tt+" J"),this};var ao=0;L.__private__.setLineJoin=L.setLineJoin=function(Q){var tt=L.CapJoinStyles[Q];if(tt===void 0)throw new Error("Line join style of '"+Q+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ao=tt,Ut(tt+" j"),this},L.__private__.setLineMiterLimit=L.__private__.setMiterLimit=L.setLineMiterLimit=L.setMiterLimit=function(Q){if(Q=Q||0,isNaN(Q))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Ut(xt(at(Q))+" M"),this},L.GState=lm,L.setGState=function(Q){(Q=typeof Q=="string"?ar[wt[Q]]:nl(null,Q)).equals(W)||(Ut("/"+Q.id+" gs"),W=Q)};var nl=function(Q,tt){if(!Q||!wt[Q]){var kt=!1;for(var zt in ar)if(ar.hasOwnProperty(zt)&&ar[zt].equals(tt)){kt=!0;break}if(kt)tt=ar[zt];else{var oe="GS"+(Object.keys(ar).length+1).toString(10);ar[oe]=tt,tt.id=oe}return Q&&(wt[Q]=tt.id),ft.publish("addGState",tt),tt}};L.addGState=function(Q,tt){return nl(Q,tt),this},L.saveGraphicsState=function(){return Ut("q"),br.push({key:Gi,size:Ne,color:Jo}),this},L.restoreGraphicsState=function(){Ut("Q");var Q=br.pop();return Gi=Q.key,Ne=Q.size,Jo=Q.color,W=null,this},L.setCurrentTransformationMatrix=function(Q){return Ut(Q.toString()+" cm"),this},L.comment=function(Q){return Ut("#"+Q),this};var BA=function(Q,tt){var kt=Q||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return kt},set:function(we){isNaN(we)||(kt=parseFloat(we))}});var zt=tt||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return zt},set:function(we){isNaN(we)||(zt=parseFloat(we))}});var oe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return oe},set:function(we){oe=we.toString()}}),this},sl=function(Q,tt,kt,zt){BA.call(this,Q,tt),this.type="rect";var oe=kt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return oe},set:function(Me){isNaN(Me)||(oe=parseFloat(Me))}});var we=zt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return we},set:function(Me){isNaN(Me)||(we=parseFloat(Me))}}),this},_A=function(){this.page=X,this.currentPage=mt,this.pages=Re.slice(0),this.pagesContext=rt.slice(0),this.x=gi,this.y=Ke,this.matrix=or,this.width=Ka(mt),this.height=Yo(mt),this.outputDestination=Xe,this.id="",this.objectNumber=-1};_A.prototype.restore=function(){X=this.page,mt=this.currentPage,rt=this.pagesContext,Re=this.pages,gi=this.x,Ke=this.y,or=this.matrix,ol(mt,this.width),xA(mt,this.height),Xe=this.outputDestination};var ma=function(Q,tt,kt,zt,oe){Rt.push(new _A),X=mt=0,Re=[],gi=Q,Ke=tt,or=oe,Pt([kt,zt])},bc=function(Q){if(Yt[Q])Rt.pop().restore();else{var tt=new _A,kt="Xo"+(Object.keys(Vt).length+1).toString(10);tt.id=kt,Yt[Q]=kt,Vt[kt]=tt,ft.publish("addFormObject",tt),Rt.pop().restore()}};for(var Xo in L.beginFormObject=function(Q,tt,kt,zt,oe){return ma(Q,tt,kt,zt,oe),this},L.endFormObject=function(Q){return bc(Q),this},L.doFormObject=function(Q,tt){var kt=Vt[Yt[Q]];return Ut("q"),Ut(tt.toString()+" cm"),Ut("/"+kt.id+" Do"),Ut("Q"),this},L.getFormObject=function(Q){var tt=Vt[Yt[Q]];return{x:tt.x,y:tt.y,width:tt.width,height:tt.height,matrix:tt.matrix}},L.save=function(Q,tt){return Q=Q||"generated.pdf",(tt=tt||{}).returnPromise=tt.returnPromise||!1,tt.returnPromise===!1?(su(He(Qi()),Q),typeof su.unload=="function"&&qi.setTimeout&&setTimeout(su.unload,911),this):new Promise(function(kt,zt){try{var oe=su(He(Qi()),Q);typeof su.unload=="function"&&qi.setTimeout&&setTimeout(su.unload,911),kt(oe)}catch(we){zt(we.message)}})},ji.API)ji.API.hasOwnProperty(Xo)&&(Xo==="events"&&ji.API.events.length?function(Q,tt){var kt,zt,oe;for(oe=tt.length-1;oe!==-1;oe--)kt=tt[oe][0],zt=tt[oe][1],Q.subscribe.apply(Q,[kt].concat(typeof zt=="function"?[zt]:zt))}(ft,ji.API.events):L[Xo]=ji.API[Xo]);var Ka=L.getPageWidth=function(Q){return(rt[Q=Q||mt].mediaBox.topRightX-rt[Q].mediaBox.bottomLeftX)/le},ol=L.setPageWidth=function(Q,tt){rt[Q].mediaBox.topRightX=tt*le+rt[Q].mediaBox.bottomLeftX},Yo=L.getPageHeight=function(Q){return(rt[Q=Q||mt].mediaBox.topRightY-rt[Q].mediaBox.bottomLeftY)/le},xA=L.setPageHeight=function(Q,tt){rt[Q].mediaBox.topRightY=tt*le+rt[Q].mediaBox.bottomLeftY};return L.internal={pdfEscape:bt,getStyle:ss,getFont:rl,getFontSize:We,getCharSpace:Zl,getTextColor:Gl,getLineHeight:fa,getLineHeightFactor:Va,getLineWidth:so,write:Ye,getHorizontalCoordinate:Oo,getVerticalCoordinate:Is,getCoordinateString:yc,getVerticalCoordinateString:Wo,collections:{},newObject:je,newAdditionalObject:$i,newObjectDeferred:ti,newObjectDeferredBegin:_i,getFilters:Hi,putStream:Wi,events:ft,scaleFactor:le,pageSize:{getWidth:function(){return Ka(mt)},setWidth:function(Q){ol(mt,Q)},getHeight:function(){return Yo(mt)},setHeight:function(Q){xA(mt,Q)}},encryptionOptions:S,encryption:ci,getEncryptor:Fi,output:Ee,getNumberOfPages:Be,pages:Re,out:Ut,f2:ie,f3:lt,getPageInfo:lr,getPageInfoByObjId:ai,getCurrentPageInfo:Br,getPDFVersion:V,Point:BA,Rectangle:sl,Matrix:Wt,hasHotfix:si},Object.defineProperty(L.internal.pageSize,"width",{get:function(){return Ka(mt)},set:function(Q){ol(mt,Q)},enumerable:!0,configurable:!0}),Object.defineProperty(L.internal.pageSize,"height",{get:function(){return Yo(mt)},set:function(Q){xA(mt,Q)},enumerable:!0,configurable:!0}),ht.call(L,Qe),Gi="F1",Jt(A,r),ft.publish("initialized"),L}function q5(n){return n.reduce(function(t,r,o){return t[r]=o,t},{})}function Jy(n){var t=n.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return $5[s=s||"normal"]?s:"normal"}(n.style),o=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(n.weight),A=function(s){return typeof Wy[s=s||"normal"]=="number"?s:"normal"}(n.stretch);return{family:t,style:r,weight:o,stretch:A,src:n.src||[],ref:n.ref||{name:t,style:[A,r,o].join(" ")}}}function x5(n,t,r,o){var A;for(A=r;A>=0&&A<t.length;A+=o)if(n[t[A]])return n[t[A]];for(A=r;A>=0&&A<t.length;A-=o)if(n[t[A]])return n[t[A]]}function F5(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function eK(n,t,r){for(var o=(r=r||{}).defaultFontFamily||"times",A=Object.assign({},tK,r.genericFontFamilies||{}),s=null,d=null,f=0;f<t.length;++f)if(A[(s=Jy(t[f])).family]&&(s.family=A[s.family]),n.hasOwnProperty(s.family)){d=n[s.family];break}if(!(d=d||n[o]))throw new Error("Could not find a font-family for the rule '"+F5(s)+"' and default family '"+o+"'.");if(d=function(I,_){if(_[I])return _[I];var S=Wy[I],U=S<=Wy.normal?-1:1,G=x5(_,tS,S,U);if(!G)throw new Error("Could not find a matching font-stretch value for "+I);return G}(s.stretch,d),d=function(I,_){if(_[I])return _[I];for(var S=$5[I],U=0;U<S.length;++U)if(_[S[U]])return _[S[U]];throw new Error("Could not find a matching font-style for "+I)}(s.style,d),!(d=function(I,_){if(_[I])return _[I];if(I===400&&_[500])return _[500];if(I===500&&_[400])return _[400];var S=$D[I],U=x5(_,eS,S,I<400?-1:1);if(!U)throw new Error("Could not find a matching font-weight for value "+I);return U}(s.weight,d)))throw new Error("Failed to resolve a font for the rule '"+F5(s)+"'.");return d}function k5(n){return n.trimLeft()}function iK(n,t){for(var r=0;r<n.length;){if(n.charAt(r)===t)return[n.substring(0,r),n.substring(r+1)];r+=1}return null}function rK(n){var t=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],n.substring(t[0].length)]}function sK(n){var t=0;if(n[t++]!==71||n[t++]!==73||n[t++]!==70||n[t++]!==56||(n[t++]+1&253)!=56||n[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=n[t++]|n[t++]<<8,o=n[t++]|n[t++]<<8,A=n[t++],s=A>>7,d=1<<(7&A)+1;n[t++],n[t++];var f=null,I=null;s&&(f=t,I=d,t+=3*d);var _=!0,S=[],U=0,G=null,L=0,K=null;for(this.width=r,this.height=o;_&&t<n.length;)switch(n[t++]){case 33:switch(n[t++]){case 255:if(n[t]!==11||n[t+1]==78&&n[t+2]==69&&n[t+3]==84&&n[t+4]==83&&n[t+5]==67&&n[t+6]==65&&n[t+7]==80&&n[t+8]==69&&n[t+9]==50&&n[t+10]==46&&n[t+11]==48&&n[t+12]==3&&n[t+13]==1&&n[t+16]==0)t+=14,K=n[t++]|n[t++]<<8,t++;else for(t+=12;;){if(!((lt=n[t++])>=0))throw Error("Invalid block size");if(lt===0)break;t+=lt}break;case 249:if(n[t++]!==4||n[t+4]!==0)throw new Error("Invalid graphics extension block.");var V=n[t++];U=n[t++]|n[t++]<<8,G=n[t++],!(1&V)&&(G=null),L=V>>2&7,t++;break;case 254:for(;;){if(!((lt=n[t++])>=0))throw Error("Invalid block size");if(lt===0)break;t+=lt}break;default:throw new Error("Unknown graphic control label: 0x"+n[t-1].toString(16))}break;case 44:var q=n[t++]|n[t++]<<8,z=n[t++]|n[t++]<<8,it=n[t++]|n[t++]<<8,At=n[t++]|n[t++]<<8,_t=n[t++],Lt=_t>>6&1,Et=1<<(7&_t)+1,xt=f,It=I,Nt=!1;_t>>7&&(Nt=!0,xt=t,It=Et,t+=3*Et);var ie=t;for(t++;;){var lt;if(!((lt=n[t++])>=0))throw Error("Invalid block size");if(lt===0)break;t+=lt}S.push({x:q,y:z,width:it,height:At,has_local_palette:Nt,palette_offset:xt,palette_size:It,data_offset:ie,data_length:t-ie,transparent_index:G,interlaced:!!Lt,delay:U,disposal:L});break;case 59:_=!1;break;default:throw new Error("Unknown gif block: 0x"+n[t-1].toString(16))}this.numFrames=function(){return S.length},this.loopCount=function(){return K},this.frameInfo=function(at){if(at<0||at>=S.length)throw new Error("Frame index out of range.");return S[at]},this.decodeAndBlitFrameBGRA=function(at,St){var Bt=this.frameInfo(at),se=Bt.width*Bt.height,ee=new Uint8Array(se);G5(n,Bt.data_offset,ee,se);var qt=Bt.palette_offset,Xt=Bt.transparent_index;Xt===null&&(Xt=256);var vt=Bt.width,Tt=r-vt,pe=vt,j=4*(Bt.y*r+Bt.x),mt=4*((Bt.y+Bt.height)*r+Bt.x),yt=j,Qt=4*Tt;Bt.interlaced===!0&&(Qt+=4*r*7);for(var Ht=8,ae=0,ge=ee.length;ae<ge;++ae){var de=ee[ae];if(pe===0&&(pe=vt,(yt+=Qt)>=mt&&(Qt=4*Tt+4*r*(Ht-1),yt=j+(vt+Tt)*(Ht<<1),Ht>>=1)),de===Xt)yt+=4;else{var Ze=n[qt+3*de],Re=n[qt+3*de+1],Je=n[qt+3*de+2];St[yt++]=Je,St[yt++]=Re,St[yt++]=Ze,St[yt++]=255}--pe}},this.decodeAndBlitFrameRGBA=function(at,St){var Bt=this.frameInfo(at),se=Bt.width*Bt.height,ee=new Uint8Array(se);G5(n,Bt.data_offset,ee,se);var qt=Bt.palette_offset,Xt=Bt.transparent_index;Xt===null&&(Xt=256);var vt=Bt.width,Tt=r-vt,pe=vt,j=4*(Bt.y*r+Bt.x),mt=4*((Bt.y+Bt.height)*r+Bt.x),yt=j,Qt=4*Tt;Bt.interlaced===!0&&(Qt+=4*r*7);for(var Ht=8,ae=0,ge=ee.length;ae<ge;++ae){var de=ee[ae];if(pe===0&&(pe=vt,(yt+=Qt)>=mt&&(Qt=4*Tt+4*r*(Ht-1),yt=j+(vt+Tt)*(Ht<<1),Ht>>=1)),de===Xt)yt+=4;else{var Ze=n[qt+3*de],Re=n[qt+3*de+1],Je=n[qt+3*de+2];St[yt++]=Ze,St[yt++]=Re,St[yt++]=Je,St[yt++]=255}--pe}}}function G5(n,t,r,o){for(var A=n[t++],s=1<<A,d=s+1,f=d+1,I=A+1,_=(1<<I)-1,S=0,U=0,G=0,L=n[t++],K=new Int32Array(4096),V=null;;){for(;S<16&&L!==0;)U|=n[t++]<<S,S+=8,L===1?L=n[t++]:--L;if(S<I)break;var q=U&_;if(U>>=I,S-=I,q!==s){if(q===d)break;for(var z=q<f?q:V,it=0,At=z;At>s;)At=K[At]>>8,++it;var _t=At;if(G+it+(z!==q?1:0)>o)return void sn.log("Warning, gif stream longer than expected.");r[G++]=_t;var Lt=G+=it;for(z!==q&&(r[G++]=_t),At=z;it--;)At=K[At],r[--Lt]=255&At,At>>=8;V!==null&&f<4096&&(K[f++]=V<<8|_t,f>=_+1&&I<12&&(++I,_=_<<1|1)),V=q}else f=d+1,_=(1<<(I=A+1))-1,V=null}return G!==o&&sn.log("Warning, gif stream shorter than expected."),r}function Zy(n){var t,r,o,A,s,d=Math.floor,f=new Array(64),I=new Array(64),_=new Array(64),S=new Array(64),U=new Array(65535),G=new Array(65535),L=new Array(64),K=new Array(64),V=[],q=0,z=7,it=new Array(64),At=new Array(64),_t=new Array(64),Lt=new Array(256),Et=new Array(2048),xt=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],It=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Nt=[0,1,2,3,4,5,6,7,8,9,10,11],ie=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],lt=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],at=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],St=[0,1,2,3,4,5,6,7,8,9,10,11],Bt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],se=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ee(j,mt){for(var yt=0,Qt=0,Ht=new Array,ae=1;ae<=16;ae++){for(var ge=1;ge<=j[ae];ge++)Ht[mt[Qt]]=[],Ht[mt[Qt]][0]=yt,Ht[mt[Qt]][1]=ae,Qt++,yt++;yt*=2}return Ht}function qt(j){for(var mt=j[0],yt=j[1]-1;yt>=0;)mt&1<<yt&&(q|=1<<z),yt--,--z<0&&(q==255?(Xt(255),Xt(0)):Xt(q),z=7,q=0)}function Xt(j){V.push(j)}function vt(j){Xt(j>>8&255),Xt(255&j)}function Tt(j,mt,yt,Qt,Ht){for(var ae,ge=Ht[0],de=Ht[240],Ze=function(Qe,Ne){var ze,We,ri,hi,Ti,fe,Ni,Di,mi,Gi,le=0;for(mi=0;mi<8;++mi){ze=Qe[le],We=Qe[le+1],ri=Qe[le+2],hi=Qe[le+3],Ti=Qe[le+4],fe=Qe[le+5],Ni=Qe[le+6];var gi=ze+(Di=Qe[le+7]),Ke=ze-Di,or=We+Ni,Ki=We-Ni,ii=ri+fe,br=ri-fe,Ji=hi+Ti,wr=hi-Ti,ar=gi+Ji,wt=gi-Ji,W=or+ii,X=or-ii;Qe[le]=ar+W,Qe[le+4]=ar-W;var rt=.707106781*(X+wt);Qe[le+2]=wt+rt,Qe[le+6]=wt-rt;var ft=.382683433*((ar=wr+br)-(X=Ki+Ke)),Mt=.5411961*ar+ft,Vt=1.306562965*X+ft,Yt=.707106781*(W=br+Ki),Rt=Ke+Yt,Wt=Ke-Yt;Qe[le+5]=Wt+Mt,Qe[le+3]=Wt-Mt,Qe[le+1]=Rt+Vt,Qe[le+7]=Rt-Vt,le+=8}for(le=0,mi=0;mi<8;++mi){ze=Qe[le],We=Qe[le+8],ri=Qe[le+16],hi=Qe[le+24],Ti=Qe[le+32],fe=Qe[le+40],Ni=Qe[le+48];var be=ze+(Di=Qe[le+56]),he=ze-Di,Le=We+Ni,je=We-Ni,ti=ri+fe,_i=ri-fe,$i=hi+Ti,xi=hi-Ti,zi=be+$i,hr=be-$i,fr=Le+ti,Hi=Le-ti;Qe[le]=zi+fr,Qe[le+32]=zi-fr;var Wi=.707106781*(Hi+hr);Qe[le+16]=hr+Wi,Qe[le+48]=hr-Wi;var Ar=.382683433*((zi=xi+_i)-(Hi=je+he)),Zt=.5411961*zi+Ar,De=1.306562965*Hi+Ar,Te=.707106781*(fr=_i+je),tr=he+Te,Ui=he-Te;Qe[le+40]=Ui+Zt,Qe[le+24]=Ui-Zt,Qe[le+8]=tr+De,Qe[le+56]=tr-De,le++}for(mi=0;mi<64;++mi)Gi=Qe[mi]*Ne[mi],L[mi]=Gi>0?Gi+.5|0:Gi-.5|0;return L}(j,mt),Re=0;Re<64;++Re)K[xt[Re]]=Ze[Re];var Je=K[0]-yt;yt=K[0],Je==0?qt(Qt[0]):(qt(Qt[G[ae=32767+Je]]),qt(U[ae]));for(var Xe=63;Xe>0&&K[Xe]==0;)Xe--;if(Xe==0)return qt(ge),yt;for(var Kt,Ce=1;Ce<=Xe;){for(var Ut=Ce;K[Ce]==0&&Ce<=Xe;)++Ce;var Ye=Ce-Ut;if(Ye>=16){Kt=Ye>>4;for(var Oe=1;Oe<=Kt;++Oe)qt(de);Ye&=15}ae=32767+K[Ce],qt(Ht[(Ye<<4)+G[ae]]),qt(U[ae]),Ce++}return Xe!=63&&qt(ge),yt}function pe(j){j=Math.min(Math.max(j,1),100),s!=j&&(function(mt){for(var yt=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Qt=0;Qt<64;Qt++){var Ht=d((yt[Qt]*mt+50)/100);Ht=Math.min(Math.max(Ht,1),255),f[xt[Qt]]=Ht}for(var ae=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ge=0;ge<64;ge++){var de=d((ae[ge]*mt+50)/100);de=Math.min(Math.max(de,1),255),I[xt[ge]]=de}for(var Ze=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Re=0,Je=0;Je<8;Je++)for(var Xe=0;Xe<8;Xe++)_[Re]=1/(f[xt[Re]]*Ze[Je]*Ze[Xe]*8),S[Re]=1/(I[xt[Re]]*Ze[Je]*Ze[Xe]*8),Re++}(j<50?Math.floor(5e3/j):Math.floor(200-2*j)),s=j)}this.encode=function(j,mt){mt&&pe(mt),V=new Array,q=0,z=7,vt(65496),vt(65504),vt(16),Xt(74),Xt(70),Xt(73),Xt(70),Xt(0),Xt(1),Xt(1),Xt(0),vt(1),vt(1),Xt(0),Xt(0),function(){vt(65499),vt(132),Xt(0);for(var We=0;We<64;We++)Xt(f[We]);Xt(1);for(var ri=0;ri<64;ri++)Xt(I[ri])}(),function(We,ri){vt(65472),vt(17),Xt(8),vt(ri),vt(We),Xt(3),Xt(1),Xt(17),Xt(0),Xt(2),Xt(17),Xt(1),Xt(3),Xt(17),Xt(1)}(j.width,j.height),function(){vt(65476),vt(418),Xt(0);for(var We=0;We<16;We++)Xt(It[We+1]);for(var ri=0;ri<=11;ri++)Xt(Nt[ri]);Xt(16);for(var hi=0;hi<16;hi++)Xt(ie[hi+1]);for(var Ti=0;Ti<=161;Ti++)Xt(lt[Ti]);Xt(1);for(var fe=0;fe<16;fe++)Xt(at[fe+1]);for(var Ni=0;Ni<=11;Ni++)Xt(St[Ni]);Xt(17);for(var Di=0;Di<16;Di++)Xt(Bt[Di+1]);for(var mi=0;mi<=161;mi++)Xt(se[mi])}(),vt(65498),vt(12),Xt(3),Xt(1),Xt(0),Xt(2),Xt(17),Xt(3),Xt(17),Xt(0),Xt(63),Xt(0);var yt=0,Qt=0,Ht=0;q=0,z=7,this.encode.displayName="_encode_";for(var ae,ge,de,Ze,Re,Je,Xe,Kt,Ce,Ut=j.data,Ye=j.width,Oe=j.height,Qe=4*Ye,Ne=0;Ne<Oe;){for(ae=0;ae<Qe;){for(Re=Qe*Ne+ae,Xe=-1,Kt=0,Ce=0;Ce<64;Ce++)Je=Re+(Kt=Ce>>3)*Qe+(Xe=4*(7&Ce)),Ne+Kt>=Oe&&(Je-=Qe*(Ne+1+Kt-Oe)),ae+Xe>=Qe&&(Je-=ae+Xe-Qe+4),ge=Ut[Je++],de=Ut[Je++],Ze=Ut[Je++],it[Ce]=(Et[ge]+Et[de+256>>0]+Et[Ze+512>>0]>>16)-128,At[Ce]=(Et[ge+768>>0]+Et[de+1024>>0]+Et[Ze+1280>>0]>>16)-128,_t[Ce]=(Et[ge+1280>>0]+Et[de+1536>>0]+Et[Ze+1792>>0]>>16)-128;yt=Tt(it,_,yt,t,o),Qt=Tt(At,S,Qt,r,A),Ht=Tt(_t,S,Ht,r,A),ae+=32}Ne+=8}if(z>=0){var ze=[];ze[1]=z+1,ze[0]=(1<<z+1)-1,qt(ze)}return vt(65497),new Uint8Array(V)},n=n||50,function(){for(var j=String.fromCharCode,mt=0;mt<256;mt++)Lt[mt]=j(mt)}(),t=ee(It,Nt),r=ee(at,St),o=ee(ie,lt),A=ee(Bt,se),function(){for(var j=1,mt=2,yt=1;yt<=15;yt++){for(var Qt=j;Qt<mt;Qt++)G[32767+Qt]=yt,U[32767+Qt]=[],U[32767+Qt][1]=yt,U[32767+Qt][0]=Qt;for(var Ht=-(mt-1);Ht<=-j;Ht++)G[32767+Ht]=yt,U[32767+Ht]=[],U[32767+Ht][1]=yt,U[32767+Ht][0]=mt-1+Ht;j<<=1,mt<<=1}}(),function(){for(var j=0;j<256;j++)Et[j]=19595*j,Et[j+256>>0]=38470*j,Et[j+512>>0]=7471*j+32768,Et[j+768>>0]=-11059*j,Et[j+1024>>0]=-21709*j,Et[j+1280>>0]=32768*j+8421375,Et[j+1536>>0]=-27439*j,Et[j+1792>>0]=-5329*j}(),pe(n)}function mA(n,t){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Z5(n){function t(It){if(!It)throw Error("assert :P")}function r(It,Nt,ie){for(var lt=0;4>lt;lt++)if(It[Nt+lt]!=ie.charCodeAt(lt))return!0;return!1}function o(It,Nt,ie,lt,at){for(var St=0;St<at;St++)It[Nt+St]=ie[lt+St]}function A(It,Nt,ie,lt){for(var at=0;at<lt;at++)It[Nt+at]=ie}function s(It){return new Int32Array(It)}function d(It,Nt){for(var ie=[],lt=0;lt<It;lt++)ie.push(new Nt);return ie}function f(It,Nt){var ie=[];return function lt(at,St,Bt){for(var se=Bt[St],ee=0;ee<se&&(at.push(Bt.length>St+1?[]:new Nt),!(Bt.length<St+1));ee++)lt(at[ee],St+1,Bt)}(ie,0,It),ie}var I=function(){var It=this;function Nt(u,g){for(var y=1<<g-1>>>0;u&y;)y>>>=1;return y?(u&y-1)+y:u}function ie(u,g,y,x,k){t(!(x%y));do u[g+(x-=y)]=k;while(0<x)}function lt(u,g,y,x,k){if(t(2328>=k),512>=k)var E=s(512);else if((E=s(k))==null)return 0;return function(R,P,H,N,O,et){var nt,Y,dt=P,gt=1<<H,ot=s(16),pt=s(16);for(t(O!=0),t(N!=null),t(R!=null),t(0<H),Y=0;Y<O;++Y){if(15<N[Y])return 0;++ot[N[Y]]}if(ot[0]==O)return 0;for(pt[1]=0,nt=1;15>nt;++nt){if(ot[nt]>1<<nt)return 0;pt[nt+1]=pt[nt]+ot[nt]}for(Y=0;Y<O;++Y)nt=N[Y],0<N[Y]&&(et[pt[nt]++]=Y);if(pt[15]==1)return(N=new at).g=0,N.value=et[0],ie(R,dt,1,gt,N),gt;var Dt,$t=-1,jt=gt-1,ue=0,ce=1,Fe=1,xe=1<<H;for(Y=0,nt=1,O=2;nt<=H;++nt,O<<=1){if(ce+=Fe<<=1,0>(Fe-=ot[nt]))return 0;for(;0<ot[nt];--ot[nt])(N=new at).g=nt,N.value=et[Y++],ie(R,dt+ue,O,xe,N),ue=Nt(ue,nt)}for(nt=H+1,O=2;15>=nt;++nt,O<<=1){if(ce+=Fe<<=1,0>(Fe-=ot[nt]))return 0;for(;0<ot[nt];--ot[nt]){if(N=new at,(ue&jt)!=$t){for(dt+=xe,Dt=1<<($t=nt)-H;15>$t&&!(0>=(Dt-=ot[$t]));)++$t,Dt<<=1;gt+=xe=1<<(Dt=$t-H),R[P+($t=ue&jt)].g=Dt+H,R[P+$t].value=dt-P-$t}N.g=nt-H,N.value=et[Y++],ie(R,dt+(ue>>H),O,xe,N),ue=Nt(ue,nt)}}return ce!=2*pt[15]-1?0:gt}(u,g,y,x,k,E)}function at(){this.value=this.g=0}function St(){this.value=this.g=0}function Bt(){this.G=d(5,at),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=d(kn,St)}function se(u,g,y,x){t(u!=null),t(g!=null),t(2147483648>x),u.Ca=254,u.I=0,u.b=-8,u.Ka=0,u.oa=g,u.pa=y,u.Jd=g,u.Yc=y+x,u.Zc=4<=x?y+x-4+1:y,ae(u)}function ee(u,g){for(var y=0;0<g--;)y|=de(u,128)<<g;return y}function qt(u,g){var y=ee(u,g);return ge(u)?-y:y}function Xt(u,g,y,x){var k,E=0;for(t(u!=null),t(g!=null),t(4294967288>x),u.Sb=x,u.Ra=0,u.u=0,u.h=0,4<x&&(x=4),k=0;k<x;++k)E+=g[y+k]<<8*k;u.Ra=E,u.bb=x,u.oa=g,u.pa=y}function vt(u){for(;8<=u.u&&u.bb<u.Sb;)u.Ra>>>=8,u.Ra+=u.oa[u.pa+u.bb]<<jo-8>>>0,++u.bb,u.u-=8;yt(u)&&(u.h=1,u.u=0)}function Tt(u,g){if(t(0<=g),!u.h&&g<=Ps){var y=mt(u)&ya[g];return u.u+=g,vt(u),y}return u.h=1,u.u=0}function pe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function mt(u){return u.Ra>>>(u.u&jo-1)>>>0}function yt(u){return t(u.bb<=u.Sb),u.h||u.bb==u.Sb&&u.u>jo}function Qt(u,g){u.u=g,u.h=yt(u)}function Ht(u){u.u>=ba&&(t(u.u>=ba),vt(u))}function ae(u){t(u!=null&&u.oa!=null),u.pa<u.Zc?(u.I=(u.oa[u.pa++]|u.I<<8)>>>0,u.b+=8):(t(u!=null&&u.oa!=null),u.pa<u.Yc?(u.b+=8,u.I=u.oa[u.pa++]|u.I<<8):u.Ka?u.b=0:(u.I<<=8,u.b+=8,u.Ka=1))}function ge(u){return ee(u,1)}function de(u,g){var y=u.Ca;0>u.b&&ae(u);var x=u.b,k=y*g>>>8,E=(u.I>>>x>k)+0;for(E?(y-=k,u.I-=k+1<<x>>>0):y=k+1,x=y,k=0;256<=x;)k+=8,x>>=8;return x=7^k+Bn[x],u.b-=x,u.Ca=(y<<x)-1,E}function Ze(u,g,y){u[g+0]=y>>24&255,u[g+1]=y>>16&255,u[g+2]=y>>8&255,u[g+3]=y>>0&255}function Re(u,g){return u[g+0]<<0|u[g+1]<<8}function Je(u,g){return Re(u,g)|u[g+2]<<16}function Xe(u,g){return Re(u,g)|Re(u,g+2)<<16}function Kt(u,g){var y=1<<g;return t(u!=null),t(0<g),u.X=s(y),u.X==null?0:(u.Mb=32-g,u.Xa=g,1)}function Ce(u,g){t(u!=null),t(g!=null),t(u.Xa==g.Xa),o(g.X,0,u.X,0,1<<g.Xa)}function Ut(){this.X=[],this.Xa=this.Mb=0}function Ye(u,g,y,x){t(y!=null),t(x!=null);var k=y[0],E=x[0];return k==0&&(k=(u*E+g/2)/g),E==0&&(E=(g*k+u/2)/u),0>=k||0>=E?0:(y[0]=k,x[0]=E,1)}function Oe(u,g){return u+(1<<g)-1>>>g}function Qe(u,g){return((4278255360&u)+(4278255360&g)>>>0&4278255360)+((16711935&u)+(16711935&g)>>>0&16711935)>>>0}function Ne(u,g){It[g]=function(y,x,k,E,R,P,H){var N;for(N=0;N<R;++N){var O=It[u](P[H+N-1],k,E+N);P[H+N]=Qe(y[x+N],O)}}}function ze(){this.ud=this.hd=this.jd=0}function We(u,g){return((4278124286&(u^g))>>>1)+(u&g)>>>0}function ri(u){return 0<=u&&256>u?u:0>u?0:255<u?255:void 0}function hi(u,g){return ri(u+(u-g+.5>>1))}function Ti(u,g,y){return Math.abs(g-y)-Math.abs(u-y)}function fe(u,g,y,x,k,E,R){for(x=E[R-1],y=0;y<k;++y)E[R+y]=x=Qe(u[g+y],x)}function Ni(u,g,y,x,k){var E;for(E=0;E<y;++E){var R=u[g+E],P=R>>8&255,H=16711935&(H=(H=16711935&R)+((P<<16)+P));x[k+E]=(4278255360&R)+H>>>0}}function Di(u,g){g.jd=u>>0&255,g.hd=u>>8&255,g.ud=u>>16&255}function mi(u,g,y,x,k,E){var R;for(R=0;R<x;++R){var P=g[y+R],H=P>>>8,N=P,O=255&(O=(O=P>>>16)+((u.jd<<24>>24)*(H<<24>>24)>>>5));N=255&(N=(N=N+((u.hd<<24>>24)*(H<<24>>24)>>>5))+((u.ud<<24>>24)*(O<<24>>24)>>>5)),k[E+R]=(4278255360&P)+(O<<16)+N}}function Gi(u,g,y,x,k){It[g]=function(E,R,P,H,N,O,et,nt,Y){for(H=et;H<nt;++H)for(et=0;et<Y;++et)N[O++]=k(P[x(E[R++])])},It[u]=function(E,R,P,H,N,O,et){var nt=8>>E.b,Y=E.Ea,dt=E.K[0],gt=E.w;if(8>nt)for(E=(1<<E.b)-1,gt=(1<<nt)-1;R<P;++R){var ot,pt=0;for(ot=0;ot<Y;++ot)ot&E||(pt=x(H[N++])),O[et++]=k(dt[pt&gt]),pt>>=nt}else It["VP8LMapColor"+y](H,N,dt,gt,O,et,R,P,Y)}}function le(u,g,y,x,k){for(y=g+y;g<y;){var E=u[g++];x[k++]=E>>16&255,x[k++]=E>>8&255,x[k++]=E>>0&255}}function gi(u,g,y,x,k){for(y=g+y;g<y;){var E=u[g++];x[k++]=E>>16&255,x[k++]=E>>8&255,x[k++]=E>>0&255,x[k++]=E>>24&255}}function Ke(u,g,y,x,k){for(y=g+y;g<y;){var E=(R=u[g++])>>16&240|R>>12&15,R=R>>0&240|R>>28&15;x[k++]=E,x[k++]=R}}function or(u,g,y,x,k){for(y=g+y;g<y;){var E=(R=u[g++])>>16&248|R>>13&7,R=R>>5&224|R>>3&31;x[k++]=E,x[k++]=R}}function Ki(u,g,y,x,k){for(y=g+y;g<y;){var E=u[g++];x[k++]=E>>0&255,x[k++]=E>>8&255,x[k++]=E>>16&255}}function ii(u,g,y,x,k,E){if(E==0)for(y=g+y;g<y;)Ze(x,((E=u[g++])[0]>>24|E[1]>>8&65280|E[2]<<8&16711680|E[3]<<24)>>>0),k+=32;else o(x,k,u,g,y)}function br(u,g){It[g][0]=It[u+"0"],It[g][1]=It[u+"1"],It[g][2]=It[u+"2"],It[g][3]=It[u+"3"],It[g][4]=It[u+"4"],It[g][5]=It[u+"5"],It[g][6]=It[u+"6"],It[g][7]=It[u+"7"],It[g][8]=It[u+"8"],It[g][9]=It[u+"9"],It[g][10]=It[u+"10"],It[g][11]=It[u+"11"],It[g][12]=It[u+"12"],It[g][13]=It[u+"13"],It[g][14]=It[u+"0"],It[g][15]=It[u+"0"]}function Ji(u){return u==Ml||u==ll||u==cl||u==ul}function wr(){this.eb=[],this.size=this.A=this.fb=0}function ar(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function wt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new wr,this.f.kb=new ar,this.sd=null}function W(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function X(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function rt(u){return alert("todo:WebPSamplerProcessPlane"),u.T}function ft(u,g){var y=u.T,x=g.ba.f.RGBA,k=x.eb,E=x.fb+u.ka*x.A,R=ls[g.ba.S],P=u.y,H=u.O,N=u.f,O=u.N,et=u.ea,nt=u.W,Y=g.cc,dt=g.dc,gt=g.Mc,ot=g.Nc,pt=u.ka,Dt=u.ka+u.T,$t=u.U,jt=$t+1>>1;for(pt==0?R(P,H,null,null,N,O,et,nt,N,O,et,nt,k,E,null,null,$t):(R(g.ec,g.fc,P,H,Y,dt,gt,ot,N,O,et,nt,k,E-x.A,k,E,$t),++y);pt+2<Dt;pt+=2)Y=N,dt=O,gt=et,ot=nt,O+=u.Rc,nt+=u.Rc,E+=2*x.A,R(P,(H+=2*u.fa)-u.fa,P,H,Y,dt,gt,ot,N,O,et,nt,k,E-x.A,k,E,$t);return H+=u.fa,u.j+Dt<u.o?(o(g.ec,g.fc,P,H,$t),o(g.cc,g.dc,N,O,jt),o(g.Mc,g.Nc,et,nt,jt),y--):1&Dt||R(P,H,null,null,N,O,et,nt,N,O,et,nt,k,E+x.A,null,null,$t),y}function Mt(u,g,y){var x=u.F,k=[u.J];if(x!=null){var E=u.U,R=g.ba.S,P=R==UA||R==cl;g=g.ba.f.RGBA;var H=[0],N=u.ka;H[0]=u.T,u.Kb&&(N==0?--H[0]:(--N,k[0]-=u.width),u.j+u.ka+u.T==u.o&&(H[0]=u.o-u.j-N));var O=g.eb;N=g.fb+N*g.A,u=kA(x,k[0],u.width,E,H,O,N+(P?0:3),g.A),t(y==H),u&&Ji(R)&&Ss(O,N,P,E,H,g.A)}return 0}function Vt(u){var g=u.ma,y=g.ba.S,x=11>y,k=y==EA||y==TA||y==UA||y==uo||y==12||Ji(y);if(g.memory=null,g.Ib=null,g.Jb=null,g.Nd=null,!Ao(g.Oa,u,k?11:12))return 0;if(k&&Ji(y)&&Me(),u.da)alert("todo:use_scaling");else{if(x){if(g.Ib=rt,u.Kb){if(y=u.U+1>>1,g.memory=s(u.U+2*y),g.memory==null)return 0;g.ec=g.memory,g.fc=0,g.cc=g.ec,g.dc=g.fc+u.U,g.Mc=g.cc,g.Nc=g.dc+y,g.Ib=ft,Me()}}else alert("todo:EmitYUV");k&&(g.Jb=Mt,x&&oe())}if(x&&!Dl){for(u=0;256>u;++u)hl[u]=89858*(u-128)+vr>>fo,yi[u]=-22014*(u-128)+vr,Kl[u]=-45773*(u-128),Zo[u]=113618*(u-128)+vr>>fo;for(u=ka;u<La;++u)g=76283*(u-16)+vr>>fo,Zi[u-ka]=os(g,255),v[u-ka]=os(g+8>>4,15);Dl=1}return 1}function Yt(u){var g=u.ma,y=u.U,x=u.T;return t(!(1&u.ka)),0>=y||0>=x?0:(y=g.Ib(u,g),g.Jb!=null&&g.Jb(u,g,y),g.Dc+=y,1)}function Rt(u){u.ma.memory=null}function Wt(u,g,y,x){return Tt(u,8)!=47?0:(g[0]=Tt(u,14)+1,y[0]=Tt(u,14)+1,x[0]=Tt(u,1),Tt(u,3)!=0?0:!u.h)}function be(u,g){if(4>u)return u+1;var y=u-2>>1;return(2+(1&u)<<y)+Tt(g,y)+1}function he(u,g){return 120<g?g-120:1<=(y=((y=ho[g-1])>>4)*u+(8-(15&y)))?y:1;var y}function Le(u,g,y){var x=mt(y),k=u[g+=255&x].g-8;return 0<k&&(Qt(y,y.u+8),x=mt(y),g+=u[g].value,g+=x&(1<<k)-1),Qt(y,y.u+u[g].g),u[g].value}function je(u,g,y){return y.g+=u.g,y.value+=u.value<<g>>>0,t(8>=y.g),u.g}function ti(u,g,y){var x=u.xc;return t((g=x==0?0:u.vc[u.md*(y>>x)+(g>>x)])<u.Wb),u.Ya[g]}function _i(u,g,y,x){var k=u.ab,E=u.c*g,R=u.C;g=R+g;var P=y,H=x;for(x=u.Ta,y=u.Ua;0<k--;){var N=u.gc[k],O=R,et=g,nt=P,Y=H,dt=(H=x,P=y,N.Ea);switch(t(O<et),t(et<=N.nc),N.hc){case 2:qo(nt,Y,(et-O)*dt,H,P);break;case 0:var gt=O,ot=et,pt=H,Dt=P,$t=(xe=N).Ea;gt==0&&(SA(nt,Y,null,null,1,pt,Dt),fe(nt,Y+1,0,0,$t-1,pt,Dt+1),Y+=$t,Dt+=$t,++gt);for(var jt=1<<xe.b,ue=jt-1,ce=Oe($t,xe.b),Fe=xe.K,xe=xe.w+(gt>>xe.b)*ce;gt<ot;){var ke=Fe,Ue=xe,$e=1;for(FA(nt,Y,pt,Dt-$t,1,pt,Dt);$e<$t;){var Li=($e&~ue)+jt;Li>$t&&(Li=$t),(0,Hs[ke[Ue++]>>8&15])(nt,Y+ +$e,pt,Dt+$e-$t,Li-$e,pt,Dt+$e),$e=Li}Y+=$t,Dt+=$t,++gt&ue||(xe+=ce)}et!=N.nc&&o(H,P-dt,H,P+(et-O-1)*dt,dt);break;case 1:for(dt=nt,ot=Y,$t=(nt=N.Ea)-(Dt=nt&~(pt=(Y=1<<N.b)-1)),gt=Oe(nt,N.b),jt=N.K,N=N.w+(O>>N.b)*gt;O<et;){for(ue=jt,ce=N,Fe=new ze,xe=ot+Dt,ke=ot+nt;ot<xe;)Di(ue[ce++],Fe),bs(Fe,dt,ot,Y,H,P),ot+=Y,P+=Y;ot<ke&&(Di(ue[ce++],Fe),bs(Fe,dt,ot,$t,H,P),ot+=$t,P+=$t),++O&pt||(N+=gt)}break;case 3:if(nt==H&&Y==P&&0<N.b){for(ot=H,nt=dt=P+(et-O)*dt-(Dt=(et-O)*Oe(N.Ea,N.b)),Y=H,pt=P,gt=[],Dt=($t=Dt)-1;0<=Dt;--Dt)gt[Dt]=Y[pt+Dt];for(Dt=$t-1;0<=Dt;--Dt)ot[nt+Dt]=gt[Dt];Ln(N,O,et,H,dt,H,P)}else Ln(N,O,et,nt,Y,H,P)}P=x,H=y}H!=y&&o(x,y,P,H,E)}function $i(u,g){var y=u.V,x=u.Ba+u.c*u.C,k=g-u.C;if(t(g<=u.l.o),t(16>=k),0<k){var E=u.l,R=u.Ta,P=u.Ua,H=E.width;if(_i(u,k,y,x),k=P=[P],t((y=u.C)<(x=g)),t(E.v<E.va),x>E.o&&(x=E.o),y<E.j){var N=E.j-y;y=E.j,k[0]+=N*H}if(y>=x?y=0:(k[0]+=4*E.v,E.ka=y-E.j,E.U=E.va-E.v,E.T=x-y,y=1),y){if(P=P[0],11>(y=u.ca).S){var O=y.f.RGBA,et=(x=y.S,k=E.U,E=E.T,N=O.eb,O.A),nt=E;for(O=O.fb+u.Ma*O.A;0<nt--;){var Y=R,dt=P,gt=k,ot=N,pt=O;switch(x){case Fa:Ms(Y,dt,gt,ot,pt);break;case EA:as(Y,dt,gt,ot,pt);break;case Ml:as(Y,dt,gt,ot,pt),Ss(ot,pt,0,gt,1,0);break;case Pl:wa(Y,dt,gt,ot,pt);break;case TA:ii(Y,dt,gt,ot,pt,1);break;case ll:ii(Y,dt,gt,ot,pt,1),Ss(ot,pt,0,gt,1,0);break;case UA:ii(Y,dt,gt,ot,pt,0);break;case cl:ii(Y,dt,gt,ot,pt,0),Ss(ot,pt,1,gt,1,0);break;case uo:vs(Y,dt,gt,ot,pt);break;case ul:vs(Y,dt,gt,ot,pt),xa(ot,pt,gt,1,0);break;case Hl:Ns(Y,dt,gt,ot,pt);break;default:t(0)}P+=H,O+=et}u.Ma+=E}else alert("todo:EmitRescaledRowsYUVA");t(u.Ma<=y.height)}}u.C=g,t(u.C<=u.i)}function xi(u){var g;if(0<u.ua)return 0;for(g=0;g<u.Wb;++g){var y=u.Ya[g].G,x=u.Ya[g].H;if(0<y[1][x[1]+0].g||0<y[2][x[2]+0].g||0<y[3][x[3]+0].g)return 0}return 1}function zi(u,g,y,x,k,E){if(u.Z!=0){var R=u.qd,P=u.rd;for(t(qe[u.Z]!=null);g<y;++g)qe[u.Z](R,P,x,k,x,k,E),R=x,P=k,k+=E;u.qd=R,u.rd=P}}function hr(u,g){var y=u.l.ma,x=y.Z==0||y.Z==1?u.l.j:u.C;if(x=u.C<x?x:u.C,t(g<=u.l.o),g>x){var k=u.l.width,E=y.ca,R=y.tb+k*x,P=u.V,H=u.Ba+u.c*x,N=u.gc;t(u.ab==1),t(N[0].hc==3),va(N[0],x,g,P,H,E,R),zi(y,x,g,E,R,k)}u.C=u.Ma=g}function fr(u,g,y,x,k,E,R){var P=u.$/x,H=u.$%x,N=u.m,O=u.s,et=y+u.$,nt=et;k=y+x*k;var Y=y+x*E,dt=280+O.ua,gt=u.Pb?P:16777216,ot=0<O.ua?O.Wa:null,pt=O.wc,Dt=et<Y?ti(O,H,P):null;t(u.C<E),t(Y<=k);var $t=!1;t:for(;;){for(;$t||et<Y;){var jt=0;if(P>=gt){var ue=et-y;t((gt=u).Pb),gt.wd=gt.m,gt.xd=ue,0<gt.s.ua&&Ce(gt.s.Wa,gt.s.vb),gt=P+go}if(H&pt||(Dt=ti(O,H,P)),t(Dt!=null),Dt.Qb&&(g[et]=Dt.qb,$t=!0),!$t)if(Ht(N),Dt.jc){jt=N,ue=g;var ce=et,Fe=Dt.pd[mt(jt)&kn-1];t(Dt.jc),256>Fe.g?(Qt(jt,jt.u+Fe.g),ue[ce]=Fe.value,jt=0):(Qt(jt,jt.u+Fe.g-256),t(256<=Fe.value),jt=Fe.value),jt==0&&($t=!0)}else jt=Le(Dt.G[0],Dt.H[0],N);if(N.h)break;if($t||256>jt){if(!$t)if(Dt.nd)g[et]=(Dt.qb|jt<<8)>>>0;else{if(Ht(N),$t=Le(Dt.G[1],Dt.H[1],N),Ht(N),ue=Le(Dt.G[2],Dt.H[2],N),ce=Le(Dt.G[3],Dt.H[3],N),N.h)break;g[et]=(ce<<24|$t<<16|jt<<8|ue)>>>0}if($t=!1,++et,++H>=x&&(H=0,++P,R!=null&&P<=E&&!(P%16)&&R(u,P),ot!=null))for(;nt<et;)jt=g[nt++],ot.X[(506832829*jt&4294967295)>>>ot.Mb]=jt}else if(280>jt){if(jt=be(jt-256,N),ue=Le(Dt.G[4],Dt.H[4],N),Ht(N),ue=he(x,ue=be(ue,N)),N.h)break;if(et-y<ue||k-et<jt)break t;for(ce=0;ce<jt;++ce)g[et+ce]=g[et+ce-ue];for(et+=jt,H+=jt;H>=x;)H-=x,++P,R!=null&&P<=E&&!(P%16)&&R(u,P);if(t(et<=k),H&pt&&(Dt=ti(O,H,P)),ot!=null)for(;nt<et;)jt=g[nt++],ot.X[(506832829*jt&4294967295)>>>ot.Mb]=jt}else{if(!(jt<dt))break t;for($t=jt-280,t(ot!=null);nt<et;)jt=g[nt++],ot.X[(506832829*jt&4294967295)>>>ot.Mb]=jt;jt=et,t(!($t>>>(ue=ot).Xa)),g[jt]=ue.X[$t],$t=!0}$t||t(N.h==yt(N))}if(u.Pb&&N.h&&et<k)t(u.m.h),u.a=5,u.m=u.wd,u.$=u.xd,0<u.s.ua&&Ce(u.s.vb,u.s.Wa);else{if(N.h)break t;R?.(u,P>E?E:P),u.a=0,u.$=et-y}return 1}return u.a=3,0}function Hi(u){t(u!=null),u.vc=null,u.yc=null,u.Ya=null;var g=u.Wa;g!=null&&(g.X=null),u.vb=null,t(u!=null)}function Wi(){var u=new bc;return u==null?null:(u.a=0,u.xb=Sc,br("Predictor","VP8LPredictors"),br("Predictor","VP8LPredictors_C"),br("PredictorAdd","VP8LPredictorsAdd"),br("PredictorAdd","VP8LPredictorsAdd_C"),qo=Ni,bs=mi,Ms=le,as=gi,vs=Ke,Ns=or,wa=Ki,It.VP8LMapColor32b=Wa,It.VP8LMapColor8b=dr,u)}function Ar(u,g,y,x,k){var E=1,R=[u],P=[g],H=x.m,N=x.s,O=null,et=0;t:for(;;){if(y)for(;E&&Tt(H,1);){var nt=R,Y=P,dt=x,gt=1,ot=dt.m,pt=dt.gc[dt.ab],Dt=Tt(ot,2);if(dt.Oc&1<<Dt)E=0;else{switch(dt.Oc|=1<<Dt,pt.hc=Dt,pt.Ea=nt[0],pt.nc=Y[0],pt.K=[null],++dt.ab,t(4>=dt.ab),Dt){case 0:case 1:pt.b=Tt(ot,3)+2,gt=Ar(Oe(pt.Ea,pt.b),Oe(pt.nc,pt.b),0,dt,pt.K),pt.K=pt.K[0];break;case 3:var $t,jt=Tt(ot,8)+1,ue=16<jt?0:4<jt?1:2<jt?2:3;if(nt[0]=Oe(pt.Ea,ue),pt.b=ue,$t=gt=Ar(jt,1,0,dt,pt.K)){var ce,Fe=jt,xe=pt,ke=1<<(8>>xe.b),Ue=s(ke);if(Ue==null)$t=0;else{var $e=xe.K[0],Li=xe.w;for(Ue[0]=xe.K[0][0],ce=1;ce<1*Fe;++ce)Ue[ce]=Qe($e[Li+ce],Ue[ce-1]);for(;ce<4*ke;++ce)Ue[ce]=0;xe.K[0]=null,xe.K[0]=Ue,$t=1}}gt=$t;break;case 2:break;default:t(0)}E=gt}}if(R=R[0],P=P[0],E&&Tt(H,1)&&!(E=1<=(et=Tt(H,4))&&11>=et)){x.a=3;break t}var pi;if(pi=E)e:{var bi,Ci,mr,Jr=x,Yi=R,Rr=P,rr=et,Lr=y,Er=Jr.m,Tr=Jr.s,rn=[null],_n=1,Tn=0,On=_c[rr];i:for(;;){if(Lr&&Tt(Er,1)){var gn=Tt(Er,3)+2,mo=Oe(Yi,gn),nn=Oe(Rr,gn),Wn=mo*nn;if(!Ar(mo,nn,0,Jr,rn))break i;for(rn=rn[0],Tr.xc=gn,bi=0;bi<Wn;++bi){var es=rn[bi]>>8&65535;rn[bi]=es,es>=_n&&(_n=es+1)}}if(Er.h)break i;for(Ci=0;5>Ci;++Ci){var Gr=QA[Ci];!Ci&&0<rr&&(Gr+=1<<rr),Tn<Gr&&(Tn=Gr)}var xn=d(_n*On,at),Un=_n,yn=d(Un,Bt);if(yn==null)var Zr=null;else t(65536>=Un),Zr=yn;var Po=s(Tn);if(Zr==null||Po==null||xn==null){Jr.a=1;break i}var GA=xn;for(bi=mr=0;bi<_n;++bi){var xr=Zr[bi],Ya=xr.G,ra=xr.H,gl=0,Co=1,Ec=0;for(Ci=0;5>Ci;++Ci){Gr=QA[Ci],Ya[Ci]=GA,ra[Ci]=mr,!Ci&&0<rr&&(Gr+=1<<rr);n:{var ZA,dl=Gr,PA=Jr,Ea=Po,HA=GA,ed=mr,Tc=0,na=PA.m,pl=Tt(na,1);if(A(Ea,0,0,dl),pl){var gu=Tt(na,1)+1,id=Tt(na,1),_h=Tt(na,id==0?1:8);Ea[_h]=1,gu==2&&(Ea[_h=Tt(na,8)]=1);var du=1}else{var pu=s(19),zl=Tt(na,4)+4;if(19<zl){PA.a=3;var ja=0;break n}for(ZA=0;ZA<zl;++ZA)pu[Vs[ZA]]=Tt(na,3);var sa=void 0,ks=void 0,qa=PA,rd=pu,Ta=dl,nd=Ea,fu=0,Pr=qa.m,mu=8,xh=d(128,at);r:for(;lt(xh,0,7,rd,19);){if(Tt(Pr,1)){var fl=2+2*Tt(Pr,3);if((sa=2+Tt(Pr,fl))>Ta)break r}else sa=Ta;for(ks=0;ks<Ta&&sa--;){Ht(Pr);var MA=xh[0+(127&mt(Pr))];Qt(Pr,Pr.u+MA.g);var $a=MA.value;if(16>$a)nd[ks++]=$a,$a!=0&&(mu=$a);else{var Sh=$a==16,Fh=$a-16,pm=Bc[Fh],kh=Tt(Pr,wc[Fh])+pm;if(ks+kh>Ta)break r;for(var fm=Sh?mu:0;0<kh--;)nd[ks++]=fm}}fu=1;break r}fu||(qa.a=3),du=fu}(du=du&&!na.h)&&(Tc=lt(HA,ed,8,Ea,dl)),du&&Tc!=0?ja=Tc:(PA.a=3,ja=0)}if(ja==0)break i;if(Co&&lu[Ci]==1&&(Co=GA[mr].g==0),gl+=GA[mr].g,mr+=ja,3>=Ci){var ml,Lh=Po[0];for(ml=1;ml<Gr;++ml)Po[ml]>Lh&&(Lh=Po[ml]);Ec+=Lh}}if(xr.nd=Co,xr.Qb=0,Co&&(xr.qb=(Ya[3][ra[3]+0].value<<24|Ya[1][ra[1]+0].value<<16|Ya[2][ra[2]+0].value)>>>0,gl==0&&256>Ya[0][ra[0]+0].value&&(xr.Qb=1,xr.qb+=Ya[0][ra[0]+0].value<<8)),xr.jc=!xr.Qb&&6>Ec,xr.jc){var Ol,Ua=xr;for(Ol=0;Ol<kn;++Ol){var tA=Ol,Io=Ua.pd[tA],Cu=Ua.G[0][Ua.H[0]+tA];256<=Cu.value?(Io.g=Cu.g+256,Io.value=Cu.value):(Io.g=0,Io.value=0,tA>>=je(Cu,8,Io),tA>>=je(Ua.G[1][Ua.H[1]+tA],16,Io),tA>>=je(Ua.G[2][Ua.H[2]+tA],0,Io),je(Ua.G[3][Ua.H[3]+tA],24,Io))}}}Tr.vc=rn,Tr.Wb=_n,Tr.Ya=Zr,Tr.yc=xn,pi=1;break e}pi=0}if(!(E=pi)){x.a=3;break t}if(0<et){if(N.ua=1<<et,!Kt(N.Wa,et)){x.a=1,E=0;break t}}else N.ua=0;var Cl=x,Uc=R,Iu=P,yu=Cl.s,bu=yu.xc;if(Cl.c=Uc,Cl.i=Iu,yu.md=Oe(Uc,bu),yu.wc=bu==0?-1:(1<<bu)-1,y){x.xb=Go;break t}if((O=s(R*P))==null){x.a=1,E=0;break t}E=(E=fr(x,O,0,R,P,P,null))&&!H.h;break t}return E?(k!=null?k[0]=O:(t(O==null),t(y)),x.$=0,y||Hi(N)):Hi(N),E}function Zt(u,g){var y=u.c*u.i,x=y+g+16*g;return t(u.c<=g),u.V=s(x),u.V==null?(u.Ta=null,u.Ua=0,u.a=1,0):(u.Ta=u.V,u.Ua=u.Ba+y+g,1)}function De(u,g){var y=u.C,x=g-y,k=u.V,E=u.Ba+u.c*y;for(t(g<=u.l.o);0<x;){var R=16<x?16:x,P=u.l.ma,H=u.l.width,N=H*R,O=P.ca,et=P.tb+H*y,nt=u.Ta,Y=u.Ua;_i(u,R,k,E),vc(nt,Y,O,et,N),zi(P,y,y+R,O,et,H),x-=R,k+=R*u.c,y+=R}t(y==g),u.C=u.Ma=g}function Te(){this.ub=this.yd=this.td=this.Rb=0}function tr(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ui(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function an(){this.Yb=function(){var u=[];return function g(y,x,k){for(var E=k[x],R=0;R<E&&(y.push(k.length>x+1?[]:0),!(k.length<x+1));R++)g(y[R],x+1,k)}(u,0,[3,11]),u}()}function Fr(){this.jb=s(3),this.Wc=f([4,8],an),this.Xc=f([4,17],an)}function $r(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Ir(){this.ld=this.La=this.dd=this.tc=0}function hn(){this.Na=this.la=0}function pn(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function An(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function pa(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ir),this.Y=0,this.ya=Array(new An),this.aa=0,this.l=new vn}function Rs(){this.y=s(16),this.f=s(8),this.ea=s(8)}function Or(){this.cb=this.a=0,this.sc="",this.m=new pe,this.Od=new Te,this.Kc=new tr,this.ed=new $r,this.Qa=new Ui,this.Ic=this.$c=this.Aa=0,this.D=new pa,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=d(8,pe),this.ia=0,this.pb=d(4,pn),this.Pa=new Fr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Rs),this.Hd=0,this.rb=Array(new hn),this.sb=0,this.wa=Array(new Ir),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new An),this.L=this.aa=0,this.gd=f([4,2],Ir),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function vn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function io(){var u=new Or;return u!=null&&(u.a=0,u.sc="OK",u.cb=0,u.Xb=0,Ja||(Ja=no)),u}function ir(u,g,y){return u.a==0&&(u.a=g,u.sc=y,u.cb=0),0}function ro(u,g,y){return 3<=y&&u[g+0]==157&&u[g+1]==1&&u[g+2]==42}function wn(u,g){if(u==null)return 0;if(u.a=0,u.sc="OK",g==null)return ir(u,2,"null VP8Io passed to VP8GetHeaders()");var y=g.data,x=g.w,k=g.ha;if(4>k)return ir(u,7,"Truncated header.");var E=y[x+0]|y[x+1]<<8|y[x+2]<<16,R=u.Od;if(R.Rb=!(1&E),R.td=E>>1&7,R.yd=E>>4&1,R.ub=E>>5,3<R.td)return ir(u,3,"Incorrect keyframe parameters.");if(!R.yd)return ir(u,4,"Frame not displayable.");x+=3,k-=3;var P=u.Kc;if(R.Rb){if(7>k)return ir(u,7,"cannot parse picture header");if(!ro(y,x,k))return ir(u,3,"Bad code word");P.c=16383&(y[x+4]<<8|y[x+3]),P.Td=y[x+4]>>6,P.i=16383&(y[x+6]<<8|y[x+5]),P.Ud=y[x+6]>>6,x+=7,k-=7,u.za=P.c+15>>4,u.Ub=P.i+15>>4,g.width=P.c,g.height=P.i,g.Da=0,g.j=0,g.v=0,g.va=g.width,g.o=g.height,g.da=0,g.ib=g.width,g.hb=g.height,g.U=g.width,g.T=g.height,A((E=u.Pa).jb,0,255,E.jb.length),t((E=u.Qa)!=null),E.Cb=0,E.Bb=0,E.Fb=1,A(E.Zb,0,0,E.Zb.length),A(E.Lb,0,0,E.Lb)}if(R.ub>k)return ir(u,7,"bad partition length");se(E=u.m,y,x,R.ub),x+=R.ub,k-=R.ub,R.Rb&&(P.Ld=ge(E),P.Kd=ge(E)),P=u.Qa;var H,N=u.Pa;if(t(E!=null),t(P!=null),P.Cb=ge(E),P.Cb){if(P.Bb=ge(E),ge(E)){for(P.Fb=ge(E),H=0;4>H;++H)P.Zb[H]=ge(E)?qt(E,7):0;for(H=0;4>H;++H)P.Lb[H]=ge(E)?qt(E,6):0}if(P.Bb)for(H=0;3>H;++H)N.jb[H]=ge(E)?ee(E,8):255}else P.Bb=0;if(E.Ka)return ir(u,3,"cannot parse segment header");if((P=u.ed).zd=ge(E),P.Tb=ee(E,6),P.wb=ee(E,3),P.Pc=ge(E),P.Pc&&ge(E)){for(N=0;4>N;++N)ge(E)&&(P.vd[N]=qt(E,6));for(N=0;4>N;++N)ge(E)&&(P.od[N]=qt(E,6))}if(u.L=P.Tb==0?0:P.zd?1:2,E.Ka)return ir(u,3,"cannot parse filter header");var O=k;if(k=H=x,x=H+O,P=O,u.Xb=(1<<ee(u.m,2))-1,O<3*(N=u.Xb))y=7;else{for(H+=3*N,P-=3*N,O=0;O<N;++O){var et=y[k+0]|y[k+1]<<8|y[k+2]<<16;et>P&&(et=P),se(u.Jc[+O],y,H,et),H+=et,P-=et,k+=3}se(u.Jc[+N],y,H,P),y=H<x?0:5}if(y!=0)return ir(u,y,"cannot parse partitions");for(y=ee(H=u.m,7),k=ge(H)?qt(H,4):0,x=ge(H)?qt(H,4):0,P=ge(H)?qt(H,4):0,N=ge(H)?qt(H,4):0,H=ge(H)?qt(H,4):0,O=u.Qa,et=0;4>et;++et){if(O.Cb){var nt=O.Zb[et];O.Fb||(nt+=y)}else{if(0<et){u.pb[et]=u.pb[0];continue}nt=y}var Y=u.pb[et];Y.Sc[0]=po[os(nt+k,127)],Y.Sc[1]=xc[os(nt+0,127)],Y.Eb[0]=2*po[os(nt+x,127)],Y.Eb[1]=101581*xc[os(nt+P,127)]>>16,8>Y.Eb[1]&&(Y.Eb[1]=8),Y.Qc[0]=po[os(nt+N,117)],Y.Qc[1]=xc[os(nt+H,127)],Y.lc=nt+H}if(!R.Rb)return ir(u,4,"Not a key frame.");for(ge(E),R=u.Pa,y=0;4>y;++y){for(k=0;8>k;++k)for(x=0;3>x;++x)for(P=0;11>P;++P)N=de(E,Ai[y][k][x][P])?ee(E,8):RA[y][k][x][P],R.Wc[y][k].Yb[x][P]=N;for(k=0;17>k;++k)R.Xc[y][k]=R.Wc[y][cu[k]]}return u.kc=ge(E),u.kc&&(u.Bd=ee(E,8)),u.cb=1}function no(u,g,y,x,k,E,R){var P=g[k].Yb[y];for(y=0;16>k;++k){if(!de(u,P[y+0]))return k;for(;!de(u,P[y+1]);)if(P=g[++k].Yb[0],y=0,k==16)return 16;var H=g[k+1].Yb;if(de(u,P[y+2])){var N=u,O=0;if(de(N,(nt=P)[(et=y)+3]))if(de(N,nt[et+6])){for(P=0,et=2*(O=de(N,nt[et+8]))+(nt=de(N,nt[et+9+O])),O=0,nt=vh[et];nt[P];++P)O+=O+de(N,nt[P]);O+=3+(8<<et)}else de(N,nt[et+7])?(O=7+2*de(N,165),O+=de(N,145)):O=5+de(N,159);else O=de(N,nt[et+4])?3+de(N,nt[et+5]):2;P=H[2]}else O=1,P=H[1];H=R+wh[k],0>(N=u).b&&ae(N);var et,nt=N.b,Y=(et=N.Ca>>1)-(N.I>>nt)>>31;--N.b,N.Ca+=Y,N.Ca|=1,N.I-=(et+1&Y)<<nt,E[H]=((O^Y)-Y)*x[(0<k)+0]}return 16}function ns(u){var g=u.rb[u.sb-1];g.la=0,g.Na=0,A(u.zc,0,0,u.zc.length),u.ja=0}function ht(u,g){if(u==null)return 0;if(g==null)return ir(u,2,"NULL VP8Io parameter in VP8Decode().");if(!u.cb&&!wn(u,g))return 0;if(t(u.cb),g.ac==null||g.ac(g)){g.ob&&(u.L=0);var y=c[u.L];if(u.L==2?(u.yb=0,u.zb=0):(u.yb=g.v-y>>4,u.zb=g.j-y>>4,0>u.yb&&(u.yb=0),0>u.zb&&(u.zb=0)),u.Va=g.o+15+y>>4,u.Hb=g.va+15+y>>4,u.Hb>u.za&&(u.Hb=u.za),u.Va>u.Ub&&(u.Va=u.Ub),0<u.L){var x=u.ed;for(y=0;4>y;++y){var k;if(u.Qa.Cb){var E=u.Qa.Lb[y];u.Qa.Fb||(E+=x.Tb)}else E=x.Tb;for(k=0;1>=k;++k){var R=u.gd[y][k],P=E;if(x.Pc&&(P+=x.vd[0],k&&(P+=x.od[0])),0<(P=0>P?0:63<P?63:P)){var H=P;0<x.wb&&(H=4<x.wb?H>>2:H>>1)>9-x.wb&&(H=9-x.wb),1>H&&(H=1),R.dd=H,R.tc=2*P+H,R.ld=40<=P?2:15<=P?1:0}else R.tc=0;R.La=k}}}y=0}else ir(u,6,"Frame setup failed"),y=u.a;if(y=y==0){if(y){u.$c=0,0<u.Aa||(u.Ic=m);t:{y=u.Ic,x=4*(H=u.za);var N=32*H,O=H+1,et=0<u.L?H*(0<u.Aa?2:1):0,nt=(u.Aa==2?2:1)*H;if((R=x+832+(k=3*(16*y+c[u.L])/2*N)+(E=u.Fa!=null&&0<u.Fa.length?u.Kc.c*u.Kc.i:0))!=R)y=0;else{if(R>u.Vb){if(u.Vb=0,u.Ec=s(R),u.Fc=0,u.Ec==null){y=ir(u,1,"no memory during frame initialization.");break t}u.Vb=R}R=u.Ec,P=u.Fc,u.Ac=R,u.Bc=P,P+=x,u.Gd=d(N,Rs),u.Hd=0,u.rb=d(O+1,hn),u.sb=1,u.wa=et?d(et,Ir):null,u.Y=0,u.D.Nb=0,u.D.wa=u.wa,u.D.Y=u.Y,0<u.Aa&&(u.D.Y+=H),t(!0),u.oc=R,u.pc=P,P+=832,u.ya=d(nt,An),u.aa=0,u.D.ya=u.ya,u.D.aa=u.aa,u.Aa==2&&(u.D.aa+=H),u.R=16*H,u.B=8*H,H=(N=c[u.L])*u.R,N=N/2*u.B,u.sa=R,u.ta=P+H,u.qa=u.sa,u.ra=u.ta+16*y*u.R+N,u.Ha=u.qa,u.Ia=u.ra+8*y*u.B+N,u.$c=0,P+=k,u.mb=E?R:null,u.nb=E?P:null,t(P+E<=u.Fc+u.Vb),ns(u),A(u.Ac,u.Bc,0,x),y=1}}if(y){if(g.ka=0,g.y=u.sa,g.O=u.ta,g.f=u.qa,g.N=u.ra,g.ea=u.Ha,g.Vd=u.Ia,g.fa=u.R,g.Rc=u.B,g.F=null,g.J=0,!LA){for(y=-255;255>=y;++y)Qr[255+y]=0>y?-y:y;for(y=-1020;1020>=y;++y)Sa[1020+y]=-128>y?-128:127<y?127:y;for(y=-112;112>=y;++y)ts[112+y]=-16>y?-16:15<y?15:y;for(y=-255;510>=y;++y)al[255+y]=0>y?0:255<y?255:y;LA=1}ws=ne,$o=re,As=_e,Bs=Be,lo=Ie,ta=Jt,Ba=vA,ea=Jo,To=Zl,_s=wA,_a=Gl,Vr=Da,xs=ao,kr=nl,_r=Va,en=Oo,Wr=Is,co=yc,Ds[0]=yr,Ds[1]=ve,Ds[2]=Br,Ds[3]=ln,Ds[4]=ss,Ds[5]=zo,Ds[6]=$n,Ds[7]=yA,Ds[8]=Ic,Ds[9]=Ql,Ro[0]=si,Ro[1]=Ri,Ro[2]=Qi,Ro[3]=He,Ro[4]=ci,Ro[5]=Fi,Ro[6]=lr,Fs[0]=Eo,Fs[1]=Ge,Fs[2]=bA,Fs[3]=Ma,Fs[4]=Kn,Fs[5]=rl,Fs[6]=Na,y=1}else y=0}y&&(y=function(Y,dt){for(Y.M=0;Y.M<Y.Va;++Y.M){var gt,ot=Y.Jc[Y.M&Y.Xb],pt=Y.m,Dt=Y;for(gt=0;gt<Dt.za;++gt){var $t=pt,jt=Dt,ue=jt.Ac,ce=jt.Bc+4*gt,Fe=jt.zc,xe=jt.ya[jt.aa+gt];if(jt.Qa.Bb?xe.$b=de($t,jt.Pa.jb[0])?2+de($t,jt.Pa.jb[2]):de($t,jt.Pa.jb[1]):xe.$b=0,jt.kc&&(xe.Ad=de($t,jt.Bd)),xe.Za=!de($t,145)+0,xe.Za){var ke=xe.Ob,Ue=0;for(jt=0;4>jt;++jt){var $e,Li=Fe[0+jt];for($e=0;4>$e;++$e){Li=Qo[ue[ce+$e]][Li];for(var pi=Nl[de($t,Li[0])];0<pi;)pi=Nl[2*pi+de($t,Li[pi])];Li=-pi,ue[ce+$e]=Li}o(ke,Ue,ue,ce,4),Ue+=4,Fe[0+jt]=Li}}else Li=de($t,156)?de($t,128)?1:3:de($t,163)?2:0,xe.Ob[0]=Li,A(ue,ce,Li,4),A(Fe,0,Li,4);xe.Dd=de($t,142)?de($t,114)?de($t,183)?1:3:2:0}if(Dt.m.Ka)return ir(Y,7,"Premature end-of-partition0 encountered.");for(;Y.ja<Y.za;++Y.ja){if(Dt=ot,$t=(pt=Y).rb[pt.sb-1],ue=pt.rb[pt.sb+pt.ja],gt=pt.ya[pt.aa+pt.ja],ce=pt.kc?gt.Ad:0)$t.la=ue.la=0,gt.Za||($t.Na=ue.Na=0),gt.Hc=0,gt.Gc=0,gt.ia=0;else{var bi,Ci;if($t=ue,ue=Dt,ce=pt.Pa.Xc,Fe=pt.ya[pt.aa+pt.ja],xe=pt.pb[Fe.$b],jt=Fe.ad,ke=0,Ue=pt.rb[pt.sb-1],Li=$e=0,A(jt,ke,0,384),Fe.Za)var mr=0,Jr=ce[3];else{pi=s(16);var Yi=$t.Na+Ue.Na;if(Yi=Ja(ue,ce[1],Yi,xe.Eb,0,pi,0),$t.Na=Ue.Na=(0<Yi)+0,1<Yi)ws(pi,0,jt,ke);else{var Rr=pi[0]+3>>3;for(pi=0;256>pi;pi+=16)jt[ke+pi]=Rr}mr=1,Jr=ce[0]}var rr=15&$t.la,Lr=15&Ue.la;for(pi=0;4>pi;++pi){var Er=1&Lr;for(Rr=Ci=0;4>Rr;++Rr)rr=rr>>1|(Er=(Yi=Ja(ue,Jr,Yi=Er+(1&rr),xe.Sc,mr,jt,ke))>mr)<<7,Ci=Ci<<2|(3<Yi?3:1<Yi?2:jt[ke+0]!=0),ke+=16;rr>>=4,Lr=Lr>>1|Er<<7,$e=($e<<8|Ci)>>>0}for(Jr=rr,mr=Lr>>4,bi=0;4>bi;bi+=2){for(Ci=0,rr=$t.la>>4+bi,Lr=Ue.la>>4+bi,pi=0;2>pi;++pi){for(Er=1&Lr,Rr=0;2>Rr;++Rr)Yi=Er+(1&rr),rr=rr>>1|(Er=0<(Yi=Ja(ue,ce[2],Yi,xe.Qc,0,jt,ke)))<<3,Ci=Ci<<2|(3<Yi?3:1<Yi?2:jt[ke+0]!=0),ke+=16;rr>>=2,Lr=Lr>>1|Er<<5}Li|=Ci<<4*bi,Jr|=rr<<4<<bi,mr|=(240&Lr)<<bi}$t.la=Jr,Ue.la=mr,Fe.Hc=$e,Fe.Gc=Li,Fe.ia=43690&Li?0:xe.ia,ce=!($e|Li)}if(0<pt.L&&(pt.wa[pt.Y+pt.ja]=pt.gd[gt.$b][gt.Za],pt.wa[pt.Y+pt.ja].La|=!ce),Dt.Ka)return ir(Y,7,"Premature end-of-file encountered.")}if(ns(Y),pt=dt,Dt=1,gt=(ot=Y).D,$t=0<ot.L&&ot.M>=ot.zb&&ot.M<=ot.Va,ot.Aa==0)t:{if(gt.M=ot.M,gt.uc=$t,Oa(ot,gt),Dt=1,gt=(Ci=ot.D).Nb,$t=(Li=c[ot.L])*ot.R,ue=Li/2*ot.B,pi=16*gt*ot.R,Rr=8*gt*ot.B,ce=ot.sa,Fe=ot.ta-$t+pi,xe=ot.qa,jt=ot.ra-ue+Rr,ke=ot.Ha,Ue=ot.Ia-ue+Rr,Lr=(rr=Ci.M)==0,$e=rr>=ot.Va-1,ot.Aa==2&&Oa(ot,Ci),Ci.uc)for(Er=(Yi=ot).D.M,t(Yi.D.uc),Ci=Yi.yb;Ci<Yi.Hb;++Ci){mr=Ci,Jr=Er;var Tr=(rn=(Gr=Yi).D).Nb;bi=Gr.R;var rn=rn.wa[rn.Y+mr],_n=Gr.sa,Tn=Gr.ta+16*Tr*bi+16*mr,On=rn.dd,gn=rn.tc;if(gn!=0)if(t(3<=gn),Gr.L==1)0<mr&&en(_n,Tn,bi,gn+4),rn.La&&co(_n,Tn,bi,gn),0<Jr&&_r(_n,Tn,bi,gn+4),rn.La&&Wr(_n,Tn,bi,gn);else{var mo=Gr.B,nn=Gr.qa,Wn=Gr.ra+8*Tr*mo+8*mr,es=Gr.Ha,Gr=Gr.Ia+8*Tr*mo+8*mr;Tr=rn.ld,0<mr&&(ea(_n,Tn,bi,gn+4,On,Tr),_s(nn,Wn,es,Gr,mo,gn+4,On,Tr)),rn.La&&(Vr(_n,Tn,bi,gn,On,Tr),kr(nn,Wn,es,Gr,mo,gn,On,Tr)),0<Jr&&(Ba(_n,Tn,bi,gn+4,On,Tr),To(nn,Wn,es,Gr,mo,gn+4,On,Tr)),rn.La&&(_a(_n,Tn,bi,gn,On,Tr),xs(nn,Wn,es,Gr,mo,gn,On,Tr))}}if(ot.ia&&alert("todo:DitherRow"),pt.put!=null){if(Ci=16*rr,rr=16*(rr+1),Lr?(pt.y=ot.sa,pt.O=ot.ta+pi,pt.f=ot.qa,pt.N=ot.ra+Rr,pt.ea=ot.Ha,pt.W=ot.Ia+Rr):(Ci-=Li,pt.y=ce,pt.O=Fe,pt.f=xe,pt.N=jt,pt.ea=ke,pt.W=Ue),$e||(rr-=Li),rr>pt.o&&(rr=pt.o),pt.F=null,pt.J=null,ot.Fa!=null&&0<ot.Fa.length&&Ci<rr&&(pt.J=xA(ot,pt,Ci,rr-Ci),pt.F=ot.mb,pt.F==null&&pt.F.length==0)){Dt=ir(ot,3,"Could not decode alpha data.");break t}Ci<pt.j&&(Li=pt.j-Ci,Ci=pt.j,t(!(1&Li)),pt.O+=ot.R*Li,pt.N+=ot.B*(Li>>1),pt.W+=ot.B*(Li>>1),pt.F!=null&&(pt.J+=pt.width*Li)),Ci<rr&&(pt.O+=pt.v,pt.N+=pt.v>>1,pt.W+=pt.v>>1,pt.F!=null&&(pt.J+=pt.v),pt.ka=Ci-pt.j,pt.U=pt.va-pt.v,pt.T=rr-Ci,Dt=pt.put(pt))}gt+1!=ot.Ic||$e||(o(ot.sa,ot.ta-$t,ce,Fe+16*ot.R,$t),o(ot.qa,ot.ra-ue,xe,jt+8*ot.B,ue),o(ot.Ha,ot.Ia-ue,ke,Ue+8*ot.B,ue))}if(!Dt)return ir(Y,6,"Output aborted.")}return 1}(u,g)),g.bc!=null&&g.bc(g),y&=1}return y?(u.cb=0,y):0}function Ct(u,g,y,x,k){k=u[g+y+32*x]+(k>>3),u[g+y+32*x]=-256&k?0>k?0:255:k}function ct(u,g,y,x,k,E){Ct(u,g,0,y,x+k),Ct(u,g,1,y,x+E),Ct(u,g,2,y,x-E),Ct(u,g,3,y,x-k)}function bt(u){return(20091*u>>16)+u}function Pt(u,g,y,x){var k,E=0,R=s(16);for(k=0;4>k;++k){var P=u[g+0]+u[g+8],H=u[g+0]-u[g+8],N=(35468*u[g+4]>>16)-bt(u[g+12]),O=bt(u[g+4])+(35468*u[g+12]>>16);R[E+0]=P+O,R[E+1]=H+N,R[E+2]=H-N,R[E+3]=P-O,E+=4,g++}for(k=E=0;4>k;++k)P=(u=R[E+0]+4)+R[E+8],H=u-R[E+8],N=(35468*R[E+4]>>16)-bt(R[E+12]),Ct(y,x,0,0,P+(O=bt(R[E+4])+(35468*R[E+12]>>16))),Ct(y,x,1,0,H+N),Ct(y,x,2,0,H-N),Ct(y,x,3,0,P-O),E++,x+=32}function Jt(u,g,y,x){var k=u[g+0]+4,E=35468*u[g+4]>>16,R=bt(u[g+4]),P=35468*u[g+1]>>16;ct(y,x,0,k+R,u=bt(u[g+1]),P),ct(y,x,1,k+E,u,P),ct(y,x,2,k-E,u,P),ct(y,x,3,k-R,u,P)}function re(u,g,y,x,k){Pt(u,g,y,x),k&&Pt(u,g+16,y,x+4)}function _e(u,g,y,x){$o(u,g+0,y,x,1),$o(u,g+32,y,x+128,1)}function Be(u,g,y,x){var k;for(u=u[g+0]+4,k=0;4>k;++k)for(g=0;4>g;++g)Ct(y,x,g,k,u)}function Ie(u,g,y,x){u[g+0]&&Bs(u,g+0,y,x),u[g+16]&&Bs(u,g+16,y,x+4),u[g+32]&&Bs(u,g+32,y,x+128),u[g+48]&&Bs(u,g+48,y,x+128+4)}function ne(u,g,y,x){var k,E=s(16);for(k=0;4>k;++k){var R=u[g+0+k]+u[g+12+k],P=u[g+4+k]+u[g+8+k],H=u[g+4+k]-u[g+8+k],N=u[g+0+k]-u[g+12+k];E[0+k]=R+P,E[8+k]=R-P,E[4+k]=N+H,E[12+k]=N-H}for(k=0;4>k;++k)R=(u=E[0+4*k]+3)+E[3+4*k],P=E[1+4*k]+E[2+4*k],H=E[1+4*k]-E[2+4*k],N=u-E[3+4*k],y[x+0]=R+P>>3,y[x+16]=N+H>>3,y[x+32]=R-P>>3,y[x+48]=N-H>>3,x+=64}function ye(u,g,y){var x,k=g-32,E=En,R=255-u[k-1];for(x=0;x<y;++x){var P,H=E,N=R+u[g-1];for(P=0;P<y;++P)u[g+P]=H[N+u[k+P]];g+=32}}function ve(u,g){ye(u,g,4)}function Ge(u,g){ye(u,g,8)}function Ri(u,g){ye(u,g,16)}function Qi(u,g){var y;for(y=0;16>y;++y)o(u,g+32*y,u,g-32,16)}function He(u,g){var y;for(y=16;0<y;--y)A(u,g,u[g-1],16),g+=32}function Ee(u,g,y){var x;for(x=0;16>x;++x)A(g,y+32*x,u,16)}function si(u,g){var y,x=16;for(y=0;16>y;++y)x+=u[g-1+32*y]+u[g+y-32];Ee(x>>5,u,g)}function ci(u,g){var y,x=8;for(y=0;16>y;++y)x+=u[g-1+32*y];Ee(x>>4,u,g)}function Fi(u,g){var y,x=8;for(y=0;16>y;++y)x+=u[g+y-32];Ee(x>>4,u,g)}function lr(u,g){Ee(128,u,g)}function ai(u,g,y){return u+2*g+y+2>>2}function Br(u,g){var y,x=g-32;for(x=new Uint8Array([ai(u[x-1],u[x+0],u[x+1]),ai(u[x+0],u[x+1],u[x+2]),ai(u[x+1],u[x+2],u[x+3]),ai(u[x+2],u[x+3],u[x+4])]),y=0;4>y;++y)o(u,g+32*y,x,0,x.length)}function ln(u,g){var y=u[g-1],x=u[g-1+32],k=u[g-1+64],E=u[g-1+96];Ze(u,g+0,16843009*ai(u[g-1-32],y,x)),Ze(u,g+32,16843009*ai(y,x,k)),Ze(u,g+64,16843009*ai(x,k,E)),Ze(u,g+96,16843009*ai(k,E,E))}function yr(u,g){var y,x=4;for(y=0;4>y;++y)x+=u[g+y-32]+u[g-1+32*y];for(x>>=3,y=0;4>y;++y)A(u,g+32*y,x,4)}function ss(u,g){var y=u[g-1+0],x=u[g-1+32],k=u[g-1+64],E=u[g-1-32],R=u[g+0-32],P=u[g+1-32],H=u[g+2-32],N=u[g+3-32];u[g+0+96]=ai(x,k,u[g-1+96]),u[g+1+96]=u[g+0+64]=ai(y,x,k),u[g+2+96]=u[g+1+64]=u[g+0+32]=ai(E,y,x),u[g+3+96]=u[g+2+64]=u[g+1+32]=u[g+0+0]=ai(R,E,y),u[g+3+64]=u[g+2+32]=u[g+1+0]=ai(P,R,E),u[g+3+32]=u[g+2+0]=ai(H,P,R),u[g+3+0]=ai(N,H,P)}function $n(u,g){var y=u[g+1-32],x=u[g+2-32],k=u[g+3-32],E=u[g+4-32],R=u[g+5-32],P=u[g+6-32],H=u[g+7-32];u[g+0+0]=ai(u[g+0-32],y,x),u[g+1+0]=u[g+0+32]=ai(y,x,k),u[g+2+0]=u[g+1+32]=u[g+0+64]=ai(x,k,E),u[g+3+0]=u[g+2+32]=u[g+1+64]=u[g+0+96]=ai(k,E,R),u[g+3+32]=u[g+2+64]=u[g+1+96]=ai(E,R,P),u[g+3+64]=u[g+2+96]=ai(R,P,H),u[g+3+96]=ai(P,H,H)}function zo(u,g){var y=u[g-1+0],x=u[g-1+32],k=u[g-1+64],E=u[g-1-32],R=u[g+0-32],P=u[g+1-32],H=u[g+2-32],N=u[g+3-32];u[g+0+0]=u[g+1+64]=E+R+1>>1,u[g+1+0]=u[g+2+64]=R+P+1>>1,u[g+2+0]=u[g+3+64]=P+H+1>>1,u[g+3+0]=H+N+1>>1,u[g+0+96]=ai(k,x,y),u[g+0+64]=ai(x,y,E),u[g+0+32]=u[g+1+96]=ai(y,E,R),u[g+1+32]=u[g+2+96]=ai(E,R,P),u[g+2+32]=u[g+3+96]=ai(R,P,H),u[g+3+32]=ai(P,H,N)}function yA(u,g){var y=u[g+0-32],x=u[g+1-32],k=u[g+2-32],E=u[g+3-32],R=u[g+4-32],P=u[g+5-32],H=u[g+6-32],N=u[g+7-32];u[g+0+0]=y+x+1>>1,u[g+1+0]=u[g+0+64]=x+k+1>>1,u[g+2+0]=u[g+1+64]=k+E+1>>1,u[g+3+0]=u[g+2+64]=E+R+1>>1,u[g+0+32]=ai(y,x,k),u[g+1+32]=u[g+0+96]=ai(x,k,E),u[g+2+32]=u[g+1+96]=ai(k,E,R),u[g+3+32]=u[g+2+96]=ai(E,R,P),u[g+3+64]=ai(R,P,H),u[g+3+96]=ai(P,H,N)}function Ql(u,g){var y=u[g-1+0],x=u[g-1+32],k=u[g-1+64],E=u[g-1+96];u[g+0+0]=y+x+1>>1,u[g+2+0]=u[g+0+32]=x+k+1>>1,u[g+2+32]=u[g+0+64]=k+E+1>>1,u[g+1+0]=ai(y,x,k),u[g+3+0]=u[g+1+32]=ai(x,k,E),u[g+3+32]=u[g+1+64]=ai(k,E,E),u[g+3+64]=u[g+2+64]=u[g+0+96]=u[g+1+96]=u[g+2+96]=u[g+3+96]=E}function Ic(u,g){var y=u[g-1+0],x=u[g-1+32],k=u[g-1+64],E=u[g-1+96],R=u[g-1-32],P=u[g+0-32],H=u[g+1-32],N=u[g+2-32];u[g+0+0]=u[g+2+32]=y+R+1>>1,u[g+0+32]=u[g+2+64]=x+y+1>>1,u[g+0+64]=u[g+2+96]=k+x+1>>1,u[g+0+96]=E+k+1>>1,u[g+3+0]=ai(P,H,N),u[g+2+0]=ai(R,P,H),u[g+1+0]=u[g+3+32]=ai(y,R,P),u[g+1+32]=u[g+3+64]=ai(x,y,R),u[g+1+64]=u[g+3+96]=ai(k,x,y),u[g+1+96]=ai(E,k,x)}function bA(u,g){var y;for(y=0;8>y;++y)o(u,g+32*y,u,g-32,8)}function Ma(u,g){var y;for(y=0;8>y;++y)A(u,g,u[g-1],8),g+=32}function Lo(u,g,y){var x;for(x=0;8>x;++x)A(g,y+32*x,u,8)}function Eo(u,g){var y,x=8;for(y=0;8>y;++y)x+=u[g+y-32]+u[g-1+32*y];Lo(x>>4,u,g)}function rl(u,g){var y,x=4;for(y=0;8>y;++y)x+=u[g+y-32];Lo(x>>3,u,g)}function Kn(u,g){var y,x=4;for(y=0;8>y;++y)x+=u[g-1+32*y];Lo(x>>3,u,g)}function Na(u,g){Lo(128,u,g)}function so(u,g,y){var x=u[g-y],k=u[g+0],E=3*(k-x)+Al[1020+u[g-2*y]-u[g+y]],R=Uo[112+(E+4>>3)];u[g-y]=En[255+x+Uo[112+(E+3>>3)]],u[g+0]=En[255+k-R]}function ur(u,g,y,x){var k=u[g+0],E=u[g+y];return zn[255+u[g-2*y]-u[g-y]]>x||zn[255+E-k]>x}function fa(u,g,y,x){return 4*zn[255+u[g-y]-u[g+0]]+zn[255+u[g-2*y]-u[g+y]]<=x}function Rl(u,g,y,x,k){var E=u[g-3*y],R=u[g-2*y],P=u[g-y],H=u[g+0],N=u[g+y],O=u[g+2*y],et=u[g+3*y];return 4*zn[255+P-H]+zn[255+R-N]>x?0:zn[255+u[g-4*y]-E]<=k&&zn[255+E-R]<=k&&zn[255+R-P]<=k&&zn[255+et-O]<=k&&zn[255+O-N]<=k&&zn[255+N-H]<=k}function Va(u,g,y,x){var k=2*x+1;for(x=0;16>x;++x)fa(u,g+x,y,k)&&so(u,g+x,y)}function Oo(u,g,y,x){var k=2*x+1;for(x=0;16>x;++x)fa(u,g+x*y,1,k)&&so(u,g+x*y,1)}function Is(u,g,y,x){var k;for(k=3;0<k;--k)Va(u,g+=4*y,y,x)}function yc(u,g,y,x){var k;for(k=3;0<k;--k)Oo(u,g+=4,y,x)}function Wo(u,g,y,x,k,E,R,P){for(E=2*E+1;0<k--;){if(Rl(u,g,y,E,R))if(ur(u,g,y,P))so(u,g,y);else{var H=u,N=g,O=y,et=H[N-2*O],nt=H[N-O],Y=H[N+0],dt=H[N+O],gt=H[N+2*O],ot=27*(Dt=Al[1020+3*(Y-nt)+Al[1020+et-dt]])+63>>7,pt=18*Dt+63>>7,Dt=9*Dt+63>>7;H[N-3*O]=En[255+H[N-3*O]+Dt],H[N-2*O]=En[255+et+pt],H[N-O]=En[255+nt+ot],H[N+0]=En[255+Y-ot],H[N+O]=En[255+dt-pt],H[N+2*O]=En[255+gt-Dt]}g+=x}}function oo(u,g,y,x,k,E,R,P){for(E=2*E+1;0<k--;){if(Rl(u,g,y,E,R))if(ur(u,g,y,P))so(u,g,y);else{var H=u,N=g,O=y,et=H[N-O],nt=H[N+0],Y=H[N+O],dt=Uo[112+((gt=3*(nt-et))+4>>3)],gt=Uo[112+(gt+3>>3)],ot=dt+1>>1;H[N-2*O]=En[255+H[N-2*O]+ot],H[N-O]=En[255+et+gt],H[N+0]=En[255+nt-dt],H[N+O]=En[255+Y-ot]}g+=x}}function vA(u,g,y,x,k,E){Wo(u,g,y,1,16,x,k,E)}function Jo(u,g,y,x,k,E){Wo(u,g,1,y,16,x,k,E)}function Gl(u,g,y,x,k,E){var R;for(R=3;0<R;--R)oo(u,g+=4*y,y,1,16,x,k,E)}function Da(u,g,y,x,k,E){var R;for(R=3;0<R;--R)oo(u,g+=4,1,y,16,x,k,E)}function Zl(u,g,y,x,k,E,R,P){Wo(u,g,k,1,8,E,R,P),Wo(y,x,k,1,8,E,R,P)}function wA(u,g,y,x,k,E,R,P){Wo(u,g,1,k,8,E,R,P),Wo(y,x,1,k,8,E,R,P)}function ao(u,g,y,x,k,E,R,P){oo(u,g+4*k,k,1,8,E,R,P),oo(y,x+4*k,k,1,8,E,R,P)}function nl(u,g,y,x,k,E,R,P){oo(u,g+4,1,k,8,E,R,P),oo(y,x+4,1,k,8,E,R,P)}function BA(){this.ba=new wt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new X,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function sl(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function _A(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ma(){this.ua=0,this.Wa=new Ut,this.vb=new Ut,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Bt,this.yc=new at}function bc(){this.xb=this.a=0,this.l=new vn,this.ca=new wt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ma,this.ab=0,this.gc=d(4,_A),this.Oc=0}function Xo(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new vn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Ka(u,g,y,x,k,E,R){for(u=u==null?0:u[g+0],g=0;g<R;++g)k[E+g]=u+y[x+g]&255,u=k[E+g]}function ol(u,g,y,x,k,E,R){var P;if(u==null)Ka(null,null,y,x,k,E,R);else for(P=0;P<R;++P)k[E+P]=u[g+P]+y[x+P]&255}function Yo(u,g,y,x,k,E,R){if(u==null)Ka(null,null,y,x,k,E,R);else{var P,H=u[g+0],N=H,O=H;for(P=0;P<R;++P)N=O+(H=u[g+P])-N,O=y[x+P]+(-256&N?0>N?0:255:N)&255,N=H,k[E+P]=O}}function xA(u,g,y,x){var k=g.width,E=g.o;if(t(u!=null&&g!=null),0>y||0>=x||y+x>E)return null;if(!u.Cc){if(u.ga==null){var R;if(u.ga=new Xo,(R=u.ga==null)||(R=g.width*g.o,t(u.Gb.length==0),u.Gb=s(R),u.Uc=0,u.Gb==null?R=0:(u.mb=u.Gb,u.nb=u.Uc,u.rc=null,R=1),R=!R),!R){R=u.ga;var P=u.Fa,H=u.P,N=u.qc,O=u.mb,et=u.nb,nt=H+1,Y=N-1,dt=R.l;if(t(P!=null&&O!=null&&g!=null),qe[0]=null,qe[1]=Ka,qe[2]=ol,qe[3]=Yo,R.ca=O,R.tb=et,R.c=g.width,R.i=g.height,t(0<R.c&&0<R.i),1>=N)g=0;else if(R.$a=P[H+0]>>0&3,R.Z=P[H+0]>>2&3,R.Lc=P[H+0]>>4&3,H=P[H+0]>>6&3,0>R.$a||1<R.$a||4<=R.Z||1<R.Lc||H)g=0;else if(dt.put=Yt,dt.ac=Vt,dt.bc=Rt,dt.ma=R,dt.width=g.width,dt.height=g.height,dt.Da=g.Da,dt.v=g.v,dt.va=g.va,dt.j=g.j,dt.o=g.o,R.$a)t:{t(R.$a==1),g=Wi();e:for(;;){if(g==null){g=0;break t}if(t(R!=null),R.mc=g,g.c=R.c,g.i=R.i,g.l=R.l,g.l.ma=R,g.l.width=R.c,g.l.height=R.i,g.a=0,Xt(g.m,P,nt,Y),!Ar(R.c,R.i,1,g,null)||(g.ab==1&&g.gc[0].hc==3&&xi(g.s)?(R.ic=1,P=g.c*g.i,g.Ta=null,g.Ua=0,g.V=s(P),g.Ba=0,g.V==null?(g.a=1,g=0):g=1):(R.ic=0,g=Zt(g,R.c)),!g))break e;g=1;break t}R.mc=null,g=0}else g=Y>=R.c*R.i;R=!g}if(R)return null;u.ga.Lc!=1?u.Ga=0:x=E-y}t(u.ga!=null),t(y+x<=E);t:{if(g=(P=u.ga).c,E=P.l.o,P.$a==0){if(nt=u.rc,Y=u.Vc,dt=u.Fa,H=u.P+1+y*g,N=u.mb,O=u.nb+y*g,t(H<=u.P+u.qc),P.Z!=0)for(t(qe[P.Z]!=null),R=0;R<x;++R)qe[P.Z](nt,Y,dt,H,N,O,g),nt=N,Y=O,O+=g,H+=g;else for(R=0;R<x;++R)o(N,O,dt,H,g),nt=N,Y=O,O+=g,H+=g;u.rc=nt,u.Vc=Y}else{if(t(P.mc!=null),g=y+x,t((R=P.mc)!=null),t(g<=R.i),R.C>=g)g=1;else if(P.ic||oe(),P.ic){P=R.V,nt=R.Ba,Y=R.c;var gt=R.i,ot=(dt=1,H=R.$/Y,N=R.$%Y,O=R.m,et=R.s,R.$),pt=Y*gt,Dt=Y*g,$t=et.wc,jt=ot<Dt?ti(et,N,H):null;t(ot<=pt),t(g<=gt),t(xi(et));e:for(;;){for(;!O.h&&ot<Dt;){if(N&$t||(jt=ti(et,N,H)),t(jt!=null),Ht(O),256>(gt=Le(jt.G[0],jt.H[0],O)))P[nt+ot]=gt,++ot,++N>=Y&&(N=0,++H<=g&&!(H%16)&&hr(R,H));else{if(!(280>gt)){dt=0;break e}gt=be(gt-256,O);var ue,ce=Le(jt.G[4],jt.H[4],O);if(Ht(O),!(ot>=(ce=he(Y,ce=be(ce,O)))&&pt-ot>=gt)){dt=0;break e}for(ue=0;ue<gt;++ue)P[nt+ot+ue]=P[nt+ot+ue-ce];for(ot+=gt,N+=gt;N>=Y;)N-=Y,++H<=g&&!(H%16)&&hr(R,H);ot<Dt&&N&$t&&(jt=ti(et,N,H))}t(O.h==yt(O))}hr(R,H>g?g:H);break e}!dt||O.h&&ot<pt?(dt=0,R.a=O.h?5:3):R.$=ot,g=dt}else g=fr(R,R.V,R.Ba,R.c,R.i,g,De);if(!g){x=0;break t}}y+x>=E&&(u.Cc=1),x=1}if(!x)return null;if(u.Cc&&((x=u.ga)!=null&&(x.mc=null),u.ga=null,0<u.Ga))return alert("todo:WebPDequantizeLevels"),null}return u.nb+y*k}function Q(u,g,y,x,k,E){for(;0<k--;){var R,P=u,H=g+(y?1:0),N=u,O=g+(y?0:3);for(R=0;R<x;++R){var et=N[O+4*R];et!=255&&(et*=32897,P[H+4*R+0]=P[H+4*R+0]*et>>23,P[H+4*R+1]=P[H+4*R+1]*et>>23,P[H+4*R+2]=P[H+4*R+2]*et>>23)}g+=E}}function tt(u,g,y,x,k){for(;0<x--;){var E;for(E=0;E<y;++E){var R=u[g+2*E+0],P=15&(N=u[g+2*E+1]),H=4369*P,N=(240&N|N>>4)*H>>16;u[g+2*E+0]=(240&R|R>>4)*H>>16&240|(15&R|R<<4)*H>>16>>4&15,u[g+2*E+1]=240&N|P}g+=k}}function kt(u,g,y,x,k,E,R,P){var H,N,O=255;for(N=0;N<k;++N){for(H=0;H<x;++H){var et=u[g+H];E[R+4*H]=et,O&=et}g+=y,R+=P}return O!=255}function zt(u,g,y,x,k){var E;for(E=0;E<k;++E)y[x+E]=u[g+E]>>8}function oe(){Ss=Q,xa=tt,kA=kt,vc=zt}function we(u,g,y){It[u]=function(x,k,E,R,P,H,N,O,et,nt,Y,dt,gt,ot,pt,Dt,$t){var jt,ue=$t-1>>1,ce=P[H+0]|N[O+0]<<16,Fe=et[nt+0]|Y[dt+0]<<16;t(x!=null);var xe=3*ce+Fe+131074>>2;for(g(x[k+0],255&xe,xe>>16,gt,ot),E!=null&&(xe=3*Fe+ce+131074>>2,g(E[R+0],255&xe,xe>>16,pt,Dt)),jt=1;jt<=ue;++jt){var ke=P[H+jt]|N[O+jt]<<16,Ue=et[nt+jt]|Y[dt+jt]<<16,$e=ce+ke+Fe+Ue+524296,Li=$e+2*(ke+Fe)>>3;xe=Li+ce>>1,ce=($e=$e+2*(ce+Ue)>>3)+ke>>1,g(x[k+2*jt-1],255&xe,xe>>16,gt,ot+(2*jt-1)*y),g(x[k+2*jt-0],255&ce,ce>>16,gt,ot+(2*jt-0)*y),E!=null&&(xe=$e+Fe>>1,ce=Li+Ue>>1,g(E[R+2*jt-1],255&xe,xe>>16,pt,Dt+(2*jt-1)*y),g(E[R+2*jt+0],255&ce,ce>>16,pt,Dt+(2*jt+0)*y)),ce=ke,Fe=Ue}1&$t||(xe=3*ce+Fe+131074>>2,g(x[k+$t-1],255&xe,xe>>16,gt,ot+($t-1)*y),E!=null&&(xe=3*Fe+ce+131074>>2,g(E[R+$t-1],255&xe,xe>>16,pt,Dt+($t-1)*y)))}}function Me(){ls[Fa]=Bh,ls[EA]=Vl,ls[Pl]=uu,ls[TA]=Fc,ls[UA]=ia,ls[uo]=kc,ls[Hl]=Lc,ls[Ml]=Vl,ls[ll]=Fc,ls[cl]=ia,ls[ul]=kc}function ui(u){return u&~hu?0>u?0:255:u>>Xa}function Mi(u,g){return ui((19077*u>>8)+(26149*g>>8)-14234)}function Xi(u,g,y){return ui((19077*u>>8)-(6419*g>>8)-(13320*y>>8)+8708)}function Ii(u,g){return ui((19077*u>>8)+(33050*g>>8)-17685)}function gr(u,g,y,x,k){x[k+0]=Mi(u,y),x[k+1]=Xi(u,g,y),x[k+2]=Ii(u,g)}function ki(u,g,y,x,k){x[k+0]=Ii(u,g),x[k+1]=Xi(u,g,y),x[k+2]=Mi(u,y)}function tn(u,g,y,x,k){var E=Xi(u,g,y);g=E<<3&224|Ii(u,g)>>3,x[k+0]=248&Mi(u,y)|E>>5,x[k+1]=g}function er(u,g,y,x,k){var E=240&Ii(u,g)|15;x[k+0]=240&Mi(u,y)|Xi(u,g,y)>>4,x[k+1]=E}function nr(u,g,y,x,k){x[k+0]=255,gr(u,g,y,x,k+1)}function cn(u,g,y,x,k){ki(u,g,y,x,k),x[k+3]=255}function Gs(u,g,y,x,k){gr(u,g,y,x,k),x[k+3]=255}function os(u,g){return 0>u?0:u>g?g:u}function Zs(u,g,y){It[u]=function(x,k,E,R,P,H,N,O,et){for(var nt=O+(-2&et)*y;O!=nt;)g(x[k+0],E[R+0],P[H+0],N,O),g(x[k+1],E[R+0],P[H+0],N,O+y),k+=2,++R,++H,O+=2*y;1&et&&g(x[k+0],E[R+0],P[H+0],N,O)}}function za(u,g,y){return y==0?u==0?g==0?6:5:g==0?4:0:y}function Ca(u,g,y,x,k){switch(u>>>30){case 3:$o(g,y,x,k,0);break;case 2:ta(g,y,x,k);break;case 1:Bs(g,y,x,k)}}function Oa(u,g){var y,x,k=g.M,E=g.Nb,R=u.oc,P=u.pc+40,H=u.oc,N=u.pc+584,O=u.oc,et=u.pc+600;for(y=0;16>y;++y)R[P+32*y-1]=129;for(y=0;8>y;++y)H[N+32*y-1]=129,O[et+32*y-1]=129;for(0<k?R[P-1-32]=H[N-1-32]=O[et-1-32]=129:(A(R,P-32-1,127,21),A(H,N-32-1,127,9),A(O,et-32-1,127,9)),x=0;x<u.za;++x){var nt=g.ya[g.aa+x];if(0<x){for(y=-1;16>y;++y)o(R,P+32*y-4,R,P+32*y+12,4);for(y=-1;8>y;++y)o(H,N+32*y-4,H,N+32*y+4,4),o(O,et+32*y-4,O,et+32*y+4,4)}var Y=u.Gd,dt=u.Hd+x,gt=nt.ad,ot=nt.Hc;if(0<k&&(o(R,P-32,Y[dt].y,0,16),o(H,N-32,Y[dt].f,0,8),o(O,et-32,Y[dt].ea,0,8)),nt.Za){var pt=R,Dt=P-32+16;for(0<k&&(x>=u.za-1?A(pt,Dt,Y[dt].y[15],4):o(pt,Dt,Y[dt+1].y,0,4)),y=0;4>y;y++)pt[Dt+128+y]=pt[Dt+256+y]=pt[Dt+384+y]=pt[Dt+0+y];for(y=0;16>y;++y,ot<<=2)pt=R,Dt=P+i[y],Ds[nt.Ob[y]](pt,Dt),Ca(ot,gt,16*+y,pt,Dt)}else if(pt=za(x,k,nt.Ob[0]),Ro[pt](R,P),ot!=0)for(y=0;16>y;++y,ot<<=2)Ca(ot,gt,16*+y,R,P+i[y]);for(y=nt.Gc,pt=za(x,k,nt.Dd),Fs[pt](H,N),Fs[pt](O,et),ot=gt,pt=H,Dt=N,255&(nt=y>>0)&&(170&nt?As(ot,256,pt,Dt):lo(ot,256,pt,Dt)),nt=O,ot=et,255&(y>>=8)&&(170&y?As(gt,320,nt,ot):lo(gt,320,nt,ot)),k<u.Ub-1&&(o(Y[dt].y,0,R,P+480,16),o(Y[dt].f,0,H,N+224,8),o(Y[dt].ea,0,O,et+224,8)),y=8*E*u.B,Y=u.sa,dt=u.ta+16*x+16*E*u.R,gt=u.qa,nt=u.ra+8*x+y,ot=u.Ha,pt=u.Ia+8*x+y,y=0;16>y;++y)o(Y,dt+y*u.R,R,P+32*y,16);for(y=0;8>y;++y)o(gt,nt+y*u.B,H,N+32*y,8),o(ot,pt+y*u.B,O,et+32*y,8)}}function ys(u,g,y,x,k,E,R,P,H){var N=[0],O=[0],et=0,nt=H!=null?H.kd:0,Y=H??new sl;if(u==null||12>y)return 7;Y.data=u,Y.w=g,Y.ha=y,g=[g],y=[y],Y.gb=[Y.gb];t:{var dt=g,gt=y,ot=Y.gb;if(t(u!=null),t(gt!=null),t(ot!=null),ot[0]=0,12<=gt[0]&&!r(u,dt[0],"RIFF")){if(r(u,dt[0]+8,"WEBP")){ot=3;break t}var pt=Xe(u,dt[0]+4);if(12>pt||4294967286<pt){ot=3;break t}if(nt&&pt>gt[0]-8){ot=7;break t}ot[0]=pt,dt[0]+=12,gt[0]-=12}ot=0}if(ot!=0)return ot;for(pt=0<Y.gb[0],y=y[0];;){t:{var Dt=u;gt=g,ot=y;var $t=N,jt=O,ue=dt=[0];if((xe=et=[et])[0]=0,8>ot[0])ot=7;else{if(!r(Dt,gt[0],"VP8X")){if(Xe(Dt,gt[0]+4)!=10){ot=3;break t}if(18>ot[0]){ot=7;break t}var ce=Xe(Dt,gt[0]+8),Fe=1+Je(Dt,gt[0]+12);if(2147483648<=Fe*(Dt=1+Je(Dt,gt[0]+15))){ot=3;break t}ue!=null&&(ue[0]=ce),$t!=null&&($t[0]=Fe),jt!=null&&(jt[0]=Dt),gt[0]+=18,ot[0]-=18,xe[0]=1}ot=0}}if(et=et[0],dt=dt[0],ot!=0)return ot;if(gt=!!(2&dt),!pt&&et)return 3;if(E!=null&&(E[0]=!!(16&dt)),R!=null&&(R[0]=gt),P!=null&&(P[0]=0),R=N[0],dt=O[0],et&&gt&&H==null){ot=0;break}if(4>y){ot=7;break}if(pt&&et||!pt&&!et&&!r(u,g[0],"ALPH")){y=[y],Y.na=[Y.na],Y.P=[Y.P],Y.Sa=[Y.Sa];t:{ce=u,ot=g,pt=y;var xe=Y.gb;$t=Y.na,jt=Y.P,ue=Y.Sa,Fe=22,t(ce!=null),t(pt!=null),Dt=ot[0];var ke=pt[0];for(t($t!=null),t(ue!=null),$t[0]=null,jt[0]=null,ue[0]=0;;){if(ot[0]=Dt,pt[0]=ke,8>ke){ot=7;break t}var Ue=Xe(ce,Dt+4);if(4294967286<Ue){ot=3;break t}var $e=8+Ue+1&-2;if(Fe+=$e,0<xe&&Fe>xe){ot=3;break t}if(!r(ce,Dt,"VP8 ")||!r(ce,Dt,"VP8L")){ot=0;break t}if(ke[0]<$e){ot=7;break t}r(ce,Dt,"ALPH")||($t[0]=ce,jt[0]=Dt+8,ue[0]=Ue),Dt+=$e,ke-=$e}}if(y=y[0],Y.na=Y.na[0],Y.P=Y.P[0],Y.Sa=Y.Sa[0],ot!=0)break}y=[y],Y.Ja=[Y.Ja],Y.xa=[Y.xa];t:if(xe=u,ot=g,pt=y,$t=Y.gb[0],jt=Y.Ja,ue=Y.xa,ce=ot[0],Dt=!r(xe,ce,"VP8 "),Fe=!r(xe,ce,"VP8L"),t(xe!=null),t(pt!=null),t(jt!=null),t(ue!=null),8>pt[0])ot=7;else{if(Dt||Fe){if(xe=Xe(xe,ce+4),12<=$t&&xe>$t-12){ot=3;break t}if(nt&&xe>pt[0]-8){ot=7;break t}jt[0]=xe,ot[0]+=8,pt[0]-=8,ue[0]=Fe}else ue[0]=5<=pt[0]&&xe[ce+0]==47&&!(xe[ce+4]>>5),jt[0]=pt[0];ot=0}if(y=y[0],Y.Ja=Y.Ja[0],Y.xa=Y.xa[0],g=g[0],ot!=0)break;if(4294967286<Y.Ja)return 3;if(P==null||gt||(P[0]=Y.xa?2:1),R=[R],dt=[dt],Y.xa){if(5>y){ot=7;break}P=R,nt=dt,gt=E,u==null||5>y?u=0:5<=y&&u[g+0]==47&&!(u[g+4]>>5)?(pt=[0],xe=[0],$t=[0],Xt(jt=new j,u,g,y),Wt(jt,pt,xe,$t)?(P!=null&&(P[0]=pt[0]),nt!=null&&(nt[0]=xe[0]),gt!=null&&(gt[0]=$t[0]),u=1):u=0):u=0}else{if(10>y){ot=7;break}P=dt,u==null||10>y||!ro(u,g+3,y-3)?u=0:(nt=u[g+0]|u[g+1]<<8|u[g+2]<<16,gt=16383&(u[g+7]<<8|u[g+6]),u=16383&(u[g+9]<<8|u[g+8]),1&nt||3<(nt>>1&7)||!(nt>>4&1)||nt>>5>=Y.Ja||!gt||!u?u=0:(R&&(R[0]=gt),P&&(P[0]=u),u=1))}if(!u||(R=R[0],dt=dt[0],et&&(N[0]!=R||O[0]!=dt)))return 3;H!=null&&(H[0]=Y,H.offset=g-H.w,t(4294967286>g-H.w),t(H.offset==H.ha-y));break}return ot==0||ot==7&&et&&H==null?(E!=null&&(E[0]|=Y.na!=null&&0<Y.na.length),x!=null&&(x[0]=R),k!=null&&(k[0]=dt),0):ot}function Ao(u,g,y){var x=g.width,k=g.height,E=0,R=0,P=x,H=k;if(g.Da=u!=null&&0<u.Da,g.Da&&(P=u.cd,H=u.bd,E=u.v,R=u.j,11>y||(E&=-2,R&=-2),0>E||0>R||0>=P||0>=H||E+P>x||R+H>k))return 0;if(g.v=E,g.j=R,g.va=E+P,g.o=R+H,g.U=P,g.T=H,g.da=u!=null&&0<u.da,g.da){if(!Ye(P,H,y=[u.ib],E=[u.hb]))return 0;g.ib=y[0],g.hb=E[0]}return g.ob=u!=null&&u.ob,g.Kb=u==null||!u.Sd,g.da&&(g.ob=g.ib<3*x/4&&g.hb<3*k/4,g.Kb=0),1}function Fn(u){if(u==null)return 2;if(11>u.S){var g=u.f.RGBA;g.fb+=(u.height-1)*g.A,g.A=-g.A}else g=u.f.kb,u=u.height,g.O+=(u-1)*g.fa,g.fa=-g.fa,g.N+=(u-1>>1)*g.Ab,g.Ab=-g.Ab,g.W+=(u-1>>1)*g.Db,g.Db=-g.Db,g.F!=null&&(g.J+=(u-1)*g.lb,g.lb=-g.lb);return 0}function Ia(u,g,y,x){if(x==null||0>=u||0>=g)return 2;if(y!=null){if(y.Da){var k=y.cd,E=y.bd,R=-2&y.v,P=-2&y.j;if(0>R||0>P||0>=k||0>=E||R+k>u||P+E>g)return 2;u=k,g=E}if(y.da){if(!Ye(u,g,k=[y.ib],E=[y.hb]))return 2;u=k[0],g=E[0]}}x.width=u,x.height=g;t:{var H=x.width,N=x.height;if(u=x.S,0>=H||0>=N||!(u>=Fa&&13>u))u=2;else{if(0>=x.Rd&&x.sd==null){R=E=k=g=0;var O=(P=H*b[u])*N;if(11>u||(E=(N+1)/2*(g=(H+1)/2),u==12&&(R=(k=H)*N)),(N=s(O+2*E+R))==null){u=1;break t}x.sd=N,11>u?((H=x.f.RGBA).eb=N,H.fb=0,H.A=P,H.size=O):((H=x.f.kb).y=N,H.O=0,H.fa=P,H.Fd=O,H.f=N,H.N=0+O,H.Ab=g,H.Cd=E,H.ea=N,H.W=0+O+E,H.Db=g,H.Ed=E,u==12&&(H.F=N,H.J=0+O+2*E),H.Tc=R,H.lb=k)}if(g=1,k=x.S,E=x.width,R=x.height,k>=Fa&&13>k)if(11>k)u=x.f.RGBA,g&=(P=Math.abs(u.A))*(R-1)+E<=u.size,g&=P>=E*b[k],g&=u.eb!=null;else{u=x.f.kb,P=(E+1)/2,O=(R+1)/2,H=Math.abs(u.fa),N=Math.abs(u.Ab);var et=Math.abs(u.Db),nt=Math.abs(u.lb),Y=nt*(R-1)+E;g&=H*(R-1)+E<=u.Fd,g&=N*(O-1)+P<=u.Cd,g=(g&=et*(O-1)+P<=u.Ed)&H>=E&N>=P&et>=P,g&=u.y!=null,g&=u.f!=null,g&=u.ea!=null,k==12&&(g&=nt>=E,g&=Y<=u.Tc,g&=u.F!=null)}else g=0;u=g?0:2}}return u!=0||y!=null&&y.fd&&(u=Fn(x)),u}var kn=64,ya=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ps=24,jo=32,ba=8,Bn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ne("Predictor0","PredictorAdd0"),It.Predictor0=function(){return 4278190080},It.Predictor1=function(u){return u},It.Predictor2=function(u,g,y){return g[y+0]},It.Predictor3=function(u,g,y){return g[y+1]},It.Predictor4=function(u,g,y){return g[y-1]},It.Predictor5=function(u,g,y){return We(We(u,g[y+1]),g[y+0])},It.Predictor6=function(u,g,y){return We(u,g[y-1])},It.Predictor7=function(u,g,y){return We(u,g[y+0])},It.Predictor8=function(u,g,y){return We(g[y-1],g[y+0])},It.Predictor9=function(u,g,y){return We(g[y+0],g[y+1])},It.Predictor10=function(u,g,y){return We(We(u,g[y-1]),We(g[y+0],g[y+1]))},It.Predictor11=function(u,g,y){var x=g[y+0];return 0>=Ti(x>>24&255,u>>24&255,(g=g[y-1])>>24&255)+Ti(x>>16&255,u>>16&255,g>>16&255)+Ti(x>>8&255,u>>8&255,g>>8&255)+Ti(255&x,255&u,255&g)?x:u},It.Predictor12=function(u,g,y){var x=g[y+0];return(ri((u>>24&255)+(x>>24&255)-((g=g[y-1])>>24&255))<<24|ri((u>>16&255)+(x>>16&255)-(g>>16&255))<<16|ri((u>>8&255)+(x>>8&255)-(g>>8&255))<<8|ri((255&u)+(255&x)-(255&g)))>>>0},It.Predictor13=function(u,g,y){var x=g[y-1];return(hi((u=We(u,g[y+0]))>>24&255,x>>24&255)<<24|hi(u>>16&255,x>>16&255)<<16|hi(u>>8&255,x>>8&255)<<8|hi(u>>0&255,x>>0&255))>>>0};var SA=It.PredictorAdd0;It.PredictorAdd1=fe,Ne("Predictor2","PredictorAdd2"),Ne("Predictor3","PredictorAdd3"),Ne("Predictor4","PredictorAdd4"),Ne("Predictor5","PredictorAdd5"),Ne("Predictor6","PredictorAdd6"),Ne("Predictor7","PredictorAdd7"),Ne("Predictor8","PredictorAdd8"),Ne("Predictor9","PredictorAdd9"),Ne("Predictor10","PredictorAdd10"),Ne("Predictor11","PredictorAdd11"),Ne("Predictor12","PredictorAdd12"),Ne("Predictor13","PredictorAdd13");var FA=It.PredictorAdd2;Gi("ColorIndexInverseTransform","MapARGB","32b",function(u){return u>>8&255},function(u){return u}),Gi("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(u){return u},function(u){return u>>8&255});var qo,Ln=It.ColorIndexInverseTransform,Wa=It.MapARGB,va=It.VP8LColorIndexInverseTransformAlpha,dr=It.MapAlpha,Hs=It.VP8LPredictorsAdd=[];Hs.length=16,(It.VP8LPredictors=[]).length=16,(It.VP8LPredictorsAdd_C=[]).length=16,(It.VP8LPredictors_C=[]).length=16;var bs,Ms,as,vs,Ns,wa,ws,$o,ta,As,Bs,lo,Ba,ea,To,_s,_a,Vr,xs,kr,_r,en,Wr,co,Ss,xa,kA,vc,Qr=s(511),Sa=s(2041),ts=s(225),al=s(767),LA=0,Al=Sa,Uo=ts,En=al,zn=Qr,Fa=0,EA=1,Pl=2,TA=3,UA=4,uo=5,Hl=6,Ml=7,ll=8,cl=9,ul=10,wc=[2,3,7],Bc=[3,3,11],QA=[280,256,256,256,40],lu=[0,1,1,1,0],Vs=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ho=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],_c=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],go=8,po=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],xc=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ja=null,vh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],wh=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Nl=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],RA=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Qo=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ai=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],cu=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ro=[],Ds=[],Fs=[],Go=1,Sc=2,qe=[],ls=[];we("UpsampleRgbLinePair",gr,3),we("UpsampleBgrLinePair",ki,3),we("UpsampleRgbaLinePair",Gs,4),we("UpsampleBgraLinePair",cn,4),we("UpsampleArgbLinePair",nr,4),we("UpsampleRgba4444LinePair",er,2),we("UpsampleRgb565LinePair",tn,2);var Bh=It.UpsampleRgbLinePair,uu=It.UpsampleBgrLinePair,Vl=It.UpsampleRgbaLinePair,Fc=It.UpsampleBgraLinePair,ia=It.UpsampleArgbLinePair,kc=It.UpsampleRgba4444LinePair,Lc=It.UpsampleRgb565LinePair,fo=16,vr=1<<fo-1,ka=-227,La=482,Xa=6,hu=(256<<Xa)-1,Dl=0,hl=s(256),Zo=s(256),Kl=s(256),yi=s(256),Zi=s(La-ka),v=s(La-ka);Zs("YuvToRgbRow",gr,3),Zs("YuvToBgrRow",ki,3),Zs("YuvToRgbaRow",Gs,4),Zs("YuvToBgraRow",cn,4),Zs("YuvToArgbRow",nr,4),Zs("YuvToRgba4444Row",er,2),Zs("YuvToRgb565Row",tn,2);var i=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],c=[0,2,8],p=[8,7,6,4,4,2,2,2,1,1,1,1],m=1;this.WebPDecodeRGBA=function(u,g,y,x,k){var E=EA,R=new BA,P=new wt;R.ba=P,P.S=E,P.width=[P.width],P.height=[P.height];var H=P.width,N=P.height,O=new W;if(O==null||u==null)var et=2;else t(O!=null),et=ys(u,g,y,O.width,O.height,O.Pd,O.Qd,O.format,null);if(et!=0?H=0:(H!=null&&(H[0]=O.width[0]),N!=null&&(N[0]=O.height[0]),H=1),H){P.width=P.width[0],P.height=P.height[0],x!=null&&(x[0]=P.width),k!=null&&(k[0]=P.height);t:{if(x=new vn,(k=new sl).data=u,k.w=g,k.ha=y,k.kd=1,g=[0],t(k!=null),((u=ys(k.data,k.w,k.ha,null,null,null,g,null,k))==0||u==7)&&g[0]&&(u=4),(g=u)==0){if(t(R!=null),x.data=k.data,x.w=k.w+k.offset,x.ha=k.ha-k.offset,x.put=Yt,x.ac=Vt,x.bc=Rt,x.ma=R,k.xa){if((u=Wi())==null){R=1;break t}if(function(nt,Y){var dt=[0],gt=[0],ot=[0];e:for(;;){if(nt==null)return 0;if(Y==null)return nt.a=2,0;if(nt.l=Y,nt.a=0,Xt(nt.m,Y.data,Y.w,Y.ha),!Wt(nt.m,dt,gt,ot)){nt.a=3;break e}if(nt.xb=Sc,Y.width=dt[0],Y.height=gt[0],!Ar(dt[0],gt[0],1,nt,null))break e;return 1}return t(nt.a!=0),0}(u,x)){if(x=(g=Ia(x.width,x.height,R.Oa,R.ba))==0){e:{x=u;i:for(;;){if(x==null){x=0;break e}if(t(x.s.yc!=null),t(x.s.Ya!=null),t(0<x.s.Wb),t((y=x.l)!=null),t((k=y.ma)!=null),x.xb!=0){if(x.ca=k.ba,x.tb=k.tb,t(x.ca!=null),!Ao(k.Oa,y,TA)){x.a=2;break i}if(!Zt(x,y.width)||y.da)break i;if((y.da||Ji(x.ca.S))&&oe(),11>x.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),x.ca.f.kb.F!=null&&oe()),x.Pb&&0<x.s.ua&&x.s.vb.X==null&&!Kt(x.s.vb,x.s.Wa.Xa)){x.a=1;break i}x.xb=0}if(!fr(x,x.V,x.Ba,x.c,x.i,y.o,$i))break i;k.Dc=x.Ma,x=1;break e}t(x.a!=0),x=0}x=!x}x&&(g=u.a)}else g=u.a}else{if((u=new io)==null){R=1;break t}if(u.Fa=k.na,u.P=k.P,u.qc=k.Sa,wn(u,x)){if((g=Ia(x.width,x.height,R.Oa,R.ba))==0){if(u.Aa=0,y=R.Oa,t((k=u)!=null),y!=null){if(0<(H=0>(H=y.Md)?0:100<H?255:255*H/100)){for(N=O=0;4>N;++N)12>(et=k.pb[N]).lc&&(et.ia=H*p[0>et.lc?0:et.lc]>>3),O|=et.ia;O&&(alert("todo:VP8InitRandom"),k.ia=1)}k.Ga=y.Id,100<k.Ga?k.Ga=100:0>k.Ga&&(k.Ga=0)}ht(u,x)||(g=u.a)}}else g=u.a}g==0&&R.Oa!=null&&R.Oa.fd&&(g=Fn(R.ba))}R=g}E=R!=0?null:11>E?P.f.RGBA.eb:P.f.kb.y}else E=null;return E};var b=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function _(It,Nt){for(var ie="",lt=0;lt<4;lt++)ie+=String.fromCharCode(It[Nt++]);return ie}function S(It,Nt){return(It[Nt+0]<<0|It[Nt+1]<<8|It[Nt+2]<<16)>>>0}function U(It,Nt){return(It[Nt+0]<<0|It[Nt+1]<<8|It[Nt+2]<<16|It[Nt+3]<<24)>>>0}new I;var G=[0],L=[0],K=[],V=new I,q=n,z=function(It,Nt){var ie={},lt=0,at=!1,St=0,Bt=0;if(ie.frames=[],!function(mt,yt,Qt,Ht){for(var ae=0;ae<Ht;ae++)if(mt[yt+ae]!=Qt.charCodeAt(ae))return!0;return!1}(It,Nt,"RIFF",4)){var se,ee;for(U(It,Nt+=4),Nt+=8;Nt<It.length;){var qt=_(It,Nt),Xt=U(It,Nt+=4);Nt+=4;var vt=Xt+(1&Xt);switch(qt){case"VP8 ":case"VP8L":ie.frames[lt]===void 0&&(ie.frames[lt]={}),(j=ie.frames[lt]).src_off=at?Bt:Nt-8,j.src_size=St+Xt+8,lt++,at&&(at=!1,St=0,Bt=0);break;case"VP8X":(j=ie.header={}).feature_flags=It[Nt];var Tt=Nt+4;j.canvas_width=1+S(It,Tt),Tt+=3,j.canvas_height=1+S(It,Tt),Tt+=3;break;case"ALPH":at=!0,St=vt+8,Bt=Nt-8;break;case"ANIM":(j=ie.header).bgcolor=U(It,Nt),Tt=Nt+4,j.loop_count=(se=It)[(ee=Tt)+0]<<0|se[ee+1]<<8,Tt+=2;break;case"ANMF":var pe,j;(j=ie.frames[lt]={}).offset_x=2*S(It,Nt),Nt+=3,j.offset_y=2*S(It,Nt),Nt+=3,j.width=1+S(It,Nt),Nt+=3,j.height=1+S(It,Nt),Nt+=3,j.duration=S(It,Nt),Nt+=3,pe=It[Nt++],j.dispose=1&pe,j.blend=pe>>1&1}qt!="ANMF"&&(Nt+=vt)}return ie}}(q,0);z.response=q,z.rgbaoutput=!0,z.dataurl=!1;var it=z.header?z.header:null,At=z.frames?z.frames:null;if(it){it.loop_counter=it.loop_count,G=[it.canvas_height],L=[it.canvas_width];for(var _t=0;_t<At.length&&At[_t].blend!=0;_t++);}var Lt=At[0],Et=V.WebPDecodeRGBA(q,Lt.src_off,Lt.src_size,L,G);Lt.rgba=Et,Lt.imgwidth=L[0],Lt.imgheight=G[0];for(var xt=0;xt<L[0]*G[0]*4;xt++)K[xt]=Et[xt];return this.width=L,this.height=G,this.data=K,this}var M5,vD,wD,on,Am,Fo,ko,jg,hm,gm,Py,N5,V5,D5,Hy,K5,BD,C5,My,Tl,Nr,el,mc,Nr,Nr,Nr,Nr,qg,Nr,_D,xD,SD,FD,Ly,fA,Ey,jy,z5,kD,Ul,Wg,Ty,Ny,I5,Jg,rm,y5,LD,ED,TD,UD,QD,RD,GD,ZD,qi,sn,Yg,Dy,su,v5,VD,w5,Sn,qy,Au,hh,cr,dc,Ko,_5,$A,DD,KD,zD,Nn,Vn,Dn,OD,WD,Oy,tm,JD,XD,YD,jD,X5,Gy,tl,Y5,j5,CA,Ch,Ih,yh,nm,ms,sm,bh,cm,om,au,am,Ei,qD,$5,tS,Wy,eS,$D,tK,S5,em,L5,E5,T5,gh,im,U5,Q5,R5,nK,IA,Cc,oK,aK,il,AK,P5,iS,lK,cK,uK,hK,gK,dK,pK,rS,fK,mK,CK,IK,yK,pc,$g,mh,Xg,Xy,Yy,um,H5,bK,vK,wK,BK,_K,xK,SK,FK,kK,LK,nS,td,ky=wd(()=>{M5=Bd(rC(),1),vD=Object.defineProperty,wD=(n,t,r)=>t in n?vD(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,on=(n,t,r)=>(wD(n,typeof t!="symbol"?t+"":t,r),r),Am=class{constructor(t){on(this,"map"),on(this,"width"),on(this,"height"),on(this,"svgCanvas"),on(this,"xLine"),on(this,"yLine"),on(this,"color","#535353"),this.map=t,this.mapResize=this.mapResize.bind(this)}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var t,r;this.width=(t=this.map)==null?void 0:t.getCanvas().clientWidth,this.height=(r=this.map)==null?void 0:r.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);let t=this.width/2,r=this.height/2;this.yLine.setAttribute("x1",`${t}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${t}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1","0px"),this.xLine.setAttribute("y1",`${r}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${r}px`)}else console.error("element value is null")}createCanvas(t){if(this.width!==void 0&&this.height!==void 0){let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.style.position="relative",r.setAttribute("width",`${this.width}px`),r.setAttribute("height",`${this.height}px`);let o=this.width/2,A=this.height/2;this.yLine=r.appendChild(this.createLine(o,0,o,this.height,this.color,"2px")),this.xLine=r.appendChild(this.createLine(0,A,this.width,A,this.color,"2px")),t?.appendChild(r),this.svgCanvas=r}}createLine(t,r,o,A,s,d){let f=document.createElementNS("http://www.w3.org/2000/svg","line");return f.setAttribute("x1",t),f.setAttribute("y1",r),f.setAttribute("x2",o),f.setAttribute("y2",A),f.setAttribute("stroke-dasharray","5,5"),f.setAttribute("stroke",s),f.setAttribute("stroke-width",d),f}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}};Fo=Uint8Array,ko=Uint16Array,jg=Uint32Array,hm=new Fo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gm=new Fo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Py=new Fo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),N5=function(n,t){for(var r=new ko(31),o=0;o<31;++o)r[o]=t+=1<<n[o-1];for(var A=new jg(r[30]),o=1;o<30;++o)for(var s=r[o];s<r[o+1];++s)A[s]=s-r[o]<<5|o;return[r,A]},V5=N5(hm,2),D5=V5[0],Hy=V5[1];D5[28]=258,Hy[258]=28;K5=N5(gm,0),BD=K5[0],C5=K5[1],My=new ko(32768);for(Nr=0;Nr<32768;++Nr)Tl=(Nr&43690)>>>1|(Nr&21845)<<1,Tl=(Tl&52428)>>>2|(Tl&13107)<<2,Tl=(Tl&61680)>>>4|(Tl&3855)<<4,My[Nr]=((Tl&65280)>>>8|(Tl&255)<<8)>>>1;el=function(n,t,r){for(var o=n.length,A=0,s=new ko(t);A<o;++A)++s[n[A]-1];var d=new ko(t);for(A=0;A<t;++A)d[A]=d[A-1]+s[A-1]<<1;var f;if(r){f=new ko(1<<t);var I=15-t;for(A=0;A<o;++A)if(n[A])for(var _=A<<4|n[A],S=t-n[A],U=d[n[A]-1]++<<S,G=U|(1<<S)-1;U<=G;++U)f[My[U]>>>I]=_}else for(f=new ko(o),A=0;A<o;++A)f[A]=My[d[n[A]-1]++]>>>15-n[A];return f},mc=new Fo(288);for(Nr=0;Nr<144;++Nr)mc[Nr]=8;for(Nr=144;Nr<256;++Nr)mc[Nr]=9;for(Nr=256;Nr<280;++Nr)mc[Nr]=7;for(Nr=280;Nr<288;++Nr)mc[Nr]=8;qg=new Fo(32);for(Nr=0;Nr<32;++Nr)qg[Nr]=5;_D=el(mc,9,0),xD=el(mc,9,1),SD=el(qg,5,0),FD=el(qg,5,1),Ly=function(n){for(var t=n[0],r=1;r<n.length;++r)n[r]>t&&(t=n[r]);return t},fA=function(n,t,r){var o=t/8>>0;return(n[o]|n[o+1]<<8)>>>(t&7)&r},Ey=function(n,t){var r=t/8>>0;return(n[r]|n[r+1]<<8|n[r+2]<<16)>>>(t&7)},jy=function(n){return(n/8>>0)+(n&7&&1)},z5=function(n,t,r){(t==null||t<0)&&(t=0),(r==null||r>n.length)&&(r=n.length);var o=new(n instanceof ko?ko:n instanceof jg?jg:Fo)(r-t);return o.set(n.subarray(t,r)),o},kD=function(n,t,r){var o=n.length,A=!t||r,s=!r||r.i;r||(r={}),t||(t=new Fo(o*3));var d=function(Ht){var ae=t.length;if(Ht>ae){var ge=new Fo(Math.max(ae*2,Ht));ge.set(t),t=ge}},f=r.f||0,I=r.p||0,_=r.b||0,S=r.l,U=r.d,G=r.m,L=r.n,K=o*8;do{if(!S){r.f=f=fA(n,I,1);var V=fA(n,I+1,3);if(I+=3,V)if(V==1)S=xD,U=FD,G=9,L=5;else if(V==2){var q=fA(n,I,31)+257,z=fA(n,I+10,15)+4,it=q+fA(n,I+5,31)+1;I+=14;for(var At=new Fo(it),_t=new Fo(19),Lt=0;Lt<z;++Lt)_t[Py[Lt]]=fA(n,I+Lt*3,7);I+=z*3;var Et=Ly(_t),xt=(1<<Et)-1;if(!s&&I+it*(Et+7)>K)break;for(var It=el(_t,Et,1),Lt=0;Lt<it;){var Nt=It[fA(n,I,xt)];I+=Nt&15;var ie=Nt>>>4;if(ie<16)At[Lt++]=ie;else{var lt=0,at=0;for(ie==16?(at=3+fA(n,I,3),I+=2,lt=At[Lt-1]):ie==17?(at=3+fA(n,I,7),I+=3):ie==18&&(at=11+fA(n,I,127),I+=7);at--;)At[Lt++]=lt}}var St=At.subarray(0,q),Bt=At.subarray(q);G=Ly(St),L=Ly(Bt),S=el(St,G,1),U=el(Bt,L,1)}else throw"invalid block type";else{var ie=jy(I)+4,se=n[ie-4]|n[ie-3]<<8,ee=ie+se;if(ee>o){if(s)throw"unexpected EOF";break}A&&d(_+se),t.set(n.subarray(ie,ee),_),r.b=_+=se,r.p=I=ee*8;continue}if(I>K)throw"unexpected EOF"}A&&d(_+131072);for(var qt=(1<<G)-1,Xt=(1<<L)-1,vt=G+L+18;s||I+vt<K;){var lt=S[Ey(n,I)&qt],Tt=lt>>>4;if(I+=lt&15,I>K)throw"unexpected EOF";if(!lt)throw"invalid length/literal";if(Tt<256)t[_++]=Tt;else if(Tt==256){S=null;break}else{var pe=Tt-254;if(Tt>264){var Lt=Tt-257,j=hm[Lt];pe=fA(n,I,(1<<j)-1)+D5[Lt],I+=j}var mt=U[Ey(n,I)&Xt],yt=mt>>>4;if(!mt)throw"invalid distance";I+=mt&15;var Bt=BD[yt];if(yt>3){var j=gm[yt];Bt+=Ey(n,I)&(1<<j)-1,I+=j}if(I>K)throw"unexpected EOF";A&&d(_+131072);for(var Qt=_+pe;_<Qt;_+=4)t[_]=t[_-Bt],t[_+1]=t[_+1-Bt],t[_+2]=t[_+2-Bt],t[_+3]=t[_+3-Bt];_=Qt}}r.l=S,r.p=I,r.b=_,S&&(f=1,r.m=G,r.d=U,r.n=L)}while(!f);return _==t.length?t:z5(t,0,_)},Ul=function(n,t,r){r<<=t&7;var o=t/8>>0;n[o]|=r,n[o+1]|=r>>>8},Wg=function(n,t,r){r<<=t&7;var o=t/8>>0;n[o]|=r,n[o+1]|=r>>>8,n[o+2]|=r>>>16},Ty=function(n,t){for(var r=[],o=0;o<n.length;++o)n[o]&&r.push({s:o,f:n[o]});var A=r.length,s=r.slice();if(!A)return[new Fo(0),0];if(A==1){var d=new Fo(r[0].s+1);return d[r[0].s]=1,[d,1]}r.sort(function(Lt,Et){return Lt.f-Et.f}),r.push({s:-1,f:25001});var f=r[0],I=r[1],_=0,S=1,U=2;for(r[0]={s:-1,f:f.f+I.f,l:f,r:I};S!=A-1;)f=r[r[_].f<r[U].f?_++:U++],I=r[_!=S&&r[_].f<r[U].f?_++:U++],r[S++]={s:-1,f:f.f+I.f,l:f,r:I};for(var G=s[0].s,o=1;o<A;++o)s[o].s>G&&(G=s[o].s);var L=new ko(G+1),K=Ny(r[S-1],L,0);if(K>t){var o=0,V=0,q=K-t,z=1<<q;for(s.sort(function(Et,xt){return L[xt.s]-L[Et.s]||Et.f-xt.f});o<A;++o){var it=s[o].s;if(L[it]>t)V+=z-(1<<K-L[it]),L[it]=t;else break}for(V>>>=q;V>0;){var At=s[o].s;L[At]<t?V-=1<<t-L[At]++-1:++o}for(;o>=0&&V;--o){var _t=s[o].s;L[_t]==t&&(--L[_t],++V)}K=t}return[new Fo(L),K]},Ny=function(n,t,r){return n.s==-1?Math.max(Ny(n.l,t,r+1),Ny(n.r,t,r+1)):t[n.s]=r},I5=function(n){for(var t=n.length;t&&!n[--t];);for(var r=new ko(++t),o=0,A=n[0],s=1,d=function(I){r[o++]=I},f=1;f<=t;++f)if(n[f]==A&&f!=t)++s;else{if(!A&&s>2){for(;s>138;s-=138)d(32754);s>2&&(d(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(d(A),--s;s>6;s-=6)d(8304);s>2&&(d(s-3<<5|8208),s=0)}for(;s--;)d(A);s=1,A=n[f]}return[r.subarray(0,o),t]},Jg=function(n,t){for(var r=0,o=0;o<t.length;++o)r+=n[o]*t[o];return r},rm=function(n,t,r){var o=r.length,A=jy(t+2);n[A]=o&255,n[A+1]=o>>>8,n[A+2]=n[A]^255,n[A+3]=n[A+1]^255;for(var s=0;s<o;++s)n[A+s+4]=r[s];return(A+4+o)*8},y5=function(n,t,r,o,A,s,d,f,I,_,S){Ul(t,S++,r),++A[256];for(var U=Ty(A,15),G=U[0],L=U[1],K=Ty(s,15),V=K[0],q=K[1],z=I5(G),it=z[0],At=z[1],_t=I5(V),Lt=_t[0],Et=_t[1],xt=new ko(19),It=0;It<it.length;++It)xt[it[It]&31]++;for(var It=0;It<Lt.length;++It)xt[Lt[It]&31]++;for(var Nt=Ty(xt,7),ie=Nt[0],lt=Nt[1],at=19;at>4&&!ie[Py[at-1]];--at);var St=_+5<<3,Bt=Jg(A,mc)+Jg(s,qg)+d,se=Jg(A,G)+Jg(s,V)+d+14+3*at+Jg(xt,ie)+(2*xt[16]+3*xt[17]+7*xt[18]);if(St<=Bt&&St<=se)return rm(t,S,n.subarray(I,I+_));var ee,qt,Xt,vt;if(Ul(t,S,1+(se<Bt)),S+=2,se<Bt){ee=el(G,L,0),qt=G,Xt=el(V,q,0),vt=V;var Tt=el(ie,lt,0);Ul(t,S,At-257),Ul(t,S+5,Et-1),Ul(t,S+10,at-4),S+=14;for(var It=0;It<at;++It)Ul(t,S+3*It,ie[Py[It]]);S+=3*at;for(var pe=[it,Lt],j=0;j<2;++j)for(var mt=pe[j],It=0;It<mt.length;++It){var yt=mt[It]&31;Ul(t,S,Tt[yt]),S+=ie[yt],yt>15&&(Ul(t,S,mt[It]>>>5&127),S+=mt[It]>>>12)}}else ee=_D,qt=mc,Xt=SD,vt=qg;for(var It=0;It<f;++It)if(o[It]>255){var yt=o[It]>>>18&31;Wg(t,S,ee[yt+257]),S+=qt[yt+257],yt>7&&(Ul(t,S,o[It]>>>23&31),S+=hm[yt]);var Qt=o[It]&31;Wg(t,S,Xt[Qt]),S+=vt[Qt],Qt>3&&(Wg(t,S,o[It]>>>5&8191),S+=gm[Qt])}else Wg(t,S,ee[o[It]]),S+=qt[o[It]];return Wg(t,S,ee[256]),S+qt[256]},LD=new jg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ED=new Fo(0),TD=function(n,t,r,o,A,s){var d=n.length,f=new Fo(o+d+5*(1+Math.floor(d/7e3))+A),I=f.subarray(o,f.length-A),_=0;if(!t||d<8)for(var S=0;S<=d;S+=65535){var U=S+65535;U<d?_=rm(I,_,n.subarray(S,U)):(I[S]=s,_=rm(I,_,n.subarray(S,d)))}else{for(var G=LD[t-1],L=G>>>13,K=G&8191,V=(1<<r)-1,q=new ko(32768),z=new ko(V+1),it=Math.ceil(r/3),At=2*it,_t=function(Kt){return(n[Kt]^n[Kt+1]<<it^n[Kt+2]<<At)&V},Lt=new jg(25e3),Et=new ko(288),xt=new ko(32),It=0,Nt=0,S=0,ie=0,lt=0,at=0;S<d;++S){var St=_t(S),Bt=S&32767,se=z[St];if(q[Bt]=se,z[St]=Bt,lt<=S){var ee=d-S;if((It>7e3||ie>24576)&&ee>423){_=y5(n,I,0,Lt,Et,xt,Nt,ie,at,S-at,_),ie=It=Nt=0,at=S;for(var qt=0;qt<286;++qt)Et[qt]=0;for(var qt=0;qt<30;++qt)xt[qt]=0}var Xt=2,vt=0,Tt=K,pe=Bt-se&32767;if(ee>2&&St==_t(S-pe))for(var j=Math.min(L,ee)-1,mt=Math.min(32767,S),yt=Math.min(258,ee);pe<=mt&&--Tt&&Bt!=se;){if(n[S+Xt]==n[S+Xt-pe]){for(var Qt=0;Qt<yt&&n[S+Qt]==n[S+Qt-pe];++Qt);if(Qt>Xt){if(Xt=Qt,vt=pe,Qt>j)break;for(var Ht=Math.min(pe,Qt-2),ae=0,qt=0;qt<Ht;++qt){var ge=S-pe+qt+32768&32767,de=q[ge],Ze=ge-de+32768&32767;Ze>ae&&(ae=Ze,se=ge)}}}Bt=se,se=q[Bt],pe+=Bt-se+32768&32767}if(vt){Lt[ie++]=268435456|Hy[Xt]<<18|C5[vt];var Re=Hy[Xt]&31,Je=C5[vt]&31;Nt+=hm[Re]+gm[Je],++Et[257+Re],++xt[Je],lt=S+Xt,++It}else Lt[ie++]=n[S],++Et[n[S]]}}_=y5(n,I,s,Lt,Et,xt,Nt,ie,at,S-at,_),s||(_=rm(I,_,ED))}return z5(f,0,o+jy(_)+A)},UD=function(){var n=1,t=0;return{p:function(r){for(var o=n,A=t,s=r.length,d=0;d!=s;){for(var f=Math.min(d+5552,s);d<f;++d)o+=r[d],A+=o;o%=65521,A%=65521}n=o,t=A},d:function(){return(n>>>8<<16|(t&255)<<8|t>>>8)+((n&255)<<23)*2}}},QD=function(n,t,r,o,A){return TD(n,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):12+t.mem,r,o,!A)},RD=function(n,t,r){for(;r;++t)n[t]=r,r>>>=8},GD=function(n,t){var r=t.level,o=r==0?0:r<6?1:r==9?3:2;n[0]=120,n[1]=o<<6|(o?32-2*o:1)},ZD=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};qi=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();sn={log:Uy,warn:function(n){qi.console&&(typeof qi.console.warn=="function"?qi.console.warn.apply(qi.console,arguments):Uy.call(null,arguments))},error:function(n){qi.console&&(typeof qi.console.error=="function"?qi.console.error.apply(qi.console,arguments):Uy(n))}};su=qi.saveAs||((typeof window>"u"?"undefined":Sr(window))!=="object"||window!==qi?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,t,r){var o=qi.URL||qi.webkitURL,A=document.createElement("a");t=t||n.name||"download",A.download=t,A.rel="noopener",typeof n=="string"?(A.href=n,A.origin!==location.origin?b5(A.href)?Qy(n,t,r):$f(A,A.target="_blank"):$f(A)):(A.href=o.createObjectURL(n),setTimeout(function(){o.revokeObjectURL(A.href)},4e4),setTimeout(function(){$f(A)},0))}:"msSaveOrOpenBlob"in navigator?function(n,t,r){if(t=t||n.name||"download",typeof n=="string")if(b5(n))Qy(n,t,r);else{var o=document.createElement("a");o.href=n,o.target="_blank",setTimeout(function(){$f(o)})}else navigator.msSaveOrOpenBlob(function(A,s){return s===void 0?s={autoBom:!1}:Sr(s)!=="object"&&(sn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(A.type)?new Blob(["\uFEFF",A],{type:A.type}):A}(n,r),t)}:function(n,t,r,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),typeof n=="string")return Qy(n,t,r);var A=n.type==="application/octet-stream",s=/constructor/i.test(qi.HTMLElement)||qi.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||A&&s)&&(typeof FileReader>"u"?"undefined":Sr(FileReader))==="object"){var f=new FileReader;f.onloadend=function(){var S=f.result;S=d?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=S:location=S,o=null},f.readAsDataURL(n)}else{var I=qi.URL||qi.webkitURL,_=I.createObjectURL(n);o?o.location=_:location.href=_,o=null,setTimeout(function(){I.revokeObjectURL(_)},4e4)}});Yg=qi.atob.bind(qi),Dy=qi.btoa.bind(qi);v5="0123456789abcdef".split("");VD=function(n){for(var t=0;t<n.length;t++)n[t]=MD(n[t]);return n.join("")}(W5("hello"))!="5d41402abc4b2a76b9719d911017c592";w5={print:4,modify:8,copy:16,"annot-forms":32};dh.prototype.lsbFirstWord=function(n){return String.fromCharCode(n>>0&255,n>>8&255,n>>16&255,n>>24&255)},dh.prototype.toHexString=function(n){return n.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},dh.prototype.hexToBytes=function(n){for(var t=[],r=0;r<n.length;r+=2)t.push(String.fromCharCode(parseInt(n.substr(r,2),16)));return t.join("")},dh.prototype.processOwnerPassword=function(n,t){return zy(Ky(t).substr(0,5),n)},dh.prototype.encryptor=function(n,t){var r=Ky(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&t,t>>8&255)).substr(0,10);return function(o){return zy(r,o)}},lm.prototype.equals=function(n){var t,r="id,objectNumber,equals";if(!n||Sr(n)!==Sr(this))return!1;var o=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!n.hasOwnProperty(t)||this[t]!==n[t])return!1;o++}for(t in n)n.hasOwnProperty(t)&&r.indexOf(t)<0&&o--;return o===0},ji.API={events:[]},ji.version="2.5.1";Sn=ji.API,qy=1,Au=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hh=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},cr=function(n){return n.toFixed(2)},dc=function(n){return n.toFixed(5)};Sn.__acroform__={};Ko=function(n,t){n.prototype=Object.create(t.prototype),n.prototype.constructor=n},_5=function(n){return n*qy},$A=function(n){var t=new Y5,r=Ei.internal.getHeight(n)||0,o=Ei.internal.getWidth(n)||0;return t.BBox=[0,0,Number(cr(o)),Number(cr(r))],t},DD=Sn.__acroform__.setBit=function(n,t){if(n=n||0,t=t||0,isNaN(n)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|=1<<t},KD=Sn.__acroform__.clearBit=function(n,t){if(n=n||0,t=t||0,isNaN(n)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&=~(1<<t)},zD=Sn.__acroform__.getBit=function(n,t){if(isNaN(n)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<t?1:0},Nn=Sn.__acroform__.getBitForPdf=function(n,t){if(isNaN(n)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return zD(n,t-1)},Vn=Sn.__acroform__.setBitForPdf=function(n,t){if(isNaN(n)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return DD(n,t-1)},Dn=Sn.__acroform__.clearBitForPdf=function(n,t){if(isNaN(n)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return KD(n,t-1)},OD=Sn.__acroform__.calculateCoordinates=function(n,t){var r=t.internal.getHorizontalCoordinate,o=t.internal.getVerticalCoordinate,A=n[0],s=n[1],d=n[2],f=n[3],I={};return I.lowerLeft_X=r(A)||0,I.lowerLeft_Y=o(s+f)||0,I.upperRight_X=r(A+d)||0,I.upperRight_Y=o(s)||0,[Number(cr(I.lowerLeft_X)),Number(cr(I.lowerLeft_Y)),Number(cr(I.upperRight_X)),Number(cr(I.upperRight_Y))]},WD=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var t=[],r=n._V||n.DV,o=Oy(n,r),A=n.scope.internal.getFont(n.fontName,n.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(n.scope.__private__.encodeColorString(n.color)),t.push("/"+A+" "+cr(o.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=$A(n);return s.scope=n.scope,s.stream=t.join(`
`),s}},Oy=function(n,t){var r=n.fontSize===0?n.maxFontSize:n.fontSize,o={text:"",fontSize:""},A=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");A=n.multiline?A.map(function(lt){return lt.split(`
`)}):A.map(function(lt){return[lt]});var s=r,d=Ei.internal.getHeight(n)||0;d=d<0?-d:d;var f=Ei.internal.getWidth(n)||0;f=f<0?-f:f;var I=function(lt,at,St){if(lt+1<A.length){var Bt=at+" "+A[lt+1][0];return tm(Bt,n,St).width<=f-4}return!1};s++;t:for(;s>0;){t="",s--;var _,S,U=tm("3",n,s).height,G=n.multiline?d-s:(d-U)/2,L=G+=2,K=0,V=0,q=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+tm(t,n,s=12).width+", FieldWidth:"+f+`
`;break}for(var z="",it=0,At=0;At<A.length;At++)if(A.hasOwnProperty(At)){var _t=!1;if(A[At].length!==1&&q!==A[At].length-1){if((U+2)*(it+2)+2>d)continue t;z+=A[At][q],_t=!0,V=At,At--}else{z=(z+=A[At][q]+" ").substr(z.length-1)==" "?z.substr(0,z.length-1):z;var Lt=parseInt(At),Et=I(Lt,z,s),xt=At>=A.length-1;if(Et&&!xt){z+=" ",q=0;continue}if(Et||xt){if(xt)V=Lt;else if(n.multiline&&(U+2)*(it+2)+2>d)continue t}else{if(!n.multiline||(U+2)*(it+2)+2>d)continue t;V=Lt}}for(var It="",Nt=K;Nt<=V;Nt++){var ie=A[Nt];if(n.multiline){if(Nt===V){It+=ie[q]+" ",q=(q+1)%ie.length;continue}if(Nt===K){It+=ie[ie.length-1]+" ";continue}}It+=ie[0]+" "}switch(It=It.substr(It.length-1)==" "?It.substr(0,It.length-1):It,S=tm(It,n,s).width,n.textAlign){case"right":_=f-S-2;break;case"center":_=(f-S)/2;break;case"left":default:_=2}t+=cr(_)+" "+cr(L)+` Td
`,t+="("+Au(It)+`) Tj
`,t+=-cr(_)+` 0 Td
`,L=-(s+2),S=0,K=_t?V:V+1,it++,z=""}break}return o.text=t,o.fontSize=s,o},tm=function(n,t,r){var o=t.scope.internal.getFont(t.fontName,t.fontStyle),A=t.scope.getStringUnitWidth(n,{font:o,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:o,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:A}},JD={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},XD=function(n,t){var r={type:"reference",object:n};t.internal.getPageInfo(n.page).pageContext.annotations.find(function(o){return o.type===r.type&&o.object===r.object})===void 0&&t.internal.getPageInfo(n.page).pageContext.annotations.push(r)},YD=function(n,t){for(var r in n)if(n.hasOwnProperty(r)){var o=r,A=n[r];t.internal.newObjectDeferredBegin(A.objId,!0),Sr(A)==="object"&&typeof A.putStream=="function"&&A.putStream(),delete n[o]}},jD=function(n,t){if(t.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(CA.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(JD)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");qy=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new j5,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var o=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var A in o)if(o.hasOwnProperty(A)){var s=o[A];s.objId=void 0,s.hasAnnotation&&XD(s,r)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(r){(function(o,A){var s=!o;for(var d in o||(A.internal.newObjectDeferredBegin(A.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),A.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),o=o||A.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(o.hasOwnProperty(d)){var f=o[d],I=[],_=f.Rect;if(f.Rect&&(f.Rect=OD(f.Rect,A)),A.internal.newObjectDeferredBegin(f.objId,!0),f.DA=Ei.createDefaultAppearanceStream(f),Sr(f)==="object"&&typeof f.getKeyValueListForStream=="function"&&(I=f.getKeyValueListForStream()),f.Rect=_,f.hasAppearanceStream&&!f.appearanceStreamContent){var S=WD(f);I.push({key:"AP",value:"<</N "+S+">>"}),A.internal.acroformPlugin.xForms.push(S)}if(f.appearanceStreamContent){var U="";for(var G in f.appearanceStreamContent)if(f.appearanceStreamContent.hasOwnProperty(G)){var L=f.appearanceStreamContent[G];if(U+="/"+G+" ",U+="<<",Object.keys(L).length>=1||Array.isArray(L)){for(var d in L)if(L.hasOwnProperty(d)){var K=L[d];typeof K=="function"&&(K=K.call(A,f)),U+="/"+d+" "+K+" ",A.internal.acroformPlugin.xForms.indexOf(K)>=0||A.internal.acroformPlugin.xForms.push(K)}}else typeof(K=L)=="function"&&(K=K.call(A,f)),U+="/"+d+" "+K,A.internal.acroformPlugin.xForms.indexOf(K)>=0||A.internal.acroformPlugin.xForms.push(K);U+=">>"}I.push({key:"AP",value:`<<
`+U+">>"})}A.internal.putStream({additionalKeyValues:I,objectId:f.objId}),A.internal.out("endobj")}s&&YD(A.internal.acroformPlugin.xForms,A)})(r,n)}),n.internal.acroformPlugin.isInitialized=!0}},X5=Sn.__acroform__.arrayToPdfArray=function(n,t,r){var o=function(d){return d};if(Array.isArray(n)){for(var A="[",s=0;s<n.length;s++)switch(s!==0&&(A+=" "),Sr(n[s])){case"boolean":case"number":case"object":A+=n[s].toString();break;case"string":n[s].substr(0,1)!=="/"?(t!==void 0&&r&&(o=r.internal.getEncryptor(t)),A+="("+Au(o(n[s].toString()))+")"):A+=n[s].toString()}return A+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Gy=function(n,t,r){var o=function(A){return A};return t!==void 0&&r&&(o=r.internal.getEncryptor(t)),(n=n||"").toString(),n="("+Au(o(n))+")"},tl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};tl.prototype.toString=function(){return this.objId+" 0 R"},tl.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},tl.prototype.getKeyValueListForStream=function(){var n=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var o=t[r],A=this[o];A&&(Array.isArray(A)?n.push({key:o,value:X5(A,this.objId,this.scope)}):A instanceof tl?(A.scope=this.scope,n.push({key:o,value:A.objId+" 0 R"})):typeof A!="function"&&n.push({key:o,value:A}))}return n};Y5=function(){tl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){n=r.trim()},get:function(){return n||null}})};Ko(Y5,tl);j5=function(){tl.call(this);var n,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var r=function(o){return o};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Au(r(n))+")"}},set:function(r){n=r}})};Ko(j5,tl);CA=function n(){tl.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(z){if(isNaN(z))throw new Error('Invalid value "'+z+'" for attribute F supplied.');t=z}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Nn(t,3)},set:function(z){z?this.F=Vn(t,3):this.F=Dn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(z){if(isNaN(z))throw new Error('Invalid value "'+z+'" for attribute Ff supplied.');r=z}});var o=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(o.length!==0)return o},set:function(z){o=z!==void 0?z:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!o||isNaN(o[0])?0:o[0]},set:function(z){o[0]=z}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!o||isNaN(o[1])?0:o[1]},set:function(z){o[1]=z}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!o||isNaN(o[2])?0:o[2]},set:function(z){o[2]=z}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!o||isNaN(o[3])?0:o[3]},set:function(z){o[3]=z}});var A="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return A},set:function(z){switch(z){case"/Btn":case"/Tx":case"/Ch":case"/Sig":A=z;break;default:throw new Error('Invalid value "'+z+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof cm)return;s="FieldObject"+n.FieldNum++}var z=function(it){return it};return this.scope&&(z=this.scope.internal.getEncryptor(this.objId)),"("+Au(z(s))+")"},set:function(z){s=z.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(z){s=z}});var d="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return d},set:function(z){d=z}});var f="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return f},set:function(z){f=z}});var I=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return I},set:function(z){I=z}});var _=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return _===void 0?50/qy:_},set:function(z){_=z}});var S="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return S},set:function(z){S=z}});var U="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!U||this instanceof cm||this instanceof au))return Gy(U,this.objId,this.scope)},set:function(z){z=z.toString(),U=z}});var G=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(G)return this instanceof ms?G:Gy(G,this.objId,this.scope)},set:function(z){z=z.toString(),G=this instanceof ms?z:z.substr(0,1)==="("?hh(z.substr(1,z.length-2)):hh(z)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ms?hh(G.substr(1,G.length-1)):G},set:function(z){z=z.toString(),G=this instanceof ms?"/"+z:z}});var L=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(L)return L},set:function(z){this.V=z}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(L)return this instanceof ms?L:Gy(L,this.objId,this.scope)},set:function(z){z=z.toString(),L=this instanceof ms?z:z.substr(0,1)==="("?hh(z.substr(1,z.length-2)):hh(z)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ms?hh(L.substr(1,L.length-1)):L},set:function(z){z=z.toString(),L=this instanceof ms?"/"+z:z}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var K,V=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return V},set:function(z){z=!!z,V=z}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(K)return K},set:function(z){K=z}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,1)},set:function(z){z?this.Ff=Vn(this.Ff,1):this.Ff=Dn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,2)},set:function(z){z?this.Ff=Vn(this.Ff,2):this.Ff=Dn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,3)},set:function(z){z?this.Ff=Vn(this.Ff,3):this.Ff=Dn(this.Ff,3)}});var q=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(q!==null)return q},set:function(z){if([0,1,2].indexOf(z)===-1)throw new Error('Invalid value "'+z+'" for attribute Q supplied.');q=z}}),Object.defineProperty(this,"textAlign",{get:function(){var z;switch(q){case 0:default:z="left";break;case 1:z="center";break;case 2:z="right"}return z},configurable:!0,enumerable:!0,set:function(z){switch(z){case"right":case 2:q=2;break;case"center":case 1:q=1;break;case"left":case 0:default:q=0}}})};Ko(CA,tl);Ch=function(){CA.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(r){n=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return X5(t,this.objId,this.scope)},set:function(r){var o,A;A=[],typeof(o=r)=="string"&&(A=function(s,d,f){f||(f=1);for(var I,_=[];I=d.exec(s);)_.push(I[f]);return _}(o,/\((.*?)\)/g)),t=A}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,o){for(o=o||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),o!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,18)},set:function(r){r?this.Ff=Vn(this.Ff,18):this.Ff=Dn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Vn(this.Ff,19):this.Ff=Dn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,20)},set:function(r){r?(this.Ff=Vn(this.Ff,20),t.sort()):this.Ff=Dn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,22)},set:function(r){r?this.Ff=Vn(this.Ff,22):this.Ff=Dn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,23)},set:function(r){r?this.Ff=Vn(this.Ff,23):this.Ff=Dn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,27)},set:function(r){r?this.Ff=Vn(this.Ff,27):this.Ff=Dn(this.Ff,27)}}),this.hasAppearanceStream=!1};Ko(Ch,CA);Ih=function(){Ch.call(this),this.fontName="helvetica",this.combo=!1};Ko(Ih,Ch);yh=function(){Ih.call(this),this.combo=!0};Ko(yh,Ih);nm=function(){yh.call(this),this.edit=!0};Ko(nm,yh);ms=function(){CA.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,15)},set:function(r){r?this.Ff=Vn(this.Ff,15):this.Ff=Dn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,16)},set:function(r){r?this.Ff=Vn(this.Ff,16):this.Ff=Dn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,17)},set:function(r){r?this.Ff=Vn(this.Ff,17):this.Ff=Dn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,26)},set:function(r){r?this.Ff=Vn(this.Ff,26):this.Ff=Dn(this.Ff,26)}});var n,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var o,A=[];for(o in A.push("<<"),t)A.push("/"+o+" ("+Au(r(t[o]))+")");return A.push(">>"),A.join(`
`)}},set:function(r){Sr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(r){n="/"+r}})};Ko(ms,CA);sm=function(){ms.call(this),this.pushButton=!0};Ko(sm,ms);bh=function(){ms.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t!==void 0?t:[]}})};Ko(bh,ms);cm=function(){var n,t;CA.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(A){n=A}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(A){t=A}});var r,o={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var A=function(f){return f};this.scope&&(A=this.scope.internal.getEncryptor(this.objId));var s,d=[];for(s in d.push("<<"),o)d.push("/"+s+" ("+Au(A(o[s]))+")");return d.push(">>"),d.join(`
`)},set:function(A){Sr(A)==="object"&&(o=A)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return o.CA||""},set:function(A){typeof A=="string"&&(o.CA=A)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(A){r=A}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(A){r="/"+A}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ei.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ko(cm,CA),bh.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=n.createAppearanceStream(r.optionName),r.caption=n.getCA()}},bh.prototype.createOption=function(n){var t=new cm;return t.Parent=this,t.optionName=n,this.Kids.push(t),qD.call(this.scope,t),t};om=function(){ms.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ei.CheckBox.createAppearanceStream()};Ko(om,ms);au=function(){CA.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,13)},set:function(t){t?this.Ff=Vn(this.Ff,13):this.Ff=Dn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,21)},set:function(t){t?this.Ff=Vn(this.Ff,21):this.Ff=Dn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,23)},set:function(t){t?this.Ff=Vn(this.Ff,23):this.Ff=Dn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,24)},set:function(t){t?this.Ff=Vn(this.Ff,24):this.Ff=Dn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,25)},set:function(t){t?this.Ff=Vn(this.Ff,25):this.Ff=Dn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,26)},set:function(t){t?this.Ff=Vn(this.Ff,26):this.Ff=Dn(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){Number.isInteger(t)&&(n=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ko(au,CA);am=function(){au.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Nn(this.Ff,14)},set:function(n){n?this.Ff=Vn(this.Ff,14):this.Ff=Dn(this.Ff,14)}}),this.password=!0};Ko(am,au);Ei={CheckBox:{createAppearanceStream:function(){return{N:{On:Ei.CheckBox.YesNormal},D:{On:Ei.CheckBox.YesPushDown,Off:Ei.CheckBox.OffPushDown}}},YesPushDown:function(n){var t=$A(n);t.scope=n.scope;var r=[],o=n.scope.internal.getFont(n.fontName,n.fontStyle).id,A=n.scope.__private__.encodeColorString(n.color),s=Oy(n,n.caption);return r.push("0.749023 g"),r.push("0 0 "+cr(Ei.internal.getWidth(n))+" "+cr(Ei.internal.getHeight(n))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+o+" "+cr(s.fontSize)+" Tf "+A),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(n){var t=$A(n);t.scope=n.scope;var r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,o=n.scope.__private__.encodeColorString(n.color),A=[],s=Ei.internal.getHeight(n),d=Ei.internal.getWidth(n),f=Oy(n,n.caption);return A.push("1 g"),A.push("0 0 "+cr(d)+" "+cr(s)+" re"),A.push("f"),A.push("q"),A.push("0 0 1 rg"),A.push("0 0 "+cr(d-1)+" "+cr(s-1)+" re"),A.push("W"),A.push("n"),A.push("0 g"),A.push("BT"),A.push("/"+r+" "+cr(f.fontSize)+" Tf "+o),A.push(f.text),A.push("ET"),A.push("Q"),t.stream=A.join(`
`),t},OffPushDown:function(n){var t=$A(n);t.scope=n.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+cr(Ei.internal.getWidth(n))+" "+cr(Ei.internal.getHeight(n))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(n){var t={D:{Off:Ei.RadioButton.Circle.OffPushDown},N:{}};return t.N[n]=Ei.RadioButton.Circle.YesNormal,t.D[n]=Ei.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(n){var t=$A(n);t.scope=n.scope;var r=[],o=Ei.internal.getWidth(n)<=Ei.internal.getHeight(n)?Ei.internal.getWidth(n)/4:Ei.internal.getHeight(n)/4;o=Number((.9*o).toFixed(5));var A=Ei.internal.Bezier_C,s=Number((o*A).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+dc(Ei.internal.getWidth(n)/2)+" "+dc(Ei.internal.getHeight(n)/2)+" cm"),r.push(o+" 0 m"),r.push(o+" "+s+" "+s+" "+o+" 0 "+o+" c"),r.push("-"+s+" "+o+" -"+o+" "+s+" -"+o+" 0 c"),r.push("-"+o+" -"+s+" -"+s+" -"+o+" 0 -"+o+" c"),r.push(s+" -"+o+" "+o+" -"+s+" "+o+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(n){var t=$A(n);t.scope=n.scope;var r=[],o=Ei.internal.getWidth(n)<=Ei.internal.getHeight(n)?Ei.internal.getWidth(n)/4:Ei.internal.getHeight(n)/4;o=Number((.9*o).toFixed(5));var A=Number((2*o).toFixed(5)),s=Number((A*Ei.internal.Bezier_C).toFixed(5)),d=Number((o*Ei.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+dc(Ei.internal.getWidth(n)/2)+" "+dc(Ei.internal.getHeight(n)/2)+" cm"),r.push(A+" 0 m"),r.push(A+" "+s+" "+s+" "+A+" 0 "+A+" c"),r.push("-"+s+" "+A+" -"+A+" "+s+" -"+A+" 0 c"),r.push("-"+A+" -"+s+" -"+s+" -"+A+" 0 -"+A+" c"),r.push(s+" -"+A+" "+A+" -"+s+" "+A+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+dc(Ei.internal.getWidth(n)/2)+" "+dc(Ei.internal.getHeight(n)/2)+" cm"),r.push(o+" 0 m"),r.push(o+" "+d+" "+d+" "+o+" 0 "+o+" c"),r.push("-"+d+" "+o+" -"+o+" "+d+" -"+o+" 0 c"),r.push("-"+o+" -"+d+" -"+d+" -"+o+" 0 -"+o+" c"),r.push(d+" -"+o+" "+o+" -"+d+" "+o+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(n){var t=$A(n);t.scope=n.scope;var r=[],o=Ei.internal.getWidth(n)<=Ei.internal.getHeight(n)?Ei.internal.getWidth(n)/4:Ei.internal.getHeight(n)/4;o=Number((.9*o).toFixed(5));var A=Number((2*o).toFixed(5)),s=Number((A*Ei.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+dc(Ei.internal.getWidth(n)/2)+" "+dc(Ei.internal.getHeight(n)/2)+" cm"),r.push(A+" 0 m"),r.push(A+" "+s+" "+s+" "+A+" 0 "+A+" c"),r.push("-"+s+" "+A+" -"+A+" "+s+" -"+A+" 0 c"),r.push("-"+A+" -"+s+" -"+s+" -"+A+" 0 -"+A+" c"),r.push(s+" -"+A+" "+A+" -"+s+" "+A+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(n){var t={D:{Off:Ei.RadioButton.Cross.OffPushDown},N:{}};return t.N[n]=Ei.RadioButton.Cross.YesNormal,t.D[n]=Ei.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(n){var t=$A(n);t.scope=n.scope;var r=[],o=Ei.internal.calculateCross(n);return r.push("q"),r.push("1 1 "+cr(Ei.internal.getWidth(n)-2)+" "+cr(Ei.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(cr(o.x1.x)+" "+cr(o.x1.y)+" m"),r.push(cr(o.x2.x)+" "+cr(o.x2.y)+" l"),r.push(cr(o.x4.x)+" "+cr(o.x4.y)+" m"),r.push(cr(o.x3.x)+" "+cr(o.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(n){var t=$A(n);t.scope=n.scope;var r=Ei.internal.calculateCross(n),o=[];return o.push("0.749023 g"),o.push("0 0 "+cr(Ei.internal.getWidth(n))+" "+cr(Ei.internal.getHeight(n))+" re"),o.push("f"),o.push("q"),o.push("1 1 "+cr(Ei.internal.getWidth(n)-2)+" "+cr(Ei.internal.getHeight(n)-2)+" re"),o.push("W"),o.push("n"),o.push(cr(r.x1.x)+" "+cr(r.x1.y)+" m"),o.push(cr(r.x2.x)+" "+cr(r.x2.y)+" l"),o.push(cr(r.x4.x)+" "+cr(r.x4.y)+" m"),o.push(cr(r.x3.x)+" "+cr(r.x3.y)+" l"),o.push("s"),o.push("Q"),t.stream=o.join(`
`),t},OffPushDown:function(n){var t=$A(n);t.scope=n.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+cr(Ei.internal.getWidth(n))+" "+cr(Ei.internal.getHeight(n))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(n){var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color);return"/"+t+" "+n.fontSize+" Tf "+r}};Ei.internal={Bezier_C:.551915024494,calculateCross:function(n){var t=Ei.internal.getWidth(n),r=Ei.internal.getHeight(n),o=Math.min(t,r);return{x1:{x:(t-o)/2,y:(r-o)/2+o},x2:{x:(t-o)/2+o,y:(r-o)/2},x3:{x:(t-o)/2,y:(r-o)/2},x4:{x:(t-o)/2+o,y:(r-o)/2+o}}}},Ei.internal.getWidth=function(n){var t=0;return Sr(n)==="object"&&(t=_5(n.Rect[2])),t},Ei.internal.getHeight=function(n){var t=0;return Sr(n)==="object"&&(t=_5(n.Rect[3])),t};qD=Sn.addField=function(n){if(jD(this,n),!(n instanceof CA))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=n).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};Sn.AcroFormChoiceField=Ch,Sn.AcroFormListBox=Ih,Sn.AcroFormComboBox=yh,Sn.AcroFormEditBox=nm,Sn.AcroFormButton=ms,Sn.AcroFormPushButton=sm,Sn.AcroFormRadioButton=bh,Sn.AcroFormCheckBox=om,Sn.AcroFormTextField=au,Sn.AcroFormPasswordField=am,Sn.AcroFormAppearance=Ei,Sn.AcroForm={ChoiceField:Ch,ListBox:Ih,ComboBox:yh,EditBox:nm,Button:ms,PushButton:sm,RadioButton:bh,CheckBox:om,TextField:au,PasswordField:am,Appearance:Ei},ji.AcroForm={ChoiceField:Ch,ListBox:Ih,ComboBox:yh,EditBox:nm,Button:ms,PushButton:sm,RadioButton:bh,CheckBox:om,TextField:au,PasswordField:am,Appearance:Ei};(function(n){n.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},o=n.__addimage__.getImageFileTypeByImageData=function(lt,at){var St,Bt,se,ee,qt,Xt=t;if((at=at||t)==="RGBA"||lt.data!==void 0&&lt.data instanceof Uint8ClampedArray&&"height"in lt&&"width"in lt)return"RGBA";if(Et(lt))for(qt in r)for(se=r[qt],St=0;St<se.length;St+=1){for(ee=!0,Bt=0;Bt<se[St].length;Bt+=1)if(se[St][Bt]!==void 0&&se[St][Bt]!==lt[Bt]){ee=!1;break}if(ee===!0){Xt=qt;break}}else for(qt in r)for(se=r[qt],St=0;St<se.length;St+=1){for(ee=!0,Bt=0;Bt<se[St].length;Bt+=1)if(se[St][Bt]!==void 0&&se[St][Bt]!==lt.charCodeAt(Bt)){ee=!1;break}if(ee===!0){Xt=qt;break}}return Xt===t&&at!==t&&(Xt=at),Xt},A=function lt(at){for(var St=this.internal.write,Bt=this.internal.putStream,se=(0,this.internal.getFilters)();se.indexOf("FlateEncode")!==-1;)se.splice(se.indexOf("FlateEncode"),1);at.objectId=this.internal.newObject();var ee=[];if(ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Image"}),ee.push({key:"Width",value:at.width}),ee.push({key:"Height",value:at.height}),at.colorSpace===q.INDEXED?ee.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(at.palette.length/3-1)+" "+("sMask"in at&&at.sMask!==void 0?at.objectId+2:at.objectId+1)+" 0 R]"}):(ee.push({key:"ColorSpace",value:"/"+at.colorSpace}),at.colorSpace===q.DEVICE_CMYK&&ee.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ee.push({key:"BitsPerComponent",value:at.bitsPerComponent}),"decodeParameters"in at&&at.decodeParameters!==void 0&&ee.push({key:"DecodeParms",value:"<<"+at.decodeParameters+">>"}),"transparency"in at&&Array.isArray(at.transparency)){for(var qt="",Xt=0,vt=at.transparency.length;Xt<vt;Xt++)qt+=at.transparency[Xt]+" "+at.transparency[Xt]+" ";ee.push({key:"Mask",value:"["+qt+"]"})}at.sMask!==void 0&&ee.push({key:"SMask",value:at.objectId+1+" 0 R"});var Tt=at.filter!==void 0?["/"+at.filter]:void 0;if(Bt({data:at.data,additionalKeyValues:ee,alreadyAppliedFilters:Tt,objectId:at.objectId}),St("endobj"),"sMask"in at&&at.sMask!==void 0){var pe="/Predictor "+at.predictor+" /Colors 1 /BitsPerComponent "+at.bitsPerComponent+" /Columns "+at.width,j={width:at.width,height:at.height,colorSpace:"DeviceGray",bitsPerComponent:at.bitsPerComponent,decodeParameters:pe,data:at.sMask};"filter"in at&&(j.filter=at.filter),lt.call(this,j)}if(at.colorSpace===q.INDEXED){var mt=this.internal.newObject();Bt({data:It(new Uint8Array(at.palette)),objectId:mt}),St("endobj")}},s=function(){var lt=this.internal.collections.addImage_images;for(var at in lt)A.call(this,lt[at])},d=function(){var lt,at=this.internal.collections.addImage_images,St=this.internal.write;for(var Bt in at)St("/I"+(lt=at[Bt]).index,lt.objectId,"0","R")},f=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",d))},I=function(){var lt=this.internal.collections.addImage_images;return f.call(this),lt},_=function(){return Object.keys(this.internal.collections.addImage_images).length},S=function(lt){return typeof n["process"+lt.toUpperCase()]=="function"},U=function(lt){return Sr(lt)==="object"&&lt.nodeType===1},G=function(lt,at){if(lt.nodeName==="IMG"&&lt.hasAttribute("src")){var St=""+lt.getAttribute("src");if(St.indexOf("data:image/")===0)return Yg(unescape(St).split("base64,").pop());var Bt=n.loadFile(St,!0);if(Bt!==void 0)return Bt}if(lt.nodeName==="CANVAS"){if(lt.width===0||lt.height===0)throw new Error("Given canvas must have data. Canvas width: "+lt.width+", height: "+lt.height);var se;switch(at){case"PNG":se="image/png";break;case"WEBP":se="image/webp";break;case"JPEG":case"JPG":default:se="image/jpeg"}return Yg(lt.toDataURL(se,1).split("base64,").pop())}},L=function(lt){var at=this.internal.collections.addImage_images;if(at){for(var St in at)if(lt===at[St].alias)return at[St]}},K=function(lt,at,St){return lt||at||(lt=-96,at=-96),lt<0&&(lt=-1*St.width*72/lt/this.internal.scaleFactor),at<0&&(at=-1*St.height*72/at/this.internal.scaleFactor),lt===0&&(lt=at*St.width/St.height),at===0&&(at=lt*St.height/St.width),[lt,at]},V=function(lt,at,St,Bt,se,ee){var qt=K.call(this,St,Bt,se),Xt=this.internal.getCoordinateString,vt=this.internal.getVerticalCoordinateString,Tt=I.call(this);if(St=qt[0],Bt=qt[1],Tt[se.index]=se,ee){ee*=Math.PI/180;var pe=Math.cos(ee),j=Math.sin(ee),mt=function(Qt){return Qt.toFixed(4)},yt=[mt(pe),mt(j),mt(-1*j),mt(pe),0,0,"cm"]}this.internal.write("q"),ee?(this.internal.write([1,"0","0",1,Xt(lt),vt(at+Bt),"cm"].join(" ")),this.internal.write(yt.join(" ")),this.internal.write([Xt(St),"0","0",Xt(Bt),"0","0","cm"].join(" "))):this.internal.write([Xt(St),"0","0",Xt(Bt),Xt(lt),vt(at+Bt),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+se.index+" Do"),this.internal.write("Q")},q=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var z=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},it=n.__addimage__.sHashCode=function(lt){var at,St,Bt=0;if(typeof lt=="string")for(St=lt.length,at=0;at<St;at++)Bt=(Bt<<5)-Bt+lt.charCodeAt(at),Bt|=0;else if(Et(lt))for(St=lt.byteLength/2,at=0;at<St;at++)Bt=(Bt<<5)-Bt+lt[at],Bt|=0;return Bt},At=n.__addimage__.validateStringAsBase64=function(lt){(lt=lt||"").toString().trim();var at=!0;return lt.length===0&&(at=!1),lt.length%4!=0&&(at=!1),/^[A-Za-z0-9+/]+$/.test(lt.substr(0,lt.length-2))===!1&&(at=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(lt.substr(-2))===!1&&(at=!1),at},_t=n.__addimage__.extractImageFromDataUrl=function(lt){var at=(lt=lt||"").split("base64,"),St=null;if(at.length===2){var Bt=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(at[0]);Array.isArray(Bt)&&(St={mimeType:Bt[1],charset:Bt[2],data:at[1]})}return St},Lt=n.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};n.__addimage__.isArrayBuffer=function(lt){return Lt()&&lt instanceof ArrayBuffer};var Et=n.__addimage__.isArrayBufferView=function(lt){return Lt()&&typeof Uint32Array<"u"&&(lt instanceof Int8Array||lt instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&lt instanceof Uint8ClampedArray||lt instanceof Int16Array||lt instanceof Uint16Array||lt instanceof Int32Array||lt instanceof Uint32Array||lt instanceof Float32Array||lt instanceof Float64Array)},xt=n.__addimage__.binaryStringToUint8Array=function(lt){for(var at=lt.length,St=new Uint8Array(at),Bt=0;Bt<at;Bt++)St[Bt]=lt.charCodeAt(Bt);return St},It=n.__addimage__.arrayBufferToBinaryString=function(lt){for(var at="",St=Et(lt)?lt:new Uint8Array(lt),Bt=0;Bt<St.length;Bt+=8192)at+=String.fromCharCode.apply(null,St.subarray(Bt,Bt+8192));return at};n.addImage=function(){var lt,at,St,Bt,se,ee,qt,Xt,vt;if(typeof arguments[1]=="number"?(at=t,St=arguments[1],Bt=arguments[2],se=arguments[3],ee=arguments[4],qt=arguments[5],Xt=arguments[6],vt=arguments[7]):(at=arguments[1],St=arguments[2],Bt=arguments[3],se=arguments[4],ee=arguments[5],qt=arguments[6],Xt=arguments[7],vt=arguments[8]),Sr(lt=arguments[0])==="object"&&!U(lt)&&"imageData"in lt){var Tt=lt;lt=Tt.imageData,at=Tt.format||at||t,St=Tt.x||St||0,Bt=Tt.y||Bt||0,se=Tt.w||Tt.width||se,ee=Tt.h||Tt.height||ee,qt=Tt.alias||qt,Xt=Tt.compression||Xt,vt=Tt.rotation||Tt.angle||vt}var pe=this.internal.getFilters();if(Xt===void 0&&pe.indexOf("FlateEncode")!==-1&&(Xt="SLOW"),isNaN(St)||isNaN(Bt))throw new Error("Invalid coordinates passed to jsPDF.addImage");f.call(this);var j=Nt.call(this,lt,at,qt,Xt);return V.call(this,St,Bt,se,ee,j,vt),this};var Nt=function(lt,at,St,Bt){var se,ee,qt;if(typeof lt=="string"&&o(lt)===t){lt=unescape(lt);var Xt=ie(lt,!1);(Xt!==""||(Xt=n.loadFile(lt,!0))!==void 0)&&(lt=Xt)}if(U(lt)&&(lt=G(lt,at)),at=o(lt,at),!S(at))throw new Error("addImage does not support files of type '"+at+"', please ensure that a plugin for '"+at+"' support is added.");if(((qt=St)==null||qt.length===0)&&(St=function(vt){return typeof vt=="string"||Et(vt)?it(vt):Et(vt.data)?it(vt.data):null}(lt)),(se=L.call(this,St))||(Lt()&&(lt instanceof Uint8Array||at==="RGBA"||(ee=lt,lt=xt(lt))),se=this["process"+at.toUpperCase()](lt,_.call(this),St,function(vt){return vt&&typeof vt=="string"&&(vt=vt.toUpperCase()),vt in n.image_compression?vt:z.NONE}(Bt),ee)),!se)throw new Error("An unknown error occurred whilst processing the image.");return se},ie=n.__addimage__.convertBase64ToBinaryString=function(lt,at){var St;at=typeof at!="boolean"||at;var Bt,se="";if(typeof lt=="string"){Bt=(St=_t(lt))!==null?St.data:lt;try{se=Yg(Bt)}catch(ee){if(at)throw At(Bt)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ee.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return se};n.getImageProperties=function(lt){var at,St,Bt="";if(U(lt)&&(lt=G(lt)),typeof lt=="string"&&o(lt)===t&&((Bt=ie(lt,!1))===""&&(Bt=n.loadFile(lt)||""),lt=Bt),St=o(lt),!S(St))throw new Error("addImage does not support files of type '"+St+"', please ensure that a plugin for '"+St+"' support is added.");if(!Lt()||lt instanceof Uint8Array||(lt=xt(lt)),!(at=this["process"+St.toUpperCase()](lt)))throw new Error("An unknown error occurred whilst processing the image");return at.fileType=St,at}})(ji.API),function(n){var t=function(r){if(r!==void 0&&r!="")return!0};ji.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(r){for(var o,A,s,d=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString,I=this.internal.getPageInfoByObjId(r.objId),_=r.pageContext.annotations,S=!1,U=0;U<_.length&&!S;U++)switch((o=_[U]).type){case"link":(t(o.options.url)||t(o.options.pageNumber))&&(S=!0);break;case"reference":case"text":case"freetext":S=!0}if(S!=0){this.internal.write("/Annots [");for(var G=0;G<_.length;G++){o=_[G];var L=this.internal.pdfEscape,K=this.internal.getEncryptor(r.objId);switch(o.type){case"reference":this.internal.write(" "+o.object.objId+" 0 R ");break;case"text":var V=this.internal.newAdditionalObject(),q=this.internal.newAdditionalObject(),z=this.internal.getEncryptor(V.objId),it=o.title||"Note";s="<</Type /Annot /Subtype /Text "+(A="/Rect ["+d(o.bounds.x)+" "+f(o.bounds.y+o.bounds.h)+" "+d(o.bounds.x+o.bounds.w)+" "+f(o.bounds.y)+"] ")+"/Contents ("+L(z(o.contents))+")",s+=" /Popup "+q.objId+" 0 R",s+=" /P "+I.objId+" 0 R",s+=" /T ("+L(z(it))+") >>",V.content=s;var At=V.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(A="/Rect ["+d(o.bounds.x+30)+" "+f(o.bounds.y+o.bounds.h)+" "+d(o.bounds.x+o.bounds.w+30)+" "+f(o.bounds.y)+"] ")+" /Parent "+At,o.open&&(s+=" /Open true"),s+=" >>",q.content=s,this.internal.write(V.objId,"0 R",q.objId,"0 R");break;case"freetext":A="/Rect ["+d(o.bounds.x)+" "+f(o.bounds.y)+" "+d(o.bounds.x+o.bounds.w)+" "+f(o.bounds.y+o.bounds.h)+"] ";var _t=o.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+A+"/Contents ("+L(K(o.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+_t+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(o.options.name){var Lt=this.annotations._nameMap[o.options.name];o.options.pageNumber=Lt.page,o.options.top=Lt.y}else o.options.top||(o.options.top=0);if(A="/Rect ["+o.finalBounds.x+" "+o.finalBounds.y+" "+o.finalBounds.w+" "+o.finalBounds.h+"] ",s="",o.options.url)s="<</Type /Annot /Subtype /Link "+A+"/Border [0 0 0] /A <</S /URI /URI ("+L(K(o.options.url))+") >>";else if(o.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+A+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(o.options.pageNumber).objId+" 0 R",o.options.magFactor=o.options.magFactor||"XYZ",o.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+o.options.top+"]";break;case"FitV":o.options.left=o.options.left||0,s+=" /FitV "+o.options.left+"]";break;case"XYZ":default:var Et=f(o.options.top);o.options.left=o.options.left||0,o.options.zoom===void 0&&(o.options.zoom=0),s+=" /XYZ "+o.options.left+" "+Et+" "+o.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),n.createAnnotation=function(r){var o=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":o.pageContext.annotations.push(r)}},n.link=function(r,o,A,s,d){var f=this.internal.getCurrentPageInfo(),I=this.internal.getCoordinateString,_=this.internal.getVerticalCoordinateString;f.pageContext.annotations.push({finalBounds:{x:I(r),y:_(o),w:I(r+A),h:_(o+s)},options:d,type:"link"})},n.textWithLink=function(r,o,A,s){var d,f,I=this.getTextWidth(r),_=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){f=s.maxWidth;var S=this.splitTextToSize(r,f).length;d=Math.ceil(_*S)}else f=I,d=_;return this.text(r,o,A,s),A+=.2*_,s.align==="center"&&(o-=I/2),s.align==="right"&&(o-=I),this.link(o,A-_,f,d,s),I},n.getTextWidth=function(r){var o=this.internal.getFontSize();return this.getStringUnitWidth(r)*o/this.internal.scaleFactor}}(ji.API),function(n){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},o={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},A=[1570,1571,1573,1575];n.__arabicParser__={};var s=n.__arabicParser__.isInArabicSubstitutionA=function(V){return t[V.charCodeAt(0)]!==void 0},d=n.__arabicParser__.isArabicLetter=function(V){return typeof V=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(V)},f=n.__arabicParser__.isArabicEndLetter=function(V){return d(V)&&s(V)&&t[V.charCodeAt(0)].length<=2},I=n.__arabicParser__.isArabicAlfLetter=function(V){return d(V)&&A.indexOf(V.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(V){return d(V)&&s(V)&&t[V.charCodeAt(0)].length>=1};var _=n.__arabicParser__.arabicLetterHasFinalForm=function(V){return d(V)&&s(V)&&t[V.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(V){return d(V)&&s(V)&&t[V.charCodeAt(0)].length>=3};var S=n.__arabicParser__.arabicLetterHasMedialForm=function(V){return d(V)&&s(V)&&t[V.charCodeAt(0)].length==4},U=n.__arabicParser__.resolveLigatures=function(V){var q=0,z=r,it="",At=0;for(q=0;q<V.length;q+=1)z[V.charCodeAt(q)]!==void 0?(At++,typeof(z=z[V.charCodeAt(q)])=="number"&&(it+=String.fromCharCode(z),z=r,At=0),q===V.length-1&&(z=r,it+=V.charAt(q-(At-1)),q-=At-1,At=0)):(z=r,it+=V.charAt(q-At),q-=At,At=0);return it};n.__arabicParser__.isArabicDiacritic=function(V){return V!==void 0&&o[V.charCodeAt(0)]!==void 0};var G=n.__arabicParser__.getCorrectForm=function(V,q,z){return d(V)?s(V)===!1?-1:!_(V)||!d(q)&&!d(z)||!d(z)&&f(q)||f(V)&&!d(q)||f(V)&&I(q)||f(V)&&f(q)?0:S(V)&&d(q)&&!f(q)&&d(z)&&_(z)?3:f(V)||!d(z)?1:2:-1},L=function(V){var q=0,z=0,it=0,At="",_t="",Lt="",Et=(V=V||"").split("\\s+"),xt=[];for(q=0;q<Et.length;q+=1){for(xt.push(""),z=0;z<Et[q].length;z+=1)At=Et[q][z],_t=Et[q][z-1],Lt=Et[q][z+1],d(At)?(it=G(At,_t,Lt),xt[q]+=it!==-1?String.fromCharCode(t[At.charCodeAt(0)][it]):At):xt[q]+=At;xt[q]=U(xt[q])}return xt.join(" ")},K=n.__arabicParser__.processArabic=n.processArabic=function(){var V,q=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,z=[];if(Array.isArray(q)){var it=0;for(z=[],it=0;it<q.length;it+=1)Array.isArray(q[it])?z.push([L(q[it][0]),q[it][1],q[it][2]]):z.push([L(q[it])]);V=z}else V=L(q);return typeof arguments[0]=="string"?V:(arguments[0].text=V,arguments[0])};n.events.push(["preProcessText",K])}(ji.API),ji.API.autoPrint=function(n){var t;switch((n=n||{}).variant=n.variant||"non-conform",n.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(n){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(f){r=f}});var o=150;Object.defineProperty(this,"width",{get:function(){return o},set:function(f){o=isNaN(f)||Number.isInteger(f)===!1||f<0?150:f,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=o+1)}});var A=300;Object.defineProperty(this,"height",{get:function(){return A},set:function(f){A=isNaN(f)||Number.isInteger(f)===!1||f<0?300:f,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=A+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(f){s=f}});var d={};Object.defineProperty(this,"style",{get:function(){return d},set:function(f){d=f}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,o){var A;if((r=r||"2d")!=="2d")return null;for(A in o)this.pdf.context2d.hasOwnProperty(A)&&(this.pdf.context2d[A]=o[A]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(ji.API),function(n){var t={left:0,top:0,bottom:0,right:0},r=!1,o=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),A.call(this))},A=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var I=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return I},set:function(V){I=V}});var _=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return _},set:function(V){_=V}});var S=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return S},set:function(V){S=V}});var U=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return U},set:function(V){U=V}});var G=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return G},set:function(V){G=V}});var L=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return L},set:function(V){L=V}});var K=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return K},set:function(V){K=V}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(I){return o.call(this),this.internal.__cell__.headerFunction=typeof I=="function"?I:void 0,this},n.getTextDimensions=function(I,_){o.call(this);var S=(_=_||{}).fontSize||this.getFontSize(),U=_.font||this.getFont(),G=_.scaleFactor||this.internal.scaleFactor,L=0,K=0,V=0,q=this;if(!Array.isArray(I)&&typeof I!="string"){if(typeof I!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");I=String(I)}var z=_.maxWidth;z>0?typeof I=="string"?I=this.splitTextToSize(I,z):Object.prototype.toString.call(I)==="[object Array]"&&(I=I.reduce(function(At,_t){return At.concat(q.splitTextToSize(_t,z))},[])):I=Array.isArray(I)?I:[I];for(var it=0;it<I.length;it++)L<(V=this.getStringUnitWidth(I[it],{font:U})*S)&&(L=V);return L!==0&&(K=I.length),{w:L/=G,h:Math.max((K*S*this.getLineHeightFactor()-S*(this.getLineHeightFactor()-1))/G,0)}},n.cellAddPage=function(){o.call(this),this.addPage();var I=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(I.left,I.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var d=n.cell=function(){var I;I=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),o.call(this);var _=this.internal.__cell__.lastCell,S=this.internal.__cell__.padding,U=this.internal.__cell__.margins||t,G=this.internal.__cell__.tableHeaderRow,L=this.internal.__cell__.printHeaders;return _.lineNumber!==void 0&&(_.lineNumber===I.lineNumber?(I.x=(_.x||0)+(_.width||0),I.y=_.y||0):_.y+_.height+I.height+U.bottom>this.getPageHeight()?(this.cellAddPage(),I.y=U.top,L&&G&&(this.printHeaderRow(I.lineNumber,!0),I.y+=G[0].height)):I.y=_.y+_.height||I.y),I.text[0]!==void 0&&(this.rect(I.x,I.y,I.width,I.height,r===!0?"FD":void 0),I.align==="right"?this.text(I.text,I.x+I.width-S,I.y+S,{align:"right",baseline:"top"}):I.align==="center"?this.text(I.text,I.x+I.width/2,I.y+S,{align:"center",baseline:"top",maxWidth:I.width-S-S}):this.text(I.text,I.x+S,I.y+S,{align:"left",baseline:"top",maxWidth:I.width-S-S})),this.internal.__cell__.lastCell=I,this};n.table=function(I,_,S,U,G){if(o.call(this),!S)throw new Error("No data for PDF table.");var L,K,V,q,z=[],it=[],At=[],_t={},Lt={},Et=[],xt=[],It=(G=G||{}).autoSize||!1,Nt=G.printHeaders!==!1,ie=G.css&&G.css["font-size"]!==void 0?16*G.css["font-size"]:G.fontSize||12,lt=G.margins||Object.assign({width:this.getPageWidth()},t),at=typeof G.padding=="number"?G.padding:3,St=G.headerBackgroundColor||"#c8c8c8",Bt=G.headerTextColor||"#000";if(A.call(this),this.internal.__cell__.printHeaders=Nt,this.internal.__cell__.margins=lt,this.internal.__cell__.table_font_size=ie,this.internal.__cell__.padding=at,this.internal.__cell__.headerBackgroundColor=St,this.internal.__cell__.headerTextColor=Bt,this.setFontSize(ie),U==null)it=z=Object.keys(S[0]),At=z.map(function(){return"left"});else if(Array.isArray(U)&&Sr(U[0])==="object")for(z=U.map(function(Tt){return Tt.name}),it=U.map(function(Tt){return Tt.prompt||Tt.name||""}),At=U.map(function(Tt){return Tt.align||"left"}),L=0;L<U.length;L+=1)Lt[U[L].name]=U[L].width*(19.049976/25.4);else Array.isArray(U)&&typeof U[0]=="string"&&(it=z=U,At=z.map(function(){return"left"}));if(It||Array.isArray(U)&&typeof U[0]=="string")for(L=0;L<z.length;L+=1){for(_t[q=z[L]]=S.map(function(Tt){return Tt[q]}),this.setFont(void 0,"bold"),Et.push(this.getTextDimensions(it[L],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),K=_t[q],this.setFont(void 0,"normal"),V=0;V<K.length;V+=1)Et.push(this.getTextDimensions(K[V],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Lt[q]=Math.max.apply(null,Et)+at+at,Et=[]}if(Nt){var se={};for(L=0;L<z.length;L+=1)se[z[L]]={},se[z[L]].text=it[L],se[z[L]].align=At[L];var ee=f.call(this,se,Lt);xt=z.map(function(Tt){return new s(I,_,Lt[Tt],ee,se[Tt].text,void 0,se[Tt].align)}),this.setTableHeaderRow(xt),this.printHeaderRow(1,!1)}var qt=U.reduce(function(Tt,pe){return Tt[pe.name]=pe.align,Tt},{});for(L=0;L<S.length;L+=1){"rowStart"in G&&G.rowStart instanceof Function&&G.rowStart({row:L,data:S[L]},this);var Xt=f.call(this,S[L],Lt);for(V=0;V<z.length;V+=1){var vt=S[L][z[V]];"cellStart"in G&&G.cellStart instanceof Function&&G.cellStart({row:L,col:V,data:vt},this),d.call(this,new s(I,_,Lt[z[V]],Xt,vt,L+2,qt[z[V]]))}}return this.internal.__cell__.table_x=I,this.internal.__cell__.table_y=_,this};var f=function(I,_){var S=this.internal.__cell__.padding,U=this.internal.__cell__.table_font_size,G=this.internal.scaleFactor;return Object.keys(I).map(function(L){var K=I[L];return this.splitTextToSize(K.hasOwnProperty("text")?K.text:K,_[L]-S-S)},this).map(function(L){return this.getLineHeightFactor()*L.length*U/G+S+S},this).reduce(function(L,K){return Math.max(L,K)},0)};n.setTableHeaderRow=function(I){o.call(this),this.internal.__cell__.tableHeaderRow=I},n.printHeaderRow=function(I,_){if(o.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var S;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var U=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(U[0],U[1],U[2],U[3],void 0,-1)}this.setFont(void 0,"bold");for(var G=[],L=0;L<this.internal.__cell__.tableHeaderRow.length;L+=1){S=this.internal.__cell__.tableHeaderRow[L].clone(),_&&(S.y=this.internal.__cell__.margins.top||0,G.push(S)),S.lineNumber=I;var K=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),d.call(this,S),this.setTextColor(K)}G.length>0&&this.setTableHeaderRow(G),this.setFont(void 0,"normal"),r=!1}}(ji.API);$5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},tS=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Wy=q5(tS),eS=[100,200,300,400,500,600,700,800,900],$D=q5(eS);tK={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},S5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};T5=["times"];(function(n){var t,r,o,A,s,d,f,I,_,S=function(j){return j=j||{},this.isStrokeTransparent=j.isStrokeTransparent||!1,this.strokeOpacity=j.strokeOpacity||1,this.strokeStyle=j.strokeStyle||"#000000",this.fillStyle=j.fillStyle||"#000000",this.isFillTransparent=j.isFillTransparent||!1,this.fillOpacity=j.fillOpacity||1,this.font=j.font||"10px sans-serif",this.textBaseline=j.textBaseline||"alphabetic",this.textAlign=j.textAlign||"left",this.lineWidth=j.lineWidth||1,this.lineJoin=j.lineJoin||"miter",this.lineCap=j.lineCap||"butt",this.path=j.path||[],this.transform=j.transform!==void 0?j.transform.clone():new I,this.globalCompositeOperation=j.globalCompositeOperation||"normal",this.globalAlpha=j.globalAlpha||1,this.clip_path=j.clip_path||[],this.currentPoint=j.currentPoint||new d,this.miterLimit=j.miterLimit||10,this.lastPoint=j.lastPoint||new d,this.lineDashOffset=j.lineDashOffset||0,this.lineDash=j.lineDash||[],this.margin=j.margin||[0,0,0,0],this.prevPageLastElemOffset=j.prevPageLastElemOffset||0,this.ignoreClearRect=typeof j.ignoreClearRect!="boolean"||j.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new U(this),t=this.internal.f2,r=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,A=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,d=this.internal.Point,f=this.internal.Rectangle,I=this.internal.Matrix,_=new S}]);var U=function(j){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var mt=j;Object.defineProperty(this,"pdf",{get:function(){return mt}});var yt=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return yt},set:function(Ce){yt=!!Ce}});var Qt=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Qt},set:function(Ce){Qt=!!Ce}});var Ht=0;Object.defineProperty(this,"posX",{get:function(){return Ht},set:function(Ce){isNaN(Ce)||(Ht=Ce)}});var ae=0;Object.defineProperty(this,"posY",{get:function(){return ae},set:function(Ce){isNaN(Ce)||(ae=Ce)}}),Object.defineProperty(this,"margin",{get:function(){return _.margin},set:function(Ce){var Ut;typeof Ce=="number"?Ut=[Ce,Ce,Ce,Ce]:((Ut=new Array(4))[0]=Ce[0],Ut[1]=Ce.length>=2?Ce[1]:Ut[0],Ut[2]=Ce.length>=3?Ce[2]:Ut[0],Ut[3]=Ce.length>=4?Ce[3]:Ut[1]),_.margin=Ut}});var ge=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ge},set:function(Ce){ge=Ce}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(Ce){de=Ce}});var Ze=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ze},set:function(Ce){Ze=Ce}}),Object.defineProperty(this,"ctx",{get:function(){return _},set:function(Ce){Ce instanceof S&&(_=Ce)}}),Object.defineProperty(this,"path",{get:function(){return _.path},set:function(Ce){_.path=Ce}});var Re=[];Object.defineProperty(this,"ctxStack",{get:function(){return Re},set:function(Ce){Re=Ce}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ce){var Ut;Ut=G(Ce),this.ctx.fillStyle=Ut.style,this.ctx.isFillTransparent=Ut.a===0,this.ctx.fillOpacity=Ut.a,this.pdf.setFillColor(Ut.r,Ut.g,Ut.b,{a:Ut.a}),this.pdf.setTextColor(Ut.r,Ut.g,Ut.b,{a:Ut.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ce){var Ut=G(Ce);this.ctx.strokeStyle=Ut.style,this.ctx.isStrokeTransparent=Ut.a===0,this.ctx.strokeOpacity=Ut.a,Ut.a===0?this.pdf.setDrawColor(255,255,255):(Ut.a,this.pdf.setDrawColor(Ut.r,Ut.g,Ut.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ce){["butt","round","square"].indexOf(Ce)!==-1&&(this.ctx.lineCap=Ce,this.pdf.setLineCap(Ce))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ce){isNaN(Ce)||(this.ctx.lineWidth=Ce,this.pdf.setLineWidth(Ce))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ce){["bevel","round","miter"].indexOf(Ce)!==-1&&(this.ctx.lineJoin=Ce,this.pdf.setLineJoin(Ce))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ce){isNaN(Ce)||(this.ctx.miterLimit=Ce,this.pdf.setMiterLimit(Ce))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ce){this.ctx.textBaseline=Ce}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ce){["right","end","center","left","start"].indexOf(Ce)!==-1&&(this.ctx.textAlign=Ce)}});var Je=null;function Xe(Ce,Ut){if(Je===null){var Ye=function(Oe){var Qe=[];return Object.keys(Oe).forEach(function(Ne){Oe[Ne].forEach(function(ze){var We=null;switch(ze){case"bold":We={family:Ne,weight:"bold"};break;case"italic":We={family:Ne,style:"italic"};break;case"bolditalic":We={family:Ne,weight:"bold",style:"italic"};break;case"":case"normal":We={family:Ne}}We!==null&&(We.ref={name:Ne,style:ze},Qe.push(We))})}),Qe}(Ce.getFontList());Je=function(Oe){for(var Qe={},Ne=0;Ne<Oe.length;++Ne){var ze=Jy(Oe[Ne]),We=ze.family,ri=ze.stretch,hi=ze.style,Ti=ze.weight;Qe[We]=Qe[We]||{},Qe[We][ri]=Qe[We][ri]||{},Qe[We][ri][hi]=Qe[We][ri][hi]||{},Qe[We][ri][hi][Ti]=ze}return Qe}(Ye.concat(Ut))}return Je}var Kt=null;Object.defineProperty(this,"fontFaces",{get:function(){return Kt},set:function(Ce){Je=null,Kt=Ce}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ce){var Ut;if(this.ctx.font=Ce,(Ut=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ce))!==null){var Ye=Ut[1],Oe=(Ut[2],Ut[3]),Qe=Ut[4],Ne=(Ut[5],Ut[6]),ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Qe)[2];Qe=Math.floor(ze==="px"?parseFloat(Qe)*this.pdf.internal.scaleFactor:ze==="em"?parseFloat(Qe)*this.pdf.getFontSize():parseFloat(Qe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Qe);var We=function(mi){var Gi,le,gi=[],Ke=mi.trim();if(Ke==="")return T5;if(Ke in S5)return[S5[Ke]];for(;Ke!=="";){switch(le=null,Gi=(Ke=k5(Ke)).charAt(0)){case'"':case"'":le=iK(Ke.substring(1),Gi);break;default:le=rK(Ke)}if(le===null||(gi.push(le[0]),(Ke=k5(le[1]))!==""&&Ke.charAt(0)!==","))return T5;Ke=Ke.replace(/^,/,"")}return gi}(Ne);if(this.fontFaces){var ri=eK(Xe(this.pdf,this.fontFaces),We.map(function(mi){return{family:mi,stretch:"normal",weight:Oe,style:Ye}}));this.pdf.setFont(ri.ref.name,ri.ref.style)}else{var hi="";(Oe==="bold"||parseInt(Oe,10)>=700||Ye==="bold")&&(hi="bold"),Ye==="italic"&&(hi+="italic"),hi.length===0&&(hi="normal");for(var Ti="",fe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ni=0;Ni<We.length;Ni++){if(this.pdf.internal.getFont(We[Ni],hi,{noFallback:!0,disableWarning:!0})!==void 0){Ti=We[Ni];break}if(hi==="bolditalic"&&this.pdf.internal.getFont(We[Ni],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ti=We[Ni],hi="bold";else if(this.pdf.internal.getFont(We[Ni],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ti=We[Ni],hi="normal";break}}if(Ti===""){for(var Di=0;Di<We.length;Di++)if(fe[We[Di]]){Ti=fe[We[Di]];break}}Ti=Ti===""?"Times":Ti,this.pdf.setFont(Ti,hi)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ce){this.ctx.globalCompositeOperation=Ce}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ce){this.ctx.globalAlpha=Ce}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ce){this.ctx.lineDashOffset=Ce,pe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ce){this.ctx.lineDash=Ce,pe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ce){this.ctx.ignoreClearRect=!!Ce}})};U.prototype.setLineDash=function(j){this.lineDash=j},U.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},U.prototype.fill=function(){_t.call(this,"fill",!1)},U.prototype.stroke=function(){_t.call(this,"stroke",!1)},U.prototype.beginPath=function(){this.path=[{type:"begin"}]},U.prototype.moveTo=function(j,mt){if(isNaN(j)||isNaN(mt))throw sn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var yt=this.ctx.transform.applyToPoint(new d(j,mt));this.path.push({type:"mt",x:yt.x,y:yt.y}),this.ctx.lastPoint=new d(j,mt)},U.prototype.closePath=function(){var j=new d(0,0),mt=0;for(mt=this.path.length-1;mt!==-1;mt--)if(this.path[mt].type==="begin"&&Sr(this.path[mt+1])==="object"&&typeof this.path[mt+1].x=="number"){j=new d(this.path[mt+1].x,this.path[mt+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new d(j.x,j.y)},U.prototype.lineTo=function(j,mt){if(isNaN(j)||isNaN(mt))throw sn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var yt=this.ctx.transform.applyToPoint(new d(j,mt));this.path.push({type:"lt",x:yt.x,y:yt.y}),this.ctx.lastPoint=new d(yt.x,yt.y)},U.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),_t.call(this,null,!0)},U.prototype.quadraticCurveTo=function(j,mt,yt,Qt){if(isNaN(yt)||isNaN(Qt)||isNaN(j)||isNaN(mt))throw sn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Ht=this.ctx.transform.applyToPoint(new d(yt,Qt)),ae=this.ctx.transform.applyToPoint(new d(j,mt));this.path.push({type:"qct",x1:ae.x,y1:ae.y,x:Ht.x,y:Ht.y}),this.ctx.lastPoint=new d(Ht.x,Ht.y)},U.prototype.bezierCurveTo=function(j,mt,yt,Qt,Ht,ae){if(isNaN(Ht)||isNaN(ae)||isNaN(j)||isNaN(mt)||isNaN(yt)||isNaN(Qt))throw sn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ge=this.ctx.transform.applyToPoint(new d(Ht,ae)),de=this.ctx.transform.applyToPoint(new d(j,mt)),Ze=this.ctx.transform.applyToPoint(new d(yt,Qt));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:Ze.x,y2:Ze.y,x:ge.x,y:ge.y}),this.ctx.lastPoint=new d(ge.x,ge.y)},U.prototype.arc=function(j,mt,yt,Qt,Ht,ae){if(isNaN(j)||isNaN(mt)||isNaN(yt)||isNaN(Qt)||isNaN(Ht))throw sn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ae=!!ae,!this.ctx.transform.isIdentity){var ge=this.ctx.transform.applyToPoint(new d(j,mt));j=ge.x,mt=ge.y;var de=this.ctx.transform.applyToPoint(new d(0,yt)),Ze=this.ctx.transform.applyToPoint(new d(0,0));yt=Math.sqrt(Math.pow(de.x-Ze.x,2)+Math.pow(de.y-Ze.y,2))}Math.abs(Ht-Qt)>=2*Math.PI&&(Qt=0,Ht=2*Math.PI),this.path.push({type:"arc",x:j,y:mt,radius:yt,startAngle:Qt,endAngle:Ht,counterclockwise:ae})},U.prototype.arcTo=function(j,mt,yt,Qt,Ht){throw new Error("arcTo not implemented.")},U.prototype.rect=function(j,mt,yt,Qt){if(isNaN(j)||isNaN(mt)||isNaN(yt)||isNaN(Qt))throw sn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(j,mt),this.lineTo(j+yt,mt),this.lineTo(j+yt,mt+Qt),this.lineTo(j,mt+Qt),this.lineTo(j,mt),this.lineTo(j+yt,mt),this.lineTo(j,mt)},U.prototype.fillRect=function(j,mt,yt,Qt){if(isNaN(j)||isNaN(mt)||isNaN(yt)||isNaN(Qt))throw sn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!L.call(this)){var Ht={};this.lineCap!=="butt"&&(Ht.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Ht.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(j,mt,yt,Qt),this.fill(),Ht.hasOwnProperty("lineCap")&&(this.lineCap=Ht.lineCap),Ht.hasOwnProperty("lineJoin")&&(this.lineJoin=Ht.lineJoin)}},U.prototype.strokeRect=function(j,mt,yt,Qt){if(isNaN(j)||isNaN(mt)||isNaN(yt)||isNaN(Qt))throw sn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");K.call(this)||(this.beginPath(),this.rect(j,mt,yt,Qt),this.stroke())},U.prototype.clearRect=function(j,mt,yt,Qt){if(isNaN(j)||isNaN(mt)||isNaN(yt)||isNaN(Qt))throw sn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(j,mt,yt,Qt))},U.prototype.save=function(j){j=typeof j!="boolean"||j;for(var mt=this.pdf.internal.getCurrentPageInfo().pageNumber,yt=0;yt<this.pdf.internal.getNumberOfPages();yt++)this.pdf.setPage(yt+1),this.pdf.internal.out("q");if(this.pdf.setPage(mt),j){this.ctx.fontSize=this.pdf.internal.getFontSize();var Qt=new S(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Qt}},U.prototype.restore=function(j){j=typeof j!="boolean"||j;for(var mt=this.pdf.internal.getCurrentPageInfo().pageNumber,yt=0;yt<this.pdf.internal.getNumberOfPages();yt++)this.pdf.setPage(yt+1),this.pdf.internal.out("Q");this.pdf.setPage(mt),j&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},U.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var G=function(j){var mt,yt,Qt,Ht;if(j.isCanvasGradient===!0&&(j=j.getColor()),!j)return{r:0,g:0,b:0,a:0,style:j};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(j))mt=0,yt=0,Qt=0,Ht=0;else{var ae=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(j);if(ae!==null)mt=parseInt(ae[1]),yt=parseInt(ae[2]),Qt=parseInt(ae[3]),Ht=1;else if((ae=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(j))!==null)mt=parseInt(ae[1]),yt=parseInt(ae[2]),Qt=parseInt(ae[3]),Ht=parseFloat(ae[4]);else{if(Ht=1,typeof j=="string"&&j.charAt(0)!=="#"){var ge=new O5(j);j=ge.ok?ge.toHex():"#000000"}j.length===4?(mt=j.substring(1,2),mt+=mt,yt=j.substring(2,3),yt+=yt,Qt=j.substring(3,4),Qt+=Qt):(mt=j.substring(1,3),yt=j.substring(3,5),Qt=j.substring(5,7)),mt=parseInt(mt,16),yt=parseInt(yt,16),Qt=parseInt(Qt,16)}}return{r:mt,g:yt,b:Qt,a:Ht,style:j}},L=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},K=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};U.prototype.fillText=function(j,mt,yt,Qt){if(isNaN(mt)||isNaN(yt)||typeof j!="string")throw sn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Qt=isNaN(Qt)?void 0:Qt,!L.call(this)){var Ht=Xt(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;at.call(this,{text:j,x:mt,y:yt,scale:ae,angle:Ht,align:this.textAlign,maxWidth:Qt})}},U.prototype.strokeText=function(j,mt,yt,Qt){if(isNaN(mt)||isNaN(yt)||typeof j!="string")throw sn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!K.call(this)){Qt=isNaN(Qt)?void 0:Qt;var Ht=Xt(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;at.call(this,{text:j,x:mt,y:yt,scale:ae,renderingMode:"stroke",angle:Ht,align:this.textAlign,maxWidth:Qt})}},U.prototype.measureText=function(j){if(typeof j!="string")throw sn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var mt=this.pdf,yt=this.pdf.internal.scaleFactor,Qt=mt.internal.getFontSize(),Ht=mt.getStringUnitWidth(j)*Qt/mt.internal.scaleFactor,ae=function(ge){var de=(ge=ge||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this};return new ae({width:Ht*=Math.round(96*yt/72*1e4)/1e4})},U.prototype.scale=function(j,mt){if(isNaN(j)||isNaN(mt))throw sn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var yt=new I(j,0,0,mt,0,0);this.ctx.transform=this.ctx.transform.multiply(yt)},U.prototype.rotate=function(j){if(isNaN(j))throw sn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var mt=new I(Math.cos(j),Math.sin(j),-Math.sin(j),Math.cos(j),0,0);this.ctx.transform=this.ctx.transform.multiply(mt)},U.prototype.translate=function(j,mt){if(isNaN(j)||isNaN(mt))throw sn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var yt=new I(1,0,0,1,j,mt);this.ctx.transform=this.ctx.transform.multiply(yt)},U.prototype.transform=function(j,mt,yt,Qt,Ht,ae){if(isNaN(j)||isNaN(mt)||isNaN(yt)||isNaN(Qt)||isNaN(Ht)||isNaN(ae))throw sn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ge=new I(j,mt,yt,Qt,Ht,ae);this.ctx.transform=this.ctx.transform.multiply(ge)},U.prototype.setTransform=function(j,mt,yt,Qt,Ht,ae){j=isNaN(j)?1:j,mt=isNaN(mt)?0:mt,yt=isNaN(yt)?0:yt,Qt=isNaN(Qt)?1:Qt,Ht=isNaN(Ht)?0:Ht,ae=isNaN(ae)?0:ae,this.ctx.transform=new I(j,mt,yt,Qt,Ht,ae)};var V=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};U.prototype.drawImage=function(j,mt,yt,Qt,Ht,ae,ge,de,Ze){var Re=this.pdf.getImageProperties(j),Je=1,Xe=1,Kt=1,Ce=1;Qt!==void 0&&de!==void 0&&(Kt=de/Qt,Ce=Ze/Ht,Je=Re.width/Qt*de/Qt,Xe=Re.height/Ht*Ze/Ht),ae===void 0&&(ae=mt,ge=yt,mt=0,yt=0),Qt!==void 0&&de===void 0&&(de=Qt,Ze=Ht),Qt===void 0&&de===void 0&&(de=Re.width,Ze=Re.height);for(var Ut,Ye=this.ctx.transform.decompose(),Oe=Xt(Ye.rotate.shx),Qe=new I,Ne=(Qe=(Qe=(Qe=Qe.multiply(Ye.translate)).multiply(Ye.skew)).multiply(Ye.scale)).applyToRectangle(new f(ae-mt*Kt,ge-yt*Ce,Qt*Je,Ht*Xe)),ze=q.call(this,Ne),We=[],ri=0;ri<ze.length;ri+=1)We.indexOf(ze[ri])===-1&&We.push(ze[ri]);if(At(We),this.autoPaging)for(var hi=We[0],Ti=We[We.length-1],fe=hi;fe<Ti+1;fe++){this.pdf.setPage(fe);var Ni=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Di=fe===1?this.posY+this.margin[0]:this.margin[0],mi=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Gi=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],le=fe===1?0:mi+(fe-2)*Gi;if(this.ctx.clip_path.length!==0){var gi=this.path;Ut=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=it(Ut,this.posX+this.margin[3],-le+Di+this.ctx.prevPageLastElemOffset),Lt.call(this,"fill",!0),this.path=gi}var Ke=JSON.parse(JSON.stringify(Ne));Ke=it([Ke],this.posX+this.margin[3],-le+Di+this.ctx.prevPageLastElemOffset)[0];var or=(fe>hi||fe<Ti)&&V.call(this);or&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ni,Gi,null).clip().discardPath()),this.pdf.addImage(j,"JPEG",Ke.x,Ke.y,Ke.w,Ke.h,null,null,Oe),or&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(j,"JPEG",Ne.x,Ne.y,Ne.w,Ne.h,null,null,Oe)};var q=function(j,mt,yt){var Qt=[];mt=mt||this.pdf.internal.pageSize.width,yt=yt||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Ht=this.posY+this.ctx.prevPageLastElemOffset;switch(j.type){default:case"mt":case"lt":Qt.push(Math.floor((j.y+Ht)/yt)+1);break;case"arc":Qt.push(Math.floor((j.y+Ht-j.radius)/yt)+1),Qt.push(Math.floor((j.y+Ht+j.radius)/yt)+1);break;case"qct":var ae=vt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x,j.y);Qt.push(Math.floor((ae.y+Ht)/yt)+1),Qt.push(Math.floor((ae.y+ae.h+Ht)/yt)+1);break;case"bct":var ge=Tt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x2,j.y2,j.x,j.y);Qt.push(Math.floor((ge.y+Ht)/yt)+1),Qt.push(Math.floor((ge.y+ge.h+Ht)/yt)+1);break;case"rect":Qt.push(Math.floor((j.y+Ht)/yt)+1),Qt.push(Math.floor((j.y+j.h+Ht)/yt)+1)}for(var de=0;de<Qt.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<Qt[de];)z.call(this);return Qt},z=function(){var j=this.fillStyle,mt=this.strokeStyle,yt=this.font,Qt=this.lineCap,Ht=this.lineWidth,ae=this.lineJoin;this.pdf.addPage(),this.fillStyle=j,this.strokeStyle=mt,this.font=yt,this.lineCap=Qt,this.lineWidth=Ht,this.lineJoin=ae},it=function(j,mt,yt){for(var Qt=0;Qt<j.length;Qt++)switch(j[Qt].type){case"bct":j[Qt].x2+=mt,j[Qt].y2+=yt;case"qct":j[Qt].x1+=mt,j[Qt].y1+=yt;case"mt":case"lt":case"arc":default:j[Qt].x+=mt,j[Qt].y+=yt}return j},At=function(j){return j.sort(function(mt,yt){return mt-yt})},_t=function(j,mt){for(var yt,Qt,Ht=this.fillStyle,ae=this.strokeStyle,ge=this.lineCap,de=this.lineWidth,Ze=Math.abs(de*this.ctx.transform.scaleX),Re=this.lineJoin,Je=JSON.parse(JSON.stringify(this.path)),Xe=JSON.parse(JSON.stringify(this.path)),Kt=[],Ce=0;Ce<Xe.length;Ce++)if(Xe[Ce].x!==void 0)for(var Ut=q.call(this,Xe[Ce]),Ye=0;Ye<Ut.length;Ye+=1)Kt.indexOf(Ut[Ye])===-1&&Kt.push(Ut[Ye]);for(var Oe=0;Oe<Kt.length;Oe++)for(;this.pdf.internal.getNumberOfPages()<Kt[Oe];)z.call(this);if(At(Kt),this.autoPaging)for(var Qe=Kt[0],Ne=Kt[Kt.length-1],ze=Qe;ze<Ne+1;ze++){this.pdf.setPage(ze),this.fillStyle=Ht,this.strokeStyle=ae,this.lineCap=ge,this.lineWidth=Ze,this.lineJoin=Re;var We=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ri=ze===1?this.posY+this.margin[0]:this.margin[0],hi=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ti=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],fe=ze===1?0:hi+(ze-2)*Ti;if(this.ctx.clip_path.length!==0){var Ni=this.path;yt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=it(yt,this.posX+this.margin[3],-fe+ri+this.ctx.prevPageLastElemOffset),Lt.call(this,j,!0),this.path=Ni}if(Qt=JSON.parse(JSON.stringify(Je)),this.path=it(Qt,this.posX+this.margin[3],-fe+ri+this.ctx.prevPageLastElemOffset),mt===!1||ze===0){var Di=(ze>Qe||ze<Ne)&&V.call(this);Di&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],We,Ti,null).clip().discardPath()),Lt.call(this,j,mt),Di&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=Ze,Lt.call(this,j,mt),this.lineWidth=de;this.path=Je},Lt=function(j,mt){if((j!=="stroke"||mt||!K.call(this))&&(j==="stroke"||mt||!L.call(this))){for(var yt,Qt,Ht=[],ae=this.path,ge=0;ge<ae.length;ge++){var de=ae[ge];switch(de.type){case"begin":Ht.push({begin:!0});break;case"close":Ht.push({close:!0});break;case"mt":Ht.push({start:de,deltas:[],abs:[]});break;case"lt":var Ze=Ht.length;if(ae[ge-1]&&!isNaN(ae[ge-1].x)&&(yt=[de.x-ae[ge-1].x,de.y-ae[ge-1].y],Ze>0)){for(;Ze>=0;Ze--)if(Ht[Ze-1].close!==!0&&Ht[Ze-1].begin!==!0){Ht[Ze-1].deltas.push(yt),Ht[Ze-1].abs.push(de);break}}break;case"bct":yt=[de.x1-ae[ge-1].x,de.y1-ae[ge-1].y,de.x2-ae[ge-1].x,de.y2-ae[ge-1].y,de.x-ae[ge-1].x,de.y-ae[ge-1].y],Ht[Ht.length-1].deltas.push(yt);break;case"qct":var Re=ae[ge-1].x+2/3*(de.x1-ae[ge-1].x),Je=ae[ge-1].y+2/3*(de.y1-ae[ge-1].y),Xe=de.x+2/3*(de.x1-de.x),Kt=de.y+2/3*(de.y1-de.y),Ce=de.x,Ut=de.y;yt=[Re-ae[ge-1].x,Je-ae[ge-1].y,Xe-ae[ge-1].x,Kt-ae[ge-1].y,Ce-ae[ge-1].x,Ut-ae[ge-1].y],Ht[Ht.length-1].deltas.push(yt);break;case"arc":Ht.push({deltas:[],abs:[],arc:!0}),Array.isArray(Ht[Ht.length-1].abs)&&Ht[Ht.length-1].abs.push(de)}}Qt=mt?null:j==="stroke"?"stroke":"fill";for(var Ye=!1,Oe=0;Oe<Ht.length;Oe++)if(Ht[Oe].arc)for(var Qe=Ht[Oe].abs,Ne=0;Ne<Qe.length;Ne++){var ze=Qe[Ne];ze.type==="arc"?It.call(this,ze.x,ze.y,ze.radius,ze.startAngle,ze.endAngle,ze.counterclockwise,void 0,mt,!Ye):St.call(this,ze.x,ze.y),Ye=!0}else if(Ht[Oe].close===!0)this.pdf.internal.out("h"),Ye=!1;else if(Ht[Oe].begin!==!0){var We=Ht[Oe].start.x,ri=Ht[Oe].start.y;Bt.call(this,Ht[Oe].deltas,We,ri),Ye=!0}Qt&&Nt.call(this,Qt),mt&&ie.call(this)}},Et=function(j){var mt=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,yt=mt*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return j-yt;case"top":return j+mt-yt;case"hanging":return j+mt-2*yt;case"middle":return j+mt/2-yt;case"ideographic":return j;case"alphabetic":default:return j}},xt=function(j){return j+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};U.prototype.createLinearGradient=function(){var j=function(){};return j.colorStops=[],j.addColorStop=function(mt,yt){this.colorStops.push([mt,yt])},j.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},j.isCanvasGradient=!0,j},U.prototype.createPattern=function(){return this.createLinearGradient()},U.prototype.createRadialGradient=function(){return this.createLinearGradient()};var It=function(j,mt,yt,Qt,Ht,ae,ge,de,Ze){for(var Re=ee.call(this,yt,Qt,Ht,ae),Je=0;Je<Re.length;Je++){var Xe=Re[Je];Je===0&&(Ze?lt.call(this,Xe.x1+j,Xe.y1+mt):St.call(this,Xe.x1+j,Xe.y1+mt)),se.call(this,j,mt,Xe.x2,Xe.y2,Xe.x3,Xe.y3,Xe.x4,Xe.y4)}de?ie.call(this):Nt.call(this,ge)},Nt=function(j){switch(j){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},ie=function(){this.pdf.clip(),this.pdf.discardPath()},lt=function(j,mt){this.pdf.internal.out(r(j)+" "+o(mt)+" m")},at=function(j){var mt;switch(j.align){case"right":case"end":mt="right";break;case"center":mt="center";break;case"left":case"start":default:mt="left"}var yt=this.pdf.getTextDimensions(j.text),Qt=Et.call(this,j.y),Ht=xt.call(this,Qt)-yt.h,ae=this.ctx.transform.applyToPoint(new d(j.x,Qt)),ge=this.ctx.transform.decompose(),de=new I;de=(de=(de=de.multiply(ge.translate)).multiply(ge.skew)).multiply(ge.scale);for(var Ze,Re,Je,Xe=this.ctx.transform.applyToRectangle(new f(j.x,Qt,yt.w,yt.h)),Kt=de.applyToRectangle(new f(j.x,Ht,yt.w,yt.h)),Ce=q.call(this,Kt),Ut=[],Ye=0;Ye<Ce.length;Ye+=1)Ut.indexOf(Ce[Ye])===-1&&Ut.push(Ce[Ye]);if(At(Ut),this.autoPaging)for(var Oe=Ut[0],Qe=Ut[Ut.length-1],Ne=Oe;Ne<Qe+1;Ne++){this.pdf.setPage(Ne);var ze=Ne===1?this.posY+this.margin[0]:this.margin[0],We=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ri=this.pdf.internal.pageSize.height-this.margin[2],hi=ri-this.margin[0],Ti=this.pdf.internal.pageSize.width-this.margin[1],fe=Ti-this.margin[3],Ni=Ne===1?0:We+(Ne-2)*hi;if(this.ctx.clip_path.length!==0){var Di=this.path;Ze=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=it(Ze,this.posX+this.margin[3],-1*Ni+ze),Lt.call(this,"fill",!0),this.path=Di}var mi=it([JSON.parse(JSON.stringify(Kt))],this.posX+this.margin[3],-Ni+ze+this.ctx.prevPageLastElemOffset)[0];j.scale>=.01&&(Re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Re*j.scale),Je=this.lineWidth,this.lineWidth=Je*j.scale);var Gi=this.autoPaging!=="text";if(Gi||mi.y+mi.h<=ri){if(Gi||mi.y>=ze&&mi.x<=Ti){var le=Gi?j.text:this.pdf.splitTextToSize(j.text,j.maxWidth||Ti-mi.x)[0],gi=it([JSON.parse(JSON.stringify(Xe))],this.posX+this.margin[3],-Ni+ze+this.ctx.prevPageLastElemOffset)[0],Ke=Gi&&(Ne>Oe||Ne<Qe)&&V.call(this);Ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],fe,hi,null).clip().discardPath()),this.pdf.text(le,gi.x,gi.y,{angle:j.angle,align:mt,renderingMode:j.renderingMode}),Ke&&this.pdf.restoreGraphicsState()}}else mi.y<ri&&(this.ctx.prevPageLastElemOffset+=ri-mi.y);j.scale>=.01&&(this.pdf.setFontSize(Re),this.lineWidth=Je)}else j.scale>=.01&&(Re=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Re*j.scale),Je=this.lineWidth,this.lineWidth=Je*j.scale),this.pdf.text(j.text,ae.x+this.posX,ae.y+this.posY,{angle:j.angle,align:mt,renderingMode:j.renderingMode,maxWidth:j.maxWidth}),j.scale>=.01&&(this.pdf.setFontSize(Re),this.lineWidth=Je)},St=function(j,mt,yt,Qt){yt=yt||0,Qt=Qt||0,this.pdf.internal.out(r(j+yt)+" "+o(mt+Qt)+" l")},Bt=function(j,mt,yt){return this.pdf.lines(j,mt,yt,null,null)},se=function(j,mt,yt,Qt,Ht,ae,ge,de){this.pdf.internal.out([t(A(yt+j)),t(s(Qt+mt)),t(A(Ht+j)),t(s(ae+mt)),t(A(ge+j)),t(s(de+mt)),"c"].join(" "))},ee=function(j,mt,yt,Qt){for(var Ht=2*Math.PI,ae=Math.PI/2;mt>yt;)mt-=Ht;var ge=Math.abs(yt-mt);ge<Ht&&Qt&&(ge=Ht-ge);for(var de=[],Ze=Qt?-1:1,Re=mt;ge>1e-5;){var Je=Re+Ze*Math.min(ge,ae);de.push(qt.call(this,j,Re,Je)),ge-=Math.abs(Je-Re),Re=Je}return de},qt=function(j,mt,yt){var Qt=(yt-mt)/2,Ht=j*Math.cos(Qt),ae=j*Math.sin(Qt),ge=Ht,de=-ae,Ze=ge*ge+de*de,Re=Ze+ge*Ht+de*ae,Je=4/3*(Math.sqrt(2*Ze*Re)-Re)/(ge*ae-de*Ht),Xe=ge-Je*de,Kt=de+Je*ge,Ce=Xe,Ut=-Kt,Ye=Qt+mt,Oe=Math.cos(Ye),Qe=Math.sin(Ye);return{x1:j*Math.cos(mt),y1:j*Math.sin(mt),x2:Xe*Oe-Kt*Qe,y2:Xe*Qe+Kt*Oe,x3:Ce*Oe-Ut*Qe,y3:Ce*Qe+Ut*Oe,x4:j*Math.cos(yt),y4:j*Math.sin(yt)}},Xt=function(j){return 180*j/Math.PI},vt=function(j,mt,yt,Qt,Ht,ae){var ge=j+.5*(yt-j),de=mt+.5*(Qt-mt),Ze=Ht+.5*(yt-Ht),Re=ae+.5*(Qt-ae),Je=Math.min(j,Ht,ge,Ze),Xe=Math.max(j,Ht,ge,Ze),Kt=Math.min(mt,ae,de,Re),Ce=Math.max(mt,ae,de,Re);return new f(Je,Kt,Xe-Je,Ce-Kt)},Tt=function(j,mt,yt,Qt,Ht,ae,ge,de){var Ze,Re,Je,Xe,Kt,Ce,Ut,Ye,Oe,Qe,Ne,ze,We,ri,hi=yt-j,Ti=Qt-mt,fe=Ht-yt,Ni=ae-Qt,Di=ge-Ht,mi=de-ae;for(Re=0;Re<41;Re++)Oe=(Ut=(Je=j+(Ze=Re/40)*hi)+Ze*((Kt=yt+Ze*fe)-Je))+Ze*(Kt+Ze*(Ht+Ze*Di-Kt)-Ut),Qe=(Ye=(Xe=mt+Ze*Ti)+Ze*((Ce=Qt+Ze*Ni)-Xe))+Ze*(Ce+Ze*(ae+Ze*mi-Ce)-Ye),Re==0?(Ne=Oe,ze=Qe,We=Oe,ri=Qe):(Ne=Math.min(Ne,Oe),ze=Math.min(ze,Qe),We=Math.max(We,Oe),ri=Math.max(ri,Qe));return new f(Math.round(Ne),Math.round(ze),Math.round(We-Ne),Math.round(ri-ze))},pe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var j,mt,yt=(j=this.ctx.lineDash,mt=this.ctx.lineDashOffset,JSON.stringify({lineDash:j,lineDashOffset:mt}));this.prevLineDash!==yt&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=yt)}}})(ji.API),function(n){var t=function(s){var d,f,I,_,S,U,G,L,K,V;for(f=[],I=0,_=(s+=d="\0\0\0\0".slice(s.length%4||4)).length;_>I;I+=4)(S=(s.charCodeAt(I)<<24)+(s.charCodeAt(I+1)<<16)+(s.charCodeAt(I+2)<<8)+s.charCodeAt(I+3))!==0?(U=(S=((S=((S=((S=(S-(V=S%85))/85)-(K=S%85))/85)-(L=S%85))/85)-(G=S%85))/85)%85,f.push(U+33,G+33,L+33,K+33,V+33)):f.push(122);return function(q,z){for(var it=z;it>0;it--)q.pop()}(f,d.length),String.fromCharCode.apply(String,f)+"~>"},r=function(s){var d,f,I,_,S,U=String,G="length",L=255,K="charCodeAt",V="slice",q="replace";for(s[V](-2),s=s[V](0,-2)[q](/\s/g,"")[q]("z","!!!!!"),I=[],_=0,S=(s+=d="uuuuu"[V](s[G]%5||5))[G];S>_;_+=5)f=52200625*(s[K](_)-33)+614125*(s[K](_+1)-33)+7225*(s[K](_+2)-33)+85*(s[K](_+3)-33)+(s[K](_+4)-33),I.push(L&f>>24,L&f>>16,L&f>>8,L&f);return function(z,it){for(var At=it;At>0;At--)z.pop()}(I,d[G]),U.fromCharCode.apply(U,I)},o=function(s){var d=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),d.test(s)===!1)return"";for(var f="",I=0;I<s.length;I+=2)f+=String.fromCharCode("0x"+(s[I]+s[I+1]));return f},A=function(s){for(var d=new Uint8Array(s.length),f=s.length;f--;)d[f]=s.charCodeAt(f);return s=(d=Vy(d)).reduce(function(I,_){return I+String.fromCharCode(_)},"")};n.processDataByFilters=function(s,d){var f=0,I=s||"",_=[];for(typeof(d=d||[])=="string"&&(d=[d]),f=0;f<d.length;f+=1)switch(d[f]){case"ASCII85Decode":case"/ASCII85Decode":I=r(I),_.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":I=t(I),_.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":I=o(I),_.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":I=I.split("").map(function(S){return("0"+S.charCodeAt().toString(16)).slice(-2)}).join("")+">",_.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":I=A(I),_.push("/FlateDecode");break;default:throw new Error('The filter: "'+d[f]+'" is not implemented')}return{data:I,reverseChain:_.reverse().join(" ")}}}(ji.API),function(n){n.loadFile=function(t,r,o){return function(A,s,d){s=s!==!1,d=typeof d=="function"?d:function(){};var f=void 0;try{f=function(I,_,S){var U=new XMLHttpRequest,G=0,L=function(K){var V=K.length,q=[],z=String.fromCharCode;for(G=0;G<V;G+=1)q.push(z(255&K.charCodeAt(G)));return q.join("")};if(U.open("GET",I,!_),U.overrideMimeType("text/plain; charset=x-user-defined"),_===!1&&(U.onload=function(){U.status===200?S(L(this.responseText)):S(void 0)}),U.send(null),_&&U.status===200)return L(U.responseText)}(A,s,d)}catch{}return f}(t,r,o)},n.loadImageFile=n.loadFile}(ji.API),function(n){function t(){return(qi.html2canvas?Promise.resolve(qi.html2canvas):Promise.resolve().then(()=>(g2(),h2))).catch(function(d){return Promise.reject(new Error("Could not load html2canvas: "+d))}).then(function(d){return d.default?d.default:d})}function r(){return(qi.DOMPurify?Promise.resolve(qi.DOMPurify):Promise.resolve().then(()=>(w2(),v2))).catch(function(d){return Promise.reject(new Error("Could not load dompurify: "+d))}).then(function(d){return d.default?d.default:d})}var o=function(d){var f=Sr(d);return f==="undefined"?"undefined":f==="string"||d instanceof String?"string":f==="number"||d instanceof Number?"number":f==="function"||d instanceof Function?"function":d&&d.constructor===Array?"array":d&&d.nodeType===1?"element":f==="object"?"object":"unknown"},A=function(d,f){var I=document.createElement(d);for(var _ in f.className&&(I.className=f.className),f.innerHTML&&f.dompurify&&(I.innerHTML=f.dompurify.sanitize(f.innerHTML)),f.style)I.style[_]=f.style[_];return I},s=function d(f){var I=Object.assign(d.convert(Promise.resolve()),JSON.parse(JSON.stringify(d.template))),_=d.convert(Promise.resolve(),I);return _=(_=_.setProgress(1,d,1,[d])).set(f)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(d,f){return d.__proto__=f||s.prototype,d},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(d,f){return this.then(function(){switch(f=f||function(I){switch(o(I)){case"string":return"string";case"element":return I.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(d)){case"string":return this.then(r).then(function(I){return this.set({src:A("div",{innerHTML:d,dompurify:I})})});case"element":return this.set({src:d});case"canvas":return this.set({canvas:d});case"img":return this.set({img:d});default:return this.error("Unknown source type.")}})},s.prototype.to=function(d){switch(d){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var d={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},f=function I(_,S){for(var U=_.nodeType===3?document.createTextNode(_.nodeValue):_.cloneNode(!1),G=_.firstChild;G;G=G.nextSibling)S!==!0&&G.nodeType===1&&G.nodeName==="SCRIPT"||U.appendChild(I(G,S));return _.nodeType===1&&(_.nodeName==="CANVAS"?(U.width=_.width,U.height=_.height,U.getContext("2d").drawImage(_,0,0)):_.nodeName!=="TEXTAREA"&&_.nodeName!=="SELECT"||(U.value=_.value),U.addEventListener("load",function(){U.scrollTop=_.scrollTop,U.scrollLeft=_.scrollLeft},!0)),U}(this.prop.src,this.opt.html2canvas.javascriptEnabled);f.tagName==="BODY"&&(d.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=A("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=A("div",{className:"html2pdf__container",style:d}),this.prop.container.appendChild(f),this.prop.container.firstChild.appendChild(A("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var d=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(d).then(t).then(function(f){var I=Object.assign({},this.opt.html2canvas);return delete I.onrendered,f(this.prop.container,I)}).then(function(f){(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var d=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(d).then(t).then(function(f){var I=this.opt.jsPDF,_=this.opt.fontFaces,S=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,U=Object.assign({async:!0,allowTaint:!0,scale:S,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete U.onrendered,I.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,I.context2d.posX=this.opt.x,I.context2d.posY=this.opt.y,I.context2d.margin=this.opt.margin,I.context2d.fontFaces=_,_)for(var G=0;G<_.length;++G){var L=_[G],K=L.src.find(function(V){return V.format==="truetype"});K&&I.addFont(K.url,L.ref.name,L.ref.style)}return U.windowHeight=U.windowHeight||0,U.windowHeight=U.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):U.windowHeight,I.context2d.save(!0),f(this.prop.container,U)}).then(function(f){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(f),this.prop.canvas=f,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var d=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=d})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(d,f,I){return(I=I||"pdf").toLowerCase()==="img"||I.toLowerCase()==="image"?this.outputImg(d,f):this.outputPdf(d,f)},s.prototype.outputPdf=function(d,f){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(d,f)})},s.prototype.outputImg=function(d){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(d){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+d+'" is not supported.'}})},s.prototype.save=function(d){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(d?{filename:d}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(d){if(o(d)!=="object")return this;var f=Object.keys(d||{}).map(function(I){if(I in s.template.prop)return function(){this.prop[I]=d[I]};switch(I){case"margin":return this.setMargin.bind(this,d.margin);case"jsPDF":return function(){return this.opt.jsPDF=d.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,d.pageSize);default:return function(){this.opt[I]=d[I]}}},this);return this.then(function(){return this.thenList(f)})},s.prototype.get=function(d,f){return this.then(function(){var I=d in s.template.prop?this.prop[d]:this.opt[d];return f?f(I):I})},s.prototype.setMargin=function(d){return this.then(function(){switch(o(d)){case"number":d=[d,d,d,d];case"array":if(d.length===2&&(d=[d[0],d[1],d[0],d[1]]),d.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=d}).then(this.setPageSize)},s.prototype.setPageSize=function(d){function f(I,_){return Math.floor(I*_/72*96)}return this.then(function(){(d=d||ji.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(d.inner={width:d.width-this.opt.margin[1]-this.opt.margin[3],height:d.height-this.opt.margin[0]-this.opt.margin[2]},d.inner.px={width:f(d.inner.width,d.k),height:f(d.inner.height,d.k)},d.inner.ratio=d.inner.height/d.inner.width),this.prop.pageSize=d})},s.prototype.setProgress=function(d,f,I,_){return d!=null&&(this.progress.val=d),f!=null&&(this.progress.state=f),I!=null&&(this.progress.n=I),_!=null&&(this.progress.stack=_),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(d,f,I,_){return this.setProgress(d?this.progress.val+d:null,f||null,I?this.progress.n+I:null,_?this.progress.stack.concat(_):null)},s.prototype.then=function(d,f){var I=this;return this.thenCore(d,f,function(_,S){return I.updateProgress(null,null,1,[_]),Promise.prototype.then.call(this,function(U){return I.updateProgress(null,_),U}).then(_,S).then(function(U){return I.updateProgress(1),U})})},s.prototype.thenCore=function(d,f,I){I=I||Promise.prototype.then,d&&(d=d.bind(this)),f&&(f=f.bind(this));var _=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),S=I.call(_,d,f);return s.convert(S,this.__proto__)},s.prototype.thenExternal=function(d,f){return Promise.prototype.then.call(this,d,f)},s.prototype.thenList=function(d){var f=this;return d.forEach(function(I){f=f.thenCore(I)}),f},s.prototype.catch=function(d){d&&(d=d.bind(this));var f=Promise.prototype.catch.call(this,d);return s.convert(f,this)},s.prototype.catchExternal=function(d){return Promise.prototype.catch.call(this,d)},s.prototype.error=function(d){return this.then(function(){throw new Error(d)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,ji.getPageSize=function(d,f,I){if(Sr(d)==="object"){var _=d;d=_.orientation,f=_.unit||f,I=_.format||I}f=f||"mm",I=I||"a4",d=(""+(d||"P")).toLowerCase();var S,U=(""+I).toLowerCase(),G={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(f){case"pt":S=1;break;case"mm":S=72/25.4;break;case"cm":S=72/2.54;break;case"in":S=72;break;case"px":S=.75;break;case"pc":case"em":S=12;break;case"ex":S=6;break;default:throw"Invalid unit: "+f}var L,K=0,V=0;if(G.hasOwnProperty(U))K=G[U][1]/S,V=G[U][0]/S;else try{K=I[1],V=I[0]}catch{throw new Error("Invalid format: "+I)}if(d==="p"||d==="portrait")d="p",V>K&&(L=V,V=K,K=L);else{if(d!=="l"&&d!=="landscape")throw"Invalid orientation: "+d;d="l",K>V&&(L=V,V=K,K=L)}return{width:V,height:K,unit:f,k:S,orientation:d}},n.html=function(d,f){(f=f||{}).callback=f.callback||function(){},f.html2canvas=f.html2canvas||{},f.html2canvas.canvas=f.html2canvas.canvas||this.canvas,f.jsPDF=f.jsPDF||this,f.fontFaces=f.fontFaces?f.fontFaces.map(Jy):null;var I=new s(f);return f.worker?I:I.from(d).doCallback()}}(ji.API),ji.API.addJS=function(n){return E5=n,this.internal.events.subscribe("postPutResources",function(){em=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(em+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),L5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+E5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){em!==void 0&&L5!==void 0&&this.internal.out("/Names <</JavaScript "+em+" 0 R>>")}),this},function(n){var t;n.events.push(["postPutResources",function(){var r=this,o=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var A=r.outline.render().split(/\r\n/),s=0;s<A.length;s++){var d=A[s],f=o.exec(d);if(f!=null){var I=f[1];r.internal.newObjectDeferredBegin(I,!1)}r.internal.write(d)}if(this.outline.createNamedDestinations){var _=this.internal.pages.length,S=[];for(s=0;s<_;s++){var U=r.internal.newObject();S.push(U);var G=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+G.objId+" 0 R /XYZ null null null]>> endobj")}var L=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<S.length;s++)r.internal.write("(page_"+(s+1)+")"+S[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+L+" 0 R"),r.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),n.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(o,A,s){var d={title:A,options:s,children:[]};return o==null&&(o=this.root),o.children.push(d),d},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(o){o.id=r.internal.newObjectDeferred();for(var A=0;A<o.children.length;A++)this.genIds_r(o.children[A])},r.outline.renderRoot=function(o){this.objStart(o),this.line("/Type /Outlines"),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1]))),this.line("/Count "+this.count_r({count:0},o)),this.objEnd()},r.outline.renderItems=function(o){for(var A=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<o.children.length;s++){var d=o.children[s];this.objStart(d),this.line("/Title "+this.makeString(d.title)),this.line("/Parent "+this.makeRef(o)),s>0&&this.line("/Prev "+this.makeRef(o.children[s-1])),s<o.children.length-1&&this.line("/Next "+this.makeRef(o.children[s+1])),d.children.length>0&&(this.line("/First "+this.makeRef(d.children[0])),this.line("/Last "+this.makeRef(d.children[d.children.length-1])));var f=this.count=this.count_r({count:0},d);if(f>0&&this.line("/Count "+f),d.options&&d.options.pageNumber){var I=r.internal.getPageInfo(d.options.pageNumber);this.line("/Dest ["+I.objId+" 0 R /XYZ 0 "+A(0)+" 0]")}this.objEnd()}for(var _=0;_<o.children.length;_++)this.renderItems(o.children[_])},r.outline.line=function(o){this.ctx.val+=o+`\r
`},r.outline.makeRef=function(o){return o.id+" 0 R"},r.outline.makeString=function(o){return"("+r.internal.pdfEscape(o)+")"},r.outline.objStart=function(o){this.ctx.val+=`\r
`+o.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(o,A){for(var s=0;s<A.children.length;s++)o.count++,this.count_r(o,A.children[s]);return o.count}}])}(ji.API),function(n){var t=[192,193,194,195,196,197,198,199];n.processJPEG=function(r,o,A,s,d,f){var I,_=this.decode.DCT_DECODE,S=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=d||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(I=function(U){for(var G,L=256*U.charCodeAt(4)+U.charCodeAt(5),K=U.length,V={width:0,height:0,numcomponents:1},q=4;q<K;q+=2){if(q+=L,t.indexOf(U.charCodeAt(q+1))!==-1){G=256*U.charCodeAt(q+5)+U.charCodeAt(q+6),V={width:256*U.charCodeAt(q+7)+U.charCodeAt(q+8),height:G,numcomponents:U.charCodeAt(q+9)};break}L=256*U.charCodeAt(q+2)+U.charCodeAt(q+3)}return V}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:f=this.color_spaces.DEVICE_GRAY;break;case 4:f=this.color_spaces.DEVICE_CMYK;break;case 3:f=this.color_spaces.DEVICE_RGB}S={data:r,width:I.width,height:I.height,colorSpace:f,bitsPerComponent:8,filter:_,index:o,alias:A}}return S}}(ji.API);nK=function(){var n,t,r;function o(s){var d,f,I,_,S,U,G,L,K,V,q,z,it,At;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},U=null;;){switch(d=this.readUInt32(),K=function(){var _t,Lt;for(Lt=[],_t=0;_t<4;++_t)Lt.push(String.fromCharCode(this.data[this.pos++]));return Lt}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(d);break;case"fcTL":U&&this.animation.frames.push(U),this.pos+=4,U={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},S=this.readUInt16(),_=this.readUInt16()||100,U.delay=1e3*S/_,U.disposeOp=this.data[this.pos++],U.blendOp=this.data[this.pos++],U.data=[];break;case"IDAT":case"fdAT":for(K==="fdAT"&&(this.pos+=4,d-=4),s=U?.data||this.imgData,z=0;0<=d?z<d:z>d;0<=d?++z:--z)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(I=this.palette.length/3,this.transparency.indexed=this.read(d),this.transparency.indexed.length>I)throw new Error("More transparent colors than palette size");if((V=I-this.transparency.indexed.length)>0)for(it=0;0<=V?it<V:it>V;0<=V?++it:--it)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(d)[0];break;case 2:this.transparency.rgb=this.read(d)}break;case"tEXt":G=(q=this.read(d)).indexOf(0),L=String.fromCharCode.apply(String,q.slice(0,G)),this.text[L]=String.fromCharCode.apply(String,q.slice(G+1));break;case"IEND":return U&&this.animation.frames.push(U),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(At=this.colorType)===4||At===6,f=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*f,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=d}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}o.prototype.read=function(s){var d,f;for(f=[],d=0;0<=s?d<s:d>s;0<=s?++d:--d)f.push(this.data[this.pos++]);return f},o.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.decodePixels=function(s){var d=this.pixelBitlength/8,f=new Uint8Array(this.width*this.height*d),I=0,_=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function S(U,G,L,K){var V,q,z,it,At,_t,Lt,Et,xt,It,Nt,ie,lt,at,St,Bt,se,ee,qt,Xt,vt,Tt=Math.ceil((_.width-U)/L),pe=Math.ceil((_.height-G)/K),j=_.width==Tt&&_.height==pe;for(at=d*Tt,ie=j?f:new Uint8Array(at*pe),_t=s.length,lt=0,q=0;lt<pe&&I<_t;){switch(s[I++]){case 0:for(it=se=0;se<at;it=se+=1)ie[q++]=s[I++];break;case 1:for(it=ee=0;ee<at;it=ee+=1)V=s[I++],At=it<d?0:ie[q-d],ie[q++]=(V+At)%256;break;case 2:for(it=qt=0;qt<at;it=qt+=1)V=s[I++],z=(it-it%d)/d,St=lt&&ie[(lt-1)*at+z*d+it%d],ie[q++]=(St+V)%256;break;case 3:for(it=Xt=0;Xt<at;it=Xt+=1)V=s[I++],z=(it-it%d)/d,At=it<d?0:ie[q-d],St=lt&&ie[(lt-1)*at+z*d+it%d],ie[q++]=(V+Math.floor((At+St)/2))%256;break;case 4:for(it=vt=0;vt<at;it=vt+=1)V=s[I++],z=(it-it%d)/d,At=it<d?0:ie[q-d],lt===0?St=Bt=0:(St=ie[(lt-1)*at+z*d+it%d],Bt=z&&ie[(lt-1)*at+(z-1)*d+it%d]),Lt=At+St-Bt,Et=Math.abs(Lt-At),It=Math.abs(Lt-St),Nt=Math.abs(Lt-Bt),xt=Et<=It&&Et<=Nt?At:It<=Nt?St:Bt,ie[q++]=(V+xt)%256;break;default:throw new Error("Invalid filter algorithm: "+s[I-1])}if(!j){var mt=((G+lt*K)*_.width+U)*d,yt=lt*at;for(it=0;it<Tt;it+=1){for(var Qt=0;Qt<d;Qt+=1)f[mt++]=ie[yt++];mt+=(L-1)*d}}lt++}}return s=PD(s),_.interlaceMethod==1?(S(0,0,8,8),S(4,0,8,8),S(0,4,4,8),S(2,0,4,4),S(0,2,2,4),S(1,0,2,2),S(0,1,1,2)):S(0,0,1,1),f},o.prototype.decodePalette=function(){var s,d,f,I,_,S,U,G,L;for(f=this.palette,S=this.transparency.indexed||[],_=new Uint8Array((S.length||0)+f.length),I=0,s=0,d=U=0,G=f.length;U<G;d=U+=3)_[I++]=f[d],_[I++]=f[d+1],_[I++]=f[d+2],_[I++]=(L=S[s++])!=null?L:255;return _},o.prototype.copyToImageData=function(s,d){var f,I,_,S,U,G,L,K,V,q,z;if(I=this.colors,V=null,f=this.hasAlphaChannel,this.palette.length&&(V=(z=this._decodedPalette)!=null?z:this._decodedPalette=this.decodePalette(),I=4,f=!0),K=(_=s.data||s).length,U=V||d,S=G=0,I===1)for(;S<K;)L=V?4*d[S/4]:G,q=U[L++],_[S++]=q,_[S++]=q,_[S++]=q,_[S++]=f?U[L++]:255,G=L;else for(;S<K;)L=V?4*d[S/4]:G,_[S++]=U[L++],_[S++]=U[L++],_[S++]=U[L++],_[S++]=f?U[L++]:255,G=L},o.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var A=function(){if(Object.prototype.toString.call(qi)==="[object Window]"){try{t=qi.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return A(),n=function(s){var d;if(A()===!0)return r.width=s.width,r.height=s.height,r.clearRect(0,0,s.width,s.height),r.putImageData(s,0,0),(d=new Image).src=t.toDataURL(),d;throw new Error("This method requires a Browser with Canvas-capability.")},o.prototype.decodeFrames=function(s){var d,f,I,_,S,U,G,L;if(this.animation){for(L=[],f=S=0,U=(G=this.animation.frames).length;S<U;f=++S)d=G[f],I=s.createImageData(d.width,d.height),_=this.decodePixels(new Uint8Array(d.data)),this.copyToImageData(I,_),d.imageData=I,L.push(d.image=n(I));return L}},o.prototype.renderFrame=function(s,d){var f,I,_;return f=(I=this.animation.frames)[d],_=I[d-1],d===0&&s.clearRect(0,0,this.width,this.height),_?.disposeOp===1?s.clearRect(_.xOffset,_.yOffset,_.width,_.height):_?.disposeOp===2&&s.putImageData(_.imageData,_.xOffset,_.yOffset),f.blendOp===0&&s.clearRect(f.xOffset,f.yOffset,f.width,f.height),s.drawImage(f.image,f.xOffset,f.yOffset)},o.prototype.animate=function(s){var d,f,I,_,S,U,G=this;return f=0,U=this.animation,_=U.numFrames,I=U.frames,S=U.numPlays,(d=function(){var L,K;if(L=f++%_,K=I[L],G.renderFrame(s,L),_>1&&f/_<S)return G.animation._timeout=setTimeout(d,K.delay)})()},o.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},o.prototype.render=function(s){var d,f;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,d=s.getContext("2d"),this.animation?(this.decodeFrames(d),this.animate(d)):(f=d.createImageData(this.width,this.height),this.copyToImageData(f,this.decodePixels()),d.putImageData(f,0,0))},o}();(function(n){var t=function(){return typeof Vy=="function"},r=function(G,L,K,V){var q=4,z=d;switch(V){case n.image_compression.FAST:q=1,z=s;break;case n.image_compression.MEDIUM:q=6,z=f;break;case n.image_compression.SLOW:q=9,z=I}G=o(G,L,K,z);var it=Vy(G,{level:q});return n.__addimage__.arrayBufferToBinaryString(it)},o=function(G,L,K,V){for(var q,z,it,At=G.length/L,_t=new Uint8Array(G.length+At),Lt=S(),Et=0;Et<At;Et+=1){if(it=Et*L,q=G.subarray(it,it+L),V)_t.set(V(q,K,z),it+Et);else{for(var xt,It=Lt.length,Nt=[];xt<It;xt+=1)Nt[xt]=Lt[xt](q,K,z);var ie=U(Nt.concat());_t.set(Nt[ie],it+Et)}z=q}return _t},A=function(G){var L=Array.apply([],G);return L.unshift(0),L},s=function(G,L){var K,V=[],q=G.length;V[0]=1;for(var z=0;z<q;z+=1)K=G[z-L]||0,V[z+1]=G[z]-K+256&255;return V},d=function(G,L,K){var V,q=[],z=G.length;q[0]=2;for(var it=0;it<z;it+=1)V=K&&K[it]||0,q[it+1]=G[it]-V+256&255;return q},f=function(G,L,K){var V,q,z=[],it=G.length;z[0]=3;for(var At=0;At<it;At+=1)V=G[At-L]||0,q=K&&K[At]||0,z[At+1]=G[At]+256-(V+q>>>1)&255;return z},I=function(G,L,K){var V,q,z,it,At=[],_t=G.length;At[0]=4;for(var Lt=0;Lt<_t;Lt+=1)V=G[Lt-L]||0,q=K&&K[Lt]||0,z=K&&K[Lt-L]||0,it=_(V,q,z),At[Lt+1]=G[Lt]-it+256&255;return At},_=function(G,L,K){if(G===L&&L===K)return G;var V=Math.abs(L-K),q=Math.abs(G-K),z=Math.abs(G+L-K-K);return V<=q&&V<=z?G:q<=z?L:K},S=function(){return[A,s,d,f,I]},U=function(G){var L=G.map(function(K){return K.reduce(function(V,q){return V+Math.abs(q)},0)});return L.indexOf(Math.min.apply(null,L))};n.processPNG=function(G,L,K,V){var q,z,it,At,_t,Lt,Et,xt,It,Nt,ie,lt,at,St,Bt,se=this.decode.FLATE_DECODE,ee="";if(this.__addimage__.isArrayBuffer(G)&&(G=new Uint8Array(G)),this.__addimage__.isArrayBufferView(G)){if(G=(it=new nK(G)).imgData,z=it.bits,q=it.colorSpace,_t=it.colors,[4,6].indexOf(it.colorType)!==-1){if(it.bits===8){It=(xt=it.pixelBitlength==32?new Uint32Array(it.decodePixels().buffer):it.pixelBitlength==16?new Uint16Array(it.decodePixels().buffer):new Uint8Array(it.decodePixels().buffer)).length,ie=new Uint8Array(It*it.colors),Nt=new Uint8Array(It);var qt,Xt=it.pixelBitlength-it.bits;for(St=0,Bt=0;St<It;St++){for(at=xt[St],qt=0;qt<Xt;)ie[Bt++]=at>>>qt&255,qt+=it.bits;Nt[St]=at>>>qt&255}}if(it.bits===16){It=(xt=new Uint32Array(it.decodePixels().buffer)).length,ie=new Uint8Array(It*(32/it.pixelBitlength)*it.colors),Nt=new Uint8Array(It*(32/it.pixelBitlength)),lt=it.colors>1,St=0,Bt=0;for(var vt=0;St<It;)at=xt[St++],ie[Bt++]=at>>>0&255,lt&&(ie[Bt++]=at>>>16&255,at=xt[St++],ie[Bt++]=at>>>0&255),Nt[vt++]=at>>>16&255;z=8}V!==n.image_compression.NONE&&t()?(G=r(ie,it.width*it.colors,it.colors,V),Et=r(Nt,it.width,1,V)):(G=ie,Et=Nt,se=void 0)}if(it.colorType===3&&(q=this.color_spaces.INDEXED,Lt=it.palette,it.transparency.indexed)){var Tt=it.transparency.indexed,pe=0;for(St=0,It=Tt.length;St<It;++St)pe+=Tt[St];if((pe/=255)===It-1&&Tt.indexOf(0)!==-1)At=[Tt.indexOf(0)];else if(pe!==It){for(xt=it.decodePixels(),Nt=new Uint8Array(xt.length),St=0,It=xt.length;St<It;St++)Nt[St]=Tt[xt[St]];Et=r(Nt,it.width,1)}}var j=function(mt){var yt;switch(mt){case n.image_compression.FAST:yt=11;break;case n.image_compression.MEDIUM:yt=13;break;case n.image_compression.SLOW:yt=14;break;default:yt=12}return yt}(V);return se===this.decode.FLATE_DECODE&&(ee="/Predictor "+j+" "),ee+="/Colors "+_t+" /BitsPerComponent "+z+" /Columns "+it.width,(this.__addimage__.isArrayBuffer(G)||this.__addimage__.isArrayBufferView(G))&&(G=this.__addimage__.arrayBufferToBinaryString(G)),(Et&&this.__addimage__.isArrayBuffer(Et)||this.__addimage__.isArrayBufferView(Et))&&(Et=this.__addimage__.arrayBufferToBinaryString(Et)),{alias:K,data:G,index:L,filter:se,decodeParameters:ee,transparency:At,palette:Lt,sMask:Et,predictor:j,width:it.width,height:it.height,bitsPerComponent:z,colorSpace:q}}}})(ji.API),function(n){n.processGIF89A=function(t,r,o,A){var s=new sK(t),d=s.width,f=s.height,I=[];s.decodeAndBlitFrameRGBA(0,I);var _={data:I,width:d,height:f},S=new Zy(100).encode(_,100);return n.processJPEG.call(this,S,r,o,A)},n.processGIF87A=n.processGIF89A}(ji.API),mA.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var t=0;t<n;t++){var r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:A,green:o,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},mA.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[n]()}catch(r){sn.log("bit decode error:"+r)}},mA.prototype.bit1=function(){var n,t=Math.ceil(this.width/8),r=t%4;for(n=this.height-1;n>=0;n--){for(var o=this.bottom_up?n:this.height-1-n,A=0;A<t;A++)for(var s=this.datav.getUint8(this.pos++,!0),d=o*this.width*4+8*A*4,f=0;f<8&&8*A+f<this.width;f++){var I=this.palette[s>>7-f&1];this.data[d+4*f]=I.blue,this.data[d+4*f+1]=I.green,this.data[d+4*f+2]=I.red,this.data[d+4*f+3]=255}r!==0&&(this.pos+=4-r)}},mA.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),t=n%4,r=this.height-1;r>=0;r--){for(var o=this.bottom_up?r:this.height-1-r,A=0;A<n;A++){var s=this.datav.getUint8(this.pos++,!0),d=o*this.width*4+2*A*4,f=s>>4,I=15&s,_=this.palette[f];if(this.data[d]=_.blue,this.data[d+1]=_.green,this.data[d+2]=_.red,this.data[d+3]=255,2*A+1>=this.width)break;_=this.palette[I],this.data[d+4]=_.blue,this.data[d+4+1]=_.green,this.data[d+4+2]=_.red,this.data[d+4+3]=255}t!==0&&(this.pos+=4-t)}},mA.prototype.bit8=function(){for(var n=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,o=0;o<this.width;o++){var A=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*o;if(A<this.palette.length){var d=this.palette[A];this.data[s]=d.red,this.data[s+1]=d.green,this.data[s+2]=d.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}n!==0&&(this.pos+=4-n)}},mA.prototype.bit15=function(){for(var n=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var o=this.bottom_up?r:this.height-1-r,A=0;A<this.width;A++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var d=(s&t)/t*255|0,f=(s>>5&t)/t*255|0,I=(s>>10&t)/t*255|0,_=s>>15?255:0,S=o*this.width*4+4*A;this.data[S]=I,this.data[S+1]=f,this.data[S+2]=d,this.data[S+3]=_}this.pos+=n}},mA.prototype.bit16=function(){for(var n=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),o=this.height-1;o>=0;o--){for(var A=this.bottom_up?o:this.height-1-o,s=0;s<this.width;s++){var d=this.datav.getUint16(this.pos,!0);this.pos+=2;var f=(d&t)/t*255|0,I=(d>>5&r)/r*255|0,_=(d>>11)/t*255|0,S=A*this.width*4+4*s;this.data[S]=_,this.data[S+1]=I,this.data[S+2]=f,this.data[S+3]=255}this.pos+=n}},mA.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var t=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var o=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),d=t*this.width*4+4*r;this.data[d]=s,this.data[d+1]=A,this.data[d+2]=o,this.data[d+3]=255}this.pos+=this.width%4}},mA.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var t=this.bottom_up?n:this.height-1-n,r=0;r<this.width;r++){var o=this.datav.getUint8(this.pos++,!0),A=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),f=t*this.width*4+4*r;this.data[f]=s,this.data[f+1]=A,this.data[f+2]=o,this.data[f+3]=d}},mA.prototype.getData=function(){return this.data},function(n){n.processBMP=function(t,r,o,A){var s=new mA(t,!1),d=s.width,f=s.height,I={data:s.getData(),width:d,height:f},_=new Zy(100).encode(I,100);return n.processJPEG.call(this,_,r,o,A)}}(ji.API),Z5.prototype.getData=function(){return this.data},function(n){n.processWEBP=function(t,r,o,A){var s=new Z5(t),d=s.width,f=s.height,I={data:s.getData(),width:d,height:f},_=new Zy(100).encode(I,100);return n.processJPEG.call(this,_,r,o,A)}}(ji.API),ji.API.processRGBA=function(n,t,r){for(var o=n.data,A=o.length,s=new Uint8Array(A/4*3),d=new Uint8Array(A/4),f=0,I=0,_=0;_<A;_+=4){var S=o[_],U=o[_+1],G=o[_+2],L=o[_+3];s[f++]=S,s[f++]=U,s[f++]=G,d[I++]=L}var K=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(d),data:K,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},ji.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},gh=ji.API,im=gh.getCharWidthsArray=function(n,t){var r,o,A=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),d=t.charSpace||this.internal.getCharSpace(),f=t.widths?t.widths:A.metadata.Unicode.widths,I=f.fof?f.fof:1,_=t.kerning?t.kerning:A.metadata.Unicode.kerning,S=_.fof?_.fof:1,U=t.doKerning!==!1,G=0,L=n.length,K=0,V=f[0]||I,q=[];for(r=0;r<L;r++)o=n.charCodeAt(r),typeof A.metadata.widthOfString=="function"?q.push((A.metadata.widthOfGlyph(A.metadata.characterToGlyph(o))+d*(1e3/s)||0)/1e3):(G=U&&Sr(_[o])==="object"&&!isNaN(parseInt(_[o][K],10))?_[o][K]/S:0,q.push((f[o]||V)/I+G)),K=o;return q},U5=gh.getStringUnitWidth=function(n,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),o=t.font||this.internal.getFont(),A=t.charSpace||this.internal.getCharSpace();return gh.processArabic&&(n=gh.processArabic(n)),typeof o.metadata.widthOfString=="function"?o.metadata.widthOfString(n,r,A)/r:im.apply(this,arguments).reduce(function(s,d){return s+d},0)},Q5=function(n,t,r,o){for(var A=[],s=0,d=n.length,f=0;s!==d&&f+t[s]<r;)f+=t[s],s++;A.push(n.slice(0,s));var I=s;for(f=0;s!==d;)f+t[s]>o&&(A.push(n.slice(I,s)),f=0,I=s),f+=t[s],s++;return I!==s&&A.push(n.slice(I,s)),A},R5=function(n,t,r){r||(r={});var o,A,s,d,f,I,_,S=[],U=[S],G=r.textIndent||0,L=0,K=0,V=n.split(" "),q=im.apply(this,[" ",r])[0];if(I=r.lineIndent===-1?V[0].length+2:r.lineIndent||0){var z=Array(I).join(" "),it=[];V.map(function(_t){(_t=_t.split(/\s*\n/)).length>1?it=it.concat(_t.map(function(Lt,Et){return(Et&&Lt.length?`
`:"")+Lt})):it.push(_t[0])}),V=it,I=U5.apply(this,[z,r])}for(s=0,d=V.length;s<d;s++){var At=0;if(o=V[s],I&&o[0]==`
`&&(o=o.substr(1),At=1),G+L+(K=(A=im.apply(this,[o,r])).reduce(function(_t,Lt){return _t+Lt},0))>t||At){if(K>t){for(f=Q5.apply(this,[o,A,t-(G+L),t]),S.push(f.shift()),S=[f.pop()];f.length;)U.push([f.shift()]);K=A.slice(o.length-(S[0]?S[0].length:0)).reduce(function(_t,Lt){return _t+Lt},0)}else S=[o];U.push(S),G=K+I,L=q}else S.push(o),G+=L+K,L=q}return _=I?function(_t,Lt){return(Lt?z:"")+_t.join(" ")}:function(_t){return _t.join(" ")},U.map(_)},gh.splitTextToSize=function(n,t,r){var o,A=(r=r||{}).fontSize||this.internal.getFontSize(),s=function(S){if(S.widths&&S.kerning)return{widths:S.widths,kerning:S.kerning};var U=this.internal.getFont(S.fontName,S.fontStyle);return U.metadata.Unicode?{widths:U.metadata.Unicode.widths||{0:1},kerning:U.metadata.Unicode.kerning||{}}:{font:U.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);o=Array.isArray(n)?n:String(n).split(/\r?\n/);var d=1*this.internal.scaleFactor*t/A;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/A:0,s.lineIndent=r.lineIndent;var f,I,_=[];for(f=0,I=o.length;f<I;f++)_=_.concat(R5.apply(this,[o[f],d,s]));return _},function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},o={},A=0;A<t.length;A++)r[t[A]]="0123456789abcdef"[A],o["0123456789abcdef"[A]]=t[A];var s=function(U){return"0x"+parseInt(U,10).toString(16)},d=n.__fontmetrics__.compress=function(U){var G,L,K,V,q=["{"];for(var z in U){if(G=U[z],isNaN(parseInt(z,10))?L="'"+z+"'":(z=parseInt(z,10),L=(L=s(z).slice(2)).slice(0,-1)+o[L.slice(-1)]),typeof G=="number")G<0?(K=s(G).slice(3),V="-"):(K=s(G).slice(2),V=""),K=V+K.slice(0,-1)+o[K.slice(-1)];else{if(Sr(G)!=="object")throw new Error("Don't know what to do with value type "+Sr(G)+".");K=d(G)}q.push(L+K)}return q.push("}"),q.join("")},f=n.__fontmetrics__.uncompress=function(U){if(typeof U!="string")throw new Error("Invalid argument passed to uncompress.");for(var G,L,K,V,q={},z=1,it=q,At=[],_t="",Lt="",Et=U.length-1,xt=1;xt<Et;xt+=1)(V=U[xt])=="'"?G?(K=G.join(""),G=void 0):G=[]:G?G.push(V):V=="{"?(At.push([it,K]),it={},K=void 0):V=="}"?((L=At.pop())[0][L[1]]=it,K=void 0,it=L[0]):V=="-"?z=-1:K===void 0?r.hasOwnProperty(V)?(_t+=r[V],K=parseInt(_t,16)*z,z=1,_t=""):_t+=V:r.hasOwnProperty(V)?(Lt+=r[V],it[K]=parseInt(Lt,16)*z,z=1,K=void 0,Lt=""):Lt+=V;return q},I={codePages:["WinAnsiEncoding"],WinAnsiEncoding:f("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},_={Unicode:{Courier:I,"Courier-Bold":I,"Courier-BoldOblique":I,"Courier-Oblique":I,Helvetica:I,"Helvetica-Bold":I,"Helvetica-BoldOblique":I,"Helvetica-Oblique":I,"Times-Roman":I,"Times-Bold":I,"Times-BoldItalic":I,"Times-Italic":I}},S={Unicode:{"Courier-Oblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":f("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":f("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:f("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:f("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":f("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":f("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(U){var G=U.font,L=S.Unicode[G.postScriptName];L&&(G.metadata.Unicode={},G.metadata.Unicode.widths=L.widths,G.metadata.Unicode.kerning=L.kerning);var K=_.Unicode[G.postScriptName];K&&(G.metadata.Unicode.encoding=K,G.encoding=K.codePages[0])}])}(ji.API),function(n){var t=function(r){for(var o=r.length,A=new Uint8Array(o),s=0;s<o;s++)A[s]=r.charCodeAt(s);return A};n.API.events.push(["addFont",function(r){var o=void 0,A=r.font,s=r.instance;if(!A.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+A.postScriptName+"').");if(typeof(o=s.existsFileInVFS(A.postScriptName)===!1?s.loadFile(A.postScriptName):s.getFileFromVFS(A.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+A.postScriptName+"').");(function(d,f){f=/^\x00\x01\x00\x00/.test(f)?t(f):t(Yg(f)),d.metadata=n.API.TTFFont.open(f),d.metadata.Unicode=d.metadata.Unicode||{encoding:{},kerning:{},widths:[]},d.metadata.glyIdsUsed=[0]})(A,o)}}])}(ji),function(n){function t(){return(qi.canvg?Promise.resolve(qi.canvg):Promise.resolve().then(()=>(m5(),f5))).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}ji.API.addSvgAsImage=function(r,o,A,s,d,f,I,_){if(isNaN(o)||isNaN(A))throw sn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(d))throw sn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var S=document.createElement("canvas");S.width=s,S.height=d;var U=S.getContext("2d");U.fillStyle="#fff",U.fillRect(0,0,S.width,S.height);var G={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},L=this;return t().then(function(K){return K.fromString(U,r,G)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(K){return K.render(G)}).then(function(){L.addImage(S.toDataURL("image/jpeg",1),o,A,s,d,I,_)})}}(),ji.API.putTotalPages=function(n){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(n,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var o=1;o<=this.internal.getNumberOfPages();o++)for(var A=0;A<this.internal.pages[o].length;A++)this.internal.pages[o][A]=this.internal.pages[o][A].replace(t,r);return this},ji.API.viewerPreferences=function(n,t){var r;n=n||{},t=t||!1;var o,A,s,d={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},f=Object.keys(d),I=[],_=0,S=0,U=0;function G(K,V){var q,z=!1;for(q=0;q<K.length;q+=1)K[q]===V&&(z=!0);return z}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(d)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,n==="reset"||t===!0){var L=f.length;for(U=0;U<L;U+=1)r[f[U]].value=r[f[U]].defaultValue,r[f[U]].explicitSet=!1}if(Sr(n)==="object"){for(A in n)if(s=n[A],G(f,A)&&s!==void 0){if(r[A].type==="boolean"&&typeof s=="boolean")r[A].value=s;else if(r[A].type==="name"&&G(r[A].valueSet,s))r[A].value=s;else if(r[A].type==="integer"&&Number.isInteger(s))r[A].value=s;else if(r[A].type==="array"){for(_=0;_<s.length;_+=1)if(o=!0,s[_].length===1&&typeof s[_][0]=="number")I.push(String(s[_]-1));else if(s[_].length>1){for(S=0;S<s[_].length;S+=1)typeof s[_][S]!="number"&&(o=!1);o===!0&&I.push([s[_][0]-1,s[_][1]-1].join(" "))}r[A].value="["+I.join(" ")+"]"}else r[A].value=r[A].defaultValue;r[A].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var K,V=[];for(K in r)r[K].explicitSet===!0&&(r[K].type==="name"?V.push("/"+K+" /"+r[K].value):V.push("/"+K+" "+r[K].value));V.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+V.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(n){var t=function(){var o='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',A=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(o)),d=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),f=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),I=unescape(encodeURIComponent("</x:xmpmeta>")),_=s.length+d.length+f.length+A.length+I.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+_+" >>"),this.internal.write("stream"),this.internal.write(A+s+d+f+I),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(o,A){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:o,namespaceuri:A||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(ji.API),function(n){var t=n.API,r=t.pdfEscape16=function(s,d){for(var f,I=d.metadata.Unicode.widths,_=["","0","00","000","0000"],S=[""],U=0,G=s.length;U<G;++U){if(f=d.metadata.characterToGlyph(s.charCodeAt(U)),d.metadata.glyIdsUsed.push(f),d.metadata.toUnicode[f]=s.charCodeAt(U),I.indexOf(f)==-1&&(I.push(f),I.push([parseInt(d.metadata.widthOfGlyph(f),10)])),f=="0")return S.join("");f=f.toString(16),S.push(_[4-f.length],f)}return S.join("")},o=function(s){var d,f,I,_,S,U,G;for(S=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,I=[],U=0,G=(f=Object.keys(s).sort(function(L,K){return L-K})).length;U<G;U++)d=f[U],I.length>=100&&(S+=`
`+I.length+` beginbfchar
`+I.join(`
`)+`
endbfchar`,I=[]),s[d]!==void 0&&s[d]!==null&&typeof s[d].toString=="function"&&(_=("0000"+s[d].toString(16)).slice(-4),d=("0000"+(+d).toString(16)).slice(-4),I.push("<"+d+"><"+_+">"));return I.length&&(S+=`
`+I.length+` beginbfchar
`+I.join(`
`)+`
endbfchar
`),S+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(d){var f=d.font,I=d.out,_=d.newObject,S=d.putStream;if(f.metadata instanceof n.API.TTFFont&&f.encoding==="Identity-H"){for(var U=f.metadata.Unicode.widths,G=f.metadata.subset.encode(f.metadata.glyIdsUsed,1),L="",K=0;K<G.length;K++)L+=String.fromCharCode(G[K]);var V=_();S({data:L,addLength1:!0,objectId:V}),I("endobj");var q=_();S({data:o(f.metadata.toUnicode),addLength1:!0,objectId:q}),I("endobj");var z=_();I("<<"),I("/Type /FontDescriptor"),I("/FontName /"+ph(f.fontName)),I("/FontFile2 "+V+" 0 R"),I("/FontBBox "+n.API.PDFObject.convert(f.metadata.bbox)),I("/Flags "+f.metadata.flags),I("/StemV "+f.metadata.stemV),I("/ItalicAngle "+f.metadata.italicAngle),I("/Ascent "+f.metadata.ascender),I("/Descent "+f.metadata.decender),I("/CapHeight "+f.metadata.capHeight),I(">>"),I("endobj");var it=_();I("<<"),I("/Type /Font"),I("/BaseFont /"+ph(f.fontName)),I("/FontDescriptor "+z+" 0 R"),I("/W "+n.API.PDFObject.convert(U)),I("/CIDToGIDMap /Identity"),I("/DW 1000"),I("/Subtype /CIDFontType2"),I("/CIDSystemInfo"),I("<<"),I("/Supplement 0"),I("/Registry (Adobe)"),I("/Ordering ("+f.encoding+")"),I(">>"),I(">>"),I("endobj"),f.objectNumber=_(),I("<<"),I("/Type /Font"),I("/Subtype /Type0"),I("/ToUnicode "+q+" 0 R"),I("/BaseFont /"+ph(f.fontName)),I("/Encoding /"+f.encoding),I("/DescendantFonts ["+it+" 0 R]"),I(">>"),I("endobj"),f.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(d){var f=d.font,I=d.out,_=d.newObject,S=d.putStream;if(f.metadata instanceof n.API.TTFFont&&f.encoding==="WinAnsiEncoding"){for(var U=f.metadata.rawData,G="",L=0;L<U.length;L++)G+=String.fromCharCode(U[L]);var K=_();S({data:G,addLength1:!0,objectId:K}),I("endobj");var V=_();S({data:o(f.metadata.toUnicode),addLength1:!0,objectId:V}),I("endobj");var q=_();I("<<"),I("/Descent "+f.metadata.decender),I("/CapHeight "+f.metadata.capHeight),I("/StemV "+f.metadata.stemV),I("/Type /FontDescriptor"),I("/FontFile2 "+K+" 0 R"),I("/Flags 96"),I("/FontBBox "+n.API.PDFObject.convert(f.metadata.bbox)),I("/FontName /"+ph(f.fontName)),I("/ItalicAngle "+f.metadata.italicAngle),I("/Ascent "+f.metadata.ascender),I(">>"),I("endobj"),f.objectNumber=_();for(var z=0;z<f.metadata.hmtx.widths.length;z++)f.metadata.hmtx.widths[z]=parseInt(f.metadata.hmtx.widths[z]*(1e3/f.metadata.head.unitsPerEm));I("<</Subtype/TrueType/Type/Font/ToUnicode "+V+" 0 R/BaseFont/"+ph(f.fontName)+"/FontDescriptor "+q+" 0 R/Encoding/"+f.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(f.metadata.hmtx.widths)+">>"),I("endobj"),f.isAlreadyPutted=!0}})(s)}]);var A=function(s){var d,f=s.text||"",I=s.x,_=s.y,S=s.options||{},U=s.mutex||{},G=U.pdfEscape,L=U.activeFontKey,K=U.fonts,V=L,q="",z=0,it="",At=K[V].encoding;if(K[V].encoding!=="Identity-H")return{text:f,x:I,y:_,options:S,mutex:U};for(it=f,V=L,Array.isArray(f)&&(it=f[0]),z=0;z<it.length;z+=1)K[V].metadata.hasOwnProperty("cmap")&&(d=K[V].metadata.cmap.unicode.codeMap[it[z].charCodeAt(0)]),d||it[z].charCodeAt(0)<256&&K[V].metadata.hasOwnProperty("Unicode")?q+=it[z]:q+="";var _t="";return parseInt(V.slice(1))<14||At==="WinAnsiEncoding"?_t=G(q,V).split("").map(function(Lt){return Lt.charCodeAt(0).toString(16)}).join(""):At==="Identity-H"&&(_t=r(q,K[V])),U.isHex=!0,{text:_t,x:I,y:_,options:S,mutex:U}};t.events.push(["postProcessText",function(s){var d=s.text||"",f=[],I={text:d,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(d)){var _=0;for(_=0;_<d.length;_+=1)Array.isArray(d[_])&&d[_].length===3?f.push([A(Object.assign({},I,{text:d[_][0]})).text,d[_][1],d[_][2]]):f.push(A(Object.assign({},I,{text:d[_]})).text);s.text=f}else s.text=A(Object.assign({},I,{text:d})).text}])}(ji),function(n){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},n.addFileToVFS=function(r,o){return t.call(this),this.internal.vFS[r]=o,this},n.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(ji.API),function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(o){var A,s,d,f,I,_,S,U=t,G=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],L=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],K={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},V={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},q=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],z=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),it=!1,At=0;this.__bidiEngine__={};var _t=function(lt){var at=lt.charCodeAt(),St=at>>8,Bt=V[St];return Bt!==void 0?U[256*Bt+(255&at)]:St===252||St===253?"AL":z.test(St)?"L":St===8?"R":"N"},Lt=function(lt){for(var at,St=0;St<lt.length;St++){if((at=_t(lt.charAt(St)))==="L")return!1;if(at==="R")return!0}return!1},Et=function(lt,at,St,Bt){var se,ee,qt,Xt,vt=at[Bt];switch(vt){case"L":case"R":it=!1;break;case"N":case"AN":break;case"EN":it&&(vt="AN");break;case"AL":it=!0,vt="R";break;case"WS":vt="N";break;case"CS":Bt<1||Bt+1>=at.length||(se=St[Bt-1])!=="EN"&&se!=="AN"||(ee=at[Bt+1])!=="EN"&&ee!=="AN"?vt="N":it&&(ee="AN"),vt=ee===se?ee:"N";break;case"ES":vt=(se=Bt>0?St[Bt-1]:"B")==="EN"&&Bt+1<at.length&&at[Bt+1]==="EN"?"EN":"N";break;case"ET":if(Bt>0&&St[Bt-1]==="EN"){vt="EN";break}if(it){vt="N";break}for(qt=Bt+1,Xt=at.length;qt<Xt&&at[qt]==="ET";)qt++;vt=qt<Xt&&at[qt]==="EN"?"EN":"N";break;case"NSM":if(d&&!f){for(Xt=at.length,qt=Bt+1;qt<Xt&&at[qt]==="NSM";)qt++;if(qt<Xt){var Tt=lt[Bt],pe=Tt>=1425&&Tt<=2303||Tt===64286;if(se=at[qt],pe&&(se==="R"||se==="AL")){vt="R";break}}}vt=Bt<1||(se=at[Bt-1])==="B"?"N":St[Bt-1];break;case"B":it=!1,A=!0,vt=At;break;case"S":s=!0,vt="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":it=!1;break;case"BN":vt="N"}return vt},xt=function(lt,at,St){var Bt=lt.split("");return St&&It(Bt,St,{hiLevel:At}),Bt.reverse(),at&&at.reverse(),Bt.join("")},It=function(lt,at,St){var Bt,se,ee,qt,Xt,vt=-1,Tt=lt.length,pe=0,j=[],mt=At?L:G,yt=[];for(it=!1,A=!1,s=!1,se=0;se<Tt;se++)yt[se]=_t(lt[se]);for(ee=0;ee<Tt;ee++){if(Xt=pe,j[ee]=Et(lt,yt,j,ee),Bt=240&(pe=mt[Xt][K[j[ee]]]),pe&=15,at[ee]=qt=mt[pe][5],Bt>0)if(Bt===16){for(se=vt;se<ee;se++)at[se]=1;vt=-1}else vt=-1;if(mt[pe][6])vt===-1&&(vt=ee);else if(vt>-1){for(se=vt;se<ee;se++)at[se]=qt;vt=-1}yt[ee]==="B"&&(at[ee]=0),St.hiLevel|=qt}s&&function(Qt,Ht,ae){for(var ge=0;ge<ae;ge++)if(Qt[ge]==="S"){Ht[ge]=At;for(var de=ge-1;de>=0&&Qt[de]==="WS";de--)Ht[de]=At}}(yt,at,Tt)},Nt=function(lt,at,St,Bt,se){if(!(se.hiLevel<lt)){if(lt===1&&At===1&&!A)return at.reverse(),void(St&&St.reverse());for(var ee,qt,Xt,vt,Tt=at.length,pe=0;pe<Tt;){if(Bt[pe]>=lt){for(Xt=pe+1;Xt<Tt&&Bt[Xt]>=lt;)Xt++;for(vt=pe,qt=Xt-1;vt<qt;vt++,qt--)ee=at[vt],at[vt]=at[qt],at[qt]=ee,St&&(ee=St[vt],St[vt]=St[qt],St[qt]=ee);pe=Xt}pe++}}},ie=function(lt,at,St){var Bt=lt.split(""),se={hiLevel:At};return St||(St=[]),It(Bt,St,se),function(ee,qt,Xt){if(Xt.hiLevel!==0&&S)for(var vt,Tt=0;Tt<ee.length;Tt++)qt[Tt]===1&&(vt=q.indexOf(ee[Tt]))>=0&&(ee[Tt]=q[vt+1])}(Bt,St,se),Nt(2,Bt,at,St,se),Nt(1,Bt,at,St,se),Bt.join("")};return this.__bidiEngine__.doBidiReorder=function(lt,at,St){if(function(se,ee){if(ee)for(var qt=0;qt<se.length;qt++)ee[qt]=qt;f===void 0&&(f=Lt(se)),_===void 0&&(_=Lt(se))}(lt,at),d||!I||_)if(d&&I&&f^_)At=f?1:0,lt=xt(lt,at,St);else if(!d&&I&&_)At=f?1:0,lt=ie(lt,at,St),lt=xt(lt,at);else if(!d||f||I||_){if(d&&!I&&f^_)lt=xt(lt,at),f?(At=0,lt=ie(lt,at,St)):(At=1,lt=ie(lt,at,St),lt=xt(lt,at));else if(d&&f&&!I&&_)At=1,lt=ie(lt,at,St),lt=xt(lt,at);else if(!d&&!I&&f^_){var Bt=S;f?(At=1,lt=ie(lt,at,St),At=0,S=!1,lt=ie(lt,at,St),S=Bt):(At=0,lt=ie(lt,at,St),lt=xt(lt,at),At=1,S=!1,lt=ie(lt,at,St),S=Bt,lt=xt(lt,at))}}else At=0,lt=ie(lt,at,St);else At=f?1:0,lt=ie(lt,at,St);return lt},this.__bidiEngine__.setOptions=function(lt){lt&&(d=lt.isInputVisual,I=lt.isOutputVisual,f=lt.isInputRtl,_=lt.isOutputRtl,S=lt.isSymmetricSwapping)},this.__bidiEngine__.setOptions(o),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(o){var A=o.text,s=(o.x,o.y,o.options||{}),d=(o.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(A)==="[object Array]"){var f=0;for(d=[],f=0;f<A.length;f+=1)Object.prototype.toString.call(A[f])==="[object Array]"?d.push([r.doBidiReorder(A[f][0]),A[f][1],A[f][2]]):d.push([r.doBidiReorder(A[f])]);o.text=d}else o.text=r.doBidiReorder(A);r.setOptions({isInputVisual:!0})}])}(ji),ji.API.TTFFont=function(){function n(t){var r;if(this.rawData=t,r=this.contents=new Cc(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new yK(this),this.registerTTF()}return n.open=function(t){return new n(t)},n.prototype.parse=function(){return this.directory=new oK(this.contents),this.head=new AK(this),this.name=new gK(this),this.cmap=new iS(this),this.toUnicode={},this.hhea=new lK(this),this.maxp=new dK(this),this.hmtx=new pK(this),this.post=new uK(this),this.os2=new cK(this),this.loca=new IK(this),this.glyf=new fK(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var t,r,o,A,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var d,f,I,_;for(_=[],d=0,f=(I=this.bbox).length;d<f;d++)t=I[d],_.push(Math.round(t*this.scaleFactor));return _}.call(this),this.stemV=0,this.post.exists?(o=255&(A=this.post.italic_angle),32768&(r=A>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+o)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},n.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},n.prototype.widthOfString=function(t,r,o){var A,s,d,f;for(d=0,s=0,f=(t=""+t).length;0<=f?s<f:s>f;s=0<=f?++s:--s)A=t.charCodeAt(s),d+=this.widthOfGlyph(this.characterToGlyph(A))+o*(1e3/r)||0;return d*(r/1e3)},n.prototype.lineHeight=function(t,r){var o;return r==null&&(r=!1),o=r?this.lineGap:0,(this.ascender+o-this.decender)/1e3*t},n}();Cc=function(){function n(t){this.data=t??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(t){return this.data[this.pos++]=t},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},n.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},n.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},n.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},n.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},n.prototype.readString=function(t){var r,o;for(o=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)o[r]=String.fromCharCode(this.readByte());return o.join("")},n.prototype.writeString=function(t){var r,o,A;for(A=[],r=0,o=t.length;0<=o?r<o:r>o;r=0<=o?++r:--r)A.push(this.writeByte(t.charCodeAt(r)));return A},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(t){return this.writeInt16(t)},n.prototype.readLongLong=function(){var t,r,o,A,s,d,f,I;return t=this.readByte(),r=this.readByte(),o=this.readByte(),A=this.readByte(),s=this.readByte(),d=this.readByte(),f=this.readByte(),I=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^o)+4294967296*(255^A)+16777216*(255^s)+65536*(255^d)+256*(255^f)+(255^I)+1):72057594037927940*t+281474976710656*r+1099511627776*o+4294967296*A+16777216*s+65536*d+256*f+I},n.prototype.writeLongLong=function(t){var r,o;return r=Math.floor(t/4294967296),o=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(o>>24&255),this.writeByte(o>>16&255),this.writeByte(o>>8&255),this.writeByte(255&o)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(t){return this.writeInt32(t)},n.prototype.read=function(t){var r,o;for(r=[],o=0;0<=t?o<t:o>t;o=0<=t?++o:--o)r.push(this.readByte());return r},n.prototype.write=function(t){var r,o,A,s;for(s=[],o=0,A=t.length;o<A;o++)r=t[o],s.push(this.writeByte(r));return s},n}(),oK=function(){var n;function t(r){var o,A,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},A=0,s=this.tableCount;0<=s?A<s:A>s;A=0<=s?++A:--A)o={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[o.tag]=o}return t.prototype.encode=function(r){var o,A,s,d,f,I,_,S,U,G,L,K,V;for(V in L=Object.keys(r).length,I=Math.log(2),U=16*Math.floor(Math.log(L)/I),d=Math.floor(U/I),S=16*L-U,(A=new Cc).writeInt(this.scalarType),A.writeShort(L),A.writeShort(U),A.writeShort(d),A.writeShort(S),s=16*L,_=A.pos+s,f=null,K=[],r)for(G=r[V],A.writeString(V),A.writeInt(n(G)),A.writeInt(_),A.writeInt(G.length),K=K.concat(G),V==="head"&&(f=_),_+=G.length;_%4;)K.push(0),_++;return A.write(K),o=2981146554-n(A.data),A.pos=f+8,A.writeUInt32(o),A.data},n=function(r){var o,A,s,d;for(r=rS.call(r);r.length%4;)r.push(0);for(s=new Cc(r),A=0,o=0,d=r.length;o<d;o=o+=4)A+=s.readUInt32();return 4294967295&A},t}(),aK={}.hasOwnProperty,il=function(n,t){for(var r in t)aK.call(t,r)&&(n[r]=t[r]);function o(){this.constructor=n}return o.prototype=t.prototype,n.prototype=new o,n.__super__=t.prototype,n};IA=function(){function n(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n}();AK=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var o;return(o=new Cc).writeInt(this.version),o.writeInt(this.revision),o.writeInt(this.checkSumAdjustment),o.writeInt(this.magicNumber),o.writeShort(this.flags),o.writeShort(this.unitsPerEm),o.writeLongLong(this.created),o.writeLongLong(this.modified),o.writeShort(this.xMin),o.writeShort(this.yMin),o.writeShort(this.xMax),o.writeShort(this.yMax),o.writeShort(this.macStyle),o.writeShort(this.lowestRecPPEM),o.writeShort(this.fontDirectionHint),o.writeShort(r),o.writeShort(this.glyphDataFormat),o.data},t}(),P5=function(){function n(t,r){var o,A,s,d,f,I,_,S,U,G,L,K,V,q,z,it,At;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),U=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(I=0;I<256;++I)this.codeMap[I]=t.readByte();break;case 4:for(L=t.readUInt16(),G=L/2,t.pos+=6,s=function(){var _t,Lt;for(Lt=[],I=_t=0;0<=G?_t<G:_t>G;I=0<=G?++_t:--_t)Lt.push(t.readUInt16());return Lt}(),t.pos+=2,V=function(){var _t,Lt;for(Lt=[],I=_t=0;0<=G?_t<G:_t>G;I=0<=G?++_t:--_t)Lt.push(t.readUInt16());return Lt}(),_=function(){var _t,Lt;for(Lt=[],I=_t=0;0<=G?_t<G:_t>G;I=0<=G?++_t:--_t)Lt.push(t.readUInt16());return Lt}(),S=function(){var _t,Lt;for(Lt=[],I=_t=0;0<=G?_t<G:_t>G;I=0<=G?++_t:--_t)Lt.push(t.readUInt16());return Lt}(),A=(this.length-t.pos+this.offset)/2,f=function(){var _t,Lt;for(Lt=[],I=_t=0;0<=A?_t<A:_t>A;I=0<=A?++_t:--_t)Lt.push(t.readUInt16());return Lt}(),I=z=0,At=s.length;z<At;I=++z)for(q=s[I],o=it=K=V[I];K<=q?it<=q:it>=q;o=K<=q?++it:--it)S[I]===0?d=o+_[I]:(d=f[S[I]/2+(o-K)-(G-I)]||0)!==0&&(d+=_[I]),this.codeMap[o]=65535&d}t.pos=U}return n.encode=function(t,r){var o,A,s,d,f,I,_,S,U,G,L,K,V,q,z,it,At,_t,Lt,Et,xt,It,Nt,ie,lt,at,St,Bt,se,ee,qt,Xt,vt,Tt,pe,j,mt,yt,Qt,Ht,ae,ge,de,Ze,Re,Je;switch(Bt=new Cc,d=Object.keys(t).sort(function(Xe,Kt){return Xe-Kt}),r){case"macroman":for(V=0,q=function(){var Xe=[];for(K=0;K<256;++K)Xe.push(0);return Xe}(),it={0:0},s={},se=0,vt=d.length;se<vt;se++)it[de=t[A=d[se]]]==null&&(it[de]=++V),s[A]={old:t[A],new:it[t[A]]},q[A]=it[t[A]];return Bt.writeUInt16(1),Bt.writeUInt16(0),Bt.writeUInt32(12),Bt.writeUInt16(0),Bt.writeUInt16(262),Bt.writeUInt16(0),Bt.write(q),{charMap:s,subtable:Bt.data,maxGlyphID:V+1};case"unicode":for(at=[],U=[],At=0,it={},o={},z=_=null,ee=0,Tt=d.length;ee<Tt;ee++)it[Lt=t[A=d[ee]]]==null&&(it[Lt]=++At),o[A]={old:Lt,new:it[Lt]},f=it[Lt]-A,z!=null&&f===_||(z&&U.push(z),at.push(A),_=f),z=A;for(z&&U.push(z),U.push(65535),at.push(65535),ie=2*(Nt=at.length),It=2*Math.pow(Math.log(Nt)/Math.LN2,2),G=Math.log(It/2)/Math.LN2,xt=2*Nt-It,I=[],Et=[],L=[],K=qt=0,pe=at.length;qt<pe;K=++qt){if(lt=at[K],S=U[K],lt===65535){I.push(0),Et.push(0);break}if(lt-(St=o[lt].new)>=32768)for(I.push(0),Et.push(2*(L.length+Nt-K)),A=Xt=lt;lt<=S?Xt<=S:Xt>=S;A=lt<=S?++Xt:--Xt)L.push(o[A].new);else I.push(St-lt),Et.push(0)}for(Bt.writeUInt16(3),Bt.writeUInt16(1),Bt.writeUInt32(12),Bt.writeUInt16(4),Bt.writeUInt16(16+8*Nt+2*L.length),Bt.writeUInt16(0),Bt.writeUInt16(ie),Bt.writeUInt16(It),Bt.writeUInt16(G),Bt.writeUInt16(xt),ae=0,j=U.length;ae<j;ae++)A=U[ae],Bt.writeUInt16(A);for(Bt.writeUInt16(0),ge=0,mt=at.length;ge<mt;ge++)A=at[ge],Bt.writeUInt16(A);for(Ze=0,yt=I.length;Ze<yt;Ze++)f=I[Ze],Bt.writeUInt16(f);for(Re=0,Qt=Et.length;Re<Qt;Re++)_t=Et[Re],Bt.writeUInt16(_t);for(Je=0,Ht=L.length;Je<Ht;Je++)V=L[Je],Bt.writeUInt16(V);return{charMap:o,subtable:Bt.data,maxGlyphID:At+1}}},n}(),iS=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="cmap",t.prototype.parse=function(r){var o,A,s;for(r.pos=this.offset,this.version=r.readUInt16(),s=r.readUInt16(),this.tables=[],this.unicode=null,A=0;0<=s?A<s:A>s;A=0<=s?++A:--A)o=new P5(r,this.offset),this.tables.push(o),o.isUnicode&&this.unicode==null&&(this.unicode=o);return!0},t.encode=function(r,o){var A,s;return o==null&&(o="macroman"),A=P5.encode(r,o),(s=new Cc).writeUInt16(0),s.writeUInt16(1),A.table=s.data.concat(A.subtable),A},t}(),lK=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),cK=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var o,A;for(A=[],o=0;o<10;++o)A.push(r.readByte());return A}(),this.charRange=function(){var o,A;for(A=[],o=0;o<4;++o)A.push(r.readInt());return A}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var o,A;for(A=[],o=0;o<2;o=++o)A.push(r.readInt());return A}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),uK=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="post",t.prototype.parse=function(r){var o,A,s;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var d;for(A=r.readUInt16(),this.glyphNameIndex=[],d=0;0<=A?d<A:d>A;d=0<=A?++d:--d)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],s=[];r.pos<this.offset+this.length;)o=r.readByte(),s.push(this.names.push(r.readString(o)));return s;case 151552:return A=r.readUInt16(),this.offsets=r.read(A);case 196608:break;case 262144:return this.map=function(){var f,I,_;for(_=[],d=f=0,I=this.file.maxp.numGlyphs;0<=I?f<I:f>I;d=0<=I?++f:--f)_.push(r.readUInt32());return _}.call(this)}},t}(),hK=function(n,t){this.raw=n,this.length=n.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},gK=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="name",t.prototype.parse=function(r){var o,A,s,d,f,I,_,S,U,G,L;for(r.pos=this.offset,r.readShort(),o=r.readShort(),I=r.readShort(),A=[],d=0;0<=o?d<o:d>o;d=0<=o?++d:--d)A.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+I+r.readShort()});for(_={},d=U=0,G=A.length;U<G;d=++U)s=A[d],r.pos=s.offset,S=r.readString(s.length),f=new hK(S,s),_[L=s.nameID]==null&&(_[L]=[]),_[s.nameID].push(f);this.strings=_,this.copyright=_[0],this.fontFamily=_[1],this.fontSubfamily=_[2],this.uniqueSubfamily=_[3],this.fontName=_[4],this.version=_[5];try{this.postscriptName=_[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=_[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=_[7],this.manufacturer=_[8],this.designer=_[9],this.description=_[10],this.vendorUrl=_[11],this.designerUrl=_[12],this.license=_[13],this.licenseUrl=_[14],this.preferredFamily=_[15],this.preferredSubfamily=_[17],this.compatibleFull=_[18],this.sampleText=_[19]},t}(),dK=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),pK=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="hmtx",t.prototype.parse=function(r){var o,A,s,d,f,I,_;for(r.pos=this.offset,this.metrics=[],o=0,I=this.file.hhea.numberOfMetrics;0<=I?o<I:o>I;o=0<=I?++o:--o)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var S,U;for(U=[],o=S=0;0<=s?S<s:S>s;o=0<=s?++S:--S)U.push(r.readInt16());return U}(),this.widths=function(){var S,U,G,L;for(L=[],S=0,U=(G=this.metrics).length;S<U;S++)d=G[S],L.push(d.advance);return L}.call(this),A=this.widths[this.widths.length-1],_=[],o=f=0;0<=s?f<s:f>s;o=0<=s?++f:--f)_.push(this.widths.push(A));return _},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),rS=[].slice,fK=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var o,A,s,d,f,I,_,S,U,G;return r in this.cache?this.cache[r]:(d=this.file.loca,o=this.file.contents,A=d.indexOf(r),(s=d.lengthOf(r))===0?this.cache[r]=null:(o.pos=this.offset+A,f=(I=new Cc(o.read(s))).readShort(),S=I.readShort(),G=I.readShort(),_=I.readShort(),U=I.readShort(),this.cache[r]=f===-1?new CK(I,S,G,_,U):new mK(I,f,S,G,_,U),this.cache[r]))},t.prototype.encode=function(r,o,A){var s,d,f,I,_;for(f=[],d=[],I=0,_=o.length;I<_;I++)s=r[o[I]],d.push(f.length),s&&(f=f.concat(s.encode(A)));return d.push(f.length),{table:f,offsets:d}},t}(),mK=function(){function n(t,r,o,A,s,d){this.raw=t,this.numberOfContours=r,this.xMin=o,this.yMin=A,this.xMax=s,this.yMax=d,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n}(),CK=function(){function n(t,r,o,A,s){var d,f;for(this.raw=t,this.xMin=r,this.yMin=o,this.xMax=A,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],d=this.raw;f=d.readShort(),this.glyphOffsets.push(d.pos),this.glyphIDs.push(d.readUInt16()),32&f;)d.pos+=1&f?4:2,128&f?d.pos+=8:64&f?d.pos+=4:8&f&&(d.pos+=2)}return n.prototype.encode=function(){var t,r,o;for(r=new Cc(rS.call(this.raw.data)),t=0,o=this.glyphIDs.length;t<o;++t)r.pos=this.glyphOffsets[t];return r.data},n}(),IK=function(n){function t(){return t.__super__.constructor.apply(this,arguments)}return il(t,IA),t.prototype.tag="loca",t.prototype.parse=function(r){var o,A;return r.pos=this.offset,o=this.file.head.indexToLocFormat,this.offsets=o===0?function(){var s,d;for(d=[],A=0,s=this.length;A<s;A+=2)d.push(2*r.readUInt16());return d}.call(this):function(){var s,d;for(d=[],A=0,s=this.length;A<s;A+=4)d.push(r.readUInt32());return d}.call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,o){for(var A=new Uint32Array(this.offsets.length),s=0,d=0,f=0;f<A.length;++f)if(A[f]=s,d<o.length&&o[d]==f){++d,A[f]=s;var I=this.offsets[f],_=this.offsets[f+1]-I;_>0&&(s+=_)}for(var S=new Array(4*A.length),U=0;U<A.length;++U)S[4*U+3]=255&A[U],S[4*U+2]=(65280&A[U])>>8,S[4*U+1]=(16711680&A[U])>>16,S[4*U]=(4278190080&A[U])>>24;return S},t}(),yK=function(){function n(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var t,r,o,A,s;for(r in A=this.font.cmap.tables[0].codeMap,t={},s=this.subset)o=s[r],t[r]=A[o];return t},n.prototype.glyphsFor=function(t){var r,o,A,s,d,f,I;for(A={},d=0,f=t.length;d<f;d++)A[s=t[d]]=this.font.glyf.glyphFor(s);for(s in r=[],A)(o=A[s])!=null&&o.compound&&r.push.apply(r,o.glyphIDs);if(r.length>0)for(s in I=this.glyphsFor(r))o=I[s],A[s]=o;return A},n.prototype.encode=function(t,r){var o,A,s,d,f,I,_,S,U,G,L,K,V,q,z;for(A in o=iS.encode(this.generateCmap(),"unicode"),d=this.glyphsFor(t),L={0:0},z=o.charMap)L[(I=z[A]).old]=I.new;for(K in G=o.maxGlyphID,d)K in L||(L[K]=G++);return S=function(it){var At,_t;for(At in _t={},it)_t[it[At]]=At;return _t}(L),U=Object.keys(S).sort(function(it,At){return it-At}),V=function(){var it,At,_t;for(_t=[],it=0,At=U.length;it<At;it++)f=U[it],_t.push(S[f]);return _t}(),s=this.font.glyf.encode(d,V,L),_=this.font.loca.encode(s.offsets,V),q={cmap:this.font.cmap.raw(),glyf:s.table,loca:_,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(q["OS/2"]=this.font.os2.raw()),this.font.directory.encode(q)},n}();ji.API.PDFObject=function(){var n;function t(){}return n=function(r,o){return(Array(o+1).join("0")+r).slice(-o)},t.convert=function(r){var o,A,s,d;if(Array.isArray(r))return"["+function(){var f,I,_;for(_=[],f=0,I=r.length;f<I;f++)o=r[f],_.push(t.convert(o));return _}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+n(r.getUTCFullYear(),4)+n(r.getUTCMonth(),2)+n(r.getUTCDate(),2)+n(r.getUTCHours(),2)+n(r.getUTCMinutes(),2)+n(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(A in s=["<<"],r)d=r[A],s.push("/"+A+" "+t.convert(d));return s.push(">>"),s.join(`
`)}return""+r},t}();(function(n){var t={};function r(o){if(t[o])return t[o].exports;var A=t[o]={i:o,l:!1,exports:{}};return n[o].call(A.exports,A,A.exports,r),A.l=!0,A.exports}r.m=n,r.c=t,r.d=function(o,A,s){r.o(o,A)||Object.defineProperty(o,A,{enumerable:!0,get:s})},r.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,A){if(1&A&&(o=r(o)),8&A||4&A&&typeof o=="object"&&o&&o.__esModule)return o;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:o}),2&A&&typeof o!="string")for(var d in o)r.d(s,d,function(f){return o[f]}.bind(null,d));return s},r.n=function(o){var A=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(A,"a",A),A},r.o=function(o,A){return Object.prototype.hasOwnProperty.call(o,A)},r.p="",r(r.s=0)})([function(n,t,r){n.exports=r(1)},function(n,t){function r(A,s){for(var d=0;d<s.length;d++){var f=s[d];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(A,f.key,f)}}var o=function(){function A(){(function(f,I){if(!(f instanceof I))throw new TypeError("Cannot call a class as a function")})(this,A),this.options={overlayBackgroundColor:"#666666",overlayOpacity:.6,spinnerIcon:"ball-circus",spinnerColor:"#000",spinnerSize:"3x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetY:0,offsetX:0,lockScroll:!1,containerID:null,spinnerZIndex:99999,overlayZIndex:99998},this.stylesheetBaseURL="https://cdn.jsdelivr.net/npm/load-awesome@1.1.0/css/",this.spinner=null,this.spinnerStylesheetURL=null,this.numberOfEmptyDivForSpinner={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":1,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1}}var s,d;return s=A,(d=[{key:"show",value:function(f){this.setOptions(f),this.addSpinnerStylesheet(),this.generateSpinnerElement(),this.options.lockScroll&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),this.generateAndAddOverlayElement()}},{key:"hide",value:function(){this.options.lockScroll&&(document.body.style.overflow="",document.documentElement.style.overflow="");var f=document.getElementById("loading-overlay-stylesheet");f&&(f.disabled=!0,f.parentNode.removeChild(f),document.getElementById(this.options.overlayIDName).remove(),document.getElementById(this.options.spinnerIDName).remove())}},{key:"setOptions",value:function(f){if(f!==void 0)for(var I in f)this.options[I]=f[I]}},{key:"generateAndAddOverlayElement",value:function(){var f="50%";this.options.offsetX!==0&&(f="calc(50% + "+this.options.offsetX+")");var I="50%";if(this.options.offsetY!==0&&(I="calc(50% + "+this.options.offsetY+")"),this.options.containerID&&document.body.contains(document.getElementById(this.options.containerID))){var _='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: absolute; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,'; z-index: 50; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: absolute; top: ').concat(I,"; left: ").concat(f,'; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: 9999;">').concat(this.spinner,"</div>"),S=document.getElementById(this.options.containerID);return S.style.position="relative",void S.insertAdjacentHTML("beforeend",_)}var U='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: fixed; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,"; z-index: ").concat(this.options.overlayZIndex,'; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: fixed; top: ').concat(I,"; left: ").concat(f,"; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: ").concat(this.options.spinnerZIndex,';">').concat(this.spinner,"</div>");document.body.insertAdjacentHTML("beforeend",U)}},{key:"generateSpinnerElement",value:function(){var f=this,I=Object.keys(this.numberOfEmptyDivForSpinner).find(function(S){return S===f.options.spinnerIcon}),_=this.generateEmptyDivElement(this.numberOfEmptyDivForSpinner[I]);this.spinner='<div style="color: '.concat(this.options.spinnerColor,'" class="la-').concat(this.options.spinnerIcon," la-").concat(this.options.spinnerSize,'">').concat(_,"</div>")}},{key:"addSpinnerStylesheet",value:function(){this.setSpinnerStylesheetURL();var f=document.createElement("link");f.setAttribute("id","loading-overlay-stylesheet"),f.setAttribute("rel","stylesheet"),f.setAttribute("type","text/css"),f.setAttribute("href",this.spinnerStylesheetURL),document.getElementsByTagName("head")[0].appendChild(f)}},{key:"setSpinnerStylesheetURL",value:function(){this.spinnerStylesheetURL=this.stylesheetBaseURL+this.options.spinnerIcon+".min.css"}},{key:"generateEmptyDivElement",value:function(f){for(var I="",_=1;_<=f;_++)I+="<div></div>";return I}}])&&r(s.prototype,d),A}();window.JsLoadingOverlay=new o,n.exports=JsLoadingOverlay}]);pc={JPEG:"jpg",PNG:"png",PDF:"pdf",SVG:"svg"},$g={in:"in",mm:"mm"},mh={LETTER:[279,216],A2:[594,420],A3:[420,297],A4:[297,210],A5:[210,148],A6:[148,105],B2:[707,500],B3:[500,353],B4:[353,250],B5:[250,176],B6:[176,125]},Xg={Landscape:"landscape",Portrait:"portrait"},Xy={72:72,96:96,200:200,300:300,400:400},Yy=class{constructor(t,r=mh.A4,o=300,A=pc.PNG.toString(),s=$g.mm,d="map"){on(this,"map"),on(this,"width"),on(this,"height"),on(this,"dpi"),on(this,"format"),on(this,"unit"),on(this,"fileName"),this.map=t,this.width=r[0],this.height=r[1],this.dpi=o,this.format=A,this.unit=s,this.fileName=d}generate(){let t=this;JsLoadingOverlay.show({overlayBackgroundColor:"#5D5959",overlayOpacity:"0.6",spinnerIcon:"ball-spin",spinnerColor:"#2400FD",spinnerSize:"2x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetX:0,offsetY:0,containerID:null,lockScroll:!1,overlayZIndex:9998,spinnerZIndex:9999});let r=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get(){return t.dpi/96}});let o=document.createElement("div");o.className="hidden-map",document.body.appendChild(o);let A=document.createElement("div");A.style.width=this.toPixels(this.width),A.style.height=this.toPixels(this.height),o.appendChild(A);let s=this.map.getStyle();if(s&&s.sources){let f=s.sources;Object.keys(f).forEach(I=>{let _=f[I];Object.keys(_).forEach(S=>{_[S]||delete _[S]})})}let d=new M5.Map({container:A,style:s,center:this.map.getCenter(),zoom:this.map.getZoom(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,transformRequest:this.map._requestManager._transformRequestFn});d.once("idle",()=>{var f;let I=d.getCanvas(),_=`${this.fileName}.${t.format}`;switch(t.format){case pc.PNG:t.toPNG(I,_);break;case pc.JPEG:t.toJPEG(I,_);break;case pc.PDF:t.toPDF(d,_);break;case pc.SVG:t.toSVG(I,_);break;default:console.error(`Invalid file format: ${t.format}`);break}d.remove(),(f=o.parentNode)==null||f.removeChild(o),Object.defineProperty(window,"devicePixelRatio",{get(){return r}}),o.remove(),JsLoadingOverlay.hide()})}toPNG(t,r){let o=document.createElement("a");o.href=t.toDataURL(),o.download=r,o.click(),o.remove()}toJPEG(t,r){let o=t.toDataURL("image/jpeg",.85),A=document.createElement("a");A.href=o,A.download=r,A.click(),A.remove()}toPDF(t,r){let o=t.getCanvas(),A=new ji({orientation:this.width>this.height?"l":"p",unit:this.unit,compress:!0,format:[this.width,this.height]});A.addImage(o.toDataURL("image/png"),"png",0,0,this.width,this.height,void 0,"FAST");let{lng:s,lat:d}=t.getCenter();A.setProperties({title:t.getStyle().name,subject:`center: [${s}, ${d}], zoom: ${t.getZoom()}`,creator:"Mapbox GL Export Plugin",author:"(c)Mapbox, (c)OpenStreetMap"}),A.save(r)}toSVG(t,r){let o=t.toDataURL("image/png"),A=Number(this.toPixels(this.width,this.dpi).replace("px","")),s=Number(this.toPixels(this.height,this.dpi).replace("px","")),d=`
    <svg xmlns="http://www.w3.org/2000/svg" 
      xmlns:xlink="http://www.w3.org/1999/xlink" 
      version="1.1" 
      width="${A}" 
      height="${s}" 
      viewBox="0 0 ${A} ${s}" 
      xml:space="preserve">
        <image style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;"  
      xlink:href="${o}" width="${A}" height="${s}"></image>
    </svg>`,f=document.createElement("a");f.href=`data:application/xml,${encodeURIComponent(d)}`,f.download=r,f.click(),f.remove()}toPixels(t,r=96){return this.unit===$g.mm&&(r/=25.4),`${r*t}px`}},um=class{constructor(t){on(this,"map"),on(this,"width"),on(this,"height"),on(this,"unit"),on(this,"svgCanvas"),on(this,"svgPath");var r,o,A;if(this.map=t,this.map===void 0)return;this.mapResize=this.mapResize.bind(this),this.map.on("resize",this.mapResize);let s=(r=this.map)==null?void 0:r.getCanvas().clientWidth,d=(o=this.map)==null?void 0:o.getCanvas().clientHeight,f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.style.position="absolute",f.style.top="0px",f.style.left="0px",f.setAttribute("width",`${s}px`),f.setAttribute("height",`${d}px`);let I=document.createElementNS("http://www.w3.org/2000/svg","path");I.setAttribute("style","fill:#888888;stroke-width:0"),I.setAttribute("fill-opacity","0.5"),f.append(I),(A=this.map)==null||A.getCanvasContainer().appendChild(f),this.svgCanvas=f,this.svgPath=I}mapResize(){this.generateCutOut()}updateArea(t,r){this.width=t,this.height=r,this.unit=$g.mm,this.generateCutOut()}generateCutOut(){var t,r;if(this.map===void 0||this.svgCanvas===void 0||this.svgPath===void 0)return;let o=this.toPixels(this.width),A=this.toPixels(this.height),s=(t=this.map)==null?void 0:t.getCanvas().clientWidth,d=(r=this.map)==null?void 0:r.getCanvas().clientHeight,f=s/2-o/2,I=f+o,_=d/2-A/2,S=_+A;this.svgCanvas.setAttribute("width",`${s}px`),this.svgCanvas.setAttribute("height",`${d}px`),this.svgPath.setAttribute("d",`M 0 0 L ${s} 0 L ${s} ${d} L 0 ${d} M ${f} ${_} L ${f} ${S} L ${I} ${S} L ${I} ${_}`)}destroy(){this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map=void 0)}toPixels(t,r=96){return this.unit===$g.mm&&(r/=25.4),r*t}},H5={PageSize:"Page Size",PageOrientation:"Page Orientation",Format:"Format",DPI:"DPI",Generate:"Generate",LanguageName:"English"},bK={PageSize:"Taille de page",PageOrientation:"Orientation de la page",Format:"Format",DPI:"DPI",Generate:"G\xE9n\xE9rer",LanguageName:"French"},vK={PageSize:"Sivukoko",PageOrientation:"Sivun suunta",Format:"Muoto",DPI:"DPI",Generate:"Generoi",LanguageName:"Finish"},wK={PageSize:"Papierformat",PageOrientation:"Papierausrichtung",Format:"Dateiformat",DPI:"Druckaufl\xF6sung",Generate:"Erstellen",LanguageName:"German"},BK={PageSize:"Sidstorlek",PageOrientation:"Sidorientering",Format:"Format",DPI:"DPI",Generate:"Generera",LanguageName:"Swedish"},_K={PageSize:"Tama\xF1o de p\xE1gina",PageOrientation:"Orientaci\xF3n de p\xE1gina",Format:"Formato",DPI:"DPI",Generate:"Generar",LanguageName:"Spanish"},xK={PageSize:"K\xEDch th\u01B0\u1EDBc trang",PageOrientation:"Lo\u1EA1i trang",Format:"\u0110\u1ECBnh d\u1EA1ng",DPI:"M\u1EADt \u0111\u1ED9 \u0111i\u1EC3m \u1EA3nh (DPI)",Generate:"T\u1EA1o",LanguageName:"Vietnam"},SK={PageSize:"\u0420\u043E\u0437\u043C\u0456\u0440 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438",PageOrientation:"\u041E\u0440\u0456\u0454\u043D\u0442\u0430\u0446\u0456\u044F \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438",Format:"\u0424\u043E\u0440\u043C\u0430\u0442",DPI:"DPI",Generate:"\u0417\u0433\u0435\u043D\u0435\u0440\u0443\u0432\u0430\u0442\u0438",LanguageName:"Ukranian"},FK={PageSize:"\u9875\u9762\u5927\u5C0F",PageOrientation:"\u9875\u9762\u65B9\u5411",Format:"\u683C\u5F0F",DPI:"\u50CF\u7D20",Generate:"\u5BFC\u51FA",LanguageName:"Chinese simplified"},kK={PageSize:"\u9801\u9762\u5927\u5C0F",PageOrientation:"\u9801\u9762\u65B9\u5411",Format:"\u683C\u5F0F",DPI:"\u50CF\u7D20",Generate:"\u5C0E\u51FA",LanguageName:"Chinese traditional"},LK={PageSize:"\u30DA\u30FC\u30B8\u30B5\u30A4\u30BA",PageOrientation:"\u30DA\u30FC\u30B8\u65B9\u5411",Format:"\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8",DPI:"DPI\uFF08\u89E3\u50CF\u5EA6\uFF09",Generate:"\u51FA\u529B",LanguageName:"Japanese"},nS=n=>{switch(n){case"de":return wK;case"en":return H5;case"fr":return bK;case"fi":return vK;case"sv":return BK;case"es":return _K;case"vi":return xK;case"uk":return SK;case"zhHans":return FK;case"zhHant":return kK;case"ja":return LK;default:return H5}},td=class{constructor(t){on(this,"controlContainer"),on(this,"exportContainer"),on(this,"crosshair"),on(this,"printableArea"),on(this,"map"),on(this,"exportButton"),on(this,"options",{PageSize:mh.A4,PageOrientation:Xg.Landscape,Format:pc.PDF,DPI:Xy[300],Crosshair:!1,PrintableArea:!1,Local:"en",AllowedSizes:Object.keys(mh),Filename:"map"}),t&&(this.options=Object.assign(this.options,t)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}getTranslation(){let t=this.options.Local??"en";return nS(t)}onAdd(t){var r;this.map=t,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("maplibregl-ctrl"),this.controlContainer.classList.add("maplibregl-ctrl-group"),this.exportContainer=document.createElement("div"),this.exportContainer.classList.add("maplibregl-export-list"),this.exportButton=document.createElement("button"),this.exportButton.classList.add("maplibregl-ctrl-icon"),this.exportButton.classList.add("maplibregl-export-control"),this.exportButton.type="button",this.exportButton.addEventListener("click",()=>{this.exportButton.style.display="none",this.exportContainer.style.display="block",this.toggleCrosshair(!0),this.togglePrintableArea(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.exportButton),this.controlContainer.appendChild(this.exportContainer);let o=document.createElement("TABLE");o.className="print-table";let A={};(r=this.options.AllowedSizes)==null||r.forEach(S=>{mh[S]&&(A[S]=mh[S])});let s=this.createSelection(A,this.getTranslation().PageSize,"page-size",this.options.PageSize,(S,U)=>JSON.stringify(S[U]));o.appendChild(s);let d=this.createSelection(Xg,this.getTranslation().PageOrientation,"page-orientation",this.options.PageOrientation,(S,U)=>S[U]);o.appendChild(d);let f=this.createSelection(pc,this.getTranslation().Format,"format-type",this.options.Format,(S,U)=>S[U]);o.appendChild(f);let I=this.createSelection(Xy,this.getTranslation().DPI,"dpi-type",this.options.DPI,(S,U)=>S[U]);o.appendChild(I),this.exportContainer.appendChild(o);let _=document.createElement("button");return _.type="button",_.textContent=this.getTranslation().Generate,_.classList.add("generate-button"),_.addEventListener("click",()=>{let S=document.getElementById("mapbox-gl-export-page-size"),U=document.getElementById("mapbox-gl-export-page-orientation"),G=document.getElementById("mapbox-gl-export-format-type"),L=document.getElementById("mapbox-gl-export-dpi-type"),K=U.value,V=JSON.parse(S.value);K===Xg.Portrait&&(V=V.reverse()),new Yy(t,V,Number(L.value),G.value,$g.mm,this.options.Filename).generate()}),this.exportContainer.appendChild(_),this.controlContainer}createSelection(t,r,o,A,s){let d=document.createElement("label");d.textContent=r;let f=document.createElement("select");f.setAttribute("id",`mapbox-gl-export-${o}`),f.style.width="100%",Object.keys(t).forEach(U=>{let G=document.createElement("option");G.setAttribute("value",s(t,U)),G.appendChild(document.createTextNode(U)),G.setAttribute("name",o),A===t[U]&&(G.selected=!0),f.appendChild(G)}),f.addEventListener("change",()=>{this.updatePrintableArea()});let I=document.createElement("TR"),_=document.createElement("TD"),S=document.createElement("TD");return _.appendChild(d),S.appendChild(f),I.appendChild(_),I.appendChild(S),I}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.exportButton||(this.exportButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0),this.map=void 0)}onDocumentClick(t){this.controlContainer&&!this.controlContainer.contains(t.target)&&this.exportContainer&&this.exportButton&&(this.exportContainer.style.display="none",this.exportButton.style.display="block",this.toggleCrosshair(!1),this.togglePrintableArea(!1))}toggleCrosshair(t){this.options.Crosshair===!0&&(t===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new Am(this.map),this.crosshair.create()))}togglePrintableArea(t){this.options.PrintableArea===!0&&(t===!1?this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0):(this.printableArea=new um(this.map),this.updatePrintableArea()))}updatePrintableArea(){if(this.printableArea===void 0)return;let t=document.getElementById("mapbox-gl-export-page-size"),r=document.getElementById("mapbox-gl-export-page-orientation").value,o=JSON.parse(t.value);r===Xg.Portrait&&(o=o.reverse()),this.printableArea.updateArea(o[0],o[1])}}});var Cs=Bd(rC()),sS=Bd(xb()),oS=Bd(Av());ky();function Fz(n,t){n.importCSS("main.css"),n.root.innerHTML=`
    <div id='map' style='width: 896px; height: 400px;'></div>
  `;let r="map",o=t.spec,{markers:A=[],clusters:s=[],controls:d=[],locate:f=[],terrain:I=[],geocode:_=[],fullscreen:S=[],scale:U=[],export_map:G=[],hover:L=[],center:K=[],info:V=[],images:q=[],jumps:z=[],fit_bounds:it=[]}=t.events,At=new Cs.Map({container:r,style:o});sS.default.addProtocols(Cs),At.on("load",function(){A.forEach(({location:vt,options:Tt})=>{_t({location:vt,options:Tt})}),s.forEach(vt=>{ee(vt)}),d.forEach(({position:vt,options:Tt})=>{Lt({position:vt,options:Tt})}),f.forEach(({high_accuracy:vt,options:Tt})=>{Et({high_accuracy:vt,options:Tt})}),I.forEach(()=>{xt()}),_.forEach(()=>{It()}),S.forEach(()=>{Nt()}),U.forEach(vt=>{ie(vt)}),G.forEach(vt=>{lt(vt)}),L.forEach(vt=>{se(vt)}),K.forEach(vt=>{St(vt)}),V.forEach(({layer:vt,property:Tt})=>{Bt({layer:vt,property:Tt})}),q.forEach(({name:vt,url:Tt,options:pe})=>{at({name:vt,url:Tt,options:pe})}),z.forEach(({location:vt,options:Tt})=>{At.easeTo({center:vt,...Tt})}),it.forEach(({bounds:vt,options:Tt})=>{At.fitBounds(vt,Tt)})}),n.handleEvent("add_markers",vt=>{vt.forEach(({location:Tt,options:pe})=>{_t({location:Tt,options:pe})})}),n.handleEvent("add_marker",({location:vt,options:Tt})=>{_t({location:vt,options:Tt})}),n.handleEvent("add_nav_controls",({position:vt,options:Tt})=>{Lt({position:vt,options:Tt})}),n.handleEvent("add_locate",({high_accuracy:vt,options:Tt})=>{Et({high_accuracy:vt,options:Tt})}),n.handleEvent("add_terrain",()=>{xt()}),n.handleEvent("add_geocode",()=>{It()}),n.handleEvent("add_fullscreen",()=>{Nt()}),n.handleEvent("add_scale",vt=>{ie(vt)}),n.handleEvent("add_export_map",vt=>{lt(vt)}),n.handleEvent("clusters_expansion",vt=>{ee(vt)}),n.handleEvent("add_hover",vt=>{se(vt)}),n.handleEvent("center_on_click",vt=>{St(vt)}),n.handleEvent("info_on_click",({layer:vt,property:Tt})=>{Bt({layer:vt,property:Tt})}),n.handleEvent("add_custom_image",({name:vt,url:Tt,options:pe})=>{at({name:vt,url:Tt,options:pe})}),n.handleEvent("jump_to",({location:vt,options:Tt})=>{At.easeTo({center:vt,...Tt})}),n.handleEvent("fit_bounds",({bounds:vt,options:Tt})=>{At.fitBounds(vt,Tt)});function _t({location:vt,options:Tt}){new Cs.Marker(Tt).setLngLat(vt).addTo(At)}function Lt({position:vt,options:Tt}){let pe=new Cs.NavigationControl(Tt);At.addControl(pe,vt)}function Et({high_accuracy:vt,options:Tt}){let pe=new Cs.GeolocateControl({positionOptions:{enableHighAccuracy:vt,maximumAge:0,timeout:6e3},...Tt});At.addControl(pe)}function xt(){let vt=At.getTerrain(),Tt=new Cs.TerrainControl(vt);At.addControl(Tt)}function It(){At.addControl(Xt())}function Nt(){let vt=new Cs.FullscreenControl;At.addControl(vt)}function ie(vt){let Tt=new Cs.ScaleControl(vt);At.addControl(Tt)}function lt({filename:vt,options:Tt}){let pe=new td({Filename:vt,...Tt});At.addControl(pe)}async function at({name:vt,url:Tt,options:pe}){let j=await At.loadImage(Tt);At.addImage(vt,j.data,pe)}function St(vt){At.on("click",vt,Tt=>{let pe=Tt.features[0].geometry.coordinates;At.easeTo({center:pe})})}function Bt({layer:vt,property:Tt}){At.on("click",vt,pe=>{new Cs.Popup().setLngLat(pe.lngLat).setHTML(pe.features[0].properties[Tt]).addTo(At)}),qt(vt)}function se(vt){let Tt=null,pe=At.getLayer(vt).source;At.on("mousemove",vt,j=>{j.features.length>0&&(Tt&&At.setFeatureState({source:pe,id:Tt},{hover:!1}),Tt=j.features[0].id,At.setFeatureState({source:pe,id:Tt},{hover:!0}))}),At.on("mouseleave",vt,()=>{Tt&&At.setFeatureState({source:pe,id:Tt},{hover:!1}),Tt=null})}function ee(vt){At.on("click",vt,Tt=>{let pe=At.getLayer(vt).source,j=At.queryRenderedFeatures(Tt.point,{layers:[vt]}),mt=j[0].properties.cluster_id;At.getSource(pe).getClusterExpansionZoom(mt,(yt,Qt)=>{yt||At.easeTo({center:j[0].geometry.coordinates,zoom:Qt})})}),qt(vt)}function qt(vt){At.on("mouseenter",vt,()=>{At.getCanvas().style.cursor="pointer"}),At.on("mouseleave",vt,()=>{At.getCanvas().style.cursor=""})}function Xt(){let vt={forwardGeocode:async Tt=>{let pe=[];try{let j=`https://nominatim.openstreetmap.org/search?q=${Tt.query}&format=geojson&polygon_geojson=1&addressdetails=1`,yt=await(await fetch(j)).json();for(let Qt of yt.features){let Ht=[Qt.bbox[0]+(Qt.bbox[2]-Qt.bbox[0])/2,Qt.bbox[1]+(Qt.bbox[3]-Qt.bbox[1])/2],ae={type:"Feature",geometry:{type:"Point",coordinates:Ht},place_name:Qt.properties.display_name,properties:Qt.properties,text:Qt.properties.display_name,place_type:["place"],center:Ht};pe.push(ae)}}catch(j){console.error(`Failed to forwardGeocode with error: ${j}`)}return{features:pe}}};return new oS.default(vt,{maplibregl:Cs})}}export{Fz as init};
/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */
/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */
/**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */
/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */
/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */
/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */
/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */
/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.5.2/LICENSE.txt
 */
/** @license
 *
 * jsPDF - PDF Document creation from JavaScript
 * Version 2.5.1 Built on 2022-01-28T15:37:57.791Z
 *                      CommitID 00000000
 *
 * Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
 *               2015-2021 yWorks GmbH, http://www.yworks.com
 *               2015-2021 Lukas Holländer <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
 *               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
 *               2010 Aaron Spike, https://github.com/acspike
 *               2012 Willow Systems Corporation, https://github.com/willowsystems
 *               2012 Pablo Hess, https://github.com/pablohess
 *               2012 Florian Jenett, https://github.com/fjenett
 *               2013 Warren Weckesser, https://github.com/warrenweckesser
 *               2013 Youssef Beddad, https://github.com/lifof
 *               2013 Lee Driscoll, https://github.com/lsdriscoll
 *               2013 Stefan Slonevskiy, https://github.com/stefslon
 *               2013 Jeremy Morel, https://github.com/jmorel
 *               2013 Christoph Hartmann, https://github.com/chris-rock
 *               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
 *               2014 James Makes, https://github.com/dollaruw
 *               2014 Diego Casorran, https://github.com/diegocr
 *               2014 Steven Spungin, https://github.com/Flamenco
 *               2014 Kenneth Glassey, https://github.com/Gavvers
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * Contributor(s):
 *    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
 *    kim3er, mfo, alnorth, Flamenco
 */
