var Z3=Object.create;var Xm=Object.defineProperty;var H3=Object.getOwnPropertyDescriptor;var N3=Object.getOwnPropertyNames;var P3=Object.getPrototypeOf,M3=Object.prototype.hasOwnProperty;var bd=(i=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(i,{get:(t,e)=>(typeof require<"u"?require:t)[e]}):i)(function(i){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+i+'" is not supported')});var vd=(i,t)=>()=>(i&&(t=i(i=0)),t);var da=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),Ym=(i,t)=>{for(var e in t)Xm(i,e,{get:t[e],enumerable:!0})},V3=(i,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of N3(t))!M3.call(i,l)&&l!==e&&Xm(i,l,{get:()=>t[l],enumerable:!(o=H3(t,l))||o.enumerable});return i};var Su=(i,t,e)=>(e=i!=null?Z3(P3(i)):{},V3(t||!i||!i.__esModule?Xm(e,"default",{value:i,enumerable:!0}):e,i));var Dh=da((jm,qm)=>{(function(i,t){typeof jm=="object"&&typeof qm<"u"?qm.exports=t():typeof define=="function"&&define.amd?define(t):(i=typeof globalThis<"u"?globalThis:i||self,i.maplibregl=t())})(jm,function(){"use strict";var i,t,e;function o(n,g){if(!i)i=g;else if(!t)t=g;else{var h="var sharedChunk = {}; ("+i+")(sharedChunk); ("+t+")(sharedChunk);",m={};i(m),e=g(m),typeof window<"u"&&(e.workerUrl=window.URL.createObjectURL(new Blob([h],{type:"text/javascript"})))}}o(["exports"],function(n){"use strict";function g(a,r,A,u){return new(A||(A=Promise))(function(f,b){function v(Z){try{Q(u.next(Z))}catch(M){b(M)}}function x(Z){try{Q(u.throw(Z))}catch(M){b(M)}}function Q(Z){var M;Z.done?f(Z.value):(M=Z.value,M instanceof A?M:new A(function(J){J(M)})).then(v,x)}Q((u=u.apply(a,r||[])).next())})}function h(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}typeof SuppressedError=="function"&&SuppressedError;var m=B;function B(a,r){this.x=a,this.y=r}B.prototype={clone:function(){return new B(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,r){return this.clone()._rotateAround(a,r)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var r=a.x-this.x,A=a.y-this.y;return r*r+A*A},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,r){return Math.atan2(this.x*r-this.y*a,this.x*a+this.y*r)},_matMult:function(a){var r=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=r,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var r=Math.cos(a),A=Math.sin(a),u=A*this.x+r*this.y;return this.x=r*this.x-A*this.y,this.y=u,this},_rotateAround:function(a,r){var A=Math.cos(a),u=Math.sin(a),f=r.y+u*(this.x-r.x)+A*(this.y-r.y);return this.x=r.x+A*(this.x-r.x)-u*(this.y-r.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},B.convert=function(a){return a instanceof B?a:Array.isArray(a)?new B(a[0],a[1]):a};var _=h(m),E=G;function G(a,r,A,u){this.cx=3*a,this.bx=3*(A-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(u-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=r,this.p2x=A,this.p2y=u}G.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,r){if(r===void 0&&(r=1e-6),a<0)return 0;if(a>1)return 1;for(var A=a,u=0;u<8;u++){var f=this.sampleCurveX(A)-a;if(Math.abs(f)<r)return A;var b=this.sampleCurveDerivativeX(A);if(Math.abs(b)<1e-6)break;A-=f/b}var v=0,x=1;for(A=a,u=0;u<20&&(f=this.sampleCurveX(A),!(Math.abs(f-a)<r));u++)a>f?v=A:x=A,A=.5*(x-v)+v;return A},solve:function(a,r){return this.sampleCurveY(this.solveCurveX(a,r))}};var S=h(E);let O,P;function tt(){return O==null&&(O=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),O}function z(){if(P==null&&(P=!1,tt())){let r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let u=0;u<5*5;u++){let f=4*u;r.fillStyle=`rgb(${f},${f+1},${f+2})`,r.fillRect(u%5,Math.floor(u/5),1,1)}let A=r.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&A[u]!==u){P=!0;break}}}return P||!1}function rt(a,r,A,u){let f=new S(a,r,A,u);return function(b){return f.solve(b)}}let ct=rt(.25,.1,.25,1);function Et(a,r,A){return Math.min(A,Math.max(r,a))}function Pt(a,r,A){let u=A-r,f=((a-r)%u+u)%u+r;return f===r?A:f}function Qt(a,...r){for(let A of r)for(let u in A)a[u]=A[u];return a}let Ut=1;function dt(a,r,A){let u={};for(let f in a)u[f]=r.call(A||this,a[f],f,a);return u}function ee(a,r,A){let u={};for(let f in a)r.call(A||this,a[f],f,a)&&(u[f]=a[f]);return u}function oe(a){return Array.isArray(a)?a.map(oe):typeof a=="object"&&a?dt(a,oe):a}let ht={};function At(a){ht[a]||(typeof console<"u"&&console.warn(a),ht[a]=!0)}function Ft(a,r,A){return(A.y-a.y)*(r.x-a.x)>(r.y-a.y)*(A.x-a.x)}function St(a){let r=0;for(let A,u,f=0,b=a.length,v=b-1;f<b;v=f++)A=a[f],u=a[v],r+=(u.x-A.x)*(A.y+u.y);return r}function ue(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let ce=null;function ae(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}let se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Lt(a,r,A,u,f){return g(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let b=new VideoFrame(a,{timestamp:0});try{let v=b?.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);let x=v.startsWith("BGR"),Q=new Uint8ClampedArray(u*f*4);if(yield b.copyTo(Q,function(Z,M,J,it,ot){let at=4*Math.max(-M,0),Bt=(Math.max(0,J)-J)*it*4+at,Gt=4*it,Mt=Math.max(0,M),ne=Math.max(0,J);return{rect:{x:Mt,y:ne,width:Math.min(Z.width,M+it)-Mt,height:Math.min(Z.height,J+ot)-ne},layout:[{offset:Bt,stride:Gt}]}}(a,r,A,u,f)),x)for(let Z=0;Z<Q.length;Z+=4){let M=Q[Z];Q[Z]=Q[Z+2],Q[Z+2]=M}return Q}finally{b.close()}})}let Ht,fe,j,It,bt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(a){let r=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(a,r=0){return this.getImageCanvasContext(a).getImageData(-r,-r,a.width+2*r,a.height+2*r)},getImageCanvasContext(a){let r=window.document.createElement("canvas"),A=r.getContext("2d",{willReadFrequently:!0});if(!A)throw new Error("failed to create canvas 2d context");return r.width=a.width,r.height=a.height,A.drawImage(a,0,0,a.width,a.height),A},resolveURL:a=>(j||(j=document.createElement("a")),j.href=a,j.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(It==null&&(It=matchMedia("(prefers-reduced-motion: reduce)")),It.matches)}},Vt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Xt extends Error{constructor(r,A,u,f){super(`AJAXError: ${A} (${r}): ${u}`),this.status=r,this.statusText=A,this.url=u,this.body=f}}let he=ue()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,me=a=>Vt.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))];function be(a,r){let A=new AbortController,u=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:he(),signal:A.signal}),f=!1,b=!1;return a.type==="json"&&u.headers.set("Accept","application/json"),b||fetch(u).then(v=>v.ok?(x=>{(a.type==="arrayBuffer"||a.type==="image"?x.arrayBuffer():a.type==="json"?x.json():x.text()).then(Q=>{b||(f=!0,r(null,Q,x.headers.get("Cache-Control"),x.headers.get("Expires")))}).catch(Q=>{b||r(new Error(Q.message))})})(v):v.blob().then(x=>r(new Xt(v.status,v.statusText,a.url,x)))).catch(v=>{v.code!==20&&r(new Error(v.message))}),{cancel:()=>{b=!0,f||A.abort()}}}let Ve=function(a,r){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){if(ue()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,r);if(!ue())return(me(a.url)||be)(a,r)}if(!(/^file:/.test(A=a.url)||/^file:/.test(he())&&!/^\w+:/.test(A))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return be(a,r);if(ue()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,r,void 0,!0)}var A;return function(u,f){let b=new XMLHttpRequest;b.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(b.responseType="arraybuffer");for(let v in u.headers)b.setRequestHeader(v,u.headers[v]);return u.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=u.credentials==="include",b.onerror=()=>{f(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let v=b.response;if(u.type==="json")try{v=JSON.parse(b.response)}catch(x){return f(x)}f(null,v,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else{let v=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});f(new Xt(b.status,b.statusText,u.url,v))}},b.send(u.body),{cancel:()=>b.abort()}}(a,r)},De=function(a,r){return Ve(Qt(a,{type:"arrayBuffer"}),r)};function ei(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;let r=new URL(a),A=window.location;return r.protocol===A.protocol&&r.host===A.host}function ri(a,r,A){A[a]&&A[a].indexOf(r)!==-1||(A[a]=A[a]||[],A[a].push(r))}function Ii(a,r,A){if(A&&A[a]){let u=A[a].indexOf(r);u!==-1&&A[a].splice(u,1)}}class Be{constructor(r,A={}){Qt(this,A),this.type=r}}class Rt extends Be{constructor(r,A={}){super("error",Qt({error:r},A))}}class Ui{on(r,A){return this._listeners=this._listeners||{},ri(r,A,this._listeners),this}off(r,A){return Ii(r,A,this._listeners),Ii(r,A,this._oneTimeListeners),this}once(r,A){return A?(this._oneTimeListeners=this._oneTimeListeners||{},ri(r,A,this._oneTimeListeners),this):new Promise(u=>this.once(r,u))}fire(r,A){typeof r=="string"&&(r=new Be(r,A||{}));let u=r.type;if(this.listens(u)){r.target=this;let f=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(let x of f)x.call(this,r);let b=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(let x of b)Ii(u,x,this._oneTimeListeners),x.call(this,r);let v=this._eventedParent;v&&(Qt(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(r))}else r instanceof Rt&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,A){return this._eventedParent=r,this._eventedParentData=A,this}}var $t={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let Ze=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function We(a,r){let A={};for(let u in a)u!=="ref"&&(A[u]=a[u]);return Ze.forEach(u=>{u in r&&(A[u]=r[u])}),A}function He(a,r){if(Array.isArray(a)){if(!Array.isArray(r)||a.length!==r.length)return!1;for(let A=0;A<a.length;A++)if(!He(a[A],r[A]))return!1;return!0}if(typeof a=="object"&&a!==null&&r!==null){if(typeof r!="object"||Object.keys(a).length!==Object.keys(r).length)return!1;for(let A in a)if(!He(a[A],r[A]))return!1;return!0}return a===r}let Re={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function hi(a,r,A){A.push({command:Re.addSource,args:[a,r[a]]})}function yi(a,r,A){r.push({command:Re.removeSource,args:[a]}),A[a]=!0}function Qi(a,r,A,u){yi(a,A,u),hi(a,r,A)}function Pi(a,r,A){let u;for(u in a[A])if(Object.prototype.hasOwnProperty.call(a[A],u)&&u!=="data"&&!He(a[A][u],r[A][u]))return!1;for(u in r[A])if(Object.prototype.hasOwnProperty.call(r[A],u)&&u!=="data"&&!He(a[A][u],r[A][u]))return!1;return!0}function zi(a,r,A,u,f,b){let v;for(v in r=r||{},a=a||{})Object.prototype.hasOwnProperty.call(a,v)&&(He(a[v],r[v])||A.push({command:b,args:[u,v,r[v],f]}));for(v in r)Object.prototype.hasOwnProperty.call(r,v)&&!Object.prototype.hasOwnProperty.call(a,v)&&(He(a[v],r[v])||A.push({command:b,args:[u,v,r[v],f]}))}function ir(a){return a.id}function Ei(a,r){return a[r.id]=r,a}class Fe{constructor(r,A,u,f){this.message=(r?`${r}: `:"")+u,f&&(this.identifier=f),A!=null&&A.__line__&&(this.line=A.__line__)}}function Ye(a,...r){for(let A of r)for(let u in A)a[u]=A[u];return a}class Ki extends Error{constructor(r,A){super(A),this.message=A,this.key=r}}class ji{constructor(r,A=[]){this.parent=r,this.bindings={};for(let[u,f]of A)this.bindings[u]=f}concat(r){return new ji(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}let vr={kind:"null"},Qe={kind:"number"},gi={kind:"string"},Bi={kind:"boolean"},Oi={kind:"color"},Fr={kind:"object"},pi={kind:"value"},Pr={kind:"collator"},gt={kind:"formatted"},Y={kind:"padding"},q={kind:"resolvedImage"},lt={kind:"variableAnchorOffsetCollection"};function _t(a,r){return{kind:"array",itemType:a,N:r}}function xt(a){if(a.kind==="array"){let r=xt(a.itemType);return typeof a.N=="number"?`array<${r}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${r}>`}return a.kind}let qt=[vr,Qe,gi,Bi,Oi,gt,Fr,_t(pi),Y,q,lt];function Jt(a,r){if(r.kind==="error")return null;if(a.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Jt(a.itemType,r.itemType))&&(typeof a.N!="number"||a.N===r.N))return null}else{if(a.kind===r.kind)return null;if(a.kind==="value"){for(let A of qt)if(!Jt(A,r))return null}}return`Expected ${xt(a)} but found ${xt(r)} instead.`}function mt(a,r){return r.some(A=>A.kind===a.kind)}function jt(a,r){return r.some(A=>A==="null"?a===null:A==="array"?Array.isArray(a):A==="object"?a&&!Array.isArray(a)&&typeof a=="object":A===typeof a)}function _e(a,r){return a.kind==="array"&&r.kind==="array"?a.itemType.kind===r.itemType.kind&&typeof a.N=="number":a.kind===r.kind}let ve=.96422,xe=.82521,si=4/29,_i=6/29,ui=3*_i*_i,fi=_i*_i*_i,bi=Math.PI/180,$i=180/Math.PI;function or(a){return(a%=360)<0&&(a+=360),a}function Ji([a,r,A,u]){let f,b,v=kr((.2225045*(a=Mi(a))+.7168786*(r=Mi(r))+.0606169*(A=Mi(A)))/1);a===r&&r===A?f=b=v:(f=kr((.4360747*a+.3850649*r+.1430804*A)/ve),b=kr((.0139322*a+.0971045*r+.7141733*A)/xe));let x=116*v-16;return[x<0?0:x,500*(f-v),200*(v-b),u]}function Mi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function kr(a){return a>fi?Math.pow(a,1/3):a/ui+si}function Nt([a,r,A,u]){let f=(a+16)/116,b=isNaN(r)?f:f+r/500,v=isNaN(A)?f:f-A/200;return f=1*Ne(f),b=ve*Ne(b),v=xe*Ne(v),[ze(3.1338561*b-1.6168667*f-.4906146*v),ze(-.9787684*b+1.9161415*f+.033454*v),ze(.0719453*b-.2289914*f+1.4052427*v),u]}function ze(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Ne(a){return a>_i?a*a*a:ui*(a-si)}function Wi(a){return parseInt(a.padEnd(2,a),16)/255}function Lr(a,r){return $r(r?a/100:a,0,1)}function $r(a,r,A){return Math.min(Math.max(r,a),A)}function Qr(a){return!a.some(Number.isNaN)}let uo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class qi{constructor(r,A,u,f=1,b=!0){this.r=r,this.g=A,this.b=u,this.a=f,b||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[r,A,u,f]))}static parse(r){if(r instanceof qi)return r;if(typeof r!="string")return;let A=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];let f=uo[u];if(f){let[v,x,Q]=f;return[v/255,x/255,Q/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){let v=u.length<6?1:2,x=1;return[Wi(u.slice(x,x+=v)),Wi(u.slice(x,x+=v)),Wi(u.slice(x,x+=v)),Wi(u.slice(x,x+v)||"ff")]}if(u.startsWith("rgb")){let v=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){let[x,Q,Z,M,J,it,ot,at,Bt,Gt,Mt,ne]=v,Yt=[M||" ",ot||" ",Gt].join("");if(Yt==="  "||Yt==="  /"||Yt===",,"||Yt===",,,"){let Ae=[Z,it,Bt].join(""),ye=Ae==="%%%"?100:Ae===""?255:0;if(ye){let Ge=[$r(+Q/ye,0,1),$r(+J/ye,0,1),$r(+at/ye,0,1),Mt?Lr(+Mt,ne):1];if(Qr(Ge))return Ge}}return}}let b=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){let[v,x,Q,Z,M,J,it,ot,at]=b,Bt=[Q||" ",M||" ",it].join("");if(Bt==="  "||Bt==="  /"||Bt===",,"||Bt===",,,"){let Gt=[+x,$r(+Z,0,100),$r(+J,0,100),ot?Lr(+ot,at):1];if(Qr(Gt))return function([Mt,ne,Yt,Ae]){function ye(Ge){let ci=(Ge+Mt/30)%12,Si=ne*Math.min(Yt,1-Yt);return Yt-Si*Math.max(-1,Math.min(ci-3,9-ci,1))}return Mt=or(Mt),ne/=100,Yt/=100,[ye(0),ye(8),ye(4),Ae]}(Gt)}}}(r);return A?new qi(...A,!1):void 0}get rgb(){let{r,g:A,b:u,a:f}=this,b=f||1/0;return this.overwriteGetter("rgb",[r/b,A/b,u/b,f])}get hcl(){return this.overwriteGetter("hcl",function(r){let[A,u,f,b]=Ji(r),v=Math.sqrt(u*u+f*f);return[Math.round(1e4*v)?or(Math.atan2(f,u)*$i):NaN,v,A,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ji(this.rgb))}overwriteGetter(r,A){return Object.defineProperty(this,r,{value:A}),A}toString(){let[r,A,u,f]=this.rgb;return`rgba(${[r,A,u].map(b=>Math.round(255*b)).join(",")},${f})`}}qi.black=new qi(0,0,0,1),qi.white=new qi(1,1,1,1),qi.transparent=new qi(0,0,0,0),qi.red=new qi(1,0,0,1);class An{constructor(r,A,u){this.sensitivity=r?A?"variant":"case":A?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,A){return this.collator.compare(r,A)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ho{constructor(r,A,u,f,b){this.text=r,this.image=A,this.scale=u,this.fontStack=f,this.textColor=b}}class dn{constructor(r){this.sections=r}static fromString(r){return new dn([new ho(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof dn?r:dn.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class Mn{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Mn)return r;if(typeof r=="number")return new Mn([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(let A of r)if(typeof A!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new Mn(r)}}toString(){return JSON.stringify(this.values)}}let Ca=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ln{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Ln)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let A=0;A<r.length;A+=2){let u=r[A],f=r[A+1];if(typeof u!="string"||!Ca.has(u)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new Ln(r)}}toString(){return JSON.stringify(this.values)}}class zr{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new zr({name:r,available:!1}):null}}function Ia(a,r,A,u){return typeof a=="number"&&a>=0&&a<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof A=="number"&&A>=0&&A<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,r,A,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,r,A,u]:[a,r,A]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ur(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof qi||a instanceof An||a instanceof dn||a instanceof Mn||a instanceof Ln||a instanceof zr)return!0;if(Array.isArray(a)){for(let r of a)if(!Ur(r))return!1;return!0}if(typeof a=="object"){for(let r in a)if(!Ur(a[r]))return!1;return!0}return!1}function Hr(a){if(a===null)return vr;if(typeof a=="string")return gi;if(typeof a=="boolean")return Bi;if(typeof a=="number")return Qe;if(a instanceof qi)return Oi;if(a instanceof An)return Pr;if(a instanceof dn)return gt;if(a instanceof Mn)return Y;if(a instanceof Ln)return lt;if(a instanceof zr)return q;if(Array.isArray(a)){let r=a.length,A;for(let u of a){let f=Hr(u);if(A){if(A===f)continue;A=pi;break}A=f}return _t(A||pi,r)}return Fr}function pr(a){let r=typeof a;return a===null?"":r==="string"||r==="number"||r==="boolean"?String(a):a instanceof qi||a instanceof dn||a instanceof Mn||a instanceof Ln||a instanceof zr?a.toString():JSON.stringify(a)}class Js{constructor(r,A){this.type=r,this.value=A}static parse(r,A){if(r.length!==2)return A.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Ur(r[1]))return A.error("invalid value");let u=r[1],f=Hr(u),b=A.expectedType;return f.kind!=="array"||f.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(f=b),new Js(f,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Gr{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}let pt={string:gi,number:Qe,boolean:Bi,object:Fr};class ft{constructor(r,A){this.type=r,this.args=A}static parse(r,A){if(r.length<2)return A.error("Expected at least one argument.");let u,f=1,b=r[0];if(b==="array"){let x,Q;if(r.length>2){let Z=r[1];if(typeof Z!="string"||!(Z in pt)||Z==="object")return A.error('The item type argument of "array" must be one of string, number, boolean',1);x=pt[Z],f++}else x=pi;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return A.error('The length argument to "array" must be a positive integer literal',2);Q=r[2],f++}u=_t(x,Q)}else{if(!pt[b])throw new Error(`Types doesn't contain name = ${b}`);u=pt[b]}let v=[];for(;f<r.length;f++){let x=A.parse(r[f],f,pi);if(!x)return null;v.push(x)}return new ft(u,v)}evaluate(r){for(let A=0;A<this.args.length;A++){let u=this.args[A].evaluate(r);if(!Jt(this.type,Hr(u)))return u;if(A===this.args.length-1)throw new Gr(`Expected value to be of type ${xt(this.type)}, but found ${xt(Hr(u))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}let ut={"to-boolean":Bi,"to-color":Oi,"to-number":Qe,"to-string":gi};class Zt{constructor(r,A){this.type=r,this.args=A}static parse(r,A){if(r.length<2)return A.error("Expected at least one argument.");let u=r[0];if(!ut[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&r.length!==2)return A.error("Expected one argument.");let f=ut[u],b=[];for(let v=1;v<r.length;v++){let x=A.parse(r[v],v,pi);if(!x)return null;b.push(x)}return new Zt(f,b)}evaluate(r){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(r));case"color":{let A,u;for(let f of this.args){if(A=f.evaluate(r),u=null,A instanceof qi)return A;if(typeof A=="string"){let b=r.parseColor(A);if(b)return b}else if(Array.isArray(A)&&(u=A.length<3||A.length>4?`Invalid rbga value ${JSON.stringify(A)}: expected an array containing either three or four numeric values.`:Ia(A[0],A[1],A[2],A[3]),!u))return new qi(A[0]/255,A[1]/255,A[2]/255,A[3])}throw new Gr(u||`Could not parse color from value '${typeof A=="string"?A:JSON.stringify(A)}'`)}case"padding":{let A;for(let u of this.args){A=u.evaluate(r);let f=Mn.parse(A);if(f)return f}throw new Gr(`Could not parse padding from value '${typeof A=="string"?A:JSON.stringify(A)}'`)}case"variableAnchorOffsetCollection":{let A;for(let u of this.args){A=u.evaluate(r);let f=Ln.parse(A);if(f)return f}throw new Gr(`Could not parse variableAnchorOffsetCollection from value '${typeof A=="string"?A:JSON.stringify(A)}'`)}case"number":{let A=null;for(let u of this.args){if(A=u.evaluate(r),A===null)return 0;let f=Number(A);if(!isNaN(f))return f}throw new Gr(`Could not convert ${JSON.stringify(A)} to number.`)}case"formatted":return dn.fromString(pr(this.args[0].evaluate(r)));case"resolvedImage":return zr.fromString(pr(this.args[0].evaluate(r)));default:return pr(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}let Kt=["Unknown","Point","LineString","Polygon"];class ie{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Kt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let A=this._parseColorCache[r];return A||(A=this._parseColorCache[r]=qi.parse(r)),A}}class ge{constructor(r,A,u=[],f,b=new ji,v=[]){this.registry=r,this.path=u,this.key=u.map(x=>`[${x}]`).join(""),this.scope=b,this.errors=v,this.expectedType=f,this._isConstant=A}parse(r,A,u,f,b={}){return A?this.concat(A,u,f)._parse(r,b):this._parse(r,b)}_parse(r,A){function u(f,b,v){return v==="assert"?new ft(b,[f]):v==="coerce"?new Zt(b,[f]):f}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let f=r[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let b=this.registry[f];if(b){let v=b.parse(r,this);if(!v)return null;if(this.expectedType){let x=this.expectedType,Q=v.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||Q.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||Q.kind!=="value"&&Q.kind!=="string")if(x.kind!=="padding"||Q.kind!=="value"&&Q.kind!=="number"&&Q.kind!=="array")if(x.kind!=="variableAnchorOffsetCollection"||Q.kind!=="value"&&Q.kind!=="array"){if(this.checkSubtype(x,Q))return null}else v=u(v,x,A.typeAnnotation||"coerce");else v=u(v,x,A.typeAnnotation||"coerce");else v=u(v,x,A.typeAnnotation||"coerce");else v=u(v,x,A.typeAnnotation||"assert")}if(!(v instanceof Js)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){let x=new ie;try{v=new Js(v.type,v.evaluate(x))}catch(Q){return this.error(Q.message),null}}return v}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,A,u){let f=typeof r=="number"?this.path.concat(r):this.path,b=u?this.scope.concat(u):this.scope;return new ge(this.registry,this._isConstant,f,A||null,b,this.errors)}error(r,...A){let u=`${this.key}${A.map(f=>`[${f}]`).join("")}`;this.errors.push(new Ki(u,r))}checkSubtype(r,A){let u=Jt(r,A);return u&&this.error(u),u}}class Ue{constructor(r,A,u){this.type=Pr,this.locale=u,this.caseSensitive=r,this.diacriticSensitive=A}static parse(r,A){if(r.length!==2)return A.error("Expected one argument.");let u=r[1];if(typeof u!="object"||Array.isArray(u))return A.error("Collator options argument must be an object.");let f=A.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Bi);if(!f)return null;let b=A.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Bi);if(!b)return null;let v=null;return u.locale&&(v=A.parse(u.locale,1,gi),!v)?null:new Ue(f,b,v)}evaluate(r){return new An(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}let Ee=8192;function Se(a,r){a[0]=Math.min(a[0],r[0]),a[1]=Math.min(a[1],r[1]),a[2]=Math.max(a[2],r[0]),a[3]=Math.max(a[3],r[1])}function le(a,r){return!(a[0]<=r[0]||a[2]>=r[2]||a[1]<=r[1]||a[3]>=r[3])}function ke(a,r){let A=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,f=Math.pow(2,r.z);return[Math.round(A*f*Ee),Math.round(u*f*Ee)]}function Te(a,r,A){let u=a[0]-r[0],f=a[1]-r[1],b=a[0]-A[0],v=a[1]-A[1];return u*v-b*f==0&&u*b<=0&&f*v<=0}function Pe(a,r){let A=!1;for(let v=0,x=r.length;v<x;v++){let Q=r[v];for(let Z=0,M=Q.length;Z<M-1;Z++){if(Te(a,Q[Z],Q[Z+1]))return!1;(f=Q[Z])[1]>(u=a)[1]!=(b=Q[Z+1])[1]>u[1]&&u[0]<(b[0]-f[0])*(u[1]-f[1])/(b[1]-f[1])+f[0]&&(A=!A)}}var u,f,b;return A}function Gi(a,r){for(let A=0;A<r.length;A++)if(Pe(a,r[A]))return!0;return!1}function Zi(a,r,A,u){let f=u[0]-A[0],b=u[1]-A[1],v=(a[0]-A[0])*b-f*(a[1]-A[1]),x=(r[0]-A[0])*b-f*(r[1]-A[1]);return v>0&&x<0||v<0&&x>0}function Je(a,r,A){for(let Z of A)for(let M=0;M<Z.length-1;++M)if((x=[(v=Z[M+1])[0]-(b=Z[M])[0],v[1]-b[1]])[0]*(Q=[(f=r)[0]-(u=a)[0],f[1]-u[1]])[1]-x[1]*Q[0]!=0&&Zi(u,f,b,v)&&Zi(b,v,u,f))return!0;var u,f,b,v,x,Q;return!1}function Me(a,r){for(let A=0;A<a.length;++A)if(!Pe(a[A],r))return!1;for(let A=0;A<a.length-1;++A)if(Je(a[A],a[A+1],r))return!1;return!0}function Ci(a,r){for(let A=0;A<r.length;A++)if(Me(a,r[A]))return!0;return!1}function Ti(a,r,A){let u=[];for(let f=0;f<a.length;f++){let b=[];for(let v=0;v<a[f].length;v++){let x=ke(a[f][v],A);Se(r,x),b.push(x)}u.push(b)}return u}function Xi(a,r,A){let u=[];for(let f=0;f<a.length;f++){let b=Ti(a[f],r,A);u.push(b)}return u}function fr(a,r,A,u){if(a[0]<A[0]||a[0]>A[2]){let f=.5*u,b=a[0]-A[0]>f?-u:A[0]-a[0]>f?u:0;b===0&&(b=a[0]-A[2]>f?-u:A[2]-a[0]>f?u:0),a[0]+=b}Se(r,a)}function mi(a,r,A,u){let f=Math.pow(2,u.z)*Ee,b=[u.x*Ee,u.y*Ee],v=[];for(let x of a)for(let Q of x){let Z=[Q.x+b[0],Q.y+b[1]];fr(Z,r,A,f),v.push(Z)}return v}function Rr(a,r,A,u){let f=Math.pow(2,u.z)*Ee,b=[u.x*Ee,u.y*Ee],v=[];for(let Q of a){let Z=[];for(let M of Q){let J=[M.x+b[0],M.y+b[1]];Se(r,J),Z.push(J)}v.push(Z)}if(r[2]-r[0]<=f/2){(x=r)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(let Q of v)for(let Z of Q)fr(Z,r,A,f)}var x;return v}class Kr{constructor(r,A){this.type=Bi,this.geojson=r,this.geometries=A}static parse(r,A){if(r.length!==2)return A.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Ur(r[1])){let u=r[1];if(u.type==="FeatureCollection")for(let f=0;f<u.features.length;++f){let b=u.features[f].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Kr(u,u.features[f].geometry)}else if(u.type==="Feature"){let f=u.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Kr(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Kr(u,u)}return A.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(A,u){let f=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],v=A.canonicalID();if(u.type==="Polygon"){let x=Ti(u.coordinates,b,v),Q=mi(A.geometry(),f,b,v);if(!le(f,b))return!1;for(let Z of Q)if(!Pe(Z,x))return!1}if(u.type==="MultiPolygon"){let x=Xi(u.coordinates,b,v),Q=mi(A.geometry(),f,b,v);if(!le(f,b))return!1;for(let Z of Q)if(!Gi(Z,x))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(A,u){let f=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],v=A.canonicalID();if(u.type==="Polygon"){let x=Ti(u.coordinates,b,v),Q=Rr(A.geometry(),f,b,v);if(!le(f,b))return!1;for(let Z of Q)if(!Me(Z,x))return!1}if(u.type==="MultiPolygon"){let x=Xi(u.coordinates,b,v),Q=Rr(A.geometry(),f,b,v);if(!le(f,b))return!1;for(let Z of Q)if(!Ci(Z,x))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Mr{constructor(r,A){this.type=A.type,this.name=r,this.boundExpression=A}static parse(r,A){if(r.length!==2||typeof r[1]!="string")return A.error("'var' expression requires exactly one string literal argument.");let u=r[1];return A.scope.has(u)?new Mr(u,A.scope.get(u)):A.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class tn{constructor(r,A,u,f){this.name=r,this.type=A,this._evaluate=u,this.args=f}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,A){let u=r[0],f=tn.definitions[u];if(!f)return A.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);let b=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,x=v.filter(([Z])=>!Array.isArray(Z)||Z.length===r.length-1),Q=null;for(let[Z,M]of x){Q=new ge(A.registry,En,A.path,null,A.scope);let J=[],it=!1;for(let ot=1;ot<r.length;ot++){let at=r[ot],Bt=Array.isArray(Z)?Z[ot-1]:Z.type,Gt=Q.parse(at,1+J.length,Bt);if(!Gt){it=!0;break}J.push(Gt)}if(!it)if(Array.isArray(Z)&&Z.length!==J.length)Q.error(`Expected ${Z.length} arguments, but found ${J.length} instead.`);else{for(let ot=0;ot<J.length;ot++){let at=Array.isArray(Z)?Z[ot]:Z.type,Bt=J[ot];Q.concat(ot+1).checkSubtype(at,Bt.type)}if(Q.errors.length===0)return new tn(u,b,M,J)}}if(x.length===1)A.errors.push(...Q.errors);else{let Z=(x.length?x:v).map(([J])=>{return it=J,Array.isArray(it)?`(${it.map(xt).join(", ")})`:`(${xt(it.type)}...)`;var it}).join(" | "),M=[];for(let J=1;J<r.length;J++){let it=A.parse(r[J],1+M.length);if(!it)return null;M.push(xt(it.type))}A.error(`Expected arguments of type ${Z}, but found (${M.join(", ")}) instead.`)}return null}static register(r,A){tn.definitions=A;for(let u in A)r[u]=tn}}function En(a){if(a instanceof Mr)return En(a.boundExpression);if(a instanceof tn&&a.name==="error"||a instanceof Ue||a instanceof Kr)return!1;let r=a instanceof Zt||a instanceof ft,A=!0;return a.eachChild(u=>{A=r?A&&En(u):A&&u instanceof Js}),!!A&&Xs(a)&&yA(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Xs(a){if(a instanceof tn&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Kr)return!1;let r=!0;return a.eachChild(A=>{r&&!Xs(A)&&(r=!1)}),r}function jo(a){if(a instanceof tn&&a.name==="feature-state")return!1;let r=!0;return a.eachChild(A=>{r&&!jo(A)&&(r=!1)}),r}function yA(a,r){if(a instanceof tn&&r.indexOf(a.name)>=0)return!1;let A=!0;return a.eachChild(u=>{A&&!yA(u,r)&&(A=!1)}),A}function ya(a,r){let A=a.length-1,u,f,b=0,v=A,x=0;for(;b<=v;)if(x=Math.floor((b+v)/2),u=a[x],f=a[x+1],u<=r){if(x===A||r<f)return x;b=x+1}else{if(!(u>r))throw new Gr("Input is not a number.");v=x-1}return 0}class Qo{constructor(r,A,u){this.type=r,this.input=A,this.labels=[],this.outputs=[];for(let[f,b]of u)this.labels.push(f),this.outputs.push(b)}static parse(r,A){if(r.length-1<4)return A.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return A.error("Expected an even number of arguments.");let u=A.parse(r[1],1,Qe);if(!u)return null;let f=[],b=null;A.expectedType&&A.expectedType.kind!=="value"&&(b=A.expectedType);for(let v=1;v<r.length;v+=2){let x=v===1?-1/0:r[v],Q=r[v+1],Z=v,M=v+1;if(typeof x!="number")return A.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(f.length&&f[f.length-1][0]>=x)return A.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Z);let J=A.parse(Q,M,b);if(!J)return null;b=b||J.type,f.push([x,J])}return new Qo(b,u,f)}evaluate(r){let A=this.labels,u=this.outputs;if(A.length===1)return u[0].evaluate(r);let f=this.input.evaluate(r);if(f<=A[0])return u[0].evaluate(r);let b=A.length;return f>=A[b-1]?u[b-1].evaluate(r):u[ya(A,f)].evaluate(r)}eachChild(r){r(this.input);for(let A of this.outputs)r(A)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function Ar(a,r,A){return a+A*(r-a)}function Uo(a,r,A){return a.map((u,f)=>Ar(u,r[f],A))}let bn={number:Ar,color:function(a,r,A,u="rgb"){switch(u){case"rgb":{let[f,b,v,x]=Uo(a.rgb,r.rgb,A);return new qi(f,b,v,x,!1)}case"hcl":{let[f,b,v,x]=a.hcl,[Q,Z,M,J]=r.hcl,it,ot;if(isNaN(f)||isNaN(Q))isNaN(f)?isNaN(Q)?it=NaN:(it=Q,v!==1&&v!==0||(ot=Z)):(it=f,M!==1&&M!==0||(ot=b));else{let ne=Q-f;Q>f&&ne>180?ne-=360:Q<f&&f-Q>180&&(ne+=360),it=f+A*ne}let[at,Bt,Gt,Mt]=function([ne,Yt,Ae,ye]){return ne=isNaN(ne)?0:ne*bi,Nt([Ae,Math.cos(ne)*Yt,Math.sin(ne)*Yt,ye])}([it,ot??Ar(b,Z,A),Ar(v,M,A),Ar(x,J,A)]);return new qi(at,Bt,Gt,Mt,!1)}case"lab":{let[f,b,v,x]=Nt(Uo(a.lab,r.lab,A));return new qi(f,b,v,x,!1)}}},array:Uo,padding:function(a,r,A){return new Mn(Uo(a.values,r.values,A))},variableAnchorOffsetCollection:function(a,r,A){let u=a.values,f=r.values;if(u.length!==f.length)throw new Gr(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${r.toString()}`);let b=[];for(let v=0;v<u.length;v+=2){if(u[v]!==f[v])throw new Gr(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${u[v]}, to[${v}]: ${f[v]}`);b.push(u[v]);let[x,Q]=u[v+1],[Z,M]=f[v+1];b.push([Ar(x,Z,A),Ar(Q,M,A)])}return new Ln(b)}};class hs{constructor(r,A,u,f,b){this.type=r,this.operator=A,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(let[v,x]of b)this.labels.push(v),this.outputs.push(x)}static interpolationFactor(r,A,u,f){let b=0;if(r.name==="exponential")b=qo(A,r.base,u,f);else if(r.name==="linear")b=qo(A,1,u,f);else if(r.name==="cubic-bezier"){let v=r.controlPoints;b=new S(v[0],v[1],v[2],v[3]).solve(qo(A,1,u,f))}return b}static parse(r,A){let[u,f,b,...v]=r;if(!Array.isArray(f)||f.length===0)return A.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){let Z=f[1];if(typeof Z!="number")return A.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:Z}}else{if(f[0]!=="cubic-bezier")return A.error(`Unknown interpolation type ${String(f[0])}`,1,0);{let Z=f.slice(1);if(Z.length!==4||Z.some(M=>typeof M!="number"||M<0||M>1))return A.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:Z}}}if(r.length-1<4)return A.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return A.error("Expected an even number of arguments.");if(b=A.parse(b,2,Qe),!b)return null;let x=[],Q=null;u==="interpolate-hcl"||u==="interpolate-lab"?Q=Oi:A.expectedType&&A.expectedType.kind!=="value"&&(Q=A.expectedType);for(let Z=0;Z<v.length;Z+=2){let M=v[Z],J=v[Z+1],it=Z+3,ot=Z+4;if(typeof M!="number")return A.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',it);if(x.length&&x[x.length-1][0]>=M)return A.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',it);let at=A.parse(J,ot,Q);if(!at)return null;Q=Q||at.type,x.push([M,at])}return _e(Q,Qe)||_e(Q,Oi)||_e(Q,Y)||_e(Q,lt)||_e(Q,_t(Qe))?new hs(Q,u,f,b,x):A.error(`Type ${xt(Q)} is not interpolatable.`)}evaluate(r){let A=this.labels,u=this.outputs;if(A.length===1)return u[0].evaluate(r);let f=this.input.evaluate(r);if(f<=A[0])return u[0].evaluate(r);let b=A.length;if(f>=A[b-1])return u[b-1].evaluate(r);let v=ya(A,f),x=hs.interpolationFactor(this.interpolation,f,A[v],A[v+1]),Q=u[v].evaluate(r),Z=u[v+1].evaluate(r);switch(this.operator){case"interpolate":return bn[this.type.kind](Q,Z,x);case"interpolate-hcl":return bn.color(Q,Z,x,"hcl");case"interpolate-lab":return bn.color(Q,Z,x,"lab")}}eachChild(r){r(this.input);for(let A of this.outputs)r(A)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function qo(a,r,A,u){let f=u-A,b=a-A;return f===0?0:r===1?b/f:(Math.pow(r,b)-1)/(Math.pow(r,f)-1)}class ba{constructor(r,A){this.type=r,this.args=A}static parse(r,A){if(r.length<2)return A.error("Expectected at least one argument.");let u=null,f=A.expectedType;f&&f.kind!=="value"&&(u=f);let b=[];for(let x of r.slice(1)){let Q=A.parse(x,1+b.length,u,void 0,{typeAnnotation:"omit"});if(!Q)return null;u=u||Q.type,b.push(Q)}if(!u)throw new Error("No output type");let v=f&&b.some(x=>Jt(f,x.type));return new ba(v?pi:u,b)}evaluate(r){let A,u=null,f=0;for(let b of this.args)if(f++,u=b.evaluate(r),u&&u instanceof zr&&!u.available&&(A||(A=u.name),u=null,f===this.args.length&&(u=A)),u!==null)break;return u}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}class $o{constructor(r,A){this.type=A.type,this.bindings=[].concat(r),this.result=A}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(let A of this.bindings)r(A[1]);r(this.result)}static parse(r,A){if(r.length<4)return A.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);let u=[];for(let b=1;b<r.length-1;b+=2){let v=r[b];if(typeof v!="string")return A.error(`Expected string, but found ${typeof v} instead.`,b);if(/[^a-zA-Z0-9_]/.test(v))return A.error("Variable names must contain only alphanumeric characters or '_'.",b);let x=A.parse(r[b+1],b+1);if(!x)return null;u.push([v,x])}let f=A.parse(r[r.length-1],r.length-1,A.expectedType,u);return f?new $o(u,f):null}outputDefined(){return this.result.outputDefined()}}class bA{constructor(r,A,u){this.type=r,this.index=A,this.input=u}static parse(r,A){if(r.length!==3)return A.error(`Expected 2 arguments, but found ${r.length-1} instead.`);let u=A.parse(r[1],1,Qe),f=A.parse(r[2],2,_t(A.expectedType||pi));return u&&f?new bA(f.type.itemType,u,f):null}evaluate(r){let A=this.index.evaluate(r),u=this.input.evaluate(r);if(A<0)throw new Gr(`Array index out of bounds: ${A} < 0.`);if(A>=u.length)throw new Gr(`Array index out of bounds: ${A} > ${u.length-1}.`);if(A!==Math.floor(A))throw new Gr(`Array index must be an integer, but found ${A} instead.`);return u[A]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class vA{constructor(r,A){this.type=Bi,this.needle=r,this.haystack=A}static parse(r,A){if(r.length!==3)return A.error(`Expected 2 arguments, but found ${r.length-1} instead.`);let u=A.parse(r[1],1,pi),f=A.parse(r[2],2,pi);return u&&f?mt(u.type,[Bi,gi,Qe,vr,pi])?new vA(u,f):A.error(`Expected first argument to be of type boolean, string, number or null, but found ${xt(u.type)} instead`):null}evaluate(r){let A=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(!u)return!1;if(!jt(A,["boolean","string","number","null"]))throw new Gr(`Expected first argument to be of type boolean, string, number or null, but found ${xt(Hr(A))} instead.`);if(!jt(u,["string","array"]))throw new Gr(`Expected second argument to be of type array or string, but found ${xt(Hr(u))} instead.`);return u.indexOf(A)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class Ua{constructor(r,A,u){this.type=Qe,this.needle=r,this.haystack=A,this.fromIndex=u}static parse(r,A){if(r.length<=2||r.length>=5)return A.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);let u=A.parse(r[1],1,pi),f=A.parse(r[2],2,pi);if(!u||!f)return null;if(!mt(u.type,[Bi,gi,Qe,vr,pi]))return A.error(`Expected first argument to be of type boolean, string, number or null, but found ${xt(u.type)} instead`);if(r.length===4){let b=A.parse(r[3],3,Qe);return b?new Ua(u,f,b):null}return new Ua(u,f)}evaluate(r){let A=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(!jt(A,["boolean","string","number","null"]))throw new Gr(`Expected first argument to be of type boolean, string, number or null, but found ${xt(Hr(A))} instead.`);if(!jt(u,["string","array"]))throw new Gr(`Expected second argument to be of type array or string, but found ${xt(Hr(u))} instead.`);if(this.fromIndex){let f=this.fromIndex.evaluate(r);return u.indexOf(A,f)}return u.indexOf(A)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class wA{constructor(r,A,u,f,b,v){this.inputType=r,this.type=A,this.input=u,this.cases=f,this.outputs=b,this.otherwise=v}static parse(r,A){if(r.length<5)return A.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return A.error("Expected an even number of arguments.");let u,f;A.expectedType&&A.expectedType.kind!=="value"&&(f=A.expectedType);let b={},v=[];for(let Z=2;Z<r.length-1;Z+=2){let M=r[Z],J=r[Z+1];Array.isArray(M)||(M=[M]);let it=A.concat(Z);if(M.length===0)return it.error("Expected at least one branch label.");for(let at of M){if(typeof at!="number"&&typeof at!="string")return it.error("Branch labels must be numbers or strings.");if(typeof at=="number"&&Math.abs(at)>Number.MAX_SAFE_INTEGER)return it.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof at=="number"&&Math.floor(at)!==at)return it.error("Numeric branch labels must be integer values.");if(u){if(it.checkSubtype(u,Hr(at)))return null}else u=Hr(at);if(b[String(at)]!==void 0)return it.error("Branch labels must be unique.");b[String(at)]=v.length}let ot=A.parse(J,Z,f);if(!ot)return null;f=f||ot.type,v.push(ot)}let x=A.parse(r[1],1,pi);if(!x)return null;let Q=A.parse(r[r.length-1],r.length-1,f);return Q?x.type.kind!=="value"&&A.concat(1).checkSubtype(u,x.type)?null:new wA(u,f,x,b,v,Q):null}evaluate(r){let A=this.input.evaluate(r);return(Hr(A)===this.inputType&&this.outputs[this.cases[A]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class go{constructor(r,A,u){this.type=r,this.branches=A,this.otherwise=u}static parse(r,A){if(r.length<4)return A.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return A.error("Expected an odd number of arguments.");let u;A.expectedType&&A.expectedType.kind!=="value"&&(u=A.expectedType);let f=[];for(let v=1;v<r.length-1;v+=2){let x=A.parse(r[v],v,Bi);if(!x)return null;let Q=A.parse(r[v+1],v+1,u);if(!Q)return null;f.push([x,Q]),u=u||Q.type}let b=A.parse(r[r.length-1],r.length-1,u);if(!b)return null;if(!u)throw new Error("Can't infer output type");return new go(u,f,b)}evaluate(r){for(let[A,u]of this.branches)if(A.evaluate(r))return u.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(let[A,u]of this.branches)r(A),r(u);r(this.otherwise)}outputDefined(){return this.branches.every(([r,A])=>A.outputDefined())&&this.otherwise.outputDefined()}}class po{constructor(r,A,u,f){this.type=r,this.input=A,this.beginIndex=u,this.endIndex=f}static parse(r,A){if(r.length<=2||r.length>=5)return A.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);let u=A.parse(r[1],1,pi),f=A.parse(r[2],2,Qe);if(!u||!f)return null;if(!mt(u.type,[_t(pi),gi,pi]))return A.error(`Expected first argument to be of type array or string, but found ${xt(u.type)} instead`);if(r.length===4){let b=A.parse(r[3],3,Qe);return b?new po(u.type,u,f,b):null}return new po(u.type,u,f)}evaluate(r){let A=this.input.evaluate(r),u=this.beginIndex.evaluate(r);if(!jt(A,["string","array"]))throw new Gr(`Expected first argument to be of type array or string, but found ${xt(Hr(A))} instead.`);if(this.endIndex){let f=this.endIndex.evaluate(r);return A.slice(u,f)}return A.slice(u)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function xl(a,r){return a==="=="||a==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function ta(a,r,A,u){return u.compare(r,A)===0}function ns(a,r,A){let u=a!=="=="&&a!=="!=";return class pb{constructor(b,v,x){this.type=Bi,this.lhs=b,this.rhs=v,this.collator=x,this.hasUntypedArgument=b.type.kind==="value"||v.type.kind==="value"}static parse(b,v){if(b.length!==3&&b.length!==4)return v.error("Expected two or three arguments.");let x=b[0],Q=v.parse(b[1],1,pi);if(!Q)return null;if(!xl(x,Q.type))return v.concat(1).error(`"${x}" comparisons are not supported for type '${xt(Q.type)}'.`);let Z=v.parse(b[2],2,pi);if(!Z)return null;if(!xl(x,Z.type))return v.concat(2).error(`"${x}" comparisons are not supported for type '${xt(Z.type)}'.`);if(Q.type.kind!==Z.type.kind&&Q.type.kind!=="value"&&Z.type.kind!=="value")return v.error(`Cannot compare types '${xt(Q.type)}' and '${xt(Z.type)}'.`);u&&(Q.type.kind==="value"&&Z.type.kind!=="value"?Q=new ft(Z.type,[Q]):Q.type.kind!=="value"&&Z.type.kind==="value"&&(Z=new ft(Q.type,[Z])));let M=null;if(b.length===4){if(Q.type.kind!=="string"&&Z.type.kind!=="string"&&Q.type.kind!=="value"&&Z.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(M=v.parse(b[3],3,Pr),!M)return null}return new pb(Q,Z,M)}evaluate(b){let v=this.lhs.evaluate(b),x=this.rhs.evaluate(b);if(u&&this.hasUntypedArgument){let Q=Hr(v),Z=Hr(x);if(Q.kind!==Z.kind||Q.kind!=="string"&&Q.kind!=="number")throw new Gr(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${Q.kind}, ${Z.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){let Q=Hr(v),Z=Hr(x);if(Q.kind!=="string"||Z.kind!=="string")return r(b,v,x)}return this.collator?A(b,v,x,this.collator.evaluate(b)):r(b,v,x)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}let YA=ns("==",function(a,r,A){return r===A},ta),Ga=ns("!=",function(a,r,A){return r!==A},function(a,r,A,u){return!ta(0,r,A,u)}),Cc=ns("<",function(a,r,A){return r<A},function(a,r,A,u){return u.compare(r,A)<0}),BA=ns(">",function(a,r,A){return r>A},function(a,r,A,u){return u.compare(r,A)>0}),Ic=ns("<=",function(a,r,A){return r<=A},function(a,r,A,u){return u.compare(r,A)<=0}),jA=ns(">=",function(a,r,A){return r>=A},function(a,r,A,u){return u.compare(r,A)>=0});class Ra{constructor(r,A,u,f,b){this.type=gi,this.number=r,this.locale=A,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=b}static parse(r,A){if(r.length!==3)return A.error("Expected two arguments.");let u=A.parse(r[1],1,Qe);if(!u)return null;let f=r[2];if(typeof f!="object"||Array.isArray(f))return A.error("NumberFormat options argument must be an object.");let b=null;if(f.locale&&(b=A.parse(f.locale,1,gi),!b))return null;let v=null;if(f.currency&&(v=A.parse(f.currency,1,gi),!v))return null;let x=null;if(f["min-fraction-digits"]&&(x=A.parse(f["min-fraction-digits"],1,Qe),!x))return null;let Q=null;return f["max-fraction-digits"]&&(Q=A.parse(f["max-fraction-digits"],1,Qe),!Q)?null:new Ra(u,b,v,x,Q)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class Za{constructor(r){this.type=gt,this.sections=r}static parse(r,A){if(r.length<2)return A.error("Expected at least one argument.");let u=r[1];if(!Array.isArray(u)&&typeof u=="object")return A.error("First argument must be an image or text section.");let f=[],b=!1;for(let v=1;v<=r.length-1;++v){let x=r[v];if(b&&typeof x=="object"&&!Array.isArray(x)){b=!1;let Q=null;if(x["font-scale"]&&(Q=A.parse(x["font-scale"],1,Qe),!Q))return null;let Z=null;if(x["text-font"]&&(Z=A.parse(x["text-font"],1,_t(gi)),!Z))return null;let M=null;if(x["text-color"]&&(M=A.parse(x["text-color"],1,Oi),!M))return null;let J=f[f.length-1];J.scale=Q,J.font=Z,J.textColor=M}else{let Q=A.parse(r[v],1,pi);if(!Q)return null;let Z=Q.type.kind;if(Z!=="string"&&Z!=="value"&&Z!=="null"&&Z!=="resolvedImage")return A.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,f.push({content:Q,scale:null,font:null,textColor:null})}}return new Za(f)}evaluate(r){return new dn(this.sections.map(A=>{let u=A.content.evaluate(r);return Hr(u)===q?new ho("",u,null,null,null):new ho(pr(u),null,A.scale?A.scale.evaluate(r):null,A.font?A.font.evaluate(r).join(","):null,A.textColor?A.textColor.evaluate(r):null)}))}eachChild(r){for(let A of this.sections)r(A.content),A.scale&&r(A.scale),A.font&&r(A.font),A.textColor&&r(A.textColor)}outputDefined(){return!1}}class va{constructor(r){this.type=q,this.input=r}static parse(r,A){if(r.length!==2)return A.error("Expected two arguments.");let u=A.parse(r[1],1,gi);return u?new va(u):A.error("No image name provided.")}evaluate(r){let A=this.input.evaluate(r),u=zr.fromString(A);return u&&r.availableImages&&(u.available=r.availableImages.indexOf(A)>-1),u}eachChild(r){r(this.input)}outputDefined(){return!1}}class Ha{constructor(r){this.type=Qe,this.input=r}static parse(r,A){if(r.length!==2)return A.error(`Expected 1 argument, but found ${r.length-1} instead.`);let u=A.parse(r[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?A.error(`Expected argument of type string or array, but found ${xt(u.type)} instead.`):new Ha(u):null}evaluate(r){let A=this.input.evaluate(r);if(typeof A=="string"||Array.isArray(A))return A.length;throw new Gr(`Expected value to be of type string or array, but found ${xt(Hr(A))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}let Go={"==":YA,"!=":Ga,">":BA,"<":Cc,">=":jA,"<=":Ic,array:ft,at:bA,boolean:ft,case:go,coalesce:ba,collator:Ue,format:Za,image:va,in:vA,"index-of":Ua,interpolate:hs,"interpolate-hcl":hs,"interpolate-lab":hs,length:Ha,let:$o,literal:Js,match:wA,number:ft,"number-format":Ra,object:ft,slice:po,step:Qo,string:ft,"to-boolean":Zt,"to-color":Zt,"to-number":Zt,"to-string":Zt,var:Mr,within:Kr};function qA(a,[r,A,u,f]){r=r.evaluate(a),A=A.evaluate(a),u=u.evaluate(a);let b=f?f.evaluate(a):1,v=Ia(r,A,u,b);if(v)throw new Gr(v);return new qi(r/255,A/255,u/255,b,!1)}function Sl(a,r){return a in r}function wa(a,r){let A=r[a];return A===void 0?null:A}function Gs(a){return{type:a}}function _A(a){return{result:"success",value:a}}function gs(a){return{result:"error",value:a}}function Ro(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function U(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function et(a){return!!a.expression&&a.expression.interpolated}function vt(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function Dt(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function de(a){return a}function Ce(a,r){let A=r.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",f=u||!(u||a.property!==void 0),b=a.type||(et(r)?"exponential":"interval");if(A||r.type==="padding"){let M=A?qi.parse:Mn.parse;(a=Ye({},a)).stops&&(a.stops=a.stops.map(J=>[J[0],M(J[1])])),a.default=M(a.default?a.default:r.default)}if(a.colorSpace&&(v=a.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var v;let x,Q,Z;if(b==="exponential")x=tr;else if(b==="interval")x=di;else if(b==="categorical"){x=ti,Q=Object.create(null);for(let M of a.stops)Q[M[0]]=M[1];Z=typeof a.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);x=cr}if(u){let M={},J=[];for(let at=0;at<a.stops.length;at++){let Bt=a.stops[at],Gt=Bt[0].zoom;M[Gt]===void 0&&(M[Gt]={zoom:Gt,type:a.type,property:a.property,default:a.default,stops:[]},J.push(Gt)),M[Gt].stops.push([Bt[0].value,Bt[1]])}let it=[];for(let at of J)it.push([M[at].zoom,Ce(M[at],r)]);let ot={name:"linear"};return{kind:"composite",interpolationType:ot,interpolationFactor:hs.interpolationFactor.bind(void 0,ot),zoomStops:it.map(at=>at[0]),evaluate:({zoom:at},Bt)=>tr({stops:it,base:a.base},r,at).evaluate(at,Bt)}}if(f){let M=b==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:hs.interpolationFactor.bind(void 0,M),zoomStops:a.stops.map(J=>J[0]),evaluate:({zoom:J})=>x(a,r,J,Q,Z)}}return{kind:"source",evaluate(M,J){let it=J&&J.properties?J.properties[a.property]:void 0;return it===void 0?Ke(a.default,r.default):x(a,r,it,Q,Z)}}}function Ke(a,r,A){return a!==void 0?a:r!==void 0?r:A!==void 0?A:void 0}function ti(a,r,A,u,f){return Ke(typeof A===f?u[A]:void 0,a.default,r.default)}function di(a,r,A){if(vt(A)!=="number")return Ke(a.default,r.default);let u=a.stops.length;if(u===1||A<=a.stops[0][0])return a.stops[0][1];if(A>=a.stops[u-1][0])return a.stops[u-1][1];let f=ya(a.stops.map(b=>b[0]),A);return a.stops[f][1]}function tr(a,r,A){let u=a.base!==void 0?a.base:1;if(vt(A)!=="number")return Ke(a.default,r.default);let f=a.stops.length;if(f===1||A<=a.stops[0][0])return a.stops[0][1];if(A>=a.stops[f-1][0])return a.stops[f-1][1];let b=ya(a.stops.map(M=>M[0]),A),v=function(M,J,it,ot){let at=ot-it,Bt=M-it;return at===0?0:J===1?Bt/at:(Math.pow(J,Bt)-1)/(Math.pow(J,at)-1)}(A,u,a.stops[b][0],a.stops[b+1][0]),x=a.stops[b][1],Q=a.stops[b+1][1],Z=bn[r.type]||de;return typeof x.evaluate=="function"?{evaluate(...M){let J=x.evaluate.apply(void 0,M),it=Q.evaluate.apply(void 0,M);if(J!==void 0&&it!==void 0)return Z(J,it,v,a.colorSpace)}}:Z(x,Q,v,a.colorSpace)}function cr(a,r,A){switch(r.type){case"color":A=qi.parse(A);break;case"formatted":A=dn.fromString(A.toString());break;case"resolvedImage":A=zr.fromString(A.toString());break;case"padding":A=Mn.parse(A);break;default:vt(A)===r.type||r.type==="enum"&&r.values[A]||(A=void 0)}return Ke(A,a.default,r.default)}tn.register(Go,{error:[{kind:"error"},[gi],(a,[r])=>{throw new Gr(r.evaluate(a))}],typeof:[gi,[pi],(a,[r])=>xt(Hr(r.evaluate(a)))],"to-rgba":[_t(Qe,4),[Oi],(a,[r])=>{let[A,u,f,b]=r.evaluate(a).rgb;return[255*A,255*u,255*f,b]}],rgb:[Oi,[Qe,Qe,Qe],qA],rgba:[Oi,[Qe,Qe,Qe,Qe],qA],has:{type:Bi,overloads:[[[gi],(a,[r])=>Sl(r.evaluate(a),a.properties())],[[gi,Fr],(a,[r,A])=>Sl(r.evaluate(a),A.evaluate(a))]]},get:{type:pi,overloads:[[[gi],(a,[r])=>wa(r.evaluate(a),a.properties())],[[gi,Fr],(a,[r,A])=>wa(r.evaluate(a),A.evaluate(a))]]},"feature-state":[pi,[gi],(a,[r])=>wa(r.evaluate(a),a.featureState||{})],properties:[Fr,[],a=>a.properties()],"geometry-type":[gi,[],a=>a.geometryType()],id:[pi,[],a=>a.id()],zoom:[Qe,[],a=>a.globals.zoom],"heatmap-density":[Qe,[],a=>a.globals.heatmapDensity||0],"line-progress":[Qe,[],a=>a.globals.lineProgress||0],accumulated:[pi,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Qe,Gs(Qe),(a,r)=>{let A=0;for(let u of r)A+=u.evaluate(a);return A}],"*":[Qe,Gs(Qe),(a,r)=>{let A=1;for(let u of r)A*=u.evaluate(a);return A}],"-":{type:Qe,overloads:[[[Qe,Qe],(a,[r,A])=>r.evaluate(a)-A.evaluate(a)],[[Qe],(a,[r])=>-r.evaluate(a)]]},"/":[Qe,[Qe,Qe],(a,[r,A])=>r.evaluate(a)/A.evaluate(a)],"%":[Qe,[Qe,Qe],(a,[r,A])=>r.evaluate(a)%A.evaluate(a)],ln2:[Qe,[],()=>Math.LN2],pi:[Qe,[],()=>Math.PI],e:[Qe,[],()=>Math.E],"^":[Qe,[Qe,Qe],(a,[r,A])=>Math.pow(r.evaluate(a),A.evaluate(a))],sqrt:[Qe,[Qe],(a,[r])=>Math.sqrt(r.evaluate(a))],log10:[Qe,[Qe],(a,[r])=>Math.log(r.evaluate(a))/Math.LN10],ln:[Qe,[Qe],(a,[r])=>Math.log(r.evaluate(a))],log2:[Qe,[Qe],(a,[r])=>Math.log(r.evaluate(a))/Math.LN2],sin:[Qe,[Qe],(a,[r])=>Math.sin(r.evaluate(a))],cos:[Qe,[Qe],(a,[r])=>Math.cos(r.evaluate(a))],tan:[Qe,[Qe],(a,[r])=>Math.tan(r.evaluate(a))],asin:[Qe,[Qe],(a,[r])=>Math.asin(r.evaluate(a))],acos:[Qe,[Qe],(a,[r])=>Math.acos(r.evaluate(a))],atan:[Qe,[Qe],(a,[r])=>Math.atan(r.evaluate(a))],min:[Qe,Gs(Qe),(a,r)=>Math.min(...r.map(A=>A.evaluate(a)))],max:[Qe,Gs(Qe),(a,r)=>Math.max(...r.map(A=>A.evaluate(a)))],abs:[Qe,[Qe],(a,[r])=>Math.abs(r.evaluate(a))],round:[Qe,[Qe],(a,[r])=>{let A=r.evaluate(a);return A<0?-Math.round(-A):Math.round(A)}],floor:[Qe,[Qe],(a,[r])=>Math.floor(r.evaluate(a))],ceil:[Qe,[Qe],(a,[r])=>Math.ceil(r.evaluate(a))],"filter-==":[Bi,[gi,pi],(a,[r,A])=>a.properties()[r.value]===A.value],"filter-id-==":[Bi,[pi],(a,[r])=>a.id()===r.value],"filter-type-==":[Bi,[gi],(a,[r])=>a.geometryType()===r.value],"filter-<":[Bi,[gi,pi],(a,[r,A])=>{let u=a.properties()[r.value],f=A.value;return typeof u==typeof f&&u<f}],"filter-id-<":[Bi,[pi],(a,[r])=>{let A=a.id(),u=r.value;return typeof A==typeof u&&A<u}],"filter->":[Bi,[gi,pi],(a,[r,A])=>{let u=a.properties()[r.value],f=A.value;return typeof u==typeof f&&u>f}],"filter-id->":[Bi,[pi],(a,[r])=>{let A=a.id(),u=r.value;return typeof A==typeof u&&A>u}],"filter-<=":[Bi,[gi,pi],(a,[r,A])=>{let u=a.properties()[r.value],f=A.value;return typeof u==typeof f&&u<=f}],"filter-id-<=":[Bi,[pi],(a,[r])=>{let A=a.id(),u=r.value;return typeof A==typeof u&&A<=u}],"filter->=":[Bi,[gi,pi],(a,[r,A])=>{let u=a.properties()[r.value],f=A.value;return typeof u==typeof f&&u>=f}],"filter-id->=":[Bi,[pi],(a,[r])=>{let A=a.id(),u=r.value;return typeof A==typeof u&&A>=u}],"filter-has":[Bi,[pi],(a,[r])=>r.value in a.properties()],"filter-has-id":[Bi,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Bi,[_t(gi)],(a,[r])=>r.value.indexOf(a.geometryType())>=0],"filter-id-in":[Bi,[_t(pi)],(a,[r])=>r.value.indexOf(a.id())>=0],"filter-in-small":[Bi,[gi,_t(pi)],(a,[r,A])=>A.value.indexOf(a.properties()[r.value])>=0],"filter-in-large":[Bi,[gi,_t(pi)],(a,[r,A])=>function(u,f,b,v){for(;b<=v;){let x=b+v>>1;if(f[x]===u)return!0;f[x]>u?v=x-1:b=x+1}return!1}(a.properties()[r.value],A.value,0,A.value.length-1)],all:{type:Bi,overloads:[[[Bi,Bi],(a,[r,A])=>r.evaluate(a)&&A.evaluate(a)],[Gs(Bi),(a,r)=>{for(let A of r)if(!A.evaluate(a))return!1;return!0}]]},any:{type:Bi,overloads:[[[Bi,Bi],(a,[r,A])=>r.evaluate(a)||A.evaluate(a)],[Gs(Bi),(a,r)=>{for(let A of r)if(A.evaluate(a))return!0;return!1}]]},"!":[Bi,[Bi],(a,[r])=>!r.evaluate(a)],"is-supported-script":[Bi,[gi],(a,[r])=>{let A=a.globals&&a.globals.isSupportedScript;return!A||A(r.evaluate(a))}],upcase:[gi,[gi],(a,[r])=>r.evaluate(a).toUpperCase()],downcase:[gi,[gi],(a,[r])=>r.evaluate(a).toLowerCase()],concat:[gi,Gs(pi),(a,r)=>r.map(A=>pr(A.evaluate(a))).join("")],"resolved-locale":[gi,[Pr],(a,[r])=>r.evaluate(a).resolvedLocale()]});class Cr{constructor(r,A){var u;this.expression=r,this._warningHistory={},this._evaluator=new ie,this._defaultValue=A?(u=A).type==="color"&&Dt(u.default)?new qi(0,0,0,0):u.type==="color"?qi.parse(u.default)||null:u.type==="padding"?Mn.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?Ln.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=A&&A.type==="enum"?A.values:null}evaluateWithoutErrorHandling(r,A,u,f,b,v){return this._evaluator.globals=r,this._evaluator.feature=A,this._evaluator.featureState=u,this._evaluator.canonical=f,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(r,A,u,f,b,v){this._evaluator.globals=r,this._evaluator.feature=A||null,this._evaluator.featureState=u||null,this._evaluator.canonical=f,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=v||null;try{let x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new Gr(`Expected value to be one of ${Object.keys(this._enumValues).map(Q=>JSON.stringify(Q)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function Jr(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Go}function en(a,r){let A=new ge(Go,En,[],r?function(f){let b={color:Oi,string:gi,number:Qe,enum:gi,boolean:Bi,formatted:gt,padding:Y,resolvedImage:q,variableAnchorOffsetCollection:lt};return f.type==="array"?_t(b[f.value]||pi,f.length):b[f.type]}(r):void 0),u=A.parse(a,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?_A(new Cr(u,r)):gs(A.errors)}class pn{constructor(r,A){this.kind=r,this._styleExpression=A,this.isStateDependent=r!=="constant"&&!jo(A.expression)}evaluateWithoutErrorHandling(r,A,u,f,b,v){return this._styleExpression.evaluateWithoutErrorHandling(r,A,u,f,b,v)}evaluate(r,A,u,f,b,v){return this._styleExpression.evaluate(r,A,u,f,b,v)}}class Sn{constructor(r,A,u,f){this.kind=r,this.zoomStops=u,this._styleExpression=A,this.isStateDependent=r!=="camera"&&!jo(A.expression),this.interpolationType=f}evaluateWithoutErrorHandling(r,A,u,f,b,v){return this._styleExpression.evaluateWithoutErrorHandling(r,A,u,f,b,v)}evaluate(r,A,u,f,b,v){return this._styleExpression.evaluate(r,A,u,f,b,v)}interpolationFactor(r,A,u){return this.interpolationType?hs.interpolationFactor(this.interpolationType,r,A,u):0}}function vn(a,r){let A=en(a,r);if(A.result==="error")return A;let u=A.value.expression,f=Xs(u);if(!f&&!Ro(r))return gs([new Ki("","data expressions not supported")]);let b=yA(u,["zoom"]);if(!b&&!U(r))return gs([new Ki("","zoom expressions not supported")]);let v=ss(u);return v||b?v instanceof Ki?gs([v]):v instanceof hs&&!et(r)?gs([new Ki("",'"interpolate" expressions cannot be used with this property')]):_A(v?new Sn(f?"camera":"composite",A.value,v.labels,v instanceof hs?v.interpolation:void 0):new pn(f?"constant":"source",A.value)):gs([new Ki("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ds{constructor(r,A){this._parameters=r,this._specification=A,Ye(this,Ce(this._parameters,this._specification))}static deserialize(r){return new ds(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function ss(a){let r=null;if(a instanceof $o)r=ss(a.result);else if(a instanceof ba){for(let A of a.args)if(r=ss(A),r)break}else(a instanceof Qo||a instanceof hs)&&a.input instanceof tn&&a.input.name==="zoom"&&(r=a);return r instanceof Ki||a.eachChild(A=>{let u=ss(A);u instanceof Ki?r=u:!r&&u?r=new Ki("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&u&&r!==u&&(r=new Ki("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function Rs(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(let r of a.slice(1))if(!Rs(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}let Fl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Na(a){if(a==null)return{filter:()=>!0,needGeometry:!1};Rs(a)||(a=Ba(a));let r=en(a,Fl);if(r.result==="error")throw new Error(r.value.map(A=>`${A.key}: ${A.message}`).join(", "));return{filter:(A,u,f)=>r.value.evaluate(A,u,{},f),needGeometry:Pa(a)}}function $A(a,r){return a<r?-1:a>r?1:0}function Pa(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let r=1;r<a.length;r++)if(Pa(a[r]))return!0;return!1}function Ba(a){if(!a)return!0;let r=a[0];return a.length<=1?r!=="any":r==="=="?Ma(a[1],a[2],"=="):r==="!="?Zo(Ma(a[1],a[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Ma(a[1],a[2],r):r==="any"?(A=a.slice(1),["any"].concat(A.map(Ba))):r==="all"?["all"].concat(a.slice(1).map(Ba)):r==="none"?["all"].concat(a.slice(1).map(Ba).map(Zo)):r==="in"?Va(a[1],a.slice(2)):r==="!in"?Zo(Va(a[1],a.slice(2))):r==="has"?ps(a[1]):r==="!has"?Zo(ps(a[1])):r!=="within"||a;var A}function Ma(a,r,A){switch(a){case"$type":return[`filter-type-${A}`,r];case"$id":return[`filter-id-${A}`,r];default:return[`filter-${A}`,a,r]}}function Va(a,r){if(r.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(A=>typeof A!=typeof r[0])?["filter-in-large",a,["literal",r.sort($A)]]:["filter-in-small",a,["literal",r]]}}function ps(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Zo(a){return["!",a]}function ea(a){let r=typeof a;if(r==="number"||r==="boolean"||r==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let f="[";for(let b of a)f+=`${ea(b)},`;return`${f}]`}let A=Object.keys(a).sort(),u="{";for(let f=0;f<A.length;f++)u+=`${JSON.stringify(A[f])}:${ea(a[A[f]])},`;return`${u}}`}function ia(a){let r="";for(let A of Ze)r+=`/${ea(a[A])}`;return r}function xA(a){let r=a.value;return r?[new Fe(a.key,r,"constants have been deprecated as of v8")]:[]}function Ir(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function ra(a){if(Array.isArray(a))return a.map(ra);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){let r={};for(let A in a)r[A]=ra(a[A]);return r}return Ir(a)}function Tn(a){let r=a.key,A=a.value,u=a.valueSpec||{},f=a.objectElementValidators||{},b=a.style,v=a.styleSpec,x=a.validateSpec,Q=[],Z=vt(A);if(Z!=="object")return[new Fe(r,A,`object expected, ${Z} found`)];for(let M in A){let J=M.split(".")[0],it=u[J]||u["*"],ot;if(f[J])ot=f[J];else if(u[J])ot=x;else if(f["*"])ot=f["*"];else{if(!u["*"]){Q.push(new Fe(r,A[M],`unknown property "${M}"`));continue}ot=x}Q=Q.concat(ot({key:(r&&`${r}.`)+M,value:A[M],valueSpec:it,style:b,styleSpec:v,object:A,objectKey:M,validateSpec:x},A))}for(let M in u)f[M]||u[M].required&&u[M].default===void 0&&A[M]===void 0&&Q.push(new Fe(r,A,`missing required property "${M}"`));return Q}function na(a){let r=a.value,A=a.valueSpec,u=a.style,f=a.styleSpec,b=a.key,v=a.arrayElementValidator||a.validateSpec;if(vt(r)!=="array")return[new Fe(b,r,`array expected, ${vt(r)} found`)];if(A.length&&r.length!==A.length)return[new Fe(b,r,`array length ${A.length} expected, length ${r.length} found`)];if(A["min-length"]&&r.length<A["min-length"])return[new Fe(b,r,`array length at least ${A["min-length"]} expected, length ${r.length} found`)];let x={type:A.value,values:A.values};f.$version<7&&(x.function=A.function),vt(A.value)==="object"&&(x=A.value);let Q=[];for(let Z=0;Z<r.length;Z++)Q=Q.concat(v({array:r,arrayIndex:Z,value:r[Z],valueSpec:x,validateSpec:a.validateSpec,style:u,styleSpec:f,key:`${b}[${Z}]`}));return Q}function fs(a){let r=a.key,A=a.value,u=a.valueSpec,f=vt(A);return f==="number"&&A!=A&&(f="NaN"),f!=="number"?[new Fe(r,A,`number expected, ${f} found`)]:"minimum"in u&&A<u.minimum?[new Fe(r,A,`${A} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&A>u.maximum?[new Fe(r,A,`${A} is greater than the maximum value ${u.maximum}`)]:[]}function _a(a){let r=a.valueSpec,A=Ir(a.value.type),u,f,b,v={},x=A!=="categorical"&&a.value.property===void 0,Q=!x,Z=vt(a.value.stops)==="array"&&vt(a.value.stops[0])==="array"&&vt(a.value.stops[0][0])==="object",M=Tn({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(ot){if(A==="identity")return[new Fe(ot.key,ot.value,'identity function may not have a "stops" property')];let at=[],Bt=ot.value;return at=at.concat(na({key:ot.key,value:Bt,valueSpec:ot.valueSpec,validateSpec:ot.validateSpec,style:ot.style,styleSpec:ot.styleSpec,arrayElementValidator:J})),vt(Bt)==="array"&&Bt.length===0&&at.push(new Fe(ot.key,Bt,"array must have at least one stop")),at},default:function(ot){return ot.validateSpec({key:ot.key,value:ot.value,valueSpec:r,validateSpec:ot.validateSpec,style:ot.style,styleSpec:ot.styleSpec})}}});return A==="identity"&&x&&M.push(new Fe(a.key,a.value,'missing required property "property"')),A==="identity"||a.value.stops||M.push(new Fe(a.key,a.value,'missing required property "stops"')),A==="exponential"&&a.valueSpec.expression&&!et(a.valueSpec)&&M.push(new Fe(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(Q&&!Ro(a.valueSpec)?M.push(new Fe(a.key,a.value,"property functions not supported")):x&&!U(a.valueSpec)&&M.push(new Fe(a.key,a.value,"zoom functions not supported"))),A!=="categorical"&&!Z||a.value.property!==void 0||M.push(new Fe(a.key,a.value,'"property" property is required')),M;function J(ot){let at=[],Bt=ot.value,Gt=ot.key;if(vt(Bt)!=="array")return[new Fe(Gt,Bt,`array expected, ${vt(Bt)} found`)];if(Bt.length!==2)return[new Fe(Gt,Bt,`array length 2 expected, length ${Bt.length} found`)];if(Z){if(vt(Bt[0])!=="object")return[new Fe(Gt,Bt,`object expected, ${vt(Bt[0])} found`)];if(Bt[0].zoom===void 0)return[new Fe(Gt,Bt,"object stop key must have zoom")];if(Bt[0].value===void 0)return[new Fe(Gt,Bt,"object stop key must have value")];if(b&&b>Ir(Bt[0].zoom))return[new Fe(Gt,Bt[0].zoom,"stop zoom values must appear in ascending order")];Ir(Bt[0].zoom)!==b&&(b=Ir(Bt[0].zoom),f=void 0,v={}),at=at.concat(Tn({key:`${Gt}[0]`,value:Bt[0],valueSpec:{zoom:{}},validateSpec:ot.validateSpec,style:ot.style,styleSpec:ot.styleSpec,objectElementValidators:{zoom:fs,value:it}}))}else at=at.concat(it({key:`${Gt}[0]`,value:Bt[0],valueSpec:{},validateSpec:ot.validateSpec,style:ot.style,styleSpec:ot.styleSpec},Bt));return Jr(ra(Bt[1]))?at.concat([new Fe(`${Gt}[1]`,Bt[1],"expressions are not allowed in function stops.")]):at.concat(ot.validateSpec({key:`${Gt}[1]`,value:Bt[1],valueSpec:r,validateSpec:ot.validateSpec,style:ot.style,styleSpec:ot.styleSpec}))}function it(ot,at){let Bt=vt(ot.value),Gt=Ir(ot.value),Mt=ot.value!==null?ot.value:at;if(u){if(Bt!==u)return[new Fe(ot.key,Mt,`${Bt} stop domain type must match previous stop domain type ${u}`)]}else u=Bt;if(Bt!=="number"&&Bt!=="string"&&Bt!=="boolean")return[new Fe(ot.key,Mt,"stop domain value must be a number, string, or boolean")];if(Bt!=="number"&&A!=="categorical"){let ne=`number expected, ${Bt} found`;return Ro(r)&&A===void 0&&(ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fe(ot.key,Mt,ne)]}return A!=="categorical"||Bt!=="number"||isFinite(Gt)&&Math.floor(Gt)===Gt?A!=="categorical"&&Bt==="number"&&f!==void 0&&Gt<f?[new Fe(ot.key,Mt,"stop domain values must appear in ascending order")]:(f=Gt,A==="categorical"&&Gt in v?[new Fe(ot.key,Mt,"stop domain values must be unique")]:(v[Gt]=!0,[])):[new Fe(ot.key,Mt,`integer expected, found ${Gt}`)]}}function sa(a){let r=(a.expressionContext==="property"?vn:en)(ra(a.value),a.valueSpec);if(r.result==="error")return r.value.map(u=>new Fe(`${a.key}${u.key}`,a.value,u.message));let A=r.value.expression||r.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!A.outputDefined())return[new Fe(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!jo(A))return[new Fe(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!jo(A))return[new Fe(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!yA(A,["zoom","feature-state"]))return[new Fe(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Xs(A))return[new Fe(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Da(a){let r=a.key,A=a.value,u=a.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(Ir(A))===-1&&f.push(new Fe(r,A,`expected one of [${u.values.join(", ")}], ${JSON.stringify(A)} found`)):Object.keys(u.values).indexOf(Ir(A))===-1&&f.push(new Fe(r,A,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(A)} found`)),f}function Zs(a){return Rs(ra(a.value))?sa(Ye({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Hs(a)}function Hs(a){let r=a.value,A=a.key;if(vt(r)!=="array")return[new Fe(A,r,`array expected, ${vt(r)} found`)];let u=a.styleSpec,f,b=[];if(r.length<1)return[new Fe(A,r,"filter array must have at least 1 element")];switch(b=b.concat(Da({key:`${A}[0]`,value:r[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),Ir(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Ir(r[1])==="$type"&&b.push(new Fe(A,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&b.push(new Fe(A,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(f=vt(r[1]),f!=="string"&&b.push(new Fe(`${A}[1]`,r[1],`string expected, ${f} found`)));for(let v=2;v<r.length;v++)f=vt(r[v]),Ir(r[1])==="$type"?b=b.concat(Da({key:`${A}[${v}]`,value:r[v],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&b.push(new Fe(`${A}[${v}]`,r[v],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let v=1;v<r.length;v++)b=b.concat(Hs({key:`${A}[${v}]`,value:r[v],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":f=vt(r[1]),r.length!==2?b.push(new Fe(A,r,`filter array for "${r[0]}" operator must have 2 elements`)):f!=="string"&&b.push(new Fe(`${A}[1]`,r[1],`string expected, ${f} found`));break;case"within":f=vt(r[1]),r.length!==2?b.push(new Fe(A,r,`filter array for "${r[0]}" operator must have 2 elements`)):f!=="object"&&b.push(new Fe(`${A}[1]`,r[1],`object expected, ${f} found`))}return b}function Ys(a,r){let A=a.key,u=a.validateSpec,f=a.style,b=a.styleSpec,v=a.value,x=a.objectKey,Q=b[`${r}_${a.layerType}`];if(!Q)return[];let Z=x.match(/^(.*)-transition$/);if(r==="paint"&&Z&&Q[Z[1]]&&Q[Z[1]].transition)return u({key:A,value:v,valueSpec:b.transition,style:f,styleSpec:b});let M=a.valueSpec||Q[x];if(!M)return[new Fe(A,v,`unknown property "${x}"`)];let J;if(vt(v)==="string"&&Ro(M)&&!M.tokens&&(J=/^{([^}]+)}$/.exec(v)))return[new Fe(A,v,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(J[1])} }\`.`)];let it=[];return a.layerType==="symbol"&&(x==="text-field"&&f&&!f.glyphs&&it.push(new Fe(A,v,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&Dt(ra(v))&&Ir(v.type)==="identity"&&it.push(new Fe(A,v,'"text-font" does not support identity functions'))),it.concat(u({key:a.key,value:v,valueSpec:M,style:f,styleSpec:b,expressionContext:"property",propertyType:r,propertyKey:x}))}function oa(a){return Ys(a,"paint")}function fo(a){return Ys(a,"layout")}function Ho(a){let r=[],A=a.value,u=a.key,f=a.style,b=a.styleSpec;A.type||A.ref||r.push(new Fe(u,A,'either "type" or "ref" is required'));let v=Ir(A.type),x=Ir(A.ref);if(A.id){let Q=Ir(A.id);for(let Z=0;Z<a.arrayIndex;Z++){let M=f.layers[Z];Ir(M.id)===Q&&r.push(new Fe(u,A.id,`duplicate layer id "${A.id}", previously used at line ${M.id.__line__}`))}}if("ref"in A){let Q;["type","source","source-layer","filter","layout"].forEach(Z=>{Z in A&&r.push(new Fe(u,A[Z],`"${Z}" is prohibited for ref layers`))}),f.layers.forEach(Z=>{Ir(Z.id)===x&&(Q=Z)}),Q?Q.ref?r.push(new Fe(u,A.ref,"ref cannot reference another ref layer")):v=Ir(Q.type):r.push(new Fe(u,A.ref,`ref layer "${x}" not found`))}else if(v!=="background")if(A.source){let Q=f.sources&&f.sources[A.source],Z=Q&&Ir(Q.type);Q?Z==="vector"&&v==="raster"?r.push(new Fe(u,A.source,`layer "${A.id}" requires a raster source`)):Z!=="raster-dem"&&v==="hillshade"?r.push(new Fe(u,A.source,`layer "${A.id}" requires a raster-dem source`)):Z==="raster"&&v!=="raster"?r.push(new Fe(u,A.source,`layer "${A.id}" requires a vector source`)):Z!=="vector"||A["source-layer"]?Z==="raster-dem"&&v!=="hillshade"?r.push(new Fe(u,A.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!A.paint||!A.paint["line-gradient"]||Z==="geojson"&&Q.lineMetrics||r.push(new Fe(u,A,`layer "${A.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Fe(u,A,`layer "${A.id}" must specify a "source-layer"`)):r.push(new Fe(u,A.source,`source "${A.source}" not found`))}else r.push(new Fe(u,A,'missing required property "source"'));return r=r.concat(Tn({key:u,value:A,valueSpec:b.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${u}.type`,value:A.type,valueSpec:b.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:A,objectKey:"type"}),filter:Zs,layout:Q=>Tn({layer:A,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,validateSpec:Q.validateSpec,objectElementValidators:{"*":Z=>fo(Ye({layerType:v},Z))}}),paint:Q=>Tn({layer:A,key:Q.key,value:Q.value,style:Q.style,styleSpec:Q.styleSpec,validateSpec:Q.validateSpec,objectElementValidators:{"*":Z=>oa(Ye({layerType:v},Z))}})}})),r}function ms(a){let r=a.value,A=a.key,u=vt(r);return u!=="string"?[new Fe(A,r,`string expected, ${u} found`)]:[]}let Cs={promoteId:function({key:a,value:r}){if(vt(r)==="string")return ms({key:a,value:r});{let A=[];for(let u in r)A.push(...ms({key:`${a}.${u}`,value:r[u]}));return A}}};function Qn(a){let r=a.value,A=a.key,u=a.styleSpec,f=a.style,b=a.validateSpec;if(!r.type)return[new Fe(A,r,'"type" is required')];let v=Ir(r.type),x;switch(v){case"vector":case"raster":return x=Tn({key:A,value:r,valueSpec:u[`source_${v.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:Cs,validateSpec:b}),x;case"raster-dem":return x=function(Q){var Z;let M=(Z=Q.sourceName)!==null&&Z!==void 0?Z:"",J=Q.value,it=Q.styleSpec,ot=it.source_raster_dem,at=Q.style,Bt=[],Gt=vt(J);if(J===void 0)return Bt;if(Gt!=="object")return Bt.push(new Fe("source_raster_dem",J,`object expected, ${Gt} found`)),Bt;let Mt=Ir(J.encoding)==="custom",ne=["redFactor","greenFactor","blueFactor","baseShift"],Yt=Q.value.encoding?`"${Q.value.encoding}"`:"Default";for(let Ae in J)!Mt&&ne.includes(Ae)?Bt.push(new Fe(Ae,J[Ae],`In "${M}": "${Ae}" is only valid when "encoding" is set to "custom". ${Yt} encoding found`)):ot[Ae]?Bt=Bt.concat(Q.validateSpec({key:Ae,value:J[Ae],valueSpec:ot[Ae],validateSpec:Q.validateSpec,style:at,styleSpec:it})):Bt.push(new Fe(Ae,J[Ae],`unknown property "${Ae}"`));return Bt}({sourceName:A,value:r,style:a.style,styleSpec:u,validateSpec:b}),x;case"geojson":if(x=Tn({key:A,value:r,valueSpec:u.source_geojson,style:f,styleSpec:u,validateSpec:b,objectElementValidators:Cs}),r.cluster)for(let Q in r.clusterProperties){let[Z,M]=r.clusterProperties[Q],J=typeof Z=="string"?[Z,["accumulated"],["get",Q]]:Z;x.push(...sa({key:`${A}.${Q}.map`,value:M,validateSpec:b,expressionContext:"cluster-map"})),x.push(...sa({key:`${A}.${Q}.reduce`,value:J,validateSpec:b,expressionContext:"cluster-reduce"}))}return x;case"video":return Tn({key:A,value:r,valueSpec:u.source_video,style:f,validateSpec:b,styleSpec:u});case"image":return Tn({key:A,value:r,valueSpec:u.source_image,style:f,validateSpec:b,styleSpec:u});case"canvas":return[new Fe(A,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Da({key:`${A}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,validateSpec:b,styleSpec:u})}}function aa(a){let r=a.value,A=a.styleSpec,u=A.light,f=a.style,b=[],v=vt(r);if(r===void 0)return b;if(v!=="object")return b=b.concat([new Fe("light",r,`object expected, ${v} found`)]),b;for(let x in r){let Q=x.match(/^(.*)-transition$/);b=b.concat(Q&&u[Q[1]]&&u[Q[1]].transition?a.validateSpec({key:x,value:r[x],valueSpec:A.transition,validateSpec:a.validateSpec,style:f,styleSpec:A}):u[x]?a.validateSpec({key:x,value:r[x],valueSpec:u[x],validateSpec:a.validateSpec,style:f,styleSpec:A}):[new Fe(x,r[x],`unknown property "${x}"`)])}return b}function Aa(a){let r=a.value,A=a.styleSpec,u=A.terrain,f=a.style,b=[],v=vt(r);if(r===void 0)return b;if(v!=="object")return b=b.concat([new Fe("terrain",r,`object expected, ${v} found`)]),b;for(let x in r)b=b.concat(u[x]?a.validateSpec({key:x,value:r[x],valueSpec:u[x],validateSpec:a.validateSpec,style:f,styleSpec:A}):[new Fe(x,r[x],`unknown property "${x}"`)]);return b}function js(a){let r=[],A=a.value,u=a.key;if(Array.isArray(A)){let f=[],b=[];for(let v in A)A[v].id&&f.includes(A[v].id)&&r.push(new Fe(u,A,`all the sprites' ids must be unique, but ${A[v].id} is duplicated`)),f.push(A[v].id),A[v].url&&b.includes(A[v].url)&&r.push(new Fe(u,A,`all the sprites' URLs must be unique, but ${A[v].url} is duplicated`)),b.push(A[v].url),r=r.concat(Tn({key:`${u}[${v}]`,value:A[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return r}return ms({key:u,value:A})}let No={"*":()=>[],array:na,boolean:function(a){let r=a.value,A=a.key,u=vt(r);return u!=="boolean"?[new Fe(A,r,`boolean expected, ${u} found`)]:[]},number:fs,color:function(a){let r=a.key,A=a.value,u=vt(A);return u!=="string"?[new Fe(r,A,`color expected, ${u} found`)]:qi.parse(String(A))?[]:[new Fe(r,A,`color expected, "${A}" found`)]},constants:xA,enum:Da,filter:Zs,function:_a,layer:Ho,object:Tn,source:Qn,light:aa,terrain:Aa,string:ms,formatted:function(a){return ms(a).length===0?[]:sa(a)},resolvedImage:function(a){return ms(a).length===0?[]:sa(a)},padding:function(a){let r=a.key,A=a.value;if(vt(A)==="array"){if(A.length<1||A.length>4)return[new Fe(r,A,`padding requires 1 to 4 values; ${A.length} values found`)];let u={type:"number"},f=[];for(let b=0;b<A.length;b++)f=f.concat(a.validateSpec({key:`${r}[${b}]`,value:A[b],validateSpec:a.validateSpec,valueSpec:u}));return f}return fs({key:r,value:A,valueSpec:{}})},variableAnchorOffsetCollection:function(a){let r=a.key,A=a.value,u=vt(A),f=a.styleSpec;if(u!=="array"||A.length<1||A.length%2!=0)return[new Fe(r,A,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let v=0;v<A.length;v+=2)b=b.concat(Da({key:`${r}[${v}]`,value:A[v],valueSpec:f.layout_symbol["text-anchor"]})),b=b.concat(na({key:`${r}[${v+1}]`,value:A[v+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:f}));return b},sprite:js};function Is(a){let r=a.value,A=a.valueSpec,u=a.styleSpec;return a.validateSpec=Is,A.expression&&Dt(Ir(r))?_a(a):A.expression&&Jr(ra(r))?sa(a):A.type&&No[A.type]?No[A.type](a):Tn(Ye({},a,{valueSpec:A.type?u[A.type]:A}))}function Ka(a){let r=a.value,A=a.key,u=ms(a);return u.length||(r.indexOf("{fontstack}")===-1&&u.push(new Fe(A,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&u.push(new Fe(A,r,'"glyphs" url must include a "{range}" token'))),u}function Un(a,r=$t){let A=[];return A=A.concat(Is({key:"",value:a,valueSpec:r.$root,styleSpec:r,style:a,validateSpec:Is,objectElementValidators:{glyphs:Ka,"*":()=>[]}})),a.constants&&(A=A.concat(xA({key:"constants",value:a.constants,style:a,styleSpec:r,validateSpec:Is}))),xa(A)}function os(a){return function(r){return a({...r,validateSpec:Is})}}function xa(a){return[].concat(a).sort((r,A)=>r.line-A.line)}function wn(a){return function(...r){return xa(a.apply(this,r))}}Un.source=wn(os(Qn)),Un.sprite=wn(os(js)),Un.glyphs=wn(os(Ka)),Un.light=wn(os(aa)),Un.terrain=wn(os(Aa)),Un.layer=wn(os(Ho)),Un.filter=wn(os(Zs)),Un.paintProperty=wn(os(oa)),Un.layoutProperty=wn(os(fo));let Vn=Un,Xr=Vn.light,Vr=Vn.paintProperty,fn=Vn.layoutProperty;function mn(a,r){let A=!1;if(r&&r.length)for(let u of r)a.fire(new Rt(new Error(u.message))),A=!0;return A}class Bs{constructor(r,A,u){let f=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;let v=new Int32Array(this.arrayBuffer);r=v[0],this.d=(A=v[1])+2*(u=v[2]);for(let Q=0;Q<this.d*this.d;Q++){let Z=v[3+Q],M=v[3+Q+1];f.push(Z===M?null:v.subarray(Z,M))}let x=v[3+f.length+1];this.keys=v.subarray(v[3+f.length],x),this.bboxes=v.subarray(x),this.insert=this._insertReadonly}else{this.d=A+2*u;for(let v=0;v<this.d*this.d;v++)f.push([]);this.keys=[],this.bboxes=[]}this.n=A,this.extent=r,this.padding=u,this.scale=A/r,this.uid=0;let b=u/A*r;this.min=-b,this.max=r+b}insert(r,A,u,f,b){this._forEachCell(A,u,f,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(A),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,A,u,f,b,v){this.cells[b].push(v)}query(r,A,u,f,b){let v=this.min,x=this.max;if(r<=v&&A<=v&&x<=u&&x<=f&&!b)return Array.prototype.slice.call(this.keys);{let Q=[];return this._forEachCell(r,A,u,f,this._queryCell,Q,{},b),Q}}_queryCell(r,A,u,f,b,v,x,Q){let Z=this.cells[b];if(Z!==null){let M=this.keys,J=this.bboxes;for(let it=0;it<Z.length;it++){let ot=Z[it];if(x[ot]===void 0){let at=4*ot;(Q?Q(J[at+0],J[at+1],J[at+2],J[at+3]):r<=J[at+2]&&A<=J[at+3]&&u>=J[at+0]&&f>=J[at+1])?(x[ot]=!0,v.push(M[ot])):x[ot]=!1}}}}_forEachCell(r,A,u,f,b,v,x,Q){let Z=this._convertToCellCoord(r),M=this._convertToCellCoord(A),J=this._convertToCellCoord(u),it=this._convertToCellCoord(f);for(let ot=Z;ot<=J;ot++)for(let at=M;at<=it;at++){let Bt=this.d*at+ot;if((!Q||Q(this._convertFromCellCoord(ot),this._convertFromCellCoord(at),this._convertFromCellCoord(ot+1),this._convertFromCellCoord(at+1)))&&b.call(this,r,A,u,f,Bt,v,x,Q))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let r=this.cells,A=3+this.cells.length+1+1,u=0;for(let v=0;v<this.cells.length;v++)u+=this.cells[v].length;let f=new Int32Array(A+u+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let b=A;for(let v=0;v<r.length;v++){let x=r[v];f[3+v]=b,f.set(x,b),b+=x.length}return f[3+r.length]=b,f.set(this.keys,b),b+=this.keys.length,f[3+r.length+1]=b,f.set(this.bboxes,b),b+=this.bboxes.length,f.buffer}static serialize(r,A){let u=r.toArrayBuffer();return A&&A.push(u),{buffer:u}}static deserialize(r){return new Bs(r.buffer)}}let as={};function li(a,r,A={}){if(as[a])throw new Error(`${a} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:a,writeable:!1}),as[a]={klass:r,omit:A.omit||[],shallow:A.shallow||[]}}li("Object",Object),li("TransferableGridIndex",Bs),li("Color",qi),li("Error",Error),li("AJAXError",Xt),li("ResolvedImage",zr),li("StylePropertyFunction",ds),li("StyleExpression",Cr,{omit:["_evaluator"]}),li("ZoomDependentExpression",Sn),li("ZoomConstantExpression",pn),li("CompoundExpression",tn,{omit:["_evaluate"]});for(let a in Go)Go[a]._classRegistryKey||li(`Expression_${a}`,Go[a]);function Oa(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function la(a,r){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob)return a;if(Oa(a)||ae(a))return r&&r.push(a),a;if(ArrayBuffer.isView(a)){let A=a;return r&&r.push(A.buffer),A}if(a instanceof ImageData)return r&&r.push(a.data.buffer),a;if(Array.isArray(a)){let A=[];for(let u of a)A.push(la(u,r));return A}if(typeof a=="object"){let A=a.constructor,u=A._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");if(!as[u])throw new Error(`${u} is not registered.`);let f=A.serialize?A.serialize(a,r):{};if(A.serialize){if(r&&f===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let b in a){if(!a.hasOwnProperty(b)||as[u].omit.indexOf(b)>=0)continue;let v=a[b];f[b]=as[u].shallow.indexOf(b)>=0?v:la(v,r)}a instanceof Error&&(f.message=a.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(f.$name=u),f}throw new Error("can't serialize object of type "+typeof a)}function Wa(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||Oa(a)||ae(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Wa);if(typeof a=="object"){let r=a.$name||"Object";if(!as[r])throw new Error(`can't deserialize unregistered class ${r}`);let{klass:A}=as[r];if(!A)throw new Error(`can't deserialize unregistered class ${r}`);if(A.deserialize)return A.deserialize(a);let u=Object.create(A.prototype);for(let f of Object.keys(a)){if(f==="$name")continue;let b=a[f];u[f]=as[r].shallow.indexOf(f)>=0?b:Wa(b)}return u}throw new Error("can't deserialize object of type "+typeof a)}class yc{constructor(){this.first=!0}update(r,A){let u=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=A):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=A),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=u,!0))}}let ai={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function kl(a){for(let r of a)if(SA(r.charCodeAt(0)))return!0;return!1}function Ll(a){for(let r of a)if(!bc(r.charCodeAt(0)))return!1;return!0}function bc(a){return!(ai.Arabic(a)||ai["Arabic Supplement"](a)||ai["Arabic Extended-A"](a)||ai["Arabic Presentation Forms-A"](a)||ai["Arabic Presentation Forms-B"](a))}function SA(a){return!(a!==746&&a!==747&&(a<4352||!(ai["Bopomofo Extended"](a)||ai.Bopomofo(a)||ai["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||ai["CJK Compatibility Ideographs"](a)||ai["CJK Compatibility"](a)||ai["CJK Radicals Supplement"](a)||ai["CJK Strokes"](a)||!(!ai["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||ai["CJK Unified Ideographs Extension A"](a)||ai["CJK Unified Ideographs"](a)||ai["Enclosed CJK Letters and Months"](a)||ai["Hangul Compatibility Jamo"](a)||ai["Hangul Jamo Extended-A"](a)||ai["Hangul Jamo Extended-B"](a)||ai["Hangul Jamo"](a)||ai["Hangul Syllables"](a)||ai.Hiragana(a)||ai["Ideographic Description Characters"](a)||ai.Kanbun(a)||ai["Kangxi Radicals"](a)||ai["Katakana Phonetic Extensions"](a)||ai.Katakana(a)&&a!==12540||!(!ai["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!ai["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||ai["Unified Canadian Aboriginal Syllabics"](a)||ai["Unified Canadian Aboriginal Syllabics Extended"](a)||ai["Vertical Forms"](a)||ai["Yijing Hexagram Symbols"](a)||ai["Yi Syllables"](a)||ai["Yi Radicals"](a))))}function _s(a){return!(SA(a)||function(r){return!!(ai["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||ai["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||ai["Letterlike Symbols"](r)||ai["Number Forms"](r)||ai["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||ai["Control Pictures"](r)&&r!==9251||ai["Optical Character Recognition"](r)||ai["Enclosed Alphanumerics"](r)||ai["Geometric Shapes"](r)||ai["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||ai["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||ai["CJK Symbols and Punctuation"](r)||ai.Katakana(r)||ai["Private Use Area"](r)||ai["CJK Compatibility Forms"](r)||ai["Small Form Variants"](r)||ai["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(a))}function Ns(a){return a>=1424&&a<=2303||ai["Arabic Presentation Forms-A"](a)||ai["Arabic Presentation Forms-B"](a)}function tl(a,r){return!(!r&&Ns(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||ai.Khmer(a))}function El(a){for(let r of a)if(Ns(r.charCodeAt(0)))return!0;return!1}let Tl="deferred",FA="loading",kA="loaded",el=null,ys="unavailable",Po=null,za=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(ys="error"),el&&el(a)};function LA(){Ja.fire(new Be("pluginStateChange",{pluginStatus:ys,pluginURL:Po}))}let Ja=new Ui,vc=function(){return ys},gu=function(){if(ys!==Tl||!Po)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ys=FA,LA(),Po&&De({url:Po},a=>{a?za(a):(ys=kA,LA())})},xs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ys===kA||xs.applyArabicShaping!=null,isLoading:()=>ys===FA,setState(a){if(!ue())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");ys=a.pluginStatus,Po=a.pluginURL},isParsed(){if(!ue())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return xs.applyArabicShaping!=null&&xs.processBidirectionalText!=null&&xs.processStyledBidirectionalText!=null},getPluginURL(){if(!ue())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Po}};class Yr{constructor(r,A){this.zoom=r,A?(this.now=A.now,this.fadeDuration=A.fadeDuration,this.zoomHistory=A.zoomHistory,this.transition=A.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new yc,this.transition={})}isSupportedScript(r){return function(A,u){for(let f of A)if(!tl(f.charCodeAt(0),u))return!1;return!0}(r,xs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let r=this.zoom,A=r-Math.floor(r),u=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:A+(1-A)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*A}}}class Ql{constructor(r,A){this.property=r,this.value=A,this.expression=function(u,f){if(Dt(u))return new ds(u,f);if(Jr(u)){let b=vn(u,f);if(b.result==="error")throw new Error(b.value.map(v=>`${v.key}: ${v.message}`).join(", "));return b.value}{let b=u;return f.type==="color"&&typeof u=="string"?b=qi.parse(u):f.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(u)&&(b=Ln.parse(u)):b=Mn.parse(u),{kind:"constant",evaluate:()=>b}}}(A===void 0?r.specification.default:A,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,A,u){return this.property.possiblyEvaluate(this,r,A,u)}}class wc{constructor(r){this.property=r,this.value=new Ql(r,void 0)}transitioned(r,A){return new pu(this.property,this.value,A,Qt({},r.transition,this.transition),r.now)}untransitioned(){return new pu(this.property,this.value,null,{},0)}}class du{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return oe(this._values[r].value.value)}setValue(r,A){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new wc(this._values[r].property)),this._values[r].value=new Ql(this._values[r].property,A===null?void 0:oe(A))}getTransition(r){return oe(this._values[r].transition)}setTransition(r,A){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new wc(this._values[r].property)),this._values[r].transition=oe(A)||void 0}serialize(){let r={};for(let A of Object.keys(this._values)){let u=this.getValue(A);u!==void 0&&(r[A]=u);let f=this.getTransition(A);f!==void 0&&(r[`${A}-transition`]=f)}return r}transitioned(r,A){let u=new Ul(this._properties);for(let f of Object.keys(this._values))u._values[f]=this._values[f].transitioned(r,A._values[f]);return u}untransitioned(){let r=new Ul(this._properties);for(let A of Object.keys(this._values))r._values[A]=this._values[A].untransitioned();return r}}class pu{constructor(r,A,u,f,b){this.property=r,this.value=A,this.begin=b+f.delay||0,this.end=this.begin+f.duration||0,r.specification.transition&&(f.delay||f.duration)&&(this.prior=u)}possiblyEvaluate(r,A,u){let f=r.now||0,b=this.value.possiblyEvaluate(r,A,u),v=this.prior;if(v){if(f>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(f<this.begin)return v.possiblyEvaluate(r,A,u);{let x=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(r,A,u),b,function(Q){if(Q<=0)return 0;if(Q>=1)return 1;let Z=Q*Q,M=Z*Q;return 4*(Q<.5?M:3*(Q-Z)+M-.75)}(x))}}return b}}class Ul{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,A,u){let f=new Gl(this._properties);for(let b of Object.keys(this._values))f._values[b]=this._values[b].possiblyEvaluate(r,A,u);return f}hasTransition(){for(let r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Bc{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return oe(this._values[r].value)}setValue(r,A){this._values[r]=new Ql(this._values[r].property,A===null?void 0:oe(A))}serialize(){let r={};for(let A of Object.keys(this._values)){let u=this.getValue(A);u!==void 0&&(r[A]=u)}return r}possiblyEvaluate(r,A,u){let f=new Gl(this._properties);for(let b of Object.keys(this._values))f._values[b]=this._values[b].possiblyEvaluate(r,A,u);return f}}class Fn{constructor(r,A,u){this.property=r,this.value=A,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,A,u,f){return this.property.evaluate(this.value,this.parameters,r,A,u,f)}}class Gl{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Fi{constructor(r){this.specification=r}possiblyEvaluate(r,A){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(A)}interpolate(r,A,u){let f=bn[this.specification.type];return f?f(r,A,u):r}}class Ni{constructor(r,A){this.specification=r,this.overrides=A}possiblyEvaluate(r,A,u,f){return new Fn(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(A,null,{},u,f)}:r.expression,A)}interpolate(r,A,u){if(r.value.kind!=="constant"||A.value.kind!=="constant")return r;if(r.value.value===void 0||A.value.value===void 0)return new Fn(this,{kind:"constant",value:void 0},r.parameters);let f=bn[this.specification.type];if(f){let b=f(r.value.value,A.value.value,u);return new Fn(this,{kind:"constant",value:b},r.parameters)}return r}evaluate(r,A,u,f,b,v){return r.kind==="constant"?r.value:r.evaluate(A,u,f,b,v)}}class il extends Ni{possiblyEvaluate(r,A,u,f){if(r.value===void 0)return new Fn(this,{kind:"constant",value:void 0},A);if(r.expression.kind==="constant"){let b=r.expression.evaluate(A,null,{},u,f),v=r.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,x=this._calculate(v,v,v,A);return new Fn(this,{kind:"constant",value:x},A)}if(r.expression.kind==="camera"){let b=this._calculate(r.expression.evaluate({zoom:A.zoom-1}),r.expression.evaluate({zoom:A.zoom}),r.expression.evaluate({zoom:A.zoom+1}),A);return new Fn(this,{kind:"constant",value:b},A)}return new Fn(this,r.expression,A)}evaluate(r,A,u,f,b,v){if(r.kind==="source"){let x=r.evaluate(A,u,f,b,v);return this._calculate(x,x,x,A)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(A.zoom)-1},u,f),r.evaluate({zoom:Math.floor(A.zoom)},u,f),r.evaluate({zoom:Math.floor(A.zoom)+1},u,f),A):r.value}_calculate(r,A,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:r,to:A}:{from:u,to:A}}interpolate(r){return r}}class _c{constructor(r){this.specification=r}possiblyEvaluate(r,A,u,f){if(r.value!==void 0){if(r.expression.kind==="constant"){let b=r.expression.evaluate(A,null,{},u,f);return this._calculate(b,b,b,A)}return this._calculate(r.expression.evaluate(new Yr(Math.floor(A.zoom-1),A)),r.expression.evaluate(new Yr(Math.floor(A.zoom),A)),r.expression.evaluate(new Yr(Math.floor(A.zoom+1),A)),A)}}_calculate(r,A,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:r,to:A}:{from:u,to:A}}interpolate(r){return r}}class xc{constructor(r){this.specification=r}possiblyEvaluate(r,A,u,f){return!!r.expression.evaluate(A,null,{},u,f)}interpolate(){return!1}}class yn{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let A in r){let u=r[A];u.specification.overridable&&this.overridableProperties.push(A);let f=this.defaultPropertyValues[A]=new Ql(u,void 0),b=this.defaultTransitionablePropertyValues[A]=new wc(u);this.defaultTransitioningPropertyValues[A]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[A]=f.possiblyEvaluate({})}}}li("DataDrivenProperty",Ni),li("DataConstantProperty",Fi),li("CrossFadedDataDrivenProperty",il),li("CrossFadedProperty",_c),li("ColorRampProperty",xc);let Mo="-transition";class Cn extends Ui{constructor(r,A){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),A.layout&&(this._unevaluatedLayout=new Bc(A.layout)),A.paint)){this._transitionablePaint=new du(A.paint);for(let u in r.paint)this.setPaintProperty(u,r.paint[u],{validate:!1});for(let u in r.layout)this.setLayoutProperty(u,r.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Gl(A.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,A,u={}){A!=null&&this._validate(fn,`layers.${this.id}.layout.${r}`,r,A,u)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,A):this.visibility=A)}getPaintProperty(r){return r.endsWith(Mo)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,A,u={}){if(A!=null&&this._validate(Vr,`layers.${this.id}.paint.${r}`,r,A,u))return!1;if(r.endsWith(Mo))return this._transitionablePaint.setTransition(r.slice(0,-11),A||void 0),!1;{let f=this._transitionablePaint._values[r],b=f.property.specification["property-type"]==="cross-faded-data-driven",v=f.value.isDataDriven(),x=f.value;this._transitionablePaint.setValue(r,A),this._handleSpecialPaintPropertyUpdate(r);let Q=this._transitionablePaint._values[r].value;return Q.isDataDriven()||v||b||this._handleOverridablePaintPropertyUpdate(r,x,Q)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,A,u){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,A){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,A)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,A)}serialize(){let r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),ee(r,(A,u)=>!(A===void 0||u==="layout"&&!Object.keys(A).length||u==="paint"&&!Object.keys(A).length))}_validate(r,A,u,f,b={}){return(!b||b.validate!==!1)&&mn(this,r.call(Vn,{key:A,layerType:this.type,objectKey:u,value:f,styleSpec:$t,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let r in this.paint._values){let A=this.paint.get(r);if(A instanceof Fn&&Ro(A.property.specification)&&(A.value.kind==="source"||A.value.kind==="composite")&&A.value.isStateDependent)return!0}return!1}}let Vo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Xa{constructor(r,A){this._structArray=r,this._pos1=A*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class rn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,A){return r._trim(),A&&(r.isTransferred=!0,A.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){let A=Object.create(this.prototype);return A.arrayBuffer=r.arrayBuffer,A.length=r.length,A.capacity=r.arrayBuffer.byteLength/A.bytesPerElement,A._refreshViews(),A}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let A=this.uint8;this._refreshViews(),A&&this.uint8.set(A)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Er(a,r=1){let A=0,u=0;return{members:a.map(f=>{let b=Vo[f.type].BYTES_PER_ELEMENT,v=A=Dn(A,Math.max(r,b)),x=f.components||1;return u=Math.max(u,b),A+=b*x,{name:f.name,type:f.type,components:x,offset:v}}),size:Dn(A,Math.max(u,r)),alignment:r}}function Dn(a,r){return Math.ceil(a/r)*r}class rl extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,A){let u=this.length;return this.resize(u+1),this.emplace(u,r,A)}emplace(r,A,u){let f=2*r;return this.int16[f+0]=A,this.int16[f+1]=u,r}}rl.prototype.bytesPerElement=4,li("StructArrayLayout2i4",rl);class nl extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,A,u){let f=this.length;return this.resize(f+1),this.emplace(f,r,A,u)}emplace(r,A,u,f){let b=3*r;return this.int16[b+0]=A,this.int16[b+1]=u,this.int16[b+2]=f,r}}nl.prototype.bytesPerElement=6,li("StructArrayLayout3i6",nl);class Sa extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,A,u,f){let b=this.length;return this.resize(b+1),this.emplace(b,r,A,u,f)}emplace(r,A,u,f,b){let v=4*r;return this.int16[v+0]=A,this.int16[v+1]=u,this.int16[v+2]=f,this.int16[v+3]=b,r}}Sa.prototype.bytesPerElement=8,li("StructArrayLayout4i8",Sa);class Rl extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,A,u,f,b,v){let x=this.length;return this.resize(x+1),this.emplace(x,r,A,u,f,b,v)}emplace(r,A,u,f,b,v,x){let Q=6*r;return this.int16[Q+0]=A,this.int16[Q+1]=u,this.int16[Q+2]=f,this.int16[Q+3]=b,this.int16[Q+4]=v,this.int16[Q+5]=x,r}}Rl.prototype.bytesPerElement=12,li("StructArrayLayout2i4i12",Rl);class Zl extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,A,u,f,b,v){let x=this.length;return this.resize(x+1),this.emplace(x,r,A,u,f,b,v)}emplace(r,A,u,f,b,v,x){let Q=4*r,Z=8*r;return this.int16[Q+0]=A,this.int16[Q+1]=u,this.uint8[Z+4]=f,this.uint8[Z+5]=b,this.uint8[Z+6]=v,this.uint8[Z+7]=x,r}}Zl.prototype.bytesPerElement=8,li("StructArrayLayout2i4ub8",Zl);class Ya extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,A){let u=this.length;return this.resize(u+1),this.emplace(u,r,A)}emplace(r,A,u){let f=2*r;return this.float32[f+0]=A,this.float32[f+1]=u,r}}Ya.prototype.bytesPerElement=8,li("StructArrayLayout2f8",Ya);class Sc extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,A,u,f,b,v,x,Q,Z,M){let J=this.length;return this.resize(J+1),this.emplace(J,r,A,u,f,b,v,x,Q,Z,M)}emplace(r,A,u,f,b,v,x,Q,Z,M,J){let it=10*r;return this.uint16[it+0]=A,this.uint16[it+1]=u,this.uint16[it+2]=f,this.uint16[it+3]=b,this.uint16[it+4]=v,this.uint16[it+5]=x,this.uint16[it+6]=Q,this.uint16[it+7]=Z,this.uint16[it+8]=M,this.uint16[it+9]=J,r}}Sc.prototype.bytesPerElement=20,li("StructArrayLayout10ui20",Sc);class EA extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,A,u,f,b,v,x,Q,Z,M,J,it){let ot=this.length;return this.resize(ot+1),this.emplace(ot,r,A,u,f,b,v,x,Q,Z,M,J,it)}emplace(r,A,u,f,b,v,x,Q,Z,M,J,it,ot){let at=12*r;return this.int16[at+0]=A,this.int16[at+1]=u,this.int16[at+2]=f,this.int16[at+3]=b,this.uint16[at+4]=v,this.uint16[at+5]=x,this.uint16[at+6]=Q,this.uint16[at+7]=Z,this.int16[at+8]=M,this.int16[at+9]=J,this.int16[at+10]=it,this.int16[at+11]=ot,r}}EA.prototype.bytesPerElement=24,li("StructArrayLayout4i4ui4i24",EA);class yr extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,A,u){let f=this.length;return this.resize(f+1),this.emplace(f,r,A,u)}emplace(r,A,u,f){let b=3*r;return this.float32[b+0]=A,this.float32[b+1]=u,this.float32[b+2]=f,r}}yr.prototype.bytesPerElement=12,li("StructArrayLayout3f12",yr);class I extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){let A=this.length;return this.resize(A+1),this.emplace(A,r)}emplace(r,A){return this.uint32[1*r+0]=A,r}}I.prototype.bytesPerElement=4,li("StructArrayLayout1ul4",I);class s extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,A,u,f,b,v,x,Q,Z){let M=this.length;return this.resize(M+1),this.emplace(M,r,A,u,f,b,v,x,Q,Z)}emplace(r,A,u,f,b,v,x,Q,Z,M){let J=10*r,it=5*r;return this.int16[J+0]=A,this.int16[J+1]=u,this.int16[J+2]=f,this.int16[J+3]=b,this.int16[J+4]=v,this.int16[J+5]=x,this.uint32[it+3]=Q,this.uint16[J+8]=Z,this.uint16[J+9]=M,r}}s.prototype.bytesPerElement=20,li("StructArrayLayout6i1ul2ui20",s);class c extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,A,u,f,b,v){let x=this.length;return this.resize(x+1),this.emplace(x,r,A,u,f,b,v)}emplace(r,A,u,f,b,v,x){let Q=6*r;return this.int16[Q+0]=A,this.int16[Q+1]=u,this.int16[Q+2]=f,this.int16[Q+3]=b,this.int16[Q+4]=v,this.int16[Q+5]=x,r}}c.prototype.bytesPerElement=12,li("StructArrayLayout2i2i2i12",c);class d extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,A,u,f,b){let v=this.length;return this.resize(v+1),this.emplace(v,r,A,u,f,b)}emplace(r,A,u,f,b,v){let x=4*r,Q=8*r;return this.float32[x+0]=A,this.float32[x+1]=u,this.float32[x+2]=f,this.int16[Q+6]=b,this.int16[Q+7]=v,r}}d.prototype.bytesPerElement=16,li("StructArrayLayout2f1f2i16",d);class C extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,A,u,f){let b=this.length;return this.resize(b+1),this.emplace(b,r,A,u,f)}emplace(r,A,u,f,b){let v=12*r,x=3*r;return this.uint8[v+0]=A,this.uint8[v+1]=u,this.float32[x+1]=f,this.float32[x+2]=b,r}}C.prototype.bytesPerElement=12,li("StructArrayLayout2ub2f12",C);class y extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,A,u){let f=this.length;return this.resize(f+1),this.emplace(f,r,A,u)}emplace(r,A,u,f){let b=3*r;return this.uint16[b+0]=A,this.uint16[b+1]=u,this.uint16[b+2]=f,r}}y.prototype.bytesPerElement=6,li("StructArrayLayout3ui6",y);class F extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,A,u,f,b,v,x,Q,Z,M,J,it,ot,at,Bt,Gt,Mt){let ne=this.length;return this.resize(ne+1),this.emplace(ne,r,A,u,f,b,v,x,Q,Z,M,J,it,ot,at,Bt,Gt,Mt)}emplace(r,A,u,f,b,v,x,Q,Z,M,J,it,ot,at,Bt,Gt,Mt,ne){let Yt=24*r,Ae=12*r,ye=48*r;return this.int16[Yt+0]=A,this.int16[Yt+1]=u,this.uint16[Yt+2]=f,this.uint16[Yt+3]=b,this.uint32[Ae+2]=v,this.uint32[Ae+3]=x,this.uint32[Ae+4]=Q,this.uint16[Yt+10]=Z,this.uint16[Yt+11]=M,this.uint16[Yt+12]=J,this.float32[Ae+7]=it,this.float32[Ae+8]=ot,this.uint8[ye+36]=at,this.uint8[ye+37]=Bt,this.uint8[ye+38]=Gt,this.uint32[Ae+10]=Mt,this.int16[Yt+22]=ne,r}}F.prototype.bytesPerElement=48,li("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",F);class L extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,A,u,f,b,v,x,Q,Z,M,J,it,ot,at,Bt,Gt,Mt,ne,Yt,Ae,ye,Ge,ci,Si,Ai,oi,ii,vi){let ni=this.length;return this.resize(ni+1),this.emplace(ni,r,A,u,f,b,v,x,Q,Z,M,J,it,ot,at,Bt,Gt,Mt,ne,Yt,Ae,ye,Ge,ci,Si,Ai,oi,ii,vi)}emplace(r,A,u,f,b,v,x,Q,Z,M,J,it,ot,at,Bt,Gt,Mt,ne,Yt,Ae,ye,Ge,ci,Si,Ai,oi,ii,vi,ni){let Oe=32*r,Hi=16*r;return this.int16[Oe+0]=A,this.int16[Oe+1]=u,this.int16[Oe+2]=f,this.int16[Oe+3]=b,this.int16[Oe+4]=v,this.int16[Oe+5]=x,this.int16[Oe+6]=Q,this.int16[Oe+7]=Z,this.uint16[Oe+8]=M,this.uint16[Oe+9]=J,this.uint16[Oe+10]=it,this.uint16[Oe+11]=ot,this.uint16[Oe+12]=at,this.uint16[Oe+13]=Bt,this.uint16[Oe+14]=Gt,this.uint16[Oe+15]=Mt,this.uint16[Oe+16]=ne,this.uint16[Oe+17]=Yt,this.uint16[Oe+18]=Ae,this.uint16[Oe+19]=ye,this.uint16[Oe+20]=Ge,this.uint16[Oe+21]=ci,this.uint16[Oe+22]=Si,this.uint32[Hi+12]=Ai,this.float32[Hi+13]=oi,this.float32[Hi+14]=ii,this.uint16[Oe+30]=vi,this.uint16[Oe+31]=ni,r}}L.prototype.bytesPerElement=64,li("StructArrayLayout8i15ui1ul2f2ui64",L);class R extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){let A=this.length;return this.resize(A+1),this.emplace(A,r)}emplace(r,A){return this.float32[1*r+0]=A,r}}R.prototype.bytesPerElement=4,li("StructArrayLayout1f4",R);class N extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,A,u){let f=this.length;return this.resize(f+1),this.emplace(f,r,A,u)}emplace(r,A,u,f){let b=3*r;return this.uint16[6*r+0]=A,this.float32[b+1]=u,this.float32[b+2]=f,r}}N.prototype.bytesPerElement=12,li("StructArrayLayout1ui2f12",N);class D extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,A,u){let f=this.length;return this.resize(f+1),this.emplace(f,r,A,u)}emplace(r,A,u,f){let b=4*r;return this.uint32[2*r+0]=A,this.uint16[b+2]=u,this.uint16[b+3]=f,r}}D.prototype.bytesPerElement=8,li("StructArrayLayout1ul2ui8",D);class W extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,A){let u=this.length;return this.resize(u+1),this.emplace(u,r,A)}emplace(r,A,u){let f=2*r;return this.uint16[f+0]=A,this.uint16[f+1]=u,r}}W.prototype.bytesPerElement=4,li("StructArrayLayout2ui4",W);class st extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){let A=this.length;return this.resize(A+1),this.emplace(A,r)}emplace(r,A){return this.uint16[1*r+0]=A,r}}st.prototype.bytesPerElement=2,li("StructArrayLayout1ui2",st);class wt extends rn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,A,u,f){let b=this.length;return this.resize(b+1),this.emplace(b,r,A,u,f)}emplace(r,A,u,f,b){let v=4*r;return this.float32[v+0]=A,this.float32[v+1]=u,this.float32[v+2]=f,this.float32[v+3]=b,r}}wt.prototype.bytesPerElement=16,li("StructArrayLayout4f16",wt);class yt extends Xa{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new _(this.anchorPointX,this.anchorPointY)}}yt.prototype.size=20;class kt extends s{get(r){return new yt(this,r)}}li("CollisionBoxArray",kt);class p extends Xa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}p.prototype.size=48;class w extends F{get(r){return new p(this,r)}}li("PlacedSymbolArray",w);class k extends Xa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}k.prototype.size=64;class T extends L{get(r){return new k(this,r)}}li("SymbolInstanceArray",T);class H extends R{getoffsetX(r){return this.float32[1*r+0]}}li("GlyphOffsetArray",H);class V extends nl{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}li("SymbolLineVertexArray",V);class K extends Xa{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}K.prototype.size=12;class X extends N{get(r){return new K(this,r)}}li("TextAnchorOffsetArray",X);class $ extends Xa{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}$.prototype.size=8;class nt extends D{get(r){return new $(this,r)}}li("FeatureIndexArray",nt);class Ct extends rl{}class zt extends rl{}class re extends rl{}class Tt extends Rl{}class pe extends Zl{}class te extends Ya{}class Ot extends Sc{}class Wt extends EA{}class Ie extends yr{}class we extends I{}class Le extends c{}class je extends C{}class $e extends y{}class wi extends W{}let qe=Er([{name:"a_pos",components:2,type:"Int16"}],4),{members:ar}=qe;class Vi{constructor(r=[]){this.segments=r}prepareSegment(r,A,u,f){let b=this.segments[this.segments.length-1];return r>Vi.MAX_VERTEX_ARRAY_LENGTH&&At(`Max vertices per segment is ${Vi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!b||b.vertexLength+r>Vi.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==f)&&(b={vertexOffset:A.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},f!==void 0&&(b.sortKey=f),this.segments.push(b)),b}get(){return this.segments}destroy(){for(let r of this.segments)for(let A in r.vaos)r.vaos[A].destroy()}static simpleSegment(r,A,u,f){return new Vi([{vertexOffset:r,primitiveOffset:A,vertexLength:u,primitiveLength:f,vaos:{},sortKey:0}])}}function lr(a,r){return 256*(a=Et(Math.floor(a),0,255))+Et(Math.floor(r),0,255)}Vi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,li("SegmentVector",Vi);let rr=Er([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Br={exports:{}},_r={exports:{}};_r.exports=function(a,r){var A,u,f,b,v,x,Q,Z;for(u=a.length-(A=3&a.length),f=r,v=3432918353,x=461845907,Z=0;Z<u;)Q=255&a.charCodeAt(Z)|(255&a.charCodeAt(++Z))<<8|(255&a.charCodeAt(++Z))<<16|(255&a.charCodeAt(++Z))<<24,++Z,f=27492+(65535&(b=5*(65535&(f=(f^=Q=(65535&(Q=(Q=(65535&Q)*v+(((Q>>>16)*v&65535)<<16)&4294967295)<<15|Q>>>17))*x+(((Q>>>16)*x&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(Q=0,A){case 3:Q^=(255&a.charCodeAt(Z+2))<<16;case 2:Q^=(255&a.charCodeAt(Z+1))<<8;case 1:f^=Q=(65535&(Q=(Q=(65535&(Q^=255&a.charCodeAt(Z)))*v+(((Q>>>16)*v&65535)<<16)&4294967295)<<15|Q>>>17))*x+(((Q>>>16)*x&65535)<<16)&4294967295}return f^=a.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var er=_r.exports,wr={exports:{}};wr.exports=function(a,r){for(var A,u=a.length,f=r^u,b=0;u>=4;)A=1540483477*(65535&(A=255&a.charCodeAt(b)|(255&a.charCodeAt(++b))<<8|(255&a.charCodeAt(++b))<<16|(255&a.charCodeAt(++b))<<24))+((1540483477*(A>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(A=1540483477*(65535&(A^=A>>>24))+((1540483477*(A>>>16)&65535)<<16)),u-=4,++b;switch(u){case 3:f^=(255&a.charCodeAt(b+2))<<16;case 2:f^=(255&a.charCodeAt(b+1))<<8;case 1:f=1540483477*(65535&(f^=255&a.charCodeAt(b)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var Zr=er,xr=wr.exports;Br.exports=Zr,Br.exports.murmur3=Zr,Br.exports.murmur2=xr;var Bn=h(Br.exports);class Yi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,A,u,f){this.ids.push(Tr(r)),this.positions.push(A,u,f)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let A=Tr(r),u=0,f=this.ids.length-1;for(;u<f;){let v=u+f>>1;this.ids[v]>=A?f=v:u=v+1}let b=[];for(;this.ids[u]===A;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b}static serialize(r,A){let u=new Float64Array(r.ids),f=new Uint32Array(r.positions);return jr(u,f,0,u.length-1),A&&A.push(u.buffer,f.buffer),{ids:u,positions:f}}static deserialize(r){let A=new Yi;return A.ids=r.ids,A.positions=r.positions,A.indexed=!0,A}}function Tr(a){let r=+a;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:Bn(String(a))}function jr(a,r,A,u){for(;A<u;){let f=a[A+u>>1],b=A-1,v=u+1;for(;;){do b++;while(a[b]<f);do v--;while(a[v]>f);if(b>=v)break;dr(a,b,v),dr(r,3*b,3*v),dr(r,3*b+1,3*v+1),dr(r,3*b+2,3*v+2)}v-A<u-v?(jr(a,r,A,v),A=v+1):(jr(a,r,v+1,u),u=v)}}function dr(a,r,A){let u=a[r];a[r]=a[A],a[A]=u}li("FeaturePositionMap",Yi);class ln{constructor(r,A){this.gl=r.gl,this.location=A}}class Gn extends ln{constructor(r,A){super(r,A),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class Ps extends ln{constructor(r,A){super(r,A),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class mo extends ln{constructor(r,A){super(r,A),this.current=qi.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}let Rn=new Float32Array(16);function Co(a){return[lr(255*a.r,255*a.g),lr(255*a.b,255*a.a)]}class As{constructor(r,A,u){this.value=r,this.uniformNames=A.map(f=>`u_${f}`),this.type=u}setUniform(r,A,u){r.set(u.constantOr(this.value))}getBinding(r,A,u){return this.type==="color"?new mo(r,A):new Gn(r,A)}}class qs{constructor(r,A){this.uniformNames=A.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,A){this.pixelRatioFrom=A.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=A.tlbr,this.patternTo=r.tlbr}setUniform(r,A,u,f){let b=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&r.set(b)}getBinding(r,A,u){return u.substr(0,9)==="u_pattern"?new Ps(r,A):new Gn(r,A)}}class Kn{constructor(r,A,u,f){this.expression=r,this.type=u,this.maxValue=0,this.paintVertexAttributes=A.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(r,A,u,f,b){let v=this.paintVertexArray.length,x=this.expression.evaluate(new Yr(0),A,{},f,[],b);this.paintVertexArray.resize(r),this._setPaintValue(v,r,x)}updatePaintArray(r,A,u,f){let b=this.expression.evaluate({zoom:0},u,f);this._setPaintValue(r,A,b)}_setPaintValue(r,A,u){if(this.type==="color"){let f=Co(u);for(let b=r;b<A;b++)this.paintVertexArray.emplace(b,f[0],f[1])}else{for(let f=r;f<A;f++)this.paintVertexArray.emplace(f,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Sr{constructor(r,A,u,f,b,v){this.expression=r,this.uniformNames=A.map(x=>`u_${x}_t`),this.type=u,this.useIntegerZoom=f,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=A.map(x=>({name:`a_${x}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(r,A,u,f,b){let v=this.expression.evaluate(new Yr(this.zoom),A,{},f,[],b),x=this.expression.evaluate(new Yr(this.zoom+1),A,{},f,[],b),Q=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(Q,r,v,x)}updatePaintArray(r,A,u,f){let b=this.expression.evaluate({zoom:this.zoom},u,f),v=this.expression.evaluate({zoom:this.zoom+1},u,f);this._setPaintValue(r,A,b,v)}_setPaintValue(r,A,u,f){if(this.type==="color"){let b=Co(u),v=Co(f);for(let x=r;x<A;x++)this.paintVertexArray.emplace(x,b[0],b[1],v[0],v[1])}else{for(let b=r;b<A;b++)this.paintVertexArray.emplace(b,u,f);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(f))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,A){let u=this.useIntegerZoom?Math.floor(A.zoom):A.zoom,f=Et(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);r.set(f)}getBinding(r,A,u){return new Gn(r,A)}}class $s{constructor(r,A,u,f,b,v){this.expression=r,this.type=A,this.useIntegerZoom=u,this.zoom=f,this.layerId=v,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(r,A,u){let f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(f,r,A.patterns&&A.patterns[this.layerId],u)}updatePaintArray(r,A,u,f,b){this._setPaintValues(r,A,u.patterns&&u.patterns[this.layerId],b)}_setPaintValues(r,A,u,f){if(!f||!u)return;let{min:b,mid:v,max:x}=u,Q=f[b],Z=f[v],M=f[x];if(Q&&Z&&M)for(let J=r;J<A;J++)this.zoomInPaintVertexArray.emplace(J,Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],Q.tl[0],Q.tl[1],Q.br[0],Q.br[1],Z.pixelRatio,Q.pixelRatio),this.zoomOutPaintVertexArray.emplace(J,Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],Z.pixelRatio,M.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,rr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,rr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Hl{constructor(r,A,u){this.binders={},this._buffers=[];let f=[];for(let b in r.paint._values){if(!u(b))continue;let v=r.paint.get(b);if(!(v instanceof Fn&&Ro(v.property.specification)))continue;let x=fu(b,r.type),Q=v.value,Z=v.property.specification.type,M=v.property.useIntegerZoom,J=v.property.specification["property-type"],it=J==="cross-faded"||J==="cross-faded-data-driven";if(Q.kind==="constant")this.binders[b]=it?new qs(Q.value,x):new As(Q.value,x,Z),f.push(`/u_${b}`);else if(Q.kind==="source"||it){let ot=Nl(b,Z,"source");this.binders[b]=it?new $s(Q,Z,M,A,ot,r.id):new Kn(Q,x,Z,ot),f.push(`/a_${b}`)}else{let ot=Nl(b,Z,"composite");this.binders[b]=new Sr(Q,x,Z,M,A,ot),f.push(`/z_${b}`)}}this.cacheKey=f.sort().join("")}getMaxValue(r){let A=this.binders[r];return A instanceof Kn||A instanceof Sr?A.maxValue:0}populatePaintArrays(r,A,u,f,b){for(let v in this.binders){let x=this.binders[v];(x instanceof Kn||x instanceof Sr||x instanceof $s)&&x.populatePaintArray(r,A,u,f,b)}}setConstantPatternPositions(r,A){for(let u in this.binders){let f=this.binders[u];f instanceof qs&&f.setConstantPatternPositions(r,A)}}updatePaintArrays(r,A,u,f,b){let v=!1;for(let x in r){let Q=A.getPositions(x);for(let Z of Q){let M=u.feature(Z.index);for(let J in this.binders){let it=this.binders[J];if((it instanceof Kn||it instanceof Sr||it instanceof $s)&&it.expression.isStateDependent===!0){let ot=f.paint.get(J);it.expression=ot.value,it.updatePaintArray(Z.start,Z.end,M,r[x],b),v=!0}}}}return v}defines(){let r=[];for(let A in this.binders){let u=this.binders[A];(u instanceof As||u instanceof qs)&&r.push(...u.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return r}getBinderAttributes(){let r=[];for(let A in this.binders){let u=this.binders[A];if(u instanceof Kn||u instanceof Sr)for(let f=0;f<u.paintVertexAttributes.length;f++)r.push(u.paintVertexAttributes[f].name);else if(u instanceof $s)for(let f=0;f<rr.members.length;f++)r.push(rr.members[f].name)}return r}getBinderUniforms(){let r=[];for(let A in this.binders){let u=this.binders[A];if(u instanceof As||u instanceof qs||u instanceof Sr)for(let f of u.uniformNames)r.push(f)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,A){let u=[];for(let f in this.binders){let b=this.binders[f];if(b instanceof As||b instanceof qs||b instanceof Sr){for(let v of b.uniformNames)if(A[v]){let x=b.getBinding(r,A[v],v);u.push({name:v,property:f,binding:x})}}}return u}setUniforms(r,A,u,f){for(let{name:b,property:v,binding:x}of A)this.binders[v].setUniform(x,f,u.get(v),b)}updatePaintBuffers(r){this._buffers=[];for(let A in this.binders){let u=this.binders[A];if(r&&u instanceof $s){let f=r.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(u instanceof Kn||u instanceof Sr)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(r){for(let A in this.binders){let u=this.binders[A];(u instanceof Kn||u instanceof Sr||u instanceof $s)&&u.upload(r)}this.updatePaintBuffers()}destroy(){for(let r in this.binders){let A=this.binders[r];(A instanceof Kn||A instanceof Sr||A instanceof $s)&&A.destroy()}}}class Do{constructor(r,A,u=()=>!0){this.programConfigurations={};for(let f of r)this.programConfigurations[f.id]=new Hl(f,A,u);this.needsUpload=!1,this._featureMap=new Yi,this._bufferOffset=0}populatePaintArrays(r,A,u,f,b,v){for(let x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(r,A,f,b,v);A.id!==void 0&&this._featureMap.add(A.id,u,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,A,u,f){for(let b of u)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(r,this._featureMap,A,b,f)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(let A in this.programConfigurations)this.programConfigurations[A].upload(r);this.needsUpload=!1}}destroy(){for(let r in this.programConfigurations)this.programConfigurations[r].destroy()}}function fu(a,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${r}-`,"").replace(/-/g,"_")]}function Nl(a,r,A){let u={color:{source:Ya,composite:wt},number:{source:R,composite:Ya}},f=function(b){return{"line-pattern":{source:Ot,composite:Ot},"fill-pattern":{source:Ot,composite:Ot},"fill-extrusion-pattern":{source:Ot,composite:Ot}}[b]}(a);return f&&f[A]||u[r][A]}li("ConstantBinder",As),li("CrossFadedConstantBinder",qs),li("SourceExpressionBinder",Kn),li("CrossFadedCompositeBinder",$s),li("CompositeExpressionBinder",Sr),li("ProgramConfiguration",Hl,{omit:["_buffers"]}),li("ProgramConfigurationSet",Do);let cn=8192,Io=Math.pow(2,14)-1,sl=-Io-1;function Ko(a){let r=cn/a.extent,A=a.loadGeometry();for(let u=0;u<A.length;u++){let f=A[u];for(let b=0;b<f.length;b++){let v=f[b],x=Math.round(v.x*r),Q=Math.round(v.y*r);v.x=Et(x,sl,Io),v.y=Et(Q,sl,Io),(x<v.x||x>v.x+1||Q<v.y||Q>v.y+1)&&At("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return A}function TA(a,r){return{type:a.type,id:a.id,properties:a.properties,geometry:r?Ko(a):[]}}function ol(a,r,A,u,f){a.emplaceBack(2*r+(u+1)/2,2*A+(f+1)/2)}class mu{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(A=>A.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new zt,this.indexArray=new $e,this.segments=new Vi,this.programConfigurations=new Do(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id)}populate(r,A,u){let f=this.layers[0],b=[],v=null,x=!1;f.type==="circle"&&(v=f.layout.get("circle-sort-key"),x=!v.isConstant());for(let{feature:Q,id:Z,index:M,sourceLayerIndex:J}of r){let it=this.layers[0]._featureFilter.needGeometry,ot=TA(Q,it);if(!this.layers[0]._featureFilter.filter(new Yr(this.zoom),ot,u))continue;let at=x?v.evaluate(ot,{},u):void 0,Bt={id:Z,properties:Q.properties,type:Q.type,sourceLayerIndex:J,index:M,geometry:it?ot.geometry:Ko(Q),patterns:{},sortKey:at};b.push(Bt)}x&&b.sort((Q,Z)=>Q.sortKey-Z.sortKey);for(let Q of b){let{geometry:Z,index:M,sourceLayerIndex:J}=Q,it=r[M].feature;this.addFeature(Q,Z,M,u),A.featureIndex.insert(it,Z,M,J,this.index)}}update(r,A,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,A,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ar),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,A,u,f){for(let b of A)for(let v of b){let x=v.x,Q=v.y;if(x<0||x>=cn||Q<0||Q>=cn)continue;let Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),M=Z.vertexLength;ol(this.layoutVertexArray,x,Q,-1,-1),ol(this.layoutVertexArray,x,Q,1,-1),ol(this.layoutVertexArray,x,Q,1,1),ol(this.layoutVertexArray,x,Q,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+3,M+2),Z.vertexLength+=4,Z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,{},f)}}function Fc(a,r){for(let A=0;A<a.length;A++)if(Pl(r,a[A]))return!0;for(let A=0;A<r.length;A++)if(Pl(a,r[A]))return!0;return!!Ih(a,r)}function Ch(a,r,A){return!!Pl(a,r)||!!Ec(r,a,A)}function kc(a,r){if(a.length===1)return ed(r,a[0]);for(let A=0;A<r.length;A++){let u=r[A];for(let f=0;f<u.length;f++)if(Pl(a,u[f]))return!0}for(let A=0;A<a.length;A++)if(ed(r,a[A]))return!0;for(let A=0;A<r.length;A++)if(Ih(a,r[A]))return!0;return!1}function Lc(a,r,A){if(a.length>1){if(Ih(a,r))return!0;for(let u=0;u<r.length;u++)if(Ec(r[u],a,A))return!0}for(let u=0;u<a.length;u++)if(Ec(a[u],r,A))return!0;return!1}function Ih(a,r){if(a.length===0||r.length===0)return!1;for(let A=0;A<a.length-1;A++){let u=a[A],f=a[A+1];for(let b=0;b<r.length-1;b++)if(hm(u,f,r[b],r[b+1]))return!0}return!1}function hm(a,r,A,u){return Ft(a,A,u)!==Ft(r,A,u)&&Ft(a,r,A)!==Ft(a,r,u)}function Ec(a,r,A){let u=A*A;if(r.length===1)return a.distSqr(r[0])<u;for(let f=1;f<r.length;f++)if(ja(a,r[f-1],r[f])<u)return!0;return!1}function ja(a,r,A){let u=r.distSqr(A);if(u===0)return a.distSqr(r);let f=((a.x-r.x)*(A.x-r.x)+(a.y-r.y)*(A.y-r.y))/u;return a.distSqr(f<0?r:f>1?A:A.sub(r)._mult(f)._add(r))}function ed(a,r){let A,u,f,b=!1;for(let v=0;v<a.length;v++){A=a[v];for(let x=0,Q=A.length-1;x<A.length;Q=x++)u=A[x],f=A[Q],u.y>r.y!=f.y>r.y&&r.x<(f.x-u.x)*(r.y-u.y)/(f.y-u.y)+u.x&&(b=!b)}return b}function Pl(a,r){let A=!1;for(let u=0,f=a.length-1;u<a.length;f=u++){let b=a[u],v=a[f];b.y>r.y!=v.y>r.y&&r.x<(v.x-b.x)*(r.y-b.y)/(v.y-b.y)+b.x&&(A=!A)}return A}function gm(a,r,A){let u=A[0],f=A[2];if(a.x<u.x&&r.x<u.x||a.x>f.x&&r.x>f.x||a.y<u.y&&r.y<u.y||a.y>f.y&&r.y>f.y)return!1;let b=Ft(a,r,A[0]);return b!==Ft(a,r,A[1])||b!==Ft(a,r,A[2])||b!==Ft(a,r,A[3])}function Ml(a,r,A){let u=r.paint.get(a).value;return u.kind==="constant"?u.value:A.programConfigurations.get(r.id).getMaxValue(a)}function al(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Tc(a,r,A,u,f){if(!r[0]&&!r[1])return a;let b=_.convert(r)._mult(f);A==="viewport"&&b._rotate(-u);let v=[];for(let x=0;x<a.length;x++)v.push(a[x].sub(b));return v}let yh,Qc;li("CircleBucket",mu,{omit:["layers"]});var bh={get paint(){return Qc=Qc||new yn({"circle-radius":new Ni($t.paint_circle["circle-radius"]),"circle-color":new Ni($t.paint_circle["circle-color"]),"circle-blur":new Ni($t.paint_circle["circle-blur"]),"circle-opacity":new Ni($t.paint_circle["circle-opacity"]),"circle-translate":new Fi($t.paint_circle["circle-translate"]),"circle-translate-anchor":new Fi($t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Fi($t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Fi($t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ni($t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ni($t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ni($t.paint_circle["circle-stroke-opacity"])})},get layout(){return yh=yh||new yn({"circle-sort-key":new Ni($t.layout_circle["circle-sort-key"])})}},Zn=1e-6,Al=typeof Float32Array<"u"?Float32Array:Array;function vh(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Uc(a,r,A){var u=r[0],f=r[1],b=r[2],v=r[3],x=r[4],Q=r[5],Z=r[6],M=r[7],J=r[8],it=r[9],ot=r[10],at=r[11],Bt=r[12],Gt=r[13],Mt=r[14],ne=r[15],Yt=A[0],Ae=A[1],ye=A[2],Ge=A[3];return a[0]=Yt*u+Ae*x+ye*J+Ge*Bt,a[1]=Yt*f+Ae*Q+ye*it+Ge*Gt,a[2]=Yt*b+Ae*Z+ye*ot+Ge*Mt,a[3]=Yt*v+Ae*M+ye*at+Ge*ne,a[4]=(Yt=A[4])*u+(Ae=A[5])*x+(ye=A[6])*J+(Ge=A[7])*Bt,a[5]=Yt*f+Ae*Q+ye*it+Ge*Gt,a[6]=Yt*b+Ae*Z+ye*ot+Ge*Mt,a[7]=Yt*v+Ae*M+ye*at+Ge*ne,a[8]=(Yt=A[8])*u+(Ae=A[9])*x+(ye=A[10])*J+(Ge=A[11])*Bt,a[9]=Yt*f+Ae*Q+ye*it+Ge*Gt,a[10]=Yt*b+Ae*Z+ye*ot+Ge*Mt,a[11]=Yt*v+Ae*M+ye*at+Ge*ne,a[12]=(Yt=A[12])*u+(Ae=A[13])*x+(ye=A[14])*J+(Ge=A[15])*Bt,a[13]=Yt*f+Ae*Q+ye*it+Ge*Gt,a[14]=Yt*b+Ae*Z+ye*ot+Ge*Mt,a[15]=Yt*v+Ae*M+ye*at+Ge*ne,a}Math.hypot||(Math.hypot=function(){for(var a=0,r=arguments.length;r--;)a+=arguments[r]*arguments[r];return Math.sqrt(a)});var Vl,wh=Uc;function ca(a,r,A){var u=r[0],f=r[1],b=r[2],v=r[3];return a[0]=A[0]*u+A[4]*f+A[8]*b+A[12]*v,a[1]=A[1]*u+A[5]*f+A[9]*b+A[13]*v,a[2]=A[2]*u+A[6]*f+A[10]*b+A[14]*v,a[3]=A[3]*u+A[7]*f+A[11]*b+A[15]*v,a}Vl=new Al(4),Al!=Float32Array&&(Vl[0]=0,Vl[1]=0,Vl[2]=0,Vl[3]=0);class id extends Cn{constructor(r){super(r,bh)}createBucket(r){return new mu(r)}queryRadius(r){let A=r;return Ml("circle-radius",this,A)+Ml("circle-stroke-width",this,A)+al(this.paint.get("circle-translate"))}queryIntersectsFeature(r,A,u,f,b,v,x,Q){let Z=Tc(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,x),M=this.paint.get("circle-radius").evaluate(A,u)+this.paint.get("circle-stroke-width").evaluate(A,u),J=this.paint.get("circle-pitch-alignment")==="map",it=J?Z:function(at,Bt){return at.map(Gt=>Bh(Gt,Bt))}(Z,Q),ot=J?M*x:M;for(let at of f)for(let Bt of at){let Gt=J?Bt:Bh(Bt,Q),Mt=ot,ne=ca([],[Bt.x,Bt.y,0,1],Q);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Mt*=ne[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Mt*=v.cameraToCenterDistance/ne[3]),Ch(it,Gt,Mt))return!0}return!1}}function Bh(a,r){let A=ca([],[a.x,a.y,0,1],r);return new _(A[0]/A[3],A[1]/A[3])}class rd extends mu{}let _h;li("HeatmapBucket",rd,{omit:["layers"]});var Dl={get paint(){return _h=_h||new yn({"heatmap-radius":new Ni($t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ni($t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Fi($t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new xc($t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Fi($t.paint_heatmap["heatmap-opacity"])})}};function xh(a,{width:r,height:A},u,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==r*A*u)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${r*A*u}`)}else f=new Uint8Array(r*A*u);return a.width=r,a.height=A,a.data=f,a}function Sh(a,{width:r,height:A},u){if(r===a.width&&A===a.height)return;let f=xh({},{width:r,height:A},u);Fh(a,f,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,r),height:Math.min(a.height,A)},u),a.width=r,a.height=A,a.data=f.data}function Fh(a,r,A,u,f,b){if(f.width===0||f.height===0)return r;if(f.width>a.width||f.height>a.height||A.x>a.width-f.width||A.y>a.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>r.width||f.height>r.height||u.x>r.width-f.width||u.y>r.height-f.height)throw new RangeError("out of range destination coordinates for image copy");let v=a.data,x=r.data;if(v===x)throw new Error("srcData equals dstData, so image is already copied");for(let Q=0;Q<f.height;Q++){let Z=((A.y+Q)*a.width+A.x)*b,M=((u.y+Q)*r.width+u.x)*b;for(let J=0;J<f.width*b;J++)x[M+J]=v[Z+J]}return r}class Kl{constructor(r,A){xh(this,r,1,A)}resize(r){Sh(this,r,1)}clone(){return new Kl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,A,u,f,b){Fh(r,A,u,f,b,1)}}class yo{constructor(r,A){xh(this,r,4,A)}resize(r){Sh(this,r,4)}replace(r,A){A?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new yo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,A,u,f,b){Fh(r,A,u,f,b,4)}}function Ol(a){let r={},A=a.resolution||256,u=a.clips?a.clips.length:1,f=a.image||new yo({width:A,height:u});if(Math.log(A)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${A}`);let b=(v,x,Q)=>{r[a.evaluationKey]=Q;let Z=a.expression.evaluate(r);f.data[v+x+0]=Math.floor(255*Z.r/Z.a),f.data[v+x+1]=Math.floor(255*Z.g/Z.a),f.data[v+x+2]=Math.floor(255*Z.b/Z.a),f.data[v+x+3]=Math.floor(255*Z.a)};if(a.clips)for(let v=0,x=0;v<u;++v,x+=4*A)for(let Q=0,Z=0;Q<A;Q++,Z+=4){let M=Q/(A-1),{start:J,end:it}=a.clips[v];b(x,Z,J*(1-M)+it*M)}else for(let v=0,x=0;v<A;v++,x+=4)b(0,x,v/(A-1));return f}li("AlphaImage",Kl),li("RGBAImage",yo);class kh extends Cn{createBucket(r){return new rd(r)}constructor(r){super(r,Dl),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ol({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Gc;var qa={get paint(){return Gc=Gc||new yn({"hillshade-illumination-direction":new Fi($t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Fi($t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Fi($t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Fi($t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Fi($t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Fi($t.paint_hillshade["hillshade-accent-color"])})}};class QA extends Cn{constructor(r){super(r,qa)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let UA=Er([{name:"a_pos",components:2,type:"Int16"}],4),{members:Cu}=UA;var Rc={exports:{}};function Zc(a,r,A){A=A||2;var u,f,b,v,x,Q,Z,M=r&&r.length,J=M?r[0]*A:a.length,it=nd(a,0,J,A,!0),ot=[];if(!it||it.next===it.prev)return ot;if(M&&(it=function(Bt,Gt,Mt,ne){var Yt,Ae,ye,Ge=[];for(Yt=0,Ae=Gt.length;Yt<Ae;Yt++)(ye=nd(Bt,Gt[Yt]*ne,Yt<Ae-1?Gt[Yt+1]*ne:Bt.length,ne,!1))===ye.next&&(ye.steiner=!0),Ge.push(cS(ye));for(Ge.sort(aS),Yt=0;Yt<Ge.length;Yt++)Mt=AS(Ge[Yt],Mt);return Mt}(a,r,it,A)),a.length>80*A){u=b=a[0],f=v=a[1];for(var at=A;at<J;at+=A)(x=a[at])<u&&(u=x),(Q=a[at+1])<f&&(f=Q),x>b&&(b=x),Q>v&&(v=Q);Z=(Z=Math.max(b-u,v-f))!==0?32767/Z:0}return ll(it,ot,A,u,f,Z,0),ot}function nd(a,r,A,u,f){var b,v;if(f===fm(a,r,A,u)>0)for(b=r;b<A;b+=u)v=$y(b,a[b],a[b+1],v);else for(b=A-u;b>=r;b-=u)v=$y(b,a[b],a[b+1],v);return v&&sd(v,v.next)&&(Eh(v),v=v.next),v}function $a(a,r){if(!a)return a;r||(r=a);var A,u=a;do if(A=!1,u.steiner||!sd(u,u.next)&&kn(u.prev,u,u.next)!==0)u=u.next;else{if(Eh(u),(u=r=u.prev)===u.next)break;A=!0}while(A||u!==r);return r}function ll(a,r,A,u,f,b,v){if(a){!v&&b&&function(M,J,it,ot){var at=M;do at.z===0&&(at.z=dm(at.x,at.y,J,it,ot)),at.prevZ=at.prev,at.nextZ=at.next,at=at.next;while(at!==M);at.prevZ.nextZ=null,at.prevZ=null,function(Bt){var Gt,Mt,ne,Yt,Ae,ye,Ge,ci,Si=1;do{for(Mt=Bt,Bt=null,Ae=null,ye=0;Mt;){for(ye++,ne=Mt,Ge=0,Gt=0;Gt<Si&&(Ge++,ne=ne.nextZ);Gt++);for(ci=Si;Ge>0||ci>0&&ne;)Ge!==0&&(ci===0||!ne||Mt.z<=ne.z)?(Yt=Mt,Mt=Mt.nextZ,Ge--):(Yt=ne,ne=ne.nextZ,ci--),Ae?Ae.nextZ=Yt:Bt=Yt,Yt.prevZ=Ae,Ae=Yt;Mt=ne}Ae.nextZ=null,Si*=2}while(ye>1)}(at)}(a,u,f,b);for(var x,Q,Z=a;a.prev!==a.next;)if(x=a.prev,Q=a.next,b?nS(a,u,f,b):rS(a))r.push(x.i/A|0),r.push(a.i/A|0),r.push(Q.i/A|0),Eh(a),a=Q.next,Z=Q.next;else if((a=Q)===Z){v?v===1?ll(a=sS($a(a),r,A),r,A,u,f,b,2):v===2&&oS(a,r,A,u,f,b):ll($a(a),r,A,u,f,b,1);break}}}function rS(a){var r=a.prev,A=a,u=a.next;if(kn(r,A,u)>=0)return!1;for(var f=r.x,b=A.x,v=u.x,x=r.y,Q=A.y,Z=u.y,M=f<b?f<v?f:v:b<v?b:v,J=x<Q?x<Z?x:Z:Q<Z?Q:Z,it=f>b?f>v?f:v:b>v?b:v,ot=x>Q?x>Z?x:Z:Q>Z?Q:Z,at=u.next;at!==r;){if(at.x>=M&&at.x<=it&&at.y>=J&&at.y<=ot&&Iu(f,x,b,Q,v,Z,at.x,at.y)&&kn(at.prev,at,at.next)>=0)return!1;at=at.next}return!0}function nS(a,r,A,u){var f=a.prev,b=a,v=a.next;if(kn(f,b,v)>=0)return!1;for(var x=f.x,Q=b.x,Z=v.x,M=f.y,J=b.y,it=v.y,ot=x<Q?x<Z?x:Z:Q<Z?Q:Z,at=M<J?M<it?M:it:J<it?J:it,Bt=x>Q?x>Z?x:Z:Q>Z?Q:Z,Gt=M>J?M>it?M:it:J>it?J:it,Mt=dm(ot,at,r,A,u),ne=dm(Bt,Gt,r,A,u),Yt=a.prevZ,Ae=a.nextZ;Yt&&Yt.z>=Mt&&Ae&&Ae.z<=ne;){if(Yt.x>=ot&&Yt.x<=Bt&&Yt.y>=at&&Yt.y<=Gt&&Yt!==f&&Yt!==v&&Iu(x,M,Q,J,Z,it,Yt.x,Yt.y)&&kn(Yt.prev,Yt,Yt.next)>=0||(Yt=Yt.prevZ,Ae.x>=ot&&Ae.x<=Bt&&Ae.y>=at&&Ae.y<=Gt&&Ae!==f&&Ae!==v&&Iu(x,M,Q,J,Z,it,Ae.x,Ae.y)&&kn(Ae.prev,Ae,Ae.next)>=0))return!1;Ae=Ae.nextZ}for(;Yt&&Yt.z>=Mt;){if(Yt.x>=ot&&Yt.x<=Bt&&Yt.y>=at&&Yt.y<=Gt&&Yt!==f&&Yt!==v&&Iu(x,M,Q,J,Z,it,Yt.x,Yt.y)&&kn(Yt.prev,Yt,Yt.next)>=0)return!1;Yt=Yt.prevZ}for(;Ae&&Ae.z<=ne;){if(Ae.x>=ot&&Ae.x<=Bt&&Ae.y>=at&&Ae.y<=Gt&&Ae!==f&&Ae!==v&&Iu(x,M,Q,J,Z,it,Ae.x,Ae.y)&&kn(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.nextZ}return!0}function sS(a,r,A){var u=a;do{var f=u.prev,b=u.next.next;!sd(f,b)&&jy(f,u,u.next,b)&&Lh(f,b)&&Lh(b,f)&&(r.push(f.i/A|0),r.push(u.i/A|0),r.push(b.i/A|0),Eh(u),Eh(u.next),u=a=b),u=u.next}while(u!==a);return $a(u)}function oS(a,r,A,u,f,b){var v=a;do{for(var x=v.next.next;x!==v.prev;){if(v.i!==x.i&&uS(v,x)){var Q=qy(v,x);return v=$a(v,v.next),Q=$a(Q,Q.next),ll(v,r,A,u,f,b,0),void ll(Q,r,A,u,f,b,0)}x=x.next}v=v.next}while(v!==a)}function aS(a,r){return a.x-r.x}function AS(a,r){var A=function(f,b){var v,x=b,Q=f.x,Z=f.y,M=-1/0;do{if(Z<=x.y&&Z>=x.next.y&&x.next.y!==x.y){var J=x.x+(Z-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(J<=Q&&J>M&&(M=J,v=x.x<x.next.x?x:x.next,J===Q))return v}x=x.next}while(x!==b);if(!v)return null;var it,ot=v,at=v.x,Bt=v.y,Gt=1/0;x=v;do Q>=x.x&&x.x>=at&&Q!==x.x&&Iu(Z<Bt?Q:M,Z,at,Bt,Z<Bt?M:Q,Z,x.x,x.y)&&(it=Math.abs(Z-x.y)/(Q-x.x),Lh(x,f)&&(it<Gt||it===Gt&&(x.x>v.x||x.x===v.x&&lS(v,x)))&&(v=x,Gt=it)),x=x.next;while(x!==ot);return v}(a,r);if(!A)return r;var u=qy(A,a);return $a(u,u.next),$a(A,A.next)}function lS(a,r){return kn(a.prev,a,r.prev)<0&&kn(r.next,a,a.next)<0}function dm(a,r,A,u,f){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-A)*f|0)|a<<8))|a<<4))|a<<2))|a<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-u)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function cS(a){var r=a,A=a;do(r.x<A.x||r.x===A.x&&r.y<A.y)&&(A=r),r=r.next;while(r!==a);return A}function Iu(a,r,A,u,f,b,v,x){return(f-v)*(r-x)>=(a-v)*(b-x)&&(a-v)*(u-x)>=(A-v)*(r-x)&&(A-v)*(b-x)>=(f-v)*(u-x)}function uS(a,r){return a.next.i!==r.i&&a.prev.i!==r.i&&!function(A,u){var f=A;do{if(f.i!==A.i&&f.next.i!==A.i&&f.i!==u.i&&f.next.i!==u.i&&jy(f,f.next,A,u))return!0;f=f.next}while(f!==A);return!1}(a,r)&&(Lh(a,r)&&Lh(r,a)&&function(A,u){var f=A,b=!1,v=(A.x+u.x)/2,x=(A.y+u.y)/2;do f.y>x!=f.next.y>x&&f.next.y!==f.y&&v<(f.next.x-f.x)*(x-f.y)/(f.next.y-f.y)+f.x&&(b=!b),f=f.next;while(f!==A);return b}(a,r)&&(kn(a.prev,a,r.prev)||kn(a,r.prev,r))||sd(a,r)&&kn(a.prev,a,a.next)>0&&kn(r.prev,r,r.next)>0)}function kn(a,r,A){return(r.y-a.y)*(A.x-r.x)-(r.x-a.x)*(A.y-r.y)}function sd(a,r){return a.x===r.x&&a.y===r.y}function jy(a,r,A,u){var f=ad(kn(a,r,A)),b=ad(kn(a,r,u)),v=ad(kn(A,u,a)),x=ad(kn(A,u,r));return f!==b&&v!==x||!(f!==0||!od(a,A,r))||!(b!==0||!od(a,u,r))||!(v!==0||!od(A,a,u))||!(x!==0||!od(A,r,u))}function od(a,r,A){return r.x<=Math.max(a.x,A.x)&&r.x>=Math.min(a.x,A.x)&&r.y<=Math.max(a.y,A.y)&&r.y>=Math.min(a.y,A.y)}function ad(a){return a>0?1:a<0?-1:0}function Lh(a,r){return kn(a.prev,a,a.next)<0?kn(a,r,a.next)>=0&&kn(a,a.prev,r)>=0:kn(a,r,a.prev)<0||kn(a,a.next,r)<0}function qy(a,r){var A=new pm(a.i,a.x,a.y),u=new pm(r.i,r.x,r.y),f=a.next,b=r.prev;return a.next=r,r.prev=a,A.next=f,f.prev=A,u.next=A,A.prev=u,b.next=u,u.prev=b,u}function $y(a,r,A,u){var f=new pm(a,r,A);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function Eh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function pm(a,r,A){this.i=a,this.x=r,this.y=A,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function fm(a,r,A,u){for(var f=0,b=r,v=A-u;b<A;b+=u)f+=(a[v]-a[b])*(a[b+1]+a[v+1]),v=b;return f}Rc.exports=Zc,Rc.exports.default=Zc,Zc.deviation=function(a,r,A,u){var f=r&&r.length,b=Math.abs(fm(a,0,f?r[0]*A:a.length,A));if(f)for(var v=0,x=r.length;v<x;v++)b-=Math.abs(fm(a,r[v]*A,v<x-1?r[v+1]*A:a.length,A));var Q=0;for(v=0;v<u.length;v+=3){var Z=u[v]*A,M=u[v+1]*A,J=u[v+2]*A;Q+=Math.abs((a[Z]-a[J])*(a[M+1]-a[Z+1])-(a[Z]-a[M])*(a[J+1]-a[Z+1]))}return b===0&&Q===0?0:Math.abs((Q-b)/b)},Zc.flatten=function(a){for(var r=a[0][0].length,A={vertices:[],holes:[],dimensions:r},u=0,f=0;f<a.length;f++){for(var b=0;b<a[f].length;b++)for(var v=0;v<r;v++)A.vertices.push(a[f][b][v]);f>0&&A.holes.push(u+=a[f-1].length)}return A};var t1=h(Rc.exports);function hS(a,r,A,u,f){e1(a,r,A||0,u||a.length-1,f||gS)}function e1(a,r,A,u,f){for(;u>A;){if(u-A>600){var b=u-A+1,v=r-A+1,x=Math.log(b),Q=.5*Math.exp(2*x/3),Z=.5*Math.sqrt(x*Q*(b-Q)/b)*(v-b/2<0?-1:1);e1(a,r,Math.max(A,Math.floor(r-v*Q/b+Z)),Math.min(u,Math.floor(r+(b-v)*Q/b+Z)),f)}var M=a[r],J=A,it=u;for(Th(a,A,r),f(a[u],M)>0&&Th(a,A,u);J<it;){for(Th(a,J,it),J++,it--;f(a[J],M)<0;)J++;for(;f(a[it],M)>0;)it--}f(a[A],M)===0?Th(a,A,it):Th(a,++it,u),it<=r&&(A=it+1),r<=it&&(u=it-1)}}function Th(a,r,A){var u=a[r];a[r]=a[A],a[A]=u}function gS(a,r){return a<r?-1:a>r?1:0}function mm(a,r){let A=a.length;if(A<=1)return[a];let u=[],f,b;for(let v=0;v<A;v++){let x=St(a[v]);x!==0&&(a[v].area=Math.abs(x),b===void 0&&(b=x<0),b===x<0?(f&&u.push(f),f=[a[v]]):f.push(a[v]))}if(f&&u.push(f),r>1)for(let v=0;v<u.length;v++)u[v].length<=r||(hS(u[v],r,1,u[v].length-1,dS),u[v]=u[v].slice(0,r));return u}function dS(a,r){return r.area-a.area}function Cm(a,r,A){let u=A.patternDependencies,f=!1;for(let b of r){let v=b.paint.get(`${a}-pattern`);v.isConstant()||(f=!0);let x=v.constantOr(null);x&&(f=!0,u[x.to]=!0,u[x.from]=!0)}return f}function Im(a,r,A,u,f){let b=f.patternDependencies;for(let v of r){let x=v.paint.get(`${a}-pattern`).value;if(x.kind!=="constant"){let Q=x.evaluate({zoom:u-1},A,{},f.availableImages),Z=x.evaluate({zoom:u},A,{},f.availableImages),M=x.evaluate({zoom:u+1},A,{},f.availableImages);Q=Q&&Q.name?Q.name:Q,Z=Z&&Z.name?Z.name:Z,M=M&&M.name?M.name:M,b[Q]=!0,b[Z]=!0,b[M]=!0,A.patterns[v.id]={min:Q,mid:Z,max:M}}}return A}class ym{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(A=>A.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new re,this.indexArray=new $e,this.indexArray2=new wi,this.programConfigurations=new Do(r.layers,r.zoom),this.segments=new Vi,this.segments2=new Vi,this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id)}populate(r,A,u){this.hasPattern=Cm("fill",this.layers,A);let f=this.layers[0].layout.get("fill-sort-key"),b=!f.isConstant(),v=[];for(let{feature:x,id:Q,index:Z,sourceLayerIndex:M}of r){let J=this.layers[0]._featureFilter.needGeometry,it=TA(x,J);if(!this.layers[0]._featureFilter.filter(new Yr(this.zoom),it,u))continue;let ot=b?f.evaluate(it,{},u,A.availableImages):void 0,at={id:Q,properties:x.properties,type:x.type,sourceLayerIndex:M,index:Z,geometry:J?it.geometry:Ko(x),patterns:{},sortKey:ot};v.push(at)}b&&v.sort((x,Q)=>x.sortKey-Q.sortKey);for(let x of v){let{geometry:Q,index:Z,sourceLayerIndex:M}=x;if(this.hasPattern){let J=Im("fill",this.layers,x,this.zoom,A);this.patternFeatures.push(J)}else this.addFeature(x,Q,Z,u,{});A.featureIndex.insert(r[Z].feature,Q,Z,M,this.index)}}update(r,A,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,A,this.stateDependentLayers,u)}addFeatures(r,A,u){for(let f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,A,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Cu),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,A,u,f,b){for(let v of mm(A,500)){let x=0;for(let ot of v)x+=ot.length;let Q=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),Z=Q.vertexLength,M=[],J=[];for(let ot of v){if(ot.length===0)continue;ot!==v[0]&&J.push(M.length/2);let at=this.segments2.prepareSegment(ot.length,this.layoutVertexArray,this.indexArray2),Bt=at.vertexLength;this.layoutVertexArray.emplaceBack(ot[0].x,ot[0].y),this.indexArray2.emplaceBack(Bt+ot.length-1,Bt),M.push(ot[0].x),M.push(ot[0].y);for(let Gt=1;Gt<ot.length;Gt++)this.layoutVertexArray.emplaceBack(ot[Gt].x,ot[Gt].y),this.indexArray2.emplaceBack(Bt+Gt-1,Bt+Gt),M.push(ot[Gt].x),M.push(ot[Gt].y);at.vertexLength+=ot.length,at.primitiveLength+=ot.length}let it=t1(M,J);for(let ot=0;ot<it.length;ot+=3)this.indexArray.emplaceBack(Z+it[ot],Z+it[ot+1],Z+it[ot+2]);Q.vertexLength+=x,Q.primitiveLength+=it.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,b,f)}}let i1,r1;li("FillBucket",ym,{omit:["layers","patternFeatures"]});var pS={get paint(){return r1=r1||new yn({"fill-antialias":new Fi($t.paint_fill["fill-antialias"]),"fill-opacity":new Ni($t.paint_fill["fill-opacity"]),"fill-color":new Ni($t.paint_fill["fill-color"]),"fill-outline-color":new Ni($t.paint_fill["fill-outline-color"]),"fill-translate":new Fi($t.paint_fill["fill-translate"]),"fill-translate-anchor":new Fi($t.paint_fill["fill-translate-anchor"]),"fill-pattern":new il($t.paint_fill["fill-pattern"])})},get layout(){return i1=i1||new yn({"fill-sort-key":new Ni($t.layout_fill["fill-sort-key"])})}};class fS extends Cn{constructor(r){super(r,pS)}recalculate(r,A){super.recalculate(r,A);let u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new ym(r)}queryRadius(){return al(this.paint.get("fill-translate"))}queryIntersectsFeature(r,A,u,f,b,v,x){return kc(Tc(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,x),f)}isTileClipped(){return!0}}let mS=Er([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),CS=Er([{name:"a_centroid",components:2,type:"Int16"}],4),{members:IS}=mS;var Wl={},yS=m,n1=yu;function yu(a,r,A,u,f){this.properties={},this.extent=A,this.type=0,this._pbf=a,this._geometry=-1,this._keys=u,this._values=f,a.readFields(bS,this,r)}function bS(a,r,A){a==1?r.id=A.readVarint():a==2?function(u,f){for(var b=u.readVarint()+u.pos;u.pos<b;){var v=f._keys[u.readVarint()],x=f._values[u.readVarint()];f.properties[v]=x}}(A,r):a==3?r.type=A.readVarint():a==4&&(r._geometry=A.pos)}function vS(a){for(var r,A,u=0,f=0,b=a.length,v=b-1;f<b;v=f++)u+=((A=a[v]).x-(r=a[f]).x)*(r.y+A.y);return u}yu.types=["Unknown","Point","LineString","Polygon"],yu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var r,A=a.readVarint()+a.pos,u=1,f=0,b=0,v=0,x=[];a.pos<A;){if(f<=0){var Q=a.readVarint();u=7&Q,f=Q>>3}if(f--,u===1||u===2)b+=a.readSVarint(),v+=a.readSVarint(),u===1&&(r&&x.push(r),r=[]),r.push(new yS(b,v));else{if(u!==7)throw new Error("unknown command "+u);r&&r.push(r[0].clone())}}return r&&x.push(r),x},yu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var r=a.readVarint()+a.pos,A=1,u=0,f=0,b=0,v=1/0,x=-1/0,Q=1/0,Z=-1/0;a.pos<r;){if(u<=0){var M=a.readVarint();A=7&M,u=M>>3}if(u--,A===1||A===2)(f+=a.readSVarint())<v&&(v=f),f>x&&(x=f),(b+=a.readSVarint())<Q&&(Q=b),b>Z&&(Z=b);else if(A!==7)throw new Error("unknown command "+A)}return[v,Q,x,Z]},yu.prototype.toGeoJSON=function(a,r,A){var u,f,b=this.extent*Math.pow(2,A),v=this.extent*a,x=this.extent*r,Q=this.loadGeometry(),Z=yu.types[this.type];function M(ot){for(var at=0;at<ot.length;at++){var Bt=ot[at];ot[at]=[360*(Bt.x+v)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(Bt.y+x)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var J=[];for(u=0;u<Q.length;u++)J[u]=Q[u][0];M(Q=J);break;case 2:for(u=0;u<Q.length;u++)M(Q[u]);break;case 3:for(Q=function(ot){var at=ot.length;if(at<=1)return[ot];for(var Bt,Gt,Mt=[],ne=0;ne<at;ne++){var Yt=vS(ot[ne]);Yt!==0&&(Gt===void 0&&(Gt=Yt<0),Gt===Yt<0?(Bt&&Mt.push(Bt),Bt=[ot[ne]]):Bt.push(ot[ne]))}return Bt&&Mt.push(Bt),Mt}(Q),u=0;u<Q.length;u++)for(f=0;f<Q[u].length;f++)M(Q[u][f])}Q.length===1?Q=Q[0]:Z="Multi"+Z;var it={type:"Feature",geometry:{type:Z,coordinates:Q},properties:this.properties};return"id"in this&&(it.id=this.id),it};var wS=n1,s1=o1;function o1(a,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(BS,this,r),this.length=this._features.length}function BS(a,r,A){a===15?r.version=A.readVarint():a===1?r.name=A.readString():a===5?r.extent=A.readVarint():a===2?r._features.push(A.pos):a===3?r._keys.push(A.readString()):a===4&&r._values.push(function(u){for(var f=null,b=u.readVarint()+u.pos;u.pos<b;){var v=u.readVarint()>>3;f=v===1?u.readString():v===2?u.readFloat():v===3?u.readDouble():v===4?u.readVarint64():v===5?u.readVarint():v===6?u.readSVarint():v===7?u.readBoolean():null}return f}(A))}o1.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var r=this._pbf.readVarint()+this._pbf.pos;return new wS(this._pbf,r,this.extent,this._keys,this._values)};var _S=s1;function xS(a,r,A){if(a===3){var u=new _S(A,A.readVarint()+A.pos);u.length&&(r[u.name]=u)}}Wl.VectorTile=function(a,r){this.layers=a.readFields(xS,{},r)},Wl.VectorTileFeature=n1,Wl.VectorTileLayer=s1;let SS=Wl.VectorTileFeature.types,bm=Math.pow(2,13);function Qh(a,r,A,u,f,b,v,x){a.emplaceBack(r,A,2*Math.floor(u*bm)+v,f*bm*2,b*bm*2,Math.round(x))}class vm{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(A=>A.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Tt,this.centroidVertexArray=new Ct,this.indexArray=new $e,this.programConfigurations=new Do(r.layers,r.zoom),this.segments=new Vi,this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id)}populate(r,A,u){this.features=[],this.hasPattern=Cm("fill-extrusion",this.layers,A);for(let{feature:f,id:b,index:v,sourceLayerIndex:x}of r){let Q=this.layers[0]._featureFilter.needGeometry,Z=TA(f,Q);if(!this.layers[0]._featureFilter.filter(new Yr(this.zoom),Z,u))continue;let M={id:b,sourceLayerIndex:x,index:v,geometry:Q?Z.geometry:Ko(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Im("fill-extrusion",this.layers,M,this.zoom,A)):this.addFeature(M,M.geometry,v,u,{}),A.featureIndex.insert(f,M.geometry,v,x,this.index,!0)}}addFeatures(r,A,u){for(let f of this.features){let{geometry:b}=f;this.addFeature(f,b,f.index,A,u)}}update(r,A,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,A,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,IS),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,CS.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,A,u,f,b){let v={x:0,y:0,vertexCount:0};for(let x of mm(A,500)){let Q=0;for(let at of x)Q+=at.length;let Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let at of x){if(at.length===0||kS(at))continue;let Bt=0;for(let Gt=0;Gt<at.length;Gt++){let Mt=at[Gt];if(Gt>=1){let ne=at[Gt-1];if(!FS(Mt,ne)){Z.vertexLength+4>Vi.MAX_VERTEX_ARRAY_LENGTH&&(Z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let Yt=Mt.sub(ne)._perp()._unit(),Ae=ne.dist(Mt);Bt+Ae>32768&&(Bt=0),Qh(this.layoutVertexArray,Mt.x,Mt.y,Yt.x,Yt.y,0,0,Bt),Qh(this.layoutVertexArray,Mt.x,Mt.y,Yt.x,Yt.y,0,1,Bt),v.x+=2*Mt.x,v.y+=2*Mt.y,v.vertexCount+=2,Bt+=Ae,Qh(this.layoutVertexArray,ne.x,ne.y,Yt.x,Yt.y,0,0,Bt),Qh(this.layoutVertexArray,ne.x,ne.y,Yt.x,Yt.y,0,1,Bt),v.x+=2*ne.x,v.y+=2*ne.y,v.vertexCount+=2;let ye=Z.vertexLength;this.indexArray.emplaceBack(ye,ye+2,ye+1),this.indexArray.emplaceBack(ye+1,ye+2,ye+3),Z.vertexLength+=4,Z.primitiveLength+=2}}}}if(Z.vertexLength+Q>Vi.MAX_VERTEX_ARRAY_LENGTH&&(Z=this.segments.prepareSegment(Q,this.layoutVertexArray,this.indexArray)),SS[r.type]!=="Polygon")continue;let M=[],J=[],it=Z.vertexLength;for(let at of x)if(at.length!==0){at!==x[0]&&J.push(M.length/2);for(let Bt=0;Bt<at.length;Bt++){let Gt=at[Bt];Qh(this.layoutVertexArray,Gt.x,Gt.y,0,0,1,1,0),v.x+=Gt.x,v.y+=Gt.y,v.vertexCount+=1,M.push(Gt.x),M.push(Gt.y)}}let ot=t1(M,J);for(let at=0;at<ot.length;at+=3)this.indexArray.emplaceBack(it+ot[at],it+ot[at+2],it+ot[at+1]);Z.primitiveLength+=ot.length/3,Z.vertexLength+=Q}for(let x=0;x<v.vertexCount;x++)this.centroidVertexArray.emplaceBack(Math.floor(v.x/v.vertexCount),Math.floor(v.y/v.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,b,f)}}function FS(a,r){return a.x===r.x&&(a.x<0||a.x>cn)||a.y===r.y&&(a.y<0||a.y>cn)}function kS(a){return a.every(r=>r.x<0)||a.every(r=>r.x>cn)||a.every(r=>r.y<0)||a.every(r=>r.y>cn)}let a1;li("FillExtrusionBucket",vm,{omit:["layers","features"]});var LS={get paint(){return a1=a1||new yn({"fill-extrusion-opacity":new Fi($t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ni($t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Fi($t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Fi($t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new il($t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ni($t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ni($t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Fi($t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class ES extends Cn{constructor(r){super(r,LS)}createBucket(r){return new vm(r)}queryRadius(){return al(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,A,u,f,b,v,x,Q){let Z=Tc(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,x),M=this.paint.get("fill-extrusion-height").evaluate(A,u),J=this.paint.get("fill-extrusion-base").evaluate(A,u),it=function(at,Bt,Gt,Mt){let ne=[];for(let Yt of at){let Ae=[Yt.x,Yt.y,0,1];ca(Ae,Ae,Bt),ne.push(new _(Ae[0]/Ae[3],Ae[1]/Ae[3]))}return ne}(Z,Q),ot=function(at,Bt,Gt,Mt){let ne=[],Yt=[],Ae=Mt[8]*Bt,ye=Mt[9]*Bt,Ge=Mt[10]*Bt,ci=Mt[11]*Bt,Si=Mt[8]*Gt,Ai=Mt[9]*Gt,oi=Mt[10]*Gt,ii=Mt[11]*Gt;for(let vi of at){let ni=[],Oe=[];for(let Hi of vi){let ki=Hi.x,hr=Hi.y,nn=Mt[0]*ki+Mt[4]*hr+Mt[12],un=Mt[1]*ki+Mt[5]*hr+Mt[13],Wn=Mt[2]*ki+Mt[6]*hr+Mt[14],Oo=Mt[3]*ki+Mt[7]*hr+Mt[15],to=Wn+Ge,Hn=Oo+ci,bs=nn+Si,Fs=un+Ai,eo=Wn+oi,io=Oo+ii,zn=new _((nn+Ae)/Hn,(un+ye)/Hn);zn.z=to/Hn,ni.push(zn);let Jn=new _(bs/io,Fs/io);Jn.z=eo/io,Oe.push(Jn)}ne.push(ni),Yt.push(Oe)}return[ne,Yt]}(f,J,M,Q);return function(at,Bt,Gt){let Mt=1/0;kc(Gt,Bt)&&(Mt=A1(Gt,Bt[0]));for(let ne=0;ne<Bt.length;ne++){let Yt=Bt[ne],Ae=at[ne];for(let ye=0;ye<Yt.length-1;ye++){let Ge=Yt[ye],ci=[Ge,Yt[ye+1],Ae[ye+1],Ae[ye],Ge];Fc(Gt,ci)&&(Mt=Math.min(Mt,A1(Gt,ci)))}}return Mt!==1/0&&Mt}(ot[0],ot[1],it)}}function Uh(a,r){return a.x*r.x+a.y*r.y}function A1(a,r){if(a.length===1){let A=0,u=r[A++],f;for(;!f||u.equals(f);)if(f=r[A++],!f)return 1/0;for(;A<r.length;A++){let b=r[A],v=a[0],x=f.sub(u),Q=b.sub(u),Z=v.sub(u),M=Uh(x,x),J=Uh(x,Q),it=Uh(Q,Q),ot=Uh(Z,x),at=Uh(Z,Q),Bt=M*it-J*J,Gt=(it*ot-J*at)/Bt,Mt=(M*at-J*ot)/Bt,ne=u.z*(1-Gt-Mt)+f.z*Gt+b.z*Mt;if(isFinite(ne))return ne}return 1/0}{let A=1/0;for(let u of r)A=Math.min(A,u.z);return A}}let TS=Er([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:QS}=TS,US=Er([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:GS}=US,RS=Wl.VectorTileFeature.types,ZS=Math.cos(Math.PI/180*37.5),l1=Math.pow(2,14)/.5;class wm{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(A=>A.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(A=>{this.gradients[A.id]={}}),this.layoutVertexArray=new pe,this.layoutVertexArray2=new te,this.indexArray=new $e,this.programConfigurations=new Do(r.layers,r.zoom),this.segments=new Vi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id)}populate(r,A,u){this.hasPattern=Cm("line",this.layers,A);let f=this.layers[0].layout.get("line-sort-key"),b=!f.isConstant(),v=[];for(let{feature:x,id:Q,index:Z,sourceLayerIndex:M}of r){let J=this.layers[0]._featureFilter.needGeometry,it=TA(x,J);if(!this.layers[0]._featureFilter.filter(new Yr(this.zoom),it,u))continue;let ot=b?f.evaluate(it,{},u):void 0,at={id:Q,properties:x.properties,type:x.type,sourceLayerIndex:M,index:Z,geometry:J?it.geometry:Ko(x),patterns:{},sortKey:ot};v.push(at)}b&&v.sort((x,Q)=>x.sortKey-Q.sortKey);for(let x of v){let{geometry:Q,index:Z,sourceLayerIndex:M}=x;if(this.hasPattern){let J=Im("line",this.layers,x,this.zoom,A);this.patternFeatures.push(J)}else this.addFeature(x,Q,Z,u,{});A.featureIndex.insert(r[Z].feature,Q,Z,M,this.index)}}update(r,A,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,A,this.stateDependentLayers,u)}addFeatures(r,A,u){for(let f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,A,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,GS)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,QS),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,A,u,f,b){let v=this.layers[0].layout,x=v.get("line-join").evaluate(r,{}),Q=v.get("line-cap"),Z=v.get("line-miter-limit"),M=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(let J of A)this.addLine(J,r,x,Q,Z,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,b,f)}addLine(r,A,u,f,b,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Mt=0;Mt<r.length-1;Mt++)this.totalDistance+=r[Mt].dist(r[Mt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let x=RS[A.type]==="Polygon",Q=r.length;for(;Q>=2&&r[Q-1].equals(r[Q-2]);)Q--;let Z=0;for(;Z<Q-1&&r[Z].equals(r[Z+1]);)Z++;if(Q<(x?3:2))return;u==="bevel"&&(b=1.05);let M=this.overscaling<=16?15*cn/(512*this.overscaling):0,J=this.segments.prepareSegment(10*Q,this.layoutVertexArray,this.indexArray),it,ot,at,Bt,Gt;this.e1=this.e2=-1,x&&(it=r[Q-2],Gt=r[Z].sub(it)._unit()._perp());for(let Mt=Z;Mt<Q;Mt++){if(at=Mt===Q-1?x?r[Z+1]:void 0:r[Mt+1],at&&r[Mt].equals(at))continue;Gt&&(Bt=Gt),it&&(ot=it),it=r[Mt],Gt=at?at.sub(it)._unit()._perp():Bt,Bt=Bt||Gt;let ne=Bt.add(Gt);ne.x===0&&ne.y===0||ne._unit();let Yt=Bt.x*Gt.x+Bt.y*Gt.y,Ae=ne.x*Gt.x+ne.y*Gt.y,ye=Ae!==0?1/Ae:1/0,Ge=2*Math.sqrt(2-2*Ae),ci=Ae<ZS&&ot&&at,Si=Bt.x*Gt.y-Bt.y*Gt.x>0;if(ci&&Mt>Z){let ii=it.dist(ot);if(ii>2*M){let vi=it.sub(it.sub(ot)._mult(M/ii)._round());this.updateDistance(ot,vi),this.addCurrentVertex(vi,Bt,0,0,J),ot=vi}}let Ai=ot&&at,oi=Ai?u:x?"butt":f;if(Ai&&oi==="round"&&(ye<v?oi="miter":ye<=2&&(oi="fakeround")),oi==="miter"&&ye>b&&(oi="bevel"),oi==="bevel"&&(ye>2&&(oi="flipbevel"),ye<b&&(oi="miter")),ot&&this.updateDistance(ot,it),oi==="miter")ne._mult(ye),this.addCurrentVertex(it,ne,0,0,J);else if(oi==="flipbevel"){if(ye>100)ne=Gt.mult(-1);else{let ii=ye*Bt.add(Gt).mag()/Bt.sub(Gt).mag();ne._perp()._mult(ii*(Si?-1:1))}this.addCurrentVertex(it,ne,0,0,J),this.addCurrentVertex(it,ne.mult(-1),0,0,J)}else if(oi==="bevel"||oi==="fakeround"){let ii=-Math.sqrt(ye*ye-1),vi=Si?ii:0,ni=Si?0:ii;if(ot&&this.addCurrentVertex(it,Bt,vi,ni,J),oi==="fakeround"){let Oe=Math.round(180*Ge/Math.PI/20);for(let Hi=1;Hi<Oe;Hi++){let ki=Hi/Oe;if(ki!==.5){let nn=ki-.5;ki+=ki*nn*(ki-1)*((1.0904+Yt*(Yt*(3.55645-1.43519*Yt)-3.2452))*nn*nn+(.848013+Yt*(.215638*Yt-1.06021)))}let hr=Gt.sub(Bt)._mult(ki)._add(Bt)._unit()._mult(Si?-1:1);this.addHalfVertex(it,hr.x,hr.y,!1,Si,0,J)}}at&&this.addCurrentVertex(it,Gt,-vi,-ni,J)}else if(oi==="butt")this.addCurrentVertex(it,ne,0,0,J);else if(oi==="square"){let ii=ot?1:-1;this.addCurrentVertex(it,ne,ii,ii,J)}else oi==="round"&&(ot&&(this.addCurrentVertex(it,Bt,0,0,J),this.addCurrentVertex(it,Bt,1,1,J,!0)),at&&(this.addCurrentVertex(it,Gt,-1,-1,J,!0),this.addCurrentVertex(it,Gt,0,0,J)));if(ci&&Mt<Q-1){let ii=it.dist(at);if(ii>2*M){let vi=it.add(at.sub(it)._mult(M/ii)._round());this.updateDistance(it,vi),this.addCurrentVertex(vi,Gt,0,0,J),it=vi}}}}addCurrentVertex(r,A,u,f,b,v=!1){let x=A.y*f-A.x,Q=-A.y-A.x*f;this.addHalfVertex(r,A.x+A.y*u,A.y-A.x*u,v,!1,u,b),this.addHalfVertex(r,x,Q,v,!0,-f,b),this.distance>l1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,A,u,f,b,v))}addHalfVertex({x:r,y:A},u,f,b,v,x,Q){let Z=.5*(this.lineClips?this.scaledDistance*(l1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(b?1:0),(A<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*f)+128,1+(x===0?0:x<0?-1:1)|(63&Z)<<2,Z>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let M=Q.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),Q.primitiveLength++),v?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,A){this.distance+=r.dist(A),this.updateScaledDistance()}}let c1,u1;li("LineBucket",wm,{omit:["layers","patternFeatures"]});var h1={get paint(){return u1=u1||new yn({"line-opacity":new Ni($t.paint_line["line-opacity"]),"line-color":new Ni($t.paint_line["line-color"]),"line-translate":new Fi($t.paint_line["line-translate"]),"line-translate-anchor":new Fi($t.paint_line["line-translate-anchor"]),"line-width":new Ni($t.paint_line["line-width"]),"line-gap-width":new Ni($t.paint_line["line-gap-width"]),"line-offset":new Ni($t.paint_line["line-offset"]),"line-blur":new Ni($t.paint_line["line-blur"]),"line-dasharray":new _c($t.paint_line["line-dasharray"]),"line-pattern":new il($t.paint_line["line-pattern"]),"line-gradient":new xc($t.paint_line["line-gradient"])})},get layout(){return c1=c1||new yn({"line-cap":new Fi($t.layout_line["line-cap"]),"line-join":new Ni($t.layout_line["line-join"]),"line-miter-limit":new Fi($t.layout_line["line-miter-limit"]),"line-round-limit":new Fi($t.layout_line["line-round-limit"]),"line-sort-key":new Ni($t.layout_line["line-sort-key"])})}};class HS extends Ni{possiblyEvaluate(r,A){return A=new Yr(Math.floor(A.zoom),{now:A.now,fadeDuration:A.fadeDuration,zoomHistory:A.zoomHistory,transition:A.transition}),super.possiblyEvaluate(r,A)}evaluate(r,A,u,f){return A=Qt({},A,{zoom:Math.floor(A.zoom)}),super.evaluate(r,A,u,f)}}let Ad;class NS extends Cn{constructor(r){super(r,h1),this.gradientVersion=0,Ad||(Ad=new HS(h1.paint.properties["line-width"].specification),Ad.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){let A=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(A)&&A._styleExpression.expression instanceof Qo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,A){super.recalculate(r,A),this.paint._values["line-floorwidth"]=Ad.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new wm(r)}queryRadius(r){let A=r,u=g1(Ml("line-width",this,A),Ml("line-gap-width",this,A)),f=Ml("line-offset",this,A);return u/2+Math.abs(f)+al(this.paint.get("line-translate"))}queryIntersectsFeature(r,A,u,f,b,v,x){let Q=Tc(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,x),Z=x/2*g1(this.paint.get("line-width").evaluate(A,u),this.paint.get("line-gap-width").evaluate(A,u)),M=this.paint.get("line-offset").evaluate(A,u);return M&&(f=function(J,it){let ot=[];for(let at=0;at<J.length;at++){let Bt=J[at],Gt=[];for(let Mt=0;Mt<Bt.length;Mt++){let ne=Bt[Mt-1],Yt=Bt[Mt],Ae=Bt[Mt+1],ye=Mt===0?new _(0,0):Yt.sub(ne)._unit()._perp(),Ge=Mt===Bt.length-1?new _(0,0):Ae.sub(Yt)._unit()._perp(),ci=ye._add(Ge)._unit(),Si=ci.x*Ge.x+ci.y*Ge.y;Si!==0&&ci._mult(1/Si),Gt.push(ci._mult(it)._add(Yt))}ot.push(Gt)}return ot}(f,M*x)),function(J,it,ot){for(let at=0;at<it.length;at++){let Bt=it[at];if(J.length>=3){for(let Gt=0;Gt<Bt.length;Gt++)if(Pl(J,Bt[Gt]))return!0}if(Lc(J,Bt,ot))return!0}return!1}(Q,f,Z)}isTileClipped(){return!0}}function g1(a,r){return r>0?r+2*a:a}let PS=Er([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),MS=Er([{name:"a_projected_pos",components:3,type:"Float32"}],4);Er([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let VS=Er([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Er([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let d1=Er([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),DS=Er([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function KS(a,r,A){return a.sections.forEach(u=>{u.text=function(f,b,v){let x=b.layout.get("text-transform").evaluate(v,{});return x==="uppercase"?f=f.toLocaleUpperCase():x==="lowercase"&&(f=f.toLocaleLowerCase()),xs.applyArabicShaping&&(f=xs.applyArabicShaping(f)),f}(u.text,r,A)}),a}Er([{name:"triangle",components:3,type:"Uint16"}]),Er([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Er([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Er([{type:"Float32",name:"offsetX"}]),Er([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Er([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let Gh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var On=24,p1=Or,f1=function(a,r,A,u,f){var b,v,x=8*f-u-1,Q=(1<<x)-1,Z=Q>>1,M=-7,J=A?f-1:0,it=A?-1:1,ot=a[r+J];for(J+=it,b=ot&(1<<-M)-1,ot>>=-M,M+=x;M>0;b=256*b+a[r+J],J+=it,M-=8);for(v=b&(1<<-M)-1,b>>=-M,M+=u;M>0;v=256*v+a[r+J],J+=it,M-=8);if(b===0)b=1-Z;else{if(b===Q)return v?NaN:1/0*(ot?-1:1);v+=Math.pow(2,u),b-=Z}return(ot?-1:1)*v*Math.pow(2,b-u)},m1=function(a,r,A,u,f,b){var v,x,Q,Z=8*b-f-1,M=(1<<Z)-1,J=M>>1,it=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,ot=u?0:b-1,at=u?1:-1,Bt=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(x=isNaN(r)?1:0,v=M):(v=Math.floor(Math.log(r)/Math.LN2),r*(Q=Math.pow(2,-v))<1&&(v--,Q*=2),(r+=v+J>=1?it/Q:it*Math.pow(2,1-J))*Q>=2&&(v++,Q/=2),v+J>=M?(x=0,v=M):v+J>=1?(x=(r*Q-1)*Math.pow(2,f),v+=J):(x=r*Math.pow(2,J-1)*Math.pow(2,f),v=0));f>=8;a[A+ot]=255&x,ot+=at,x/=256,f-=8);for(v=v<<f|x,Z+=f;Z>0;a[A+ot]=255&v,ot+=at,v/=256,Z-=8);a[A+ot-at]|=128*Bt};function Or(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Or.Varint=0,Or.Fixed64=1,Or.Bytes=2,Or.Fixed32=5;var Bm=4294967296,C1=1/Bm,I1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function cl(a){return a.type===Or.Bytes?a.readVarint()+a.pos:a.pos+1}function bu(a,r,A){return A?4294967296*r+(a>>>0):4294967296*(r>>>0)+(a>>>0)}function y1(a,r,A){var u=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));A.realloc(u);for(var f=A.pos-1;f>=a;f--)A.buf[f+u]=A.buf[f]}function OS(a,r){for(var A=0;A<a.length;A++)r.writeVarint(a[A])}function WS(a,r){for(var A=0;A<a.length;A++)r.writeSVarint(a[A])}function zS(a,r){for(var A=0;A<a.length;A++)r.writeFloat(a[A])}function JS(a,r){for(var A=0;A<a.length;A++)r.writeDouble(a[A])}function XS(a,r){for(var A=0;A<a.length;A++)r.writeBoolean(a[A])}function YS(a,r){for(var A=0;A<a.length;A++)r.writeFixed32(a[A])}function jS(a,r){for(var A=0;A<a.length;A++)r.writeSFixed32(a[A])}function qS(a,r){for(var A=0;A<a.length;A++)r.writeFixed64(a[A])}function $S(a,r){for(var A=0;A<a.length;A++)r.writeSFixed64(a[A])}function ld(a,r){return(a[r]|a[r+1]<<8|a[r+2]<<16)+16777216*a[r+3]}function vu(a,r,A){a[A]=r,a[A+1]=r>>>8,a[A+2]=r>>>16,a[A+3]=r>>>24}function b1(a,r){return(a[r]|a[r+1]<<8|a[r+2]<<16)+(a[r+3]<<24)}Or.prototype={destroy:function(){this.buf=null},readFields:function(a,r,A){for(A=A||this.length;this.pos<A;){var u=this.readVarint(),f=u>>3,b=this.pos;this.type=7&u,a(f,r,this),this.pos===b&&this.skip(u)}return r},readMessage:function(a,r){return this.readFields(a,r,this.readVarint()+this.pos)},readFixed32:function(){var a=ld(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=b1(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=ld(this.buf,this.pos)+ld(this.buf,this.pos+4)*Bm;return this.pos+=8,a},readSFixed64:function(){var a=ld(this.buf,this.pos)+b1(this.buf,this.pos+4)*Bm;return this.pos+=8,a},readFloat:function(){var a=f1(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=f1(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var r,A,u=this.buf;return r=127&(A=u[this.pos++]),A<128?r:(r|=(127&(A=u[this.pos++]))<<7,A<128?r:(r|=(127&(A=u[this.pos++]))<<14,A<128?r:(r|=(127&(A=u[this.pos++]))<<21,A<128?r:function(f,b,v){var x,Q,Z=v.buf;if(x=(112&(Q=Z[v.pos++]))>>4,Q<128||(x|=(127&(Q=Z[v.pos++]))<<3,Q<128)||(x|=(127&(Q=Z[v.pos++]))<<10,Q<128)||(x|=(127&(Q=Z[v.pos++]))<<17,Q<128)||(x|=(127&(Q=Z[v.pos++]))<<24,Q<128)||(x|=(1&(Q=Z[v.pos++]))<<31,Q<128))return bu(f,x,b);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(A=u[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,r=this.pos;return this.pos=a,a-r>=12&&I1?function(A,u,f){return I1.decode(A.subarray(u,f))}(this.buf,r,a):function(A,u,f){for(var b="",v=u;v<f;){var x,Q,Z,M=A[v],J=null,it=M>239?4:M>223?3:M>191?2:1;if(v+it>f)break;it===1?M<128&&(J=M):it===2?(192&(x=A[v+1]))==128&&(J=(31&M)<<6|63&x)<=127&&(J=null):it===3?(Q=A[v+2],(192&(x=A[v+1]))==128&&(192&Q)==128&&((J=(15&M)<<12|(63&x)<<6|63&Q)<=2047||J>=55296&&J<=57343)&&(J=null)):it===4&&(Q=A[v+2],Z=A[v+3],(192&(x=A[v+1]))==128&&(192&Q)==128&&(192&Z)==128&&((J=(15&M)<<18|(63&x)<<12|(63&Q)<<6|63&Z)<=65535||J>=1114112)&&(J=null)),J===null?(J=65533,it=1):J>65535&&(J-=65536,b+=String.fromCharCode(J>>>10&1023|55296),J=56320|1023&J),b+=String.fromCharCode(J),v+=it}return b}(this.buf,r,a)},readBytes:function(){var a=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,a);return this.pos=a,r},readPackedVarint:function(a,r){if(this.type!==Or.Bytes)return a.push(this.readVarint(r));var A=cl(this);for(a=a||[];this.pos<A;)a.push(this.readVarint(r));return a},readPackedSVarint:function(a){if(this.type!==Or.Bytes)return a.push(this.readSVarint());var r=cl(this);for(a=a||[];this.pos<r;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Or.Bytes)return a.push(this.readBoolean());var r=cl(this);for(a=a||[];this.pos<r;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Or.Bytes)return a.push(this.readFloat());var r=cl(this);for(a=a||[];this.pos<r;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Or.Bytes)return a.push(this.readDouble());var r=cl(this);for(a=a||[];this.pos<r;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Or.Bytes)return a.push(this.readFixed32());var r=cl(this);for(a=a||[];this.pos<r;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Or.Bytes)return a.push(this.readSFixed32());var r=cl(this);for(a=a||[];this.pos<r;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Or.Bytes)return a.push(this.readFixed64());var r=cl(this);for(a=a||[];this.pos<r;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Or.Bytes)return a.push(this.readSFixed64());var r=cl(this);for(a=a||[];this.pos<r;)a.push(this.readSFixed64());return a},skip:function(a){var r=7&a;if(r===Or.Varint)for(;this.buf[this.pos++]>127;);else if(r===Or.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Or.Fixed32)this.pos+=4;else{if(r!==Or.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(a,r){this.writeVarint(a<<3|r)},realloc:function(a){for(var r=this.length||16;r<this.pos+a;)r*=2;if(r!==this.length){var A=new Uint8Array(r);A.set(this.buf),this.buf=A,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),vu(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),vu(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),vu(this.buf,-1&a,this.pos),vu(this.buf,Math.floor(a*C1),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),vu(this.buf,-1&a,this.pos),vu(this.buf,Math.floor(a*C1),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(r,A){var u,f;if(r>=0?(u=r%4294967296|0,f=r/4294967296|0):(f=~(-r/4294967296),4294967295^(u=~(-r%4294967296))?u=u+1|0:(u=0,f=f+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");A.realloc(10),function(b,v,x){x.buf[x.pos++]=127&b|128,b>>>=7,x.buf[x.pos++]=127&b|128,b>>>=7,x.buf[x.pos++]=127&b|128,b>>>=7,x.buf[x.pos++]=127&b|128,x.buf[x.pos]=127&(b>>>=7)}(u,0,A),function(b,v){var x=(7&b)<<4;v.buf[v.pos++]|=x|((b>>>=3)?128:0),b&&(v.buf[v.pos++]=127&b|((b>>>=7)?128:0),b&&(v.buf[v.pos++]=127&b|((b>>>=7)?128:0),b&&(v.buf[v.pos++]=127&b|((b>>>=7)?128:0),b&&(v.buf[v.pos++]=127&b|((b>>>=7)?128:0),b&&(v.buf[v.pos++]=127&b)))))}(f,A)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var r=this.pos;this.pos=function(u,f,b){for(var v,x,Q=0;Q<f.length;Q++){if((v=f.charCodeAt(Q))>55295&&v<57344){if(!x){v>56319||Q+1===f.length?(u[b++]=239,u[b++]=191,u[b++]=189):x=v;continue}if(v<56320){u[b++]=239,u[b++]=191,u[b++]=189,x=v;continue}v=x-55296<<10|v-56320|65536,x=null}else x&&(u[b++]=239,u[b++]=191,u[b++]=189,x=null);v<128?u[b++]=v:(v<2048?u[b++]=v>>6|192:(v<65536?u[b++]=v>>12|224:(u[b++]=v>>18|240,u[b++]=v>>12&63|128),u[b++]=v>>6&63|128),u[b++]=63&v|128)}return b}(this.buf,a,this.pos);var A=this.pos-r;A>=128&&y1(r,A,this),this.pos=r-1,this.writeVarint(A),this.pos+=A},writeFloat:function(a){this.realloc(4),m1(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),m1(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var r=a.length;this.writeVarint(r),this.realloc(r);for(var A=0;A<r;A++)this.buf[this.pos++]=a[A]},writeRawMessage:function(a,r){this.pos++;var A=this.pos;a(r,this);var u=this.pos-A;u>=128&&y1(A,u,this),this.pos=A-1,this.writeVarint(u),this.pos+=u},writeMessage:function(a,r,A){this.writeTag(a,Or.Bytes),this.writeRawMessage(r,A)},writePackedVarint:function(a,r){r.length&&this.writeMessage(a,OS,r)},writePackedSVarint:function(a,r){r.length&&this.writeMessage(a,WS,r)},writePackedBoolean:function(a,r){r.length&&this.writeMessage(a,XS,r)},writePackedFloat:function(a,r){r.length&&this.writeMessage(a,zS,r)},writePackedDouble:function(a,r){r.length&&this.writeMessage(a,JS,r)},writePackedFixed32:function(a,r){r.length&&this.writeMessage(a,YS,r)},writePackedSFixed32:function(a,r){r.length&&this.writeMessage(a,jS,r)},writePackedFixed64:function(a,r){r.length&&this.writeMessage(a,qS,r)},writePackedSFixed64:function(a,r){r.length&&this.writeMessage(a,$S,r)},writeBytesField:function(a,r){this.writeTag(a,Or.Bytes),this.writeBytes(r)},writeFixed32Field:function(a,r){this.writeTag(a,Or.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(a,r){this.writeTag(a,Or.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(a,r){this.writeTag(a,Or.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(a,r){this.writeTag(a,Or.Fixed64),this.writeSFixed64(r)},writeVarintField:function(a,r){this.writeTag(a,Or.Varint),this.writeVarint(r)},writeSVarintField:function(a,r){this.writeTag(a,Or.Varint),this.writeSVarint(r)},writeStringField:function(a,r){this.writeTag(a,Or.Bytes),this.writeString(r)},writeFloatField:function(a,r){this.writeTag(a,Or.Fixed32),this.writeFloat(r)},writeDoubleField:function(a,r){this.writeTag(a,Or.Fixed64),this.writeDouble(r)},writeBooleanField:function(a,r){this.writeVarintField(a,Boolean(r))}};var _m=h(p1);let xm=3;function t3(a,r,A){a===1&&A.readMessage(e3,r)}function e3(a,r,A){if(a===3){let{id:u,bitmap:f,width:b,height:v,left:x,top:Q,advance:Z}=A.readMessage(i3,{});r.push({id:u,bitmap:new Kl({width:b+2*xm,height:v+2*xm},f),metrics:{width:b,height:v,left:x,top:Q,advance:Z}})}}function i3(a,r,A){a===1?r.id=A.readVarint():a===2?r.bitmap=A.readBytes():a===3?r.width=A.readVarint():a===4?r.height=A.readVarint():a===5?r.left=A.readSVarint():a===6?r.top=A.readSVarint():a===7&&(r.advance=A.readVarint())}let v1=xm;function w1(a){let r=0,A=0;for(let v of a)r+=v.w*v.h,A=Math.max(A,v.w);a.sort((v,x)=>x.h-v.h);let u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),A),h:1/0}],f=0,b=0;for(let v of a)for(let x=u.length-1;x>=0;x--){let Q=u[x];if(!(v.w>Q.w||v.h>Q.h)){if(v.x=Q.x,v.y=Q.y,b=Math.max(b,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===Q.w&&v.h===Q.h){let Z=u.pop();x<u.length&&(u[x]=Z)}else v.h===Q.h?(Q.x+=v.w,Q.w-=v.w):v.w===Q.w?(Q.y+=v.h,Q.h-=v.h):(u.push({x:Q.x+v.w,y:Q.y,w:Q.w-v.w,h:v.h}),Q.y+=v.h,Q.h-=v.h);break}}return{w:f,h:b,fill:r/(f*b)||0}}let bo=1;class Sm{constructor(r,{pixelRatio:A,version:u,stretchX:f,stretchY:b,content:v}){this.paddedRect=r,this.pixelRatio=A,this.stretchX=f,this.stretchY=b,this.content=v,this.version=u}get tl(){return[this.paddedRect.x+bo,this.paddedRect.y+bo]}get br(){return[this.paddedRect.x+this.paddedRect.w-bo,this.paddedRect.y+this.paddedRect.h-bo]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*bo)/this.pixelRatio,(this.paddedRect.h-2*bo)/this.pixelRatio]}}class B1{constructor(r,A){let u={},f={};this.haveRenderCallbacks=[];let b=[];this.addImages(r,u,b),this.addImages(A,f,b);let{w:v,h:x}=w1(b),Q=new yo({width:v||1,height:x||1});for(let Z in r){let M=r[Z],J=u[Z].paddedRect;yo.copy(M.data,Q,{x:0,y:0},{x:J.x+bo,y:J.y+bo},M.data)}for(let Z in A){let M=A[Z],J=f[Z].paddedRect,it=J.x+bo,ot=J.y+bo,at=M.data.width,Bt=M.data.height;yo.copy(M.data,Q,{x:0,y:0},{x:it,y:ot},M.data),yo.copy(M.data,Q,{x:0,y:Bt-1},{x:it,y:ot-1},{width:at,height:1}),yo.copy(M.data,Q,{x:0,y:0},{x:it,y:ot+Bt},{width:at,height:1}),yo.copy(M.data,Q,{x:at-1,y:0},{x:it-1,y:ot},{width:1,height:Bt}),yo.copy(M.data,Q,{x:0,y:0},{x:it+at,y:ot},{width:1,height:Bt})}this.image=Q,this.iconPositions=u,this.patternPositions=f}addImages(r,A,u){for(let f in r){let b=r[f],v={x:0,y:0,w:b.data.width+2*bo,h:b.data.height+2*bo};u.push(v),A[f]=new Sm(v,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(r,A){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let u in r.updatedImages)this.patchUpdatedImage(this.iconPositions[u],r.getImage(u),A),this.patchUpdatedImage(this.patternPositions[u],r.getImage(u),A)}patchUpdatedImage(r,A,u){if(!r||!A||r.version===A.version)return;r.version=A.version;let[f,b]=r.tl;u.update(A.data,void 0,{x:f,y:b})}}var zl;li("ImagePosition",Sm),li("ImageAtlas",B1),n.ai=void 0,(zl=n.ai||(n.ai={}))[zl.none=0]="none",zl[zl.horizontal=1]="horizontal",zl[zl.vertical=2]="vertical",zl[zl.horizontalOnly=3]="horizontalOnly";let Rh=-17;class Zh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,A){let u=new Zh;return u.scale=r||1,u.fontStack=A,u}static forImage(r){let A=new Zh;return A.imageName=r,A}}class wu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,A){let u=new wu;for(let f=0;f<r.sections.length;f++){let b=r.sections[f];b.image?u.addImageSection(b):u.addTextSection(b,A)}return u}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let A="";for(let u=0;u<r.length;u++){let f=r.charCodeAt(u+1)||null,b=r.charCodeAt(u-1)||null;A+=f&&_s(f)&&!Gh[r[u+1]]||b&&_s(b)&&!Gh[r[u-1]]||!Gh[r[u]]?r[u]:Gh[r[u]]}return A}(this.text)}trim(){let r=0;for(let u=0;u<this.text.length&&ud[this.text.charCodeAt(u)];u++)r++;let A=this.text.length;for(let u=this.text.length-1;u>=0&&u>=r&&ud[this.text.charCodeAt(u)];u--)A--;this.text=this.text.substring(r,A),this.sectionIndex=this.sectionIndex.slice(r,A)}substring(r,A){let u=new wu;return u.text=this.text.substring(r,A),u.sectionIndex=this.sectionIndex.slice(r,A),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,A)=>Math.max(r,this.sections[A].scale),0)}addTextSection(r,A){this.text+=r.text,this.sections.push(Zh.forText(r.scale,r.fontStack||A));let u=this.sections.length-1;for(let f=0;f<r.text.length;++f)this.sectionIndex.push(u)}addImageSection(r){let A=r.image?r.image.name:"";if(A.length===0)return void At("Can't add FormattedSection with an empty image.");let u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Zh.forImage(A)),this.sectionIndex.push(this.sections.length-1)):At("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function cd(a,r,A,u,f,b,v,x,Q,Z,M,J,it,ot,at,Bt){let Gt=wu.fromFeature(a,f),Mt;J===n.ai.vertical&&Gt.verticalizePunctuation();let{processBidirectionalText:ne,processStyledBidirectionalText:Yt}=xs;if(ne&&Gt.sections.length===1){Mt=[];let Ge=ne(Gt.toString(),Fm(Gt,Z,b,r,u,ot,at));for(let ci of Ge){let Si=new wu;Si.text=ci,Si.sections=Gt.sections;for(let Ai=0;Ai<ci.length;Ai++)Si.sectionIndex.push(0);Mt.push(Si)}}else if(Yt){Mt=[];let Ge=Yt(Gt.text,Gt.sectionIndex,Fm(Gt,Z,b,r,u,ot,at));for(let ci of Ge){let Si=new wu;Si.text=ci[0],Si.sectionIndex=ci[1],Si.sections=Gt.sections,Mt.push(Si)}}else Mt=function(Ge,ci){let Si=[],Ai=Ge.text,oi=0;for(let ii of ci)Si.push(Ge.substring(oi,ii)),oi=ii;return oi<Ai.length&&Si.push(Ge.substring(oi,Ai.length)),Si}(Gt,Fm(Gt,Z,b,r,u,ot,at));let Ae=[],ye={positionedLines:Ae,text:Gt.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:J,iconsInText:!1,verticalizable:!1};return function(Ge,ci,Si,Ai,oi,ii,vi,ni,Oe,Hi,ki,hr){let nn=0,un=Rh,Wn=0,Oo=0,to=ni==="right"?1:ni==="left"?0:.5,Hn=0;for(let zn of oi){zn.trim();let Jn=zn.getMaxScale(),Ms=(Jn-1)*On,ro={positionedGlyphs:[],lineOffset:0};Ge.positionedLines[Hn]=ro;let Vs=ro.positionedGlyphs,vo=0;if(!zn.length()){un+=ii,++Hn;continue}for(let Xn=0;Xn<zn.length();Xn++){let mr=zn.getSection(Xn),Ds=zn.getSectionIndex(Xn),ks=zn.getCharCode(Xn),Yn=0,Fa=null,tA=null,eA=null,ul=On,ka=!(Oe===n.ai.horizontal||!ki&&!SA(ks)||ki&&(ud[ks]||(bs=ks,ai.Arabic(bs)||ai["Arabic Supplement"](bs)||ai["Arabic Extended-A"](bs)||ai["Arabic Presentation Forms-A"](bs)||ai["Arabic Presentation Forms-B"](bs))));if(mr.imageName){let ha=Ai[mr.imageName];if(!ha)continue;eA=mr.imageName,Ge.iconsInText=Ge.iconsInText||!0,tA=ha.paddedRect;let Bo=ha.displaySize;mr.scale=mr.scale*On/hr,Fa={width:Bo[0],height:Bo[1],left:bo,top:-v1,advance:ka?Bo[1]:Bo[0]},Yn=Ms+(On-Bo[1]*mr.scale),ul=Fa.advance;let hl=ka?Bo[0]*mr.scale-On*Jn:Bo[1]*mr.scale-On*Jn;hl>0&&hl>vo&&(vo=hl)}else{let ha=Si[mr.fontStack],Bo=ha&&ha[ks];if(Bo&&Bo.rect)tA=Bo.rect,Fa=Bo.metrics;else{let hl=ci[mr.fontStack],Vh=hl&&hl[ks];if(!Vh)continue;Fa=Vh.metrics}Yn=(Jn-mr.scale)*On}ka?(Ge.verticalizable=!0,Vs.push({glyph:ks,imageName:eA,x:nn,y:un+Yn,vertical:ka,scale:mr.scale,fontStack:mr.fontStack,sectionIndex:Ds,metrics:Fa,rect:tA}),nn+=ul*mr.scale+Hi):(Vs.push({glyph:ks,imageName:eA,x:nn,y:un+Yn,vertical:ka,scale:mr.scale,fontStack:mr.fontStack,sectionIndex:Ds,metrics:Fa,rect:tA}),nn+=Fa.advance*mr.scale+Hi)}Vs.length!==0&&(Wn=Math.max(nn-Hi,Wn),s3(Vs,0,Vs.length-1,to,vo)),nn=0;let wo=ii*Jn+vo;ro.lineOffset=Math.max(vo,Ms),un+=wo,Oo=Math.max(wo,Oo),++Hn}var bs;let Fs=un-Rh,{horizontalAlign:eo,verticalAlign:io}=km(vi);(function(zn,Jn,Ms,ro,Vs,vo,wo,Xn,mr){let Ds=(Jn-Ms)*Vs,ks=0;ks=vo!==wo?-Xn*ro-Rh:(-ro*mr+.5)*wo;for(let Yn of zn)for(let Fa of Yn.positionedGlyphs)Fa.x+=Ds,Fa.y+=ks})(Ge.positionedLines,to,eo,io,Wn,Oo,ii,Fs,oi.length),Ge.top+=-io*Fs,Ge.bottom=Ge.top+Fs,Ge.left+=-eo*Wn,Ge.right=Ge.left+Wn}(ye,r,A,u,Mt,v,x,Q,J,Z,it,Bt),!function(Ge){for(let ci of Ge)if(ci.positionedGlyphs.length!==0)return!1;return!0}(Ae)&&ye}let ud={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},r3={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function _1(a,r,A,u,f,b){if(r.imageName){let v=u[r.imageName];return v?v.displaySize[0]*r.scale*On/b+f:0}{let v=A[r.fontStack],x=v&&v[a];return x?x.metrics.advance*r.scale+f:0}}function x1(a,r,A,u){let f=Math.pow(a-r,2);return u?a<r?f/2:2*f:f+Math.abs(A)*A}function n3(a,r,A){let u=0;return a===10&&(u-=1e4),A&&(u+=150),a!==40&&a!==65288||(u+=50),r!==41&&r!==65289||(u+=50),u}function S1(a,r,A,u,f,b){let v=null,x=x1(r,A,f,b);for(let Q of u){let Z=x1(r-Q.x,A,f,b)+Q.badness;Z<=x&&(v=Q,x=Z)}return{index:a,x:r,priorBreak:v,badness:x}}function F1(a){return a?F1(a.priorBreak).concat(a.index):[]}function Fm(a,r,A,u,f,b,v){if(b!=="point")return[];if(!a)return[];let x=[],Q=function(it,ot,at,Bt,Gt,Mt){let ne=0;for(let Yt=0;Yt<it.length();Yt++){let Ae=it.getSection(Yt);ne+=_1(it.getCharCode(Yt),Ae,Bt,Gt,ot,Mt)}return ne/Math.max(1,Math.ceil(ne/at))}(a,r,A,u,f,v),Z=a.text.indexOf("\u200B")>=0,M=0;for(let it=0;it<a.length();it++){let ot=a.getSection(it),at=a.getCharCode(it);if(ud[at]||(M+=_1(at,ot,u,f,r,v)),it<a.length()-1){let Bt=!((J=at)<11904||!(ai["Bopomofo Extended"](J)||ai.Bopomofo(J)||ai["CJK Compatibility Forms"](J)||ai["CJK Compatibility Ideographs"](J)||ai["CJK Compatibility"](J)||ai["CJK Radicals Supplement"](J)||ai["CJK Strokes"](J)||ai["CJK Symbols and Punctuation"](J)||ai["CJK Unified Ideographs Extension A"](J)||ai["CJK Unified Ideographs"](J)||ai["Enclosed CJK Letters and Months"](J)||ai["Halfwidth and Fullwidth Forms"](J)||ai.Hiragana(J)||ai["Ideographic Description Characters"](J)||ai["Kangxi Radicals"](J)||ai["Katakana Phonetic Extensions"](J)||ai.Katakana(J)||ai["Vertical Forms"](J)||ai["Yi Radicals"](J)||ai["Yi Syllables"](J)));(r3[at]||Bt||ot.imageName)&&x.push(S1(it+1,M,Q,x,n3(at,a.getCharCode(it+1),Bt&&Z),!1))}}var J;return F1(S1(a.length(),M,Q,x,0,!0))}function km(a){let r=.5,A=.5;switch(a){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":A=1;break;case"top":case"top-right":case"top-left":A=0}return{horizontalAlign:r,verticalAlign:A}}function s3(a,r,A,u,f){if(!u&&!f)return;let b=a[A],v=(a[A].x+b.metrics.advance*b.scale)*u;for(let x=r;x<=A;x++)a[x].x-=v,a[x].y+=f}function o3(a,r,A){let{horizontalAlign:u,verticalAlign:f}=km(A),b=r[0]-a.displaySize[0]*u,v=r[1]-a.displaySize[1]*f;return{image:a,top:v,bottom:v+a.displaySize[1],left:b,right:b+a.displaySize[0]}}function k1(a,r,A,u,f,b){let v=a.image,x;if(v.content){let Gt=v.content,Mt=v.pixelRatio||1;x=[Gt[0]/Mt,Gt[1]/Mt,v.displaySize[0]-Gt[2]/Mt,v.displaySize[1]-Gt[3]/Mt]}let Q=r.left*b,Z=r.right*b,M,J,it,ot;A==="width"||A==="both"?(ot=f[0]+Q-u[3],J=f[0]+Z+u[1]):(ot=f[0]+(Q+Z-v.displaySize[0])/2,J=ot+v.displaySize[0]);let at=r.top*b,Bt=r.bottom*b;return A==="height"||A==="both"?(M=f[1]+at-u[0],it=f[1]+Bt+u[2]):(M=f[1]+(at+Bt-v.displaySize[1])/2,it=M+v.displaySize[1]),{image:v,top:M,right:J,bottom:it,left:ot,collisionPadding:x}}let Hh=255,GA=128,Jl=Hh*GA;function L1(a,r){let{expression:A}=r;if(A.kind==="constant")return{kind:"constant",layoutSize:A.evaluate(new Yr(a+1))};if(A.kind==="source")return{kind:"source"};{let{zoomStops:u,interpolationType:f}=A,b=0;for(;b<u.length&&u[b]<=a;)b++;b=Math.max(0,b-1);let v=b;for(;v<u.length&&u[v]<a+1;)v++;v=Math.min(u.length-1,v);let x=u[b],Q=u[v];return A.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:Q,interpolationType:f}:{kind:"camera",minZoom:x,maxZoom:Q,minSize:A.evaluate(new Yr(x)),maxSize:A.evaluate(new Yr(Q)),interpolationType:f}}}function Lm(a,r,A){let u="never",f=a.get(r);return f?u=f:a.get(A)&&(u="always"),u}let a3=Wl.VectorTileFeature.types,A3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function hd(a,r,A,u,f,b,v,x,Q,Z,M,J,it){let ot=x?Math.min(Jl,Math.round(x[0])):0,at=x?Math.min(Jl,Math.round(x[1])):0;a.emplaceBack(r,A,Math.round(32*u),Math.round(32*f),b,v,(ot<<1)+(Q?1:0),at,16*Z,16*M,256*J,256*it)}function Em(a,r,A){a.emplaceBack(r.x,r.y,A),a.emplaceBack(r.x,r.y,A),a.emplaceBack(r.x,r.y,A),a.emplaceBack(r.x,r.y,A)}function l3(a){for(let r of a.sections)if(El(r.text))return!0;return!1}class Tm{constructor(r){this.layoutVertexArray=new Wt,this.indexArray=new $e,this.programConfigurations=r,this.segments=new Vi,this.dynamicLayoutVertexArray=new Ie,this.opacityVertexArray=new we,this.hasVisibleVertices=!1,this.placedSymbolArray=new w}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,A,u,f){this.isEmpty()||(u&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,PS.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,A),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,MS.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,A3,!0),this.opacityVertexBuffer.itemSize=1),(u||f)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}li("SymbolBuffers",Tm);class Qm{constructor(r,A,u){this.layoutVertexArray=new r,this.layoutAttributes=A,this.indexArray=new u,this.segments=new Vi,this.collisionVertexArray=new je}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,VS.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}li("CollisionBuffers",Qm);class Bu{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(v=>v.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=vh([]),this.placementViewportMatrix=vh([]);let A=this.layers[0]._unevaluatedLayout._values;this.textSizeData=L1(this.zoom,A["text-size"]),this.iconSizeData=L1(this.zoom,A["icon-size"]);let u=this.layers[0].layout,f=u.get("symbol-sort-key"),b=u.get("symbol-z-order");this.canOverlap=Lm(u,"text-overlap","text-allow-overlap")!=="never"||Lm(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(v=>n.ai[v])),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=r.sourceID}createArrays(){this.text=new Tm(new Do(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new Tm(new Do(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new H,this.lineVertexArray=new V,this.symbolInstances=new T,this.textAnchorOffsets=new X}calculateGlyphDependencies(r,A,u,f,b){for(let v=0;v<r.length;v++)if(A[r.charCodeAt(v)]=!0,(u||f)&&b){let x=Gh[r.charAt(v)];x&&(A[x.charCodeAt(0)]=!0)}}populate(r,A,u){let f=this.layers[0],b=f.layout,v=b.get("text-font"),x=b.get("text-field"),Q=b.get("icon-image"),Z=(x.value.kind!=="constant"||x.value.value instanceof dn&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),M=Q.value.kind!=="constant"||!!Q.value.value||Object.keys(Q.parameters).length>0,J=b.get("symbol-sort-key");if(this.features=[],!Z&&!M)return;let it=A.iconDependencies,ot=A.glyphDependencies,at=A.availableImages,Bt=new Yr(this.zoom);for(let{feature:Gt,id:Mt,index:ne,sourceLayerIndex:Yt}of r){let Ae=f._featureFilter.needGeometry,ye=TA(Gt,Ae);if(!f._featureFilter.filter(Bt,ye,u))continue;let Ge,ci;if(Ae||(ye.geometry=Ko(Gt)),Z){let Ai=f.getValueAndResolveTokens("text-field",ye,u,at),oi=dn.factory(Ai);l3(oi)&&(this.hasRTLText=!0),(!this.hasRTLText||vc()==="unavailable"||this.hasRTLText&&xs.isParsed())&&(Ge=KS(oi,f,ye))}if(M){let Ai=f.getValueAndResolveTokens("icon-image",ye,u,at);ci=Ai instanceof zr?Ai:zr.fromString(Ai)}if(!Ge&&!ci)continue;let Si=this.sortFeaturesByKey?J.evaluate(ye,{},u):void 0;if(this.features.push({id:Mt,text:Ge,icon:ci,index:ne,sourceLayerIndex:Yt,geometry:ye.geometry,properties:Gt.properties,type:a3[Gt.type],sortKey:Si}),ci&&(it[ci.name]=!0),Ge){let Ai=v.evaluate(ye,{},u).join(","),oi=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(n.ai.vertical)>=0;for(let ii of Ge.sections)if(ii.image)it[ii.image.name]=!0;else{let vi=kl(Ge.toString()),ni=ii.fontStack||Ai,Oe=ot[ni]=ot[ni]||{};this.calculateGlyphDependencies(ii.text,Oe,oi,this.allowVerticalPlacement,vi)}}}b.get("symbol-placement")==="line"&&(this.features=function(Gt){let Mt={},ne={},Yt=[],Ae=0;function ye(Ai){Yt.push(Gt[Ai]),Ae++}function Ge(Ai,oi,ii){let vi=ne[Ai];return delete ne[Ai],ne[oi]=vi,Yt[vi].geometry[0].pop(),Yt[vi].geometry[0]=Yt[vi].geometry[0].concat(ii[0]),vi}function ci(Ai,oi,ii){let vi=Mt[oi];return delete Mt[oi],Mt[Ai]=vi,Yt[vi].geometry[0].shift(),Yt[vi].geometry[0]=ii[0].concat(Yt[vi].geometry[0]),vi}function Si(Ai,oi,ii){let vi=ii?oi[0][oi[0].length-1]:oi[0][0];return`${Ai}:${vi.x}:${vi.y}`}for(let Ai=0;Ai<Gt.length;Ai++){let oi=Gt[Ai],ii=oi.geometry,vi=oi.text?oi.text.toString():null;if(!vi){ye(Ai);continue}let ni=Si(vi,ii),Oe=Si(vi,ii,!0);if(ni in ne&&Oe in Mt&&ne[ni]!==Mt[Oe]){let Hi=ci(ni,Oe,ii),ki=Ge(ni,Oe,Yt[Hi].geometry);delete Mt[ni],delete ne[Oe],ne[Si(vi,Yt[ki].geometry,!0)]=ki,Yt[Hi].geometry=null}else ni in ne?Ge(ni,Oe,ii):Oe in Mt?ci(ni,Oe,ii):(ye(Ai),Mt[ni]=Ae-1,ne[Oe]=Ae-1)}return Yt.filter(Ai=>Ai.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Gt,Mt)=>Gt.sortKey-Mt.sortKey)}update(r,A,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,A,this.layers,u),this.icon.programConfigurations.updatePaintArrays(r,A,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,A){let u=this.lineVertexArray.length;if(r.segment!==void 0){let f=r.dist(A[r.segment+1]),b=r.dist(A[r.segment]),v={};for(let x=r.segment+1;x<A.length;x++)v[x]={x:A[x].x,y:A[x].y,tileUnitDistanceFromAnchor:f},x<A.length-1&&(f+=A[x+1].dist(A[x]));for(let x=r.segment||0;x>=0;x--)v[x]={x:A[x].x,y:A[x].y,tileUnitDistanceFromAnchor:b},x>0&&(b+=A[x-1].dist(A[x]));for(let x=0;x<A.length;x++){let Q=v[x];this.lineVertexArray.emplaceBack(Q.x,Q.y,Q.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(r,A,u,f,b,v,x,Q,Z,M,J,it){let ot=r.indexArray,at=r.layoutVertexArray,Bt=r.segments.prepareSegment(4*A.length,at,ot,this.canOverlap?v.sortKey:void 0),Gt=this.glyphOffsetArray.length,Mt=Bt.vertexLength,ne=this.allowVerticalPlacement&&x===n.ai.vertical?Math.PI/2:0,Yt=v.text&&v.text.sections;for(let Ae=0;Ae<A.length;Ae++){let{tl:ye,tr:Ge,bl:ci,br:Si,tex:Ai,pixelOffsetTL:oi,pixelOffsetBR:ii,minFontScaleX:vi,minFontScaleY:ni,glyphOffset:Oe,isSDF:Hi,sectionIndex:ki}=A[Ae],hr=Bt.vertexLength,nn=Oe[1];hd(at,Q.x,Q.y,ye.x,nn+ye.y,Ai.x,Ai.y,u,Hi,oi.x,oi.y,vi,ni),hd(at,Q.x,Q.y,Ge.x,nn+Ge.y,Ai.x+Ai.w,Ai.y,u,Hi,ii.x,oi.y,vi,ni),hd(at,Q.x,Q.y,ci.x,nn+ci.y,Ai.x,Ai.y+Ai.h,u,Hi,oi.x,ii.y,vi,ni),hd(at,Q.x,Q.y,Si.x,nn+Si.y,Ai.x+Ai.w,Ai.y+Ai.h,u,Hi,ii.x,ii.y,vi,ni),Em(r.dynamicLayoutVertexArray,Q,ne),ot.emplaceBack(hr,hr+1,hr+2),ot.emplaceBack(hr+1,hr+2,hr+3),Bt.vertexLength+=4,Bt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Oe[0]),Ae!==A.length-1&&ki===A[Ae+1].sectionIndex||r.programConfigurations.populatePaintArrays(at.length,v,v.index,{},it,Yt&&Yt[ki])}r.placedSymbolArray.emplaceBack(Q.x,Q.y,Gt,this.glyphOffsetArray.length-Gt,Mt,Z,M,Q.segment,u?u[0]:0,u?u[1]:0,f[0],f[1],x,0,!1,0,J)}_addCollisionDebugVertex(r,A,u,f,b,v){return A.emplaceBack(0,0),r.emplaceBack(u.x,u.y,f,b,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(r,A,u,f,b,v,x){let Q=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),Z=Q.vertexLength,M=b.layoutVertexArray,J=b.collisionVertexArray,it=x.anchorX,ot=x.anchorY;this._addCollisionDebugVertex(M,J,v,it,ot,new _(r,A)),this._addCollisionDebugVertex(M,J,v,it,ot,new _(u,A)),this._addCollisionDebugVertex(M,J,v,it,ot,new _(u,f)),this._addCollisionDebugVertex(M,J,v,it,ot,new _(r,f)),Q.vertexLength+=4;let at=b.indexArray;at.emplaceBack(Z,Z+1),at.emplaceBack(Z+1,Z+2),at.emplaceBack(Z+2,Z+3),at.emplaceBack(Z+3,Z),Q.primitiveLength+=4}addDebugCollisionBoxes(r,A,u,f){for(let b=r;b<A;b++){let v=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,f?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Qm(Le,d1.members,wi),this.iconCollisionBox=new Qm(Le,d1.members,wi);for(let r=0;r<this.symbolInstances.length;r++){let A=this.symbolInstances.get(r);this.addDebugCollisionBoxes(A.textBoxStartIndex,A.textBoxEndIndex,A,!0),this.addDebugCollisionBoxes(A.verticalTextBoxStartIndex,A.verticalTextBoxEndIndex,A,!0),this.addDebugCollisionBoxes(A.iconBoxStartIndex,A.iconBoxEndIndex,A,!1),this.addDebugCollisionBoxes(A.verticalIconBoxStartIndex,A.verticalIconBoxEndIndex,A,!1)}}_deserializeCollisionBoxesForSymbol(r,A,u,f,b,v,x,Q,Z){let M={};for(let J=A;J<u;J++){let it=r.get(J);M.textBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},M.textFeatureIndex=it.featureIndex;break}for(let J=f;J<b;J++){let it=r.get(J);M.verticalTextBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},M.verticalTextFeatureIndex=it.featureIndex;break}for(let J=v;J<x;J++){let it=r.get(J);M.iconBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},M.iconFeatureIndex=it.featureIndex;break}for(let J=Q;J<Z;J++){let it=r.get(J);M.verticalIconBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},M.verticalIconFeatureIndex=it.featureIndex;break}return M}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let A=0;A<this.symbolInstances.length;A++){let u=this.symbolInstances.get(A);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,A){let u=r.placedSymbolArray.get(A),f=u.vertexStartIndex+4*u.numGlyphs;for(let b=u.vertexStartIndex;b<f;b+=4)r.indexArray.emplaceBack(b,b+1,b+2),r.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let A=Math.sin(r),u=Math.cos(r),f=[],b=[],v=[];for(let x=0;x<this.symbolInstances.length;++x){v.push(x);let Q=this.symbolInstances.get(x);f.push(0|Math.round(A*Q.anchorX+u*Q.anchorY)),b.push(Q.featureIndex)}return v.sort((x,Q)=>f[x]-f[Q]||b[Q]-b[x]),v}addToSortKeyRanges(r,A){let u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===A?u.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:A,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let A of this.symbolInstanceIndexes){let u=this.symbolInstances.get(A);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((f,b,v)=>{f>=0&&v.indexOf(f)===b&&this.addIndicesForPlacedSymbol(this.text,f)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let E1,T1;li("SymbolBucket",Bu,{omit:["layers","collisionBoxArray","features","compareText"]}),Bu.MAX_GLYPHS=65535,Bu.addDynamicAttributes=Em;var Um={get paint(){return T1=T1||new yn({"icon-opacity":new Ni($t.paint_symbol["icon-opacity"]),"icon-color":new Ni($t.paint_symbol["icon-color"]),"icon-halo-color":new Ni($t.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ni($t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ni($t.paint_symbol["icon-halo-blur"]),"icon-translate":new Fi($t.paint_symbol["icon-translate"]),"icon-translate-anchor":new Fi($t.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ni($t.paint_symbol["text-opacity"]),"text-color":new Ni($t.paint_symbol["text-color"],{runtimeType:Oi,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Ni($t.paint_symbol["text-halo-color"]),"text-halo-width":new Ni($t.paint_symbol["text-halo-width"]),"text-halo-blur":new Ni($t.paint_symbol["text-halo-blur"]),"text-translate":new Fi($t.paint_symbol["text-translate"]),"text-translate-anchor":new Fi($t.paint_symbol["text-translate-anchor"])})},get layout(){return E1=E1||new yn({"symbol-placement":new Fi($t.layout_symbol["symbol-placement"]),"symbol-spacing":new Fi($t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Fi($t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ni($t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Fi($t.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Fi($t.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Fi($t.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Fi($t.layout_symbol["icon-ignore-placement"]),"icon-optional":new Fi($t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Fi($t.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ni($t.layout_symbol["icon-size"]),"icon-text-fit":new Fi($t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Fi($t.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ni($t.layout_symbol["icon-image"]),"icon-rotate":new Ni($t.layout_symbol["icon-rotate"]),"icon-padding":new Ni($t.layout_symbol["icon-padding"]),"icon-keep-upright":new Fi($t.layout_symbol["icon-keep-upright"]),"icon-offset":new Ni($t.layout_symbol["icon-offset"]),"icon-anchor":new Ni($t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Fi($t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Fi($t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Fi($t.layout_symbol["text-rotation-alignment"]),"text-field":new Ni($t.layout_symbol["text-field"]),"text-font":new Ni($t.layout_symbol["text-font"]),"text-size":new Ni($t.layout_symbol["text-size"]),"text-max-width":new Ni($t.layout_symbol["text-max-width"]),"text-line-height":new Fi($t.layout_symbol["text-line-height"]),"text-letter-spacing":new Ni($t.layout_symbol["text-letter-spacing"]),"text-justify":new Ni($t.layout_symbol["text-justify"]),"text-radial-offset":new Ni($t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Fi($t.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ni($t.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ni($t.layout_symbol["text-anchor"]),"text-max-angle":new Fi($t.layout_symbol["text-max-angle"]),"text-writing-mode":new Fi($t.layout_symbol["text-writing-mode"]),"text-rotate":new Ni($t.layout_symbol["text-rotate"]),"text-padding":new Fi($t.layout_symbol["text-padding"]),"text-keep-upright":new Fi($t.layout_symbol["text-keep-upright"]),"text-transform":new Ni($t.layout_symbol["text-transform"]),"text-offset":new Ni($t.layout_symbol["text-offset"]),"text-allow-overlap":new Fi($t.layout_symbol["text-allow-overlap"]),"text-overlap":new Fi($t.layout_symbol["text-overlap"]),"text-ignore-placement":new Fi($t.layout_symbol["text-ignore-placement"]),"text-optional":new Fi($t.layout_symbol["text-optional"])})}};class Q1{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:vr,this.defaultValue=r}evaluate(r){if(r.formattedSection){let A=this.defaultValue.property.overrides;if(A&&A.hasOverride(r.formattedSection))return A.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}li("FormatSectionOverride",Q1,{omit:["defaultValue"]});class gd extends Cn{constructor(r){super(r,Um)}recalculate(r,A){if(super.recalculate(r,A),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let u=this.layout.get("text-writing-mode");if(u){let f=[];for(let b of u)f.indexOf(b)<0&&f.push(b);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,A,u,f){let b=this.layout.get(r).evaluate(A,{},u,f),v=this._unevaluatedLayout._values[r];return v.isDataDriven()||Jr(v.value)||!b?b:function(x,Q){return Q.replace(/{([^{}]+)}/g,(Z,M)=>x&&M in x?String(x[M]):"")}(A.properties,b)}createBucket(r){return new Bu(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let r of Um.paint.overridableProperties){if(!gd.hasPaintOverride(this.layout,r))continue;let A=this.paint.get(r),u=new Q1(A),f=new Cr(u,A.property.specification),b=null;b=A.value.kind==="constant"||A.value.kind==="source"?new pn("source",f):new Sn("composite",f,A.value.zoomStops),this.paint._values[r]=new Fn(A.property,b,A.parameters)}}_handleOverridablePaintPropertyUpdate(r,A,u){return!(!this.layout||A.isDataDriven()||u.isDataDriven())&&gd.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,A){let u=r.get("text-field"),f=Um.paint.properties[A],b=!1,v=x=>{for(let Q of x)if(f.overrides&&f.overrides.hasOverride(Q))return void(b=!0)};if(u.value.kind==="constant"&&u.value.value instanceof dn)v(u.value.value.sections);else if(u.value.kind==="source"){let x=Z=>{b||(Z instanceof Js&&Hr(Z.value)===gt?v(Z.value.sections):Z instanceof Za?v(Z.sections):Z.eachChild(x))},Q=u.value;Q._styleExpression&&x(Q._styleExpression.expression)}return b}}let U1;var c3={get paint(){return U1=U1||new yn({"background-color":new Fi($t.paint_background["background-color"]),"background-pattern":new _c($t.paint_background["background-pattern"]),"background-opacity":new Fi($t.paint_background["background-opacity"])})}};class u3 extends Cn{constructor(r){super(r,c3)}}let G1;var h3={get paint(){return G1=G1||new yn({"raster-opacity":new Fi($t.paint_raster["raster-opacity"]),"raster-hue-rotate":new Fi($t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Fi($t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Fi($t.paint_raster["raster-brightness-max"]),"raster-saturation":new Fi($t.paint_raster["raster-saturation"]),"raster-contrast":new Fi($t.paint_raster["raster-contrast"]),"raster-resampling":new Fi($t.paint_raster["raster-resampling"]),"raster-fade-duration":new Fi($t.paint_raster["raster-fade-duration"])})}};class g3 extends Cn{constructor(r){super(r,h3)}}class d3 extends Cn{constructor(r){super(r,{}),this.onAdd=A=>{this.implementation.onAdd&&this.implementation.onAdd(A,A.painter.context.gl)},this.onRemove=A=>{this.implementation.onRemove&&this.implementation.onRemove(A,A.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class p3{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}let Gm=63710088e-1;class Xl{constructor(r,A){if(isNaN(r)||isNaN(A))throw new Error(`Invalid LngLat object: (${r}, ${A})`);if(this.lng=+r,this.lat=+A,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Xl(Pt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){let A=Math.PI/180,u=this.lat*A,f=r.lat*A,b=Math.sin(u)*Math.sin(f)+Math.cos(u)*Math.cos(f)*Math.cos((r.lng-this.lng)*A);return Gm*Math.acos(Math.min(b,1))}static convert(r){if(r instanceof Xl)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new Xl(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new Xl(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let R1=2*Math.PI*Gm;function Z1(a){return R1*Math.cos(a*Math.PI/180)}function H1(a){return(180+a)/360}function N1(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function P1(a,r){return a/Z1(r)}function M1(a){return 360*a-180}function Rm(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class dd{constructor(r,A,u=0){this.x=+r,this.y=+A,this.z=+u}static fromLngLat(r,A=0){let u=Xl.convert(r);return new dd(H1(u.lng),N1(u.lat),P1(A,u.lat))}toLngLat(){return new Xl(M1(this.x),Rm(this.y))}toAltitude(){return this.z*Z1(Rm(this.y))}meterInMercatorCoordinateUnits(){return 1/R1*(r=Rm(this.y),1/Math.cos(r*Math.PI/180));var r}}function V1(a,r,A){var u=2*Math.PI*6378137/256/Math.pow(2,A);return[a*u-2*Math.PI*6378137/2,r*u-2*Math.PI*6378137/2]}class Zm{constructor(r,A,u){if(r<0||r>25||u<0||u>=Math.pow(2,r)||A<0||A>=Math.pow(2,r))throw new Error(`x=${A}, y=${u}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=A,this.y=u,this.key=Nh(0,r,r,A,u)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,A,u){let f=(v=this.y,x=this.z,Q=V1(256*(b=this.x),256*(v=Math.pow(2,x)-v-1),x),Z=V1(256*(b+1),256*(v+1),x),Q[0]+","+Q[1]+","+Z[0]+","+Z[1]);var b,v,x,Q,Z;let M=function(J,it,ot){let at,Bt="";for(let Gt=J;Gt>0;Gt--)at=1<<Gt-1,Bt+=(it&at?1:0)+(ot&at?2:0);return Bt}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,A>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,f)}isChildOf(r){let A=this.z-r.z;return A>0&&r.x===this.x>>A&&r.y===this.y>>A}getTilePoint(r){let A=Math.pow(2,this.z);return new _((r.x*A-this.x)*cn,(r.y*A-this.y)*cn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class D1{constructor(r,A){this.wrap=r,this.canonical=A,this.key=Nh(r,A.z,A.z,A.x,A.y)}}class ua{constructor(r,A,u,f,b){if(r<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${u}`);this.overscaledZ=r,this.wrap=A,this.canonical=new Zm(u,+f,+b),this.key=Nh(A,r,u,f,b)}clone(){return new ua(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);let A=this.canonical.z-r;return r>this.canonical.z?new ua(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ua(r,this.wrap,r,this.canonical.x>>A,this.canonical.y>>A)}calculateScaledKey(r,A){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);let u=this.canonical.z-r;return r>this.canonical.z?Nh(this.wrap*+A,r,this.canonical.z,this.canonical.x,this.canonical.y):Nh(this.wrap*+A,r,r,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(r){if(r.wrap!==this.wrap)return!1;let A=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>A&&r.canonical.y===this.canonical.y>>A}children(r){if(this.overscaledZ>=r)return[new ua(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let A=this.canonical.z+1,u=2*this.canonical.x,f=2*this.canonical.y;return[new ua(A,this.wrap,A,u,f),new ua(A,this.wrap,A,u+1,f),new ua(A,this.wrap,A,u,f+1),new ua(A,this.wrap,A,u+1,f+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new ua(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new ua(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new D1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new dd(r.x-this.wrap,r.y))}}function Nh(a,r,A,u,f){(a*=2)<0&&(a=-1*a-1);let b=1<<A;return(b*b*a+b*f+u).toString(36)+A.toString(36)+r.toString(36)}li("CanonicalTileID",Zm),li("OverscaledTileID",ua,{omit:["posMatrix"]});class K1{constructor(r,A,u,f=1,b=1,v=1,x=0){if(this.uid=r,A.height!==A.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void At(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=A.height;let Q=this.dim=A.height-2;switch(this.data=new Uint32Array(A.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=b,this.blueFactor=v,this.baseShift=x;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Z=0;Z<Q;Z++)this.data[this._idx(-1,Z)]=this.data[this._idx(0,Z)],this.data[this._idx(Q,Z)]=this.data[this._idx(Q-1,Z)],this.data[this._idx(Z,-1)]=this.data[this._idx(Z,0)],this.data[this._idx(Z,Q)]=this.data[this._idx(Z,Q-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(Q,-1)]=this.data[this._idx(Q-1,0)],this.data[this._idx(-1,Q)]=this.data[this._idx(0,Q-1)],this.data[this._idx(Q,Q)]=this.data[this._idx(Q-1,Q-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Z=0;Z<Q;Z++)for(let M=0;M<Q;M++){let J=this.get(Z,M);J>this.max&&(this.max=J),J<this.min&&(this.min=J)}}get(r,A){let u=new Uint8Array(this.data.buffer),f=4*this._idx(r,A);return this.unpack(u[f],u[f+1],u[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,A){if(r<-1||r>=this.dim+1||A<-1||A>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(A+1)*this.stride+(r+1)}unpack(r,A,u){return r*this.redFactor+A*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new yo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,A,u){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let f=A*this.dim,b=A*this.dim+this.dim,v=u*this.dim,x=u*this.dim+this.dim;switch(A){case-1:f=b-1;break;case 1:b=f+1}switch(u){case-1:v=x-1;break;case 1:x=v+1}let Q=-A*this.dim,Z=-u*this.dim;for(let M=v;M<x;M++)for(let J=f;J<b;J++)this.data[this._idx(J,M)]=r.data[this._idx(J+Q,M+Z)]}}li("DEMData",K1);class O1{constructor(r){this._stringToNumber={},this._numberToString=[];for(let A=0;A<r.length;A++){let u=r[A];this._stringToNumber[u]=A,this._numberToString[A]=u}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class W1{constructor(r,A,u,f,b){this.type="Feature",this._vectorTileFeature=r,r._z=A,r._x=u,r._y=f,this.properties=r.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){let r={geometry:this.geometry};for(let A in this)A!=="_geometry"&&A!=="_vectorTileFeature"&&(r[A]=this[A]);return r}}class z1{constructor(r,A){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Bs(cn,16,0),this.grid3D=new Bs(cn,16,0),this.featureIndexArray=new nt,this.promoteId=A}insert(r,A,u,f,b,v){let x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,f,b);let Q=v?this.grid3D:this.grid;for(let Z=0;Z<A.length;Z++){let M=A[Z],J=[1/0,1/0,-1/0,-1/0];for(let it=0;it<M.length;it++){let ot=M[it];J[0]=Math.min(J[0],ot.x),J[1]=Math.min(J[1],ot.y),J[2]=Math.max(J[2],ot.x),J[3]=Math.max(J[3],ot.y)}J[0]<cn&&J[1]<cn&&J[2]>=0&&J[3]>=0&&Q.insert(x,J[0],J[1],J[2],J[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Wl.VectorTile(new _m(this.rawTileData)).layers,this.sourceLayerCoder=new O1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,A,u,f){this.loadVTLayers();let b=r.params||{},v=cn/r.tileSize/r.scale,x=Na(b.filter),Q=r.queryGeometry,Z=r.queryPadding*v,M=X1(Q),J=this.grid.query(M.minX-Z,M.minY-Z,M.maxX+Z,M.maxY+Z),it=X1(r.cameraQueryGeometry),ot=this.grid3D.query(it.minX-Z,it.minY-Z,it.maxX+Z,it.maxY+Z,(Gt,Mt,ne,Yt)=>function(Ae,ye,Ge,ci,Si){for(let oi of Ae)if(ye<=oi.x&&Ge<=oi.y&&ci>=oi.x&&Si>=oi.y)return!0;let Ai=[new _(ye,Ge),new _(ye,Si),new _(ci,Si),new _(ci,Ge)];if(Ae.length>2){for(let oi of Ai)if(Pl(Ae,oi))return!0}for(let oi=0;oi<Ae.length-1;oi++)if(gm(Ae[oi],Ae[oi+1],Ai))return!0;return!1}(r.cameraQueryGeometry,Gt-Z,Mt-Z,ne+Z,Yt+Z));for(let Gt of ot)J.push(Gt);J.sort(f3);let at={},Bt;for(let Gt=0;Gt<J.length;Gt++){let Mt=J[Gt];if(Mt===Bt)continue;Bt=Mt;let ne=this.featureIndexArray.get(Mt),Yt=null;this.loadMatchingFeature(at,ne.bucketIndex,ne.sourceLayerIndex,ne.featureIndex,x,b.layers,b.availableImages,A,u,f,(Ae,ye,Ge)=>(Yt||(Yt=Ko(Ae)),ye.queryIntersectsFeature(Q,Ae,Ge,Yt,this.z,r.transform,v,r.pixelPosMatrix)))}return at}loadMatchingFeature(r,A,u,f,b,v,x,Q,Z,M,J){let it=this.bucketLayerIDs[A];if(v&&!function(Gt,Mt){for(let ne=0;ne<Gt.length;ne++)if(Mt.indexOf(Gt[ne])>=0)return!0;return!1}(v,it))return;let ot=this.sourceLayerCoder.decode(u),at=this.vtLayers[ot].feature(f);if(b.needGeometry){let Gt=TA(at,!0);if(!b.filter(new Yr(this.tileID.overscaledZ),Gt,this.tileID.canonical))return}else if(!b.filter(new Yr(this.tileID.overscaledZ),at))return;let Bt=this.getId(at,ot);for(let Gt=0;Gt<it.length;Gt++){let Mt=it[Gt];if(v&&v.indexOf(Mt)<0)continue;let ne=Q[Mt];if(!ne)continue;let Yt={};Bt&&M&&(Yt=M.getState(ne.sourceLayer||"_geojsonTileLayer",Bt));let Ae=Qt({},Z[Mt]);Ae.paint=J1(Ae.paint,ne.paint,at,Yt,x),Ae.layout=J1(Ae.layout,ne.layout,at,Yt,x);let ye=!J||J(at,ne,Yt);if(!ye)continue;let Ge=new W1(at,this.z,this.x,this.y,Bt);Ge.layer=Ae;let ci=r[Mt];ci===void 0&&(ci=r[Mt]=[]),ci.push({featureIndex:f,feature:Ge,intersectionZ:ye})}}lookupSymbolFeatures(r,A,u,f,b,v,x,Q){let Z={};this.loadVTLayers();let M=Na(b);for(let J of r)this.loadMatchingFeature(Z,u,f,J,M,v,x,Q,A);return Z}hasLayer(r){for(let A of this.bucketLayerIDs)for(let u of A)if(r===u)return!0;return!1}getId(r,A){let u=r.id;return this.promoteId&&(u=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[A]],typeof u=="boolean"&&(u=Number(u))),u}}function J1(a,r,A,u,f){return dt(a,(b,v)=>{let x=r instanceof Gl?r.get(v):null;return x&&x.evaluate?x.evaluate(A,u,f):x})}function X1(a){let r=1/0,A=1/0,u=-1/0,f=-1/0;for(let b of a)r=Math.min(r,b.x),A=Math.min(A,b.y),u=Math.max(u,b.x),f=Math.max(f,b.y);return{minX:r,minY:A,maxX:u,maxY:f}}function f3(a,r){return r-a}function Y1(a,r,A,u,f){let b=[];for(let v=0;v<a.length;v++){let x=a[v],Q;for(let Z=0;Z<x.length-1;Z++){let M=x[Z],J=x[Z+1];M.x<r&&J.x<r||(M.x<r?M=new _(r,M.y+(r-M.x)/(J.x-M.x)*(J.y-M.y))._round():J.x<r&&(J=new _(r,M.y+(r-M.x)/(J.x-M.x)*(J.y-M.y))._round()),M.y<A&&J.y<A||(M.y<A?M=new _(M.x+(A-M.y)/(J.y-M.y)*(J.x-M.x),A)._round():J.y<A&&(J=new _(M.x+(A-M.y)/(J.y-M.y)*(J.x-M.x),A)._round()),M.x>=u&&J.x>=u||(M.x>=u?M=new _(u,M.y+(u-M.x)/(J.x-M.x)*(J.y-M.y))._round():J.x>=u&&(J=new _(u,M.y+(u-M.x)/(J.x-M.x)*(J.y-M.y))._round()),M.y>=f&&J.y>=f||(M.y>=f?M=new _(M.x+(f-M.y)/(J.y-M.y)*(J.x-M.x),f)._round():J.y>=f&&(J=new _(M.x+(f-M.y)/(J.y-M.y)*(J.x-M.x),f)._round()),Q&&M.equals(Q[Q.length-1])||(Q=[M],b.push(Q)),Q.push(J)))))}}return b}li("FeatureIndex",z1,{omit:["rawTileData","sourceLayerCoder"]});class Yl extends _{constructor(r,A,u,f){super(r,A),this.angle=u,f!==void 0&&(this.segment=f)}clone(){return new Yl(this.x,this.y,this.angle,this.segment)}}function j1(a,r,A,u,f){if(r.segment===void 0||A===0)return!0;let b=r,v=r.segment+1,x=0;for(;x>-A/2;){if(v--,v<0)return!1;x-=a[v].dist(b),b=a[v]}x+=a[v].dist(a[v+1]),v++;let Q=[],Z=0;for(;x<A/2;){let M=a[v],J=a[v+1];if(!J)return!1;let it=a[v-1].angleTo(M)-M.angleTo(J);for(it=Math.abs((it+3*Math.PI)%(2*Math.PI)-Math.PI),Q.push({distance:x,angleDelta:it}),Z+=it;x-Q[0].distance>u;)Z-=Q.shift().angleDelta;if(Z>f)return!1;v++,x+=M.dist(J)}return!0}function q1(a){let r=0;for(let A=0;A<a.length-1;A++)r+=a[A].dist(a[A+1]);return r}function $1(a,r,A){return a?.6*r*A:0}function tb(a,r){return Math.max(a?a.right-a.left:0,r?r.right-r.left:0)}function m3(a,r,A,u,f,b){let v=$1(A,f,b),x=tb(A,u)*b,Q=0,Z=q1(a)/2;for(let M=0;M<a.length-1;M++){let J=a[M],it=a[M+1],ot=J.dist(it);if(Q+ot>Z){let at=(Z-Q)/ot,Bt=bn.number(J.x,it.x,at),Gt=bn.number(J.y,it.y,at),Mt=new Yl(Bt,Gt,it.angleTo(J),M);return Mt._round(),!v||j1(a,Mt,x,v,r)?Mt:void 0}Q+=ot}}function C3(a,r,A,u,f,b,v,x,Q){let Z=$1(u,b,v),M=tb(u,f),J=M*v,it=a[0].x===0||a[0].x===Q||a[0].y===0||a[0].y===Q;return r-J<r/4&&(r=J+r/4),eb(a,it?r/2*x%r:(M/2+2*b)*v*x%r,r,Z,A,J,it,!1,Q)}function eb(a,r,A,u,f,b,v,x,Q){let Z=b/2,M=q1(a),J=0,it=r-A,ot=[];for(let at=0;at<a.length-1;at++){let Bt=a[at],Gt=a[at+1],Mt=Bt.dist(Gt),ne=Gt.angleTo(Bt);for(;it+A<J+Mt;){it+=A;let Yt=(it-J)/Mt,Ae=bn.number(Bt.x,Gt.x,Yt),ye=bn.number(Bt.y,Gt.y,Yt);if(Ae>=0&&Ae<Q&&ye>=0&&ye<Q&&it-Z>=0&&it+Z<=M){let Ge=new Yl(Ae,ye,ne,at);Ge._round(),u&&!j1(a,Ge,b,u,f)||ot.push(Ge)}}J+=Mt}return x||ot.length||v||(ot=eb(a,J/2,A,u,f,b,v,!0,Q)),ot}li("Anchor",Yl);let _u=bo;function ib(a,r,A,u){let f=[],b=a.image,v=b.pixelRatio,x=b.paddedRect.w-2*_u,Q=b.paddedRect.h-2*_u,Z=a.right-a.left,M=a.bottom-a.top,J=b.stretchX||[[0,x]],it=b.stretchY||[[0,Q]],ot=(ii,vi)=>ii+vi[1]-vi[0],at=J.reduce(ot,0),Bt=it.reduce(ot,0),Gt=x-at,Mt=Q-Bt,ne=0,Yt=at,Ae=0,ye=Bt,Ge=0,ci=Gt,Si=0,Ai=Mt;if(b.content&&u){let ii=b.content;ne=pd(J,0,ii[0]),Ae=pd(it,0,ii[1]),Yt=pd(J,ii[0],ii[2]),ye=pd(it,ii[1],ii[3]),Ge=ii[0]-ne,Si=ii[1]-Ae,ci=ii[2]-ii[0]-Yt,Ai=ii[3]-ii[1]-ye}let oi=(ii,vi,ni,Oe)=>{let Hi=fd(ii.stretch-ne,Yt,Z,a.left),ki=md(ii.fixed-Ge,ci,ii.stretch,at),hr=fd(vi.stretch-Ae,ye,M,a.top),nn=md(vi.fixed-Si,Ai,vi.stretch,Bt),un=fd(ni.stretch-ne,Yt,Z,a.left),Wn=md(ni.fixed-Ge,ci,ni.stretch,at),Oo=fd(Oe.stretch-Ae,ye,M,a.top),to=md(Oe.fixed-Si,Ai,Oe.stretch,Bt),Hn=new _(Hi,hr),bs=new _(un,hr),Fs=new _(un,Oo),eo=new _(Hi,Oo),io=new _(ki/v,nn/v),zn=new _(Wn/v,to/v),Jn=r*Math.PI/180;if(Jn){let Vs=Math.sin(Jn),vo=Math.cos(Jn),wo=[vo,-Vs,Vs,vo];Hn._matMult(wo),bs._matMult(wo),eo._matMult(wo),Fs._matMult(wo)}let Ms=ii.stretch+ii.fixed,ro=vi.stretch+vi.fixed;return{tl:Hn,tr:bs,bl:eo,br:Fs,tex:{x:b.paddedRect.x+_u+Ms,y:b.paddedRect.y+_u+ro,w:ni.stretch+ni.fixed-Ms,h:Oe.stretch+Oe.fixed-ro},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:io,pixelOffsetBR:zn,minFontScaleX:ci/v/Z,minFontScaleY:Ai/v/M,isSDF:A}};if(u&&(b.stretchX||b.stretchY)){let ii=rb(J,Gt,at),vi=rb(it,Mt,Bt);for(let ni=0;ni<ii.length-1;ni++){let Oe=ii[ni],Hi=ii[ni+1];for(let ki=0;ki<vi.length-1;ki++)f.push(oi(Oe,vi[ki],Hi,vi[ki+1]))}}else f.push(oi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:Q+1}));return f}function pd(a,r,A){let u=0;for(let f of a)u+=Math.max(r,Math.min(A,f[1]))-Math.max(r,Math.min(A,f[0]));return u}function rb(a,r,A){let u=[{fixed:-_u,stretch:0}];for(let[f,b]of a){let v=u[u.length-1];u.push({fixed:f-v.stretch,stretch:v.stretch}),u.push({fixed:f-v.stretch,stretch:v.stretch+(b-f)})}return u.push({fixed:r+_u,stretch:A}),u}function fd(a,r,A,u){return a/r*A+u}function md(a,r,A,u){return a-r*A/u}class Cd{constructor(r,A,u,f,b,v,x,Q,Z,M){if(this.boxStartIndex=r.length,Z){let J=v.top,it=v.bottom,ot=v.collisionPadding;ot&&(J-=ot[1],it+=ot[3]);let at=it-J;at>0&&(at=Math.max(10,at),this.circleDiameter=at)}else{let J=v.top*x-Q[0],it=v.bottom*x+Q[2],ot=v.left*x-Q[3],at=v.right*x+Q[1],Bt=v.collisionPadding;if(Bt&&(ot-=Bt[0]*x,J-=Bt[1]*x,at+=Bt[2]*x,it+=Bt[3]*x),M){let Gt=new _(ot,J),Mt=new _(at,J),ne=new _(ot,it),Yt=new _(at,it),Ae=M*Math.PI/180;Gt._rotate(Ae),Mt._rotate(Ae),ne._rotate(Ae),Yt._rotate(Ae),ot=Math.min(Gt.x,Mt.x,ne.x,Yt.x),at=Math.max(Gt.x,Mt.x,ne.x,Yt.x),J=Math.min(Gt.y,Mt.y,ne.y,Yt.y),it=Math.max(Gt.y,Mt.y,ne.y,Yt.y)}r.emplaceBack(A.x,A.y,ot,J,at,it,u,f,b)}this.boxEndIndex=r.length}}class I3{constructor(r=[],A=y3){if(this.data=r,this.length=this.data.length,this.compare=A,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let r=this.data[0],A=this.data.pop();return this.length--,this.length>0&&(this.data[0]=A,this._down(0)),r}peek(){return this.data[0]}_up(r){let{data:A,compare:u}=this,f=A[r];for(;r>0;){let b=r-1>>1,v=A[b];if(u(f,v)>=0)break;A[r]=v,r=b}A[r]=f}_down(r){let{data:A,compare:u}=this,f=this.length>>1,b=A[r];for(;r<f;){let v=1+(r<<1),x=A[v],Q=v+1;if(Q<this.length&&u(A[Q],x)<0&&(v=Q,x=A[Q]),u(x,b)>=0)break;A[r]=x,r=v}A[r]=b}}function y3(a,r){return a<r?-1:a>r?1:0}function b3(a,r=1,A=!1){let u=1/0,f=1/0,b=-1/0,v=-1/0,x=a[0];for(let ot=0;ot<x.length;ot++){let at=x[ot];(!ot||at.x<u)&&(u=at.x),(!ot||at.y<f)&&(f=at.y),(!ot||at.x>b)&&(b=at.x),(!ot||at.y>v)&&(v=at.y)}let Q=Math.min(b-u,v-f),Z=Q/2,M=new I3([],v3);if(Q===0)return new _(u,f);for(let ot=u;ot<b;ot+=Q)for(let at=f;at<v;at+=Q)M.push(new xu(ot+Z,at+Z,Z,a));let J=function(ot){let at=0,Bt=0,Gt=0,Mt=ot[0];for(let ne=0,Yt=Mt.length,Ae=Yt-1;ne<Yt;Ae=ne++){let ye=Mt[ne],Ge=Mt[Ae],ci=ye.x*Ge.y-Ge.x*ye.y;Bt+=(ye.x+Ge.x)*ci,Gt+=(ye.y+Ge.y)*ci,at+=3*ci}return new xu(Bt/at,Gt/at,0,ot)}(a),it=M.length;for(;M.length;){let ot=M.pop();(ot.d>J.d||!J.d)&&(J=ot,A&&console.log("found best %d after %d probes",Math.round(1e4*ot.d)/1e4,it)),ot.max-J.d<=r||(Z=ot.h/2,M.push(new xu(ot.p.x-Z,ot.p.y-Z,Z,a)),M.push(new xu(ot.p.x+Z,ot.p.y-Z,Z,a)),M.push(new xu(ot.p.x-Z,ot.p.y+Z,Z,a)),M.push(new xu(ot.p.x+Z,ot.p.y+Z,Z,a)),it+=4)}return A&&(console.log(`num probes: ${it}`),console.log(`best distance: ${J.d}`)),J.p}function v3(a,r){return r.max-a.max}function xu(a,r,A,u){this.p=new _(a,r),this.h=A,this.d=function(f,b){let v=!1,x=1/0;for(let Q=0;Q<b.length;Q++){let Z=b[Q];for(let M=0,J=Z.length,it=J-1;M<J;it=M++){let ot=Z[M],at=Z[it];ot.y>f.y!=at.y>f.y&&f.x<(at.x-ot.x)*(f.y-ot.y)/(at.y-ot.y)+ot.x&&(v=!v),x=Math.min(x,ja(f,ot,at))}}return(v?1:-1)*Math.sqrt(x)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var Ss;n.aq=void 0,(Ss=n.aq||(n.aq={}))[Ss.center=1]="center",Ss[Ss.left=2]="left",Ss[Ss.right=3]="right",Ss[Ss.top=4]="top",Ss[Ss.bottom=5]="bottom",Ss[Ss["top-left"]=6]="top-left",Ss[Ss["top-right"]=7]="top-right",Ss[Ss["bottom-left"]=8]="bottom-left",Ss[Ss["bottom-right"]=9]="bottom-right";let jl=7,Hm=Number.POSITIVE_INFINITY;function nb(a,r){return r[1]!==Hm?function(A,u,f){let b=0,v=0;switch(u=Math.abs(u),f=Math.abs(f),A){case"top-right":case"top-left":case"top":v=f-jl;break;case"bottom-right":case"bottom-left":case"bottom":v=-f+jl}switch(A){case"top-right":case"bottom-right":case"right":b=-u;break;case"top-left":case"bottom-left":case"left":b=u}return[b,v]}(a,r[0],r[1]):function(A,u){let f=0,b=0;u<0&&(u=0);let v=u/Math.SQRT2;switch(A){case"top-right":case"top-left":b=v-jl;break;case"bottom-right":case"bottom-left":b=-v+jl;break;case"bottom":b=-u+jl;break;case"top":b=u-jl}switch(A){case"top-right":case"bottom-right":f=-v;break;case"top-left":case"bottom-left":f=v;break;case"left":f=u;break;case"right":f=-u}return[f,b]}(a,r[0])}function sb(a,r,A){var u;let f=a.layout,b=(u=f.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(r,{},A);if(b){let x=b.values,Q=[];for(let Z=0;Z<x.length;Z+=2){let M=Q[Z]=x[Z],J=x[Z+1].map(it=>it*On);M.startsWith("top")?J[1]-=jl:M.startsWith("bottom")&&(J[1]+=jl),Q[Z+1]=J}return new Ln(Q)}let v=f.get("text-variable-anchor");if(v){let x;x=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(r,{},A)*On,Hm]:f.get("text-offset").evaluate(r,{},A).map(Z=>Z*On);let Q=[];for(let Z of v)Q.push(Z,nb(Z,x));return new Ln(Q)}return null}function Nm(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function w3(a,r,A,u,f,b,v,x,Q,Z,M){let J=b.textMaxSize.evaluate(r,{});J===void 0&&(J=v);let it=a.layers[0].layout,ot=it.get("icon-offset").evaluate(r,{},M),at=ab(A.horizontal),Bt=v/24,Gt=a.tilePixelRatio*Bt,Mt=a.tilePixelRatio*J/24,ne=a.tilePixelRatio*x,Yt=a.tilePixelRatio*it.get("symbol-spacing"),Ae=it.get("text-padding")*a.tilePixelRatio,ye=function(Oe,Hi,ki,hr=1){let nn=Oe.get("icon-padding").evaluate(Hi,{},ki),un=nn&&nn.values;return[un[0]*hr,un[1]*hr,un[2]*hr,un[3]*hr]}(it,r,M,a.tilePixelRatio),Ge=it.get("text-max-angle")/180*Math.PI,ci=it.get("text-rotation-alignment")!=="viewport"&&it.get("symbol-placement")!=="point",Si=it.get("icon-rotation-alignment")==="map"&&it.get("symbol-placement")!=="point",Ai=it.get("symbol-placement"),oi=Yt/2,ii=it.get("icon-text-fit"),vi;u&&ii!=="none"&&(a.allowVerticalPlacement&&A.vertical&&(vi=k1(u,A.vertical,ii,it.get("icon-text-fit-padding"),ot,Bt)),at&&(u=k1(u,at,ii,it.get("icon-text-fit-padding"),ot,Bt)));let ni=(Oe,Hi)=>{Hi.x<0||Hi.x>=cn||Hi.y<0||Hi.y>=cn||function(ki,hr,nn,un,Wn,Oo,to,Hn,bs,Fs,eo,io,zn,Jn,Ms,ro,Vs,vo,wo,Xn,mr,Ds,ks,Yn,Fa){let tA=ki.addToLineVertexArray(hr,nn),eA,ul,ka,ha,Bo=0,hl=0,Vh=0,ub=0,zm=-1,Jm=-1,gl={},hb=Bn("");if(ki.allowVerticalPlacement&&un.vertical){let Ks=Hn.layout.get("text-rotate").evaluate(mr,{},Yn)+90;ka=new Cd(bs,hr,Fs,eo,io,un.vertical,zn,Jn,Ms,Ks),to&&(ha=new Cd(bs,hr,Fs,eo,io,to,Vs,vo,Ms,Ks))}if(Wn){let Ks=Hn.layout.get("icon-rotate").evaluate(mr,{}),ga=Hn.layout.get("icon-text-fit")!=="none",Hc=ib(Wn,Ks,ks,ga),rA=to?ib(to,Ks,ks,ga):void 0;ul=new Cd(bs,hr,Fs,eo,io,Wn,Vs,vo,!1,Ks),Bo=4*Hc.length;let Nc=ki.iconSizeData,RA=null;Nc.kind==="source"?(RA=[GA*Hn.layout.get("icon-size").evaluate(mr,{})],RA[0]>Jl&&At(`${ki.layerIds[0]}: Value for "icon-size" is >= ${Hh}. Reduce your "icon-size".`)):Nc.kind==="composite"&&(RA=[GA*Ds.compositeIconSizes[0].evaluate(mr,{},Yn),GA*Ds.compositeIconSizes[1].evaluate(mr,{},Yn)],(RA[0]>Jl||RA[1]>Jl)&&At(`${ki.layerIds[0]}: Value for "icon-size" is >= ${Hh}. Reduce your "icon-size".`)),ki.addSymbols(ki.icon,Hc,RA,Xn,wo,mr,n.ai.none,hr,tA.lineStartIndex,tA.lineLength,-1,Yn),zm=ki.icon.placedSymbolArray.length-1,rA&&(hl=4*rA.length,ki.addSymbols(ki.icon,rA,RA,Xn,wo,mr,n.ai.vertical,hr,tA.lineStartIndex,tA.lineLength,-1,Yn),Jm=ki.icon.placedSymbolArray.length-1)}let gb=Object.keys(un.horizontal);for(let Ks of gb){let ga=un.horizontal[Ks];if(!eA){hb=Bn(ga.text);let rA=Hn.layout.get("text-rotate").evaluate(mr,{},Yn);eA=new Cd(bs,hr,Fs,eo,io,ga,zn,Jn,Ms,rA)}let Hc=ga.positionedLines.length===1;if(Vh+=ob(ki,hr,ga,Oo,Hn,Ms,mr,ro,tA,un.vertical?n.ai.horizontal:n.ai.horizontalOnly,Hc?gb:[Ks],gl,zm,Ds,Yn),Hc)break}un.vertical&&(ub+=ob(ki,hr,un.vertical,Oo,Hn,Ms,mr,ro,tA,n.ai.vertical,["vertical"],gl,Jm,Ds,Yn));let x3=eA?eA.boxStartIndex:ki.collisionBoxArray.length,S3=eA?eA.boxEndIndex:ki.collisionBoxArray.length,F3=ka?ka.boxStartIndex:ki.collisionBoxArray.length,k3=ka?ka.boxEndIndex:ki.collisionBoxArray.length,L3=ul?ul.boxStartIndex:ki.collisionBoxArray.length,E3=ul?ul.boxEndIndex:ki.collisionBoxArray.length,T3=ha?ha.boxStartIndex:ki.collisionBoxArray.length,Q3=ha?ha.boxEndIndex:ki.collisionBoxArray.length,iA=-1,yd=(Ks,ga)=>Ks&&Ks.circleDiameter?Math.max(Ks.circleDiameter,ga):ga;iA=yd(eA,iA),iA=yd(ka,iA),iA=yd(ul,iA),iA=yd(ha,iA);let db=iA>-1?1:0;db&&(iA*=Fa/On),ki.glyphOffsetArray.length>=Bu.MAX_GLYPHS&&At("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mr.sortKey!==void 0&&ki.addToSortKeyRanges(ki.symbolInstances.length,mr.sortKey);let U3=sb(Hn,mr,Yn),[G3,R3]=function(Ks,ga){let Hc=Ks.length,rA=ga?.values;if(rA?.length>0)for(let Nc=0;Nc<rA.length;Nc+=2){let RA=rA[Nc+1];Ks.emplaceBack(n.aq[rA[Nc]],RA[0],RA[1])}return[Hc,Ks.length]}(ki.textAnchorOffsets,U3);ki.symbolInstances.emplaceBack(hr.x,hr.y,gl.right>=0?gl.right:-1,gl.center>=0?gl.center:-1,gl.left>=0?gl.left:-1,gl.vertical||-1,zm,Jm,hb,x3,S3,F3,k3,L3,E3,T3,Q3,Fs,Vh,ub,Bo,hl,db,0,zn,iA,G3,R3)}(a,Hi,Oe,A,u,f,vi,a.layers[0],a.collisionBoxArray,r.index,r.sourceLayerIndex,a.index,Gt,[Ae,Ae,Ae,Ae],ci,Q,ne,ye,Si,ot,r,b,Z,M,v)};if(Ai==="line")for(let Oe of Y1(r.geometry,0,0,cn,cn)){let Hi=C3(Oe,Yt,Ge,A.vertical||at,u,24,Mt,a.overscaling,cn);for(let ki of Hi)at&&B3(a,at.text,oi,ki)||ni(Oe,ki)}else if(Ai==="line-center"){for(let Oe of r.geometry)if(Oe.length>1){let Hi=m3(Oe,Ge,A.vertical||at,u,24,Mt);Hi&&ni(Oe,Hi)}}else if(r.type==="Polygon")for(let Oe of mm(r.geometry,0)){let Hi=b3(Oe,16);ni(Oe[0],new Yl(Hi.x,Hi.y,0))}else if(r.type==="LineString")for(let Oe of r.geometry)ni(Oe,new Yl(Oe[0].x,Oe[0].y,0));else if(r.type==="Point")for(let Oe of r.geometry)for(let Hi of Oe)ni([Hi],new Yl(Hi.x,Hi.y,0))}function ob(a,r,A,u,f,b,v,x,Q,Z,M,J,it,ot,at){let Bt=function(ne,Yt,Ae,ye,Ge,ci,Si,Ai){let oi=ye.layout.get("text-rotate").evaluate(ci,{})*Math.PI/180,ii=[];for(let vi of Yt.positionedLines)for(let ni of vi.positionedGlyphs){if(!ni.rect)continue;let Oe=ni.rect||{},Hi=v1+1,ki=!0,hr=1,nn=0,un=(Ge||Ai)&&ni.vertical,Wn=ni.metrics.advance*ni.scale/2;if(Ai&&Yt.verticalizable&&(nn=vi.lineOffset/2-(ni.imageName?-(On-ni.metrics.width*ni.scale)/2:(ni.scale-1)*On)),ni.imageName){let Xn=Si[ni.imageName];ki=Xn.sdf,hr=Xn.pixelRatio,Hi=bo/hr}let Oo=Ge?[ni.x+Wn,ni.y]:[0,0],to=Ge?[0,0]:[ni.x+Wn+Ae[0],ni.y+Ae[1]-nn],Hn=[0,0];un&&(Hn=to,to=[0,0]);let bs=ni.metrics.isDoubleResolution?2:1,Fs=(ni.metrics.left-Hi)*ni.scale-Wn+to[0],eo=(-ni.metrics.top-Hi)*ni.scale+to[1],io=Fs+Oe.w/bs*ni.scale/hr,zn=eo+Oe.h/bs*ni.scale/hr,Jn=new _(Fs,eo),Ms=new _(io,eo),ro=new _(Fs,zn),Vs=new _(io,zn);if(un){let Xn=new _(-Wn,Wn-Rh),mr=-Math.PI/2,Ds=On/2-Wn,ks=new _(5-Rh-Ds,-(ni.imageName?Ds:0)),Yn=new _(...Hn);Jn._rotateAround(mr,Xn)._add(ks)._add(Yn),Ms._rotateAround(mr,Xn)._add(ks)._add(Yn),ro._rotateAround(mr,Xn)._add(ks)._add(Yn),Vs._rotateAround(mr,Xn)._add(ks)._add(Yn)}if(oi){let Xn=Math.sin(oi),mr=Math.cos(oi),Ds=[mr,-Xn,Xn,mr];Jn._matMult(Ds),Ms._matMult(Ds),ro._matMult(Ds),Vs._matMult(Ds)}let vo=new _(0,0),wo=new _(0,0);ii.push({tl:Jn,tr:Ms,bl:ro,br:Vs,tex:Oe,writingMode:Yt.writingMode,glyphOffset:Oo,sectionIndex:ni.sectionIndex,isSDF:ki,pixelOffsetTL:vo,pixelOffsetBR:wo,minFontScaleX:0,minFontScaleY:0})}return ii}(0,A,x,f,b,v,u,a.allowVerticalPlacement),Gt=a.textSizeData,Mt=null;Gt.kind==="source"?(Mt=[GA*f.layout.get("text-size").evaluate(v,{})],Mt[0]>Jl&&At(`${a.layerIds[0]}: Value for "text-size" is >= ${Hh}. Reduce your "text-size".`)):Gt.kind==="composite"&&(Mt=[GA*ot.compositeTextSizes[0].evaluate(v,{},at),GA*ot.compositeTextSizes[1].evaluate(v,{},at)],(Mt[0]>Jl||Mt[1]>Jl)&&At(`${a.layerIds[0]}: Value for "text-size" is >= ${Hh}. Reduce your "text-size".`)),a.addSymbols(a.text,Bt,Mt,x,b,v,Z,r,Q.lineStartIndex,Q.lineLength,it,at);for(let ne of M)J[ne]=a.text.placedSymbolArray.length-1;return 4*Bt.length}function ab(a){for(let r in a)return a[r];return null}function B3(a,r,A,u){let f=a.compareText;if(r in f){let b=f[r];for(let v=b.length-1;v>=0;v--)if(u.dist(b[v])<A)return!0}else f[r]=[];return f[r].push(u),!1}let Ab=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Pm{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[A,u]=new Uint8Array(r,0,2);if(A!==219)throw new Error("Data does not appear to be in a KDBush format.");let f=u>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);let b=Ab[15&u];if(!b)throw new Error("Unrecognized array type.");let[v]=new Uint16Array(r,2,1),[x]=new Uint32Array(r,4,1);return new Pm(x,v,b,r)}constructor(r,A=64,u=Float64Array,f){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+A,2),65535),this.ArrayType=u,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;let b=Ab.indexOf(this.ArrayType),v=2*r*this.ArrayType.BYTES_PER_ELEMENT,x=r*this.IndexArrayType.BYTES_PER_ELEMENT,Q=(8-x%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${u}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+x+Q,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+v+x+Q),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+x+Q,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=A,new Uint32Array(this.data,4,1)[0]=r)}add(r,A){let u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=r,this.coords[this._pos++]=A,u}finish(){let r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return Mm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,A,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:b,coords:v,nodeSize:x}=this,Q=[0,b.length-1,0],Z=[];for(;Q.length;){let M=Q.pop()||0,J=Q.pop()||0,it=Q.pop()||0;if(J-it<=x){for(let Gt=it;Gt<=J;Gt++){let Mt=v[2*Gt],ne=v[2*Gt+1];Mt>=r&&Mt<=u&&ne>=A&&ne<=f&&Z.push(b[Gt])}continue}let ot=it+J>>1,at=v[2*ot],Bt=v[2*ot+1];at>=r&&at<=u&&Bt>=A&&Bt<=f&&Z.push(b[ot]),(M===0?r<=at:A<=Bt)&&(Q.push(it),Q.push(ot-1),Q.push(1-M)),(M===0?u>=at:f>=Bt)&&(Q.push(ot+1),Q.push(J),Q.push(1-M))}return Z}within(r,A,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:f,coords:b,nodeSize:v}=this,x=[0,f.length-1,0],Q=[],Z=u*u;for(;x.length;){let M=x.pop()||0,J=x.pop()||0,it=x.pop()||0;if(J-it<=v){for(let Gt=it;Gt<=J;Gt++)cb(b[2*Gt],b[2*Gt+1],r,A)<=Z&&Q.push(f[Gt]);continue}let ot=it+J>>1,at=b[2*ot],Bt=b[2*ot+1];cb(at,Bt,r,A)<=Z&&Q.push(f[ot]),(M===0?r-u<=at:A-u<=Bt)&&(x.push(it),x.push(ot-1),x.push(1-M)),(M===0?r+u>=at:A+u>=Bt)&&(x.push(ot+1),x.push(J),x.push(1-M))}return Q}}function Mm(a,r,A,u,f,b){if(f-u<=A)return;let v=u+f>>1;lb(a,r,v,u,f,b),Mm(a,r,A,u,v-1,1-b),Mm(a,r,A,v+1,f,1-b)}function lb(a,r,A,u,f,b){for(;f>u;){if(f-u>600){let Z=f-u+1,M=A-u+1,J=Math.log(Z),it=.5*Math.exp(2*J/3),ot=.5*Math.sqrt(J*it*(Z-it)/Z)*(M-Z/2<0?-1:1);lb(a,r,A,Math.max(u,Math.floor(A-M*it/Z+ot)),Math.min(f,Math.floor(A+(Z-M)*it/Z+ot)),b)}let v=r[2*A+b],x=u,Q=f;for(Ph(a,r,u,A),r[2*f+b]>v&&Ph(a,r,u,f);x<Q;){for(Ph(a,r,x,Q),x++,Q--;r[2*x+b]<v;)x++;for(;r[2*Q+b]>v;)Q--}r[2*u+b]===v?Ph(a,r,u,Q):(Q++,Ph(a,r,Q,f)),Q<=A&&(u=Q+1),A<=Q&&(f=Q-1)}}function Ph(a,r,A,u){Vm(a,A,u),Vm(r,2*A,2*u),Vm(r,2*A+1,2*u+1)}function Vm(a,r,A){let u=a[r];a[r]=a[A],a[A]=u}function cb(a,r,A,u){let f=a-A,b=r-u;return f*f+b*b}var Dm;n.bh=void 0,(Dm=n.bh||(n.bh={})).create="create",Dm.load="load",Dm.fullLoad="fullLoad";let Id=null,Mh=[],Km=1e3/60,Om="loadTime",Wm="fullLoadTime",_3={mark(a){performance.mark(a)},frame(a){let r=a;Id!=null&&Mh.push(r-Id),Id=r},clearMetrics(){Id=null,Mh=[],performance.clearMeasures(Om),performance.clearMeasures(Wm);for(let a in n.bh)performance.clearMarks(n.bh[a])},getPerformanceMetrics(){performance.measure(Om,n.bh.create,n.bh.load),performance.measure(Wm,n.bh.create,n.bh.fullLoad);let a=performance.getEntriesByName(Om)[0].duration,r=performance.getEntriesByName(Wm)[0].duration,A=Mh.length,u=1/(Mh.reduce((b,v)=>b+v,0)/A/1e3),f=Mh.filter(b=>b>Km).reduce((b,v)=>b+(v-Km)/Km,0);return{loadTime:a,fullLoadTime:r,fps:u,percentDroppedFrames:f/(A+f)*100,totalFrames:A}}};n.$=function(a,r,A){var u,f,b,v,x,Q,Z,M,J,it,ot,at,Bt=A[0],Gt=A[1],Mt=A[2];return r===a?(a[12]=r[0]*Bt+r[4]*Gt+r[8]*Mt+r[12],a[13]=r[1]*Bt+r[5]*Gt+r[9]*Mt+r[13],a[14]=r[2]*Bt+r[6]*Gt+r[10]*Mt+r[14],a[15]=r[3]*Bt+r[7]*Gt+r[11]*Mt+r[15]):(f=r[1],b=r[2],v=r[3],x=r[4],Q=r[5],Z=r[6],M=r[7],J=r[8],it=r[9],ot=r[10],at=r[11],a[0]=u=r[0],a[1]=f,a[2]=b,a[3]=v,a[4]=x,a[5]=Q,a[6]=Z,a[7]=M,a[8]=J,a[9]=it,a[10]=ot,a[11]=at,a[12]=u*Bt+x*Gt+J*Mt+r[12],a[13]=f*Bt+Q*Gt+it*Mt+r[13],a[14]=b*Bt+Z*Gt+ot*Mt+r[14],a[15]=v*Bt+M*Gt+at*Mt+r[15]),a},n.A=Al,n.B=bn,n.C=class{constructor(a,r,A){this.receive=u=>{let f=u.data,b=f.id;if(b&&(!f.targetMapId||this.mapId===f.targetMapId))if(f.type==="<cancel>"){delete this.tasks[b];let v=this.cancelCallbacks[b];delete this.cancelCallbacks[b],v&&v()}else ue()||f.mustQueue?(this.tasks[b]=f,this.taskQueue.push(b),this.invoker.trigger()):this.processTask(b,f)},this.process=()=>{if(!this.taskQueue.length)return;let u=this.taskQueue.shift(),f=this.tasks[u];delete this.tasks[u],this.taskQueue.length&&this.invoker.trigger(),f&&this.processTask(u,f)},this.target=a,this.parent=r,this.mapId=A,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new p3(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ue()?a:window}send(a,r,A,u,f=!1){let b=Math.round(1e18*Math.random()).toString(36).substring(0,10);A&&(this.callbacks[b]=A);let v=[],x={id:b,type:a,hasCallback:!!A,targetMapId:u,mustQueue:f,sourceMapId:this.mapId,data:la(r,v)};return this.target.postMessage(x,{transfer:v}),{cancel:()=>{A&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}processTask(a,r){if(r.type==="<response>"){let A=this.callbacks[a];delete this.callbacks[a],A&&(r.error?A(Wa(r.error)):A(null,Wa(r.data)))}else{let A=!1,u=[],f=r.hasCallback?(x,Q)=>{A=!0,delete this.cancelCallbacks[a];let Z={id:a,type:"<response>",sourceMapId:this.mapId,error:x?la(x):null,data:la(Q,u)};this.target.postMessage(Z,{transfer:u})}:x=>{A=!0},b=null,v=Wa(r.data);if(this.parent[r.type])b=this.parent[r.type](r.sourceMapId,v,f);else if("getWorkerSource"in this.parent){let x=r.type.split(".");b=this.parent.getWorkerSource(r.sourceMapId,x[0],v.source)[x[1]](v,f)}else f(new Error(`Could not find function ${r.type}`));!A&&b&&b.cancel&&(this.cancelCallbacks[a]=b.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},n.D=Fi,n.E=Ui,n.F=function(a,r){let A={};for(let u=0;u<r.length;u++){let f=r[u];f in a&&(A[f]=a[f])}return A},n.G=H1,n.H=N1,n.I=Sm,n.J=tt,n.K=z,n.L=Xl,n.M=Lt,n.N=cn,n.O=ua,n.P=_,n.Q=Er,n.R=yo,n.S=Vi,n.T=du,n.U=dd,n.V=class extends Sa{},n.W=Zm,n.X=function(a,r){let A=window.document.createElement("video");A.muted=!0,A.onloadstart=function(){r(null,A)};for(let u=0;u<a.length;u++){let f=window.document.createElement("source");ei(a[u])||(A.crossOrigin="Anonymous"),f.src=a[u],A.appendChild(f)}return{cancel:()=>{}}},n.Y=Fe,n.Z=function(){var a=new Al(16);return Al!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},n._=g,n.a=ae,n.a$=class extends st{},n.a0=function(a,r,A){var u=A[0],f=A[1],b=A[2];return a[0]=r[0]*u,a[1]=r[1]*u,a[2]=r[2]*u,a[3]=r[3]*u,a[4]=r[4]*f,a[5]=r[5]*f,a[6]=r[6]*f,a[7]=r[7]*f,a[8]=r[8]*b,a[9]=r[9]*b,a[10]=r[10]*b,a[11]=r[11]*b,a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15],a},n.a1=Uc,n.a2=function(){return Ut++},n.a3=kt,n.a4=Bu,n.a5=function(){xs.isLoading()||xs.isLoaded()||vc()!=="deferred"||gu()},n.a6=Na,n.a7=TA,n.a8=Yr,n.a9=W1,n.aA=za,n.aB=function(a){a=a.slice();let r=Object.create(null);for(let A=0;A<a.length;A++)r[a[A].id]=a[A];for(let A=0;A<a.length;A++)"ref"in a[A]&&(a[A]=We(a[A],r[a[A].ref]));return a},n.aC=function(a){if(a.type==="custom")return new d3(a);switch(a.type){case"background":return new u3(a);case"circle":return new id(a);case"fill":return new fS(a);case"fill-extrusion":return new ES(a);case"heatmap":return new kh(a);case"hillshade":return new QA(a);case"line":return new NS(a);case"raster":return new g3(a);case"symbol":return new gd(a)}},n.aD=oe,n.aE=function(a,r){if(!a)return[{command:Re.setStyle,args:[r]}];let A=[];try{if(!He(a.version,r.version))return[{command:Re.setStyle,args:[r]}];He(a.center,r.center)||A.push({command:Re.setCenter,args:[r.center]}),He(a.zoom,r.zoom)||A.push({command:Re.setZoom,args:[r.zoom]}),He(a.bearing,r.bearing)||A.push({command:Re.setBearing,args:[r.bearing]}),He(a.pitch,r.pitch)||A.push({command:Re.setPitch,args:[r.pitch]}),He(a.sprite,r.sprite)||A.push({command:Re.setSprite,args:[r.sprite]}),He(a.glyphs,r.glyphs)||A.push({command:Re.setGlyphs,args:[r.glyphs]}),He(a.transition,r.transition)||A.push({command:Re.setTransition,args:[r.transition]}),He(a.light,r.light)||A.push({command:Re.setLight,args:[r.light]});let u={},f=[];(function(v,x,Q,Z){let M;for(M in x=x||{},v=v||{})Object.prototype.hasOwnProperty.call(v,M)&&(Object.prototype.hasOwnProperty.call(x,M)||yi(M,Q,Z));for(M in x)Object.prototype.hasOwnProperty.call(x,M)&&(Object.prototype.hasOwnProperty.call(v,M)?He(v[M],x[M])||(v[M].type==="geojson"&&x[M].type==="geojson"&&Pi(v,x,M)?Q.push({command:Re.setGeoJSONSourceData,args:[M,x[M].data]}):Qi(M,x,Q,Z)):hi(M,x,Q))})(a.sources,r.sources,f,u);let b=[];a.layers&&a.layers.forEach(v=>{u[v.source]?A.push({command:Re.removeLayer,args:[v.id]}):b.push(v)}),A=A.concat(f),function(v,x,Q){x=x||[];let Z=(v=v||[]).map(ir),M=x.map(ir),J=v.reduce(Ei,{}),it=x.reduce(Ei,{}),ot=Z.slice(),at=Object.create(null),Bt,Gt,Mt,ne,Yt,Ae,ye;for(Bt=0,Gt=0;Bt<Z.length;Bt++)Mt=Z[Bt],Object.prototype.hasOwnProperty.call(it,Mt)?Gt++:(Q.push({command:Re.removeLayer,args:[Mt]}),ot.splice(ot.indexOf(Mt,Gt),1));for(Bt=0,Gt=0;Bt<M.length;Bt++)Mt=M[M.length-1-Bt],ot[ot.length-1-Bt]!==Mt&&(Object.prototype.hasOwnProperty.call(J,Mt)?(Q.push({command:Re.removeLayer,args:[Mt]}),ot.splice(ot.lastIndexOf(Mt,ot.length-Gt),1)):Gt++,Ae=ot[ot.length-Bt],Q.push({command:Re.addLayer,args:[it[Mt],Ae]}),ot.splice(ot.length-Bt,0,Mt),at[Mt]=!0);for(Bt=0;Bt<M.length;Bt++)if(Mt=M[Bt],ne=J[Mt],Yt=it[Mt],!at[Mt]&&!He(ne,Yt))if(He(ne.source,Yt.source)&&He(ne["source-layer"],Yt["source-layer"])&&He(ne.type,Yt.type)){for(ye in zi(ne.layout,Yt.layout,Q,Mt,null,Re.setLayoutProperty),zi(ne.paint,Yt.paint,Q,Mt,null,Re.setPaintProperty),He(ne.filter,Yt.filter)||Q.push({command:Re.setFilter,args:[Mt,Yt.filter]}),He(ne.minzoom,Yt.minzoom)&&He(ne.maxzoom,Yt.maxzoom)||Q.push({command:Re.setLayerZoomRange,args:[Mt,Yt.minzoom,Yt.maxzoom]}),ne)Object.prototype.hasOwnProperty.call(ne,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?zi(ne[ye],Yt[ye],Q,Mt,ye.slice(6),Re.setPaintProperty):He(ne[ye],Yt[ye])||Q.push({command:Re.setLayerProperty,args:[Mt,ye,Yt[ye]]}));for(ye in Yt)Object.prototype.hasOwnProperty.call(Yt,ye)&&!Object.prototype.hasOwnProperty.call(ne,ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?zi(ne[ye],Yt[ye],Q,Mt,ye.slice(6),Re.setPaintProperty):He(ne[ye],Yt[ye])||Q.push({command:Re.setLayerProperty,args:[Mt,ye,Yt[ye]]}))}else Q.push({command:Re.removeLayer,args:[Mt]}),Ae=ot[ot.lastIndexOf(Mt)+1],Q.push({command:Re.addLayer,args:[Yt,Ae]})}(b,r.layers,A)}catch(u){console.warn("Unable to compute style diff:",u),A=[{command:Re.setStyle,args:[r]}]}return A},n.aF=function(a){let r=[],A=a.id;return A===void 0&&r.push({message:`layers.${A}: missing required property "id"`}),a.render===void 0&&r.push({message:`layers.${A}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&r.push({message:`layers.${A}: property "renderingMode" must be either "2d" or "3d"`}),r},n.aG=function a(r,A){if(Array.isArray(r)){if(!Array.isArray(A)||r.length!==A.length)return!1;for(let u=0;u<r.length;u++)if(!a(r[u],A[u]))return!1;return!0}if(typeof r=="object"&&r!==null&&A!==null){if(typeof A!="object"||Object.keys(r).length!==Object.keys(A).length)return!1;for(let u in r)if(!a(r[u],A[u]))return!1;return!0}return r===A},n.aH=dt,n.aI=ee,n.aJ=Ja,n.aK=function(a){return a({pluginStatus:ys,pluginURL:Po}),Ja.on("pluginStateChange",a),a},n.aL=class extends ln{constructor(a,r){super(a,r),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},n.aM=Gn,n.aN=class extends ln{constructor(a,r){super(a,r),this.current=Rn}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let r=1;r<16;r++)if(a[r]!==this.current[r]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},n.aO=Ps,n.aP=class extends ln{constructor(a,r){super(a,r),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},n.aQ=class extends ln{constructor(a,r){super(a,r),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},n.aR=mo,n.aS=function(a,r,A,u,f,b,v){var x=1/(r-A),Q=1/(u-f),Z=1/(b-v);return a[0]=-2*x,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*Q,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*Z,a[11]=0,a[12]=(r+A)*x,a[13]=(f+u)*Q,a[14]=(v+b)*Z,a[15]=1,a},n.aT=qi,n.aU=wh,n.aV=class extends d{},n.aW=DS,n.aX=class extends y{},n.aY=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},n.aZ=Ol,n.a_=Ct,n.aa=function(a){let r={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(A,u,f,b)=>{let v=f||b;return r[u]=!v||v.toLowerCase(),""}),r["max-age"]){let A=parseInt(r["max-age"],10);isNaN(A)?delete r["max-age"]:r["max-age"]=A}return r},n.ab=function(a,r){let A=[];for(let u in a)u in r||A.push(u);return A},n.ac=function(a){if(ce==null){let r=a.navigator?a.navigator.userAgent:null;ce=!!a.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return ce},n.ad=Et,n.ae=function(a,r,A){var u=Math.sin(A),f=Math.cos(A),b=r[0],v=r[1],x=r[2],Q=r[3],Z=r[4],M=r[5],J=r[6],it=r[7];return r!==a&&(a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[0]=b*f+Z*u,a[1]=v*f+M*u,a[2]=x*f+J*u,a[3]=Q*f+it*u,a[4]=Z*f-b*u,a[5]=M*f-v*u,a[6]=J*f-x*u,a[7]=it*f-Q*u,a},n.af=function(a){var r=new Al(16);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[4]=a[4],r[5]=a[5],r[6]=a[6],r[7]=a[7],r[8]=a[8],r[9]=a[9],r[10]=a[10],r[11]=a[11],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15],r},n.ag=ca,n.ah=function(a,r){let A=0,u=0;if(a.kind==="constant")u=a.layoutSize;else if(a.kind!=="source"){let{interpolationType:f,minZoom:b,maxZoom:v}=a,x=f?Et(hs.interpolationFactor(f,r,b,v),0,1):0;a.kind==="camera"?u=bn.number(a.minSize,a.maxSize,x):A=x}return{uSizeT:A,uSize:u}},n.aj=function(a,{uSize:r,uSizeT:A},{lowerSize:u,upperSize:f}){return a.kind==="source"?u/GA:a.kind==="composite"?bn.number(u/GA,f/GA,A):r},n.ak=Em,n.al=function(a,r,A,u){let f=r.y-a.y,b=r.x-a.x,v=u.y-A.y,x=u.x-A.x,Q=v*b-x*f;if(Q===0)return null;let Z=(x*(a.y-A.y)-v*(a.x-A.x))/Q;return new _(a.x+Z*b,a.y+Z*f)},n.am=Y1,n.an=Fc,n.ao=vh,n.ap=On,n.ar=Lm,n.as=function(a,r){var A=r[0],u=r[1],f=r[2],b=r[3],v=r[4],x=r[5],Q=r[6],Z=r[7],M=r[8],J=r[9],it=r[10],ot=r[11],at=r[12],Bt=r[13],Gt=r[14],Mt=r[15],ne=A*x-u*v,Yt=A*Q-f*v,Ae=A*Z-b*v,ye=u*Q-f*x,Ge=u*Z-b*x,ci=f*Z-b*Q,Si=M*Bt-J*at,Ai=M*Gt-it*at,oi=M*Mt-ot*at,ii=J*Gt-it*Bt,vi=J*Mt-ot*Bt,ni=it*Mt-ot*Gt,Oe=ne*ni-Yt*vi+Ae*ii+ye*oi-Ge*Ai+ci*Si;return Oe?(a[0]=(x*ni-Q*vi+Z*ii)*(Oe=1/Oe),a[1]=(f*vi-u*ni-b*ii)*Oe,a[2]=(Bt*ci-Gt*Ge+Mt*ye)*Oe,a[3]=(it*Ge-J*ci-ot*ye)*Oe,a[4]=(Q*oi-v*ni-Z*Ai)*Oe,a[5]=(A*ni-f*oi+b*Ai)*Oe,a[6]=(Gt*Ae-at*ci-Mt*Yt)*Oe,a[7]=(M*ci-it*Ae+ot*Yt)*Oe,a[8]=(v*vi-x*oi+Z*Si)*Oe,a[9]=(u*oi-A*vi-b*Si)*Oe,a[10]=(at*Ge-Bt*Ae+Mt*ne)*Oe,a[11]=(J*Ae-M*Ge-ot*ne)*Oe,a[12]=(x*Ai-v*ii-Q*Si)*Oe,a[13]=(A*ii-u*Ai+f*Si)*Oe,a[14]=(Bt*Yt-at*ye-Gt*ne)*Oe,a[15]=(M*ye-J*Yt+it*ne)*Oe,a):null},n.at=Nm,n.au=km,n.av=Pm,n.aw=function(){let a={},r=$t.$version;for(let A in $t.$root){let u=$t.$root[A];if(u.required){let f=null;f=A==="version"?r:u.type==="array"?[]:{},f!=null&&(a[A]=f)}}return a},n.ax=Re,n.ay=yc,n.az=he,n.b=function(a,r){let A=new Blob([new Uint8Array(a)],{type:"image/png"});createImageBitmap(A).then(u=>{r(null,u)}).catch(u=>{r(new Error(`Could not load image because of ${u.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},n.b0=$e,n.b1=function(a,r){var A=a[0],u=a[1],f=a[2],b=a[3],v=a[4],x=a[5],Q=a[6],Z=a[7],M=a[8],J=a[9],it=a[10],ot=a[11],at=a[12],Bt=a[13],Gt=a[14],Mt=a[15],ne=r[0],Yt=r[1],Ae=r[2],ye=r[3],Ge=r[4],ci=r[5],Si=r[6],Ai=r[7],oi=r[8],ii=r[9],vi=r[10],ni=r[11],Oe=r[12],Hi=r[13],ki=r[14],hr=r[15];return Math.abs(A-ne)<=Zn*Math.max(1,Math.abs(A),Math.abs(ne))&&Math.abs(u-Yt)<=Zn*Math.max(1,Math.abs(u),Math.abs(Yt))&&Math.abs(f-Ae)<=Zn*Math.max(1,Math.abs(f),Math.abs(Ae))&&Math.abs(b-ye)<=Zn*Math.max(1,Math.abs(b),Math.abs(ye))&&Math.abs(v-Ge)<=Zn*Math.max(1,Math.abs(v),Math.abs(Ge))&&Math.abs(x-ci)<=Zn*Math.max(1,Math.abs(x),Math.abs(ci))&&Math.abs(Q-Si)<=Zn*Math.max(1,Math.abs(Q),Math.abs(Si))&&Math.abs(Z-Ai)<=Zn*Math.max(1,Math.abs(Z),Math.abs(Ai))&&Math.abs(M-oi)<=Zn*Math.max(1,Math.abs(M),Math.abs(oi))&&Math.abs(J-ii)<=Zn*Math.max(1,Math.abs(J),Math.abs(ii))&&Math.abs(it-vi)<=Zn*Math.max(1,Math.abs(it),Math.abs(vi))&&Math.abs(ot-ni)<=Zn*Math.max(1,Math.abs(ot),Math.abs(ni))&&Math.abs(at-Oe)<=Zn*Math.max(1,Math.abs(at),Math.abs(Oe))&&Math.abs(Bt-Hi)<=Zn*Math.max(1,Math.abs(Bt),Math.abs(Hi))&&Math.abs(Gt-ki)<=Zn*Math.max(1,Math.abs(Gt),Math.abs(ki))&&Math.abs(Mt-hr)<=Zn*Math.max(1,Math.abs(Mt),Math.abs(hr))},n.b2=function(a,r){return a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15],a},n.b3=function(a,r,A){return a[0]=r[0]*A[0],a[1]=r[1]*A[1],a[2]=r[2]*A[2],a[3]=r[3]*A[3],a},n.b4=function(a,r){return a[0]*r[0]+a[1]*r[1]+a[2]*r[2]+a[3]*r[3]},n.b5=Pt,n.b6=D1,n.b7=P1,n.b8=function(a,r,A,u,f){var b,v=1/Math.tan(r/2);return a[0]=v/A,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=v,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,f!=null&&f!==1/0?(a[10]=(f+u)*(b=1/(u-f)),a[14]=2*f*u*b):(a[10]=-1,a[14]=-2*u),a},n.b9=function(a,r,A){var u=Math.sin(A),f=Math.cos(A),b=r[4],v=r[5],x=r[6],Q=r[7],Z=r[8],M=r[9],J=r[10],it=r[11];return r!==a&&(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[4]=b*f+Z*u,a[5]=v*f+M*u,a[6]=x*f+J*u,a[7]=Q*f+it*u,a[8]=Z*f-b*u,a[9]=M*f-v*u,a[10]=J*f-x*u,a[11]=it*f-Q*u,a},n.bA=m,n.bB=p1,n.bC=en,n.bD=xs,n.ba=rt,n.bb=ct,n.bc=function(a,r){return a[0]=r[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=r[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=r[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},n.bd=class extends nl{},n.be=Gm,n.bf=M1,n.bg=_3,n.bi=Xt,n.bj=function(a,r,A=!1){if(ys===Tl||ys===FA||ys===kA)throw new Error("setRTLTextPlugin cannot be called multiple times.");Po=bt.resolveURL(a),ys=Tl,el=r,LA(),A||gu()},n.bk=vc,n.bl=function(a,r){let A={};for(let f=0;f<a.length;f++){let b=r&&r[a[f].id]||ia(a[f]);r&&(r[a[f].id]=b);let v=A[b];v||(v=A[b]=[]),v.push(a[f])}let u=[];for(let f in A)u.push(A[f]);return u},n.bm=li,n.bn=O1,n.bo=z1,n.bp=B1,n.bq=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=cn/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;let r=a.bucket.layers[0],A=r.layout,u=r._unevaluatedLayout._values,f={layoutIconSize:u["icon-size"].possiblyEvaluate(new Yr(a.bucket.zoom+1),a.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Yr(a.bucket.zoom+1),a.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Yr(18))};if(a.bucket.textSizeData.kind==="composite"){let{minZoom:Z,maxZoom:M}=a.bucket.textSizeData;f.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Yr(Z),a.canonical),u["text-size"].possiblyEvaluate(new Yr(M),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){let{minZoom:Z,maxZoom:M}=a.bucket.iconSizeData;f.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Yr(Z),a.canonical),u["icon-size"].possiblyEvaluate(new Yr(M),a.canonical)]}let b=A.get("text-line-height")*On,v=A.get("text-rotation-alignment")!=="viewport"&&A.get("symbol-placement")!=="point",x=A.get("text-keep-upright"),Q=A.get("text-size");for(let Z of a.bucket.features){let M=A.get("text-font").evaluate(Z,{},a.canonical).join(","),J=Q.evaluate(Z,{},a.canonical),it=f.layoutTextSize.evaluate(Z,{},a.canonical),ot=f.layoutIconSize.evaluate(Z,{},a.canonical),at={horizontal:{},vertical:void 0},Bt=Z.text,Gt,Mt=[0,0];if(Bt){let Ae=Bt.toString(),ye=A.get("text-letter-spacing").evaluate(Z,{},a.canonical)*On,Ge=Ll(Ae)?ye:0,ci=A.get("text-anchor").evaluate(Z,{},a.canonical),Si=sb(r,Z,a.canonical);if(!Si){let ni=A.get("text-radial-offset").evaluate(Z,{},a.canonical);Mt=ni?nb(ci,[ni*On,Hm]):A.get("text-offset").evaluate(Z,{},a.canonical).map(Oe=>Oe*On)}let Ai=v?"center":A.get("text-justify").evaluate(Z,{},a.canonical),oi=A.get("symbol-placement"),ii=oi==="point"?A.get("text-max-width").evaluate(Z,{},a.canonical)*On:0,vi=()=>{a.bucket.allowVerticalPlacement&&kl(Ae)&&(at.vertical=cd(Bt,a.glyphMap,a.glyphPositions,a.imagePositions,M,ii,b,ci,"left",Ge,Mt,n.ai.vertical,!0,oi,it,J))};if(!v&&Si){let ni=new Set;if(Ai==="auto")for(let Hi=0;Hi<Si.values.length;Hi+=2)ni.add(Nm(Si.values[Hi]));else ni.add(Ai);let Oe=!1;for(let Hi of ni)if(!at.horizontal[Hi])if(Oe)at.horizontal[Hi]=at.horizontal[0];else{let ki=cd(Bt,a.glyphMap,a.glyphPositions,a.imagePositions,M,ii,b,"center",Hi,Ge,Mt,n.ai.horizontal,!1,oi,it,J);ki&&(at.horizontal[Hi]=ki,Oe=ki.positionedLines.length===1)}vi()}else{Ai==="auto"&&(Ai=Nm(ci));let ni=cd(Bt,a.glyphMap,a.glyphPositions,a.imagePositions,M,ii,b,ci,Ai,Ge,Mt,n.ai.horizontal,!1,oi,it,J);ni&&(at.horizontal[Ai]=ni),vi(),kl(Ae)&&v&&x&&(at.vertical=cd(Bt,a.glyphMap,a.glyphPositions,a.imagePositions,M,ii,b,ci,Ai,Ge,Mt,n.ai.vertical,!1,oi,it,J))}}let ne=!1;if(Z.icon&&Z.icon.name){let Ae=a.imageMap[Z.icon.name];Ae&&(Gt=o3(a.imagePositions[Z.icon.name],A.get("icon-offset").evaluate(Z,{},a.canonical),A.get("icon-anchor").evaluate(Z,{},a.canonical)),ne=!!Ae.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=ne:a.bucket.sdfIcons!==ne&&At("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ae.pixelRatio!==a.bucket.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}let Yt=ab(at.horizontal)||at.vertical;a.bucket.iconsInText=!!Yt&&Yt.iconsInText,(Yt||Gt)&&w3(a.bucket,Z,at,Gt,a.imageMap,f,it,ot,Mt,ne,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},n.br=wm,n.bs=ym,n.bt=vm,n.bu=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},n.bv=_m,n.bw=Wl,n.bx=function(a,r,A,u,f){return g(this,void 0,void 0,function*(){if(z())try{return yield Lt(a,r,A,u,f)}catch{}return function(b,v,x,Q,Z){let M=b.width,J=b.height;Ht&&fe||(Ht=new OffscreenCanvas(M,J),fe=Ht.getContext("2d",{willReadFrequently:!0})),Ht.width=M,Ht.height=J,fe.drawImage(b,0,0,M,J);let it=fe.getImageData(v,x,Q,Z);return fe.clearRect(0,0,M,J),it.data}(a,r,A,u,f)})},n.by=K1,n.bz=h,n.c=Vt,n.d=function(a,r){let A=new Image;A.onload=()=>{r(null,A),URL.revokeObjectURL(A.src),A.onload=null,window.requestAnimationFrame(()=>{A.src=se})},A.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let u=new Blob([new Uint8Array(a)],{type:"image/png"});A.src=a.byteLength?URL.createObjectURL(u):se},n.e=Qt,n.f=function(a,r){return Ve(Qt(a,{type:"json"}),r)},n.g=me,n.h=bt,n.i=ue,n.j=Rt,n.k=Be,n.l=De,n.m=Ve,n.n=function(a){return new _m(a).readFields(t3,[])},n.o=function(a,r,A){if(!a.length)return A(null,[]);let u=a.length,f=new Array(a.length),b=null;a.forEach((v,x)=>{r(v,(Q,Z)=>{Q&&(b=Q),f[x]=Z,--u==0&&A(b,f)})})},n.p=w1,n.q=Kl,n.r=yn,n.s=ei,n.t=Xr,n.u=ai,n.v=$t,n.w=At,n.x=mn,n.y=Vn,n.z=function([a,r,A]){return r+=90,r*=Math.PI/180,A*=Math.PI/180,{x:a*Math.cos(r)*Math.sin(A),y:a*Math.sin(r)*Math.sin(A),z:a*Math.cos(A)}}}),o(["./shared"],function(n){"use strict";class g{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y){this._layerConfigs={},this._layers={},this.update(Y,[])}update(Y,q){for(let _t of Y){this._layerConfigs[_t.id]=_t;let xt=this._layers[_t.id]=n.aC(_t);xt._featureFilter=n.a6(xt.filter),this.keyCache[_t.id]&&delete this.keyCache[_t.id]}for(let _t of q)delete this.keyCache[_t],delete this._layerConfigs[_t],delete this._layers[_t];this.familiesBySource={};let lt=n.bl(Object.values(this._layerConfigs),this.keyCache);for(let _t of lt){let xt=_t.map(ve=>this._layers[ve.id]),qt=xt[0];if(qt.visibility==="none")continue;let Jt=qt.source||"",mt=this.familiesBySource[Jt];mt||(mt=this.familiesBySource[Jt]={});let jt=qt.sourceLayer||"_geojsonTileLayer",_e=mt[jt];_e||(_e=mt[jt]=[]),_e.push(xt)}}}class h{constructor(Y){let q={},lt=[];for(let Jt in Y){let mt=Y[Jt],jt=q[Jt]={};for(let _e in mt){let ve=mt[+_e];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;let xe={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};lt.push(xe),jt[_e]={rect:xe,metrics:ve.metrics}}}let{w:_t,h:xt}=n.p(lt),qt=new n.q({width:_t||1,height:xt||1});for(let Jt in Y){let mt=Y[Jt];for(let jt in mt){let _e=mt[+jt];if(!_e||_e.bitmap.width===0||_e.bitmap.height===0)continue;let ve=q[Jt][jt].rect;n.q.copy(_e.bitmap,qt,{x:0,y:0},{x:ve.x+1,y:ve.y+1},_e.bitmap)}}this.image=qt,this.positions=q}}n.bm("GlyphAtlas",h);class m{constructor(Y){this.tileID=new n.O(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.uid=Y.uid,this.zoom=Y.zoom,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.collectResourceTiming,this.returnDependencies=!!Y.returnDependencies,this.promoteId=Y.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(Y,q,lt,_t,xt){this.status="parsing",this.data=Y,this.collisionBoxArray=new n.a3;let qt=new n.bn(Object.keys(Y.layers).sort()),Jt=new n.bo(this.tileID,this.promoteId);Jt.bucketLayerIDs=[];let mt={},jt={featureIndex:Jt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:lt},_e=q.familiesBySource[this.source];for(let Ji in _e){let Mi=Y.layers[Ji];if(!Mi)continue;Mi.version===1&&n.w(`Vector tile source "${this.source}" layer "${Ji}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let kr=qt.encode(Ji),Nt=[];for(let ze=0;ze<Mi.length;ze++){let Ne=Mi.feature(ze),Wi=Jt.getId(Ne,Ji);Nt.push({feature:Ne,id:Wi,index:ze,sourceLayerIndex:kr})}for(let ze of _e[Ji]){let Ne=ze[0];Ne.source!==this.source&&n.w(`layer.source = ${Ne.source} does not equal this.source = ${this.source}`),Ne.minzoom&&this.zoom<Math.floor(Ne.minzoom)||Ne.maxzoom&&this.zoom>=Ne.maxzoom||Ne.visibility!=="none"&&(B(ze,this.zoom,lt),(mt[Ne.id]=Ne.createBucket({index:Jt.bucketLayerIDs.length,layers:ze,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:kr,sourceID:this.source})).populate(Nt,jt,this.tileID.canonical),Jt.bucketLayerIDs.push(ze.map(Wi=>Wi.id)))}}let ve,xe,si,_i,ui=n.aH(jt.glyphDependencies,Ji=>Object.keys(Ji).map(Number));this.inFlightDependencies.forEach(Ji=>Ji?.cancel()),this.inFlightDependencies=[];let fi=++this.dependencySentinel;Object.keys(ui).length?this.inFlightDependencies.push(_t.send("getGlyphs",{uid:this.uid,stacks:ui,source:this.source,tileID:this.tileID,type:"glyphs"},(Ji,Mi)=>{fi===this.dependencySentinel&&(ve||(ve=Ji,xe=Mi,or.call(this)))})):xe={};let bi=Object.keys(jt.iconDependencies);bi.length?this.inFlightDependencies.push(_t.send("getImages",{icons:bi,source:this.source,tileID:this.tileID,type:"icons"},(Ji,Mi)=>{fi===this.dependencySentinel&&(ve||(ve=Ji,si=Mi,or.call(this)))})):si={};let $i=Object.keys(jt.patternDependencies);function or(){if(ve)return xt(ve);if(xe&&si&&_i){let Ji=new h(xe),Mi=new n.bp(si,_i);for(let kr in mt){let Nt=mt[kr];Nt instanceof n.a4?(B(Nt.layers,this.zoom,lt),n.bq({bucket:Nt,glyphMap:xe,glyphPositions:Ji.positions,imageMap:si,imagePositions:Mi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Nt.hasPattern&&(Nt instanceof n.br||Nt instanceof n.bs||Nt instanceof n.bt)&&(B(Nt.layers,this.zoom,lt),Nt.addFeatures(jt,this.tileID.canonical,Mi.patternPositions))}this.status="done",xt(null,{buckets:Object.values(mt).filter(kr=>!kr.isEmpty()),featureIndex:Jt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ji.image,imageAtlas:Mi,glyphMap:this.returnDependencies?xe:null,iconMap:this.returnDependencies?si:null,glyphPositions:this.returnDependencies?Ji.positions:null})}}$i.length?this.inFlightDependencies.push(_t.send("getImages",{icons:$i,source:this.source,tileID:this.tileID,type:"patterns"},(Ji,Mi)=>{fi===this.dependencySentinel&&(ve||(ve=Ji,_i=Mi,or.call(this)))})):_i={},or.call(this)}}function B(gt,Y,q){let lt=new n.a8(Y);for(let _t of gt)_t.recalculate(lt,q)}function _(gt,Y){let q=n.l(gt.request,(lt,_t,xt,qt)=>{if(lt)Y(lt);else if(_t)try{let Jt=new n.bw.VectorTile(new n.bv(_t));Y(null,{vectorTile:Jt,rawData:_t,cacheControl:xt,expires:qt})}catch(Jt){let mt=new Uint8Array(_t),jt=`Unable to parse the tile at ${gt.request.url}, `;jt+=mt[0]===31&&mt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Jt.messge}`,Y(new Error(jt))}});return()=>{q.cancel(),Y()}}class E{constructor(Y,q,lt,_t){this.actor=Y,this.layerIndex=q,this.availableImages=lt,this.loadVectorData=_t||_,this.fetching={},this.loading={},this.loaded={}}loadTile(Y,q){let lt=Y.uid;this.loading||(this.loading={});let _t=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new n.bu(Y.request),xt=this.loading[lt]=new m(Y);xt.abort=this.loadVectorData(Y,(qt,Jt)=>{if(delete this.loading[lt],qt||!Jt)return xt.status="done",this.loaded[lt]=xt,q(qt);let mt=Jt.rawData,jt={};Jt.expires&&(jt.expires=Jt.expires),Jt.cacheControl&&(jt.cacheControl=Jt.cacheControl);let _e={};if(_t){let ve=_t.finish();ve&&(_e.resourceTiming=JSON.parse(JSON.stringify(ve)))}xt.vectorTile=Jt.vectorTile,xt.parse(Jt.vectorTile,this.layerIndex,this.availableImages,this.actor,(ve,xe)=>{if(delete this.fetching[lt],ve||!xe)return q(ve);q(null,n.e({rawTileData:mt.slice(0)},xe,jt,_e))}),this.loaded=this.loaded||{},this.loaded[lt]=xt,this.fetching[lt]={rawTileData:mt,cacheControl:jt,resourceTiming:_e}})}reloadTile(Y,q){let lt=this.loaded,_t=Y.uid;if(lt&&lt[_t]){let xt=lt[_t];xt.showCollisionBoxes=Y.showCollisionBoxes,xt.status==="parsing"?xt.parse(xt.vectorTile,this.layerIndex,this.availableImages,this.actor,(qt,Jt)=>{if(qt||!Jt)return q(qt,Jt);let mt;if(this.fetching[_t]){let{rawTileData:jt,cacheControl:_e,resourceTiming:ve}=this.fetching[_t];delete this.fetching[_t],mt=n.e({rawTileData:jt.slice(0)},Jt,_e,ve)}else mt=Jt;q(null,mt)}):xt.status==="done"&&(xt.vectorTile?xt.parse(xt.vectorTile,this.layerIndex,this.availableImages,this.actor,q):q())}}abortTile(Y,q){let lt=this.loading,_t=Y.uid;lt&&lt[_t]&&lt[_t].abort&&(lt[_t].abort(),delete lt[_t]),q()}removeTile(Y,q){let lt=this.loaded,_t=Y.uid;lt&&lt[_t]&&delete lt[_t],q()}}class G{constructor(){this.loaded={}}loadTile(Y,q){return n._(this,void 0,void 0,function*(){let{uid:lt,encoding:_t,rawImageData:xt,redFactor:qt,greenFactor:Jt,blueFactor:mt,baseShift:jt}=Y,_e=xt.width+2,ve=xt.height+2,xe=n.a(xt)?new n.R({width:_e,height:ve},yield n.bx(xt,-1,-1,_e,ve)):xt,si=new n.by(lt,xe,_t,qt,Jt,mt,jt);this.loaded=this.loaded||{},this.loaded[lt]=si,q(null,si)})}removeTile(Y){let q=this.loaded,lt=Y.uid;q&&q[lt]&&delete q[lt]}}function S(gt,Y){if(gt.length!==0){O(gt[0],Y);for(var q=1;q<gt.length;q++)O(gt[q],!Y)}}function O(gt,Y){for(var q=0,lt=0,_t=0,xt=gt.length,qt=xt-1;_t<xt;qt=_t++){var Jt=(gt[_t][0]-gt[qt][0])*(gt[qt][1]+gt[_t][1]),mt=q+Jt;lt+=Math.abs(q)>=Math.abs(Jt)?q-mt+Jt:Jt-mt+q,q=mt}q+lt>=0!=!!Y&&gt.reverse()}var P=n.bz(function gt(Y,q){var lt,_t=Y&&Y.type;if(_t==="FeatureCollection")for(lt=0;lt<Y.features.length;lt++)gt(Y.features[lt],q);else if(_t==="GeometryCollection")for(lt=0;lt<Y.geometries.length;lt++)gt(Y.geometries[lt],q);else if(_t==="Feature")gt(Y.geometry,q);else if(_t==="Polygon")S(Y.coordinates,q);else if(_t==="MultiPolygon")for(lt=0;lt<Y.coordinates.length;lt++)S(Y.coordinates[lt],q);return Y});let tt=n.bw.VectorTileFeature.prototype.toGeoJSON;var z={exports:{}},rt=n.bA,ct=n.bw.VectorTileFeature,Et=Pt;function Pt(gt,Y){this.options=Y||{},this.features=gt,this.length=gt.length}function Qt(gt,Y){this.id=typeof gt.id=="number"?gt.id:void 0,this.type=gt.type,this.rawGeometry=gt.type===1?[gt.geometry]:gt.geometry,this.properties=gt.tags,this.extent=Y||4096}Pt.prototype.feature=function(gt){return new Qt(this.features[gt],this.options.extent)},Qt.prototype.loadGeometry=function(){var gt=this.rawGeometry;this.geometry=[];for(var Y=0;Y<gt.length;Y++){for(var q=gt[Y],lt=[],_t=0;_t<q.length;_t++)lt.push(new rt(q[_t][0],q[_t][1]));this.geometry.push(lt)}return this.geometry},Qt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var gt=this.geometry,Y=1/0,q=-1/0,lt=1/0,_t=-1/0,xt=0;xt<gt.length;xt++)for(var qt=gt[xt],Jt=0;Jt<qt.length;Jt++){var mt=qt[Jt];Y=Math.min(Y,mt.x),q=Math.max(q,mt.x),lt=Math.min(lt,mt.y),_t=Math.max(_t,mt.y)}return[Y,lt,q,_t]},Qt.prototype.toGeoJSON=ct.prototype.toGeoJSON;var Ut=n.bB,dt=Et;function ee(gt){var Y=new Ut;return function(q,lt){for(var _t in q.layers)lt.writeMessage(3,oe,q.layers[_t])}(gt,Y),Y.finish()}function oe(gt,Y){var q;Y.writeVarintField(15,gt.version||1),Y.writeStringField(1,gt.name||""),Y.writeVarintField(5,gt.extent||4096);var lt={keys:[],values:[],keycache:{},valuecache:{}};for(q=0;q<gt.length;q++)lt.feature=gt.feature(q),Y.writeMessage(2,ht,lt);var _t=lt.keys;for(q=0;q<_t.length;q++)Y.writeStringField(3,_t[q]);var xt=lt.values;for(q=0;q<xt.length;q++)Y.writeMessage(4,ce,xt[q])}function ht(gt,Y){var q=gt.feature;q.id!==void 0&&Y.writeVarintField(1,q.id),Y.writeMessage(2,At,gt),Y.writeVarintField(3,q.type),Y.writeMessage(4,ue,q)}function At(gt,Y){var q=gt.feature,lt=gt.keys,_t=gt.values,xt=gt.keycache,qt=gt.valuecache;for(var Jt in q.properties){var mt=q.properties[Jt],jt=xt[Jt];if(mt!==null){jt===void 0&&(lt.push(Jt),xt[Jt]=jt=lt.length-1),Y.writeVarint(jt);var _e=typeof mt;_e!=="string"&&_e!=="boolean"&&_e!=="number"&&(mt=JSON.stringify(mt));var ve=_e+":"+mt,xe=qt[ve];xe===void 0&&(_t.push(mt),qt[ve]=xe=_t.length-1),Y.writeVarint(xe)}}}function Ft(gt,Y){return(Y<<3)+(7&gt)}function St(gt){return gt<<1^gt>>31}function ue(gt,Y){for(var q=gt.loadGeometry(),lt=gt.type,_t=0,xt=0,qt=q.length,Jt=0;Jt<qt;Jt++){var mt=q[Jt],jt=1;lt===1&&(jt=mt.length),Y.writeVarint(Ft(1,jt));for(var _e=lt===3?mt.length-1:mt.length,ve=0;ve<_e;ve++){ve===1&&lt!==1&&Y.writeVarint(Ft(2,_e-1));var xe=mt[ve].x-_t,si=mt[ve].y-xt;Y.writeVarint(St(xe)),Y.writeVarint(St(si)),_t+=xe,xt+=si}lt===3&&Y.writeVarint(Ft(7,1))}}function ce(gt,Y){var q=typeof gt;q==="string"?Y.writeStringField(1,gt):q==="boolean"?Y.writeBooleanField(7,gt):q==="number"&&(gt%1!=0?Y.writeDoubleField(3,gt):gt<0?Y.writeSVarintField(6,gt):Y.writeVarintField(5,gt))}z.exports=ee,z.exports.fromVectorTileJs=ee,z.exports.fromGeojsonVt=function(gt,Y){Y=Y||{};var q={};for(var lt in gt)q[lt]=new dt(gt[lt].features,Y),q[lt].name=lt,q[lt].version=Y.version,q[lt].extent=Y.extent;return ee({layers:q})},z.exports.GeoJSONWrapper=dt;var ae=n.bz(z.exports);let se={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:gt=>gt},Lt=Math.fround||(Ht=new Float32Array(1),gt=>(Ht[0]=+gt,Ht[0]));var Ht;let fe=3,j=5,It=6;class bt{constructor(Y){this.options=Object.assign(Object.create(se),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){let{log:q,minZoom:lt,maxZoom:_t}=this.options;q&&console.time("total time");let xt=`prepare ${Y.length} points`;q&&console.time(xt),this.points=Y;let qt=[];for(let mt=0;mt<Y.length;mt++){let jt=Y[mt];if(!jt.geometry)continue;let[_e,ve]=jt.geometry.coordinates,xe=Lt(he(_e)),si=Lt(me(ve));qt.push(xe,si,1/0,mt,-1,1),this.options.reduce&&qt.push(0)}let Jt=this.trees[_t+1]=this._createTree(qt);q&&console.timeEnd(xt);for(let mt=_t;mt>=lt;mt--){let jt=+Date.now();Jt=this.trees[mt]=this._createTree(this._cluster(Jt,mt)),q&&console.log("z%d: %d clusters in %dms",mt,Jt.numItems,+Date.now()-jt)}return q&&console.timeEnd("total time"),this}getClusters(Y,q){let lt=((Y[0]+180)%360+360)%360-180,_t=Math.max(-90,Math.min(90,Y[1])),xt=Y[2]===180?180:((Y[2]+180)%360+360)%360-180,qt=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)lt=-180,xt=180;else if(lt>xt){let ve=this.getClusters([lt,_t,180,qt],q),xe=this.getClusters([-180,_t,xt,qt],q);return ve.concat(xe)}let Jt=this.trees[this._limitZoom(q)],mt=Jt.range(he(lt),me(qt),he(xt),me(_t)),jt=Jt.data,_e=[];for(let ve of mt){let xe=this.stride*ve;_e.push(jt[xe+j]>1?Vt(jt,xe,this.clusterProps):this.points[jt[xe+fe]])}return _e}getChildren(Y){let q=this._getOriginId(Y),lt=this._getOriginZoom(Y),_t="No cluster with the specified id.",xt=this.trees[lt];if(!xt)throw new Error(_t);let qt=xt.data;if(q*this.stride>=qt.length)throw new Error(_t);let Jt=this.options.radius/(this.options.extent*Math.pow(2,lt-1)),mt=xt.within(qt[q*this.stride],qt[q*this.stride+1],Jt),jt=[];for(let _e of mt){let ve=_e*this.stride;qt[ve+4]===Y&&jt.push(qt[ve+j]>1?Vt(qt,ve,this.clusterProps):this.points[qt[ve+fe]])}if(jt.length===0)throw new Error(_t);return jt}getLeaves(Y,q,lt){let _t=[];return this._appendLeaves(_t,Y,q=q||10,lt=lt||0,0),_t}getTile(Y,q,lt){let _t=this.trees[this._limitZoom(Y)],xt=Math.pow(2,Y),{extent:qt,radius:Jt}=this.options,mt=Jt/qt,jt=(lt-mt)/xt,_e=(lt+1+mt)/xt,ve={features:[]};return this._addTileFeatures(_t.range((q-mt)/xt,jt,(q+1+mt)/xt,_e),_t.data,q,lt,xt,ve),q===0&&this._addTileFeatures(_t.range(1-mt/xt,jt,1,_e),_t.data,xt,lt,xt,ve),q===xt-1&&this._addTileFeatures(_t.range(0,jt,mt/xt,_e),_t.data,-1,lt,xt,ve),ve.features.length?ve:null}getClusterExpansionZoom(Y){let q=this._getOriginZoom(Y)-1;for(;q<=this.options.maxZoom;){let lt=this.getChildren(Y);if(q++,lt.length!==1)break;Y=lt[0].properties.cluster_id}return q}_appendLeaves(Y,q,lt,_t,xt){let qt=this.getChildren(q);for(let Jt of qt){let mt=Jt.properties;if(mt&&mt.cluster?xt+mt.point_count<=_t?xt+=mt.point_count:xt=this._appendLeaves(Y,mt.cluster_id,lt,_t,xt):xt<_t?xt++:Y.push(Jt),Y.length===lt)break}return xt}_createTree(Y){let q=new n.av(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let lt=0;lt<Y.length;lt+=this.stride)q.add(Y[lt],Y[lt+1]);return q.finish(),q.data=Y,q}_addTileFeatures(Y,q,lt,_t,xt,qt){for(let Jt of Y){let mt=Jt*this.stride,jt=q[mt+j]>1,_e,ve,xe;if(jt)_e=Xt(q,mt,this.clusterProps),ve=q[mt],xe=q[mt+1];else{let ui=this.points[q[mt+fe]];_e=ui.properties;let[fi,bi]=ui.geometry.coordinates;ve=he(fi),xe=me(bi)}let si={type:1,geometry:[[Math.round(this.options.extent*(ve*xt-lt)),Math.round(this.options.extent*(xe*xt-_t))]],tags:_e},_i;_i=jt||this.options.generateId?q[mt+fe]:this.points[q[mt+fe]].id,_i!==void 0&&(si.id=_i),qt.features.push(si)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,q){let{radius:lt,extent:_t,reduce:xt,minPoints:qt}=this.options,Jt=lt/(_t*Math.pow(2,q)),mt=Y.data,jt=[],_e=this.stride;for(let ve=0;ve<mt.length;ve+=_e){if(mt[ve+2]<=q)continue;mt[ve+2]=q;let xe=mt[ve],si=mt[ve+1],_i=Y.within(mt[ve],mt[ve+1],Jt),ui=mt[ve+j],fi=ui;for(let bi of _i){let $i=bi*_e;mt[$i+2]>q&&(fi+=mt[$i+j])}if(fi>ui&&fi>=qt){let bi,$i=xe*ui,or=si*ui,Ji=-1,Mi=((ve/_e|0)<<5)+(q+1)+this.points.length;for(let kr of _i){let Nt=kr*_e;if(mt[Nt+2]<=q)continue;mt[Nt+2]=q;let ze=mt[Nt+j];$i+=mt[Nt]*ze,or+=mt[Nt+1]*ze,mt[Nt+4]=Mi,xt&&(bi||(bi=this._map(mt,ve,!0),Ji=this.clusterProps.length,this.clusterProps.push(bi)),xt(bi,this._map(mt,Nt)))}mt[ve+4]=Mi,jt.push($i/fi,or/fi,1/0,Mi,-1,fi),xt&&jt.push(Ji)}else{for(let bi=0;bi<_e;bi++)jt.push(mt[ve+bi]);if(fi>1)for(let bi of _i){let $i=bi*_e;if(!(mt[$i+2]<=q)){mt[$i+2]=q;for(let or=0;or<_e;or++)jt.push(mt[$i+or])}}}}return jt}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,q,lt){if(Y[q+j]>1){let qt=this.clusterProps[Y[q+It]];return lt?Object.assign({},qt):qt}let _t=this.points[Y[q+fe]].properties,xt=this.options.map(_t);return lt&&xt===_t?Object.assign({},xt):xt}}function Vt(gt,Y,q){return{type:"Feature",id:gt[Y+fe],properties:Xt(gt,Y,q),geometry:{type:"Point",coordinates:[(lt=gt[Y],360*(lt-.5)),be(gt[Y+1])]}};var lt}function Xt(gt,Y,q){let lt=gt[Y+j],_t=lt>=1e4?`${Math.round(lt/1e3)}k`:lt>=1e3?Math.round(lt/100)/10+"k":lt,xt=gt[Y+It],qt=xt===-1?{}:Object.assign({},q[xt]);return Object.assign(qt,{cluster:!0,cluster_id:gt[Y+fe],point_count:lt,point_count_abbreviated:_t})}function he(gt){return gt/360+.5}function me(gt){let Y=Math.sin(gt*Math.PI/180),q=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return q<0?0:q>1?1:q}function be(gt){let Y=(180-360*gt)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function Ve(gt,Y,q,lt){for(var _t,xt=lt,qt=q-Y>>1,Jt=q-Y,mt=gt[Y],jt=gt[Y+1],_e=gt[q],ve=gt[q+1],xe=Y+3;xe<q;xe+=3){var si=De(gt[xe],gt[xe+1],mt,jt,_e,ve);if(si>xt)_t=xe,xt=si;else if(si===xt){var _i=Math.abs(xe-qt);_i<Jt&&(_t=xe,Jt=_i)}}xt>lt&&(_t-Y>3&&Ve(gt,Y,_t,lt),gt[_t+2]=xt,q-_t>3&&Ve(gt,_t,q,lt))}function De(gt,Y,q,lt,_t,xt){var qt=_t-q,Jt=xt-lt;if(qt!==0||Jt!==0){var mt=((gt-q)*qt+(Y-lt)*Jt)/(qt*qt+Jt*Jt);mt>1?(q=_t,lt=xt):mt>0&&(q+=qt*mt,lt+=Jt*mt)}return(qt=gt-q)*qt+(Jt=Y-lt)*Jt}function ei(gt,Y,q,lt){var _t={id:gt===void 0?null:gt,type:Y,geometry:q,tags:lt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(xt){var qt=xt.geometry,Jt=xt.type;if(Jt==="Point"||Jt==="MultiPoint"||Jt==="LineString")ri(xt,qt);else if(Jt==="Polygon"||Jt==="MultiLineString")for(var mt=0;mt<qt.length;mt++)ri(xt,qt[mt]);else if(Jt==="MultiPolygon")for(mt=0;mt<qt.length;mt++)for(var jt=0;jt<qt[mt].length;jt++)ri(xt,qt[mt][jt])}(_t),_t}function ri(gt,Y){for(var q=0;q<Y.length;q+=3)gt.minX=Math.min(gt.minX,Y[q]),gt.minY=Math.min(gt.minY,Y[q+1]),gt.maxX=Math.max(gt.maxX,Y[q]),gt.maxY=Math.max(gt.maxY,Y[q+1])}function Ii(gt,Y,q,lt){if(Y.geometry){var _t=Y.geometry.coordinates,xt=Y.geometry.type,qt=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),Jt=[],mt=Y.id;if(q.promoteId?mt=Y.properties[q.promoteId]:q.generateId&&(mt=lt||0),xt==="Point")Be(_t,Jt);else if(xt==="MultiPoint")for(var jt=0;jt<_t.length;jt++)Be(_t[jt],Jt);else if(xt==="LineString")Rt(_t,Jt,qt,!1);else if(xt==="MultiLineString"){if(q.lineMetrics){for(jt=0;jt<_t.length;jt++)Rt(_t[jt],Jt=[],qt,!1),gt.push(ei(mt,"LineString",Jt,Y.properties));return}Ui(_t,Jt,qt,!1)}else if(xt==="Polygon")Ui(_t,Jt,qt,!0);else{if(xt!=="MultiPolygon"){if(xt==="GeometryCollection"){for(jt=0;jt<Y.geometry.geometries.length;jt++)Ii(gt,{id:mt,geometry:Y.geometry.geometries[jt],properties:Y.properties},q,lt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(jt=0;jt<_t.length;jt++){var _e=[];Ui(_t[jt],_e,qt,!0),Jt.push(_e)}}gt.push(ei(mt,xt,Jt,Y.properties))}}function Be(gt,Y){Y.push($t(gt[0])),Y.push(Ze(gt[1])),Y.push(0)}function Rt(gt,Y,q,lt){for(var _t,xt,qt=0,Jt=0;Jt<gt.length;Jt++){var mt=$t(gt[Jt][0]),jt=Ze(gt[Jt][1]);Y.push(mt),Y.push(jt),Y.push(0),Jt>0&&(qt+=lt?(_t*jt-mt*xt)/2:Math.sqrt(Math.pow(mt-_t,2)+Math.pow(jt-xt,2))),_t=mt,xt=jt}var _e=Y.length-3;Y[2]=1,Ve(Y,0,_e,q),Y[_e+2]=1,Y.size=Math.abs(qt),Y.start=0,Y.end=Y.size}function Ui(gt,Y,q,lt){for(var _t=0;_t<gt.length;_t++){var xt=[];Rt(gt[_t],xt,q,lt),Y.push(xt)}}function $t(gt){return gt/360+.5}function Ze(gt){var Y=Math.sin(gt*Math.PI/180),q=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return q<0?0:q>1?1:q}function We(gt,Y,q,lt,_t,xt,qt,Jt){if(lt/=Y,xt>=(q/=Y)&&qt<lt)return gt;if(qt<q||xt>=lt)return null;for(var mt=[],jt=0;jt<gt.length;jt++){var _e=gt[jt],ve=_e.geometry,xe=_e.type,si=_t===0?_e.minX:_e.minY,_i=_t===0?_e.maxX:_e.maxY;if(si>=q&&_i<lt)mt.push(_e);else if(!(_i<q||si>=lt)){var ui=[];if(xe==="Point"||xe==="MultiPoint")He(ve,ui,q,lt,_t);else if(xe==="LineString")Re(ve,ui,q,lt,_t,!1,Jt.lineMetrics);else if(xe==="MultiLineString")yi(ve,ui,q,lt,_t,!1);else if(xe==="Polygon")yi(ve,ui,q,lt,_t,!0);else if(xe==="MultiPolygon")for(var fi=0;fi<ve.length;fi++){var bi=[];yi(ve[fi],bi,q,lt,_t,!0),bi.length&&ui.push(bi)}if(ui.length){if(Jt.lineMetrics&&xe==="LineString"){for(fi=0;fi<ui.length;fi++)mt.push(ei(_e.id,xe,ui[fi],_e.tags));continue}xe!=="LineString"&&xe!=="MultiLineString"||(ui.length===1?(xe="LineString",ui=ui[0]):xe="MultiLineString"),xe!=="Point"&&xe!=="MultiPoint"||(xe=ui.length===3?"Point":"MultiPoint"),mt.push(ei(_e.id,xe,ui,_e.tags))}}}return mt.length?mt:null}function He(gt,Y,q,lt,_t){for(var xt=0;xt<gt.length;xt+=3){var qt=gt[xt+_t];qt>=q&&qt<=lt&&(Y.push(gt[xt]),Y.push(gt[xt+1]),Y.push(gt[xt+2]))}}function Re(gt,Y,q,lt,_t,xt,qt){for(var Jt,mt,jt=hi(gt),_e=_t===0?Pi:zi,ve=gt.start,xe=0;xe<gt.length-3;xe+=3){var si=gt[xe],_i=gt[xe+1],ui=gt[xe+2],fi=gt[xe+3],bi=gt[xe+4],$i=_t===0?si:_i,or=_t===0?fi:bi,Ji=!1;qt&&(Jt=Math.sqrt(Math.pow(si-fi,2)+Math.pow(_i-bi,2))),$i<q?or>q&&(mt=_e(jt,si,_i,fi,bi,q),qt&&(jt.start=ve+Jt*mt)):$i>lt?or<lt&&(mt=_e(jt,si,_i,fi,bi,lt),qt&&(jt.start=ve+Jt*mt)):Qi(jt,si,_i,ui),or<q&&$i>=q&&(mt=_e(jt,si,_i,fi,bi,q),Ji=!0),or>lt&&$i<=lt&&(mt=_e(jt,si,_i,fi,bi,lt),Ji=!0),!xt&&Ji&&(qt&&(jt.end=ve+Jt*mt),Y.push(jt),jt=hi(gt)),qt&&(ve+=Jt)}var Mi=gt.length-3;si=gt[Mi],_i=gt[Mi+1],ui=gt[Mi+2],($i=_t===0?si:_i)>=q&&$i<=lt&&Qi(jt,si,_i,ui),Mi=jt.length-3,xt&&Mi>=3&&(jt[Mi]!==jt[0]||jt[Mi+1]!==jt[1])&&Qi(jt,jt[0],jt[1],jt[2]),jt.length&&Y.push(jt)}function hi(gt){var Y=[];return Y.size=gt.size,Y.start=gt.start,Y.end=gt.end,Y}function yi(gt,Y,q,lt,_t,xt){for(var qt=0;qt<gt.length;qt++)Re(gt[qt],Y,q,lt,_t,xt,!1)}function Qi(gt,Y,q,lt){gt.push(Y),gt.push(q),gt.push(lt)}function Pi(gt,Y,q,lt,_t,xt){var qt=(xt-Y)/(lt-Y);return gt.push(xt),gt.push(q+(_t-q)*qt),gt.push(1),qt}function zi(gt,Y,q,lt,_t,xt){var qt=(xt-q)/(_t-q);return gt.push(Y+(lt-Y)*qt),gt.push(xt),gt.push(1),qt}function ir(gt,Y){for(var q=[],lt=0;lt<gt.length;lt++){var _t,xt=gt[lt],qt=xt.type;if(qt==="Point"||qt==="MultiPoint"||qt==="LineString")_t=Ei(xt.geometry,Y);else if(qt==="MultiLineString"||qt==="Polygon"){_t=[];for(var Jt=0;Jt<xt.geometry.length;Jt++)_t.push(Ei(xt.geometry[Jt],Y))}else if(qt==="MultiPolygon")for(_t=[],Jt=0;Jt<xt.geometry.length;Jt++){for(var mt=[],jt=0;jt<xt.geometry[Jt].length;jt++)mt.push(Ei(xt.geometry[Jt][jt],Y));_t.push(mt)}q.push(ei(xt.id,qt,_t,xt.tags))}return q}function Ei(gt,Y){var q=[];q.size=gt.size,gt.start!==void 0&&(q.start=gt.start,q.end=gt.end);for(var lt=0;lt<gt.length;lt+=3)q.push(gt[lt]+Y,gt[lt+1],gt[lt+2]);return q}function Fe(gt,Y){if(gt.transformed)return gt;var q,lt,_t,xt=1<<gt.z,qt=gt.x,Jt=gt.y;for(q=0;q<gt.features.length;q++){var mt=gt.features[q],jt=mt.geometry,_e=mt.type;if(mt.geometry=[],_e===1)for(lt=0;lt<jt.length;lt+=2)mt.geometry.push(Ye(jt[lt],jt[lt+1],Y,xt,qt,Jt));else for(lt=0;lt<jt.length;lt++){var ve=[];for(_t=0;_t<jt[lt].length;_t+=2)ve.push(Ye(jt[lt][_t],jt[lt][_t+1],Y,xt,qt,Jt));mt.geometry.push(ve)}}return gt.transformed=!0,gt}function Ye(gt,Y,q,lt,_t,xt){return[Math.round(q*(gt*lt-_t)),Math.round(q*(Y*lt-xt))]}function Ki(gt,Y,q,lt,_t){for(var xt=Y===_t.maxZoom?0:_t.tolerance/((1<<Y)*_t.extent),qt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:q,y:lt,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Jt=0;Jt<gt.length;Jt++){qt.numFeatures++,ji(qt,gt[Jt],xt,_t);var mt=gt[Jt].minX,jt=gt[Jt].minY,_e=gt[Jt].maxX,ve=gt[Jt].maxY;mt<qt.minX&&(qt.minX=mt),jt<qt.minY&&(qt.minY=jt),_e>qt.maxX&&(qt.maxX=_e),ve>qt.maxY&&(qt.maxY=ve)}return qt}function ji(gt,Y,q,lt){var _t=Y.geometry,xt=Y.type,qt=[];if(xt==="Point"||xt==="MultiPoint")for(var Jt=0;Jt<_t.length;Jt+=3)qt.push(_t[Jt]),qt.push(_t[Jt+1]),gt.numPoints++,gt.numSimplified++;else if(xt==="LineString")vr(qt,_t,gt,q,!1,!1);else if(xt==="MultiLineString"||xt==="Polygon")for(Jt=0;Jt<_t.length;Jt++)vr(qt,_t[Jt],gt,q,xt==="Polygon",Jt===0);else if(xt==="MultiPolygon")for(var mt=0;mt<_t.length;mt++){var jt=_t[mt];for(Jt=0;Jt<jt.length;Jt++)vr(qt,jt[Jt],gt,q,!0,Jt===0)}if(qt.length){var _e=Y.tags||null;if(xt==="LineString"&&lt.lineMetrics){for(var ve in _e={},Y.tags)_e[ve]=Y.tags[ve];_e.mapbox_clip_start=_t.start/_t.size,_e.mapbox_clip_end=_t.end/_t.size}var xe={geometry:qt,type:xt==="Polygon"||xt==="MultiPolygon"?3:xt==="LineString"||xt==="MultiLineString"?2:1,tags:_e};Y.id!==null&&(xe.id=Y.id),gt.features.push(xe)}}function vr(gt,Y,q,lt,_t,xt){var qt=lt*lt;if(lt>0&&Y.size<(_t?qt:lt))q.numPoints+=Y.length/3;else{for(var Jt=[],mt=0;mt<Y.length;mt+=3)(lt===0||Y[mt+2]>qt)&&(q.numSimplified++,Jt.push(Y[mt]),Jt.push(Y[mt+1])),q.numPoints++;_t&&function(jt,_e){for(var ve=0,xe=0,si=jt.length,_i=si-2;xe<si;_i=xe,xe+=2)ve+=(jt[xe]-jt[_i])*(jt[xe+1]+jt[_i+1]);if(ve>0===_e)for(xe=0,si=jt.length;xe<si/2;xe+=2){var ui=jt[xe],fi=jt[xe+1];jt[xe]=jt[si-2-xe],jt[xe+1]=jt[si-1-xe],jt[si-2-xe]=ui,jt[si-1-xe]=fi}}(Jt,xt),gt.push(Jt)}}function Qe(gt,Y){var q=(Y=this.options=function(_t,xt){for(var qt in xt)_t[qt]=xt[qt];return _t}(Object.create(this.options),Y)).debug;if(q&&console.time("preprocess data"),Y.maxZoom<0||Y.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Y.promoteId&&Y.generateId)throw new Error("promoteId and generateId cannot be used together.");var lt=function(_t,xt){var qt=[];if(_t.type==="FeatureCollection")for(var Jt=0;Jt<_t.features.length;Jt++)Ii(qt,_t.features[Jt],xt,Jt);else Ii(qt,_t.type==="Feature"?_t:{geometry:_t},xt);return qt}(gt,Y);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Y.indexMaxZoom,Y.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),lt=function(_t,xt){var qt=xt.buffer/xt.extent,Jt=_t,mt=We(_t,1,-1-qt,qt,0,-1,2,xt),jt=We(_t,1,1-qt,2+qt,0,-1,2,xt);return(mt||jt)&&(Jt=We(_t,1,-qt,1+qt,0,-1,2,xt)||[],mt&&(Jt=ir(mt,1).concat(Jt)),jt&&(Jt=Jt.concat(ir(jt,-1)))),Jt}(lt,Y),lt.length&&this.splitTile(lt,0,0,0),q&&(lt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function gi(gt,Y,q){return 32*((1<<gt)*q+Y)+gt}function Bi(gt,Y){return Y?gt.properties[Y]:gt.id}function Oi(gt,Y){if(gt==null)return!0;if(gt.type==="Feature")return Bi(gt,Y)!=null;if(gt.type==="FeatureCollection"){let q=new Set;for(let lt of gt.features){let _t=Bi(lt,Y);if(_t==null||q.has(_t))return!1;q.add(_t)}return!0}return!1}function Fr(gt,Y){let q=new Map;if(gt!=null)if(gt.type==="Feature")q.set(Bi(gt,Y),gt);else for(let lt of gt.features)q.set(Bi(lt,Y),lt);return q}Qe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Qe.prototype.splitTile=function(gt,Y,q,lt,_t,xt,qt){for(var Jt=[gt,Y,q,lt],mt=this.options,jt=mt.debug;Jt.length;){lt=Jt.pop(),q=Jt.pop(),Y=Jt.pop(),gt=Jt.pop();var _e=1<<Y,ve=gi(Y,q,lt),xe=this.tiles[ve];if(!xe&&(jt>1&&console.time("creation"),xe=this.tiles[ve]=Ki(gt,Y,q,lt,mt),this.tileCoords.push({z:Y,x:q,y:lt}),jt)){jt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Y,q,lt,xe.numFeatures,xe.numPoints,xe.numSimplified),console.timeEnd("creation"));var si="z"+Y;this.stats[si]=(this.stats[si]||0)+1,this.total++}if(xe.source=gt,_t){if(Y===mt.maxZoom||Y===_t)continue;var _i=1<<_t-Y;if(q!==Math.floor(xt/_i)||lt!==Math.floor(qt/_i))continue}else if(Y===mt.indexMaxZoom||xe.numPoints<=mt.indexMaxPoints)continue;if(xe.source=null,gt.length!==0){jt>1&&console.time("clipping");var ui,fi,bi,$i,or,Ji,Mi=.5*mt.buffer/mt.extent,kr=.5-Mi,Nt=.5+Mi,ze=1+Mi;ui=fi=bi=$i=null,or=We(gt,_e,q-Mi,q+Nt,0,xe.minX,xe.maxX,mt),Ji=We(gt,_e,q+kr,q+ze,0,xe.minX,xe.maxX,mt),gt=null,or&&(ui=We(or,_e,lt-Mi,lt+Nt,1,xe.minY,xe.maxY,mt),fi=We(or,_e,lt+kr,lt+ze,1,xe.minY,xe.maxY,mt),or=null),Ji&&(bi=We(Ji,_e,lt-Mi,lt+Nt,1,xe.minY,xe.maxY,mt),$i=We(Ji,_e,lt+kr,lt+ze,1,xe.minY,xe.maxY,mt),Ji=null),jt>1&&console.timeEnd("clipping"),Jt.push(ui||[],Y+1,2*q,2*lt),Jt.push(fi||[],Y+1,2*q,2*lt+1),Jt.push(bi||[],Y+1,2*q+1,2*lt),Jt.push($i||[],Y+1,2*q+1,2*lt+1)}}},Qe.prototype.getTile=function(gt,Y,q){var lt=this.options,_t=lt.extent,xt=lt.debug;if(gt<0||gt>24)return null;var qt=1<<gt,Jt=gi(gt,Y=(Y%qt+qt)%qt,q);if(this.tiles[Jt])return Fe(this.tiles[Jt],_t);xt>1&&console.log("drilling down to z%d-%d-%d",gt,Y,q);for(var mt,jt=gt,_e=Y,ve=q;!mt&&jt>0;)jt--,_e=Math.floor(_e/2),ve=Math.floor(ve/2),mt=this.tiles[gi(jt,_e,ve)];return mt&&mt.source?(xt>1&&console.log("found parent tile z%d-%d-%d",jt,_e,ve),xt>1&&console.time("drilling down"),this.splitTile(mt.source,jt,_e,ve,gt,Y,q),xt>1&&console.timeEnd("drilling down"),this.tiles[Jt]?Fe(this.tiles[Jt],_t):null):null};class pi extends E{constructor(Y,q,lt,_t){super(Y,q,lt),this._dataUpdateable=new Map,this.loadGeoJSON=(xt,qt)=>{let{promoteId:Jt}=xt;if(xt.request)return n.f(xt.request,(mt,jt,_e,ve)=>{this._dataUpdateable=Oi(jt,Jt)?Fr(jt,Jt):void 0,qt(mt,jt,_e,ve)});if(typeof xt.data=="string")try{let mt=JSON.parse(xt.data);this._dataUpdateable=Oi(mt,Jt)?Fr(mt,Jt):void 0,qt(null,mt)}catch{qt(new Error(`Input data given to '${xt.source}' is not a valid GeoJSON object.`))}else xt.dataDiff?this._dataUpdateable?(function(mt,jt,_e){var ve,xe,si,_i;if(jt.removeAll&&mt.clear(),jt.remove)for(let ui of jt.remove)mt.delete(ui);if(jt.add)for(let ui of jt.add){let fi=Bi(ui,_e);fi!=null&&mt.set(fi,ui)}if(jt.update)for(let ui of jt.update){let fi=mt.get(ui.id);if(fi==null)continue;let bi=!ui.removeAllProperties&&(((ve=ui.removeProperties)===null||ve===void 0?void 0:ve.length)>0||((xe=ui.addOrUpdateProperties)===null||xe===void 0?void 0:xe.length)>0);if((ui.newGeometry||ui.removeAllProperties||bi)&&(fi=Object.assign({},fi),mt.set(ui.id,fi),bi&&(fi.properties=Object.assign({},fi.properties))),ui.newGeometry&&(fi.geometry=ui.newGeometry),ui.removeAllProperties)fi.properties={};else if(((si=ui.removeProperties)===null||si===void 0?void 0:si.length)>0)for(let $i of ui.removeProperties)Object.prototype.hasOwnProperty.call(fi.properties,$i)&&delete fi.properties[$i];if(((_i=ui.addOrUpdateProperties)===null||_i===void 0?void 0:_i.length)>0)for(let{key:$i,value:or}of ui.addOrUpdateProperties)fi.properties[$i]=or}}(this._dataUpdateable,xt.dataDiff,Jt),qt(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):qt(new Error(`Cannot update existing geojson data in ${xt.source}`)):qt(new Error(`Input data given to '${xt.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,_t&&(this.loadGeoJSON=_t)}loadGeoJSONTile(Y,q){let lt=Y.tileID.canonical;if(!this._geoJSONIndex)return q(null,null);let _t=this._geoJSONIndex.getTile(lt.z,lt.x,lt.y);if(!_t)return q(null,null);let xt=new class{constructor(Jt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=n.N,this.length=Jt.length,this._features=Jt}feature(Jt){return new class{constructor(mt){this._feature=mt,this.extent=n.N,this.type=mt.type,this.properties=mt.tags,"id"in mt&&!isNaN(mt.id)&&(this.id=parseInt(mt.id,10))}loadGeometry(){if(this._feature.type===1){let mt=[];for(let jt of this._feature.geometry)mt.push([new n.P(jt[0],jt[1])]);return mt}{let mt=[];for(let jt of this._feature.geometry){let _e=[];for(let ve of jt)_e.push(new n.P(ve[0],ve[1]));mt.push(_e)}return mt}}toGeoJSON(mt,jt,_e){return tt.call(this,mt,jt,_e)}}(this._features[Jt])}}(_t.features),qt=ae(xt);qt.byteOffset===0&&qt.byteLength===qt.buffer.byteLength||(qt=new Uint8Array(qt)),q(null,{vectorTile:xt,rawData:qt.buffer})}loadData(Y,q){var lt;(lt=this._pendingRequest)===null||lt===void 0||lt.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});let _t=!!(Y&&Y.request&&Y.request.collectResourceTiming)&&new n.bu(Y.request);this._pendingCallback=q,this._pendingRequest=this.loadGeoJSON(Y,(xt,qt)=>{if(delete this._pendingCallback,delete this._pendingRequest,xt||!qt)return q(xt);if(typeof qt!="object")return q(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{P(qt,!0);try{if(Y.filter){let mt=n.bC(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(mt.result==="error")throw new Error(mt.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));qt={type:"FeatureCollection",features:qt.features.filter(_e=>mt.value.evaluate({zoom:0},_e))}}this._geoJSONIndex=Y.cluster?new bt(function({superclusterOptions:mt,clusterProperties:jt}){if(!jt||!mt)return mt;let _e={},ve={},xe={accumulated:null,zoom:0},si={properties:null},_i=Object.keys(jt);for(let ui of _i){let[fi,bi]=jt[ui],$i=n.bC(bi),or=n.bC(typeof fi=="string"?[fi,["accumulated"],["get",ui]]:fi);_e[ui]=$i.value,ve[ui]=or.value}return mt.map=ui=>{si.properties=ui;let fi={};for(let bi of _i)fi[bi]=_e[bi].evaluate(xe,si);return fi},mt.reduce=(ui,fi)=>{si.properties=fi;for(let bi of _i)xe.accumulated=ui[bi],ui[bi]=ve[bi].evaluate(xe,si)},mt}(Y)).load(qt.features):function(mt,jt){return new Qe(mt,jt)}(qt,Y.geojsonVtOptions)}catch(mt){return q(mt)}this.loaded={};let Jt={};if(_t){let mt=_t.finish();mt&&(Jt.resourceTiming={},Jt.resourceTiming[Y.source]=JSON.parse(JSON.stringify(mt)))}q(null,Jt)}})}reloadTile(Y,q){let lt=this.loaded;return lt&&lt[Y.uid]?super.reloadTile(Y,q):this.loadTile(Y,q)}removeSource(Y,q){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),q()}getClusterExpansionZoom(Y,q){try{q(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(lt){q(lt)}}getClusterChildren(Y,q){try{q(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(lt){q(lt)}}getClusterLeaves(Y,q){try{q(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(lt){q(lt)}}}class Pr{constructor(Y){this.self=Y,this.actor=new n.C(Y,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:E,geojson:pi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(q,lt)=>{if(this.workerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.workerSourceTypes[q]=lt},this.self.registerRTLTextPlugin=q=>{if(n.bD.isParsed())throw new Error("RTL text plugin already registered.");n.bD.applyArabicShaping=q.applyArabicShaping,n.bD.processBidirectionalText=q.processBidirectionalText,n.bD.processStyledBidirectionalText=q.processStyledBidirectionalText}}setReferrer(Y,q){this.referrer=q}setImages(Y,q,lt){this.availableImages[Y]=q;for(let _t in this.workerSources[Y]){let xt=this.workerSources[Y][_t];for(let qt in xt)xt[qt].availableImages=q}lt()}setLayers(Y,q,lt){this.getLayerIndex(Y).replace(q),lt()}updateLayers(Y,q,lt){this.getLayerIndex(Y).update(q.layers,q.removedIds),lt()}loadTile(Y,q,lt){this.getWorkerSource(Y,q.type,q.source).loadTile(q,lt)}loadDEMTile(Y,q,lt){this.getDEMWorkerSource(Y,q.source).loadTile(q,lt)}reloadTile(Y,q,lt){this.getWorkerSource(Y,q.type,q.source).reloadTile(q,lt)}abortTile(Y,q,lt){this.getWorkerSource(Y,q.type,q.source).abortTile(q,lt)}removeTile(Y,q,lt){this.getWorkerSource(Y,q.type,q.source).removeTile(q,lt)}removeDEMTile(Y,q){this.getDEMWorkerSource(Y,q.source).removeTile(q)}removeSource(Y,q,lt){if(!this.workerSources[Y]||!this.workerSources[Y][q.type]||!this.workerSources[Y][q.type][q.source])return;let _t=this.workerSources[Y][q.type][q.source];delete this.workerSources[Y][q.type][q.source],_t.removeSource!==void 0?_t.removeSource(q,lt):lt()}loadWorkerSource(Y,q,lt){try{this.self.importScripts(q.url),lt()}catch(_t){lt(_t.toString())}}syncRTLPluginState(Y,q,lt){try{n.bD.setState(q);let _t=n.bD.getPluginURL();if(n.bD.isLoaded()&&!n.bD.isParsed()&&_t!=null){this.self.importScripts(_t);let xt=n.bD.isParsed();lt(xt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${_t}`),xt)}}catch(_t){lt(_t.toString())}}getAvailableImages(Y){let q=this.availableImages[Y];return q||(q=[]),q}getLayerIndex(Y){let q=this.layerIndexes[Y];return q||(q=this.layerIndexes[Y]=new g),q}getWorkerSource(Y,q,lt){return this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][q]||(this.workerSources[Y][q]={}),this.workerSources[Y][q][lt]||(this.workerSources[Y][q][lt]=new this.workerSourceTypes[q]({send:(_t,xt,qt)=>{this.actor.send(_t,xt,qt,Y)}},this.getLayerIndex(Y),this.getAvailableImages(Y))),this.workerSources[Y][q][lt]}getDEMWorkerSource(Y,q){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][q]||(this.demWorkerSources[Y][q]=new G),this.demWorkerSources[Y][q]}}return n.i()&&(self.worker=new Pr(self)),Pr}),o(["./shared"],function(n){"use strict";var g="3.6.2";class h{static testProp(s){if(!h.docStyle)return s[0];for(let c=0;c<s.length;c++)if(s[c]in h.docStyle)return s[c];return s[0]}static create(s,c,d){let C=window.document.createElement(s);return c!==void 0&&(C.className=c),d&&d.appendChild(C),C}static createNS(s,c){return window.document.createElementNS(s,c)}static disableDrag(){h.docStyle&&h.selectProp&&(h.userSelect=h.docStyle[h.selectProp],h.docStyle[h.selectProp]="none")}static enableDrag(){h.docStyle&&h.selectProp&&(h.docStyle[h.selectProp]=h.userSelect)}static setTransform(s,c){s.style[h.transformProp]=c}static addEventListener(s,c,d,C={}){s.addEventListener(c,d,"passive"in C?C:C.capture)}static removeEventListener(s,c,d,C={}){s.removeEventListener(c,d,"passive"in C?C:C.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",h.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",h.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",h.suppressClickInternal,!0)},0)}static mousePos(s,c){let d=s.getBoundingClientRect();return new n.P(c.clientX-d.left-s.clientLeft,c.clientY-d.top-s.clientTop)}static touchPos(s,c){let d=s.getBoundingClientRect(),C=[];for(let y=0;y<c.length;y++)C.push(new n.P(c[y].clientX-d.left-s.clientLeft,c[y].clientY-d.top-s.clientTop));return C}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}}h.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,h.selectProp=h.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),h.transformProp=h.testProp(["transform","WebkitTransform"]);let m={supported:!1,testSupport:function(I){!E&&_&&(G?S(I):B=I)}},B,_,E=!1,G=!1;function S(I){let s=I.createTexture();I.bindTexture(I.TEXTURE_2D,s);try{if(I.texImage2D(I.TEXTURE_2D,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,_),I.isContextLost())return;m.supported=!0}catch{}I.deleteTexture(s),E=!0}var O,P;typeof document<"u"&&(_=document.createElement("img"),_.onload=function(){B&&S(B),B=null,G=!0},_.onerror=function(){E=!0,B=null},_.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(I){let s,c,d,C;I.resetRequestQueue=()=>{s=[],c=0,d=0,C={}},I.addThrottleControl=N=>{let D=d++;return C[D]=N,D},I.removeThrottleControl=N=>{delete C[N],L()},I.getImage=(N,D,W=!0)=>{m.supported&&(N.headers||(N.headers={}),N.headers.accept="image/webp,*/*");let st={requestParameters:N,supportImageRefresh:W,callback:D,cancelled:!1,completed:!1,cancel:()=>{st.completed||st.cancelled||(st.cancelled=!0,st.innerRequest&&(st.innerRequest.cancel(),c--),L())}};return s.push(st),L(),st};let y=N=>{let{requestParameters:D,supportImageRefresh:W,callback:st}=N;return n.e(D,{type:"image"}),(W!==!1||n.i()||n.g(D.url)||D.headers&&!Object.keys(D.headers).reduce((wt,yt)=>wt&&yt==="accept",!0)?n.m:R)(D,(wt,yt,kt,p)=>{F(N,st,wt,yt,kt,p)})},F=(N,D,W,st,wt,yt)=>{W?D(W):st instanceof HTMLImageElement||n.a(st)?D(null,st):st&&((kt,p)=>{typeof createImageBitmap=="function"?n.b(kt,p):n.d(kt,p)})(st,(kt,p)=>{kt!=null?D(kt):p!=null&&D(null,p,{cacheControl:wt,expires:yt})}),N.cancelled||(N.completed=!0,c--,L())},L=()=>{let N=(()=>{let D=Object.keys(C),W=!1;if(D.length>0){for(let st of D)if(W=C[st](),W)break}return W})()?n.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:n.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let D=c;D<N&&s.length>0;D++){let W=s.shift();if(W.cancelled){D--;continue}let st=y(W);c++,W.innerRequest=st}},R=(N,D)=>{let W=new Image,st=N.url,wt=!1,yt=N.credentials;return yt&&yt==="include"?W.crossOrigin="use-credentials":(yt&&yt==="same-origin"||!n.s(st))&&(W.crossOrigin="anonymous"),W.fetchPriority="high",W.onload=()=>{D(null,W),W.onerror=W.onload=null},W.onerror=()=>{wt||D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),W.onerror=W.onload=null},W.src=st,{cancel:()=>{wt=!0,W.src=""}}}}(O||(O={})),O.resetRequestQueue(),function(I){I.Glyphs="Glyphs",I.Image="Image",I.Source="Source",I.SpriteImage="SpriteImage",I.SpriteJSON="SpriteJSON",I.Style="Style",I.Tile="Tile",I.Unknown="Unknown"}(P||(P={}));class tt{constructor(s){this._transformRequestFn=s}transformRequest(s,c){return this._transformRequestFn&&this._transformRequestFn(s,c)||{url:s}}normalizeSpriteURL(s,c,d){let C=function(y){let F=y.match(z);if(!F)throw new Error(`Unable to parse URL "${y}"`);return{protocol:F[1],authority:F[2],path:F[3]||"/",params:F[4]?F[4].split("&"):[]}}(s);return C.path+=`${c}${d}`,function(y){let F=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${F}`}(C)}setTransformRequest(s){this._transformRequestFn=s}}let z=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function rt(I){var s=new n.A(3);return s[0]=I[0],s[1]=I[1],s[2]=I[2],s}var ct,Et=function(I,s,c){return I[0]=s[0]-c[0],I[1]=s[1]-c[1],I[2]=s[2]-c[2],I};ct=new n.A(3),n.A!=Float32Array&&(ct[0]=0,ct[1]=0,ct[2]=0);var Pt=function(I){var s=I[0],c=I[1];return s*s+c*c};function Qt(I){let s=[];if(typeof I=="string")s.push({id:"default",url:I});else if(I&&I.length>0){let c=[];for(let{id:d,url:C}of I){let y=`${d}${C}`;c.indexOf(y)===-1&&(c.push(y),s.push({id:d,url:C}))}}return s}function Ut(I,s,c,d,C){if(d)return void I(d);if(C!==Object.values(s).length||C!==Object.values(c).length)return;let y={};for(let F in s){y[F]={};let L=n.h.getImageCanvasContext(c[F]),R=s[F];for(let N in R){let{width:D,height:W,x:st,y:wt,sdf:yt,pixelRatio:kt,stretchX:p,stretchY:w,content:k}=R[N];y[F][N]={data:null,pixelRatio:kt,sdf:yt,stretchX:p,stretchY:w,content:k,spriteData:{width:D,height:W,x:st,y:wt,context:L}}}}I(null,y)}(function(){var I=new n.A(2);n.A!=Float32Array&&(I[0]=0,I[1]=0)})();class dt{constructor(s,c,d,C){this.context=s,this.format=d,this.texture=s.gl.createTexture(),this.update(c,C)}update(s,c,d){let{width:C,height:y}=s,F=!(this.size&&this.size[0]===C&&this.size[1]===y||d),{context:L}=this,{gl:R}=L;if(this.useMipmap=Boolean(c&&c.useMipmap),R.bindTexture(R.TEXTURE_2D,this.texture),L.pixelStoreUnpackFlipY.set(!1),L.pixelStoreUnpack.set(1),L.pixelStoreUnpackPremultiplyAlpha.set(this.format===R.RGBA&&(!c||c.premultiply!==!1)),F)this.size=[C,y],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||n.a(s)?R.texImage2D(R.TEXTURE_2D,0,this.format,this.format,R.UNSIGNED_BYTE,s):R.texImage2D(R.TEXTURE_2D,0,this.format,C,y,0,this.format,R.UNSIGNED_BYTE,s.data);else{let{x:N,y:D}=d||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||n.a(s)?R.texSubImage2D(R.TEXTURE_2D,0,N,D,R.RGBA,R.UNSIGNED_BYTE,s):R.texSubImage2D(R.TEXTURE_2D,0,N,D,C,y,R.RGBA,R.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&R.generateMipmap(R.TEXTURE_2D)}bind(s,c,d){let{context:C}=this,{gl:y}=C;y.bindTexture(y.TEXTURE_2D,this.texture),d!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=y.LINEAR),s!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,s),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,d||s),this.filter=s),c!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,c),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function ee(I){let{userImage:s}=I;return!!(s&&s.render&&s.render())&&(I.data.replace(new Uint8Array(s.data.buffer)),!0)}class oe extends n.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new n.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(let{ids:c,callback:d}of this.requestors)this._notify(c,d);this.requestors=[]}}getImage(s){let c=this.images[s];if(c&&!c.data&&c.spriteData){let d=c.spriteData;c.data=new n.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),c.spriteData=null}return c}addImage(s,c){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,c)&&(this.images[s]=c)}_validate(s,c){let d=!0,C=c.data||c.spriteData;return this._validateStretch(c.stretchX,C&&C.width)||(this.fire(new n.j(new Error(`Image "${s}" has invalid "stretchX" value`))),d=!1),this._validateStretch(c.stretchY,C&&C.height)||(this.fire(new n.j(new Error(`Image "${s}" has invalid "stretchY" value`))),d=!1),this._validateContent(c.content,c)||(this.fire(new n.j(new Error(`Image "${s}" has invalid "content" value`))),d=!1),d}_validateStretch(s,c){if(!s)return!0;let d=0;for(let C of s){if(C[0]<d||C[1]<C[0]||c<C[1])return!1;d=C[1]}return!0}_validateContent(s,c){if(!s)return!0;if(s.length!==4)return!1;let d=c.spriteData,C=d&&d.width||c.data.width,y=d&&d.height||c.data.height;return!(s[0]<0||C<s[0]||s[1]<0||y<s[1]||s[2]<0||C<s[2]||s[3]<0||y<s[3]||s[2]<s[0]||s[3]<s[1])}updateImage(s,c,d=!0){let C=this.getImage(s);if(d&&(C.data.width!==c.data.width||C.data.height!==c.data.height))throw new Error(`size mismatch between old image (${C.data.width}x${C.data.height}) and new image (${c.data.width}x${c.data.height}).`);c.version=C.version+1,this.images[s]=c,this.updatedImages[s]=!0}removeImage(s){let c=this.images[s];delete this.images[s],delete this.patterns[s],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s,c){let d=!0;if(!this.isLoaded())for(let C of s)this.images[C]||(d=!1);this.isLoaded()||d?this._notify(s,c):this.requestors.push({ids:s,callback:c})}_notify(s,c){let d={};for(let C of s){let y=this.getImage(C);y||(this.fire(new n.k("styleimagemissing",{id:C})),y=this.getImage(C)),y?d[C]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,hasRenderCallback:Boolean(y.userImage&&y.userImage.render)}:n.w(`Image "${C}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,d)}getPixelSize(){let{width:s,height:c}=this.atlasImage;return{width:s,height:c}}getPattern(s){let c=this.patterns[s],d=this.getImage(s);if(!d)return null;if(c&&c.position.version===d.version)return c.position;if(c)c.position.version=d.version;else{let C={w:d.data.width+2,h:d.data.height+2,x:0,y:0},y=new n.I(C,d);this.patterns[s]={bin:C,position:y}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){let c=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new dt(s,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){let s=[];for(let y in this.patterns)s.push(this.patterns[y].bin);let{w:c,h:d}=n.p(s),C=this.atlasImage;C.resize({width:c||1,height:d||1});for(let y in this.patterns){let{bin:F}=this.patterns[y],L=F.x+1,R=F.y+1,N=this.getImage(y).data,D=N.width,W=N.height;n.R.copy(N,C,{x:0,y:0},{x:L,y:R},{width:D,height:W}),n.R.copy(N,C,{x:0,y:W-1},{x:L,y:R-1},{width:D,height:1}),n.R.copy(N,C,{x:0,y:0},{x:L,y:R+W},{width:D,height:1}),n.R.copy(N,C,{x:D-1,y:0},{x:L-1,y:R},{width:1,height:W}),n.R.copy(N,C,{x:0,y:0},{x:L+D,y:R},{width:1,height:W})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(let c of s){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;let d=this.getImage(c);d||n.w(`Image with ID: "${c}" was not found`),ee(d)&&this.updateImage(c,d)}}}let ht=1e20;function At(I,s,c,d,C,y,F,L,R){for(let N=s;N<s+d;N++)Ft(I,c*y+N,y,C,F,L,R);for(let N=c;N<c+C;N++)Ft(I,N*y+s,1,d,F,L,R)}function Ft(I,s,c,d,C,y,F){y[0]=0,F[0]=-ht,F[1]=ht,C[0]=I[s];for(let L=1,R=0,N=0;L<d;L++){C[L]=I[s+L*c];let D=L*L;do{let W=y[R];N=(C[L]-C[W]+D-W*W)/(L-W)/2}while(N<=F[R]&&--R>-1);R++,y[R]=L,F[R]=N,F[R+1]=ht}for(let L=0,R=0;L<d;L++){for(;F[R+1]<L;)R++;let N=y[R],D=L-N;I[s+L*c]=C[N]+D*D}}class St{constructor(s,c){this.requestManager=s,this.localIdeographFontFamily=c,this.entries={}}setURL(s){this.url=s}getGlyphs(s,c){let d=[];for(let C in s)for(let y of s[C])d.push({stack:C,id:y});n.o(d,({stack:C,id:y},F)=>{let L=this.entries[C];L||(L=this.entries[C]={glyphs:{},requests:{},ranges:{}});let R=L.glyphs[y];if(R!==void 0)return void F(null,{stack:C,id:y,glyph:R});if(R=this._tinySDF(L,C,y),R)return L.glyphs[y]=R,void F(null,{stack:C,id:y,glyph:R});let N=Math.floor(y/256);if(256*N>65535)return void F(new Error("glyphs > 65535 not supported"));if(L.ranges[N])return void F(null,{stack:C,id:y,glyph:R});if(!this.url)return void F(new Error("glyphsUrl is not set"));let D=L.requests[N];D||(D=L.requests[N]=[],St.loadGlyphRange(C,N,this.url,this.requestManager,(W,st)=>{if(st){for(let wt in st)this._doesCharSupportLocalGlyph(+wt)||(L.glyphs[+wt]=st[+wt]);L.ranges[N]=!0}for(let wt of D)wt(W,st);delete L.requests[N]})),D.push((W,st)=>{W?F(W):st&&F(null,{stack:C,id:y,glyph:st[y]||null})})},(C,y)=>{if(C)c(C);else if(y){let F={};for(let{stack:L,id:R,glyph:N}of y)(F[L]||(F[L]={}))[R]=N&&{id:N.id,bitmap:N.bitmap.clone(),metrics:N.metrics};c(null,F)}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(n.u["CJK Unified Ideographs"](s)||n.u["Hangul Syllables"](s)||n.u.Hiragana(s)||n.u.Katakana(s))}_tinySDF(s,c,d){let C=this.localIdeographFontFamily;if(!C||!this._doesCharSupportLocalGlyph(d))return;let y=s.tinySDF;if(!y){let L="400";/bold/i.test(c)?L="900":/medium/i.test(c)?L="500":/light/i.test(c)&&(L="200"),y=s.tinySDF=new St.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:C,fontWeight:L})}let F=y.draw(String.fromCharCode(d));return{id:d,bitmap:new n.q({width:F.width||60,height:F.height||60},F.data),metrics:{width:F.glyphWidth/2||24,height:F.glyphHeight/2||24,left:F.glyphLeft/2+.5||0,top:F.glyphTop/2-27.5||-8,advance:F.glyphAdvance/2||24,isDoubleResolution:!0}}}}St.loadGlyphRange=function(I,s,c,d,C){let y=256*s,F=y+255,L=d.transformRequest(c.replace("{fontstack}",I).replace("{range}",`${y}-${F}`),P.Glyphs);n.l(L,(R,N)=>{if(R)C(R);else if(N){let D={};for(let W of n.n(N))D[W.id]=W;C(null,D)}})},St.TinySDF=class{constructor({fontSize:I=24,buffer:s=3,radius:c=8,cutoff:d=.25,fontFamily:C="sans-serif",fontWeight:y="normal",fontStyle:F="normal"}={}){this.buffer=s,this.cutoff=d,this.radius=c;let L=this.size=I+4*s,R=this._createCanvas(L),N=this.ctx=R.getContext("2d",{willReadFrequently:!0});N.font=`${F} ${y} ${I}px ${C}`,N.textBaseline="alphabetic",N.textAlign="left",N.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Uint16Array(L)}_createCanvas(I){let s=document.createElement("canvas");return s.width=s.height=I,s}draw(I){let{width:s,actualBoundingBoxAscent:c,actualBoundingBoxDescent:d,actualBoundingBoxLeft:C,actualBoundingBoxRight:y}=this.ctx.measureText(I),F=Math.ceil(c),L=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-C))),R=Math.min(this.size-this.buffer,F+Math.ceil(d)),N=L+2*this.buffer,D=R+2*this.buffer,W=Math.max(N*D,0),st=new Uint8ClampedArray(W),wt={data:st,width:N,height:D,glyphWidth:L,glyphHeight:R,glyphTop:F,glyphLeft:0,glyphAdvance:s};if(L===0||R===0)return wt;let{ctx:yt,buffer:kt,gridInner:p,gridOuter:w}=this;yt.clearRect(kt,kt,L,R),yt.fillText(I,kt,kt+F);let k=yt.getImageData(kt,kt,L,R);w.fill(ht,0,W),p.fill(0,0,W);for(let T=0;T<R;T++)for(let H=0;H<L;H++){let V=k.data[4*(T*L+H)+3]/255;if(V===0)continue;let K=(T+kt)*N+H+kt;if(V===1)w[K]=0,p[K]=ht;else{let X=.5-V;w[K]=X>0?X*X:0,p[K]=X<0?X*X:0}}At(w,0,0,N,D,N,this.f,this.v,this.z),At(p,kt,kt,L,R,N,this.f,this.v,this.z);for(let T=0;T<W;T++){let H=Math.sqrt(w[T])-Math.sqrt(p[T]);st[T]=Math.round(255-255*(H/this.radius+this.cutoff))}return wt}};class ue{constructor(){this.specification=n.v.light.position}possiblyEvaluate(s,c){return n.z(s.expression.evaluate(c))}interpolate(s,c,d){return{x:n.B.number(s.x,c.x,d),y:n.B.number(s.y,c.y,d),z:n.B.number(s.z,c.z,d)}}}let ce;class ae extends n.E{constructor(s){super(),ce=ce||new n.r({anchor:new n.D(n.v.light.anchor),position:new ue,color:new n.D(n.v.light.color),intensity:new n.D(n.v.light.intensity)}),this._transitionable=new n.T(ce),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,c={}){if(!this._validate(n.t,s,c))for(let d in s){let C=s[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),C):this._transitionable.setValue(d,C)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,c,d){return(!d||d.validate!==!1)&&n.x(this,s.call(n.y,n.e({value:c,style:{glyphs:!0,sprite:!0},styleSpec:n.v})))}}class se{constructor(s,c){this.width=s,this.height=c,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,c){let d=s.join(",")+String(c);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(s,c)),this.dashEntry[d]}getDashRanges(s,c,d){let C=[],y=s.length%2==1?-s[s.length-1]*d:0,F=s[0]*d,L=!0;C.push({left:y,right:F,isDash:L,zeroLength:s[0]===0});let R=s[0];for(let N=1;N<s.length;N++){L=!L;let D=s[N];y=R*d,R+=D,F=R*d,C.push({left:y,right:F,isDash:L,zeroLength:D===0})}return C}addRoundDash(s,c,d){let C=c/2;for(let y=-d;y<=d;y++){let F=this.width*(this.nextRow+d+y),L=0,R=s[L];for(let N=0;N<this.width;N++){N/R.right>1&&(R=s[++L]);let D=Math.abs(N-R.left),W=Math.abs(N-R.right),st=Math.min(D,W),wt,yt=y/d*(C+1);if(R.isDash){let kt=C-Math.abs(yt);wt=Math.sqrt(st*st+kt*kt)}else wt=C-Math.sqrt(st*st+yt*yt);this.data[F+N]=Math.max(0,Math.min(255,wt+128))}}}addRegularDash(s){for(let L=s.length-1;L>=0;--L){let R=s[L],N=s[L+1];R.zeroLength?s.splice(L,1):N&&N.isDash===R.isDash&&(N.left=R.left,s.splice(L,1))}let c=s[0],d=s[s.length-1];c.isDash===d.isDash&&(c.left=d.left-this.width,d.right=c.right+this.width);let C=this.width*this.nextRow,y=0,F=s[y];for(let L=0;L<this.width;L++){L/F.right>1&&(F=s[++y]);let R=Math.abs(L-F.left),N=Math.abs(L-F.right),D=Math.min(R,N);this.data[C+L]=Math.max(0,Math.min(255,(F.isDash?D:-D)+128))}}addDash(s,c){let d=c?7:0,C=2*d+1;if(this.nextRow+C>this.height)return n.w("LineAtlas out of space"),null;let y=0;for(let L=0;L<s.length;L++)y+=s[L];if(y!==0){let L=this.width/y,R=this.getDashRanges(s,this.width,L);c?this.addRoundDash(R,L,d):this.addRegularDash(R)}let F={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:y};return this.nextRow+=C,this.dirty=!0,F}bind(s){let c=s.gl;this.texture?(c.bindTexture(c.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,c.texSubImage2D(c.TEXTURE_2D,0,0,0,this.width,this.height,c.ALPHA,c.UNSIGNED_BYTE,this.data))):(this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.ALPHA,this.width,this.height,0,c.ALPHA,c.UNSIGNED_BYTE,this.data))}}class Lt{constructor(s,c,d){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=d;let C=this.workerPool.acquire(d);for(let y=0;y<C.length;y++){let F=new n.C(C[y],c,d);F.name=`Worker ${y}`,this.actors.push(F)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,c,d){n.o(this.actors,(C,y)=>{C.send(s,c,y)},d=d||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(s=!0){this.actors.forEach(c=>{c.remove()}),this.actors=[],s&&this.workerPool.release(this.id)}}function Ht(I,s,c){let d=function(C,y){if(C)return c(C);if(y){let F=n.F(n.e(y,I),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);y.vector_layers&&(F.vectorLayers=y.vector_layers,F.vectorLayerIds=F.vectorLayers.map(L=>L.id)),c(null,F)}};return I.url?n.f(s.transformRequest(I.url,P.Source),d):n.h.frame(()=>d(null,I))}class fe{constructor(s,c){s&&(c?this.setSouthWest(s).setNorthEast(c):Array.isArray(s)&&(s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1])))}setNorthEast(s){return this._ne=s instanceof n.L?new n.L(s.lng,s.lat):n.L.convert(s),this}setSouthWest(s){return this._sw=s instanceof n.L?new n.L(s.lng,s.lat):n.L.convert(s),this}extend(s){let c=this._sw,d=this._ne,C,y;if(s instanceof n.L)C=s,y=s;else{if(!(s instanceof fe))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(fe.convert(s)):this.extend(n.L.convert(s)):s&&("lng"in s||"lon"in s)&&"lat"in s?this.extend(n.L.convert(s)):this;if(C=s._sw,y=s._ne,!C||!y)return this}return c||d?(c.lng=Math.min(C.lng,c.lng),c.lat=Math.min(C.lat,c.lat),d.lng=Math.max(y.lng,d.lng),d.lat=Math.max(y.lat,d.lat)):(this._sw=new n.L(C.lng,C.lat),this._ne=new n.L(y.lng,y.lat)),this}getCenter(){return new n.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new n.L(this.getWest(),this.getNorth())}getSouthEast(){return new n.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){let{lng:c,lat:d}=n.L.convert(s),C=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(C=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&C}static convert(s){return s instanceof fe?s:s&&new fe(s)}static fromLngLat(s,c=0){let d=360*c/40075017,C=d/Math.cos(Math.PI/180*s.lat);return new fe(new n.L(s.lng-C,s.lat-d),new n.L(s.lng+C,s.lat+d))}}class j{constructor(s,c,d){this.bounds=fe.convert(this.validateBounds(s)),this.minzoom=c||0,this.maxzoom=d||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){let c=Math.pow(2,s.z),d=Math.floor(n.G(this.bounds.getWest())*c),C=Math.floor(n.H(this.bounds.getNorth())*c),y=Math.ceil(n.G(this.bounds.getEast())*c),F=Math.ceil(n.H(this.bounds.getSouth())*c);return s.x>=d&&s.x<y&&s.y>=C&&s.y<F}}class It extends n.E{constructor(s,c,d,C){if(super(),this.load=()=>{this._loaded=!1,this.fire(new n.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ht(this._options,this.map._requestManager,(y,F)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),y?this.fire(new n.j(y)):F&&(n.e(this,F),F.bounds&&(this.tileBounds=new j(F.bounds,this.minzoom,this.maxzoom)),this.fire(new n.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new n.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>n.e({},this._options),this.id=s,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,n.e(this,n.F(c,["url","scheme","tileSize","promoteId"])),this._options=n.e({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.cancel(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(s,c){let d=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),C={request:this.map._requestManager.transformRequest(d,P.Tile),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function y(F,L){return delete s.request,s.aborted?c(null):F&&F.status!==404?c(F):(L&&L.resourceTiming&&(s.resourceTiming=L.resourceTiming),this.map._refreshExpiredTiles&&L&&s.setExpiryData(L),s.loadVectorData(L,this.map.painter),c(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}C.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired"?s.state==="loading"?s.reloadCallback=c:s.request=s.actor.send("reloadTile",C,y.bind(this)):(s.actor=this.dispatcher.getActor(),s.request=s.actor.send("loadTile",C,y.bind(this)))}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id},void 0)}unloadTile(s){s.unloadVectorData(),s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class bt extends n.E{constructor(s,c,d,C){super(),this.id=s,this.dispatcher=d,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=n.e({type:"raster"},c),n.e(this,n.F(c,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new n.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ht(this._options,this.map._requestManager,(s,c)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new n.j(s)):c&&(n.e(this,c),c.bounds&&(this.tileBounds=new j(c.bounds,this.minzoom,this.maxzoom)),this.fire(new n.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new n.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.cancel(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}serialize(){return n.e({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,c){let d=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.request=O.getImage(this.map._requestManager.transformRequest(d,P.Tile),(C,y,F)=>{if(delete s.request,s.aborted)s.state="unloaded",c(null);else if(C)s.state="errored",c(C);else if(y){this.map._refreshExpiredTiles&&F&&s.setExpiryData(F);let L=this.map.painter.context,R=L.gl;s.texture=this.map.painter.getTileTexture(y.width),s.texture?s.texture.update(y,{useMipmap:!0}):(s.texture=new dt(L,y,R.RGBA,{useMipmap:!0}),s.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),L.extTextureFilterAnisotropic&&R.texParameterf(R.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax)),s.state="loaded",c(null)}},this.map._refreshExpiredTiles)}abortTile(s,c){s.request&&(s.request.cancel(),delete s.request),c()}unloadTile(s,c){s.texture&&this.map.painter.saveTileTexture(s.texture),c()}hasTransition(){return!1}}class Vt extends bt{constructor(s,c,d,C){super(s,c,d,C),this.type="raster-dem",this.maxzoom=22,this._options=n.e({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox",this.redFactor=c.redFactor,this.greenFactor=c.greenFactor,this.blueFactor=c.blueFactor,this.baseShift=c.baseShift}loadTile(s,c){let d=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),C=this.map._requestManager.transformRequest(d,P.Tile);function y(F,L){F&&(s.state="errored",c(F)),L&&(s.dem=L,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded",c(null))}s.neighboringTiles=this._getNeighboringTiles(s.tileID),s.request=O.getImage(C,(F,L,R)=>n._(this,void 0,void 0,function*(){if(delete s.request,s.aborted)s.state="unloaded",c(null);else if(F)s.state="errored",c(F);else if(L){this.map._refreshExpiredTiles&&s.setExpiryData(R);let N=n.a(L)&&n.J()?L:yield function(W){return n._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&n.K()){let st=W.width+2,wt=W.height+2;try{return new n.R({width:st,height:wt},yield n.M(W,-1,-1,st,wt))}catch{}}return n.h.getImageData(W,1)})}(L),D={uid:s.uid,coord:s.tileID,source:this.id,rawImageData:N,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};s.actor&&s.state!=="expired"||(s.actor=this.dispatcher.getActor(),s.actor.send("loadDEMTile",D,y))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(s){let c=s.canonical,d=Math.pow(2,c.z),C=(c.x-1+d)%d,y=c.x===0?s.wrap-1:s.wrap,F=(c.x+1+d)%d,L=c.x+1===d?s.wrap+1:s.wrap,R={};return R[new n.O(s.overscaledZ,y,c.z,C,c.y).key]={backfilled:!1},R[new n.O(s.overscaledZ,L,c.z,F,c.y).key]={backfilled:!1},c.y>0&&(R[new n.O(s.overscaledZ,y,c.z,C,c.y-1).key]={backfilled:!1},R[new n.O(s.overscaledZ,s.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},R[new n.O(s.overscaledZ,L,c.z,F,c.y-1).key]={backfilled:!1}),c.y+1<d&&(R[new n.O(s.overscaledZ,y,c.z,C,c.y+1).key]={backfilled:!1},R[new n.O(s.overscaledZ,s.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},R[new n.O(s.overscaledZ,L,c.z,F,c.y+1).key]={backfilled:!1}),R}unloadTile(s){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&s.actor.send("removeDEMTile",{uid:s.uid,source:this.id})}}class Xt extends n.E{constructor(s,c,d,C){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>n.e({},this._options,{type:this.type,data:this._data}),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(C),this._data=c.data,this._options=n.e({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;let y=n.N/this.tileSize;this.workerOptions=n.e({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*y,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*y,extent:n.N,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:n.N,radius:(c.clusterRadius||50)*y,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData(),this}updateData(s){return this._updateWorkerData(s),this}setClusterOptions(s){return this.workerOptions.cluster=s.cluster,s&&(s.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=s.clusterRadius),s.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=s.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(s,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:s,source:this.id},c),this}getClusterChildren(s,c){return this.actor.send("geojson.getClusterChildren",{clusterId:s,source:this.id},c),this}getClusterLeaves(s,c,d,C){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:s,limit:c,offset:d},C),this}_updateWorkerData(s){let c=n.e({},this.workerOptions);s?c.dataDiff=s:typeof this._data=="string"?(c.request=this.map._requestManager.transformRequest(n.h.resolveURL(this._data),P.Source),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new n.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,c,(d,C)=>{if(this._pendingLoads--,this._removed||C&&C.abandoned)return void this.fire(new n.k("dataabort",{dataType:"source"}));let y=null;if(C&&C.resourceTiming&&C.resourceTiming[this.id]&&(y=C.resourceTiming[this.id].slice(0)),d)return void this.fire(new n.j(d));let F={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&n.e(F,{resourceTiming:y}),this.fire(new n.k("data",Object.assign(Object.assign({},F),{sourceDataType:"metadata"}))),this.fire(new n.k("data",Object.assign(Object.assign({},F),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(s,c){let d=s.actor?"reloadTile":"loadTile";s.actor=this.actor;let C={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};s.request=this.actor.send(d,C,(y,F)=>(delete s.request,s.unloadVectorData(),s.aborted?c(null):y?c(y):(s.loadVectorData(F,this.map.painter,d==="reloadTile"),c(null))))}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.aborted=!0}unloadTile(s){s.unloadVectorData(),this.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var he=n.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class me extends n.E{constructor(s,c,d,C){super(),this.load=(y,F)=>{this._loaded=!1,this.fire(new n.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=O.getImage(this.map._requestManager.transformRequest(this.url,P.Image),(L,R)=>{this._request=null,this._loaded=!0,L?this.fire(new n.j(L)):R&&(this.image=R,y&&(this.coordinates=y),F&&F(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;let y=this.map.painter.context,F=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,he.members)),this.boundsSegments||(this.boundsSegments=n.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new dt(y,this.image,F.RGBA),this.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE));let L=!1;for(let R in this.tiles){let N=this.tiles[R];N.state!=="loaded"&&(N.state="loaded",N.texture=this.texture,L=!0)}L&&this.fire(new n.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=s,this.dispatcher=d,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=c}loaded(){return this._loaded}updateImage(s){return s.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=s.url,this.load(s.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new n.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(s){this.coordinates=s;let c=s.map(n.U.fromLngLat);this.tileID=function(C){let y=1/0,F=1/0,L=-1/0,R=-1/0;for(let st of C)y=Math.min(y,st.x),F=Math.min(F,st.y),L=Math.max(L,st.x),R=Math.max(R,st.y);let N=Math.max(L-y,R-F),D=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),W=Math.pow(2,D);return new n.W(D,Math.floor((y+L)/2*W),Math.floor((F+R)/2*W))}(c),this.minzoom=this.maxzoom=this.tileID.z;let d=c.map(C=>this.tileID.getTilePoint(C)._round());return this._boundsArray=new n.V,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,n.N,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,n.N),this._boundsArray.emplaceBack(d[2].x,d[2].y,n.N,n.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new n.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(s,c){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},c(null)):(s.state="errored",c(null))}hasTransition(){return!1}}class be extends me{constructor(s,c,d,C){super(s,c,d,C),this.load=()=>{this._loaded=!1;let y=this.options;this.urls=[];for(let F of y.urls)this.urls.push(this.map._requestManager.transformRequest(F,P.Source).url);n.X(this.urls,(F,L)=>{this._loaded=!0,F?this.fire(new n.j(F)):L&&(this.video=L,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let y=this.map.painter.context,F=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,he.members)),this.boundsSegments||(this.boundsSegments=n.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE),F.texSubImage2D(F.TEXTURE_2D,0,0,0,F.RGBA,F.UNSIGNED_BYTE,this.video)):(this.texture=new dt(y,this.video,F.RGBA),this.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE));let L=!1;for(let R in this.tiles){let N=this.tiles[R];N.state!=="loaded"&&(N.state="loaded",N.texture=this.texture,L=!0)}L&&this.fire(new n.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=c}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){let c=this.video.seekable;s<c.start(0)||s>c.end(0)?this.fire(new n.j(new n.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Ve extends me{constructor(s,c,d,C){super(s,c,d,C),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new n.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let F=this.map.painter.context,L=F.gl;this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,he.members)),this.boundsSegments||(this.boundsSegments=n.S.simpleSegment(0,0,4,2)),this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new dt(F,this.canvas,L.RGBA,{premultiply:!0});let R=!1;for(let N in this.tiles){let D=this.tiles[N];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture,R=!0)}R&&this.fire(new n.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(F=>typeof F!="number"))||this.fire(new n.j(new n.Y(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new n.j(new n.Y(`sources.${s}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new n.j(new n.Y(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof HTMLCanvasElement||this.fire(new n.j(new n.Y(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new n.j(new n.Y(`sources.${s}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}let De={},ei=I=>{switch(I){case"geojson":return Xt;case"image":return me;case"raster":return bt;case"raster-dem":return Vt;case"vector":return It;case"video":return be;case"canvas":return Ve}return De[I]};function ri(I,s){let c=n.Z();return n.$(c,c,[1,1,0]),n.a0(c,c,[.5*I.width,.5*I.height,1]),n.a1(c,c,I.calculatePosMatrix(s.toUnwrapped()))}function Ii(I,s,c,d,C,y){let F=function(W,st,wt){if(W)for(let yt of W){let kt=st[yt];if(kt&&kt.source===wt&&kt.type==="fill-extrusion")return!0}else for(let yt in st){let kt=st[yt];if(kt.source===wt&&kt.type==="fill-extrusion")return!0}return!1}(C&&C.layers,s,I.id),L=y.maxPitchScaleFactor(),R=I.tilesIn(d,L,F);R.sort(Be);let N=[];for(let W of R)N.push({wrappedTileID:W.tileID.wrapped().key,queryResults:W.tile.queryRenderedFeatures(s,c,I._state,W.queryGeometry,W.cameraQueryGeometry,W.scale,C,y,L,ri(I.transform,W.tileID))});let D=function(W){let st={},wt={};for(let yt of W){let kt=yt.queryResults,p=yt.wrappedTileID,w=wt[p]=wt[p]||{};for(let k in kt){let T=kt[k],H=w[k]=w[k]||{},V=st[k]=st[k]||[];for(let K of T)H[K.featureIndex]||(H[K.featureIndex]=!0,V.push(K))}}return st}(N);for(let W in D)D[W].forEach(st=>{let wt=st.feature,yt=I.getFeatureState(wt.layer["source-layer"],wt.id);wt.source=wt.layer.source,wt.layer["source-layer"]&&(wt.sourceLayer=wt.layer["source-layer"]),wt.state=yt});return D}function Be(I,s){let c=I.tileID,d=s.tileID;return c.overscaledZ-d.overscaledZ||c.canonical.y-d.canonical.y||c.wrap-d.wrap||c.canonical.x-d.canonical.x}class Rt{constructor(s,c){this.timeAdded=0,this.fadeEndTime=0,this.tileID=s,this.uid=n.a2(),this.uses=0,this.tileSize=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){let c=s+this.timeAdded;c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(s,c,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(C,y){let F={};if(!y)return F;for(let L of C){let R=L.layerIds.map(N=>y.getLayer(N)).filter(Boolean);if(R.length!==0){L.layers=R,L.stateDependentLayerIds&&(L.stateDependentLayers=L.stateDependentLayerIds.map(N=>R.filter(D=>D.id===N)[0]));for(let N of R)F[N.id]=L}}return F}(s.buckets,c.style),this.hasSymbolBuckets=!1;for(let C in this.buckets){let y=this.buckets[C];if(y instanceof n.a4){if(this.hasSymbolBuckets=!0,!d)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let C in this.buckets){let y=this.buckets[C];if(y instanceof n.a4&&y.hasRTLText){this.hasRTLText=!0,n.a5();break}}this.queryPadding=0;for(let C in this.buckets){let y=this.buckets[C];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(C).queryRadius(y))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new n.a3}unloadVectorData(){for(let s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(let d in this.buckets){let C=this.buckets[d];C.uploadPending()&&C.upload(s)}let c=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new dt(s,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new dt(s,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,c,d,C,y,F,L,R,N,D){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:y,scale:F,tileSize:this.tileSize,pixelPosMatrix:D,transform:R,params:L,queryPadding:this.queryPadding*N},s,c,d):{}}querySourceFeatures(s,c){let d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;let C=d.loadVTLayers(),y=c&&c.sourceLayer?c.sourceLayer:"",F=C._geojsonTileLayer||C[y];if(!F)return;let L=n.a6(c&&c.filter),{z:R,x:N,y:D}=this.tileID.canonical,W={z:R,x:N,y:D};for(let st=0;st<F.length;st++){let wt=F.feature(st);if(L.needGeometry){let p=n.a7(wt,!0);if(!L.filter(new n.a8(this.tileID.overscaledZ),p,this.tileID.canonical))continue}else if(!L.filter(new n.a8(this.tileID.overscaledZ),wt))continue;let yt=d.getId(wt,y),kt=new n.a9(wt,R,N,D,yt);kt.tile=W,s.push(kt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){let c=this.expirationTime;if(s.cacheControl){let d=n.aa(s.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){let d=Date.now(),C=!1;if(this.expirationTime>d)C=!1;else if(c)if(this.expirationTime<c)C=!0;else{let y=this.expirationTime-c;y?this.expirationTime=d+Math.max(y,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0)return;let d=this.latestFeatureIndex.loadVTLayers();for(let C in this.buckets){if(!c.style.hasLayer(C))continue;let y=this.buckets[C],F=y.layers[0].sourceLayer||"_geojsonTileLayer",L=d[F],R=s[F];if(!L||!R||Object.keys(R).length===0)continue;y.update(R,L,this.imageAtlas&&this.imageAtlas.patternPositions||{});let N=c&&c.style&&c.style.getLayer(C);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<n.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=n.h.now()+s}setDependencies(s,c){let d={};for(let C of c)d[C]=!0;this.dependencies[s]=d}hasDependency(s,c){for(let d of s){let C=this.dependencies[d];if(C){for(let y of c)if(C[y])return!0}}return!1}}class Ui{constructor(s,c){this.max=s,this.onRemove=c,this.reset()}reset(){for(let s in this.data)for(let c of this.data[s])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(s,c,d){let C=s.wrapped().key;this.data[C]===void 0&&(this.data[C]=[]);let y={value:c,timeout:void 0};if(d!==void 0&&(y.timeout=setTimeout(()=>{this.remove(s,y)},d)),this.data[C].push(y),this.order.push(C),this.order.length>this.max){let F=this._getAndRemoveByKey(this.order[0]);F&&this.onRemove(F)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){let c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value}getByKey(s){let c=this.data[s];return c?c[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,c){if(!this.has(s))return this;let d=s.wrapped().key,C=c===void 0?0:this.data[d].indexOf(c),y=this.data[d][C];return this.data[d].splice(C,1),y.timeout&&clearTimeout(y.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(y.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){let c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(s){let c=[];for(let d in this.data)for(let C of this.data[d])s(C.value)||c.push(C);for(let d of c)this.remove(d.value.tileID,d)}}class $t{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,c,d){let C=String(c);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][C]=this.stateChanges[s][C]||{},n.e(this.stateChanges[s][C],d),this.deletedStates[s]===null){this.deletedStates[s]={};for(let y in this.state[s])y!==C&&(this.deletedStates[s][y]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][C]===null){this.deletedStates[s][C]={};for(let y in this.state[s][C])d[y]||(this.deletedStates[s][C][y]=null)}else for(let y in d)this.deletedStates[s]&&this.deletedStates[s][C]&&this.deletedStates[s][C][y]===null&&delete this.deletedStates[s][C][y]}removeFeatureState(s,c,d){if(this.deletedStates[s]===null)return;let C=String(c);if(this.deletedStates[s]=this.deletedStates[s]||{},d&&c!==void 0)this.deletedStates[s][C]!==null&&(this.deletedStates[s][C]=this.deletedStates[s][C]||{},this.deletedStates[s][C][d]=null);else if(c!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][C])for(d in this.deletedStates[s][C]={},this.stateChanges[s][C])this.deletedStates[s][C][d]=null;else this.deletedStates[s][C]=null;else this.deletedStates[s]=null}getState(s,c){let d=String(c),C=n.e({},(this.state[s]||{})[d],(this.stateChanges[s]||{})[d]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){let y=this.deletedStates[s][c];if(y===null)return{};for(let F in y)delete C[F]}return C}initializeTileState(s,c){s.setFeatureState(this.state,c)}coalesceChanges(s,c){let d={};for(let C in this.stateChanges){this.state[C]=this.state[C]||{};let y={};for(let F in this.stateChanges[C])this.state[C][F]||(this.state[C][F]={}),n.e(this.state[C][F],this.stateChanges[C][F]),y[F]=this.state[C][F];d[C]=y}for(let C in this.deletedStates){this.state[C]=this.state[C]||{};let y={};if(this.deletedStates[C]===null)for(let F in this.state[C])y[F]={},this.state[C][F]={};else for(let F in this.deletedStates[C]){if(this.deletedStates[C][F]===null)this.state[C][F]={};else for(let L of Object.keys(this.deletedStates[C][F]))delete this.state[C][F][L];y[F]=this.state[C][F]}d[C]=d[C]||{},n.e(d[C],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(let C in s)s[C].setFeatureState(d,c)}}class Ze extends n.E{constructor(s,c,d){super(),this.id=s,this.dispatcher=d,this.on("data",C=>{C.dataType==="source"&&C.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&C.dataType==="source"&&C.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((C,y,F,L)=>{let R=new(ei(y.type))(C,y,F,L);if(R.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${R.id}`);return R})(s,c,d,this),this._tiles={},this._cache=new Ui(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new $t,this._didEmitContent=!1,this._updated=!1}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._maxTileCacheZoomLevels=s?s._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let s in this._tiles){let c=this._tiles[s];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,c){return this._source.loadTile(s,c)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){this._source.abortTile&&this._source.abortTile(s,()=>{}),this._source.fire(new n.k("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let c in this._tiles){let d=this._tiles[c];d.upload(s),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(We).map(s=>s.key)}getRenderableIds(s){let c=[];for(let d in this._tiles)this._isIdRenderable(d,s)&&c.push(this._tiles[d]);return s?c.sort((d,C)=>{let y=d.tileID,F=C.tileID,L=new n.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),R=new n.P(F.canonical.x,F.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-F.overscaledZ||R.y-L.y||R.x-L.x}).map(d=>d.tileID.key):c.map(d=>d.tileID).sort(We).map(d=>d.key)}hasRenderableParent(s){let c=this.findLoadedParent(s,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(s,c){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(c||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(s,c){let d=this._tiles[s];d&&(d.state!=="loading"&&(d.state=c),this._loadTile(d,this._tileLoaded.bind(this,d,s,c)))}_tileLoaded(s,c,d,C){if(C)return s.state="errored",void(C.status!==404?this._source.fire(new n.j(C,{tile:s})):this.update(this.transform,this.terrain));s.timeAdded=n.h.now(),d==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(c,s),this.getSource().type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new n.k("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){let c=this.getRenderableIds();for(let C=0;C<c.length;C++){let y=c[C];if(s.neighboringTiles&&s.neighboringTiles[y]){let F=this.getTileByID(y);d(s,F),d(F,s)}}function d(C,y){C.needsHillshadePrepare=!0,C.needsTerrainPrepare=!0;let F=y.tileID.canonical.x-C.tileID.canonical.x,L=y.tileID.canonical.y-C.tileID.canonical.y,R=Math.pow(2,C.tileID.canonical.z),N=y.tileID.key;F===0&&L===0||Math.abs(L)>1||(Math.abs(F)>1&&(Math.abs(F+R)===1?F+=R:Math.abs(F-R)===1&&(F-=R)),y.dem&&C.dem&&(C.dem.backfillBorder(y.dem,F,L),C.neighboringTiles&&C.neighboringTiles[N]&&(C.neighboringTiles[N].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,c,d,C){for(let y in this._tiles){let F=this._tiles[y];if(C[y]||!F.hasData()||F.tileID.overscaledZ<=c||F.tileID.overscaledZ>d)continue;let L=F.tileID;for(;F&&F.tileID.overscaledZ>c+1;){let N=F.tileID.scaledTo(F.tileID.overscaledZ-1);F=this._tiles[N.key],F&&F.hasData()&&(L=N)}let R=L;for(;R.overscaledZ>c;)if(R=R.scaledTo(R.overscaledZ-1),s[R.key]){C[L.key]=L;break}}}findLoadedParent(s,c){if(s.key in this._loadedParentTiles){let d=this._loadedParentTiles[s.key];return d&&d.tileID.overscaledZ>=c?d:null}for(let d=s.overscaledZ-1;d>=c;d--){let C=s.scaledTo(d),y=this._getLoadedTile(C);if(y)return y}}_getLoadedTile(s){let c=this._tiles[s.key];return c&&c.hasData()?c:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){let c=Math.ceil(s.width/this._source.tileSize)+1,d=Math.ceil(s.height/this._source.tileSize)+1,C=Math.floor(c*d*(this._maxTileCacheZoomLevels===null?n.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(y)}handleWrapJump(s){let c=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,c){let d={};for(let C in this._tiles){let y=this._tiles[C];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+c),d[y.tileID.key]=y}this._tiles=d;for(let C in this._timers)clearTimeout(this._timers[C]),delete this._timers[C];for(let C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}}update(s,c){if(this.transform=s,this.terrain=c,!this._sourceLoaded||this._paused)return;let d;this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(D=>new n.O(D.canonical.z,D.wrap,D.canonical.z,D.canonical.x,D.canonical.y)):(d=s.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:c}),this._source.hasTile&&(d=d.filter(D=>this._source.hasTile(D)))):d=[];let C=s.coveringZoomLevel(this._source),y=Math.max(C-Ze.maxOverzooming,this._source.minzoom),F=Math.max(C+Ze.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let D={};for(let W of d)if(W.canonical.z>this._source.minzoom){let st=W.scaledTo(W.canonical.z-1);D[st.key]=st;let wt=W.scaledTo(Math.max(this._source.minzoom,Math.min(W.canonical.z,5)));D[wt.key]=wt}d=d.concat(Object.values(D))}let L=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,L&&this.fire(new n.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let R=this._updateRetainedTiles(d,C);if(He(this._source.type)){let D={},W={},st=Object.keys(R),wt=n.h.now();for(let yt of st){let kt=R[yt],p=this._tiles[yt];if(!p||p.fadeEndTime!==0&&p.fadeEndTime<=wt)continue;let w=this.findLoadedParent(kt,y);w&&(this._addTile(w.tileID),D[w.tileID.key]=w.tileID),W[yt]=kt}this._retainLoadedChildren(W,C,F,R);for(let yt in D)R[yt]||(this._coveredTiles[yt]=!0,R[yt]=D[yt]);if(c){let yt={},kt={};for(let p of d)this._tiles[p.key].hasData()?yt[p.key]=p:kt[p.key]=p;for(let p in kt){let w=kt[p].children(this._source.maxzoom);this._tiles[w[0].key]&&this._tiles[w[1].key]&&this._tiles[w[2].key]&&this._tiles[w[3].key]&&(yt[w[0].key]=R[w[0].key]=w[0],yt[w[1].key]=R[w[1].key]=w[1],yt[w[2].key]=R[w[2].key]=w[2],yt[w[3].key]=R[w[3].key]=w[3],delete kt[p])}for(let p in kt){let w=this.findLoadedParent(kt[p],this._source.minzoom);if(w){yt[w.tileID.key]=R[w.tileID.key]=w.tileID;for(let k in yt)yt[k].isChildOf(w.tileID)&&delete yt[k]}}for(let p in this._tiles)yt[p]||(this._coveredTiles[p]=!0)}}for(let D in R)this._tiles[D].clearFadeHold();let N=n.ab(this._tiles,R);for(let D of N){let W=this._tiles[D];W.hasSymbolBuckets&&!W.holdingForFade()?W.setHoldDuration(this.map._fadeDuration):W.hasSymbolBuckets&&!W.symbolFadeFinished()||this._removeTile(D)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,c){let d={},C={},y=Math.max(c-Ze.maxOverzooming,this._source.minzoom),F=Math.max(c+Ze.maxUnderzooming,this._source.minzoom),L={};for(let R of s){let N=this._addTile(R);d[R.key]=R,N.hasData()||c<this._source.maxzoom&&(L[R.key]=R)}this._retainLoadedChildren(L,c,F,d);for(let R of s){let N=this._tiles[R.key];if(N.hasData())continue;if(c+1>this._source.maxzoom){let W=R.children(this._source.maxzoom)[0],st=this.getTile(W);if(st&&st.hasData()){d[W.key]=W;continue}}else{let W=R.children(this._source.maxzoom);if(d[W[0].key]&&d[W[1].key]&&d[W[2].key]&&d[W[3].key])continue}let D=N.wasRequested();for(let W=R.overscaledZ-1;W>=y;--W){let st=R.scaledTo(W);if(C[st.key])break;if(C[st.key]=!0,N=this.getTile(st),!N&&D&&(N=this._addTile(st)),N){let wt=N.hasData();if((D||wt)&&(d[st.key]=st),D=N.wasRequested(),wt)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let s in this._tiles){let c=[],d,C=this._tiles[s].tileID;for(;C.overscaledZ>0;){if(C.key in this._loadedParentTiles){d=this._loadedParentTiles[C.key];break}c.push(C.key);let y=C.scaledTo(C.overscaledZ-1);if(d=this._getLoadedTile(y),d)break;C=y}for(let y of c)this._loadedParentTiles[y]=d}}_addTile(s){let c=this._tiles[s.key];if(c)return c;c=this._cache.getAndRemove(s),c&&(this._setTileReloadTimer(s.key,c),c.tileID=s,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,c)));let d=c;return c||(c=new Rt(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,s.key,c.state))),c.uses++,this._tiles[s.key]=c,d||this._source.fire(new n.k("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(s,c){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);let d=c.getExpiryTimeout();d&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},d))}_removeTile(s){let c=this._tiles[s];c&&(c.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,c,d){let C=[],y=this.transform;if(!y)return C;let F=d?y.getCameraQueryGeometry(s):s,L=s.map(yt=>y.pointCoordinate(yt,this.terrain)),R=F.map(yt=>y.pointCoordinate(yt,this.terrain)),N=this.getIds(),D=1/0,W=1/0,st=-1/0,wt=-1/0;for(let yt of R)D=Math.min(D,yt.x),W=Math.min(W,yt.y),st=Math.max(st,yt.x),wt=Math.max(wt,yt.y);for(let yt=0;yt<N.length;yt++){let kt=this._tiles[N[yt]];if(kt.holdingForFade())continue;let p=kt.tileID,w=Math.pow(2,y.zoom-kt.tileID.overscaledZ),k=c*kt.queryPadding*n.N/kt.tileSize/w,T=[p.getTilePoint(new n.U(D,W)),p.getTilePoint(new n.U(st,wt))];if(T[0].x-k<n.N&&T[0].y-k<n.N&&T[1].x+k>=0&&T[1].y+k>=0){let H=L.map(K=>p.getTilePoint(K)),V=R.map(K=>p.getTilePoint(K));C.push({tile:kt,tileID:p,queryGeometry:H,cameraQueryGeometry:V,scale:w})}}return C}getVisibleCoordinates(s){let c=this.getRenderableIds(s).map(d=>this._tiles[d].tileID);for(let d of c)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(He(this._source.type)){let s=n.h.now();for(let c in this._tiles)if(this._tiles[c].fadeEndTime>=s)return!0}return!1}setFeatureState(s,c,d){this._state.updateState(s=s||"_geojsonTileLayer",c,d)}removeFeatureState(s,c,d){this._state.removeFeatureState(s=s||"_geojsonTileLayer",c,d)}getFeatureState(s,c){return this._state.getState(s=s||"_geojsonTileLayer",c)}setDependencies(s,c,d){let C=this._tiles[s];C&&C.setDependencies(c,d)}reloadTilesForDependencies(s,c){for(let d in this._tiles)this._tiles[d].hasDependency(s,c)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(s,c))}}function We(I,s){let c=Math.abs(2*I.wrap)-+(I.wrap<0),d=Math.abs(2*s.wrap)-+(s.wrap<0);return I.overscaledZ-s.overscaledZ||d-c||s.canonical.y-I.canonical.y||s.canonical.x-I.canonical.x}function He(I){return I==="raster"||I==="image"||I==="video"}Ze.maxOverzooming=10,Ze.maxUnderzooming=3;let Re="mapboxgl_preloaded_worker_pool";class hi{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<hi.workerCount;)this.workers.push(new Worker(n.c.WORKER_URL));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Re]}numActive(){return Object.keys(this.active).length}}let yi=Math.floor(n.h.hardwareConcurrency/2),Qi;function Pi(){return Qi||(Qi=new hi),Qi}hi.workerCount=n.ac(globalThis)?Math.max(Math.min(yi,3),1):1;class zi{constructor(s,c){this.reset(s,c)}reset(s,c){this.points=s||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=n.ad(s,0,1);let c=1,d=this._distances[c],C=s*this.paddedLength+this.padding;for(;d<C&&c<this._distances.length;)d=this._distances[++c];let y=c-1,F=this._distances[y],L=d-F,R=L>0?(C-F)/L:0;return this.points[y].mult(1-R).add(this.points[c].mult(R))}}function ir(I,s){let c=!0;return I==="always"||I!=="never"&&s!=="never"||(c=!1),c}class Ei{constructor(s,c,d){let C=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(s/d),this.yCellCount=Math.ceil(c/d);for(let F=0;F<this.xCellCount*this.yCellCount;F++)C.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=c,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,c,d,C,y){this._forEachCell(c,d,C,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(C),this.bboxes.push(y)}insertCircle(s,c,d,C){this._forEachCell(c-C,d-C,c+C,d+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(c),this.circles.push(d),this.circles.push(C)}_insertBoxCell(s,c,d,C,y,F){this.boxCells[y].push(F)}_insertCircleCell(s,c,d,C,y,F){this.circleCells[y].push(F)}_query(s,c,d,C,y,F,L){if(d<0||s>this.width||C<0||c>this.height)return[];let R=[];if(s<=0&&c<=0&&this.width<=d&&this.height<=C){if(y)return[{key:null,x1:s,y1:c,x2:d,y2:C}];for(let N=0;N<this.boxKeys.length;N++)R.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){let D=this.circles[3*N],W=this.circles[3*N+1],st=this.circles[3*N+2];R.push({key:this.circleKeys[N],x1:D-st,y1:W-st,x2:D+st,y2:W+st})}}else this._forEachCell(s,c,d,C,this._queryCell,R,{hitTest:y,overlapMode:F,seenUids:{box:{},circle:{}}},L);return R}query(s,c,d,C){return this._query(s,c,d,C,!1,null)}hitTest(s,c,d,C,y,F){return this._query(s,c,d,C,!0,y,F).length>0}hitTestCircle(s,c,d,C,y){let F=s-d,L=s+d,R=c-d,N=c+d;if(L<0||F>this.width||N<0||R>this.height)return!1;let D=[];return this._forEachCell(F,R,L,N,this._queryCellCircle,D,{hitTest:!0,overlapMode:C,circle:{x:s,y:c,radius:d},seenUids:{box:{},circle:{}}},y),D.length>0}_queryCell(s,c,d,C,y,F,L,R){let{seenUids:N,hitTest:D,overlapMode:W}=L,st=this.boxCells[y];if(st!==null){let yt=this.bboxes;for(let kt of st)if(!N.box[kt]){N.box[kt]=!0;let p=4*kt,w=this.boxKeys[kt];if(s<=yt[p+2]&&c<=yt[p+3]&&d>=yt[p+0]&&C>=yt[p+1]&&(!R||R(w))&&(!D||!ir(W,w.overlapMode))&&(F.push({key:w,x1:yt[p],y1:yt[p+1],x2:yt[p+2],y2:yt[p+3]}),D))return!0}}let wt=this.circleCells[y];if(wt!==null){let yt=this.circles;for(let kt of wt)if(!N.circle[kt]){N.circle[kt]=!0;let p=3*kt,w=this.circleKeys[kt];if(this._circleAndRectCollide(yt[p],yt[p+1],yt[p+2],s,c,d,C)&&(!R||R(w))&&(!D||!ir(W,w.overlapMode))){let k=yt[p],T=yt[p+1],H=yt[p+2];if(F.push({key:w,x1:k-H,y1:T-H,x2:k+H,y2:T+H}),D)return!0}}}return!1}_queryCellCircle(s,c,d,C,y,F,L,R){let{circle:N,seenUids:D,overlapMode:W}=L,st=this.boxCells[y];if(st!==null){let yt=this.bboxes;for(let kt of st)if(!D.box[kt]){D.box[kt]=!0;let p=4*kt,w=this.boxKeys[kt];if(this._circleAndRectCollide(N.x,N.y,N.radius,yt[p+0],yt[p+1],yt[p+2],yt[p+3])&&(!R||R(w))&&!ir(W,w.overlapMode))return F.push(!0),!0}}let wt=this.circleCells[y];if(wt!==null){let yt=this.circles;for(let kt of wt)if(!D.circle[kt]){D.circle[kt]=!0;let p=3*kt,w=this.circleKeys[kt];if(this._circlesCollide(yt[p],yt[p+1],yt[p+2],N.x,N.y,N.radius)&&(!R||R(w))&&!ir(W,w.overlapMode))return F.push(!0),!0}}}_forEachCell(s,c,d,C,y,F,L,R){let N=this._convertToXCellCoord(s),D=this._convertToYCellCoord(c),W=this._convertToXCellCoord(d),st=this._convertToYCellCoord(C);for(let wt=N;wt<=W;wt++)for(let yt=D;yt<=st;yt++)if(y.call(this,s,c,d,C,this.xCellCount*yt+wt,F,L,R))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,c,d,C,y,F){let L=C-s,R=y-c,N=d+F;return N*N>L*L+R*R}_circleAndRectCollide(s,c,d,C,y,F,L){let R=(F-C)/2,N=Math.abs(s-(C+R));if(N>R+d)return!1;let D=(L-y)/2,W=Math.abs(c-(y+D));if(W>D+d)return!1;if(N<=R||W<=D)return!0;let st=N-R,wt=W-D;return st*st+wt*wt<=d*d}}function Fe(I,s,c,d,C){let y=n.Z();return s?(n.a0(y,y,[1/C,1/C,1]),c||n.ae(y,y,d.angle)):n.a1(y,d.labelPlaneMatrix,I),y}function Ye(I,s,c,d,C){if(s){let y=n.af(I);return n.a0(y,y,[C,C,1]),c||n.ae(y,y,-d.angle),y}return d.glCoordMatrix}function Ki(I,s,c){let d;c?(d=[I.x,I.y,c(I.x,I.y),1],n.ag(d,d,s)):(d=[I.x,I.y,0,1],_t(d,d,s));let C=d[3];return{point:new n.P(d[0]/C,d[1]/C),signedDistanceFromCamera:C}}function ji(I,s){return .5+I/s*.5}function vr(I,s){let c=I[0]/I[3],d=I[1]/I[3];return c>=-s[0]&&c<=s[0]&&d>=-s[1]&&d<=s[1]}function Qe(I,s,c,d,C,y,F,L,R,N){let D=d?I.textSizeData:I.iconSizeData,W=n.ah(D,c.transform.zoom),st=[256/c.width*2+1,256/c.height*2+1],wt=d?I.text.dynamicLayoutVertexArray:I.icon.dynamicLayoutVertexArray;wt.clear();let yt=I.lineVertexArray,kt=d?I.text.placedSymbolArray:I.icon.placedSymbolArray,p=c.transform.width/c.transform.height,w=!1;for(let k=0;k<kt.length;k++){let T=kt.get(k);if(T.hidden||T.writingMode===n.ai.vertical&&!w){lt(T.numGlyphs,wt);continue}let H;if(w=!1,N?(H=[T.anchorX,T.anchorY,N(T.anchorX,T.anchorY),1],n.ag(H,H,s)):(H=[T.anchorX,T.anchorY,0,1],_t(H,H,s)),!vr(H,st)){lt(T.numGlyphs,wt);continue}let V=ji(c.transform.cameraToCenterDistance,H[3]),K=n.aj(D,W,T),X=F?K/V:K*V,$=new n.P(T.anchorX,T.anchorY),nt=Ki($,C,N).point,Ct={projections:{},offsets:{}},zt=Oi(T,X,!1,L,s,C,y,I.glyphOffsetArray,yt,wt,nt,$,Ct,p,R,N);w=zt.useVertical,(zt.notEnoughRoom||w||zt.needsFlipping&&Oi(T,X,!0,L,s,C,y,I.glyphOffsetArray,yt,wt,nt,$,Ct,p,R,N).notEnoughRoom)&&lt(T.numGlyphs,wt)}d?I.text.dynamicLayoutVertexBuffer.updateData(wt):I.icon.dynamicLayoutVertexBuffer.updateData(wt)}function gi(I,s,c,d,C,y,F,L,R,N,D,W,st){let wt=L.glyphStartIndex+L.numGlyphs,yt=L.lineStartIndex,kt=L.lineStartIndex+L.lineLength,p=s.getoffsetX(L.glyphStartIndex),w=s.getoffsetX(wt-1),k=Y(I*p,c,d,C,y,F,L.segment,yt,kt,R,N,D,W,st);if(!k)return null;let T=Y(I*w,c,d,C,y,F,L.segment,yt,kt,R,N,D,W,st);return T?{first:k,last:T}:null}function Bi(I,s,c,d){return I===n.ai.horizontal&&Math.abs(c.y-s.y)>Math.abs(c.x-s.x)*d?{useVertical:!0}:(I===n.ai.vertical?s.y<c.y:s.x>c.x)?{needsFlipping:!0}:null}function Oi(I,s,c,d,C,y,F,L,R,N,D,W,st,wt,yt,kt){let p=s/24,w=I.lineOffsetX*p,k=I.lineOffsetY*p,T;if(I.numGlyphs>1){let H=I.glyphStartIndex+I.numGlyphs,V=I.lineStartIndex,K=I.lineStartIndex+I.lineLength,X=gi(p,L,w,k,c,D,W,I,R,y,st,yt,kt);if(!X)return{notEnoughRoom:!0};let $=Ki(X.first.point,F,kt).point,nt=Ki(X.last.point,F,kt).point;if(d&&!c){let Ct=Bi(I.writingMode,$,nt,wt);if(Ct)return Ct}T=[X.first];for(let Ct=I.glyphStartIndex+1;Ct<H-1;Ct++)T.push(Y(p*L.getoffsetX(Ct),w,k,c,D,W,I.segment,V,K,R,y,st,yt,kt));T.push(X.last)}else{if(d&&!c){let V=Ki(W,C,kt).point,K=I.lineStartIndex+I.segment+1,X=new n.P(R.getx(K),R.gety(K)),$=Ki(X,C,kt),nt=$.signedDistanceFromCamera>0?$.point:Fr(W,X,V,1,C,kt),Ct=Bi(I.writingMode,V,nt,wt);if(Ct)return Ct}let H=Y(p*L.getoffsetX(I.glyphStartIndex),w,k,c,D,W,I.segment,I.lineStartIndex,I.lineStartIndex+I.lineLength,R,y,st,yt,kt);if(!H)return{notEnoughRoom:!0};T=[H]}for(let H of T)n.ak(N,H.point,H.angle);return{}}function Fr(I,s,c,d,C,y){let F=Ki(I.add(I.sub(s)._unit()),C,y).point,L=c.sub(F);return c.add(L._mult(d/L.mag()))}function pi(I,s){let{projectionCache:c,lineVertexArray:d,labelPlaneMatrix:C,tileAnchorPoint:y,distanceFromAnchor:F,getElevation:L,previousVertex:R,direction:N,absOffsetX:D}=s;if(c.projections[I])return c.projections[I];let W=new n.P(d.getx(I),d.gety(I)),st=Ki(W,C,L);if(st.signedDistanceFromCamera>0)return c.projections[I]=st.point,st.point;let wt=I-N;return Fr(F===0?y:new n.P(d.getx(wt),d.gety(wt)),W,R,D-F+1,C,L)}function Pr(I,s,c){return I._unit()._perp()._mult(s*c)}function gt(I,s,c,d,C,y,F,L){let{projectionCache:R,direction:N}=L;if(R.offsets[I])return R.offsets[I];let D=c.add(s);if(I+N<d||I+N>=C)return R.offsets[I]=D,D;let W=pi(I+N,L),st=Pr(W.sub(c),F,N),wt=c.add(st),yt=W.add(st);return R.offsets[I]=n.al(y,D,wt,yt)||D,R.offsets[I]}function Y(I,s,c,d,C,y,F,L,R,N,D,W,st,wt){let yt=d?I-s:I+s,kt=yt>0?1:-1,p=0;d&&(kt*=-1,p=Math.PI),kt<0&&(p+=Math.PI);let w,k,T=kt>0?L+F:L+F+1,H=C,V=C,K=0,X=0,$=Math.abs(yt),nt=[],Ct;for(;K+X<=$;){if(T+=kt,T<L||T>=R)return null;K+=X,V=H,k=w;let Tt={projectionCache:W,lineVertexArray:N,labelPlaneMatrix:D,tileAnchorPoint:y,distanceFromAnchor:K,getElevation:wt,previousVertex:V,direction:kt,absOffsetX:$};if(H=pi(T,Tt),c===0)nt.push(V),Ct=H.sub(V);else{let pe,te=H.sub(V);pe=te.mag()===0?Pr(pi(T+kt,Tt).sub(H),c,kt):Pr(te,c,kt),k||(k=V.add(pe)),w=gt(T,pe,H,L,R,k,c,Tt),nt.push(k),Ct=w.sub(k)}X=Ct.mag()}let zt=Ct._mult(($-K)/X)._add(k||V),re=p+Math.atan2(H.y-V.y,H.x-V.x);return nt.push(zt),{point:zt,angle:st?re:0,path:nt}}let q=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function lt(I,s){for(let c=0;c<I;c++){let d=s.length;s.resize(d+4),s.float32.set(q,3*d)}}function _t(I,s,c){let d=s[0],C=s[1];return I[0]=c[0]*d+c[4]*C+c[12],I[1]=c[1]*d+c[5]*C+c[13],I[3]=c[3]*d+c[7]*C+c[15],I}let xt=100;class qt{constructor(s,c=new Ei(s.width+200,s.height+200,25),d=new Ei(s.width+200,s.height+200,25)){this.transform=s,this.grid=c,this.ignoredGrid=d,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+xt,this.screenBottomBoundary=s.height+xt,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,c,d,C,y,F){let L=this.projectAndGetPerspectiveRatio(C,s.anchorPointX,s.anchorPointY,F),R=d*L.perspectiveRatio,N=s.x1*R+L.point.x,D=s.y1*R+L.point.y,W=s.x2*R+L.point.x,st=s.y2*R+L.point.y;return!this.isInsideGrid(N,D,W,st)||c!=="always"&&this.grid.hitTest(N,D,W,st,c,y)||L.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[N,D,W,st],offscreen:this.isOffscreen(N,D,W,st)}}placeCollisionCircles(s,c,d,C,y,F,L,R,N,D,W,st,wt,yt){let kt=[],p=new n.P(c.anchorX,c.anchorY),w=Ki(p,F,yt),k=ji(this.transform.cameraToCenterDistance,w.signedDistanceFromCamera),T=(D?y/k:y*k)/n.ap,H=Ki(p,L,yt).point,V=gi(T,C,c.lineOffsetX*T,c.lineOffsetY*T,!1,H,p,c,d,L,{projections:{},offsets:{}},!1,yt),K=!1,X=!1,$=!0;if(V){let nt=.5*st*k+wt,Ct=new n.P(-100,-100),zt=new n.P(this.screenRightBoundary,this.screenBottomBoundary),re=new zi,Tt=V.first,pe=V.last,te=[];for(let Ie=Tt.path.length-1;Ie>=1;Ie--)te.push(Tt.path[Ie]);for(let Ie=1;Ie<pe.path.length;Ie++)te.push(pe.path[Ie]);let Ot=2.5*nt;if(R){let Ie=te.map(we=>Ki(we,R,yt));te=Ie.some(we=>we.signedDistanceFromCamera<=0)?[]:Ie.map(we=>we.point)}let Wt=[];if(te.length>0){let Ie=te[0].clone(),we=te[0].clone();for(let Le=1;Le<te.length;Le++)Ie.x=Math.min(Ie.x,te[Le].x),Ie.y=Math.min(Ie.y,te[Le].y),we.x=Math.max(we.x,te[Le].x),we.y=Math.max(we.y,te[Le].y);Wt=Ie.x>=Ct.x&&we.x<=zt.x&&Ie.y>=Ct.y&&we.y<=zt.y?[te]:we.x<Ct.x||Ie.x>zt.x||we.y<Ct.y||Ie.y>zt.y?[]:n.am([te],Ct.x,Ct.y,zt.x,zt.y)}for(let Ie of Wt){re.reset(Ie,.25*nt);let we=0;we=re.length<=.5*nt?1:Math.ceil(re.paddedLength/Ot)+1;for(let Le=0;Le<we;Le++){let je=Le/Math.max(we-1,1),$e=re.lerp(je),wi=$e.x+xt,qe=$e.y+xt;kt.push(wi,qe,nt,0);let ar=wi-nt,Vi=qe-nt,lr=wi+nt,rr=qe+nt;if($=$&&this.isOffscreen(ar,Vi,lr,rr),X=X||this.isInsideGrid(ar,Vi,lr,rr),s!=="always"&&this.grid.hitTestCircle(wi,qe,nt,s,W)&&(K=!0,!N))return{circles:[],offscreen:!1,collisionDetected:K}}}}return{circles:!N&&K||!X||k<this.perspectiveRatioCutoff?[]:kt,offscreen:$,collisionDetected:K}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let c=[],d=1/0,C=1/0,y=-1/0,F=-1/0;for(let D of s){let W=new n.P(D.x+xt,D.y+xt);d=Math.min(d,W.x),C=Math.min(C,W.y),y=Math.max(y,W.x),F=Math.max(F,W.y),c.push(W)}let L=this.grid.query(d,C,y,F).concat(this.ignoredGrid.query(d,C,y,F)),R={},N={};for(let D of L){let W=D.key;if(R[W.bucketInstanceId]===void 0&&(R[W.bucketInstanceId]={}),R[W.bucketInstanceId][W.featureIndex])continue;let st=[new n.P(D.x1,D.y1),new n.P(D.x2,D.y1),new n.P(D.x2,D.y2),new n.P(D.x1,D.y2)];n.an(c,st)&&(R[W.bucketInstanceId][W.featureIndex]=!0,N[W.bucketInstanceId]===void 0&&(N[W.bucketInstanceId]=[]),N[W.bucketInstanceId].push(W.featureIndex))}return N}insertCollisionBox(s,c,d,C,y,F){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:y,collisionGroupID:F,overlapMode:c},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,c,d,C,y,F){let L=d?this.ignoredGrid:this.grid,R={bucketInstanceId:C,featureIndex:y,collisionGroupID:F,overlapMode:c};for(let N=0;N<s.length;N+=4)L.insertCircle(R,s[N],s[N+1],s[N+2])}projectAndGetPerspectiveRatio(s,c,d,C){let y;return C?(y=[c,d,C(c,d),1],n.ag(y,y,s)):(y=[c,d,0,1],_t(y,y,s)),{point:new n.P((y[0]/y[3]+1)/2*this.transform.width+xt,(-y[1]/y[3]+1)/2*this.transform.height+xt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/y[3]*.5}}isOffscreen(s,c,d,C){return d<xt||s>=this.screenRightBoundary||C<xt||c>this.screenBottomBoundary}isInsideGrid(s,c,d,C){return d>=0&&s<this.gridRightBoundary&&C>=0&&c<this.gridBottomBoundary}getViewportMatrix(){let s=n.ao([]);return n.$(s,s,[-100,-100,0]),s}}function Jt(I,s,c){return s*(n.N/(I.tileSize*Math.pow(2,c-I.tileID.overscaledZ)))}class mt{constructor(s,c,d,C){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?c:-c))):C&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class jt{constructor(s,c,d,C,y){this.text=new mt(s?s.text:null,c,d,y),this.icon=new mt(s?s.icon:null,c,C,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _e{constructor(s,c,d){this.text=s,this.icon=c,this.skipFade=d}}class ve{constructor(){this.invProjMatrix=n.Z(),this.viewportMatrix=n.Z(),this.circles=[]}}class xe{constructor(s,c,d,C,y){this.bucketInstanceId=s,this.featureIndex=c,this.sourceLayerIndex=d,this.bucketIndex=C,this.tileID=y}}class si{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){let c=++this.maxGroupID;this.collisionGroups[s]={ID:c,predicate:d=>d.collisionGroupID===c}}return this.collisionGroups[s]}}function _i(I,s,c,d,C){let{horizontalAlign:y,verticalAlign:F}=n.au(I);return new n.P(-(y-.5)*s+d[0]*C,-(F-.5)*c+d[1]*C)}function ui(I,s,c,d,C,y){let{x1:F,x2:L,y1:R,y2:N,anchorPointX:D,anchorPointY:W}=I,st=new n.P(s,c);return d&&st._rotate(C?y:-y),{x1:F+st.x,y1:R+st.y,x2:L+st.x,y2:N+st.y,anchorPointX:D,anchorPointY:W}}class fi{constructor(s,c,d,C,y){this.transform=s.clone(),this.terrain=c,this.collisionIndex=new qt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new si(C),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,c,d,C){let y=d.getBucket(c),F=d.latestFeatureIndex;if(!y||!F||c.id!==y.layerIds[0])return;let L=d.collisionBoxArray,R=y.layers[0].layout,N=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),D=d.tileSize/n.N,W=this.transform.calculatePosMatrix(d.tileID.toUnwrapped()),st=R.get("text-pitch-alignment")==="map",wt=R.get("text-rotation-alignment")==="map",yt=Jt(d,1,this.transform.zoom),kt=Fe(W,st,wt,this.transform,yt),p=null;if(st){let k=Ye(W,st,wt,this.transform,yt);p=n.a1([],this.transform.labelPlaneMatrix,k)}this.retainedQueryData[y.bucketInstanceId]=new xe(y.bucketInstanceId,F,y.sourceLayerIndex,y.index,d.tileID);let w={bucket:y,layout:R,posMatrix:W,textLabelPlaneMatrix:kt,labelToScreenMatrix:p,scale:N,textPixelRatio:D,holdingForFade:d.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:n.ah(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(C)for(let k of y.sortKeyRanges){let{sortKey:T,symbolInstanceStart:H,symbolInstanceEnd:V}=k;s.push({sortKey:T,symbolInstanceStart:H,symbolInstanceEnd:V,parameters:w})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:w})}attemptAnchorPlacement(s,c,d,C,y,F,L,R,N,D,W,st,wt,yt,kt,p){let w=n.aq[s.textAnchor],k=[s.textOffset0,s.textOffset1],T=_i(w,d,C,k,y),H=this.collisionIndex.placeCollisionBox(ui(c,T.x,T.y,F,L,this.transform.angle),W,R,N,D.predicate,p);if((!kt||this.collisionIndex.placeCollisionBox(ui(kt,T.x,T.y,F,L,this.transform.angle),W,R,N,D.predicate,p).box.length!==0)&&H.box.length>0){let V;if(this.prevPlacement&&this.prevPlacement.variableOffsets[st.crossTileID]&&this.prevPlacement.placements[st.crossTileID]&&this.prevPlacement.placements[st.crossTileID].text&&(V=this.prevPlacement.variableOffsets[st.crossTileID].anchor),st.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[st.crossTileID]={textOffset:k,width:d,height:C,anchor:w,textBoxScale:y,prevAnchor:V},this.markUsedJustification(wt,w,st,yt),wt.allowVerticalPlacement&&(this.markUsedOrientation(wt,yt,st),this.placedOrientations[st.crossTileID]=yt),{shift:T,placedGlyphBoxes:H}}}placeLayerBucketPart(s,c,d){let{bucket:C,layout:y,posMatrix:F,textLabelPlaneMatrix:L,labelToScreenMatrix:R,textPixelRatio:N,holdingForFade:D,collisionBoxArray:W,partiallyEvaluatedTextSize:st,collisionGroup:wt}=s.parameters,yt=y.get("text-optional"),kt=y.get("icon-optional"),p=n.ar(y,"text-overlap","text-allow-overlap"),w=p==="always",k=n.ar(y,"icon-overlap","icon-allow-overlap"),T=k==="always",H=y.get("text-rotation-alignment")==="map",V=y.get("text-pitch-alignment")==="map",K=y.get("icon-text-fit")!=="none",X=y.get("symbol-z-order")==="viewport-y",$=w&&(T||!C.hasIconData()||kt),nt=T&&(w||!C.hasTextData()||yt);!C.collisionArrays&&W&&C.deserializeCollisionBoxes(W);let Ct=this.retainedQueryData[C.bucketInstanceId].tileID,zt=this.terrain?(Tt,pe)=>this.terrain.getElevation(Ct,Tt,pe):null,re=(Tt,pe)=>{var te,Ot;if(c[Tt.crossTileID])return;if(D)return void(this.placements[Tt.crossTileID]=new _e(!1,!1,!1));let Wt=!1,Ie=!1,we=!0,Le=null,je={box:null,offscreen:null},$e={box:null,offscreen:null},wi=null,qe=null,ar=null,Vi=0,lr=0,rr=0;pe.textFeatureIndex?Vi=pe.textFeatureIndex:Tt.useRuntimeCollisionCircles&&(Vi=Tt.featureIndex),pe.verticalTextFeatureIndex&&(lr=pe.verticalTextFeatureIndex);let Br=pe.textBox;if(Br){let wr=Yi=>{let Tr=n.ai.horizontal;if(C.allowVerticalPlacement&&!Yi&&this.prevPlacement){let jr=this.prevPlacement.placedOrientations[Tt.crossTileID];jr&&(this.placedOrientations[Tt.crossTileID]=jr,Tr=jr,this.markUsedOrientation(C,Tr,Tt))}return Tr},Zr=(Yi,Tr)=>{if(C.allowVerticalPlacement&&Tt.numVerticalGlyphVertices>0&&pe.verticalTextBox){for(let jr of C.writingModes)if(jr===n.ai.vertical?(je=Tr(),$e=je):je=Yi(),je&&je.box&&je.box.length)break}else je=Yi()},xr=Tt.textAnchorOffsetStartIndex,Bn=Tt.textAnchorOffsetEndIndex;if(Bn===xr){let Yi=(Tr,jr)=>{let dr=this.collisionIndex.placeCollisionBox(Tr,p,N,F,wt.predicate,zt);return dr&&dr.box&&dr.box.length&&(this.markUsedOrientation(C,jr,Tt),this.placedOrientations[Tt.crossTileID]=jr),dr};Zr(()=>Yi(Br,n.ai.horizontal),()=>{let Tr=pe.verticalTextBox;return C.allowVerticalPlacement&&Tt.numVerticalGlyphVertices>0&&Tr?Yi(Tr,n.ai.vertical):{box:null,offscreen:null}}),wr(je&&je.box&&je.box.length)}else{let Yi=n.aq[(Ot=(te=this.prevPlacement)===null||te===void 0?void 0:te.variableOffsets[Tt.crossTileID])===null||Ot===void 0?void 0:Ot.anchor],Tr=(dr,ln,Gn)=>{let Ps=dr.x2-dr.x1,mo=dr.y2-dr.y1,Rn=Tt.textBoxScale,Co=K&&k==="never"?ln:null,As={box:[],offscreen:!1},qs=p==="never"?1:2,Kn="never";Yi&&qs++;for(let Sr=0;Sr<qs;Sr++){for(let $s=xr;$s<Bn;$s++){let Hl=C.textAnchorOffsets.get($s);if(Yi&&Hl.textAnchor!==Yi)continue;let Do=this.attemptAnchorPlacement(Hl,dr,Ps,mo,Rn,H,V,N,F,wt,Kn,Tt,C,Gn,Co,zt);if(Do&&(As=Do.placedGlyphBoxes,As&&As.box&&As.box.length))return Wt=!0,Le=Do.shift,As}Yi?Yi=null:Kn=p}return As};Zr(()=>Tr(Br,pe.iconBox,n.ai.horizontal),()=>{let dr=pe.verticalTextBox;return C.allowVerticalPlacement&&!(je&&je.box&&je.box.length)&&Tt.numVerticalGlyphVertices>0&&dr?Tr(dr,pe.verticalIconBox,n.ai.vertical):{box:null,offscreen:null}}),je&&(Wt=je.box,we=je.offscreen);let jr=wr(je&&je.box);if(!Wt&&this.prevPlacement){let dr=this.prevPlacement.variableOffsets[Tt.crossTileID];dr&&(this.variableOffsets[Tt.crossTileID]=dr,this.markUsedJustification(C,dr.anchor,Tt,jr))}}}if(wi=je,Wt=wi&&wi.box&&wi.box.length>0,we=wi&&wi.offscreen,Tt.useRuntimeCollisionCircles){let wr=C.text.placedSymbolArray.get(Tt.centerJustifiedTextSymbolIndex),Zr=n.aj(C.textSizeData,st,wr),xr=y.get("text-padding");qe=this.collisionIndex.placeCollisionCircles(p,wr,C.lineVertexArray,C.glyphOffsetArray,Zr,F,L,R,d,V,wt.predicate,Tt.collisionCircleDiameter,xr,zt),qe.circles.length&&qe.collisionDetected&&!d&&n.w("Collisions detected, but collision boxes are not shown"),Wt=w||qe.circles.length>0&&!qe.collisionDetected,we=we&&qe.offscreen}if(pe.iconFeatureIndex&&(rr=pe.iconFeatureIndex),pe.iconBox){let wr=Zr=>{let xr=K&&Le?ui(Zr,Le.x,Le.y,H,V,this.transform.angle):Zr;return this.collisionIndex.placeCollisionBox(xr,k,N,F,wt.predicate,zt)};$e&&$e.box&&$e.box.length&&pe.verticalIconBox?(ar=wr(pe.verticalIconBox),Ie=ar.box.length>0):(ar=wr(pe.iconBox),Ie=ar.box.length>0),we=we&&ar.offscreen}let _r=yt||Tt.numHorizontalGlyphVertices===0&&Tt.numVerticalGlyphVertices===0,er=kt||Tt.numIconVertices===0;if(_r||er?er?_r||(Ie=Ie&&Wt):Wt=Ie&&Wt:Ie=Wt=Ie&&Wt,Wt&&wi&&wi.box&&this.collisionIndex.insertCollisionBox(wi.box,p,y.get("text-ignore-placement"),C.bucketInstanceId,$e&&$e.box&&lr?lr:Vi,wt.ID),Ie&&ar&&this.collisionIndex.insertCollisionBox(ar.box,k,y.get("icon-ignore-placement"),C.bucketInstanceId,rr,wt.ID),qe&&(Wt&&this.collisionIndex.insertCollisionCircles(qe.circles,p,y.get("text-ignore-placement"),C.bucketInstanceId,Vi,wt.ID),d)){let wr=C.bucketInstanceId,Zr=this.collisionCircleArrays[wr];Zr===void 0&&(Zr=this.collisionCircleArrays[wr]=new ve);for(let xr=0;xr<qe.circles.length;xr+=4)Zr.circles.push(qe.circles[xr+0]),Zr.circles.push(qe.circles[xr+1]),Zr.circles.push(qe.circles[xr+2]),Zr.circles.push(qe.collisionDetected?1:0)}if(Tt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(C.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Tt.crossTileID]=new _e(Wt||$,Ie||nt,we||C.justReloaded),c[Tt.crossTileID]=!0};if(X){if(s.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let Tt=C.getSortedSymbolIndexes(this.transform.angle);for(let pe=Tt.length-1;pe>=0;--pe){let te=Tt[pe];re(C.symbolInstances.get(te),C.collisionArrays[te])}}else for(let Tt=s.symbolInstanceStart;Tt<s.symbolInstanceEnd;Tt++)re(C.symbolInstances.get(Tt),C.collisionArrays[Tt]);if(d&&C.bucketInstanceId in this.collisionCircleArrays){let Tt=this.collisionCircleArrays[C.bucketInstanceId];n.as(Tt.invProjMatrix,F),Tt.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(s,c,d,C){let y;y=C===n.ai.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[n.at(c)];let F=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(let L of F)L>=0&&(s.text.placedSymbolArray.get(L).crossTileID=y>=0&&L!==y?0:d.crossTileID)}markUsedOrientation(s,c,d){let C=c===n.ai.horizontal||c===n.ai.horizontalOnly?c:0,y=c===n.ai.vertical?c:0,F=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(let L of F)s.text.placedSymbolArray.get(L).placedOrientation=C;d.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;let c=this.prevPlacement,d=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;let C=c?c.symbolFadeChange(s):1,y=c?c.opacities:{},F=c?c.variableOffsets:{},L=c?c.placedOrientations:{};for(let R in this.placements){let N=this.placements[R],D=y[R];D?(this.opacities[R]=new jt(D,C,N.text,N.icon),d=d||N.text!==D.text.placed||N.icon!==D.icon.placed):(this.opacities[R]=new jt(null,C,N.text,N.icon,N.skipFade),d=d||N.text||N.icon)}for(let R in y){let N=y[R];if(!this.opacities[R]){let D=new jt(N,C,!1,!1);D.isHidden()||(this.opacities[R]=D,d=d||N.text.placed||N.icon.placed)}}for(let R in F)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=F[R]);for(let R in L)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=L[R]);if(c&&c.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:s)}updateLayerOpacities(s,c){let d={};for(let C of c){let y=C.getBucket(s);y&&C.latestFeatureIndex&&s.id===y.layerIds[0]&&this.updateBucketOpacities(y,d,C.collisionBoxArray)}}updateBucketOpacities(s,c,d){s.hasTextData()&&(s.text.opacityVertexArray.clear(),s.text.hasVisibleVertices=!1),s.hasIconData()&&(s.icon.opacityVertexArray.clear(),s.icon.hasVisibleVertices=!1),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();let C=s.layers[0],y=C.layout,F=new jt(null,0,!1,!1,!0),L=y.get("text-allow-overlap"),R=y.get("icon-allow-overlap"),N=C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"),D=y.get("text-rotation-alignment")==="map",W=y.get("text-pitch-alignment")==="map",st=y.get("icon-text-fit")!=="none",wt=new jt(null,0,L&&(R||!s.hasIconData()||y.get("icon-optional")),R&&(L||!s.hasTextData()||y.get("text-optional")),!0);!s.collisionArrays&&d&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(d);let yt=(kt,p,w)=>{for(let k=0;k<p/4;k++)kt.opacityVertexArray.emplaceBack(w);kt.hasVisibleVertices=kt.hasVisibleVertices||w!==Wi};for(let kt=0;kt<s.symbolInstances.length;kt++){let p=s.symbolInstances.get(kt),{numHorizontalGlyphVertices:w,numVerticalGlyphVertices:k,crossTileID:T}=p,H=this.opacities[T];c[T]?H=F:H||(H=wt,this.opacities[T]=H),c[T]=!0;let V=p.numIconVertices>0,K=this.placedOrientations[p.crossTileID],X=K===n.ai.vertical,$=K===n.ai.horizontal||K===n.ai.horizontalOnly;if(w>0||k>0){let nt=Ne(H.text);yt(s.text,w,X?Wi:nt),yt(s.text,k,$?Wi:nt);let Ct=H.text.isHidden();[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach(Tt=>{Tt>=0&&(s.text.placedSymbolArray.get(Tt).hidden=Ct||X?1:0)}),p.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).hidden=Ct||$?1:0);let zt=this.variableOffsets[p.crossTileID];zt&&this.markUsedJustification(s,zt.anchor,p,K);let re=this.placedOrientations[p.crossTileID];re&&(this.markUsedJustification(s,"left",p,re),this.markUsedOrientation(s,re,p))}if(V){let nt=Ne(H.icon),Ct=!(st&&p.verticalPlacedIconSymbolIndex&&X);p.placedIconSymbolIndex>=0&&(yt(s.icon,p.numIconVertices,Ct?nt:Wi),s.icon.placedSymbolArray.get(p.placedIconSymbolIndex).hidden=H.icon.isHidden()),p.verticalPlacedIconSymbolIndex>=0&&(yt(s.icon,p.numVerticalIconVertices,Ct?Wi:nt),s.icon.placedSymbolArray.get(p.verticalPlacedIconSymbolIndex).hidden=H.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){let nt=s.collisionArrays[kt];if(nt){let Ct=new n.P(0,0);if(nt.textBox||nt.verticalTextBox){let re=!0;if(N){let Tt=this.variableOffsets[T];Tt?(Ct=_i(Tt.anchor,Tt.width,Tt.height,Tt.textOffset,Tt.textBoxScale),D&&Ct._rotate(W?this.transform.angle:-this.transform.angle)):re=!1}nt.textBox&&bi(s.textCollisionBox.collisionVertexArray,H.text.placed,!re||X,Ct.x,Ct.y),nt.verticalTextBox&&bi(s.textCollisionBox.collisionVertexArray,H.text.placed,!re||$,Ct.x,Ct.y)}let zt=Boolean(!$&&nt.verticalIconBox);nt.iconBox&&bi(s.iconCollisionBox.collisionVertexArray,H.icon.placed,zt,st?Ct.x:0,st?Ct.y:0),nt.verticalIconBox&&bi(s.iconCollisionBox.collisionVertexArray,H.icon.placed,!zt,st?Ct.x:0,st?Ct.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);if(s.bucketInstanceId in this.collisionCircleArrays){let kt=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=kt.invProjMatrix,s.placementViewportMatrix=kt.viewportMatrix,s.collisionCircleArray=kt.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,c){let d=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*d>s}setStale(){this.stale=!0}}function bi(I,s,c,d,C){I.emplaceBack(s?1:0,c?1:0,d||0,C||0),I.emplaceBack(s?1:0,c?1:0,d||0,C||0),I.emplaceBack(s?1:0,c?1:0,d||0,C||0),I.emplaceBack(s?1:0,c?1:0,d||0,C||0)}let $i=Math.pow(2,25),or=Math.pow(2,24),Ji=Math.pow(2,17),Mi=Math.pow(2,16),kr=Math.pow(2,9),Nt=Math.pow(2,8),ze=Math.pow(2,1);function Ne(I){if(I.opacity===0&&!I.placed)return 0;if(I.opacity===1&&I.placed)return 4294967295;let s=I.placed?1:0,c=Math.floor(127*I.opacity);return c*$i+s*or+c*Ji+s*Mi+c*kr+s*Nt+c*ze+s}let Wi=0;class Lr{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,c,d,C,y){let F=this._bucketParts;for(;this._currentTileIndex<s.length;)if(c.getBucketParts(F,C,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((L,R)=>L.sortKey-R.sortKey));this._currentPartIndex<F.length;)if(c.placeLayerBucketPart(F[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,y())return!0;return!1}}class $r{constructor(s,c,d,C,y,F,L,R){this.placement=new fi(s,c,F,L,R),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(s,c,d){let C=n.h.now(),y=()=>!this._forceFullPlacement&&n.h.now()-C>2;for(;this._currentPlacementIndex>=0;){let F=c[s[this._currentPlacementIndex]],L=this.placement.collisionIndex.transform.zoom;if(F.type==="symbol"&&(!F.minzoom||F.minzoom<=L)&&(!F.maxzoom||F.maxzoom>L)){if(this._inProgressLayer||(this._inProgressLayer=new Lr(F)),this._inProgressLayer.continuePlacement(d[F.source],this.placement,this._showCollisionBoxes,F,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}let Qr=512/n.N/2;class uo{constructor(s,c,d){this.tileID=s,this.bucketInstanceId=d,this._symbolsByKey={};let C=new Map;for(let y=0;y<c.length;y++){let F=c.get(y),L=F.key,R=C.get(L);R?R.push(F):C.set(L,[F])}for(let[y,F]of C){let L={positions:F.map(R=>({x:Math.floor(R.anchorX*Qr),y:Math.floor(R.anchorY*Qr)})),crossTileIDs:F.map(R=>R.crossTileID)};if(L.positions.length>128){let R=new n.av(L.positions.length,16,Uint16Array);for(let{x:N,y:D}of L.positions)R.add(N,D);R.finish(),delete L.positions,L.index=R}this._symbolsByKey[y]=L}}getScaledCoordinates(s,c){let{x:d,y:C,z:y}=this.tileID.canonical,{x:F,y:L,z:R}=c.canonical,N=Qr/Math.pow(2,R-y),D=(L*n.N+s.anchorY)*N,W=C*n.N*Qr;return{x:Math.floor((F*n.N+s.anchorX)*N-d*n.N*Qr),y:Math.floor(D-W)}}findMatches(s,c,d){let C=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let y=0;y<s.length;y++){let F=s.get(y);if(F.crossTileID)continue;let L=this._symbolsByKey[F.key];if(!L)continue;let R=this.getScaledCoordinates(F,c);if(L.index){let N=L.index.range(R.x-C,R.y-C,R.x+C,R.y+C).sort();for(let D of N){let W=L.crossTileIDs[D];if(!d[W]){d[W]=!0,F.crossTileID=W;break}}}else if(L.positions)for(let N=0;N<L.positions.length;N++){let D=L.positions[N],W=L.crossTileIDs[N];if(Math.abs(D.x-R.x)<=C&&Math.abs(D.y-R.y)<=C&&!d[W]){d[W]=!0,F.crossTileID=W;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:s})=>s)}}class qi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class An{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){let c=Math.round((s-this.lng)/360);if(c!==0)for(let d in this.indexes){let C=this.indexes[d],y={};for(let F in C){let L=C[F];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+c),y[L.tileID.key]=L}this.indexes[d]=y}this.lng=s}addBucket(s,c,d){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let y=0;y<c.symbolInstances.length;y++)c.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});let C=this.usedCrossTileIDs[s.overscaledZ];for(let y in this.indexes){let F=this.indexes[y];if(Number(y)>s.overscaledZ)for(let L in F){let R=F[L];R.tileID.isChildOf(s)&&R.findMatches(c.symbolInstances,s,C)}else{let L=F[s.scaledTo(Number(y)).key];L&&L.findMatches(c.symbolInstances,s,C)}}for(let y=0;y<c.symbolInstances.length;y++){let F=c.symbolInstances.get(y);F.crossTileID||(F.crossTileID=d.generate(),C[F.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new uo(s,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(s,c){for(let d of c.getCrossTileIDsLists())for(let C of d)delete this.usedCrossTileIDs[s][C]}removeStaleBuckets(s){let c=!1;for(let d in this.indexes){let C=this.indexes[d];for(let y in C)s[C[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,C[y]),delete C[y],c=!0)}return c}}class ho{constructor(){this.layerIndexes={},this.crossTileIDs=new qi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,c,d){let C=this.layerIndexes[s.id];C===void 0&&(C=this.layerIndexes[s.id]=new An);let y=!1,F={};C.handleWrapJump(d);for(let L of c){let R=L.getBucket(s);R&&s.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(L.tileID,R,this.crossTileIDs)&&(y=!0),F[R.bucketInstanceId]=!0)}return C.removeStaleBuckets(F)&&(y=!0),y}pruneUnusedLayers(s){let c={};s.forEach(d=>{c[d]=!0});for(let d in this.layerIndexes)c[d]||delete this.layerIndexes[d]}}let dn=(I,s)=>n.x(I,s&&s.filter(c=>c.identifier!=="source.canvas")),Mn=n.F(n.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Ca=n.F(n.ax,["setCenter","setZoom","setBearing","setPitch"]),Ln=n.aw();class zr extends n.E{constructor(s,c={}){super(),this.map=s,this.dispatcher=new Lt(Pi(),this,s._getMapId()),this.imageManager=new oe,this.imageManager.setEventedParent(this),this.glyphManager=new St(s._requestManager,c.localIdeographFontFamily),this.lineAtlas=new se(256,512),this.crossTileSymbolIndex=new ho,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new n.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",n.az());let d=this;this._rtlTextPluginCallback=zr.registerForPluginStateChange(C=>{d.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},(y,F)=>{if(n.aA(y),F&&F.every(L=>L))for(let L in d.sourceCaches){let R=d.sourceCaches[L].getSource().type;R!=="vector"&&R!=="geojson"||d.sourceCaches[L].reload()}})}),this.on("data",C=>{if(C.dataType!=="source"||C.sourceDataType!=="metadata")return;let y=this.sourceCaches[C.sourceId];if(!y)return;let F=y.getSource();if(F&&F.vectorLayerIds)for(let L in this._layers){let R=this._layers[L];R.source===F.id&&this._validateLayer(R)}})}loadURL(s,c={},d){this.fire(new n.k("dataloading",{dataType:"style"})),c.validate=typeof c.validate!="boolean"||c.validate;let C=this.map._requestManager.transformRequest(s,P.Style);this._request=n.f(C,(y,F)=>{this._request=null,y?this.fire(new n.j(y)):F&&this._load(F,c,d)})}loadJSON(s,c={},d){this.fire(new n.k("dataloading",{dataType:"style"})),this._request=n.h.frame(()=>{this._request=null,c.validate=c.validate!==!1,this._load(s,c,d)})}loadEmpty(){this.fire(new n.k("dataloading",{dataType:"style"})),this._load(Ln,{validate:!1})}_load(s,c,d){var C;let y=c.transformStyle?c.transformStyle(d,s):s;if(!c.validate||!dn(this,n.y(y))){this._loaded=!0,this.stylesheet=y;for(let F in y.sources)this.addSource(F,y.sources[F],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new ae(this.stylesheet.light),this.map.setTerrain((C=this.stylesheet.terrain)!==null&&C!==void 0?C:null),this.fire(new n.k("data",{dataType:"style"})),this.fire(new n.k("style.load"))}}_createLayers(){let s=n.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",s),this._order=s.map(c=>c.id),this._layers={},this._serializedLayers=null;for(let c of s){let d=n.aC(c);d.setEventedParent(this,{layer:{id:c.id}}),this._layers[c.id]=d}}_loadSprite(s,c=!1,d=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(C,y,F,L){let R=Qt(C),N=R.length,D=F>1?"@2x":"",W={},st={},wt={};for(let{id:yt,url:kt}of R){let p=y.transformRequest(y.normalizeSpriteURL(kt,D,".json"),P.SpriteJSON),w=`${yt}_${p.url}`;W[w]=n.f(p,(H,V)=>{delete W[w],st[yt]=V,Ut(L,st,wt,H,N)});let k=y.transformRequest(y.normalizeSpriteURL(kt,D,".png"),P.SpriteImage),T=`${yt}_${k.url}`;W[T]=O.getImage(k,(H,V)=>{delete W[T],wt[yt]=V,Ut(L,st,wt,H,N)})}return{cancel(){for(let yt of Object.values(W))yt.cancel()}}}(s,this.map._requestManager,this.map.getPixelRatio(),(C,y)=>{if(this._spriteRequest=null,C)this.fire(new n.j(C));else if(y)for(let F in y){this._spritesImagesIds[F]=[];let L=this._spritesImagesIds[F]?this._spritesImagesIds[F].filter(R=>!(R in y)):[];for(let R of L)this.imageManager.removeImage(R),this._changedImages[R]=!0;for(let R in y[F]){let N=F==="default"?R:`${F}:${R}`;this._spritesImagesIds[F].push(N),N in this.imageManager.images?this.imageManager.updateImage(N,y[F][R],!1):this.imageManager.addImage(N,y[F][R]),c&&(this._changedImages[N]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),c&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"})),d&&d(C)})}_unloadSprite(){for(let s of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(s),this._changedImages[s]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"}))}_validateLayer(s){let c=this.sourceCaches[s.source];if(!c)return;let d=s.sourceLayer;if(!d)return;let C=c.getSource();(C.type==="geojson"||C.vectorLayerIds&&C.vectorLayerIds.indexOf(d)===-1)&&this.fire(new n.j(new Error(`Source layer "${d}" does not exist on source "${C.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(s){let c=this._serializedAllLayers();if(!s||s.length===0)return Object.values(c);let d=[];for(let C of s)c[C]&&d.push(c[C]);return d}_serializedAllLayers(){let s=this._serializedLayers;if(s)return s;s=this._serializedLayers={};let c=Object.keys(this._layers);for(let d of c){let C=this._layers[d];C.type!=="custom"&&(s[d]=C.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let s in this.sourceCaches)if(this.sourceCaches[s].hasTransition())return!0;for(let s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;let c=this._changed;if(this._changed){let C=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(C.length||y.length)&&this._updateWorkerLayers(C,y);for(let F in this._updatedSources){let L=this._updatedSources[F];if(L==="reload")this._reloadSource(F);else{if(L!=="clear")throw new Error(`Invalid action ${L}`);this._clearSource(F)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let F in this._updatedPaintProps)this._layers[F].updateTransitions(s);this.light.updateTransitions(s),this._resetUpdates()}let d={};for(let C in this.sourceCaches){let y=this.sourceCaches[C];d[C]=y.used,y.used=!1}for(let C of this._order){let y=this._layers[C];y.recalculate(s,this._availableImages),!y.isHidden(s.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(let C in d){let y=this.sourceCaches[C];d[C]!==y.used&&y.fire(new n.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:C}))}this.light.recalculate(s),this.z=s.zoom,c&&this.fire(new n.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){let s=Object.keys(this._changedImages);if(s.length){for(let c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(s,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(s),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(s,c={}){this._checkLoaded();let d=this.serialize();if(s=c.transformStyle?c.transformStyle(d,s):s,dn(this,n.y(s)))return!1;(s=n.aD(s)).layers=n.aB(s.layers);let C=n.aE(d,s).filter(F=>!(F.command in Ca));if(C.length===0)return!1;let y=C.filter(F=>!(F.command in Mn));if(y.length>0)throw new Error(`Unimplemented: ${y.map(F=>F.command).join(", ")}.`);for(let F of C)F.command!=="setTransition"&&this[F.command].apply(this,F.args);return this.stylesheet=s,this._serializedLayers=null,!0}addImage(s,c){if(this.getImage(s))return this.fire(new n.j(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,c),this._afterImageUpdated(s)}updateImage(s,c){this.imageManager.updateImage(s,c)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new n.j(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,c,d={}){if(this._checkLoaded(),this.sourceCaches[s]!==void 0)throw new Error(`Source "${s}" already exists.`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(n.y.source,`sources.${s}`,c,null,d))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);let C=this.sourceCaches[s]=new Ze(s,c,this.dispatcher);C.style=this,C.setEventedParent(this,()=>({isSourceLoaded:C.loaded(),source:C.serialize(),sourceId:s})),C.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error("There is no source with this ID");for(let d in this._layers)if(this._layers[d].source===s)return this.fire(new n.j(new Error(`Source "${s}" cannot be removed while layer "${d}" is using it.`)));let c=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],c.fire(new n.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),c.setEventedParent(null),c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,c){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error(`There is no source with this ID=${s}`);let d=this.sourceCaches[s].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(c),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,c,d={}){this._checkLoaded();let C=s.id;if(this.getLayer(C))return void this.fire(new n.j(new Error(`Layer "${C}" already exists on this map.`)));let y;if(s.type==="custom"){if(dn(this,n.aF(s)))return;y=n.aC(s)}else{if("source"in s&&typeof s.source=="object"&&(this.addSource(C,s.source),s=n.aD(s),s=n.e(s,{source:C})),this._validate(n.y.layer,`layers.${C}`,s,{arrayIndex:-1},d))return;y=n.aC(s),this._validateLayer(y),y.setEventedParent(this,{layer:{id:C}})}let F=c?this._order.indexOf(c):this._order.length;if(c&&F===-1)this.fire(new n.j(new Error(`Cannot add layer "${C}" before non-existing layer "${c}".`)));else{if(this._order.splice(F,0,C),this._layerOrderChanged=!0,this._layers[C]=y,this._removedLayers[C]&&y.source&&y.type!=="custom"){let L=this._removedLayers[C];delete this._removedLayers[C],L.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(s,c){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new n.j(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===c)return;let d=this._order.indexOf(s);this._order.splice(d,1);let C=c?this._order.indexOf(c):this._order.length;c&&C===-1?this.fire(new n.j(new Error(`Cannot move layer "${s}" before non-existing layer "${c}".`))):(this._order.splice(C,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();let c=this._layers[s];if(!c)return void this.fire(new n.j(new Error(`Cannot remove non-existing layer "${s}".`)));c.setEventedParent(null);let d=this._order.indexOf(s);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=c,delete this._layers[s],this._serializedLayers&&delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],c.onRemove&&c.onRemove(this.map)}getLayer(s){return this._layers[s]}getLayersOrder(){return[...this._order]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,c,d){this._checkLoaded();let C=this.getLayer(s);C?C.minzoom===c&&C.maxzoom===d||(c!=null&&(C.minzoom=c),d!=null&&(C.maxzoom=d),this._updateLayer(C)):this.fire(new n.j(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,c,d={}){this._checkLoaded();let C=this.getLayer(s);if(C){if(!n.aG(C.filter,c))return c==null?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(n.y.filter,`layers.${C.id}.filter`,c,null,d)||(C.filter=n.aD(c),this._updateLayer(C)))}else this.fire(new n.j(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return n.aD(this.getLayer(s).filter)}setLayoutProperty(s,c,d,C={}){this._checkLoaded();let y=this.getLayer(s);y?n.aG(y.getLayoutProperty(c),d)||(y.setLayoutProperty(c,d,C),this._updateLayer(y)):this.fire(new n.j(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,c){let d=this.getLayer(s);if(d)return d.getLayoutProperty(c);this.fire(new n.j(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,c,d,C={}){this._checkLoaded();let y=this.getLayer(s);y?n.aG(y.getPaintProperty(c),d)||(y.setPaintProperty(c,d,C)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new n.j(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,c){return this.getLayer(s).getPaintProperty(c)}setFeatureState(s,c){this._checkLoaded();let d=s.source,C=s.sourceLayer,y=this.sourceCaches[d];if(y===void 0)return void this.fire(new n.j(new Error(`The source '${d}' does not exist in the map's style.`)));let F=y.getSource().type;F==="geojson"&&C?this.fire(new n.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):F!=="vector"||C?(s.id===void 0&&this.fire(new n.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(C,s.id,c)):this.fire(new n.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,c){this._checkLoaded();let d=s.source,C=this.sourceCaches[d];if(C===void 0)return void this.fire(new n.j(new Error(`The source '${d}' does not exist in the map's style.`)));let y=C.getSource().type,F=y==="vector"?s.sourceLayer:void 0;y!=="vector"||F?c&&typeof s.id!="string"&&typeof s.id!="number"?this.fire(new n.j(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(F,s.id,c):this.fire(new n.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();let c=s.source,d=s.sourceLayer,C=this.sourceCaches[c];if(C!==void 0)return C.getSource().type!=="vector"||d?(s.id===void 0&&this.fire(new n.j(new Error("The feature id parameter must be provided."))),C.getFeatureState(d,s.id)):void this.fire(new n.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new n.j(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return n.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let s=n.aH(this.sourceCaches,y=>y.serialize()),c=this._serializeByIds(this._order),d=this.map.getTerrain()||void 0,C=this.stylesheet;return n.aI({version:C.version,name:C.name,metadata:C.metadata,light:C.light,center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch,sprite:C.sprite,glyphs:C.glyphs,transition:C.transition,sources:s,layers:c,terrain:d},y=>y!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&this.sourceCaches[s.source].getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(s){let c=F=>this._layers[F].type==="fill-extrusion",d={},C=[];for(let F=this._order.length-1;F>=0;F--){let L=this._order[F];if(c(L)){d[L]=F;for(let R of s){let N=R[L];if(N)for(let D of N)C.push(D)}}}C.sort((F,L)=>L.intersectionZ-F.intersectionZ);let y=[];for(let F=this._order.length-1;F>=0;F--){let L=this._order[F];if(c(L))for(let R=C.length-1;R>=0;R--){let N=C[R].feature;if(d[N.layer.id]<F)break;y.push(N),C.pop()}else for(let R of s){let N=R[L];if(N)for(let D of N)y.push(D.feature)}}return y}queryRenderedFeatures(s,c,d){c&&c.filter&&this._validate(n.y.filter,"queryRenderedFeatures.filter",c.filter,null,c);let C={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new n.j(new Error("parameters.layers must be an Array."))),[];for(let L of c.layers){let R=this._layers[L];if(!R)return this.fire(new n.j(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];C[R.source]=!0}}let y=[];c.availableImages=this._availableImages;let F=this._serializedAllLayers();for(let L in this.sourceCaches)c.layers&&!C[L]||y.push(Ii(this.sourceCaches[L],this._layers,F,s,c,d));return this.placement&&y.push(function(L,R,N,D,W,st,wt){let yt={},kt=st.queryRenderedSymbols(D),p=[];for(let w of Object.keys(kt).map(Number))p.push(wt[w]);p.sort(Be);for(let w of p){let k=w.featureIndex.lookupSymbolFeatures(kt[w.bucketInstanceId],R,w.bucketIndex,w.sourceLayerIndex,W.filter,W.layers,W.availableImages,L);for(let T in k){let H=yt[T]=yt[T]||[],V=k[T];V.sort((K,X)=>{let $=w.featureSortOrder;if($){let nt=$.indexOf(K.featureIndex);return $.indexOf(X.featureIndex)-nt}return X.featureIndex-K.featureIndex});for(let K of V)H.push(K)}}for(let w in yt)yt[w].forEach(k=>{let T=k.feature,H=N[L[w].source].getFeatureState(T.layer["source-layer"],T.id);T.source=T.layer.source,T.layer["source-layer"]&&(T.sourceLayer=T.layer["source-layer"]),T.state=H});return yt}(this._layers,F,this.sourceCaches,s,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(s,c){c&&c.filter&&this._validate(n.y.filter,"querySourceFeatures.filter",c.filter,null,c);let d=this.sourceCaches[s];return d?function(C,y){let F=C.getRenderableIds().map(N=>C.getTileByID(N)),L=[],R={};for(let N=0;N<F.length;N++){let D=F[N],W=D.tileID.canonical.key;R[W]||(R[W]=!0,D.querySourceFeatures(L,y))}return L}(d,c):[]}addSourceType(s,c,d){return ei(s)?d(new Error(`A source type called "${s}" already exists.`)):(((C,y)=>{De[C]=y})(s,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:c.workerSourceURL},d):d(null,null))}getLight(){return this.light.getLight()}setLight(s,c={}){this._checkLoaded();let d=this.light.getLight(),C=!1;for(let F in s)if(!n.aG(s[F],d[F])){C=!0;break}if(!C)return;let y={now:n.h.now(),transition:n.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,c),this.light.updateTransitions(y)}_validate(s,c,d,C,y={}){return(!y||y.validate!==!1)&&dn(this,s.call(n.y,n.e({key:c,style:this.serialize(),value:d,styleSpec:n.v},C)))}_remove(s=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),n.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(let c in this._layers)this._layers[c].setEventedParent(null);for(let c in this.sourceCaches){let d=this.sourceCaches[c];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(s)}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(let c in this.sourceCaches)this.sourceCaches[c].update(s,this.map.terrain)}_generateCollisionBoxes(){for(let s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,c,d,C,y=!1){let F=!1,L=!1,R={};for(let N of this._order){let D=this._layers[N];if(D.type!=="symbol")continue;if(!R[D.source]){let st=this.sourceCaches[D.source];R[D.source]=st.getRenderableIds(!0).map(wt=>st.getTileByID(wt)).sort((wt,yt)=>yt.tileID.overscaledZ-wt.tileID.overscaledZ||(wt.tileID.isLessThan(yt.tileID)?-1:1))}let W=this.crossTileSymbolIndex.addLayer(D,R[D.source],s.center.lng);F=F||W}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(n.h.now(),s.zoom))&&(this.pauseablePlacement=new $r(s,this.map.terrain,this._order,y,c,d,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(n.h.now()),L=!0),F&&this.pauseablePlacement.placement.setStale()),L||F)for(let N of this._order){let D=this._layers[N];D.type==="symbol"&&this.placement.updateLayerOpacities(D,R[D.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(n.h.now())}_releaseSymbolFadeTiles(){for(let s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,c,d){this.imageManager.getImages(c.icons,d),this._updateTilesForChangedImages();let C=this.sourceCaches[c.source];C&&C.setDependencies(c.tileID.key,c.type,c.icons)}getGlyphs(s,c,d){this.glyphManager.getGlyphs(c.stacks,d);let C=this.sourceCaches[c.source];C&&C.setDependencies(c.tileID.key,c.type,[""])}getResource(s,c,d){return n.m(c,d)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(s,c={}){this._checkLoaded(),s&&this._validate(n.y.glyphs,"glyphs",s,null,c)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=s,this.glyphManager.entries={},this.glyphManager.setURL(s))}addSprite(s,c,d={},C){this._checkLoaded();let y=[{id:s,url:c}],F=[...Qt(this.stylesheet.sprite),...y];this._validate(n.y.sprite,"sprite",F,null,d)||(this.stylesheet.sprite=F,this._loadSprite(y,!0,C))}removeSprite(s){this._checkLoaded();let c=Qt(this.stylesheet.sprite);if(c.find(d=>d.id===s)){if(this._spritesImagesIds[s])for(let d of this._spritesImagesIds[s])this.imageManager.removeImage(d),this._changedImages[d]=!0;c.splice(c.findIndex(d=>d.id===s),1),this.stylesheet.sprite=c.length>0?c:void 0,delete this._spritesImagesIds[s],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"}))}else this.fire(new n.j(new Error(`Sprite "${s}" doesn't exists on this map.`)))}getSprite(){return Qt(this.stylesheet.sprite)}setSprite(s,c={},d){this._checkLoaded(),s&&this._validate(n.y.sprite,"sprite",s,null,c)||(this.stylesheet.sprite=s,s?this._loadSprite(s,!0,d):(this._unloadSprite(),d&&d(null)))}}zr.registerForPluginStateChange=n.aK;var Ia=n.Q([{name:"a_pos",type:"Int16",components:2}]),Ur="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";let Hr={prelude:pr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:pr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:pr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:pr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:pr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:pr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:pr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:pr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:pr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:pr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:pr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:pr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:pr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:pr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:pr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:pr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:pr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:pr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:pr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:pr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:pr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:pr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:pr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:pr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:pr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:pr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:pr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Ur),terrainDepth:pr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Ur),terrainCoords:pr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Ur)};function pr(I,s){let c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=s.match(/attribute ([\w]+) ([\w]+)/g),C=I.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),F=y?y.concat(C):C,L={};return{fragmentSource:I=I.replace(c,(R,N,D,W,st)=>(L[st]=!0,N==="define"?`
#ifndef HAS_UNIFORM_u_${st}
varying ${D} ${W} ${st};
#else
uniform ${D} ${W} u_${st};
#endif
`:`
#ifdef HAS_UNIFORM_u_${st}
    ${D} ${W} ${st} = u_${st};
#endif
`)),vertexSource:s=s.replace(c,(R,N,D,W,st)=>{let wt=W==="float"?"vec2":"vec4",yt=st.match(/color/)?"color":wt;return L[st]?N==="define"?`
#ifndef HAS_UNIFORM_u_${st}
uniform lowp float u_${st}_t;
attribute ${D} ${wt} a_${st};
varying ${D} ${W} ${st};
#else
uniform ${D} ${W} u_${st};
#endif
`:yt==="vec4"?`
#ifndef HAS_UNIFORM_u_${st}
    ${st} = a_${st};
#else
    ${D} ${W} ${st} = u_${st};
#endif
`:`
#ifndef HAS_UNIFORM_u_${st}
    ${st} = unpack_mix_${yt}(a_${st}, u_${st}_t);
#else
    ${D} ${W} ${st} = u_${st};
#endif
`:N==="define"?`
#ifndef HAS_UNIFORM_u_${st}
uniform lowp float u_${st}_t;
attribute ${D} ${wt} a_${st};
#else
uniform ${D} ${W} u_${st};
#endif
`:yt==="vec4"?`
#ifndef HAS_UNIFORM_u_${st}
    ${D} ${W} ${st} = a_${st};
#else
    ${D} ${W} ${st} = u_${st};
#endif
`:`
#ifndef HAS_UNIFORM_u_${st}
    ${D} ${W} ${st} = unpack_mix_${yt}(a_${st}, u_${st}_t);
#else
    ${D} ${W} ${st} = u_${st};
#endif
`}),staticAttributes:d,staticUniforms:F}}class Js{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,c,d,C,y,F,L,R,N){this.context=s;let D=this.boundPaintVertexBuffers.length!==C.length;for(let W=0;!D&&W<C.length;W++)this.boundPaintVertexBuffers[W]!==C[W]&&(D=!0);!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==d||D||this.boundIndexBuffer!==y||this.boundVertexOffset!==F||this.boundDynamicVertexBuffer!==L||this.boundDynamicVertexBuffer2!==R||this.boundDynamicVertexBuffer3!==N?this.freshBind(c,d,C,y,F,L,R,N):(s.bindVertexArray.set(this.vao),L&&L.bind(),y&&y.dynamicDraw&&y.bind(),R&&R.bind(),N&&N.bind())}freshBind(s,c,d,C,y,F,L,R){let N=s.numAttributes,D=this.context,W=D.gl;this.vao&&this.destroy(),this.vao=D.createVertexArray(),D.bindVertexArray.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=C,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=F,this.boundDynamicVertexBuffer2=L,this.boundDynamicVertexBuffer3=R,c.enableAttributes(W,s);for(let st of d)st.enableAttributes(W,s);F&&F.enableAttributes(W,s),L&&L.enableAttributes(W,s),R&&R.enableAttributes(W,s),c.bind(),c.setVertexAttribPointers(W,s,y);for(let st of d)st.bind(),st.setVertexAttribPointers(W,s,y);F&&(F.bind(),F.setVertexAttribPointers(W,s,y)),C&&C.bind(),L&&(L.bind(),L.setVertexAttribPointers(W,s,y)),R&&(R.bind(),R.setVertexAttribPointers(W,s,y)),D.currentNumAttributes=N}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Gr(I){let s=[];for(let c=0;c<I.length;c++){if(I[c]===null)continue;let d=I[c].split(" ");s.push(d.pop())}return s}class pt{constructor(s,c,d,C,y,F){let L=s.gl;this.program=L.createProgram();let R=Gr(c.staticAttributes),N=d?d.getBinderAttributes():[],D=R.concat(N),W=Hr.prelude.staticUniforms?Gr(Hr.prelude.staticUniforms):[],st=c.staticUniforms?Gr(c.staticUniforms):[],wt=d?d.getBinderUniforms():[],yt=W.concat(st).concat(wt),kt=[];for(let K of yt)kt.indexOf(K)<0&&kt.push(K);let p=d?d.defines():[];y&&p.push("#define OVERDRAW_INSPECTOR;"),F&&p.push("#define TERRAIN3D;");let w=p.concat(Hr.prelude.fragmentSource,c.fragmentSource).join(`
`),k=p.concat(Hr.prelude.vertexSource,c.vertexSource).join(`
`),T=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);if(L.shaderSource(T,w),L.compileShader(T),!L.getShaderParameter(T,L.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${L.getShaderInfoLog(T)}`);L.attachShader(this.program,T);let H=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);if(L.shaderSource(H,k),L.compileShader(H),!L.getShaderParameter(H,L.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${L.getShaderInfoLog(H)}`);L.attachShader(this.program,H),this.attributes={};let V={};this.numAttributes=D.length;for(let K=0;K<this.numAttributes;K++)D[K]&&(L.bindAttribLocation(this.program,K,D[K]),this.attributes[D[K]]=K);if(L.linkProgram(this.program),!L.getProgramParameter(this.program,L.LINK_STATUS))throw new Error(`Program failed to link: ${L.getProgramInfoLog(this.program)}`);L.deleteShader(H),L.deleteShader(T);for(let K=0;K<kt.length;K++){let X=kt[K];if(X&&!V[X]){let $=L.getUniformLocation(this.program,X);$&&(V[X]=$)}}this.fixedUniforms=C(s,V),this.terrainUniforms=((K,X)=>({u_depth:new n.aL(K,X.u_depth),u_terrain:new n.aL(K,X.u_terrain),u_terrain_dim:new n.aM(K,X.u_terrain_dim),u_terrain_matrix:new n.aN(K,X.u_terrain_matrix),u_terrain_unpack:new n.aO(K,X.u_terrain_unpack),u_terrain_exaggeration:new n.aM(K,X.u_terrain_exaggeration)}))(s,V),this.binderUniforms=d?d.getUniforms(s,V):[]}draw(s,c,d,C,y,F,L,R,N,D,W,st,wt,yt,kt,p,w,k){let T=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(d),s.setStencilMode(C),s.setColorMode(y),s.setCullFace(F),R){s.activeTexture.set(T.TEXTURE2),T.bindTexture(T.TEXTURE_2D,R.depthTexture),s.activeTexture.set(T.TEXTURE3),T.bindTexture(T.TEXTURE_2D,R.texture);for(let V in this.terrainUniforms)this.terrainUniforms[V].set(R[V])}for(let V in this.fixedUniforms)this.fixedUniforms[V].set(L[V]);kt&&kt.setUniforms(s,this.binderUniforms,wt,{zoom:yt});let H=0;switch(c){case T.LINES:H=2;break;case T.TRIANGLES:H=3;break;case T.LINE_STRIP:H=1}for(let V of st.get()){let K=V.vaos||(V.vaos={});(K[N]||(K[N]=new Js)).bind(s,this,D,kt?kt.getPaintVertexBuffers():[],W,V.vertexOffset,p,w,k),T.drawElements(c,V.primitiveLength*H,T.UNSIGNED_SHORT,V.primitiveOffset*H*2)}}}function ft(I,s,c){let d=1/Jt(c,1,s.transform.tileZoom),C=Math.pow(2,c.tileID.overscaledZ),y=c.tileSize*Math.pow(2,s.transform.tileZoom)/C,F=y*(c.tileID.canonical.x+c.tileID.wrap*C),L=y*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[d,I.fromScale,I.toScale],u_fade:I.t,u_pixel_coord_upper:[F>>16,L>>16],u_pixel_coord_lower:[65535&F,65535&L]}}let ut=(I,s,c,d)=>{let C=s.style.light,y=C.properties.get("position"),F=[y.x,y.y,y.z],L=function(){var N=new n.A(9);return n.A!=Float32Array&&(N[1]=0,N[2]=0,N[3]=0,N[5]=0,N[6]=0,N[7]=0),N[0]=1,N[4]=1,N[8]=1,N}();C.properties.get("anchor")==="viewport"&&function(N,D){var W=Math.sin(D),st=Math.cos(D);N[0]=st,N[1]=W,N[2]=0,N[3]=-W,N[4]=st,N[5]=0,N[6]=0,N[7]=0,N[8]=1}(L,-s.transform.angle),function(N,D,W){var st=D[0],wt=D[1],yt=D[2];N[0]=st*W[0]+wt*W[3]+yt*W[6],N[1]=st*W[1]+wt*W[4]+yt*W[7],N[2]=st*W[2]+wt*W[5]+yt*W[8]}(F,F,L);let R=C.properties.get("color");return{u_matrix:I,u_lightpos:F,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[R.r,R.g,R.b],u_vertical_gradient:+c,u_opacity:d}},Zt=(I,s,c,d,C,y,F)=>n.e(ut(I,s,c,d),ft(y,s,F),{u_height_factor:-Math.pow(2,C.overscaledZ)/F.tileSize/8}),Kt=I=>({u_matrix:I}),ie=(I,s,c,d)=>n.e(Kt(I),ft(c,s,d)),ge=(I,s)=>({u_matrix:I,u_world:s}),Ue=(I,s,c,d,C)=>n.e(ie(I,s,c,d),{u_world:C}),Ee=(I,s,c,d)=>{let C=I.transform,y,F;if(d.paint.get("circle-pitch-alignment")==="map"){let L=Jt(c,1,C.zoom);y=!0,F=[L,L]}else y=!1,F=C.pixelsToGLUnits;return{u_camera_to_center_distance:C.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:I.translatePosMatrix(s.posMatrix,c,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:I.pixelRatio,u_extrude_scale:F}},Se=(I,s,c)=>{let d=Jt(c,1,s.zoom),C=Math.pow(2,s.zoom-c.tileID.overscaledZ),y=c.tileID.overscaleFactor();return{u_matrix:I,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[s.pixelsToGLUnits[0]/(d*C),s.pixelsToGLUnits[1]/(d*C)],u_overscale_factor:y}},le=(I,s,c=1)=>({u_matrix:I,u_color:s,u_overlay:0,u_overlay_scale:c}),ke=I=>({u_matrix:I}),Te=(I,s,c,d)=>({u_matrix:I,u_extrude_scale:Jt(s,1,c),u_intensity:d});function Pe(I,s){let c=Math.pow(2,s.canonical.z),d=s.canonical.y;return[new n.U(0,d/c).toLngLat().lat,new n.U(0,(d+1)/c).toLngLat().lat]}let Gi=(I,s,c,d)=>{let C=I.transform;return{u_matrix:Ti(I,s,c,d),u_ratio:1/Jt(s,1,C.zoom),u_device_pixel_ratio:I.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},Zi=(I,s,c,d,C)=>n.e(Gi(I,s,c,C),{u_image:0,u_image_height:d}),Je=(I,s,c,d,C)=>{let y=I.transform,F=Ci(s,y);return{u_matrix:Ti(I,s,c,C),u_texsize:s.imageAtlasTexture.size,u_ratio:1/Jt(s,1,y.zoom),u_device_pixel_ratio:I.pixelRatio,u_image:0,u_scale:[F,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Me=(I,s,c,d,C,y)=>{let F=I.lineAtlas,L=Ci(s,I.transform),R=c.layout.get("line-cap")==="round",N=F.getDash(d.from,R),D=F.getDash(d.to,R),W=N.width*C.fromScale,st=D.width*C.toScale;return n.e(Gi(I,s,c,y),{u_patternscale_a:[L/W,-N.height/2],u_patternscale_b:[L/st,-D.height/2],u_sdfgamma:F.width/(256*Math.min(W,st)*I.pixelRatio)/2,u_image:0,u_tex_y_a:N.y,u_tex_y_b:D.y,u_mix:C.t})};function Ci(I,s){return 1/Jt(I,1,s.tileZoom)}function Ti(I,s,c,d){return I.translatePosMatrix(d?d.posMatrix:s.tileID.posMatrix,s,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}let Xi=(I,s,c,d,C)=>{return{u_matrix:I,u_tl_parent:s,u_scale_parent:c,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:(F=C.paint.get("raster-saturation"),F>0?1-1/(1.001-F):-F),u_contrast_factor:(y=C.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:fr(C.paint.get("raster-hue-rotate"))};var y,F};function fr(I){I*=Math.PI/180;let s=Math.sin(I),c=Math.cos(I);return[(2*c+1)/3,(-Math.sqrt(3)*s-c+1)/3,(Math.sqrt(3)*s-c+1)/3]}let mi=(I,s,c,d,C,y,F,L,R,N)=>{let D=C.transform;return{u_is_size_zoom_constant:+(I==="constant"||I==="source"),u_is_size_feature_constant:+(I==="constant"||I==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:D.cameraToCenterDistance,u_pitch:D.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:D.width/D.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:F,u_coord_matrix:L,u_is_text:+R,u_pitch_with_map:+d,u_texsize:N,u_texture:0}},Rr=(I,s,c,d,C,y,F,L,R,N,D)=>{let W=C.transform;return n.e(mi(I,s,c,d,C,y,F,L,R,N),{u_gamma_scale:d?Math.cos(W._pitch)*W.cameraToCenterDistance:1,u_device_pixel_ratio:C.pixelRatio,u_is_halo:+D})},Kr=(I,s,c,d,C,y,F,L,R,N)=>n.e(Rr(I,s,c,d,C,y,F,L,!0,R,!0),{u_texsize_icon:N,u_texture_icon:1}),Mr=(I,s,c)=>({u_matrix:I,u_opacity:s,u_color:c}),tn=(I,s,c,d,C,y)=>n.e(function(F,L,R,N){let D=R.imageManager.getPattern(F.from.toString()),W=R.imageManager.getPattern(F.to.toString()),{width:st,height:wt}=R.imageManager.getPixelSize(),yt=Math.pow(2,N.tileID.overscaledZ),kt=N.tileSize*Math.pow(2,R.transform.tileZoom)/yt,p=kt*(N.tileID.canonical.x+N.tileID.wrap*yt),w=kt*N.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:D.tl,u_pattern_br_a:D.br,u_pattern_tl_b:W.tl,u_pattern_br_b:W.br,u_texsize:[st,wt],u_mix:L.t,u_pattern_size_a:D.displaySize,u_pattern_size_b:W.displaySize,u_scale_a:L.fromScale,u_scale_b:L.toScale,u_tile_units_to_pixels:1/Jt(N,1,R.transform.tileZoom),u_pixel_coord_upper:[p>>16,w>>16],u_pixel_coord_lower:[65535&p,65535&w]}}(d,y,c,C),{u_matrix:I,u_opacity:s}),En={fillExtrusion:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_lightpos:new n.aP(I,s.u_lightpos),u_lightintensity:new n.aM(I,s.u_lightintensity),u_lightcolor:new n.aP(I,s.u_lightcolor),u_vertical_gradient:new n.aM(I,s.u_vertical_gradient),u_opacity:new n.aM(I,s.u_opacity)}),fillExtrusionPattern:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_lightpos:new n.aP(I,s.u_lightpos),u_lightintensity:new n.aM(I,s.u_lightintensity),u_lightcolor:new n.aP(I,s.u_lightcolor),u_vertical_gradient:new n.aM(I,s.u_vertical_gradient),u_height_factor:new n.aM(I,s.u_height_factor),u_image:new n.aL(I,s.u_image),u_texsize:new n.aQ(I,s.u_texsize),u_pixel_coord_upper:new n.aQ(I,s.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(I,s.u_pixel_coord_lower),u_scale:new n.aP(I,s.u_scale),u_fade:new n.aM(I,s.u_fade),u_opacity:new n.aM(I,s.u_opacity)}),fill:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix)}),fillPattern:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_image:new n.aL(I,s.u_image),u_texsize:new n.aQ(I,s.u_texsize),u_pixel_coord_upper:new n.aQ(I,s.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(I,s.u_pixel_coord_lower),u_scale:new n.aP(I,s.u_scale),u_fade:new n.aM(I,s.u_fade)}),fillOutline:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_world:new n.aQ(I,s.u_world)}),fillOutlinePattern:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_world:new n.aQ(I,s.u_world),u_image:new n.aL(I,s.u_image),u_texsize:new n.aQ(I,s.u_texsize),u_pixel_coord_upper:new n.aQ(I,s.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(I,s.u_pixel_coord_lower),u_scale:new n.aP(I,s.u_scale),u_fade:new n.aM(I,s.u_fade)}),circle:(I,s)=>({u_camera_to_center_distance:new n.aM(I,s.u_camera_to_center_distance),u_scale_with_map:new n.aL(I,s.u_scale_with_map),u_pitch_with_map:new n.aL(I,s.u_pitch_with_map),u_extrude_scale:new n.aQ(I,s.u_extrude_scale),u_device_pixel_ratio:new n.aM(I,s.u_device_pixel_ratio),u_matrix:new n.aN(I,s.u_matrix)}),collisionBox:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_camera_to_center_distance:new n.aM(I,s.u_camera_to_center_distance),u_pixels_to_tile_units:new n.aM(I,s.u_pixels_to_tile_units),u_extrude_scale:new n.aQ(I,s.u_extrude_scale),u_overscale_factor:new n.aM(I,s.u_overscale_factor)}),collisionCircle:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_inv_matrix:new n.aN(I,s.u_inv_matrix),u_camera_to_center_distance:new n.aM(I,s.u_camera_to_center_distance),u_viewport_size:new n.aQ(I,s.u_viewport_size)}),debug:(I,s)=>({u_color:new n.aR(I,s.u_color),u_matrix:new n.aN(I,s.u_matrix),u_overlay:new n.aL(I,s.u_overlay),u_overlay_scale:new n.aM(I,s.u_overlay_scale)}),clippingMask:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix)}),heatmap:(I,s)=>({u_extrude_scale:new n.aM(I,s.u_extrude_scale),u_intensity:new n.aM(I,s.u_intensity),u_matrix:new n.aN(I,s.u_matrix)}),heatmapTexture:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_world:new n.aQ(I,s.u_world),u_image:new n.aL(I,s.u_image),u_color_ramp:new n.aL(I,s.u_color_ramp),u_opacity:new n.aM(I,s.u_opacity)}),hillshade:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_image:new n.aL(I,s.u_image),u_latrange:new n.aQ(I,s.u_latrange),u_light:new n.aQ(I,s.u_light),u_shadow:new n.aR(I,s.u_shadow),u_highlight:new n.aR(I,s.u_highlight),u_accent:new n.aR(I,s.u_accent)}),hillshadePrepare:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_image:new n.aL(I,s.u_image),u_dimension:new n.aQ(I,s.u_dimension),u_zoom:new n.aM(I,s.u_zoom),u_unpack:new n.aO(I,s.u_unpack)}),line:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_ratio:new n.aM(I,s.u_ratio),u_device_pixel_ratio:new n.aM(I,s.u_device_pixel_ratio),u_units_to_pixels:new n.aQ(I,s.u_units_to_pixels)}),lineGradient:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_ratio:new n.aM(I,s.u_ratio),u_device_pixel_ratio:new n.aM(I,s.u_device_pixel_ratio),u_units_to_pixels:new n.aQ(I,s.u_units_to_pixels),u_image:new n.aL(I,s.u_image),u_image_height:new n.aM(I,s.u_image_height)}),linePattern:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_texsize:new n.aQ(I,s.u_texsize),u_ratio:new n.aM(I,s.u_ratio),u_device_pixel_ratio:new n.aM(I,s.u_device_pixel_ratio),u_image:new n.aL(I,s.u_image),u_units_to_pixels:new n.aQ(I,s.u_units_to_pixels),u_scale:new n.aP(I,s.u_scale),u_fade:new n.aM(I,s.u_fade)}),lineSDF:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_ratio:new n.aM(I,s.u_ratio),u_device_pixel_ratio:new n.aM(I,s.u_device_pixel_ratio),u_units_to_pixels:new n.aQ(I,s.u_units_to_pixels),u_patternscale_a:new n.aQ(I,s.u_patternscale_a),u_patternscale_b:new n.aQ(I,s.u_patternscale_b),u_sdfgamma:new n.aM(I,s.u_sdfgamma),u_image:new n.aL(I,s.u_image),u_tex_y_a:new n.aM(I,s.u_tex_y_a),u_tex_y_b:new n.aM(I,s.u_tex_y_b),u_mix:new n.aM(I,s.u_mix)}),raster:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_tl_parent:new n.aQ(I,s.u_tl_parent),u_scale_parent:new n.aM(I,s.u_scale_parent),u_buffer_scale:new n.aM(I,s.u_buffer_scale),u_fade_t:new n.aM(I,s.u_fade_t),u_opacity:new n.aM(I,s.u_opacity),u_image0:new n.aL(I,s.u_image0),u_image1:new n.aL(I,s.u_image1),u_brightness_low:new n.aM(I,s.u_brightness_low),u_brightness_high:new n.aM(I,s.u_brightness_high),u_saturation_factor:new n.aM(I,s.u_saturation_factor),u_contrast_factor:new n.aM(I,s.u_contrast_factor),u_spin_weights:new n.aP(I,s.u_spin_weights)}),symbolIcon:(I,s)=>({u_is_size_zoom_constant:new n.aL(I,s.u_is_size_zoom_constant),u_is_size_feature_constant:new n.aL(I,s.u_is_size_feature_constant),u_size_t:new n.aM(I,s.u_size_t),u_size:new n.aM(I,s.u_size),u_camera_to_center_distance:new n.aM(I,s.u_camera_to_center_distance),u_pitch:new n.aM(I,s.u_pitch),u_rotate_symbol:new n.aL(I,s.u_rotate_symbol),u_aspect_ratio:new n.aM(I,s.u_aspect_ratio),u_fade_change:new n.aM(I,s.u_fade_change),u_matrix:new n.aN(I,s.u_matrix),u_label_plane_matrix:new n.aN(I,s.u_label_plane_matrix),u_coord_matrix:new n.aN(I,s.u_coord_matrix),u_is_text:new n.aL(I,s.u_is_text),u_pitch_with_map:new n.aL(I,s.u_pitch_with_map),u_texsize:new n.aQ(I,s.u_texsize),u_texture:new n.aL(I,s.u_texture)}),symbolSDF:(I,s)=>({u_is_size_zoom_constant:new n.aL(I,s.u_is_size_zoom_constant),u_is_size_feature_constant:new n.aL(I,s.u_is_size_feature_constant),u_size_t:new n.aM(I,s.u_size_t),u_size:new n.aM(I,s.u_size),u_camera_to_center_distance:new n.aM(I,s.u_camera_to_center_distance),u_pitch:new n.aM(I,s.u_pitch),u_rotate_symbol:new n.aL(I,s.u_rotate_symbol),u_aspect_ratio:new n.aM(I,s.u_aspect_ratio),u_fade_change:new n.aM(I,s.u_fade_change),u_matrix:new n.aN(I,s.u_matrix),u_label_plane_matrix:new n.aN(I,s.u_label_plane_matrix),u_coord_matrix:new n.aN(I,s.u_coord_matrix),u_is_text:new n.aL(I,s.u_is_text),u_pitch_with_map:new n.aL(I,s.u_pitch_with_map),u_texsize:new n.aQ(I,s.u_texsize),u_texture:new n.aL(I,s.u_texture),u_gamma_scale:new n.aM(I,s.u_gamma_scale),u_device_pixel_ratio:new n.aM(I,s.u_device_pixel_ratio),u_is_halo:new n.aL(I,s.u_is_halo)}),symbolTextAndIcon:(I,s)=>({u_is_size_zoom_constant:new n.aL(I,s.u_is_size_zoom_constant),u_is_size_feature_constant:new n.aL(I,s.u_is_size_feature_constant),u_size_t:new n.aM(I,s.u_size_t),u_size:new n.aM(I,s.u_size),u_camera_to_center_distance:new n.aM(I,s.u_camera_to_center_distance),u_pitch:new n.aM(I,s.u_pitch),u_rotate_symbol:new n.aL(I,s.u_rotate_symbol),u_aspect_ratio:new n.aM(I,s.u_aspect_ratio),u_fade_change:new n.aM(I,s.u_fade_change),u_matrix:new n.aN(I,s.u_matrix),u_label_plane_matrix:new n.aN(I,s.u_label_plane_matrix),u_coord_matrix:new n.aN(I,s.u_coord_matrix),u_is_text:new n.aL(I,s.u_is_text),u_pitch_with_map:new n.aL(I,s.u_pitch_with_map),u_texsize:new n.aQ(I,s.u_texsize),u_texsize_icon:new n.aQ(I,s.u_texsize_icon),u_texture:new n.aL(I,s.u_texture),u_texture_icon:new n.aL(I,s.u_texture_icon),u_gamma_scale:new n.aM(I,s.u_gamma_scale),u_device_pixel_ratio:new n.aM(I,s.u_device_pixel_ratio),u_is_halo:new n.aL(I,s.u_is_halo)}),background:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_opacity:new n.aM(I,s.u_opacity),u_color:new n.aR(I,s.u_color)}),backgroundPattern:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_opacity:new n.aM(I,s.u_opacity),u_image:new n.aL(I,s.u_image),u_pattern_tl_a:new n.aQ(I,s.u_pattern_tl_a),u_pattern_br_a:new n.aQ(I,s.u_pattern_br_a),u_pattern_tl_b:new n.aQ(I,s.u_pattern_tl_b),u_pattern_br_b:new n.aQ(I,s.u_pattern_br_b),u_texsize:new n.aQ(I,s.u_texsize),u_mix:new n.aM(I,s.u_mix),u_pattern_size_a:new n.aQ(I,s.u_pattern_size_a),u_pattern_size_b:new n.aQ(I,s.u_pattern_size_b),u_scale_a:new n.aM(I,s.u_scale_a),u_scale_b:new n.aM(I,s.u_scale_b),u_pixel_coord_upper:new n.aQ(I,s.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(I,s.u_pixel_coord_lower),u_tile_units_to_pixels:new n.aM(I,s.u_tile_units_to_pixels)}),terrain:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_texture:new n.aL(I,s.u_texture),u_ele_delta:new n.aM(I,s.u_ele_delta)}),terrainDepth:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_ele_delta:new n.aM(I,s.u_ele_delta)}),terrainCoords:(I,s)=>({u_matrix:new n.aN(I,s.u_matrix),u_texture:new n.aL(I,s.u_texture),u_terrain_coords_id:new n.aM(I,s.u_terrain_coords_id),u_ele_delta:new n.aM(I,s.u_ele_delta)})};class Xs{constructor(s,c,d){this.context=s;let C=s.gl;this.buffer=C.createBuffer(),this.dynamicDraw=Boolean(d),this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){let c=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let jo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class yA{constructor(s,c,d,C){this.length=c.length,this.attributes=d,this.itemSize=c.bytesPerElement,this.dynamicDraw=C,this.context=s;let y=s.gl;this.buffer=y.createBuffer(),s.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);let c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,c){for(let d=0;d<this.attributes.length;d++){let C=c.attributes[this.attributes[d].name];C!==void 0&&s.enableVertexAttribArray(C)}}setVertexAttribPointers(s,c,d){for(let C=0;C<this.attributes.length;C++){let y=this.attributes[C],F=c.attributes[y.name];F!==void 0&&s.vertexAttribPointer(F,y.components,s[jo[y.type]],!1,this.itemSize,y.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let ya=new WeakMap;function Qo(I){var s;if(ya.has(I))return ya.get(I);{let c=(s=I.getParameter(I.VERSION))===null||s===void 0?void 0:s.startsWith("WebGL 2.0");return ya.set(I,c),c}}class Ar{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Uo extends Ar{getDefault(){return n.aT.transparent}set(s){let c=this.current;(s.r!==c.r||s.g!==c.g||s.b!==c.b||s.a!==c.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class bn extends Ar{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class hs extends Ar{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class qo extends Ar{getDefault(){return[!0,!0,!0,!0]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class ba extends Ar{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class $o extends Ar{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class bA extends Ar{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){let c=this.current;(s.func!==c.func||s.ref!==c.ref||s.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class vA extends Ar{getDefault(){let s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Ua extends Ar{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;s?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=s,this.dirty=!1}}class wA extends Ar{getDefault(){return[0,1]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class go extends Ar{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;s?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=s,this.dirty=!1}}class po extends Ar{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class xl extends Ar{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;s?c.enable(c.BLEND):c.disable(c.BLEND),this.current=s,this.dirty=!1}}class ta extends Ar{getDefault(){let s=this.gl;return[s.ONE,s.ZERO]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class ns extends Ar{getDefault(){return n.aT.transparent}set(s){let c=this.current;(s.r!==c.r||s.g!==c.g||s.b!==c.b||s.a!==c.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class YA extends Ar{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class Ga extends Ar{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;s?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=s,this.dirty=!1}}class Cc extends Ar{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class BA extends Ar{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class Ic extends Ar{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class jA extends Ar{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class Ra extends Ar{getDefault(){let s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){let c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Za extends Ar{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class va extends Ar{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Ha extends Ar{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.bindTexture(c.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Go extends Ar{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class qA extends Ar{getDefault(){return null}set(s){let c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Sl extends Ar{getDefault(){return null}set(s){var c;if(s===this.current&&!this.dirty)return;let d=this.gl;Qo(d)?d.bindVertexArray(s):(c=d.getExtension("OES_vertex_array_object"))===null||c===void 0||c.bindVertexArrayOES(s),this.current=s,this.dirty=!1}}class wa extends Ar{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class Gs extends Ar{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class _A extends Ar{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;let c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class gs extends Ar{constructor(s,c){super(s),this.context=s,this.parent=c}getDefault(){return null}}class Ro extends gs{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class U extends gs{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class et extends gs{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class vt{constructor(s,c,d,C,y){this.context=s,this.width=c,this.height=d;let F=s.gl,L=this.framebuffer=F.createFramebuffer();if(this.colorAttachment=new Ro(s,L),C)this.depthAttachment=y?new et(s,L):new U(s,L);else if(y)throw new Error("Stencil cannot be setted without depth");if(F.checkFramebufferStatus(F.FRAMEBUFFER)!==F.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let s=this.context.gl,c=this.colorAttachment.get();if(c&&s.deleteTexture(c),this.depthAttachment){let d=this.depthAttachment.get();d&&s.deleteRenderbuffer(d)}s.deleteFramebuffer(this.framebuffer)}}class Dt{constructor(s,c,d){this.blendFunction=s,this.blendColor=c,this.mask=d}}Dt.Replace=[1,0],Dt.disabled=new Dt(Dt.Replace,n.aT.transparent,[!1,!1,!1,!1]),Dt.unblended=new Dt(Dt.Replace,n.aT.transparent,[!0,!0,!0,!0]),Dt.alphaBlended=new Dt([1,771],n.aT.transparent,[!0,!0,!0,!0]);class de{constructor(s){var c,d;if(this.gl=s,this.clearColor=new Uo(this),this.clearDepth=new bn(this),this.clearStencil=new hs(this),this.colorMask=new qo(this),this.depthMask=new ba(this),this.stencilMask=new $o(this),this.stencilFunc=new bA(this),this.stencilOp=new vA(this),this.stencilTest=new Ua(this),this.depthRange=new wA(this),this.depthTest=new go(this),this.depthFunc=new po(this),this.blend=new xl(this),this.blendFunc=new ta(this),this.blendColor=new ns(this),this.blendEquation=new YA(this),this.cullFace=new Ga(this),this.cullFaceSide=new Cc(this),this.frontFace=new BA(this),this.program=new Ic(this),this.activeTexture=new jA(this),this.viewport=new Ra(this),this.bindFramebuffer=new Za(this),this.bindRenderbuffer=new va(this),this.bindTexture=new Ha(this),this.bindVertexBuffer=new Go(this),this.bindElementBuffer=new qA(this),this.bindVertexArray=new Sl(this),this.pixelStoreUnpack=new wa(this),this.pixelStoreUnpackPremultiplyAlpha=new Gs(this),this.pixelStoreUnpackFlipY=new _A(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),Qo(s)){this.HALF_FLOAT=s.HALF_FLOAT;let C=s.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(c=s.RGBA16F)!==null&&c!==void 0?c:C?.RGBA16F_EXT,this.RGB16F=(d=s.RGB16F)!==null&&d!==void 0?d:C?.RGB16F_EXT,s.getExtension("EXT_color_buffer_float")}else{s.getExtension("EXT_color_buffer_half_float"),s.getExtension("OES_texture_half_float_linear");let C=s.getExtension("OES_texture_half_float");this.HALF_FLOAT=C?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,c){return new Xs(this,s,c)}createVertexBuffer(s,c,d){return new yA(this,s,c,d)}createRenderbuffer(s,c,d){let C=this.gl,y=C.createRenderbuffer();return this.bindRenderbuffer.set(y),C.renderbufferStorage(C.RENDERBUFFER,s,c,d),this.bindRenderbuffer.set(null),y}createFramebuffer(s,c,d,C){return new vt(this,s,c,d,C)}clear({color:s,depth:c,stencil:d}){let C=this.gl,y=0;s&&(y|=C.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(y|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),d!==void 0&&(y|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),C.clear(y)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){n.aG(s.blendFunction,Dt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}createVertexArray(){var s;return Qo(this.gl)?this.gl.createVertexArray():(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.createVertexArrayOES()}deleteVertexArray(s){var c;return Qo(this.gl)?this.gl.deleteVertexArray(s):(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.deleteVertexArrayOES(s)}unbindVAO(){this.bindVertexArray.set(null)}}class Ce{constructor(s,c,d){this.func=s,this.mask=c,this.range=d}}Ce.ReadOnly=!1,Ce.ReadWrite=!0,Ce.disabled=new Ce(519,Ce.ReadOnly,[0,1]);let Ke=7680;class ti{constructor(s,c,d,C,y,F){this.test=s,this.ref=c,this.mask=d,this.fail=C,this.depthFail=y,this.pass=F}}ti.disabled=new ti({func:519,mask:0},0,0,Ke,Ke,Ke);class di{constructor(s,c,d){this.enable=s,this.mode=c,this.frontFace=d}}let tr;function cr(I,s,c,d,C,y,F){let L=I.context,R=L.gl,N=I.useProgram("collisionBox"),D=[],W=0,st=0;for(let T=0;T<d.length;T++){let H=d[T],V=s.getTile(H),K=V.getBucket(c);if(!K)continue;let X=H.posMatrix;C[0]===0&&C[1]===0||(X=I.translatePosMatrix(H.posMatrix,V,C,y));let $=F?K.textCollisionBox:K.iconCollisionBox,nt=K.collisionCircleArray;if(nt.length>0){let Ct=n.Z(),zt=X;n.aU(Ct,K.placementInvProjMatrix,I.transform.glCoordMatrix),n.aU(Ct,Ct,K.placementViewportMatrix),D.push({circleArray:nt,circleOffset:st,transform:zt,invTransform:Ct,coord:H}),W+=nt.length/4,st=W}$&&N.draw(L,R.LINES,Ce.disabled,ti.disabled,I.colorModeForRenderPass(),di.disabled,Se(X,I.transform,V),I.style.map.terrain&&I.style.map.terrain.getTerrainData(H),c.id,$.layoutVertexBuffer,$.indexBuffer,$.segments,null,I.transform.zoom,null,null,$.collisionVertexBuffer)}if(!F||!D.length)return;let wt=I.useProgram("collisionCircle"),yt=new n.aV;yt.resize(4*W),yt._trim();let kt=0;for(let T of D)for(let H=0;H<T.circleArray.length/4;H++){let V=4*H,K=T.circleArray[V+0],X=T.circleArray[V+1],$=T.circleArray[V+2],nt=T.circleArray[V+3];yt.emplace(kt++,K,X,$,nt,0),yt.emplace(kt++,K,X,$,nt,1),yt.emplace(kt++,K,X,$,nt,2),yt.emplace(kt++,K,X,$,nt,3)}(!tr||tr.length<2*W)&&(tr=function(T){let H=2*T,V=new n.aX;V.resize(H),V._trim();for(let K=0;K<H;K++){let X=6*K;V.uint16[X+0]=4*K+0,V.uint16[X+1]=4*K+1,V.uint16[X+2]=4*K+2,V.uint16[X+3]=4*K+2,V.uint16[X+4]=4*K+3,V.uint16[X+5]=4*K+0}return V}(W));let p=L.createIndexBuffer(tr,!0),w=L.createVertexBuffer(yt,n.aW.members,!0);for(let T of D){let H={u_matrix:T.transform,u_inv_matrix:T.invTransform,u_camera_to_center_distance:(k=I.transform).cameraToCenterDistance,u_viewport_size:[k.width,k.height]};wt.draw(L,R.TRIANGLES,Ce.disabled,ti.disabled,I.colorModeForRenderPass(),di.disabled,H,I.style.map.terrain&&I.style.map.terrain.getTerrainData(T.coord),c.id,w,p,n.S.simpleSegment(0,2*T.circleOffset,T.circleArray.length,T.circleArray.length/2),null,I.transform.zoom,null,null,null)}var k;w.destroy(),p.destroy()}di.disabled=new di(!1,1029,2305),di.backCCW=new di(!0,1029,2305);let Cr=n.ao(new Float32Array(16));function Jr(I,s,c,d,C,y){let{horizontalAlign:F,verticalAlign:L}=n.au(I);return new n.P((-(F-.5)*s/C+d[0])*y,(-(L-.5)*c/C+d[1])*y)}function en(I,s,c,d,C,y,F,L,R,N,D){let W=I.text.placedSymbolArray,st=I.text.dynamicLayoutVertexArray,wt=I.icon.dynamicLayoutVertexArray,yt={};st.clear();for(let kt=0;kt<W.length;kt++){let p=W.get(kt),w=p.hidden||!p.crossTileID||I.allowVerticalPlacement&&!p.placedOrientation?null:d[p.crossTileID];if(w){let k=new n.P(p.anchorX,p.anchorY),T=Ki(k,c?F:y,D),H=ji(C.cameraToCenterDistance,T.signedDistanceFromCamera),V=n.aj(I.textSizeData,R,p)*H/n.ap;c&&(V*=I.tilePixelRatio/L);let{width:K,height:X,anchor:$,textOffset:nt,textBoxScale:Ct}=w,zt=Jr($,K,X,nt,Ct,V),re=c?Ki(k.add(zt),y,D).point:T.point.add(s?zt.rotate(-C.angle):zt),Tt=I.allowVerticalPlacement&&p.placedOrientation===n.ai.vertical?Math.PI/2:0;for(let pe=0;pe<p.numGlyphs;pe++)n.ak(st,re,Tt);N&&p.associatedIconIndex>=0&&(yt[p.associatedIconIndex]={shiftedAnchor:re,angle:Tt})}else lt(p.numGlyphs,st)}if(N){wt.clear();let kt=I.icon.placedSymbolArray;for(let p=0;p<kt.length;p++){let w=kt.get(p);if(w.hidden)lt(w.numGlyphs,wt);else{let k=yt[p];if(k)for(let T=0;T<w.numGlyphs;T++)n.ak(wt,k.shiftedAnchor,k.angle);else lt(w.numGlyphs,wt)}}I.icon.dynamicLayoutVertexBuffer.updateData(wt)}I.text.dynamicLayoutVertexBuffer.updateData(st)}function pn(I,s,c){return c.iconsInText&&s?"symbolTextAndIcon":I?"symbolSDF":"symbolIcon"}function Sn(I,s,c,d,C,y,F,L,R,N,D,W){let st=I.context,wt=st.gl,yt=I.transform,kt=L==="map",p=R==="map",w=L!=="viewport"&&c.layout.get("symbol-placement")!=="point",k=kt&&!p&&!w,T=!c.layout.get("symbol-sort-key").isConstant(),H=!1,V=I.depthModeForSublayer(0,Ce.ReadOnly),K=c._unevaluatedLayout.hasValue("text-variable-anchor")||c._unevaluatedLayout.hasValue("text-variable-anchor-offset"),X=[];for(let $ of d){let nt=s.getTile($),Ct=nt.getBucket(c);if(!Ct)continue;let zt=C?Ct.text:Ct.icon;if(!zt||!zt.segments.get().length||!zt.hasVisibleVertices)continue;let re=zt.programConfigurations.get(c.id),Tt=C||Ct.sdfIcons,pe=C?Ct.textSizeData:Ct.iconSizeData,te=p||yt.pitch!==0,Ot=I.useProgram(pn(Tt,C,Ct),re),Wt=n.ah(pe,yt.zoom),Ie=I.style.map.terrain&&I.style.map.terrain.getTerrainData($),we,Le,je,$e,wi=[0,0],qe=null;if(C)Le=nt.glyphAtlasTexture,je=wt.LINEAR,we=nt.glyphAtlasTexture.size,Ct.iconsInText&&(wi=nt.imageAtlasTexture.size,qe=nt.imageAtlasTexture,$e=te||I.options.rotating||I.options.zooming||pe.kind==="composite"||pe.kind==="camera"?wt.LINEAR:wt.NEAREST);else{let Yi=c.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear;Le=nt.imageAtlasTexture,je=Tt||I.options.rotating||I.options.zooming||Yi||te?wt.LINEAR:wt.NEAREST,we=nt.imageAtlasTexture.size}let ar=Jt(nt,1,I.transform.zoom),Vi=Fe($.posMatrix,p,kt,I.transform,ar),lr=Ye($.posMatrix,p,kt,I.transform,ar),rr=K&&Ct.hasTextData(),Br=c.layout.get("icon-text-fit")!=="none"&&rr&&Ct.hasIconData();if(w){let Yi=I.style.map.terrain?(jr,dr)=>I.style.map.terrain.getElevation($,jr,dr):null,Tr=c.layout.get("text-rotation-alignment")==="map";Qe(Ct,$.posMatrix,I,C,Vi,lr,p,N,Tr,Yi)}let _r=I.translatePosMatrix($.posMatrix,nt,y,F),er=w||C&&K||Br?Cr:Vi,wr=I.translatePosMatrix(lr,nt,y,F,!0),Zr=Tt&&c.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1)!==0,xr;xr=Tt?Ct.iconsInText?Kr(pe.kind,Wt,k,p,I,_r,er,wr,we,wi):Rr(pe.kind,Wt,k,p,I,_r,er,wr,C,we,!0):mi(pe.kind,Wt,k,p,I,_r,er,wr,C,we);let Bn={program:Ot,buffers:zt,uniformValues:xr,atlasTexture:Le,atlasTextureIcon:qe,atlasInterpolation:je,atlasInterpolationIcon:$e,isSDF:Tt,hasHalo:Zr};if(T&&Ct.canOverlap){H=!0;let Yi=zt.segments.get();for(let Tr of Yi)X.push({segments:new n.S([Tr]),sortKey:Tr.sortKey,state:Bn,terrainData:Ie})}else X.push({segments:zt.segments,sortKey:0,state:Bn,terrainData:Ie})}H&&X.sort(($,nt)=>$.sortKey-nt.sortKey);for(let $ of X){let nt=$.state;if(st.activeTexture.set(wt.TEXTURE0),nt.atlasTexture.bind(nt.atlasInterpolation,wt.CLAMP_TO_EDGE),nt.atlasTextureIcon&&(st.activeTexture.set(wt.TEXTURE1),nt.atlasTextureIcon&&nt.atlasTextureIcon.bind(nt.atlasInterpolationIcon,wt.CLAMP_TO_EDGE)),nt.isSDF){let Ct=nt.uniformValues;nt.hasHalo&&(Ct.u_is_halo=1,vn(nt.buffers,$.segments,c,I,nt.program,V,D,W,Ct,$.terrainData)),Ct.u_is_halo=0}vn(nt.buffers,$.segments,c,I,nt.program,V,D,W,nt.uniformValues,$.terrainData)}}function vn(I,s,c,d,C,y,F,L,R,N){let D=d.context;C.draw(D,D.gl.TRIANGLES,y,F,L,di.disabled,R,N,c.id,I.layoutVertexBuffer,I.indexBuffer,s,c.paint,d.transform.zoom,I.programConfigurations.get(c.id),I.dynamicLayoutVertexBuffer,I.opacityVertexBuffer)}function ds(I,s,c,d,C){if(!c||!d||!d.imageAtlas)return;let y=d.imageAtlas.patternPositions,F=y[c.to.toString()],L=y[c.from.toString()];if(!F&&L&&(F=L),!L&&F&&(L=F),!F||!L){let R=C.getPaintProperty(s);F=y[R],L=y[R]}F&&L&&I.setConstantPatternPositions(F,L)}function ss(I,s,c,d,C,y,F){let L=I.context.gl,R="fill-pattern",N=c.paint.get(R),D=N&&N.constantOr(1),W=c.getCrossfadeParameters(),st,wt,yt,kt,p;F?(wt=D&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",st=L.LINES):(wt=D?"fillPattern":"fill",st=L.TRIANGLES);let w=N.constantOr(null);for(let k of d){let T=s.getTile(k);if(D&&!T.patternsLoaded())continue;let H=T.getBucket(c);if(!H)continue;let V=H.programConfigurations.get(c.id),K=I.useProgram(wt,V),X=I.style.map.terrain&&I.style.map.terrain.getTerrainData(k);D&&(I.context.activeTexture.set(L.TEXTURE0),T.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),V.updatePaintBuffers(W)),ds(V,R,w,T,c);let $=X?k:null,nt=I.translatePosMatrix($?$.posMatrix:k.posMatrix,T,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(F){kt=H.indexBuffer2,p=H.segments2;let Ct=[L.drawingBufferWidth,L.drawingBufferHeight];yt=wt==="fillOutlinePattern"&&D?Ue(nt,I,W,T,Ct):ge(nt,Ct)}else kt=H.indexBuffer,p=H.segments,yt=D?ie(nt,I,W,T):Kt(nt);K.draw(I.context,st,C,I.stencilModeForClipping(k),y,di.disabled,yt,X,c.id,H.layoutVertexBuffer,kt,p,c.paint,I.transform.zoom,V)}}function Rs(I,s,c,d,C,y,F){let L=I.context,R=L.gl,N="fill-extrusion-pattern",D=c.paint.get(N),W=D.constantOr(1),st=c.getCrossfadeParameters(),wt=c.paint.get("fill-extrusion-opacity"),yt=D.constantOr(null);for(let kt of d){let p=s.getTile(kt),w=p.getBucket(c);if(!w)continue;let k=I.style.map.terrain&&I.style.map.terrain.getTerrainData(kt),T=w.programConfigurations.get(c.id),H=I.useProgram(W?"fillExtrusionPattern":"fillExtrusion",T);W&&(I.context.activeTexture.set(R.TEXTURE0),p.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),T.updatePaintBuffers(st)),ds(T,N,yt,p,c);let V=I.translatePosMatrix(kt.posMatrix,p,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),K=c.paint.get("fill-extrusion-vertical-gradient"),X=W?Zt(V,I,K,wt,kt,st,p):ut(V,I,K,wt);H.draw(L,L.gl.TRIANGLES,C,y,F,di.backCCW,X,k,c.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,c.paint,I.transform.zoom,T,I.style.map.terrain&&w.centroidVertexBuffer)}}function Fl(I,s,c,d,C,y,F){let L=I.context,R=L.gl,N=c.fbo;if(!N)return;let D=I.useProgram("hillshade"),W=I.style.map.terrain&&I.style.map.terrain.getTerrainData(s);L.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,N.colorAttachment.get()),D.draw(L,R.TRIANGLES,C,y,F,di.disabled,((st,wt,yt,kt)=>{let p=yt.paint.get("hillshade-shadow-color"),w=yt.paint.get("hillshade-highlight-color"),k=yt.paint.get("hillshade-accent-color"),T=yt.paint.get("hillshade-illumination-direction")*(Math.PI/180);yt.paint.get("hillshade-illumination-anchor")==="viewport"&&(T-=st.transform.angle);let H=!st.options.moving;return{u_matrix:kt?kt.posMatrix:st.transform.calculatePosMatrix(wt.tileID.toUnwrapped(),H),u_image:0,u_latrange:Pe(0,wt.tileID),u_light:[yt.paint.get("hillshade-exaggeration"),T],u_shadow:p,u_highlight:w,u_accent:k}})(I,c,d,W?s:null),W,d.id,I.rasterBoundsBuffer,I.quadTriangleIndexBuffer,I.rasterBoundsSegments)}function Na(I,s,c,d,C,y){let F=I.context,L=F.gl,R=s.dem;if(R&&R.data){let N=R.dim,D=R.stride,W=R.getPixels();if(F.activeTexture.set(L.TEXTURE1),F.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||I.getTileTexture(D),s.demTexture){let wt=s.demTexture;wt.update(W,{premultiply:!1}),wt.bind(L.NEAREST,L.CLAMP_TO_EDGE)}else s.demTexture=new dt(F,W,L.RGBA,{premultiply:!1}),s.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE);F.activeTexture.set(L.TEXTURE0);let st=s.fbo;if(!st){let wt=new dt(F,{width:N,height:N,data:null},L.RGBA);wt.bind(L.LINEAR,L.CLAMP_TO_EDGE),st=s.fbo=F.createFramebuffer(N,N,!0,!1),st.colorAttachment.set(wt.texture)}F.bindFramebuffer.set(st.framebuffer),F.viewport.set([0,0,N,N]),I.useProgram("hillshadePrepare").draw(F,L.TRIANGLES,d,C,y,di.disabled,((wt,yt)=>{let kt=yt.stride,p=n.Z();return n.aS(p,0,n.N,-n.N,0,0,1),n.$(p,p,[0,-n.N,0]),{u_matrix:p,u_image:1,u_dimension:[kt,kt],u_zoom:wt.overscaledZ,u_unpack:yt.getUnpackVector()}})(s.tileID,R),null,c.id,I.rasterBoundsBuffer,I.quadTriangleIndexBuffer,I.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function $A(I,s,c,d,C,y){let F=d.paint.get("raster-fade-duration");if(!y&&F>0){let L=n.h.now(),R=(L-I.timeAdded)/F,N=s?(L-s.timeAdded)/F:-1,D=c.getSource(),W=C.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),st=!s||Math.abs(s.tileID.overscaledZ-W)>Math.abs(I.tileID.overscaledZ-W),wt=st&&I.refreshedUponExpiration?1:n.ad(st?R:1-N,0,1);return I.refreshedUponExpiration&&R>=1&&(I.refreshedUponExpiration=!1),s?{opacity:1,mix:1-wt}:{opacity:wt,mix:0}}return{opacity:1,mix:0}}let Pa=new n.aT(1,0,0,1),Ba=new n.aT(0,1,0,1),Ma=new n.aT(0,0,1,1),Va=new n.aT(1,0,1,1),ps=new n.aT(0,1,1,1);function Zo(I,s,c,d){ia(I,0,s+c/2,I.transform.width,c,d)}function ea(I,s,c,d){ia(I,s-c/2,0,c,I.transform.height,d)}function ia(I,s,c,d,C,y){let F=I.context,L=F.gl;L.enable(L.SCISSOR_TEST),L.scissor(s*I.pixelRatio,c*I.pixelRatio,d*I.pixelRatio,C*I.pixelRatio),F.clear({color:y}),L.disable(L.SCISSOR_TEST)}function xA(I,s,c){let d=I.context,C=d.gl,y=c.posMatrix,F=I.useProgram("debug"),L=Ce.disabled,R=ti.disabled,N=I.colorModeForRenderPass(),D="$debug",W=I.style.map.terrain&&I.style.map.terrain.getTerrainData(c);d.activeTexture.set(C.TEXTURE0);let st=s.getTileByID(c.key).latestRawTileData,wt=Math.floor((st&&st.byteLength||0)/1024),yt=s.getTile(c).tileSize,kt=512/Math.min(yt,512)*(c.overscaledZ/I.transform.zoom)*.5,p=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(p+=` => ${c.overscaledZ}`),function(w,k){w.initDebugOverlayCanvas();let T=w.debugOverlayCanvas,H=w.context.gl,V=w.debugOverlayCanvas.getContext("2d");V.clearRect(0,0,T.width,T.height),V.shadowColor="white",V.shadowBlur=2,V.lineWidth=1.5,V.strokeStyle="white",V.textBaseline="top",V.font="bold 36px Open Sans, sans-serif",V.fillText(k,5,5),V.strokeText(k,5,5),w.debugOverlayTexture.update(T),w.debugOverlayTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE)}(I,`${p} ${wt}kB`),F.draw(d,C.TRIANGLES,L,R,Dt.alphaBlended,di.disabled,le(y,n.aT.transparent,kt),null,D,I.debugBuffer,I.quadTriangleIndexBuffer,I.debugSegments),F.draw(d,C.LINE_STRIP,L,R,N,di.disabled,le(y,n.aT.red),W,D,I.debugBuffer,I.tileBorderIndexBuffer,I.debugSegments)}function Ir(I,s,c){let d=I.context,C=d.gl,y=I.colorModeForRenderPass(),F=new Ce(C.LEQUAL,Ce.ReadWrite,I.depthRangeFor3D),L=I.useProgram("terrain"),R=s.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,I.width,I.height]);for(let N of c){let D=I.renderToTexture.getTexture(N),W=s.getTerrainData(N.tileID);d.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,D.texture);let st={u_matrix:I.transform.calculatePosMatrix(N.tileID.toUnwrapped()),u_texture:0,u_ele_delta:s.getMeshFrameDelta(I.transform.zoom)};L.draw(d,C.TRIANGLES,F,ti.disabled,y,di.backCCW,st,W,"terrain",R.vertexBuffer,R.indexBuffer,R.segments)}}class ra{constructor(s,c){this.context=new de(s),this.transform=c,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:n.Z(),renderTime:0},this.setup(),this.numSublayers=Ze.maxUnderzooming+Ze.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ho}resize(s,c,d){if(this.width=Math.floor(s*d),this.height=Math.floor(c*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let C of this.style._order)this.style._layers[C].resize()}setup(){let s=this.context,c=new n.a_;c.emplaceBack(0,0),c.emplaceBack(n.N,0),c.emplaceBack(0,n.N),c.emplaceBack(n.N,n.N),this.tileExtentBuffer=s.createVertexBuffer(c,Ia.members),this.tileExtentSegments=n.S.simpleSegment(0,0,4,2);let d=new n.a_;d.emplaceBack(0,0),d.emplaceBack(n.N,0),d.emplaceBack(0,n.N),d.emplaceBack(n.N,n.N),this.debugBuffer=s.createVertexBuffer(d,Ia.members),this.debugSegments=n.S.simpleSegment(0,0,4,5);let C=new n.V;C.emplaceBack(0,0,0,0),C.emplaceBack(n.N,0,n.N,0),C.emplaceBack(0,n.N,0,n.N),C.emplaceBack(n.N,n.N,n.N,n.N),this.rasterBoundsBuffer=s.createVertexBuffer(C,he.members),this.rasterBoundsSegments=n.S.simpleSegment(0,0,4,2);let y=new n.a_;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(y,Ia.members),this.viewportSegments=n.S.simpleSegment(0,0,4,2);let F=new n.a$;F.emplaceBack(0),F.emplaceBack(1),F.emplaceBack(3),F.emplaceBack(2),F.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(F);let L=new n.b0;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(L);let R=this.context.gl;this.stencilClearMode=new ti({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO)}clearStencil(){let s=this.context,c=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let d=n.Z();n.aS(d,0,this.width,this.height,0,0,1),n.a0(d,d,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,c.TRIANGLES,Ce.disabled,this.stencilClearMode,Dt.disabled,di.disabled,ke(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,c){if(this.currentStencilSource===s.source||!s.isTileClipped()||!c||!c.length)return;this.currentStencilSource=s.source;let d=this.context,C=d.gl;this.nextStencilID+c.length>256&&this.clearStencil(),d.setColorMode(Dt.disabled),d.setDepthMode(Ce.disabled);let y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let F of c){let L=this._tileClippingMaskIDs[F.key]=this.nextStencilID++,R=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F);y.draw(d,C.TRIANGLES,Ce.disabled,new ti({func:C.ALWAYS,mask:0},L,255,C.KEEP,C.KEEP,C.REPLACE),Dt.disabled,di.disabled,ke(F.posMatrix),R,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let s=this.nextStencilID++,c=this.context.gl;return new ti({func:c.NOTEQUAL,mask:255},s,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(s){let c=this.context.gl;return new ti({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(s){let c=this.context.gl,d=s.sort((F,L)=>L.overscaledZ-F.overscaledZ),C=d[d.length-1].overscaledZ,y=d[0].overscaledZ-C+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();let F={};for(let L=0;L<y;L++)F[L+C]=new ti({func:c.GEQUAL,mask:255},L+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=y,[F,d]}return[{[C]:ti.disabled},d]}colorModeForRenderPass(){let s=this.context.gl;return this._showOverdrawInspector?new Dt([s.CONSTANT_COLOR,s.ONE],new n.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Dt.unblended:Dt.alphaBlended}depthModeForSublayer(s,c,d){if(!this.opaquePassEnabledForLayer())return Ce.disabled;let C=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Ce(d||this.context.gl.LEQUAL,c,[C,C])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,c){this.style=s,this.options=c,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(n.h.now()),this.imageManager.beginFrame();let d=this.style._order,C=this.style.sourceCaches,y={},F={},L={};for(let R in C){let N=C[R];N.used&&N.prepare(this.context),y[R]=N.getVisibleCoordinates(),F[R]=y[R].slice().reverse(),L[R]=N.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let R=0;R<d.length;R++)if(this.style._layers[d[R]].is3D()){this.opaquePassCutoff=R;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;let R=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!n.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||R.length)&&(n.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(N,D){let W=N.context,st=W.gl,wt=Dt.unblended,yt=new Ce(st.LEQUAL,Ce.ReadWrite,[0,1]),kt=D.getTerrainMesh(),p=D.sourceCache.getRenderableTiles(),w=N.useProgram("terrainDepth");W.bindFramebuffer.set(D.getFramebuffer("depth").framebuffer),W.viewport.set([0,0,N.width/devicePixelRatio,N.height/devicePixelRatio]),W.clear({color:n.aT.transparent,depth:1});for(let k of p){let T=D.getTerrainData(k.tileID),H={u_matrix:N.transform.calculatePosMatrix(k.tileID.toUnwrapped()),u_ele_delta:D.getMeshFrameDelta(N.transform.zoom)};w.draw(W,st.TRIANGLES,yt,ti.disabled,wt,di.backCCW,H,T,"terrain",kt.vertexBuffer,kt.indexBuffer,kt.segments)}W.bindFramebuffer.set(null),W.viewport.set([0,0,N.width,N.height])}(this,this.style.map.terrain),function(N,D){let W=N.context,st=W.gl,wt=Dt.unblended,yt=new Ce(st.LEQUAL,Ce.ReadWrite,[0,1]),kt=D.getTerrainMesh(),p=D.getCoordsTexture(),w=D.sourceCache.getRenderableTiles(),k=N.useProgram("terrainCoords");W.bindFramebuffer.set(D.getFramebuffer("coords").framebuffer),W.viewport.set([0,0,N.width/devicePixelRatio,N.height/devicePixelRatio]),W.clear({color:n.aT.transparent,depth:1}),D.coordsIndex=[];for(let T of w){let H=D.getTerrainData(T.tileID);W.activeTexture.set(st.TEXTURE0),st.bindTexture(st.TEXTURE_2D,p.texture);let V={u_matrix:N.transform.calculatePosMatrix(T.tileID.toUnwrapped()),u_terrain_coords_id:(255-D.coordsIndex.length)/255,u_texture:0,u_ele_delta:D.getMeshFrameDelta(N.transform.zoom)};k.draw(W,st.TRIANGLES,yt,ti.disabled,wt,di.backCCW,V,H,"terrain",kt.vertexBuffer,kt.indexBuffer,kt.segments),D.coordsIndex.push(T.tileID.key)}W.bindFramebuffer.set(null),W.viewport.set([0,0,N.width,N.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(let R of d){let N=this.style._layers[R];if(!N.hasOffscreenPass()||N.isHidden(this.transform.zoom))continue;let D=F[N.source];(N.type==="custom"||D.length)&&this.renderLayer(this,C[N.source],N,D)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?n.aT.black:n.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){let R=this.style._layers[d[this.currentLayer]],N=C[R.source],D=y[R.source];this._renderTileClippingMasks(R,D),this.renderLayer(this,N,R,D)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){let R=this.style._layers[d[this.currentLayer]],N=C[R.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(R))continue;let D=(R.type==="symbol"?L:F)[R.source];this._renderTileClippingMasks(R,y[R.source]),this.renderLayer(this,N,R,D)}if(this.options.showTileBoundaries){let R=function(N,D){let W=null,st=Object.values(N._layers).flatMap(p=>p.source&&!p.isHidden(D)?[N.sourceCaches[p.source]]:[]),wt=st.filter(p=>p.getSource().type==="vector"),yt=st.filter(p=>p.getSource().type!=="vector"),kt=p=>{(!W||W.getSource().maxzoom<p.getSource().maxzoom)&&(W=p)};return wt.forEach(p=>kt(p)),W||yt.forEach(p=>kt(p)),W}(this.style,this.transform.zoom);R&&function(N,D,W){for(let st=0;st<W.length;st++)xA(N,D,W[st])}(this,R,R.getVisibleCoordinates())}this.options.showPadding&&function(R){let N=R.transform.padding;Zo(R,R.transform.height-(N.top||0),3,Pa),Zo(R,N.bottom||0,3,Ba),ea(R,N.left||0,3,Ma),ea(R,R.transform.width-(N.right||0),3,Va);let D=R.transform.centerPoint;(function(W,st,wt,yt){ia(W,st-1,wt-10,2,20,yt),ia(W,st-10,wt-1,20,2,yt)})(R,D.x,R.transform.height-D.y,ps)}(this),this.context.setDefault()}renderLayer(s,c,d,C){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(C||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(y,F,L,R,N){if(y.renderPass!=="translucent")return;let D=ti.disabled,W=y.colorModeForRenderPass();(L._unevaluatedLayout.hasValue("text-variable-anchor")||L._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(st,wt,yt,kt,p,w,k){let T=wt.transform,H=p==="map",V=w==="map";for(let K of st){let X=kt.getTile(K),$=X.getBucket(yt);if(!$||!$.text||!$.text.segments.get().length)continue;let nt=n.ah($.textSizeData,T.zoom),Ct=Jt(X,1,wt.transform.zoom),zt=Fe(K.posMatrix,V,H,wt.transform,Ct),re=yt.layout.get("icon-text-fit")!=="none"&&$.hasIconData();if(nt){let Tt=Math.pow(2,T.zoom-X.tileID.overscaledZ);en($,H,V,k,T,zt,K.posMatrix,Tt,nt,re,wt.style.map.terrain?(pe,te)=>wt.style.map.terrain.getElevation(K,pe,te):null)}}}(R,y,L,F,L.layout.get("text-rotation-alignment"),L.layout.get("text-pitch-alignment"),N),L.paint.get("icon-opacity").constantOr(1)!==0&&Sn(y,F,L,R,!1,L.paint.get("icon-translate"),L.paint.get("icon-translate-anchor"),L.layout.get("icon-rotation-alignment"),L.layout.get("icon-pitch-alignment"),L.layout.get("icon-keep-upright"),D,W),L.paint.get("text-opacity").constantOr(1)!==0&&Sn(y,F,L,R,!0,L.paint.get("text-translate"),L.paint.get("text-translate-anchor"),L.layout.get("text-rotation-alignment"),L.layout.get("text-pitch-alignment"),L.layout.get("text-keep-upright"),D,W),F.map.showCollisionBoxes&&(cr(y,F,L,R,L.paint.get("text-translate"),L.paint.get("text-translate-anchor"),!0),cr(y,F,L,R,L.paint.get("icon-translate"),L.paint.get("icon-translate-anchor"),!1))})(s,c,d,C,this.style.placement.variableOffsets);break;case"circle":(function(y,F,L,R){if(y.renderPass!=="translucent")return;let N=L.paint.get("circle-opacity"),D=L.paint.get("circle-stroke-width"),W=L.paint.get("circle-stroke-opacity"),st=!L.layout.get("circle-sort-key").isConstant();if(N.constantOr(1)===0&&(D.constantOr(1)===0||W.constantOr(1)===0))return;let wt=y.context,yt=wt.gl,kt=y.depthModeForSublayer(0,Ce.ReadOnly),p=ti.disabled,w=y.colorModeForRenderPass(),k=[];for(let T=0;T<R.length;T++){let H=R[T],V=F.getTile(H),K=V.getBucket(L);if(!K)continue;let X=K.programConfigurations.get(L.id),$=y.useProgram("circle",X),nt=K.layoutVertexBuffer,Ct=K.indexBuffer,zt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(H),re={programConfiguration:X,program:$,layoutVertexBuffer:nt,indexBuffer:Ct,uniformValues:Ee(y,H,V,L),terrainData:zt};if(st){let Tt=K.segments.get();for(let pe of Tt)k.push({segments:new n.S([pe]),sortKey:pe.sortKey,state:re})}else k.push({segments:K.segments,sortKey:0,state:re})}st&&k.sort((T,H)=>T.sortKey-H.sortKey);for(let T of k){let{programConfiguration:H,program:V,layoutVertexBuffer:K,indexBuffer:X,uniformValues:$,terrainData:nt}=T.state;V.draw(wt,yt.TRIANGLES,kt,p,w,di.disabled,$,nt,L.id,K,X,T.segments,L.paint,y.transform.zoom,H)}})(s,c,d,C);break;case"heatmap":(function(y,F,L,R){if(L.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){let N=y.context,D=N.gl,W=ti.disabled,st=new Dt([D.ONE,D.ONE],n.aT.transparent,[!0,!0,!0,!0]);(function(wt,yt,kt){let p=wt.gl;wt.activeTexture.set(p.TEXTURE1),wt.viewport.set([0,0,yt.width/4,yt.height/4]);let w=kt.heatmapFbo;if(w)p.bindTexture(p.TEXTURE_2D,w.colorAttachment.get()),wt.bindFramebuffer.set(w.framebuffer);else{let k=p.createTexture();p.bindTexture(p.TEXTURE_2D,k),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),w=kt.heatmapFbo=wt.createFramebuffer(yt.width/4,yt.height/4,!1,!1),function(T,H,V,K){var X,$;let nt=T.gl,Ct=(X=T.HALF_FLOAT)!==null&&X!==void 0?X:nt.UNSIGNED_BYTE,zt=($=T.RGBA16F)!==null&&$!==void 0?$:nt.RGBA;nt.texImage2D(nt.TEXTURE_2D,0,zt,H.width/4,H.height/4,0,nt.RGBA,Ct,null),K.colorAttachment.set(V)}(wt,yt,k,w)}})(N,y,L),N.clear({color:n.aT.transparent});for(let wt=0;wt<R.length;wt++){let yt=R[wt];if(F.hasRenderableParent(yt))continue;let kt=F.getTile(yt),p=kt.getBucket(L);if(!p)continue;let w=p.programConfigurations.get(L.id),k=y.useProgram("heatmap",w),{zoom:T}=y.transform;k.draw(N,D.TRIANGLES,Ce.disabled,W,st,di.disabled,Te(yt.posMatrix,kt,T,L.paint.get("heatmap-intensity")),null,L.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,L.paint,y.transform.zoom,w)}N.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(N,D){let W=N.context,st=W.gl,wt=D.heatmapFbo;if(!wt)return;W.activeTexture.set(st.TEXTURE0),st.bindTexture(st.TEXTURE_2D,wt.colorAttachment.get()),W.activeTexture.set(st.TEXTURE1);let yt=D.colorRampTexture;yt||(yt=D.colorRampTexture=new dt(W,D.colorRamp,st.RGBA)),yt.bind(st.LINEAR,st.CLAMP_TO_EDGE),N.useProgram("heatmapTexture").draw(W,st.TRIANGLES,Ce.disabled,ti.disabled,N.colorModeForRenderPass(),di.disabled,((kt,p,w,k)=>{let T=n.Z();n.aS(T,0,kt.width,kt.height,0,0,1);let H=kt.context.gl;return{u_matrix:T,u_world:[H.drawingBufferWidth,H.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:p.paint.get("heatmap-opacity")}})(N,D),null,D.id,N.viewportBuffer,N.quadTriangleIndexBuffer,N.viewportSegments,D.paint,N.transform.zoom)}(y,L))})(s,c,d,C);break;case"line":(function(y,F,L,R){if(y.renderPass!=="translucent")return;let N=L.paint.get("line-opacity"),D=L.paint.get("line-width");if(N.constantOr(1)===0||D.constantOr(1)===0)return;let W=y.depthModeForSublayer(0,Ce.ReadOnly),st=y.colorModeForRenderPass(),wt=L.paint.get("line-dasharray"),yt=L.paint.get("line-pattern"),kt=yt.constantOr(1),p=L.paint.get("line-gradient"),w=L.getCrossfadeParameters(),k=kt?"linePattern":wt?"lineSDF":p?"lineGradient":"line",T=y.context,H=T.gl,V=!0;for(let K of R){let X=F.getTile(K);if(kt&&!X.patternsLoaded())continue;let $=X.getBucket(L);if(!$)continue;let nt=$.programConfigurations.get(L.id),Ct=y.context.program.get(),zt=y.useProgram(k,nt),re=V||zt.program!==Ct,Tt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(K),pe=yt.constantOr(null);if(pe&&X.imageAtlas){let Wt=X.imageAtlas,Ie=Wt.patternPositions[pe.to.toString()],we=Wt.patternPositions[pe.from.toString()];Ie&&we&&nt.setConstantPatternPositions(Ie,we)}let te=Tt?K:null,Ot=kt?Je(y,X,L,w,te):wt?Me(y,X,L,wt,w,te):p?Zi(y,X,L,$.lineClipsArray.length,te):Gi(y,X,L,te);if(kt)T.activeTexture.set(H.TEXTURE0),X.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),nt.updatePaintBuffers(w);else if(wt&&(re||y.lineAtlas.dirty))T.activeTexture.set(H.TEXTURE0),y.lineAtlas.bind(T);else if(p){let Wt=$.gradients[L.id],Ie=Wt.texture;if(L.gradientVersion!==Wt.version){let we=256;if(L.stepInterpolant){let Le=F.getSource().maxzoom,je=K.canonical.z===Le?Math.ceil(1<<y.transform.maxZoom-K.canonical.z):1;we=n.ad(n.aY($.maxLineLength/n.N*1024*je),256,T.maxTextureSize)}Wt.gradient=n.aZ({expression:L.gradientExpression(),evaluationKey:"lineProgress",resolution:we,image:Wt.gradient||void 0,clips:$.lineClipsArray}),Wt.texture?Wt.texture.update(Wt.gradient):Wt.texture=new dt(T,Wt.gradient,H.RGBA),Wt.version=L.gradientVersion,Ie=Wt.texture}T.activeTexture.set(H.TEXTURE0),Ie.bind(L.stepInterpolant?H.NEAREST:H.LINEAR,H.CLAMP_TO_EDGE)}zt.draw(T,H.TRIANGLES,W,y.stencilModeForClipping(K),st,di.disabled,Ot,Tt,L.id,$.layoutVertexBuffer,$.indexBuffer,$.segments,L.paint,y.transform.zoom,nt,$.layoutVertexBuffer2),V=!1}})(s,c,d,C);break;case"fill":(function(y,F,L,R){let N=L.paint.get("fill-color"),D=L.paint.get("fill-opacity");if(D.constantOr(1)===0)return;let W=y.colorModeForRenderPass(),st=L.paint.get("fill-pattern"),wt=y.opaquePassEnabledForLayer()&&!st.constantOr(1)&&N.constantOr(n.aT.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===wt){let yt=y.depthModeForSublayer(1,y.renderPass==="opaque"?Ce.ReadWrite:Ce.ReadOnly);ss(y,F,L,R,yt,W,!1)}if(y.renderPass==="translucent"&&L.paint.get("fill-antialias")){let yt=y.depthModeForSublayer(L.getPaintProperty("fill-outline-color")?2:0,Ce.ReadOnly);ss(y,F,L,R,yt,W,!0)}})(s,c,d,C);break;case"fill-extrusion":(function(y,F,L,R){let N=L.paint.get("fill-extrusion-opacity");if(N!==0&&y.renderPass==="translucent"){let D=new Ce(y.context.gl.LEQUAL,Ce.ReadWrite,y.depthRangeFor3D);if(N!==1||L.paint.get("fill-extrusion-pattern").constantOr(1))Rs(y,F,L,R,D,ti.disabled,Dt.disabled),Rs(y,F,L,R,D,y.stencilModeFor3D(),y.colorModeForRenderPass());else{let W=y.colorModeForRenderPass();Rs(y,F,L,R,D,ti.disabled,W)}}})(s,c,d,C);break;case"hillshade":(function(y,F,L,R){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;let N=y.context,D=y.depthModeForSublayer(0,Ce.ReadOnly),W=y.colorModeForRenderPass(),[st,wt]=y.renderPass==="translucent"?y.stencilConfigForOverlap(R):[{},R];for(let yt of wt){let kt=F.getTile(yt);kt.needsHillshadePrepare!==void 0&&kt.needsHillshadePrepare&&y.renderPass==="offscreen"?Na(y,kt,L,D,ti.disabled,W):y.renderPass==="translucent"&&Fl(y,yt,kt,L,D,st[yt.overscaledZ],W)}N.viewport.set([0,0,y.width,y.height])})(s,c,d,C);break;case"raster":(function(y,F,L,R){if(y.renderPass!=="translucent"||L.paint.get("raster-opacity")===0||!R.length)return;let N=y.context,D=N.gl,W=F.getSource(),st=y.useProgram("raster"),wt=y.colorModeForRenderPass(),[yt,kt]=W instanceof me?[{},R]:y.stencilConfigForOverlap(R),p=kt[kt.length-1].overscaledZ,w=!y.options.moving;for(let k of kt){let T=y.depthModeForSublayer(k.overscaledZ-p,L.paint.get("raster-opacity")===1?Ce.ReadWrite:Ce.ReadOnly,D.LESS),H=F.getTile(k);H.registerFadeDuration(L.paint.get("raster-fade-duration"));let V=F.findLoadedParent(k,0),K=$A(H,V,F,L,y.transform,y.style.map.terrain),X,$,nt=L.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;N.activeTexture.set(D.TEXTURE0),H.texture.bind(nt,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),N.activeTexture.set(D.TEXTURE1),V?(V.texture.bind(nt,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),X=Math.pow(2,V.tileID.overscaledZ-H.tileID.overscaledZ),$=[H.tileID.canonical.x*X%1,H.tileID.canonical.y*X%1]):H.texture.bind(nt,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST);let Ct=y.style.map.terrain&&y.style.map.terrain.getTerrainData(k),zt=Ct?k:null,re=zt?zt.posMatrix:y.transform.calculatePosMatrix(k.toUnwrapped(),w),Tt=Xi(re,$||[0,0],X||1,K,L);W instanceof me?st.draw(N,D.TRIANGLES,T,ti.disabled,wt,di.disabled,Tt,Ct,L.id,W.boundsBuffer,y.quadTriangleIndexBuffer,W.boundsSegments):st.draw(N,D.TRIANGLES,T,yt[k.overscaledZ],wt,di.disabled,Tt,Ct,L.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(s,c,d,C);break;case"background":(function(y,F,L,R){let N=L.paint.get("background-color"),D=L.paint.get("background-opacity");if(D===0)return;let W=y.context,st=W.gl,wt=y.transform,yt=wt.tileSize,kt=L.paint.get("background-pattern");if(y.isPatternMissing(kt))return;let p=!kt&&N.a===1&&D===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==p)return;let w=ti.disabled,k=y.depthModeForSublayer(0,p==="opaque"?Ce.ReadWrite:Ce.ReadOnly),T=y.colorModeForRenderPass(),H=y.useProgram(kt?"backgroundPattern":"background"),V=R||wt.coveringTiles({tileSize:yt,terrain:y.style.map.terrain});kt&&(W.activeTexture.set(st.TEXTURE0),y.imageManager.bind(y.context));let K=L.getCrossfadeParameters();for(let X of V){let $=R?X.posMatrix:y.transform.calculatePosMatrix(X.toUnwrapped()),nt=kt?tn($,D,y,kt,{tileID:X,tileSize:yt},K):Mr($,D,N),Ct=y.style.map.terrain&&y.style.map.terrain.getTerrainData(X);H.draw(W,st.TRIANGLES,k,w,T,di.disabled,nt,Ct,L.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(s,0,d,C);break;case"custom":(function(y,F,L){let R=y.context,N=L.implementation;if(y.renderPass==="offscreen"){let D=N.prerender;D&&(y.setCustomLayerDefaults(),R.setColorMode(y.colorModeForRenderPass()),D.call(N,R.gl,y.transform.customLayerMatrix()),R.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),R.setColorMode(y.colorModeForRenderPass()),R.setStencilMode(ti.disabled);let D=N.renderingMode==="3d"?new Ce(y.context.gl.LEQUAL,Ce.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,Ce.ReadOnly);R.setDepthMode(D),N.render(R.gl,y.transform.customLayerMatrix()),R.setDirty(),y.setBaseState(),R.bindFramebuffer.set(null)}})(s,0,d)}}translatePosMatrix(s,c,d,C,y){if(!d[0]&&!d[1])return s;let F=y?C==="map"?this.transform.angle:0:C==="viewport"?-this.transform.angle:0;if(F){let N=Math.sin(F),D=Math.cos(F);d=[d[0]*D-d[1]*N,d[0]*N+d[1]*D]}let L=[y?d[0]:Jt(c,d[0],this.transform.zoom),y?d[1]:Jt(c,d[1],this.transform.zoom),0],R=new Float32Array(16);return n.$(R,s,L),R}saveTileTexture(s){let c=this._tileTextures[s.size[0]];c?c.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){let c=this._tileTextures[s];return c&&c.length>0?c.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;let c=this.imageManager.getPattern(s.from.toString()),d=this.imageManager.getPattern(s.to.toString());return!c||!d}useProgram(s,c){this.cache=this.cache||{};let d=s+(c?c.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new pt(this.context,Hr[s],c,En[s],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new dt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:s,drawingBufferHeight:c}=this.context.gl;return this.width!==s||this.height!==c}}class Tn{constructor(s,c){this.points=s,this.planes=c}static fromInvProjectionMatrix(s,c,d){let C=Math.pow(2,d),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(L=>{let R=1/(L=n.ag([],L,s))[3]/c*C;return n.b3(L,L,[R,R,1/L[3],R])}),F=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(L=>{let R=function(st,wt){var yt=wt[0],kt=wt[1],p=wt[2],w=yt*yt+kt*kt+p*p;return w>0&&(w=1/Math.sqrt(w)),st[0]=wt[0]*w,st[1]=wt[1]*w,st[2]=wt[2]*w,st}([],function(st,wt,yt){var kt=wt[0],p=wt[1],w=wt[2],k=yt[0],T=yt[1],H=yt[2];return st[0]=p*H-w*T,st[1]=w*k-kt*H,st[2]=kt*T-p*k,st}([],Et([],y[L[0]],y[L[1]]),Et([],y[L[2]],y[L[1]]))),N=-((D=R)[0]*(W=y[L[1]])[0]+D[1]*W[1]+D[2]*W[2]);var D,W;return R.concat(N)});return new Tn(y,F)}}class na{constructor(s,c){this.min=s,this.max=c,this.center=function(d,C,y){return d[0]=.5*C[0],d[1]=.5*C[1],d[2]=.5*C[2],d}([],function(d,C,y){return d[0]=C[0]+y[0],d[1]=C[1]+y[1],d[2]=C[2]+y[2],d}([],this.min,this.max))}quadrant(s){let c=[s%2==0,s<2],d=rt(this.min),C=rt(this.max);for(let y=0;y<c.length;y++)d[y]=c[y]?this.min[y]:this.center[y],C[y]=c[y]?this.center[y]:this.max[y];return C[2]=this.max[2],new na(d,C)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersects(s){let c=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],d=!0;for(let C=0;C<s.planes.length;C++){let y=s.planes[C],F=0;for(let L=0;L<c.length;L++)n.b4(y,c[L])>=0&&F++;if(F===0)return 0;F!==c.length&&(d=!1)}if(d)return 2;for(let C=0;C<3;C++){let y=Number.MAX_VALUE,F=-Number.MAX_VALUE;for(let L=0;L<s.points.length;L++){let R=s.points[L][C]-this.min[C];y=Math.min(y,R),F=Math.max(F,R)}if(F<0||y>this.max[C]-this.min[C])return 0}return 1}}class fs{constructor(s=0,c=0,d=0,C=0){if(isNaN(s)||s<0||isNaN(c)||c<0||isNaN(d)||d<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=c,this.left=d,this.right=C}interpolate(s,c,d){return c.top!=null&&s.top!=null&&(this.top=n.B.number(s.top,c.top,d)),c.bottom!=null&&s.bottom!=null&&(this.bottom=n.B.number(s.bottom,c.bottom,d)),c.left!=null&&s.left!=null&&(this.left=n.B.number(s.left,c.left,d)),c.right!=null&&s.right!=null&&(this.right=n.B.number(s.right,c.right,d)),this}getCenter(s,c){let d=n.ad((this.left+s-this.right)/2,0,s),C=n.ad((this.top+c-this.bottom)/2,0,c);return new n.P(d,C)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new fs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class _a{constructor(s,c,d,C,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=y===void 0||!!y,this._minZoom=s||0,this._maxZoom=c||22,this._minPitch=d??0,this._maxPitch=C??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new n.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fs,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){let s=new _a(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.apply(this),s}apply(s){this.tileSize=s.tileSize,this.latRange=s.latRange,this.width=s.width,this.height=s.height,this._center=s._center,this._elevation=s._elevation,this._minEleveationForCurrentTile=s._minEleveationForCurrentTile,this.zoom=s.zoom,this.angle=s.angle,this._fov=s._fov,this._pitch=s._pitch,this._unmodified=s._unmodified,this._edgeInsets=s._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new n.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){let c=-n.b5(s,-180,180)*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=function(){var d=new n.A(4);return n.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,C,y){var F=C[0],L=C[1],R=C[2],N=C[3],D=Math.sin(y),W=Math.cos(y);d[0]=F*W+R*D,d[1]=L*W+N*D,d[2]=F*-D+R*W,d[3]=L*-D+N*W}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){let c=n.ad(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(s){let c=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._zoom=c,this.tileZoom=Math.max(0,Math.floor(c)),this.scale=this.zoomScale(c),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,c,d){this._unmodified=!1,this._edgeInsets.interpolate(s,c,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){let c=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(s){let c=[new n.b6(0,s)];if(this._renderWorldCopies){let d=this.pointCoordinate(new n.P(0,0)),C=this.pointCoordinate(new n.P(this.width,0)),y=this.pointCoordinate(new n.P(this.width,this.height)),F=this.pointCoordinate(new n.P(0,this.height)),L=Math.floor(Math.min(d.x,C.x,y.x,F.x)),R=Math.floor(Math.max(d.x,C.x,y.x,F.x)),N=1;for(let D=L-N;D<=R+N;D++)D!==0&&c.push(new n.b6(D,s))}return c}coveringTiles(s){var c,d;let C=this.coveringZoomLevel(s),y=C;if(s.minzoom!==void 0&&C<s.minzoom)return[];s.maxzoom!==void 0&&C>s.maxzoom&&(C=s.maxzoom);let F=this.pointCoordinate(this.getCameraPoint()),L=n.U.fromLngLat(this.center),R=Math.pow(2,C),N=[R*F.x,R*F.y,0],D=[R*L.x,R*L.y,0],W=Tn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,C),st=s.minzoom||0;!s.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(st=C);let wt=s.terrain?2/Math.min(this.tileSize,s.tileSize)*this.tileSize:3,yt=T=>({aabb:new na([T*R,0,0],[(T+1)*R,R,0]),zoom:0,x:0,y:0,wrap:T,fullyVisible:!1}),kt=[],p=[],w=C,k=s.reparseOverscaled?y:C;if(this._renderWorldCopies)for(let T=1;T<=3;T++)kt.push(yt(-T)),kt.push(yt(T));for(kt.push(yt(0));kt.length>0;){let T=kt.pop(),H=T.x,V=T.y,K=T.fullyVisible;if(!K){let zt=T.aabb.intersects(W);if(zt===0)continue;K=zt===2}let X=s.terrain?N:D,$=T.aabb.distanceX(X),nt=T.aabb.distanceY(X),Ct=Math.max(Math.abs($),Math.abs(nt));if(T.zoom===w||Ct>wt+(1<<w-T.zoom)-2&&T.zoom>=st){let zt=w-T.zoom,re=N[0]-.5-(H<<zt),Tt=N[1]-.5-(V<<zt);p.push({tileID:new n.O(T.zoom===w?k:T.zoom,T.wrap,T.zoom,H,V),distanceSq:Pt([D[0]-.5-H,D[1]-.5-V]),tileDistanceToCamera:Math.sqrt(re*re+Tt*Tt)})}else for(let zt=0;zt<4;zt++){let re=(H<<1)+zt%2,Tt=(V<<1)+(zt>>1),pe=T.zoom+1,te=T.aabb.quadrant(zt);if(s.terrain){let Ot=new n.O(pe,T.wrap,pe,re,Tt),Wt=s.terrain.getMinMaxElevation(Ot),Ie=(c=Wt.minElevation)!==null&&c!==void 0?c:this.elevation,we=(d=Wt.maxElevation)!==null&&d!==void 0?d:this.elevation;te=new na([te.min[0],te.min[1],Ie],[te.max[0],te.max[1],we])}kt.push({aabb:te,zoom:pe,x:re,y:Tt,wrap:T.wrap,fullyVisible:K})}}return p.sort((T,H)=>T.distanceSq-H.distanceSq).map(T=>T.tileID)}resize(s,c){this.width=s,this.height=c,this.pixelsToGLUnits=[2/s,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){let c=n.ad(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new n.P(n.G(s.lng)*this.worldSize,n.H(c)*this.worldSize)}unproject(s){return new n.U(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(s){let c=this.pointLocation(this.centerPoint,s),d=s.getElevationForLngLatZoom(c,this.tileZoom);if(!(this.elevation-d))return;let C=this.getCameraPosition(),y=n.U.fromLngLat(C.lngLat,C.altitude),F=n.U.fromLngLat(c,d),L=y.x-F.x,R=y.y-F.y,N=y.z-F.z,D=Math.sqrt(L*L+R*R+N*N),W=this.scaleZoom(this.cameraToCenterDistance/D/this.tileSize);this._elevation=d,this._center=c,this.zoom=W}setLocationAtPoint(s,c){let d=this.pointCoordinate(c),C=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(s),F=new n.U(y.x-(d.x-C.x),y.y-(d.y-C.y));this.center=this.coordinateLocation(F),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s,c){return c?this.coordinatePoint(this.locationCoordinate(s),c.getElevationForLngLatZoom(s,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(s))}pointLocation(s,c){return this.coordinateLocation(this.pointCoordinate(s,c))}locationCoordinate(s){return n.U.fromLngLat(s)}coordinateLocation(s){return s&&s.toLngLat()}pointCoordinate(s,c){if(c){let st=c.pointCoordinate(s);if(st!=null)return st}let d=[s.x,s.y,0,1],C=[s.x,s.y,1,1];n.ag(d,d,this.pixelMatrixInverse),n.ag(C,C,this.pixelMatrixInverse);let y=d[3],F=C[3],L=d[1]/y,R=C[1]/F,N=d[2]/y,D=C[2]/F,W=N===D?0:(0-N)/(D-N);return new n.U(n.B.number(d[0]/y,C[0]/F,W)/this.worldSize,n.B.number(L,R,W)/this.worldSize)}coordinatePoint(s,c=0,d=this.pixelMatrix){let C=[s.x*this.worldSize,s.y*this.worldSize,c,1];return n.ag(C,C,d),new n.P(C[0]/C[3],C[1]/C[3])}getBounds(){let s=Math.max(0,this.height/2-this.getHorizon());return new fe().extend(this.pointLocation(new n.P(0,s))).extend(this.pointLocation(new n.P(this.width,s))).extend(this.pointLocation(new n.P(this.width,this.height))).extend(this.pointLocation(new n.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new fe([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(s,c=!1){let d=s.key,C=c?this._alignedPosMatrixCache:this._posMatrixCache;if(C[d])return C[d];let y=s.canonical,F=this.worldSize/this.zoomScale(y.z),L=y.x+Math.pow(2,y.z)*s.wrap,R=n.ao(new Float64Array(16));return n.$(R,R,[L*F,y.y*F,0]),n.a0(R,R,[F/n.N,F/n.N,1]),n.a1(R,c?this.alignedProjMatrix:this.projMatrix,R),C[d]=new Float32Array(R),C[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let s,c,d,C,y=-90,F=90,L=-180,R=180,N=this.size,D=this._unmodified;if(this.latRange){let wt=this.latRange;y=n.H(wt[1])*this.worldSize,F=n.H(wt[0])*this.worldSize,s=F-y<N.y?N.y/(F-y):0}if(this.lngRange){let wt=this.lngRange;L=n.b5(n.G(wt[0])*this.worldSize,0,this.worldSize),R=n.b5(n.G(wt[1])*this.worldSize,0,this.worldSize),R<L&&(R+=this.worldSize),c=R-L<N.x?N.x/(R-L):0}let W=this.point,st=Math.max(c||0,s||0);if(st)return this.center=this.unproject(new n.P(c?(R+L)/2:W.x,s?(F+y)/2:W.y)),this.zoom+=this.scaleZoom(st),this._unmodified=D,void(this._constraining=!1);if(this.latRange){let wt=W.y,yt=N.y/2;wt-yt<y&&(C=y+yt),wt+yt>F&&(C=F-yt)}if(this.lngRange){let wt=(L+R)/2,yt=n.b5(W.x,wt-this.worldSize/2,wt+this.worldSize/2),kt=N.x/2;yt-kt<L&&(d=L+kt),yt+kt>R&&(d=R-kt)}d===void 0&&C===void 0||(this.center=this.unproject(new n.P(d!==void 0?d:W.x,C!==void 0?C:W.y)).wrap()),this._unmodified=D,this._constraining=!1}_calcMatrices(){if(!this.height)return;let s=this.centerOffset,c=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=n.b7(1,this.center.lat)*this.worldSize;let C=n.ao(new Float64Array(16));n.a0(C,C,[this.width/2,-this.height/2,1]),n.$(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=n.ao(new Float64Array(16)),n.a0(C,C,[1,-1,1]),n.$(C,C,[-1,-1,0]),n.a0(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C;let y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),F=Math.min(this.elevation,this._minEleveationForCurrentTile),L=y-F*this._pixelPerMeter/Math.cos(this._pitch),R=F<0?L:y,N=Math.PI/2+this._pitch,D=this._fov*(.5+s.y/this.height),W=Math.sin(D)*R/Math.sin(n.ad(Math.PI-N-D,.01,Math.PI-.01)),st=this.getHorizon(),wt=2*Math.atan(st/this.cameraToCenterDistance)*(.5+s.y/(2*st)),yt=Math.sin(wt)*R/Math.sin(n.ad(Math.PI-N-wt,.01,Math.PI-.01)),kt=Math.min(W,yt),p=1.01*(Math.cos(Math.PI/2-this._pitch)*kt+R),w=this.height/50;C=new Float64Array(16),n.b8(C,this._fov,this.width/this.height,w,p),C[8]=2*-s.x/this.width,C[9]=2*s.y/this.height,n.a0(C,C,[1,-1,1]),n.$(C,C,[0,0,-this.cameraToCenterDistance]),n.b9(C,C,this._pitch),n.ae(C,C,this.angle),n.$(C,C,[-c,-d,0]),this.mercatorMatrix=n.a0([],C,[this.worldSize,this.worldSize,this.worldSize]),n.a0(C,C,[1,1,this._pixelPerMeter]),this.pixelMatrix=n.a1(new Float64Array(16),this.labelPlaneMatrix,C),n.$(C,C,[0,0,-this.elevation]),this.projMatrix=C,this.invProjMatrix=n.as([],C),this.pixelMatrix3D=n.a1(new Float64Array(16),this.labelPlaneMatrix,C);let k=this.width%2/2,T=this.height%2/2,H=Math.cos(this.angle),V=Math.sin(this.angle),K=c-Math.round(c)+H*k+V*T,X=d-Math.round(d)+H*T+V*k,$=new Float64Array(C);if(n.$($,$,[K>.5?K-1:K,X>.5?X-1:X,0]),this.alignedProjMatrix=$,C=n.as(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");this.pixelMatrixInverse=C,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let s=this.pointCoordinate(new n.P(0,0)),c=[s.x*this.worldSize,s.y*this.worldSize,0,1];return n.ag(c,c,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new n.P(0,s))}getCameraQueryGeometry(s){let c=this.getCameraPoint();if(s.length===1)return[s[0],c];{let d=c.x,C=c.y,y=c.x,F=c.y;for(let L of s)d=Math.min(d,L.x),C=Math.min(C,L.y),y=Math.max(y,L.x),F=Math.max(F,L.y);return[new n.P(d,C),new n.P(y,C),new n.P(y,F),new n.P(d,F),new n.P(d,C)]}}}function sa(I,s){let c,d=!1,C=null,y=null,F=()=>{C=null,d&&(I.apply(y,c),C=setTimeout(F,s),d=!1)};return(...L)=>(d=!0,y=this,c=L,C||F(),C)}class Da{constructor(s){this._getCurrentHash=()=>{let c=window.location.hash.replace("#","");if(this._hashName){let d;return c.split("&").map(C=>C.split("=")).forEach(C=>{C[0]===this._hashName&&(d=C)}),(d&&d[1]||"").split("/")}return c.split("/")},this._onHashChange=()=>{let c=this._getCurrentHash();if(c.length>=3&&!c.some(d=>isNaN(d))){let d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:d,pitch:+(c[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{let c=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,c)}catch{}},this._updateHash=sa(this._updateHashUnthrottled,300),this._hashName=s&&encodeURIComponent(s)}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){let c=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,C=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,C),F=Math.round(c.lng*y)/y,L=Math.round(c.lat*y)/y,R=this._map.getBearing(),N=this._map.getPitch(),D="";if(D+=s?`/${F}/${L}/${d}`:`${d}/${L}/${F}`,(R||N)&&(D+="/"+Math.round(10*R)/10),N&&(D+=`/${Math.round(N)}`),this._hashName){let W=this._hashName,st=!1,wt=window.location.hash.slice(1).split("&").map(yt=>{let kt=yt.split("=")[0];return kt===W?(st=!0,`${kt}=${D}`):yt}).filter(yt=>yt);return st||wt.push(`${W}=${D}`),`#${wt.join("&")}`}return`#${D}`}}let Zs={linearity:.3,easing:n.ba(0,0,.3,1)},Hs=n.e({deceleration:2500,maxSpeed:1400},Zs),Ys=n.e({deceleration:20,maxSpeed:1400},Zs),oa=n.e({deceleration:1e3,maxSpeed:360},Zs),fo=n.e({deceleration:1e3,maxSpeed:90},Zs);class Ho{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:n.h.now(),settings:s})}_drainInertiaBuffer(){let s=this._inertiaBuffer,c=n.h.now();for(;s.length>0&&c-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let c={zoom:0,bearing:0,pitch:0,pan:new n.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:y}of this._inertiaBuffer)c.zoom+=y.zoomDelta||0,c.bearing+=y.bearingDelta||0,c.pitch+=y.pitchDelta||0,y.panDelta&&c.pan._add(y.panDelta),y.around&&(c.around=y.around),y.pinchAround&&(c.pinchAround=y.pinchAround);let d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(c.pan.mag()){let y=Cs(c.pan.mag(),d,n.e({},Hs,s||{}));C.offset=c.pan.mult(y.amount/c.pan.mag()),C.center=this._map.transform.center,ms(C,y)}if(c.zoom){let y=Cs(c.zoom,d,Ys);C.zoom=this._map.transform.zoom+y.amount,ms(C,y)}if(c.bearing){let y=Cs(c.bearing,d,oa);C.bearing=this._map.transform.bearing+n.ad(y.amount,-179,179),ms(C,y)}if(c.pitch){let y=Cs(c.pitch,d,fo);C.pitch=this._map.transform.pitch+y.amount,ms(C,y)}if(C.zoom||C.bearing){let y=c.pinchAround===void 0?c.around:c.pinchAround;C.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),n.e(C,{noMoveStart:!0})}}function ms(I,s){(!I.duration||I.duration<s.duration)&&(I.duration=s.duration,I.easing=s.easing)}function Cs(I,s,c){let{maxSpeed:d,linearity:C,deceleration:y}=c,F=n.ad(I*C/(s/1e3),-d,d),L=Math.abs(F)/(y*C);return{easing:c.easing,duration:1e3*L,amount:F*(L/2)}}class Qn extends n.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,d,C={}){let y=h.mousePos(c.getCanvasContainer(),d),F=c.unproject(y);super(s,n.e({point:y,lngLat:F,originalEvent:d},C)),this._defaultPrevented=!1,this.target=c}}class aa extends n.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,d){let C=s==="touchend"?d.changedTouches:d.touches,y=h.touchPos(c.getCanvasContainer(),C),F=y.map(R=>c.unproject(R)),L=y.reduce((R,N,D,W)=>R.add(N.div(W.length)),new n.P(0,0));super(s,{points:y,point:L,lngLats:F,lngLat:c.unproject(L),originalEvent:d}),this._defaultPrevented=!1}}class Aa extends n.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,d){super(s,{originalEvent:d}),this._defaultPrevented=!1}}class js{constructor(s,c){this._map=s,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Aa(s.type,this._map,s))}mousedown(s,c){return this._mousedownPos=c,this._firePreventable(new Qn(s.type,this._map,s))}mouseup(s){this._map.fire(new Qn(s.type,this._map,s))}click(s,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||this._map.fire(new Qn(s.type,this._map,s))}dblclick(s){return this._firePreventable(new Qn(s.type,this._map,s))}mouseover(s){this._map.fire(new Qn(s.type,this._map,s))}mouseout(s){this._map.fire(new Qn(s.type,this._map,s))}touchstart(s){return this._firePreventable(new aa(s.type,this._map,s))}touchmove(s){this._map.fire(new aa(s.type,this._map,s))}touchend(s){this._map.fire(new aa(s.type,this._map,s))}touchcancel(s){this._map.fire(new aa(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class No{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new Qn(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Qn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new Qn(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Is{constructor(s){this._map=s}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(s){return this.transform.pointLocation(n.P.convert(s),this._map.terrain)}}class Ka{constructor(s,c){this._map=s,this._tr=new Is(s),this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,c){this.isEnabled()&&s.shiftKey&&s.button===0&&(h.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(s,c){if(!this._active)return;let d=c;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;let C=this._startPos;this._lastPos=d,this._box||(this._box=h.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",s));let y=Math.min(C.x,d.x),F=Math.max(C.x,d.x),L=Math.min(C.y,d.y),R=Math.max(C.y,d.y);h.setTransform(this._box,`translate(${y}px,${L}px)`),this._box.style.width=F-y+"px",this._box.style.height=R-L+"px"}mouseupWindow(s,c){if(!this._active||s.button!==0)return;let d=this._startPos,C=c;if(this.reset(),h.suppressClick(),d.x!==C.x||d.y!==C.y)return this._map.fire(new n.k("boxzoomend",{originalEvent:s})),{cameraAnimation:y=>y.fitScreenCoordinates(d,C,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(h.remove(this._box),this._box=null),h.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,c){return this._map.fire(new n.k(s,{originalEvent:c}))}}function Un(I,s){if(I.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${I.length}, points ${s.length}`);let c={};for(let d=0;d<I.length;d++)c[I[d].identifier]=s[d];return c}class os{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,c,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),d.length===this.numTouches&&(this.centroid=function(C){let y=new n.P(0,0);for(let F of C)y._add(F);return y.div(C.length)}(c),this.touches=Un(d,c)))}touchmove(s,c,d){if(this.aborted||!this.centroid)return;let C=Un(d,c);for(let y in this.touches){let F=C[y];(!F||F.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(s,c,d){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){let C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class xa{constructor(s){this.singleTap=new os(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,c,d){this.singleTap.touchstart(s,c,d)}touchmove(s,c,d){this.singleTap.touchmove(s,c,d)}touchend(s,c,d){let C=this.singleTap.touchend(s,c,d);if(C){let y=s.timeStamp-this.lastTime<500,F=!this.lastTap||this.lastTap.dist(C)<30;if(y&&F||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class wn{constructor(s){this._tr=new Is(s),this._zoomIn=new xa({numTouches:1,numTaps:2}),this._zoomOut=new xa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,c,d){this._zoomIn.touchstart(s,c,d),this._zoomOut.touchstart(s,c,d)}touchmove(s,c,d){this._zoomIn.touchmove(s,c,d),this._zoomOut.touchmove(s,c,d)}touchend(s,c,d){let C=this._zoomIn.touchend(s,c,d),y=this._zoomOut.touchend(s,c,d),F=this._tr;return C?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:F.zoom+1,around:F.unproject(C)},{originalEvent:s})}):y?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:F.zoom-1,around:F.unproject(y)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vn{constructor(s){this._enabled=!!s.enable,this._moveStateManager=s.moveStateManager,this._clickTolerance=s.clickTolerance||1,this._moveFunction=s.move,this._activateOnStart=!!s.activateOnStart,s.assignEvents(this),this.reset()}reset(s){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(s)}_move(...s){let c=this._moveFunction(...s);if(c.bearingDelta||c.pitchDelta||c.around||c.panDelta)return this._active=!0,c}dragStart(s,c){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(s)&&(this._moveStateManager.startMove(s),this._lastPoint=c.length?c[0]:c,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(s,c){if(!this.isEnabled())return;let d=this._lastPoint;if(!d)return;if(s.preventDefault(),!this._moveStateManager.isValidMoveEvent(s))return void this.reset(s);let C=c.length?c[0]:c;return!this._moved&&C.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=C,this._move(d,C))}dragEnd(s){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(s)&&(this._moved&&h.suppressClick(),this.reset(s))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let Xr={0:1,2:2};class Vr{constructor(s){this._correctEvent=s.checkCorrectEvent}startMove(s){let c=h.mouseButton(s);this._eventButton=c}endMove(s){delete this._eventButton}isValidStartEvent(s){return this._correctEvent(s)}isValidMoveEvent(s){return!function(c,d){let C=Xr[d];return c.buttons===void 0||(c.buttons&C)!==C}(s,this._eventButton)}isValidEndEvent(s){return h.mouseButton(s)===this._eventButton}}class fn{constructor(){this._firstTouch=void 0}_isOneFingerTouch(s){return s.targetTouches.length===1}_isSameTouchEvent(s){return s.targetTouches[0].identifier===this._firstTouch}startMove(s){this._firstTouch=s.targetTouches[0].identifier}endMove(s){delete this._firstTouch}isValidStartEvent(s){return this._isOneFingerTouch(s)}isValidMoveEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}isValidEndEvent(s){return this._isOneFingerTouch(s)&&this._isSameTouchEvent(s)}}let mn=I=>{I.mousedown=I.dragStart,I.mousemoveWindow=I.dragMove,I.mouseup=I.dragEnd,I.contextmenu=function(s){s.preventDefault()}},Bs=({enable:I,clickTolerance:s,bearingDegreesPerPixelMoved:c=.8})=>{let d=new Vr({checkCorrectEvent:C=>h.mouseButton(C)===0&&C.ctrlKey||h.mouseButton(C)===2});return new Vn({clickTolerance:s,move:(C,y)=>({bearingDelta:(y.x-C.x)*c}),moveStateManager:d,enable:I,assignEvents:mn})},as=({enable:I,clickTolerance:s,pitchDegreesPerPixelMoved:c=-.5})=>{let d=new Vr({checkCorrectEvent:C=>h.mouseButton(C)===0&&C.ctrlKey||h.mouseButton(C)===2});return new Vn({clickTolerance:s,move:(C,y)=>({pitchDelta:(y.y-C.y)*c}),moveStateManager:d,enable:I,assignEvents:mn})};class li{constructor(s,c){this._minTouches=s.cooperativeGestures?2:1,this._clickTolerance=s.clickTolerance||1,this._map=c,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new n.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(s,c,d){return this._calculateTransform(s,c,d)}touchmove(s,c,d){if(this._map._cooperativeGestures&&(this._minTouches===2&&d.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(s,!1,d.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(d.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,c,d)}touchend(s,c,d){this._calculateTransform(s,c,d),this._active&&d.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,c,d){d.length>0&&(this._active=!0);let C=Un(d,c),y=new n.P(0,0),F=new n.P(0,0),L=0;for(let N in C){let D=C[N],W=this._touches[N];W&&(y._add(D),F._add(D.sub(W)),L++,C[N]=D)}if(this._touches=C,L<this._minTouches||!F.mag())return;let R=F.div(L);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(L),panDelta:R}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(s,c,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([c[0],c[1]]))}touchmove(s,c,d){if(!this._firstTwoTouches)return;s.preventDefault();let[C,y]=this._firstTwoTouches,F=la(d,c,C),L=la(d,c,y);if(!F||!L)return;let R=this._aroundCenter?null:F.add(L).div(2);return this._move([F,L],R,s)}touchend(s,c,d){if(!this._firstTwoTouches)return;let[C,y]=this._firstTwoTouches,F=la(d,c,C),L=la(d,c,y);F&&L||(this._active&&h.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function la(I,s,c){for(let d=0;d<I.length;d++)if(I[d].identifier===c)return s[d]}function Wa(I,s){return Math.log(I/s)/Math.LN2}class yc extends Oa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,c){let d=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(Wa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wa(this._distance,d),pinchAround:c}}}function ai(I,s){return 180*I.angleWith(s)/Math.PI}class kl extends Oa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,c){let d=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ai(this._vector,d),pinchAround:c}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());let c=25/(Math.PI*this._minDiameter)*360,d=ai(s,this._startVector);return Math.abs(d)<c}}function Ll(I){return Math.abs(I.y)>Math.abs(I.x)}class bc extends Oa{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,c,d){super.touchstart(s,c,d),this._currentTouchCount=d.length}_start(s){this._lastPoints=s,Ll(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,c,d){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;let C=s[0].sub(this._lastPoints[0]),y=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(C,y,d.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(C.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(s,c,d){if(this._valid!==void 0)return this._valid;let C=s.mag()>=2,y=c.mag()>=2;if(!C&&!y)return;if(!C||!y)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;let F=s.y>0==c.y>0;return Ll(s)&&Ll(c)&&F}}let SA={panStep:100,bearingStep:15,pitchStep:10};class _s{constructor(s){this._tr=new Is(s);let c=SA;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let c=0,d=0,C=0,y=0,F=0;switch(s.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:s.shiftKey?d=-1:(s.preventDefault(),y=-1);break;case 39:s.shiftKey?d=1:(s.preventDefault(),y=1);break;case 38:s.shiftKey?C=1:(s.preventDefault(),F=-1);break;case 40:s.shiftKey?C=-1:(s.preventDefault(),F=1);break;default:return}return this._rotationDisabled&&(d=0,C=0),{cameraAnimation:L=>{let R=this._tr;L.easeTo({duration:300,easeId:"keyboardHandler",easing:Ns,zoom:c?Math.round(R.zoom)+c*(s.shiftKey?2:1):R.zoom,bearing:R.bearing+d*this._bearingStep,pitch:R.pitch+C*this._pitchStep,offset:[-y*this._panStep,-F*this._panStep],center:R.center},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ns(I){return I*(2-I)}let tl=4.000244140625;class El{constructor(s,c){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=s,this._tr=new Is(s),this._el=s.getCanvasContainer(),this._triggerRenderFrame=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!s[this._map._metaKey])return;s.preventDefault()}let c=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY,d=n.h.now(),C=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,c!==0&&c%tl==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(C*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),s.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=s,this._delta-=c,this._active||this._start(s)),s.preventDefault()}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let c=h.mousePos(this._el,s),d=this._tr;this._around=n.L.convert(this._aroundCenter?d.center:d.unproject(c)),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let s=this._tr.transform;if(this._delta!==0){let L=this._type==="wheel"&&Math.abs(this._delta)>tl?this._wheelZoomRate:this._defaultZoomRate,R=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&R!==0&&(R=1/R);let N=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(N*R))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let c=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,d=this._startZoom,C=this._easing,y,F=!1;if(this._type==="wheel"&&d&&C){let L=Math.min((n.h.now()-this._lastWheelEventTime)/200,1),R=C(L);y=n.B.number(d,c,R),L<1?this._frameId||(this._frameId=!0):F=!0}else y=c,F=!0;return this._active=!0,F&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!F,zoomDelta:y-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let c=n.bb;if(this._prevEase){let d=this._prevEase,C=(n.h.now()-d.start)/d.duration,y=d.easing(C+.01)-d.easing(C),F=.27/Math.sqrt(y*y+1e-4)*.01,L=Math.sqrt(.0729-F*F);c=n.ba(F,L,.25,1)}return this._prevEase={start:n.h.now(),duration:s,easing:c},c}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Tl{constructor(s,c){this._clickZoom=s,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class FA{constructor(s){this._tr=new Is(s),this.reset()}reset(){this._active=!1}dblclick(s,c){return s.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(s.shiftKey?-1:1),around:this._tr.unproject(c)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kA{constructor(){this._tap=new xa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(s,c,d){if(!this._swipePoint)if(this._tapTime){let C=c[0],y=s.timeStamp-this._tapTime<500,F=this._tapPoint.dist(C)<30;y&&F?d.length>0&&(this._swipePoint=C,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(s,c,d)}touchmove(s,c,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;let C=c[0],y=C.y-this._swipePoint.y;return this._swipePoint=C,s.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(s,c,d)}touchend(s,c,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{let C=this._tap.touchend(s,c,d);C&&(this._tapTime=s.timeStamp,this._tapPoint=C)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class el{constructor(s,c,d){this._el=s,this._mousePan=c,this._touchPan=d}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ys{constructor(s,c,d){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=c,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Po{constructor(s,c,d,C){this._el=s,this._touchZoom=c,this._touchRotate=d,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}let za=I=>I.zoom||I.drag||I.pitch||I.rotate;class LA extends n.k{}function Ja(I){return I.panDelta&&I.panDelta.mag()||I.zoomDelta||I.bearingDelta||I.pitchDelta}class vc{constructor(s,c){this.handleWindowEvent=C=>{this.handleEvent(C,`${C.type}Window`)},this.handleEvent=(C,y)=>{if(C.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let F=C.type==="renderFrame"?void 0:C,L={needsRenderFrame:!1},R={},N={},D=C.touches,W=D?this._getMapTouches(D):void 0,st=W?h.touchPos(this._el,W):h.mousePos(this._el,C);for(let{handlerName:kt,handler:p,allowed:w}of this._handlers){if(!p.isEnabled())continue;let k;this._blockedByActive(N,w,kt)?p.reset():p[y||C.type]&&(k=p[y||C.type](C,st,W),this.mergeHandlerResult(L,R,k,kt,F),k&&k.needsRenderFrame&&this._triggerRenderFrame()),(k||p.isActive())&&(N[kt]=p)}let wt={};for(let kt in this._previousActiveHandlers)N[kt]||(wt[kt]=F);this._previousActiveHandlers=N,(Object.keys(wt).length||Ja(L))&&(this._changes.push([L,R,wt]),this._triggerRenderFrame()),(Object.keys(N).length||Ja(L))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:yt}=L;yt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],yt(this._map))},this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ho(s),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(c);let d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(let[C,y,F]of this._listeners)h.addEventListener(C,y,C===document?this.handleWindowEvent:this.handleEvent,F)}destroy(){for(let[s,c,d]of this._listeners)h.removeEventListener(s,c,s===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(s){let c=this._map,d=c.getCanvasContainer();this._add("mapEvent",new js(c,s));let C=c.boxZoom=new Ka(c,s);this._add("boxZoom",C),s.interactive&&s.boxZoom&&C.enable();let y=new wn(c),F=new FA(c);c.doubleClickZoom=new Tl(F,y),this._add("tapZoom",y),this._add("clickZoom",F),s.interactive&&s.doubleClickZoom&&c.doubleClickZoom.enable();let L=new kA;this._add("tapDragZoom",L);let R=c.touchPitch=new bc(c);this._add("touchPitch",R),s.interactive&&s.touchPitch&&c.touchPitch.enable(s.touchPitch);let N=Bs(s),D=as(s);c.dragRotate=new ys(s,N,D),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",D,["mouseRotate"]),s.interactive&&s.dragRotate&&c.dragRotate.enable();let W=(({enable:w,clickTolerance:k})=>{let T=new Vr({checkCorrectEvent:H=>h.mouseButton(H)===0&&!H.ctrlKey});return new Vn({clickTolerance:k,move:(H,V)=>({around:V,panDelta:V.sub(H)}),activateOnStart:!0,moveStateManager:T,enable:w,assignEvents:mn})})(s),st=new li(s,c);c.dragPan=new el(d,W,st),this._add("mousePan",W),this._add("touchPan",st,["touchZoom","touchRotate"]),s.interactive&&s.dragPan&&c.dragPan.enable(s.dragPan);let wt=new kl,yt=new yc;c.touchZoomRotate=new Po(d,yt,wt,L),this._add("touchRotate",wt,["touchPan","touchZoom"]),this._add("touchZoom",yt,["touchPan","touchRotate"]),s.interactive&&s.touchZoomRotate&&c.touchZoomRotate.enable(s.touchZoomRotate);let kt=c.scrollZoom=new El(c,()=>this._triggerRenderFrame());this._add("scrollZoom",kt,["mousePan"]),s.interactive&&s.scrollZoom&&c.scrollZoom.enable(s.scrollZoom);let p=c.keyboard=new _s(c);this._add("keyboard",p),s.interactive&&s.keyboard&&c.keyboard.enable(),this._add("blockableMapEvent",new No(c))}_add(s,c,d){this._handlers.push({handlerName:s,handler:c,allowed:d}),this._handlersById[s]=c}stop(s){if(!this._updatingCamera){for(let{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(let{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(za(this._eventsInProgress))||this.isZooming()}_blockedByActive(s,c,d){for(let C in s)if(C!==d&&(!c||c.indexOf(C)<0))return!0;return!1}_getMapTouches(s){let c=[];for(let d of s)this._el.contains(d.target)&&c.push(d);return c}mergeHandlerResult(s,c,d,C,y){if(!d)return;n.e(s,d);let F={handlerName:C,originalEvent:d.originalEvent||y};d.zoomDelta!==void 0&&(c.zoom=F),d.panDelta!==void 0&&(c.drag=F),d.pitchDelta!==void 0&&(c.pitch=F),d.bearingDelta!==void 0&&(c.rotate=F)}_applyChanges(){let s={},c={},d={};for(let[C,y,F]of this._changes)C.panDelta&&(s.panDelta=(s.panDelta||new n.P(0,0))._add(C.panDelta)),C.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+C.pitchDelta),C.around!==void 0&&(s.around=C.around),C.pinchAround!==void 0&&(s.pinchAround=C.pinchAround),C.noInertia&&(s.noInertia=C.noInertia),n.e(c,y),n.e(d,F);this._updateMapTransform(s,c,d),this._changes=[]}_updateMapTransform(s,c,d){let C=this._map,y=C._getTransformForUpdate(),F=C.terrain;if(!(Ja(s)||F&&this._terrainMovement))return this._fireEvents(c,d,!0);let{panDelta:L,zoomDelta:R,bearingDelta:N,pitchDelta:D,around:W,pinchAround:st}=s;st!==void 0&&(W=st),C._stop(!0),W=W||C.transform.centerPoint;let wt=y.pointLocation(L?W.sub(L):W);N&&(y.bearing+=N),D&&(y.pitch+=D),R&&(y.zoom+=R),F?this._terrainMovement||!c.drag&&!c.zoom?c.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(L)):y.setLocationAtPoint(wt,W):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(wt,W),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,y.recalculateZoom(C.terrain)})):y.setLocationAtPoint(wt,W),C._applyUpdatedTransform(y),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(c,d,!0)}_fireEvents(s,c,d){let C=za(this._eventsInProgress),y=za(s),F={};for(let D in s){let{originalEvent:W}=s[D];this._eventsInProgress[D]||(F[`${D}start`]=W),this._eventsInProgress[D]=s[D]}!C&&y&&this._fireEvent("movestart",y.originalEvent);for(let D in F)this._fireEvent(D,F[D]);y&&this._fireEvent("move",y.originalEvent);for(let D in s){let{originalEvent:W}=s[D];this._fireEvent(D,W)}let L={},R;for(let D in this._eventsInProgress){let{handlerName:W,originalEvent:st}=this._eventsInProgress[D];this._handlersById[W].isActive()||(delete this._eventsInProgress[D],R=c[W]||st,L[`${D}end`]=R)}for(let D in L)this._fireEvent(D,L[D]);let N=za(this._eventsInProgress);if(d&&(C||y)&&!N){this._updatingCamera=!0;let D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),W=st=>st!==0&&-this._bearingSnap<st&&st<this._bearingSnap;!D||!D.essential&&n.h.prefersReducedMotion?(this._map.fire(new n.k("moveend",{originalEvent:R})),W(this._map.getBearing())&&this._map.resetNorth()):(W(D.bearing||this._map.getBearing())&&(D.bearing=0),D.freezeElevation=!0,this._map.easeTo(D,{originalEvent:R})),this._updatingCamera=!1}}_fireEvent(s,c){this._map.fire(new n.k(s,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new LA("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class gu extends n.E{constructor(s,c){super(),this._renderFrameCallback=()=>{let d=Math.min((n.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=c.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new n.L(this.transform.center.lng,this.transform.center.lat)}setCenter(s,c){return this.jumpTo({center:s},c)}panBy(s,c,d){return s=n.P.convert(s).mult(-1),this.panTo(this.transform.center,n.e({offset:s},c),d)}panTo(s,c,d){return this.easeTo(n.e({center:s},c),d)}getZoom(){return this.transform.zoom}setZoom(s,c){return this.jumpTo({zoom:s},c),this}zoomTo(s,c,d){return this.easeTo(n.e({zoom:s},c),d)}zoomIn(s,c){return this.zoomTo(this.getZoom()+1,s,c),this}zoomOut(s,c){return this.zoomTo(this.getZoom()-1,s,c),this}getBearing(){return this.transform.bearing}setBearing(s,c){return this.jumpTo({bearing:s},c),this}getPadding(){return this.transform.padding}setPadding(s,c){return this.jumpTo({padding:s},c),this}rotateTo(s,c,d){return this.easeTo(n.e({bearing:s},c),d)}resetNorth(s,c){return this.rotateTo(0,n.e({duration:1e3},s),c),this}resetNorthPitch(s,c){return this.easeTo(n.e({bearing:0,pitch:0,duration:1e3},s),c),this}snapToNorth(s,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,c):this}getPitch(){return this.transform.pitch}setPitch(s,c){return this.jumpTo({pitch:s},c),this}cameraForBounds(s,c){s=fe.convert(s);let d=c&&c.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),d,c)}_cameraForBoxAndBearing(s,c,d,C){let y={top:0,bottom:0,right:0,left:0};if(typeof(C=n.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding=="number"){let V=C.padding;C.padding={top:V,bottom:V,right:V,left:V}}C.padding=n.e(y,C.padding);let F=this.transform,L=F.padding,R=F.project(n.L.convert(s)),N=F.project(n.L.convert(c)),D=R.rotate(-d*Math.PI/180),W=N.rotate(-d*Math.PI/180),st=new n.P(Math.max(D.x,W.x),Math.max(D.y,W.y)),wt=new n.P(Math.min(D.x,W.x),Math.min(D.y,W.y)),yt=st.sub(wt),kt=(F.width-(L.left+L.right+C.padding.left+C.padding.right))/yt.x,p=(F.height-(L.top+L.bottom+C.padding.top+C.padding.bottom))/yt.y;if(p<0||kt<0)return void n.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");let w=Math.min(F.scaleZoom(F.scale*Math.min(kt,p)),C.maxZoom),k=n.P.convert(C.offset),T=new n.P((C.padding.left-C.padding.right)/2,(C.padding.top-C.padding.bottom)/2).rotate(d*Math.PI/180),H=k.add(T).mult(F.scale/F.zoomScale(w));return{center:F.unproject(R.add(N).div(2).sub(H)),zoom:w,bearing:d}}fitBounds(s,c,d){return this._fitInternal(this.cameraForBounds(s,c),c,d)}fitScreenCoordinates(s,c,d,C,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(n.P.convert(s)),this.transform.pointLocation(n.P.convert(c)),d,C),C,y)}_fitInternal(s,c,d){return s?(delete(c=n.e(s,c)).padding,c.linear?this.easeTo(c,d):this.flyTo(c,d)):this}jumpTo(s,c){this.stop();let d=this._getTransformForUpdate(),C=!1,y=!1,F=!1;return"zoom"in s&&d.zoom!==+s.zoom&&(C=!0,d.zoom=+s.zoom),s.center!==void 0&&(d.center=n.L.convert(s.center)),"bearing"in s&&d.bearing!==+s.bearing&&(y=!0,d.bearing=+s.bearing),"pitch"in s&&d.pitch!==+s.pitch&&(F=!0,d.pitch=+s.pitch),s.padding==null||d.isPaddingEqual(s.padding)||(d.padding=s.padding),this._applyUpdatedTransform(d),this.fire(new n.k("movestart",c)).fire(new n.k("move",c)),C&&this.fire(new n.k("zoomstart",c)).fire(new n.k("zoom",c)).fire(new n.k("zoomend",c)),y&&this.fire(new n.k("rotatestart",c)).fire(new n.k("rotate",c)).fire(new n.k("rotateend",c)),F&&this.fire(new n.k("pitchstart",c)).fire(new n.k("pitch",c)).fire(new n.k("pitchend",c)),this.fire(new n.k("moveend",c))}calculateCameraOptionsFromTo(s,c,d,C=0){let y=n.U.fromLngLat(s,c),F=n.U.fromLngLat(d,C),L=F.x-y.x,R=F.y-y.y,N=F.z-y.z,D=Math.hypot(L,R,N);if(D===0)throw new Error("Can't calculate camera options with same From and To");let W=Math.hypot(L,R),st=this.transform.scaleZoom(this.transform.cameraToCenterDistance/D/this.transform.tileSize),wt=180*Math.atan2(L,-R)/Math.PI,yt=180*Math.acos(W/D)/Math.PI;return yt=N<0?90-yt:90+yt,{center:F.toLngLat(),zoom:st,pitch:yt,bearing:wt}}easeTo(s,c){this._stop(!1,s.easeId),((s=n.e({offset:[0,0],duration:500,easing:n.bb},s)).animate===!1||!s.essential&&n.h.prefersReducedMotion)&&(s.duration=0);let d=this._getTransformForUpdate(),C=this.getZoom(),y=this.getBearing(),F=this.getPitch(),L=this.getPadding(),R="zoom"in s?+s.zoom:C,N="bearing"in s?this._normalizeBearing(s.bearing,y):y,D="pitch"in s?+s.pitch:F,W="padding"in s?s.padding:d.padding,st=n.P.convert(s.offset),wt=d.centerPoint.add(st),yt=d.pointLocation(wt),kt=n.L.convert(s.center||yt);this._normalizeCenter(kt);let p=d.project(yt),w=d.project(kt).sub(p),k=d.zoomScale(R-C),T,H;s.around&&(T=n.L.convert(s.around),H=d.locationPoint(T));let V={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||R!==C,this._rotating=this._rotating||y!==N,this._pitching=this._pitching||D!==F,this._padding=!d.isPaddingEqual(W),this._easeId=s.easeId,this._prepareEase(c,s.noMoveStart,V),this.terrain&&this._prepareElevation(kt),this._ease(K=>{if(this._zooming&&(d.zoom=n.B.number(C,R,K)),this._rotating&&(d.bearing=n.B.number(y,N,K)),this._pitching&&(d.pitch=n.B.number(F,D,K)),this._padding&&(d.interpolatePadding(L,W,K),wt=d.centerPoint.add(st)),this.terrain&&!s.freezeElevation&&this._updateElevation(K),T)d.setLocationAtPoint(T,H);else{let X=d.zoomScale(d.zoom-C),$=R>C?Math.min(2,k):Math.max(.5,k),nt=Math.pow($,1-K),Ct=d.unproject(p.add(w.mult(K*nt)).mult(X));d.setLocationAtPoint(d.renderWorldCopies?Ct.wrap():Ct,wt)}this._applyUpdatedTransform(d),this._fireMoveEvents(c)},K=>{this.terrain&&this._finalizeElevation(),this._afterEase(c,K)},s),this}_prepareEase(s,c,d={}){this._moving=!0,c||d.moving||this.fire(new n.k("movestart",s)),this._zooming&&!d.zooming&&this.fire(new n.k("zoomstart",s)),this._rotating&&!d.rotating&&this.fire(new n.k("rotatestart",s)),this._pitching&&!d.pitching&&this.fire(new n.k("pitchstart",s))}_prepareElevation(s){this._elevationCenter=s,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(s){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let c=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(s<1&&c!==this._elevationTarget){let d=this._elevationTarget-this._elevationStart;this._elevationStart+=s*(d-(c-(d*s+this._elevationStart))/(1-s)),this._elevationTarget=c}this.transform.elevation=n.B.number(this._elevationStart,this._elevationTarget,s)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(s){if(!this.transformCameraUpdate)return;let c=s.clone(),{center:d,zoom:C,pitch:y,bearing:F,elevation:L}=this.transformCameraUpdate(c);d&&(c.center=d),C!==void 0&&(c.zoom=C),y!==void 0&&(c.pitch=y),F!==void 0&&(c.bearing=F),L!==void 0&&(c.elevation=L),this.transform.apply(c)}_fireMoveEvents(s){this.fire(new n.k("move",s)),this._zooming&&this.fire(new n.k("zoom",s)),this._rotating&&this.fire(new n.k("rotate",s)),this._pitching&&this.fire(new n.k("pitch",s))}_afterEase(s,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId;let d=this._zooming,C=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new n.k("zoomend",s)),C&&this.fire(new n.k("rotateend",s)),y&&this.fire(new n.k("pitchend",s)),this.fire(new n.k("moveend",s))}flyTo(s,c){if(!s.essential&&n.h.prefersReducedMotion){let te=n.F(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(te,c)}this.stop(),s=n.e({offset:[0,0],speed:1.2,curve:1.42,easing:n.bb},s);let d=this._getTransformForUpdate(),C=this.getZoom(),y=this.getBearing(),F=this.getPitch(),L=this.getPadding(),R="zoom"in s?n.ad(+s.zoom,d.minZoom,d.maxZoom):C,N="bearing"in s?this._normalizeBearing(s.bearing,y):y,D="pitch"in s?+s.pitch:F,W="padding"in s?s.padding:d.padding,st=d.zoomScale(R-C),wt=n.P.convert(s.offset),yt=d.centerPoint.add(wt),kt=d.pointLocation(yt),p=n.L.convert(s.center||kt);this._normalizeCenter(p);let w=d.project(kt),k=d.project(p).sub(w),T=s.curve,H=Math.max(d.width,d.height),V=H/st,K=k.mag();if("minZoom"in s){let te=n.ad(Math.min(s.minZoom,C,R),d.minZoom,d.maxZoom),Ot=H/d.zoomScale(te-C);T=Math.sqrt(Ot/K*2)}let X=T*T;function $(te){let Ot=(V*V-H*H+(te?-1:1)*X*X*K*K)/(2*(te?V:H)*X*K);return Math.log(Math.sqrt(Ot*Ot+1)-Ot)}function nt(te){return(Math.exp(te)-Math.exp(-te))/2}function Ct(te){return(Math.exp(te)+Math.exp(-te))/2}let zt=$(!1),re=function(te){return Ct(zt)/Ct(zt+T*te)},Tt=function(te){return H*((Ct(zt)*(nt(Ot=zt+T*te)/Ct(Ot))-nt(zt))/X)/K;var Ot},pe=($(!0)-zt)/T;if(Math.abs(K)<1e-6||!isFinite(pe)){if(Math.abs(H-V)<1e-6)return this.easeTo(s,c);let te=V<H?-1:1;pe=Math.abs(Math.log(V/H))/T,Tt=function(){return 0},re=function(Ot){return Math.exp(te*T*Ot)}}return s.duration="duration"in s?+s.duration:1e3*pe/("screenSpeed"in s?+s.screenSpeed/T:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=y!==N,this._pitching=D!==F,this._padding=!d.isPaddingEqual(W),this._prepareEase(c,!1),this.terrain&&this._prepareElevation(p),this._ease(te=>{let Ot=te*pe,Wt=1/re(Ot);d.zoom=te===1?R:C+d.scaleZoom(Wt),this._rotating&&(d.bearing=n.B.number(y,N,te)),this._pitching&&(d.pitch=n.B.number(F,D,te)),this._padding&&(d.interpolatePadding(L,W,te),yt=d.centerPoint.add(wt)),this.terrain&&!s.freezeElevation&&this._updateElevation(te);let Ie=te===1?p:d.unproject(w.add(k.mult(Tt(Ot))).mult(Wt));d.setLocationAtPoint(d.renderWorldCopies?Ie.wrap():Ie,yt),this._applyUpdatedTransform(d),this._fireMoveEvents(c)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(c)},s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,c)}if(!s){let d=this.handlers;d&&d.stop(!1)}return this}_ease(s,c,d){d.animate===!1||d.duration===0?(s(1),c()):(this._easeStart=n.h.now(),this._easeOptions=d,this._onEaseFrame=s,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(s,c){s=n.b5(s,-180,180);let d=Math.abs(s-c);return Math.abs(s-360-c)<d&&(s-=360),Math.abs(s+360-c)<d&&(s+=360),s}_normalizeCenter(s){let c=this.transform;if(!c.renderWorldCopies||c.lngRange)return;let d=s.lng-c.center.lng;s.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(s){return this.terrain?this.terrain.getElevationForLngLatZoom(n.L.convert(s),this.transform.tileZoom)-this.transform.elevation:null}}class xs{constructor(s={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=c=>{!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=s}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options&&this.options.compact,this._container=h.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=h.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=h.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){h.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,c){let d=this._map._getUIString(`AttributionControl.${c}`);s.title=d,s.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(C=>typeof C!="string"?"":C)):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){let C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}let c=this._map.style.sourceCaches;for(let C in c){let y=c[C];if(y.used||y.usedForTerrain){let F=y.getSource();F.attribution&&s.indexOf(F.attribution)<0&&s.push(F.attribution)}}s=s.filter(C=>String(C).trim()),s.sort((C,y)=>C.length-y.length),s=s.filter((C,y)=>{for(let F=y+1;F<s.length;F++)if(s[F].indexOf(C)>=0)return!1;return!0});let d=s.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,s.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Yr{constructor(s={}){this._updateCompact=()=>{let c=this._container.children;if(c.length){let d=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=s}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=h.create("div","maplibregl-ctrl");let c=h.create("a","maplibregl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://maplibre.org/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){h.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ql{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){let c=++this._id;return this._queue.push({callback:s,id:c,cancelled:!1}),c}remove(s){let c=this._currentlyRunning,d=c?this._queue.concat(c):this._queue;for(let C of d)if(C.id===s)return void(C.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let c=this._currentlyRunning=this._queue;this._queue=[];for(let d of c)if(!d.cancelled&&(d.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}let wc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var du=n.Q([{name:"a_pos3d",type:"Int16",components:3}]);class pu extends n.E{constructor(s){super(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,s.usedForTerrain=!0,s.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(s,c){this.sourceCache.update(s,c),this._renderableTilesKeys=[];let d={};for(let C of s.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:c}))d[C.key]=!0,this._renderableTilesKeys.push(C.key),this._tiles[C.key]||(C.posMatrix=new Float64Array(16),n.aS(C.posMatrix,0,n.N,0,n.N,0,1),this._tiles[C.key]=new Rt(C,this.tileSize));for(let C in this._tiles)d[C]||delete this._tiles[C]}freeRtt(s){for(let c in this._tiles){let d=this._tiles[c];(!s||d.tileID.equals(s)||d.tileID.isChildOf(s)||s.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s){let c={};for(let d of this._renderableTilesKeys){let C=this._tiles[d].tileID;if(C.canonical.equals(s.canonical)){let y=s.clone();y.posMatrix=new Float64Array(16),n.aS(y.posMatrix,0,n.N,0,n.N,0,1),c[d]=y}else if(C.canonical.isChildOf(s.canonical)){let y=s.clone();y.posMatrix=new Float64Array(16);let F=C.canonical.z-s.canonical.z,L=C.canonical.x-(C.canonical.x>>F<<F),R=C.canonical.y-(C.canonical.y>>F<<F),N=n.N>>F;n.aS(y.posMatrix,0,N,0,N,0,1),n.$(y.posMatrix,y.posMatrix,[-L*N,-R*N,0]),c[d]=y}else if(s.canonical.isChildOf(C.canonical)){let y=s.clone();y.posMatrix=new Float64Array(16);let F=s.canonical.z-C.canonical.z,L=s.canonical.x-(s.canonical.x>>F<<F),R=s.canonical.y-(s.canonical.y>>F<<F),N=n.N>>F;n.aS(y.posMatrix,0,n.N,0,n.N,0,1),n.$(y.posMatrix,y.posMatrix,[L*N,R*N,0]),n.a0(y.posMatrix,y.posMatrix,[1/2**F,1/2**F,0]),c[d]=y}}return c}getSourceTile(s,c){let d=this.sourceCache._source,C=s.overscaledZ-this.deltaZoom;if(C>d.maxzoom&&(C=d.maxzoom),C<d.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(C).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!y||!y.dem)&&c)for(;C>=d.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(s.scaledTo(C--).key);return y}tilesAfterTime(s=Date.now()){return Object.values(this._tiles).filter(c=>c.timeAdded>=s)}}class Ul{constructor(s,c,d){this.painter=s,this.sourceCache=new pu(c),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(s,c,d,C=n.N){var y;if(!(c>=0&&c<C&&d>=0&&d<C))return 0;let F=this.getTerrainData(s),L=(y=F.tile)===null||y===void 0?void 0:y.dem;if(!L)return 0;let R=function(yt,kt,p){var w=kt[0],k=kt[1];return yt[0]=p[0]*w+p[4]*k+p[12],yt[1]=p[1]*w+p[5]*k+p[13],yt}([],[c/C*n.N,d/C*n.N],F.u_terrain_matrix),N=[R[0]*L.dim,R[1]*L.dim],D=Math.floor(N[0]),W=Math.floor(N[1]),st=N[0]-D,wt=N[1]-W;return L.get(D,W)*(1-st)*(1-wt)+L.get(D+1,W)*st*(1-wt)+L.get(D,W+1)*(1-st)*wt+L.get(D+1,W+1)*st*wt}getElevationForLngLatZoom(s,c){let{tileID:d,mercatorX:C,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(s,c);return this.getElevation(d,C%n.N,y%n.N,n.N)}getElevation(s,c,d,C=n.N){return this.getDEMElevation(s,c,d,C)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){let C=this.painter.context,y=new n.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new dt(C,y,C.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new dt(C,new n.R({width:1,height:1}),C.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=n.ao([])}let c=this.sourceCache.getSourceTile(s,!0);if(c&&c.dem&&(!c.demTexture||c.needsTerrainPrepare)){let C=this.painter.context;c.demTexture=this.painter.getTileTexture(c.dem.stride),c.demTexture?c.demTexture.update(c.dem.getPixels(),{premultiply:!1}):c.demTexture=new dt(C,c.dem.getPixels(),C.gl.RGBA,{premultiply:!1}),c.demTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),c.needsTerrainPrepare=!1}let d=c&&c+c.tileID.key+s.key;if(d&&!this._demMatrixCache[d]){let C=this.sourceCache.sourceCache._source.maxzoom,y=s.canonical.z-c.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=C?y=s.canonical.z-C:n.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let F=s.canonical.x-(s.canonical.x>>y<<y),L=s.canonical.y-(s.canonical.y>>y<<y),R=n.bc(new Float64Array(16),[1/(n.N<<y),1/(n.N<<y),0]);n.$(R,R,[F*n.N,L*n.N,0]),this._demMatrixCache[s.key]={matrix:R,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:c&&c.dem&&c.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:c&&c.dem&&c.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(c&&c.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:c}}getFramebuffer(s){let c=this.painter,d=c.width/devicePixelRatio,C=c.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new dt(c.context,{width:d,height:C,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new dt(c.context,{width:d,height:C,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=c.context.createFramebuffer(d,C,!0,!1),this._fbo.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,d,C))),this._fbo.colorAttachment.set(s==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let s=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let c=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,F=0;y<this._coordsTextureSize;y++)for(let L=0;L<this._coordsTextureSize;L++,F+=4)c[F+0]=255&L,c[F+1]=255&y,c[F+2]=L>>8<<4|y>>8,c[F+3]=0;let d=new n.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(c.buffer)),C=new dt(s,d,s.gl.RGBA,{premultiply:!1});return C.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=C,C}pointCoordinate(s){let c=new Uint8Array(4),d=this.painter.context,C=d.gl;d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),C.readPixels(s.x,this.painter.height/devicePixelRatio-s.y-1,1,1,C.RGBA,C.UNSIGNED_BYTE,c),d.bindFramebuffer.set(null);let y=c[0]+(c[2]>>4<<8),F=c[1]+((15&c[2])<<8),L=this.coordsIndex[255-c[3]],R=L&&this.sourceCache.getTileByID(L);if(!R)return null;let N=this._coordsTextureSize,D=(1<<R.tileID.canonical.z)*N;return new n.U(this._allowMercatorOverflow(s,(R.tileID.canonical.x*N+y)/D),(R.tileID.canonical.y*N+F)/D,this.getElevation(R.tileID,y,F,N))}getTerrainMesh(){if(this._mesh)return this._mesh;let s=this.painter.context,c=new n.bd,d=new n.b0,C=this.meshSize,y=n.N/C,F=C*C;for(let W=0;W<=C;W++)for(let st=0;st<=C;st++)c.emplaceBack(st*y,W*y,0);for(let W=0;W<F;W+=C+1)for(let st=0;st<C;st++)d.emplaceBack(st+W,C+st+W+1,C+st+W+2),d.emplaceBack(st+W,C+st+W+2,st+W+1);let L=c.length,R=L+2*(C+1);for(let W of[0,1])for(let st=0;st<=C;st++)for(let wt of[0,1])c.emplaceBack(st*y,W*n.N,wt);for(let W=0;W<2*C;W+=2)d.emplaceBack(R+W,R+W+1,R+W+3),d.emplaceBack(R+W,R+W+3,R+W+2),d.emplaceBack(L+W,L+W+3,L+W+1),d.emplaceBack(L+W,L+W+2,L+W+3);let N=c.length,D=N+2*(C+1);for(let W of[0,1])for(let st=0;st<=C;st++)for(let wt of[0,1])c.emplaceBack(W*n.N,st*y,wt);for(let W=0;W<2*C;W+=2)d.emplaceBack(N+W,N+W+1,N+W+3),d.emplaceBack(N+W,N+W+3,N+W+2),d.emplaceBack(D+W,D+W+3,D+W+1),d.emplaceBack(D+W,D+W+2,D+W+3);return this._mesh={indexBuffer:s.createIndexBuffer(d),vertexBuffer:s.createVertexBuffer(c,du.members),segments:n.S.simpleSegment(0,0,c.length,d.length)},this._mesh}getMeshFrameDelta(s){return 2*Math.PI*n.be/Math.pow(2,s)/5}getMinTileElevationForLngLatZoom(s,c){var d;let{tileID:C}=this._getOverscaledTileIDFromLngLatZoom(s,c);return(d=this.getMinMaxElevation(C).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(s){let c=this.getTerrainData(s).tile,d={minElevation:null,maxElevation:null};return c&&c.dem&&(d.minElevation=c.dem.min*this.exaggeration,d.maxElevation=c.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(s,c){let d=n.U.fromLngLat(s.wrap()),C=(1<<c)*n.N,y=d.x*C,F=d.y*C,L=Math.floor(y/n.N),R=Math.floor(F/n.N);return{tileID:new n.O(c,0,c,L,R),mercatorX:y,mercatorY:F}}_allowMercatorOverflow(s,c){let d=s.x<this.painter.width/2,C=n.bf(c),y=this.painter.transform.center.lng;return d&&Math.sign(C)>0&&Math.sign(y)<0||!d&&Math.sign(C)<0&&Math.sign(y)>0?(C=360*Math.sign(y)+C,n.G(C)):c}}class Bc{constructor(s,c,d){this._context=s,this._size=c,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let s of this._objects)s.texture.destroy(),s.fbo.destroy()}_createObject(s){let c=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new dt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),c.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),c.colorAttachment.set(d.texture),{id:s,fbo:c,texture:d,stamp:-1,inUse:!1}}getObjectForId(s){return this._objects[s]}useObject(s){s.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(c=>s.id!==c),this._recentlyUsed.push(s.id)}stampObject(s){s.stamp=++this._stamp}getOrCreateFreeObject(){for(let c of this._recentlyUsed)if(!this._objects[c].inUse)return this._objects[c];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let s=this._createObject(this._objects.length);return this._objects.push(s),s}freeObject(s){s.inUse=!1}freeAllObjects(){for(let s of this._objects)this.freeObject(s)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(s=>!s.inUse)===!1}}let Fn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Gl{constructor(s,c){this.painter=s,this.terrain=c,this.pool=new Bc(s.context,30,c.sourceCache.tileSize*c.qualityFactor)}destruct(){this.pool.destruct()}getTexture(s){return this.pool.getObjectForId(s.rtt[this._stacks.length-1].id).texture}prepareForRender(s,c){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=s._order.filter(d=>!s._layers[d].isHidden(c)),this._coordsDescendingInv={};for(let d in s.sourceCaches){this._coordsDescendingInv[d]={};let C=s.sourceCaches[d].getVisibleCoordinates();for(let y of C){let F=this.terrain.sourceCache.getTerrainCoords(y);for(let L in F)this._coordsDescendingInv[d][L]||(this._coordsDescendingInv[d][L]=[]),this._coordsDescendingInv[d][L].push(F[L])}}this._coordsDescendingInvStr={};for(let d of s._order){let C=s._layers[d],y=C.source;if(Fn[C.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(let F in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][F]=this._coordsDescendingInv[y][F].map(L=>L.key).sort().join()}}for(let d of this._renderableTiles)for(let C in this._coordsDescendingInvStr){let y=this._coordsDescendingInvStr[C][d.tileID.key];y&&y!==d.rttCoords[C]&&(d.rtt=[])}}renderLayer(s){if(s.isHidden(this.painter.transform.zoom))return!1;let c=s.type,d=this.painter,C=this._renderableLayerIds[this._renderableLayerIds.length-1]===s.id;if(Fn[c]&&(this._prevType&&Fn[this._prevType]||this._stacks.push([]),this._prevType=c,this._stacks[this._stacks.length-1].push(s.id),!C))return!0;if(Fn[this._prevType]||Fn[c]&&C){this._prevType=c;let y=this._stacks.length-1,F=this._stacks[y]||[];for(let L of this._renderableTiles){if(this.pool.isFull()&&(Ir(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(L),L.rtt[y]){let N=this.pool.getObjectForId(L.rtt[y].id);if(N.stamp===L.rtt[y].stamp){this.pool.useObject(N);continue}}let R=this.pool.getOrCreateFreeObject();this.pool.useObject(R),this.pool.stampObject(R),L.rtt[y]={id:R.id,stamp:R.stamp},d.context.bindFramebuffer.set(R.fbo.framebuffer),d.context.clear({color:n.aT.transparent,stencil:0}),d.currentStencilSource=void 0;for(let N=0;N<F.length;N++){let D=d.style._layers[F[N]],W=D.source?this._coordsDescendingInv[D.source][L.tileID.key]:[L.tileID];d.context.viewport.set([0,0,R.fbo.width,R.fbo.height]),d._renderTileClippingMasks(D,W),d.renderLayer(d,d.style.sourceCaches[D.source],D,W),D.source&&(L.rttCoords[D.source]=this._coordsDescendingInvStr[D.source][L.tileID.key])}}return Ir(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Fn[c]}return!1}}let Fi=g,Ni={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:n.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},il=I=>{I.touchstart=I.dragStart,I.touchmoveWindow=I.dragMove,I.touchend=I.dragEnd},_c={showCompass:!0,showZoom:!0,visualizePitch:!1};class xc{constructor(s,c,d=!1){this.mousedown=F=>{this.startMouse(n.e({},F,{ctrlKey:!0,preventDefault:()=>F.preventDefault()}),h.mousePos(this.element,F)),h.addEventListener(window,"mousemove",this.mousemove),h.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=F=>{this.moveMouse(F,h.mousePos(this.element,F))},this.mouseup=F=>{this.mouseRotate.dragEnd(F),this.mousePitch&&this.mousePitch.dragEnd(F),this.offTemp()},this.touchstart=F=>{F.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=h.touchPos(this.element,F.targetTouches)[0],this.startTouch(F,this._startPos),h.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),h.addEventListener(window,"touchend",this.touchend))},this.touchmove=F=>{F.targetTouches.length!==1?this.reset():(this._lastPos=h.touchPos(this.element,F.targetTouches)[0],this.moveTouch(F,this._lastPos))},this.touchend=F=>{F.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;let C=s.dragRotate._mouseRotate.getClickTolerance(),y=s.dragRotate._mousePitch.getClickTolerance();this.element=c,this.mouseRotate=Bs({clickTolerance:C,enable:!0}),this.touchRotate=(({enable:F,clickTolerance:L,bearingDegreesPerPixelMoved:R=.8})=>{let N=new fn;return new Vn({clickTolerance:L,move:(D,W)=>({bearingDelta:(W.x-D.x)*R}),moveStateManager:N,enable:F,assignEvents:il})})({clickTolerance:C,enable:!0}),this.map=s,d&&(this.mousePitch=as({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:F,clickTolerance:L,pitchDegreesPerPixelMoved:R=-.5})=>{let N=new fn;return new Vn({clickTolerance:L,move:(D,W)=>({pitchDelta:(W.y-D.y)*R}),moveStateManager:N,enable:F,assignEvents:il})})({clickTolerance:y,enable:!0})),h.addEventListener(c,"mousedown",this.mousedown),h.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),h.addEventListener(c,"touchcancel",this.reset)}startMouse(s,c){this.mouseRotate.dragStart(s,c),this.mousePitch&&this.mousePitch.dragStart(s,c),h.disableDrag()}startTouch(s,c){this.touchRotate.dragStart(s,c),this.touchPitch&&this.touchPitch.dragStart(s,c),h.disableDrag()}moveMouse(s,c){let d=this.map,{bearingDelta:C}=this.mouseRotate.dragMove(s,c)||{};if(C&&d.setBearing(d.getBearing()+C),this.mousePitch){let{pitchDelta:y}=this.mousePitch.dragMove(s,c)||{};y&&d.setPitch(d.getPitch()+y)}}moveTouch(s,c){let d=this.map,{bearingDelta:C}=this.touchRotate.dragMove(s,c)||{};if(C&&d.setBearing(d.getBearing()+C),this.touchPitch){let{pitchDelta:y}=this.touchPitch.dragMove(s,c)||{};y&&d.setPitch(d.getPitch()+y)}}off(){let s=this.element;h.removeEventListener(s,"mousedown",this.mousedown),h.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),h.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),h.removeEventListener(window,"touchend",this.touchend),h.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){h.enableDrag(),h.removeEventListener(window,"mousemove",this.mousemove),h.removeEventListener(window,"mouseup",this.mouseup),h.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),h.removeEventListener(window,"touchend",this.touchend)}}let yn;function Mo(I,s,c){if(I=new n.L(I.lng,I.lat),s){let d=new n.L(I.lng-360,I.lat),C=new n.L(I.lng+360,I.lat),y=c.locationPoint(I).distSqr(s);c.locationPoint(d).distSqr(s)<y?I=d:c.locationPoint(C).distSqr(s)<y&&(I=C)}for(;Math.abs(I.lng-c.center.lng)>180;){let d=c.locationPoint(I);if(d.x>=0&&d.y>=0&&d.x<=c.width&&d.y<=c.height)break;I.lng>c.center.lng?I.lng-=360:I.lng+=360}return I}let Cn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Vo(I,s,c){let d=I.classList;for(let C in Cn)d.remove(`maplibregl-${c}-anchor-${C}`);d.add(`maplibregl-${c}-anchor-${s}`)}class Xa extends n.E{constructor(s){if(super(),this._onKeyPress=c=>{let d=c.code,C=c.charCode||c.keyCode;d!=="Space"&&d!=="Enter"&&C!==32&&C!==13||this.togglePopup()},this._onMapClick=c=>{let d=c.originalEvent.target,C=this._element;this._popup&&(d===C||C.contains(d))&&this.togglePopup()},this._update=c=>{if(!this._map)return;let d=this._map.loaded()&&!this._map.isMoving();(c?.type==="terrain"||c?.type==="render"&&!d)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Mo(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let C="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?C=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(C=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),c&&c.type!=="moveend"||(this._pos=this._pos.round()),h.setTransform(this._element,`${Cn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${C}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{let F=this._map.unproject(this._pos),L=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=F.distanceTo(this._lngLat)>20*L?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=c=>{if(!this._isDragging){let d=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new n.k("dragstart"))),this.fire(new n.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new n.k("dragend")),this._state="inactive"},this._addDragHandler=c=>{this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment!=="auto"?s.pitchAlignment:this._rotationAlignment,s&&s.element)this._element=s.element,this._offset=n.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=h.create("div"),this._element.setAttribute("aria-label","Map marker");let c=h.createNS("http://www.w3.org/2000/svg","svg"),d=41,C=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${d}px`),c.setAttributeNS(null,"width",`${C}px`),c.setAttributeNS(null,"viewBox",`0 0 ${C} ${d}`);let y=h.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");let F=h.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"fill-rule","nonzero");let L=h.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"transform","translate(3.0, 29.0)"),L.setAttributeNS(null,"fill","#000000");let R=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let w of R){let k=h.createNS("http://www.w3.org/2000/svg","ellipse");k.setAttributeNS(null,"opacity","0.04"),k.setAttributeNS(null,"cx","10.5"),k.setAttributeNS(null,"cy","5.80029008"),k.setAttributeNS(null,"rx",w.rx),k.setAttributeNS(null,"ry",w.ry),L.appendChild(k)}let N=h.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill",this._color);let D=h.createNS("http://www.w3.org/2000/svg","path");D.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),N.appendChild(D);let W=h.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"fill","#000000");let st=h.createNS("http://www.w3.org/2000/svg","path");st.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),W.appendChild(st);let wt=h.createNS("http://www.w3.org/2000/svg","g");wt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),wt.setAttributeNS(null,"fill","#FFFFFF");let yt=h.createNS("http://www.w3.org/2000/svg","g");yt.setAttributeNS(null,"transform","translate(8.0, 8.0)");let kt=h.createNS("http://www.w3.org/2000/svg","circle");kt.setAttributeNS(null,"fill","#000000"),kt.setAttributeNS(null,"opacity","0.25"),kt.setAttributeNS(null,"cx","5.5"),kt.setAttributeNS(null,"cy","5.5"),kt.setAttributeNS(null,"r","5.4999962");let p=h.createNS("http://www.w3.org/2000/svg","circle");p.setAttributeNS(null,"fill","#FFFFFF"),p.setAttributeNS(null,"cx","5.5"),p.setAttributeNS(null,"cy","5.5"),p.setAttributeNS(null,"r","5.4999962"),yt.appendChild(kt),yt.appendChild(p),F.appendChild(L),F.appendChild(N),F.appendChild(W),F.appendChild(wt),F.appendChild(yt),c.appendChild(F),c.setAttributeNS(null,"height",d*this._scale+"px"),c.setAttributeNS(null,"width",C*this._scale+"px"),this._element.appendChild(c),this._offset=n.P.convert(s&&s.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),Vo(this._element,this._anchor,"marker"),s&&s.className)for(let c of s.className.split(" "))this._element.classList.add(c);this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),s.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),h.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=n.L.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){let C=Math.abs(13.5)/Math.SQRT2;s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(38.1-13.5+C)],"bottom-right":[-C,-1*(38.1-13.5+C)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let s=this._popup;return s?(s.isOpen()?s.remove():s.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(s){return this._offset=n.P.convert(s),this._update(),this}addClassName(s){this._element.classList.add(s)}removeClassName(s){this._element.classList.remove(s)}toggleClassName(s){return this._element.classList.toggle(s)}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&s!=="auto"?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}let rn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Er=0,Dn=!1,rl={maxWidth:100,unit:"metric"};function nl(I,s,c){let d=c&&c.maxWidth||100,C=I._container.clientHeight/2,y=I.unproject([0,C]),F=I.unproject([d,C]),L=y.distanceTo(F);if(c&&c.unit==="imperial"){let R=3.2808*L;R>5280?Sa(s,d,R/5280,I._getUIString("ScaleControl.Miles")):Sa(s,d,R,I._getUIString("ScaleControl.Feet"))}else c&&c.unit==="nautical"?Sa(s,d,L/1852,I._getUIString("ScaleControl.NauticalMiles")):L>=1e3?Sa(s,d,L/1e3,I._getUIString("ScaleControl.Kilometers")):Sa(s,d,L,I._getUIString("ScaleControl.Meters"))}function Sa(I,s,c,d){let C=function(y){let F=Math.pow(10,`${Math.floor(y)}`.length-1),L=y/F;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(R){let N=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*N)/N}(L),F*L}(c);I.style.width=s*(C/c)+"px",I.innerHTML=`${C}&nbsp;${d}`}let Rl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Zl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ya(I){if(I){if(typeof I=="number"){let s=Math.round(Math.abs(I)/Math.SQRT2);return{center:new n.P(0,0),top:new n.P(0,I),"top-left":new n.P(s,s),"top-right":new n.P(-s,s),bottom:new n.P(0,-I),"bottom-left":new n.P(s,-s),"bottom-right":new n.P(-s,-s),left:new n.P(I,0),right:new n.P(-I,0)}}if(I instanceof n.P||Array.isArray(I)){let s=n.P.convert(I);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:n.P.convert(I.center||[0,0]),top:n.P.convert(I.top||[0,0]),"top-left":n.P.convert(I["top-left"]||[0,0]),"top-right":n.P.convert(I["top-right"]||[0,0]),bottom:n.P.convert(I.bottom||[0,0]),"bottom-left":n.P.convert(I["bottom-left"]||[0,0]),"bottom-right":n.P.convert(I["bottom-right"]||[0,0]),left:n.P.convert(I.left||[0,0]),right:n.P.convert(I.right||[0,0])}}return Ya(new n.P(0,0))}let Sc={extend:(I,...s)=>n.e(I,...s),run(I){I()},logToElement(I,s=!1,c="log"){let d=window.document.getElementById(c);d&&(s&&(d.innerHTML=""),d.innerHTML+=`<br>${I}`)}},EA=g;class yr{static get version(){return EA}static get workerCount(){return hi.workerCount}static set workerCount(s){hi.workerCount=s}static get maxParallelImageRequests(){return n.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(s){n.c.MAX_PARALLEL_IMAGE_REQUESTS=s}static get workerUrl(){return n.c.WORKER_URL}static set workerUrl(s){n.c.WORKER_URL=s}static addProtocol(s,c){n.c.REGISTERED_PROTOCOLS[s]=c}static removeProtocol(s){delete n.c.REGISTERED_PROTOCOLS[s]}}return yr.Map=class extends gu{constructor(I){if(n.bg.mark(n.bh.create),(I=n.e({},Ni,I)).minZoom!=null&&I.maxZoom!=null&&I.minZoom>I.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(I.minPitch!=null&&I.maxPitch!=null&&I.minPitch>I.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(I.minPitch!=null&&I.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(I.maxPitch!=null&&I.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new _a(I.minZoom,I.maxZoom,I.minPitch,I.maxPitch,I.renderWorldCopies),{bearingSnap:I.bearingSnap}),this._cooperativeGesturesOnWheel=s=>{this._onCooperativeGesture(s,s[this._metaKey],1)},this._contextLost=s=>{s.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new n.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new n.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=I.interactive,this._cooperativeGestures=I.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=I.maxTileCacheSize,this._maxTileCacheZoomLevels=I.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=I.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=I.preserveDrawingBuffer,this._antialias=I.antialias,this._trackResize=I.trackResize,this._bearingSnap=I.bearingSnap,this._refreshExpiredTiles=I.refreshExpiredTiles,this._fadeDuration=I.fadeDuration,this._crossSourceCollisions=I.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=I.collectResourceTiming,this._renderTaskQueue=new Ql,this._controls=[],this._mapId=n.a2(),this._locale=n.e({},wc,I.locale),this._clickTolerance=I.clickTolerance,this._overridePixelRatio=I.pixelRatio,this._maxCanvasSize=I.maxCanvasSize,this.transformCameraUpdate=I.transformCameraUpdate,this._imageQueueHandle=O.addThrottleControl(()=>this.isMoving()),this._requestManager=new tt(I.transformRequest),typeof I.container=="string"){if(this._container=document.getElementById(I.container),!this._container)throw new Error(`Container '${I.container}' not found.`)}else{if(!(I.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=I.container}if(I.maxBounds&&this.setMaxBounds(I.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1,c=sa(d=>{this._trackResize&&!this._removed&&this.resize(d)._update()},50);this._resizeObserver=new ResizeObserver(d=>{s?c(d):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new vc(this,I),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=I.hash&&new Da(typeof I.hash=="string"&&I.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:I.center,zoom:I.zoom,bearing:I.bearing,pitch:I.pitch}),I.bounds&&(this.resize(),this.fitBounds(I.bounds,n.e({},I.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=I.localIdeographFontFamily,this._validateStyle=I.validateStyle,I.style&&this.setStyle(I.style,{localIdeographFontFamily:I.localIdeographFontFamily}),I.attributionControl&&this.addControl(new xs({customAttribution:I.customAttribution})),I.maplibreLogo&&this.addControl(new Yr,I.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new n.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new n.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new n.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(I,s){if(s===void 0&&(s=I.getDefaultPosition?I.getDefaultPosition():"top-right"),!I||!I.onAdd)return this.fire(new n.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let c=I.onAdd(this);this._controls.push(I);let d=this._controlPositions[s];return s.indexOf("bottom")!==-1?d.insertBefore(c,d.firstChild):d.appendChild(c),this}removeControl(I){if(!I||!I.onRemove)return this.fire(new n.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let s=this._controls.indexOf(I);return s>-1&&this._controls.splice(s,1),I.onRemove(this),this}hasControl(I){return this._controls.indexOf(I)>-1}calculateCameraOptionsFromTo(I,s,c,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(c,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(I,s,c,d)}resize(I){var s;let c=this._containerDimensions(),d=c[0],C=c[1],y=this._getClampedPixelRatio(d,C);if(this._resizeCanvas(d,C,y),this.painter.resize(d,C,y),this.painter.overLimit()){let L=this.painter.context.gl;this._maxCanvasSize=[L.drawingBufferWidth,L.drawingBufferHeight];let R=this._getClampedPixelRatio(d,C);this._resizeCanvas(d,C,R),this.painter.resize(d,C,R)}this.transform.resize(d,C),(s=this._requestedCameraState)===null||s===void 0||s.resize(d,C);let F=!this._moving;return F&&(this.stop(),this.fire(new n.k("movestart",I)).fire(new n.k("move",I))),this.fire(new n.k("resize",I)),F&&this.fire(new n.k("moveend",I)),this}_getClampedPixelRatio(I,s){let{0:c,1:d}=this._maxCanvasSize,C=this.getPixelRatio(),y=I*C,F=s*C;return Math.min(y>c?c/y:1,F>d?d/F:1)*C}getPixelRatio(){var I;return(I=this._overridePixelRatio)!==null&&I!==void 0?I:devicePixelRatio}setPixelRatio(I){this._overridePixelRatio=I,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(I){return this.transform.setMaxBounds(fe.convert(I)),this._update()}setMinZoom(I){if((I=I??-2)>=-2&&I<=this.transform.maxZoom)return this.transform.minZoom=I,this._update(),this.getZoom()<I&&this.setZoom(I),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(I){if((I=I??22)>=this.transform.minZoom)return this.transform.maxZoom=I,this._update(),this.getZoom()>I&&this.setZoom(I),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(I){if((I=I??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(I>=0&&I<=this.transform.maxPitch)return this.transform.minPitch=I,this._update(),this.getPitch()<I&&this.setPitch(I),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(I){if((I=I??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(I>=this.transform.minPitch)return this.transform.maxPitch=I,this._update(),this.getPitch()>I&&this.setPitch(I),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(I){return this.transform.renderWorldCopies=I,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(I){return this._cooperativeGestures=I,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(I){return this.transform.locationPoint(n.L.convert(I),this.style&&this.terrain)}unproject(I){return this.transform.pointLocation(n.P.convert(I),this.terrain)}isMoving(){var I;return this._moving||((I=this.handlers)===null||I===void 0?void 0:I.isMoving())}isZooming(){var I;return this._zooming||((I=this.handlers)===null||I===void 0?void 0:I.isZooming())}isRotating(){var I;return this._rotating||((I=this.handlers)===null||I===void 0?void 0:I.isRotating())}_createDelegatedListener(I,s,c){if(I==="mouseenter"||I==="mouseover"){let d=!1;return{layer:s,listener:c,delegates:{mousemove:y=>{let F=this.getLayer(s)?this.queryRenderedFeatures(y.point,{layers:[s]}):[];F.length?d||(d=!0,c.call(this,new Qn(I,this,y.originalEvent,{features:F}))):d=!1},mouseout:()=>{d=!1}}}}if(I==="mouseleave"||I==="mouseout"){let d=!1;return{layer:s,listener:c,delegates:{mousemove:F=>{(this.getLayer(s)?this.queryRenderedFeatures(F.point,{layers:[s]}):[]).length?d=!0:d&&(d=!1,c.call(this,new Qn(I,this,F.originalEvent)))},mouseout:F=>{d&&(d=!1,c.call(this,new Qn(I,this,F.originalEvent)))}}}}{let d=C=>{let y=this.getLayer(s)?this.queryRenderedFeatures(C.point,{layers:[s]}):[];y.length&&(C.features=y,c.call(this,C),delete C.features)};return{layer:s,listener:c,delegates:{[I]:d}}}}on(I,s,c){if(c===void 0)return super.on(I,s);let d=this._createDelegatedListener(I,s,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[I]=this._delegatedListeners[I]||[],this._delegatedListeners[I].push(d);for(let C in d.delegates)this.on(C,d.delegates[C]);return this}once(I,s,c){if(c===void 0)return super.once(I,s);let d=this._createDelegatedListener(I,s,c);for(let C in d.delegates)this.once(C,d.delegates[C]);return this}off(I,s,c){return c===void 0?super.off(I,s):(this._delegatedListeners&&this._delegatedListeners[I]&&(d=>{let C=this._delegatedListeners[I];for(let y=0;y<C.length;y++){let F=C[y];if(F.layer===s&&F.listener===c){for(let L in F.delegates)this.off(L,F.delegates[L]);return C.splice(y,1),this}}})(),this)}queryRenderedFeatures(I,s){if(!this.style)return[];let c,d=I instanceof n.P||Array.isArray(I),C=d?I:[[0,0],[this.transform.width,this.transform.height]];if(s=s||(d?{}:I)||{},C instanceof n.P||typeof C[0]=="number")c=[n.P.convert(C)];else{let y=n.P.convert(C[0]),F=n.P.convert(C[1]);c=[y,new n.P(F.x,y.y),F,new n.P(y.x,F.y),y]}return this.style.queryRenderedFeatures(c,s,this.transform)}querySourceFeatures(I,s){return this.style.querySourceFeatures(I,s)}setStyle(I,s){return(s=n.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&I?(this._diffStyle(I,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(I,s))}setTransformRequest(I){return this._requestManager.setTransformRequest(I),this}_getUIString(I){let s=this._locale[I];if(s==null)throw new Error(`Missing UI string '${I}'`);return s}_updateStyle(I,s){if(s.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(I,s));let c=this.style&&s.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!I)),I?(this.style=new zr(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof I=="string"?this.style.loadURL(I,s,c):this.style.loadJSON(I,s,c),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new zr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(I,s){if(typeof I=="string"){let c=this._requestManager.transformRequest(I,P.Style);n.f(c,(d,C)=>{d?this.fire(new n.j(d)):C&&this._updateDiff(C,s)})}else typeof I=="object"&&this._updateDiff(I,s)}_updateDiff(I,s){try{this.style.setState(I,s)&&this._update(!0)}catch(c){n.w(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(I,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():n.w("There is no style added to the map.")}addSource(I,s){return this._lazyInitEmptyStyle(),this.style.addSource(I,s),this._update(!0)}isSourceLoaded(I){let s=this.style&&this.style.sourceCaches[I];if(s!==void 0)return s.loaded();this.fire(new n.j(new Error(`There is no source with ID '${I}'`)))}setTerrain(I){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),I){let s=this.style.sourceCaches[I.source];if(!s)throw new Error(`cannot load terrain, because there exists no source with ID: ${I.source}`);for(let c in this.style._layers){let d=this.style._layers[c];d.type==="hillshade"&&d.source===I.source&&n.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ul(this.painter,s,I),this.painter.renderToTexture=new Gl(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=c=>{c.dataType==="style"?this.terrain.sourceCache.freeRtt():c.dataType==="source"&&c.tile&&(c.sourceId!==I.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(c.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new n.k("terrain",{terrain:I})),this}getTerrain(){var I,s;return(s=(I=this.terrain)===null||I===void 0?void 0:I.options)!==null&&s!==void 0?s:null}areTilesLoaded(){let I=this.style&&this.style.sourceCaches;for(let s in I){let c=I[s]._tiles;for(let d in c){let C=c[d];if(C.state!=="loaded"&&C.state!=="errored")return!1}}return!0}addSourceType(I,s,c){return this._lazyInitEmptyStyle(),this.style.addSourceType(I,s,c)}removeSource(I){return this.style.removeSource(I),this._update(!0)}getSource(I){return this.style.getSource(I)}addImage(I,s,c={}){let{pixelRatio:d=1,sdf:C=!1,stretchX:y,stretchY:F,content:L}=c;if(this._lazyInitEmptyStyle(),!(s instanceof HTMLImageElement||n.a(s))){if(s.width===void 0||s.height===void 0)return this.fire(new n.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:R,height:N,data:D}=s,W=s;return this.style.addImage(I,{data:new n.R({width:R,height:N},new Uint8Array(D)),pixelRatio:d,stretchX:y,stretchY:F,content:L,sdf:C,version:0,userImage:W}),W.onAdd&&W.onAdd(this,I),this}}{let{width:R,height:N,data:D}=n.h.getImageData(s);this.style.addImage(I,{data:new n.R({width:R,height:N},D),pixelRatio:d,stretchX:y,stretchY:F,content:L,sdf:C,version:0})}}updateImage(I,s){let c=this.style.getImage(I);if(!c)return this.fire(new n.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let d=s instanceof HTMLImageElement||n.a(s)?n.h.getImageData(s):s,{width:C,height:y,data:F}=d;if(C===void 0||y===void 0)return this.fire(new n.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==c.data.width||y!==c.data.height)return this.fire(new n.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));let L=!(s instanceof HTMLImageElement||n.a(s));return c.data.replace(F,L),this.style.updateImage(I,c),this}getImage(I){return this.style.getImage(I)}hasImage(I){return I?!!this.style.getImage(I):(this.fire(new n.j(new Error("Missing required image id"))),!1)}removeImage(I){this.style.removeImage(I)}loadImage(I,s){O.getImage(this._requestManager.transformRequest(I,P.Image),s)}listImages(){return this.style.listImages()}addLayer(I,s){return this._lazyInitEmptyStyle(),this.style.addLayer(I,s),this._update(!0)}moveLayer(I,s){return this.style.moveLayer(I,s),this._update(!0)}removeLayer(I){return this.style.removeLayer(I),this._update(!0)}getLayer(I){return this.style.getLayer(I)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(I,s,c){return this.style.setLayerZoomRange(I,s,c),this._update(!0)}setFilter(I,s,c={}){return this.style.setFilter(I,s,c),this._update(!0)}getFilter(I){return this.style.getFilter(I)}setPaintProperty(I,s,c,d={}){return this.style.setPaintProperty(I,s,c,d),this._update(!0)}getPaintProperty(I,s){return this.style.getPaintProperty(I,s)}setLayoutProperty(I,s,c,d={}){return this.style.setLayoutProperty(I,s,c,d),this._update(!0)}getLayoutProperty(I,s){return this.style.getLayoutProperty(I,s)}setGlyphs(I,s={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(I,s),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(I,s,c={}){return this._lazyInitEmptyStyle(),this.style.addSprite(I,s,c,d=>{d||this._update(!0)}),this}removeSprite(I){return this._lazyInitEmptyStyle(),this.style.removeSprite(I),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(I,s={}){return this._lazyInitEmptyStyle(),this.style.setSprite(I,s,c=>{c||this._update(!0)}),this}setLight(I,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(I,s),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(I,s){return this.style.setFeatureState(I,s),this._update()}removeFeatureState(I,s){return this.style.removeFeatureState(I,s),this._update()}getFeatureState(I){return this.style.getFeatureState(I)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let I=0,s=0;return this._container&&(I=this._container.clientWidth||400,s=this._container.clientHeight||300),[I,s]}_setupContainer(){let I=this._container;I.classList.add("maplibregl-map");let s=this._canvasContainer=h.create("div","maplibregl-canvas-container",I);this._interactive&&s.classList.add("maplibregl-interactive"),this._canvas=h.create("canvas","maplibregl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let c=this._containerDimensions(),d=this._getClampedPixelRatio(c[0],c[1]);this._resizeCanvas(c[0],c[1],d);let C=this._controlContainer=h.create("div","maplibregl-control-container",I),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(F=>{y[F]=h.create("div",`maplibregl-ctrl-${F} `,C)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=h.create("div","maplibregl-cooperative-gesture-screen",this._container);let I=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(I=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${I}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){h.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(I,s,c){this._canvas.width=Math.floor(c*I),this._canvas.height=Math.floor(c*s),this._canvas.style.width=`${I}px`,this._canvas.style.height=`${s}px`}_setupPainter(){let I={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},s=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{s={requestedAttributes:I},d&&(s.statusMessage=d.statusMessage,s.type=d.type)},{once:!0});let c=this._canvas.getContext("webgl2",I)||this._canvas.getContext("webgl",I);if(!c){let d="Failed to initialize WebGL";throw s?(s.message=d,new Error(JSON.stringify(s))):new Error(d)}this.painter=new ra(c,this.transform),m.testSupport(c)}_onCooperativeGesture(I,s,c){return!s&&c<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(I){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||I,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(I){return this._update(),this._renderTaskQueue.add(I)}_cancelRenderFrame(I){this._renderTaskQueue.remove(I)}_render(I){let s=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(I),this._removed)return;let c=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let C=this.transform.zoom,y=n.h.now();this.style.zoomHistory.update(C,y);let F=new n.a8(C,{now:y,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),L=F.crossFadingFactor();L===1&&L===this._crossFadingFactor||(c=!0,this._crossFadingFactor=L),this.style.update(F)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,showPadding:this.showPadding}),this.fire(new n.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,n.bg.mark(n.bh.load),this.fire(new n.k("load"))),this.style&&(this.style.hasTransitions()||c)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new n.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,n.bg.mark(n.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var I;this._hash&&this._hash.remove();for(let c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),O.removeThrottleControl(this._imageQueueHandle),(I=this._resizeObserver)===null||I===void 0||I.disconnect();let s=this.painter.context.gl.getExtension("WEBGL_lose_context");s&&s.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),h.remove(this._canvasContainer),h.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),n.bg.clearMetrics(),this._removed=!0,this.fire(new n.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=n.h.frame(I=>{n.bg.frame(I),this._frame=null,this._render(I)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(I){this._showTileBoundaries!==I&&(this._showTileBoundaries=I,this._update())}get showPadding(){return!!this._showPadding}set showPadding(I){this._showPadding!==I&&(this._showPadding=I,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(I){this._showCollisionBoxes!==I&&(this._showCollisionBoxes=I,I?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(I){this._showOverdrawInspector!==I&&(this._showOverdrawInspector=I,this._update())}get repaint(){return!!this._repaint}set repaint(I){this._repaint!==I&&(this._repaint=I,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(I){this._vertices=I,this._update()}get version(){return Fi}getCameraTargetElevation(){return this.transform.elevation}},yr.NavigationControl=class{constructor(I){this._updateZoomButtons=()=>{let s=this._map.getZoom(),c=s===this._map.getMaxZoom(),d=s===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{let s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=s},this._setButtonTitle=(s,c)=>{let d=this._map._getUIString(`NavigationControl.${c}`);s.title=d,s.setAttribute("aria-label",d)},this.options=n.e({},_c,I),this._container=h.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),h.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),h.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=h.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(I){return this._map=I,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){h.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(I,s){let c=h.create("button",I,this._container);return c.type="button",c.addEventListener("click",s),c}},yr.GeolocateControl=class extends n.E{constructor(I){super(),this._onSuccess=s=>{if(this._map){if(this._isOutOfMapMaxBounds(s))return this._setErrorState(),this.fire(new n.k("outofmaxbounds",s)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=s,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(s),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(s),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new n.k("geolocate",s)),this._finish()}},this._updateCamera=s=>{let c=new n.L(s.coords.longitude,s.coords.latitude),d=s.coords.accuracy,C=this._map.getBearing(),y=n.e({bearing:C},this.options.fitBoundsOptions),F=fe.fromLngLat(c,d);this._map.fitBounds(F,y,{geolocateSource:!0})},this._updateMarker=s=>{if(s){let c=new n.L(s.coords.longitude,s.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=s.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=s=>{if(this._map){if(this.options.trackUserLocation)if(s.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(s.code===3&&Dn)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new n.k("error",s)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=s=>{if(this._map){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=h.create("button","maplibregl-ctrl-geolocate",this._container),h.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",s===!1){n.w("Geolocation support is not available so the GeolocateControl will be disabled.");let c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{let c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=h.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Xa({element:this._dotElement}),this._circleElement=h.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Xa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new n.k("trackuserlocationend")))})}},this.options=n.e({},rn,I)}onAdd(I){return this._map=I,this._container=h.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(s,c=!1){yn===void 0||c?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(d=>{yn=d.state!=="denied",s(yn)}).catch(()=>{yn=!!window.navigator.geolocation,s(yn)}):(yn=!!window.navigator.geolocation,s(yn)):s(yn)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),h.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Er=0,Dn=!1}_isOutOfMapMaxBounds(I){let s=this._map.getMaxBounds(),c=I.coords;return s&&(c.longitude<s.getWest()||c.longitude>s.getEast()||c.latitude<s.getSouth()||c.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let I=this._map.getBounds(),s=I.getSouthEast(),c=I.getNorthEast(),d=s.distanceTo(c),C=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${C}px`,this._circleElement.style.height=`${C}px`}trigger(){if(!this._setup)return n.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new n.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Er--,Dn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new n.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new n.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let I;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Er++,Er>1?(I={maximumAge:6e5,timeout:0},Dn=!0):(I=this.options.positionOptions,Dn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,I)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},yr.AttributionControl=xs,yr.LogoControl=Yr,yr.ScaleControl=class{constructor(I){this._onMove=()=>{nl(this._map,this._container,this.options)},this.setUnit=s=>{this.options.unit=s,nl(this._map,this._container,this.options)},this.options=n.e({},rl,I)}getDefaultPosition(){return"bottom-left"}onAdd(I){return this._map=I,this._container=h.create("div","maplibregl-ctrl maplibregl-ctrl-scale",I.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){h.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},yr.FullscreenControl=class extends n.E{constructor(I={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,I&&I.container&&(I.container instanceof HTMLElement?this._container=I.container:n.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(I){return this._map=I,this._container||(this._container=this._map.getContainer()),this._controlContainer=h.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){h.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let I=this._fullscreenButton=h.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);h.create("span","maplibregl-ctrl-icon",I).setAttribute("aria-hidden","true"),I.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let I=this._getTitle();this._fullscreenButton.setAttribute("aria-label",I),this._fullscreenButton.title=I}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new n.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new n.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},yr.TerrainControl=class{constructor(I){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=I}onAdd(I){return this._map=I,this._container=h.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=h.create("button","maplibregl-ctrl-terrain",this._container),h.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){h.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},yr.Popup=class extends n.E{constructor(I){super(),this.remove=()=>(this._content&&h.remove(this._content),this._container&&(h.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new n.k("close")),this),this._onMouseUp=s=>{this._update(s.point)},this._onMouseMove=s=>{this._update(s.point)},this._onDrag=s=>{this._update(s.point)},this._update=s=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=h.create("div","maplibregl-popup",this._map.getContainer()),this._tip=h.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let F of this.options.className.split(" "))this._container.classList.add(F);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Mo(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!s)return;let c=this._pos=this._trackPointer&&s?s:this._map.project(this._lngLat),d=this.options.anchor,C=Ya(this.options.offset);if(!d){let F=this._container.offsetWidth,L=this._container.offsetHeight,R;R=c.y+C.bottom.y<L?["top"]:c.y>this._map.transform.height-L?["bottom"]:[],c.x<F/2?R.push("left"):c.x>this._map.transform.width-F/2&&R.push("right"),d=R.length===0?"bottom":R.join("-")}let y=c.add(C[d]).round();h.setTransform(this._container,`${Cn[d]} translate(${y.x}px,${y.y}px)`),Vo(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=n.e(Object.create(Rl),I)}addTo(I){return this._map&&this.remove(),this._map=I,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new n.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(I){return this._lngLat=n.L.convert(I),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(I){return this.setDOMContent(document.createTextNode(I))}setHTML(I){let s=document.createDocumentFragment(),c=document.createElement("body"),d;for(c.innerHTML=I;d=c.firstChild,d;)s.appendChild(d);return this.setDOMContent(s)}getMaxWidth(){var I;return(I=this._container)===null||I===void 0?void 0:I.style.maxWidth}setMaxWidth(I){return this.options.maxWidth=I,this._update(),this}setDOMContent(I){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=h.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(I),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(I){this._container&&this._container.classList.add(I)}removeClassName(I){this._container&&this._container.classList.remove(I)}setOffset(I){return this.options.offset=I,this._update(),this}toggleClassName(I){if(this._container)return this._container.classList.toggle(I)}_createCloseButton(){this.options.closeButton&&(this._closeButton=h.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let I=this._container.querySelector(Zl);I&&I.focus()}},yr.Marker=Xa,yr.Style=zr,yr.LngLat=n.L,yr.LngLatBounds=fe,yr.Point=n.P,yr.MercatorCoordinate=n.U,yr.Evented=n.E,yr.AJAXError=n.bi,yr.config=n.c,yr.CanvasSource=Ve,yr.GeoJSONSource=Xt,yr.ImageSource=me,yr.RasterDEMTileSource=Vt,yr.RasterTileSource=bt,yr.VectorTileSource=It,yr.VideoSource=be,yr.setRTLTextPlugin=n.bj,yr.getRTLTextPluginStatus=n.bk,yr.prewarm=function(){Pi().acquire(Re)},yr.clearPrewarmedResources=function(){let I=Qi;I&&(I.isPreloaded()&&I.numActive()===1?(I.release(Re),Qi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Sc.extend(yr,{isSafari:n.ac,getPerformanceMetrics:n.bg.getPerformanceMetrics}),yr});var l=e;return l})});var fb=da((wd,Bd)=>{(function(i,t){typeof wd=="object"&&typeof Bd<"u"?t(wd):typeof define=="function"&&define.amd?define(["exports"],t):t((i=typeof globalThis<"u"?globalThis:i||self).VectorTextProtocol={})})(wd,function(i){"use strict";function t(pt){return pt&&pt.__esModule&&Object.prototype.hasOwnProperty.call(pt,"default")?pt.default:pt}function e(pt){if(pt.__esModule)return pt;var ft=pt.default;if(typeof ft=="function"){var ut=function Zt(){return this instanceof Zt?Reflect.construct(ft,arguments,this.constructor):ft.apply(this,arguments)};ut.prototype=ft.prototype}else ut={};return Object.defineProperty(ut,"__esModule",{value:!0}),Object.keys(pt).forEach(function(Zt){var Kt=Object.getOwnPropertyDescriptor(pt,Zt);Object.defineProperty(ut,Zt,Kt.get?Kt:{enumerable:!0,get:function(){return pt[Zt]}})}),ut}function o(pt){return new Function("d","return {"+pt.map(function(ft,ut){return JSON.stringify(ft)+": d["+ut+"]"}).join(",")+"}")}function l(pt){var ft=new RegExp('["'+pt+`
]`),ut=pt.charCodeAt(0);function Zt(ge,Ue){var Ee,Se,le={},ke={},Te=[],Pe=ge.length,Gi=0,Zi=0;function Je(){if(Gi>=Pe)return ke;if(Se)return Se=!1,le;var Ci,Ti=Gi;if(ge.charCodeAt(Ti)===34){for(var Xi=Ti;Xi++<Pe;)if(ge.charCodeAt(Xi)===34){if(ge.charCodeAt(Xi+1)!==34)break;++Xi}return Gi=Xi+2,(Ci=ge.charCodeAt(Xi+1))===13?(Se=!0,ge.charCodeAt(Xi+2)===10&&++Gi):Ci===10&&(Se=!0),ge.slice(Ti+1,Xi).replace(/""/g,'"')}for(;Gi<Pe;){var fr=1;if((Ci=ge.charCodeAt(Gi++))===10)Se=!0;else if(Ci===13)Se=!0,ge.charCodeAt(Gi)===10&&(++Gi,++fr);else if(Ci!==ut)continue;return ge.slice(Ti,Gi-fr)}return ge.slice(Ti)}for(;(Ee=Je())!==ke;){for(var Me=[];Ee!==le&&Ee!==ke;)Me.push(Ee),Ee=Je();Ue&&(Me=Ue(Me,Zi++))==null||Te.push(Me)}return Te}function Kt(ge){return ge.map(ie).join(pt)}function ie(ge){return ge==null?"":ft.test(ge+="")?'"'+ge.replace(/\"/g,'""')+'"':ge}return{parse:function(ge,Ue){var Ee,Se,le=Zt(ge,function(ke,Te){if(Ee)return Ee(ke,Te-1);Se=ke,Ee=Ue?function(Pe,Gi){var Zi=o(Pe);return function(Je,Me){return Gi(Zi(Je),Me,Pe)}}(ke,Ue):o(ke)});return le.columns=Se,le},parseRows:Zt,format:function(ge,Ue){return Ue==null&&(Ue=function(Ee){var Se=Object.create(null),le=[];return Ee.forEach(function(ke){for(var Te in ke)Te in Se||le.push(Se[Te]=Te)}),le}(ge)),[Ue.map(ie).join(pt)].concat(ge.map(function(Ee){return Ue.map(function(Se){return ie(Ee[Se])}).join(pt)})).join(`
`)},formatRows:function(ge){return ge.map(Kt).join(`
`)}}}var n=l(","),g=n.parse,h=n.parseRows,m=n.format,B=n.formatRows,_=l("	"),E=_.parse,G=_.parseRows,S=_.format,O=_.formatRows,P=e(Object.freeze({__proto__:null,csvFormat:m,csvFormatRows:B,csvParse:g,csvParseRows:h,dsvFormat:l,tsvFormat:S,tsvFormatRows:O,tsvParse:E,tsvParseRows:G})),tt={exports:{}};function z(pt,ft){var ut=rt(pt,ft);return ut.whole+"\xB0 "+(ut.minutes?ut.minutes+"' ":"")+(ut.seconds?ut.seconds+'" ':"")+ut.dir}function rt(pt,ft){var ut=({lat:["N","S"],lon:["E","W"]}[ft]||"")[pt>=0?0:1],Zt=Math.abs(pt),Kt=Math.floor(Zt),ie=60*(Zt-Kt),ge=Math.floor(ie);return{whole:Kt,minutes:ge,seconds:Math.floor(60*(ie-ge)),dir:ut}}function ct(pt,ft){if(ft||(ft="NSEW"),typeof pt!="string")return null;var ut=(pt=pt.toUpperCase()).match(/^[\s\,]*([NSEW])?\s*([\-|\—|\―]?[0-9.]+)[°º˚]?\s*(?:([0-9.]+)['’′‘]\s*)?(?:([0-9.]+)(?:''|"|”|″)\s*)?([NSEW])?/);if(!ut)return null;var Zt,Kt=ut[0];if(ut[1]&&ut[5]?(Zt=ut[1],Kt=Kt.slice(0,-1)):Zt=ut[1]||ut[5],Zt&&ft.indexOf(Zt)===-1)return null;var ie=ut[2]?parseFloat(ut[2]):0,ge=ut[3]?parseFloat(ut[3])/60:0,Ue=ut[4]?parseFloat(ut[4])/3600:0,Ee=ie<0?-1:1;return Zt!=="S"&&Zt!=="W"||(Ee*=-1),{val:(Math.abs(ie)+ge+Ue)*Ee,dim:Zt,matched:Kt,remain:pt.slice(Kt.length)}}tt.exports=function(pt,ft){var ut=ct(pt,ft);return ut===null?null:ut.val},tt.exports.pair=function(pt,ft){var ut=ct(pt=pt.trim(),ft);if(!ut)return null;var Zt=ct(pt=ut.remain.trim(),ft);return!Zt||Zt.remain?null:ut.dim?function(Kt,ie,ge){if(ge==="N"||ge==="S")return[Kt,ie];if(ge==="W"||ge==="E")return[ie,Kt]}(ut.val,Zt.val,ut.dim):[ut.val,Zt.val]},tt.exports.format=z,tt.exports.formatPair=function(pt){return z(pt.lat,"lat")+" "+z(pt.lon,"lon")},tt.exports.coordToDMS=rt;var Et=tt.exports,Pt=P,Qt=Et,Ut=/(Lat)(itude)?/gi,dt=/(L)(on|ng)(gitude)?/i;function ee(pt,ft){var ut,Zt,Kt;for(var ie in pt)(Zt=ie.match(ft))&&(!ut||Zt[0].length/ie.length>Kt)&&(Kt=Zt[0].length/ie.length,ut=ie);return ut}function oe(pt){return ee(pt,Ut)}function ht(pt){return ee(pt,dt)}function At(pt){return typeof pt=="object"?Object.keys(pt).length:0}function Ft(pt){var ft=[];return[",",";","	","|"].forEach(function(ut){var Zt=Pt.dsvFormat(ut).parse(pt);if(Zt.length>=1){for(var Kt=At(Zt[0]),ie=0;ie<Zt.length;ie++)if(At(Zt[ie])!==Kt)return;ft.push({delimiter:ut,arity:Object.keys(Zt[0]).length})}}),ft.length?ft.sort(function(ut,Zt){return Zt.arity-ut.arity})[0].delimiter:null}var St={isLon:function(pt){return!!pt.match(dt)},isLat:function(pt){return!!pt.match(Ut)},guessLatHeader:oe,guessLonHeader:ht,csv:Pt.csvParse,tsv:Pt.tsvParse,dsv:Pt,auto:function(pt){var ft=Ft(pt);return ft?function(ut){return delete ut.columns,ut}(Pt.dsvFormat(ft).parse(pt)):null},csv2geojson:function(pt,ft,ut){ut||(ut=ft,ft={}),ft.delimiter=ft.delimiter||",";var Zt=ft.latfield||"",Kt=ft.lonfield||"",ie=ft.crs||"",ge=[],Ue={type:"FeatureCollection",features:ge};if(ie!==""&&(Ue.crs={type:"name",properties:{name:ie}}),ft.delimiter!=="auto"||typeof pt!="string"||(ft.delimiter=Ft(pt),ft.delimiter)){var Ee=ft.numericFields?ft.numericFields.split(","):null,Se=typeof pt=="string"?Pt.dsvFormat(ft.delimiter).parse(pt,function(Me){if(Ee)for(var Ci in Me)Ee.includes(Ci)&&(Me[Ci]=+Me[Ci]);return Me}):pt;if(Se.length){var le,ke=[];if(Zt||(Zt=oe(Se[0])),Kt||(Kt=ht(Se[0])),!Zt||!Kt){for(le=0;le<Se.length;le++)ge.push({type:"Feature",properties:Se[le],geometry:null});ut(ke.length?ke:null,Ue)}else{for(le=0;le<Se.length;le++)if(Se[le][Kt]!==void 0&&Se[le][Zt]!==void 0){var Te,Pe,Gi,Zi=Se[le][Kt],Je=Se[le][Zt];(Gi=Qt(Zi,"EW"))&&(Zi=Gi),(Gi=Qt(Je,"NS"))&&(Je=Gi),Te=parseFloat(Zi),Pe=parseFloat(Je),isNaN(Te)||isNaN(Pe)?ke.push({message:"A row contained an invalid value for latitude or longitude",row:Se[le],index:le}):(ft.includeLatLon||(delete Se[le][Kt],delete Se[le][Zt]),ge.push({type:"Feature",properties:Se[le],geometry:{type:"Point",coordinates:[parseFloat(Te),parseFloat(Pe)]}}))}ut(ke.length?ke:null,Ue)}}else ut(null,Ue)}else ut({type:"Error",message:"Could not autodetect delimiter"})},toLine:function(pt){for(var ft=pt.features,ut={type:"Feature",geometry:{type:"LineString",coordinates:[]}},Zt=0;Zt<ft.length;Zt++)ut.geometry.coordinates.push(ft[Zt].geometry.coordinates);return ut.properties=ft.reduce(function(Kt,ie){for(var ge in ie.properties)Kt[ge]||(Kt[ge]=[]),Kt[ge].push(ie.properties[ge]);return Kt},{}),{type:"FeatureCollection",features:[ut]}},toPolygon:function(pt){for(var ft=pt.features,ut={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},Zt=0;Zt<ft.length;Zt++)ut.geometry.coordinates[0].push(ft[Zt].geometry.coordinates);return ut.properties=ft.reduce(function(Kt,ie){for(var ge in ie.properties)Kt[ge]||(Kt[ge]=[]),Kt[ge].push(ie.properties[ge]);return Kt},{}),{type:"FeatureCollection",features:[ut]}}};function ue(pt){return pt}function ce(pt,ft){var ut=ft.id,Zt=ft.bbox,Kt=ft.properties==null?{}:ft.properties,ie=function(ge,Ue){var Ee=function(Je){if(Je==null)return ue;var Me,Ci,Ti=Je.scale[0],Xi=Je.scale[1],fr=Je.translate[0],mi=Je.translate[1];return function(Rr,Kr){Kr||(Me=Ci=0);var Mr=2,tn=Rr.length,En=new Array(tn);for(En[0]=(Me+=Rr[0])*Ti+fr,En[1]=(Ci+=Rr[1])*Xi+mi;Mr<tn;)En[Mr]=Rr[Mr],++Mr;return En}}(ge.transform),Se=ge.arcs;function le(Je,Me){Me.length&&Me.pop();for(var Ci=Se[Je<0?~Je:Je],Ti=0,Xi=Ci.length;Ti<Xi;++Ti)Me.push(Ee(Ci[Ti],Ti));Je<0&&function(fr,mi){for(var Rr,Kr=fr.length,Mr=Kr-mi;Mr<--Kr;)Rr=fr[Mr],fr[Mr++]=fr[Kr],fr[Kr]=Rr}(Me,Xi)}function ke(Je){return Ee(Je)}function Te(Je){for(var Me=[],Ci=0,Ti=Je.length;Ci<Ti;++Ci)le(Je[Ci],Me);return Me.length<2&&Me.push(Me[0]),Me}function Pe(Je){for(var Me=Te(Je);Me.length<4;)Me.push(Me[0]);return Me}function Gi(Je){return Je.map(Pe)}function Zi(Je){var Me,Ci=Je.type;switch(Ci){case"GeometryCollection":return{type:Ci,geometries:Je.geometries.map(Zi)};case"Point":Me=ke(Je.coordinates);break;case"MultiPoint":Me=Je.coordinates.map(ke);break;case"LineString":Me=Te(Je.arcs);break;case"MultiLineString":Me=Je.arcs.map(Te);break;case"Polygon":Me=Gi(Je.arcs);break;case"MultiPolygon":Me=Je.arcs.map(Gi);break;default:return null}return{type:Ci,coordinates:Me}}return Zi(Ue)}(pt,ft);return ut==null&&Zt==null?{type:"Feature",properties:Kt,geometry:ie}:Zt==null?{type:"Feature",id:ut,properties:Kt,geometry:ie}:{type:"Feature",id:ut,bbox:Zt,properties:Kt,geometry:ie}}function ae(pt,ft){return Array.from(pt.getElementsByTagName(ft))}function se(pt){return pt[0]==="#"?pt:`#${pt}`}function Lt(pt){return pt?.normalize(),pt&&pt.textContent||""}function Ht(pt,ft,ut){let Zt=pt.getElementsByTagName(ft),Kt=Zt.length?Zt[0]:null;return Kt&&ut&&ut(Kt),Kt}function fe(pt,ft,ut){let Zt={};if(!pt)return Zt;let Kt=pt.getElementsByTagName(ft),ie=Kt.length?Kt[0]:null;return ie&&ut?ut(ie,Zt):Zt}function j(pt,ft,ut){let Zt=Lt(Ht(pt,ft));return Zt&&ut&&ut(Zt)||{}}function It(pt,ft,ut){let Zt=parseFloat(Lt(Ht(pt,ft)));if(!isNaN(Zt))return Zt&&ut&&ut(Zt)||{}}function bt(pt,ft,ut){let Zt=parseFloat(Lt(Ht(pt,ft)));if(!isNaN(Zt))return ut&&ut(Zt),Zt}function Vt(pt,ft){let ut={};for(let Zt of ft)j(pt,Zt,Kt=>{ut[Zt]=Kt});return ut}function Xt(pt){return pt?.nodeType===1}function he(pt){return fe(pt,"line",ft=>Object.assign({},j(ft,"color",ut=>({stroke:`#${ut}`})),It(ft,"opacity",ut=>({"stroke-opacity":ut})),It(ft,"width",ut=>({"stroke-width":96*ut/25.4}))))}function me(pt){let ft=[];if(pt===null)return ft;for(let ut of Array.from(pt.childNodes)){if(!Xt(ut))continue;let Zt=be(ut.nodeName);if(Zt==="gpxtpx:TrackPointExtension")ft=ft.concat(me(ut));else{let Kt=Lt(ut);ft.push([Zt,Ve(Kt)])}}return ft}function be(pt){return["heart","gpxtpx:hr","hr"].includes(pt)?"heart":pt}function Ve(pt){let ft=parseFloat(pt);return isNaN(ft)?pt:ft}function De(pt){let ft=[parseFloat(pt.getAttribute("lon")||""),parseFloat(pt.getAttribute("lat")||"")];if(isNaN(ft[0])||isNaN(ft[1]))return null;bt(pt,"ele",Zt=>{ft.push(Zt)});let ut=Ht(pt,"time");return{coordinates:ft,time:ut?Lt(ut):null,extendedValues:me(Ht(pt,"extensions"))}}function ei(pt){let ft=Vt(pt,["name","cmt","desc","type","time","keywords"]),ut=Array.from(pt.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/GpxExtensions/v3","*"));for(let Kt of ut)Kt.parentNode?.parentNode===pt&&(ft[Kt.tagName.replace(":","_")]=Lt(Kt));let Zt=ae(pt,"link");return Zt.length&&(ft.links=Zt.map(Kt=>Object.assign({href:Kt.getAttribute("href")},Vt(Kt,["text","type"])))),ft}function ri(pt,ft){let ut=ae(pt,ft),Zt=[],Kt=[],ie={};for(let ge=0;ge<ut.length;ge++){let Ue=De(ut[ge]);if(Ue){Zt.push(Ue.coordinates),Ue.time&&Kt.push(Ue.time);for(let[Ee,Se]of Ue.extendedValues){let le=Ee==="heart"?Ee:Ee.replace("gpxtpx:","")+"s";ie[le]||(ie[le]=Array(ut.length).fill(null)),ie[le][ge]=Se}}}if(!(Zt.length<2))return{line:Zt,times:Kt,extendedValues:ie}}function Ii(pt){let ft=ri(pt,"rtept");if(ft)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},ei(pt),he(Ht(pt,"extensions"))),geometry:{type:"LineString",coordinates:ft.line}}}function Be(pt){let ft=ae(pt,"trkseg"),ut=[],Zt=[],Kt=[];for(let Ue of ft){let Ee=ri(Ue,"trkpt");Ee&&(Kt.push(Ee),Ee.times&&Ee.times.length&&Zt.push(Ee.times))}if(Kt.length===0)return null;let ie=Kt.length>1,ge=Object.assign({_gpxType:"trk"},ei(pt),he(Ht(pt,"extensions")),Zt.length?{coordinateProperties:{times:ie?Zt:Zt[0]}}:{});for(let Ue of Kt){ut.push(Ue.line),ge.coordinateProperties||(ge.coordinateProperties={});let Ee=ge.coordinateProperties,Se=Object.entries(Ue.extendedValues);for(let le=0;le<Se.length;le++){let[ke,Te]=Se[le];ie?(Ee[ke]||(Ee[ke]=Kt.map(Pe=>new Array(Pe.line.length).fill(null))),Ee[ke][le]=Te):Ee[ke]=Te}}return{type:"Feature",properties:ge,geometry:ie?{type:"MultiLineString",coordinates:ut}:{type:"LineString",coordinates:ut[0]}}}function Rt(pt){let ft=Object.assign(ei(pt),Vt(pt,["sym"])),ut=De(pt);return ut?{type:"Feature",properties:ft,geometry:{type:"Point",coordinates:ut.coordinates}}:null}function*Ui(pt){for(let ft of ae(pt,"trk")){let ut=Be(ft);ut&&(yield ut)}for(let ft of ae(pt,"rte")){let ut=Ii(ft);ut&&(yield ut)}for(let ft of ae(pt,"wpt")){let ut=Rt(ft);ut&&(yield ut)}}let $t="http://www.garmin.com/xmlschemas/ActivityExtension/v2",Ze=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],We=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function He(pt,ft){let ut=[];for(let[Zt,Kt]of ft){let ie=Ht(pt,Zt);if(!ie){let Ue=pt.getElementsByTagNameNS($t,Zt);Ue.length&&(ie=Ue[0])}let ge=parseFloat(Lt(ie));isNaN(ge)||ut.push([Kt,ge])}return ut}function Re(pt){let ft=[bt(pt,"LongitudeDegrees"),bt(pt,"LatitudeDegrees")];if(ft[0]===void 0||isNaN(ft[0])||ft[1]===void 0||isNaN(ft[1]))return null;let ut=Ht(pt,"HeartRateBpm"),Zt=Lt(Ht(pt,"Time"));return Ht(pt,"AltitudeMeters",Kt=>{let ie=parseFloat(Lt(Kt));isNaN(ie)||ft.push(ie)}),{coordinates:ft,time:Zt||null,heartRate:ut?parseFloat(Lt(ut)):null,extensions:He(pt,Ze)}}function hi(pt){let ft=ae(pt,"Trackpoint"),ut=[],Zt=[],Kt=[];if(ft.length<2)return null;let ie={},ge={extendedProperties:ie};for(let Ue=0;Ue<ft.length;Ue++){let Ee=Re(ft[Ue]);if(Ee===null)continue;ut.push(Ee.coordinates);let{time:Se,heartRate:le,extensions:ke}=Ee;Se&&Zt.push(Se),le&&Kt.push(le);for(let[Te,Pe]of ke)ie[Te]||(ie[Te]=Array(ft.length).fill(null)),ie[Te][Ue]=Pe}return ut.length<2?null:Object.assign(ge,{line:ut,times:Zt,heartRates:Kt})}function yi(pt){let ft=ae(pt,"Track"),ut=[],Zt=[],Kt=[],ie=[],ge,Ue=Object.assign(Object.fromEntries(He(pt,We)),fe(pt,"Name",Ee=>({name:Lt(Ee)})));for(let Ee of ft)ge=hi(Ee),ge&&(ut.push(ge.line),ge.times.length&&Zt.push(ge.times),ge.heartRates.length&&Kt.push(ge.heartRates),ie.push(ge.extendedProperties));for(let Ee=0;Ee<ie.length;Ee++){let Se=ie[Ee];for(let le in Se)ft.length===1?ge&&(Ue[le]=ge.extendedProperties[le]):(Ue[le]||(Ue[le]=ut.map(ke=>Array(ke.length).fill(null))),Ue[le][Ee]=Se[le])}return ut.length===0?null:((Zt.length||Kt.length)&&(Ue.coordinateProperties=Object.assign(Zt.length?{times:ut.length===1?Zt[0]:Zt}:{},Kt.length?{heart:ut.length===1?Kt[0]:Kt}:{})),{type:"Feature",properties:Ue,geometry:ut.length===1?{type:"LineString",coordinates:ut[0]}:{type:"MultiLineString",coordinates:ut}})}function*Qi(pt){for(let ft of ae(pt,"Lap")){let ut=yi(ft);ut&&(yield ut)}for(let ft of ae(pt,"Courses")){let ut=yi(ft);ut&&(yield ut)}}function Pi(pt,ft){let ut={},Zt=ft=="stroke"||ft==="fill"?ft:ft+"-color";return pt[0]==="#"&&(pt=pt.substring(1)),pt.length===6||pt.length===3?ut[Zt]="#"+pt:pt.length===8&&(ut[ft+"-opacity"]=parseInt(pt.substring(0,2),16)/255,ut[Zt]="#"+pt.substring(6,8)+pt.substring(4,6)+pt.substring(2,4)),ut}function zi(pt,ft,ut){let Zt={};return bt(pt,ft,Kt=>{Zt[ut]=Kt}),Zt}function ir(pt,ft){return fe(pt,"color",ut=>Pi(Lt(ut),ft))}function Ei(pt){return fe(pt,"Icon",(ft,ut)=>(j(ft,"href",Zt=>{ut.icon=Zt}),ut))}function Fe(pt){return Object.assign({},function(ft){return fe(ft,"PolyStyle",(ut,Zt)=>Object.assign(Zt,fe(ut,"color",Kt=>Pi(Lt(Kt),"fill")),j(ut,"fill",Kt=>{if(Kt==="0")return{"fill-opacity":0}}),j(ut,"outline",Kt=>{if(Kt==="0")return{"stroke-opacity":0}})))}(pt),function(ft){return fe(ft,"LineStyle",ut=>Object.assign(ir(ut,"stroke"),zi(ut,"width","stroke-width")))}(pt),function(ft){return fe(ft,"LabelStyle",ut=>Object.assign(ir(ut,"label"),zi(ut,"scale","label-scale")))}(pt),function(ft){return fe(ft,"IconStyle",ut=>Object.assign(ir(ut,"icon"),zi(ut,"scale","icon-scale"),zi(ut,"heading","icon-heading"),fe(ut,"hotSpot",Zt=>{let Kt=parseFloat(Zt.getAttribute("x")||""),ie=parseFloat(Zt.getAttribute("y")||""),ge=Zt.getAttribute("xunits")||"",Ue=Zt.getAttribute("yunits")||"";return isNaN(Kt)||isNaN(ie)?{}:{"icon-offset":[Kt,ie],"icon-offset-units":[ge,Ue]}}),Ei(ut)))}(pt))}let Ye=pt=>Number(pt),Ki={string:pt=>pt,int:Ye,uint:Ye,short:Ye,ushort:Ye,float:Ye,double:Ye,bool:pt=>Boolean(pt)};function ji(pt,ft){return fe(pt,"ExtendedData",(ut,Zt)=>{for(let Kt of ae(ut,"Data"))Zt[Kt.getAttribute("name")||""]=Lt(Ht(Kt,"value"));for(let Kt of ae(ut,"SimpleData")){let ie=Kt.getAttribute("name")||"",ge=ft[ie]||Ki.string;Zt[ie]=ge(Lt(Kt))}return Zt})}function vr(pt){let ft=Ht(pt,"description");for(let ut of Array.from(ft?.childNodes||[]))if(ut.nodeType===4)return{description:{"@type":"html",value:Lt(ut)}};return{}}function Qe(pt){return fe(pt,"TimeSpan",ft=>({timespan:{begin:Lt(Ht(ft,"begin")),end:Lt(Ht(ft,"end"))}}))}function gi(pt){return fe(pt,"TimeStamp",ft=>({timestamp:Lt(Ht(ft,"when"))}))}function Bi(pt,ft){return j(pt,"styleUrl",ut=>(ut=se(ut),ft[ut]?Object.assign({styleUrl:ut},ft[ut]):{styleUrl:ut}))}let Oi=/\s*/g,Fr=/^\s*|\s*$/g,pi=/\s+/;function Pr(pt){return pt.replace(Oi,"").split(",").map(parseFloat).filter(ft=>!isNaN(ft)).slice(0,3)}function gt(pt){return pt.replace(Fr,"").split(pi).map(Pr).filter(ft=>ft.length>=2)}function Y(pt){let ft=ae(pt,"coord");ft.length===0&&(ft=function(Zt,Kt,ie){return Array.from(Zt.getElementsByTagNameNS(ie,Kt))}(pt,"coord","*"));let ut=ft.map(Zt=>Lt(Zt).split(" ").map(parseFloat));return ut.length===0?null:{geometry:ut.length>2?{type:"LineString",coordinates:ut}:{type:"Point",coordinates:ut[0]},times:ae(pt,"when").map(Zt=>Lt(Zt))}}function q(pt){if(pt.length===0)return pt;let ft=pt[0],ut=pt[pt.length-1],Zt=!0;for(let Kt=0;Kt<Math.max(ft.length,ut.length);Kt++)if(ft[Kt]!==ut[Kt]){Zt=!1;break}return Zt?pt:pt.concat([pt[0]])}function lt(pt){return Lt(Ht(pt,"coordinates"))}function _t(pt){let ft=[],ut=[];for(let Zt=0;Zt<pt.childNodes.length;Zt++){let Kt=pt.childNodes.item(Zt);if(Xt(Kt))switch(Kt.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{let ie=_t(Kt);ft=ft.concat(ie.geometries),ut=ut.concat(ie.coordTimes);break}case"Point":{let ie=Pr(lt(Kt));ie.length>=2&&ft.push({type:"Point",coordinates:ie});break}case"LinearRing":case"LineString":{let ie=gt(lt(Kt));ie.length>=2&&ft.push({type:"LineString",coordinates:ie});break}case"Polygon":{let ie=[];for(let ge of ae(Kt,"LinearRing")){let Ue=q(gt(lt(ge)));Ue.length>=4&&ie.push(Ue)}ie.length&&ft.push({type:"Polygon",coordinates:ie});break}case"Track":case"gx:Track":{let ie=Y(Kt);if(!ie)break;let{times:ge,geometry:Ue}=ie;ft.push(Ue),ge.length&&ut.push(ge);break}}}return{geometries:ft,coordTimes:ut}}function xt(pt,ft,ut,Zt){let{coordTimes:Kt,geometries:ie}=_t(pt),ge=function(Se){return Se.length===0?null:Se.length===1?Se[0]:{type:"GeometryCollection",geometries:Se}}(ie);if(!ge&&Zt.skipNullGeometry)return null;let Ue={type:"Feature",geometry:ge,properties:Object.assign(Vt(pt,["name","address","visibility","open","phoneNumber","description"]),vr(pt),Bi(pt,ft),Fe(pt),ji(pt,ut),Qe(pt),gi(pt),Kt.length?{coordinateProperties:{times:Kt.length===1?Kt[0]:Kt}}:{})};Ue.properties?.visibility!==void 0&&(Ue.properties.visibility=Ue.properties.visibility!=="0");let Ee=pt.getAttribute("id");return Ee!==null&&Ee!==""&&(Ue.id=Ee),Ue}function qt(pt){return Ht(pt,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[q(gt(lt(pt)))]}}:function(ft){let ut=Ht(ft,"LatLonBox");if(ut){let Zt=bt(ut,"north"),Kt=bt(ut,"west"),ie=bt(ut,"east"),ge=bt(ut,"south"),Ue=bt(ut,"rotation");if(typeof Zt=="number"&&typeof ge=="number"&&typeof Kt=="number"&&typeof ie=="number"){let Ee=[Kt,ge,ie,Zt],Se=[[[Kt,Zt],[ie,Zt],[ie,ge],[Kt,ge],[Kt,Zt]]];return typeof Ue=="number"&&(Se=function(le,ke,Te){let Pe=[(le[0]+le[2])/2,(le[1]+le[3])/2];return[ke[0].map(Gi=>{let Zi=Gi[1]-Pe[1],Je=Gi[0]-Pe[0],Me=Math.sqrt(Math.pow(Zi,2)+Math.pow(Je,2)),Ci=Math.atan2(Zi,Je)+Te*Jt;return[Pe[0]+Math.cos(Ci)*Me,Pe[1]+Math.sin(Ci)*Me]})]}(Ee,Se,Ue)),{bbox:Ee,geometry:{type:"Polygon",coordinates:Se}}}}return null}(pt)}let Jt=Math.PI/180;function mt(pt,ft,ut,Zt){let Kt=qt(pt),ie=Kt?.geometry||null;if(!ie&&Zt.skipNullGeometry)return null;let ge={type:"Feature",geometry:ie,properties:Object.assign({"@geometry-type":"groundoverlay"},Vt(pt,["name","address","visibility","open","phoneNumber","description"]),vr(pt),Bi(pt,ft),Fe(pt),Ei(pt),ji(pt,ut),Qe(pt),gi(pt))};Kt?.bbox&&(ge.bbox=Kt.bbox),ge.properties?.visibility!==void 0&&(ge.properties.visibility=ge.properties.visibility!=="0");let Ue=pt.getAttribute("id");return Ue!==null&&Ue!==""&&(ge.id=Ue),ge}function jt(pt){let ft=pt.getAttribute("id"),ut=pt.parentNode;return!ft&&Xt(ut)&&ut.localName==="CascadingStyle"&&(ft=ut.getAttribute("kml:id")||ut.getAttribute("id")),se(ft||"")}function _e(pt){let ft={};for(let ut of ae(pt,"Style"))ft[jt(ut)]=Fe(ut);for(let ut of ae(pt,"StyleMap")){let Zt=se(ut.getAttribute("id")||"");j(ut,"styleUrl",Kt=>{Kt=se(Kt),ft[Kt]&&(ft[Zt]=ft[Kt])})}return ft}function ve(pt){let ft={};for(let ut of ae(pt,"SimpleField"))ft[ut.getAttribute("name")||""]=Ki[ut.getAttribute("type")||""]||Ki.string;return ft}let xe=["name","visibility","open","address","description","phoneNumber","visibility"];function*si(pt,ft={skipNullGeometry:!1}){let ut=_e(pt),Zt=ve(pt);for(let Kt of ae(pt,"Placemark")){let ie=xt(Kt,ut,Zt,ft);ie&&(yield ie)}for(let Kt of ae(pt,"GroundOverlay")){let ie=mt(Kt,ut,Zt,ft);ie&&(yield ie)}}var _i=Object.freeze({__proto__:null,gpx:function(pt){return{type:"FeatureCollection",features:Array.from(Ui(pt))}},gpxGen:Ui,kml:function(pt,ft={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(si(pt,ft))}},kmlGen:si,kmlWithFolders:function(pt,ft={skipNullGeometry:!1}){let ut=_e(pt),Zt=ve(pt),Kt={type:"root",children:[]};return function ie(ge,Ue,Ee){if(Xt(ge))switch(ge.tagName){case"GroundOverlay":{let Se=mt(ge,ut,Zt,Ee);Se&&Ue.children.push(Se);break}case"Placemark":{let Se=xt(ge,ut,Zt,Ee);Se&&Ue.children.push(Se);break}case"Folder":{let Se=function(le){let ke={};for(let Te of Array.from(le.childNodes))Xt(Te)&&xe.includes(Te.tagName)&&(ke[Te.tagName]=Lt(Te));return{type:"folder",meta:ke,children:[]}}(ge);Ue.children.push(Se),Ue=Se;break}}if(ge.childNodes)for(let Se=0;Se<ge.childNodes.length;Se++)ie(ge.childNodes[Se],Ue,Ee)}(pt,Kt,ft),Kt},tcx:function(pt){return{type:"FeatureCollection",features:Array.from(Qi(pt))}},tcxGen:Qi}),ui={exports:{}};(function(pt){var ft={};function ut(ie){return Math.floor(Math.abs(ie)+.5)*(ie>=0?1:-1)}function Zt(ie,ge,Ue){var Ee=2*((ie=ut(ie*Ue))-(ge=ut(ge*Ue)));Ee<0&&(Ee=-Ee-1);for(var Se="";Ee>=32;)Se+=String.fromCharCode(63+(32|31&Ee)),Ee/=32;return Se+=String.fromCharCode(63+(0|Ee))}function Kt(ie){for(var ge=[],Ue=0;Ue<ie.length;Ue++){var Ee=ie[Ue].slice();ge.push([Ee[1],Ee[0]])}return ge}ft.decode=function(ie,ge){for(var Ue,Ee=0,Se=0,le=0,ke=[],Te=0,Pe=0,Gi=null,Zi=Math.pow(10,Number.isInteger(ge)?ge:5);Ee<ie.length;){Gi=null,Te=1,Pe=0;do Pe+=(31&(Gi=ie.charCodeAt(Ee++)-63))*Te,Te*=32;while(Gi>=32);Ue=1&Pe?(-Pe-1)/2:Pe/2,Te=1,Pe=0;do Pe+=(31&(Gi=ie.charCodeAt(Ee++)-63))*Te,Te*=32;while(Gi>=32);Se+=Ue,le+=1&Pe?(-Pe-1)/2:Pe/2,ke.push([Se/Zi,le/Zi])}return ke},ft.encode=function(ie,ge){if(!ie.length)return"";for(var Ue=Math.pow(10,Number.isInteger(ge)?ge:5),Ee=Zt(ie[0][0],0,Ue)+Zt(ie[0][1],0,Ue),Se=1;Se<ie.length;Se++){var le=ie[Se],ke=ie[Se-1];Ee+=Zt(le[0],ke[0],Ue),Ee+=Zt(le[1],ke[1],Ue)}return Ee},ft.fromGeoJSON=function(ie,ge){if(ie&&ie.type==="Feature"&&(ie=ie.geometry),!ie||ie.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return ft.encode(Kt(ie.coordinates),ge)},ft.toGeoJSON=function(ie,ge){return{type:"LineString",coordinates:Kt(ft.decode(ie,ge))}},pt.exports&&(pt.exports=ft)})(ui);var fi=ui.exports,bi=(()=>{let pt=le=>le[0],ft=le=>le[le.length-1],ut=le=>le.join(","),Zt=(le,ke,Te)=>{let Pe=le[ke];Pe?Pe.push(Te):le[ke]=[Te]},Kt=(le,ke,Te)=>{let Pe=le[ke],Gi=null;Pe&&(Gi=Pe.indexOf(Te))>=0&&Pe.splice(Gi,1)},ie=(le,ke)=>{let Te=le[ke];return Te&&Te.length>0?Te[0]:null},ge=le=>le.length>3&&ut(pt(le))===ut(ft(le)),Ue=(le,ke,Te)=>{ke=ke||0,Te=Te||1;let Pe=le.reduce((fr,mi,Rr)=>le[fr][ke]>mi[ke]?fr:Rr,0),Gi=Pe<=0?le.length-2:Pe-1,Zi=Pe>=le.length-1?1:Pe+1,Je=le[Gi][ke],Me=le[Pe][ke],Ci=le[Zi][ke],Ti=le[Gi][Te],Xi=le[Pe][Te];return(Me-Je)*(le[Zi][Te]-Ti)-(Ci-Je)*(Xi-Ti)<0?"clockwise":"counterclockwise"},Ee=le=>le instanceof Array?le.map(Ee):parseFloat(le);class Se extends Map{constructor(){super(),this.binders=[]}add(ke,Te){this.has(ke)||this.set(ke,Te)}addBinder(ke){this.binders.push(ke)}bindAll(){this.binders.forEach(ke=>ke.bind())}}return{purgeProps:(le,ke)=>{if(le){let Te=Object.assign({},le);if(ke)for(let Pe of ke)delete Te[Pe];return Te}return{}},mergeProps:(le,ke)=>(le=le||{},ke=ke||{},Object.assign(le,ke)),first:pt,last:ft,coordsToKey:ut,addToMap:Zt,removeFromMap:Kt,getFirstFromMap:ie,isRing:ge,ringDirection:Ue,ptInsidePolygon:(le,ke,Te,Pe)=>{Te=Te||0,Pe=Pe||1;let Gi=!1;for(let Zi=0,Je=ke.length-1;Zi<ke.length;Je=Zi++)(ke[Zi][Te]<=le[Te]&&le[Te]<ke[Je][Te]||ke[Je][Te]<=le[Te]&&le[Te]<ke[Zi][Te])&&le[Pe]<(ke[Je][Pe]-ke[Zi][Pe])*(le[Te]-ke[Zi][Te])/(ke[Je][Te]-ke[Zi][Te])+ke[Zi][Pe]&&(Gi=!Gi);return Gi},strToFloat:Ee,RefElements:Se,LateBinder:class{constructor(le,ke,Te,Pe){this.container=le,this.valueFunc=ke,this.ctx=Te,this.args=Pe}bind(){let le=this.valueFunc.apply(this.ctx,this.args);if(this.container instanceof Array){let ke=this.container.indexOf(this);if(ke>=0){let Te=[ke,1];le&&Te.push(le),[].splice.apply(this.container,Te)}}else if(typeof this.container=="object"){let ke=Object.keys(this.container).find(Te=>this.container[Te]===this);ke&&(le?this.container[ke]=le:delete this.container[ke])}}},WayCollection:class extends Array{constructor(){super(),this.firstMap={},this.lastMap={}}addWay(le){(le=le.toCoordsArray()).length>0&&(this.push(le),Zt(this.firstMap,ut(pt(le)),le),Zt(this.lastMap,ut(ft(le)),le))}toStrings(){let le=[],ke=null;for(;ke=this.shift();){Kt(this.firstMap,ut(pt(ke)),ke),Kt(this.lastMap,ut(ft(ke)),ke);let Te=ke,Pe=null;do{let Gi=ut(ft(Te)),Zi=!1;Pe=ie(this.firstMap,Gi),Pe||(Pe=ie(this.lastMap,Gi),Zi=!0),Pe&&(this.splice(this.indexOf(Pe),1),Kt(this.firstMap,ut(pt(Pe)),Pe),Kt(this.lastMap,ut(ft(Pe)),Pe),Zi&&(Pe.length>Te.length&&([Te,Pe]=[Pe,Te]),Pe.reverse()),Te=Te.concat(Pe.slice(1)))}while(Pe);le.push(Ee(Te))}return le}toRings(le){let ke=this.toStrings(),Te=[],Pe=null;for(;Pe=ke.shift();)ge(Pe)&&(Ue(Pe)!==le&&Pe.reverse(),Te.push(Pe));return Te}}}})(),$i={building:{},highway:{whitelist:["services","rest_area","escape","elevator"]},natural:{blacklist:["coastline","cliff","ridge","arete","tree_row"]},landuse:{},waterway:{whitelist:["riverbank","dock","boatyard","dam"]},amenity:{},leisure:{},barrier:{whitelist:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},railway:{whitelist:["station","turntable","roundhouse","platform"]},area:{},boundary:{},man_made:{blacklist:["cutline","embankment","pipeline"]},power:{whitelist:["plant","substation","generator","transformer"]},place:{},shop:{},aeroway:{blacklist:["taxiway"]},tourism:{},historic:{},public_transport:{},office:{},"building:part":{},military:{},ruins:{},"area:highway":{},craft:{},golf:{},indoor:{}},or=(()=>{let{first:pt,last:ft,coordsToKey:ut,addToMap:Zt,removeFromMap:Kt,getFirstFromMap:ie,isRing:ge,ringDirection:Ue,ptInsidePolygon:Ee,strToFloat:Se,LateBinder:le,WayCollection:ke}=bi,Te=$i;class Pe{constructor(Me,Ci,Ti){this.type=Me,this.id=Ci,this.refElems=Ti,this.tags={},this.props={id:this.getCompositeId()},this.refCount=0,this.hasTag=!1,Ti&&Ti.add(this.getCompositeId(),this)}addTags(Me){this.tags=Object.assign(this.tags,Me),this.hasTag=!!Me}addTag(Me,Ci){this.tags[Me]=Ci,this.hasTag=!!Me}addProp(Me,Ci){this.props[Me]=Ci}addProps(Me){this.props=Object.assign(this.props,Me)}getCompositeId(){return`${this.type}/${this.id}`}getProps(){return Object.assign(this.props,this.tags)}toFeatureArray(){return[]}}class Gi extends Pe{constructor(Me,Ci){super("node",Me,Ci),this.latLng=null}setLatLng(Me){this.latLng=Me}toFeatureArray(){return this.latLng?[{type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"Point",coordinates:Se([this.latLng.lon,this.latLng.lat])}}]:[]}getLatLng(){return this.latLng}}class Zi extends Pe{constructor(Me,Ci){super("way",Me,Ci),this.latLngArray=[],this.isPolygon=!1}addLatLng(Me){this.latLngArray.push(Me)}setLatLngArray(Me){this.latLngArray=Me}addNodeRef(Me){let Ci=new le(this.latLngArray,function(Ti){let Xi=this.refElems.get(`node/${Ti}`);if(Xi)return Xi.refCount++,Xi.getLatLng()},this,[Me]);this.latLngArray.push(Ci),this.refElems.addBinder(Ci)}analyzeGeometryType(Me,Ci){let Ti=Te[Me];Ti&&(this.isPolygon=!0,Ti.whitelist?this.isPolygon=Ti.whitelist.indexOf(Ci)>=0:Ti.blacklist&&(this.isPolygon=!(Ti.blacklist.indexOf(Ci)>=0)))}addTags(Me){super.addTags(Me);for(let[Ci,Ti]of Object.entries(Me))this.analyzeGeometryType(Ci,Ti)}addTag(Me,Ci){super.addTag(Me,Ci),this.analyzeGeometryType(Me,Ci)}toCoordsArray(){return this.latLngArray.map(Me=>[Me.lon,Me.lat])}toFeatureArray(){let Me=this.toCoordsArray();if(Me.length>1){Me=Se(Me);let Ci={type:"Feature",id:this.getCompositeId(),properties:this.getProps(),geometry:{type:"LineString",coordinates:Me}};return this.isPolygon&&ge(Me)?(Ue(Me)!=="counterclockwise"&&Me.reverse(),Ci.geometry={type:"Polygon",coordinates:[Me]},[Ci]):[Ci]}return[]}}return{Node:Gi,Way:Zi,Relation:class extends Pe{constructor(Je,Me){super("relation",Je,Me),this.relations=[],this.nodes=[],this.bounds=null}setBounds(Je){this.bounds=Je}addMember(Je){switch(Je.type){case"relation":let Me=new le(this.relations,function(Xi){let fr=this.refElems.get(`relation/${Xi}`);if(fr)return fr.refCount++,fr},this,[Je.ref]);this.relations.push(Me),this.refElems.addBinder(Me);break;case"way":Je.role||(Je.role="");let Ci=this[Je.role];if(Ci||(Ci=this[Je.role]=[]),Je.geometry){let Xi=new Zi(Je.ref,this.refElems);Xi.setLatLngArray(Je.geometry),Xi.refCount++,Ci.push(Xi)}else if(Je.nodes){let Xi=new Zi(Je.ref,this.refElems);for(let fr of Je.nodes)Xi.addNodeRef(fr);Xi.refCount++,Ci.push(Xi)}else{let Xi=new le(Ci,function(fr){let mi=this.refElems.get(`way/${fr}`);if(mi)return mi.refCount++,mi},this,[Je.ref]);Ci.push(Xi),this.refElems.addBinder(Xi)}break;case"node":let Ti=null;if(Je.lat&&Je.lon){Ti=new Gi(Je.ref,this.refElems),Ti.setLatLng({lon:Je.lon,lat:Je.lat}),Je.tags&&Ti.addTags(Je.tags);for(let[Xi,fr]of Object.entries(Je))["id","type","lat","lon"].indexOf(Xi)<0&&Ti.addProp(Xi,fr);Ti.refCount++,this.nodes.push(Ti)}else{let Xi=new le(this.nodes,function(fr){let mi=this.refElems.get(`node/${fr}`);if(mi)return mi.refCount++,mi},this,[Je.ref]);this.nodes.push(Xi),this.refElems.addBinder(Xi)}}}toFeatureArray(){let Je=[],Me=[],Ci=[],Ti=["outer","inner",""];for(let mi of this.relations)if(mi)for(let Rr of Ti){let Kr=mi[Rr];if(Kr){let Mr=this[Rr];Mr?[].splice.apply(Mr,[Mr.length,0].concat(Kr)):this[Rr]=Kr}}for(let mi of Ti){let Rr=this[mi];if(Rr){this[mi]=new ke;for(let Kr of Rr)this[mi].addWay(Kr)}}let Xi=null,fr={type:"Feature",id:this.getCompositeId(),bbox:this.bounds,properties:this.getProps()};this.bounds||delete fr.bbox,this.outer?(Xi=((mi,Rr)=>{let Kr=mi?mi.toRings("counterclockwise"):[],Mr=Rr?Rr.toRings("clockwise"):[];if(Kr.length>0){let tn=[],En=null;for(En of Kr)tn.push([En]);for(;En=Mr.shift();)for(let Xs in Kr)if(Ee(pt(En),Kr[Xs])){tn[Xs].push(En);break}return tn.length===1?{type:"Polygon",coordinates:tn[0]}:{type:"MultiPolygon",coordinates:tn}}return null})(this.outer,this.inner),Xi&&(fr.geometry=Xi,Je.push(fr))):this[""]&&(Xi=(mi=>{let Rr=mi?mi.toStrings():[];return Rr.length>0?Rr.length===1?{type:"LineString",coordinates:Rr[0]}:{type:"MultiLineString",coordinates:Rr}:null})(this[""]),Xi&&(fr.geometry=Xi,Me.push(fr)));for(let mi of this.nodes)Ci=Ci.concat(mi.toFeatureArray());return Je.concat(Me).concat(Ci)}}}})(),Ji=(()=>{function pt(ut){return ut.match(/^(.+?)\[(.+?)\]>$/g)!=null}function ft(ut){let Zt=/^(.+?)\[(.+?)\]>$/g.exec(ut);return Zt?{evt:Zt[1]+">",exp:Zt[2]}:{evt:ut}}return class{constructor(ut){ut&&(this.queryParent=!!ut.queryParent,this.progressive=ut.progressive,this.queryParent&&(this.parentMap=new WeakMap)),this.evtListeners={}}parse(ut,Zt,Kt){Kt=Kt?Kt+".":"";let ie=/<([^ >\/]+)(.*?)>/gm,ge=null,Ue=[];for(;ge=ie.exec(ut);){let Ee=ge[1],Se={$tag:Ee},le=Kt+Ee,ke=ge[2].trim(),Te=!1;(ke.endsWith("/")||Ee.startsWith("?")||Ee.startsWith("!"))&&(Te=!0);let Pe=/([^ ]+?)="(.+?)"/g,Gi=/([^ ]+?)='(.+?)'/g,Zi=null,Je=!1;for(;Zi=Pe.exec(ke);)Je=!0,Se[Zi[1]]=Zi[2];if(!Je)for(;Zi=Gi.exec(ke);)Je=!0,Se[Zi[1]]=Zi[2];if(Je||ke===""||(Se.text=ke),this.progressive&&this.emit(`<${le}>`,Se,Zt),!Te){let Me=new RegExp(`([^]+?)</${Ee}>`,"g");Me.lastIndex=ie.lastIndex;let Ci=Me.exec(ut);if(Ci&&Ci[1]){ie.lastIndex=Me.lastIndex;let Ti=this.parse(Ci[1],Se,le);Ti.length>0?Se.$innerNodes=Ti:Se.$innerText=Ci[1]}}this.queryParent&&Zt&&this.parentMap.set(Se,Zt),this.progressive&&this.emit(`</${le}>`,Se,Zt),Ue.push(Se)}return Ue}getParent(ut){return this.queryParent?this.parentMap.get(ut):null}#t(ut,Zt){let Kt=this.evtListeners[ut];Kt?Kt.push(Zt):this.evtListeners[ut]=[Zt]}addListener(ut,Zt){pt(ut)&&(ut=ft(ut),Zt.condition=function(Kt){let ie="return "+Kt.replace(/(\$.+?)(?=[=!.])/g,"node.$&")+";";return new Function("node",ie)}(ut.exp),ut=ut.evt),this.#t(ut,Zt)}#e(ut,Zt){let Kt=this.evtListeners[ut],ie=null;Kt&&(ie=Kt.indexOf(Zt))>=0&&Kt.splice(ie,1)}removeListener(ut,Zt){pt(ut)&&(ut=(ut=ft(ut)).evt),this.#e(ut,Zt)}emit(ut,...Zt){let Kt=this.evtListeners[ut];if(Kt)for(let ie of Kt)ie.condition?ie.condition.apply(null,Zt)===!0&&ie.apply(null,Zt):ie.apply(null,Zt)}on(ut,Zt){this.addListener(ut,Zt)}off(ut,Zt){this.removeListener(ut,Zt)}}})();let{Node:Mi,Way:kr,Relation:Nt}=or,{purgeProps:ze,RefElements:Ne}=bi,Wi=Ji;var Lr=(pt,ft)=>{let ut=!1,Zt=!1,Kt=!0;(Ee=>{if(Ee){ut=!(!Ee.completeFeature&&!Ee.allFeatures),Zt=!!Ee.renderTagged;let Se=Ee.suppressWay||Ee.excludeWay;Se===void 0||Se||(Kt=!1)}})(ft);let ie=(Ee=>Ee.elements?"json":Ee.indexOf("<osm")>=0?"xml":Ee.trim().startsWith("{")?"json-raw":"invalid")(pt),ge=new Ne,Ue=[];ie==="json-raw"&&(ie=(pt=JSON.parse(pt)).elements?"json":"invalid"),ie==="json"?(Ee=>{for(let Se of Ee.elements)switch(Se.type){case"node":let le=new Mi(Se.id,ge);Se.tags&&le.addTags(Se.tags),le.addProps(ze(Se,["id","type","tags","lat","lon"])),le.setLatLng(Se);break;case"way":let ke=new kr(Se.id,ge);if(Se.tags&&ke.addTags(Se.tags),ke.addProps(ze(Se,["id","type","tags","nodes","geometry"])),Se.nodes)for(let Pe of Se.nodes)ke.addNodeRef(Pe);else Se.geometry&&ke.setLatLngArray(Se.geometry);break;case"relation":let Te=new Nt(Se.id,ge);if(Se.bounds&&Te.setBounds([parseFloat(Se.bounds.minlon),parseFloat(Se.bounds.minlat),parseFloat(Se.bounds.maxlon),parseFloat(Se.bounds.maxlat)]),Se.tags&&Te.addTags(Se.tags),Te.addProps(ze(Se,["id","type","tags","bounds","members"])),Se.members)for(let Pe of Se.members)Te.addMember(Pe)}})(pt):ie==="xml"&&(Ee=>{let Se=new Wi({progressive:!0});Se.on("</osm.node>",le=>{let ke=new Mi(le.id,ge);for(let[Te,Pe]of Object.entries(le))!Te.startsWith("$")&&["id","lon","lat"].indexOf(Te)<0&&ke.addProp(Te,Pe);if(ke.setLatLng(le),le.$innerNodes)for(let Te of le.$innerNodes)Te.$tag==="tag"&&ke.addTag(Te.k,Te.v)}),Se.on("</osm.way>",le=>{let ke=new kr(le.id,ge);for(let[Te,Pe]of Object.entries(le))!Te.startsWith("$")&&["id"].indexOf(Te)<0&&ke.addProp(Te,Pe);if(le.$innerNodes)for(let Te of le.$innerNodes)Te.$tag==="nd"?Te.lon&&Te.lat?ke.addLatLng(Te):Te.ref&&ke.addNodeRef(Te.ref):Te.$tag==="tag"&&ke.addTag(Te.k,Te.v)}),Se.on("<osm.relation>",le=>{new Nt(le.id,ge)}),Se.on("</osm.relation.member>",(le,ke)=>{let Te=ge.get(`relation/${ke.id}`),Pe={type:le.type,role:le.role?le.role:"",ref:le.ref};if(le.lat&&le.lon){Pe.lat=le.lat,Pe.lon=le.lon,Pe.tags={};for(let[Gi,Zi]of Object.entries(le))!Gi.startsWith("$")&&["type","lat","lon"].indexOf(Gi)<0&&(Pe[Gi]=Zi)}if(le.$innerNodes){let Gi=[],Zi=[];for(let Je of le.$innerNodes)Je.lat&&Je.lon?Gi.push(Je):Zi.push(Je.ref);Gi.length>0?Pe.geometry=Gi:Zi.length>0&&(Pe.nodes=Zi)}Te.addMember(Pe)}),Se.on("</osm.relation.bounds>",(le,ke)=>{ge.get(`relation/${ke.id}`).setBounds([parseFloat(le.minlon),parseFloat(le.minlat),parseFloat(le.maxlon),parseFloat(le.maxlat)])}),Se.on("</osm.relation.tag>",(le,ke)=>{ge.get(`relation/${ke.id}`).addTag(le.k,le.v)}),Se.parse(Ee)})(pt),ge.bindAll();for(let Ee of ge.values())if(Ee.refCount<=0||Ee.hasTag&&Zt&&!(Ee instanceof kr&&Kt)){let Se=Ee.toFeatureArray();if(Ee instanceof Nt&&!ut&&Se.length>0)return Se[0].geometry;Ue=Ue.concat(Se)}return{type:"FeatureCollection",features:Ue}},$r=t(Lr);let Qr=["topojson","osm","kml","gpx","tcx","csv","tsv","polyline"];class uo{constructor(ft,ut,Zt={}){this.blankGeoJSON=()=>({type:"FeatureCollection",features:[]}),this._rawData=ut,this._format=ft,this._options=Zt;let Kt={topojson:this.loadTopoJson,osm:this.loadOsm,kml:this.loadXml,gpx:this.loadXml,tcx:this.loadXml,csv:this.loadCsv,tsv:this.loadCsv,polyline:this.loadPolyline};this._conversionFn=Kt[ft]}async convert(){return this._conversionFn?this._conversionFn():new Promise((ft,ut)=>ut(`No converter exists for ${this._format}`))}async loadXml(){return _i[this._format](new DOMParser().parseFromString(this._rawData,"text/xml"))}async loadCsv(){let ft=this._options.csvOptions||{};return this._format==="tsv"&&(ft.delimiter="	"),await new Promise((ut,Zt)=>{St.csv2geojson(this._rawData,ft,(Kt,ie)=>{Kt?Zt(Kt):ut(ie)})})}async loadTopoJson(){let ft={};try{ft=JSON.parse(this._rawData)}catch{throw"Invalid TopoJson"}let ut=this.blankGeoJSON();return ft.type==="Topology"&&ft.objects!==void 0&&(ut={type:"FeatureCollection",features:ut.features=Object.keys(ft.objects).map(Zt=>{return Kt=ft,typeof(ie=Zt)=="string"&&(ie=Kt.objects[ie]),ie.type==="GeometryCollection"?{type:"FeatureCollection",features:ie.geometries.map(function(ge){return ce(Kt,ge)})}:ce(Kt,ie);var Kt,ie}).reduce((Zt,Kt)=>[...Zt,...Kt.features],[])}),ut}async loadOsm(){return $r(this._rawData)}async loadPolyline(){let ft=this._options.polylineOptions||{};return await new Promise((ut,Zt)=>{try{let Kt=fi.toGeoJSON(this._rawData,ft.precision),ie=Kt;ft.type==="point"?Kt.coordinates.length===1?ie={type:"Point",coordinates:Kt.coordinates[0]}:console.warn("Cannot convert polyline to "+ft.type):ft.type==="polygon"&&(Kt.coordinates[0][0]===Kt.coordinates[Kt.coordinates.length-1][0]&&Kt.coordinates[0][1]===Kt.coordinates[Kt.coordinates.length-1][1]?ie={type:"Polygon",coordinates:[Kt.coordinates]}:console.warn("Cannot convert polyline to "+ft.type)),ut({type:"FeatureCollection",features:[{type:"Feature",geometry:ie,properties:ft.properties||{}}]})}catch(Kt){Zt(Kt)}})}}var qi=null;try{var An=typeof Bd<"u"&&typeof Bd.require=="function"&&bd("worker_threads")||typeof __non_webpack_require__=="function"&&__non_webpack_require__("worker_threads")||typeof bd=="function"&&bd("worker_threads");qi=An.Worker}catch{}function ho(pt,ft,ut){var Zt=ft===void 0?null:ft,Kt=function(Ue,Ee){return Buffer.from(Ue,"base64").toString(Ee?"utf16":"utf8")}(pt,ut!==void 0&&ut),ie=Kt.indexOf(`
`,10)+1,ge=Kt.substring(ie)+(Zt?"//# sourceMappingURL="+Zt:"");return function(Ue){return new qi(ge,Object.assign({},Ue,{eval:!0}))}}function dn(pt,ft,ut){var Zt=ft===void 0?null:ft,Kt=function(Ee,Se){var le=atob(Ee);if(Se){for(var ke=new Uint8Array(le.length),Te=0,Pe=le.length;Te<Pe;++Te)ke[Te]=le.charCodeAt(Te);return String.fromCharCode.apply(null,new Uint16Array(ke.buffer))}return le}(pt,ut!==void 0&&ut),ie=Kt.indexOf(`
`,10)+1,ge=Kt.substring(ie)+(Zt?"//# sourceMappingURL="+Zt:""),Ue=new Blob([ge],{type:"application/javascript"});return URL.createObjectURL(Ue)}var Mn=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",Ca,Ln,zr,Ia=(Ca="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCWZ1bmN0aW9uIGdldERlZmF1bHRFeHBvcnRGcm9tQ2pzICh4KSB7CgkJcmV0dXJuIHggJiYgeC5fX2VzTW9kdWxlICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh4LCAnZGVmYXVsdCcpID8geFsnZGVmYXVsdCddIDogeDsKCX0KCglmdW5jdGlvbiBnZXRBdWdtZW50ZWROYW1lc3BhY2UobikgewoJICBpZiAobi5fX2VzTW9kdWxlKSByZXR1cm4gbjsKCSAgdmFyIGYgPSBuLmRlZmF1bHQ7CgkJaWYgKHR5cGVvZiBmID09ICJmdW5jdGlvbiIpIHsKCQkJdmFyIGEgPSBmdW5jdGlvbiBhICgpIHsKCQkJCWlmICh0aGlzIGluc3RhbmNlb2YgYSkgewoJICAgICAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QoZiwgYXJndW1lbnRzLCB0aGlzLmNvbnN0cnVjdG9yKTsKCQkJCX0KCQkJCXJldHVybiBmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgkJCX07CgkJCWEucHJvdG90eXBlID0gZi5wcm90b3R5cGU7CgkgIH0gZWxzZSBhID0ge307CgkgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCAnX19lc01vZHVsZScsIHt2YWx1ZTogdHJ1ZX0pOwoJCU9iamVjdC5rZXlzKG4pLmZvckVhY2goZnVuY3Rpb24gKGspIHsKCQkJdmFyIGQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG4sIGspOwoJCQlPYmplY3QuZGVmaW5lUHJvcGVydHkoYSwgaywgZC5nZXQgPyBkIDogewoJCQkJZW51bWVyYWJsZTogdHJ1ZSwKCQkJCWdldDogZnVuY3Rpb24gKCkgewoJCQkJCXJldHVybiBuW2tdOwoJCQkJfQoJCQl9KTsKCQl9KTsKCQlyZXR1cm4gYTsKCX0KCglmdW5jdGlvbiBvYmplY3RDb252ZXJ0ZXIoY29sdW1ucykgewoJICByZXR1cm4gbmV3IEZ1bmN0aW9uKCJkIiwgInJldHVybiB7IiArIGNvbHVtbnMubWFwKGZ1bmN0aW9uKG5hbWUsIGkpIHsKCSAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobmFtZSkgKyAiOiBkWyIgKyBpICsgIl0iOwoJICB9KS5qb2luKCIsIikgKyAifSIpOwoJfQoKCWZ1bmN0aW9uIGN1c3RvbUNvbnZlcnRlcihjb2x1bW5zLCBmKSB7CgkgIHZhciBvYmplY3QgPSBvYmplY3RDb252ZXJ0ZXIoY29sdW1ucyk7CgkgIHJldHVybiBmdW5jdGlvbihyb3csIGkpIHsKCSAgICByZXR1cm4gZihvYmplY3Qocm93KSwgaSwgY29sdW1ucyk7CgkgIH07Cgl9CgoJLy8gQ29tcHV0ZSB1bmlxdWUgY29sdW1ucyBpbiBvcmRlciBvZiBkaXNjb3ZlcnkuCglmdW5jdGlvbiBpbmZlckNvbHVtbnMocm93cykgewoJICB2YXIgY29sdW1uU2V0ID0gT2JqZWN0LmNyZWF0ZShudWxsKSwKCSAgICAgIGNvbHVtbnMgPSBbXTsKCgkgIHJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpIHsKCSAgICBmb3IgKHZhciBjb2x1bW4gaW4gcm93KSB7CgkgICAgICBpZiAoIShjb2x1bW4gaW4gY29sdW1uU2V0KSkgewoJICAgICAgICBjb2x1bW5zLnB1c2goY29sdW1uU2V0W2NvbHVtbl0gPSBjb2x1bW4pOwoJICAgICAgfQoJICAgIH0KCSAgfSk7CgoJICByZXR1cm4gY29sdW1uczsKCX0KCglmdW5jdGlvbiBkc3YkMShkZWxpbWl0ZXIpIHsKCSAgdmFyIHJlRm9ybWF0ID0gbmV3IFJlZ0V4cCgiW1wiIiArIGRlbGltaXRlciArICJcbl0iKSwKCSAgICAgIGRlbGltaXRlckNvZGUgPSBkZWxpbWl0ZXIuY2hhckNvZGVBdCgwKTsKCgkgIGZ1bmN0aW9uIHBhcnNlKHRleHQsIGYpIHsKCSAgICB2YXIgY29udmVydCwgY29sdW1ucywgcm93cyA9IHBhcnNlUm93cyh0ZXh0LCBmdW5jdGlvbihyb3csIGkpIHsKCSAgICAgIGlmIChjb252ZXJ0KSByZXR1cm4gY29udmVydChyb3csIGkgLSAxKTsKCSAgICAgIGNvbHVtbnMgPSByb3csIGNvbnZlcnQgPSBmID8gY3VzdG9tQ29udmVydGVyKHJvdywgZikgOiBvYmplY3RDb252ZXJ0ZXIocm93KTsKCSAgICB9KTsKCSAgICByb3dzLmNvbHVtbnMgPSBjb2x1bW5zOwoJICAgIHJldHVybiByb3dzOwoJICB9CgoJICBmdW5jdGlvbiBwYXJzZVJvd3ModGV4dCwgZikgewoJICAgIHZhciBFT0wgPSB7fSwgLy8gc2VudGluZWwgdmFsdWUgZm9yIGVuZC1vZi1saW5lCgkgICAgICAgIEVPRiA9IHt9LCAvLyBzZW50aW5lbCB2YWx1ZSBmb3IgZW5kLW9mLWZpbGUKCSAgICAgICAgcm93cyA9IFtdLCAvLyBvdXRwdXQgcm93cwoJICAgICAgICBOID0gdGV4dC5sZW5ndGgsCgkgICAgICAgIEkgPSAwLCAvLyBjdXJyZW50IGNoYXJhY3RlciBpbmRleAoJICAgICAgICBuID0gMCwgLy8gdGhlIGN1cnJlbnQgbGluZSBudW1iZXIKCSAgICAgICAgdCwgLy8gdGhlIGN1cnJlbnQgdG9rZW4KCSAgICAgICAgZW9sOyAvLyBpcyB0aGUgY3VycmVudCB0b2tlbiBmb2xsb3dlZCBieSBFT0w/CgoJICAgIGZ1bmN0aW9uIHRva2VuKCkgewoJICAgICAgaWYgKEkgPj0gTikgcmV0dXJuIEVPRjsgLy8gc3BlY2lhbCBjYXNlOiBlbmQgb2YgZmlsZQoJICAgICAgaWYgKGVvbCkgcmV0dXJuIGVvbCA9IGZhbHNlLCBFT0w7IC8vIHNwZWNpYWwgY2FzZTogZW5kIG9mIGxpbmUKCgkgICAgICAvLyBzcGVjaWFsIGNhc2U6IHF1b3RlcwoJICAgICAgdmFyIGogPSBJLCBjOwoJICAgICAgaWYgKHRleHQuY2hhckNvZGVBdChqKSA9PT0gMzQpIHsKCSAgICAgICAgdmFyIGkgPSBqOwoJICAgICAgICB3aGlsZSAoaSsrIDwgTikgewoJICAgICAgICAgIGlmICh0ZXh0LmNoYXJDb2RlQXQoaSkgPT09IDM0KSB7CgkgICAgICAgICAgICBpZiAodGV4dC5jaGFyQ29kZUF0KGkgKyAxKSAhPT0gMzQpIGJyZWFrOwoJICAgICAgICAgICAgKytpOwoJICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBJID0gaSArIDI7CgkgICAgICAgIGMgPSB0ZXh0LmNoYXJDb2RlQXQoaSArIDEpOwoJICAgICAgICBpZiAoYyA9PT0gMTMpIHsKCSAgICAgICAgICBlb2wgPSB0cnVlOwoJICAgICAgICAgIGlmICh0ZXh0LmNoYXJDb2RlQXQoaSArIDIpID09PSAxMCkgKytJOwoJICAgICAgICB9IGVsc2UgaWYgKGMgPT09IDEwKSB7CgkgICAgICAgICAgZW9sID0gdHJ1ZTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGV4dC5zbGljZShqICsgMSwgaSkucmVwbGFjZSgvIiIvZywgIlwiIik7CgkgICAgICB9CgoJICAgICAgLy8gY29tbW9uIGNhc2U6IGZpbmQgbmV4dCBkZWxpbWl0ZXIgb3IgbmV3bGluZQoJICAgICAgd2hpbGUgKEkgPCBOKSB7CgkgICAgICAgIHZhciBrID0gMTsKCSAgICAgICAgYyA9IHRleHQuY2hhckNvZGVBdChJKyspOwoJICAgICAgICBpZiAoYyA9PT0gMTApIGVvbCA9IHRydWU7IC8vIFxuCgkgICAgICAgIGVsc2UgaWYgKGMgPT09IDEzKSB7IGVvbCA9IHRydWU7IGlmICh0ZXh0LmNoYXJDb2RlQXQoSSkgPT09IDEwKSArK0ksICsrazsgfSAvLyBccnxcclxuCgkgICAgICAgIGVsc2UgaWYgKGMgIT09IGRlbGltaXRlckNvZGUpIGNvbnRpbnVlOwoJICAgICAgICByZXR1cm4gdGV4dC5zbGljZShqLCBJIC0gayk7CgkgICAgICB9CgoJICAgICAgLy8gc3BlY2lhbCBjYXNlOiBsYXN0IHRva2VuIGJlZm9yZSBFT0YKCSAgICAgIHJldHVybiB0ZXh0LnNsaWNlKGopOwoJICAgIH0KCgkgICAgd2hpbGUgKCh0ID0gdG9rZW4oKSkgIT09IEVPRikgewoJICAgICAgdmFyIGEgPSBbXTsKCSAgICAgIHdoaWxlICh0ICE9PSBFT0wgJiYgdCAhPT0gRU9GKSB7CgkgICAgICAgIGEucHVzaCh0KTsKCSAgICAgICAgdCA9IHRva2VuKCk7CgkgICAgICB9CgkgICAgICBpZiAoZiAmJiAoYSA9IGYoYSwgbisrKSkgPT0gbnVsbCkgY29udGludWU7CgkgICAgICByb3dzLnB1c2goYSk7CgkgICAgfQoKCSAgICByZXR1cm4gcm93czsKCSAgfQoKCSAgZnVuY3Rpb24gZm9ybWF0KHJvd3MsIGNvbHVtbnMpIHsKCSAgICBpZiAoY29sdW1ucyA9PSBudWxsKSBjb2x1bW5zID0gaW5mZXJDb2x1bW5zKHJvd3MpOwoJICAgIHJldHVybiBbY29sdW1ucy5tYXAoZm9ybWF0VmFsdWUpLmpvaW4oZGVsaW1pdGVyKV0uY29uY2F0KHJvd3MubWFwKGZ1bmN0aW9uKHJvdykgewoJICAgICAgcmV0dXJuIGNvbHVtbnMubWFwKGZ1bmN0aW9uKGNvbHVtbikgewoJICAgICAgICByZXR1cm4gZm9ybWF0VmFsdWUocm93W2NvbHVtbl0pOwoJICAgICAgfSkuam9pbihkZWxpbWl0ZXIpOwoJICAgIH0pKS5qb2luKCJcbiIpOwoJICB9CgoJICBmdW5jdGlvbiBmb3JtYXRSb3dzKHJvd3MpIHsKCSAgICByZXR1cm4gcm93cy5tYXAoZm9ybWF0Um93KS5qb2luKCJcbiIpOwoJICB9CgoJICBmdW5jdGlvbiBmb3JtYXRSb3cocm93KSB7CgkgICAgcmV0dXJuIHJvdy5tYXAoZm9ybWF0VmFsdWUpLmpvaW4oZGVsaW1pdGVyKTsKCSAgfQoKCSAgZnVuY3Rpb24gZm9ybWF0VmFsdWUodGV4dCkgewoJICAgIHJldHVybiB0ZXh0ID09IG51bGwgPyAiIgoJICAgICAgICA6IHJlRm9ybWF0LnRlc3QodGV4dCArPSAiIikgPyAiXCIiICsgdGV4dC5yZXBsYWNlKC9cIi9nLCAiXCJcIiIpICsgIlwiIgoJICAgICAgICA6IHRleHQ7CgkgIH0KCgkgIHJldHVybiB7CgkgICAgcGFyc2U6IHBhcnNlLAoJICAgIHBhcnNlUm93czogcGFyc2VSb3dzLAoJICAgIGZvcm1hdDogZm9ybWF0LAoJICAgIGZvcm1hdFJvd3M6IGZvcm1hdFJvd3MKCSAgfTsKCX0KCgl2YXIgY3N2ID0gZHN2JDEoIiwiKTsKCgl2YXIgY3N2UGFyc2UgPSBjc3YucGFyc2U7Cgl2YXIgY3N2UGFyc2VSb3dzID0gY3N2LnBhcnNlUm93czsKCXZhciBjc3ZGb3JtYXQgPSBjc3YuZm9ybWF0OwoJdmFyIGNzdkZvcm1hdFJvd3MgPSBjc3YuZm9ybWF0Um93czsKCgl2YXIgdHN2ID0gZHN2JDEoIlx0Iik7CgoJdmFyIHRzdlBhcnNlID0gdHN2LnBhcnNlOwoJdmFyIHRzdlBhcnNlUm93cyA9IHRzdi5wYXJzZVJvd3M7Cgl2YXIgdHN2Rm9ybWF0ID0gdHN2LmZvcm1hdDsKCXZhciB0c3ZGb3JtYXRSb3dzID0gdHN2LmZvcm1hdFJvd3M7CgoJdmFyIGQzRHN2ID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoewoJCV9fcHJvdG9fXzogbnVsbCwKCQljc3ZGb3JtYXQ6IGNzdkZvcm1hdCwKCQljc3ZGb3JtYXRSb3dzOiBjc3ZGb3JtYXRSb3dzLAoJCWNzdlBhcnNlOiBjc3ZQYXJzZSwKCQljc3ZQYXJzZVJvd3M6IGNzdlBhcnNlUm93cywKCQlkc3ZGb3JtYXQ6IGRzdiQxLAoJCXRzdkZvcm1hdDogdHN2Rm9ybWF0LAoJCXRzdkZvcm1hdFJvd3M6IHRzdkZvcm1hdFJvd3MsCgkJdHN2UGFyc2U6IHRzdlBhcnNlLAoJCXRzdlBhcnNlUm93czogdHN2UGFyc2VSb3dzCgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoZDNEc3YpOwoKCXZhciBzZXhhZ2VzaW1hbCQxID0ge2V4cG9ydHM6IHt9fTsKCglzZXhhZ2VzaW1hbCQxLmV4cG9ydHMgPSBlbGVtZW50OwoJc2V4YWdlc2ltYWwkMS5leHBvcnRzLnBhaXIgPSBwYWlyOwoJc2V4YWdlc2ltYWwkMS5leHBvcnRzLmZvcm1hdCA9IGZvcm1hdDsKCXNleGFnZXNpbWFsJDEuZXhwb3J0cy5mb3JtYXRQYWlyID0gZm9ybWF0UGFpcjsKCXNleGFnZXNpbWFsJDEuZXhwb3J0cy5jb29yZFRvRE1TID0gY29vcmRUb0RNUzsKCgoJZnVuY3Rpb24gZWxlbWVudChpbnB1dCwgZGltcykgewoJICB2YXIgcmVzdWx0ID0gc2VhcmNoKGlucHV0LCBkaW1zKTsKCSAgcmV0dXJuIChyZXN1bHQgPT09IG51bGwpID8gbnVsbCA6IHJlc3VsdC52YWw7Cgl9CgoKCWZ1bmN0aW9uIGZvcm1hdFBhaXIoaW5wdXQpIHsKCSAgcmV0dXJuIGZvcm1hdChpbnB1dC5sYXQsICdsYXQnKSArICcgJyArIGZvcm1hdChpbnB1dC5sb24sICdsb24nKTsKCX0KCgoJLy8gSXMgMCBOb3J0aCBvciBTb3V0aD8KCWZ1bmN0aW9uIGZvcm1hdChpbnB1dCwgZGltKSB7CgkgIHZhciBkbXMgPSBjb29yZFRvRE1TKGlucHV0LCBkaW0pOwoJICByZXR1cm4gZG1zLndob2xlICsgJ8KwICcgKwoJICAgIChkbXMubWludXRlcyA/IGRtcy5taW51dGVzICsgJ1wnICcgOiAnJykgKwoJICAgIChkbXMuc2Vjb25kcyA/IGRtcy5zZWNvbmRzICsgJyIgJyA6ICcnKSArIGRtcy5kaXI7Cgl9CgoKCWZ1bmN0aW9uIGNvb3JkVG9ETVMoaW5wdXQsIGRpbSkgewoJICB2YXIgZGlycyA9IHsgbGF0OiBbJ04nLCAnUyddLCBsb246IFsnRScsICdXJ10gfVtkaW1dIHx8ICcnOwoJICB2YXIgZGlyID0gZGlyc1tpbnB1dCA+PSAwID8gMCA6IDFdOwoJICB2YXIgYWJzID0gTWF0aC5hYnMoaW5wdXQpOwoJICB2YXIgd2hvbGUgPSBNYXRoLmZsb29yKGFicyk7CgkgIHZhciBmcmFjdGlvbiA9IGFicyAtIHdob2xlOwoJICB2YXIgZnJhY3Rpb25NaW51dGVzID0gZnJhY3Rpb24gKiA2MDsKCSAgdmFyIG1pbnV0ZXMgPSBNYXRoLmZsb29yKGZyYWN0aW9uTWludXRlcyk7CgkgIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcigoZnJhY3Rpb25NaW51dGVzIC0gbWludXRlcykgKiA2MCk7CgoJICByZXR1cm4gewoJICAgIHdob2xlOiB3aG9sZSwKCSAgICBtaW51dGVzOiBtaW51dGVzLAoJICAgIHNlY29uZHM6IHNlY29uZHMsCgkgICAgZGlyOiBkaXIKCSAgfTsKCX0KCgoJZnVuY3Rpb24gc2VhcmNoKGlucHV0LCBkaW1zKSB7CgkgIGlmICghZGltcykgZGltcyA9ICdOU0VXJzsKCSAgaWYgKHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycpIHJldHVybiBudWxsOwoKCSAgaW5wdXQgPSBpbnB1dC50b1VwcGVyQ2FzZSgpOwoJICB2YXIgcmVnZXggPSAvXltcc1wsXSooW05TRVddKT9ccyooW1wtfFzigJR8XOKAlV0/WzAtOS5dKylbwrDCusuaXT9ccyooPzooWzAtOS5dKylbJ+KAmeKAsuKAmF1ccyopPyg/OihbMC05Ll0rKSg/OicnfCJ84oCdfOKAsylccyopPyhbTlNFV10pPy87CgoJICB2YXIgbSA9IGlucHV0Lm1hdGNoKHJlZ2V4KTsKCSAgaWYgKCFtKSByZXR1cm4gbnVsbDsgIC8vIG5vIG1hdGNoCgoJICB2YXIgbWF0Y2hlZCA9IG1bMF07CgoJICAvLyBleHRyYWN0IGRpbWVuc2lvbi4uIG1bMV0gPSBsZWFkaW5nLCBtWzVdID0gdHJhaWxpbmcKCSAgdmFyIGRpbTsKCSAgaWYgKG1bMV0gJiYgbVs1XSkgeyAgICAgICAgICAgICAgICAgLy8gaWYgbWF0Y2hlZCBib3RoLi4KCSAgICBkaW0gPSBtWzFdOyAgICAgICAgICAgICAgICAgICAgICAgLy8ga2VlcCBsZWFkaW5nCgkgICAgbWF0Y2hlZCA9IG1hdGNoZWQuc2xpY2UoMCwgLTEpOyAgIC8vIHJlbW92ZSB0cmFpbGluZyBkaW1lbnNpb24gZnJvbSBtYXRjaAoJICB9IGVsc2UgewoJICAgIGRpbSA9IG1bMV0gfHwgbVs1XTsKCSAgfQoKCSAgLy8gaWYgdW5yZWNvZ25pemVkIGRpbWVuc2lvbgoJICBpZiAoZGltICYmIGRpbXMuaW5kZXhPZihkaW0pID09PSAtMSkgcmV0dXJuIG51bGw7CgoJICAvLyBleHRyYWN0IERNUwoJICB2YXIgZGVnID0gbVsyXSA/IHBhcnNlRmxvYXQobVsyXSkgOiAwOwoJICB2YXIgbWluID0gbVszXSA/IHBhcnNlRmxvYXQobVszXSkgLyA2MCA6IDA7CgkgIHZhciBzZWMgPSBtWzRdID8gcGFyc2VGbG9hdChtWzRdKSAvIDM2MDAgOiAwOwoJICB2YXIgc2lnbiA9IChkZWcgPCAwKSA/IC0xIDogMTsKCSAgaWYgKGRpbSA9PT0gJ1MnIHx8IGRpbSA9PT0gJ1cnKSBzaWduICo9IC0xOwoKCSAgcmV0dXJuIHsKCSAgICB2YWw6IChNYXRoLmFicyhkZWcpICsgbWluICsgc2VjKSAqIHNpZ24sCgkgICAgZGltOiBkaW0sCgkgICAgbWF0Y2hlZDogbWF0Y2hlZCwKCSAgICByZW1haW46IGlucHV0LnNsaWNlKG1hdGNoZWQubGVuZ3RoKQoJICB9OwoJfQoKCglmdW5jdGlvbiBwYWlyKGlucHV0LCBkaW1zKSB7CgkgIGlucHV0ID0gaW5wdXQudHJpbSgpOwoJICB2YXIgb25lID0gc2VhcmNoKGlucHV0LCBkaW1zKTsKCSAgaWYgKCFvbmUpIHJldHVybiBudWxsOwoKCSAgaW5wdXQgPSBvbmUucmVtYWluLnRyaW0oKTsKCSAgdmFyIHR3byA9IHNlYXJjaChpbnB1dCwgZGltcyk7CgkgIGlmICghdHdvIHx8IHR3by5yZW1haW4pIHJldHVybiBudWxsOwoKCSAgaWYgKG9uZS5kaW0pIHsKCSAgICByZXR1cm4gc3dhcGRpbShvbmUudmFsLCB0d28udmFsLCBvbmUuZGltKTsKCSAgfSBlbHNlIHsKCSAgICByZXR1cm4gW29uZS52YWwsIHR3by52YWxdOwoJICB9Cgl9CgoKCWZ1bmN0aW9uIHN3YXBkaW0oYSwgYiwgZGltKSB7CgkgIGlmIChkaW0gPT09ICdOJyB8fCBkaW0gPT09ICdTJykgcmV0dXJuIFthLCBiXTsKCSAgaWYgKGRpbSA9PT0gJ1cnIHx8IGRpbSA9PT0gJ0UnKSByZXR1cm4gW2IsIGFdOwoJfQoKCXZhciBzZXhhZ2VzaW1hbEV4cG9ydHMgPSBzZXhhZ2VzaW1hbCQxLmV4cG9ydHM7CgoJdmFyIGRzdiA9IHJlcXVpcmUkJDAsCgkgICAgc2V4YWdlc2ltYWwgPSBzZXhhZ2VzaW1hbEV4cG9ydHM7CgoJdmFyIGxhdFJlZ2V4ID0gLyhMYXQpKGl0dWRlKT8vZ2ksCgkgICAgbG9uUmVnZXggPSAvKEwpKG9ufG5nKShnaXR1ZGUpPy9pOwoKCWZ1bmN0aW9uIGd1ZXNzSGVhZGVyKHJvdywgcmVnZXhwKSB7CgkgICAgdmFyIG5hbWUsIG1hdGNoLCBzY29yZTsKCSAgICBmb3IgKHZhciBmIGluIHJvdykgewoJICAgICAgICBtYXRjaCA9IGYubWF0Y2gocmVnZXhwKTsKCSAgICAgICAgaWYgKG1hdGNoICYmICghbmFtZSB8fCBtYXRjaFswXS5sZW5ndGggLyBmLmxlbmd0aCA+IHNjb3JlKSkgewoJICAgICAgICAgICAgc2NvcmUgPSBtYXRjaFswXS5sZW5ndGggLyBmLmxlbmd0aDsKCSAgICAgICAgICAgIG5hbWUgPSBmOwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiBuYW1lOwoJfQoKCWZ1bmN0aW9uIGd1ZXNzTGF0SGVhZGVyKHJvdykgeyByZXR1cm4gZ3Vlc3NIZWFkZXIocm93LCBsYXRSZWdleCk7IH0KCWZ1bmN0aW9uIGd1ZXNzTG9uSGVhZGVyKHJvdykgeyByZXR1cm4gZ3Vlc3NIZWFkZXIocm93LCBsb25SZWdleCk7IH0KCglmdW5jdGlvbiBpc0xhdChmKSB7IHJldHVybiAhIWYubWF0Y2gobGF0UmVnZXgpOyB9CglmdW5jdGlvbiBpc0xvbihmKSB7IHJldHVybiAhIWYubWF0Y2gobG9uUmVnZXgpOyB9CgoJZnVuY3Rpb24ga2V5Q291bnQobykgewoJICAgIHJldHVybiAodHlwZW9mIG8gPT0gJ29iamVjdCcpID8gT2JqZWN0LmtleXMobykubGVuZ3RoIDogMDsKCX0KCglmdW5jdGlvbiBhdXRvRGVsaW1pdGVyKHgpIHsKCSAgICB2YXIgZGVsaW1pdGVycyA9IFsnLCcsICc7JywgJ1x0JywgJ3wnXTsKCSAgICB2YXIgcmVzdWx0cyA9IFtdOwoKCSAgICBkZWxpbWl0ZXJzLmZvckVhY2goZnVuY3Rpb24gKGRlbGltaXRlcikgewoJICAgICAgICB2YXIgcmVzID0gZHN2LmRzdkZvcm1hdChkZWxpbWl0ZXIpLnBhcnNlKHgpOwoJICAgICAgICBpZiAocmVzLmxlbmd0aCA+PSAxKSB7CgkgICAgICAgICAgICB2YXIgY291bnQgPSBrZXlDb3VudChyZXNbMF0pOwoJICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoa2V5Q291bnQocmVzW2ldKSAhPT0gY291bnQpIHJldHVybjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7CgkgICAgICAgICAgICAgICAgZGVsaW1pdGVyOiBkZWxpbWl0ZXIsCgkgICAgICAgICAgICAgICAgYXJpdHk6IE9iamVjdC5rZXlzKHJlc1swXSkubGVuZ3RoLAoJICAgICAgICAgICAgfSk7CgkgICAgICAgIH0KCSAgICB9KTsKCgkgICAgaWYgKHJlc3VsdHMubGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiByZXN1bHRzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKCSAgICAgICAgICAgIHJldHVybiBiLmFyaXR5IC0gYS5hcml0eTsKCSAgICAgICAgfSlbMF0uZGVsaW1pdGVyOwoJICAgIH0gZWxzZSB7CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH0KCX0KCgkvKioKCSAqIFNpbGx5IHN0b3BnYXAgZm9yIGRzdiB0byBkMy1kc3YgdXBncmFkZQoJICoKCSAqIEBwYXJhbSB7QXJyYXl9IHggZHN2IG91dHB1dAoJICogQHJldHVybnMge0FycmF5fSBhcnJheSB3aXRob3V0IGNvbHVtbnMgbWVtYmVyCgkgKi8KCWZ1bmN0aW9uIGRlbGV0ZUNvbHVtbnMoeCkgewoJICAgIGRlbGV0ZSB4LmNvbHVtbnM7CgkgICAgcmV0dXJuIHg7Cgl9CgoJZnVuY3Rpb24gYXV0byh4KSB7CgkgICAgdmFyIGRlbGltaXRlciA9IGF1dG9EZWxpbWl0ZXIoeCk7CgkgICAgaWYgKCFkZWxpbWl0ZXIpIHJldHVybiBudWxsOwoJICAgIHJldHVybiBkZWxldGVDb2x1bW5zKGRzdi5kc3ZGb3JtYXQoZGVsaW1pdGVyKS5wYXJzZSh4KSk7Cgl9CgoJZnVuY3Rpb24gY3N2Mmdlb2pzb24oeCwgb3B0aW9ucywgY2FsbGJhY2spIHsKCgkgICAgaWYgKCFjYWxsYmFjaykgewoJICAgICAgICBjYWxsYmFjayA9IG9wdGlvbnM7CgkgICAgICAgIG9wdGlvbnMgPSB7fTsKCSAgICB9CgoJICAgIG9wdGlvbnMuZGVsaW1pdGVyID0gb3B0aW9ucy5kZWxpbWl0ZXIgfHwgJywnOwoKCSAgICB2YXIgbGF0ZmllbGQgPSBvcHRpb25zLmxhdGZpZWxkIHx8ICcnLAoJICAgICAgICBsb25maWVsZCA9IG9wdGlvbnMubG9uZmllbGQgfHwgJycsCgkgICAgICAgIGNycyA9IG9wdGlvbnMuY3JzIHx8ICcnOwoKCSAgICB2YXIgZmVhdHVyZXMgPSBbXSwKCSAgICAgICAgZmVhdHVyZWNvbGxlY3Rpb24gPSB7dHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywgZmVhdHVyZXM6IGZlYXR1cmVzfTsKCgkgICAgaWYgKGNycyAhPT0gJycpIHsKCSAgICAgICAgZmVhdHVyZWNvbGxlY3Rpb24uY3JzID0ge3R5cGU6ICduYW1lJywgcHJvcGVydGllczoge25hbWU6IGNyc319OwoJICAgIH0KCgkgICAgaWYgKG9wdGlvbnMuZGVsaW1pdGVyID09PSAnYXV0bycgJiYgdHlwZW9mIHggPT0gJ3N0cmluZycpIHsKCSAgICAgICAgb3B0aW9ucy5kZWxpbWl0ZXIgPSBhdXRvRGVsaW1pdGVyKHgpOwoJICAgICAgICBpZiAoIW9wdGlvbnMuZGVsaW1pdGVyKSB7CgkgICAgICAgICAgICBjYWxsYmFjayh7CgkgICAgICAgICAgICAgICAgdHlwZTogJ0Vycm9yJywKCSAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQ291bGQgbm90IGF1dG9kZXRlY3QgZGVsaW1pdGVyJwoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICByZXR1cm47CgkgICAgICAgIH0KCSAgICB9CgoJICAgIHZhciBudW1lcmljRmllbGRzID0gb3B0aW9ucy5udW1lcmljRmllbGRzID8gb3B0aW9ucy5udW1lcmljRmllbGRzLnNwbGl0KCcsJykgOiBudWxsOwoKCSAgICB2YXIgcGFyc2VkID0gKHR5cGVvZiB4ID09ICdzdHJpbmcnKSA/CgkgICAgICAgIGRzdi5kc3ZGb3JtYXQob3B0aW9ucy5kZWxpbWl0ZXIpLnBhcnNlKHgsIGZ1bmN0aW9uIChkKSB7CgkgICAgICAgICAgICBpZiAobnVtZXJpY0ZpZWxkcykgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBkKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChudW1lcmljRmllbGRzLmluY2x1ZGVzKGtleSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGRba2V5XSA9ICtkW2tleV07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXR1cm4gZDsKCSAgICAgICAgfSkgOiB4OwoKCSAgICBpZiAoIXBhcnNlZC5sZW5ndGgpIHsKCSAgICAgICAgY2FsbGJhY2sobnVsbCwgZmVhdHVyZWNvbGxlY3Rpb24pOwoJICAgICAgICByZXR1cm47CgkgICAgfQoKCSAgICB2YXIgZXJyb3JzID0gW107CgkgICAgdmFyIGk7CgoKCSAgICBpZiAoIWxhdGZpZWxkKSBsYXRmaWVsZCA9IGd1ZXNzTGF0SGVhZGVyKHBhcnNlZFswXSk7CgkgICAgaWYgKCFsb25maWVsZCkgbG9uZmllbGQgPSBndWVzc0xvbkhlYWRlcihwYXJzZWRbMF0pOwoJICAgIHZhciBub0dlb21ldHJ5ID0gKCFsYXRmaWVsZCB8fCAhbG9uZmllbGQpOwoKCSAgICBpZiAobm9HZW9tZXRyeSkgewoJICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGFyc2VkLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICBmZWF0dXJlcy5wdXNoKHsKCSAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgICAgICAgICAgcHJvcGVydGllczogcGFyc2VkW2ldLAoJICAgICAgICAgICAgICAgIGdlb21ldHJ5OiBudWxsCgkgICAgICAgICAgICB9KTsKCSAgICAgICAgfQoJICAgICAgICBjYWxsYmFjayhlcnJvcnMubGVuZ3RoID8gZXJyb3JzIDogbnVsbCwgZmVhdHVyZWNvbGxlY3Rpb24pOwoJICAgICAgICByZXR1cm47CgkgICAgfQoKCSAgICBmb3IgKGkgPSAwOyBpIDwgcGFyc2VkLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGlmIChwYXJzZWRbaV1bbG9uZmllbGRdICE9PSB1bmRlZmluZWQgJiYKCSAgICAgICAgICAgIHBhcnNlZFtpXVtsYXRmaWVsZF0gIT09IHVuZGVmaW5lZCkgewoKCSAgICAgICAgICAgIHZhciBsb25rID0gcGFyc2VkW2ldW2xvbmZpZWxkXSwKCSAgICAgICAgICAgICAgICBsYXRrID0gcGFyc2VkW2ldW2xhdGZpZWxkXSwKCSAgICAgICAgICAgICAgICBsb25mLCBsYXRmLAoJICAgICAgICAgICAgICAgIGE7CgoJICAgICAgICAgICAgYSA9IHNleGFnZXNpbWFsKGxvbmssICdFVycpOwoJICAgICAgICAgICAgaWYgKGEpIGxvbmsgPSBhOwoJICAgICAgICAgICAgYSA9IHNleGFnZXNpbWFsKGxhdGssICdOUycpOwoJICAgICAgICAgICAgaWYgKGEpIGxhdGsgPSBhOwoKCSAgICAgICAgICAgIGxvbmYgPSBwYXJzZUZsb2F0KGxvbmspOwoJICAgICAgICAgICAgbGF0ZiA9IHBhcnNlRmxvYXQobGF0ayk7CgoJICAgICAgICAgICAgaWYgKGlzTmFOKGxvbmYpIHx8CgkgICAgICAgICAgICAgICAgaXNOYU4obGF0ZikpIHsKCSAgICAgICAgICAgICAgICBlcnJvcnMucHVzaCh7CgkgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdBIHJvdyBjb250YWluZWQgYW4gaW52YWxpZCB2YWx1ZSBmb3IgbGF0aXR1ZGUgb3IgbG9uZ2l0dWRlJywKCSAgICAgICAgICAgICAgICAgICAgcm93OiBwYXJzZWRbaV0sCgkgICAgICAgICAgICAgICAgICAgIGluZGV4OiBpCgkgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgIGlmICghb3B0aW9ucy5pbmNsdWRlTGF0TG9uKSB7CgkgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwYXJzZWRbaV1bbG9uZmllbGRdOwoJICAgICAgICAgICAgICAgICAgICBkZWxldGUgcGFyc2VkW2ldW2xhdGZpZWxkXTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIGZlYXR1cmVzLnB1c2goewoJICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHBhcnNlZFtpXSwKCSAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnk6IHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogWwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlRmxvYXQobG9uZiksCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdChsYXRmKQoJICAgICAgICAgICAgICAgICAgICAgICAgXQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGNhbGxiYWNrKGVycm9ycy5sZW5ndGggPyBlcnJvcnMgOiBudWxsLCBmZWF0dXJlY29sbGVjdGlvbik7Cgl9CgoJZnVuY3Rpb24gdG9MaW5lKGdqKSB7CgkgICAgdmFyIGZlYXR1cmVzID0gZ2ouZmVhdHVyZXM7CgkgICAgdmFyIGxpbmUgPSB7CgkgICAgICAgIHR5cGU6ICdGZWF0dXJlJywKCSAgICAgICAgZ2VvbWV0cnk6IHsKCSAgICAgICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJywKCSAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbXQoJICAgICAgICB9CgkgICAgfTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGxpbmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXMucHVzaChmZWF0dXJlc1tpXS5nZW9tZXRyeS5jb29yZGluYXRlcyk7CgkgICAgfQoJICAgIGxpbmUucHJvcGVydGllcyA9IGZlYXR1cmVzLnJlZHVjZShmdW5jdGlvbiAoYWdncmVnYXRlZFByb3BlcnRpZXMsIG5ld0ZlYXR1cmUpIHsKCSAgICAgICAgZm9yICh2YXIga2V5IGluIG5ld0ZlYXR1cmUucHJvcGVydGllcykgewoJICAgICAgICAgICAgaWYgKCFhZ2dyZWdhdGVkUHJvcGVydGllc1trZXldKSB7CgkgICAgICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XSA9IFtdOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XS5wdXNoKG5ld0ZlYXR1cmUucHJvcGVydGllc1trZXldKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYWdncmVnYXRlZFByb3BlcnRpZXM7CgkgICAgfSwge30pOwoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCgkgICAgICAgIGZlYXR1cmVzOiBbbGluZV0KCSAgICB9OwoJfQoKCWZ1bmN0aW9uIHRvUG9seWdvbihnaikgewoJICAgIHZhciBmZWF0dXJlcyA9IGdqLmZlYXR1cmVzOwoJICAgIHZhciBwb2x5ID0gewoJICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICB0eXBlOiAnUG9seWdvbicsCgkgICAgICAgICAgICBjb29yZGluYXRlczogW1tdXQoJICAgICAgICB9CgkgICAgfTsKCSAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZlYXR1cmVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIHBvbHkuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0ucHVzaChmZWF0dXJlc1tpXS5nZW9tZXRyeS5jb29yZGluYXRlcyk7CgkgICAgfQoJICAgIHBvbHkucHJvcGVydGllcyA9IGZlYXR1cmVzLnJlZHVjZShmdW5jdGlvbiAoYWdncmVnYXRlZFByb3BlcnRpZXMsIG5ld0ZlYXR1cmUpIHsKCSAgICAgICAgZm9yICh2YXIga2V5IGluIG5ld0ZlYXR1cmUucHJvcGVydGllcykgewoJICAgICAgICAgICAgaWYgKCFhZ2dyZWdhdGVkUHJvcGVydGllc1trZXldKSB7CgkgICAgICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XSA9IFtdOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYWdncmVnYXRlZFByb3BlcnRpZXNba2V5XS5wdXNoKG5ld0ZlYXR1cmUucHJvcGVydGllc1trZXldKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYWdncmVnYXRlZFByb3BlcnRpZXM7CgkgICAgfSwge30pOwoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCgkgICAgICAgIGZlYXR1cmVzOiBbcG9seV0KCSAgICB9OwoJfQoKCXZhciBjc3YyZ2VvanNvbl8xID0gewoJICAgIGlzTG9uOiBpc0xvbiwKCSAgICBpc0xhdDogaXNMYXQsCgkgICAgZ3Vlc3NMYXRIZWFkZXI6IGd1ZXNzTGF0SGVhZGVyLAoJICAgIGd1ZXNzTG9uSGVhZGVyOiBndWVzc0xvbkhlYWRlciwKCSAgICBjc3Y6IGRzdi5jc3ZQYXJzZSwKCSAgICB0c3Y6IGRzdi50c3ZQYXJzZSwKCSAgICBkc3Y6IGRzdiwKCSAgICBhdXRvOiBhdXRvLAoJICAgIGNzdjJnZW9qc29uOiBjc3YyZ2VvanNvbiwKCSAgICB0b0xpbmU6IHRvTGluZSwKCSAgICB0b1BvbHlnb246IHRvUG9seWdvbgoJfTsKCglmdW5jdGlvbiBpZGVudGl0eSh4KSB7CgkgIHJldHVybiB4OwoJfQoKCWZ1bmN0aW9uIHRyYW5zZm9ybSh0cmFuc2Zvcm0pIHsKCSAgaWYgKHRyYW5zZm9ybSA9PSBudWxsKSByZXR1cm4gaWRlbnRpdHk7CgkgIHZhciB4MCwKCSAgICAgIHkwLAoJICAgICAga3ggPSB0cmFuc2Zvcm0uc2NhbGVbMF0sCgkgICAgICBreSA9IHRyYW5zZm9ybS5zY2FsZVsxXSwKCSAgICAgIGR4ID0gdHJhbnNmb3JtLnRyYW5zbGF0ZVswXSwKCSAgICAgIGR5ID0gdHJhbnNmb3JtLnRyYW5zbGF0ZVsxXTsKCSAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBpKSB7CgkgICAgaWYgKCFpKSB4MCA9IHkwID0gMDsKCSAgICB2YXIgaiA9IDIsIG4gPSBpbnB1dC5sZW5ndGgsIG91dHB1dCA9IG5ldyBBcnJheShuKTsKCSAgICBvdXRwdXRbMF0gPSAoeDAgKz0gaW5wdXRbMF0pICoga3ggKyBkeDsKCSAgICBvdXRwdXRbMV0gPSAoeTAgKz0gaW5wdXRbMV0pICoga3kgKyBkeTsKCSAgICB3aGlsZSAoaiA8IG4pIG91dHB1dFtqXSA9IGlucHV0W2pdLCArK2o7CgkgICAgcmV0dXJuIG91dHB1dDsKCSAgfTsKCX0KCglmdW5jdGlvbiByZXZlcnNlKGFycmF5LCBuKSB7CgkgIHZhciB0LCBqID0gYXJyYXkubGVuZ3RoLCBpID0gaiAtIG47CgkgIHdoaWxlIChpIDwgLS1qKSB0ID0gYXJyYXlbaV0sIGFycmF5W2krK10gPSBhcnJheVtqXSwgYXJyYXlbal0gPSB0OwoJfQoKCWZ1bmN0aW9uIHRvcG9qc29uRmVhdHVyZSh0b3BvbG9neSwgbykgewoJICBpZiAodHlwZW9mIG8gPT09ICJzdHJpbmciKSBvID0gdG9wb2xvZ3kub2JqZWN0c1tvXTsKCSAgcmV0dXJuIG8udHlwZSA9PT0gIkdlb21ldHJ5Q29sbGVjdGlvbiIKCSAgICAgID8ge3R5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsIGZlYXR1cmVzOiBvLmdlb21ldHJpZXMubWFwKGZ1bmN0aW9uKG8pIHsgcmV0dXJuIGZlYXR1cmUodG9wb2xvZ3ksIG8pOyB9KX0KCSAgICAgIDogZmVhdHVyZSh0b3BvbG9neSwgbyk7Cgl9CgoJZnVuY3Rpb24gZmVhdHVyZSh0b3BvbG9neSwgbykgewoJICB2YXIgaWQgPSBvLmlkLAoJICAgICAgYmJveCA9IG8uYmJveCwKCSAgICAgIHByb3BlcnRpZXMgPSBvLnByb3BlcnRpZXMgPT0gbnVsbCA/IHt9IDogby5wcm9wZXJ0aWVzLAoJICAgICAgZ2VvbWV0cnkgPSBvYmplY3QodG9wb2xvZ3ksIG8pOwoJICByZXR1cm4gaWQgPT0gbnVsbCAmJiBiYm94ID09IG51bGwgPyB7dHlwZTogIkZlYXR1cmUiLCBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLCBnZW9tZXRyeTogZ2VvbWV0cnl9CgkgICAgICA6IGJib3ggPT0gbnVsbCA/IHt0eXBlOiAiRmVhdHVyZSIsIGlkOiBpZCwgcHJvcGVydGllczogcHJvcGVydGllcywgZ2VvbWV0cnk6IGdlb21ldHJ5fQoJICAgICAgOiB7dHlwZTogIkZlYXR1cmUiLCBpZDogaWQsIGJib3g6IGJib3gsIHByb3BlcnRpZXM6IHByb3BlcnRpZXMsIGdlb21ldHJ5OiBnZW9tZXRyeX07Cgl9CgoJZnVuY3Rpb24gb2JqZWN0KHRvcG9sb2d5LCBvKSB7CgkgIHZhciB0cmFuc2Zvcm1Qb2ludCA9IHRyYW5zZm9ybSh0b3BvbG9neS50cmFuc2Zvcm0pLAoJICAgICAgYXJjcyA9IHRvcG9sb2d5LmFyY3M7CgoJICBmdW5jdGlvbiBhcmMoaSwgcG9pbnRzKSB7CgkgICAgaWYgKHBvaW50cy5sZW5ndGgpIHBvaW50cy5wb3AoKTsKCSAgICBmb3IgKHZhciBhID0gYXJjc1tpIDwgMCA/IH5pIDogaV0sIGsgPSAwLCBuID0gYS5sZW5ndGg7IGsgPCBuOyArK2spIHsKCSAgICAgIHBvaW50cy5wdXNoKHRyYW5zZm9ybVBvaW50KGFba10sIGspKTsKCSAgICB9CgkgICAgaWYgKGkgPCAwKSByZXZlcnNlKHBvaW50cywgbik7CgkgIH0KCgkgIGZ1bmN0aW9uIHBvaW50KHApIHsKCSAgICByZXR1cm4gdHJhbnNmb3JtUG9pbnQocCk7CgkgIH0KCgkgIGZ1bmN0aW9uIGxpbmUoYXJjcykgewoJICAgIHZhciBwb2ludHMgPSBbXTsKCSAgICBmb3IgKHZhciBpID0gMCwgbiA9IGFyY3MubGVuZ3RoOyBpIDwgbjsgKytpKSBhcmMoYXJjc1tpXSwgcG9pbnRzKTsKCSAgICBpZiAocG9pbnRzLmxlbmd0aCA8IDIpIHBvaW50cy5wdXNoKHBvaW50c1swXSk7IC8vIFRoaXMgc2hvdWxkIG5ldmVyIGhhcHBlbiBwZXIgdGhlIHNwZWNpZmljYXRpb24uCgkgICAgcmV0dXJuIHBvaW50czsKCSAgfQoKCSAgZnVuY3Rpb24gcmluZyhhcmNzKSB7CgkgICAgdmFyIHBvaW50cyA9IGxpbmUoYXJjcyk7CgkgICAgd2hpbGUgKHBvaW50cy5sZW5ndGggPCA0KSBwb2ludHMucHVzaChwb2ludHNbMF0pOyAvLyBUaGlzIG1heSBoYXBwZW4gaWYgYW4gYXJjIGhhcyBvbmx5IHR3byBwb2ludHMuCgkgICAgcmV0dXJuIHBvaW50czsKCSAgfQoKCSAgZnVuY3Rpb24gcG9seWdvbihhcmNzKSB7CgkgICAgcmV0dXJuIGFyY3MubWFwKHJpbmcpOwoJICB9CgoJICBmdW5jdGlvbiBnZW9tZXRyeShvKSB7CgkgICAgdmFyIHR5cGUgPSBvLnR5cGUsIGNvb3JkaW5hdGVzOwoJICAgIHN3aXRjaCAodHlwZSkgewoJICAgICAgY2FzZSAiR2VvbWV0cnlDb2xsZWN0aW9uIjogcmV0dXJuIHt0eXBlOiB0eXBlLCBnZW9tZXRyaWVzOiBvLmdlb21ldHJpZXMubWFwKGdlb21ldHJ5KX07CgkgICAgICBjYXNlICJQb2ludCI6IGNvb3JkaW5hdGVzID0gcG9pbnQoby5jb29yZGluYXRlcyk7IGJyZWFrOwoJICAgICAgY2FzZSAiTXVsdGlQb2ludCI6IGNvb3JkaW5hdGVzID0gby5jb29yZGluYXRlcy5tYXAocG9pbnQpOyBicmVhazsKCSAgICAgIGNhc2UgIkxpbmVTdHJpbmciOiBjb29yZGluYXRlcyA9IGxpbmUoby5hcmNzKTsgYnJlYWs7CgkgICAgICBjYXNlICJNdWx0aUxpbmVTdHJpbmciOiBjb29yZGluYXRlcyA9IG8uYXJjcy5tYXAobGluZSk7IGJyZWFrOwoJICAgICAgY2FzZSAiUG9seWdvbiI6IGNvb3JkaW5hdGVzID0gcG9seWdvbihvLmFyY3MpOyBicmVhazsKCSAgICAgIGNhc2UgIk11bHRpUG9seWdvbiI6IGNvb3JkaW5hdGVzID0gby5hcmNzLm1hcChwb2x5Z29uKTsgYnJlYWs7CgkgICAgICBkZWZhdWx0OiByZXR1cm4gbnVsbDsKCSAgICB9CgkgICAgcmV0dXJuIHt0eXBlOiB0eXBlLCBjb29yZGluYXRlczogY29vcmRpbmF0ZXN9OwoJICB9CgoJICByZXR1cm4gZ2VvbWV0cnkobyk7Cgl9CgoJZnVuY3Rpb24gJChlbGVtZW50LCB0YWdOYW1lKSB7CgkgICAgcmV0dXJuIEFycmF5LmZyb20oZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKSk7Cgl9CglmdW5jdGlvbiBub3JtYWxpemVJZChpZCkgewoJICAgIHJldHVybiBpZFswXSA9PT0gIiMiID8gaWQgOiBgIyR7aWR9YDsKCX0KCWZ1bmN0aW9uICRucyhlbGVtZW50LCB0YWdOYW1lLCBucykgewoJICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhucywgdGFnTmFtZSkpOwoJfQoJLyoqCgkgKiBnZXQgdGhlIGNvbnRlbnQgb2YgYSB0ZXh0IG5vZGUsIGlmIGFueQoJICovCglmdW5jdGlvbiBub2RlVmFsKG5vZGUpIHsKCSAgICBub2RlPy5ub3JtYWxpemUoKTsKCSAgICByZXR1cm4gKG5vZGUgJiYgbm9kZS50ZXh0Q29udGVudCkgfHwgIiI7Cgl9CgkvKioKCSAqIEdldCBvbmUgWSBjaGlsZCBvZiBYLCBpZiBhbnksIG90aGVyd2lzZSBudWxsCgkgKi8KCWZ1bmN0aW9uIGdldDEobm9kZSwgdGFnTmFtZSwgY2FsbGJhY2spIHsKCSAgICBjb25zdCBuID0gbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKTsKCSAgICBjb25zdCByZXN1bHQgPSBuLmxlbmd0aCA/IG5bMF0gOiBudWxsOwoJICAgIGlmIChyZXN1bHQgJiYgY2FsbGJhY2spCgkgICAgICAgIGNhbGxiYWNrKHJlc3VsdCk7CgkgICAgcmV0dXJuIHJlc3VsdDsKCX0KCWZ1bmN0aW9uIGdldChub2RlLCB0YWdOYW1lLCBjYWxsYmFjaykgewoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7fTsKCSAgICBpZiAoIW5vZGUpCgkgICAgICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJICAgIGNvbnN0IG4gPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZ05hbWUpOwoJICAgIGNvbnN0IHJlc3VsdCA9IG4ubGVuZ3RoID8gblswXSA6IG51bGw7CgkgICAgaWYgKHJlc3VsdCAmJiBjYWxsYmFjaykgewoJICAgICAgICByZXR1cm4gY2FsbGJhY2socmVzdWx0LCBwcm9wZXJ0aWVzKTsKCSAgICB9CgkgICAgcmV0dXJuIHByb3BlcnRpZXM7Cgl9CglmdW5jdGlvbiB2YWwxKG5vZGUsIHRhZ05hbWUsIGNhbGxiYWNrKSB7CgkgICAgY29uc3QgdmFsID0gbm9kZVZhbChnZXQxKG5vZGUsIHRhZ05hbWUpKTsKCSAgICBpZiAodmFsICYmIGNhbGxiYWNrKQoJICAgICAgICByZXR1cm4gY2FsbGJhY2sodmFsKSB8fCB7fTsKCSAgICByZXR1cm4ge307Cgl9CglmdW5jdGlvbiAkbnVtKG5vZGUsIHRhZ05hbWUsIGNhbGxiYWNrKSB7CgkgICAgY29uc3QgdmFsID0gcGFyc2VGbG9hdChub2RlVmFsKGdldDEobm9kZSwgdGFnTmFtZSkpKTsKCSAgICBpZiAoaXNOYU4odmFsKSkKCSAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCSAgICBpZiAodmFsICYmIGNhbGxiYWNrKQoJICAgICAgICByZXR1cm4gY2FsbGJhY2sodmFsKSB8fCB7fTsKCSAgICByZXR1cm4ge307Cgl9CglmdW5jdGlvbiBudW0xKG5vZGUsIHRhZ05hbWUsIGNhbGxiYWNrKSB7CgkgICAgY29uc3QgdmFsID0gcGFyc2VGbG9hdChub2RlVmFsKGdldDEobm9kZSwgdGFnTmFtZSkpKTsKCSAgICBpZiAoaXNOYU4odmFsKSkKCSAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKCSAgICBpZiAoY2FsbGJhY2spCgkgICAgICAgIGNhbGxiYWNrKHZhbCk7CgkgICAgcmV0dXJuIHZhbDsKCX0KCWZ1bmN0aW9uIGdldE11bHRpKG5vZGUsIHByb3BlcnR5TmFtZXMpIHsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0ge307CgkgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBvZiBwcm9wZXJ0eU5hbWVzKSB7CgkgICAgICAgIHZhbDEobm9kZSwgcHJvcGVydHksICh2YWwpID0+IHsKCSAgICAgICAgICAgIHByb3BlcnRpZXNbcHJvcGVydHldID0gdmFsOwoJICAgICAgICB9KTsKCSAgICB9CgkgICAgcmV0dXJuIHByb3BlcnRpZXM7Cgl9CglmdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkgewoJICAgIHJldHVybiBub2RlPy5ub2RlVHlwZSA9PT0gMTsKCX0KCglmdW5jdGlvbiBnZXRMaW5lU3R5bGUobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgImxpbmUiLCAobGluZVN0eWxlKSA9PiB7CgkgICAgICAgIGNvbnN0IHZhbCA9IE9iamVjdC5hc3NpZ24oe30sIHZhbDEobGluZVN0eWxlLCAiY29sb3IiLCAoY29sb3IpID0+IHsKCSAgICAgICAgICAgIHJldHVybiB7IHN0cm9rZTogYCMke2NvbG9yfWAgfTsKCSAgICAgICAgfSksICRudW0obGluZVN0eWxlLCAib3BhY2l0eSIsIChvcGFjaXR5KSA9PiB7CgkgICAgICAgICAgICByZXR1cm4geyAic3Ryb2tlLW9wYWNpdHkiOiBvcGFjaXR5IH07CgkgICAgICAgIH0pLCAkbnVtKGxpbmVTdHlsZSwgIndpZHRoIiwgKHdpZHRoKSA9PiB7CgkgICAgICAgICAgICAvLyBHUFggd2lkdGggaXMgaW4gbW0sIGNvbnZlcnQgdG8gcHggd2l0aCA5NiBweCBwZXIgaW5jaAoJICAgICAgICAgICAgcmV0dXJuIHsgInN0cm9rZS13aWR0aCI6ICh3aWR0aCAqIDk2KSAvIDI1LjQgfTsKCSAgICAgICAgfSkpOwoJICAgICAgICByZXR1cm4gdmFsOwoJICAgIH0pOwoJfQoKCWZ1bmN0aW9uIGdldEV4dGVuc2lvbnMobm9kZSkgewoJICAgIGxldCB2YWx1ZXMgPSBbXTsKCSAgICBpZiAobm9kZSA9PT0gbnVsbCkKCSAgICAgICAgcmV0dXJuIHZhbHVlczsKCSAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIEFycmF5LmZyb20obm9kZS5jaGlsZE5vZGVzKSkgewoJICAgICAgICBpZiAoIWlzRWxlbWVudChjaGlsZCkpCgkgICAgICAgICAgICBjb250aW51ZTsKCSAgICAgICAgY29uc3QgbmFtZSA9IGFiYnJldmlhdGVOYW1lKGNoaWxkLm5vZGVOYW1lKTsKCSAgICAgICAgaWYgKG5hbWUgPT09ICJncHh0cHg6VHJhY2tQb2ludEV4dGVuc2lvbiIpIHsKCSAgICAgICAgICAgIC8vIGxvb3AgYWdhaW4gZm9yIG5lc3RlZCBnYXJtaW4gZXh0ZW5zaW9ucyAoZWcuICJncHh0cHg6aHIiKQoJICAgICAgICAgICAgdmFsdWVzID0gdmFsdWVzLmNvbmNhdChnZXRFeHRlbnNpb25zKGNoaWxkKSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBwdXNoIGN1c3RvbSBleHRlbnNpb24gKGVnLiAicG93ZXIiKQoJICAgICAgICAgICAgY29uc3QgdmFsID0gbm9kZVZhbChjaGlsZCk7CgkgICAgICAgICAgICB2YWx1ZXMucHVzaChbbmFtZSwgcGFyc2VOdW1lcmljKHZhbCldKTsKCSAgICAgICAgfQoJICAgIH0KCSAgICByZXR1cm4gdmFsdWVzOwoJfQoJZnVuY3Rpb24gYWJicmV2aWF0ZU5hbWUobmFtZSkgewoJICAgIHJldHVybiBbImhlYXJ0IiwgImdweHRweDpociIsICJociJdLmluY2x1ZGVzKG5hbWUpID8gImhlYXJ0IiA6IG5hbWU7Cgl9CglmdW5jdGlvbiBwYXJzZU51bWVyaWModmFsKSB7CgkgICAgY29uc3QgbnVtID0gcGFyc2VGbG9hdCh2YWwpOwoJICAgIHJldHVybiBpc05hTihudW0pID8gdmFsIDogbnVtOwoJfQoKCWZ1bmN0aW9uIGNvb3JkUGFpciQxKG5vZGUpIHsKCSAgICBjb25zdCBsbCA9IFsKCSAgICAgICAgcGFyc2VGbG9hdChub2RlLmdldEF0dHJpYnV0ZSgibG9uIikgfHwgIiIpLAoJICAgICAgICBwYXJzZUZsb2F0KG5vZGUuZ2V0QXR0cmlidXRlKCJsYXQiKSB8fCAiIiksCgkgICAgXTsKCSAgICBpZiAoaXNOYU4obGxbMF0pIHx8IGlzTmFOKGxsWzFdKSkgewoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9CgkgICAgbnVtMShub2RlLCAiZWxlIiwgKHZhbCkgPT4gewoJICAgICAgICBsbC5wdXNoKHZhbCk7CgkgICAgfSk7CgkgICAgY29uc3QgdGltZSA9IGdldDEobm9kZSwgInRpbWUiKTsKCSAgICByZXR1cm4gewoJICAgICAgICBjb29yZGluYXRlczogbGwsCgkgICAgICAgIHRpbWU6IHRpbWUgPyBub2RlVmFsKHRpbWUpIDogbnVsbCwKCSAgICAgICAgZXh0ZW5kZWRWYWx1ZXM6IGdldEV4dGVuc2lvbnMoZ2V0MShub2RlLCAiZXh0ZW5zaW9ucyIpKSwKCSAgICB9OwoJfQoKCWZ1bmN0aW9uIGV4dHJhY3RQcm9wZXJ0aWVzKG5vZGUpIHsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0gZ2V0TXVsdGkobm9kZSwgWwoJICAgICAgICAibmFtZSIsCgkgICAgICAgICJjbXQiLAoJICAgICAgICAiZGVzYyIsCgkgICAgICAgICJ0eXBlIiwKCSAgICAgICAgInRpbWUiLAoJICAgICAgICAia2V5d29yZHMiLAoJICAgIF0pOwoJICAgIGNvbnN0IGV4dGVuc2lvbnMgPSBBcnJheS5mcm9tKG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUygiaHR0cDovL3d3dy5nYXJtaW4uY29tL3htbHNjaGVtYXMvR3B4RXh0ZW5zaW9ucy92MyIsICIqIikpOwoJICAgIGZvciAoY29uc3QgY2hpbGQgb2YgZXh0ZW5zaW9ucykgewoJICAgICAgICBpZiAoY2hpbGQucGFyZW50Tm9kZT8ucGFyZW50Tm9kZSA9PT0gbm9kZSkgewoJICAgICAgICAgICAgcHJvcGVydGllc1tjaGlsZC50YWdOYW1lLnJlcGxhY2UoIjoiLCAiXyIpXSA9IG5vZGVWYWwoY2hpbGQpOwoJICAgICAgICB9CgkgICAgfQoJICAgIGNvbnN0IGxpbmtzID0gJChub2RlLCAibGluayIpOwoJICAgIGlmIChsaW5rcy5sZW5ndGgpIHsKCSAgICAgICAgcHJvcGVydGllcy5saW5rcyA9IGxpbmtzLm1hcCgobGluaykgPT4gT2JqZWN0LmFzc2lnbih7IGhyZWY6IGxpbmsuZ2V0QXR0cmlidXRlKCJocmVmIikgfSwgZ2V0TXVsdGkobGluaywgWyJ0ZXh0IiwgInR5cGUiXSkpKTsKCSAgICB9CgkgICAgcmV0dXJuIHByb3BlcnRpZXM7Cgl9CgoJLyoqCgkgKiBFeHRyYWN0IHBvaW50cyBmcm9tIGEgdHJrc2VnIG9yIHJ0ZSBlbGVtZW50LgoJICovCglmdW5jdGlvbiBnZXRQb2ludHMkMShub2RlLCBwb2ludG5hbWUpIHsKCSAgICBjb25zdCBwdHMgPSAkKG5vZGUsIHBvaW50bmFtZSk7CgkgICAgY29uc3QgbGluZSA9IFtdOwoJICAgIGNvbnN0IHRpbWVzID0gW107CgkgICAgY29uc3QgZXh0ZW5kZWRWYWx1ZXMgPSB7fTsKCSAgICBmb3IgKGxldCBpID0gMDsgaSA8IHB0cy5sZW5ndGg7IGkrKykgewoJICAgICAgICBjb25zdCBjID0gY29vcmRQYWlyJDEocHRzW2ldKTsKCSAgICAgICAgaWYgKCFjKSB7CgkgICAgICAgICAgICBjb250aW51ZTsKCSAgICAgICAgfQoJICAgICAgICBsaW5lLnB1c2goYy5jb29yZGluYXRlcyk7CgkgICAgICAgIGlmIChjLnRpbWUpCgkgICAgICAgICAgICB0aW1lcy5wdXNoKGMudGltZSk7CgkgICAgICAgIGZvciAoY29uc3QgW25hbWUsIHZhbF0gb2YgYy5leHRlbmRlZFZhbHVlcykgewoJICAgICAgICAgICAgY29uc3QgcGx1cmFsID0gbmFtZSA9PT0gImhlYXJ0IiA/IG5hbWUgOiBuYW1lLnJlcGxhY2UoImdweHRweDoiLCAiIikgKyAicyI7CgkgICAgICAgICAgICBpZiAoIWV4dGVuZGVkVmFsdWVzW3BsdXJhbF0pIHsKCSAgICAgICAgICAgICAgICBleHRlbmRlZFZhbHVlc1twbHVyYWxdID0gQXJyYXkocHRzLmxlbmd0aCkuZmlsbChudWxsKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGV4dGVuZGVkVmFsdWVzW3BsdXJhbF1baV0gPSB2YWw7CgkgICAgICAgIH0KCSAgICB9CgkgICAgaWYgKGxpbmUubGVuZ3RoIDwgMikKCSAgICAgICAgcmV0dXJuOyAvLyBJbnZhbGlkIGxpbmUgaW4gR2VvSlNPTgoJICAgIHJldHVybiB7CgkgICAgICAgIGxpbmU6IGxpbmUsCgkgICAgICAgIHRpbWVzOiB0aW1lcywKCSAgICAgICAgZXh0ZW5kZWRWYWx1ZXM6IGV4dGVuZGVkVmFsdWVzLAoJICAgIH07Cgl9CgkvKioKCSAqIEV4dHJhY3QgYSBMaW5lU3RyaW5nIGdlb21ldHJ5IGZyb20gYSBydGUKCSAqIGVsZW1lbnQuCgkgKi8KCWZ1bmN0aW9uIGdldFJvdXRlKG5vZGUpIHsKCSAgICBjb25zdCBsaW5lID0gZ2V0UG9pbnRzJDEobm9kZSwgInJ0ZXB0Iik7CgkgICAgaWYgKCFsaW5lKQoJICAgICAgICByZXR1cm47CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmUiLAoJICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKHsgX2dweFR5cGU6ICJydGUiIH0sIGV4dHJhY3RQcm9wZXJ0aWVzKG5vZGUpLCBnZXRMaW5lU3R5bGUoZ2V0MShub2RlLCAiZXh0ZW5zaW9ucyIpKSksCgkgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICB0eXBlOiAiTGluZVN0cmluZyIsCgkgICAgICAgICAgICBjb29yZGluYXRlczogbGluZS5saW5lLAoJICAgICAgICB9LAoJICAgIH07Cgl9CglmdW5jdGlvbiBnZXRUcmFjayhub2RlKSB7CgkgICAgY29uc3Qgc2VnbWVudHMgPSAkKG5vZGUsICJ0cmtzZWciKTsKCSAgICBjb25zdCB0cmFjayA9IFtdOwoJICAgIGNvbnN0IHRpbWVzID0gW107CgkgICAgY29uc3QgZXh0cmFjdGVkTGluZXMgPSBbXTsKCSAgICBmb3IgKGNvbnN0IHNlZ21lbnQgb2Ygc2VnbWVudHMpIHsKCSAgICAgICAgY29uc3QgbGluZSA9IGdldFBvaW50cyQxKHNlZ21lbnQsICJ0cmtwdCIpOwoJICAgICAgICBpZiAobGluZSkgewoJICAgICAgICAgICAgZXh0cmFjdGVkTGluZXMucHVzaChsaW5lKTsKCSAgICAgICAgICAgIGlmIChsaW5lLnRpbWVzICYmIGxpbmUudGltZXMubGVuZ3RoKQoJICAgICAgICAgICAgICAgIHRpbWVzLnB1c2gobGluZS50aW1lcyk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgaWYgKGV4dHJhY3RlZExpbmVzLmxlbmd0aCA9PT0gMCkKCSAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgY29uc3QgbXVsdGkgPSBleHRyYWN0ZWRMaW5lcy5sZW5ndGggPiAxOwoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSBPYmplY3QuYXNzaWduKHsgX2dweFR5cGU6ICJ0cmsiIH0sIGV4dHJhY3RQcm9wZXJ0aWVzKG5vZGUpLCBnZXRMaW5lU3R5bGUoZ2V0MShub2RlLCAiZXh0ZW5zaW9ucyIpKSwgdGltZXMubGVuZ3RoCgkgICAgICAgID8gewoJICAgICAgICAgICAgY29vcmRpbmF0ZVByb3BlcnRpZXM6IHsKCSAgICAgICAgICAgICAgICB0aW1lczogbXVsdGkgPyB0aW1lcyA6IHRpbWVzWzBdLAoJICAgICAgICAgICAgfSwKCSAgICAgICAgfQoJICAgICAgICA6IHt9KTsKCSAgICBmb3IgKGNvbnN0IGxpbmUgb2YgZXh0cmFjdGVkTGluZXMpIHsKCSAgICAgICAgdHJhY2sucHVzaChsaW5lLmxpbmUpOwoJICAgICAgICBpZiAoIXByb3BlcnRpZXMuY29vcmRpbmF0ZVByb3BlcnRpZXMpIHsKCSAgICAgICAgICAgIHByb3BlcnRpZXMuY29vcmRpbmF0ZVByb3BlcnRpZXMgPSB7fTsKCSAgICAgICAgfQoJICAgICAgICBjb25zdCBwcm9wcyA9IHByb3BlcnRpZXMuY29vcmRpbmF0ZVByb3BlcnRpZXM7CgkgICAgICAgIGNvbnN0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhsaW5lLmV4dGVuZGVkVmFsdWVzKTsKCSAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbnRyaWVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICBjb25zdCBbbmFtZSwgdmFsXSA9IGVudHJpZXNbaV07CgkgICAgICAgICAgICBpZiAobXVsdGkpIHsKCSAgICAgICAgICAgICAgICBpZiAoIXByb3BzW25hbWVdKSB7CgkgICAgICAgICAgICAgICAgICAgIHByb3BzW25hbWVdID0gZXh0cmFjdGVkTGluZXMubWFwKChsaW5lKSA9PiBuZXcgQXJyYXkobGluZS5saW5lLmxlbmd0aCkuZmlsbChudWxsKSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHByb3BzW25hbWVdW2ldID0gdmFsOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgcHJvcHNbbmFtZV0gPSB2YWw7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmUiLAoJICAgICAgICBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLAoJICAgICAgICBnZW9tZXRyeTogbXVsdGkKCSAgICAgICAgICAgID8gewoJICAgICAgICAgICAgICAgIHR5cGU6ICJNdWx0aUxpbmVTdHJpbmciLAoJICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiB0cmFjaywKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIDogewoJICAgICAgICAgICAgICAgIHR5cGU6ICJMaW5lU3RyaW5nIiwKCSAgICAgICAgICAgICAgICBjb29yZGluYXRlczogdHJhY2tbMF0sCgkgICAgICAgICAgICB9LAoJICAgIH07Cgl9CgkvKioKCSAqIEV4dHJhY3QgYSBwb2ludCwgaWYgcG9zc2libGUsIGZyb20gYSBnaXZlbiBub2RlLAoJICogd2hpY2ggaXMgdXN1YWxseSBhIHdwdCBvciB0cmtwdAoJICovCglmdW5jdGlvbiBnZXRQb2ludChub2RlKSB7CgkgICAgY29uc3QgcHJvcGVydGllcyA9IE9iamVjdC5hc3NpZ24oZXh0cmFjdFByb3BlcnRpZXMobm9kZSksIGdldE11bHRpKG5vZGUsIFsic3ltIl0pKTsKCSAgICBjb25zdCBwYWlyID0gY29vcmRQYWlyJDEobm9kZSk7CgkgICAgaWYgKCFwYWlyKQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICByZXR1cm4gewoJICAgICAgICB0eXBlOiAiRmVhdHVyZSIsCgkgICAgICAgIHByb3BlcnRpZXMsCgkgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICB0eXBlOiAiUG9pbnQiLAoJICAgICAgICAgICAgY29vcmRpbmF0ZXM6IHBhaXIuY29vcmRpbmF0ZXMsCgkgICAgICAgIH0sCgkgICAgfTsKCX0KCS8qKgoJICogQ29udmVydCBHUFggdG8gR2VvSlNPTiBpbmNyZW1lbnRhbGx5LCByZXR1cm5pbmcKCSAqIGEgW0dlbmVyYXRvcl0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9HdWlkZS9JdGVyYXRvcnNfYW5kX0dlbmVyYXRvcnMpCgkgKiB0aGF0IHlpZWxkcyBvdXRwdXQgZmVhdHVyZSBieSBmZWF0dXJlLgoJICovCglmdW5jdGlvbiogZ3B4R2VuKG5vZGUpIHsKCSAgICBmb3IgKGNvbnN0IHRyYWNrIG9mICQobm9kZSwgInRyayIpKSB7CgkgICAgICAgIGNvbnN0IGZlYXR1cmUgPSBnZXRUcmFjayh0cmFjayk7CgkgICAgICAgIGlmIChmZWF0dXJlKQoJICAgICAgICAgICAgeWllbGQgZmVhdHVyZTsKCSAgICB9CgkgICAgZm9yIChjb25zdCByb3V0ZSBvZiAkKG5vZGUsICJydGUiKSkgewoJICAgICAgICBjb25zdCBmZWF0dXJlID0gZ2V0Um91dGUocm91dGUpOwoJICAgICAgICBpZiAoZmVhdHVyZSkKCSAgICAgICAgICAgIHlpZWxkIGZlYXR1cmU7CgkgICAgfQoJICAgIGZvciAoY29uc3Qgd2F5cG9pbnQgb2YgJChub2RlLCAid3B0IikpIHsKCSAgICAgICAgY29uc3QgcG9pbnQgPSBnZXRQb2ludCh3YXlwb2ludCk7CgkgICAgICAgIGlmIChwb2ludCkKCSAgICAgICAgICAgIHlpZWxkIHBvaW50OwoJICAgIH0KCX0KCS8qKgoJICoKCSAqIENvbnZlcnQgYSBHUFggZG9jdW1lbnQgdG8gR2VvSlNPTi4gVGhlIGZpcnN0IGFyZ3VtZW50LCBgZG9jYCwgbXVzdCBiZSBhIEdQWAoJICogZG9jdW1lbnQgYXMgYW4gWE1MIERPTSAtIG5vdCBhcyBhIHN0cmluZy4gWW91IGNhbiBnZXQgdGhpcyB1c2luZyBqUXVlcnkncyBkZWZhdWx0CgkgKiBgLmFqYXhgIGZ1bmN0aW9uIG9yIHVzaW5nIGEgYmFyZSBYTUxIdHRwUmVxdWVzdCB3aXRoIHRoZSBgLnJlc3BvbnNlYCBwcm9wZXJ0eQoJICogaG9sZGluZyBhbiBYTUwgRE9NLgoJICoKCSAqIFRoZSBvdXRwdXQgaXMgYSBKYXZhU2NyaXB0IG9iamVjdCBvZiBHZW9KU09OIGRhdGEsIHNhbWUgYXMgYC5rbWxgIG91dHB1dHMsIHdpdGggdGhlCgkgKiBhZGRpdGlvbiBvZiBhIGBfZ3B4VHlwZWAgcHJvcGVydHkgb24gZWFjaCBgTGluZVN0cmluZ2AgZmVhdHVyZSB0aGF0IGluZGljYXRlcyB3aGV0aGVyCgkgKiB0aGUgZmVhdHVyZSB3YXMgZW5jb2RlZCBhcyBhIHJvdXRlIChgcnRlYCkgb3IgdHJhY2sgKGB0cmtgKSBpbiB0aGUgR1BYIGRvY3VtZW50LgoJICovCglmdW5jdGlvbiBncHgobm9kZSkgewoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsCgkgICAgICAgIGZlYXR1cmVzOiBBcnJheS5mcm9tKGdweEdlbihub2RlKSksCgkgICAgfTsKCX0KCgljb25zdCBFWFRFTlNJT05TX05TID0gImh0dHA6Ly93d3cuZ2FybWluLmNvbS94bWxzY2hlbWFzL0FjdGl2aXR5RXh0ZW5zaW9uL3YyIjsKCWNvbnN0IFRSQUNLUE9JTlRfQVRUUklCVVRFUyA9IFsKCSAgICBbImhlYXJ0UmF0ZSIsICJoZWFydFJhdGVzIl0sCgkgICAgWyJDYWRlbmNlIiwgImNhZGVuY2VzIl0sCgkgICAgLy8gRXh0ZW5kZWQgVHJhY2twb2ludCBhdHRyaWJ1dGVzCgkgICAgWyJTcGVlZCIsICJzcGVlZHMiXSwKCSAgICBbIldhdHRzIiwgIndhdHRzIl0sCgldOwoJY29uc3QgTEFQX0FUVFJJQlVURVMgPSBbCgkgICAgWyJUb3RhbFRpbWVTZWNvbmRzIiwgInRvdGFsVGltZVNlY29uZHMiXSwKCSAgICBbIkRpc3RhbmNlTWV0ZXJzIiwgImRpc3RhbmNlTWV0ZXJzIl0sCgkgICAgWyJNYXhpbXVtU3BlZWQiLCAibWF4U3BlZWQiXSwKCSAgICBbIkF2ZXJhZ2VIZWFydFJhdGVCcG0iLCAiYXZnSGVhcnRSYXRlIl0sCgkgICAgWyJNYXhpbXVtSGVhcnRSYXRlQnBtIiwgIm1heEhlYXJ0UmF0ZSJdLAoJICAgIC8vIEV4dGVuZGVkIExhcCBhdHRyaWJ1dGVzCgkgICAgWyJBdmdTcGVlZCIsICJhdmdTcGVlZCJdLAoJICAgIFsiQXZnV2F0dHMiLCAiYXZnV2F0dHMiXSwKCSAgICBbIk1heFdhdHRzIiwgIm1heFdhdHRzIl0sCgldOwoJZnVuY3Rpb24gZ2V0UHJvcGVydGllcyhub2RlLCBhdHRyaWJ1dGVOYW1lcykgewoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSBbXTsKCSAgICBmb3IgKGNvbnN0IFt0YWcsIGFsaWFzXSBvZiBhdHRyaWJ1dGVOYW1lcykgewoJICAgICAgICBsZXQgZWxlbSA9IGdldDEobm9kZSwgdGFnKTsKCSAgICAgICAgaWYgKCFlbGVtKSB7CgkgICAgICAgICAgICBjb25zdCBlbGVtZW50cyA9IG5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWVOUyhFWFRFTlNJT05TX05TLCB0YWcpOwoJICAgICAgICAgICAgaWYgKGVsZW1lbnRzLmxlbmd0aCkgewoJICAgICAgICAgICAgICAgIGVsZW0gPSBlbGVtZW50c1swXTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjb25zdCB2YWwgPSBwYXJzZUZsb2F0KG5vZGVWYWwoZWxlbSkpOwoJICAgICAgICBpZiAoIWlzTmFOKHZhbCkpIHsKCSAgICAgICAgICAgIHByb3BlcnRpZXMucHVzaChbYWxpYXMsIHZhbF0pOwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJfQoJZnVuY3Rpb24gY29vcmRQYWlyKG5vZGUpIHsKCSAgICBjb25zdCBsbCA9IFtudW0xKG5vZGUsICJMb25naXR1ZGVEZWdyZWVzIiksIG51bTEobm9kZSwgIkxhdGl0dWRlRGVncmVlcyIpXTsKCSAgICBpZiAobGxbMF0gPT09IHVuZGVmaW5lZCB8fAoJICAgICAgICBpc05hTihsbFswXSkgfHwKCSAgICAgICAgbGxbMV0gPT09IHVuZGVmaW5lZCB8fAoJICAgICAgICBpc05hTihsbFsxXSkpIHsKCSAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgfQoJICAgIGNvbnN0IGhlYXJ0UmF0ZSA9IGdldDEobm9kZSwgIkhlYXJ0UmF0ZUJwbSIpOwoJICAgIGNvbnN0IHRpbWUgPSBub2RlVmFsKGdldDEobm9kZSwgIlRpbWUiKSk7CgkgICAgZ2V0MShub2RlLCAiQWx0aXR1ZGVNZXRlcnMiLCAoYWx0KSA9PiB7CgkgICAgICAgIGNvbnN0IGEgPSBwYXJzZUZsb2F0KG5vZGVWYWwoYWx0KSk7CgkgICAgICAgIGlmICghaXNOYU4oYSkpIHsKCSAgICAgICAgICAgIGxsLnB1c2goYSk7CgkgICAgICAgIH0KCSAgICB9KTsKCSAgICByZXR1cm4gewoJICAgICAgICBjb29yZGluYXRlczogbGwsCgkgICAgICAgIHRpbWU6IHRpbWUgfHwgbnVsbCwKCSAgICAgICAgaGVhcnRSYXRlOiBoZWFydFJhdGUgPyBwYXJzZUZsb2F0KG5vZGVWYWwoaGVhcnRSYXRlKSkgOiBudWxsLAoJICAgICAgICBleHRlbnNpb25zOiBnZXRQcm9wZXJ0aWVzKG5vZGUsIFRSQUNLUE9JTlRfQVRUUklCVVRFUyksCgkgICAgfTsKCX0KCWZ1bmN0aW9uIGdldFBvaW50cyhub2RlKSB7CgkgICAgY29uc3QgcHRzID0gJChub2RlLCAiVHJhY2twb2ludCIpOwoJICAgIGNvbnN0IGxpbmUgPSBbXTsKCSAgICBjb25zdCB0aW1lcyA9IFtdOwoJICAgIGNvbnN0IGhlYXJ0UmF0ZXMgPSBbXTsKCSAgICBpZiAocHRzLmxlbmd0aCA8IDIpCgkgICAgICAgIHJldHVybiBudWxsOyAvLyBJbnZhbGlkIGxpbmUgaW4gR2VvSlNPTgoJICAgIGNvbnN0IGV4dGVuZGVkUHJvcGVydGllcyA9IHt9OwoJICAgIGNvbnN0IHJlc3VsdCA9IHsgZXh0ZW5kZWRQcm9wZXJ0aWVzIH07CgkgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwdHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgY29uc3QgYyA9IGNvb3JkUGFpcihwdHNbaV0pOwoJICAgICAgICBpZiAoYyA9PT0gbnVsbCkKCSAgICAgICAgICAgIGNvbnRpbnVlOwoJICAgICAgICBsaW5lLnB1c2goYy5jb29yZGluYXRlcyk7CgkgICAgICAgIGNvbnN0IHsgdGltZSwgaGVhcnRSYXRlLCBleHRlbnNpb25zIH0gPSBjOwoJICAgICAgICBpZiAodGltZSkKCSAgICAgICAgICAgIHRpbWVzLnB1c2godGltZSk7CgkgICAgICAgIGlmIChoZWFydFJhdGUpCgkgICAgICAgICAgICBoZWFydFJhdGVzLnB1c2goaGVhcnRSYXRlKTsKCSAgICAgICAgZm9yIChjb25zdCBbYWxpYXMsIHZhbHVlXSBvZiBleHRlbnNpb25zKSB7CgkgICAgICAgICAgICBpZiAoIWV4dGVuZGVkUHJvcGVydGllc1thbGlhc10pIHsKCSAgICAgICAgICAgICAgICBleHRlbmRlZFByb3BlcnRpZXNbYWxpYXNdID0gQXJyYXkocHRzLmxlbmd0aCkuZmlsbChudWxsKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGV4dGVuZGVkUHJvcGVydGllc1thbGlhc11baV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH0KCSAgICBpZiAobGluZS5sZW5ndGggPCAyKQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihyZXN1bHQsIHsKCSAgICAgICAgbGluZTogbGluZSwKCSAgICAgICAgdGltZXM6IHRpbWVzLAoJICAgICAgICBoZWFydFJhdGVzOiBoZWFydFJhdGVzLAoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZ2V0TGFwKG5vZGUpIHsKCSAgICBjb25zdCBzZWdtZW50cyA9ICQobm9kZSwgIlRyYWNrIik7CgkgICAgY29uc3QgdHJhY2sgPSBbXTsKCSAgICBjb25zdCB0aW1lcyA9IFtdOwoJICAgIGNvbnN0IGhlYXJ0UmF0ZXMgPSBbXTsKCSAgICBjb25zdCBhbGxFeHRlbmRlZFByb3BlcnRpZXMgPSBbXTsKCSAgICBsZXQgbGluZTsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0gT2JqZWN0LmFzc2lnbihPYmplY3QuZnJvbUVudHJpZXMoZ2V0UHJvcGVydGllcyhub2RlLCBMQVBfQVRUUklCVVRFUykpLCBnZXQobm9kZSwgIk5hbWUiLCAobmFtZUVsZW1lbnQpID0+IHsKCSAgICAgICAgcmV0dXJuIHsgbmFtZTogbm9kZVZhbChuYW1lRWxlbWVudCkgfTsKCSAgICB9KSk7CgkgICAgZm9yIChjb25zdCBzZWdtZW50IG9mIHNlZ21lbnRzKSB7CgkgICAgICAgIGxpbmUgPSBnZXRQb2ludHMoc2VnbWVudCk7CgkgICAgICAgIGlmIChsaW5lKSB7CgkgICAgICAgICAgICB0cmFjay5wdXNoKGxpbmUubGluZSk7CgkgICAgICAgICAgICBpZiAobGluZS50aW1lcy5sZW5ndGgpCgkgICAgICAgICAgICAgICAgdGltZXMucHVzaChsaW5lLnRpbWVzKTsKCSAgICAgICAgICAgIGlmIChsaW5lLmhlYXJ0UmF0ZXMubGVuZ3RoKQoJICAgICAgICAgICAgICAgIGhlYXJ0UmF0ZXMucHVzaChsaW5lLmhlYXJ0UmF0ZXMpOwoJICAgICAgICAgICAgYWxsRXh0ZW5kZWRQcm9wZXJ0aWVzLnB1c2gobGluZS5leHRlbmRlZFByb3BlcnRpZXMpOwoJICAgICAgICB9CgkgICAgfQoJICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWxsRXh0ZW5kZWRQcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgIGNvbnN0IGV4dGVuZGVkUHJvcGVydGllcyA9IGFsbEV4dGVuZGVkUHJvcGVydGllc1tpXTsKCSAgICAgICAgZm9yIChjb25zdCBwcm9wZXJ0eSBpbiBleHRlbmRlZFByb3BlcnRpZXMpIHsKCSAgICAgICAgICAgIGlmIChzZWdtZW50cy5sZW5ndGggPT09IDEpIHsKCSAgICAgICAgICAgICAgICBpZiAobGluZSkgewoJICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzW3Byb3BlcnR5XSA9IGxpbmUuZXh0ZW5kZWRQcm9wZXJ0aWVzW3Byb3BlcnR5XTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICBpZiAoIXByb3BlcnRpZXNbcHJvcGVydHldKSB7CgkgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNbcHJvcGVydHldID0gdHJhY2subWFwKCh0cmFjaykgPT4gQXJyYXkodHJhY2subGVuZ3RoKS5maWxsKG51bGwpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcHJvcGVydGllc1twcm9wZXJ0eV1baV0gPSBleHRlbmRlZFByb3BlcnRpZXNbcHJvcGVydHldOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoJICAgIGlmICh0cmFjay5sZW5ndGggPT09IDApCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIGlmICh0aW1lcy5sZW5ndGggfHwgaGVhcnRSYXRlcy5sZW5ndGgpIHsKCSAgICAgICAgcHJvcGVydGllcy5jb29yZGluYXRlUHJvcGVydGllcyA9IE9iamVjdC5hc3NpZ24odGltZXMubGVuZ3RoCgkgICAgICAgICAgICA/IHsKCSAgICAgICAgICAgICAgICB0aW1lczogdHJhY2subGVuZ3RoID09PSAxID8gdGltZXNbMF0gOiB0aW1lcywKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIDoge30sIGhlYXJ0UmF0ZXMubGVuZ3RoCgkgICAgICAgICAgICA/IHsKCSAgICAgICAgICAgICAgICBoZWFydDogdHJhY2subGVuZ3RoID09PSAxID8gaGVhcnRSYXRlc1swXSA6IGhlYXJ0UmF0ZXMsCgkgICAgICAgICAgICB9CgkgICAgICAgICAgICA6IHt9KTsKCSAgICB9CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmUiLAoJICAgICAgICBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLAoJICAgICAgICBnZW9tZXRyeTogdHJhY2subGVuZ3RoID09PSAxCgkgICAgICAgICAgICA/IHsKCSAgICAgICAgICAgICAgICB0eXBlOiAiTGluZVN0cmluZyIsCgkgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IHRyYWNrWzBdLAoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgOiB7CgkgICAgICAgICAgICAgICAgdHlwZTogIk11bHRpTGluZVN0cmluZyIsCgkgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IHRyYWNrLAoJICAgICAgICAgICAgfSwKCSAgICB9OwoJfQoJLyoqCgkgKiBJbmNyZW1lbnRhbGx5IGNvbnZlcnQgYSBUQ1ggZG9jdW1lbnQgdG8gR2VvSlNPTi4gVGhlCgkgKiBmaXJzdCBhcmd1bWVudCwgYGRvY2AsIG11c3QgYmUgYSBUQ1gKCSAqIGRvY3VtZW50IGFzIGFuIFhNTCBET00gLSBub3QgYXMgYSBzdHJpbmcuCgkgKi8KCWZ1bmN0aW9uKiB0Y3hHZW4obm9kZSkgewoJICAgIGZvciAoY29uc3QgbGFwIG9mICQobm9kZSwgIkxhcCIpKSB7CgkgICAgICAgIGNvbnN0IGZlYXR1cmUgPSBnZXRMYXAobGFwKTsKCSAgICAgICAgaWYgKGZlYXR1cmUpCgkgICAgICAgICAgICB5aWVsZCBmZWF0dXJlOwoJICAgIH0KCSAgICBmb3IgKGNvbnN0IGNvdXJzZSBvZiAkKG5vZGUsICJDb3Vyc2VzIikpIHsKCSAgICAgICAgY29uc3QgZmVhdHVyZSA9IGdldExhcChjb3Vyc2UpOwoJICAgICAgICBpZiAoZmVhdHVyZSkKCSAgICAgICAgICAgIHlpZWxkIGZlYXR1cmU7CgkgICAgfQoJfQoJLyoqCgkgKiBDb252ZXJ0IGEgVENYIGRvY3VtZW50IHRvIEdlb0pTT04uIFRoZSBmaXJzdCBhcmd1bWVudCwgYGRvY2AsIG11c3QgYmUgYSBUQ1gKCSAqIGRvY3VtZW50IGFzIGFuIFhNTCBET00gLSBub3QgYXMgYSBzdHJpbmcuCgkgKi8KCWZ1bmN0aW9uIHRjeChub2RlKSB7CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmVDb2xsZWN0aW9uIiwKCSAgICAgICAgZmVhdHVyZXM6IEFycmF5LmZyb20odGN4R2VuKG5vZGUpKSwKCSAgICB9OwoJfQoKCWZ1bmN0aW9uIGZpeENvbG9yKHYsIHByZWZpeCkgewoJICAgIGNvbnN0IHByb3BlcnRpZXMgPSB7fTsKCSAgICBjb25zdCBjb2xvclByb3AgPSBwcmVmaXggPT0gInN0cm9rZSIgfHwgcHJlZml4ID09PSAiZmlsbCIgPyBwcmVmaXggOiBwcmVmaXggKyAiLWNvbG9yIjsKCSAgICBpZiAodlswXSA9PT0gIiMiKSB7CgkgICAgICAgIHYgPSB2LnN1YnN0cmluZygxKTsKCSAgICB9CgkgICAgaWYgKHYubGVuZ3RoID09PSA2IHx8IHYubGVuZ3RoID09PSAzKSB7CgkgICAgICAgIHByb3BlcnRpZXNbY29sb3JQcm9wXSA9ICIjIiArIHY7CgkgICAgfQoJICAgIGVsc2UgaWYgKHYubGVuZ3RoID09PSA4KSB7CgkgICAgICAgIHByb3BlcnRpZXNbcHJlZml4ICsgIi1vcGFjaXR5Il0gPSBwYXJzZUludCh2LnN1YnN0cmluZygwLCAyKSwgMTYpIC8gMjU1OwoJICAgICAgICBwcm9wZXJ0aWVzW2NvbG9yUHJvcF0gPQoJICAgICAgICAgICAgIiMiICsgdi5zdWJzdHJpbmcoNiwgOCkgKyB2LnN1YnN0cmluZyg0LCA2KSArIHYuc3Vic3RyaW5nKDIsIDQpOwoJICAgIH0KCSAgICByZXR1cm4gcHJvcGVydGllczsKCX0KCglmdW5jdGlvbiBudW1lcmljUHJvcGVydHkobm9kZSwgc291cmNlLCB0YXJnZXQpIHsKCSAgICBjb25zdCBwcm9wZXJ0aWVzID0ge307CgkgICAgbnVtMShub2RlLCBzb3VyY2UsICh2YWwpID0+IHsKCSAgICAgICAgcHJvcGVydGllc1t0YXJnZXRdID0gdmFsOwoJICAgIH0pOwoJICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJfQoJZnVuY3Rpb24gZ2V0Q29sb3Iobm9kZSwgb3V0cHV0KSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiY29sb3IiLCAoZWxlbSkgPT4gZml4Q29sb3Iobm9kZVZhbChlbGVtKSwgb3V0cHV0KSk7Cgl9CglmdW5jdGlvbiBleHRyYWN0SWNvbkhyZWYobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgIkljb24iLCAoaWNvbiwgcHJvcGVydGllcykgPT4gewoJICAgICAgICB2YWwxKGljb24sICJocmVmIiwgKGhyZWYpID0+IHsKCSAgICAgICAgICAgIHByb3BlcnRpZXMuaWNvbiA9IGhyZWY7CgkgICAgICAgIH0pOwoJICAgICAgICByZXR1cm4gcHJvcGVydGllczsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RJY29uKG5vZGUpIHsKCSAgICByZXR1cm4gZ2V0KG5vZGUsICJJY29uU3R5bGUiLCAoaWNvblN0eWxlKSA9PiB7CgkgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGdldENvbG9yKGljb25TdHlsZSwgImljb24iKSwgbnVtZXJpY1Byb3BlcnR5KGljb25TdHlsZSwgInNjYWxlIiwgImljb24tc2NhbGUiKSwgbnVtZXJpY1Byb3BlcnR5KGljb25TdHlsZSwgImhlYWRpbmciLCAiaWNvbi1oZWFkaW5nIiksIGdldChpY29uU3R5bGUsICJob3RTcG90IiwgKGhvdHNwb3QpID0+IHsKCSAgICAgICAgICAgIGNvbnN0IGxlZnQgPSBwYXJzZUZsb2F0KGhvdHNwb3QuZ2V0QXR0cmlidXRlKCJ4IikgfHwgIiIpOwoJICAgICAgICAgICAgY29uc3QgdG9wID0gcGFyc2VGbG9hdChob3RzcG90LmdldEF0dHJpYnV0ZSgieSIpIHx8ICIiKTsKCSAgICAgICAgICAgIGNvbnN0IHh1bml0cyA9IGhvdHNwb3QuZ2V0QXR0cmlidXRlKCJ4dW5pdHMiKSB8fCAiIjsKCSAgICAgICAgICAgIGNvbnN0IHl1bml0cyA9IGhvdHNwb3QuZ2V0QXR0cmlidXRlKCJ5dW5pdHMiKSB8fCAiIjsKCSAgICAgICAgICAgIGlmICghaXNOYU4obGVmdCkgJiYgIWlzTmFOKHRvcCkpCgkgICAgICAgICAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICAgICAgImljb24tb2Zmc2V0IjogW2xlZnQsIHRvcF0sCgkgICAgICAgICAgICAgICAgICAgICJpY29uLW9mZnNldC11bml0cyI6IFt4dW5pdHMsIHl1bml0c10sCgkgICAgICAgICAgICAgICAgfTsKCSAgICAgICAgICAgIHJldHVybiB7fTsKCSAgICAgICAgfSksIGV4dHJhY3RJY29uSHJlZihpY29uU3R5bGUpKTsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RMYWJlbChub2RlKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiTGFiZWxTdHlsZSIsIChsYWJlbFN0eWxlKSA9PiB7CgkgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKGdldENvbG9yKGxhYmVsU3R5bGUsICJsYWJlbCIpLCBudW1lcmljUHJvcGVydHkobGFiZWxTdHlsZSwgInNjYWxlIiwgImxhYmVsLXNjYWxlIikpOwoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZXh0cmFjdExpbmUobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgIkxpbmVTdHlsZSIsIChsaW5lU3R5bGUpID0+IHsKCSAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZ2V0Q29sb3IobGluZVN0eWxlLCAic3Ryb2tlIiksIG51bWVyaWNQcm9wZXJ0eShsaW5lU3R5bGUsICJ3aWR0aCIsICJzdHJva2Utd2lkdGgiKSk7CgkgICAgfSk7Cgl9CglmdW5jdGlvbiBleHRyYWN0UG9seShub2RlKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiUG9seVN0eWxlIiwgKHBvbHlTdHlsZSwgcHJvcGVydGllcykgPT4gewoJICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwcm9wZXJ0aWVzLCBnZXQocG9seVN0eWxlLCAiY29sb3IiLCAoZWxlbSkgPT4gZml4Q29sb3Iobm9kZVZhbChlbGVtKSwgImZpbGwiKSksIHZhbDEocG9seVN0eWxlLCAiZmlsbCIsIChmaWxsKSA9PiB7CgkgICAgICAgICAgICBpZiAoZmlsbCA9PT0gIjAiKQoJICAgICAgICAgICAgICAgIHJldHVybiB7ICJmaWxsLW9wYWNpdHkiOiAwIH07CgkgICAgICAgIH0pLCB2YWwxKHBvbHlTdHlsZSwgIm91dGxpbmUiLCAob3V0bGluZSkgPT4gewoJICAgICAgICAgICAgaWYgKG91dGxpbmUgPT09ICIwIikKCSAgICAgICAgICAgICAgICByZXR1cm4geyAic3Ryb2tlLW9wYWNpdHkiOiAwIH07CgkgICAgICAgIH0pKTsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RTdHlsZShub2RlKSB7CgkgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGV4dHJhY3RQb2x5KG5vZGUpLCBleHRyYWN0TGluZShub2RlKSwgZXh0cmFjdExhYmVsKG5vZGUpLCBleHRyYWN0SWNvbihub2RlKSk7Cgl9CgoJY29uc3QgdG9OdW1iZXIgPSAoeCkgPT4gTnVtYmVyKHgpOwoJY29uc3QgdHlwZUNvbnZlcnRlcnMgPSB7CgkgICAgc3RyaW5nOiAoeCkgPT4geCwKCSAgICBpbnQ6IHRvTnVtYmVyLAoJICAgIHVpbnQ6IHRvTnVtYmVyLAoJICAgIHNob3J0OiB0b051bWJlciwKCSAgICB1c2hvcnQ6IHRvTnVtYmVyLAoJICAgIGZsb2F0OiB0b051bWJlciwKCSAgICBkb3VibGU6IHRvTnVtYmVyLAoJICAgIGJvb2w6ICh4KSA9PiBCb29sZWFuKHgpLAoJfTsKCWZ1bmN0aW9uIGV4dHJhY3RFeHRlbmRlZERhdGEobm9kZSwgc2NoZW1hKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiRXh0ZW5kZWREYXRhIiwgKGV4dGVuZGVkRGF0YSwgcHJvcGVydGllcykgPT4gewoJICAgICAgICBmb3IgKGNvbnN0IGRhdGEgb2YgJChleHRlbmRlZERhdGEsICJEYXRhIikpIHsKCSAgICAgICAgICAgIHByb3BlcnRpZXNbZGF0YS5nZXRBdHRyaWJ1dGUoIm5hbWUiKSB8fCAiIl0gPSBub2RlVmFsKGdldDEoZGF0YSwgInZhbHVlIikpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAoY29uc3Qgc2ltcGxlRGF0YSBvZiAkKGV4dGVuZGVkRGF0YSwgIlNpbXBsZURhdGEiKSkgewoJICAgICAgICAgICAgY29uc3QgbmFtZSA9IHNpbXBsZURhdGEuZ2V0QXR0cmlidXRlKCJuYW1lIikgfHwgIiI7CgkgICAgICAgICAgICBjb25zdCB0eXBlQ29udmVydGVyID0gc2NoZW1hW25hbWVdIHx8IHR5cGVDb252ZXJ0ZXJzLnN0cmluZzsKCSAgICAgICAgICAgIHByb3BlcnRpZXNbbmFtZV0gPSB0eXBlQ29udmVydGVyKG5vZGVWYWwoc2ltcGxlRGF0YSkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBwcm9wZXJ0aWVzOwoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZ2V0TWF5YmVIVE1MRGVzY3JpcHRpb24obm9kZSkgewoJICAgIGNvbnN0IGRlc2NyaXB0aW9uTm9kZSA9IGdldDEobm9kZSwgImRlc2NyaXB0aW9uIik7CgkgICAgZm9yIChjb25zdCBjIG9mIEFycmF5LmZyb20oZGVzY3JpcHRpb25Ob2RlPy5jaGlsZE5vZGVzIHx8IFtdKSkgewoJICAgICAgICBpZiAoYy5ub2RlVHlwZSA9PT0gNCkgewoJICAgICAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogewoJICAgICAgICAgICAgICAgICAgICAiQHR5cGUiOiAiaHRtbCIsCgkgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBub2RlVmFsKGMpLAoJICAgICAgICAgICAgICAgIH0sCgkgICAgICAgICAgICB9OwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiB7fTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RUaW1lU3Bhbihub2RlKSB7CgkgICAgcmV0dXJuIGdldChub2RlLCAiVGltZVNwYW4iLCAodGltZVNwYW4pID0+IHsKCSAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgIHRpbWVzcGFuOiB7CgkgICAgICAgICAgICAgICAgYmVnaW46IG5vZGVWYWwoZ2V0MSh0aW1lU3BhbiwgImJlZ2luIikpLAoJICAgICAgICAgICAgICAgIGVuZDogbm9kZVZhbChnZXQxKHRpbWVTcGFuLCAiZW5kIikpLAoJICAgICAgICAgICAgfSwKCSAgICAgICAgfTsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGV4dHJhY3RUaW1lU3RhbXAobm9kZSkgewoJICAgIHJldHVybiBnZXQobm9kZSwgIlRpbWVTdGFtcCIsICh0aW1lU3RhbXApID0+IHsKCSAgICAgICAgcmV0dXJuIHsgdGltZXN0YW1wOiBub2RlVmFsKGdldDEodGltZVN0YW1wLCAid2hlbiIpKSB9OwoJICAgIH0pOwoJfQoJZnVuY3Rpb24gZXh0cmFjdENhc2NhZGVkU3R5bGUobm9kZSwgc3R5bGVNYXApIHsKCSAgICByZXR1cm4gdmFsMShub2RlLCAic3R5bGVVcmwiLCAoc3R5bGVVcmwpID0+IHsKCSAgICAgICAgc3R5bGVVcmwgPSBub3JtYWxpemVJZChzdHlsZVVybCk7CgkgICAgICAgIGlmIChzdHlsZU1hcFtzdHlsZVVybF0pIHsKCSAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHsgc3R5bGVVcmwgfSwgc3R5bGVNYXBbc3R5bGVVcmxdKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBGb3IgYmFja3dhcmQtY29tcGF0aWJpbGl0eS4gU2hvdWxkIHdlIHN0aWxsIGluY2x1ZGUKCSAgICAgICAgLy8gc3R5bGVVcmwgZXZlbiBpZiBpdCdzIG5vdCByZXNvbHZlZD8KCSAgICAgICAgcmV0dXJuIHsgc3R5bGVVcmwgfTsKCSAgICB9KTsKCX0KCgljb25zdCByZW1vdmVTcGFjZSA9IC9ccyovZzsKCWNvbnN0IHRyaW1TcGFjZSA9IC9eXHMqfFxzKiQvZzsKCWNvbnN0IHNwbGl0U3BhY2UgPSAvXHMrLzsKCS8qKgoJICogR2V0IG9uZSBjb29yZGluYXRlIGZyb20gYSBjb29yZGluYXRlIGFycmF5LCBpZiBhbnkKCSAqLwoJZnVuY3Rpb24gY29vcmQxKHZhbHVlKSB7CgkgICAgcmV0dXJuIHZhbHVlCgkgICAgICAgIC5yZXBsYWNlKHJlbW92ZVNwYWNlLCAiIikKCSAgICAgICAgLnNwbGl0KCIsIikKCSAgICAgICAgLm1hcChwYXJzZUZsb2F0KQoJICAgICAgICAuZmlsdGVyKChudW0pID0+ICFpc05hTihudW0pKQoJICAgICAgICAuc2xpY2UoMCwgMyk7Cgl9CgkvKioKCSAqIEdldCBhbGwgY29vcmRpbmF0ZXMgZnJvbSBhIGNvb3JkaW5hdGUgYXJyYXkgYXMgW1tdLFtdXQoJICovCglmdW5jdGlvbiBjb29yZCh2YWx1ZSkgewoJICAgIHJldHVybiB2YWx1ZQoJICAgICAgICAucmVwbGFjZSh0cmltU3BhY2UsICIiKQoJICAgICAgICAuc3BsaXQoc3BsaXRTcGFjZSkKCSAgICAgICAgLm1hcChjb29yZDEpCgkgICAgICAgIC5maWx0ZXIoKGNvb3JkKSA9PiB7CgkgICAgICAgIHJldHVybiBjb29yZC5sZW5ndGggPj0gMjsKCSAgICB9KTsKCX0KCWZ1bmN0aW9uIGd4Q29vcmRzKG5vZGUpIHsKCSAgICBsZXQgZWxlbXMgPSAkKG5vZGUsICJjb29yZCIpOwoJICAgIGlmIChlbGVtcy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgZWxlbXMgPSAkbnMobm9kZSwgImNvb3JkIiwgIioiKTsKCSAgICB9CgkgICAgY29uc3QgY29vcmRpbmF0ZXMgPSBlbGVtcy5tYXAoKGVsZW0pID0+IHsKCSAgICAgICAgcmV0dXJuIG5vZGVWYWwoZWxlbSkuc3BsaXQoIiAiKS5tYXAocGFyc2VGbG9hdCk7CgkgICAgfSk7CgkgICAgaWYgKGNvb3JkaW5hdGVzLmxlbmd0aCA9PT0gMCkgewoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9CgkgICAgcmV0dXJuIHsKCSAgICAgICAgZ2VvbWV0cnk6IGNvb3JkaW5hdGVzLmxlbmd0aCA+IDIKCSAgICAgICAgICAgID8gewoJICAgICAgICAgICAgICAgIHR5cGU6ICJMaW5lU3RyaW5nIiwKCSAgICAgICAgICAgICAgICBjb29yZGluYXRlcywKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIDogewoJICAgICAgICAgICAgICAgIHR5cGU6ICJQb2ludCIsCgkgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IGNvb3JkaW5hdGVzWzBdLAoJICAgICAgICAgICAgfSwKCSAgICAgICAgdGltZXM6ICQobm9kZSwgIndoZW4iKS5tYXAoKGVsZW0pID0+IG5vZGVWYWwoZWxlbSkpLAoJICAgIH07Cgl9CglmdW5jdGlvbiBmaXhSaW5nKHJpbmcpIHsKCSAgICBpZiAocmluZy5sZW5ndGggPT09IDApCgkgICAgICAgIHJldHVybiByaW5nOwoJICAgIGNvbnN0IGZpcnN0ID0gcmluZ1swXTsKCSAgICBjb25zdCBsYXN0ID0gcmluZ1tyaW5nLmxlbmd0aCAtIDFdOwoJICAgIGxldCBlcXVhbCA9IHRydWU7CgkgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLm1heChmaXJzdC5sZW5ndGgsIGxhc3QubGVuZ3RoKTsgaSsrKSB7CgkgICAgICAgIGlmIChmaXJzdFtpXSAhPT0gbGFzdFtpXSkgewoJICAgICAgICAgICAgZXF1YWwgPSBmYWxzZTsKCSAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICB9CgkgICAgfQoJICAgIGlmICghZXF1YWwpIHsKCSAgICAgICAgcmV0dXJuIHJpbmcuY29uY2F0KFtyaW5nWzBdXSk7CgkgICAgfQoJICAgIHJldHVybiByaW5nOwoJfQoJZnVuY3Rpb24gZ2V0Q29vcmRpbmF0ZXMobm9kZSkgewoJICAgIHJldHVybiBub2RlVmFsKGdldDEobm9kZSwgImNvb3JkaW5hdGVzIikpOwoJfQoJZnVuY3Rpb24gZ2V0R2VvbWV0cnkobm9kZSkgewoJICAgIGxldCBnZW9tZXRyaWVzID0gW107CgkgICAgbGV0IGNvb3JkVGltZXMgPSBbXTsKCSAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykgewoJICAgICAgICBjb25zdCBjaGlsZCA9IG5vZGUuY2hpbGROb2Rlcy5pdGVtKGkpOwoJICAgICAgICBpZiAoaXNFbGVtZW50KGNoaWxkKSkgewoJICAgICAgICAgICAgc3dpdGNoIChjaGlsZC50YWdOYW1lKSB7CgkgICAgICAgICAgICAgICAgY2FzZSAiTXVsdGlHZW9tZXRyeSI6CgkgICAgICAgICAgICAgICAgY2FzZSAiTXVsdGlUcmFjayI6CgkgICAgICAgICAgICAgICAgY2FzZSAiZ3g6TXVsdGlUcmFjayI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hpbGRHZW9tZXRyaWVzID0gZ2V0R2VvbWV0cnkoY2hpbGQpOwoJICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzID0gZ2VvbWV0cmllcy5jb25jYXQoY2hpbGRHZW9tZXRyaWVzLmdlb21ldHJpZXMpOwoJICAgICAgICAgICAgICAgICAgICBjb29yZFRpbWVzID0gY29vcmRUaW1lcy5jb25jYXQoY2hpbGRHZW9tZXRyaWVzLmNvb3JkVGltZXMpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgY2FzZSAiUG9pbnQiOiB7CgkgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gY29vcmQxKGdldENvb3JkaW5hdGVzKGNoaWxkKSk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChjb29yZGluYXRlcy5sZW5ndGggPj0gMikgewoJICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cmllcy5wdXNoKHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiUG9pbnQiLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzLAoJICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhc2UgIkxpbmVhclJpbmciOgoJICAgICAgICAgICAgICAgIGNhc2UgIkxpbmVTdHJpbmciOiB7CgkgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gY29vcmQoZ2V0Q29vcmRpbmF0ZXMoY2hpbGQpKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNvb3JkaW5hdGVzLmxlbmd0aCA+PSAyKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzLnB1c2goewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJMaW5lU3RyaW5nIiwKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlcywKCSAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBjYXNlICJQb2x5Z29uIjogewoJICAgICAgICAgICAgICAgICAgICBjb25zdCBjb29yZHMgPSBbXTsKCSAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lYXJSaW5nIG9mICQoY2hpbGQsICJMaW5lYXJSaW5nIikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJpbmcgPSBmaXhSaW5nKGNvb3JkKGdldENvb3JkaW5hdGVzKGxpbmVhclJpbmcpKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmluZy5sZW5ndGggPj0gNCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3Jkcy5wdXNoKHJpbmcpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmIChjb29yZHMubGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzLnB1c2goewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQb2x5Z29uIiwKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogY29vcmRzLAoJICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhc2UgIlRyYWNrIjoKCSAgICAgICAgICAgICAgICBjYXNlICJneDpUcmFjayI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgZ3ggPSBneENvb3JkcyhjaGlsZCk7CgkgICAgICAgICAgICAgICAgICAgIGlmICghZ3gpCgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgeyB0aW1lcywgZ2VvbWV0cnkgfSA9IGd4OwoJICAgICAgICAgICAgICAgICAgICBnZW9tZXRyaWVzLnB1c2goZ2VvbWV0cnkpOwoJICAgICAgICAgICAgICAgICAgICBpZiAodGltZXMubGVuZ3RoKQoJICAgICAgICAgICAgICAgICAgICAgICAgY29vcmRUaW1lcy5wdXNoKHRpbWVzKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiB7CgkgICAgICAgIGdlb21ldHJpZXMsCgkgICAgICAgIGNvb3JkVGltZXMsCgkgICAgfTsKCX0KCglmdW5jdGlvbiBnZW9tZXRyeUxpc3RUb0dlb21ldHJ5KGdlb21ldHJpZXMpIHsKCSAgICByZXR1cm4gZ2VvbWV0cmllcy5sZW5ndGggPT09IDAKCSAgICAgICAgPyBudWxsCgkgICAgICAgIDogZ2VvbWV0cmllcy5sZW5ndGggPT09IDEKCSAgICAgICAgICAgID8gZ2VvbWV0cmllc1swXQoJICAgICAgICAgICAgOiB7CgkgICAgICAgICAgICAgICAgdHlwZTogIkdlb21ldHJ5Q29sbGVjdGlvbiIsCgkgICAgICAgICAgICAgICAgZ2VvbWV0cmllcywKCSAgICAgICAgICAgIH07Cgl9CglmdW5jdGlvbiBnZXRQbGFjZW1hcmsobm9kZSwgc3R5bGVNYXAsIHNjaGVtYSwgb3B0aW9ucykgewoJICAgIGNvbnN0IHsgY29vcmRUaW1lcywgZ2VvbWV0cmllcyB9ID0gZ2V0R2VvbWV0cnkobm9kZSk7CgkgICAgY29uc3QgZ2VvbWV0cnkgPSBnZW9tZXRyeUxpc3RUb0dlb21ldHJ5KGdlb21ldHJpZXMpOwoJICAgIGlmICghZ2VvbWV0cnkgJiYgb3B0aW9ucy5za2lwTnVsbEdlb21ldHJ5KSB7CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH0KCSAgICBjb25zdCBmZWF0dXJlID0gewoJICAgICAgICB0eXBlOiAiRmVhdHVyZSIsCgkgICAgICAgIGdlb21ldHJ5LAoJICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKGdldE11bHRpKG5vZGUsIFsKCSAgICAgICAgICAgICJuYW1lIiwKCSAgICAgICAgICAgICJhZGRyZXNzIiwKCSAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwKCSAgICAgICAgICAgICJvcGVuIiwKCSAgICAgICAgICAgICJwaG9uZU51bWJlciIsCgkgICAgICAgICAgICAiZGVzY3JpcHRpb24iLAoJICAgICAgICBdKSwgZ2V0TWF5YmVIVE1MRGVzY3JpcHRpb24obm9kZSksIGV4dHJhY3RDYXNjYWRlZFN0eWxlKG5vZGUsIHN0eWxlTWFwKSwgZXh0cmFjdFN0eWxlKG5vZGUpLCBleHRyYWN0RXh0ZW5kZWREYXRhKG5vZGUsIHNjaGVtYSksIGV4dHJhY3RUaW1lU3Bhbihub2RlKSwgZXh0cmFjdFRpbWVTdGFtcChub2RlKSwgY29vcmRUaW1lcy5sZW5ndGgKCSAgICAgICAgICAgID8gewoJICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVQcm9wZXJ0aWVzOiB7CgkgICAgICAgICAgICAgICAgICAgIHRpbWVzOiBjb29yZFRpbWVzLmxlbmd0aCA9PT0gMSA/IGNvb3JkVGltZXNbMF0gOiBjb29yZFRpbWVzLAoJICAgICAgICAgICAgICAgIH0sCgkgICAgICAgICAgICB9CgkgICAgICAgICAgICA6IHt9KSwKCSAgICB9OwoJICAgIGlmIChmZWF0dXJlLnByb3BlcnRpZXM/LnZpc2liaWxpdHkgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICBmZWF0dXJlLnByb3BlcnRpZXMudmlzaWJpbGl0eSA9IGZlYXR1cmUucHJvcGVydGllcy52aXNpYmlsaXR5ICE9PSAiMCI7CgkgICAgfQoJICAgIGNvbnN0IGlkID0gbm9kZS5nZXRBdHRyaWJ1dGUoImlkIik7CgkgICAgaWYgKGlkICE9PSBudWxsICYmIGlkICE9PSAiIikKCSAgICAgICAgZmVhdHVyZS5pZCA9IGlkOwoJICAgIHJldHVybiBmZWF0dXJlOwoJfQoKCWZ1bmN0aW9uIGdldEdyb3VuZE92ZXJsYXlCb3gobm9kZSkgewoJICAgIGNvbnN0IGxhdExvblF1YWQgPSBnZXQxKG5vZGUsICJneDpMYXRMb25RdWFkIik7CgkgICAgaWYgKGxhdExvblF1YWQpIHsKCSAgICAgICAgY29uc3QgcmluZyA9IGZpeFJpbmcoY29vcmQoZ2V0Q29vcmRpbmF0ZXMobm9kZSkpKTsKCSAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICAgICAgdHlwZTogIlBvbHlnb24iLAoJICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbcmluZ10sCgkgICAgICAgICAgICB9LAoJICAgICAgICB9OwoJICAgIH0KCSAgICByZXR1cm4gZ2V0TGF0TG9uQm94KG5vZGUpOwoJfQoJY29uc3QgREVHUkVFU19UT19SQURJQU5TID0gTWF0aC5QSSAvIDE4MDsKCWZ1bmN0aW9uIHJvdGF0ZUJveChiYm94LCBjb29yZGluYXRlcywgcm90YXRpb24pIHsKCSAgICBjb25zdCBjZW50ZXIgPSBbKGJib3hbMF0gKyBiYm94WzJdKSAvIDIsIChiYm94WzFdICsgYmJveFszXSkgLyAyXTsKCSAgICByZXR1cm4gWwoJICAgICAgICBjb29yZGluYXRlc1swXS5tYXAoKGNvb3JkaW5hdGUpID0+IHsKCSAgICAgICAgICAgIGNvbnN0IGR5ID0gY29vcmRpbmF0ZVsxXSAtIGNlbnRlclsxXTsKCSAgICAgICAgICAgIGNvbnN0IGR4ID0gY29vcmRpbmF0ZVswXSAtIGNlbnRlclswXTsKCSAgICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KE1hdGgucG93KGR5LCAyKSArIE1hdGgucG93KGR4LCAyKSk7CgkgICAgICAgICAgICBjb25zdCBhbmdsZSA9IE1hdGguYXRhbjIoZHksIGR4KSArIHJvdGF0aW9uICogREVHUkVFU19UT19SQURJQU5TOwoJICAgICAgICAgICAgcmV0dXJuIFsKCSAgICAgICAgICAgICAgICBjZW50ZXJbMF0gKyBNYXRoLmNvcyhhbmdsZSkgKiBkaXN0YW5jZSwKCSAgICAgICAgICAgICAgICBjZW50ZXJbMV0gKyBNYXRoLnNpbihhbmdsZSkgKiBkaXN0YW5jZSwKCSAgICAgICAgICAgIF07CgkgICAgICAgIH0pLAoJICAgIF07Cgl9CglmdW5jdGlvbiBnZXRMYXRMb25Cb3gobm9kZSkgewoJICAgIGNvbnN0IGxhdExvbkJveCA9IGdldDEobm9kZSwgIkxhdExvbkJveCIpOwoJICAgIGlmIChsYXRMb25Cb3gpIHsKCSAgICAgICAgY29uc3Qgbm9ydGggPSBudW0xKGxhdExvbkJveCwgIm5vcnRoIik7CgkgICAgICAgIGNvbnN0IHdlc3QgPSBudW0xKGxhdExvbkJveCwgIndlc3QiKTsKCSAgICAgICAgY29uc3QgZWFzdCA9IG51bTEobGF0TG9uQm94LCAiZWFzdCIpOwoJICAgICAgICBjb25zdCBzb3V0aCA9IG51bTEobGF0TG9uQm94LCAic291dGgiKTsKCSAgICAgICAgY29uc3Qgcm90YXRpb24gPSBudW0xKGxhdExvbkJveCwgInJvdGF0aW9uIik7CgkgICAgICAgIGlmICh0eXBlb2Ygbm9ydGggPT09ICJudW1iZXIiICYmCgkgICAgICAgICAgICB0eXBlb2Ygc291dGggPT09ICJudW1iZXIiICYmCgkgICAgICAgICAgICB0eXBlb2Ygd2VzdCA9PT0gIm51bWJlciIgJiYKCSAgICAgICAgICAgIHR5cGVvZiBlYXN0ID09PSAibnVtYmVyIikgewoJICAgICAgICAgICAgY29uc3QgYmJveCA9IFt3ZXN0LCBzb3V0aCwgZWFzdCwgbm9ydGhdOwoJICAgICAgICAgICAgbGV0IGNvb3JkaW5hdGVzID0gWwoJICAgICAgICAgICAgICAgIFsKCSAgICAgICAgICAgICAgICAgICAgW3dlc3QsIG5vcnRoXSwKCSAgICAgICAgICAgICAgICAgICAgW2Vhc3QsIG5vcnRoXSwKCSAgICAgICAgICAgICAgICAgICAgW2Vhc3QsIHNvdXRoXSwKCSAgICAgICAgICAgICAgICAgICAgW3dlc3QsIHNvdXRoXSwKCSAgICAgICAgICAgICAgICAgICAgW3dlc3QsIG5vcnRoXSwgLy8gdG9wIGxlZnQgKGFnYWluKQoJICAgICAgICAgICAgICAgIF0sCgkgICAgICAgICAgICBdOwoJICAgICAgICAgICAgaWYgKHR5cGVvZiByb3RhdGlvbiA9PT0gIm51bWJlciIpIHsKCSAgICAgICAgICAgICAgICBjb29yZGluYXRlcyA9IHJvdGF0ZUJveChiYm94LCBjb29yZGluYXRlcywgcm90YXRpb24pOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICBiYm94LAoJICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQb2x5Z29uIiwKCSAgICAgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXMsCgkgICAgICAgICAgICAgICAgfSwKCSAgICAgICAgICAgIH07CgkgICAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIG51bGw7Cgl9CglmdW5jdGlvbiBnZXRHcm91bmRPdmVybGF5KG5vZGUsIHN0eWxlTWFwLCBzY2hlbWEsIG9wdGlvbnMpIHsKCSAgICBjb25zdCBib3ggPSBnZXRHcm91bmRPdmVybGF5Qm94KG5vZGUpOwoJICAgIGNvbnN0IGdlb21ldHJ5ID0gYm94Py5nZW9tZXRyeSB8fCBudWxsOwoJICAgIGlmICghZ2VvbWV0cnkgJiYgb3B0aW9ucy5za2lwTnVsbEdlb21ldHJ5KSB7CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH0KCSAgICBjb25zdCBmZWF0dXJlID0gewoJICAgICAgICB0eXBlOiAiRmVhdHVyZSIsCgkgICAgICAgIGdlb21ldHJ5LAoJICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKAoJICAgICAgICAvKioKCSAgICAgICAgICogUmVsYXRlZCB0bwoJICAgICAgICAgKiBodHRwczovL2dpc3QuZ2l0aHViLmNvbS90bWN3LzAzN2ExY2I2NjYwZDc0YTM5MmU5ZGE3NDQ2NTQwZjQ2CgkgICAgICAgICAqLwoJICAgICAgICB7ICJAZ2VvbWV0cnktdHlwZSI6ICJncm91bmRvdmVybGF5IiB9LCBnZXRNdWx0aShub2RlLCBbCgkgICAgICAgICAgICAibmFtZSIsCgkgICAgICAgICAgICAiYWRkcmVzcyIsCgkgICAgICAgICAgICAidmlzaWJpbGl0eSIsCgkgICAgICAgICAgICAib3BlbiIsCgkgICAgICAgICAgICAicGhvbmVOdW1iZXIiLAoJICAgICAgICAgICAgImRlc2NyaXB0aW9uIiwKCSAgICAgICAgXSksIGdldE1heWJlSFRNTERlc2NyaXB0aW9uKG5vZGUpLCBleHRyYWN0Q2FzY2FkZWRTdHlsZShub2RlLCBzdHlsZU1hcCksIGV4dHJhY3RTdHlsZShub2RlKSwgZXh0cmFjdEljb25IcmVmKG5vZGUpLCBleHRyYWN0RXh0ZW5kZWREYXRhKG5vZGUsIHNjaGVtYSksIGV4dHJhY3RUaW1lU3Bhbihub2RlKSwgZXh0cmFjdFRpbWVTdGFtcChub2RlKSksCgkgICAgfTsKCSAgICBpZiAoYm94Py5iYm94KSB7CgkgICAgICAgIGZlYXR1cmUuYmJveCA9IGJveC5iYm94OwoJICAgIH0KCSAgICBpZiAoZmVhdHVyZS5wcm9wZXJ0aWVzPy52aXNpYmlsaXR5ICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgZmVhdHVyZS5wcm9wZXJ0aWVzLnZpc2liaWxpdHkgPSBmZWF0dXJlLnByb3BlcnRpZXMudmlzaWJpbGl0eSAhPT0gIjAiOwoJICAgIH0KCSAgICBjb25zdCBpZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCJpZCIpOwoJICAgIGlmIChpZCAhPT0gbnVsbCAmJiBpZCAhPT0gIiIpCgkgICAgICAgIGZlYXR1cmUuaWQgPSBpZDsKCSAgICByZXR1cm4gZmVhdHVyZTsKCX0KCglmdW5jdGlvbiBnZXRTdHlsZUlkKHN0eWxlKSB7CgkgICAgbGV0IGlkID0gc3R5bGUuZ2V0QXR0cmlidXRlKCJpZCIpOwoJICAgIGNvbnN0IHBhcmVudE5vZGUgPSBzdHlsZS5wYXJlbnROb2RlOwoJICAgIGlmICghaWQgJiYKCSAgICAgICAgaXNFbGVtZW50KHBhcmVudE5vZGUpICYmCgkgICAgICAgIHBhcmVudE5vZGUubG9jYWxOYW1lID09PSAiQ2FzY2FkaW5nU3R5bGUiKSB7CgkgICAgICAgIGlkID0gcGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoImttbDppZCIpIHx8IHBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCJpZCIpOwoJICAgIH0KCSAgICByZXR1cm4gbm9ybWFsaXplSWQoaWQgfHwgIiIpOwoJfQoJZnVuY3Rpb24gYnVpbGRTdHlsZU1hcChub2RlKSB7CgkgICAgY29uc3Qgc3R5bGVNYXAgPSB7fTsKCSAgICBmb3IgKGNvbnN0IHN0eWxlIG9mICQobm9kZSwgIlN0eWxlIikpIHsKCSAgICAgICAgc3R5bGVNYXBbZ2V0U3R5bGVJZChzdHlsZSldID0gZXh0cmFjdFN0eWxlKHN0eWxlKTsKCSAgICB9CgkgICAgZm9yIChjb25zdCBtYXAgb2YgJChub2RlLCAiU3R5bGVNYXAiKSkgewoJICAgICAgICBjb25zdCBpZCA9IG5vcm1hbGl6ZUlkKG1hcC5nZXRBdHRyaWJ1dGUoImlkIikgfHwgIiIpOwoJICAgICAgICB2YWwxKG1hcCwgInN0eWxlVXJsIiwgKHN0eWxlVXJsKSA9PiB7CgkgICAgICAgICAgICBzdHlsZVVybCA9IG5vcm1hbGl6ZUlkKHN0eWxlVXJsKTsKCSAgICAgICAgICAgIGlmIChzdHlsZU1hcFtzdHlsZVVybF0pIHsKCSAgICAgICAgICAgICAgICBzdHlsZU1hcFtpZF0gPSBzdHlsZU1hcFtzdHlsZVVybF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0pOwoJICAgIH0KCSAgICByZXR1cm4gc3R5bGVNYXA7Cgl9CglmdW5jdGlvbiBidWlsZFNjaGVtYShub2RlKSB7CgkgICAgY29uc3Qgc2NoZW1hID0ge307CgkgICAgZm9yIChjb25zdCBmaWVsZCBvZiAkKG5vZGUsICJTaW1wbGVGaWVsZCIpKSB7CgkgICAgICAgIHNjaGVtYVtmaWVsZC5nZXRBdHRyaWJ1dGUoIm5hbWUiKSB8fCAiIl0gPQoJICAgICAgICAgICAgdHlwZUNvbnZlcnRlcnNbZmllbGQuZ2V0QXR0cmlidXRlKCJ0eXBlIikgfHwgIiJdIHx8CgkgICAgICAgICAgICAgICAgdHlwZUNvbnZlcnRlcnNbInN0cmluZyJdOwoJICAgIH0KCSAgICByZXR1cm4gc2NoZW1hOwoJfQoJY29uc3QgRk9MREVSX1BST1BTID0gWwoJICAgICJuYW1lIiwKCSAgICAidmlzaWJpbGl0eSIsCgkgICAgIm9wZW4iLAoJICAgICJhZGRyZXNzIiwKCSAgICAiZGVzY3JpcHRpb24iLAoJICAgICJwaG9uZU51bWJlciIsCgkgICAgInZpc2liaWxpdHkiLAoJXTsKCWZ1bmN0aW9uIGdldEZvbGRlcihub2RlKSB7CgkgICAgY29uc3QgbWV0YSA9IHt9OwoJICAgIGZvciAoY29uc3QgY2hpbGQgb2YgQXJyYXkuZnJvbShub2RlLmNoaWxkTm9kZXMpKSB7CgkgICAgICAgIGlmIChpc0VsZW1lbnQoY2hpbGQpICYmIEZPTERFUl9QUk9QUy5pbmNsdWRlcyhjaGlsZC50YWdOYW1lKSkgewoJICAgICAgICAgICAgbWV0YVtjaGlsZC50YWdOYW1lXSA9IG5vZGVWYWwoY2hpbGQpOwoJICAgICAgICB9CgkgICAgfQoJICAgIHJldHVybiB7CgkgICAgICAgIHR5cGU6ICJmb2xkZXIiLAoJICAgICAgICBtZXRhLAoJICAgICAgICBjaGlsZHJlbjogW10sCgkgICAgfTsKCX0KCS8qKgoJICogWWllbGQgYSBuZXN0ZWQgdHJlZSB3aXRoIEtNTCBmb2xkZXIgc3RydWN0dXJlCgkgKgoJICogVGhpcyBnZW5lcmF0ZXMgYSB0cmVlIHdpdGggdGhlIGdpdmVuIHN0cnVjdHVyZToKCSAqCgkgKiBgYGBqcwoJICogewoJICogICAidHlwZSI6ICJyb290IiwKCSAqICAgImNoaWxkcmVuIjogWwoJICogICAgIHsKCSAqICAgICAgICJ0eXBlIjogImZvbGRlciIsCgkgKiAgICAgICAibWV0YSI6IHsKCSAqICAgICAgICAgIm5hbWUiOiAiVGVzdCIKCSAqICAgICAgIH0sCgkgKiAgICAgICAiY2hpbGRyZW4iOiBbCgkgKiAgICAgICAgICAvLyAuLi5mZWF0dXJlcyBhbmQgZm9sZGVycwoJICogICAgICAgXQoJICogICAgIH0KCSAqICAgICAvLyAuLi5mZWF0dXJlcwoJICogICBdCgkgKiB9CgkgKiBgYGAKCSAqCgkgKiAjIyMgR3JvdW5kT3ZlcmxheQoJICoKCSAqIEdyb3VuZE92ZXJsYXkgZWxlbWVudHMgYXJlIGNvbnZlcnRlZCBpbnRvCgkgKiBgRmVhdHVyZWAgb2JqZWN0cyB3aXRoIGBQb2x5Z29uYCBnZW9tZXRyaWVzLAoJICogYSBwcm9wZXJ0eSBsaWtlOgoJICoKCSAqIGBgYGpzb24KCSAqIHsKCSAqICAgIkBnZW9tZXRyeS10eXBlIjogImdyb3VuZG92ZXJsYXkiCgkgKiB9CgkgKiBgYGAKCSAqCgkgKiBBbmQgdGhlIGdyb3VuZCBvdmVybGF5J3MgaW1hZ2UgVVJMIGluIHRoZSBgaHJlZmAKCSAqIHByb3BlcnR5LiBHcm91bmQgb3ZlcmxheXMgd2lsbCBuZWVkIHRvIGJlIGRpc3BsYXllZAoJICogd2l0aCBhIHNlcGFyYXRlIG1ldGhvZCB0byBvdGhlciBmZWF0dXJlcywgZGVwZW5kaW5nCgkgKiBvbiB3aGljaCBtYXAgZnJhbWV3b3JrIHlvdSdyZSB1c2luZy4KCSAqLwoJZnVuY3Rpb24ga21sV2l0aEZvbGRlcnMobm9kZSwgb3B0aW9ucyA9IHsKCSAgICBza2lwTnVsbEdlb21ldHJ5OiBmYWxzZSwKCX0pIHsKCSAgICBjb25zdCBzdHlsZU1hcCA9IGJ1aWxkU3R5bGVNYXAobm9kZSk7CgkgICAgY29uc3Qgc2NoZW1hID0gYnVpbGRTY2hlbWEobm9kZSk7CgkgICAgY29uc3QgdHJlZSA9IHsgdHlwZTogInJvb3QiLCBjaGlsZHJlbjogW10gfTsKCSAgICBmdW5jdGlvbiB0cmF2ZXJzZShub2RlLCBwb2ludGVyLCBvcHRpb25zKSB7CgkgICAgICAgIGlmIChpc0VsZW1lbnQobm9kZSkpIHsKCSAgICAgICAgICAgIHN3aXRjaCAobm9kZS50YWdOYW1lKSB7CgkgICAgICAgICAgICAgICAgY2FzZSAiR3JvdW5kT3ZlcmxheSI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgcGxhY2VtYXJrID0gZ2V0R3JvdW5kT3ZlcmxheShub2RlLCBzdHlsZU1hcCwgc2NoZW1hLCBvcHRpb25zKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHBsYWNlbWFyaykgewoJICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRlci5jaGlsZHJlbi5wdXNoKHBsYWNlbWFyayk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhc2UgIlBsYWNlbWFyayI6IHsKCSAgICAgICAgICAgICAgICAgICAgY29uc3QgcGxhY2VtYXJrID0gZ2V0UGxhY2VtYXJrKG5vZGUsIHN0eWxlTWFwLCBzY2hlbWEsIG9wdGlvbnMpOwoJICAgICAgICAgICAgICAgICAgICBpZiAocGxhY2VtYXJrKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBwb2ludGVyLmNoaWxkcmVuLnB1c2gocGxhY2VtYXJrKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgY2FzZSAiRm9sZGVyIjogewoJICAgICAgICAgICAgICAgICAgICBjb25zdCBmb2xkZXIgPSBnZXRGb2xkZXIobm9kZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvaW50ZXIuY2hpbGRyZW4ucHVzaChmb2xkZXIpOwoJICAgICAgICAgICAgICAgICAgICBwb2ludGVyID0gZm9sZGVyOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG5vZGUuY2hpbGROb2RlcykgewoJICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2RlLmNoaWxkTm9kZXMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgICAgICB0cmF2ZXJzZShub2RlLmNoaWxkTm9kZXNbaV0sIHBvaW50ZXIsIG9wdGlvbnMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQoJICAgIHRyYXZlcnNlKG5vZGUsIHRyZWUsIG9wdGlvbnMpOwoJICAgIHJldHVybiB0cmVlOwoJfQoJLyoqCgkgKiBDb252ZXJ0IEtNTCB0byBHZW9KU09OIGluY3JlbWVudGFsbHksIHJldHVybmluZwoJICogYSBbR2VuZXJhdG9yXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L0d1aWRlL0l0ZXJhdG9yc19hbmRfR2VuZXJhdG9ycykKCSAqIHRoYXQgeWllbGRzIG91dHB1dCBmZWF0dXJlIGJ5IGZlYXR1cmUuCgkgKi8KCWZ1bmN0aW9uKiBrbWxHZW4obm9kZSwgb3B0aW9ucyA9IHsKCSAgICBza2lwTnVsbEdlb21ldHJ5OiBmYWxzZSwKCX0pIHsKCSAgICBjb25zdCBzdHlsZU1hcCA9IGJ1aWxkU3R5bGVNYXAobm9kZSk7CgkgICAgY29uc3Qgc2NoZW1hID0gYnVpbGRTY2hlbWEobm9kZSk7CgkgICAgZm9yIChjb25zdCBwbGFjZW1hcmsgb2YgJChub2RlLCAiUGxhY2VtYXJrIikpIHsKCSAgICAgICAgY29uc3QgZmVhdHVyZSA9IGdldFBsYWNlbWFyayhwbGFjZW1hcmssIHN0eWxlTWFwLCBzY2hlbWEsIG9wdGlvbnMpOwoJICAgICAgICBpZiAoZmVhdHVyZSkKCSAgICAgICAgICAgIHlpZWxkIGZlYXR1cmU7CgkgICAgfQoJICAgIGZvciAoY29uc3QgZ3JvdW5kT3ZlcmxheSBvZiAkKG5vZGUsICJHcm91bmRPdmVybGF5IikpIHsKCSAgICAgICAgY29uc3QgZmVhdHVyZSA9IGdldEdyb3VuZE92ZXJsYXkoZ3JvdW5kT3ZlcmxheSwgc3R5bGVNYXAsIHNjaGVtYSwgb3B0aW9ucyk7CgkgICAgICAgIGlmIChmZWF0dXJlKQoJICAgICAgICAgICAgeWllbGQgZmVhdHVyZTsKCSAgICB9Cgl9CgkvKioKCSAqIENvbnZlcnQgYSBLTUwgZG9jdW1lbnQgdG8gR2VvSlNPTi4gVGhlIGZpcnN0IGFyZ3VtZW50LCBgZG9jYCwgbXVzdCBiZSBhIEtNTAoJICogZG9jdW1lbnQgYXMgYW4gWE1MIERPTSAtIG5vdCBhcyBhIHN0cmluZy4gWW91IGNhbiBnZXQgdGhpcyB1c2luZyBqUXVlcnkncyBkZWZhdWx0CgkgKiBgLmFqYXhgIGZ1bmN0aW9uIG9yIHVzaW5nIGEgYmFyZSBYTUxIdHRwUmVxdWVzdCB3aXRoIHRoZSBgLnJlc3BvbnNlYCBwcm9wZXJ0eQoJICogaG9sZGluZyBhbiBYTUwgRE9NLgoJICoKCSAqIFRoZSBvdXRwdXQgaXMgYSBKYXZhU2NyaXB0IG9iamVjdCBvZiBHZW9KU09OIGRhdGEuIFlvdSBjYW4gY29udmVydCBpdCB0byBhIHN0cmluZwoJICogd2l0aCBbSlNPTi5zdHJpbmdpZnldKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0pTT04vc3RyaW5naWZ5KQoJICogb3IgdXNlIGl0IGRpcmVjdGx5IGluIGxpYnJhcmllcy4KCSAqLwoJZnVuY3Rpb24ga21sKG5vZGUsIG9wdGlvbnMgPSB7CgkgICAgc2tpcE51bGxHZW9tZXRyeTogZmFsc2UsCgl9KSB7CgkgICAgcmV0dXJuIHsKCSAgICAgICAgdHlwZTogIkZlYXR1cmVDb2xsZWN0aW9uIiwKCSAgICAgICAgZmVhdHVyZXM6IEFycmF5LmZyb20oa21sR2VuKG5vZGUsIG9wdGlvbnMpKSwKCSAgICB9OwoJfQoKCXZhciB0b0dlb0pzb24gPSAvKiNfX1BVUkVfXyovT2JqZWN0LmZyZWV6ZSh7CgkJX19wcm90b19fOiBudWxsLAoJCWdweDogZ3B4LAoJCWdweEdlbjogZ3B4R2VuLAoJCWttbDoga21sLAoJCWttbEdlbjoga21sR2VuLAoJCWttbFdpdGhGb2xkZXJzOiBrbWxXaXRoRm9sZGVycywKCQl0Y3g6IHRjeCwKCQl0Y3hHZW46IHRjeEdlbgoJfSk7CgoJdmFyIHBvbHlsaW5lID0ge2V4cG9ydHM6IHt9fTsKCgkoZnVuY3Rpb24gKG1vZHVsZSkgewoKCQkvKioKCQkgKiBCYXNlZCBvZmYgb2YgW3RoZSBvZmZpY2FsIEdvb2dsZSBkb2N1bWVudF0oaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vbWFwcy9kb2N1bWVudGF0aW9uL3V0aWxpdGllcy9wb2x5bGluZWFsZ29yaXRobSkKCQkgKgoJCSAqIFNvbWUgcGFydHMgZnJvbSBbdGhpcyBpbXBsZW1lbnRhdGlvbl0oaHR0cDovL2ZhY3N0YWZmLnVuY2EuZWR1L21jbWNjbHVyL0dvb2dsZU1hcHMvRW5jb2RlUG9seWxpbmUvUG9seWxpbmVFbmNvZGVyLmpzKQoJCSAqIGJ5IFtNYXJrIE1jQ2x1cmVdKGh0dHA6Ly9mYWNzdGFmZi51bmNhLmVkdS9tY21jY2x1ci8pCgkJICoKCQkgKiBAbW9kdWxlIHBvbHlsaW5lCgkJICovCgoJCXZhciBwb2x5bGluZSA9IHt9OwoKCQlmdW5jdGlvbiBweTJfcm91bmQodmFsdWUpIHsKCQkgICAgLy8gR29vZ2xlJ3MgcG9seWxpbmUgYWxnb3JpdGhtIHVzZXMgdGhlIHNhbWUgcm91bmRpbmcgc3RyYXRlZ3kgYXMgUHl0aG9uIDIsIHdoaWNoIGlzIGRpZmZlcmVudCBmcm9tIEpTIGZvciBuZWdhdGl2ZSB2YWx1ZXMKCQkgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5hYnModmFsdWUpICsgMC41KSAqICh2YWx1ZSA+PSAwID8gMSA6IC0xKTsKCQl9CgoJCWZ1bmN0aW9uIGVuY29kZShjdXJyZW50LCBwcmV2aW91cywgZmFjdG9yKSB7CgkJICAgIGN1cnJlbnQgPSBweTJfcm91bmQoY3VycmVudCAqIGZhY3Rvcik7CgkJICAgIHByZXZpb3VzID0gcHkyX3JvdW5kKHByZXZpb3VzICogZmFjdG9yKTsKCQkgICAgdmFyIGNvb3JkaW5hdGUgPSAoY3VycmVudCAtIHByZXZpb3VzKSAqIDI7CgkJICAgIGlmIChjb29yZGluYXRlIDwgMCkgewoJCSAgICAgICAgY29vcmRpbmF0ZSA9IC1jb29yZGluYXRlIC0gMTsKCQkgICAgfQoJCSAgICB2YXIgb3V0cHV0ID0gJyc7CgkJICAgIHdoaWxlIChjb29yZGluYXRlID49IDB4MjApIHsKCQkgICAgICAgIG91dHB1dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgweDIwIHwgKGNvb3JkaW5hdGUgJiAweDFmKSkgKyA2Myk7CgkJICAgICAgICBjb29yZGluYXRlIC89IDMyOwoJCSAgICB9CgkJICAgIG91dHB1dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChjb29yZGluYXRlIHwgMCkgKyA2Myk7CgkJICAgIHJldHVybiBvdXRwdXQ7CgkJfQoKCQkvKioKCQkgKiBEZWNvZGVzIHRvIGEgW2xhdGl0dWRlLCBsb25naXR1ZGVdIGNvb3JkaW5hdGVzIGFycmF5LgoJCSAqCgkJICogVGhpcyBpcyBhZGFwdGVkIGZyb20gdGhlIGltcGxlbWVudGF0aW9uIGluIFByb2plY3QtT1NSTS4KCQkgKgoJCSAqIEBwYXJhbSB7U3RyaW5nfSBzdHIKCQkgKiBAcGFyYW0ge051bWJlcn0gcHJlY2lzaW9uCgkJICogQHJldHVybnMge0FycmF5fQoJCSAqCgkJICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vUHJvamVjdC1PU1JNL29zcm0tZnJvbnRlbmQvYmxvYi9tYXN0ZXIvV2ViQ29udGVudC9yb3V0aW5nL09TUk0uUm91dGluZ0dlb21ldHJ5LmpzCgkJICovCgkJcG9seWxpbmUuZGVjb2RlID0gZnVuY3Rpb24oc3RyLCBwcmVjaXNpb24pIHsKCQkgICAgdmFyIGluZGV4ID0gMCwKCQkgICAgICAgIGxhdCA9IDAsCgkJICAgICAgICBsbmcgPSAwLAoJCSAgICAgICAgY29vcmRpbmF0ZXMgPSBbXSwKCQkgICAgICAgIHNoaWZ0ID0gMCwKCQkgICAgICAgIHJlc3VsdCA9IDAsCgkJICAgICAgICBieXRlID0gbnVsbCwKCQkgICAgICAgIGxhdGl0dWRlX2NoYW5nZSwKCQkgICAgICAgIGxvbmdpdHVkZV9jaGFuZ2UsCgkJICAgICAgICBmYWN0b3IgPSBNYXRoLnBvdygxMCwgTnVtYmVyLmlzSW50ZWdlcihwcmVjaXNpb24pID8gcHJlY2lzaW9uIDogNSk7CgoJCSAgICAvLyBDb29yZGluYXRlcyBoYXZlIHZhcmlhYmxlIGxlbmd0aCB3aGVuIGVuY29kZWQsIHNvIGp1c3Qga2VlcAoJCSAgICAvLyB0cmFjayBvZiB3aGV0aGVyIHdlJ3ZlIGhpdCB0aGUgZW5kIG9mIHRoZSBzdHJpbmcuIEluIGVhY2gKCQkgICAgLy8gbG9vcCBpdGVyYXRpb24sIGEgc2luZ2xlIGNvb3JkaW5hdGUgaXMgZGVjb2RlZC4KCQkgICAgd2hpbGUgKGluZGV4IDwgc3RyLmxlbmd0aCkgewoKCQkgICAgICAgIC8vIFJlc2V0IHNoaWZ0LCByZXN1bHQsIGFuZCBieXRlCgkJICAgICAgICBieXRlID0gbnVsbDsKCQkgICAgICAgIHNoaWZ0ID0gMTsKCQkgICAgICAgIHJlc3VsdCA9IDA7CgoJCSAgICAgICAgZG8gewoJCSAgICAgICAgICAgIGJ5dGUgPSBzdHIuY2hhckNvZGVBdChpbmRleCsrKSAtIDYzOwoJCSAgICAgICAgICAgIHJlc3VsdCArPSAoYnl0ZSAmIDB4MWYpICogc2hpZnQ7CgkJICAgICAgICAgICAgc2hpZnQgKj0gMzI7CgkJICAgICAgICB9IHdoaWxlIChieXRlID49IDB4MjApOwoKCQkgICAgICAgIGxhdGl0dWRlX2NoYW5nZSA9IChyZXN1bHQgJiAxKSA/ICgoLXJlc3VsdCAtIDEpIC8gMikgOiAocmVzdWx0IC8gMik7CgoJCSAgICAgICAgc2hpZnQgPSAxOwoJCSAgICAgICAgcmVzdWx0ID0gMDsKCgkJICAgICAgICBkbyB7CgkJICAgICAgICAgICAgYnl0ZSA9IHN0ci5jaGFyQ29kZUF0KGluZGV4KyspIC0gNjM7CgkJICAgICAgICAgICAgcmVzdWx0ICs9IChieXRlICYgMHgxZikgKiBzaGlmdDsKCQkgICAgICAgICAgICBzaGlmdCAqPSAzMjsKCQkgICAgICAgIH0gd2hpbGUgKGJ5dGUgPj0gMHgyMCk7CgoJCSAgICAgICAgbG9uZ2l0dWRlX2NoYW5nZSA9IChyZXN1bHQgJiAxKSA/ICgoLXJlc3VsdCAtIDEpIC8gMikgOiAocmVzdWx0IC8gMik7CgoJCSAgICAgICAgbGF0ICs9IGxhdGl0dWRlX2NoYW5nZTsKCQkgICAgICAgIGxuZyArPSBsb25naXR1ZGVfY2hhbmdlOwoKCQkgICAgICAgIGNvb3JkaW5hdGVzLnB1c2goW2xhdCAvIGZhY3RvciwgbG5nIC8gZmFjdG9yXSk7CgkJICAgIH0KCgkJICAgIHJldHVybiBjb29yZGluYXRlczsKCQl9OwoKCQkvKioKCQkgKiBFbmNvZGVzIHRoZSBnaXZlbiBbbGF0aXR1ZGUsIGxvbmdpdHVkZV0gY29vcmRpbmF0ZXMgYXJyYXkuCgkJICoKCQkgKiBAcGFyYW0ge0FycmF5LjxBcnJheS48TnVtYmVyPj59IGNvb3JkaW5hdGVzCgkJICogQHBhcmFtIHtOdW1iZXJ9IHByZWNpc2lvbgoJCSAqIEByZXR1cm5zIHtTdHJpbmd9CgkJICovCgkJcG9seWxpbmUuZW5jb2RlID0gZnVuY3Rpb24oY29vcmRpbmF0ZXMsIHByZWNpc2lvbikgewoJCSAgICBpZiAoIWNvb3JkaW5hdGVzLmxlbmd0aCkgeyByZXR1cm4gJyc7IH0KCgkJICAgIHZhciBmYWN0b3IgPSBNYXRoLnBvdygxMCwgTnVtYmVyLmlzSW50ZWdlcihwcmVjaXNpb24pID8gcHJlY2lzaW9uIDogNSksCgkJICAgICAgICBvdXRwdXQgPSBlbmNvZGUoY29vcmRpbmF0ZXNbMF1bMF0sIDAsIGZhY3RvcikgKyBlbmNvZGUoY29vcmRpbmF0ZXNbMF1bMV0sIDAsIGZhY3Rvcik7CgoJCSAgICBmb3IgKHZhciBpID0gMTsgaSA8IGNvb3JkaW5hdGVzLmxlbmd0aDsgaSsrKSB7CgkJICAgICAgICB2YXIgYSA9IGNvb3JkaW5hdGVzW2ldLCBiID0gY29vcmRpbmF0ZXNbaSAtIDFdOwoJCSAgICAgICAgb3V0cHV0ICs9IGVuY29kZShhWzBdLCBiWzBdLCBmYWN0b3IpOwoJCSAgICAgICAgb3V0cHV0ICs9IGVuY29kZShhWzFdLCBiWzFdLCBmYWN0b3IpOwoJCSAgICB9CgoJCSAgICByZXR1cm4gb3V0cHV0OwoJCX07CgoJCWZ1bmN0aW9uIGZsaXBwZWQoY29vcmRzKSB7CgkJICAgIHZhciBmbGlwcGVkID0gW107CgkJICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29vcmRzLmxlbmd0aDsgaSsrKSB7CgkJICAgICAgICB2YXIgY29vcmQgPSBjb29yZHNbaV0uc2xpY2UoKTsKCQkgICAgICAgIGZsaXBwZWQucHVzaChbY29vcmRbMV0sIGNvb3JkWzBdXSk7CgkJICAgIH0KCQkgICAgcmV0dXJuIGZsaXBwZWQ7CgkJfQoKCQkvKioKCQkgKiBFbmNvZGVzIGEgR2VvSlNPTiBMaW5lU3RyaW5nIGZlYXR1cmUvZ2VvbWV0cnkuCgkJICoKCQkgKiBAcGFyYW0ge09iamVjdH0gZ2VvanNvbgoJCSAqIEBwYXJhbSB7TnVtYmVyfSBwcmVjaXNpb24KCQkgKiBAcmV0dXJucyB7U3RyaW5nfQoJCSAqLwoJCXBvbHlsaW5lLmZyb21HZW9KU09OID0gZnVuY3Rpb24oZ2VvanNvbiwgcHJlY2lzaW9uKSB7CgkJICAgIGlmIChnZW9qc29uICYmIGdlb2pzb24udHlwZSA9PT0gJ0ZlYXR1cmUnKSB7CgkJICAgICAgICBnZW9qc29uID0gZ2VvanNvbi5nZW9tZXRyeTsKCQkgICAgfQoJCSAgICBpZiAoIWdlb2pzb24gfHwgZ2VvanNvbi50eXBlICE9PSAnTGluZVN0cmluZycpIHsKCQkgICAgICAgIHRocm93IG5ldyBFcnJvcignSW5wdXQgbXVzdCBiZSBhIEdlb0pTT04gTGluZVN0cmluZycpOwoJCSAgICB9CgkJICAgIHJldHVybiBwb2x5bGluZS5lbmNvZGUoZmxpcHBlZChnZW9qc29uLmNvb3JkaW5hdGVzKSwgcHJlY2lzaW9uKTsKCQl9OwoKCQkvKioKCQkgKiBEZWNvZGVzIHRvIGEgR2VvSlNPTiBMaW5lU3RyaW5nIGdlb21ldHJ5LgoJCSAqCgkJICogQHBhcmFtIHtTdHJpbmd9IHN0cgoJCSAqIEBwYXJhbSB7TnVtYmVyfSBwcmVjaXNpb24KCQkgKiBAcmV0dXJucyB7T2JqZWN0fQoJCSAqLwoJCXBvbHlsaW5lLnRvR2VvSlNPTiA9IGZ1bmN0aW9uKHN0ciwgcHJlY2lzaW9uKSB7CgkJICAgIHZhciBjb29yZHMgPSBwb2x5bGluZS5kZWNvZGUoc3RyLCBwcmVjaXNpb24pOwoJCSAgICByZXR1cm4gewoJCSAgICAgICAgdHlwZTogJ0xpbmVTdHJpbmcnLAoJCSAgICAgICAgY29vcmRpbmF0ZXM6IGZsaXBwZWQoY29vcmRzKQoJCSAgICB9OwoJCX07CgoJCWlmIChtb2R1bGUuZXhwb3J0cykgewoJCSAgICBtb2R1bGUuZXhwb3J0cyA9IHBvbHlsaW5lOwoJCX0gCgl9IChwb2x5bGluZSkpOwoKCXZhciBwb2x5bGluZUV4cG9ydHMgPSBwb2x5bGluZS5leHBvcnRzOwoKCXZhciB1dGlscyA9ICgoKSA9PiB7CgoJICAgIGNvbnN0IHB1cmdlUHJvcHMgPSAob2JqLCBibGFja2xpc3QpID0+IHsKCSAgICAgICAgaWYgKG9iaikgewoJICAgICAgICAgICAgbGV0IHJzID0gT2JqZWN0LmFzc2lnbih7fSwgb2JqKTsKCSAgICAgICAgICAgIGlmIChibGFja2xpc3QpIHsKCSAgICAgICAgICAgICAgICBmb3IgKGxldCBwcm9wIG9mIGJsYWNrbGlzdCkgewoJICAgICAgICAgICAgICAgICAgICBkZWxldGUgcnNbcHJvcF07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIHJzOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB7fTsKCSAgICB9OwoKCSAgICBjb25zdCBtZXJnZVByb3BzID0gKG9iajEsIG9iajIpID0+IHsKCSAgICAgICAgb2JqMSA9IG9iajEgPyBvYmoxIDoge307CgkgICAgICAgIG9iajIgPSBvYmoyID8gb2JqMiA6IHt9OwoJICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihvYmoxLCBvYmoyKTsKCSAgICB9OwoKCSAgICBjb25zdCBmaXJzdCA9IGEgPT4gYVswXTsKCSAgICBjb25zdCBsYXN0ID0gYSA9PiBhW2EubGVuZ3RoIC0gMV07CgkgICAgY29uc3QgY29vcmRzVG9LZXkgPSBhID0+IGEuam9pbignLCcpOwoKCSAgICBjb25zdCBhZGRUb01hcCA9IChtLCBrLCB2KSA9PiB7CgkgICAgICAgIGxldCBhID0gbVtrXTsKCSAgICAgICAgaWYgKGEpIHsKCSAgICAgICAgICAgIGEucHVzaCh2KTsKCSAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgIG1ba10gPSBbdl07CgkgICAgICAgIH0KCSAgICB9OwoKCSAgICBjb25zdCByZW1vdmVGcm9tTWFwID0gKG0sIGssIHYpID0+IHsKCSAgICAgICAgbGV0IGEgPSBtW2tdOwoJICAgICAgICBsZXQgaWR4ID0gbnVsbDsKCSAgICAgICAgaWYgKGEgJiYgKGlkeCA9IGEuaW5kZXhPZih2KSkgPj0gMCkgewoJICAgICAgICAgICAgYS5zcGxpY2UoaWR4LCAxKTsKCSAgICAgICAgfQoJICAgIH07CgoJICAgIGNvbnN0IGdldEZpcnN0RnJvbU1hcCA9IChtLCBrKSA9PiB7CgkgICAgICAgIGxldCBhID0gbVtrXTsKCSAgICAgICAgaWYgKGEgJiYgYS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICByZXR1cm4gYVswXTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoKCSAgICAvLyBuZWVkIDMrIGRpZmZlcmVudCBwb2ludHMgdG8gZm9ybSBhIHJpbmcsIGhlcmUgdXNpbmcgPiAzIGlzICdjb3ogYSB0aGUgZmlyc3QgYW5kIHRoZSBsYXN0IHBvaW50cyBhcmUgYWN0dWFsbHkgdGhlIHNhbWUKCSAgICBjb25zdCBpc1JpbmcgPSBhID0+IGEubGVuZ3RoID4gMyAmJiBjb29yZHNUb0tleShmaXJzdChhKSkgPT09IGNvb3Jkc1RvS2V5KGxhc3QoYSkpOwoKCSAgICBjb25zdCByaW5nRGlyZWN0aW9uID0gKGEsIHhJZHgsIHlJZHgpID0+IHsKCSAgICAgICAgeElkeCA9IHhJZHggfHwgMCwgeUlkeCA9IHlJZHggfHwgMTsKCSAgICAgICAgLy8gZ2V0IHRoZSBpbmRleCBvZiB0aGUgcG9pbnQgd2hpY2ggaGFzIHRoZSBtYXhpbXVtIHggdmFsdWUKCSAgICAgICAgbGV0IG0gPSBhLnJlZHVjZSgobWF4eElkeCwgdiwgaWR4KSA9PiBhW21heHhJZHhdW3hJZHhdID4gdlt4SWR4XSA/IG1heHhJZHggOiBpZHgsIDApOwoJICAgICAgICAvLyAnY296IHRoZSBmaXJzdCBwb2ludCBpcyB2aXJ0dWFsbHkgdGhlIHNhbWUgb25lIGFzIHRoZSBsYXN0IHBvaW50LCAKCSAgICAgICAgLy8gd2UgbmVlZCB0byBza2lwIGEubGVuZ3RoIC0gMSBmb3IgbGVmdCB3aGVuIG0gPSAwLAoJICAgICAgICAvLyBhbmQgc2tpcCAwIGZvciByaWdodCB3aGVuIG0gPSBhLmxlbmd0aCAtIDE7CgkgICAgICAgIGxldCBsID0gbSA8PSAwID8gYS5sZW5ndGggLSAyIDogbSAtIDEsIHIgPSBtID49IGEubGVuZ3RoIC0gMSA/IDEgOiBtICsgMTsKCSAgICAgICAgbGV0IHhhID0gYVtsXVt4SWR4XSwgeGIgPSBhW21dW3hJZHhdLCB4YyA9IGFbcl1beElkeF07CgkgICAgICAgIGxldCB5YSA9IGFbbF1beUlkeF0sIHliID0gYVttXVt5SWR4XSwgeWMgPSBhW3JdW3lJZHhdOwoJICAgICAgICBsZXQgZGV0ID0gKHhiIC0geGEpICogKHljIC0geWEpIC0gKHhjIC0geGEpICogKHliIC0geWEpOwoJICAgICAgICByZXR1cm4gZGV0IDwgMCA/ICdjbG9ja3dpc2UnIDogJ2NvdW50ZXJjbG9ja3dpc2UnOwoJICAgIH07CgoJICAgIGNvbnN0IHB0SW5zaWRlUG9seWdvbiA9IChwdCwgcG9seWdvbiwgeElkeCwgeUlkeCkgPT4gewoJICAgICAgICB4SWR4ID0geElkeCB8fCAwLCB5SWR4ID0geUlkeCB8fCAxOwoJICAgICAgICBsZXQgcmVzdWx0ID0gZmFsc2U7CgkgICAgICAgIGZvciAobGV0IGkgPSAwLCBqID0gcG9seWdvbi5sZW5ndGggLSAxOyBpIDwgcG9seWdvbi5sZW5ndGg7IGogPSBpKyspIHsKCSAgICAgICAgICAgIGlmICgocG9seWdvbltpXVt4SWR4XSA8PSBwdFt4SWR4XSAmJiBwdFt4SWR4XSA8IHBvbHlnb25bal1beElkeF0gfHwKCSAgICAgICAgICAgICAgICBwb2x5Z29uW2pdW3hJZHhdIDw9IHB0W3hJZHhdICYmIHB0W3hJZHhdIDwgcG9seWdvbltpXVt4SWR4XSkgJiYKCSAgICAgICAgICAgICAgICBwdFt5SWR4XSA8IChwb2x5Z29uW2pdW3lJZHhdIC0gcG9seWdvbltpXVt5SWR4XSkgKiAocHRbeElkeF0gLSBwb2x5Z29uW2ldW3hJZHhdKSAvIChwb2x5Z29uW2pdW3hJZHhdIC0gcG9seWdvbltpXVt4SWR4XSkgKyBwb2x5Z29uW2ldW3lJZHhdKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gIXJlc3VsdDsKCSAgICAgICAgICAgIH0KCgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoKCSAgICBjb25zdCBzdHJUb0Zsb2F0ID0gZWwgPT4gZWwgaW5zdGFuY2VvZiBBcnJheSA/IGVsLm1hcChzdHJUb0Zsb2F0KSA6IHBhcnNlRmxvYXQoZWwpOwoKCSAgICBjbGFzcyBSZWZFbGVtZW50cyBleHRlbmRzIE1hcCB7CgkgICAgICAgIGNvbnN0cnVjdG9yKCkgewoJICAgICAgICAgICAgc3VwZXIoKTsKCSAgICAgICAgICAgIHRoaXMuYmluZGVycyA9IFtdOwoJICAgICAgICB9CgoJICAgICAgICBhZGQoaywgdikgewoJICAgICAgICAgICAgaWYgKCF0aGlzLmhhcyhrKSkgewoJICAgICAgICAgICAgICAgIHRoaXMuc2V0KGssIHYpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gc3VwcHJlc3MgZHVwbGNhdGVkIGtleSBlcnJvcgoJICAgICAgICAgICAgLy8gZWxzZQoJICAgICAgICAgICAgLy8gdGhyb3cgYEVycm9yOiBhZGRpbmcgZHVwbGljYXRlZCBrZXkgJyR7a30nIHRvIFJlZkVsZW1lbnRzYDsKCSAgICAgICAgfQoKCSAgICAgICAgYWRkQmluZGVyKGJpbmRlcikgewoJICAgICAgICAgICAgdGhpcy5iaW5kZXJzLnB1c2goYmluZGVyKTsKCSAgICAgICAgfQoKCSAgICAgICAgYmluZEFsbCgpIHsKCSAgICAgICAgICAgIHRoaXMuYmluZGVycy5mb3JFYWNoKGJpbmRlciA9PiBiaW5kZXIuYmluZCgpKTsKCSAgICAgICAgfQoJICAgIH0KCgkgICAgY2xhc3MgTGF0ZUJpbmRlciB7CgkgICAgICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgdmFsdWVGdW5jLCBjdHgsIGFyZ3MpIHsKCSAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyOwoJICAgICAgICAgICAgdGhpcy52YWx1ZUZ1bmMgPSB2YWx1ZUZ1bmM7CgkgICAgICAgICAgICB0aGlzLmN0eCA9IGN0eDsKCSAgICAgICAgICAgIHRoaXMuYXJncyA9IGFyZ3M7CgkgICAgICAgIH0KCgkgICAgICAgIGJpbmQoKSB7CgkgICAgICAgICAgICBsZXQgdiA9IHRoaXMudmFsdWVGdW5jLmFwcGx5KHRoaXMuY3R4LCB0aGlzLmFyZ3MpOwoJICAgICAgICAgICAgaWYgKHRoaXMuY29udGFpbmVyIGluc3RhbmNlb2YgQXJyYXkpIHsKCSAgICAgICAgICAgICAgICBsZXQgaWR4ID0gdGhpcy5jb250YWluZXIuaW5kZXhPZih0aGlzKTsKCSAgICAgICAgICAgICAgICBpZiAoaWR4ID49IDApIHsKCSAgICAgICAgICAgICAgICAgICAgbGV0IGFyZ3MgPSBbaWR4LCAxXTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh2KTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBbXS5zcGxpY2UuYXBwbHkodGhpcy5jb250YWluZXIsIGFyZ3MpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoaXMuY29udGFpbmVyID09PSAnb2JqZWN0JykgewoJICAgICAgICAgICAgICAgIGxldCBrID0gT2JqZWN0LmtleXModGhpcy5jb250YWluZXIpLmZpbmQodiA9PiB0aGlzLmNvbnRhaW5lclt2XSA9PT0gdGhpcyk7CgkgICAgICAgICAgICAgICAgaWYgKGspIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyW2tdID0gdjsKCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNvbnRhaW5lcltrXTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCgkgICAgY2xhc3MgV2F5Q29sbGVjdGlvbiBleHRlbmRzIEFycmF5IHsKCSAgICAgICAgY29uc3RydWN0b3IoKSB7CgkgICAgICAgICAgICBzdXBlcigpOwoJICAgICAgICAgICAgdGhpcy5maXJzdE1hcCA9IHt9OwoJICAgICAgICAgICAgdGhpcy5sYXN0TWFwID0ge307CgkgICAgICAgIH0KCgkgICAgICAgIGFkZFdheSh3YXkpIHsKCSAgICAgICAgICAgIHdheSA9IHdheS50b0Nvb3Jkc0FycmF5KCk7CgkgICAgICAgICAgICBpZiAod2F5Lmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICB0aGlzLnB1c2god2F5KTsKCSAgICAgICAgICAgICAgICBhZGRUb01hcCh0aGlzLmZpcnN0TWFwLCBjb29yZHNUb0tleShmaXJzdCh3YXkpKSwgd2F5KTsKCSAgICAgICAgICAgICAgICBhZGRUb01hcCh0aGlzLmxhc3RNYXAsIGNvb3Jkc1RvS2V5KGxhc3Qod2F5KSksIHdheSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAgIHRvU3RyaW5ncygpIHsKCSAgICAgICAgICAgIGxldCBzdHJpbmdzID0gW10sIHdheSA9IG51bGw7CgkgICAgICAgICAgICB3aGlsZSAod2F5ID0gdGhpcy5zaGlmdCgpKSB7CgkgICAgICAgICAgICAgICAgcmVtb3ZlRnJvbU1hcCh0aGlzLmZpcnN0TWFwLCBjb29yZHNUb0tleShmaXJzdCh3YXkpKSwgd2F5KTsKCSAgICAgICAgICAgICAgICByZW1vdmVGcm9tTWFwKHRoaXMubGFzdE1hcCwgY29vcmRzVG9LZXkobGFzdCh3YXkpKSwgd2F5KTsKCSAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IHdheSwgbmV4dCA9IG51bGw7CgkgICAgICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gY29vcmRzVG9LZXkobGFzdChjdXJyZW50KSksIHNob3VsZFJldmVyc2UgPSBmYWxzZTsKCgkgICAgICAgICAgICAgICAgICAgIG5leHQgPSBnZXRGaXJzdEZyb21NYXAodGhpcy5maXJzdE1hcCwga2V5KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCFuZXh0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBuZXh0ID0gZ2V0Rmlyc3RGcm9tTWFwKHRoaXMubGFzdE1hcCwga2V5KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZFJldmVyc2UgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICBpZiAobmV4dCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpY2UodGhpcy5pbmRleE9mKG5leHQpLCAxKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZyb21NYXAodGhpcy5maXJzdE1hcCwgY29vcmRzVG9LZXkoZmlyc3QobmV4dCkpLCBuZXh0KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUZyb21NYXAodGhpcy5sYXN0TWFwLCBjb29yZHNUb0tleShsYXN0KG5leHQpKSwgbmV4dCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2hvdWxkUmV2ZXJzZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFsd2F5cyByZXZlcnNlIHNob3J0ZXIgb25lIHRvIHNhdmUgdGltZQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0Lmxlbmd0aCA+IGN1cnJlbnQubGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtjdXJyZW50LCBuZXh0XSA9IFtuZXh0LCBjdXJyZW50XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dC5yZXZlcnNlKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQuY29uY2F0KG5leHQuc2xpY2UoMSkpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSB3aGlsZSAobmV4dCk7CgkgICAgICAgICAgICAgICAgc3RyaW5ncy5wdXNoKHN0clRvRmxvYXQoY3VycmVudCkpOwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIHJldHVybiBzdHJpbmdzOwoJICAgICAgICB9CgoJICAgICAgICB0b1JpbmdzKGRpcmVjdGlvbikgewoJICAgICAgICAgICAgbGV0IHN0cmluZ3MgPSB0aGlzLnRvU3RyaW5ncygpOwoJICAgICAgICAgICAgbGV0IHJpbmdzID0gW10sIHN0cmluZyA9IG51bGw7CgkgICAgICAgICAgICB3aGlsZSAoc3RyaW5nID0gc3RyaW5ncy5zaGlmdCgpKSB7CgkgICAgICAgICAgICAgICAgaWYgKGlzUmluZyhzdHJpbmcpKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyaW5nRGlyZWN0aW9uKHN0cmluZykgIT09IGRpcmVjdGlvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nLnJldmVyc2UoKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByaW5ncy5wdXNoKHN0cmluZyk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIHJpbmdzOwoJICAgICAgICB9CgkgICAgfQoKCSAgICByZXR1cm4gewoJICAgICAgICBwdXJnZVByb3BzLCBtZXJnZVByb3BzLAoJICAgICAgICBmaXJzdCwgbGFzdCwgY29vcmRzVG9LZXksCgkgICAgICAgIGFkZFRvTWFwLCByZW1vdmVGcm9tTWFwLCBnZXRGaXJzdEZyb21NYXAsCgkgICAgICAgIGlzUmluZywgcmluZ0RpcmVjdGlvbiwgcHRJbnNpZGVQb2x5Z29uLCBzdHJUb0Zsb2F0LAoJICAgICAgICBSZWZFbGVtZW50cywgTGF0ZUJpbmRlciwgV2F5Q29sbGVjdGlvbgoJICAgIH07Cgl9KSgpOwoKCXZhciBidWlsZGluZyA9IHsKCX07Cgl2YXIgaGlnaHdheSA9IHsKCQl3aGl0ZWxpc3Q6IFsKCQkJInNlcnZpY2VzIiwKCQkJInJlc3RfYXJlYSIsCgkJCSJlc2NhcGUiLAoJCQkiZWxldmF0b3IiCgkJXQoJfTsKCXZhciBuYXR1cmFsID0gewoJCWJsYWNrbGlzdDogWwoJCQkiY29hc3RsaW5lIiwKCQkJImNsaWZmIiwKCQkJInJpZGdlIiwKCQkJImFyZXRlIiwKCQkJInRyZWVfcm93IgoJCV0KCX07Cgl2YXIgbGFuZHVzZSA9IHsKCX07Cgl2YXIgd2F0ZXJ3YXkgPSB7CgkJd2hpdGVsaXN0OiBbCgkJCSJyaXZlcmJhbmsiLAoJCQkiZG9jayIsCgkJCSJib2F0eWFyZCIsCgkJCSJkYW0iCgkJXQoJfTsKCXZhciBhbWVuaXR5ID0gewoJfTsKCXZhciBsZWlzdXJlID0gewoJfTsKCXZhciBiYXJyaWVyID0gewoJCXdoaXRlbGlzdDogWwoJCQkiY2l0eV93YWxsIiwKCQkJImRpdGNoIiwKCQkJImhlZGdlIiwKCQkJInJldGFpbmluZ193YWxsIiwKCQkJIndhbGwiLAoJCQkic3Bpa2VzIgoJCV0KCX07Cgl2YXIgcmFpbHdheSA9IHsKCQl3aGl0ZWxpc3Q6IFsKCQkJInN0YXRpb24iLAoJCQkidHVybnRhYmxlIiwKCQkJInJvdW5kaG91c2UiLAoJCQkicGxhdGZvcm0iCgkJXQoJfTsKCXZhciBhcmVhID0gewoJfTsKCXZhciBib3VuZGFyeSA9IHsKCX07Cgl2YXIgbWFuX21hZGUgPSB7CgkJYmxhY2tsaXN0OiBbCgkJCSJjdXRsaW5lIiwKCQkJImVtYmFua21lbnQiLAoJCQkicGlwZWxpbmUiCgkJXQoJfTsKCXZhciBwb3dlciA9IHsKCQl3aGl0ZWxpc3Q6IFsKCQkJInBsYW50IiwKCQkJInN1YnN0YXRpb24iLAoJCQkiZ2VuZXJhdG9yIiwKCQkJInRyYW5zZm9ybWVyIgoJCV0KCX07Cgl2YXIgcGxhY2UgPSB7Cgl9OwoJdmFyIHNob3AgPSB7Cgl9OwoJdmFyIGFlcm93YXkgPSB7CgkJYmxhY2tsaXN0OiBbCgkJCSJ0YXhpd2F5IgoJCV0KCX07Cgl2YXIgdG91cmlzbSA9IHsKCX07Cgl2YXIgaGlzdG9yaWMgPSB7Cgl9OwoJdmFyIHB1YmxpY190cmFuc3BvcnQgPSB7Cgl9OwoJdmFyIG9mZmljZSA9IHsKCX07Cgl2YXIgbWlsaXRhcnkgPSB7Cgl9OwoJdmFyIHJ1aW5zID0gewoJfTsKCXZhciBjcmFmdCA9IHsKCX07Cgl2YXIgZ29sZiA9IHsKCX07Cgl2YXIgaW5kb29yID0gewoJfTsKCXZhciByZXF1aXJlJCQxID0gewoJCWJ1aWxkaW5nOiBidWlsZGluZywKCQloaWdod2F5OiBoaWdod2F5LAoJCW5hdHVyYWw6IG5hdHVyYWwsCgkJbGFuZHVzZTogbGFuZHVzZSwKCQl3YXRlcndheTogd2F0ZXJ3YXksCgkJYW1lbml0eTogYW1lbml0eSwKCQlsZWlzdXJlOiBsZWlzdXJlLAoJCWJhcnJpZXI6IGJhcnJpZXIsCgkJcmFpbHdheTogcmFpbHdheSwKCQlhcmVhOiBhcmVhLAoJCWJvdW5kYXJ5OiBib3VuZGFyeSwKCQltYW5fbWFkZTogbWFuX21hZGUsCgkJcG93ZXI6IHBvd2VyLAoJCXBsYWNlOiBwbGFjZSwKCQlzaG9wOiBzaG9wLAoJCWFlcm93YXk6IGFlcm93YXksCgkJdG91cmlzbTogdG91cmlzbSwKCQloaXN0b3JpYzogaGlzdG9yaWMsCgkJcHVibGljX3RyYW5zcG9ydDogcHVibGljX3RyYW5zcG9ydCwKCQlvZmZpY2U6IG9mZmljZSwKCQkiYnVpbGRpbmc6cGFydCI6IHsKCX0sCgkJbWlsaXRhcnk6IG1pbGl0YXJ5LAoJCXJ1aW5zOiBydWlucywKCQkiYXJlYTpoaWdod2F5IjogewoJfSwKCQljcmFmdDogY3JhZnQsCgkJZ29sZjogZ29sZiwKCQlpbmRvb3I6IGluZG9vcgoJfTsKCgl2YXIgb3Ntb2JqcyA9ICgoKSA9PiB7CgoJICAgIGNvbnN0IHsgZmlyc3QsIGxhc3QsIGNvb3Jkc1RvS2V5LAoJICAgICAgICBhZGRUb01hcCwgcmVtb3ZlRnJvbU1hcCwgZ2V0Rmlyc3RGcm9tTWFwLAoJICAgICAgICBpc1JpbmcsIHJpbmdEaXJlY3Rpb24sIHB0SW5zaWRlUG9seWdvbiwgc3RyVG9GbG9hdCwKCSAgICAgICAgTGF0ZUJpbmRlciwgV2F5Q29sbGVjdGlvbiB9ID0gdXRpbHMsCgkgICAgICAgIHBvbHlnb25UYWdzID0gcmVxdWlyZSQkMTsKCgkgICAgY2xhc3MgT3NtT2JqZWN0IHsKCSAgICAgICAgY29uc3RydWN0b3IodHlwZSwgaWQsIHJlZkVsZW1zKSB7CgkgICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlOwoJICAgICAgICAgICAgdGhpcy5pZCA9IGlkOwoJICAgICAgICAgICAgdGhpcy5yZWZFbGVtcyA9IHJlZkVsZW1zOwoJICAgICAgICAgICAgdGhpcy50YWdzID0ge307CgkgICAgICAgICAgICB0aGlzLnByb3BzID0geyBpZDogdGhpcy5nZXRDb21wb3NpdGVJZCgpIH07CgkgICAgICAgICAgICB0aGlzLnJlZkNvdW50ID0gMDsKCSAgICAgICAgICAgIHRoaXMuaGFzVGFnID0gZmFsc2U7CgkgICAgICAgICAgICBpZiAocmVmRWxlbXMpIHsKCSAgICAgICAgICAgICAgICByZWZFbGVtcy5hZGQodGhpcy5nZXRDb21wb3NpdGVJZCgpLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgYWRkVGFncyh0YWdzKSB7CgkgICAgICAgICAgICB0aGlzLnRhZ3MgPSBPYmplY3QuYXNzaWduKHRoaXMudGFncywgdGFncyk7CgkgICAgICAgICAgICB0aGlzLmhhc1RhZyA9IHRhZ3MgPyB0cnVlIDogZmFsc2U7CgkgICAgICAgIH0KCgkgICAgICAgIGFkZFRhZyhrLCB2KSB7CgkgICAgICAgICAgICB0aGlzLnRhZ3Nba10gPSB2OwoJICAgICAgICAgICAgdGhpcy5oYXNUYWcgPSBrID8gdHJ1ZSA6IGZhbHNlOwoJICAgICAgICB9CgoJICAgICAgICBhZGRQcm9wKGssIHYpIHsKCSAgICAgICAgICAgIHRoaXMucHJvcHNba10gPSB2OwoJICAgICAgICB9CgoJICAgICAgICBhZGRQcm9wcyhwcm9wcykgewoJICAgICAgICAgICAgdGhpcy5wcm9wcyA9IE9iamVjdC5hc3NpZ24odGhpcy5wcm9wcywgcHJvcHMpOwoJICAgICAgICB9CgoJICAgICAgICBnZXRDb21wb3NpdGVJZCgpIHsKCSAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLnR5cGV9LyR7dGhpcy5pZH1gOwoJICAgICAgICB9CgoJICAgICAgICBnZXRQcm9wcygpIHsKCSAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHRoaXMucHJvcHMsIHRoaXMudGFncyk7CgkgICAgICAgIH0KCgkgICAgICAgIHRvRmVhdHVyZUFycmF5KCkgewoJICAgICAgICAgICAgcmV0dXJuIFtdOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBjbGFzcyBOb2RlIGV4dGVuZHMgT3NtT2JqZWN0IHsKCSAgICAgICAgY29uc3RydWN0b3IoaWQsIHJlZkVsZW1zKSB7CgkgICAgICAgICAgICBzdXBlcignbm9kZScsIGlkLCByZWZFbGVtcyk7CgkgICAgICAgICAgICB0aGlzLmxhdExuZyA9IG51bGw7CgkgICAgICAgIH0KCgkgICAgICAgIHNldExhdExuZyhsYXRMbmcpIHsKCSAgICAgICAgICAgIHRoaXMubGF0TG5nID0gbGF0TG5nOwoJICAgICAgICB9CgoJICAgICAgICB0b0ZlYXR1cmVBcnJheSgpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLmxhdExuZykgewoJICAgICAgICAgICAgICAgIHJldHVybiBbewoJICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCgkgICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLmdldENvbXBvc2l0ZUlkKCksCgkgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHRoaXMuZ2V0UHJvcHMoKSwKCSAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnk6IHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogc3RyVG9GbG9hdChbdGhpcy5sYXRMbmcubG9uLCB0aGlzLmxhdExuZy5sYXRdKQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfV07CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmV0dXJuIFtdOwoJICAgICAgICB9CgoJICAgICAgICBnZXRMYXRMbmcoKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sYXRMbmc7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGNsYXNzIFdheSBleHRlbmRzIE9zbU9iamVjdCB7CgkgICAgICAgIGNvbnN0cnVjdG9yKGlkLCByZWZFbGVtcykgewoJICAgICAgICAgICAgc3VwZXIoJ3dheScsIGlkLCByZWZFbGVtcyk7CgkgICAgICAgICAgICB0aGlzLmxhdExuZ0FycmF5ID0gW107CgkgICAgICAgICAgICB0aGlzLmlzUG9seWdvbiA9IGZhbHNlOwoJICAgICAgICB9CgoJICAgICAgICBhZGRMYXRMbmcobGF0TG5nKSB7CgkgICAgICAgICAgICB0aGlzLmxhdExuZ0FycmF5LnB1c2gobGF0TG5nKTsKCSAgICAgICAgfQoKCSAgICAgICAgc2V0TGF0TG5nQXJyYXkobGF0TG5nQXJyYXkpIHsKCSAgICAgICAgICAgIHRoaXMubGF0TG5nQXJyYXkgPSBsYXRMbmdBcnJheTsKCSAgICAgICAgfQoKCSAgICAgICAgYWRkTm9kZVJlZihyZWYpIHsKCSAgICAgICAgICAgIGxldCBiaW5kZXIgPSBuZXcgTGF0ZUJpbmRlcih0aGlzLmxhdExuZ0FycmF5LCBmdW5jdGlvbiAoaWQpIHsKCSAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IHRoaXMucmVmRWxlbXMuZ2V0KGBub2RlLyR7aWR9YCk7CgkgICAgICAgICAgICAgICAgaWYgKG5vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgbm9kZS5yZWZDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5nZXRMYXRMbmcoKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9LCB0aGlzLCBbcmVmXSk7CgoJICAgICAgICAgICAgdGhpcy5sYXRMbmdBcnJheS5wdXNoKGJpbmRlcik7CgkgICAgICAgICAgICB0aGlzLnJlZkVsZW1zLmFkZEJpbmRlcihiaW5kZXIpOwoJICAgICAgICB9CgoJICAgICAgICBhbmFseXplR2VvbWV0cnlUeXBlKGssIHYpIHsKCSAgICAgICAgICAgIGxldCBvID0gcG9seWdvblRhZ3Nba107CgkgICAgICAgICAgICBpZiAobykgewoJICAgICAgICAgICAgICAgIHRoaXMuaXNQb2x5Z29uID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICBpZiAoby53aGl0ZWxpc3QpIHsKCSAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1BvbHlnb24gPSBvLndoaXRlbGlzdC5pbmRleE9mKHYpID49IDAgPyB0cnVlIDogZmFsc2U7CgkgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvLmJsYWNrbGlzdCkgewoJICAgICAgICAgICAgICAgICAgICB0aGlzLmlzUG9seWdvbiA9IG8uYmxhY2tsaXN0LmluZGV4T2YodikgPj0gMCA/IGZhbHNlIDogdHJ1ZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAgIGFkZFRhZ3ModGFncykgewoJICAgICAgICAgICAgc3VwZXIuYWRkVGFncyh0YWdzKTsKCSAgICAgICAgICAgIGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyh0YWdzKSkgewoJICAgICAgICAgICAgICAgIHRoaXMuYW5hbHl6ZUdlb21ldHJ5VHlwZShrLCB2KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgYWRkVGFnKGssIHYpIHsKCSAgICAgICAgICAgIHN1cGVyLmFkZFRhZyhrLCB2KTsKCSAgICAgICAgICAgIHRoaXMuYW5hbHl6ZUdlb21ldHJ5VHlwZShrLCB2KTsKCSAgICAgICAgfQoKCSAgICAgICAgdG9Db29yZHNBcnJheSgpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmxhdExuZ0FycmF5Lm1hcChsYXRMbmcgPT4gW2xhdExuZy5sb24sIGxhdExuZy5sYXRdKTsKCSAgICAgICAgfQoKCSAgICAgICAgdG9GZWF0dXJlQXJyYXkoKSB7CgkgICAgICAgICAgICBsZXQgY29vcmRzQXJyYXkgPSB0aGlzLnRvQ29vcmRzQXJyYXkoKTsKCSAgICAgICAgICAgIGlmIChjb29yZHNBcnJheS5sZW5ndGggPiAxKSB7CgkgICAgICAgICAgICAgICAgY29vcmRzQXJyYXkgPSBzdHJUb0Zsb2F0KGNvb3Jkc0FycmF5KTsKCSAgICAgICAgICAgICAgICBsZXQgZmVhdHVyZSA9IHsKCSAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLAoJICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5nZXRDb21wb3NpdGVJZCgpLAoJICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB0aGlzLmdldFByb3BzKCksCgkgICAgICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTGluZVN0cmluZycsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogY29vcmRzQXJyYXkKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH07CgoJICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUG9seWdvbiAmJiBpc1JpbmcoY29vcmRzQXJyYXkpKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyaW5nRGlyZWN0aW9uKGNvb3Jkc0FycmF5KSAhPT0gJ2NvdW50ZXJjbG9ja3dpc2UnKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZHNBcnJheS5yZXZlcnNlKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIGZlYXR1cmUuZ2VvbWV0cnkgPSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnUG9seWdvbicsCgkgICAgICAgICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogW2Nvb3Jkc0FycmF5XQoJICAgICAgICAgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtmZWF0dXJlXTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIHJldHVybiBbZmVhdHVyZV07CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmV0dXJuIFtdOwoJICAgICAgICB9CgkgICAgfQoKCSAgICBjbGFzcyBSZWxhdGlvbiBleHRlbmRzIE9zbU9iamVjdCB7CgkgICAgICAgIGNvbnN0cnVjdG9yKGlkLCByZWZFbGVtcykgewoJICAgICAgICAgICAgc3VwZXIoJ3JlbGF0aW9uJywgaWQsIHJlZkVsZW1zKTsKCSAgICAgICAgICAgIHRoaXMucmVsYXRpb25zID0gW107CgkgICAgICAgICAgICB0aGlzLm5vZGVzID0gW107CgkgICAgICAgICAgICB0aGlzLmJvdW5kcyA9IG51bGw7CgkgICAgICAgIH0KCgkgICAgICAgIHNldEJvdW5kcyhib3VuZHMpIHsKCSAgICAgICAgICAgIHRoaXMuYm91bmRzID0gYm91bmRzOwoJICAgICAgICB9CgoJICAgICAgICBhZGRNZW1iZXIobWVtYmVyKSB7CgkgICAgICAgICAgICBzd2l0Y2ggKG1lbWJlci50eXBlKSB7CgkgICAgICAgICAgICAgICAgLy8gc3VwZXIgcmVsYXRpb24sIG5lZWQgdG8gZG8gY29tYmluYXRpb24KCSAgICAgICAgICAgICAgICBjYXNlICdyZWxhdGlvbic6CgkgICAgICAgICAgICAgICAgICAgIGxldCBiaW5kZXIgPSBuZXcgTGF0ZUJpbmRlcih0aGlzLnJlbGF0aW9ucywgZnVuY3Rpb24gKGlkKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVsYXRpb24gPSB0aGlzLnJlZkVsZW1zLmdldChgcmVsYXRpb24vJHtpZH1gKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxhdGlvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uLnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlbGF0aW9uOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLCBbbWVtYmVyLnJlZl0pOwoJICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbGF0aW9ucy5wdXNoKGJpbmRlcik7CgkgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRWxlbXMuYWRkQmluZGVyKGJpbmRlcik7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKCSAgICAgICAgICAgICAgICBjYXNlICd3YXknOgoJICAgICAgICAgICAgICAgICAgICBpZiAoIW1lbWJlci5yb2xlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIucm9sZSA9ICcnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGxldCB3YXlzID0gdGhpc1ttZW1iZXIucm9sZV07CgkgICAgICAgICAgICAgICAgICAgIGlmICghd2F5cykgewoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5cyA9IHRoaXNbbWVtYmVyLnJvbGVdID0gW107CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgaWYgKG1lbWJlci5nZW9tZXRyeSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdheSA9IG5ldyBXYXkobWVtYmVyLnJlZiwgdGhpcy5yZWZFbGVtcyk7CgkgICAgICAgICAgICAgICAgICAgICAgICB3YXkuc2V0TGF0TG5nQXJyYXkobWVtYmVyLmdlb21ldHJ5KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdheS5yZWZDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5cy5wdXNoKHdheSk7CgkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWVtYmVyLm5vZGVzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBsZXQgd2F5ID0gbmV3IFdheShtZW1iZXIucmVmLCB0aGlzLnJlZkVsZW1zKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG5pZCBvZiBtZW1iZXIubm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXkuYWRkTm9kZVJlZihuaWQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5LnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICB3YXlzLnB1c2god2F5KTsKCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGxldCBiaW5kZXIgPSBuZXcgTGF0ZUJpbmRlcih3YXlzLCBmdW5jdGlvbiAoaWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgd2F5ID0gdGhpcy5yZWZFbGVtcy5nZXQoYHdheS8ke2lkfWApOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3YXkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F5LnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3YXk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcywgW21lbWJlci5yZWZdKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdheXMucHVzaChiaW5kZXIpOwoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZFbGVtcy5hZGRCaW5kZXIoYmluZGVyKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCgkgICAgICAgICAgICAgICAgY2FzZSAnbm9kZSc6CgkgICAgICAgICAgICAgICAgICAgIGxldCBub2RlID0gbnVsbDsKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1lbWJlci5sYXQgJiYgbWVtYmVyLmxvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZSA9IG5ldyBOb2RlKG1lbWJlci5yZWYsIHRoaXMucmVmRWxlbXMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5zZXRMYXRMbmcoeyBsb246IG1lbWJlci5sb24sIGxhdDogbWVtYmVyLmxhdCB9KTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZW1iZXIudGFncykgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYWRkVGFncyhtZW1iZXIudGFncyk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMobWVtYmVyKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChbJ2lkJywgJ3R5cGUnLCAnbGF0JywgJ2xvbiddLmluZGV4T2YoaykgPCAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuYWRkUHJvcChrLCB2KTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5yZWZDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2Rlcy5wdXNoKG5vZGUpOwoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJpbmRlciA9IG5ldyBMYXRlQmluZGVyKHRoaXMubm9kZXMsIGZ1bmN0aW9uIChpZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBub2RlID0gdGhpcy5yZWZFbGVtcy5nZXQoYG5vZGUvJHtpZH1gKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm9kZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLnJlZkNvdW50Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMsIFttZW1iZXIucmVmXSk7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGVzLnB1c2goYmluZGVyKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmRWxlbXMuYWRkQmluZGVyKGJpbmRlcik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCgkgICAgICAgIHRvRmVhdHVyZUFycmF5KCkgewoJICAgICAgICAgICAgY29uc3QgY29uc3RydWN0U3RyaW5nR2VvbWV0cnkgPSAod3MpID0+IHsKCSAgICAgICAgICAgICAgICBsZXQgc3RyaW5ncyA9IHdzID8gd3MudG9TdHJpbmdzKCkgOiBbXTsKCSAgICAgICAgICAgICAgICBpZiAoc3RyaW5ncy5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChzdHJpbmdzLmxlbmd0aCA9PT0gMSkgcmV0dXJuIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJywKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBzdHJpbmdzWzBdCgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTXVsdGlMaW5lU3RyaW5nJywKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBzdHJpbmdzCgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgIGNvbnN0IGNvbnN0cnVjdFBvbHlnb25HZW9tZXRyeSA9IChvd3MsIGl3cykgPT4gewoJICAgICAgICAgICAgICAgIGxldCBvdXRlclJpbmdzID0gb3dzID8gb3dzLnRvUmluZ3MoJ2NvdW50ZXJjbG9ja3dpc2UnKSA6IFtdLAoJICAgICAgICAgICAgICAgICAgICBpbm5lclJpbmdzID0gaXdzID8gaXdzLnRvUmluZ3MoJ2Nsb2Nrd2lzZScpIDogW107CgoJICAgICAgICAgICAgICAgIGlmIChvdXRlclJpbmdzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICAgICAgbGV0IGNvbXBvc2l0UG9seW9ucyA9IFtdOwoKCSAgICAgICAgICAgICAgICAgICAgbGV0IHJpbmcgPSBudWxsOwoJICAgICAgICAgICAgICAgICAgICBmb3IgKHJpbmcgb2Ygb3V0ZXJSaW5ncykKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0UG9seW9ucy5wdXNoKFtyaW5nXSk7CgoJICAgICAgICAgICAgICAgICAgICAvLyBsaW5rIGlubmVyIHBvbHlnb25zIHRvIG91dGVyIGNvbnRhaW5lcnMKCSAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHJpbmcgPSBpbm5lclJpbmdzLnNoaWZ0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGlkeCBpbiBvdXRlclJpbmdzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHB0SW5zaWRlUG9seWdvbihmaXJzdChyaW5nKSwgb3V0ZXJSaW5nc1tpZHhdKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb3NpdFBvbHlvbnNbaWR4XS5wdXNoKHJpbmcpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIC8vIGNvbnN0cnVjdCB0aGUgUG9seWdvbi9NdWx0aVBvbHlnb24gZ2VvbWV0cnkKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvc2l0UG9seW9ucy5sZW5ndGggPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BvbHlnb24nLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBjb21wb3NpdFBvbHlvbnNbMF0KCSAgICAgICAgICAgICAgICAgICAgICAgIH07CgkgICAgICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTXVsdGlQb2x5Z29uJywKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBjb21wb3NpdFBvbHlvbnMKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgIGxldCBwb2x5Z29uRmVhdHVyZXMgPSBbXSwgc3RyaW5nRmVhdHVyZXMgPSBbXSwgcG9pbnRGZWF0dXJlcyA9IFtdOwoJICAgICAgICAgICAgY29uc3Qgd2F5c0ZpZWxkTmFtZXMgPSBbJ291dGVyJywgJ2lubmVyJywgJyddOwoJICAgICAgICAgICAgLy8gbmVlZCB0byBkbyBjb21iaW5hdGlvbiB3aGVuIHRoZXJlJ3JlIG5lc3RlZCByZWxhdGlvbnMKCSAgICAgICAgICAgIGZvciAobGV0IHJlbGF0aW9uIG9mIHRoaXMucmVsYXRpb25zKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlbGF0aW9uKSB7CgkgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGZpZWxkTmFtZSBvZiB3YXlzRmllbGROYW1lcykgewoJICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdheXMgPSByZWxhdGlvbltmaWVsZE5hbWVdOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdheXMpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGhpc1dheXMgPSB0aGlzW2ZpZWxkTmFtZV07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNXYXlzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtdLnNwbGljZS5hcHBseSh0aGlzV2F5cywgW3RoaXNXYXlzLmxlbmd0aCwgMF0uY29uY2F0KHdheXMpKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2ZpZWxkTmFtZV0gPSB3YXlzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICBmb3IgKGxldCBmaWVsZE5hbWUgb2Ygd2F5c0ZpZWxkTmFtZXMpIHsKCSAgICAgICAgICAgICAgICBsZXQgd2F5cyA9IHRoaXNbZmllbGROYW1lXTsKCSAgICAgICAgICAgICAgICBpZiAod2F5cykgewoJICAgICAgICAgICAgICAgICAgICB0aGlzW2ZpZWxkTmFtZV0gPSBuZXcgV2F5Q29sbGVjdGlvbigpOwoJICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB3YXkgb2Ygd2F5cykgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tmaWVsZE5hbWVdLmFkZFdheSh3YXkpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIGxldCBnZW9tZXRyeSA9IG51bGw7CgoJICAgICAgICAgICAgbGV0IGZlYXR1cmUgPSB7CgkgICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLAoJICAgICAgICAgICAgICAgIGlkOiB0aGlzLmdldENvbXBvc2l0ZUlkKCksCgkgICAgICAgICAgICAgICAgYmJveDogdGhpcy5ib3VuZHMsCgkgICAgICAgICAgICAgICAgcHJvcGVydGllczogdGhpcy5nZXRQcm9wcygpCgkgICAgICAgICAgICB9OwoKCSAgICAgICAgICAgIGlmICghdGhpcy5ib3VuZHMpIHsKCSAgICAgICAgICAgICAgICBkZWxldGUgZmVhdHVyZS5iYm94OwoJICAgICAgICAgICAgfQoKCSAgICAgICAgICAgIGlmICh0aGlzLm91dGVyKSB7CgkgICAgICAgICAgICAgICAgZ2VvbWV0cnkgPSBjb25zdHJ1Y3RQb2x5Z29uR2VvbWV0cnkodGhpcy5vdXRlciwgdGhpcy5pbm5lcik7CgkgICAgICAgICAgICAgICAgaWYgKGdlb21ldHJ5KSB7CgkgICAgICAgICAgICAgICAgICAgIGZlYXR1cmUuZ2VvbWV0cnkgPSBnZW9tZXRyeTsKCSAgICAgICAgICAgICAgICAgICAgcG9seWdvbkZlYXR1cmVzLnB1c2goZmVhdHVyZSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAodGhpc1snJ10pIHsKCSAgICAgICAgICAgICAgICBnZW9tZXRyeSA9IGNvbnN0cnVjdFN0cmluZ0dlb21ldHJ5KHRoaXNbJyddKTsKCSAgICAgICAgICAgICAgICBpZiAoZ2VvbWV0cnkpIHsKCSAgICAgICAgICAgICAgICAgICAgZmVhdHVyZS5nZW9tZXRyeSA9IGdlb21ldHJ5OwoJICAgICAgICAgICAgICAgICAgICBzdHJpbmdGZWF0dXJlcy5wdXNoKGZlYXR1cmUpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICBmb3IgKGxldCBub2RlIG9mIHRoaXMubm9kZXMpIHsKCSAgICAgICAgICAgICAgICBwb2ludEZlYXR1cmVzID0gcG9pbnRGZWF0dXJlcy5jb25jYXQobm9kZS50b0ZlYXR1cmVBcnJheSgpKTsKCSAgICAgICAgICAgIH0KCgkgICAgICAgICAgICByZXR1cm4gcG9seWdvbkZlYXR1cmVzLmNvbmNhdChzdHJpbmdGZWF0dXJlcykuY29uY2F0KHBvaW50RmVhdHVyZXMpOwoJICAgICAgICB9CgkgICAgfQoKCSAgICByZXR1cm4geyBOb2RlLCBXYXksIFJlbGF0aW9uIH07Cgl9KSgpOwoKCXZhciB4bWxwYXJzZXIgPSAoKCkgPT4gewoKCSAgICBmdW5jdGlvbiBjb25kaXRpb25lZChldnQpIHsKCSAgICAgICAgcmV0dXJuIGV2dC5tYXRjaCgvXiguKz8pXFsoLis/KVxdPiQvZykgIT0gbnVsbDsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIHBhcnNlRXZlbnQoZXZ0KSB7CgkgICAgICAgIGxldCBtYXRjaCA9IC9eKC4rPylcWyguKz8pXF0+JC9nLmV4ZWMoZXZ0KTsKCSAgICAgICAgaWYgKG1hdGNoKSB7CgkgICAgICAgICAgICByZXR1cm4geyBldnQ6IG1hdGNoWzFdICsgJz4nLCBleHA6IG1hdGNoWzJdIH07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHsgZXZ0OiBldnQgfTsKCSAgICB9CgoJICAgIGZ1bmN0aW9uIGdlbkNvbmRpdGlvbkZ1bmMoY29uZCkgewoJICAgICAgICBsZXQgYm9keSA9ICdyZXR1cm4gJyArIGNvbmQucmVwbGFjZSgvKFwkLis/KSg/PVs9IS5dKS9nLCAnbm9kZS4kJicpICsgJzsnOwoJICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCdub2RlJywgYm9keSk7CgkgICAgfQoKCSAgICByZXR1cm4gY2xhc3MgewoJICAgICAgICBjb25zdHJ1Y3RvcihvcHRzKSB7CgkgICAgICAgICAgICBpZiAob3B0cykgewoJICAgICAgICAgICAgICAgIHRoaXMucXVlcnlQYXJlbnQgPSBvcHRzLnF1ZXJ5UGFyZW50ID8gdHJ1ZSA6IGZhbHNlOwoJICAgICAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NpdmUgPSBvcHRzLnByb2dyZXNzaXZlOwoJICAgICAgICAgICAgICAgIGlmICh0aGlzLnF1ZXJ5UGFyZW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50TWFwID0gbmV3IFdlYWtNYXAoKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aGlzLmV2dExpc3RlbmVycyA9IHt9OwoJICAgICAgICB9CgoJICAgICAgICBwYXJzZSh4bWwsIHBhcmVudCwgZGlyKSB7CgkgICAgICAgICAgICBkaXIgPSBkaXIgPyBkaXIgKyAnLicgOiAnJzsKCSAgICAgICAgICAgIGxldCBub2RlUmVnRXggPSAvPChbXiA+XC9dKykoLio/KT4vbWcsIG5vZGVNYXRjaCA9IG51bGwsIG5vZGVzID0gW107CgkgICAgICAgICAgICB3aGlsZSAobm9kZU1hdGNoID0gbm9kZVJlZ0V4LmV4ZWMoeG1sKSkgewoJICAgICAgICAgICAgICAgIGxldCB0YWcgPSBub2RlTWF0Y2hbMV0sIG5vZGUgPSB7ICR0YWc6IHRhZyB9LCBmdWxsVGFnID0gZGlyICsgdGFnOwoKCSAgICAgICAgICAgICAgICBsZXQgYXR0clRleHQgPSBub2RlTWF0Y2hbMl0udHJpbSgpLCBjbG9zZWQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICBpZiAoYXR0clRleHQuZW5kc1dpdGgoJy8nKSB8fCB0YWcuc3RhcnRzV2l0aCgnPycpIHx8IHRhZy5zdGFydHNXaXRoKCchJykpIHsKCSAgICAgICAgICAgICAgICAgICAgY2xvc2VkID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIGxldCBhdHRSZWdFeDEgPSAvKFteIF0rPyk9IiguKz8pIi9nLCBhdHRSZWdFeDIgPSAvKFteIF0rPyk9JyguKz8pJy9nOwoJICAgICAgICAgICAgICAgIGxldCBhdHRNYXRjaCA9IG51bGwsIGhhc0F0dHJzID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgd2hpbGUgKGF0dE1hdGNoID0gYXR0UmVnRXgxLmV4ZWMoYXR0clRleHQpKSB7CgkgICAgICAgICAgICAgICAgICAgIGhhc0F0dHJzID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgbm9kZVthdHRNYXRjaFsxXV0gPSBhdHRNYXRjaFsyXTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFoYXNBdHRycykKCSAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGF0dE1hdGNoID0gYXR0UmVnRXgyLmV4ZWMoYXR0clRleHQpKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBoYXNBdHRycyA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICBub2RlW2F0dE1hdGNoWzFdXSA9IGF0dE1hdGNoWzJdOwoJICAgICAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIGlmICghaGFzQXR0cnMgJiYgYXR0clRleHQgIT09ICcnKSB7CgkgICAgICAgICAgICAgICAgICAgIG5vZGUudGV4dCA9IGF0dHJUZXh0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9ncmVzc2l2ZSkgewoJICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoYDwke2Z1bGxUYWd9PmAsIG5vZGUsIHBhcmVudCk7CgkgICAgICAgICAgICAgICAgfQoKCSAgICAgICAgICAgICAgICBpZiAoIWNsb3NlZCkgewoJICAgICAgICAgICAgICAgICAgICBsZXQgaW5uZXJSZWdFeCA9IG5ldyBSZWdFeHAoYChbXl0rPyk8XC8ke3RhZ30+YCwgJ2cnKTsKCSAgICAgICAgICAgICAgICAgICAgaW5uZXJSZWdFeC5sYXN0SW5kZXggPSBub2RlUmVnRXgubGFzdEluZGV4OwoJICAgICAgICAgICAgICAgICAgICBsZXQgaW5uZXJNYXRjaCA9IGlubmVyUmVnRXguZXhlYyh4bWwpOwoJICAgICAgICAgICAgICAgICAgICBpZiAoaW5uZXJNYXRjaCAmJiBpbm5lck1hdGNoWzFdKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBub2RlUmVnRXgubGFzdEluZGV4ID0gaW5uZXJSZWdFeC5sYXN0SW5kZXg7CgkgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5uZXJOb2RlcyA9IHRoaXMucGFyc2UoaW5uZXJNYXRjaFsxXSwgbm9kZSwgZnVsbFRhZyk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5uZXJOb2Rlcy5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS4kaW5uZXJOb2RlcyA9IGlubmVyTm9kZXM7CgkgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUuJGlubmVyVGV4dCA9IGlubmVyTWF0Y2hbMV07CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlcnlQYXJlbnQgJiYgcGFyZW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50TWFwLnNldChub2RlLCBwYXJlbnQpOwoJICAgICAgICAgICAgICAgIH0KCgkgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NpdmUpIHsKCSAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KGA8LyR7ZnVsbFRhZ30+YCwgbm9kZSwgcGFyZW50KTsKCSAgICAgICAgICAgICAgICB9CgoJICAgICAgICAgICAgICAgIG5vZGVzLnB1c2gobm9kZSk7CgkgICAgICAgICAgICB9CgoJICAgICAgICAgICAgcmV0dXJuIG5vZGVzOwoJICAgICAgICB9CgoJICAgICAgICBnZXRQYXJlbnQobm9kZSkgewoJICAgICAgICAgICAgaWYgKHRoaXMucXVlcnlQYXJlbnQpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnRNYXAuZ2V0KG5vZGUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCgkgICAgICAgICNhZGRMaXN0ZW5lcihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIGxldCBmdW5jcyA9IHRoaXMuZXZ0TGlzdGVuZXJzW2V2dF07CgkgICAgICAgICAgICBpZiAoZnVuY3MpIHsKCSAgICAgICAgICAgICAgICBmdW5jcy5wdXNoKGZ1bmMpOwoJICAgICAgICAgICAgfSBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmV2dExpc3RlbmVyc1tldnRdID0gW2Z1bmNdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICAvLyBzdXBwb3J0IGphdmFzY3JpcHQgY29uZGl0aW9uIGZvciB0aGUgbGFzdCB0YWcKCSAgICAgICAgYWRkTGlzdGVuZXIoZXZ0LCBmdW5jKSB7CgkgICAgICAgICAgICBpZiAoY29uZGl0aW9uZWQoZXZ0KSkgewoJICAgICAgICAgICAgICAgIC8vIGZ1bmMucHJvdG90eXBlID0gZXZ0OwoJICAgICAgICAgICAgICAgIGV2dCA9IHBhcnNlRXZlbnQoZXZ0KTsKCSAgICAgICAgICAgICAgICBmdW5jLmNvbmRpdGlvbiA9IGdlbkNvbmRpdGlvbkZ1bmMoZXZ0LmV4cCk7CgkgICAgICAgICAgICAgICAgZXZ0ID0gZXZ0LmV2dDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHRoaXMuI2FkZExpc3RlbmVyKGV2dCwgZnVuYyk7CgkgICAgICAgIH0KCgkgICAgICAgICNyZW1vdmVMaXN0ZW5lcihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIGxldCBmdW5jcyA9IHRoaXMuZXZ0TGlzdGVuZXJzW2V2dF07CgkgICAgICAgICAgICBsZXQgaWR4ID0gbnVsbDsKCSAgICAgICAgICAgIGlmIChmdW5jcyAmJiAoaWR4ID0gZnVuY3MuaW5kZXhPZihmdW5jKSkgPj0gMCkgewoJICAgICAgICAgICAgICAgIGZ1bmNzLnNwbGljZShpZHgsIDEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgoJICAgICAgICByZW1vdmVMaXN0ZW5lcihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIGlmIChjb25kaXRpb25lZChldnQpKSB7CgkgICAgICAgICAgICAgICAgZXZ0ID0gcGFyc2VFdmVudChldnQpOwoJICAgICAgICAgICAgICAgIGV2dCA9IGV2dC5ldnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aGlzLiNyZW1vdmVMaXN0ZW5lcihldnQsIGZ1bmMpOwoJICAgICAgICB9CgoJICAgICAgICBlbWl0KGV2dCwgLi4uYXJncykgewoJICAgICAgICAgICAgbGV0IGZ1bmNzID0gdGhpcy5ldnRMaXN0ZW5lcnNbZXZ0XTsKCSAgICAgICAgICAgIGlmIChmdW5jcykgewoJICAgICAgICAgICAgICAgIGZvciAobGV0IGZ1bmMgb2YgZnVuY3MpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bmMuY29uZGl0aW9uKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZnVuYy5jb25kaXRpb24uYXBwbHkobnVsbCwgYXJncykgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jLmFwcGx5KG51bGwsIGFyZ3MpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseShudWxsLCBhcmdzKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoKCSAgICAgICAgb24oZXZ0LCBmdW5jKSB7CgkgICAgICAgICAgICB0aGlzLmFkZExpc3RlbmVyKGV2dCwgZnVuYyk7CgkgICAgICAgIH0KCgkgICAgICAgIG9mZihldnQsIGZ1bmMpIHsKCSAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIoZXZ0LCBmdW5jKTsKCSAgICAgICAgfQoJICAgIH07Cgl9KSgpOwoKCWNvbnN0IHsgTm9kZSwgV2F5LCBSZWxhdGlvbiB9ID0gb3Ntb2JqcywKCSAgICB7IHB1cmdlUHJvcHMsIFJlZkVsZW1lbnRzIH0gPSB1dGlscywKCSAgICBYbWxQYXJzZXIgPSB4bWxwYXJzZXI7CgoJdmFyIGxpYiA9IChvc20sIG9wdHMpID0+IHsKCSAgICBsZXQgY29tcGxldGVGZWF0dXJlID0gZmFsc2UsIHJlbmRlclRhZ2dlZCA9IGZhbHNlLCBleGNsdWRlV2F5ID0gdHJ1ZTsKCgkgICAgY29uc3QgcGFyc2VPcHRzID0gb3B0cyA9PiB7CgkgICAgICAgIGlmIChvcHRzKSB7CgkgICAgICAgICAgICBjb21wbGV0ZUZlYXR1cmUgPSBvcHRzLmNvbXBsZXRlRmVhdHVyZSB8fCBvcHRzLmFsbEZlYXR1cmVzID8gdHJ1ZSA6IGZhbHNlOwoJICAgICAgICAgICAgcmVuZGVyVGFnZ2VkID0gb3B0cy5yZW5kZXJUYWdnZWQgPyB0cnVlIDogZmFsc2U7CgkgICAgICAgICAgICBsZXQgd2F5T3B0ID0gb3B0cy5zdXBwcmVzc1dheSB8fCBvcHRzLmV4Y2x1ZGVXYXk7CgkgICAgICAgICAgICBpZiAod2F5T3B0ICE9PSB1bmRlZmluZWQgJiYgIXdheU9wdCkgewoJICAgICAgICAgICAgICAgIGV4Y2x1ZGVXYXkgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgoJICAgIHBhcnNlT3B0cyhvcHRzKTsKCgkgICAgY29uc3QgZGV0ZWN0Rm9ybWF0ID0gb3NtID0+IHsKCSAgICAgICAgaWYgKG9zbS5lbGVtZW50cykgewoJICAgICAgICAgICAgcmV0dXJuICdqc29uJzsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3NtLmluZGV4T2YoJzxvc20nKSA+PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gJ3htbCc7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG9zbS50cmltKCkuc3RhcnRzV2l0aCgneycpKSB7CgkgICAgICAgICAgICByZXR1cm4gJ2pzb24tcmF3JzsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gJ2ludmFsaWQnOwoJICAgIH07CgoJICAgIGxldCBmb3JtYXQgPSBkZXRlY3RGb3JtYXQob3NtKTsKCgkgICAgbGV0IHJlZkVsZW1lbnRzID0gbmV3IFJlZkVsZW1lbnRzKCksIGZlYXR1cmVBcnJheSA9IFtdOwoKCSAgICBjb25zdCBhbmFseXplRmVhdHVyZXNGcm9tSnNvbiA9IG9zbSA9PiB7CgkgICAgICAgIGZvciAobGV0IGVsZW0gb2Ygb3NtLmVsZW1lbnRzKSB7CgkgICAgICAgICAgICBzd2l0Y2ggKGVsZW0udHlwZSkgewoJICAgICAgICAgICAgICAgIGNhc2UgJ25vZGUnOgoJICAgICAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IG5ldyBOb2RlKGVsZW0uaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0udGFncykgewoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5hZGRUYWdzKGVsZW0udGFncyk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgbm9kZS5hZGRQcm9wcyhwdXJnZVByb3BzKGVsZW0sIFsnaWQnLCAndHlwZScsICd0YWdzJywgJ2xhdCcsICdsb24nXSkpOwoJICAgICAgICAgICAgICAgICAgICBub2RlLnNldExhdExuZyhlbGVtKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgoJICAgICAgICAgICAgICAgIGNhc2UgJ3dheSc6CgkgICAgICAgICAgICAgICAgICAgIGxldCB3YXkgPSBuZXcgV2F5KGVsZW0uaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0udGFncykgewoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZFRhZ3MoZWxlbS50YWdzKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB3YXkuYWRkUHJvcHMocHVyZ2VQcm9wcyhlbGVtLCBbJ2lkJywgJ3R5cGUnLCAndGFncycsICdub2RlcycsICdnZW9tZXRyeSddKSk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLm5vZGVzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBuIG9mIGVsZW0ubm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXkuYWRkTm9kZVJlZihuKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtLmdlb21ldHJ5KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB3YXkuc2V0TGF0TG5nQXJyYXkoZWxlbS5nZW9tZXRyeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgoJICAgICAgICAgICAgICAgIGNhc2UgJ3JlbGF0aW9uJzoKCSAgICAgICAgICAgICAgICAgICAgbGV0IHJlbGF0aW9uID0gbmV3IFJlbGF0aW9uKGVsZW0uaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0uYm91bmRzKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGlvbi5zZXRCb3VuZHMoW3BhcnNlRmxvYXQoZWxlbS5ib3VuZHMubWlubG9uKSwgcGFyc2VGbG9hdChlbGVtLmJvdW5kcy5taW5sYXQpLCBwYXJzZUZsb2F0KGVsZW0uYm91bmRzLm1heGxvbiksIHBhcnNlRmxvYXQoZWxlbS5ib3VuZHMubWF4bGF0KV0pOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmIChlbGVtLnRhZ3MpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uLmFkZFRhZ3MoZWxlbS50YWdzKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByZWxhdGlvbi5hZGRQcm9wcyhwdXJnZVByb3BzKGVsZW0sIFsnaWQnLCAndHlwZScsICd0YWdzJywgJ2JvdW5kcycsICdtZW1iZXJzJ10pKTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW0ubWVtYmVycykgewoJICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgbWVtYmVyIG9mIGVsZW0ubWVtYmVycykgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0aW9uLmFkZE1lbWJlcihtZW1iZXIpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCgkgICAgY29uc3QgYW5hbHl6ZUZlYXR1cmVzRnJvbVhtbCA9IG9zbSA9PiB7CgkgICAgICAgIGNvbnN0IHhtbFBhcnNlciA9IG5ldyBYbWxQYXJzZXIoeyBwcm9ncmVzc2l2ZTogdHJ1ZSB9KTsKCgkgICAgICAgIHhtbFBhcnNlci5vbignPC9vc20ubm9kZT4nLCBub2RlID0+IHsKCSAgICAgICAgICAgIGxldCBuZCA9IG5ldyBOb2RlKG5vZGUuaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgIGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhub2RlKSkKCSAgICAgICAgICAgICAgICBpZiAoIWsuc3RhcnRzV2l0aCgnJCcpICYmIFsnaWQnLCAnbG9uJywgJ2xhdCddLmluZGV4T2YoaykgPCAwKSB7CgkgICAgICAgICAgICAgICAgICAgIG5kLmFkZFByb3Aoaywgdik7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmQuc2V0TGF0TG5nKG5vZGUpOwoJICAgICAgICAgICAgaWYgKG5vZGUuJGlubmVyTm9kZXMpIHsKCSAgICAgICAgICAgICAgICBmb3IgKGxldCBpbmQgb2Ygbm9kZS4kaW5uZXJOb2RlcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW5kLiR0YWcgPT09ICd0YWcnKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBuZC5hZGRUYWcoaW5kLmssIGluZC52KTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfSk7CgoJICAgICAgICB4bWxQYXJzZXIub24oJzwvb3NtLndheT4nLCBub2RlID0+IHsKCSAgICAgICAgICAgIGxldCB3YXkgPSBuZXcgV2F5KG5vZGUuaWQsIHJlZkVsZW1lbnRzKTsKCSAgICAgICAgICAgIGZvciAobGV0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyhub2RlKSkgewoJICAgICAgICAgICAgICAgIGlmICghay5zdGFydHNXaXRoKCckJykgJiYgWydpZCddLmluZGV4T2YoaykgPCAwKSB7CgkgICAgICAgICAgICAgICAgICAgIHdheS5hZGRQcm9wKGssIHYpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChub2RlLiRpbm5lck5vZGVzKSB7CgkgICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kIG9mIG5vZGUuJGlubmVyTm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGluZC4kdGFnID09PSAnbmQnKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kLmxvbiAmJiBpbmQubGF0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZExhdExuZyhpbmQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbmQucmVmKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZE5vZGVSZWYoaW5kLnJlZik7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5kLiR0YWcgPT09ICd0YWcnKQoJICAgICAgICAgICAgICAgICAgICAgICAgd2F5LmFkZFRhZyhpbmQuaywgaW5kLnYpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfSk7CgoJICAgICAgICB4bWxQYXJzZXIub24oJzxvc20ucmVsYXRpb24+Jywgbm9kZSA9PiB7CgkgICAgICAgICAgICBuZXcgUmVsYXRpb24obm9kZS5pZCwgcmVmRWxlbWVudHMpOwoJICAgICAgICB9KTsKCgkgICAgICAgIHhtbFBhcnNlci5vbignPC9vc20ucmVsYXRpb24ubWVtYmVyPicsIChub2RlLCBwYXJlbnQpID0+IHsKCSAgICAgICAgICAgIGxldCByZWxhdGlvbiA9IHJlZkVsZW1lbnRzLmdldChgcmVsYXRpb24vJHtwYXJlbnQuaWR9YCk7CgkgICAgICAgICAgICBsZXQgbWVtYmVyID0gewoJICAgICAgICAgICAgICAgIHR5cGU6IG5vZGUudHlwZSwKCSAgICAgICAgICAgICAgICByb2xlOiBub2RlLnJvbGUgPyBub2RlLnJvbGUgOiAnJywKCSAgICAgICAgICAgICAgICByZWY6IG5vZGUucmVmCgkgICAgICAgICAgICB9OwoJICAgICAgICAgICAgaWYgKG5vZGUubGF0ICYmIG5vZGUubG9uKSB7CgkgICAgICAgICAgICAgICAgbWVtYmVyLmxhdCA9IG5vZGUubGF0LCBtZW1iZXIubG9uID0gbm9kZS5sb24sIG1lbWJlci50YWdzID0ge307CgkgICAgICAgICAgICAgICAgZm9yIChsZXQgW2ssIHZdIG9mIE9iamVjdC5lbnRyaWVzKG5vZGUpKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICghay5zdGFydHNXaXRoKCckJykgJiYgWyd0eXBlJywgJ2xhdCcsICdsb24nXS5pbmRleE9mKGspIDwgMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyW2tdID0gdjsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChub2RlLiRpbm5lck5vZGVzKSB7CgkgICAgICAgICAgICAgICAgbGV0IGdlb21ldHJ5ID0gW107CgkgICAgICAgICAgICAgICAgbGV0IG5vZGVzID0gW107CgkgICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kIG9mIG5vZGUuJGlubmVyTm9kZXMpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGluZC5sYXQgJiYgaW5kLmxvbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnkucHVzaChpbmQpOwoJICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgbm9kZXMucHVzaChpbmQucmVmKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpZiAoZ2VvbWV0cnkubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICBtZW1iZXIuZ2VvbWV0cnkgPSBnZW9tZXRyeTsKCSAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGVzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgICAgICAgICAgbWVtYmVyLm5vZGVzID0gbm9kZXM7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVsYXRpb24uYWRkTWVtYmVyKG1lbWJlcik7CgkgICAgICAgIH0pOwoKCSAgICAgICAgeG1sUGFyc2VyLm9uKCc8L29zbS5yZWxhdGlvbi5ib3VuZHM+JywgKG5vZGUsIHBhcmVudCkgPT4gewoJICAgICAgICAgICAgcmVmRWxlbWVudHMuZ2V0KGByZWxhdGlvbi8ke3BhcmVudC5pZH1gKS5zZXRCb3VuZHMoW3BhcnNlRmxvYXQobm9kZS5taW5sb24pLCBwYXJzZUZsb2F0KG5vZGUubWlubGF0KSwgcGFyc2VGbG9hdChub2RlLm1heGxvbiksIHBhcnNlRmxvYXQobm9kZS5tYXhsYXQpXSk7CgkgICAgICAgIH0pOwoKCSAgICAgICAgeG1sUGFyc2VyLm9uKCc8L29zbS5yZWxhdGlvbi50YWc+JywgKG5vZGUsIHBhcmVudCkgPT4gewoJICAgICAgICAgICAgcmVmRWxlbWVudHMuZ2V0KGByZWxhdGlvbi8ke3BhcmVudC5pZH1gKS5hZGRUYWcobm9kZS5rLCBub2RlLnYpOwoJICAgICAgICB9KTsKCgkgICAgICAgIHhtbFBhcnNlci5wYXJzZShvc20pOwoJICAgIH07CgoJICAgIGlmIChmb3JtYXQgPT09ICdqc29uLXJhdycpIHsKCSAgICAgICAgb3NtID0gSlNPTi5wYXJzZShvc20pOwoJICAgICAgICBpZiAob3NtLmVsZW1lbnRzKSB7CgkgICAgICAgICAgICBmb3JtYXQgPSAnanNvbic7CgkgICAgICAgIH0gZWxzZSB7CgkgICAgICAgICAgICBmb3JtYXQgPSAnaW52YWxpZCc7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIGlmIChmb3JtYXQgPT09ICdqc29uJykgewoJICAgICAgICBhbmFseXplRmVhdHVyZXNGcm9tSnNvbihvc20pOwoJICAgIH0gZWxzZSBpZiAoZm9ybWF0ID09PSAneG1sJykgewoJICAgICAgICBhbmFseXplRmVhdHVyZXNGcm9tWG1sKG9zbSk7CgkgICAgfQoKCSAgICByZWZFbGVtZW50cy5iaW5kQWxsKCk7CgoJICAgIGZvciAobGV0IHYgb2YgcmVmRWxlbWVudHMudmFsdWVzKCkpIHsKCSAgICAgICAgaWYgKHYucmVmQ291bnQgPD0gMCB8fCAodi5oYXNUYWcgJiYgcmVuZGVyVGFnZ2VkICYmICEodiBpbnN0YW5jZW9mIFdheSAmJiBleGNsdWRlV2F5KSkpIHsKCSAgICAgICAgICAgIGxldCBmZWF0dXJlcyA9IHYudG9GZWF0dXJlQXJyYXkoKTsKCSAgICAgICAgICAgIC8vIHJldHVybiB0aGUgZmlyc3QgZ2VvbWV0cnkgb2YgdGhlIGZpcnN0IHJlbGF0aW9uIGVsZW1lbnQKCSAgICAgICAgICAgIGlmICh2IGluc3RhbmNlb2YgUmVsYXRpb24gJiYgIWNvbXBsZXRlRmVhdHVyZSAmJiBmZWF0dXJlcy5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZlYXR1cmVzWzBdLmdlb21ldHJ5OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmVhdHVyZUFycmF5ID0gZmVhdHVyZUFycmF5LmNvbmNhdChmZWF0dXJlcyk7CgkgICAgICAgIH0KCSAgICB9CgoJICAgIHJldHVybiB7IHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsIGZlYXR1cmVzOiBmZWF0dXJlQXJyYXkgfTsKCX07CgoJdmFyIG9zbTJnZW9qc29uID0gLypAX19QVVJFX18qL2dldERlZmF1bHRFeHBvcnRGcm9tQ2pzKGxpYik7CgoJY2xhc3MgQ29udmVydGVyIHsKCSAgICBjb25zdHJ1Y3Rvcihmb3JtYXQsIGRhdGEsIG9wdGlvbnMgPSB7fSkgewoJICAgICAgICAvKioKCSAgICAgICAgICogQ3JlYXRlcyBhIGJsYW5rIEdlb0pTT04gZmVhdHVyZSBjb2xsZWN0aW9uLgoJICAgICAgICAgKiBAcmV0dXJucyBBIG5ldyBHZW9KU09OIGZlYXR1cmUgY29sbGVjdGlvbiB3aXRoIG5vIGZlYXR1cmVzLgoJICAgICAgICAgKi8KCSAgICAgICAgdGhpcy5ibGFua0dlb0pTT04gPSAoKSA9PiAoewoJICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywKCSAgICAgICAgICAgIGZlYXR1cmVzOiBbXSwKCSAgICAgICAgfSk7CgkgICAgICAgIHRoaXMuX3Jhd0RhdGEgPSBkYXRhOwoJICAgICAgICB0aGlzLl9mb3JtYXQgPSBmb3JtYXQ7CgkgICAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zOwoJICAgICAgICBjb25zdCBjb252ZXJ0ZXJzID0gewoJICAgICAgICAgICAgJ3RvcG9qc29uJzogdGhpcy5sb2FkVG9wb0pzb24sCgkgICAgICAgICAgICAnb3NtJzogdGhpcy5sb2FkT3NtLAoJICAgICAgICAgICAgJ2ttbCc6IHRoaXMubG9hZFhtbCwKCSAgICAgICAgICAgICdncHgnOiB0aGlzLmxvYWRYbWwsCgkgICAgICAgICAgICAndGN4JzogdGhpcy5sb2FkWG1sLAoJICAgICAgICAgICAgJ2Nzdic6IHRoaXMubG9hZENzdiwKCSAgICAgICAgICAgICd0c3YnOiB0aGlzLmxvYWRDc3YsCgkgICAgICAgICAgICAncG9seWxpbmUnOiB0aGlzLmxvYWRQb2x5bGluZQoJICAgICAgICB9OwoJICAgICAgICB0aGlzLl9jb252ZXJzaW9uRm4gPSBjb252ZXJ0ZXJzW2Zvcm1hdF07CgkgICAgfQoJICAgIGFzeW5jIGNvbnZlcnQoKSB7CgkgICAgICAgIGlmICghdGhpcy5fY29udmVyc2lvbkZuKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKF8sIHJlaikgPT4gcmVqKGBObyBjb252ZXJ0ZXIgZXhpc3RzIGZvciAke3RoaXMuX2Zvcm1hdH1gKSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVyc2lvbkZuKCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogTG9hZCB0aGUgWE1MIGRhdGEgYXMgR2VvSlNPTgoJICAgICAqIEByZXR1cm5zIEEgcHJvbWlzZSByZXNvbHZpbmcgdG8gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZFhtbCgpIHsKCSAgICAgICAgLy8gVXNlIHRoZSBhcHByb3ByaWF0ZSBwYXJzZXIgYmFzZWQgb24gdGhlIGZvcm1hdAoJICAgICAgICBjb25zdCBnZW9qc29uID0gdG9HZW9Kc29uW3RoaXMuX2Zvcm1hdF0obmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh0aGlzLl9yYXdEYXRhLCAidGV4dC94bWwiKSk7CgkgICAgICAgIHJldHVybiBnZW9qc29uOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBMb2FkcyBhbmQgcGFyc2VzIENTViBkYXRhIGludG8gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uLgoJICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZENzdigpIHsKCSAgICAgICAgLy8gRGVmaW5lIG9wdGlvbnMgZm9yIHRoZSBjc3YyZ2VvanNvbiBsaWJyYXJ5CgkgICAgICAgIGxldCBvcHRpb25zID0gdGhpcy5fb3B0aW9ucy5jc3ZPcHRpb25zIHx8IHt9OyAvLyBUT0RPIGFsbG93IENTViBvcHRpb25zCgkgICAgICAgIGlmICh0aGlzLl9mb3JtYXQgPT09ICd0c3YnKSB7CgkgICAgICAgICAgICBvcHRpb25zLmRlbGltaXRlciA9ICdcdCc7CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIHRoZSBjc3YyZ2VvanNvbiBsaWJyYXJ5IHRvIGNvbnZlcnQgdGhlIENTViB0byBHZW9KU09OCgkgICAgICAgIGNvbnN0IGdlb2pzb24gPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CgkgICAgICAgICAgICBjc3YyZ2VvanNvbl8xLmNzdjJnZW9qc29uKHRoaXMuX3Jhd0RhdGEsIG9wdGlvbnMsIChlcnIsIGRhdGEpID0+IHsKCSAgICAgICAgICAgICAgICBpZiAoZXJyKSB7CgkgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9KTsKCSAgICAgICAgfSk7CgkgICAgICAgIHJldHVybiBnZW9qc29uOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBMb2FkcyBUb3BvSlNPTiBkYXRhIGFuZCBjb252ZXJ0cyBpdCBpbnRvIGEgR2VvSlNPTiBGZWF0dXJlQ29sbGVjdGlvbgoJICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZFRvcG9Kc29uKCkgewoJICAgICAgICBsZXQgdG9wb0pzb25EYXRhID0ge307CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB0b3BvSnNvbkRhdGEgPSBKU09OLnBhcnNlKHRoaXMuX3Jhd0RhdGEpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlKSB7CgkgICAgICAgICAgICB0aHJvdyAiSW52YWxpZCBUb3BvSnNvbiI7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udmVydCB0aGUgZGF0YQoJICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5ibGFua0dlb0pTT04oKTsKCSAgICAgICAgaWYgKHRvcG9Kc29uRGF0YS50eXBlID09PSAiVG9wb2xvZ3kiICYmIHRvcG9Kc29uRGF0YS5vYmplY3RzICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJlc3VsdCA9IHsKCSAgICAgICAgICAgICAgICB0eXBlOiAiRmVhdHVyZUNvbGxlY3Rpb24iLAoJICAgICAgICAgICAgICAgIGZlYXR1cmVzOiByZXN1bHQuZmVhdHVyZXMgPSBPYmplY3Qua2V5cyh0b3BvSnNvbkRhdGEub2JqZWN0cykubWFwKGtleSA9PiB0b3BvanNvbkZlYXR1cmUodG9wb0pzb25EYXRhLCBrZXkpKS5yZWR1Y2UoKGEsIHYpID0+IFsuLi5hLCAuLi52LmZlYXR1cmVzXSwgW10pCgkgICAgICAgICAgICB9OwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfQoJICAgIDsKCSAgICAvKioKCSAgICAgKiBMb2FkcyBPU00gZGF0YSBhbmQgY29udmVydHMgaXQgaW50byBhIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24KCSAgICAgKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uLgoJICAgICAqLwoJICAgIGFzeW5jIGxvYWRPc20oKSB7CgkgICAgICAgIHJldHVybiBvc20yZ2VvanNvbih0aGlzLl9yYXdEYXRhKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogTG9hZHMgYW5kIHBhcnNlcyBQb2x5bGluZSBkYXRhIGludG8gYSBHZW9KU09OIEZlYXR1cmVDb2xsZWN0aW9uLgoJICAgICAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggdGhlIEdlb0pTT04gRmVhdHVyZUNvbGxlY3Rpb24uCgkgICAgICovCgkgICAgYXN5bmMgbG9hZFBvbHlsaW5lKCkgewoJICAgICAgICBsZXQgb3B0aW9ucyA9IHRoaXMuX29wdGlvbnMucG9seWxpbmVPcHRpb25zIHx8IHt9OwoJICAgICAgICAvLyBVc2UgdGhlIGNzdjJnZW9qc29uIGxpYnJhcnkgdG8gY29udmVydCB0aGUgQ1NWIHRvIEdlb0pTT04KCSAgICAgICAgY29uc3QgZ2VvanNvbiA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgY29uc3QgbGluZVN0cmluZyA9IHBvbHlsaW5lRXhwb3J0cy50b0dlb0pTT04odGhpcy5fcmF3RGF0YSwgb3B0aW9ucy5wcmVjaXNpb24pOwoJICAgICAgICAgICAgICAgIGxldCBnZW9tZXRyeSA9IGxpbmVTdHJpbmc7CgkgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMudHlwZSA9PT0gJ3BvaW50JykgewoJICAgICAgICAgICAgICAgICAgICBpZiAobGluZVN0cmluZy5jb29yZGluYXRlcy5sZW5ndGggPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgaXQgYSBwb2ludAoJICAgICAgICAgICAgICAgICAgICAgICAgZ2VvbWV0cnkgPSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnOiAnUG9pbnQnLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb29yZGluYXRlcyc6IGxpbmVTdHJpbmcuY29vcmRpbmF0ZXNbMF0KCSAgICAgICAgICAgICAgICAgICAgICAgIH07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0Nhbm5vdCBjb252ZXJ0IHBvbHlsaW5lIHRvICcgKyBvcHRpb25zLnR5cGUpOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9wdGlvbnMudHlwZSA9PT0gJ3BvbHlnb24nKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lU3RyaW5nLmNvb3JkaW5hdGVzWzBdWzBdID09PSBsaW5lU3RyaW5nLmNvb3JkaW5hdGVzW2xpbmVTdHJpbmcuY29vcmRpbmF0ZXMubGVuZ3RoIC0gMV1bMF0gJiYKCSAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVTdHJpbmcuY29vcmRpbmF0ZXNbMF1bMV0gPT09IGxpbmVTdHJpbmcuY29vcmRpbmF0ZXNbbGluZVN0cmluZy5jb29yZGluYXRlcy5sZW5ndGggLSAxXVsxXSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSBpdCBhIHBvbHlnb24KCSAgICAgICAgICAgICAgICAgICAgICAgIGdlb21ldHJ5ID0gewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJzogJ1BvbHlnb24nLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb29yZGluYXRlcyc6IFtsaW5lU3RyaW5nLmNvb3JkaW5hdGVzXQoJICAgICAgICAgICAgICAgICAgICAgICAgfTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignQ2Fubm90IGNvbnZlcnQgcG9seWxpbmUgdG8gJyArIG9wdGlvbnMudHlwZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmVzb2x2ZSh7CgkgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsCgkgICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzOiBbewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0eXBlIjogIkZlYXR1cmUiLAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICJnZW9tZXRyeSI6IGdlb21ldHJ5LAoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwcm9wZXJ0aWVzIjogb3B0aW9ucy5wcm9wZXJ0aWVzIHx8IHt9CgkgICAgICAgICAgICAgICAgICAgICAgICB9XQoJICAgICAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVycikgewoJICAgICAgICAgICAgICAgIHJlamVjdChlcnIpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9KTsKCSAgICAgICAgcmV0dXJuIGdlb2pzb247CgkgICAgfQoJfQoKCWNvbnN0IGxpYnJhcmllcyA9IHsKCSAgICAnQ29udmVydGVyJzogQ29udmVydGVyCgl9OwoJbGV0IHN1YkNsYXNzOwoJc2VsZi5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZSA9PiB7CgkgICAgY29uc3QgZGF0YSA9IChlLmRhdGEgfHwgZSk7CgkgICAgY29uc3QgcG9zdCA9IChpZCwgZXJyLCByZXMsIHR5cGUpID0+IHsKCSAgICAgICAgcG9zdE1lc3NhZ2UoewoJICAgICAgICAgICAgdHlwZTogdHlwZSA/IHR5cGUgOiAoZXJyID8gJ2Vycm9yJyA6ICdyZXNwb25zZScpLAoJICAgICAgICAgICAgaWQ6IGlkLAoJICAgICAgICAgICAgbWVzc2FnZTogcmVzLAoJICAgICAgICAgICAgZXJyb3I6IGVycgoJICAgICAgICB9KTsKCSAgICB9OwoJICAgIGNvbnN0IGNvbW1hbmRzID0gewoJICAgICAgICAnaW5pdCc6IChtc2cpID0+IHsKCSAgICAgICAgICAgIGNvbnN0IHsgaWQsIGNvbW1hbmQsIG1lc3NhZ2UgfSA9IG1zZzsKCSAgICAgICAgICAgIHN1YkNsYXNzID0gbmV3IGxpYnJhcmllc1tjb21tYW5kXShtZXNzYWdlWzBdLCBtZXNzYWdlWzFdKTsKCSAgICAgICAgICAgIC8vIHJldHVybiB0aGUgY2xhc3MnIG1ldGhvZHMKCSAgICAgICAgICAgIGNvbnN0IGZucyA9IFsKCSAgICAgICAgICAgICAgICAuLi5PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhsaWJyYXJpZXNbY29tbWFuZF0ucHJvdG90eXBlKSwKCSAgICAgICAgICAgICAgICAuLi5PYmplY3Qua2V5cyhzdWJDbGFzcykKCSAgICAgICAgICAgIF0ubWFwKGtleSA9PiBba2V5LCB0eXBlb2YgbGlicmFyaWVzW2NvbW1hbmRdLnByb3RvdHlwZVtrZXldXSkKCSAgICAgICAgICAgICAgICAucmVkdWNlKChhLCBjKSA9PiAoeyAuLi5hLCAuLi57IFtjWzBdXTogY1sxXSB9IH0pLCB7fSk7CgkgICAgICAgICAgICBwb3N0KGlkLCB1bmRlZmluZWQsIGZucywgJ2luaXRfcmVzcG9uc2UnKTsKCSAgICAgICAgfSwKCSAgICAgICAgJ2dldCc6IGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgICAgIGNvbnN0IHsgaWQsIGNvbW1hbmQgfSA9IG1zZzsKCSAgICAgICAgICAgIGlmIChzdWJDbGFzcyAmJiBzdWJDbGFzc1tjb21tYW5kXSkgewoJICAgICAgICAgICAgICAgIHBvc3QoaWQsIHVuZGVmaW5lZCwgc3ViQ2xhc3NbY29tbWFuZF0pOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgcG9zdChpZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9LAoJICAgICAgICAnZXhlYyc6IGZ1bmN0aW9uIChtc2cpIHsKCSAgICAgICAgICAgIGNvbnN0IHsgaWQsIGNvbW1hbmQsIG1lc3NhZ2UgfSA9IG1zZzsKCSAgICAgICAgICAgIGlmIChzdWJDbGFzcyAmJiBzdWJDbGFzc1tjb21tYW5kXSAmJiB0eXBlb2Ygc3ViQ2xhc3NbY29tbWFuZF0gPT09ICdmdW5jdGlvbicpIHsKCSAgICAgICAgICAgICAgICBjb25zdCBjbWQgPSBzdWJDbGFzc1tjb21tYW5kXQoJICAgICAgICAgICAgICAgICAgICAuYXBwbHkoc3ViQ2xhc3MsIG1lc3NhZ2UpOwoJICAgICAgICAgICAgICAgIGlmICghIWNtZCAmJiB0eXBlb2YgY21kLnRoZW4gPT09ICdmdW5jdGlvbicpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSXQncyBhIHByb21pc2UsIHNvIHdhaXQgZm9yIGl0CgkgICAgICAgICAgICAgICAgICAgIGNtZAoJICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHBvc3QoaWQsIHVuZGVmaW5lZCwgcmVzKSkKCSAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlID0+IHBvc3QoaWQsIGUpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vdCBhIHByb21pc2UsIGp1c3QgcmV0dXJuIGl0CgkgICAgICAgICAgICAgICAgICAgIHBvc3QoaWQsIHVuZGVmaW5lZCwgY21kKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBFcnJvcgoJICAgICAgICAgICAgICAgIHBvc3QoaWQsIG5ldyBFcnJvcihgY29tbWFuZCAiJHtjb21tYW5kfSIgbm90IGZvdW5kYCkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBpZiAoY29tbWFuZHNbZGF0YS50eXBlXSkgewoJICAgICAgICBjb21tYW5kc1tkYXRhLnR5cGVdKGRhdGEpOwoJICAgIH0KCX0pOwoKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9d29ya2VyLmpzLm1hcAoK",Ln=null,zr=!1,Mn?ho(Ca,Ln,zr):function(pt,ft,ut){var Zt;return function(Kt){return Zt=Zt||dn(pt,ft,ut),new Worker(Zt,Kt)}}(Ca,Ln,zr));let Ur=()=>Math.random().toString(36).substring(2);class Hr{constructor(ft,ut){this.initId=Ur()+"-"+ft,this.worker=new Ia,this.handlers=new Map,this.worker.onmessage=Zt=>{let Kt=Zt.data,ie=this.handlers.get(Kt.id),ge=this;if(ie){if(Kt.type==="response"&&ie.resolve(Kt.message),Kt.type==="error"){let Ue=Kt.error||new Error(`Unknown error with ${ft}`);ie.reject(Ue)}Kt.type==="init_response"&&(this._=Object.keys(Kt.message).map(Ue=>{let Ee=typeof Kt.message[Ue]=="function";return[Ue,function(){return Ee?ge.exec(Ue)(...arguments):ge.get(Ue)}]}).reduce((Ue,Ee)=>({...Ue,[Ee[0]]:Ee[1]}),{}),ie.resolve(this._))}},this.worker.postMessage({type:"init",id:this.initId,command:ft,message:ut})}onLoad(){return new Promise(ft=>{this._===void 0?this.handlers.set(this.initId,{resolve:ft,reject:ft}):ft(this._)})}exec(ft){let ut=this;return function(...Zt){return new Promise((Kt,ie)=>{let ge=Ur()+"-"+ft;ut.handlers.set(ge,{resolve:Kt,reject:ie}),ut.worker.postMessage({type:"exec",id:ge,command:ft,message:[...Zt]})})}}get(ft){return new Promise((ut,Zt)=>{let Kt=Ur()+"-"+ft;this.handlers.set(Kt,{resolve:ut,reject:Zt}),this.worker.postMessage({type:"get",id:Kt,command:ft,message:[]})})}}let pr=new URL("test://http://example.com").href!=="test://http://example.com";async function Js(pt,ft,ut){let Zt=await fetch(pt,ut?{signal:ut.signal}:void 0),Kt={};try{let ie=new URL(pt,window.location.href).hash,ge=decodeURIComponent(ie.slice(1));Kt=JSON.parse(ge)}catch(ie){console.warn("Error parsing or reading URL:",ie)}if(Zt.status==200){let ie=await Zt.text(),ge;return["kml","tcx","gpx"].indexOf(ft)>=0||!(()=>{let Ue=!1;try{Ue=typeof window.Worker=="function"}catch{Ue=!1}return Ue})()?ge=new uo(ft,ie,Kt).convert():ge=new Hr("Converter",[ft,ie,Kt]).exec("convert")(),await ge}throw new Error(`Data fetch error: ${Zt.statusText}`)}let Gr=(pt,ft)=>{let ut=new AbortController,Zt=pt.url.split("://")[0],Kt=pt.url.replace(new RegExp(`^${Zt}://`),""),ie=pr?(ge=>{let Ue=new RegExp("^(https?)(//)");return ge.replace(Ue,"$1:$2")})(Kt):Kt;return ie&&Js(ie,Zt,ut).then(ge=>ft(null,ge)).catch(ge=>ft(ge)),{cancel:()=>{ut.abort()}}};i.VectorTextProtocol=Gr,i.addOptions=(pt,ft)=>{try{let ut=new URL(pt);return ut.hash=`#${encodeURIComponent(JSON.stringify(ft))}`,ut.toString()}catch(ut){return console.error("Error parsing or updating URL:",ut),pt}},i.addProtocols=pt=>{Qr.forEach(ft=>{pt.addProtocol(ft,Gr)})}})});var $m=da((eO,mb)=>{mb.exports=K3;var D3=Object.prototype.hasOwnProperty;function K3(){for(var i={},t=0;t<arguments.length;t++){var e=arguments[t];for(var o in e)D3.call(e,o)&&(i[o]=e[o])}return i}});var yb=da((Cb,Ib)=>{(function(){var i=this,t={};typeof Cb<"u"?Ib.exports=t:i.fuzzy=t,t.simpleFilter=function(e,o){return o.filter(function(l){return t.test(e,l)})},t.test=function(e,o){return t.match(e,o)!==null},t.match=function(e,o,l){l=l||{};var n=0,g=[],h=o.length,m=0,B=0,_=l.pre||"",E=l.post||"",G=l.caseSensitive&&o||o.toLowerCase(),S;e=l.caseSensitive&&e||e.toLowerCase();for(var O=0;O<h;O++)S=o[O],G[O]===e[n]?(S=_+S+E,n+=1,B+=1+B):B=0,m+=B,g[g.length]=S;return n===e.length?(m=G===e?1/0:m,{rendered:g.join(""),score:m}):null},t.filter=function(e,o,l){return!o||o.length===0?[]:typeof e!="string"?o:(l=l||{},o.reduce(function(n,g,h,m){var B=g;l.extract&&(B=l.extract(g));var _=t.match(e,B,l);return _!=null&&(n[n.length]={string:_.rendered,score:_.score,index:h,original:g}),n},[]).sort(function(n,g){var h=g.score-n.score;return h||n.index-g.index}))}})()});var vb=da((iO,bb)=>{"use strict";var Wo=function(i){return this.component=i,this.items=[],this.active=i.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,i.el.parentNode.insertBefore(this.wrapper,i.el.nextSibling),this};Wo.prototype.show=function(){this.element.style.display="block"};Wo.prototype.hide=function(){this.element.style.display="none"};Wo.prototype.add=function(i){this.items.push(i)};Wo.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0};Wo.prototype.isEmpty=function(){return!this.items.length};Wo.prototype.isVisible=function(){return this.element.style.display==="block"};Wo.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var i=0;i<this.items.length;i++)this.drawItem(this.items[i],this.active===i);this.show()};Wo.prototype.drawItem=function(i,t){var e=document.createElement("li"),o=document.createElement("a");t&&(e.className+=" active"),o.innerHTML=i.string,e.appendChild(o),this.element.appendChild(e),e.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),e.addEventListener("mouseup",function(){this.handleMouseUp.call(this,i)}.bind(this))};Wo.prototype.handleMouseUp=function(i){this.selectingListItem=!1,this.component.value(i.original),this.clear(),this.draw()};Wo.prototype.move=function(i){this.active=i,this.draw()};Wo.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)};Wo.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)};Wo.prototype.drawError=function(i){var t=document.createElement("li");t.innerHTML=i,this.element.appendChild(t),this.show()};bb.exports=Wo});var Bb=da((rO,wb)=>{"use strict";var O3=$m(),W3=yb(),z3=vb(),no=function(i,t,e){return e=e||{},this.options=O3({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},e),this.el=i,this.data=t||[],this.list=new z3(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(o){this.handleKeyUp(o.keyCode,o)}.bind(this),!1),this.el.addEventListener("keydown",function(o){this.handleKeyDown(o)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(o){this.handlePaste(o)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};no.prototype.handleKeyUp=function(i,t){if(!(i===40||i===38||i===27||i===9)){if(i===13){this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),t.stopPropagation());return}this.handleInputChange(this.el.value)}};no.prototype.handleKeyDown=function(i){switch(i.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&i.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};no.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};no.prototype.handlePaste=function(i){if(i.clipboardData)this.handleInputChange(i.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(i.target.value)},100)}};no.prototype.handleInputChange=function(i){if(this.query=this.normalize(i),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates(function(t){for(var e=0;e<t.length&&(this.list.add(t[e]),e!==this.options.limit-1);e++);this.list.draw()}.bind(this))};no.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};no.prototype.update=function(i){this.data=i,this.handleKeyUp()};no.prototype.clear=function(){this.data=[],this.list.clear()};no.prototype.normalize=function(i){return i=i.toLowerCase(),i};no.prototype.match=function(i,t){return i.indexOf(t)>-1};no.prototype.value=function(i){if(this.selected=i,this.el.value=this.getItemValue(i||{place_name:this.query}),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")};no.prototype.getCandidates=function(i){var t={pre:"<strong>",post:"</strong>",extract:function(o){return this.getItemValue(o)}.bind(this)},e;this.options.filter?(e=W3.filter(this.query,this.data,t),e=e.map(function(o){return{original:o.original,string:this.render(o.original,o.string)}}.bind(this))):e=this.data.map(function(o){var l=this.render(o);return{original:o,string:l}}.bind(this)),i(e)};no.prototype.getItemValue=function(i){return i};no.prototype.render=function(i,t){if(t)return t;for(var e=i.original?this.getItemValue(i.original):this.getItemValue(i),o=this.normalize(e),l=o.lastIndexOf(this.query);l>-1;){var n=l+this.query.length;e=e.slice(0,l)+"<strong>"+e.slice(l,n)+"</strong>"+e.slice(n),l=o.slice(0,l).lastIndexOf(this.query)}return e};no.prototype.renderError=function(i){this.list.drawError(i)};wb.exports=no});var Sb=da((nO,xb)=>{"use strict";var _b=Bb();xb.exports=_b;typeof window<"u"&&(window.Suggestions=_b)});var Eb=da((sO,Lb)=>{var J3="Expected a function",Fb=NaN,X3="[object Symbol]",Y3=/^\s+|\s+$/g,j3=/^[-+]0x[0-9a-f]+$/i,q3=/^0b[01]+$/i,$3=/^0o[0-7]+$/i,tF=parseInt,eF=typeof global=="object"&&global&&global.Object===Object&&global,iF=typeof self=="object"&&self&&self.Object===Object&&self,rF=eF||iF||Function("return this")(),nF=Object.prototype,sF=nF.toString,oF=Math.max,aF=Math.min,tC=function(){return rF.Date.now()};function AF(i,t,e){var o,l,n,g,h,m,B=0,_=!1,E=!1,G=!0;if(typeof i!="function")throw new TypeError(J3);t=kb(t)||0,eC(e)&&(_=!!e.leading,E="maxWait"in e,n=E?oF(kb(e.maxWait)||0,t):n,G="trailing"in e?!!e.trailing:G);function S(Qt){var Ut=o,dt=l;return o=l=void 0,B=Qt,g=i.apply(dt,Ut),g}function O(Qt){return B=Qt,h=setTimeout(z,t),_?S(Qt):g}function P(Qt){var Ut=Qt-m,dt=Qt-B,ee=t-Ut;return E?aF(ee,n-dt):ee}function tt(Qt){var Ut=Qt-m,dt=Qt-B;return m===void 0||Ut>=t||Ut<0||E&&dt>=n}function z(){var Qt=tC();if(tt(Qt))return rt(Qt);h=setTimeout(z,P(Qt))}function rt(Qt){return h=void 0,G&&o?S(Qt):(o=l=void 0,g)}function ct(){h!==void 0&&clearTimeout(h),B=0,o=m=l=h=void 0}function Et(){return h===void 0?g:rt(tC())}function Pt(){var Qt=tC(),Ut=tt(Qt);if(o=arguments,l=this,m=Qt,Ut){if(h===void 0)return O(m);if(E)return h=setTimeout(z,t),S(m)}return h===void 0&&(h=setTimeout(z,t)),g}return Pt.cancel=ct,Pt.flush=Et,Pt}function eC(i){var t=typeof i;return!!i&&(t=="object"||t=="function")}function lF(i){return!!i&&typeof i=="object"}function cF(i){return typeof i=="symbol"||lF(i)&&sF.call(i)==X3}function kb(i){if(typeof i=="number")return i;if(cF(i))return Fb;if(eC(i)){var t=typeof i.valueOf=="function"?i.valueOf():i;i=eC(t)?t+"":t}if(typeof i!="string")return i===0?i:+i;i=i.replace(Y3,"");var e=q3.test(i);return e||$3.test(i)?tF(i.slice(2),e?2:8):j3.test(i)?Fb:+i}Lb.exports=AF});var Vb=da((oO,iC)=>{"use strict";var Fu=typeof Reflect=="object"?Reflect:null,Tb=Fu&&typeof Fu.apply=="function"?Fu.apply:function(t,e,o){return Function.prototype.apply.call(t,e,o)},_d;Fu&&typeof Fu.ownKeys=="function"?_d=Fu.ownKeys:Object.getOwnPropertySymbols?_d=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:_d=function(t){return Object.getOwnPropertyNames(t)};function uF(i){console&&console.warn&&console.warn(i)}var Ub=Number.isNaN||function(t){return t!==t};function sn(){sn.init.call(this)}iC.exports=sn;iC.exports.once=pF;sn.EventEmitter=sn;sn.prototype._events=void 0;sn.prototype._eventsCount=0;sn.prototype._maxListeners=void 0;var Qb=10;function xd(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}Object.defineProperty(sn,"defaultMaxListeners",{enumerable:!0,get:function(){return Qb},set:function(i){if(typeof i!="number"||i<0||Ub(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");Qb=i}});sn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};sn.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Ub(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Gb(i){return i._maxListeners===void 0?sn.defaultMaxListeners:i._maxListeners}sn.prototype.getMaxListeners=function(){return Gb(this)};sn.prototype.emit=function(t){for(var e=[],o=1;o<arguments.length;o++)e.push(arguments[o]);var l=t==="error",n=this._events;if(n!==void 0)l=l&&n.error===void 0;else if(!l)return!1;if(l){var g;if(e.length>0&&(g=e[0]),g instanceof Error)throw g;var h=new Error("Unhandled error."+(g?" ("+g.message+")":""));throw h.context=g,h}var m=n[t];if(m===void 0)return!1;if(typeof m=="function")Tb(m,this,e);else for(var B=m.length,_=Pb(m,B),o=0;o<B;++o)Tb(_[o],this,e);return!0};function Rb(i,t,e,o){var l,n,g;if(xd(e),n=i._events,n===void 0?(n=i._events=Object.create(null),i._eventsCount=0):(n.newListener!==void 0&&(i.emit("newListener",t,e.listener?e.listener:e),n=i._events),g=n[t]),g===void 0)g=n[t]=e,++i._eventsCount;else if(typeof g=="function"?g=n[t]=o?[e,g]:[g,e]:o?g.unshift(e):g.push(e),l=Gb(i),l>0&&g.length>l&&!g.warned){g.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+g.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=i,h.type=t,h.count=g.length,uF(h)}return i}sn.prototype.addListener=function(t,e){return Rb(this,t,e,!1)};sn.prototype.on=sn.prototype.addListener;sn.prototype.prependListener=function(t,e){return Rb(this,t,e,!0)};function hF(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zb(i,t,e){var o={fired:!1,wrapFn:void 0,target:i,type:t,listener:e},l=hF.bind(o);return l.listener=e,o.wrapFn=l,l}sn.prototype.once=function(t,e){return xd(e),this.on(t,Zb(this,t,e)),this};sn.prototype.prependOnceListener=function(t,e){return xd(e),this.prependListener(t,Zb(this,t,e)),this};sn.prototype.removeListener=function(t,e){var o,l,n,g,h;if(xd(e),l=this._events,l===void 0)return this;if(o=l[t],o===void 0)return this;if(o===e||o.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete l[t],l.removeListener&&this.emit("removeListener",t,o.listener||e));else if(typeof o!="function"){for(n=-1,g=o.length-1;g>=0;g--)if(o[g]===e||o[g].listener===e){h=o[g].listener,n=g;break}if(n<0)return this;n===0?o.shift():gF(o,n),o.length===1&&(l[t]=o[0]),l.removeListener!==void 0&&this.emit("removeListener",t,h||e)}return this};sn.prototype.off=sn.prototype.removeListener;sn.prototype.removeAllListeners=function(t){var e,o,l;if(o=this._events,o===void 0)return this;if(o.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):o[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete o[t]),this;if(arguments.length===0){var n=Object.keys(o),g;for(l=0;l<n.length;++l)g=n[l],g!=="removeListener"&&this.removeAllListeners(g);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=o[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(l=e.length-1;l>=0;l--)this.removeListener(t,e[l]);return this};function Hb(i,t,e){var o=i._events;if(o===void 0)return[];var l=o[t];return l===void 0?[]:typeof l=="function"?e?[l.listener||l]:[l]:e?dF(l):Pb(l,l.length)}sn.prototype.listeners=function(t){return Hb(this,t,!0)};sn.prototype.rawListeners=function(t){return Hb(this,t,!1)};sn.listenerCount=function(i,t){return typeof i.listenerCount=="function"?i.listenerCount(t):Nb.call(i,t)};sn.prototype.listenerCount=Nb;function Nb(i){var t=this._events;if(t!==void 0){var e=t[i];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}sn.prototype.eventNames=function(){return this._eventsCount>0?_d(this._events):[]};function Pb(i,t){for(var e=new Array(t),o=0;o<t;++o)e[o]=i[o];return e}function gF(i,t){for(;t+1<i.length;t++)i[t]=i[t+1];i.pop()}function dF(i){for(var t=new Array(i.length),e=0;e<t.length;++e)t[e]=i[e].listener||i[e];return t}function pF(i,t){return new Promise(function(e,o){function l(g){i.removeListener(t,n),o(g)}function n(){typeof i.removeListener=="function"&&i.removeListener("error",l),e([].slice.call(arguments))}Mb(i,t,n,{once:!0}),t!=="error"&&fF(i,l,{once:!0})})}function fF(i,t,e){typeof i.on=="function"&&Mb(i,"error",t,e)}function Mb(i,t,e,o){if(typeof i.on=="function")o.once?i.once(t,e):i.on(t,e);else if(typeof i.addEventListener=="function")i.addEventListener(t,function l(n){o.once&&i.removeEventListener(t,l),e(n)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i)}});var Kb=da((aO,Db)=>{Db.exports={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}}});var Wb=da((AO,Ob)=>{"use strict";var mF={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05DC\u05D7\u05E4\u05E9",ja:"\u30B5\u30FC\u30C1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041F\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641C\u7D22",cs:"Vyhled\xE1v\xE1n\xED",hu:"Keres\xE9s",ka:"\u10EB\u10D8\u10D4\u10D1\u10D0",nb:"S\xF8ke",sk:"Vyh\u013Ead\xE1vanie",th:"\u0E04\u0E49\u0E19\u0E2B\u0E32",fi:"Hae",is:"Leita",ko:"\uC218\uC0C9",pl:"Szukaj",sl:"Iskanje",fa:"\u062C\u0633\u062A\u062C\u0648",ru:"\u041F\u043E\u0438\u0441\u043A"};Ob.exports={placeholder:mF}});var Jb=da((zb,Sd)=>{(function(i,t,e){typeof Sd<"u"&&Sd.exports?Sd.exports=e():i[t]=e()})(zb,"subtag",function(){var i="",t=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function e(h){return h.match(t)||[]}function o(h){return e(h).filter(function(m,B){return m&&B})}function l(h){return h=e(h),{language:h[1]||i,extlang:h[2]||i,script:h[3]||i,region:h[4]||i}}function n(h,m,B){Object.defineProperty(h,m,{value:B,enumerable:!0})}function g(h,m,B){function _(E){return e(E)[h]||i}n(_,"pattern",m),n(l,B,_)}return g(1,/^[a-zA-Z]{2,3}$/,"language"),g(2,/^[a-zA-Z]{3}$/,"extlang"),g(3,/^[a-zA-Z]{4}$/,"script"),g(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),n(l,"split",o),l})});var qb=da((lO,jb)=>{"use strict";var CF=Sb(),IF=Eb(),pa=$m(),yF=Vb().EventEmitter,Xb=Kb(),bF=Wb(),vF=Jb();function Yb(i,t){this._eventEmitter=new yF,this.options=pa({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geocoderApi=i}Yb.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,getItemValue:function(i){return i.text!==void 0?i.text:i.place_name},render:function(i){if(i.geometry){var h=i.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--result maplibregl-ctrl-geocoder--result"><svg class="mapboxgl-ctrl-geocoder--result-icon maplibre-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="mapboxgl-ctrl-geocoder--result-title maplibregl-ctrl-geocoder--result-title">'+h[0]+'</div><div class="mapboxgl-ctrl-geocoder--result-address maplibregl-ctrl-geocoder--result-address">'+h.splice(1,h.length).join(",")+"</div></div></div>"}else{var t=i.text,e=t.toLowerCase().indexOf(this.query.toLowerCase()),o=this.query.length,l=t.substring(0,e),n=t.substring(e,e+o),g=t.substring(e+o);return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibregl-ctrl-geocoder--suggestion"><svg class="mapboxgl-ctrl-geocoder--suggestion-icon maplibre-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="mapboxgl-ctrl-geocoder--suggestion-info maplibregl-ctrl-geocoder--suggestion-info"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibregl-ctrl-geocoder--suggestion-title">'+l+'<span class="mapboxgl-ctrl-geocoder--suggestion-match maplibregl-ctrl-geocoder--suggestion-match">'+n+"</span>"+g+"</div></div></div>"}},popupRender:function(i){var t=i.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion maplibre-ctrl-geocoder--suggestion popup-suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title maplibre-ctrl-geocoder--suggestion-title popup-suggestion-title">'+t[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address maplibre-ctrl-geocoder--suggestion-address popup-suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},addTo:function(i){function t(o,l){if(!document.body.contains(l))throw new Error("Element provided to #addTo() exists, but is not in the DOM");var n=o.onAdd();l.appendChild(n)}if(i._controlContainer)i.addControl(this);else if(i instanceof HTMLElement)t(this,i);else if(typeof i=="string"){var e=document.querySelectorAll(i);if(e.length===0)throw new Error("Element ",i,"not found.");if(e.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,e[0])}else throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(i){if(i&&typeof i!="string"&&(this._map=i),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);var t=this.container=document.createElement("div");t.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";var e=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",IF(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);var o=document.createElement("div");o.classList.add("mapboxgl-ctrl-geocoder--pin-right","maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button maplibregl-ctrl-geocoder--button";var l=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(l),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),o.appendChild(this._clearEl),o.appendChild(this._loadingEl),t.appendChild(e),t.appendChild(this._inputEl),t.appendChild(o),this._typeahead=new CF(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),t},createIcon:function(i,t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+i+" maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+i),e.setAttribute("viewBox","0 0 18 18"),e.setAttribute("xml:space","preserve"),e.setAttribute("width",18),e.setAttribute("height",18),"innerHTML"in e)e.innerHTML=t;else{var o=document.createElement("div");o.innerHTML="<svg>"+t.valueOf().toString()+"</svg>";var l=o.firstChild,n=l.firstChild;e.appendChild(n)}return e},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_onPaste:function(i){var t=(i.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t)},_onKeyDown:function(i){var t=27,e=9;if(i.keyCode===t&&this.options.clearAndBlurOnEsc)return this._clear(i),this._inputEl.blur();var o=i.target&&i.target.shadowRoot?i.target.shadowRoot.activeElement:i.target,l=o?o.value:"";if(!l)return this.fresh=!0,i.keyCode!==e&&this.clear(i),this._clearEl.style.display="none";if(!(i.metaKey||[e,t,37,39,38,40].indexOf(i.keyCode)!==-1)){if(i.keyCode===13)if(!this.options.showResultsWhileTyping)this._typeahead.selected||this._geocode(o.value);else{this._typeahead.selected==null&&this.geocoderApi.getSuggestions?this._geocode(o.value,!0):this._typeahead.selected==null&&this.options.showResultMarkers&&this._fitBoundsForMarkers();return}o.value.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(o.value)}},_showButton:function(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")},_hideButton:function(){this._typeahead.selected&&(this._clearEl.style.display="none")},_onBlur:function(i){this.options.clearOnBlur&&this._clearOnBlur(i),this.options.collapsed&&this._collapse()},_onChange:function(){var i=this._typeahead.selected;if(i&&!i.geometry)i.placeId?this._geocode(i.placeId,!0,!0):this._geocode(i.text,!0);else if(i&&JSON.stringify(i)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){var t;if(this._removeResultMarkers(),i.properties&&Xb[i.properties.short_code])t=pa({},this.options.flyTo),this._map&&this._map.fitBounds(Xb[i.properties.short_code].bbox,t);else if(i.bbox){var e=i.bbox;t=pa({},this.options.flyTo),this._map&&this._map.fitBounds([[e[0],e[1]],[e[2],e[3]]],t)}else{var o={zoom:this.options.zoom};t=pa({},o,this.options.flyTo),i.center?t.center=i.center:i.geometry&&i.geometry.type&&i.geometry.type==="Point"&&i.geometry.coordinates&&(t.center=i.geometry.coordinates),this._map&&this._map.flyTo(t)}}this.options.marker&&this._maplibregl&&this._handleMarker(i),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(i),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:i})}},_getConfigForRequest:function(){var i=["bbox","limit","proximity","countries","types","language","reverseMode"],t=this,e=i.reduce(function(o,l){return t.options[l]&&(["countries","types","language"].indexOf(l)>-1?o[l]=t.options[l].split(/[\s,]+/):o[l]=t.options[l],l==="proximity"&&t.options[l]&&typeof t.options[l].longitude=="number"&&typeof t.options[l].latitude=="number"&&(o[l]=[t.options[l].longitude,t.options[l].latitude])),o},{});return e},_geocode:function(i,t,e){this._loadingEl.style.display="block",this._eventEmitter.emit("loading",{query:i}),this.inputString=i;var o=null,l=this._getConfigForRequest(),n;if(this.options.localGeocoderOnly)n=Promise.resolve();else if(this.options.reverseGeocode&&/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/.test(i)){var g=i.split(/[\s(,)?]+/).map(function(B){return parseFloat(B,10)}).reverse();l.types&&l.types[0],l=pa(l,{query:g,limit:1}),"proximity"in l&&delete l.proximity,n=this.geocoderApi.reverseGeocode(l)}else l=pa(l,{query:i}),this.geocoderApi.getSuggestions?t?this.geocoderApi.searchByPlaceId&&e?n=this.geocoderApi.searchByPlaceId(l):n=this.geocoderApi.forwardGeocode(l):n=this.geocoderApi.getSuggestions(l):n=this.geocoderApi.forwardGeocode(l);var h=[];this.options.localGeocoder&&(h=this.options.localGeocoder(i),h||(h=[]));var m=[];return n.catch(function(B){o=B}.bind(this)).then(function(B){this._loadingEl.style.display="none";var _={};return B?_=B:_={type:"FeatureCollection",features:[]},_.config=l,this.fresh&&(this.fresh=!1),_.features=_.features?h.concat(_.features):h,this.options.externalGeocoder?(m=this.options.externalGeocoder(i,_.features,l)||[],m.then(function(E){return _.features=_.features?E.concat(_.features):E,_},function(){return _})):_}.bind(this)).then(function(B){if(o)throw o;this.options.filter&&B.features.length&&(B.features=B.features.filter(this.options.filter));var _=[];B.suggestions?_=B.suggestions:B.place?_=[B.place]:_=B.features,_.length?(this._clearEl.style.display="block",this._typeahead.update(_),(!this.options.showResultsWhileTyping||t)&&this.options.showResultMarkers&&(B.features.length>0||B.place)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",B)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",B))}.bind(this)).catch(function(B){this._loadingEl.style.display="none",h.length&&this.options.localGeocoder||m.length&&this.options.externalGeocoder?(this._clearEl.style.display="block",this._typeahead.update(h)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:h}),this._eventEmitter.emit("error",{error:B})}.bind(this)),n},_clear:function(i){i&&i.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(i){this._clear(i),this._inputEl.focus()},_clearOnBlur:function(i){var t=this;i.relatedTarget&&t._clear(i)},_onQueryResult:function(i){var t=i;if(!!t.features.length){var e=t.features[0];this._typeahead.selected=e,this._inputEl.value=e.place_name,this._onChange()}},_updateProximity:function(){if(!!this._map)if(this._map.getZoom()>9){var i=this._map.getCenter().wrap();this.setProximity({longitude:i.lng,latitude:i.lat})}else this.setProximity(null)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed","maplibregl-ctrl-geocoder--collapsed")},query:function(i){return this._geocode(i).then(this._onQueryResult),this},_renderError:function(){var i="<div class='mapbox-gl-geocoder--error maplibre-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(i)},_renderNoResults:function(){var i="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>No results found</div>";this._renderMessage(i)},_renderMessage:function(i){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(i)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var i=this.options.language.split(",")[0],t=vF.language(i),e=bF.placeholder[t];if(e)return e}return"Search"},_fitBoundsForMarkers:function(){if(!(this._typeahead.data.length<1)){var i=this._typeahead.data.filter(function(l){return typeof l!="string"}).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){var t={padding:100},e=pa({},t,this.options.flyTo),o=new this._maplibregl.LngLatBounds;i.forEach(function(l){o.extend(l.geometry.coordinates)}),this._map.fitBounds(o.toArray(),e)}return i.length>0&&this._maplibregl&&this._handleResultMarkers(i),this}},setInput:function(i){return this._inputEl.value=i,this._typeahead.selected=null,this._typeahead.clear(),i.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(i),this},setProximity:function(i){return this.options.proximity=i,this},getProximity:function(){return this.options.proximity},setRenderFunction:function(i){return i&&typeof i=="function"&&(this._typeahead.render=i),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(i){var t=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=i||this.options.language||t,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(i){return this.options.zoom=i,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(i){return this.options.flyTo=i,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(i){return this.placeholder=i||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(i){return this.options.bbox=i,this},getCountries:function(){return this.options.countries},setCountries:function(i){return this.options.countries=i,this},getTypes:function(){return this.options.types},setTypes:function(i){return this.options.types=i,this},getMinLength:function(){return this.options.minLength},setMinLength:function(i){return this.options.minLength=i,this._typeahead&&(this._typeahead.options.minLength=i),this},getLimit:function(){return this.options.limit},setLimit:function(i){return this.options.limit=i,this._typeahead&&(this._typeahead.options.limit=i),this},getFilter:function(){return this.options.filter},setFilter:function(i){return this.options.filter=i,this},setGeocoderApi:function(i){return this.geocoderApi=i,this},getGeocoderApi:function(){return this.geocoderApi},_handleMarker:function(i){if(!!this._map){this._removeMarker();var t={color:"#4668F2"},e=pa({},t,this.options.marker);this.mapMarker=new this._maplibregl.Marker(e);var o;if(this.options.popup){var l={},n=pa({},l,this.options.popup);o=new this._maplibregl.Popup(n).setHTML(this.options.popupRender(i))}return i.center?(this.mapMarker.setLngLat(i.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)):i.geometry&&i.geometry.type&&i.geometry.type==="Point"&&i.geometry.coordinates&&(this.mapMarker.setLngLat(i.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(o)),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},_handleResultMarkers:function(i){if(!!this._map){this._removeResultMarkers();var t={color:"#4668F2"},e=pa({},t,this.options.showResultMarkers);return i.forEach(function(o){if(this.options.showResultMarkers&&this.options.showResultMarkers.element){var l=this.options.showResultMarkers.element.cloneNode(!0);e=pa(e,{element:l})}var n=new this._maplibregl.Marker(pa({},e,{element:l})),g;if(this.options.popup){var h={},m=pa({},h,this.options.popup);g=new this._maplibregl.Popup(m).setHTML(this.options.popupRender(o))}o.center?(n.setLngLat(o.center).addTo(this._map),this.options.popup&&n.setPopup(g)):o.geometry&&o.geometry.type&&o.geometry.type==="Point"&&o.geometry.coordinates&&(n.setLngLat(o.geometry.coordinates).addTo(this._map),this.options.popup&&n.setPopup(g)),this.resultMarkers.push(n)}.bind(this)),this}},_removeResultMarkers:function(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(i){i.remove()}),this.resultMarkers=[])},on:function(i,t){return this._eventEmitter.on(i,t),this},off:function(i,t){return this._eventEmitter.removeListener(i,t),this}};jb.exports=Yb});var iw={};Ym(iw,{default:()=>OT});function sA(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");wC(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function xo(i,t,e,o){function l(n){return n instanceof e?n:new e(function(g){g(n)})}return new(e||(e=Promise))(function(n,g){function h(_){try{B(o.next(_))}catch(E){g(E)}}function m(_){try{B(o.throw(_))}catch(E){g(E)}}function B(_){_.done?n(_.value):l(_.value).then(h,m)}B((o=o.apply(i,t||[])).next())})}function so(i,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,l,n,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(B){return function(_){return m([B,_])}}function m(B){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,l&&(n=B[0]&2?l.return:B[0]?l.throw||((n=l.return)&&n.call(l),0):l.next)&&!(n=n.call(l,B[1])).done)return n;switch(l=0,n&&(B=[B[0]&2,n.value]),B[0]){case 0:case 1:n=B;break;case 4:return e.label++,{value:B[1],done:!1};case 5:e.label++,l=B[1],B=[0];continue;case 7:B=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(B[0]===6||B[0]===2)){e=0;continue}if(B[0]===3&&(!n||B[1]>n[0]&&B[1]<n[3])){e.label=B[1];break}if(B[0]===6&&e.label<n[1]){e.label=n[1],n=B;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(B);break}n[2]&&e.ops.pop(),e.trys.pop();continue}B=t.call(i,e)}catch(_){B=[6,_],l=0}finally{o=n=0}if(B[0]&5)throw B[1];return{value:B[0]?B[1]:void 0,done:!0}}}function Fd(i,t,e){if(e||arguments.length===2)for(var o=0,l=t.length,n;o<l;o++)(n||!(o in t))&&(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return i.concat(n||t)}function cC(i,t,e){return e<0&&(e+=1),e>=1&&(e-=1),e<1/6?(t-i)*e*6+i:e<1/2?t:e<2/3?(t-i)*6*(2/3-e)+i:i}function wk(i){return!(i.type===20&&i.value==="none")&&(i.type!==18||!!L2[i.name])}var wC,BC,ml,op,wF,ap,qn,$b,BF,Kh,tv,$h,Oh,_F,xF,SF,Dc,WC,rC,FF,$v,kF,nC,LF,EF,TF,QF,UF,GF,RF,ZF,ev,HF,NF,PF,iv,MF,Wh,VF,rv,DF,t2,e2,KF,OF,nv,i2,sv,ec,_C,ov,xC,WF,tg,SC,kd,zh,zF,av,FC,Jh,sC,ku,fa,eg,ig,Lu,JF,Zu,XF,Ld,Ed,kC,LC,EC,ug,TC,Wd,zd,oC,r2,YF,jF,n2,_o,Td,QC,dl,UC,s2,Av,qF,lv,$F,t4,aC,cv,e4,i4,r4,n4,s4,o4,dg,uv,Yd,hv,og,a4,A4,Qd,Xh,l4,c4,u4,Ud,Gd,Yh,h4,zo,g4,d4,p4,f4,m4,C4,I4,y4,Rd,b4,gv,v4,w4,dv,AC,Mc,B4,_4,x4,hg,S4,F4,k4,L4,E4,T4,ZA,o2,a2,A2,Q4,U4,G4,l2,c2,u2,R4,Z4,So,H4,Eu,N4,P4,M4,V4,Zd,jd,pv,D4,tc,Hd,lC,K4,O4,W4,z4,J4,X4,Y4,j4,q4,$4,tk,ek,Nd,ik,rk,nk,sk,ok,ak,Ak,lk,GC,h2,g2,pg,Mu,on,ck,RC,d2,Pu,HA,uk,oc,ls,p2,Ws,zC,ic,rg,In,f2,m2,C2,I2,Ap,y2,b2,Ea,nc,sc,Ls,rc,fv,mv,Cv,hk,ag,fl,gk,dk,lp,Iv,pk,fk,nA,yv,mk,Ck,Pd,Ik,v2,w2,B2,_2,x2,S2,F2,k2,yk,Md,bk,vk,JC,L2,Bk,_k,xk,Sk,Fk,Nu,kk,Lk,cp,Ek,Tk,Qk,Uk,up,Gk,Rk,Zk,Hk,hp,Nk,Pk,Mk,Vk,gp,Dk,Kk,Ok,Wk,zk,Jk,Xk,Yk,jk,qk,qd,$k,tL,bv,eL,iL,ZC,dp,rL,nL,sL,oL,aL,AL,pp,lL,cL,uL,hL,gL,dL,pL,fL,mL,CL,IL,yL,vv,bL,vL,wL,Ag,BL,_L,E2,xL,SL,FL,kL,LL,EL,TL,QL,vs,UL,GL,RL,ZL,HL,wv,NL,PL,ML,VL,DL,KL,Bv,Li,OL,WL,HC,NA,zL,_v,ng,jh,JL,XL,YL,Kc,XC,uC,jL,T2,qL,hC,$L,tE,eE,iE,rE,nE,sE,oE,xv,aE,AE,lE,Sv,cE,qh,uE,gC,dC,Fv,kv,hE,Lv,pC,fC,Ev,Tv,Qv,Uv,mC,gE,dE,pE,Vc,Gv,fE,mE,CE,IE,yE,bE,vE,wE,BE,Rv,_E,NC,Zv,Os,lg,xE,SE,Hv,YC,FE,kE,LE,EE,TE,QE,UE,GE,Q2,U2,G2,R2,PC,RE,ZE,HE,NE,$d,tp,PE,Nv,jC,Z2,H2,N2,ME,Jd,P2,M2,VE,DE,V2,Hu,MC,Xd,KE,OE,WE,zE,D2,qC,K2,Pv,VC,O2,Mv,JE,ep,ip,W2,Vv,XE,Dv,Kv,YE,jE,Tu,z2,jn,Pc,Gu,ql,$l,sg,pl,Ov,Wv,zv,CC,gg,J2,Jv,cg,qE,$E,tT,eT,iT,IC,rT,nT,sT,oT,aT,DC,KC,Xv,AT,lT,X2,cT,uT,hT,gT,dT,yC,pT,bC,fT,xi,Qu,Vd,La,mT,qr,_n,rp,CT,np,IT,Dd,yT,bT,Y2,vT,Yv,wT,j2,q2,OC,$2,BT,jv,_T,xT,ST,Kd,Ta,tw,sp,FT,kT,vC,Uu,Od,LT,Ru,ET,TT,qv,QT,ew,UT,GT,RT,ZT,HT,NT,PT,MT,VT,DT,KT,OT,WT,zT,rw=vd(()=>{wC=function(i,t){return wC=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])},wC(i,t)};BC=function(){return BC=Object.assign||function(i){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(i[l]=t[l])}return i},BC.apply(this,arguments)};ml=function(){function i(t,e,o,l){this.left=t,this.top=e,this.width=o,this.height=l}return i.prototype.add=function(t,e,o,l){return new i(this.left+t,this.top+e,this.width+o,this.height+l)},i.fromClientRect=function(t,e){return new i(e.left+t.windowBounds.left,e.top+t.windowBounds.top,e.width,e.height)},i.fromDOMRectList=function(t,e){var o=Array.from(e).find(function(l){return l.width!==0});return o?new i(o.left+t.windowBounds.left,o.top+t.windowBounds.top,o.width,o.height):i.EMPTY},i.EMPTY=new i(0,0,0,0),i}(),op=function(i,t){return ml.fromClientRect(i,t.getBoundingClientRect())},wF=function(i){var t=i.body,e=i.documentElement;if(!t||!e)throw new Error("Unable to get document size");var o=Math.max(Math.max(t.scrollWidth,e.scrollWidth),Math.max(t.offsetWidth,e.offsetWidth),Math.max(t.clientWidth,e.clientWidth)),l=Math.max(Math.max(t.scrollHeight,e.scrollHeight),Math.max(t.offsetHeight,e.offsetHeight),Math.max(t.clientHeight,e.clientHeight));return new ml(0,0,o,l)},ap=function(i){for(var t=[],e=0,o=i.length;e<o;){var l=i.charCodeAt(e++);if(l>=55296&&l<=56319&&e<o){var n=i.charCodeAt(e++);(n&64512)===56320?t.push(((l&1023)<<10)+(n&1023)+65536):(t.push(l),e--)}else t.push(l)}return t},qn=function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,i);var e=i.length;if(!e)return"";for(var o=[],l=-1,n="";++l<e;){var g=i[l];g<=65535?o.push(g):(g-=65536,o.push((g>>10)+55296,g%1024+56320)),(l+1===e||o.length>16384)&&(n+=String.fromCharCode.apply(String,o),o.length=0)}return n},$b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",BF=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Kh=0;Kh<$b.length;Kh++)BF[$b.charCodeAt(Kh)]=Kh;tv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$h=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Oh=0;Oh<tv.length;Oh++)$h[tv.charCodeAt(Oh)]=Oh;_F=function(i){var t=i.length*.75,e=i.length,o,l=0,n,g,h,m;i[i.length-1]==="="&&(t--,i[i.length-2]==="="&&t--);var B=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),_=Array.isArray(B)?B:new Uint8Array(B);for(o=0;o<e;o+=4)n=$h[i.charCodeAt(o)],g=$h[i.charCodeAt(o+1)],h=$h[i.charCodeAt(o+2)],m=$h[i.charCodeAt(o+3)],_[l++]=n<<2|g>>4,_[l++]=(g&15)<<4|h>>2,_[l++]=(h&3)<<6|m&63;return B},xF=function(i){for(var t=i.length,e=[],o=0;o<t;o+=2)e.push(i[o+1]<<8|i[o]);return e},SF=function(i){for(var t=i.length,e=[],o=0;o<t;o+=4)e.push(i[o+3]<<24|i[o+2]<<16|i[o+1]<<8|i[o]);return e},Dc=5,WC=6+5,rC=2,FF=WC-Dc,$v=65536>>Dc,kF=1<<Dc,nC=kF-1,LF=1024>>Dc,EF=$v+LF,TF=EF,QF=32,UF=TF+QF,GF=65536>>WC,RF=1<<FF,ZF=RF-1,ev=function(i,t,e){return i.slice?i.slice(t,e):new Uint16Array(Array.prototype.slice.call(i,t,e))},HF=function(i,t,e){return i.slice?i.slice(t,e):new Uint32Array(Array.prototype.slice.call(i,t,e))},NF=function(i,t){var e=_F(i),o=Array.isArray(e)?SF(e):new Uint32Array(e),l=Array.isArray(e)?xF(e):new Uint16Array(e),n=24,g=ev(l,n/2,o[4]/2),h=o[5]===2?ev(l,(n+o[4])/2):HF(o,Math.ceil((n+o[4])/4));return new PF(o[0],o[1],o[2],o[3],g,h)},PF=function(){function i(t,e,o,l,n,g){this.initialValue=t,this.errorValue=e,this.highStart=o,this.highValueIndex=l,this.index=n,this.data=g}return i.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=this.index[t>>Dc],e=(e<<rC)+(t&nC),this.data[e];if(t<=65535)return e=this.index[$v+(t-55296>>Dc)],e=(e<<rC)+(t&nC),this.data[e];if(t<this.highStart)return e=UF-GF+(t>>WC),e=this.index[e],e+=t>>Dc&ZF,e=this.index[e],e=(e<<rC)+(t&nC),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},i}(),iv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",MF=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(Wh=0;Wh<iv.length;Wh++)MF[iv.charCodeAt(Wh)]=Wh;VF="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",rv=50,DF=1,t2=2,e2=3,KF=4,OF=5,nv=7,i2=8,sv=9,ec=10,_C=11,ov=12,xC=13,WF=14,tg=15,SC=16,kd=17,zh=18,zF=19,av=20,FC=21,Jh=22,sC=23,ku=24,fa=25,eg=26,ig=27,Lu=28,JF=29,Zu=30,XF=31,Ld=32,Ed=33,kC=34,LC=35,EC=36,ug=37,TC=38,Wd=39,zd=40,oC=41,r2=42,YF=43,jF=[9001,65288],n2="!",_o="\xD7",Td="\xF7",QC=NF(VF),dl=[Zu,EC],UC=[DF,t2,e2,OF],s2=[ec,i2],Av=[ig,eg],qF=UC.concat(s2),lv=[TC,Wd,zd,kC,LC],$F=[tg,xC],t4=function(i,t){t===void 0&&(t="strict");var e=[],o=[],l=[];return i.forEach(function(n,g){var h=QC.get(n);if(h>rv?(l.push(!0),h-=rv):l.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(n)!==-1)return o.push(g),e.push(SC);if(h===KF||h===_C){if(g===0)return o.push(g),e.push(Zu);var m=e[g-1];return qF.indexOf(m)===-1?(o.push(o[g-1]),e.push(m)):(o.push(g),e.push(Zu))}if(o.push(g),h===XF)return e.push(t==="strict"?FC:ug);if(h===r2||h===JF)return e.push(Zu);if(h===YF)return n>=131072&&n<=196605||n>=196608&&n<=262141?e.push(ug):e.push(Zu);e.push(h)}),[o,e,l]},aC=function(i,t,e,o){var l=o[e];if(Array.isArray(i)?i.indexOf(l)!==-1:i===l)for(var n=e;n<=o.length;){n++;var g=o[n];if(g===t)return!0;if(g!==ec)break}if(l===ec)for(var n=e;n>0;){n--;var h=o[n];if(Array.isArray(i)?i.indexOf(h)!==-1:i===h)for(var m=e;m<=o.length;){m++;var g=o[m];if(g===t)return!0;if(g!==ec)break}if(h!==ec)break}return!1},cv=function(i,t){for(var e=i;e>=0;){var o=t[e];if(o===ec)e--;else return o}return 0},e4=function(i,t,e,o,l){if(e[o]===0)return _o;var n=o-1;if(Array.isArray(l)&&l[n]===!0)return _o;var g=n-1,h=n+1,m=t[n],B=g>=0?t[g]:0,_=t[h];if(m===t2&&_===e2)return _o;if(UC.indexOf(m)!==-1)return n2;if(UC.indexOf(_)!==-1||s2.indexOf(_)!==-1)return _o;if(cv(n,t)===i2)return Td;if(QC.get(i[n])===_C||(m===Ld||m===Ed)&&QC.get(i[h])===_C||m===nv||_===nv||m===sv||[ec,xC,tg].indexOf(m)===-1&&_===sv||[kd,zh,zF,ku,Lu].indexOf(_)!==-1||cv(n,t)===Jh||aC(sC,Jh,n,t)||aC([kd,zh],FC,n,t)||aC(ov,ov,n,t))return _o;if(m===ec)return Td;if(m===sC||_===sC)return _o;if(_===SC||m===SC)return Td;if([xC,tg,FC].indexOf(_)!==-1||m===WF||B===EC&&$F.indexOf(m)!==-1||m===Lu&&_===EC||_===av||dl.indexOf(_)!==-1&&m===fa||dl.indexOf(m)!==-1&&_===fa||m===ig&&[ug,Ld,Ed].indexOf(_)!==-1||[ug,Ld,Ed].indexOf(m)!==-1&&_===eg||dl.indexOf(m)!==-1&&Av.indexOf(_)!==-1||Av.indexOf(m)!==-1&&dl.indexOf(_)!==-1||[ig,eg].indexOf(m)!==-1&&(_===fa||[Jh,tg].indexOf(_)!==-1&&t[h+1]===fa)||[Jh,tg].indexOf(m)!==-1&&_===fa||m===fa&&[fa,Lu,ku].indexOf(_)!==-1)return _o;if([fa,Lu,ku,kd,zh].indexOf(_)!==-1)for(var E=n;E>=0;){var G=t[E];if(G===fa)return _o;if([Lu,ku].indexOf(G)!==-1)E--;else break}if([ig,eg].indexOf(_)!==-1)for(var E=[kd,zh].indexOf(m)!==-1?g:n;E>=0;){var G=t[E];if(G===fa)return _o;if([Lu,ku].indexOf(G)!==-1)E--;else break}if(TC===m&&[TC,Wd,kC,LC].indexOf(_)!==-1||[Wd,kC].indexOf(m)!==-1&&[Wd,zd].indexOf(_)!==-1||[zd,LC].indexOf(m)!==-1&&_===zd||lv.indexOf(m)!==-1&&[av,eg].indexOf(_)!==-1||lv.indexOf(_)!==-1&&m===ig||dl.indexOf(m)!==-1&&dl.indexOf(_)!==-1||m===ku&&dl.indexOf(_)!==-1||dl.concat(fa).indexOf(m)!==-1&&_===Jh&&jF.indexOf(i[h])===-1||dl.concat(fa).indexOf(_)!==-1&&m===zh)return _o;if(m===oC&&_===oC){for(var S=e[n],O=1;S>0&&(S--,t[S]===oC);)O++;if(O%2!==0)return _o}return m===Ld&&_===Ed?_o:Td},i4=function(i,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var e=t4(i,t.lineBreak),o=e[0],l=e[1],n=e[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(l=l.map(function(h){return[fa,Zu,r2].indexOf(h)!==-1?ug:h}));var g=t.wordBreak==="keep-all"?n.map(function(h,m){return h&&i[m]>=19968&&i[m]<=40959}):void 0;return[o,l,g]},r4=function(){function i(t,e,o,l){this.codePoints=t,this.required=e===n2,this.start=o,this.end=l}return i.prototype.slice=function(){return qn.apply(void 0,this.codePoints.slice(this.start,this.end))},i}(),n4=function(i,t){var e=ap(i),o=i4(e,t),l=o[0],n=o[1],g=o[2],h=e.length,m=0,B=0;return{next:function(){if(B>=h)return{done:!0,value:null};for(var _=_o;B<h&&(_=e4(e,n,l,++B,g))===_o;);if(_!==_o||B===h){var E=new r4(e,_,m,B);return m=B,{value:E,done:!1}}return{done:!0,value:null}}}},s4=1,o4=2,dg=4,uv=8,Yd=10,hv=47,og=92,a4=9,A4=32,Qd=34,Xh=61,l4=35,c4=36,u4=37,Ud=39,Gd=40,Yh=41,h4=95,zo=45,g4=33,d4=60,p4=62,f4=64,m4=91,C4=93,I4=61,y4=123,Rd=63,b4=125,gv=124,v4=126,w4=128,dv=65533,AC=42,Mc=43,B4=44,_4=58,x4=59,hg=46,S4=0,F4=8,k4=11,L4=14,E4=31,T4=127,ZA=-1,o2=48,a2=97,A2=101,Q4=102,U4=117,G4=122,l2=65,c2=69,u2=70,R4=85,Z4=90,So=function(i){return i>=o2&&i<=57},H4=function(i){return i>=55296&&i<=57343},Eu=function(i){return So(i)||i>=l2&&i<=u2||i>=a2&&i<=Q4},N4=function(i){return i>=a2&&i<=G4},P4=function(i){return i>=l2&&i<=Z4},M4=function(i){return N4(i)||P4(i)},V4=function(i){return i>=w4},Zd=function(i){return i===Yd||i===a4||i===A4},jd=function(i){return M4(i)||V4(i)||i===h4},pv=function(i){return jd(i)||So(i)||i===zo},D4=function(i){return i>=S4&&i<=F4||i===k4||i>=L4&&i<=E4||i===T4},tc=function(i,t){return i!==og?!1:t!==Yd},Hd=function(i,t,e){return i===zo?jd(t)||tc(t,e):jd(i)?!0:!!(i===og&&tc(i,t))},lC=function(i,t,e){return i===Mc||i===zo?So(t)?!0:t===hg&&So(e):So(i===hg?t:i)},K4=function(i){var t=0,e=1;(i[t]===Mc||i[t]===zo)&&(i[t]===zo&&(e=-1),t++);for(var o=[];So(i[t]);)o.push(i[t++]);var l=o.length?parseInt(qn.apply(void 0,o),10):0;i[t]===hg&&t++;for(var n=[];So(i[t]);)n.push(i[t++]);var g=n.length,h=g?parseInt(qn.apply(void 0,n),10):0;(i[t]===c2||i[t]===A2)&&t++;var m=1;(i[t]===Mc||i[t]===zo)&&(i[t]===zo&&(m=-1),t++);for(var B=[];So(i[t]);)B.push(i[t++]);var _=B.length?parseInt(qn.apply(void 0,B),10):0;return e*(l+h*Math.pow(10,-g))*Math.pow(10,m*_)},O4={type:2},W4={type:3},z4={type:4},J4={type:13},X4={type:8},Y4={type:21},j4={type:9},q4={type:10},$4={type:11},tk={type:12},ek={type:14},Nd={type:23},ik={type:1},rk={type:25},nk={type:24},sk={type:26},ok={type:27},ak={type:28},Ak={type:29},lk={type:31},GC={type:32},h2=function(){function i(){this._value=[]}return i.prototype.write=function(t){this._value=this._value.concat(ap(t))},i.prototype.read=function(){for(var t=[],e=this.consumeToken();e!==GC;)t.push(e),e=this.consumeToken();return t},i.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case Qd:return this.consumeStringToken(Qd);case l4:var e=this.peekCodePoint(0),o=this.peekCodePoint(1),l=this.peekCodePoint(2);if(pv(e)||tc(o,l)){var n=Hd(e,o,l)?o4:s4,g=this.consumeName();return{type:5,value:g,flags:n}}break;case c4:if(this.peekCodePoint(0)===Xh)return this.consumeCodePoint(),J4;break;case Ud:return this.consumeStringToken(Ud);case Gd:return O4;case Yh:return W4;case AC:if(this.peekCodePoint(0)===Xh)return this.consumeCodePoint(),ek;break;case Mc:if(lC(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case B4:return z4;case zo:var h=t,m=this.peekCodePoint(0),B=this.peekCodePoint(1);if(lC(h,m,B))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Hd(h,m,B))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(m===zo&&B===p4)return this.consumeCodePoint(),this.consumeCodePoint(),nk;break;case hg:if(lC(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case hv:if(this.peekCodePoint(0)===AC)for(this.consumeCodePoint();;){var _=this.consumeCodePoint();if(_===AC&&(_=this.consumeCodePoint(),_===hv))return this.consumeToken();if(_===ZA)return this.consumeToken()}break;case _4:return sk;case x4:return ok;case d4:if(this.peekCodePoint(0)===g4&&this.peekCodePoint(1)===zo&&this.peekCodePoint(2)===zo)return this.consumeCodePoint(),this.consumeCodePoint(),rk;break;case f4:var E=this.peekCodePoint(0),G=this.peekCodePoint(1),S=this.peekCodePoint(2);if(Hd(E,G,S)){var g=this.consumeName();return{type:7,value:g}}break;case m4:return ak;case og:if(tc(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case C4:return Ak;case I4:if(this.peekCodePoint(0)===Xh)return this.consumeCodePoint(),X4;break;case y4:return $4;case b4:return tk;case U4:case R4:var O=this.peekCodePoint(0),P=this.peekCodePoint(1);return O===Mc&&(Eu(P)||P===Rd)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case gv:if(this.peekCodePoint(0)===Xh)return this.consumeCodePoint(),j4;if(this.peekCodePoint(0)===gv)return this.consumeCodePoint(),Y4;break;case v4:if(this.peekCodePoint(0)===Xh)return this.consumeCodePoint(),q4;break;case ZA:return GC}return Zd(t)?(this.consumeWhiteSpace(),lk):So(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):jd(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:qn(t)}},i.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},i.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},i.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},i.prototype.consumeUnicodeRangeToken=function(){for(var t=[],e=this.consumeCodePoint();Eu(e)&&t.length<6;)t.push(e),e=this.consumeCodePoint();for(var o=!1;e===Rd&&t.length<6;)t.push(e),e=this.consumeCodePoint(),o=!0;if(o){var l=parseInt(qn.apply(void 0,t.map(function(m){return m===Rd?o2:m})),16),n=parseInt(qn.apply(void 0,t.map(function(m){return m===Rd?u2:m})),16);return{type:30,start:l,end:n}}var g=parseInt(qn.apply(void 0,t),16);if(this.peekCodePoint(0)===zo&&Eu(this.peekCodePoint(1))){this.consumeCodePoint(),e=this.consumeCodePoint();for(var h=[];Eu(e)&&h.length<6;)h.push(e),e=this.consumeCodePoint();var n=parseInt(qn.apply(void 0,h),16);return{type:30,start:g,end:n}}else return{type:30,start:g,end:g}},i.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===Gd?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Gd?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},i.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ZA)return{type:22,value:""};var e=this.peekCodePoint(0);if(e===Ud||e===Qd){var o=this.consumeStringToken(this.consumeCodePoint());return o.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ZA||this.peekCodePoint(0)===Yh)?(this.consumeCodePoint(),{type:22,value:o.value}):(this.consumeBadUrlRemnants(),Nd)}for(;;){var l=this.consumeCodePoint();if(l===ZA||l===Yh)return{type:22,value:qn.apply(void 0,t)};if(Zd(l))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ZA||this.peekCodePoint(0)===Yh?(this.consumeCodePoint(),{type:22,value:qn.apply(void 0,t)}):(this.consumeBadUrlRemnants(),Nd);if(l===Qd||l===Ud||l===Gd||D4(l))return this.consumeBadUrlRemnants(),Nd;if(l===og)if(tc(l,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Nd;else t.push(l)}},i.prototype.consumeWhiteSpace=function(){for(;Zd(this.peekCodePoint(0));)this.consumeCodePoint()},i.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===Yh||t===ZA)return;tc(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},i.prototype.consumeStringSlice=function(t){for(var e=5e4,o="";t>0;){var l=Math.min(e,t);o+=qn.apply(void 0,this._value.splice(0,l)),t-=l}return this._value.shift(),o},i.prototype.consumeStringToken=function(t){var e="",o=0;do{var l=this._value[o];if(l===ZA||l===void 0||l===t)return e+=this.consumeStringSlice(o),{type:0,value:e};if(l===Yd)return this._value.splice(0,o),ik;if(l===og){var n=this._value[o+1];n!==ZA&&n!==void 0&&(n===Yd?(e+=this.consumeStringSlice(o),o=-1,this._value.shift()):tc(l,n)&&(e+=this.consumeStringSlice(o),e+=qn(this.consumeEscapedCodePoint()),o=-1))}o++}while(!0)},i.prototype.consumeNumber=function(){var t=[],e=dg,o=this.peekCodePoint(0);for((o===Mc||o===zo)&&t.push(this.consumeCodePoint());So(this.peekCodePoint(0));)t.push(this.consumeCodePoint());o=this.peekCodePoint(0);var l=this.peekCodePoint(1);if(o===hg&&So(l))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=uv;So(this.peekCodePoint(0));)t.push(this.consumeCodePoint());o=this.peekCodePoint(0),l=this.peekCodePoint(1);var n=this.peekCodePoint(2);if((o===c2||o===A2)&&((l===Mc||l===zo)&&So(n)||So(l)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=uv;So(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[K4(t),e]},i.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),e=t[0],o=t[1],l=this.peekCodePoint(0),n=this.peekCodePoint(1),g=this.peekCodePoint(2);if(Hd(l,n,g)){var h=this.consumeName();return{type:15,number:e,flags:o,unit:h}}return l===u4?(this.consumeCodePoint(),{type:16,number:e,flags:o}):{type:17,number:e,flags:o}},i.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Eu(t)){for(var e=qn(t);Eu(this.peekCodePoint(0))&&e.length<6;)e+=qn(this.consumeCodePoint());Zd(this.peekCodePoint(0))&&this.consumeCodePoint();var o=parseInt(e,16);return o===0||H4(o)||o>1114111?dv:o}return t===ZA?dv:t},i.prototype.consumeName=function(){for(var t="";;){var e=this.consumeCodePoint();if(pv(e))t+=qn(e);else if(tc(e,this.peekCodePoint(0)))t+=qn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(e),t}},i}(),g2=function(){function i(t){this._tokens=t}return i.create=function(t){var e=new h2;return e.write(t),new i(e.read())},i.parseValue=function(t){return i.create(t).parseComponentValue()},i.parseValues=function(t){return i.create(t).parseComponentValues()},i.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var e=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return e;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},i.prototype.parseComponentValues=function(){for(var t=[];;){var e=this.consumeComponentValue();if(e.type===32)return t;t.push(e),t.push()}},i.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},i.prototype.consumeSimpleBlock=function(t){for(var e={type:t,values:[]},o=this.consumeToken();;){if(o.type===32||uk(o,t))return e;this.reconsumeToken(o),e.values.push(this.consumeComponentValue()),o=this.consumeToken()}},i.prototype.consumeFunction=function(t){for(var e={name:t.value,values:[],type:18};;){var o=this.consumeToken();if(o.type===32||o.type===3)return e;this.reconsumeToken(o),e.values.push(this.consumeComponentValue())}},i.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?GC:t},i.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},i}(),pg=function(i){return i.type===15},Mu=function(i){return i.type===17},on=function(i){return i.type===20},ck=function(i){return i.type===0},RC=function(i,t){return on(i)&&i.value===t},d2=function(i){return i.type!==31},Pu=function(i){return i.type!==31&&i.type!==4},HA=function(i){var t=[],e=[];return i.forEach(function(o){if(o.type===4){if(e.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(e),e=[];return}o.type!==31&&e.push(o)}),e.length&&t.push(e),t},uk=function(i,t){return t===11&&i.type===12||t===28&&i.type===29?!0:t===2&&i.type===3},oc=function(i){return i.type===17||i.type===15},ls=function(i){return i.type===16||oc(i)},p2=function(i){return i.length>1?[i[0],i[1]]:[i[0]]},Ws={type:17,number:0,flags:dg},zC={type:16,number:50,flags:dg},ic={type:16,number:100,flags:dg},rg=function(i,t,e){var o=i[0],l=i[1];return[In(o,t),In(typeof l<"u"?l:o,e)]},In=function(i,t){if(i.type===16)return i.number/100*t;if(pg(i))switch(i.unit){case"rem":case"em":return 16*i.number;case"px":default:return i.number}return i.number},f2="deg",m2="grad",C2="rad",I2="turn",Ap={name:"angle",parse:function(i,t){if(t.type===15)switch(t.unit){case f2:return Math.PI*t.number/180;case m2:return Math.PI/200*t.number;case C2:return t.number;case I2:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},y2=function(i){return i.type===15&&(i.unit===f2||i.unit===m2||i.unit===C2||i.unit===I2)},b2=function(i){var t=i.filter(on).map(function(e){return e.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Ws,Ws];case"to top":case"bottom":return Ea(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Ws,ic];case"to right":case"left":return Ea(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[ic,ic];case"to bottom":case"top":return Ea(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[ic,Ws];case"to left":case"right":return Ea(270)}return 0},Ea=function(i){return Math.PI*i/180},nc={name:"color",parse:function(i,t){if(t.type===18){var e=hk[t.name];if(typeof e>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return e(i,t.values)}if(t.type===5){if(t.value.length===3){var o=t.value.substring(0,1),l=t.value.substring(1,2),n=t.value.substring(2,3);return rc(parseInt(o+o,16),parseInt(l+l,16),parseInt(n+n,16),1)}if(t.value.length===4){var o=t.value.substring(0,1),l=t.value.substring(1,2),n=t.value.substring(2,3),g=t.value.substring(3,4);return rc(parseInt(o+o,16),parseInt(l+l,16),parseInt(n+n,16),parseInt(g+g,16)/255)}if(t.value.length===6){var o=t.value.substring(0,2),l=t.value.substring(2,4),n=t.value.substring(4,6);return rc(parseInt(o,16),parseInt(l,16),parseInt(n,16),1)}if(t.value.length===8){var o=t.value.substring(0,2),l=t.value.substring(2,4),n=t.value.substring(4,6),g=t.value.substring(6,8);return rc(parseInt(o,16),parseInt(l,16),parseInt(n,16),parseInt(g,16)/255)}}if(t.type===20){var h=fl[t.value.toUpperCase()];if(typeof h<"u")return h}return fl.TRANSPARENT}},sc=function(i){return(255&i)===0},Ls=function(i){var t=255&i,e=255&i>>8,o=255&i>>16,l=255&i>>24;return t<255?"rgba("+l+","+o+","+e+","+t/255+")":"rgb("+l+","+o+","+e+")"},rc=function(i,t,e,o){return(i<<24|t<<16|e<<8|Math.round(o*255)<<0)>>>0},fv=function(i,t){if(i.type===17)return i.number;if(i.type===16){var e=t===3?1:255;return t===3?i.number/100*e:Math.round(i.number/100*e)}return 0},mv=function(i,t){var e=t.filter(Pu);if(e.length===3){var o=e.map(fv),l=o[0],n=o[1],g=o[2];return rc(l,n,g,1)}if(e.length===4){var h=e.map(fv),l=h[0],n=h[1],g=h[2],m=h[3];return rc(l,n,g,m)}return 0};Cv=function(i,t){var e=t.filter(Pu),o=e[0],l=e[1],n=e[2],g=e[3],h=(o.type===17?Ea(o.number):Ap.parse(i,o))/(Math.PI*2),m=ls(l)?l.number/100:0,B=ls(n)?n.number/100:0,_=typeof g<"u"&&ls(g)?In(g,1):1;if(m===0)return rc(B*255,B*255,B*255,1);var E=B<=.5?B*(m+1):B+m-B*m,G=B*2-E,S=cC(G,E,h+1/3),O=cC(G,E,h),P=cC(G,E,h-1/3);return rc(S*255,O*255,P*255,_)},hk={hsl:Cv,hsla:Cv,rgb:mv,rgba:mv},ag=function(i,t){return nc.parse(i,g2.create(t).parseComponentValue())},fl={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},gk={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(i,t){return t.map(function(e){if(on(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},dk={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},lp=function(i,t){var e=nc.parse(i,t[0]),o=t[1];return o&&ls(o)?{color:e,stop:o}:{color:e,stop:null}},Iv=function(i,t){var e=i[0],o=i[i.length-1];e.stop===null&&(e.stop=Ws),o.stop===null&&(o.stop=ic);for(var l=[],n=0,g=0;g<i.length;g++){var h=i[g].stop;if(h!==null){var m=In(h,t);m>n?l.push(m):l.push(n),n=m}else l.push(null)}for(var B=null,g=0;g<l.length;g++){var _=l[g];if(_===null)B===null&&(B=g);else if(B!==null){for(var E=g-B,G=l[B-1],S=(_-G)/(E+1),O=1;O<=E;O++)l[B+O-1]=S*O;B=null}}return i.map(function(P,tt){var z=P.color;return{color:z,stop:Math.max(Math.min(1,l[tt]/t),0)}})},pk=function(i,t,e){var o=t/2,l=e/2,n=In(i[0],t)-o,g=l-In(i[1],e);return(Math.atan2(g,n)+Math.PI*2)%(Math.PI*2)},fk=function(i,t,e){var o=typeof i=="number"?i:pk(i,t,e),l=Math.abs(t*Math.sin(o))+Math.abs(e*Math.cos(o)),n=t/2,g=e/2,h=l/2,m=Math.sin(o-Math.PI/2)*h,B=Math.cos(o-Math.PI/2)*h;return[l,n-B,n+B,g-m,g+m]},nA=function(i,t){return Math.sqrt(i*i+t*t)},yv=function(i,t,e,o,l){var n=[[0,0],[0,t],[i,0],[i,t]];return n.reduce(function(g,h){var m=h[0],B=h[1],_=nA(e-m,o-B);return(l?_<g.optimumDistance:_>g.optimumDistance)?{optimumCorner:h,optimumDistance:_}:g},{optimumDistance:l?1/0:-1/0,optimumCorner:null}).optimumCorner},mk=function(i,t,e,o,l){var n=0,g=0;switch(i.size){case 0:i.shape===0?n=g=Math.min(Math.abs(t),Math.abs(t-o),Math.abs(e),Math.abs(e-l)):i.shape===1&&(n=Math.min(Math.abs(t),Math.abs(t-o)),g=Math.min(Math.abs(e),Math.abs(e-l)));break;case 2:if(i.shape===0)n=g=Math.min(nA(t,e),nA(t,e-l),nA(t-o,e),nA(t-o,e-l));else if(i.shape===1){var h=Math.min(Math.abs(e),Math.abs(e-l))/Math.min(Math.abs(t),Math.abs(t-o)),m=yv(o,l,t,e,!0),B=m[0],_=m[1];n=nA(B-t,(_-e)/h),g=h*n}break;case 1:i.shape===0?n=g=Math.max(Math.abs(t),Math.abs(t-o),Math.abs(e),Math.abs(e-l)):i.shape===1&&(n=Math.max(Math.abs(t),Math.abs(t-o)),g=Math.max(Math.abs(e),Math.abs(e-l)));break;case 3:if(i.shape===0)n=g=Math.max(nA(t,e),nA(t,e-l),nA(t-o,e),nA(t-o,e-l));else if(i.shape===1){var h=Math.max(Math.abs(e),Math.abs(e-l))/Math.max(Math.abs(t),Math.abs(t-o)),E=yv(o,l,t,e,!1),B=E[0],_=E[1];n=nA(B-t,(_-e)/h),g=h*n}break}return Array.isArray(i.size)&&(n=In(i.size[0],o),g=i.size.length===2?In(i.size[1],l):n),[n,g]},Ck=function(i,t){var e=Ea(180),o=[];return HA(t).forEach(function(l,n){if(n===0){var g=l[0];if(g.type===20&&g.value==="to"){e=b2(l);return}else if(y2(g)){e=Ap.parse(i,g);return}}var h=lp(i,l);o.push(h)}),{angle:e,stops:o,type:1}},Pd=function(i,t){var e=Ea(180),o=[];return HA(t).forEach(function(l,n){if(n===0){var g=l[0];if(g.type===20&&["top","left","right","bottom"].indexOf(g.value)!==-1){e=b2(l);return}else if(y2(g)){e=(Ap.parse(i,g)+Ea(270))%Ea(360);return}}var h=lp(i,l);o.push(h)}),{angle:e,stops:o,type:1}},Ik=function(i,t){var e=Ea(180),o=[],l=1,n=0,g=3,h=[];return HA(t).forEach(function(m,B){var _=m[0];if(B===0){if(on(_)&&_.value==="linear"){l=1;return}else if(on(_)&&_.value==="radial"){l=2;return}}if(_.type===18){if(_.name==="from"){var E=nc.parse(i,_.values[0]);o.push({stop:Ws,color:E})}else if(_.name==="to"){var E=nc.parse(i,_.values[0]);o.push({stop:ic,color:E})}else if(_.name==="color-stop"){var G=_.values.filter(Pu);if(G.length===2){var E=nc.parse(i,G[1]),S=G[0];Mu(S)&&o.push({stop:{type:16,number:S.number*100,flags:S.flags},color:E})}}}}),l===1?{angle:(e+Ea(180))%Ea(360),stops:o,type:l}:{size:g,shape:n,stops:o,position:h,type:l}},v2="closest-side",w2="farthest-side",B2="closest-corner",_2="farthest-corner",x2="circle",S2="ellipse",F2="cover",k2="contain",yk=function(i,t){var e=0,o=3,l=[],n=[];return HA(t).forEach(function(g,h){var m=!0;if(h===0){var B=!1;m=g.reduce(function(E,G){if(B)if(on(G))switch(G.value){case"center":return n.push(zC),E;case"top":case"left":return n.push(Ws),E;case"right":case"bottom":return n.push(ic),E}else(ls(G)||oc(G))&&n.push(G);else if(on(G))switch(G.value){case x2:return e=0,!1;case S2:return e=1,!1;case"at":return B=!0,!1;case v2:return o=0,!1;case F2:case w2:return o=1,!1;case k2:case B2:return o=2,!1;case _2:return o=3,!1}else if(oc(G)||ls(G))return Array.isArray(o)||(o=[]),o.push(G),!1;return E},m)}if(m){var _=lp(i,g);l.push(_)}}),{size:o,shape:e,stops:l,position:n,type:2}},Md=function(i,t){var e=0,o=3,l=[],n=[];return HA(t).forEach(function(g,h){var m=!0;if(h===0?m=g.reduce(function(_,E){if(on(E))switch(E.value){case"center":return n.push(zC),!1;case"top":case"left":return n.push(Ws),!1;case"right":case"bottom":return n.push(ic),!1}else if(ls(E)||oc(E))return n.push(E),!1;return _},m):h===1&&(m=g.reduce(function(_,E){if(on(E))switch(E.value){case x2:return e=0,!1;case S2:return e=1,!1;case k2:case v2:return o=0,!1;case w2:return o=1,!1;case B2:return o=2,!1;case F2:case _2:return o=3,!1}else if(oc(E)||ls(E))return Array.isArray(o)||(o=[]),o.push(E),!1;return _},m)),m){var B=lp(i,g);l.push(B)}}),{size:o,shape:e,stops:l,position:n,type:2}},bk=function(i){return i.type===1},vk=function(i){return i.type===2},JC={name:"image",parse:function(i,t){if(t.type===22){var e={url:t.value,type:0};return i.cache.addImage(t.value),e}if(t.type===18){var o=L2[t.name];if(typeof o>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return o(i,t.values)}throw new Error("Unsupported image type "+t.type)}};L2={"linear-gradient":Ck,"-moz-linear-gradient":Pd,"-ms-linear-gradient":Pd,"-o-linear-gradient":Pd,"-webkit-linear-gradient":Pd,"radial-gradient":yk,"-moz-radial-gradient":Md,"-ms-radial-gradient":Md,"-o-radial-gradient":Md,"-webkit-radial-gradient":Md,"-webkit-gradient":Ik},Bk={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(i,t){if(t.length===0)return[];var e=t[0];return e.type===20&&e.value==="none"?[]:t.filter(function(o){return Pu(o)&&wk(o)}).map(function(o){return JC.parse(i,o)})}},_k={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(i,t){return t.map(function(e){if(on(e))switch(e.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},xk={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(i,t){return HA(t).map(function(e){return e.filter(ls)}).map(p2)}},Sk={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(i,t){return HA(t).map(function(e){return e.filter(on).map(function(o){return o.value}).join(" ")}).map(Fk)}},Fk=function(i){switch(i){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}};(function(i){i.AUTO="auto",i.CONTAIN="contain",i.COVER="cover"})(Nu||(Nu={}));kk={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(i,t){return HA(t).map(function(e){return e.filter(Lk)})}},Lk=function(i){return on(i)||ls(i)},cp=function(i){return{name:"border-"+i+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Ek=cp("top"),Tk=cp("right"),Qk=cp("bottom"),Uk=cp("left"),up=function(i){return{name:"border-radius-"+i,initialValue:"0 0",prefix:!1,type:1,parse:function(t,e){return p2(e.filter(ls))}}},Gk=up("top-left"),Rk=up("top-right"),Zk=up("bottom-right"),Hk=up("bottom-left"),hp=function(i){return{name:"border-"+i+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,e){switch(e){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Nk=hp("top"),Pk=hp("right"),Mk=hp("bottom"),Vk=hp("left"),gp=function(i){return{name:"border-"+i+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return pg(e)?e.number:0}}},Dk=gp("top"),Kk=gp("right"),Ok=gp("bottom"),Wk=gp("left"),zk={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Jk={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(i,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},Xk={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(i,t){return t.filter(on).reduce(function(e,o){return e|Yk(o.value)},0)}},Yk=function(i){switch(i){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},jk={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(i,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},qk={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(i,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}};(function(i){i.NORMAL="normal",i.STRICT="strict"})(qd||(qd={}));$k={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(i,t){switch(t){case"strict":return qd.STRICT;case"normal":default:return qd.NORMAL}}},tL={name:"line-height",initialValue:"normal",prefix:!1,type:4},bv=function(i,t){return on(i)&&i.value==="normal"?1.2*t:i.type===17?t*i.number:ls(i)?In(i,t):t},eL={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(i,t){return t.type===20&&t.value==="none"?null:JC.parse(i,t)}},iL={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(i,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},ZC={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(i,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},dp=function(i){return{name:"margin-"+i,initialValue:"0",prefix:!1,type:4}},rL=dp("top"),nL=dp("right"),sL=dp("bottom"),oL=dp("left"),aL={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(i,t){return t.filter(on).map(function(e){switch(e.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},AL={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(i,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},pp=function(i){return{name:"padding-"+i,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},lL=pp("top"),cL=pp("right"),uL=pp("bottom"),hL=pp("left"),gL={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(i,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},dL={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(i,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},pL={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(i,t){return t.length===1&&RC(t[0],"none")?[]:HA(t).map(function(e){for(var o={color:fl.TRANSPARENT,offsetX:Ws,offsetY:Ws,blur:Ws},l=0,n=0;n<e.length;n++){var g=e[n];oc(g)?(l===0?o.offsetX=g:l===1?o.offsetY=g:o.blur=g,l++):o.color=nc.parse(i,g)}return o})}},fL={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(i,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},mL={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(i,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var e=yL[t.name];if(typeof e>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return e(t.values)}return null}},CL=function(i){var t=i.filter(function(e){return e.type===17}).map(function(e){return e.number});return t.length===6?t:null},IL=function(i){var t=i.filter(function(m){return m.type===17}).map(function(m){return m.number}),e=t[0],o=t[1];t[2],t[3];var l=t[4],n=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var g=t[12],h=t[13];return t[14],t[15],t.length===16?[e,o,l,n,g,h]:null},yL={matrix:CL,matrix3d:IL},vv={type:16,number:50,flags:dg},bL=[vv,vv],vL={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(i,t){var e=t.filter(ls);return e.length!==2?bL:[e[0],e[1]]}},wL={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(i,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}};(function(i){i.NORMAL="normal",i.BREAK_ALL="break-all",i.KEEP_ALL="keep-all"})(Ag||(Ag={}));BL={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(i,t){switch(t){case"break-all":return Ag.BREAK_ALL;case"keep-all":return Ag.KEEP_ALL;case"normal":default:return Ag.NORMAL}}},_L={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(i,t){if(t.type===20)return{auto:!0,order:0};if(Mu(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},E2={name:"time",parse:function(i,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},xL={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(i,t){return Mu(t)?t.number:1}},SL={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},FL={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(i,t){return t.filter(on).map(function(e){switch(e.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(e){return e!==0})}},kL={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(i,t){var e=[],o=[];return t.forEach(function(l){switch(l.type){case 20:case 0:e.push(l.value);break;case 17:e.push(l.number.toString());break;case 4:o.push(e.join(" ")),e.length=0;break}}),e.length&&o.push(e.join(" ")),o.map(function(l){return l.indexOf(" ")===-1?l:"'"+l+"'"})}},LL={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},EL={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(i,t){if(Mu(t))return t.number;if(on(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},TL={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(i,t){return t.filter(on).map(function(e){return e.value})}},QL={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(i,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},vs=function(i,t){return(i&t)!==0},UL={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(i,t){if(t.length===0)return[];var e=t[0];return e.type===20&&e.value==="none"?[]:t}},GL={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(i,t){if(t.length===0)return null;var e=t[0];if(e.type===20&&e.value==="none")return null;for(var o=[],l=t.filter(d2),n=0;n<l.length;n++){var g=l[n],h=l[n+1];if(g.type===20){var m=h&&Mu(h)?h.number:1;o.push({counter:g.value,increment:m})}}return o}},RL={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(i,t){if(t.length===0)return[];for(var e=[],o=t.filter(d2),l=0;l<o.length;l++){var n=o[l],g=o[l+1];if(on(n)&&n.value!=="none"){var h=g&&Mu(g)?g.number:0;e.push({counter:n.value,reset:h})}}return e}},ZL={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(i,t){return t.filter(pg).map(function(e){return E2.parse(i,e)})}},HL={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(i,t){if(t.length===0)return null;var e=t[0];if(e.type===20&&e.value==="none")return null;var o=[],l=t.filter(ck);if(l.length%2!==0)return null;for(var n=0;n<l.length;n+=2){var g=l[n].value,h=l[n+1].value;o.push({open:g,close:h})}return o}},wv=function(i,t,e){if(!i)return"";var o=i[Math.min(t,i.length-1)];return o?e?o.open:o.close:""},NL={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(i,t){return t.length===1&&RC(t[0],"none")?[]:HA(t).map(function(e){for(var o={color:255,offsetX:Ws,offsetY:Ws,blur:Ws,spread:Ws,inset:!1},l=0,n=0;n<e.length;n++){var g=e[n];RC(g,"inset")?o.inset=!0:oc(g)?(l===0?o.offsetX=g:l===1?o.offsetY=g:l===2?o.blur=g:o.spread=g,l++):o.color=nc.parse(i,g)}return o})}},PL={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(i,t){var e=[0,1,2],o=[];return t.filter(on).forEach(function(l){switch(l.value){case"stroke":o.push(1);break;case"fill":o.push(0);break;case"markers":o.push(2);break}}),e.forEach(function(l){o.indexOf(l)===-1&&o.push(l)}),o}},ML={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},VL={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(i,t){return pg(t)?t.number:0}},DL=function(){function i(t,e){var o,l;this.animationDuration=Li(t,ZL,e.animationDuration),this.backgroundClip=Li(t,gk,e.backgroundClip),this.backgroundColor=Li(t,dk,e.backgroundColor),this.backgroundImage=Li(t,Bk,e.backgroundImage),this.backgroundOrigin=Li(t,_k,e.backgroundOrigin),this.backgroundPosition=Li(t,xk,e.backgroundPosition),this.backgroundRepeat=Li(t,Sk,e.backgroundRepeat),this.backgroundSize=Li(t,kk,e.backgroundSize),this.borderTopColor=Li(t,Ek,e.borderTopColor),this.borderRightColor=Li(t,Tk,e.borderRightColor),this.borderBottomColor=Li(t,Qk,e.borderBottomColor),this.borderLeftColor=Li(t,Uk,e.borderLeftColor),this.borderTopLeftRadius=Li(t,Gk,e.borderTopLeftRadius),this.borderTopRightRadius=Li(t,Rk,e.borderTopRightRadius),this.borderBottomRightRadius=Li(t,Zk,e.borderBottomRightRadius),this.borderBottomLeftRadius=Li(t,Hk,e.borderBottomLeftRadius),this.borderTopStyle=Li(t,Nk,e.borderTopStyle),this.borderRightStyle=Li(t,Pk,e.borderRightStyle),this.borderBottomStyle=Li(t,Mk,e.borderBottomStyle),this.borderLeftStyle=Li(t,Vk,e.borderLeftStyle),this.borderTopWidth=Li(t,Dk,e.borderTopWidth),this.borderRightWidth=Li(t,Kk,e.borderRightWidth),this.borderBottomWidth=Li(t,Ok,e.borderBottomWidth),this.borderLeftWidth=Li(t,Wk,e.borderLeftWidth),this.boxShadow=Li(t,NL,e.boxShadow),this.color=Li(t,zk,e.color),this.direction=Li(t,Jk,e.direction),this.display=Li(t,Xk,e.display),this.float=Li(t,jk,e.cssFloat),this.fontFamily=Li(t,kL,e.fontFamily),this.fontSize=Li(t,LL,e.fontSize),this.fontStyle=Li(t,QL,e.fontStyle),this.fontVariant=Li(t,TL,e.fontVariant),this.fontWeight=Li(t,EL,e.fontWeight),this.letterSpacing=Li(t,qk,e.letterSpacing),this.lineBreak=Li(t,$k,e.lineBreak),this.lineHeight=Li(t,tL,e.lineHeight),this.listStyleImage=Li(t,eL,e.listStyleImage),this.listStylePosition=Li(t,iL,e.listStylePosition),this.listStyleType=Li(t,ZC,e.listStyleType),this.marginTop=Li(t,rL,e.marginTop),this.marginRight=Li(t,nL,e.marginRight),this.marginBottom=Li(t,sL,e.marginBottom),this.marginLeft=Li(t,oL,e.marginLeft),this.opacity=Li(t,xL,e.opacity);var n=Li(t,aL,e.overflow);this.overflowX=n[0],this.overflowY=n[n.length>1?1:0],this.overflowWrap=Li(t,AL,e.overflowWrap),this.paddingTop=Li(t,lL,e.paddingTop),this.paddingRight=Li(t,cL,e.paddingRight),this.paddingBottom=Li(t,uL,e.paddingBottom),this.paddingLeft=Li(t,hL,e.paddingLeft),this.paintOrder=Li(t,PL,e.paintOrder),this.position=Li(t,dL,e.position),this.textAlign=Li(t,gL,e.textAlign),this.textDecorationColor=Li(t,SL,(o=e.textDecorationColor)!==null&&o!==void 0?o:e.color),this.textDecorationLine=Li(t,FL,(l=e.textDecorationLine)!==null&&l!==void 0?l:e.textDecoration),this.textShadow=Li(t,pL,e.textShadow),this.textTransform=Li(t,fL,e.textTransform),this.transform=Li(t,mL,e.transform),this.transformOrigin=Li(t,vL,e.transformOrigin),this.visibility=Li(t,wL,e.visibility),this.webkitTextStrokeColor=Li(t,ML,e.webkitTextStrokeColor),this.webkitTextStrokeWidth=Li(t,VL,e.webkitTextStrokeWidth),this.wordBreak=Li(t,BL,e.wordBreak),this.zIndex=Li(t,_L,e.zIndex)}return i.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},i.prototype.isTransparent=function(){return sc(this.backgroundColor)},i.prototype.isTransformed=function(){return this.transform!==null},i.prototype.isPositioned=function(){return this.position!==0},i.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},i.prototype.isFloating=function(){return this.float!==0},i.prototype.isInlineLevel=function(){return vs(this.display,4)||vs(this.display,33554432)||vs(this.display,268435456)||vs(this.display,536870912)||vs(this.display,67108864)||vs(this.display,134217728)},i}(),KL=function(){function i(t,e){this.content=Li(t,UL,e.content),this.quotes=Li(t,HL,e.quotes)}return i}(),Bv=function(){function i(t,e){this.counterIncrement=Li(t,GL,e.counterIncrement),this.counterReset=Li(t,RL,e.counterReset)}return i}(),Li=function(i,t,e){var o=new h2,l=e!==null&&typeof e<"u"?e.toString():t.initialValue;o.write(l);var n=new g2(o.read());switch(t.type){case 2:var g=n.parseComponentValue();return t.parse(i,on(g)?g.value:t.initialValue);case 0:return t.parse(i,n.parseComponentValue());case 1:return t.parse(i,n.parseComponentValues());case 4:return n.parseComponentValue();case 3:switch(t.format){case"angle":return Ap.parse(i,n.parseComponentValue());case"color":return nc.parse(i,n.parseComponentValue());case"image":return JC.parse(i,n.parseComponentValue());case"length":var h=n.parseComponentValue();return oc(h)?h:Ws;case"length-percentage":var m=n.parseComponentValue();return ls(m)?m:Ws;case"time":return E2.parse(i,n.parseComponentValue())}break}},OL="data-html2canvas-debug",WL=function(i){var t=i.getAttribute(OL);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},HC=function(i,t){var e=WL(i);return e===1||t===e},NA=function(){function i(t,e){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,HC(e,3))debugger;this.styles=new DL(t,window.getComputedStyle(e,null)),MC(e)&&(this.styles.animationDuration.some(function(o){return o>0})&&(e.style.animationDuration="0s"),this.styles.transform!==null&&(e.style.transform="none")),this.bounds=op(this.context,e),HC(e,4)&&(this.flags|=16)}return i}(),zL="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",_v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ng=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(jh=0;jh<_v.length;jh++)ng[_v.charCodeAt(jh)]=jh;JL=function(i){var t=i.length*.75,e=i.length,o,l=0,n,g,h,m;i[i.length-1]==="="&&(t--,i[i.length-2]==="="&&t--);var B=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),_=Array.isArray(B)?B:new Uint8Array(B);for(o=0;o<e;o+=4)n=ng[i.charCodeAt(o)],g=ng[i.charCodeAt(o+1)],h=ng[i.charCodeAt(o+2)],m=ng[i.charCodeAt(o+3)],_[l++]=n<<2|g>>4,_[l++]=(g&15)<<4|h>>2,_[l++]=(h&3)<<6|m&63;return B},XL=function(i){for(var t=i.length,e=[],o=0;o<t;o+=2)e.push(i[o+1]<<8|i[o]);return e},YL=function(i){for(var t=i.length,e=[],o=0;o<t;o+=4)e.push(i[o+3]<<24|i[o+2]<<16|i[o+1]<<8|i[o]);return e},Kc=5,XC=6+5,uC=2,jL=XC-Kc,T2=65536>>Kc,qL=1<<Kc,hC=qL-1,$L=1024>>Kc,tE=T2+$L,eE=tE,iE=32,rE=eE+iE,nE=65536>>XC,sE=1<<jL,oE=sE-1,xv=function(i,t,e){return i.slice?i.slice(t,e):new Uint16Array(Array.prototype.slice.call(i,t,e))},aE=function(i,t,e){return i.slice?i.slice(t,e):new Uint32Array(Array.prototype.slice.call(i,t,e))},AE=function(i,t){var e=JL(i),o=Array.isArray(e)?YL(e):new Uint32Array(e),l=Array.isArray(e)?XL(e):new Uint16Array(e),n=24,g=xv(l,n/2,o[4]/2),h=o[5]===2?xv(l,(n+o[4])/2):aE(o,Math.ceil((n+o[4])/4));return new lE(o[0],o[1],o[2],o[3],g,h)},lE=function(){function i(t,e,o,l,n,g){this.initialValue=t,this.errorValue=e,this.highStart=o,this.highValueIndex=l,this.index=n,this.data=g}return i.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=this.index[t>>Kc],e=(e<<uC)+(t&hC),this.data[e];if(t<=65535)return e=this.index[T2+(t-55296>>Kc)],e=(e<<uC)+(t&hC),this.data[e];if(t<this.highStart)return e=rE-nE+(t>>XC),e=this.index[e],e+=t>>Kc&oE,e=this.index[e],e=(e<<uC)+(t&hC),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},i}(),Sv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cE=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(qh=0;qh<Sv.length;qh++)cE[Sv.charCodeAt(qh)]=qh;uE=1,gC=2,dC=3,Fv=4,kv=5,hE=7,Lv=8,pC=9,fC=10,Ev=11,Tv=12,Qv=13,Uv=14,mC=15,gE=function(i){for(var t=[],e=0,o=i.length;e<o;){var l=i.charCodeAt(e++);if(l>=55296&&l<=56319&&e<o){var n=i.charCodeAt(e++);(n&64512)===56320?t.push(((l&1023)<<10)+(n&1023)+65536):(t.push(l),e--)}else t.push(l)}return t},dE=function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,i);var e=i.length;if(!e)return"";for(var o=[],l=-1,n="";++l<e;){var g=i[l];g<=65535?o.push(g):(g-=65536,o.push((g>>10)+55296,g%1024+56320)),(l+1===e||o.length>16384)&&(n+=String.fromCharCode.apply(String,o),o.length=0)}return n},pE=AE(zL),Vc="\xD7",Gv="\xF7",fE=function(i){return pE.get(i)},mE=function(i,t,e){var o=e-2,l=t[o],n=t[e-1],g=t[e];if(n===gC&&g===dC)return Vc;if(n===gC||n===dC||n===Fv||g===gC||g===dC||g===Fv)return Gv;if(n===Lv&&[Lv,pC,Ev,Tv].indexOf(g)!==-1||(n===Ev||n===pC)&&(g===pC||g===fC)||(n===Tv||n===fC)&&g===fC||g===Qv||g===kv||g===hE||n===uE)return Vc;if(n===Qv&&g===Uv){for(;l===kv;)l=t[--o];if(l===Uv)return Vc}if(n===mC&&g===mC){for(var h=0;l===mC;)h++,l=t[--o];if(h%2===0)return Vc}return Gv},CE=function(i){var t=gE(i),e=t.length,o=0,l=0,n=t.map(fE);return{next:function(){if(o>=e)return{done:!0,value:null};for(var g=Vc;o<e&&(g=mE(t,n,++o))===Vc;);if(g!==Vc||o===e){var h=dE.apply(null,t.slice(l,o));return l=o,{value:h,done:!1}}return{done:!0,value:null}}}},IE=function(i){for(var t=CE(i),e=[],o;!(o=t.next()).done;)o.value&&e.push(o.value.slice());return e},yE=function(i){var t=123;if(i.createRange){var e=i.createRange();if(e.getBoundingClientRect){var o=i.createElement("boundtest");o.style.height=t+"px",o.style.display="block",i.body.appendChild(o),e.selectNode(o);var l=e.getBoundingClientRect(),n=Math.round(l.height);if(i.body.removeChild(o),n===t)return!0}}return!1},bE=function(i){var t=i.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",i.body.appendChild(t);var e=i.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var o=t.firstChild,l=ap(o.data).map(function(m){return qn(m)}),n=0,g={},h=l.every(function(m,B){e.setStart(o,n),e.setEnd(o,n+m.length);var _=e.getBoundingClientRect();n+=m.length;var E=_.x>g.x||_.y>g.y;return g=_,B===0?!0:E});return i.body.removeChild(t),h},vE=function(){return typeof new Image().crossOrigin<"u"},wE=function(){return typeof new XMLHttpRequest().responseType=="string"},BE=function(i){var t=new Image,e=i.createElement("canvas"),o=e.getContext("2d");if(!o)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{o.drawImage(t,0,0),e.toDataURL()}catch{return!1}return!0},Rv=function(i){return i[0]===0&&i[1]===255&&i[2]===0&&i[3]===255},_E=function(i){var t=i.createElement("canvas"),e=100;t.width=e,t.height=e;var o=t.getContext("2d");if(!o)return Promise.reject(!1);o.fillStyle="rgb(0, 255, 0)",o.fillRect(0,0,e,e);var l=new Image,n=t.toDataURL();l.src=n;var g=NC(e,e,0,0,l);return o.fillStyle="red",o.fillRect(0,0,e,e),Zv(g).then(function(h){o.drawImage(h,0,0);var m=o.getImageData(0,0,e,e).data;o.fillStyle="red",o.fillRect(0,0,e,e);var B=i.createElement("div");return B.style.backgroundImage="url("+n+")",B.style.height=e+"px",Rv(m)?Zv(NC(e,e,0,0,B)):Promise.reject(!1)}).then(function(h){return o.drawImage(h,0,0),Rv(o.getImageData(0,0,e,e).data)}).catch(function(){return!1})},NC=function(i,t,e,o,l){var n="http://www.w3.org/2000/svg",g=document.createElementNS(n,"svg"),h=document.createElementNS(n,"foreignObject");return g.setAttributeNS(null,"width",i.toString()),g.setAttributeNS(null,"height",t.toString()),h.setAttributeNS(null,"width","100%"),h.setAttributeNS(null,"height","100%"),h.setAttributeNS(null,"x",e.toString()),h.setAttributeNS(null,"y",o.toString()),h.setAttributeNS(null,"externalResourcesRequired","true"),g.appendChild(h),h.appendChild(l),g},Zv=function(i){return new Promise(function(t,e){var o=new Image;o.onload=function(){return t(o)},o.onerror=e,o.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(i))})},Os={get SUPPORT_RANGE_BOUNDS(){var i=yE(document);return Object.defineProperty(Os,"SUPPORT_RANGE_BOUNDS",{value:i}),i},get SUPPORT_WORD_BREAKING(){var i=Os.SUPPORT_RANGE_BOUNDS&&bE(document);return Object.defineProperty(Os,"SUPPORT_WORD_BREAKING",{value:i}),i},get SUPPORT_SVG_DRAWING(){var i=BE(document);return Object.defineProperty(Os,"SUPPORT_SVG_DRAWING",{value:i}),i},get SUPPORT_FOREIGNOBJECT_DRAWING(){var i=typeof Array.from=="function"&&typeof window.fetch=="function"?_E(document):Promise.resolve(!1);return Object.defineProperty(Os,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:i}),i},get SUPPORT_CORS_IMAGES(){var i=vE();return Object.defineProperty(Os,"SUPPORT_CORS_IMAGES",{value:i}),i},get SUPPORT_RESPONSE_TYPE(){var i=wE();return Object.defineProperty(Os,"SUPPORT_RESPONSE_TYPE",{value:i}),i},get SUPPORT_CORS_XHR(){var i="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Os,"SUPPORT_CORS_XHR",{value:i}),i},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var i=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Os,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:i}),i}},lg=function(){function i(t,e){this.text=t,this.bounds=e}return i}(),xE=function(i,t,e,o){var l=kE(t,e),n=[],g=0;return l.forEach(function(h){if(e.textDecorationLine.length||h.trim().length>0)if(Os.SUPPORT_RANGE_BOUNDS){var m=Hv(o,g,h.length).getClientRects();if(m.length>1){var B=YC(h),_=0;B.forEach(function(G){n.push(new lg(G,ml.fromDOMRectList(i,Hv(o,_+g,G.length).getClientRects()))),_+=G.length})}else n.push(new lg(h,ml.fromDOMRectList(i,m)))}else{var E=o.splitText(h.length);n.push(new lg(h,SE(i,o))),o=E}else Os.SUPPORT_RANGE_BOUNDS||(o=o.splitText(h.length));g+=h.length}),n},SE=function(i,t){var e=t.ownerDocument;if(e){var o=e.createElement("html2canvaswrapper");o.appendChild(t.cloneNode(!0));var l=t.parentNode;if(l){l.replaceChild(o,t);var n=op(i,o);return o.firstChild&&l.replaceChild(o.firstChild,o),n}}return ml.EMPTY},Hv=function(i,t,e){var o=i.ownerDocument;if(!o)throw new Error("Node has no owner document");var l=o.createRange();return l.setStart(i,t),l.setEnd(i,t+e),l},YC=function(i){if(Os.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(i)).map(function(e){return e.segment})}return IE(i)},FE=function(i,t){if(Os.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(e.segment(i)).map(function(o){return o.segment})}return EE(i,t)},kE=function(i,t){return t.letterSpacing!==0?YC(i):FE(i,t)},LE=[32,160,4961,65792,65793,4153,4241],EE=function(i,t){for(var e=n4(i,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),o=[],l,n=function(){if(l.value){var g=l.value.slice(),h=ap(g),m="";h.forEach(function(B){LE.indexOf(B)===-1?m+=qn(B):(m.length&&o.push(m),o.push(qn(B)),m="")}),m.length&&o.push(m)}};!(l=e.next()).done;)n();return o},TE=function(){function i(t,e,o){this.text=QE(e.data,o.textTransform),this.textBounds=xE(t,this.text,o,e)}return i}(),QE=function(i,t){switch(t){case 1:return i.toLowerCase();case 3:return i.replace(UE,GE);case 2:return i.toUpperCase();default:return i}},UE=/(^|\s|:|-|\(|\))([a-z])/g,GE=function(i,t,e){return i.length>0?t+e.toUpperCase():i},Q2=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this;return l.src=o.currentSrc||o.src,l.intrinsicWidth=o.naturalWidth,l.intrinsicHeight=o.naturalHeight,l.context.cache.addImage(l.src),l}return t}(NA),U2=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this;return l.canvas=o,l.intrinsicWidth=o.width,l.intrinsicHeight=o.height,l}return t}(NA),G2=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this,n=new XMLSerializer,g=op(e,o);return o.setAttribute("width",g.width+"px"),o.setAttribute("height",g.height+"px"),l.svg="data:image/svg+xml,"+encodeURIComponent(n.serializeToString(o)),l.intrinsicWidth=o.width.baseVal.value,l.intrinsicHeight=o.height.baseVal.value,l.context.cache.addImage(l.svg),l}return t}(NA),R2=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this;return l.value=o.value,l}return t}(NA),PC=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this;return l.start=o.start,l.reversed=typeof o.reversed=="boolean"&&o.reversed===!0,l}return t}(NA),RE=[{type:15,flags:0,unit:"px",number:3}],ZE=[{type:16,flags:0,number:50}],HE=function(i){return i.width>i.height?new ml(i.left+(i.width-i.height)/2,i.top,i.height,i.height):i.width<i.height?new ml(i.left,i.top+(i.height-i.width)/2,i.width,i.width):i},NE=function(i){var t=i.type===PE?new Array(i.value.length+1).join("\u2022"):i.value;return t.length===0?i.placeholder||"":t},$d="checkbox",tp="radio",PE="password",Nv=707406591,jC=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this;switch(l.type=o.type.toLowerCase(),l.checked=o.checked,l.value=NE(o),(l.type===$d||l.type===tp)&&(l.styles.backgroundColor=3739148031,l.styles.borderTopColor=l.styles.borderRightColor=l.styles.borderBottomColor=l.styles.borderLeftColor=2779096575,l.styles.borderTopWidth=l.styles.borderRightWidth=l.styles.borderBottomWidth=l.styles.borderLeftWidth=1,l.styles.borderTopStyle=l.styles.borderRightStyle=l.styles.borderBottomStyle=l.styles.borderLeftStyle=1,l.styles.backgroundClip=[0],l.styles.backgroundOrigin=[0],l.bounds=HE(l.bounds)),l.type){case $d:l.styles.borderTopRightRadius=l.styles.borderTopLeftRadius=l.styles.borderBottomRightRadius=l.styles.borderBottomLeftRadius=RE;break;case tp:l.styles.borderTopRightRadius=l.styles.borderTopLeftRadius=l.styles.borderBottomRightRadius=l.styles.borderBottomLeftRadius=ZE;break}return l}return t}(NA),Z2=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this,n=o.options[o.selectedIndex||0];return l.value=n&&n.text||"",l}return t}(NA),H2=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this;return l.value=o.value,l}return t}(NA),N2=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this;l.src=o.src,l.width=parseInt(o.width,10)||0,l.height=parseInt(o.height,10)||0,l.backgroundColor=l.styles.backgroundColor;try{if(o.contentWindow&&o.contentWindow.document&&o.contentWindow.document.documentElement){l.tree=M2(e,o.contentWindow.document.documentElement);var n=o.contentWindow.document.documentElement?ag(e,getComputedStyle(o.contentWindow.document.documentElement).backgroundColor):fl.TRANSPARENT,g=o.contentWindow.document.body?ag(e,getComputedStyle(o.contentWindow.document.body).backgroundColor):fl.TRANSPARENT;l.backgroundColor=sc(n)?sc(g)?l.styles.backgroundColor:g:n}}catch{}return l}return t}(NA),ME=["OL","UL","MENU"],Jd=function(i,t,e,o){for(var l=t.firstChild,n=void 0;l;l=n)if(n=l.nextSibling,V2(l)&&l.data.trim().length>0)e.textNodes.push(new TE(i,l,e.styles));else if(Hu(l))if(W2(l)&&l.assignedNodes)l.assignedNodes().forEach(function(h){return Jd(i,h,e,o)});else{var g=P2(i,l);g.styles.isVisible()&&(VE(l,g,o)?g.flags|=4:DE(g.styles)&&(g.flags|=2),ME.indexOf(l.tagName)!==-1&&(g.flags|=8),e.elements.push(g),l.slot,l.shadowRoot?Jd(i,l.shadowRoot,g,o):!ep(l)&&!D2(l)&&!ip(l)&&Jd(i,l,g,o))}},P2=function(i,t){return VC(t)?new Q2(i,t):K2(t)?new U2(i,t):D2(t)?new G2(i,t):KE(t)?new R2(i,t):OE(t)?new PC(i,t):WE(t)?new jC(i,t):ip(t)?new Z2(i,t):ep(t)?new H2(i,t):O2(t)?new N2(i,t):new NA(i,t)},M2=function(i,t){var e=P2(i,t);return e.flags|=4,Jd(i,t,e,e),e},VE=function(i,t,e){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||qC(i)&&e.styles.isTransparent()},DE=function(i){return i.isPositioned()||i.isFloating()},V2=function(i){return i.nodeType===Node.TEXT_NODE},Hu=function(i){return i.nodeType===Node.ELEMENT_NODE},MC=function(i){return Hu(i)&&typeof i.style<"u"&&!Xd(i)},Xd=function(i){return typeof i.className=="object"},KE=function(i){return i.tagName==="LI"},OE=function(i){return i.tagName==="OL"},WE=function(i){return i.tagName==="INPUT"},zE=function(i){return i.tagName==="HTML"},D2=function(i){return i.tagName==="svg"},qC=function(i){return i.tagName==="BODY"},K2=function(i){return i.tagName==="CANVAS"},Pv=function(i){return i.tagName==="VIDEO"},VC=function(i){return i.tagName==="IMG"},O2=function(i){return i.tagName==="IFRAME"},Mv=function(i){return i.tagName==="STYLE"},JE=function(i){return i.tagName==="SCRIPT"},ep=function(i){return i.tagName==="TEXTAREA"},ip=function(i){return i.tagName==="SELECT"},W2=function(i){return i.tagName==="SLOT"},Vv=function(i){return i.tagName.indexOf("-")>0},XE=function(){function i(){this.counters={}}return i.prototype.getCounterValue=function(t){var e=this.counters[t];return e&&e.length?e[e.length-1]:1},i.prototype.getCounterValues=function(t){var e=this.counters[t];return e||[]},i.prototype.pop=function(t){var e=this;t.forEach(function(o){return e.counters[o].pop()})},i.prototype.parse=function(t){var e=this,o=t.counterIncrement,l=t.counterReset,n=!0;o!==null&&o.forEach(function(h){var m=e.counters[h.counter];m&&h.increment!==0&&(n=!1,m.length||m.push(1),m[Math.max(0,m.length-1)]+=h.increment)});var g=[];return n&&l.forEach(function(h){var m=e.counters[h.counter];g.push(h.counter),m||(m=e.counters[h.counter]=[]),m.push(h.reset)}),g},i}(),Dv={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Kv={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},YE={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},jE={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},Tu=function(i,t,e,o,l,n){return i<t||i>e?gg(i,l,n.length>0):o.integers.reduce(function(g,h,m){for(;i>=h;)i-=h,g+=o.values[m];return g},"")+n},z2=function(i,t,e,o){var l="";do e||i--,l=o(i)+l,i/=t;while(i*t>=t);return l},jn=function(i,t,e,o,l){var n=e-t+1;return(i<0?"-":"")+(z2(Math.abs(i),n,o,function(g){return qn(Math.floor(g%n)+t)})+l)},Pc=function(i,t,e){e===void 0&&(e=". ");var o=t.length;return z2(Math.abs(i),o,!1,function(l){return t[Math.floor(l%o)]})+e},Gu=1,ql=2,$l=4,sg=8,pl=function(i,t,e,o,l,n){if(i<-9999||i>9999)return gg(i,4,l.length>0);var g=Math.abs(i),h=l;if(g===0)return t[0]+h;for(var m=0;g>0&&m<=4;m++){var B=g%10;B===0&&vs(n,Gu)&&h!==""?h=t[B]+h:B>1||B===1&&m===0||B===1&&m===1&&vs(n,ql)||B===1&&m===1&&vs(n,$l)&&i>100||B===1&&m>1&&vs(n,sg)?h=t[B]+(m>0?e[m-1]:"")+h:B===1&&m>0&&(h=e[m-1]+h),g=Math.floor(g/10)}return(i<0?o:"")+h},Ov="\u5341\u767E\u5343\u842C",Wv="\u62FE\u4F70\u4EDF\u842C",zv="\u30DE\u30A4\u30CA\u30B9",CC="\uB9C8\uC774\uB108\uC2A4",gg=function(i,t,e){var o=e?". ":"",l=e?"\u3001":"",n=e?", ":"",g=e?" ":"";switch(t){case 0:return"\u2022"+g;case 1:return"\u25E6"+g;case 2:return"\u25FE"+g;case 5:var h=jn(i,48,57,!0,o);return h.length<4?"0"+h:h;case 4:return Pc(i,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",l);case 6:return Tu(i,1,3999,Dv,3,o).toLowerCase();case 7:return Tu(i,1,3999,Dv,3,o);case 8:return jn(i,945,969,!1,o);case 9:return jn(i,97,122,!1,o);case 10:return jn(i,65,90,!1,o);case 11:return jn(i,1632,1641,!0,o);case 12:case 49:return Tu(i,1,9999,Kv,3,o);case 35:return Tu(i,1,9999,Kv,3,o).toLowerCase();case 13:return jn(i,2534,2543,!0,o);case 14:case 30:return jn(i,6112,6121,!0,o);case 15:return Pc(i,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",l);case 16:return Pc(i,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",l);case 17:case 48:return pl(i,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Ov,"\u8CA0",l,ql|$l|sg);case 47:return pl(i,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",Wv,"\u8CA0",l,Gu|ql|$l|sg);case 42:return pl(i,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Ov,"\u8D1F",l,ql|$l|sg);case 41:return pl(i,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",Wv,"\u8D1F",l,Gu|ql|$l|sg);case 26:return pl(i,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",zv,l,0);case 25:return pl(i,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",zv,l,Gu|ql|$l);case 31:return pl(i,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",CC,n,Gu|ql|$l);case 33:return pl(i,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",CC,n,0);case 32:return pl(i,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",CC,n,Gu|ql|$l);case 18:return jn(i,2406,2415,!0,o);case 20:return Tu(i,1,19999,jE,3,o);case 21:return jn(i,2790,2799,!0,o);case 22:return jn(i,2662,2671,!0,o);case 22:return Tu(i,1,10999,YE,3,o);case 23:return Pc(i,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case 24:return Pc(i,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case 27:return jn(i,3302,3311,!0,o);case 28:return Pc(i,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",l);case 29:return Pc(i,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",l);case 34:return jn(i,3792,3801,!0,o);case 37:return jn(i,6160,6169,!0,o);case 38:return jn(i,4160,4169,!0,o);case 39:return jn(i,2918,2927,!0,o);case 40:return jn(i,1776,1785,!0,o);case 43:return jn(i,3046,3055,!0,o);case 44:return jn(i,3174,3183,!0,o);case 45:return jn(i,3664,3673,!0,o);case 46:return jn(i,3872,3881,!0,o);case 3:default:return jn(i,48,57,!0,o)}},J2="data-html2canvas-ignore",Jv=function(){function i(t,e,o){if(this.context=t,this.options=o,this.scrolledElements=[],this.referenceElement=e,this.counters=new XE,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement,!1)}return i.prototype.toIFrame=function(t,e){var o=this,l=qE(t,e);if(!l.contentWindow)return Promise.reject("Unable to find iframe window");var n=t.defaultView.pageXOffset,g=t.defaultView.pageYOffset,h=l.contentWindow,m=h.document,B=eT(l).then(function(){return xo(o,void 0,void 0,function(){var _,E;return so(this,function(G){switch(G.label){case 0:return this.scrolledElements.forEach(sT),h&&(h.scrollTo(e.left,e.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(h.scrollY!==e.top||h.scrollX!==e.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(h.scrollX-e.left,h.scrollY-e.top,0,0))),_=this.options.onclone,E=this.clonedReferenceElement,typeof E>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:m.fonts&&m.fonts.ready?[4,m.fonts.ready]:[3,2];case 1:G.sent(),G.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,tT(m)]:[3,4];case 3:G.sent(),G.label=4;case 4:return typeof _=="function"?[2,Promise.resolve().then(function(){return _(m,E)}).then(function(){return l})]:[2,l]}})})});return m.open(),m.write(rT(document.doctype)+"<html></html>"),nT(this.referenceElement.ownerDocument,n,g),m.replaceChild(m.adoptNode(this.documentElement),m.documentElement),m.close(),B},i.prototype.createElementClone=function(t){if(HC(t,2))debugger;if(K2(t))return this.createCanvasClone(t);if(Pv(t))return this.createVideoClone(t);if(Mv(t))return this.createStyleClone(t);var e=t.cloneNode(!1);return VC(e)&&(VC(t)&&t.currentSrc&&t.currentSrc!==t.src&&(e.src=t.currentSrc,e.srcset=""),e.loading==="lazy"&&(e.loading="eager")),Vv(e)?this.createCustomElementClone(e):e},i.prototype.createCustomElementClone=function(t){var e=document.createElement("html2canvascustomelement");return IC(t.style,e),e},i.prototype.createStyleClone=function(t){try{var e=t.sheet;if(e&&e.cssRules){var o=[].slice.call(e.cssRules,0).reduce(function(n,g){return g&&typeof g.cssText=="string"?n+g.cssText:n},""),l=t.cloneNode(!1);return l.textContent=o,l}}catch(n){if(this.context.logger.error("Unable to access cssRules property",n),n.name!=="SecurityError")throw n}return t.cloneNode(!1)},i.prototype.createCanvasClone=function(t){var e;if(this.options.inlineImages&&t.ownerDocument){var o=t.ownerDocument.createElement("img");try{return o.src=t.toDataURL(),o}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var l=t.cloneNode(!1);try{l.width=t.width,l.height=t.height;var n=t.getContext("2d"),g=l.getContext("2d");if(g)if(!this.options.allowTaint&&n)g.putImageData(n.getImageData(0,0,t.width,t.height),0,0);else{var h=(e=t.getContext("webgl2"))!==null&&e!==void 0?e:t.getContext("webgl");if(h){var m=h.getContextAttributes();m?.preserveDrawingBuffer===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}g.drawImage(t,0,0)}return l}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return l},i.prototype.createVideoClone=function(t){var e=t.ownerDocument.createElement("canvas");e.width=t.offsetWidth,e.height=t.offsetHeight;var o=e.getContext("2d");try{return o&&(o.drawImage(t,0,0,e.width,e.height),this.options.allowTaint||o.getImageData(0,0,e.width,e.height)),e}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var l=t.ownerDocument.createElement("canvas");return l.width=t.offsetWidth,l.height=t.offsetHeight,l},i.prototype.appendChildNode=function(t,e,o){(!Hu(e)||!JE(e)&&!e.hasAttribute(J2)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(e)))&&(!this.options.copyStyles||!Hu(e)||!Mv(e))&&t.appendChild(this.cloneNode(e,o))},i.prototype.cloneChildNodes=function(t,e,o){for(var l=this,n=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;n;n=n.nextSibling)if(Hu(n)&&W2(n)&&typeof n.assignedNodes=="function"){var g=n.assignedNodes();g.length&&g.forEach(function(h){return l.appendChildNode(e,h,o)})}else this.appendChildNode(e,n,o)},i.prototype.cloneNode=function(t,e){if(V2(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var o=t.ownerDocument.defaultView;if(o&&Hu(t)&&(MC(t)||Xd(t))){var l=this.createElementClone(t);l.style.transitionProperty="none";var n=o.getComputedStyle(t),g=o.getComputedStyle(t,":before"),h=o.getComputedStyle(t,":after");this.referenceElement===t&&MC(l)&&(this.clonedReferenceElement=l),qC(l)&&AT(l);var m=this.counters.parse(new Bv(this.context,n)),B=this.resolvePseudoContent(t,l,g,cg.BEFORE);Vv(t)&&(e=!0),Pv(t)||this.cloneChildNodes(t,l,e),B&&l.insertBefore(B,l.firstChild);var _=this.resolvePseudoContent(t,l,h,cg.AFTER);return _&&l.appendChild(_),this.counters.pop(m),(n&&(this.options.copyStyles||Xd(t))&&!O2(t)||e)&&IC(n,l),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([l,t.scrollLeft,t.scrollTop]),(ep(t)||ip(t))&&(ep(l)||ip(l))&&(l.value=t.value),l}return t.cloneNode(!1)},i.prototype.resolvePseudoContent=function(t,e,o,l){var n=this;if(o){var g=o.content,h=e.ownerDocument;if(!(!h||!g||g==="none"||g==="-moz-alt-content"||o.display==="none")){this.counters.parse(new Bv(this.context,o));var m=new KL(this.context,o),B=h.createElement("html2canvaspseudoelement");IC(o,B),m.content.forEach(function(E){if(E.type===0)B.appendChild(h.createTextNode(E.value));else if(E.type===22){var G=h.createElement("img");G.src=E.value,G.style.opacity="1",B.appendChild(G)}else if(E.type===18){if(E.name==="attr"){var S=E.values.filter(on);S.length&&B.appendChild(h.createTextNode(t.getAttribute(S[0].value)||""))}else if(E.name==="counter"){var O=E.values.filter(Pu),P=O[0],tt=O[1];if(P&&on(P)){var z=n.counters.getCounterValue(P.value),rt=tt&&on(tt)?ZC.parse(n.context,tt.value):3;B.appendChild(h.createTextNode(gg(z,rt,!1)))}}else if(E.name==="counters"){var ct=E.values.filter(Pu),P=ct[0],Et=ct[1],tt=ct[2];if(P&&on(P)){var Pt=n.counters.getCounterValues(P.value),Qt=tt&&on(tt)?ZC.parse(n.context,tt.value):3,Ut=Et&&Et.type===0?Et.value:"",dt=Pt.map(function(ht){return gg(ht,Qt,!1)}).join(Ut);B.appendChild(h.createTextNode(dt))}}}else if(E.type===20)switch(E.value){case"open-quote":B.appendChild(h.createTextNode(wv(m.quotes,n.quoteDepth++,!0)));break;case"close-quote":B.appendChild(h.createTextNode(wv(m.quotes,--n.quoteDepth,!1)));break;default:B.appendChild(h.createTextNode(E.value))}}),B.className=DC+" "+KC;var _=l===cg.BEFORE?" "+DC:" "+KC;return Xd(e)?e.className.baseValue+=_:e.className+=_,B}}},i.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},i}();(function(i){i[i.BEFORE=0]="BEFORE",i[i.AFTER=1]="AFTER"})(cg||(cg={}));qE=function(i,t){var e=i.createElement("iframe");return e.className="html2canvas-container",e.style.visibility="hidden",e.style.position="fixed",e.style.left="-10000px",e.style.top="0px",e.style.border="0",e.width=t.width.toString(),e.height=t.height.toString(),e.scrolling="no",e.setAttribute(J2,"true"),i.body.appendChild(e),e},$E=function(i){return new Promise(function(t){if(i.complete){t();return}if(!i.src){t();return}i.onload=t,i.onerror=t})},tT=function(i){return Promise.all([].slice.call(i.images,0).map($E))},eT=function(i){return new Promise(function(t,e){var o=i.contentWindow;if(!o)return e("No window assigned for iframe");var l=o.document;o.onload=i.onload=function(){o.onload=i.onload=null;var n=setInterval(function(){l.body.childNodes.length>0&&l.readyState==="complete"&&(clearInterval(n),t(i))},50)}})},iT=["all","d","content"],IC=function(i,t){for(var e=i.length-1;e>=0;e--){var o=i.item(e);iT.indexOf(o)===-1&&t.style.setProperty(o,i.getPropertyValue(o))}return t},rT=function(i){var t="";return i&&(t+="<!DOCTYPE ",i.name&&(t+=i.name),i.internalSubset&&(t+=i.internalSubset),i.publicId&&(t+='"'+i.publicId+'"'),i.systemId&&(t+='"'+i.systemId+'"'),t+=">"),t},nT=function(i,t,e){i&&i.defaultView&&(t!==i.defaultView.pageXOffset||e!==i.defaultView.pageYOffset)&&i.defaultView.scrollTo(t,e)},sT=function(i){var t=i[0],e=i[1],o=i[2];t.scrollLeft=e,t.scrollTop=o},oT=":before",aT=":after",DC="___html2canvas___pseudoelement_before",KC="___html2canvas___pseudoelement_after",Xv=`{
    content: "" !important;
    display: none !important;
}`,AT=function(i){lT(i,"."+DC+oT+Xv+`
         .`+KC+aT+Xv)},lT=function(i,t){var e=i.ownerDocument;if(e){var o=e.createElement("style");o.textContent=t,i.appendChild(o)}},X2=function(){function i(){}return i.getOrigin=function(t){var e=i._link;return e?(e.href=t,e.href=e.href,e.protocol+e.hostname+e.port):"about:blank"},i.isSameOrigin=function(t){return i.getOrigin(t)===i._origin},i.setContext=function(t){i._link=t.document.createElement("a"),i._origin=i.getOrigin(t.location.href)},i._origin="about:blank",i}(),cT=function(){function i(t,e){this.context=t,this._options=e,this._cache={}}return i.prototype.addImage=function(t){var e=Promise.resolve();return this.has(t)||(bC(t)||dT(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),e},i.prototype.match=function(t){return this._cache[t]},i.prototype.loadImage=function(t){return xo(this,void 0,void 0,function(){var e,o,l,n,g=this;return so(this,function(h){switch(h.label){case 0:return e=X2.isSameOrigin(t),o=!yC(t)&&this._options.useCORS===!0&&Os.SUPPORT_CORS_IMAGES&&!e,l=!yC(t)&&!e&&!bC(t)&&typeof this._options.proxy=="string"&&Os.SUPPORT_CORS_XHR&&!o,!e&&this._options.allowTaint===!1&&!yC(t)&&!bC(t)&&!l&&!o?[2]:(n=t,l?[4,this.proxy(n)]:[3,2]);case 1:n=h.sent(),h.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(m,B){var _=new Image;_.onload=function(){return m(_)},_.onerror=B,(pT(n)||o)&&(_.crossOrigin="anonymous"),_.src=n,_.complete===!0&&setTimeout(function(){return m(_)},500),g._options.imageTimeout>0&&setTimeout(function(){return B("Timed out ("+g._options.imageTimeout+"ms) loading image")},g._options.imageTimeout)})];case 3:return[2,h.sent()]}})})},i.prototype.has=function(t){return typeof this._cache[t]<"u"},i.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},i.prototype.proxy=function(t){var e=this,o=this._options.proxy;if(!o)throw new Error("No proxy defined");var l=t.substring(0,256);return new Promise(function(n,g){var h=Os.SUPPORT_RESPONSE_TYPE?"blob":"text",m=new XMLHttpRequest;m.onload=function(){if(m.status===200)if(h==="text")n(m.response);else{var E=new FileReader;E.addEventListener("load",function(){return n(E.result)},!1),E.addEventListener("error",function(G){return g(G)},!1),E.readAsDataURL(m.response)}else g("Failed to proxy resource "+l+" with status code "+m.status)},m.onerror=g;var B=o.indexOf("?")>-1?"&":"?";if(m.open("GET",""+o+B+"url="+encodeURIComponent(t)+"&responseType="+h),h!=="text"&&m instanceof XMLHttpRequest&&(m.responseType=h),e._options.imageTimeout){var _=e._options.imageTimeout;m.timeout=_,m.ontimeout=function(){return g("Timed out ("+_+"ms) proxying "+l)}}m.send()})},i}(),uT=/^data:image\/svg\+xml/i,hT=/^data:image\/.*;base64,/i,gT=/^data:image\/.*/i,dT=function(i){return Os.SUPPORT_SVG_DRAWING||!fT(i)},yC=function(i){return gT.test(i)},pT=function(i){return hT.test(i)},bC=function(i){return i.substr(0,4)==="blob"},fT=function(i){return i.substr(-3).toLowerCase()==="svg"||uT.test(i)},xi=function(){function i(t,e){this.type=0,this.x=t,this.y=e}return i.prototype.add=function(t,e){return new i(this.x+t,this.y+e)},i}(),Qu=function(i,t,e){return new xi(i.x+(t.x-i.x)*e,i.y+(t.y-i.y)*e)},Vd=function(){function i(t,e,o,l){this.type=1,this.start=t,this.startControl=e,this.endControl=o,this.end=l}return i.prototype.subdivide=function(t,e){var o=Qu(this.start,this.startControl,t),l=Qu(this.startControl,this.endControl,t),n=Qu(this.endControl,this.end,t),g=Qu(o,l,t),h=Qu(l,n,t),m=Qu(g,h,t);return e?new i(this.start,o,g,m):new i(m,h,n,this.end)},i.prototype.add=function(t,e){return new i(this.start.add(t,e),this.startControl.add(t,e),this.endControl.add(t,e),this.end.add(t,e))},i.prototype.reverse=function(){return new i(this.end,this.endControl,this.startControl,this.start)},i}(),La=function(i){return i.type===1},mT=function(){function i(t){var e=t.styles,o=t.bounds,l=rg(e.borderTopLeftRadius,o.width,o.height),n=l[0],g=l[1],h=rg(e.borderTopRightRadius,o.width,o.height),m=h[0],B=h[1],_=rg(e.borderBottomRightRadius,o.width,o.height),E=_[0],G=_[1],S=rg(e.borderBottomLeftRadius,o.width,o.height),O=S[0],P=S[1],tt=[];tt.push((n+m)/o.width),tt.push((O+E)/o.width),tt.push((g+P)/o.height),tt.push((B+G)/o.height);var z=Math.max.apply(Math,tt);z>1&&(n/=z,g/=z,m/=z,B/=z,E/=z,G/=z,O/=z,P/=z);var rt=o.width-m,ct=o.height-G,Et=o.width-E,Pt=o.height-P,Qt=e.borderTopWidth,Ut=e.borderRightWidth,dt=e.borderBottomWidth,ee=e.borderLeftWidth,oe=In(e.paddingTop,t.bounds.width),ht=In(e.paddingRight,t.bounds.width),At=In(e.paddingBottom,t.bounds.width),Ft=In(e.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=n>0||g>0?_n(o.left+ee/3,o.top+Qt/3,n-ee/3,g-Qt/3,qr.TOP_LEFT):new xi(o.left+ee/3,o.top+Qt/3),this.topRightBorderDoubleOuterBox=n>0||g>0?_n(o.left+rt,o.top+Qt/3,m-Ut/3,B-Qt/3,qr.TOP_RIGHT):new xi(o.left+o.width-Ut/3,o.top+Qt/3),this.bottomRightBorderDoubleOuterBox=E>0||G>0?_n(o.left+Et,o.top+ct,E-Ut/3,G-dt/3,qr.BOTTOM_RIGHT):new xi(o.left+o.width-Ut/3,o.top+o.height-dt/3),this.bottomLeftBorderDoubleOuterBox=O>0||P>0?_n(o.left+ee/3,o.top+Pt,O-ee/3,P-dt/3,qr.BOTTOM_LEFT):new xi(o.left+ee/3,o.top+o.height-dt/3),this.topLeftBorderDoubleInnerBox=n>0||g>0?_n(o.left+ee*2/3,o.top+Qt*2/3,n-ee*2/3,g-Qt*2/3,qr.TOP_LEFT):new xi(o.left+ee*2/3,o.top+Qt*2/3),this.topRightBorderDoubleInnerBox=n>0||g>0?_n(o.left+rt,o.top+Qt*2/3,m-Ut*2/3,B-Qt*2/3,qr.TOP_RIGHT):new xi(o.left+o.width-Ut*2/3,o.top+Qt*2/3),this.bottomRightBorderDoubleInnerBox=E>0||G>0?_n(o.left+Et,o.top+ct,E-Ut*2/3,G-dt*2/3,qr.BOTTOM_RIGHT):new xi(o.left+o.width-Ut*2/3,o.top+o.height-dt*2/3),this.bottomLeftBorderDoubleInnerBox=O>0||P>0?_n(o.left+ee*2/3,o.top+Pt,O-ee*2/3,P-dt*2/3,qr.BOTTOM_LEFT):new xi(o.left+ee*2/3,o.top+o.height-dt*2/3),this.topLeftBorderStroke=n>0||g>0?_n(o.left+ee/2,o.top+Qt/2,n-ee/2,g-Qt/2,qr.TOP_LEFT):new xi(o.left+ee/2,o.top+Qt/2),this.topRightBorderStroke=n>0||g>0?_n(o.left+rt,o.top+Qt/2,m-Ut/2,B-Qt/2,qr.TOP_RIGHT):new xi(o.left+o.width-Ut/2,o.top+Qt/2),this.bottomRightBorderStroke=E>0||G>0?_n(o.left+Et,o.top+ct,E-Ut/2,G-dt/2,qr.BOTTOM_RIGHT):new xi(o.left+o.width-Ut/2,o.top+o.height-dt/2),this.bottomLeftBorderStroke=O>0||P>0?_n(o.left+ee/2,o.top+Pt,O-ee/2,P-dt/2,qr.BOTTOM_LEFT):new xi(o.left+ee/2,o.top+o.height-dt/2),this.topLeftBorderBox=n>0||g>0?_n(o.left,o.top,n,g,qr.TOP_LEFT):new xi(o.left,o.top),this.topRightBorderBox=m>0||B>0?_n(o.left+rt,o.top,m,B,qr.TOP_RIGHT):new xi(o.left+o.width,o.top),this.bottomRightBorderBox=E>0||G>0?_n(o.left+Et,o.top+ct,E,G,qr.BOTTOM_RIGHT):new xi(o.left+o.width,o.top+o.height),this.bottomLeftBorderBox=O>0||P>0?_n(o.left,o.top+Pt,O,P,qr.BOTTOM_LEFT):new xi(o.left,o.top+o.height),this.topLeftPaddingBox=n>0||g>0?_n(o.left+ee,o.top+Qt,Math.max(0,n-ee),Math.max(0,g-Qt),qr.TOP_LEFT):new xi(o.left+ee,o.top+Qt),this.topRightPaddingBox=m>0||B>0?_n(o.left+Math.min(rt,o.width-Ut),o.top+Qt,rt>o.width+Ut?0:Math.max(0,m-Ut),Math.max(0,B-Qt),qr.TOP_RIGHT):new xi(o.left+o.width-Ut,o.top+Qt),this.bottomRightPaddingBox=E>0||G>0?_n(o.left+Math.min(Et,o.width-ee),o.top+Math.min(ct,o.height-dt),Math.max(0,E-Ut),Math.max(0,G-dt),qr.BOTTOM_RIGHT):new xi(o.left+o.width-Ut,o.top+o.height-dt),this.bottomLeftPaddingBox=O>0||P>0?_n(o.left+ee,o.top+Math.min(Pt,o.height-dt),Math.max(0,O-ee),Math.max(0,P-dt),qr.BOTTOM_LEFT):new xi(o.left+ee,o.top+o.height-dt),this.topLeftContentBox=n>0||g>0?_n(o.left+ee+Ft,o.top+Qt+oe,Math.max(0,n-(ee+Ft)),Math.max(0,g-(Qt+oe)),qr.TOP_LEFT):new xi(o.left+ee+Ft,o.top+Qt+oe),this.topRightContentBox=m>0||B>0?_n(o.left+Math.min(rt,o.width+ee+Ft),o.top+Qt+oe,rt>o.width+ee+Ft?0:m-ee+Ft,B-(Qt+oe),qr.TOP_RIGHT):new xi(o.left+o.width-(Ut+ht),o.top+Qt+oe),this.bottomRightContentBox=E>0||G>0?_n(o.left+Math.min(Et,o.width-(ee+Ft)),o.top+Math.min(ct,o.height+Qt+oe),Math.max(0,E-(Ut+ht)),G-(dt+At),qr.BOTTOM_RIGHT):new xi(o.left+o.width-(Ut+ht),o.top+o.height-(dt+At)),this.bottomLeftContentBox=O>0||P>0?_n(o.left+ee+Ft,o.top+Pt,Math.max(0,O-(ee+Ft)),P-(dt+At),qr.BOTTOM_LEFT):new xi(o.left+ee+Ft,o.top+o.height-(dt+At))}return i}();(function(i){i[i.TOP_LEFT=0]="TOP_LEFT",i[i.TOP_RIGHT=1]="TOP_RIGHT",i[i.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",i[i.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(qr||(qr={}));_n=function(i,t,e,o,l){var n=4*((Math.sqrt(2)-1)/3),g=e*n,h=o*n,m=i+e,B=t+o;switch(l){case qr.TOP_LEFT:return new Vd(new xi(i,B),new xi(i,B-h),new xi(m-g,t),new xi(m,t));case qr.TOP_RIGHT:return new Vd(new xi(i,t),new xi(i+g,t),new xi(m,B-h),new xi(m,B));case qr.BOTTOM_RIGHT:return new Vd(new xi(m,t),new xi(m,t+h),new xi(i+g,B),new xi(i,B));case qr.BOTTOM_LEFT:default:return new Vd(new xi(m,B),new xi(m-g,B),new xi(i,t+h),new xi(i,t))}},rp=function(i){return[i.topLeftBorderBox,i.topRightBorderBox,i.bottomRightBorderBox,i.bottomLeftBorderBox]},CT=function(i){return[i.topLeftContentBox,i.topRightContentBox,i.bottomRightContentBox,i.bottomLeftContentBox]},np=function(i){return[i.topLeftPaddingBox,i.topRightPaddingBox,i.bottomRightPaddingBox,i.bottomLeftPaddingBox]},IT=function(){function i(t,e,o){this.offsetX=t,this.offsetY=e,this.matrix=o,this.type=0,this.target=6}return i}(),Dd=function(){function i(t,e){this.path=t,this.target=e,this.type=1}return i}(),yT=function(){function i(t){this.opacity=t,this.type=2,this.target=6}return i}(),bT=function(i){return i.type===0},Y2=function(i){return i.type===1},vT=function(i){return i.type===2},Yv=function(i,t){return i.length===t.length?i.some(function(e,o){return e===t[o]}):!1},wT=function(i,t,e,o,l){return i.map(function(n,g){switch(g){case 0:return n.add(t,e);case 1:return n.add(t+o,e);case 2:return n.add(t+o,e+l);case 3:return n.add(t,e+l)}return n})},j2=function(){function i(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return i}(),q2=function(){function i(t,e){if(this.container=t,this.parent=e,this.effects=[],this.curves=new mT(this.container),this.container.styles.opacity<1&&this.effects.push(new yT(this.container.styles.opacity)),this.container.styles.transform!==null){var o=this.container.bounds.left+this.container.styles.transformOrigin[0].number,l=this.container.bounds.top+this.container.styles.transformOrigin[1].number,n=this.container.styles.transform;this.effects.push(new IT(o,l,n))}if(this.container.styles.overflowX!==0){var g=rp(this.curves),h=np(this.curves);Yv(g,h)?this.effects.push(new Dd(g,6)):(this.effects.push(new Dd(g,2)),this.effects.push(new Dd(h,4)))}}return i.prototype.getEffects=function(t){for(var e=[2,3].indexOf(this.container.styles.position)===-1,o=this.parent,l=this.effects.slice(0);o;){var n=o.effects.filter(function(m){return!Y2(m)});if(e||o.container.styles.position!==0||!o.parent){if(l.unshift.apply(l,n),e=[2,3].indexOf(o.container.styles.position)===-1,o.container.styles.overflowX!==0){var g=rp(o.curves),h=np(o.curves);Yv(g,h)||l.unshift(new Dd(h,6))}}else l.unshift.apply(l,n);o=o.parent}return l.filter(function(m){return vs(m.target,t)})},i}(),OC=function(i,t,e,o){i.container.elements.forEach(function(l){var n=vs(l.flags,4),g=vs(l.flags,2),h=new q2(l,i);vs(l.styles.display,2048)&&o.push(h);var m=vs(l.flags,8)?[]:o;if(n||g){var B=n||l.styles.isPositioned()?e:t,_=new j2(h);if(l.styles.isPositioned()||l.styles.opacity<1||l.styles.isTransformed()){var E=l.styles.zIndex.order;if(E<0){var G=0;B.negativeZIndex.some(function(O,P){return E>O.element.container.styles.zIndex.order?(G=P,!1):G>0}),B.negativeZIndex.splice(G,0,_)}else if(E>0){var S=0;B.positiveZIndex.some(function(O,P){return E>=O.element.container.styles.zIndex.order?(S=P+1,!1):S>0}),B.positiveZIndex.splice(S,0,_)}else B.zeroOrAutoZIndexOrTransformedOrOpacity.push(_)}else l.styles.isFloating()?B.nonPositionedFloats.push(_):B.nonPositionedInlineLevel.push(_);OC(h,_,n?_:e,m)}else l.styles.isInlineLevel()?t.inlineLevel.push(h):t.nonInlineLevel.push(h),OC(h,t,e,m);vs(l.flags,8)&&$2(l,m)})},$2=function(i,t){for(var e=i instanceof PC?i.start:1,o=i instanceof PC?i.reversed:!1,l=0;l<t.length;l++){var n=t[l];n.container instanceof R2&&typeof n.container.value=="number"&&n.container.value!==0&&(e=n.container.value),n.listValue=gg(e,n.container.styles.listStyleType,!0),e+=o?-1:1}},BT=function(i){var t=new q2(i,null),e=new j2(t),o=[];return OC(t,e,e,o),$2(t.container,o),e},jv=function(i,t){switch(t){case 0:return Ta(i.topLeftBorderBox,i.topLeftPaddingBox,i.topRightBorderBox,i.topRightPaddingBox);case 1:return Ta(i.topRightBorderBox,i.topRightPaddingBox,i.bottomRightBorderBox,i.bottomRightPaddingBox);case 2:return Ta(i.bottomRightBorderBox,i.bottomRightPaddingBox,i.bottomLeftBorderBox,i.bottomLeftPaddingBox);case 3:default:return Ta(i.bottomLeftBorderBox,i.bottomLeftPaddingBox,i.topLeftBorderBox,i.topLeftPaddingBox)}},_T=function(i,t){switch(t){case 0:return Ta(i.topLeftBorderBox,i.topLeftBorderDoubleOuterBox,i.topRightBorderBox,i.topRightBorderDoubleOuterBox);case 1:return Ta(i.topRightBorderBox,i.topRightBorderDoubleOuterBox,i.bottomRightBorderBox,i.bottomRightBorderDoubleOuterBox);case 2:return Ta(i.bottomRightBorderBox,i.bottomRightBorderDoubleOuterBox,i.bottomLeftBorderBox,i.bottomLeftBorderDoubleOuterBox);case 3:default:return Ta(i.bottomLeftBorderBox,i.bottomLeftBorderDoubleOuterBox,i.topLeftBorderBox,i.topLeftBorderDoubleOuterBox)}},xT=function(i,t){switch(t){case 0:return Ta(i.topLeftBorderDoubleInnerBox,i.topLeftPaddingBox,i.topRightBorderDoubleInnerBox,i.topRightPaddingBox);case 1:return Ta(i.topRightBorderDoubleInnerBox,i.topRightPaddingBox,i.bottomRightBorderDoubleInnerBox,i.bottomRightPaddingBox);case 2:return Ta(i.bottomRightBorderDoubleInnerBox,i.bottomRightPaddingBox,i.bottomLeftBorderDoubleInnerBox,i.bottomLeftPaddingBox);case 3:default:return Ta(i.bottomLeftBorderDoubleInnerBox,i.bottomLeftPaddingBox,i.topLeftBorderDoubleInnerBox,i.topLeftPaddingBox)}},ST=function(i,t){switch(t){case 0:return Kd(i.topLeftBorderStroke,i.topRightBorderStroke);case 1:return Kd(i.topRightBorderStroke,i.bottomRightBorderStroke);case 2:return Kd(i.bottomRightBorderStroke,i.bottomLeftBorderStroke);case 3:default:return Kd(i.bottomLeftBorderStroke,i.topLeftBorderStroke)}},Kd=function(i,t){var e=[];return La(i)?e.push(i.subdivide(.5,!1)):e.push(i),La(t)?e.push(t.subdivide(.5,!0)):e.push(t),e},Ta=function(i,t,e,o){var l=[];return La(i)?l.push(i.subdivide(.5,!1)):l.push(i),La(e)?l.push(e.subdivide(.5,!0)):l.push(e),La(o)?l.push(o.subdivide(.5,!0).reverse()):l.push(o),La(t)?l.push(t.subdivide(.5,!1).reverse()):l.push(t),l},tw=function(i){var t=i.bounds,e=i.styles;return t.add(e.borderLeftWidth,e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth),-(e.borderTopWidth+e.borderBottomWidth))},sp=function(i){var t=i.styles,e=i.bounds,o=In(t.paddingLeft,e.width),l=In(t.paddingRight,e.width),n=In(t.paddingTop,e.width),g=In(t.paddingBottom,e.width);return e.add(o+t.borderLeftWidth,n+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+o+l),-(t.borderTopWidth+t.borderBottomWidth+n+g))},FT=function(i,t){return i===0?t.bounds:i===2?sp(t):tw(t)},kT=function(i,t){return i===0?t.bounds:i===2?sp(t):tw(t)},vC=function(i,t,e){var o=FT(Ru(i.styles.backgroundOrigin,t),i),l=kT(Ru(i.styles.backgroundClip,t),i),n=LT(Ru(i.styles.backgroundSize,t),e,o),g=n[0],h=n[1],m=rg(Ru(i.styles.backgroundPosition,t),o.width-g,o.height-h),B=ET(Ru(i.styles.backgroundRepeat,t),m,n,o,l),_=Math.round(o.left+m[0]),E=Math.round(o.top+m[1]);return[B,_,E,g,h]},Uu=function(i){return on(i)&&i.value===Nu.AUTO},Od=function(i){return typeof i=="number"},LT=function(i,t,e){var o=t[0],l=t[1],n=t[2],g=i[0],h=i[1];if(!g)return[0,0];if(ls(g)&&h&&ls(h))return[In(g,e.width),In(h,e.height)];var m=Od(n);if(on(g)&&(g.value===Nu.CONTAIN||g.value===Nu.COVER)){if(Od(n)){var B=e.width/e.height;return B<n!=(g.value===Nu.COVER)?[e.width,e.width/n]:[e.height*n,e.height]}return[e.width,e.height]}var _=Od(o),E=Od(l),G=_||E;if(Uu(g)&&(!h||Uu(h))){if(_&&E)return[o,l];if(!m&&!G)return[e.width,e.height];if(G&&m){var S=_?o:l*n,O=E?l:o/n;return[S,O]}var P=_?o:e.width,tt=E?l:e.height;return[P,tt]}if(m){var z=0,rt=0;return ls(g)?z=In(g,e.width):ls(h)&&(rt=In(h,e.height)),Uu(g)?z=rt*n:(!h||Uu(h))&&(rt=z/n),[z,rt]}var ct=null,Et=null;if(ls(g)?ct=In(g,e.width):h&&ls(h)&&(Et=In(h,e.height)),ct!==null&&(!h||Uu(h))&&(Et=_&&E?ct/o*l:e.height),Et!==null&&Uu(g)&&(ct=_&&E?Et/l*o:e.width),ct!==null&&Et!==null)return[ct,Et];throw new Error("Unable to calculate background-size for element")},Ru=function(i,t){var e=i[t];return typeof e>"u"?i[0]:e},ET=function(i,t,e,o,l){var n=t[0],g=t[1],h=e[0],m=e[1];switch(i){case 2:return[new xi(Math.round(o.left),Math.round(o.top+g)),new xi(Math.round(o.left+o.width),Math.round(o.top+g)),new xi(Math.round(o.left+o.width),Math.round(m+o.top+g)),new xi(Math.round(o.left),Math.round(m+o.top+g))];case 3:return[new xi(Math.round(o.left+n),Math.round(o.top)),new xi(Math.round(o.left+n+h),Math.round(o.top)),new xi(Math.round(o.left+n+h),Math.round(o.height+o.top)),new xi(Math.round(o.left+n),Math.round(o.height+o.top))];case 1:return[new xi(Math.round(o.left+n),Math.round(o.top+g)),new xi(Math.round(o.left+n+h),Math.round(o.top+g)),new xi(Math.round(o.left+n+h),Math.round(o.top+g+m)),new xi(Math.round(o.left+n),Math.round(o.top+g+m))];default:return[new xi(Math.round(l.left),Math.round(l.top)),new xi(Math.round(l.left+l.width),Math.round(l.top)),new xi(Math.round(l.left+l.width),Math.round(l.height+l.top)),new xi(Math.round(l.left),Math.round(l.height+l.top))]}},TT="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",qv="Hidden Text",QT=function(){function i(t){this._data={},this._document=t}return i.prototype.parseMetrics=function(t,e){var o=this._document.createElement("div"),l=this._document.createElement("img"),n=this._document.createElement("span"),g=this._document.body;o.style.visibility="hidden",o.style.fontFamily=t,o.style.fontSize=e,o.style.margin="0",o.style.padding="0",o.style.whiteSpace="nowrap",g.appendChild(o),l.src=TT,l.width=1,l.height=1,l.style.margin="0",l.style.padding="0",l.style.verticalAlign="baseline",n.style.fontFamily=t,n.style.fontSize=e,n.style.margin="0",n.style.padding="0",n.appendChild(this._document.createTextNode(qv)),o.appendChild(n),o.appendChild(l);var h=l.offsetTop-n.offsetTop+2;o.removeChild(n),o.appendChild(this._document.createTextNode(qv)),o.style.lineHeight="normal",l.style.verticalAlign="super";var m=l.offsetTop-o.offsetTop+2;return g.removeChild(o),{baseline:h,middle:m}},i.prototype.getMetrics=function(t,e){var o=t+" "+e;return typeof this._data[o]>"u"&&(this._data[o]=this.parseMetrics(t,e)),this._data[o]},i}(),ew=function(){function i(t,e){this.context=t,this.options=e}return i}(),UT=1e4,GT=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this;return l._activeEffects=[],l.canvas=o.canvas?o.canvas:document.createElement("canvas"),l.ctx=l.canvas.getContext("2d"),o.canvas||(l.canvas.width=Math.floor(o.width*o.scale),l.canvas.height=Math.floor(o.height*o.scale),l.canvas.style.width=o.width+"px",l.canvas.style.height=o.height+"px"),l.fontMetrics=new QT(document),l.ctx.scale(l.options.scale,l.options.scale),l.ctx.translate(-o.x,-o.y),l.ctx.textBaseline="bottom",l._activeEffects=[],l.context.logger.debug("Canvas renderer initialized ("+o.width+"x"+o.height+") with scale "+o.scale),l}return t.prototype.applyEffects=function(e){for(var o=this;this._activeEffects.length;)this.popEffect();e.forEach(function(l){return o.applyEffect(l)})},t.prototype.applyEffect=function(e){this.ctx.save(),vT(e)&&(this.ctx.globalAlpha=e.opacity),bT(e)&&(this.ctx.translate(e.offsetX,e.offsetY),this.ctx.transform(e.matrix[0],e.matrix[1],e.matrix[2],e.matrix[3],e.matrix[4],e.matrix[5]),this.ctx.translate(-e.offsetX,-e.offsetY)),Y2(e)&&(this.path(e.path),this.ctx.clip()),this._activeEffects.push(e)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(e){return xo(this,void 0,void 0,function(){var o;return so(this,function(l){switch(l.label){case 0:return o=e.element.container.styles,o.isVisible()?[4,this.renderStackContent(e)]:[3,2];case 1:l.sent(),l.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(e){return xo(this,void 0,void 0,function(){return so(this,function(o){switch(o.label){case 0:if(vs(e.container.flags,16))debugger;return e.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(e)]:[3,3];case 1:return o.sent(),[4,this.renderNodeContent(e)];case 2:o.sent(),o.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(e,o,l){var n=this;if(o===0)this.ctx.fillText(e.text,e.bounds.left,e.bounds.top+l);else{var g=YC(e.text);g.reduce(function(h,m){return n.ctx.fillText(m,h,e.bounds.top+l),h+n.ctx.measureText(m).width},e.bounds.left)}},t.prototype.createFontStyle=function(e){var o=e.fontVariant.filter(function(g){return g==="normal"||g==="small-caps"}).join(""),l=PT(e.fontFamily).join(", "),n=pg(e.fontSize)?""+e.fontSize.number+e.fontSize.unit:e.fontSize.number+"px";return[[e.fontStyle,o,e.fontWeight,n,l].join(" "),l,n]},t.prototype.renderTextNode=function(e,o){return xo(this,void 0,void 0,function(){var l,n,g,h,m,B,_,E,G=this;return so(this,function(S){return l=this.createFontStyle(o),n=l[0],g=l[1],h=l[2],this.ctx.font=n,this.ctx.direction=o.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",m=this.fontMetrics.getMetrics(g,h),B=m.baseline,_=m.middle,E=o.paintOrder,e.textBounds.forEach(function(O){E.forEach(function(P){switch(P){case 0:G.ctx.fillStyle=Ls(o.color),G.renderTextWithLetterSpacing(O,o.letterSpacing,B);var tt=o.textShadow;tt.length&&O.text.trim().length&&(tt.slice(0).reverse().forEach(function(z){G.ctx.shadowColor=Ls(z.color),G.ctx.shadowOffsetX=z.offsetX.number*G.options.scale,G.ctx.shadowOffsetY=z.offsetY.number*G.options.scale,G.ctx.shadowBlur=z.blur.number,G.renderTextWithLetterSpacing(O,o.letterSpacing,B)}),G.ctx.shadowColor="",G.ctx.shadowOffsetX=0,G.ctx.shadowOffsetY=0,G.ctx.shadowBlur=0),o.textDecorationLine.length&&(G.ctx.fillStyle=Ls(o.textDecorationColor||o.color),o.textDecorationLine.forEach(function(z){switch(z){case 1:G.ctx.fillRect(O.bounds.left,Math.round(O.bounds.top+B),O.bounds.width,1);break;case 2:G.ctx.fillRect(O.bounds.left,Math.round(O.bounds.top),O.bounds.width,1);break;case 3:G.ctx.fillRect(O.bounds.left,Math.ceil(O.bounds.top+_),O.bounds.width,1);break}}));break;case 1:o.webkitTextStrokeWidth&&O.text.trim().length&&(G.ctx.strokeStyle=Ls(o.webkitTextStrokeColor),G.ctx.lineWidth=o.webkitTextStrokeWidth,G.ctx.lineJoin=window.chrome?"miter":"round",G.ctx.strokeText(O.text,O.bounds.left,O.bounds.top+B)),G.ctx.strokeStyle="",G.ctx.lineWidth=0,G.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(e,o,l){if(l&&e.intrinsicWidth>0&&e.intrinsicHeight>0){var n=sp(e),g=np(o);this.path(g),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(l,0,0,e.intrinsicWidth,e.intrinsicHeight,n.left,n.top,n.width,n.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(e){return xo(this,void 0,void 0,function(){var o,l,n,g,h,m,rt,rt,B,_,E,G,Et,S,O,Pt,P,tt,z,rt,ct,Et,Pt;return so(this,function(Qt){switch(Qt.label){case 0:this.applyEffects(e.getEffects(4)),o=e.container,l=e.curves,n=o.styles,g=0,h=o.textNodes,Qt.label=1;case 1:return g<h.length?(m=h[g],[4,this.renderTextNode(m,n)]):[3,4];case 2:Qt.sent(),Qt.label=3;case 3:return g++,[3,1];case 4:if(!(o instanceof Q2))return[3,8];Qt.label=5;case 5:return Qt.trys.push([5,7,,8]),[4,this.context.cache.match(o.src)];case 6:return rt=Qt.sent(),this.renderReplacedElement(o,l,rt),[3,8];case 7:return Qt.sent(),this.context.logger.error("Error loading image "+o.src),[3,8];case 8:if(o instanceof U2&&this.renderReplacedElement(o,l,o.canvas),!(o instanceof G2))return[3,12];Qt.label=9;case 9:return Qt.trys.push([9,11,,12]),[4,this.context.cache.match(o.svg)];case 10:return rt=Qt.sent(),this.renderReplacedElement(o,l,rt),[3,12];case 11:return Qt.sent(),this.context.logger.error("Error loading svg "+o.svg.substring(0,255)),[3,12];case 12:return o instanceof N2&&o.tree?(B=new t(this.context,{scale:this.options.scale,backgroundColor:o.backgroundColor,x:0,y:0,width:o.width,height:o.height}),[4,B.render(o.tree)]):[3,14];case 13:_=Qt.sent(),o.width&&o.height&&this.ctx.drawImage(_,0,0,o.width,o.height,o.bounds.left,o.bounds.top,o.bounds.width,o.bounds.height),Qt.label=14;case 14:if(o instanceof jC&&(E=Math.min(o.bounds.width,o.bounds.height),o.type===$d?o.checked&&(this.ctx.save(),this.path([new xi(o.bounds.left+E*.39363,o.bounds.top+E*.79),new xi(o.bounds.left+E*.16,o.bounds.top+E*.5549),new xi(o.bounds.left+E*.27347,o.bounds.top+E*.44071),new xi(o.bounds.left+E*.39694,o.bounds.top+E*.5649),new xi(o.bounds.left+E*.72983,o.bounds.top+E*.23),new xi(o.bounds.left+E*.84,o.bounds.top+E*.34085),new xi(o.bounds.left+E*.39363,o.bounds.top+E*.79)]),this.ctx.fillStyle=Ls(Nv),this.ctx.fill(),this.ctx.restore()):o.type===tp&&o.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(o.bounds.left+E/2,o.bounds.top+E/2,E/4,0,Math.PI*2,!0),this.ctx.fillStyle=Ls(Nv),this.ctx.fill(),this.ctx.restore())),RT(o)&&o.value.length){switch(G=this.createFontStyle(n),Et=G[0],S=G[1],O=this.fontMetrics.getMetrics(Et,S).baseline,this.ctx.font=Et,this.ctx.fillStyle=Ls(n.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=HT(o.styles.textAlign),Pt=sp(o),P=0,o.styles.textAlign){case 1:P+=Pt.width/2;break;case 2:P+=Pt.width;break}tt=Pt.add(P,0,0,-Pt.height/2+1),this.ctx.save(),this.path([new xi(Pt.left,Pt.top),new xi(Pt.left+Pt.width,Pt.top),new xi(Pt.left+Pt.width,Pt.top+Pt.height),new xi(Pt.left,Pt.top+Pt.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new lg(o.value,tt),n.letterSpacing,O),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!vs(o.styles.display,2048))return[3,20];if(o.styles.listStyleImage===null)return[3,19];if(z=o.styles.listStyleImage,z.type!==0)return[3,18];rt=void 0,ct=z.url,Qt.label=15;case 15:return Qt.trys.push([15,17,,18]),[4,this.context.cache.match(ct)];case 16:return rt=Qt.sent(),this.ctx.drawImage(rt,o.bounds.left-(rt.width+10),o.bounds.top),[3,18];case 17:return Qt.sent(),this.context.logger.error("Error loading list-style-image "+ct),[3,18];case 18:return[3,20];case 19:e.listValue&&o.styles.listStyleType!==-1&&(Et=this.createFontStyle(n)[0],this.ctx.font=Et,this.ctx.fillStyle=Ls(n.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Pt=new ml(o.bounds.left,o.bounds.top+In(o.styles.paddingTop,o.bounds.width),o.bounds.width,bv(n.lineHeight,n.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new lg(e.listValue,Pt),n.letterSpacing,bv(n.lineHeight,n.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Qt.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(e){return xo(this,void 0,void 0,function(){var o,l,z,n,g,z,h,m,z,B,_,z,E,G,z,S,O,z,P,tt,z;return so(this,function(rt){switch(rt.label){case 0:if(vs(e.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(e.element)];case 1:rt.sent(),o=0,l=e.negativeZIndex,rt.label=2;case 2:return o<l.length?(z=l[o],[4,this.renderStack(z)]):[3,5];case 3:rt.sent(),rt.label=4;case 4:return o++,[3,2];case 5:return[4,this.renderNodeContent(e.element)];case 6:rt.sent(),n=0,g=e.nonInlineLevel,rt.label=7;case 7:return n<g.length?(z=g[n],[4,this.renderNode(z)]):[3,10];case 8:rt.sent(),rt.label=9;case 9:return n++,[3,7];case 10:h=0,m=e.nonPositionedFloats,rt.label=11;case 11:return h<m.length?(z=m[h],[4,this.renderStack(z)]):[3,14];case 12:rt.sent(),rt.label=13;case 13:return h++,[3,11];case 14:B=0,_=e.nonPositionedInlineLevel,rt.label=15;case 15:return B<_.length?(z=_[B],[4,this.renderStack(z)]):[3,18];case 16:rt.sent(),rt.label=17;case 17:return B++,[3,15];case 18:E=0,G=e.inlineLevel,rt.label=19;case 19:return E<G.length?(z=G[E],[4,this.renderNode(z)]):[3,22];case 20:rt.sent(),rt.label=21;case 21:return E++,[3,19];case 22:S=0,O=e.zeroOrAutoZIndexOrTransformedOrOpacity,rt.label=23;case 23:return S<O.length?(z=O[S],[4,this.renderStack(z)]):[3,26];case 24:rt.sent(),rt.label=25;case 25:return S++,[3,23];case 26:P=0,tt=e.positiveZIndex,rt.label=27;case 27:return P<tt.length?(z=tt[P],[4,this.renderStack(z)]):[3,30];case 28:rt.sent(),rt.label=29;case 29:return P++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(e){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(e.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(e){this.ctx.beginPath(),this.formatPath(e),this.ctx.closePath()},t.prototype.formatPath=function(e){var o=this;e.forEach(function(l,n){var g=La(l)?l.start:l;n===0?o.ctx.moveTo(g.x,g.y):o.ctx.lineTo(g.x,g.y),La(l)&&o.ctx.bezierCurveTo(l.startControl.x,l.startControl.y,l.endControl.x,l.endControl.y,l.end.x,l.end.y)})},t.prototype.renderRepeat=function(e,o,l,n){this.path(e),this.ctx.fillStyle=o,this.ctx.translate(l,n),this.ctx.fill(),this.ctx.translate(-l,-n)},t.prototype.resizeImage=function(e,o,l){var n;if(e.width===o&&e.height===l)return e;var g=(n=this.canvas.ownerDocument)!==null&&n!==void 0?n:document,h=g.createElement("canvas");h.width=Math.max(1,o),h.height=Math.max(1,l);var m=h.getContext("2d");return m.drawImage(e,0,0,e.width,e.height,0,0,o,l),h},t.prototype.renderBackgroundImage=function(e){return xo(this,void 0,void 0,function(){var o,l,n,g,h,m;return so(this,function(B){switch(B.label){case 0:o=e.styles.backgroundImage.length-1,l=function(_){var E,G,S,oe,ce,ae,Ft,St,dt,O,oe,ce,ae,Ft,St,P,tt,z,rt,ct,Et,Pt,Qt,Ut,dt,ee,oe,ht,At,Ft,St,ue,ce,ae,se,Lt,Ht,fe,j,It,bt,Vt;return so(this,function(Xt){switch(Xt.label){case 0:if(_.type!==0)return[3,5];E=void 0,G=_.url,Xt.label=1;case 1:return Xt.trys.push([1,3,,4]),[4,n.context.cache.match(G)];case 2:return E=Xt.sent(),[3,4];case 3:return Xt.sent(),n.context.logger.error("Error loading background-image "+G),[3,4];case 4:return E&&(S=vC(e,o,[E.width,E.height,E.width/E.height]),oe=S[0],ce=S[1],ae=S[2],Ft=S[3],St=S[4],dt=n.ctx.createPattern(n.resizeImage(E,Ft,St),"repeat"),n.renderRepeat(oe,dt,ce,ae)),[3,6];case 5:bk(_)?(O=vC(e,o,[null,null,null]),oe=O[0],ce=O[1],ae=O[2],Ft=O[3],St=O[4],P=fk(_.angle,Ft,St),tt=P[0],z=P[1],rt=P[2],ct=P[3],Et=P[4],Pt=document.createElement("canvas"),Pt.width=Ft,Pt.height=St,Qt=Pt.getContext("2d"),Ut=Qt.createLinearGradient(z,ct,rt,Et),Iv(_.stops,tt).forEach(function(he){return Ut.addColorStop(he.stop,Ls(he.color))}),Qt.fillStyle=Ut,Qt.fillRect(0,0,Ft,St),Ft>0&&St>0&&(dt=n.ctx.createPattern(Pt,"repeat"),n.renderRepeat(oe,dt,ce,ae))):vk(_)&&(ee=vC(e,o,[null,null,null]),oe=ee[0],ht=ee[1],At=ee[2],Ft=ee[3],St=ee[4],ue=_.position.length===0?[zC]:_.position,ce=In(ue[0],Ft),ae=In(ue[ue.length-1],St),se=mk(_,ce,ae,Ft,St),Lt=se[0],Ht=se[1],Lt>0&&Ht>0&&(fe=n.ctx.createRadialGradient(ht+ce,At+ae,0,ht+ce,At+ae,Lt),Iv(_.stops,Lt*2).forEach(function(he){return fe.addColorStop(he.stop,Ls(he.color))}),n.path(oe),n.ctx.fillStyle=fe,Lt!==Ht?(j=e.bounds.left+.5*e.bounds.width,It=e.bounds.top+.5*e.bounds.height,bt=Ht/Lt,Vt=1/bt,n.ctx.save(),n.ctx.translate(j,It),n.ctx.transform(1,0,0,bt,0,0),n.ctx.translate(-j,-It),n.ctx.fillRect(ht,Vt*(At-It)+It,Ft,St*Vt),n.ctx.restore()):n.ctx.fill())),Xt.label=6;case 6:return o--,[2]}})},n=this,g=0,h=e.styles.backgroundImage.slice(0).reverse(),B.label=1;case 1:return g<h.length?(m=h[g],[5,l(m)]):[3,4];case 2:B.sent(),B.label=3;case 3:return g++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(e,o,l){return xo(this,void 0,void 0,function(){return so(this,function(n){return this.path(jv(l,o)),this.ctx.fillStyle=Ls(e),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(e,o,l,n){return xo(this,void 0,void 0,function(){var g,h;return so(this,function(m){switch(m.label){case 0:return o<3?[4,this.renderSolidBorder(e,l,n)]:[3,2];case 1:return m.sent(),[2];case 2:return g=_T(n,l),this.path(g),this.ctx.fillStyle=Ls(e),this.ctx.fill(),h=xT(n,l),this.path(h),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(e){return xo(this,void 0,void 0,function(){var o,l,n,g,h,m,B,_,E=this;return so(this,function(G){switch(G.label){case 0:return this.applyEffects(e.getEffects(2)),o=e.container.styles,l=!sc(o.backgroundColor)||o.backgroundImage.length,n=[{style:o.borderTopStyle,color:o.borderTopColor,width:o.borderTopWidth},{style:o.borderRightStyle,color:o.borderRightColor,width:o.borderRightWidth},{style:o.borderBottomStyle,color:o.borderBottomColor,width:o.borderBottomWidth},{style:o.borderLeftStyle,color:o.borderLeftColor,width:o.borderLeftWidth}],g=ZT(Ru(o.backgroundClip,0),e.curves),l||o.boxShadow.length?(this.ctx.save(),this.path(g),this.ctx.clip(),sc(o.backgroundColor)||(this.ctx.fillStyle=Ls(o.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(e.container)]):[3,2];case 1:G.sent(),this.ctx.restore(),o.boxShadow.slice(0).reverse().forEach(function(S){E.ctx.save();var O=rp(e.curves),P=S.inset?0:UT,tt=wT(O,-P+(S.inset?1:-1)*S.spread.number,(S.inset?1:-1)*S.spread.number,S.spread.number*(S.inset?-2:2),S.spread.number*(S.inset?-2:2));S.inset?(E.path(O),E.ctx.clip(),E.mask(tt)):(E.mask(O),E.ctx.clip(),E.path(tt)),E.ctx.shadowOffsetX=S.offsetX.number+P,E.ctx.shadowOffsetY=S.offsetY.number,E.ctx.shadowColor=Ls(S.color),E.ctx.shadowBlur=S.blur.number,E.ctx.fillStyle=S.inset?Ls(S.color):"rgba(0,0,0,1)",E.ctx.fill(),E.ctx.restore()}),G.label=2;case 2:h=0,m=0,B=n,G.label=3;case 3:return m<B.length?(_=B[m],_.style!==0&&!sc(_.color)&&_.width>0?_.style!==2?[3,5]:[4,this.renderDashedDottedBorder(_.color,_.width,h,e.curves,2)]:[3,11]):[3,13];case 4:return G.sent(),[3,11];case 5:return _.style!==3?[3,7]:[4,this.renderDashedDottedBorder(_.color,_.width,h,e.curves,3)];case 6:return G.sent(),[3,11];case 7:return _.style!==4?[3,9]:[4,this.renderDoubleBorder(_.color,_.width,h,e.curves)];case 8:return G.sent(),[3,11];case 9:return[4,this.renderSolidBorder(_.color,h,e.curves)];case 10:G.sent(),G.label=11;case 11:h++,G.label=12;case 12:return m++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(e,o,l,n,g){return xo(this,void 0,void 0,function(){var h,m,B,_,E,G,S,O,P,tt,z,rt,ct,Et,Pt,Qt,Pt,Qt;return so(this,function(Ut){return this.ctx.save(),h=ST(n,l),m=jv(n,l),g===2&&(this.path(m),this.ctx.clip()),La(m[0])?(B=m[0].start.x,_=m[0].start.y):(B=m[0].x,_=m[0].y),La(m[1])?(E=m[1].end.x,G=m[1].end.y):(E=m[1].x,G=m[1].y),l===0||l===2?S=Math.abs(B-E):S=Math.abs(_-G),this.ctx.beginPath(),g===3?this.formatPath(h):this.formatPath(m.slice(0,2)),O=o<3?o*3:o*2,P=o<3?o*2:o,g===3&&(O=o,P=o),tt=!0,S<=O*2?tt=!1:S<=O*2+P?(z=S/(2*O+P),O*=z,P*=z):(rt=Math.floor((S+P)/(O+P)),ct=(S-rt*O)/(rt-1),Et=(S-(rt+1)*O)/rt,P=Et<=0||Math.abs(P-ct)<Math.abs(P-Et)?ct:Et),tt&&(g===3?this.ctx.setLineDash([0,O+P]):this.ctx.setLineDash([O,P])),g===3?(this.ctx.lineCap="round",this.ctx.lineWidth=o):this.ctx.lineWidth=o*2+1.1,this.ctx.strokeStyle=Ls(e),this.ctx.stroke(),this.ctx.setLineDash([]),g===2&&(La(m[0])&&(Pt=m[3],Qt=m[0],this.ctx.beginPath(),this.formatPath([new xi(Pt.end.x,Pt.end.y),new xi(Qt.start.x,Qt.start.y)]),this.ctx.stroke()),La(m[1])&&(Pt=m[1],Qt=m[2],this.ctx.beginPath(),this.formatPath([new xi(Pt.end.x,Pt.end.y),new xi(Qt.start.x,Qt.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(e){return xo(this,void 0,void 0,function(){var o;return so(this,function(l){switch(l.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Ls(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),o=BT(e),[4,this.renderStack(o)];case 1:return l.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(ew),RT=function(i){return i instanceof H2||i instanceof Z2?!0:i instanceof jC&&i.type!==tp&&i.type!==$d},ZT=function(i,t){switch(i){case 0:return rp(t);case 2:return CT(t);case 1:default:return np(t)}},HT=function(i){switch(i){case 1:return"center";case 2:return"right";case 0:default:return"left"}},NT=["-apple-system","system-ui"],PT=function(i){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?i.filter(function(t){return NT.indexOf(t)===-1}):i},MT=function(i){sA(t,i);function t(e,o){var l=i.call(this,e,o)||this;return l.canvas=o.canvas?o.canvas:document.createElement("canvas"),l.ctx=l.canvas.getContext("2d"),l.options=o,l.canvas.width=Math.floor(o.width*o.scale),l.canvas.height=Math.floor(o.height*o.scale),l.canvas.style.width=o.width+"px",l.canvas.style.height=o.height+"px",l.ctx.scale(l.options.scale,l.options.scale),l.ctx.translate(-o.x,-o.y),l.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+o.width+"x"+o.height+" at "+o.x+","+o.y+") with scale "+o.scale),l}return t.prototype.render=function(e){return xo(this,void 0,void 0,function(){var o,l;return so(this,function(n){switch(n.label){case 0:return o=NC(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,e),[4,VT(o)];case 1:return l=n.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Ls(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(l,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(ew),VT=function(i){return new Promise(function(t,e){var o=new Image;o.onload=function(){t(o)},o.onerror=e,o.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(i))})},DT=function(){function i(t){var e=t.id,o=t.enabled;this.id=e,this.enabled=o,this.start=Date.now()}return i.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Fd([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},i.prototype.getTime=function(){return Date.now()-this.start},i.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Fd([this.id,this.getTime()+"ms"],t))},i.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Fd([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},i.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Fd([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},i.instances={},i}(),KT=function(){function i(t,e){var o;this.windowBounds=e,this.instanceName="#"+i.instanceCount++,this.logger=new DT({id:this.instanceName,enabled:t.logging}),this.cache=(o=t.cache)!==null&&o!==void 0?o:new cT(this,t)}return i.instanceCount=1,i}(),OT=function(i,t){return t===void 0&&(t={}),WT(i,t)};typeof window<"u"&&X2.setContext(window);WT=function(i,t){return xo(void 0,void 0,void 0,function(){var e,o,l,n,g,h,m,B,_,E,G,S,O,P,tt,z,rt,ct,Et,Pt,Ut,Qt,Ut,dt,ee,oe,ht,At,Ft,St,ue,ce,ae,se,Lt,Ht,fe,j,It,bt;return so(this,function(Vt){switch(Vt.label){case 0:if(!i||typeof i!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(e=i.ownerDocument,!e)throw new Error("Element is not attached to a Document");if(o=e.defaultView,!o)throw new Error("Document is not attached to a Window");return l={allowTaint:(dt=t.allowTaint)!==null&&dt!==void 0?dt:!1,imageTimeout:(ee=t.imageTimeout)!==null&&ee!==void 0?ee:15e3,proxy:t.proxy,useCORS:(oe=t.useCORS)!==null&&oe!==void 0?oe:!1},n=BC({logging:(ht=t.logging)!==null&&ht!==void 0?ht:!0,cache:t.cache},l),g={windowWidth:(At=t.windowWidth)!==null&&At!==void 0?At:o.innerWidth,windowHeight:(Ft=t.windowHeight)!==null&&Ft!==void 0?Ft:o.innerHeight,scrollX:(St=t.scrollX)!==null&&St!==void 0?St:o.pageXOffset,scrollY:(ue=t.scrollY)!==null&&ue!==void 0?ue:o.pageYOffset},h=new ml(g.scrollX,g.scrollY,g.windowWidth,g.windowHeight),m=new KT(n,h),B=(ce=t.foreignObjectRendering)!==null&&ce!==void 0?ce:!1,_={allowTaint:(ae=t.allowTaint)!==null&&ae!==void 0?ae:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:B,copyStyles:B},m.logger.debug("Starting document clone with size "+h.width+"x"+h.height+" scrolled to "+-h.left+","+-h.top),E=new Jv(m,i,_),G=E.clonedReferenceElement,G?[4,E.toIFrame(e,h)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return S=Vt.sent(),O=qC(G)||zE(G)?wF(G.ownerDocument):op(m,G),P=O.width,tt=O.height,z=O.left,rt=O.top,ct=zT(m,G,t.backgroundColor),Et={canvas:t.canvas,backgroundColor:ct,scale:(Lt=(se=t.scale)!==null&&se!==void 0?se:o.devicePixelRatio)!==null&&Lt!==void 0?Lt:1,x:((Ht=t.x)!==null&&Ht!==void 0?Ht:0)+z,y:((fe=t.y)!==null&&fe!==void 0?fe:0)+rt,width:(j=t.width)!==null&&j!==void 0?j:Math.ceil(P),height:(It=t.height)!==null&&It!==void 0?It:Math.ceil(tt)},B?(m.logger.debug("Document cloned, using foreign object rendering"),Ut=new MT(m,Et),[4,Ut.render(G)]):[3,3];case 2:return Pt=Vt.sent(),[3,5];case 3:return m.logger.debug("Document cloned, element located at "+z+","+rt+" with size "+P+"x"+tt+" using computed rendering"),m.logger.debug("Starting DOM parsing"),Qt=M2(m,G),ct===Qt.styles.backgroundColor&&(Qt.styles.backgroundColor=fl.TRANSPARENT),m.logger.debug("Starting renderer for element at "+Et.x+","+Et.y+" with size "+Et.width+"x"+Et.height),Ut=new GT(m,Et),[4,Ut.render(Qt)];case 4:Pt=Vt.sent(),Vt.label=5;case 5:return(!((bt=t.removeContainer)!==null&&bt!==void 0)||bt)&&(Jv.destroy(S)||m.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),m.logger.debug("Finished rendering"),[2,Pt]}})})},zT=function(i,t,e){var o=t.ownerDocument,l=o.documentElement?ag(i,getComputedStyle(o.documentElement).backgroundColor):fl.TRANSPARENT,n=o.body?ag(i,getComputedStyle(o.body).backgroundColor):fl.TRANSPARENT,g=typeof e=="string"?ag(i,e):e===null?fl.TRANSPARENT:4294967295;return t===o.documentElement?sc(l)?sc(n)?g:n:l:g}});var hw={};Ym(hw,{default:()=>vQ});function ac(i){return ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ac(i)}function s0(i,t){return s0=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e},s0(i,t)}function JT(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cp(i,t,e){return JT()?Cp=Reflect.construct:Cp=function(o,l,n){var g=[null];g.push.apply(g,l);var h=Function.bind.apply(o,g),m=new h;return n&&s0(m,n.prototype),m},Cp.apply(null,arguments)}function aA(i){return XT(i)||YT(i)||jT(i)||qT()}function XT(i){if(Array.isArray(i))return o0(i)}function YT(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function jT(i,t){if(i){if(typeof i=="string")return o0(i,t);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return o0(i,t)}}function o0(i,t){(t==null||t>i.length)&&(t=i.length);for(var e=0,o=new Array(t);e<t;e++)o[e]=i[e];return o}function qT(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qa(i){return function(t){for(var e=arguments.length,o=new Array(e>1?e-1:0),l=1;l<e;l++)o[l-1]=arguments[l];return yp(i,t,o)}}function AQ(i){return function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return a0(i,e)}}function br(i,t,e){e=e||Ip,nw&&nw(i,null);for(var o=t.length;o--;){var l=t[o];if(typeof l=="string"){var n=e(l);n!==l&&(tQ(t)||(t[o]=n),l=n)}i[l]=!0}return i}function Oc(i){var t=rQ(null),e;for(e in i)yp($T,i,[e])===!0&&(t[e]=i[e]);return t}function fp(i,t){for(;i!==null;){var e=iQ(i,t);if(e){if(e.get)return Qa(e.get);if(typeof e.value=="function")return Qa(e.value)}i=eQ(i)}function o(l){return console.warn("fallback value for",l),null}return o}function uw(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yQ(),t=function(Nt){return uw(Nt)};if(t.version="2.4.5",t.removed=[],!i||!i.document||i.document.nodeType!==9)return t.isSupported=!1,t;var e=i.document,o=i.document,l=i.DocumentFragment,n=i.HTMLTemplateElement,g=i.Node,h=i.Element,m=i.NodeFilter,B=i.NamedNodeMap,_=B===void 0?i.NamedNodeMap||i.MozNamedAttrMap:B,E=i.HTMLFormElement,G=i.DOMParser,S=i.trustedTypes,O=h.prototype,P=fp(O,"cloneNode"),tt=fp(O,"nextSibling"),z=fp(O,"childNodes"),rt=fp(O,"parentNode");if(typeof n=="function"){var ct=o.createElement("template");ct.content&&ct.content.ownerDocument&&(o=ct.content.ownerDocument)}var Et=bQ(S,e),Pt=Et?Et.createHTML(""):"",Qt=o,Ut=Qt.implementation,dt=Qt.createNodeIterator,ee=Qt.createDocumentFragment,oe=Qt.getElementsByTagName,ht=e.importNode,At={};try{At=Oc(o).documentMode?o.documentMode:{}}catch{}var Ft={};t.isSupported=typeof rt=="function"&&Ut&&typeof Ut.createHTMLDocument<"u"&&At!==9;var St=uQ,ue=hQ,ce=gQ,ae=dQ,se=pQ,Lt=mQ,Ht=CQ,fe=fQ,j=null,It=br({},[].concat(aA(ow),aA(e0),aA(i0),aA(r0),aA(aw))),bt=null,Vt=br({},[].concat(aA(Aw),aA(n0),aA(lw),aA(mp))),Xt=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),he=null,me=null,be=!0,Ve=!0,De=!1,ei=!0,ri=!1,Ii=!1,Be=!1,Rt=!1,Ui=!1,$t=!1,Ze=!1,We=!0,He=!1,Re="user-content-",hi=!0,yi=!1,Qi={},Pi=null,zi=br({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ir=null,Ei=br({},["audio","video","img","source","image","track"]),Fe=null,Ye=br({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ki="http://www.w3.org/1998/Math/MathML",ji="http://www.w3.org/2000/svg",vr="http://www.w3.org/1999/xhtml",Qe=vr,gi=!1,Bi=null,Oi=br({},[Ki,ji,vr],$C),Fr,pi=["application/xhtml+xml","text/html"],Pr="text/html",gt,Y=null,q=o.createElement("form"),lt=function(Nt){return Nt instanceof RegExp||Nt instanceof Function},_t=function(Nt){Y&&Y===Nt||((!Nt||ac(Nt)!=="object")&&(Nt={}),Nt=Oc(Nt),Fr=pi.indexOf(Nt.PARSER_MEDIA_TYPE)===-1?Fr=Pr:Fr=Nt.PARSER_MEDIA_TYPE,gt=Fr==="application/xhtml+xml"?$C:Ip,j="ALLOWED_TAGS"in Nt?br({},Nt.ALLOWED_TAGS,gt):It,bt="ALLOWED_ATTR"in Nt?br({},Nt.ALLOWED_ATTR,gt):Vt,Bi="ALLOWED_NAMESPACES"in Nt?br({},Nt.ALLOWED_NAMESPACES,$C):Oi,Fe="ADD_URI_SAFE_ATTR"in Nt?br(Oc(Ye),Nt.ADD_URI_SAFE_ATTR,gt):Ye,ir="ADD_DATA_URI_TAGS"in Nt?br(Oc(Ei),Nt.ADD_DATA_URI_TAGS,gt):Ei,Pi="FORBID_CONTENTS"in Nt?br({},Nt.FORBID_CONTENTS,gt):zi,he="FORBID_TAGS"in Nt?br({},Nt.FORBID_TAGS,gt):{},me="FORBID_ATTR"in Nt?br({},Nt.FORBID_ATTR,gt):{},Qi="USE_PROFILES"in Nt?Nt.USE_PROFILES:!1,be=Nt.ALLOW_ARIA_ATTR!==!1,Ve=Nt.ALLOW_DATA_ATTR!==!1,De=Nt.ALLOW_UNKNOWN_PROTOCOLS||!1,ei=Nt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ri=Nt.SAFE_FOR_TEMPLATES||!1,Ii=Nt.WHOLE_DOCUMENT||!1,Ui=Nt.RETURN_DOM||!1,$t=Nt.RETURN_DOM_FRAGMENT||!1,Ze=Nt.RETURN_TRUSTED_TYPE||!1,Rt=Nt.FORCE_BODY||!1,We=Nt.SANITIZE_DOM!==!1,He=Nt.SANITIZE_NAMED_PROPS||!1,hi=Nt.KEEP_CONTENT!==!1,yi=Nt.IN_PLACE||!1,fe=Nt.ALLOWED_URI_REGEXP||fe,Qe=Nt.NAMESPACE||vr,Xt=Nt.CUSTOM_ELEMENT_HANDLING||{},Nt.CUSTOM_ELEMENT_HANDLING&&lt(Nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Xt.tagNameCheck=Nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Nt.CUSTOM_ELEMENT_HANDLING&&lt(Nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Xt.attributeNameCheck=Nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Nt.CUSTOM_ELEMENT_HANDLING&&typeof Nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Xt.allowCustomizedBuiltInElements=Nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ri&&(Ve=!1),$t&&(Ui=!0),Qi&&(j=br({},aA(aw)),bt=[],Qi.html===!0&&(br(j,ow),br(bt,Aw)),Qi.svg===!0&&(br(j,e0),br(bt,n0),br(bt,mp)),Qi.svgFilters===!0&&(br(j,i0),br(bt,n0),br(bt,mp)),Qi.mathMl===!0&&(br(j,r0),br(bt,lw),br(bt,mp))),Nt.ADD_TAGS&&(j===It&&(j=Oc(j)),br(j,Nt.ADD_TAGS,gt)),Nt.ADD_ATTR&&(bt===Vt&&(bt=Oc(bt)),br(bt,Nt.ADD_ATTR,gt)),Nt.ADD_URI_SAFE_ATTR&&br(Fe,Nt.ADD_URI_SAFE_ATTR,gt),Nt.FORBID_CONTENTS&&(Pi===zi&&(Pi=Oc(Pi)),br(Pi,Nt.FORBID_CONTENTS,gt)),hi&&(j["#text"]=!0),Ii&&br(j,["html","head","body"]),j.table&&(br(j,["tbody"]),delete he.tbody),ko&&ko(Nt),Y=Nt)},xt=br({},["mi","mo","mn","ms","mtext"]),qt=br({},["foreignobject","desc","title","annotation-xml"]),Jt=br({},["title","style","font","a","script"]),mt=br({},e0);br(mt,i0),br(mt,lQ);var jt=br({},r0);br(jt,cQ);var _e=function(Nt){var ze=rt(Nt);(!ze||!ze.tagName)&&(ze={namespaceURI:Qe,tagName:"template"});var Ne=Ip(Nt.tagName),Wi=Ip(ze.tagName);return Bi[Nt.namespaceURI]?Nt.namespaceURI===ji?ze.namespaceURI===vr?Ne==="svg":ze.namespaceURI===Ki?Ne==="svg"&&(Wi==="annotation-xml"||xt[Wi]):!!mt[Ne]:Nt.namespaceURI===Ki?ze.namespaceURI===vr?Ne==="math":ze.namespaceURI===ji?Ne==="math"&&qt[Wi]:!!jt[Ne]:Nt.namespaceURI===vr?ze.namespaceURI===ji&&!qt[Wi]||ze.namespaceURI===Ki&&!xt[Wi]?!1:!jt[Ne]&&(Jt[Ne]||!mt[Ne]):!!(Fr==="application/xhtml+xml"&&Bi[Nt.namespaceURI]):!1},ve=function(Nt){fg(t.removed,{element:Nt});try{Nt.parentNode.removeChild(Nt)}catch{try{Nt.outerHTML=Pt}catch{Nt.remove()}}},xe=function(Nt,ze){try{fg(t.removed,{attribute:ze.getAttributeNode(Nt),from:ze})}catch{fg(t.removed,{attribute:null,from:ze})}if(ze.removeAttribute(Nt),Nt==="is"&&!bt[Nt])if(Ui||$t)try{ve(ze)}catch{}else try{ze.setAttribute(Nt,"")}catch{}},si=function(Nt){var ze,Ne;if(Rt)Nt="<remove></remove>"+Nt;else{var Wi=sQ(Nt,/^[\r\n\t ]+/);Ne=Wi&&Wi[0]}Fr==="application/xhtml+xml"&&Qe===vr&&(Nt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Nt+"</body></html>");var Lr=Et?Et.createHTML(Nt):Nt;if(Qe===vr)try{ze=new G().parseFromString(Lr,Fr)}catch{}if(!ze||!ze.documentElement){ze=Ut.createDocument(Qe,"template",null);try{ze.documentElement.innerHTML=gi?Pt:Lr}catch{}}var $r=ze.body||ze.documentElement;return Nt&&Ne&&$r.insertBefore(o.createTextNode(Ne),$r.childNodes[0]||null),Qe===vr?oe.call(ze,Ii?"html":"body")[0]:Ii?ze.documentElement:$r},_i=function(Nt){return dt.call(Nt.ownerDocument||Nt,Nt,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT,null,!1)},ui=function(Nt){return Nt instanceof E&&(typeof Nt.nodeName!="string"||typeof Nt.textContent!="string"||typeof Nt.removeChild!="function"||!(Nt.attributes instanceof _)||typeof Nt.removeAttribute!="function"||typeof Nt.setAttribute!="function"||typeof Nt.namespaceURI!="string"||typeof Nt.insertBefore!="function"||typeof Nt.hasChildNodes!="function")},fi=function(Nt){return ac(g)==="object"?Nt instanceof g:Nt&&ac(Nt)==="object"&&typeof Nt.nodeType=="number"&&typeof Nt.nodeName=="string"},bi=function(Nt,ze,Ne){Ft[Nt]&&nQ(Ft[Nt],function(Wi){Wi.call(t,ze,Ne,Y)})},$i=function(Nt){var ze;if(bi("beforeSanitizeElements",Nt,null),ui(Nt)||Fo(/[\u0080-\uFFFF]/,Nt.nodeName))return ve(Nt),!0;var Ne=gt(Nt.nodeName);if(bi("uponSanitizeElement",Nt,{tagName:Ne,allowedTags:j}),Nt.hasChildNodes()&&!fi(Nt.firstElementChild)&&(!fi(Nt.content)||!fi(Nt.content.firstElementChild))&&Fo(/<[/\w]/g,Nt.innerHTML)&&Fo(/<[/\w]/g,Nt.textContent)||Ne==="select"&&Fo(/<template/i,Nt.innerHTML))return ve(Nt),!0;if(!j[Ne]||he[Ne]){if(!he[Ne]&&Ji(Ne)&&(Xt.tagNameCheck instanceof RegExp&&Fo(Xt.tagNameCheck,Ne)||Xt.tagNameCheck instanceof Function&&Xt.tagNameCheck(Ne)))return!1;if(hi&&!Pi[Ne]){var Wi=rt(Nt)||Nt.parentNode,Lr=z(Nt)||Nt.childNodes;if(Lr&&Wi)for(var $r=Lr.length,Qr=$r-1;Qr>=0;--Qr)Wi.insertBefore(P(Lr[Qr],!0),tt(Nt))}return ve(Nt),!0}return Nt instanceof h&&!_e(Nt)||(Ne==="noscript"||Ne==="noembed")&&Fo(/<\/no(script|embed)/i,Nt.innerHTML)?(ve(Nt),!0):(ri&&Nt.nodeType===3&&(ze=Nt.textContent,ze=oA(ze,St," "),ze=oA(ze,ue," "),ze=oA(ze,ce," "),Nt.textContent!==ze&&(fg(t.removed,{element:Nt.cloneNode()}),Nt.textContent=ze)),bi("afterSanitizeElements",Nt,null),!1)},or=function(Nt,ze,Ne){if(We&&(ze==="id"||ze==="name")&&(Ne in o||Ne in q))return!1;if(!(Ve&&!me[ze]&&Fo(ae,ze))&&!(be&&Fo(se,ze))){if(!bt[ze]||me[ze]){if(!(Ji(Nt)&&(Xt.tagNameCheck instanceof RegExp&&Fo(Xt.tagNameCheck,Nt)||Xt.tagNameCheck instanceof Function&&Xt.tagNameCheck(Nt))&&(Xt.attributeNameCheck instanceof RegExp&&Fo(Xt.attributeNameCheck,ze)||Xt.attributeNameCheck instanceof Function&&Xt.attributeNameCheck(ze))||ze==="is"&&Xt.allowCustomizedBuiltInElements&&(Xt.tagNameCheck instanceof RegExp&&Fo(Xt.tagNameCheck,Ne)||Xt.tagNameCheck instanceof Function&&Xt.tagNameCheck(Ne))))return!1}else if(!Fe[ze]&&!Fo(fe,oA(Ne,Ht,""))&&!((ze==="src"||ze==="xlink:href"||ze==="href")&&Nt!=="script"&&oQ(Ne,"data:")===0&&ir[Nt])&&!(De&&!Fo(Lt,oA(Ne,Ht,"")))&&Ne)return!1}return!0},Ji=function(Nt){return Nt.indexOf("-")>0},Mi=function(Nt){var ze,Ne,Wi,Lr;bi("beforeSanitizeAttributes",Nt,null);var $r=Nt.attributes;if($r){var Qr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:bt};for(Lr=$r.length;Lr--;){ze=$r[Lr];var uo=ze,qi=uo.name,An=uo.namespaceURI;if(Ne=qi==="value"?ze.value:aQ(ze.value),Wi=gt(qi),Qr.attrName=Wi,Qr.attrValue=Ne,Qr.keepAttr=!0,Qr.forceKeepAttr=void 0,bi("uponSanitizeAttribute",Nt,Qr),Ne=Qr.attrValue,!Qr.forceKeepAttr&&(xe(qi,Nt),!!Qr.keepAttr)){if(!ei&&Fo(/\/>/i,Ne)){xe(qi,Nt);continue}ri&&(Ne=oA(Ne,St," "),Ne=oA(Ne,ue," "),Ne=oA(Ne,ce," "));var ho=gt(Nt.nodeName);if(or(ho,Wi,Ne)){if(He&&(Wi==="id"||Wi==="name")&&(xe(qi,Nt),Ne=Re+Ne),Et&&ac(S)==="object"&&typeof S.getAttributeType=="function"&&!An)switch(S.getAttributeType(ho,Wi)){case"TrustedHTML":Ne=Et.createHTML(Ne);break;case"TrustedScriptURL":Ne=Et.createScriptURL(Ne);break}try{An?Nt.setAttributeNS(An,qi,Ne):Nt.setAttribute(qi,Ne),sw(t.removed)}catch{}}}}bi("afterSanitizeAttributes",Nt,null)}},kr=function Nt(ze){var Ne,Wi=_i(ze);for(bi("beforeSanitizeShadowDOM",ze,null);Ne=Wi.nextNode();)bi("uponSanitizeShadowNode",Ne,null),!$i(Ne)&&(Ne.content instanceof l&&Nt(Ne.content),Mi(Ne));bi("afterSanitizeShadowDOM",ze,null)};return t.sanitize=function(Nt){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ne,Wi,Lr,$r,Qr;if(gi=!Nt,gi&&(Nt="<!-->"),typeof Nt!="string"&&!fi(Nt)){if(typeof Nt.toString!="function")throw t0("toString is not a function");if(Nt=Nt.toString(),typeof Nt!="string")throw t0("dirty is not a string, aborting")}if(!t.isSupported){if(ac(i.toStaticHTML)==="object"||typeof i.toStaticHTML=="function"){if(typeof Nt=="string")return i.toStaticHTML(Nt);if(fi(Nt))return i.toStaticHTML(Nt.outerHTML)}return Nt}if(Be||_t(ze),t.removed=[],typeof Nt=="string"&&(yi=!1),yi){if(Nt.nodeName){var uo=gt(Nt.nodeName);if(!j[uo]||he[uo])throw t0("root node is forbidden and cannot be sanitized in-place")}}else if(Nt instanceof g)Ne=si("<!---->"),Wi=Ne.ownerDocument.importNode(Nt,!0),Wi.nodeType===1&&Wi.nodeName==="BODY"||Wi.nodeName==="HTML"?Ne=Wi:Ne.appendChild(Wi);else{if(!Ui&&!ri&&!Ii&&Nt.indexOf("<")===-1)return Et&&Ze?Et.createHTML(Nt):Nt;if(Ne=si(Nt),!Ne)return Ui?null:Ze?Pt:""}Ne&&Rt&&ve(Ne.firstChild);for(var qi=_i(yi?Nt:Ne);Lr=qi.nextNode();)Lr.nodeType===3&&Lr===$r||$i(Lr)||(Lr.content instanceof l&&kr(Lr.content),Mi(Lr),$r=Lr);if($r=null,yi)return Nt;if(Ui){if($t)for(Qr=ee.call(Ne.ownerDocument);Ne.firstChild;)Qr.appendChild(Ne.firstChild);else Qr=Ne;return(bt.shadowroot||bt.shadowrootmod)&&(Qr=ht.call(e,Qr,!0)),Qr}var An=Ii?Ne.outerHTML:Ne.innerHTML;return Ii&&j["!doctype"]&&Ne.ownerDocument&&Ne.ownerDocument.doctype&&Ne.ownerDocument.doctype.name&&Fo(IQ,Ne.ownerDocument.doctype.name)&&(An="<!DOCTYPE "+Ne.ownerDocument.doctype.name+`>
`+An),ri&&(An=oA(An,St," "),An=oA(An,ue," "),An=oA(An,ce," ")),Et&&Ze?Et.createHTML(An):An},t.setConfig=function(Nt){_t(Nt),Be=!0},t.clearConfig=function(){Y=null,Be=!1},t.isValidAttribute=function(Nt,ze,Ne){Y||_t({});var Wi=gt(Nt),Lr=gt(ze);return or(Wi,Lr,Ne)},t.addHook=function(Nt,ze){typeof ze=="function"&&(Ft[Nt]=Ft[Nt]||[],fg(Ft[Nt],ze))},t.removeHook=function(Nt){if(Ft[Nt])return sw(Ft[Nt])},t.removeHooks=function(Nt){Ft[Nt]&&(Ft[Nt]=[])},t.removeAllHooks=function(){Ft={}},t}var $T,nw,tQ,eQ,iQ,ko,AA,rQ,cw,yp,a0,nQ,sw,fg,Ip,$C,sQ,oA,oQ,aQ,Fo,t0,ow,e0,i0,lQ,r0,cQ,aw,Aw,n0,lw,mp,uQ,hQ,gQ,dQ,pQ,fQ,mQ,CQ,IQ,yQ,bQ,vQ,gw=vd(()=>{$T=Object.hasOwnProperty,nw=Object.setPrototypeOf,tQ=Object.isFrozen,eQ=Object.getPrototypeOf,iQ=Object.getOwnPropertyDescriptor,ko=Object.freeze,AA=Object.seal,rQ=Object.create,cw=typeof Reflect<"u"&&Reflect,yp=cw.apply,a0=cw.construct;yp||(yp=function(i,t,e){return i.apply(t,e)});ko||(ko=function(i){return i});AA||(AA=function(i){return i});a0||(a0=function(i,t){return Cp(i,aA(t))});nQ=Qa(Array.prototype.forEach),sw=Qa(Array.prototype.pop),fg=Qa(Array.prototype.push),Ip=Qa(String.prototype.toLowerCase),$C=Qa(String.prototype.toString),sQ=Qa(String.prototype.match),oA=Qa(String.prototype.replace),oQ=Qa(String.prototype.indexOf),aQ=Qa(String.prototype.trim),Fo=Qa(RegExp.prototype.test),t0=AQ(TypeError);ow=ko(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),e0=ko(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),i0=ko(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),lQ=ko(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),r0=ko(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),cQ=ko(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),aw=ko(["#text"]),Aw=ko(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),n0=ko(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),lw=ko(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),mp=ko(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),uQ=AA(/\{\{[\w\W]*|[\w\W]*\}\}/gm),hQ=AA(/<%[\w\W]*|[\w\W]*%>/gm),gQ=AA(/\${[\w\W]*}/gm),dQ=AA(/^data-[\-\w.\u00B7-\uFFFF]/),pQ=AA(/^aria-[\-\w]+$/),fQ=AA(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),mQ=AA(/^(?:\w+script|data):/i),CQ=AA(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),IQ=AA(/^html$/i),yQ=function(){return typeof window>"u"?null:window},bQ=function(i,t){if(ac(i)!=="object"||typeof i.createPolicy!="function")return null;var e=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(e=t.currentScript.getAttribute(o));var l="dompurify"+(e?"#"+e:"");try{return i.createPolicy(l,{createHTML:function(n){return n},createScriptURL:function(n){return n}})}catch{return console.warn("TrustedTypes policy "+l+" could not be created."),null}};vQ=uw()});var g5={};Ym(g5,{AElement:()=>vf,AnimateColorElement:()=>ff,AnimateElement:()=>rh,AnimateTransformElement:()=>mf,BoundingBox:()=>Xo,CB1:()=>TI,CB2:()=>QI,CB3:()=>UI,CB4:()=>GI,Canvg:()=>cc,CircleElement:()=>of,ClipPathElement:()=>Ff,DefsElement:()=>hf,DescElement:()=>Uf,Document:()=>gA,Element:()=>an,EllipseElement:()=>af,FeColorMatrixElement:()=>Ng,FeCompositeElement:()=>Ef,FeDropShadowElement:()=>kf,FeGaussianBlurElement:()=>Tf,FeMorphologyElement:()=>Lf,FilterElement:()=>ru,Font:()=>Es,FontElement:()=>Cf,FontFaceElement:()=>If,GElement:()=>ih,GlyphElement:()=>Ug,GradientElement:()=>Zg,ImageElement:()=>Bf,LineElement:()=>Af,LinearGradientElement:()=>gf,MarkerElement:()=>uf,MaskElement:()=>iu,Matrix:()=>Tg,MissingGlyphElement:()=>yf,Mouse:()=>qp,PSEUDO_ZERO:()=>jc,Parser:()=>$u,PathElement:()=>Dr,PathParser:()=>ur,PatternElement:()=>cf,Point:()=>xn,PolygonElement:()=>lf,PolylineElement:()=>Rg,Property:()=>Di,QB1:()=>RI,QB2:()=>ZI,QB3:()=>HI,RadialGradientElement:()=>df,RectElement:()=>Gg,RenderedElement:()=>MA,Rotate:()=>tf,SVGElement:()=>hc,SVGFontLoader:()=>xf,Scale:()=>ef,Screen:()=>tu,Skew:()=>Qg,SkewX:()=>rf,SkewY:()=>nf,StopElement:()=>pf,StyleElement:()=>Hg,SymbolElement:()=>_f,TRefElement:()=>bf,TSpanElement:()=>eu,TextElement:()=>dA,TextPathElement:()=>wf,TitleElement:()=>Qf,Transform:()=>PA,Translate:()=>$p,UnknownElement:()=>sf,UseElement:()=>Sf,ViewPort:()=>jp,compressSpaces:()=>Au,default:()=>cc,getSelectorSpecificity:()=>c5,normalizeAttributeName:()=>A5,normalizeColor:()=>l5,parseExternalUrl:()=>By,presets:()=>Y6,toNumbers:()=>Jo,trimLeft:()=>o5,trimRight:()=>a5,vectorMagnitude:()=>LI,vectorsAngle:()=>EI,vectorsRatio:()=>Yp});function b_(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function fB(i,t,e,o,l,n,g){try{var h=i[n](g),m=h.value}catch(B){e(B);return}h.done?t(m):Promise.resolve(m).then(o,l)}function bl(i){return function(){var t=this,e=arguments;return new Promise(function(o,l){var n=i.apply(t,e);function g(m){fB(n,o,l,g,h,"next",m)}function h(m){fB(n,o,l,g,h,"throw",m)}g(void 0)})}}function qV(i,t){if(Nr(i)!=="object"||i===null)return i;var e=i[Symbol.toPrimitive];if(e!==void 0){var o=e.call(i,t||"default");if(Nr(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function $V(i){var t=qV(i,"string");return Nr(t)==="symbol"?t:String(t)}function by(i,t,e){return t=$V(t),t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function r5(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}i5(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function _6(i){var t="";Array.isArray(i)||(i=[i]);for(var e=0;e<i.length;e++){var o=i[e];if(o.type===Xe.CLOSE_PATH)t+="z";else if(o.type===Xe.HORIZ_LINE_TO)t+=(o.relative?"h":"H")+o.x;else if(o.type===Xe.VERT_LINE_TO)t+=(o.relative?"v":"V")+o.y;else if(o.type===Xe.MOVE_TO)t+=(o.relative?"m":"M")+o.x+" "+o.y;else if(o.type===Xe.LINE_TO)t+=(o.relative?"l":"L")+o.x+" "+o.y;else if(o.type===Xe.CURVE_TO)t+=(o.relative?"c":"C")+o.x1+" "+o.y1+" "+o.x2+" "+o.y2+" "+o.x+" "+o.y;else if(o.type===Xe.SMOOTH_CURVE_TO)t+=(o.relative?"s":"S")+o.x2+" "+o.y2+" "+o.x+" "+o.y;else if(o.type===Xe.QUAD_TO)t+=(o.relative?"q":"Q")+o.x1+" "+o.y1+" "+o.x+" "+o.y;else if(o.type===Xe.SMOOTH_QUAD_TO)t+=(o.relative?"t":"T")+o.x+" "+o.y;else{if(o.type!==Xe.ARC)throw new Error('Unexpected command type "'+o.type+'" at index '+e+".");t+=(o.relative?"a":"A")+o.rX+" "+o.rY+" "+o.xRot+" "+ +o.lArcFlag+" "+ +o.sweepFlag+" "+o.x+" "+o.y}}return t}function kI(i,t){var e=i[0],o=i[1];return[e*Math.cos(t)-o*Math.sin(t),e*Math.sin(t)+o*Math.cos(t)]}function uA(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];for(var e=0;e<i.length;e++)if(typeof i[e]!="number")throw new Error("assertNumbers arguments["+e+"] is not a number. "+typeof i[e]+" == typeof "+i[e]);return!0}function tI(i,t,e){i.lArcFlag=i.lArcFlag===0?0:1,i.sweepFlag=i.sweepFlag===0?0:1;var o=i.rX,l=i.rY,n=i.x,g=i.y;o=Math.abs(i.rX),l=Math.abs(i.rY);var h=kI([(t-n)/2,(e-g)/2],-i.xRot/180*lc),m=h[0],B=h[1],_=Math.pow(m,2)/Math.pow(o,2)+Math.pow(B,2)/Math.pow(l,2);1<_&&(o*=Math.sqrt(_),l*=Math.sqrt(_)),i.rX=o,i.rY=l;var E=Math.pow(o,2)*Math.pow(B,2)+Math.pow(l,2)*Math.pow(m,2),G=(i.lArcFlag!==i.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(o,2)*Math.pow(l,2)-E)/E)),S=o*B/l*G,O=-l*m/o*G,P=kI([S,O],i.xRot/180*lc);i.cX=P[0]+(t+n)/2,i.cY=P[1]+(e+g)/2,i.phi1=Math.atan2((B-O)/l,(m-S)/o),i.phi2=Math.atan2((-B-O)/l,(-m-S)/o),i.sweepFlag===0&&i.phi2>i.phi1&&(i.phi2-=2*lc),i.sweepFlag===1&&i.phi2<i.phi1&&(i.phi2+=2*lc),i.phi1*=180/lc,i.phi2*=180/lc}function A_(i,t,e){uA(i,t,e);var o=i*i+t*t-e*e;if(0>o)return[];if(o===0)return[[i*e/(i*i+t*t),t*e/(i*i+t*t)]];var l=Math.sqrt(o);return[[(i*e+t*l)/(i*i+t*t),(t*e-i*l)/(i*i+t*t)],[(i*e-t*l)/(i*i+t*t),(t*e+i*l)/(i*i+t*t)]]}function l_(i,t,e){return(1-e)*i+e*t}function c_(i,t,e,o){return i+Math.cos(o/180*lc)*t+Math.sin(o/180*lc)*e}function u_(i,t,e,o){var l=1e-6,n=t-i,g=e-t,h=3*n+3*(o-e)-6*g,m=6*(g-n),B=3*n;return Math.abs(h)<l?[-B/m]:function(_,E,G){G===void 0&&(G=1e-6);var S=_*_/4-E;if(S<-G)return[];if(S<=G)return[-_/2];var O=Math.sqrt(S);return[-_/2-O,-_/2+O]}(m/h,B/h,l)}function h_(i,t,e,o,l){var n=1-l;return i*(n*n*n)+t*(3*n*n*l)+e*(3*n*l*l)+o*(l*l*l)}function Dp(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Dp=function(t){return typeof t}:Dp=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dp(i)}function V6(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function O6(i,t,e,o,l){if(typeof i=="string"&&(i=document.getElementById(i)),!i||Dp(i)!=="object"||!("getContext"in i))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var n=i.getContext("2d");try{return n.getImageData(t,e,o,l)}catch(g){throw new Error("unable to access image data: "+g)}}function W6(i,t,e,o,l,n){if(!(isNaN(n)||n<1)){n|=0;var g=O6(i,t,e,o,l);g=z6(g,t,e,o,l,n),i.getContext("2d").putImageData(g,t,e)}}function z6(i,t,e,o,l,n){for(var g=i.data,h=2*n+1,m=o-1,B=l-1,_=n+1,E=_*(_+1)/2,G=new f_,S=G,O,P=1;P<h;P++)S=S.next=new f_,P===_&&(O=S);S.next=G;for(var tt=null,z=null,rt=0,ct=0,Et=D6[n],Pt=K6[n],Qt=0;Qt<l;Qt++){S=G;for(var Ut=g[ct],dt=g[ct+1],ee=g[ct+2],oe=g[ct+3],ht=0;ht<_;ht++)S.r=Ut,S.g=dt,S.b=ee,S.a=oe,S=S.next;for(var At=0,Ft=0,St=0,ue=0,ce=_*Ut,ae=_*dt,se=_*ee,Lt=_*oe,Ht=E*Ut,fe=E*dt,j=E*ee,It=E*oe,bt=1;bt<_;bt++){var Vt=ct+((m<bt?m:bt)<<2),Xt=g[Vt],he=g[Vt+1],me=g[Vt+2],be=g[Vt+3],Ve=_-bt;Ht+=(S.r=Xt)*Ve,fe+=(S.g=he)*Ve,j+=(S.b=me)*Ve,It+=(S.a=be)*Ve,At+=Xt,Ft+=he,St+=me,ue+=be,S=S.next}tt=G,z=O;for(var De=0;De<o;De++){var ei=It*Et>>Pt;if(g[ct+3]=ei,ei!==0){var ri=255/ei;g[ct]=(Ht*Et>>Pt)*ri,g[ct+1]=(fe*Et>>Pt)*ri,g[ct+2]=(j*Et>>Pt)*ri}else g[ct]=g[ct+1]=g[ct+2]=0;Ht-=ce,fe-=ae,j-=se,It-=Lt,ce-=tt.r,ae-=tt.g,se-=tt.b,Lt-=tt.a;var Ii=De+n+1;Ii=rt+(Ii<m?Ii:m)<<2,At+=tt.r=g[Ii],Ft+=tt.g=g[Ii+1],St+=tt.b=g[Ii+2],ue+=tt.a=g[Ii+3],Ht+=At,fe+=Ft,j+=St,It+=ue,tt=tt.next;var Be=z,Rt=Be.r,Ui=Be.g,$t=Be.b,Ze=Be.a;ce+=Rt,ae+=Ui,se+=$t,Lt+=Ze,At-=Rt,Ft-=Ui,St-=$t,ue-=Ze,z=z.next,ct+=4}rt+=o}for(var We=0;We<o;We++){ct=We<<2;var He=g[ct],Re=g[ct+1],hi=g[ct+2],yi=g[ct+3],Qi=_*He,Pi=_*Re,zi=_*hi,ir=_*yi,Ei=E*He,Fe=E*Re,Ye=E*hi,Ki=E*yi;S=G;for(var ji=0;ji<_;ji++)S.r=He,S.g=Re,S.b=hi,S.a=yi,S=S.next;for(var vr=o,Qe=0,gi=0,Bi=0,Oi=0,Fr=1;Fr<=n;Fr++){ct=vr+We<<2;var pi=_-Fr;Ei+=(S.r=He=g[ct])*pi,Fe+=(S.g=Re=g[ct+1])*pi,Ye+=(S.b=hi=g[ct+2])*pi,Ki+=(S.a=yi=g[ct+3])*pi,Oi+=He,Qe+=Re,gi+=hi,Bi+=yi,S=S.next,Fr<B&&(vr+=o)}ct=We,tt=G,z=O;for(var Pr=0;Pr<l;Pr++){var gt=ct<<2;g[gt+3]=yi=Ki*Et>>Pt,yi>0?(yi=255/yi,g[gt]=(Ei*Et>>Pt)*yi,g[gt+1]=(Fe*Et>>Pt)*yi,g[gt+2]=(Ye*Et>>Pt)*yi):g[gt]=g[gt+1]=g[gt+2]=0,Ei-=Qi,Fe-=Pi,Ye-=zi,Ki-=ir,Qi-=tt.r,Pi-=tt.g,zi-=tt.b,ir-=tt.a,gt=We+((gt=Pr+_)<B?gt:B)*o<<2,Ei+=Oi+=tt.r=g[gt],Fe+=Qe+=tt.g=g[gt+1],Ye+=gi+=tt.b=g[gt+2],Ki+=Bi+=tt.a=g[gt+3],tt=tt.next,Qi+=He=z.r,Pi+=Re=z.g,zi+=hi=z.b,ir+=yi=z.a,Oi-=He,Qe-=Re,gi-=hi,Bi-=yi,z=z.next,ct+=o}}return i}function J6(){var{DOMParser:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:i,createCanvas(e,o){return new OffscreenCanvas(e,o)},createImage(e){return bl(function*(){var o=yield fetch(e),l=yield o.blob(),n=yield createImageBitmap(l);return n})()}};return(typeof DOMParser<"u"||typeof i>"u")&&Reflect.deleteProperty(t,"DOMParser"),t}function X6(i){var{DOMParser:t,canvas:e,fetch:o}=i;return{window:null,ignoreAnimation:!0,ignoreMouse:!0,DOMParser:t,fetch:o,createCanvas:e.createCanvas,createImage:e.loadImage}}function Au(i){return i.replace(/(?!\u3000)\s+/gm," ")}function o5(i){return i.replace(/^[\n \t]+/,"")}function a5(i){return i.replace(/[\n \t]+$/,"")}function Jo(i){var t=(i||"").match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm)||[];return t.map(parseFloat)}function A5(i){return j6.test(i)?i.toLowerCase():i}function By(i){var t=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(i)||[];return t[2]||t[3]||t[4]}function l5(i){if(!i.startsWith("rgb"))return i;var t=3,e=i.replace(/\d+(\.\d+)?/g,(o,l)=>t--&&l?String(Math.round(parseFloat(o))):o);return e}function Jc(i,t){var e=t.exec(i);return e?[i.replace(t," "),e.length]:[i,0]}function c5(i){var t=[0,0,0],e=i.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),o=0;return[e,o]=Jc(e,q6),t[1]+=o,[e,o]=Jc(e,$6),t[0]+=o,[e,o]=Jc(e,tD),t[1]+=o,[e,o]=Jc(e,eD),t[2]+=o,[e,o]=Jc(e,iD),t[1]+=o,[e,o]=Jc(e,rD),t[1]+=o,e=e.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[e,o]=Jc(e,nD),t[2]+=o,t.join("")}function LI(i){return Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2))}function Yp(i,t){return(i[0]*t[0]+i[1]*t[1])/(LI(i)*LI(t))}function EI(i,t){return(i[0]*t[1]<i[1]*t[0]?-1:1)*Math.acos(Yp(i,t))}function TI(i){return i*i*i}function QI(i){return 3*i*i*(1-i)}function UI(i){return 3*i*(1-i)*(1-i)}function GI(i){return(1-i)*(1-i)*(1-i)}function RI(i){return i*i}function ZI(i){return 2*i*(1-i)}function HI(i){return(1-i)*(1-i)}function aD(i){return Au(i).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function AD(i){var[t,e]=i.split("(");return[t.trim(),e.trim().replace(")","")]}function lD(i){var t=i.trim();return/^('|")/.test(t)?t:'"'.concat(t,'"')}function cD(i){return typeof process>"u"?i:i.trim().split(",").map(lD).join(",")}function uD(i){if(!i)return"";var t=i.trim().toLowerCase();switch(t){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return t;default:return/^oblique\s+(-|)\d+deg$/.test(t)?t:""}}function hD(i){if(!i)return"";var t=i.trim().toLowerCase();switch(t){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return t;default:return/^[\d.]+$/.test(t)?t:""}}function m_(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),e.push.apply(e,o)}return e}function Gp(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?m_(Object(e),!0).forEach(function(o){by(i,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):m_(Object(e)).forEach(function(o){Object.defineProperty(i,o,Object.getOwnPropertyDescriptor(e,o))})}return i}function Rp(i,t,e,o,l,n){return i[e*o*4+t*4+n]}function Zp(i,t,e,o,l,n,g){i[e*o*4+t*4+n]=g}function cs(i,t,e){var o=i[t];return o*e}function Il(i,t,e,o){return t+Math.cos(i)*e+Math.sin(i)*o}function I_(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),e.push.apply(e,o)}return e}function pD(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?I_(Object(e),!0).forEach(function(o){by(i,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):I_(Object(e)).forEach(function(o){Object.defineProperty(i,o,Object.getOwnPropertyDescriptor(e,o))})}return i}function fD(i,t){var e=document.createElement("canvas");return e.width=i,e.height=t,e}function mD(i){return PI.apply(this,arguments)}function PI(){return PI=bl(function*(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,e=document.createElement("img");return t&&(e.crossOrigin="Anonymous"),new Promise((o,l)=>{e.onload=()=>{o(e)},e.onerror=(n,g,h,m,B)=>{l(B)},e.src=i})}),PI.apply(this,arguments)}function y_(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);t&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable})),e.push.apply(e,o)}return e}function Xc(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?y_(Object(e),!0).forEach(function(o){by(i,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):y_(Object(e)).forEach(function(o){Object.defineProperty(i,o,Object.getOwnPropertyDescriptor(e,o))})}return i}var uO,xg,bp,ws,nh,$n,wQ,VA,BQ,Gf,_Q,vp,zs,v_,w_,B_,xQ,Rf,__,x_,eI,SQ,ts,S_,FQ,kQ,nu,LQ,EQ,TQ,A0,QQ,F_,su,UQ,GQ,DA,RQ,ZQ,Pg,iI,HQ,k_,L_,NQ,Nn,dw,E_,PQ,vl,l0,MQ,VQ,ou,DQ,Zf,Hf,T_,c0,pw,fw,mw,Cw,hA,Kp,MI,Iw,KQ,OQ,WQ,Q_,zQ,U_,JQ,XQ,YQ,jQ,qQ,G_,$Q,Nf,tU,eU,iU,wl,rU,nU,sh,u0,h0,g0,sU,oU,R_,yw,aU,VI,AU,lU,bw,cU,DI,vw,KI,uU,hU,Pf,gU,dU,pU,pA,fU,mU,CU,IU,Z_,yU,bU,ww,vU,wU,BU,Ju,d0,_U,Ts,xU,Bw,_w,SU,FU,kU,LU,EU,TU,QU,UU,OI,GU,xw,rI,RU,Mf,ZU,HU,NU,H_,PU,MU,VU,DU,KU,OU,WU,zU,Sw,KA,JU,XU,N_,YU,jU,qU,oo,$U,tG,eG,wp,Fw,iG,p0,rG,f0,m0,C0,nG,sG,oG,Mg,P_,nI,aG,M_,AG,WI,lG,cG,Vf,uG,hG,sI,gG,zI,dG,pG,kw,fG,mG,CG,Lw,JI,XI,IG,V_,yG,bG,I0,y0,vG,wG,Ew,oI,BG,Op,kg,Wp,_G,xG,lA,Wc,Df,YI,SG,FG,Bp,aI,kG,LG,D_,EG,TG,Tw,Hp,QG,UG,GG,RG,ZG,HG,K_,NG,PG,MG,VG,au,O_,DG,KG,OG,WG,Kf,zG,JG,XG,W_,YG,jG,oh,qG,Of,$G,tR,eR,Qw,z_,iR,b0,rR,nR,sR,Uw,J_,jI,oR,aR,AR,X_,lR,cR,uR,hR,gR,dR,pR,Gw,fR,mR,CR,IR,yR,bR,vR,Vg,wR,BR,_R,xR,Y_,v0,SR,FR,kR,LR,ER,TR,Lo,QR,Dg,UR,GR,RR,ZR,HR,NR,PR,MR,VR,DR,j_,KR,OR,WR,Rw,qI,Zw,zR,JR,XR,YR,jR,qR,Hw,$R,tZ,eZ,iZ,rZ,nZ,q_,sZ,oZ,aZ,Np,AZ,lZ,cZ,uZ,hZ,$I,gZ,dZ,$_,pZ,fZ,mZ,tx,CZ,ex,ty,IZ,yZ,mg,ix,bZ,vZ,wZ,BZ,_Z,Nw,xZ,SZ,FZ,kZ,rx,LZ,nx,Pw,Mw,ey,EZ,TZ,Kg,Vw,QZ,UZ,GZ,iy,RZ,sx,ZZ,HZ,NZ,PZ,MZ,ox,ma,VZ,DZ,Dw,KZ,ax,Kw,OZ,Ow,WZ,zZ,JZ,AI,lI,XZ,w0,YZ,Ww,jZ,B0,Sg,zw,Lg,zc,_0,x0,ry,S0,Jw,Xw,Ax,lx,cx,qZ,$Z,tH,eH,qc,Yw,iH,F0,rH,nH,sH,oH,k0,jw,qw,$w,_p,tB,cI,Vu,L0,E0,xp,eB,Cg,Ig,aH,AH,ny,lH,Wf,ux,cH,uH,hH,gH,Fg,dH,pH,fH,mH,CH,IH,T0,yH,uI,hx,bH,Og,ah,iB,vH,wH,BH,zp,uc,th,rB,nB,_H,xH,SH,Pp,FH,kH,LH,gx,sy,EH,TH,QH,dx,Jp,oy,px,zf,fx,UH,GH,Q0,RH,zu,Yc,Sp,mx,hI,ay,gI,ZH,HH,Cx,NH,sB,Ix,PH,Ay,yx,Fp,oB,MH,aB,bx,vx,wx,Bx,VH,AB,DH,Xu,ju,dI,Wg,KH,OH,WH,zH,JH,XH,lB,YH,jH,qH,$H,_x,tN,eN,iN,rN,nN,sN,oN,aN,cB,AN,lN,cN,uN,hN,gN,dN,pN,uB,fN,mN,hB,CN,Mp,gB,xx,IN,Sx,Fx,dB,U0,yN,bN,vN,wN,kx,BN,_N,xN,SN,FN,kN,LN,EN,TN,pI,QN,UN,GN,pB,G0,RN,ZN,HN,NN,PN,MN,VN,DN,KN,ON,WN,zN,JN,XN,YN,jN,qN,$N,tP,eP,iP,OA,rP,Lx,ly,nP,cy,uy,sP,oP,Ex,Tx,aP,AP,lP,cP,uP,hP,gP,dP,pP,fP,mP,mB,CP,IP,yP,bP,CB,IB,fI,mI,Qx,R0,Ux,yB,vP,kp,Vp,hy,wP,BP,_P,xP,SP,FP,kP,LP,Yu,Jf,EP,TP,QP,UP,GP,RP,ZP,HP,NP,Xp,CI,PP,MP,VP,Z0,II,Gx,yI,DP,Xf,KP,bB,vB,wB,OP,BB,Rx,WP,zP,H0,gy,dy,JP,XP,YP,jP,_B,qP,xB,$P,tM,py,SB,eM,iM,rM,nM,sM,fy,oM,aM,AM,lM,cM,N0,uM,hM,gM,FB,my,dM,pM,P0,fM,M0,mM,CM,IM,yM,kB,Yf,bM,vM,wM,BM,_M,xM,SM,Du,FM,kM,LM,EM,TM,QM,bI,UM,GM,RM,V0,LB,EB,ZM,HM,TB,NM,PM,MM,VM,DM,Zx,KM,OM,Cy,WM,zM,Iy,JM,Hx,XM,YM,QB,jM,qM,$M,UB,tV,eV,Nx,iV,rV,nV,sV,vI,wI,oV,aV,AV,lV,cV,uV,hV,gV,GB,BI,dV,Px,pV,fV,mV,RB,CV,IV,_I,Mx,$c,D0,K0,yV,Vx,bV,vV,wV,BV,_V,xV,SV,FV,kV,Dx,LV,EV,ZB,HB,TV,QV,O0,UV,GV,Kx,RV,ZV,NB,Lp,yg,PB,bg,MB,HV,NV,PV,MV,yy,VB,Ox,VV,DV,Ep,KV,Wx,OV,WV,zV,DB,JV,XV,W0,KB,YV,OB,zx,jV,Bg,z0,Jx,J0,WB,X0,Xx,Tp,t9,e9,i9,r9,n9,zB,s9,o9,Yx,a9,A9,l9,JB,c9,u9,h9,g9,jx,d9,p9,XB,f9,m9,C9,YB,I9,y9,qx,b9,v9,w9,B9,_9,jB,x9,S9,F9,k9,L9,E9,vg,vy,T9,Q9,U9,G9,qB,R9,Z9,H9,Y0,N9,$B,t_,P9,M9,V9,Ku,e_,D9,$x,K9,Ou,wg,O9,jf,_g,W9,z9,yl,Qp,qu,eh,Eg,Wu,Up,j0,Ac,i_,J9,q0,t5,X9,Y9,j9,xI,r_,q9,$9,$0,t6,e6,i6,n_,s_,r6,n6,s6,o6,a6,SI,A6,l6,c6,u6,FI,e5,h6,g6,d6,p6,f6,o_,m6,C6,I6,y6,b6,v6,w6,B6,a_,i5,lc,us,Cl,cA,n5,x6,g_,S6,Xe,F6,k6,L6,E6,T6,d_,Q6,U6,G6,R6,p_,Z6,H6,wy,N6,s5,P6,M6,D6,K6,f_,Y6,j6,q6,$6,tD,eD,iD,rD,nD,jc,Di,jp,xn,qp,u5,h5,tu,sD,oD,$u,$p,tf,ef,Tg,Qg,rf,nf,PA,an,sf,Es,Xo,ur,MA,Dr,Ug,dA,eu,NI,hc,Gg,of,af,Af,Rg,lf,cf,uf,hf,ih,Zg,gf,df,pf,rh,ff,mf,Cf,If,yf,bf,vf,wf,gD,Bf,_f,xf,Hg,Sf,Ng,iu,C_,Ff,ru,kf,Lf,Ef,Tf,Qf,Uf,dD,gA,cc,d5=vd(()=>{_y();uO=Su(Dh(),1),xg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};bp=function(i){return i&&i.Math==Math&&i},ws=bp(typeof globalThis=="object"&&globalThis)||bp(typeof window=="object"&&window)||bp(typeof self=="object"&&self)||bp(typeof xg=="object"&&xg)||function(){return this}()||xg||Function("return this")(),nh={},$n=function(i){try{return!!i()}catch{return!0}},wQ=$n,VA=!wQ(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),BQ=$n,Gf=!BQ(function(){var i=function(){}.bind();return typeof i!="function"||i.hasOwnProperty("prototype")}),_Q=Gf,vp=Function.prototype.call,zs=_Q?vp.bind(vp):function(){return vp.apply(vp,arguments)},v_={},w_={}.propertyIsEnumerable,B_=Object.getOwnPropertyDescriptor,xQ=B_&&!w_.call({1:2},1);v_.f=xQ?function(i){var t=B_(this,i);return!!t&&t.enumerable}:w_;Rf=function(i,t){return{enumerable:!(i&1),configurable:!(i&2),writable:!(i&4),value:t}},__=Gf,x_=Function.prototype,eI=x_.call,SQ=__&&x_.bind.bind(eI,eI),ts=__?SQ:function(i){return function(){return eI.apply(i,arguments)}},S_=ts,FQ=S_({}.toString),kQ=S_("".slice),nu=function(i){return kQ(FQ(i),8,-1)},LQ=ts,EQ=$n,TQ=nu,A0=Object,QQ=LQ("".split),F_=EQ(function(){return!A0("z").propertyIsEnumerable(0)})?function(i){return TQ(i)=="String"?QQ(i,""):A0(i)}:A0,su=function(i){return i==null},UQ=su,GQ=TypeError,DA=function(i){if(UQ(i))throw GQ("Can't call method on "+i);return i},RQ=F_,ZQ=DA,Pg=function(i){return RQ(ZQ(i))},iI=typeof document=="object"&&document.all,HQ=typeof iI>"u"&&iI!==void 0,k_={all:iI,IS_HTMLDDA:HQ},L_=k_,NQ=L_.all,Nn=L_.IS_HTMLDDA?function(i){return typeof i=="function"||i===NQ}:function(i){return typeof i=="function"},dw=Nn,E_=k_,PQ=E_.all,vl=E_.IS_HTMLDDA?function(i){return typeof i=="object"?i!==null:dw(i)||i===PQ}:function(i){return typeof i=="object"?i!==null:dw(i)},l0=ws,MQ=Nn,VQ=function(i){return MQ(i)?i:void 0},ou=function(i,t){return arguments.length<2?VQ(l0[i]):l0[i]&&l0[i][t]},DQ=ts,Zf=DQ({}.isPrototypeOf),Hf=typeof navigator<"u"&&String(navigator.userAgent)||"",T_=ws,c0=Hf,pw=T_.process,fw=T_.Deno,mw=pw&&pw.versions||fw&&fw.version,Cw=mw&&mw.v8;Cw&&(hA=Cw.split("."),Kp=hA[0]>0&&hA[0]<4?1:+(hA[0]+hA[1]));!Kp&&c0&&(hA=c0.match(/Edge\/(\d+)/),(!hA||hA[1]>=74)&&(hA=c0.match(/Chrome\/(\d+)/),hA&&(Kp=+hA[1])));MI=Kp,Iw=MI,KQ=$n,OQ=ws,WQ=OQ.String,Q_=!!Object.getOwnPropertySymbols&&!KQ(function(){var i=Symbol();return!WQ(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&Iw&&Iw<41}),zQ=Q_,U_=zQ&&!Symbol.sham&&typeof Symbol.iterator=="symbol",JQ=ou,XQ=Nn,YQ=Zf,jQ=U_,qQ=Object,G_=jQ?function(i){return typeof i=="symbol"}:function(i){var t=JQ("Symbol");return XQ(t)&&YQ(t.prototype,qQ(i))},$Q=String,Nf=function(i){try{return $Q(i)}catch{return"Object"}},tU=Nn,eU=Nf,iU=TypeError,wl=function(i){if(tU(i))return i;throw iU(eU(i)+" is not a function")},rU=wl,nU=su,sh=function(i,t){var e=i[t];return nU(e)?void 0:rU(e)},u0=zs,h0=Nn,g0=vl,sU=TypeError,oU=function(i,t){var e,o;if(t==="string"&&h0(e=i.toString)&&!g0(o=u0(e,i))||h0(e=i.valueOf)&&!g0(o=u0(e,i))||t!=="string"&&h0(e=i.toString)&&!g0(o=u0(e,i)))return o;throw sU("Can't convert object to primitive value")},R_={exports:{}},yw=ws,aU=Object.defineProperty,VI=function(i,t){try{aU(yw,i,{value:t,configurable:!0,writable:!0})}catch{yw[i]=t}return t},AU=ws,lU=VI,bw="__core-js_shared__",cU=AU[bw]||lU(bw,{}),DI=cU,vw=DI;(R_.exports=function(i,t){return vw[i]||(vw[i]=t!==void 0?t:{})})("versions",[]).push({version:"3.30.2",mode:"global",copyright:"\xA9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.2/LICENSE",source:"https://github.com/zloirock/core-js"});KI=R_.exports,uU=DA,hU=Object,Pf=function(i){return hU(uU(i))},gU=ts,dU=Pf,pU=gU({}.hasOwnProperty),pA=Object.hasOwn||function(i,t){return pU(dU(i),t)},fU=ts,mU=0,CU=Math.random(),IU=fU(1 .toString),Z_=function(i){return"Symbol("+(i===void 0?"":i)+")_"+IU(++mU+CU,36)},yU=ws,bU=KI,ww=pA,vU=Z_,wU=Q_,BU=U_,Ju=yU.Symbol,d0=bU("wks"),_U=BU?Ju.for||Ju:Ju&&Ju.withoutSetter||vU,Ts=function(i){return ww(d0,i)||(d0[i]=wU&&ww(Ju,i)?Ju[i]:_U("Symbol."+i)),d0[i]},xU=zs,Bw=vl,_w=G_,SU=sh,FU=oU,kU=Ts,LU=TypeError,EU=kU("toPrimitive"),TU=function(i,t){if(!Bw(i)||_w(i))return i;var e=SU(i,EU),o;if(e){if(t===void 0&&(t="default"),o=xU(e,i,t),!Bw(o)||_w(o))return o;throw LU("Can't convert object to primitive value")}return t===void 0&&(t="number"),FU(i,t)},QU=TU,UU=G_,OI=function(i){var t=QU(i,"string");return UU(t)?t:t+""},GU=ws,xw=vl,rI=GU.document,RU=xw(rI)&&xw(rI.createElement),Mf=function(i){return RU?rI.createElement(i):{}},ZU=VA,HU=$n,NU=Mf,H_=!ZU&&!HU(function(){return Object.defineProperty(NU("div"),"a",{get:function(){return 7}}).a!=7}),PU=VA,MU=zs,VU=v_,DU=Rf,KU=Pg,OU=OI,WU=pA,zU=H_,Sw=Object.getOwnPropertyDescriptor;nh.f=PU?Sw:function(i,t){if(i=KU(i),t=OU(t),zU)try{return Sw(i,t)}catch{}if(WU(i,t))return DU(!MU(VU.f,i,t),i[t])};KA={},JU=VA,XU=$n,N_=JU&&XU(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),YU=vl,jU=String,qU=TypeError,oo=function(i){if(YU(i))return i;throw qU(jU(i)+" is not an object")},$U=VA,tG=H_,eG=N_,wp=oo,Fw=OI,iG=TypeError,p0=Object.defineProperty,rG=Object.getOwnPropertyDescriptor,f0="enumerable",m0="configurable",C0="writable";KA.f=$U?eG?function(i,t,e){if(wp(i),t=Fw(t),wp(e),typeof i=="function"&&t==="prototype"&&"value"in e&&C0 in e&&!e[C0]){var o=rG(i,t);o&&o[C0]&&(i[t]=e.value,e={configurable:m0 in e?e[m0]:o[m0],enumerable:f0 in e?e[f0]:o[f0],writable:!1})}return p0(i,t,e)}:p0:function(i,t,e){if(wp(i),t=Fw(t),wp(e),tG)try{return p0(i,t,e)}catch{}if("get"in e||"set"in e)throw iG("Accessors not supported");return"value"in e&&(i[t]=e.value),i};nG=VA,sG=KA,oG=Rf,Mg=nG?function(i,t,e){return sG.f(i,t,oG(1,e))}:function(i,t,e){return i[t]=e,i},P_={exports:{}},nI=VA,aG=pA,M_=Function.prototype,AG=nI&&Object.getOwnPropertyDescriptor,WI=aG(M_,"name"),lG=WI&&function(){}.name==="something",cG=WI&&(!nI||nI&&AG(M_,"name").configurable),Vf={EXISTS:WI,PROPER:lG,CONFIGURABLE:cG},uG=ts,hG=Nn,sI=DI,gG=uG(Function.toString);hG(sI.inspectSource)||(sI.inspectSource=function(i){return gG(i)});zI=sI.inspectSource,dG=ws,pG=Nn,kw=dG.WeakMap,fG=pG(kw)&&/native code/.test(String(kw)),mG=KI,CG=Z_,Lw=mG("keys"),JI=function(i){return Lw[i]||(Lw[i]=CG(i))},XI={},IG=fG,V_=ws,yG=vl,bG=Mg,I0=pA,y0=DI,vG=JI,wG=XI,Ew="Object already initialized",oI=V_.TypeError,BG=V_.WeakMap,_G=function(i){return Wp(i)?kg(i):Op(i,{})},xG=function(i){return function(t){var e;if(!yG(t)||(e=kg(t)).type!==i)throw oI("Incompatible receiver, "+i+" required");return e}};IG||y0.state?(lA=y0.state||(y0.state=new BG),lA.get=lA.get,lA.has=lA.has,lA.set=lA.set,Op=function(i,t){if(lA.has(i))throw oI(Ew);return t.facade=i,lA.set(i,t),t},kg=function(i){return lA.get(i)||{}},Wp=function(i){return lA.has(i)}):(Wc=vG("state"),wG[Wc]=!0,Op=function(i,t){if(I0(i,Wc))throw oI(Ew);return t.facade=i,bG(i,Wc,t),t},kg=function(i){return I0(i,Wc)?i[Wc]:{}},Wp=function(i){return I0(i,Wc)});Df={set:Op,get:kg,has:Wp,enforce:_G,getterFor:xG},YI=ts,SG=$n,FG=Nn,Bp=pA,aI=VA,kG=Vf.CONFIGURABLE,LG=zI,D_=Df,EG=D_.enforce,TG=D_.get,Tw=String,Hp=Object.defineProperty,QG=YI("".slice),UG=YI("".replace),GG=YI([].join),RG=aI&&!SG(function(){return Hp(function(){},"length",{value:8}).length!==8}),ZG=String(String).split("String"),HG=P_.exports=function(i,t,e){QG(Tw(t),0,7)==="Symbol("&&(t="["+UG(Tw(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),e&&e.getter&&(t="get "+t),e&&e.setter&&(t="set "+t),(!Bp(i,"name")||kG&&i.name!==t)&&(aI?Hp(i,"name",{value:t,configurable:!0}):i.name=t),RG&&e&&Bp(e,"arity")&&i.length!==e.arity&&Hp(i,"length",{value:e.arity});try{e&&Bp(e,"constructor")&&e.constructor?aI&&Hp(i,"prototype",{writable:!1}):i.prototype&&(i.prototype=void 0)}catch{}var o=EG(i);return Bp(o,"source")||(o.source=GG(ZG,typeof t=="string"?t:"")),i};Function.prototype.toString=HG(function(){return FG(this)&&TG(this).source||LG(this)},"toString");K_=P_.exports,NG=Nn,PG=KA,MG=K_,VG=VI,au=function(i,t,e,o){o||(o={});var l=o.enumerable,n=o.name!==void 0?o.name:t;if(NG(e)&&MG(e,n,o),o.global)l?i[t]=e:VG(t,e);else{try{o.unsafe?i[t]&&(l=!0):delete i[t]}catch{}l?i[t]=e:PG.f(i,t,{value:e,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return i},O_={},DG=Math.ceil,KG=Math.floor,OG=Math.trunc||function(i){var t=+i;return(t>0?KG:DG)(t)},WG=OG,Kf=function(i){var t=+i;return t!==t||t===0?0:WG(t)},zG=Kf,JG=Math.max,XG=Math.min,W_=function(i,t){var e=zG(i);return e<0?JG(e+t,0):XG(e,t)},YG=Kf,jG=Math.min,oh=function(i){return i>0?jG(YG(i),9007199254740991):0},qG=oh,Of=function(i){return qG(i.length)},$G=Pg,tR=W_,eR=Of,Qw=function(i){return function(t,e,o){var l=$G(t),n=eR(l),g=tR(o,n),h;if(i&&e!=e){for(;n>g;)if(h=l[g++],h!=h)return!0}else for(;n>g;g++)if((i||g in l)&&l[g]===e)return i||g||0;return!i&&-1}},z_={includes:Qw(!0),indexOf:Qw(!1)},iR=ts,b0=pA,rR=Pg,nR=z_.indexOf,sR=XI,Uw=iR([].push),J_=function(i,t){var e=rR(i),o=0,l=[],n;for(n in e)!b0(sR,n)&&b0(e,n)&&Uw(l,n);for(;t.length>o;)b0(e,n=t[o++])&&(~nR(l,n)||Uw(l,n));return l},jI=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],oR=J_,aR=jI,AR=aR.concat("length","prototype");O_.f=Object.getOwnPropertyNames||function(i){return oR(i,AR)};X_={};X_.f=Object.getOwnPropertySymbols;lR=ou,cR=ts,uR=O_,hR=X_,gR=oo,dR=cR([].concat),pR=lR("Reflect","ownKeys")||function(i){var t=uR.f(gR(i)),e=hR.f;return e?dR(t,e(i)):t},Gw=pA,fR=pR,mR=nh,CR=KA,IR=function(i,t,e){for(var o=fR(t),l=CR.f,n=mR.f,g=0;g<o.length;g++){var h=o[g];!Gw(i,h)&&!(e&&Gw(e,h))&&l(i,h,n(t,h))}},yR=$n,bR=Nn,vR=/#|\.prototype\./,Vg=function(i,t){var e=BR[wR(i)];return e==xR?!0:e==_R?!1:bR(t)?yR(t):!!t},wR=Vg.normalize=function(i){return String(i).replace(vR,".").toLowerCase()},BR=Vg.data={},_R=Vg.NATIVE="N",xR=Vg.POLYFILL="P",Y_=Vg,v0=ws,SR=nh.f,FR=Mg,kR=au,LR=VI,ER=IR,TR=Y_,Lo=function(i,t){var e=i.target,o=i.global,l=i.stat,n,g,h,m,B,_;if(o?g=v0:l?g=v0[e]||LR(e,{}):g=(v0[e]||{}).prototype,g)for(h in t){if(B=t[h],i.dontCallGetSet?(_=SR(g,h),m=_&&_.value):m=g[h],n=TR(o?h:e+(l?".":"#")+h,i.forced),!n&&m!==void 0){if(typeof B==typeof m)continue;ER(B,m)}(i.sham||m&&m.sham)&&FR(B,"sham",!0),kR(g,h,B,i)}},QR=nu,Dg=typeof process<"u"&&QR(process)=="process",UR=ts,GR=wl,RR=function(i,t,e){try{return UR(GR(Object.getOwnPropertyDescriptor(i,t)[e]))}catch{}},ZR=Nn,HR=String,NR=TypeError,PR=function(i){if(typeof i=="object"||ZR(i))return i;throw NR("Can't set "+HR(i)+" as a prototype")},MR=RR,VR=oo,DR=PR,j_=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,t={},e;try{e=MR(Object.prototype,"__proto__","set"),e(t,[]),i=t instanceof Array}catch{}return function(o,l){return VR(o),DR(l),i?e(o,l):o.__proto__=l,o}}():void 0),KR=KA.f,OR=pA,WR=Ts,Rw=WR("toStringTag"),qI=function(i,t,e){i&&!e&&(i=i.prototype),i&&!OR(i,Rw)&&KR(i,Rw,{configurable:!0,value:t})},Zw=K_,zR=KA,JR=function(i,t,e){return e.get&&Zw(e.get,t,{getter:!0}),e.set&&Zw(e.set,t,{setter:!0}),zR.f(i,t,e)},XR=ou,YR=JR,jR=Ts,qR=VA,Hw=jR("species"),$R=function(i){var t=XR(i);qR&&t&&!t[Hw]&&YR(t,Hw,{configurable:!0,get:function(){return this}})},tZ=Zf,eZ=TypeError,iZ=function(i,t){if(tZ(t,i))return i;throw eZ("Incorrect invocation")},rZ=Ts,nZ=rZ("toStringTag"),q_={};q_[nZ]="z";sZ=String(q_)==="[object z]",oZ=sZ,aZ=Nn,Np=nu,AZ=Ts,lZ=AZ("toStringTag"),cZ=Object,uZ=Np(function(){return arguments}())=="Arguments",hZ=function(i,t){try{return i[t]}catch{}},$I=oZ?Np:function(i){var t,e,o;return i===void 0?"Undefined":i===null?"Null":typeof(e=hZ(t=cZ(i),lZ))=="string"?e:uZ?Np(t):(o=Np(t))=="Object"&&aZ(t.callee)?"Arguments":o},gZ=ts,dZ=$n,$_=Nn,pZ=$I,fZ=ou,mZ=zI,tx=function(){},CZ=[],ex=fZ("Reflect","construct"),ty=/^\s*(?:class|function)\b/,IZ=gZ(ty.exec),yZ=!ty.exec(tx),mg=function(i){if(!$_(i))return!1;try{return ex(tx,CZ,i),!0}catch{return!1}},ix=function(i){if(!$_(i))return!1;switch(pZ(i)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return yZ||!!IZ(ty,mZ(i))}catch{return!0}};ix.sham=!0;bZ=!ex||dZ(function(){var i;return mg(mg.call)||!mg(Object)||!mg(function(){i=!0})||i})?ix:mg,vZ=bZ,wZ=Nf,BZ=TypeError,_Z=function(i){if(vZ(i))return i;throw BZ(wZ(i)+" is not a constructor")},Nw=oo,xZ=_Z,SZ=su,FZ=Ts,kZ=FZ("species"),rx=function(i,t){var e=Nw(i).constructor,o;return e===void 0||SZ(o=Nw(e)[kZ])?t:xZ(o)},LZ=Gf,nx=Function.prototype,Pw=nx.apply,Mw=nx.call,ey=typeof Reflect=="object"&&Reflect.apply||(LZ?Mw.bind(Pw):function(){return Mw.apply(Pw,arguments)}),EZ=nu,TZ=ts,Kg=function(i){if(EZ(i)==="Function")return TZ(i)},Vw=Kg,QZ=wl,UZ=Gf,GZ=Vw(Vw.bind),iy=function(i,t){return QZ(i),t===void 0?i:UZ?GZ(i,t):function(){return i.apply(t,arguments)}},RZ=ou,sx=RZ("document","documentElement"),ZZ=ts,HZ=ZZ([].slice),NZ=TypeError,PZ=function(i,t){if(i<t)throw NZ("Not enough arguments");return i},MZ=Hf,ox=/(?:ipad|iphone|ipod).*applewebkit/i.test(MZ),ma=ws,VZ=ey,DZ=iy,Dw=Nn,KZ=pA,ax=$n,Kw=sx,OZ=HZ,Ow=Mf,WZ=PZ,zZ=ox,JZ=Dg,AI=ma.setImmediate,lI=ma.clearImmediate,XZ=ma.process,w0=ma.Dispatch,YZ=ma.Function,Ww=ma.MessageChannel,jZ=ma.String,B0=0,Sg={},zw="onreadystatechange";ax(function(){Lg=ma.location});ry=function(i){if(KZ(Sg,i)){var t=Sg[i];delete Sg[i],t()}},S0=function(i){return function(){ry(i)}},Jw=function(i){ry(i.data)},Xw=function(i){ma.postMessage(jZ(i),Lg.protocol+"//"+Lg.host)};(!AI||!lI)&&(AI=function(i){WZ(arguments.length,1);var t=Dw(i)?i:YZ(i),e=OZ(arguments,1);return Sg[++B0]=function(){VZ(t,void 0,e)},zc(B0),B0},lI=function(i){delete Sg[i]},JZ?zc=function(i){XZ.nextTick(S0(i))}:w0&&w0.now?zc=function(i){w0.now(S0(i))}:Ww&&!zZ?(_0=new Ww,x0=_0.port2,_0.port1.onmessage=Jw,zc=DZ(x0.postMessage,x0)):ma.addEventListener&&Dw(ma.postMessage)&&!ma.importScripts&&Lg&&Lg.protocol!=="file:"&&!ax(Xw)?(zc=Xw,ma.addEventListener("message",Jw,!1)):zw in Ow("script")?zc=function(i){Kw.appendChild(Ow("script"))[zw]=function(){Kw.removeChild(this),ry(i)}}:zc=function(i){setTimeout(S0(i),0)});Ax={set:AI,clear:lI},lx=function(){this.head=null,this.tail=null};lx.prototype={add:function(i){var t={item:i,next:null},e=this.tail;e?e.next=t:this.head=t,this.tail=t},get:function(){var i=this.head;if(i){var t=this.head=i.next;return t===null&&(this.tail=null),i.item}}};cx=lx,qZ=Hf,$Z=/ipad|iphone|ipod/i.test(qZ)&&typeof Pebble<"u",tH=Hf,eH=/web0s(?!.*chrome)/i.test(tH),qc=ws,Yw=iy,iH=nh.f,F0=Ax.set,rH=cx,nH=ox,sH=$Z,oH=eH,k0=Dg,jw=qc.MutationObserver||qc.WebKitMutationObserver,qw=qc.document,$w=qc.process,_p=qc.Promise,tB=iH(qc,"queueMicrotask"),cI=tB&&tB.value;cI||(Cg=new rH,Ig=function(){var i,t;for(k0&&(i=$w.domain)&&i.exit();t=Cg.get();)try{t()}catch(e){throw Cg.head&&Vu(),e}i&&i.enter()},!nH&&!k0&&!oH&&jw&&qw?(L0=!0,E0=qw.createTextNode(""),new jw(Ig).observe(E0,{characterData:!0}),Vu=function(){E0.data=L0=!L0}):!sH&&_p&&_p.resolve?(xp=_p.resolve(void 0),xp.constructor=_p,eB=Yw(xp.then,xp),Vu=function(){eB(Ig)}):k0?Vu=function(){$w.nextTick(Ig)}:(F0=Yw(F0,qc),Vu=function(){F0(Ig)}),cI=function(i){Cg.head||Vu(),Cg.add(i)});aH=cI,AH=function(i,t){try{arguments.length==1?console.error(i):console.error(i,t)}catch{}},ny=function(i){try{return{error:!1,value:i()}}catch(t){return{error:!0,value:t}}},lH=ws,Wf=lH.Promise,ux=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",cH=ux,uH=Dg,hH=!cH&&!uH&&typeof window=="object"&&typeof document=="object",gH=ws,Fg=Wf,dH=Nn,pH=Y_,fH=zI,mH=Ts,CH=hH,IH=ux,T0=MI;Fg&&Fg.prototype;yH=mH("species"),uI=!1,hx=dH(gH.PromiseRejectionEvent),bH=pH("Promise",function(){var i=fH(Fg),t=i!==String(Fg);if(!t&&T0===66)return!0;if(!T0||T0<51||!/native code/.test(i)){var e=new Fg(function(n){n(1)}),o=function(n){n(function(){},function(){})},l=e.constructor={};if(l[yH]=o,uI=e.then(function(){})instanceof o,!uI)return!0}return!t&&(CH||IH)&&!hx}),Og={CONSTRUCTOR:bH,REJECTION_EVENT:hx,SUBCLASSING:uI},ah={},iB=wl,vH=TypeError,wH=function(i){var t,e;this.promise=new i(function(o,l){if(t!==void 0||e!==void 0)throw vH("Bad Promise constructor");t=o,e=l}),this.resolve=iB(t),this.reject=iB(e)};ah.f=function(i){return new wH(i)};BH=Lo,zp=Dg,uc=ws,th=zs,rB=au,nB=j_,_H=qI,xH=$R,SH=wl,Pp=Nn,FH=vl,kH=iZ,LH=rx,gx=Ax.set,sy=aH,EH=AH,TH=ny,QH=cx,dx=Df,Jp=Wf,oy=Og,px=ah,zf="Promise",fx=oy.CONSTRUCTOR,UH=oy.REJECTION_EVENT,GH=oy.SUBCLASSING,Q0=dx.getterFor(zf),RH=dx.set,zu=Jp&&Jp.prototype,Yc=Jp,Sp=zu,mx=uc.TypeError,hI=uc.document,ay=uc.process,gI=px.f,ZH=gI,HH=!!(hI&&hI.createEvent&&uc.dispatchEvent),Cx="unhandledrejection",NH="rejectionhandled",sB=0,Ix=1,PH=2,Ay=1,yx=2,bx=function(i){var t;return FH(i)&&Pp(t=i.then)?t:!1},vx=function(i,t){var e=t.value,o=t.state==Ix,l=o?i.ok:i.fail,n=i.resolve,g=i.reject,h=i.domain,m,B,_;try{l?(o||(t.rejection===yx&&DH(t),t.rejection=Ay),l===!0?m=e:(h&&h.enter(),m=l(e),h&&(h.exit(),_=!0)),m===i.promise?g(mx("Promise-chain cycle")):(B=bx(m))?th(B,m,n,g):n(m)):g(e)}catch(E){h&&!_&&h.exit(),g(E)}},wx=function(i,t){i.notified||(i.notified=!0,sy(function(){for(var e=i.reactions,o;o=e.get();)vx(o,i);i.notified=!1,t&&!i.rejection&&VH(i)}))},Bx=function(i,t,e){var o,l;HH?(o=hI.createEvent("Event"),o.promise=t,o.reason=e,o.initEvent(i,!1,!0),uc.dispatchEvent(o)):o={promise:t,reason:e},!UH&&(l=uc["on"+i])?l(o):i===Cx&&EH("Unhandled promise rejection",e)},VH=function(i){th(gx,uc,function(){var t=i.facade,e=i.value,o=AB(i),l;if(o&&(l=TH(function(){zp?ay.emit("unhandledRejection",e,t):Bx(Cx,t,e)}),i.rejection=zp||AB(i)?yx:Ay,l.error))throw l.value})},AB=function(i){return i.rejection!==Ay&&!i.parent},DH=function(i){th(gx,uc,function(){var t=i.facade;zp?ay.emit("rejectionHandled",t):Bx(NH,t,i.value)})},Xu=function(i,t,e){return function(o){i(t,o,e)}},ju=function(i,t,e){i.done||(i.done=!0,e&&(i=e),i.value=t,i.state=PH,wx(i,!0))},dI=function(i,t,e){if(!i.done){i.done=!0,e&&(i=e);try{if(i.facade===t)throw mx("Promise can't be resolved itself");var o=bx(t);o?sy(function(){var l={done:!1};try{th(o,t,Xu(dI,l,i),Xu(ju,l,i))}catch(n){ju(l,n,i)}}):(i.value=t,i.state=Ix,wx(i,!1))}catch(l){ju({done:!1},l,i)}}};if(fx&&(Yc=function(i){kH(this,Sp),SH(i),th(Fp,this);var t=Q0(this);try{i(Xu(dI,t),Xu(ju,t))}catch(e){ju(t,e)}},Sp=Yc.prototype,Fp=function(i){RH(this,{type:zf,done:!1,notified:!1,parent:!1,reactions:new QH,rejection:!1,state:sB,value:void 0})},Fp.prototype=rB(Sp,"then",function(i,t){var e=Q0(this),o=gI(LH(this,Yc));return e.parent=!0,o.ok=Pp(i)?i:!0,o.fail=Pp(t)&&t,o.domain=zp?ay.domain:void 0,e.state==sB?e.reactions.add(o):sy(function(){vx(o,e)}),o.promise}),oB=function(){var i=new Fp,t=Q0(i);this.promise=i,this.resolve=Xu(dI,t),this.reject=Xu(ju,t)},px.f=gI=function(i){return i===Yc||i===MH?new oB(i):ZH(i)},Pp(Jp)&&zu!==Object.prototype)){aB=zu.then,GH||rB(zu,"then",function(i,t){var e=this;return new Yc(function(o,l){th(aB,e,o,l)}).then(i,t)},{unsafe:!0});try{delete zu.constructor}catch{}nB&&nB(zu,Sp)}BH({global:!0,constructor:!0,wrap:!0,forced:fx},{Promise:Yc});_H(Yc,zf,!1);xH(zf);Wg={},KH=Ts,OH=Wg,WH=KH("iterator"),zH=Array.prototype,JH=function(i){return i!==void 0&&(OH.Array===i||zH[WH]===i)},XH=$I,lB=sh,YH=su,jH=Wg,qH=Ts,$H=qH("iterator"),_x=function(i){if(!YH(i))return lB(i,$H)||lB(i,"@@iterator")||jH[XH(i)]},tN=zs,eN=wl,iN=oo,rN=Nf,nN=_x,sN=TypeError,oN=function(i,t){var e=arguments.length<2?nN(i):t;if(eN(e))return iN(tN(e,i));throw sN(rN(i)+" is not iterable")},aN=zs,cB=oo,AN=sh,lN=function(i,t,e){var o,l;cB(i);try{if(o=AN(i,"return"),!o){if(t==="throw")throw e;return e}o=aN(o,i)}catch(n){l=!0,o=n}if(t==="throw")throw e;if(l)throw o;return cB(o),e},cN=iy,uN=zs,hN=oo,gN=Nf,dN=JH,pN=Of,uB=Zf,fN=oN,mN=_x,hB=lN,CN=TypeError,Mp=function(i,t){this.stopped=i,this.result=t},gB=Mp.prototype,xx=function(i,t,e){var o=e&&e.that,l=!!(e&&e.AS_ENTRIES),n=!!(e&&e.IS_RECORD),g=!!(e&&e.IS_ITERATOR),h=!!(e&&e.INTERRUPTED),m=cN(t,o),B,_,E,G,S,O,P,tt=function(rt){return B&&hB(B,"normal",rt),new Mp(!0,rt)},z=function(rt){return l?(hN(rt),h?m(rt[0],rt[1],tt):m(rt[0],rt[1])):h?m(rt,tt):m(rt)};if(n)B=i.iterator;else if(g)B=i;else{if(_=mN(i),!_)throw CN(gN(i)+" is not iterable");if(dN(_)){for(E=0,G=pN(i);G>E;E++)if(S=z(i[E]),S&&uB(gB,S))return S;return new Mp(!1)}B=fN(i,_)}for(O=n?i.next:B.next;!(P=uN(O,B)).done;){try{S=z(P.value)}catch(rt){hB(B,"throw",rt)}if(typeof S=="object"&&S&&uB(gB,S))return S}return new Mp(!1)},IN=Ts,Sx=IN("iterator"),Fx=!1;try{dB=0,U0={next:function(){return{done:!!dB++}},return:function(){Fx=!0}},U0[Sx]=function(){return this},Array.from(U0,function(){throw 2})}catch{}yN=function(i,t){if(!t&&!Fx)return!1;var e=!1;try{var o={};o[Sx]=function(){return{next:function(){return{done:e=!0}}}},i(o)}catch{}return e},bN=Wf,vN=yN,wN=Og.CONSTRUCTOR,kx=wN||!vN(function(i){bN.all(i).then(void 0,function(){})}),BN=Lo,_N=zs,xN=wl,SN=ah,FN=ny,kN=xx,LN=kx;BN({target:"Promise",stat:!0,forced:LN},{all:function(i){var t=this,e=SN.f(t),o=e.resolve,l=e.reject,n=FN(function(){var g=xN(t.resolve),h=[],m=0,B=1;kN(i,function(_){var E=m++,G=!1;B++,_N(g,t,_).then(function(S){G||(G=!0,h[E]=S,--B||o(h))},l)}),--B||o(h)});return n.error&&l(n.value),e.promise}});EN=Lo,TN=Og.CONSTRUCTOR,pI=Wf,QN=ou,UN=Nn,GN=au,pB=pI&&pI.prototype;EN({target:"Promise",proto:!0,forced:TN,real:!0},{catch:function(i){return this.then(void 0,i)}});UN(pI)&&(G0=QN("Promise").prototype.catch,pB.catch!==G0&&GN(pB,"catch",G0,{unsafe:!0}));RN=Lo,ZN=zs,HN=wl,NN=ah,PN=ny,MN=xx,VN=kx;RN({target:"Promise",stat:!0,forced:VN},{race:function(i){var t=this,e=NN.f(t),o=e.reject,l=PN(function(){var n=HN(t.resolve);MN(i,function(g){ZN(n,t,g).then(e.resolve,o)})});return l.error&&o(l.value),e.promise}});DN=Lo,KN=zs,ON=ah,WN=Og.CONSTRUCTOR;DN({target:"Promise",stat:!0,forced:WN},{reject:function(i){var t=ON.f(this);return KN(t.reject,void 0,i),t.promise}});zN=oo,JN=vl,XN=ah,YN=function(i,t){if(zN(i),JN(t)&&t.constructor===i)return t;var e=XN.f(i),o=e.resolve;return o(t),e.promise},jN=Lo,qN=ou,$N=Og.CONSTRUCTOR,tP=YN;qN("Promise");jN({target:"Promise",stat:!0,forced:$N},{resolve:function(i){return tP(this,i)}});eP=$I,iP=String,OA=function(i){if(eP(i)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return iP(i)},rP=oo,Lx=function(){var i=rP(this),t="";return i.hasIndices&&(t+="d"),i.global&&(t+="g"),i.ignoreCase&&(t+="i"),i.multiline&&(t+="m"),i.dotAll&&(t+="s"),i.unicode&&(t+="u"),i.unicodeSets&&(t+="v"),i.sticky&&(t+="y"),t},ly=$n,nP=ws,cy=nP.RegExp,uy=ly(function(){var i=cy("a","y");return i.lastIndex=2,i.exec("abcd")!=null}),sP=uy||ly(function(){return!cy("a","y").sticky}),oP=uy||ly(function(){var i=cy("^r","gy");return i.lastIndex=2,i.exec("str")!=null}),Ex={BROKEN_CARET:oP,MISSED_STICKY:sP,UNSUPPORTED_Y:uy},Tx={},aP=J_,AP=jI,lP=Object.keys||function(i){return aP(i,AP)},cP=VA,uP=N_,hP=KA,gP=oo,dP=Pg,pP=lP;Tx.f=cP&&!uP?Object.defineProperties:function(i,t){gP(i);for(var e=dP(t),o=pP(t),l=o.length,n=0,g;l>n;)hP.f(i,g=o[n++],e[g]);return i};fP=oo,mP=Tx,mB=jI,CP=XI,IP=sx,yP=Mf,bP=JI,CB=">",IB="<",fI="prototype",mI="script",Qx=bP("IE_PROTO"),R0=function(){},Ux=function(i){return IB+mI+CB+i+IB+"/"+mI+CB},yB=function(i){i.write(Ux("")),i.close();var t=i.parentWindow.Object;return i=null,t},vP=function(){var i=yP("iframe"),t="java"+mI+":",e;return i.style.display="none",IP.appendChild(i),i.src=String(t),e=i.contentWindow.document,e.open(),e.write(Ux("document.F=Object")),e.close(),e.F},Vp=function(){try{kp=new ActiveXObject("htmlfile")}catch{}Vp=typeof document<"u"?document.domain&&kp?yB(kp):vP():yB(kp);for(var i=mB.length;i--;)delete Vp[fI][mB[i]];return Vp()};CP[Qx]=!0;hy=Object.create||function(i,t){var e;return i!==null?(R0[fI]=fP(i),e=new R0,R0[fI]=null,e[Qx]=i):e=Vp(),t===void 0?e:mP.f(e,t)},wP=$n,BP=ws,_P=BP.RegExp,xP=wP(function(){var i=_P(".","s");return!(i.dotAll&&i.exec(`
`)&&i.flags==="s")}),SP=$n,FP=ws,kP=FP.RegExp,LP=SP(function(){var i=kP("(?<a>b)","g");return i.exec("b").groups.a!=="b"||"b".replace(i,"$<a>c")!=="bc"}),Yu=zs,Jf=ts,EP=OA,TP=Lx,QP=Ex,UP=KI,GP=hy,RP=Df.get,ZP=xP,HP=LP,NP=UP("native-string-replace",String.prototype.replace),Xp=RegExp.prototype.exec,CI=Xp,PP=Jf("".charAt),MP=Jf("".indexOf),VP=Jf("".replace),Z0=Jf("".slice),II=function(){var i=/a/,t=/b*/g;return Yu(Xp,i,"a"),Yu(Xp,t,"a"),i.lastIndex!==0||t.lastIndex!==0}(),Gx=QP.BROKEN_CARET,yI=/()??/.exec("")[1]!==void 0,DP=II||yI||Gx||ZP||HP;DP&&(CI=function(i){var t=this,e=RP(t),o=EP(i),l=e.raw,n,g,h,m,B,_,E;if(l)return l.lastIndex=t.lastIndex,n=Yu(CI,l,o),t.lastIndex=l.lastIndex,n;var G=e.groups,S=Gx&&t.sticky,O=Yu(TP,t),P=t.source,tt=0,z=o;if(S&&(O=VP(O,"y",""),MP(O,"g")===-1&&(O+="g"),z=Z0(o,t.lastIndex),t.lastIndex>0&&(!t.multiline||t.multiline&&PP(o,t.lastIndex-1)!==`
`)&&(P="(?: "+P+")",z=" "+z,tt++),g=new RegExp("^(?:"+P+")",O)),yI&&(g=new RegExp("^"+P+"$(?!\\s)",O)),II&&(h=t.lastIndex),m=Yu(Xp,S?g:t,z),S?m?(m.input=Z0(m.input,tt),m[0]=Z0(m[0],tt),m.index=t.lastIndex,t.lastIndex+=m[0].length):t.lastIndex=0:II&&m&&(t.lastIndex=t.global?m.index+m[0].length:h),yI&&m&&m.length>1&&Yu(NP,m[0],g,function(){for(B=1;B<arguments.length-2;B++)arguments[B]===void 0&&(m[B]=void 0)}),m&&G)for(m.groups=_=GP(null),B=0;B<G.length;B++)E=G[B],_[E[0]]=m[E[1]];return m});Xf=CI,KP=Lo,bB=Xf;KP({target:"RegExp",proto:!0,forced:/./.exec!==bB},{exec:bB});vB=Kg,wB=au,OP=Xf,BB=$n,Rx=Ts,WP=Mg,zP=Rx("species"),H0=RegExp.prototype,gy=function(i,t,e,o){var l=Rx(i),n=!BB(function(){var B={};return B[l]=function(){return 7},""[i](B)!=7}),g=n&&!BB(function(){var B=!1,_=/a/;return i==="split"&&(_={},_.constructor={},_.constructor[zP]=function(){return _},_.flags="",_[l]=/./[l]),_.exec=function(){return B=!0,null},_[l](""),!B});if(!n||!g||e){var h=vB(/./[l]),m=t(l,""[i],function(B,_,E,G,S){var O=vB(B),P=_.exec;return P===OP||P===H0.exec?n&&!S?{done:!0,value:h(_,E,G)}:{done:!0,value:O(E,_,G)}:{done:!1}});wB(String.prototype,i,m[0]),wB(H0,l,m[1])}o&&WP(H0[l],"sham",!0)},dy=ts,JP=Kf,XP=OA,YP=DA,jP=dy("".charAt),_B=dy("".charCodeAt),qP=dy("".slice),xB=function(i){return function(t,e){var o=XP(YP(t)),l=JP(e),n=o.length,g,h;return l<0||l>=n?i?"":void 0:(g=_B(o,l),g<55296||g>56319||l+1===n||(h=_B(o,l+1))<56320||h>57343?i?jP(o,l):g:i?qP(o,l,l+2):(g-55296<<10)+(h-56320)+65536)}},$P={codeAt:xB(!1),charAt:xB(!0)},tM=$P.charAt,py=function(i,t,e){return t+(e?tM(i,t).length:1)},SB=zs,eM=oo,iM=Nn,rM=nu,nM=Xf,sM=TypeError,fy=function(i,t){var e=i.exec;if(iM(e)){var o=SB(e,i,t);return o!==null&&eM(o),o}if(rM(i)==="RegExp")return SB(nM,i,t);throw sM("RegExp#exec called on incompatible receiver")},oM=zs,aM=gy,AM=oo,lM=su,cM=oh,N0=OA,uM=DA,hM=sh,gM=py,FB=fy;aM("match",function(i,t,e){return[function(o){var l=uM(this),n=lM(o)?void 0:hM(o,i);return n?oM(n,o,l):new RegExp(o)[i](N0(l))},function(o){var l=AM(this),n=N0(o),g=e(t,l,n);if(g.done)return g.value;if(!l.global)return FB(l,n);var h=l.unicode;l.lastIndex=0;for(var m=[],B=0,_;(_=FB(l,n))!==null;){var E=N0(_[0]);m[B]=E,E===""&&(l.lastIndex=gM(n,cM(l.lastIndex),h)),B++}return B===0?null:m}]});my=ts,dM=Pf,pM=Math.floor,P0=my("".charAt),fM=my("".replace),M0=my("".slice),mM=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,CM=/\$([$&'`]|\d{1,2})/g,IM=function(i,t,e,o,l,n){var g=e+i.length,h=o.length,m=CM;return l!==void 0&&(l=dM(l),m=mM),fM(n,m,function(B,_){var E;switch(P0(_,0)){case"$":return"$";case"&":return i;case"`":return M0(t,0,e);case"'":return M0(t,g);case"<":E=l[M0(_,1,-1)];break;default:var G=+_;if(G===0)return B;if(G>h){var S=pM(G/10);return S===0?B:S<=h?o[S-1]===void 0?P0(_,1):o[S-1]+P0(_,1):B}E=o[G-1]}return E===void 0?"":E})},yM=ey,kB=zs,Yf=ts,bM=gy,vM=$n,wM=oo,BM=Nn,_M=su,xM=Kf,SM=oh,Du=OA,FM=DA,kM=py,LM=sh,EM=IM,TM=fy,QM=Ts,bI=QM("replace"),UM=Math.max,GM=Math.min,RM=Yf([].concat),V0=Yf([].push),LB=Yf("".indexOf),EB=Yf("".slice),ZM=function(i){return i===void 0?i:String(i)},HM=function(){return"a".replace(/./,"$0")==="$0"}(),TB=function(){return/./[bI]?/./[bI]("a","$0")==="":!1}(),NM=!vM(function(){var i=/./;return i.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(i,"$<a>")!=="7"});bM("replace",function(i,t,e){var o=TB?"$":"$0";return[function(l,n){var g=FM(this),h=_M(l)?void 0:LM(l,bI);return h?kB(h,l,g,n):kB(t,Du(g),l,n)},function(l,n){var g=wM(this),h=Du(l);if(typeof n=="string"&&LB(n,o)===-1&&LB(n,"$<")===-1){var m=e(t,g,h,n);if(m.done)return m.value}var B=BM(n);B||(n=Du(n));var _=g.global;if(_){var E=g.unicode;g.lastIndex=0}for(var G=[];;){var S=TM(g,h);if(S===null||(V0(G,S),!_))break;var O=Du(S[0]);O===""&&(g.lastIndex=kM(h,SM(g.lastIndex),E))}for(var P="",tt=0,z=0;z<G.length;z++){S=G[z];for(var rt=Du(S[0]),ct=UM(GM(xM(S.index),h.length),0),Et=[],Pt=1;Pt<S.length;Pt++)V0(Et,ZM(S[Pt]));var Qt=S.groups;if(B){var Ut=RM([rt],Et,ct,h);Qt!==void 0&&V0(Ut,Qt);var dt=Du(yM(n,void 0,Ut))}else dt=EM(rt,h,ct,Et,Qt,n);ct>=tt&&(P+=EB(h,tt,ct)+dt,tt=ct+rt.length)}return P+EB(h,tt)}]},!NM||!HM||TB);PM=vl,MM=nu,VM=Ts,DM=VM("match"),Zx=function(i){var t;return PM(i)&&((t=i[DM])!==void 0?!!t:MM(i)=="RegExp")},KM=Zx,OM=TypeError,Cy=function(i){if(KM(i))throw OM("The method doesn't accept regular expressions");return i},WM=Ts,zM=WM("match"),Iy=function(i){var t=/./;try{"/./"[i](t)}catch{try{return t[zM]=!1,"/./"[i](t)}catch{}}return!1},JM=Lo,Hx=Kg,XM=nh.f,YM=oh,QB=OA,jM=Cy,qM=DA,$M=Iy,UB=Hx("".startsWith),tV=Hx("".slice),eV=Math.min,Nx=$M("startsWith"),iV=!Nx&&!!function(){var i=XM(String.prototype,"startsWith");return i&&!i.writable}();JM({target:"String",proto:!0,forced:!iV&&!Nx},{startsWith:function(i){var t=QB(qM(this));jM(i);var e=YM(eV(arguments.length>1?arguments[1]:void 0,t.length)),o=QB(i);return UB?UB(t,o,e):tV(t,e,e+o.length)===o}});rV=Ts,nV=hy,sV=KA.f,vI=rV("unscopables"),wI=Array.prototype;wI[vI]==null&&sV(wI,vI,{configurable:!0,value:nV(null)});oV=function(i){wI[vI][i]=!0},aV=$n,AV=!aV(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype}),lV=pA,cV=Nn,uV=Pf,hV=JI,gV=AV,GB=hV("IE_PROTO"),BI=Object,dV=BI.prototype,Px=gV?BI.getPrototypeOf:function(i){var t=uV(i);if(lV(t,GB))return t[GB];var e=t.constructor;return cV(e)&&t instanceof e?e.prototype:t instanceof BI?dV:null},pV=$n,fV=Nn,mV=vl,RB=Px,CV=au,IV=Ts,_I=IV("iterator"),Mx=!1;[].keys&&(K0=[].keys(),"next"in K0?(D0=RB(RB(K0)),D0!==Object.prototype&&($c=D0)):Mx=!0);yV=!mV($c)||pV(function(){var i={};return $c[_I].call(i)!==i});yV&&($c={});fV($c[_I])||CV($c,_I,function(){return this});Vx={IteratorPrototype:$c,BUGGY_SAFARI_ITERATORS:Mx},bV=Vx.IteratorPrototype,vV=hy,wV=Rf,BV=qI,_V=Wg,xV=function(){return this},SV=function(i,t,e,o){var l=t+" Iterator";return i.prototype=vV(bV,{next:wV(+!o,e)}),BV(i,l,!1),_V[l]=xV,i},FV=Lo,kV=zs,Dx=Vf,LV=Nn,EV=SV,ZB=Px,HB=j_,TV=qI,QV=Mg,O0=au,UV=Ts,GV=Wg,Kx=Vx,RV=Dx.PROPER,ZV=Dx.CONFIGURABLE,NB=Kx.IteratorPrototype,Lp=Kx.BUGGY_SAFARI_ITERATORS,yg=UV("iterator"),PB="keys",bg="values",MB="entries",HV=function(){return this},NV=function(i,t,e,o,l,n,g){EV(e,t,o);var h=function(z){if(z===l&&G)return G;if(!Lp&&z in _)return _[z];switch(z){case PB:return function(){return new e(this,z)};case bg:return function(){return new e(this,z)};case MB:return function(){return new e(this,z)}}return function(){return new e(this)}},m=t+" Iterator",B=!1,_=i.prototype,E=_[yg]||_["@@iterator"]||l&&_[l],G=!Lp&&E||h(l),S=t=="Array"&&_.entries||E,O,P,tt;if(S&&(O=ZB(S.call(new i)),O!==Object.prototype&&O.next&&(ZB(O)!==NB&&(HB?HB(O,NB):LV(O[yg])||O0(O,yg,HV)),TV(O,m,!0))),RV&&l==bg&&E&&E.name!==bg&&(ZV?QV(_,"name",bg):(B=!0,G=function(){return kV(E,this)})),l)if(P={values:h(bg),keys:n?G:h(PB),entries:h(MB)},g)for(tt in P)(Lp||B||!(tt in _))&&O0(_,tt,P[tt]);else FV({target:t,proto:!0,forced:Lp||B},P);return _[yg]!==G&&O0(_,yg,G,{name:l}),GV[t]=G,P},PV=function(i,t){return{value:i,done:t}},MV=Pg,yy=oV,VB=Wg,Ox=Df,VV=KA.f,DV=NV,Ep=PV,KV=VA,Wx="Array Iterator",OV=Ox.set,WV=Ox.getterFor(Wx),zV=DV(Array,"Array",function(i,t){OV(this,{type:Wx,target:MV(i),index:0,kind:t})},function(){var i=WV(this),t=i.target,e=i.kind,o=i.index++;return!t||o>=t.length?(i.target=void 0,Ep(void 0,!0)):e=="keys"?Ep(o,!1):e=="values"?Ep(t[o],!1):Ep([o,t[o]],!1)},"values"),DB=VB.Arguments=VB.Array;yy("keys");yy("values");yy("entries");if(KV&&DB.name!=="values")try{VV(DB,"name",{value:"values"})}catch{}JV={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},XV=Mf,W0=XV("span").classList,KB=W0&&W0.constructor&&W0.constructor.prototype,YV=KB===Object.prototype?void 0:KB,OB=ws,zx=JV,jV=YV,Bg=zV,z0=Mg,Jx=Ts,J0=Jx("iterator"),WB=Jx("toStringTag"),X0=Bg.values,Xx=function(i,t){if(i){if(i[J0]!==X0)try{z0(i,J0,X0)}catch{i[J0]=X0}if(i[WB]||z0(i,WB,t),zx[t]){for(var e in Bg)if(i[e]!==Bg[e])try{z0(i,e,Bg[e])}catch{i[e]=Bg[e]}}}};for(Tp in zx)Xx(OB[Tp]&&OB[Tp].prototype,Tp);Xx(jV,"DOMTokenList");t9=wl,e9=Pf,i9=F_,r9=Of,n9=TypeError,zB=function(i){return function(t,e,o,l){t9(e);var n=e9(t),g=i9(n),h=r9(n),m=i?h-1:0,B=i?-1:1;if(o<2)for(;;){if(m in g){l=g[m],m+=B;break}if(m+=B,i?m<0:h<=m)throw n9("Reduce of empty array with no initial value")}for(;i?m>=0:h>m;m+=B)m in g&&(l=e(l,g[m],m,n));return l}},s9={left:zB(!1),right:zB(!0)},o9=$n,Yx=function(i,t){var e=[][i];return!!e&&o9(function(){e.call(null,t||function(){return 1},1)})},a9=Lo,A9=s9.left,l9=Yx,JB=MI,c9=Dg,u9=!c9&&JB>79&&JB<83,h9=u9||!l9("reduce");a9({target:"Array",proto:!0,forced:h9},{reduce:function(i){var t=arguments.length;return A9(this,i,t,t>1?arguments[1]:void 0)}});g9=Lo,jx=Kg,d9=nh.f,p9=oh,XB=OA,f9=Cy,m9=DA,C9=Iy,YB=jx("".endsWith),I9=jx("".slice),y9=Math.min,qx=C9("endsWith"),b9=!qx&&!!function(){var i=d9(String.prototype,"endsWith");return i&&!i.writable}();g9({target:"String",proto:!0,forced:!b9&&!qx},{endsWith:function(i){var t=XB(m9(this));f9(i);var e=arguments.length>1?arguments[1]:void 0,o=t.length,l=e===void 0?o:y9(p9(e),o),n=XB(i);return YB?YB(t,n,l):I9(t,l-n.length,l)===n}});v9=OI,w9=KA,B9=Rf,_9=function(i,t,e){var o=v9(t);o in i?w9.f(i,o,B9(0,e)):i[o]=e},jB=W_,x9=Of,S9=_9,F9=Array,k9=Math.max,L9=function(i,t,e){for(var o=x9(i),l=jB(t,o),n=jB(e===void 0?o:e,o),g=F9(k9(n-l,0)),h=0;l<n;l++,h++)S9(g,h,i[l]);return g.length=h,g},E9=ey,vg=zs,vy=ts,T9=gy,Q9=oo,U9=su,G9=Zx,qB=DA,R9=rx,Z9=py,H9=oh,Y0=OA,N9=sh,$B=L9,t_=fy,P9=Xf,M9=Ex,V9=$n,Ku=M9.UNSUPPORTED_Y,e_=4294967295,D9=Math.min,$x=[].push,K9=vy(/./.exec),Ou=vy($x),wg=vy("".slice),O9=!V9(function(){var i=/(?:)/,t=i.exec;i.exec=function(){return t.apply(this,arguments)};var e="ab".split(i);return e.length!==2||e[0]!=="a"||e[1]!=="b"});T9("split",function(i,t,e){var o;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?o=function(l,n){var g=Y0(qB(this)),h=n===void 0?e_:n>>>0;if(h===0)return[];if(l===void 0)return[g];if(!G9(l))return vg(t,g,l,h);for(var m=[],B=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(l.sticky?"y":""),_=0,E=new RegExp(l.source,B+"g"),G,S,O;(G=vg(P9,E,g))&&(S=E.lastIndex,!(S>_&&(Ou(m,wg(g,_,G.index)),G.length>1&&G.index<g.length&&E9($x,m,$B(G,1)),O=G[0].length,_=S,m.length>=h)));)E.lastIndex===G.index&&E.lastIndex++;return _===g.length?(O||!K9(E,""))&&Ou(m,""):Ou(m,wg(g,_)),m.length>h?$B(m,0,h):m}:"0".split(void 0,0).length?o=function(l,n){return l===void 0&&n===0?[]:vg(t,this,l,n)}:o=t,[function(l,n){var g=qB(this),h=U9(l)?void 0:N9(l,i);return h?vg(h,l,g,n):vg(o,Y0(g),l,n)},function(l,n){var g=Q9(this),h=Y0(l),m=e(o,g,h,n,o!==t);if(m.done)return m.value;var B=R9(g,RegExp),_=g.unicode,E=(g.ignoreCase?"i":"")+(g.multiline?"m":"")+(g.unicode?"u":"")+(Ku?"g":"y"),G=new B(Ku?"^(?:"+g.source+")":g,E),S=n===void 0?e_:n>>>0;if(S===0)return[];if(h.length===0)return t_(G,h)===null?[h]:[];for(var O=0,P=0,tt=[];P<h.length;){G.lastIndex=Ku?0:P;var z=t_(G,Ku?wg(h,P):h),rt;if(z===null||(rt=D9(H9(G.lastIndex+(Ku?P:0)),h.length))===O)P=Z9(h,P,_);else{if(Ou(tt,wg(h,O,P)),tt.length===S)return tt;for(var ct=1;ct<=z.length-1;ct++)if(Ou(tt,z[ct]),tt.length===S)return tt;P=O=rt}}return Ou(tt,wg(h,O)),tt}]},!O9,Ku);jf={exports:{}},_g={exports:{}};(function(){var i,t,e,o,l,n;typeof performance<"u"&&performance!==null&&performance.now?_g.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(_g.exports=function(){return(i()-l)/1e6},t=process.hrtime,i=function(){var g;return g=t(),g[0]*1e9+g[1]},o=i(),n=process.uptime()*1e9,l=o-n):Date.now?(_g.exports=function(){return Date.now()-e},e=Date.now()):(_g.exports=function(){return new Date().getTime()-e},e=new Date().getTime())}).call(xg);W9=_g.exports,z9=W9,yl=typeof window>"u"?xg:window,Qp=["moz","webkit"],qu="AnimationFrame",eh=yl["request"+qu],Eg=yl["cancel"+qu]||yl["cancelRequest"+qu];for(Wu=0;!eh&&Wu<Qp.length;Wu++)eh=yl[Qp[Wu]+"Request"+qu],Eg=yl[Qp[Wu]+"Cancel"+qu]||yl[Qp[Wu]+"CancelRequest"+qu];(!eh||!Eg)&&(Up=0,j0=0,Ac=[],i_=1e3/60,eh=function(i){if(Ac.length===0){var t=z9(),e=Math.max(0,i_-(t-Up));Up=e+t,setTimeout(function(){var o=Ac.slice(0);Ac.length=0;for(var l=0;l<o.length;l++)if(!o[l].cancelled)try{o[l].callback(Up)}catch(n){setTimeout(function(){throw n},0)}},Math.round(e))}return Ac.push({handle:++j0,callback:i,cancelled:!1}),j0},Eg=function(i){for(var t=0;t<Ac.length;t++)Ac[t].handle===i&&(Ac[t].cancelled=!0)});jf.exports=function(i){return eh.call(yl,i)};jf.exports.cancel=function(){Eg.apply(yl,arguments)};jf.exports.polyfill=function(i){i||(i=yl),i.requestAnimationFrame=eh,i.cancelAnimationFrame=Eg};J9=jf.exports,q0=b_(J9),t5=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,X9=ts,Y9=DA,j9=OA,xI=t5,r_=X9("".replace),q9=RegExp("^["+xI+"]+"),$9=RegExp("(^|[^"+xI+"])["+xI+"]+$"),$0=function(i){return function(t){var e=j9(Y9(t));return i&1&&(e=r_(e,q9,"")),i&2&&(e=r_(e,$9,"$1")),e}},t6={start:$0(1),end:$0(2),trim:$0(3)},e6=Vf.PROPER,i6=$n,n_=t5,s_="\u200B\x85\u180E",r6=function(i){return i6(function(){return!!n_[i]()||s_[i]()!==s_||e6&&n_[i].name!==i})},n6=Lo,s6=t6.trim,o6=r6;n6({target:"String",proto:!0,forced:o6("trim")},{trim:function(){return s6(this)}});a6=function(i){this.ok=!1,this.alpha=1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i=i.replace(/ /g,""),i=i.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};i=t[i]||i;for(var e=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(m){return[parseInt(m[1]),parseInt(m[2]),parseInt(m[3]),parseFloat(m[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(m){return[parseInt(m[1]),parseInt(m[2]),parseInt(m[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(m){return[parseInt(m[1],16),parseInt(m[2],16),parseInt(m[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(m){return[parseInt(m[1]+m[1],16),parseInt(m[2]+m[2],16),parseInt(m[3]+m[3],16)]}}],o=0;o<e.length;o++){var l=e[o].re,n=e[o].process,g=l.exec(i);if(g){var h=n(g);this.r=h[0],this.g=h[1],this.b=h[2],h.length>3&&(this.alpha=h[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var m=this.r.toString(16),B=this.g.toString(16),_=this.b.toString(16);return m.length==1&&(m="0"+m),B.length==1&&(B="0"+B),_.length==1&&(_="0"+_),"#"+m+B+_},this.getHelpXML=function(){for(var m=new Array,B=0;B<e.length;B++)for(var _=e[B].example,E=0;E<_.length;E++)m[m.length]=_[E];for(var G in t)m[m.length]=G;var S=document.createElement("ul");S.setAttribute("id","rgbcolor-examples");for(var B=0;B<m.length;B++)try{var O=document.createElement("li"),P=new RGBColor(m[B]),tt=document.createElement("div");tt.style.cssText="margin: 3px; border: 1px solid black; background:"+P.toHex()+"; color:"+P.toHex(),tt.appendChild(document.createTextNode("test"));var z=document.createTextNode(" "+m[B]+" -> "+P.toRGB()+" -> "+P.toHex());O.appendChild(tt),O.appendChild(z),S.appendChild(O)}catch{}return S}},SI=b_(a6),A6=Lo,l6=Kg,c6=z_.indexOf,u6=Yx,FI=l6([].indexOf),e5=!!FI&&1/FI([1],1,-0)<0,h6=e5||!u6("indexOf");A6({target:"Array",proto:!0,forced:h6},{indexOf:function(i){var t=arguments.length>1?arguments[1]:void 0;return e5?FI(this,i,t)||0:c6(this,i,t)}});g6=Lo,d6=ts,p6=Cy,f6=DA,o_=OA,m6=Iy,C6=d6("".indexOf);g6({target:"String",proto:!0,forced:!m6("includes")},{includes:function(i){return!!~C6(o_(f6(this)),o_(p6(i)),arguments.length>1?arguments[1]:void 0)}});I6=nu,y6=Array.isArray||function(i){return I6(i)=="Array"},b6=Lo,v6=ts,w6=y6,B6=v6([].reverse),a_=[1,2];b6({target:"Array",proto:!0,forced:String(a_)===String(a_.reverse())},{reverse:function(){return w6(this)&&(this.length=this.length),B6(this)}});i5=function(i,t){return(i5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])})(i,t)};lc=Math.PI;Cl=Math.PI/180;(function(i){function t(){return l(function(h,m,B){return h.relative&&(h.x1!==void 0&&(h.x1+=m),h.y1!==void 0&&(h.y1+=B),h.x2!==void 0&&(h.x2+=m),h.y2!==void 0&&(h.y2+=B),h.x!==void 0&&(h.x+=m),h.y!==void 0&&(h.y+=B),h.relative=!1),h})}function e(){var h=NaN,m=NaN,B=NaN,_=NaN;return l(function(E,G,S){return E.type&Xe.SMOOTH_CURVE_TO&&(E.type=Xe.CURVE_TO,h=isNaN(h)?G:h,m=isNaN(m)?S:m,E.x1=E.relative?G-h:2*G-h,E.y1=E.relative?S-m:2*S-m),E.type&Xe.CURVE_TO?(h=E.relative?G+E.x2:E.x2,m=E.relative?S+E.y2:E.y2):(h=NaN,m=NaN),E.type&Xe.SMOOTH_QUAD_TO&&(E.type=Xe.QUAD_TO,B=isNaN(B)?G:B,_=isNaN(_)?S:_,E.x1=E.relative?G-B:2*G-B,E.y1=E.relative?S-_:2*S-_),E.type&Xe.QUAD_TO?(B=E.relative?G+E.x1:E.x1,_=E.relative?S+E.y1:E.y1):(B=NaN,_=NaN),E})}function o(){var h=NaN,m=NaN;return l(function(B,_,E){if(B.type&Xe.SMOOTH_QUAD_TO&&(B.type=Xe.QUAD_TO,h=isNaN(h)?_:h,m=isNaN(m)?E:m,B.x1=B.relative?_-h:2*_-h,B.y1=B.relative?E-m:2*E-m),B.type&Xe.QUAD_TO){h=B.relative?_+B.x1:B.x1,m=B.relative?E+B.y1:B.y1;var G=B.x1,S=B.y1;B.type=Xe.CURVE_TO,B.x1=((B.relative?0:_)+2*G)/3,B.y1=((B.relative?0:E)+2*S)/3,B.x2=(B.x+2*G)/3,B.y2=(B.y+2*S)/3}else h=NaN,m=NaN;return B})}function l(h){var m=0,B=0,_=NaN,E=NaN;return function(G){if(isNaN(_)&&!(G.type&Xe.MOVE_TO))throw new Error("path must start with moveto");var S=h(G,m,B,_,E);return G.type&Xe.CLOSE_PATH&&(m=_,B=E),G.x!==void 0&&(m=G.relative?m+G.x:G.x),G.y!==void 0&&(B=G.relative?B+G.y:G.y),G.type&Xe.MOVE_TO&&(_=m,E=B),S}}function n(h,m,B,_,E,G){return uA(h,m,B,_,E,G),l(function(S,O,P,tt){var z=S.x1,rt=S.x2,ct=S.relative&&!isNaN(tt),Et=S.x!==void 0?S.x:ct?0:O,Pt=S.y!==void 0?S.y:ct?0:P;function Qt(j){return j*j}S.type&Xe.HORIZ_LINE_TO&&m!==0&&(S.type=Xe.LINE_TO,S.y=S.relative?0:P),S.type&Xe.VERT_LINE_TO&&B!==0&&(S.type=Xe.LINE_TO,S.x=S.relative?0:O),S.x!==void 0&&(S.x=S.x*h+Pt*B+(ct?0:E)),S.y!==void 0&&(S.y=Et*m+S.y*_+(ct?0:G)),S.x1!==void 0&&(S.x1=S.x1*h+S.y1*B+(ct?0:E)),S.y1!==void 0&&(S.y1=z*m+S.y1*_+(ct?0:G)),S.x2!==void 0&&(S.x2=S.x2*h+S.y2*B+(ct?0:E)),S.y2!==void 0&&(S.y2=rt*m+S.y2*_+(ct?0:G));var Ut=h*_-m*B;if(S.xRot!==void 0&&(h!==1||m!==0||B!==0||_!==1))if(Ut===0)delete S.rX,delete S.rY,delete S.xRot,delete S.lArcFlag,delete S.sweepFlag,S.type=Xe.LINE_TO;else{var dt=S.xRot*Math.PI/180,ee=Math.sin(dt),oe=Math.cos(dt),ht=1/Qt(S.rX),At=1/Qt(S.rY),Ft=Qt(oe)*ht+Qt(ee)*At,St=2*ee*oe*(ht-At),ue=Qt(ee)*ht+Qt(oe)*At,ce=Ft*_*_-St*m*_+ue*m*m,ae=St*(h*_+m*B)-2*(Ft*B*_+ue*h*m),se=Ft*B*B-St*h*B+ue*h*h,Lt=(Math.atan2(ae,ce-se)+Math.PI)%Math.PI/2,Ht=Math.sin(Lt),fe=Math.cos(Lt);S.rX=Math.abs(Ut)/Math.sqrt(ce*Qt(fe)+ae*Ht*fe+se*Qt(Ht)),S.rY=Math.abs(Ut)/Math.sqrt(ce*Qt(Ht)-ae*Ht*fe+se*Qt(fe)),S.xRot=180*Lt/Math.PI}return S.sweepFlag!==void 0&&0>Ut&&(S.sweepFlag=+!S.sweepFlag),S})}function g(){return function(h){var m={};for(var B in h)m[B]=h[B];return m}}i.ROUND=function(h){function m(B){return Math.round(B*h)/h}return h===void 0&&(h=1e13),uA(h),function(B){return B.x1!==void 0&&(B.x1=m(B.x1)),B.y1!==void 0&&(B.y1=m(B.y1)),B.x2!==void 0&&(B.x2=m(B.x2)),B.y2!==void 0&&(B.y2=m(B.y2)),B.x!==void 0&&(B.x=m(B.x)),B.y!==void 0&&(B.y=m(B.y)),B.rX!==void 0&&(B.rX=m(B.rX)),B.rY!==void 0&&(B.rY=m(B.rY)),B}},i.TO_ABS=t,i.TO_REL=function(){return l(function(h,m,B){return h.relative||(h.x1!==void 0&&(h.x1-=m),h.y1!==void 0&&(h.y1-=B),h.x2!==void 0&&(h.x2-=m),h.y2!==void 0&&(h.y2-=B),h.x!==void 0&&(h.x-=m),h.y!==void 0&&(h.y-=B),h.relative=!0),h})},i.NORMALIZE_HVZ=function(h,m,B){return h===void 0&&(h=!0),m===void 0&&(m=!0),B===void 0&&(B=!0),l(function(_,E,G,S,O){if(isNaN(S)&&!(_.type&Xe.MOVE_TO))throw new Error("path must start with moveto");return m&&_.type&Xe.HORIZ_LINE_TO&&(_.type=Xe.LINE_TO,_.y=_.relative?0:G),B&&_.type&Xe.VERT_LINE_TO&&(_.type=Xe.LINE_TO,_.x=_.relative?0:E),h&&_.type&Xe.CLOSE_PATH&&(_.type=Xe.LINE_TO,_.x=_.relative?S-E:S,_.y=_.relative?O-G:O),_.type&Xe.ARC&&(_.rX===0||_.rY===0)&&(_.type=Xe.LINE_TO,delete _.rX,delete _.rY,delete _.xRot,delete _.lArcFlag,delete _.sweepFlag),_})},i.NORMALIZE_ST=e,i.QT_TO_C=o,i.INFO=l,i.SANITIZE=function(h){h===void 0&&(h=0),uA(h);var m=NaN,B=NaN,_=NaN,E=NaN;return l(function(G,S,O,P,tt){var z=Math.abs,rt=!1,ct=0,Et=0;if(G.type&Xe.SMOOTH_CURVE_TO&&(ct=isNaN(m)?0:S-m,Et=isNaN(B)?0:O-B),G.type&(Xe.CURVE_TO|Xe.SMOOTH_CURVE_TO)?(m=G.relative?S+G.x2:G.x2,B=G.relative?O+G.y2:G.y2):(m=NaN,B=NaN),G.type&Xe.SMOOTH_QUAD_TO?(_=isNaN(_)?S:2*S-_,E=isNaN(E)?O:2*O-E):G.type&Xe.QUAD_TO?(_=G.relative?S+G.x1:G.x1,E=G.relative?O+G.y1:G.y2):(_=NaN,E=NaN),G.type&Xe.LINE_COMMANDS||G.type&Xe.ARC&&(G.rX===0||G.rY===0||!G.lArcFlag)||G.type&Xe.CURVE_TO||G.type&Xe.SMOOTH_CURVE_TO||G.type&Xe.QUAD_TO||G.type&Xe.SMOOTH_QUAD_TO){var Pt=G.x===void 0?0:G.relative?G.x:G.x-S,Qt=G.y===void 0?0:G.relative?G.y:G.y-O;ct=isNaN(_)?G.x1===void 0?ct:G.relative?G.x:G.x1-S:_-S,Et=isNaN(E)?G.y1===void 0?Et:G.relative?G.y:G.y1-O:E-O;var Ut=G.x2===void 0?0:G.relative?G.x:G.x2-S,dt=G.y2===void 0?0:G.relative?G.y:G.y2-O;z(Pt)<=h&&z(Qt)<=h&&z(ct)<=h&&z(Et)<=h&&z(Ut)<=h&&z(dt)<=h&&(rt=!0)}return G.type&Xe.CLOSE_PATH&&z(S-P)<=h&&z(O-tt)<=h&&(rt=!0),rt?[]:G})},i.MATRIX=n,i.ROTATE=function(h,m,B){m===void 0&&(m=0),B===void 0&&(B=0),uA(h,m,B);var _=Math.sin(h),E=Math.cos(h);return n(E,_,-_,E,m-m*E+B*_,B-m*_-B*E)},i.TRANSLATE=function(h,m){return m===void 0&&(m=0),uA(h,m),n(1,0,0,1,h,m)},i.SCALE=function(h,m){return m===void 0&&(m=h),uA(h,m),n(h,0,0,m,0,0)},i.SKEW_X=function(h){return uA(h),n(1,0,Math.atan(h),1,0,0)},i.SKEW_Y=function(h){return uA(h),n(1,Math.atan(h),0,1,0,0)},i.X_AXIS_SYMMETRY=function(h){return h===void 0&&(h=0),uA(h),n(-1,0,0,1,h,0)},i.Y_AXIS_SYMMETRY=function(h){return h===void 0&&(h=0),uA(h),n(1,0,0,-1,0,h)},i.A_TO_C=function(){return l(function(h,m,B){return Xe.ARC===h.type?function(_,E,G){var S,O,P,tt;_.cX||tI(_,E,G);for(var z=Math.min(_.phi1,_.phi2),rt=Math.max(_.phi1,_.phi2)-z,ct=Math.ceil(rt/90),Et=new Array(ct),Pt=E,Qt=G,Ut=0;Ut<ct;Ut++){var dt=l_(_.phi1,_.phi2,Ut/ct),ee=l_(_.phi1,_.phi2,(Ut+1)/ct),oe=ee-dt,ht=4/3*Math.tan(oe*Cl/4),At=[Math.cos(dt*Cl)-ht*Math.sin(dt*Cl),Math.sin(dt*Cl)+ht*Math.cos(dt*Cl)],Ft=At[0],St=At[1],ue=[Math.cos(ee*Cl),Math.sin(ee*Cl)],ce=ue[0],ae=ue[1],se=[ce+ht*Math.sin(ee*Cl),ae-ht*Math.cos(ee*Cl)],Lt=se[0],Ht=se[1];Et[Ut]={relative:_.relative,type:Xe.CURVE_TO};var fe=function(j,It){var bt=kI([j*_.rX,It*_.rY],_.xRot),Vt=bt[0],Xt=bt[1];return[_.cX+Vt,_.cY+Xt]};S=fe(Ft,St),Et[Ut].x1=S[0],Et[Ut].y1=S[1],O=fe(Lt,Ht),Et[Ut].x2=O[0],Et[Ut].y2=O[1],P=fe(ce,ae),Et[Ut].x=P[0],Et[Ut].y=P[1],_.relative&&(Et[Ut].x1-=Pt,Et[Ut].y1-=Qt,Et[Ut].x2-=Pt,Et[Ut].y2-=Qt,Et[Ut].x-=Pt,Et[Ut].y-=Qt),Pt=(tt=[Et[Ut].x,Et[Ut].y])[0],Qt=tt[1]}return Et}(h,h.relative?0:m,h.relative?0:B):h})},i.ANNOTATE_ARCS=function(){return l(function(h,m,B){return h.relative&&(m=0,B=0),Xe.ARC===h.type&&tI(h,m,B),h})},i.CLONE=g,i.CALCULATE_BOUNDS=function(){var h=function(G){var S={};for(var O in G)S[O]=G[O];return S},m=t(),B=o(),_=e(),E=l(function(G,S,O){var P=_(B(m(h(G))));function tt(Ht){Ht>E.maxX&&(E.maxX=Ht),Ht<E.minX&&(E.minX=Ht)}function z(Ht){Ht>E.maxY&&(E.maxY=Ht),Ht<E.minY&&(E.minY=Ht)}if(P.type&Xe.DRAWING_COMMANDS&&(tt(S),z(O)),P.type&Xe.HORIZ_LINE_TO&&tt(P.x),P.type&Xe.VERT_LINE_TO&&z(P.y),P.type&Xe.LINE_TO&&(tt(P.x),z(P.y)),P.type&Xe.CURVE_TO){tt(P.x),z(P.y);for(var rt=0,ct=u_(S,P.x1,P.x2,P.x);rt<ct.length;rt++)0<(Lt=ct[rt])&&1>Lt&&tt(h_(S,P.x1,P.x2,P.x,Lt));for(var Et=0,Pt=u_(O,P.y1,P.y2,P.y);Et<Pt.length;Et++)0<(Lt=Pt[Et])&&1>Lt&&z(h_(O,P.y1,P.y2,P.y,Lt))}if(P.type&Xe.ARC){tt(P.x),z(P.y),tI(P,S,O);for(var Qt=P.xRot/180*Math.PI,Ut=Math.cos(Qt)*P.rX,dt=Math.sin(Qt)*P.rX,ee=-Math.sin(Qt)*P.rY,oe=Math.cos(Qt)*P.rY,ht=P.phi1<P.phi2?[P.phi1,P.phi2]:-180>P.phi2?[P.phi2+360,P.phi1+360]:[P.phi2,P.phi1],At=ht[0],Ft=ht[1],St=function(Ht){var fe=Ht[0],j=Ht[1],It=180*Math.atan2(j,fe)/Math.PI;return It<At?It+360:It},ue=0,ce=A_(ee,-Ut,0).map(St);ue<ce.length;ue++)(Lt=ce[ue])>At&&Lt<Ft&&tt(c_(P.cX,Ut,ee,Lt));for(var ae=0,se=A_(oe,-dt,0).map(St);ae<se.length;ae++){var Lt;(Lt=se[ae])>At&&Lt<Ft&&z(c_(P.cY,dt,oe,Lt))}}return G});return E.minX=1/0,E.maxX=-1/0,E.minY=1/0,E.maxY=-1/0,E}})(us||(us={}));n5=function(){function i(){}return i.prototype.round=function(t){return this.transform(us.ROUND(t))},i.prototype.toAbs=function(){return this.transform(us.TO_ABS())},i.prototype.toRel=function(){return this.transform(us.TO_REL())},i.prototype.normalizeHVZ=function(t,e,o){return this.transform(us.NORMALIZE_HVZ(t,e,o))},i.prototype.normalizeST=function(){return this.transform(us.NORMALIZE_ST())},i.prototype.qtToC=function(){return this.transform(us.QT_TO_C())},i.prototype.aToC=function(){return this.transform(us.A_TO_C())},i.prototype.sanitize=function(t){return this.transform(us.SANITIZE(t))},i.prototype.translate=function(t,e){return this.transform(us.TRANSLATE(t,e))},i.prototype.scale=function(t,e){return this.transform(us.SCALE(t,e))},i.prototype.rotate=function(t,e,o){return this.transform(us.ROTATE(t,e,o))},i.prototype.matrix=function(t,e,o,l,n,g){return this.transform(us.MATRIX(t,e,o,l,n,g))},i.prototype.skewX=function(t){return this.transform(us.SKEW_X(t))},i.prototype.skewY=function(t){return this.transform(us.SKEW_Y(t))},i.prototype.xSymmetry=function(t){return this.transform(us.X_AXIS_SYMMETRY(t))},i.prototype.ySymmetry=function(t){return this.transform(us.Y_AXIS_SYMMETRY(t))},i.prototype.annotateArcs=function(){return this.transform(us.ANNOTATE_ARCS())},i}(),x6=function(i){return i===" "||i==="	"||i==="\r"||i===`
`},g_=function(i){return"0".charCodeAt(0)<=i.charCodeAt(0)&&i.charCodeAt(0)<="9".charCodeAt(0)},S6=function(i){function t(){var e=i.call(this)||this;return e.curNumber="",e.curCommandType=-1,e.curCommandRelative=!1,e.canParseCommandOrComma=!0,e.curNumberHasExp=!1,e.curNumberHasExpDigits=!1,e.curNumberHasDecimal=!1,e.curArgs=[],e}return r5(t,i),t.prototype.finish=function(e){if(e===void 0&&(e=[]),this.parse(" ",e),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return e},t.prototype.parse=function(e,o){var l=this;o===void 0&&(o=[]);for(var n=function(E){o.push(E),l.curArgs.length=0,l.canParseCommandOrComma=!0},g=0;g<e.length;g++){var h=e[g],m=!(this.curCommandType!==Xe.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),B=g_(h)&&(this.curNumber==="0"&&h==="0"||m);if(!g_(h)||B)if(h!=="e"&&h!=="E")if(h!=="-"&&h!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(h!=="."||this.curNumberHasExp||this.curNumberHasDecimal||m){if(this.curNumber&&this.curCommandType!==-1){var _=Number(this.curNumber);if(isNaN(_))throw new SyntaxError("Invalid number ending at "+g);if(this.curCommandType===Xe.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>_)throw new SyntaxError('Expected positive number, got "'+_+'" at index "'+g+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+g+'"')}this.curArgs.push(_),this.curArgs.length===F6[this.curCommandType]&&(Xe.HORIZ_LINE_TO===this.curCommandType?n({type:Xe.HORIZ_LINE_TO,relative:this.curCommandRelative,x:_}):Xe.VERT_LINE_TO===this.curCommandType?n({type:Xe.VERT_LINE_TO,relative:this.curCommandRelative,y:_}):this.curCommandType===Xe.MOVE_TO||this.curCommandType===Xe.LINE_TO||this.curCommandType===Xe.SMOOTH_QUAD_TO?(n({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),Xe.MOVE_TO===this.curCommandType&&(this.curCommandType=Xe.LINE_TO)):this.curCommandType===Xe.CURVE_TO?n({type:Xe.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===Xe.SMOOTH_CURVE_TO?n({type:Xe.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Xe.QUAD_TO?n({type:Xe.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===Xe.ARC&&n({type:Xe.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!x6(h))if(h===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(h!=="+"&&h!=="-"&&h!==".")if(B)this.curNumber=h,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+g+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+h+'" at index '+g+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,h!=="z"&&h!=="Z")if(h==="h"||h==="H")this.curCommandType=Xe.HORIZ_LINE_TO,this.curCommandRelative=h==="h";else if(h==="v"||h==="V")this.curCommandType=Xe.VERT_LINE_TO,this.curCommandRelative=h==="v";else if(h==="m"||h==="M")this.curCommandType=Xe.MOVE_TO,this.curCommandRelative=h==="m";else if(h==="l"||h==="L")this.curCommandType=Xe.LINE_TO,this.curCommandRelative=h==="l";else if(h==="c"||h==="C")this.curCommandType=Xe.CURVE_TO,this.curCommandRelative=h==="c";else if(h==="s"||h==="S")this.curCommandType=Xe.SMOOTH_CURVE_TO,this.curCommandRelative=h==="s";else if(h==="q"||h==="Q")this.curCommandType=Xe.QUAD_TO,this.curCommandRelative=h==="q";else if(h==="t"||h==="T")this.curCommandType=Xe.SMOOTH_QUAD_TO,this.curCommandRelative=h==="t";else{if(h!=="a"&&h!=="A")throw new SyntaxError('Unexpected character "'+h+'" at index '+g+".");this.curCommandType=Xe.ARC,this.curCommandRelative=h==="a"}else o.push({type:Xe.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=h,this.curNumberHasDecimal=h==="."}else this.curNumber+=h,this.curNumberHasDecimal=!0;else this.curNumber+=h;else this.curNumber+=h,this.curNumberHasExp=!0;else this.curNumber+=h,this.curNumberHasExpDigits=this.curNumberHasExp}return o},t.prototype.transform=function(e){return Object.create(this,{parse:{value:function(o,l){l===void 0&&(l=[]);for(var n=0,g=Object.getPrototypeOf(this).parse.call(this,o);n<g.length;n++){var h=g[n],m=e(h);Array.isArray(m)?l.push.apply(l,m):l.push(m)}return l}}})},t}(n5),Xe=function(i){function t(e){var o=i.call(this)||this;return o.commands=typeof e=="string"?t.parse(e):e,o}return r5(t,i),t.prototype.encode=function(){return t.encode(this.commands)},t.prototype.getBounds=function(){var e=us.CALCULATE_BOUNDS();return this.transform(e),e},t.prototype.transform=function(e){for(var o=[],l=0,n=this.commands;l<n.length;l++){var g=e(n[l]);Array.isArray(g)?o.push.apply(o,g):o.push(g)}return this.commands=o,this},t.encode=function(e){return _6(e)},t.parse=function(e){var o=new S6,l=[];return o.parse(e,l),o.finish(l),l},t.CLOSE_PATH=1,t.MOVE_TO=2,t.HORIZ_LINE_TO=4,t.VERT_LINE_TO=8,t.LINE_TO=16,t.CURVE_TO=32,t.SMOOTH_CURVE_TO=64,t.QUAD_TO=128,t.SMOOTH_QUAD_TO=256,t.ARC=512,t.LINE_COMMANDS=t.LINE_TO|t.HORIZ_LINE_TO|t.VERT_LINE_TO,t.DRAWING_COMMANDS=t.HORIZ_LINE_TO|t.VERT_LINE_TO|t.LINE_TO|t.CURVE_TO|t.SMOOTH_CURVE_TO|t.QUAD_TO|t.SMOOTH_QUAD_TO|t.ARC,t}(n5),F6=((cA={})[Xe.MOVE_TO]=2,cA[Xe.LINE_TO]=2,cA[Xe.HORIZ_LINE_TO]=1,cA[Xe.VERT_LINE_TO]=1,cA[Xe.CLOSE_PATH]=0,cA[Xe.QUAD_TO]=4,cA[Xe.SMOOTH_QUAD_TO]=2,cA[Xe.CURVE_TO]=6,cA[Xe.SMOOTH_CURVE_TO]=4,cA[Xe.ARC]=7,cA),k6=zs,L6=pA,E6=Zf,T6=Lx,d_=RegExp.prototype,Q6=function(i){var t=i.flags;return t===void 0&&!("flags"in d_)&&!L6(i,"flags")&&E6(d_,i)?k6(T6,i):t},U6=Vf.PROPER,G6=au,R6=oo,p_=OA,Z6=$n,H6=Q6,wy="toString",N6=RegExp.prototype,s5=N6[wy],P6=Z6(function(){return s5.call({source:"a",flags:"b"})!="/a/b"}),M6=U6&&s5.name!=wy;(P6||M6)&&G6(RegExp.prototype,wy,function(){var i=R6(this),t=p_(i.source),e=p_(H6(i));return"/"+t+"/"+e},{unsafe:!0});D6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],K6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];f_=function i(){V6(this,i),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};Y6=Object.freeze({__proto__:null,offscreen:J6,node:X6});j6=/^[A-Z-]+$/;q6=/(\[[^\]]+\])/g,$6=/(#[^\s+>~.[:]+)/g,tD=/(\.[^\s+>~.[:]+)/g,eD=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,iD=/(:[\w-]+\([^)]*\))/gi,rD=/(:[^\s+>~.[:]+)/g,nD=/([^\s+>~.[:]+)/g;jc=1e-8;Di=class{constructor(t,e,o){this.document=t,this.name=e,this.value=o,this.isNormalizedColor=!1}static empty(t){return new Di(t,"EMPTY","")}split(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ",{document:e,name:o}=this;return Au(this.getString()).trim().split(t).map(l=>new Di(e,o,l))}hasValue(t){var{value:e}=this;return e!==null&&e!==""&&(t||e!==0)&&typeof e<"u"}isString(t){var{value:e}=this,o=typeof e=="string";return!o||!t?o:t.test(e)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;var t=this.getString();switch(!0){case t.endsWith("px"):case/^[0-9]+$/.test(t):return!0;default:return!1}}setValue(t){return this.value=t,this}getValue(t){return typeof t>"u"||this.hasValue()?this.value:t}getNumber(t){if(!this.hasValue())return typeof t>"u"?0:parseFloat(t);var{value:e}=this,o=parseFloat(e);return this.isString(/%$/)&&(o/=100),o}getString(t){return typeof t>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(t)}getColor(t){var e=this.getString(t);return this.isNormalizedColor||(this.isNormalizedColor=!0,e=l5(e),this.value=e),e}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;var[o,l]=typeof t=="boolean"?[void 0,t]:[t],{viewPort:n}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(n.computeSize("x"),n.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(n.computeSize("x"),n.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*n.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*n.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&l):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*n.computeSize(o);default:{var g=this.getNumber();return e&&g<1?g*n.computeSize(o):g}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){var t=this.getString(),e=/#([^)'"]+)/.exec(t);return e&&(e=e[1]),e||(e=t),this.document.definitions[e]}getFillStyleDefinition(t,e){var o=this.getDefinition();if(!o)return null;if(typeof o.createGradient=="function")return o.createGradient(this.document.ctx,t,e);if(typeof o.createPattern=="function"){if(o.getHrefAttribute().hasValue()){var l=o.getAttribute("patternTransform");o=o.getHrefAttribute().getDefinition(),l.hasValue()&&o.getAttribute("patternTransform",!0).setValue(l.value)}return o.createPattern(this.document.ctx,t,e)}return null}getTextBaseline(){return this.hasValue()?Di.textBaselineMapping[this.getString()]:null}addOpacity(t){for(var e=this.getColor(),o=e.length,l=0,n=0;n<o&&(e[n]===","&&l++,l!==3);n++);if(t.hasValue()&&this.isString()&&l!==3){var g=new SI(e);g.ok&&(g.alpha=t.getNumber(),e=g.toRGBA())}return new Di(this.document,this.name,e)}};Di.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};jp=class{constructor(){this.viewPorts=[]}clear(){this.viewPorts=[]}setCurrent(t,e){this.viewPorts.push({width:t,height:e})}removeCurrent(){this.viewPorts.pop()}getCurrent(){var{viewPorts:t}=this;return t[t.length-1]}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(t){return typeof t=="number"?t:t==="x"?this.width:t==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}},xn=class{constructor(t,e){this.x=t,this.y=e}static parse(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,[o=e,l=e]=Jo(t);return new xn(o,l)}static parseScale(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,[o=e,l=o]=Jo(t);return new xn(o,l)}static parsePath(t){for(var e=Jo(t),o=e.length,l=[],n=0;n<o;n+=2)l.push(new xn(e[n],e[n+1]));return l}angleTo(t){return Math.atan2(t.y-this.y,t.x-this.x)}applyTransform(t){var{x:e,y:o}=this,l=e*t[0]+o*t[2]+t[4],n=e*t[1]+o*t[3]+t[5];this.x=l,this.y=n}},qp=class{constructor(t){this.screen=t,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}isWorking(){return this.working}start(){if(!this.working){var{screen:t,onClick:e,onMouseMove:o}=this,l=t.ctx.canvas;l.onclick=e,l.onmousemove=o,this.working=!0}}stop(){if(this.working){var t=this.screen.ctx.canvas;this.working=!1,t.onclick=null,t.onmousemove=null}}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(this.working){var{screen:t,events:e,eventElements:o}=this,{style:l}=t.ctx.canvas;l&&(l.cursor=""),e.forEach((n,g)=>{for(var{run:h}=n,m=o[g];m;)h(m),m=m.parent}),this.events=[],this.eventElements=[]}}checkPath(t,e){if(!(!this.working||!e)){var{events:o,eventElements:l}=this;o.forEach((n,g)=>{var{x:h,y:m}=n;!l[g]&&e.isPointInPath&&e.isPointInPath(h,m)&&(l[g]=t)})}}checkBoundingBox(t,e){if(!(!this.working||!e)){var{events:o,eventElements:l}=this;o.forEach((n,g)=>{var{x:h,y:m}=n;!l[g]&&e.isPointInBox(h,m)&&(l[g]=t)})}}mapXY(t,e){for(var{window:o,ctx:l}=this.screen,n=new xn(t,e),g=l.canvas;g;)n.x-=g.offsetLeft,n.y-=g.offsetTop,g=g.offsetParent;return o.scrollX&&(n.x+=o.scrollX),o.scrollY&&(n.y+=o.scrollY),n}onClick(t){var{x:e,y:o}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onclick",x:e,y:o,run(l){l.onClick&&l.onClick()}})}onMouseMove(t){var{x:e,y:o}=this.mapXY(t.clientX,t.clientY);this.events.push({type:"onmousemove",x:e,y:o,run(l){l.onMouseMove&&l.onMouseMove()}})}},u5=typeof window<"u"?window:null,h5=typeof fetch<"u"?fetch.bind(void 0):null,tu=class{constructor(t){var{fetch:e=h5,window:o=u5}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.ctx=t,this.FRAMERATE=30,this.MAX_VIRTUAL_PIXELS=3e4,this.CLIENT_WIDTH=800,this.CLIENT_HEIGHT=600,this.viewPort=new jp,this.mouse=new qp(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=o,this.fetch=e}wait(t){this.waits.push(t)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;var t=this.waits.every(e=>e());return t&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=t,t}setDefaults(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4}setViewBox(t){var{document:e,ctx:o,aspectRatio:l,width:n,desiredWidth:g,height:h,desiredHeight:m,minX:B=0,minY:_=0,refX:E,refY:G,clip:S=!1,clipX:O=0,clipY:P=0}=t,tt=Au(l).replace(/^defer\s/,""),[z,rt]=tt.split(" "),ct=z||"xMidYMid",Et=rt||"meet",Pt=n/g,Qt=h/m,Ut=Math.min(Pt,Qt),dt=Math.max(Pt,Qt),ee=g,oe=m;Et==="meet"&&(ee*=Ut,oe*=Ut),Et==="slice"&&(ee*=dt,oe*=dt);var ht=new Di(e,"refX",E),At=new Di(e,"refY",G),Ft=ht.hasValue()&&At.hasValue();if(Ft&&o.translate(-Ut*ht.getPixels("x"),-Ut*At.getPixels("y")),S){var St=Ut*O,ue=Ut*P;o.beginPath(),o.moveTo(St,ue),o.lineTo(n,ue),o.lineTo(n,h),o.lineTo(St,h),o.closePath(),o.clip()}if(!Ft){var ce=Et==="meet"&&Ut===Qt,ae=Et==="slice"&&dt===Qt,se=Et==="meet"&&Ut===Pt,Lt=Et==="slice"&&dt===Pt;ct.startsWith("xMid")&&(ce||ae)&&o.translate(n/2-ee/2,0),ct.endsWith("YMid")&&(se||Lt)&&o.translate(0,h/2-oe/2),ct.startsWith("xMax")&&(ce||ae)&&o.translate(n-ee,0),ct.endsWith("YMax")&&(se||Lt)&&o.translate(0,h-oe)}switch(!0){case ct==="none":o.scale(Pt,Qt);break;case Et==="meet":o.scale(Ut,Ut);break;case Et==="slice":o.scale(dt,dt);break}o.translate(-B,-_)}start(t){var{enableRedraw:e=!1,ignoreMouse:o=!1,ignoreAnimation:l=!1,ignoreDimensions:n=!1,ignoreClear:g=!1,forceRedraw:h,scaleWidth:m,scaleHeight:B,offsetX:_,offsetY:E}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{FRAMERATE:G,mouse:S}=this,O=1e3/G;if(this.frameDuration=O,this.readyPromise=new Promise(ct=>{this.resolveReady=ct}),this.isReady()&&this.render(t,n,g,m,B,_,E),!!e){var P=Date.now(),tt=P,z=0,rt=()=>{P=Date.now(),z=P-tt,z>=O&&(tt=P-z%O,this.shouldUpdate(l,h)&&(this.render(t,n,g,m,B,_,E),S.runEvents())),this.intervalId=q0(rt)};o||S.start(),this.intervalId=q0(rt)}}stop(){this.intervalId&&(q0.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(t,e){if(!t){var{frameDuration:o}=this,l=this.animations.reduce((n,g)=>g.update(o)||n,!1);if(l)return!0}return!!(typeof e=="function"&&e()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(t,e,o,l,n,g,h){var{CLIENT_WIDTH:m,CLIENT_HEIGHT:B,viewPort:_,ctx:E,isFirstRender:G}=this,S=E.canvas;_.clear(),S.width&&S.height?_.setCurrent(S.width,S.height):_.setCurrent(m,B);var O=t.getStyle("width"),P=t.getStyle("height");!e&&(G||typeof l!="number"&&typeof n!="number")&&(O.hasValue()&&(S.width=O.getPixels("x"),S.style&&(S.style.width="".concat(S.width,"px"))),P.hasValue()&&(S.height=P.getPixels("y"),S.style&&(S.style.height="".concat(S.height,"px"))));var tt=S.clientWidth||S.width,z=S.clientHeight||S.height;if(e&&O.hasValue()&&P.hasValue()&&(tt=O.getPixels("x"),z=P.getPixels("y")),_.setCurrent(tt,z),typeof g=="number"&&t.getAttribute("x",!0).setValue(g),typeof h=="number"&&t.getAttribute("y",!0).setValue(h),typeof l=="number"||typeof n=="number"){var rt=Jo(t.getAttribute("viewBox").getString()),ct=0,Et=0;if(typeof l=="number"){var Pt=t.getStyle("width");Pt.hasValue()?ct=Pt.getPixels("x")/l:isNaN(rt[2])||(ct=rt[2]/l)}if(typeof n=="number"){var Qt=t.getStyle("height");Qt.hasValue()?Et=Qt.getPixels("y")/n:isNaN(rt[3])||(Et=rt[3]/n)}ct||(ct=Et),Et||(Et=ct),t.getAttribute("width",!0).setValue(l),t.getAttribute("height",!0).setValue(n);var Ut=t.getStyle("transform",!0,!0);Ut.setValue("".concat(Ut.getString()," scale(").concat(1/ct,", ").concat(1/Et,")"))}o||E.clearRect(0,0,tt,z),t.render(E),G&&(this.isFirstRender=!1)}};tu.defaultWindow=u5;tu.defaultFetch=h5;({defaultFetch:sD}=tu),oD=typeof DOMParser<"u"?DOMParser:null,$u=class{constructor(){var{fetch:t=sD,DOMParser:e=oD}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fetch=t,this.DOMParser=e}parse(t){var e=this;return bl(function*(){return t.startsWith("<")?e.parseFromString(t):e.load(t)})()}parseFromString(t){var e=new this.DOMParser;try{return this.checkDocument(e.parseFromString(t,"image/svg+xml"))}catch{return this.checkDocument(e.parseFromString(t,"text/xml"))}}checkDocument(t){var e=t.getElementsByTagName("parsererror")[0];if(e)throw new Error(e.textContent);return t}load(t){var e=this;return bl(function*(){var o=yield e.fetch(t),l=yield o.text();return e.parseFromString(l)})()}},$p=class{constructor(t,e){this.type="translate",this.point=null,this.point=xn.parse(e)}apply(t){var{x:e,y:o}=this.point;t.translate(e||0,o||0)}unapply(t){var{x:e,y:o}=this.point;t.translate(-1*e||0,-1*o||0)}applyToPoint(t){var{x:e,y:o}=this.point;t.applyTransform([1,0,0,1,e||0,o||0])}},tf=class{constructor(t,e,o){this.type="rotate",this.angle=null,this.originX=null,this.originY=null,this.cx=0,this.cy=0;var l=Jo(e);this.angle=new Di(t,"angle",l[0]),this.originX=o[0],this.originY=o[1],this.cx=l[1]||0,this.cy=l[2]||0}apply(t){var{cx:e,cy:o,originX:l,originY:n,angle:g}=this,h=e+l.getPixels("x"),m=o+n.getPixels("y");t.translate(h,m),t.rotate(g.getRadians()),t.translate(-h,-m)}unapply(t){var{cx:e,cy:o,originX:l,originY:n,angle:g}=this,h=e+l.getPixels("x"),m=o+n.getPixels("y");t.translate(h,m),t.rotate(-1*g.getRadians()),t.translate(-h,-m)}applyToPoint(t){var{cx:e,cy:o,angle:l}=this,n=l.getRadians();t.applyTransform([1,0,0,1,e||0,o||0]),t.applyTransform([Math.cos(n),Math.sin(n),-Math.sin(n),Math.cos(n),0,0]),t.applyTransform([1,0,0,1,-e||0,-o||0])}},ef=class{constructor(t,e,o){this.type="scale",this.scale=null,this.originX=null,this.originY=null;var l=xn.parseScale(e);(l.x===0||l.y===0)&&(l.x=jc,l.y=jc),this.scale=l,this.originX=o[0],this.originY=o[1]}apply(t){var{scale:{x:e,y:o},originX:l,originY:n}=this,g=l.getPixels("x"),h=n.getPixels("y");t.translate(g,h),t.scale(e,o||e),t.translate(-g,-h)}unapply(t){var{scale:{x:e,y:o},originX:l,originY:n}=this,g=l.getPixels("x"),h=n.getPixels("y");t.translate(g,h),t.scale(1/e,1/o||e),t.translate(-g,-h)}applyToPoint(t){var{x:e,y:o}=this.scale;t.applyTransform([e||0,0,0,o||0,0,0])}},Tg=class{constructor(t,e,o){this.type="matrix",this.matrix=[],this.originX=null,this.originY=null,this.matrix=Jo(e),this.originX=o[0],this.originY=o[1]}apply(t){var{originX:e,originY:o,matrix:l}=this,n=e.getPixels("x"),g=o.getPixels("y");t.translate(n,g),t.transform(l[0],l[1],l[2],l[3],l[4],l[5]),t.translate(-n,-g)}unapply(t){var{originX:e,originY:o,matrix:l}=this,n=l[0],g=l[2],h=l[4],m=l[1],B=l[3],_=l[5],E=0,G=0,S=1,O=1/(n*(B*S-_*G)-g*(m*S-_*E)+h*(m*G-B*E)),P=e.getPixels("x"),tt=o.getPixels("y");t.translate(P,tt),t.transform(O*(B*S-_*G),O*(_*E-m*S),O*(h*G-g*S),O*(n*S-h*E),O*(g*_-h*B),O*(h*m-n*_)),t.translate(-P,-tt)}applyToPoint(t){t.applyTransform(this.matrix)}},Qg=class extends Tg{constructor(t,e,o){super(t,e,o),this.type="skew",this.angle=null,this.angle=new Di(t,"angle",e)}},rf=class extends Qg{constructor(t,e,o){super(t,e,o),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}},nf=class extends Qg{constructor(t,e,o){super(t,e,o),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}};PA=class{constructor(t,e,o){this.document=t,this.transforms=[];var l=aD(e);l.forEach(n=>{if(n!=="none"){var[g,h]=AD(n),m=PA.transformTypes[g];typeof m<"u"&&this.transforms.push(new m(this.document,h,o))}})}static fromElement(t,e){var o=e.getStyle("transform",!1,!0),[l,n=l]=e.getStyle("transform-origin",!1,!0).split(),g=[l,n];return o.hasValue()?new PA(t,o.getString(),g):null}apply(t){for(var{transforms:e}=this,o=e.length,l=0;l<o;l++)e[l].apply(t)}unapply(t){for(var{transforms:e}=this,o=e.length,l=o-1;l>=0;l--)e[l].unapply(t)}applyToPoint(t){for(var{transforms:e}=this,o=e.length,l=0;l<o;l++)e[l].applyToPoint(t)}};PA.transformTypes={translate:$p,rotate:tf,scale:ef,matrix:Tg,skewX:rf,skewY:nf};an=class{constructor(t,e){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.document=t,this.node=e,this.captureTextNodes=o,this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!(!e||e.nodeType!==1)){if(Array.from(e.attributes).forEach(h=>{var m=A5(h.nodeName);this.attributes[m]=new Di(t,m,h.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()){var l=this.getAttribute("style").getString().split(";").map(h=>h.trim());l.forEach(h=>{if(h){var[m,B]=h.split(":").map(_=>_.trim());this.styles[m]=new Di(t,m,B)}})}var{definitions:n}=t,g=this.getAttribute("id");g.hasValue()&&(n[g.getString()]||(n[g.getString()]=this)),Array.from(e.childNodes).forEach(h=>{if(h.nodeType===1)this.addChild(h);else if(o&&(h.nodeType===3||h.nodeType===4)){var m=t.createTextNode(h);m.getText().length>0&&this.addChild(m)}})}}getAttribute(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.attributes[t];if(!o&&e){var l=new Di(this.document,t,"");return this.attributes[t]=l,l}return o||Di.empty(this.document)}getHrefAttribute(){for(var t in this.attributes)if(t==="href"||t.endsWith(":href"))return this.attributes[t];return Di.empty(this.document)}getStyle(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=this.styles[t];if(l)return l;var n=this.getAttribute(t);if(n!=null&&n.hasValue())return this.styles[t]=n,n;if(!o){var{parent:g}=this;if(g){var h=g.getStyle(t);if(h!=null&&h.hasValue())return h}}if(e){var m=new Di(this.document,t,"");return this.styles[t]=m,m}return l||Di.empty(this.document)}render(t){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(t.save(),this.getStyle("mask").hasValue()){var e=this.getStyle("mask").getDefinition();e&&(this.applyEffects(t),e.apply(t,this))}else if(this.getStyle("filter").getValue("none")!=="none"){var o=this.getStyle("filter").getDefinition();o&&(this.applyEffects(t),o.apply(t,this))}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}}setContext(t){}applyEffects(t){var e=PA.fromElement(this.document,this);e&&e.apply(t);var o=this.getStyle("clip-path",!1,!0);if(o.hasValue()){var l=o.getDefinition();l&&l.apply(t)}}clearContext(t){}renderChildren(t){this.children.forEach(e=>{e.render(t)})}addChild(t){var e=t instanceof an?t:this.document.createElement(t);e.parent=this,an.ignoreChildTypes.includes(e.type)||this.children.push(e)}matchesSelector(t){var e,{node:o}=this;if(typeof o.matches=="function")return o.matches(t);var l=(e=o.getAttribute)===null||e===void 0?void 0:e.call(o,"class");return!l||l===""?!1:l.split(" ").some(n=>".".concat(n)===t)}addStylesFromStyleDefinition(){var{styles:t,stylesSpecificity:e}=this.document;for(var o in t)if(!o.startsWith("@")&&this.matchesSelector(o)){var l=t[o],n=e[o];if(l)for(var g in l){var h=this.stylesSpecificity[g];typeof h>"u"&&(h="000"),n>=h&&(this.styles[g]=l[g],this.stylesSpecificity[g]=n)}}}removeStyles(t,e){var o=e.reduce((l,n)=>{var g=t.getStyle(n);if(!g.hasValue())return l;var h=g.getString();return g.setValue(""),[...l,[n,h]]},[]);return o}restoreStyles(t,e){e.forEach(o=>{var[l,n]=o;t.getStyle(l,!0).setValue(n)})}isFirstChild(){var t;return((t=this.parent)===null||t===void 0?void 0:t.children.indexOf(this))===0}};an.ignoreChildTypes=["title"];sf=class extends an{constructor(t,e,o){super(t,e,o)}};Es=class{constructor(t,e,o,l,n,g){var h=g?typeof g=="string"?Es.parse(g):g:{};this.fontFamily=n||h.fontFamily,this.fontSize=l||h.fontSize,this.fontStyle=t||h.fontStyle,this.fontWeight=o||h.fontWeight,this.fontVariant=e||h.fontVariant}static parse(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,o="",l="",n="",g="",h="",m=Au(t).trim().split(" "),B={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return m.forEach(_=>{switch(!0){case(!B.fontStyle&&Es.styles.includes(_)):_!=="inherit"&&(o=_),B.fontStyle=!0;break;case(!B.fontVariant&&Es.variants.includes(_)):_!=="inherit"&&(l=_),B.fontStyle=!0,B.fontVariant=!0;break;case(!B.fontWeight&&Es.weights.includes(_)):_!=="inherit"&&(n=_),B.fontStyle=!0,B.fontVariant=!0,B.fontWeight=!0;break;case!B.fontSize:_!=="inherit"&&([g]=_.split("/")),B.fontStyle=!0,B.fontVariant=!0,B.fontWeight=!0,B.fontSize=!0;break;default:_!=="inherit"&&(h+=_)}}),new Es(o,l,n,g,h,e)}toString(){return[uD(this.fontStyle),this.fontVariant,hD(this.fontWeight),this.fontSize,cD(this.fontFamily)].join(" ").trim()}};Es.styles="normal|italic|oblique|inherit";Es.variants="normal|small-caps|inherit";Es.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";Xo=class{constructor(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.NaN,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.NaN,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Number.NaN,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Number.NaN;this.x1=t,this.y1=e,this.x2=o,this.y2=l,this.addPoint(t,e),this.addPoint(o,l)}get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(t,e){typeof t<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),typeof e<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))}addX(t){this.addPoint(t,null)}addY(t){this.addPoint(null,t)}addBoundingBox(t){if(t){var{x1:e,y1:o,x2:l,y2:n}=t;this.addPoint(e,o),this.addPoint(l,n)}}sumCubic(t,e,o,l,n){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*o+3*(1-t)*Math.pow(t,2)*l+Math.pow(t,3)*n}bezierCurveAdd(t,e,o,l,n){var g=6*e-12*o+6*l,h=-3*e+9*o-9*l+3*n,m=3*o-3*e;if(h===0){if(g===0)return;var B=-m/g;0<B&&B<1&&(t?this.addX(this.sumCubic(B,e,o,l,n)):this.addY(this.sumCubic(B,e,o,l,n)));return}var _=Math.pow(g,2)-4*m*h;if(!(_<0)){var E=(-g+Math.sqrt(_))/(2*h);0<E&&E<1&&(t?this.addX(this.sumCubic(E,e,o,l,n)):this.addY(this.sumCubic(E,e,o,l,n)));var G=(-g-Math.sqrt(_))/(2*h);0<G&&G<1&&(t?this.addX(this.sumCubic(G,e,o,l,n)):this.addY(this.sumCubic(G,e,o,l,n)))}}addBezierCurve(t,e,o,l,n,g,h,m){this.addPoint(t,e),this.addPoint(h,m),this.bezierCurveAdd(!0,t,o,n,h),this.bezierCurveAdd(!1,e,l,g,m)}addQuadraticCurve(t,e,o,l,n,g){var h=t+.6666666666666666*(o-t),m=e+2/3*(l-e),B=h+1/3*(n-t),_=m+1/3*(g-e);this.addBezierCurve(t,e,h,B,m,_,n,g)}isPointInBox(t,e){var{x1:o,y1:l,x2:n,y2:g}=this;return o<=t&&t<=n&&l<=e&&e<=g}},ur=class extends Xe{constructor(t){super(t.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=null,this.start=null,this.current=null,this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new xn(0,0),this.control=new xn(0,0),this.current=new xn(0,0),this.points=[],this.angles=[]}isEnd(){var{i:t,commands:e}=this;return t>=e.length-1}next(){var t=this.commands[++this.i];return this.previousCommand=this.command,this.command=t,t}getPoint(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y",o=new xn(this.command[t],this.command[e]);return this.makeAbsolute(o)}getAsControlPoint(t,e){var o=this.getPoint(t,e);return this.control=o,o}getAsCurrentPoint(t,e){var o=this.getPoint(t,e);return this.current=o,o}getReflectedControlPoint(){var t=this.previousCommand.type;if(t!==Xe.CURVE_TO&&t!==Xe.SMOOTH_CURVE_TO&&t!==Xe.QUAD_TO&&t!==Xe.SMOOTH_QUAD_TO)return this.current;var{current:{x:e,y:o},control:{x:l,y:n}}=this,g=new xn(2*e-l,2*o-n);return g}makeAbsolute(t){if(this.command.relative){var{x:e,y:o}=this.current;t.x+=e,t.y+=o}return t}addMarker(t,e,o){var{points:l,angles:n}=this;o&&n.length>0&&!n[n.length-1]&&(n[n.length-1]=l[l.length-1].angleTo(o)),this.addMarkerAngle(t,e?e.angleTo(t):null)}addMarkerAngle(t,e){this.points.push(t),this.angles.push(e)}getMarkerPoints(){return this.points}getMarkerAngles(){for(var{angles:t}=this,e=t.length,o=0;o<e;o++)if(!t[o]){for(var l=o+1;l<e;l++)if(t[l]){t[o]=t[l];break}}return t}},MA=class extends an{constructor(){super(...arguments),this.modifiedEmSizeStack=!1}calculateOpacity(){for(var t=1,e=this;e;){var o=e.getStyle("opacity",!1,!0);o.hasValue(!0)&&(t*=o.getNumber()),e=e.parent}return t}setContext(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e){var o=this.getStyle("fill"),l=this.getStyle("fill-opacity"),n=this.getStyle("stroke"),g=this.getStyle("stroke-opacity");if(o.isUrlDefinition()){var h=o.getFillStyleDefinition(this,l);h&&(t.fillStyle=h)}else if(o.hasValue()){o.getString()==="currentColor"&&o.setValue(this.getStyle("color").getColor());var m=o.getColor();m!=="inherit"&&(t.fillStyle=m==="none"?"rgba(0,0,0,0)":m)}if(l.hasValue()){var B=new Di(this.document,"fill",t.fillStyle).addOpacity(l).getColor();t.fillStyle=B}if(n.isUrlDefinition()){var _=n.getFillStyleDefinition(this,g);_&&(t.strokeStyle=_)}else if(n.hasValue()){n.getString()==="currentColor"&&n.setValue(this.getStyle("color").getColor());var E=n.getString();E!=="inherit"&&(t.strokeStyle=E==="none"?"rgba(0,0,0,0)":E)}if(g.hasValue()){var G=new Di(this.document,"stroke",t.strokeStyle).addOpacity(g).getString();t.strokeStyle=G}var S=this.getStyle("stroke-width");if(S.hasValue()){var O=S.getPixels();t.lineWidth=O||jc}var P=this.getStyle("stroke-linecap"),tt=this.getStyle("stroke-linejoin"),z=this.getStyle("stroke-miterlimit"),rt=this.getStyle("stroke-dasharray"),ct=this.getStyle("stroke-dashoffset");if(P.hasValue()&&(t.lineCap=P.getString()),tt.hasValue()&&(t.lineJoin=tt.getString()),z.hasValue()&&(t.miterLimit=z.getNumber()),rt.hasValue()&&rt.getString()!=="none"){var Et=Jo(rt.getString());typeof t.setLineDash<"u"?t.setLineDash(Et):typeof t.webkitLineDash<"u"?t.webkitLineDash=Et:typeof t.mozDash<"u"&&!(Et.length===1&&Et[0]===0)&&(t.mozDash=Et);var Pt=ct.getPixels();typeof t.lineDashOffset<"u"?t.lineDashOffset=Pt:typeof t.webkitLineDashOffset<"u"?t.webkitLineDashOffset=Pt:typeof t.mozDashOffset<"u"&&(t.mozDashOffset=Pt)}}if(this.modifiedEmSizeStack=!1,typeof t.font<"u"){var Qt=this.getStyle("font"),Ut=this.getStyle("font-style"),dt=this.getStyle("font-variant"),ee=this.getStyle("font-weight"),oe=this.getStyle("font-size"),ht=this.getStyle("font-family"),At=new Es(Ut.getString(),dt.getString(),ee.getString(),oe.hasValue()?"".concat(oe.getPixels(!0),"px"):"",ht.getString(),Es.parse(Qt.getString(),t.font));Ut.setValue(At.fontStyle),dt.setValue(At.fontVariant),ee.setValue(At.fontWeight),oe.setValue(At.fontSize),ht.setValue(At.fontFamily),t.font=At.toString(),oe.isPixels()&&(this.document.emSize=oe.getPixels(),this.modifiedEmSizeStack=!0)}e||(this.applyEffects(t),t.globalAlpha=this.calculateOpacity())}clearContext(t){super.clearContext(t),this.modifiedEmSizeStack&&this.document.popEmSize()}},Dr=class extends MA{constructor(t,e,o){super(t,e,o),this.type="path",this.pathParser=null,this.pathParser=new ur(this.getAttribute("d").getString())}path(t){var{pathParser:e}=this,o=new Xo;for(e.reset(),t&&t.beginPath();!e.isEnd();)switch(e.next().type){case ur.MOVE_TO:this.pathM(t,o);break;case ur.LINE_TO:this.pathL(t,o);break;case ur.HORIZ_LINE_TO:this.pathH(t,o);break;case ur.VERT_LINE_TO:this.pathV(t,o);break;case ur.CURVE_TO:this.pathC(t,o);break;case ur.SMOOTH_CURVE_TO:this.pathS(t,o);break;case ur.QUAD_TO:this.pathQ(t,o);break;case ur.SMOOTH_QUAD_TO:this.pathT(t,o);break;case ur.ARC:this.pathA(t,o);break;case ur.CLOSE_PATH:this.pathZ(t,o);break}return o}getBoundingBox(t){return this.path()}getMarkers(){var{pathParser:t}=this,e=t.getMarkerPoints(),o=t.getMarkerAngles(),l=e.map((n,g)=>[n,o[g]]);return l}renderChildren(t){this.path(t),this.document.screen.mouse.checkPath(this,t);var e=this.getStyle("fill-rule");t.fillStyle!==""&&(e.getString("inherit")!=="inherit"?t.fill(e.getString()):t.fill()),t.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(t.save(),t.setTransform(1,0,0,1,0,0),t.stroke(),t.restore()):t.stroke());var o=this.getMarkers();if(o){var l=o.length-1,n=this.getStyle("marker-start"),g=this.getStyle("marker-mid"),h=this.getStyle("marker-end");if(n.isUrlDefinition()){var m=n.getDefinition(),[B,_]=o[0];m.render(t,B,_)}if(g.isUrlDefinition())for(var E=g.getDefinition(),G=1;G<l;G++){var[S,O]=o[G];E.render(t,S,O)}if(h.isUrlDefinition()){var P=h.getDefinition(),[tt,z]=o[l];P.render(t,tt,z)}}}static pathM(t){var e=t.getAsCurrentPoint();return t.start=t.current,{point:e}}pathM(t,e){var{pathParser:o}=this,{point:l}=Dr.pathM(o),{x:n,y:g}=l;o.addMarker(l),e.addPoint(n,g),t&&t.moveTo(n,g)}static pathL(t){var{current:e}=t,o=t.getAsCurrentPoint();return{current:e,point:o}}pathL(t,e){var{pathParser:o}=this,{current:l,point:n}=Dr.pathL(o),{x:g,y:h}=n;o.addMarker(n,l),e.addPoint(g,h),t&&t.lineTo(g,h)}static pathH(t){var{current:e,command:o}=t,l=new xn((o.relative?e.x:0)+o.x,e.y);return t.current=l,{current:e,point:l}}pathH(t,e){var{pathParser:o}=this,{current:l,point:n}=Dr.pathH(o),{x:g,y:h}=n;o.addMarker(n,l),e.addPoint(g,h),t&&t.lineTo(g,h)}static pathV(t){var{current:e,command:o}=t,l=new xn(e.x,(o.relative?e.y:0)+o.y);return t.current=l,{current:e,point:l}}pathV(t,e){var{pathParser:o}=this,{current:l,point:n}=Dr.pathV(o),{x:g,y:h}=n;o.addMarker(n,l),e.addPoint(g,h),t&&t.lineTo(g,h)}static pathC(t){var{current:e}=t,o=t.getPoint("x1","y1"),l=t.getAsControlPoint("x2","y2"),n=t.getAsCurrentPoint();return{current:e,point:o,controlPoint:l,currentPoint:n}}pathC(t,e){var{pathParser:o}=this,{current:l,point:n,controlPoint:g,currentPoint:h}=Dr.pathC(o);o.addMarker(h,g,n),e.addBezierCurve(l.x,l.y,n.x,n.y,g.x,g.y,h.x,h.y),t&&t.bezierCurveTo(n.x,n.y,g.x,g.y,h.x,h.y)}static pathS(t){var{current:e}=t,o=t.getReflectedControlPoint(),l=t.getAsControlPoint("x2","y2"),n=t.getAsCurrentPoint();return{current:e,point:o,controlPoint:l,currentPoint:n}}pathS(t,e){var{pathParser:o}=this,{current:l,point:n,controlPoint:g,currentPoint:h}=Dr.pathS(o);o.addMarker(h,g,n),e.addBezierCurve(l.x,l.y,n.x,n.y,g.x,g.y,h.x,h.y),t&&t.bezierCurveTo(n.x,n.y,g.x,g.y,h.x,h.y)}static pathQ(t){var{current:e}=t,o=t.getAsControlPoint("x1","y1"),l=t.getAsCurrentPoint();return{current:e,controlPoint:o,currentPoint:l}}pathQ(t,e){var{pathParser:o}=this,{current:l,controlPoint:n,currentPoint:g}=Dr.pathQ(o);o.addMarker(g,n,n),e.addQuadraticCurve(l.x,l.y,n.x,n.y,g.x,g.y),t&&t.quadraticCurveTo(n.x,n.y,g.x,g.y)}static pathT(t){var{current:e}=t,o=t.getReflectedControlPoint();t.control=o;var l=t.getAsCurrentPoint();return{current:e,controlPoint:o,currentPoint:l}}pathT(t,e){var{pathParser:o}=this,{current:l,controlPoint:n,currentPoint:g}=Dr.pathT(o);o.addMarker(g,n,n),e.addQuadraticCurve(l.x,l.y,n.x,n.y,g.x,g.y),t&&t.quadraticCurveTo(n.x,n.y,g.x,g.y)}static pathA(t){var{current:e,command:o}=t,{rX:l,rY:n,xRot:g,lArcFlag:h,sweepFlag:m}=o,B=g*(Math.PI/180),_=t.getAsCurrentPoint(),E=new xn(Math.cos(B)*(e.x-_.x)/2+Math.sin(B)*(e.y-_.y)/2,-Math.sin(B)*(e.x-_.x)/2+Math.cos(B)*(e.y-_.y)/2),G=Math.pow(E.x,2)/Math.pow(l,2)+Math.pow(E.y,2)/Math.pow(n,2);G>1&&(l*=Math.sqrt(G),n*=Math.sqrt(G));var S=(h===m?-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(n,2)-Math.pow(l,2)*Math.pow(E.y,2)-Math.pow(n,2)*Math.pow(E.x,2))/(Math.pow(l,2)*Math.pow(E.y,2)+Math.pow(n,2)*Math.pow(E.x,2)));isNaN(S)&&(S=0);var O=new xn(S*l*E.y/n,S*-n*E.x/l),P=new xn((e.x+_.x)/2+Math.cos(B)*O.x-Math.sin(B)*O.y,(e.y+_.y)/2+Math.sin(B)*O.x+Math.cos(B)*O.y),tt=EI([1,0],[(E.x-O.x)/l,(E.y-O.y)/n]),z=[(E.x-O.x)/l,(E.y-O.y)/n],rt=[(-E.x-O.x)/l,(-E.y-O.y)/n],ct=EI(z,rt);return Yp(z,rt)<=-1&&(ct=Math.PI),Yp(z,rt)>=1&&(ct=0),{currentPoint:_,rX:l,rY:n,sweepFlag:m,xAxisRotation:B,centp:P,a1:tt,ad:ct}}pathA(t,e){var{pathParser:o}=this,{currentPoint:l,rX:n,rY:g,sweepFlag:h,xAxisRotation:m,centp:B,a1:_,ad:E}=Dr.pathA(o),G=1-h?1:-1,S=_+G*(E/2),O=new xn(B.x+n*Math.cos(S),B.y+g*Math.sin(S));if(o.addMarkerAngle(O,S-G*Math.PI/2),o.addMarkerAngle(l,S-G*Math.PI),e.addPoint(l.x,l.y),t&&!isNaN(_)&&!isNaN(E)){var P=n>g?n:g,tt=n>g?1:n/g,z=n>g?g/n:1;t.translate(B.x,B.y),t.rotate(m),t.scale(tt,z),t.arc(0,0,P,_,_+E,!!(1-h)),t.scale(1/tt,1/z),t.rotate(-m),t.translate(-B.x,-B.y)}}static pathZ(t){t.current=t.start}pathZ(t,e){Dr.pathZ(this.pathParser),t&&e.x1!==e.x2&&e.y1!==e.y2&&t.closePath()}},Ug=class extends Dr{constructor(t,e,o){super(t,e,o),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}},dA=class extends MA{constructor(t,e,o){super(t,e,new.target===dA?!0:o),this.type="text",this.x=0,this.y=0,this.measureCache=-1}setContext(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(t,e);var o=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();o&&(t.textBaseline=o)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(t){if(this.type!=="text")return this.getTElementBoundingBox(t);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t);var e=null;return this.children.forEach((o,l)=>{var n=this.getChildBoundingBox(t,this,this,l);e?e.addBoundingBox(n):e=n}),e}getFontSize(){var{document:t,parent:e}=this,o=Es.parse(t.ctx.font).fontSize,l=e.getStyle("font-size").getNumber(o);return l}getTElementBoundingBox(t){var e=this.getFontSize();return new Xo(this.x,this.y-e,this.x+this.measureText(t),this.y)}getGlyph(t,e,o){var l=e[o],n=null;if(t.isArabic){var g=e.length,h=e[o-1],m=e[o+1],B="isolated";if((o===0||h===" ")&&o<g-1&&m!==" "&&(B="terminal"),o>0&&h!==" "&&o<g-1&&m!==" "&&(B="medial"),o>0&&h!==" "&&(o===g-1||m===" ")&&(B="initial"),typeof t.glyphs[l]<"u"){var _=t.glyphs[l];n=_ instanceof Ug?_:_[B]}}else n=t.glyphs[l];return n||(n=t.missingGlyph),n}getText(){return""}getTextFromNode(t){var e=t||this.node,o=Array.from(e.parentNode.childNodes),l=o.indexOf(e),n=o.length-1,g=Au(e.textContent||"");return l===0&&(g=o5(g)),l===n&&(g=a5(g)),g}renderChildren(t){if(this.type!=="text"){this.renderTElementChildren(t);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(t),this.children.forEach((o,l)=>{this.renderChild(t,this,this,l)});var{mouse:e}=this.document.screen;e.isWorking()&&e.checkBoundingBox(this,this.getBoundingBox(t))}renderTElementChildren(t){var{document:e,parent:o}=this,l=this.getText(),n=o.getStyle("font-family").getDefinition();if(n){for(var{unitsPerEm:g}=n.fontFace,h=Es.parse(e.ctx.font),m=o.getStyle("font-size").getNumber(h.fontSize),B=o.getStyle("font-style").getString(h.fontStyle),_=m/g,E=n.isRTL?l.split("").reverse().join(""):l,G=Jo(o.getAttribute("dx").getString()),S=E.length,O=0;O<S;O++){var P=this.getGlyph(n,E,O);t.translate(this.x,this.y),t.scale(_,-_);var tt=t.lineWidth;t.lineWidth=t.lineWidth*g/m,B==="italic"&&t.transform(1,0,.4,1,0,0),P.render(t),B==="italic"&&t.transform(1,0,-.4,1,0,0),t.lineWidth=tt,t.scale(1/_,-1/_),t.translate(-this.x,-this.y),this.x+=m*(P.horizAdvX||n.horizAdvX)/g,typeof G[O]<"u"&&!isNaN(G[O])&&(this.x+=G[O])}return}var{x:z,y:rt}=this;t.fillStyle&&t.fillText(l,z,rt),t.strokeStyle&&t.strokeText(l,z,rt)}applyAnchoring(){if(!(this.textChunkStart>=this.leafTexts.length)){var t=this.leafTexts[this.textChunkStart],e=t.getStyle("text-anchor").getString("start"),o=!1,l=0;e==="start"&&!o||e==="end"&&o?l=t.x-this.minX:e==="end"&&!o||e==="start"&&o?l=t.x-this.maxX:l=t.x-(this.minX+this.maxX)/2;for(var n=this.textChunkStart;n<this.leafTexts.length;n++)this.leafTexts[n].x+=l;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}}adjustChildCoordinatesRecursive(t){this.children.forEach((e,o)=>{this.adjustChildCoordinatesRecursiveCore(t,this,this,o)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(t,e,o,l){var n=o.children[l];n.children.length>0?n.children.forEach((g,h)=>{e.adjustChildCoordinatesRecursiveCore(t,e,n,h)}):this.adjustChildCoordinates(t,e,o,l)}adjustChildCoordinates(t,e,o,l){var n=o.children[l];if(typeof n.measureText!="function")return n;t.save(),n.setContext(t,!0);var g=n.getAttribute("x"),h=n.getAttribute("y"),m=n.getAttribute("dx"),B=n.getAttribute("dy"),_=n.getStyle("font-family").getDefinition(),E=!!_&&_.isRTL;l===0&&(g.hasValue()||g.setValue(n.getInheritedAttribute("x")),h.hasValue()||h.setValue(n.getInheritedAttribute("y")),m.hasValue()||m.setValue(n.getInheritedAttribute("dx")),B.hasValue()||B.setValue(n.getInheritedAttribute("dy")));var G=n.measureText(t);return E&&(e.x-=G),g.hasValue()?(e.applyAnchoring(),n.x=g.getPixels("x"),m.hasValue()&&(n.x+=m.getPixels("x"))):(m.hasValue()&&(e.x+=m.getPixels("x")),n.x=e.x),e.x=n.x,E||(e.x+=G),h.hasValue()?(n.y=h.getPixels("y"),B.hasValue()&&(n.y+=B.getPixels("y"))):(B.hasValue()&&(e.y+=B.getPixels("y")),n.y=e.y),e.y=n.y,e.leafTexts.push(n),e.minX=Math.min(e.minX,n.x,n.x+G),e.maxX=Math.max(e.maxX,n.x,n.x+G),n.clearContext(t),t.restore(),n}getChildBoundingBox(t,e,o,l){var n=o.children[l];if(typeof n.getBoundingBox!="function")return null;var g=n.getBoundingBox(t);return g?(n.children.forEach((h,m)=>{var B=e.getChildBoundingBox(t,e,n,m);g.addBoundingBox(B)}),g):null}renderChild(t,e,o,l){var n=o.children[l];n.render(t),n.children.forEach((g,h)=>{e.renderChild(t,e,n,h)})}measureText(t){var{measureCache:e}=this;if(~e)return e;var o=this.getText(),l=this.measureTargetText(t,o);return this.measureCache=l,l}measureTargetText(t,e){if(!e.length)return 0;var{parent:o}=this,l=o.getStyle("font-family").getDefinition();if(l){for(var n=this.getFontSize(),g=l.isRTL?e.split("").reverse().join(""):e,h=Jo(o.getAttribute("dx").getString()),m=g.length,B=0,_=0;_<m;_++){var E=this.getGlyph(l,g,_);B+=(E.horizAdvX||l.horizAdvX)*n/l.fontFace.unitsPerEm,typeof h[_]<"u"&&!isNaN(h[_])&&(B+=h[_])}return B}if(!t.measureText)return e.length*10;t.save(),this.setContext(t,!0);var{width:G}=t.measureText(e);return this.clearContext(t),t.restore(),G}getInheritedAttribute(t){for(var e=this;e instanceof dA&&e.isFirstChild();){var o=e.parent.getAttribute(t);if(o.hasValue(!0))return o.getValue("0");e=e.parent}return null}},eu=class extends dA{constructor(t,e,o){super(t,e,new.target===eu?!0:o),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}getText(){return this.text}},NI=class extends eu{constructor(){super(...arguments),this.type="textNode"}},hc=class extends MA{constructor(){super(...arguments),this.type="svg",this.root=!1}setContext(t){var e,{document:o}=this,{screen:l,window:n}=o,g=t.canvas;if(l.setDefaults(t),g.style&&typeof t.font<"u"&&n&&typeof n.getComputedStyle<"u"){t.font=n.getComputedStyle(g).getPropertyValue("font");var h=new Di(o,"fontSize",Es.parse(t.font).fontSize);h.hasValue()&&(o.rootEmSize=h.getPixels("y"),o.emSize=o.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);var{width:m,height:B}=l.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");var _=this.getAttribute("refX"),E=this.getAttribute("refY"),G=this.getAttribute("viewBox"),S=G.hasValue()?Jo(G.getString()):null,O=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible",P=0,tt=0,z=0,rt=0;S&&(P=S[0],tt=S[1]),this.root||(m=this.getStyle("width").getPixels("x"),B=this.getStyle("height").getPixels("y"),this.type==="marker"&&(z=P,rt=tt,P=0,tt=0)),l.viewPort.setCurrent(m,B),this.node&&(!this.parent||((e=this.node.parentNode)===null||e===void 0?void 0:e.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(t),t.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),S&&(m=S[2],B=S[3]),o.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:l.viewPort.width,desiredWidth:m,height:l.viewPort.height,desiredHeight:B,minX:P,minY:tt,refX:_.getValue(),refY:E.getValue(),clip:O,clipX:z,clipY:rt}),S&&(l.viewPort.removeCurrent(),l.viewPort.setCurrent(m,B))}clearContext(t){super.clearContext(t),this.document.screen.viewPort.removeCurrent()}resize(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=this.getAttribute("width",!0),n=this.getAttribute("height",!0),g=this.getAttribute("viewBox"),h=this.getAttribute("style"),m=l.getNumber(0),B=n.getNumber(0);if(o)if(typeof o=="string")this.getAttribute("preserveAspectRatio",!0).setValue(o);else{var _=this.getAttribute("preserveAspectRatio");_.hasValue()&&_.setValue(_.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(l.setValue(t),n.setValue(e),g.hasValue()||g.setValue("0 0 ".concat(m||t," ").concat(B||e)),h.hasValue()){var E=this.getStyle("width"),G=this.getStyle("height");E.hasValue()&&E.setValue("".concat(t,"px")),G.hasValue()&&G.setValue("".concat(e,"px"))}}},Gg=class extends Dr{constructor(){super(...arguments),this.type="rect"}path(t){var e=this.getAttribute("x").getPixels("x"),o=this.getAttribute("y").getPixels("y"),l=this.getStyle("width",!1,!0).getPixels("x"),n=this.getStyle("height",!1,!0).getPixels("y"),g=this.getAttribute("rx"),h=this.getAttribute("ry"),m=g.getPixels("x"),B=h.getPixels("y");if(g.hasValue()&&!h.hasValue()&&(B=m),h.hasValue()&&!g.hasValue()&&(m=B),m=Math.min(m,l/2),B=Math.min(B,n/2),t){var _=4*((Math.sqrt(2)-1)/3);t.beginPath(),n>0&&l>0&&(t.moveTo(e+m,o),t.lineTo(e+l-m,o),t.bezierCurveTo(e+l-m+_*m,o,e+l,o+B-_*B,e+l,o+B),t.lineTo(e+l,o+n-B),t.bezierCurveTo(e+l,o+n-B+_*B,e+l-m+_*m,o+n,e+l-m,o+n),t.lineTo(e+m,o+n),t.bezierCurveTo(e+m-_*m,o+n,e,o+n-B+_*B,e,o+n-B),t.lineTo(e,o+B),t.bezierCurveTo(e,o+B-_*B,e+m-_*m,o,e+m,o),t.closePath())}return new Xo(e,o,e+l,o+n)}getMarkers(){return null}},of=class extends Dr{constructor(){super(...arguments),this.type="circle"}path(t){var e=this.getAttribute("cx").getPixels("x"),o=this.getAttribute("cy").getPixels("y"),l=this.getAttribute("r").getPixels();return t&&l>0&&(t.beginPath(),t.arc(e,o,l,0,Math.PI*2,!1),t.closePath()),new Xo(e-l,o-l,e+l,o+l)}getMarkers(){return null}},af=class extends Dr{constructor(){super(...arguments),this.type="ellipse"}path(t){var e=4*((Math.sqrt(2)-1)/3),o=this.getAttribute("rx").getPixels("x"),l=this.getAttribute("ry").getPixels("y"),n=this.getAttribute("cx").getPixels("x"),g=this.getAttribute("cy").getPixels("y");return t&&o>0&&l>0&&(t.beginPath(),t.moveTo(n+o,g),t.bezierCurveTo(n+o,g+e*l,n+e*o,g+l,n,g+l),t.bezierCurveTo(n-e*o,g+l,n-o,g+e*l,n-o,g),t.bezierCurveTo(n-o,g-e*l,n-e*o,g-l,n,g-l),t.bezierCurveTo(n+e*o,g-l,n+o,g-e*l,n+o,g),t.closePath()),new Xo(n-o,g-l,n+o,g+l)}getMarkers(){return null}},Af=class extends Dr{constructor(){super(...arguments),this.type="line"}getPoints(){return[new xn(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new xn(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(t){var[{x:e,y:o},{x:l,y:n}]=this.getPoints();return t&&(t.beginPath(),t.moveTo(e,o),t.lineTo(l,n)),new Xo(e,o,l,n)}getMarkers(){var[t,e]=this.getPoints(),o=t.angleTo(e);return[[t,o],[e,o]]}},Rg=class extends Dr{constructor(t,e,o){super(t,e,o),this.type="polyline",this.points=[],this.points=xn.parsePath(this.getAttribute("points").getString())}path(t){var{points:e}=this,[{x:o,y:l}]=e,n=new Xo(o,l);return t&&(t.beginPath(),t.moveTo(o,l)),e.forEach(g=>{var{x:h,y:m}=g;n.addPoint(h,m),t&&t.lineTo(h,m)}),n}getMarkers(){var{points:t}=this,e=t.length-1,o=[];return t.forEach((l,n)=>{n!==e&&o.push([l,l.angleTo(t[n+1])])}),o.length>0&&o.push([t[t.length-1],o[o.length-1][1]]),o}},lf=class extends Rg{constructor(){super(...arguments),this.type="polygon"}path(t){var e=super.path(t),[{x:o,y:l}]=this.points;return t&&(t.lineTo(o,l),t.closePath()),e}},cf=class extends an{constructor(){super(...arguments),this.type="pattern"}createPattern(t,e,o){var l=this.getStyle("width").getPixels("x",!0),n=this.getStyle("height").getPixels("y",!0),g=new hc(this.document,null);g.attributes.viewBox=new Di(this.document,"viewBox",this.getAttribute("viewBox").getValue()),g.attributes.width=new Di(this.document,"width","".concat(l,"px")),g.attributes.height=new Di(this.document,"height","".concat(n,"px")),g.attributes.transform=new Di(this.document,"transform",this.getAttribute("patternTransform").getValue()),g.children=this.children;var h=this.document.createCanvas(l,n),m=h.getContext("2d"),B=this.getAttribute("x"),_=this.getAttribute("y");B.hasValue()&&_.hasValue()&&m.translate(B.getPixels("x",!0),_.getPixels("y",!0)),o.hasValue()?this.styles["fill-opacity"]=o:Reflect.deleteProperty(this.styles,"fill-opacity");for(var E=-1;E<=1;E++)for(var G=-1;G<=1;G++)m.save(),g.attributes.x=new Di(this.document,"x",E*h.width),g.attributes.y=new Di(this.document,"y",G*h.height),g.render(m),m.restore();var S=t.createPattern(h,"repeat");return S}},uf=class extends an{constructor(){super(...arguments),this.type="marker"}render(t,e,o){if(e){var{x:l,y:n}=e,g=this.getAttribute("orient").getString("auto"),h=this.getAttribute("markerUnits").getString("strokeWidth");t.translate(l,n),g==="auto"&&t.rotate(o),h==="strokeWidth"&&t.scale(t.lineWidth,t.lineWidth),t.save();var m=new hc(this.document,null);m.type=this.type,m.attributes.viewBox=new Di(this.document,"viewBox",this.getAttribute("viewBox").getValue()),m.attributes.refX=new Di(this.document,"refX",this.getAttribute("refX").getValue()),m.attributes.refY=new Di(this.document,"refY",this.getAttribute("refY").getValue()),m.attributes.width=new Di(this.document,"width",this.getAttribute("markerWidth").getValue()),m.attributes.height=new Di(this.document,"height",this.getAttribute("markerHeight").getValue()),m.attributes.overflow=new Di(this.document,"overflow",this.getAttribute("overflow").getValue()),m.attributes.fill=new Di(this.document,"fill",this.getAttribute("fill").getColor("black")),m.attributes.stroke=new Di(this.document,"stroke",this.getAttribute("stroke").getValue("none")),m.children=this.children,m.render(t),t.restore(),h==="strokeWidth"&&t.scale(1/t.lineWidth,1/t.lineWidth),g==="auto"&&t.rotate(-o),t.translate(-l,-n)}}},hf=class extends an{constructor(){super(...arguments),this.type="defs"}render(){}},ih=class extends MA{constructor(){super(...arguments),this.type="g"}getBoundingBox(t){var e=new Xo;return this.children.forEach(o=>{e.addBoundingBox(o.getBoundingBox(t))}),e}},Zg=class extends an{constructor(t,e,o){super(t,e,o),this.attributesToInherit=["gradientUnits"],this.stops=[];var{stops:l,children:n}=this;n.forEach(g=>{g.type==="stop"&&l.push(g)})}getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(t,e,o){var l=this;this.getHrefAttribute().hasValue()&&(l=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(l));var{stops:n}=l,g=this.getGradient(t,e);if(!g)return this.addParentOpacity(o,n[n.length-1].color);if(n.forEach(tt=>{g.addColorStop(tt.offset,this.addParentOpacity(o,tt.color))}),this.getAttribute("gradientTransform").hasValue()){var{document:h}=this,{MAX_VIRTUAL_PIXELS:m,viewPort:B}=h.screen,[_]=B.viewPorts,E=new Gg(h,null);E.attributes.x=new Di(h,"x",-m/3),E.attributes.y=new Di(h,"y",-m/3),E.attributes.width=new Di(h,"width",m),E.attributes.height=new Di(h,"height",m);var G=new ih(h,null);G.attributes.transform=new Di(h,"transform",this.getAttribute("gradientTransform").getValue()),G.children=[E];var S=new hc(h,null);S.attributes.x=new Di(h,"x",0),S.attributes.y=new Di(h,"y",0),S.attributes.width=new Di(h,"width",_.width),S.attributes.height=new Di(h,"height",_.height),S.children=[G];var O=h.createCanvas(_.width,_.height),P=O.getContext("2d");return P.fillStyle=g,S.render(P),P.createPattern(O,"no-repeat")}return g}inheritStopContainer(t){this.attributesToInherit.forEach(e=>{!this.getAttribute(e).hasValue()&&t.getAttribute(e).hasValue()&&this.getAttribute(e,!0).setValue(t.getAttribute(e).getValue())})}addParentOpacity(t,e){if(t.hasValue()){var o=new Di(this.document,"color",e);return o.addOpacity(t).getColor()}return e}},gf=class extends Zg{constructor(t,e,o){super(t,e,o),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}getGradient(t,e){var o=this.getGradientUnits()==="objectBoundingBox",l=o?e.getBoundingBox(t):null;if(o&&!l)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));var n=o?l.x+l.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),g=o?l.y+l.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),h=o?l.x+l.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),m=o?l.y+l.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return n===h&&g===m?null:t.createLinearGradient(n,g,h,m)}},df=class extends Zg{constructor(t,e,o){super(t,e,o),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}getGradient(t,e){var o=this.getGradientUnits()==="objectBoundingBox",l=e.getBoundingBox(t);if(o&&!l)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");var n=o?l.x+l.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),g=o?l.y+l.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y"),h=n,m=g;this.getAttribute("fx").hasValue()&&(h=o?l.x+l.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(m=o?l.y+l.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));var B=o?(l.width+l.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),_=this.getAttribute("fr").getPixels();return t.createRadialGradient(h,m,_,n,g,B)}},pf=class extends an{constructor(t,e,o){super(t,e,o),this.type="stop";var l=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),n=this.getStyle("stop-opacity"),g=this.getStyle("stop-color",!0);g.getString()===""&&g.setValue("#000"),n.hasValue()&&(g=g.addOpacity(n)),this.offset=l,this.color=g.getColor()}},rh=class extends an{constructor(t,e,o){super(t,e,o),this.type="animate",this.duration=0,this.initialValue=null,this.initialUnits="",this.removed=!1,this.frozen=!1,t.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Di(t,"values",null);var l=this.getAttribute("values");l.hasValue()&&this.values.setValue(l.getString().split(";"))}getProperty(){var t=this.getAttribute("attributeType").getString(),e=this.getAttribute("attributeName").getString();return t==="CSS"?this.parent.getStyle(e,!0):this.parent.getAttribute(e,!0)}calcValue(){var{initialUnits:t}=this,{progress:e,from:o,to:l}=this.getProgress(),n=o.getNumber()+(l.getNumber()-o.getNumber())*e;return t==="%"&&(n*=100),"".concat(n).concat(t)}update(t){var{parent:e}=this,o=this.getProperty();if(this.initialValue||(this.initialValue=o.getString(),this.initialUnits=o.getUnits()),this.duration>this.maxDuration){var l=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(l==="freeze"&&!this.frozen)this.frozen=!0,e.animationFrozen=!0,e.animationFrozenValue=o.getString();else if(l==="remove"&&!this.removed)return this.removed=!0,o.setValue(e.animationFrozen?e.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=t;var n=!1;if(this.begin<this.duration){var g=this.calcValue(),h=this.getAttribute("type");if(h.hasValue()){var m=h.getString();g="".concat(m,"(").concat(g,")")}o.setValue(g),n=!0}return n}getProgress(){var{document:t,values:e}=this,o={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(e.hasValue()){var l=o.progress*(e.getValue().length-1),n=Math.floor(l),g=Math.ceil(l);o.from=new Di(t,"from",parseFloat(e.getValue()[n])),o.to=new Di(t,"to",parseFloat(e.getValue()[g])),o.progress=(l-n)/(g-n)}else o.from=this.from,o.to=this.to;return o}},ff=class extends rh{constructor(){super(...arguments),this.type="animateColor"}calcValue(){var{progress:t,from:e,to:o}=this.getProgress(),l=new SI(e.getColor()),n=new SI(o.getColor());if(l.ok&&n.ok){var g=l.r+(n.r-l.r)*t,h=l.g+(n.g-l.g)*t,m=l.b+(n.b-l.b)*t;return"rgb(".concat(Math.floor(g),", ").concat(Math.floor(h),", ").concat(Math.floor(m),")")}return this.getAttribute("from").getColor()}},mf=class extends rh{constructor(){super(...arguments),this.type="animateTransform"}calcValue(){var{progress:t,from:e,to:o}=this.getProgress(),l=Jo(e.getString()),n=Jo(o.getString()),g=l.map((h,m)=>{var B=n[m];return h+(B-h)*t}).join(" ");return g}},Cf=class extends an{constructor(t,e,o){super(t,e,o),this.type="font",this.glyphs={},this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();var{definitions:l}=t,{children:n}=this;for(var g of n)switch(g.type){case"font-face":{this.fontFace=g;var h=g.getStyle("font-family");h.hasValue()&&(l[h.getString()]=this);break}case"missing-glyph":this.missingGlyph=g;break;case"glyph":{var m=g;m.arabicForm?(this.isRTL=!0,this.isArabic=!0,typeof this.glyphs[m.unicode]>"u"&&(this.glyphs[m.unicode]={}),this.glyphs[m.unicode][m.arabicForm]=m):this.glyphs[m.unicode]=m;break}}}render(){}},If=class extends an{constructor(t,e,o){super(t,e,o),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}},yf=class extends Dr{constructor(){super(...arguments),this.type="missing-glyph",this.horizAdvX=0}},bf=class extends dA{constructor(){super(...arguments),this.type="tref"}getText(){var t=this.getHrefAttribute().getDefinition();if(t){var e=t.children[0];if(e)return e.getText()}return""}},vf=class extends dA{constructor(t,e,o){super(t,e,o),this.type="a";var{childNodes:l}=e,n=l[0],g=l.length>0&&Array.from(l).every(h=>h.nodeType===3);this.hasText=g,this.text=g?this.getTextFromNode(n):""}getText(){return this.text}renderChildren(t){if(this.hasText){super.renderChildren(t);var{document:e,x:o,y:l}=this,{mouse:n}=e.screen,g=new Di(e,"fontSize",Es.parse(e.ctx.font).fontSize);n.isWorking()&&n.checkBoundingBox(this,new Xo(o,l-g.getPixels("y"),o+this.measureText(t),l))}else if(this.children.length>0){var h=new ih(this.document,null);h.children=this.children,h.parent=this,h.render(t)}}onClick(){var{window:t}=this.document;t&&t.open(this.getHrefAttribute().getString())}onMouseMove(){var t=this.document.ctx;t.canvas.style.cursor="pointer"}};wf=class extends dA{constructor(t,e,o){super(t,e,o),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);var l=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(l)}getText(){return this.text}path(t){var{dataArray:e}=this;t&&t.beginPath(),e.forEach(o=>{var{type:l,points:n}=o;switch(l){case ur.LINE_TO:t&&t.lineTo(n[0],n[1]);break;case ur.MOVE_TO:t&&t.moveTo(n[0],n[1]);break;case ur.CURVE_TO:t&&t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]);break;case ur.QUAD_TO:t&&t.quadraticCurveTo(n[0],n[1],n[2],n[3]);break;case ur.ARC:{var[g,h,m,B,_,E,G,S]=n,O=m>B?m:B,P=m>B?1:m/B,tt=m>B?B/m:1;t&&(t.translate(g,h),t.rotate(G),t.scale(P,tt),t.arc(0,0,O,_,_+E,!!(1-S)),t.scale(1/P,1/tt),t.rotate(-G),t.translate(-g,-h));break}case ur.CLOSE_PATH:t&&t.closePath();break}})}renderChildren(t){this.setTextData(t),t.save();var e=this.parent.getStyle("text-decoration").getString(),o=this.getFontSize(),{glyphInfo:l}=this,n=t.fillStyle;e==="underline"&&t.beginPath(),l.forEach((g,h)=>{var{p0:m,p1:B,rotation:_,text:E}=g;t.save(),t.translate(m.x,m.y),t.rotate(_),t.fillStyle&&t.fillText(E,0,0),t.strokeStyle&&t.strokeText(E,0,0),t.restore(),e==="underline"&&(h===0&&t.moveTo(m.x,m.y+o/8),t.lineTo(B.x,B.y+o/5))}),e==="underline"&&(t.lineWidth=o/20,t.strokeStyle=n,t.stroke(),t.closePath()),t.restore()}getLetterSpacingAt(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[t]||0}findSegmentToFitChar(t,e,o,l,n,g,h,m,B){var _=g,E=this.measureText(t,m);m===" "&&e==="justify"&&o<l&&(E+=(l-o)/n),B>-1&&(_+=this.getLetterSpacingAt(B));var G=this.textHeight/20,S=this.getEquidistantPointOnPath(_,G,0),O=this.getEquidistantPointOnPath(_+E,G,0),P={p0:S,p1:O},tt=S&&O?Math.atan2(O.y-S.y,O.x-S.x):0;if(h){var z=Math.cos(Math.PI/2+tt)*h,rt=Math.cos(-tt)*h;P.p0=Gp(Gp({},S),{},{x:S.x+z,y:S.y+rt}),P.p1=Gp(Gp({},O),{},{x:O.x+z,y:O.y+rt})}return _+=E,{offset:_,segment:P,rotation:tt}}measureText(t,e){var{measuresCache:o}=this,l=e||this.getText();if(o.has(l))return o.get(l);var n=this.measureTargetText(t,l);return o.set(l,n),n}setTextData(t){if(!this.glyphInfo){var e=this.getText(),o=e.split(""),l=e.split(" ").length-1,n=this.parent.getAttribute("dx").split().map(Et=>Et.getPixels("x")),g=this.parent.getAttribute("dy").getPixels("y"),h=this.parent.getStyle("text-anchor").getString("start"),m=this.getStyle("letter-spacing"),B=this.parent.getStyle("letter-spacing"),_=0;!m.hasValue()||m.getValue()==="inherit"?_=B.getPixels():m.hasValue()&&m.getValue()!=="initial"&&m.getValue()!=="unset"&&(_=m.getPixels());var E=[],G=e.length;this.letterSpacingCache=E;for(var S=0;S<G;S++)E.push(typeof n[S]<"u"?n[S]:_);var O=E.reduce((Et,Pt,Qt)=>Qt===0?0:Et+Pt||0,0),P=this.measureText(t),tt=Math.max(P+O,0);this.textWidth=P,this.textHeight=this.getFontSize(),this.glyphInfo=[];var z=this.getPathLength(),rt=this.getStyle("startOffset").getNumber(0)*z,ct=0;(h==="middle"||h==="center")&&(ct=-tt/2),(h==="end"||h==="right")&&(ct=-tt),ct+=rt,o.forEach((Et,Pt)=>{var{offset:Qt,segment:Ut,rotation:dt}=this.findSegmentToFitChar(t,h,tt,z,l,ct,g,Et,Pt);ct=Qt,!(!Ut.p0||!Ut.p1)&&this.glyphInfo.push({text:o[Pt],p0:Ut.p0,p1:Ut.p1,rotation:dt})})}}parsePathData(t){if(this.pathLength=-1,!t)return[];var e=[],{pathParser:o}=t;for(o.reset();!o.isEnd();){var{current:l}=o,n=l?l.x:0,g=l?l.y:0,h=o.next(),m=h.type,B=[];switch(h.type){case ur.MOVE_TO:this.pathM(o,B);break;case ur.LINE_TO:m=this.pathL(o,B);break;case ur.HORIZ_LINE_TO:m=this.pathH(o,B);break;case ur.VERT_LINE_TO:m=this.pathV(o,B);break;case ur.CURVE_TO:this.pathC(o,B);break;case ur.SMOOTH_CURVE_TO:m=this.pathS(o,B);break;case ur.QUAD_TO:this.pathQ(o,B);break;case ur.SMOOTH_QUAD_TO:m=this.pathT(o,B);break;case ur.ARC:B=this.pathA(o);break;case ur.CLOSE_PATH:Dr.pathZ(o);break}h.type!==ur.CLOSE_PATH?e.push({type:m,points:B,start:{x:n,y:g},pathLength:this.calcLength(n,g,m,B)}):e.push({type:ur.CLOSE_PATH,points:[],pathLength:0})}return e}pathM(t,e){var{x:o,y:l}=Dr.pathM(t).point;e.push(o,l)}pathL(t,e){var{x:o,y:l}=Dr.pathL(t).point;return e.push(o,l),ur.LINE_TO}pathH(t,e){var{x:o,y:l}=Dr.pathH(t).point;return e.push(o,l),ur.LINE_TO}pathV(t,e){var{x:o,y:l}=Dr.pathV(t).point;return e.push(o,l),ur.LINE_TO}pathC(t,e){var{point:o,controlPoint:l,currentPoint:n}=Dr.pathC(t);e.push(o.x,o.y,l.x,l.y,n.x,n.y)}pathS(t,e){var{point:o,controlPoint:l,currentPoint:n}=Dr.pathS(t);return e.push(o.x,o.y,l.x,l.y,n.x,n.y),ur.CURVE_TO}pathQ(t,e){var{controlPoint:o,currentPoint:l}=Dr.pathQ(t);e.push(o.x,o.y,l.x,l.y)}pathT(t,e){var{controlPoint:o,currentPoint:l}=Dr.pathT(t);return e.push(o.x,o.y,l.x,l.y),ur.QUAD_TO}pathA(t){var{rX:e,rY:o,sweepFlag:l,xAxisRotation:n,centp:g,a1:h,ad:m}=Dr.pathA(t);return l===0&&m>0&&(m-=2*Math.PI),l===1&&m<0&&(m+=2*Math.PI),[g.x,g.y,e,o,h,m,n,l]}calcLength(t,e,o,l){var n=0,g=null,h=null,m=0;switch(o){case ur.LINE_TO:return this.getLineLength(t,e,l[0],l[1]);case ur.CURVE_TO:for(n=0,g=this.getPointOnCubicBezier(0,t,e,l[0],l[1],l[2],l[3],l[4],l[5]),m=.01;m<=1;m+=.01)h=this.getPointOnCubicBezier(m,t,e,l[0],l[1],l[2],l[3],l[4],l[5]),n+=this.getLineLength(g.x,g.y,h.x,h.y),g=h;return n;case ur.QUAD_TO:for(n=0,g=this.getPointOnQuadraticBezier(0,t,e,l[0],l[1],l[2],l[3]),m=.01;m<=1;m+=.01)h=this.getPointOnQuadraticBezier(m,t,e,l[0],l[1],l[2],l[3]),n+=this.getLineLength(g.x,g.y,h.x,h.y),g=h;return n;case ur.ARC:{n=0;var B=l[4],_=l[5],E=l[4]+_,G=Math.PI/180;if(Math.abs(B-E)<G&&(G=Math.abs(B-E)),g=this.getPointOnEllipticalArc(l[0],l[1],l[2],l[3],B,0),_<0)for(m=B-G;m>E;m-=G)h=this.getPointOnEllipticalArc(l[0],l[1],l[2],l[3],m,0),n+=this.getLineLength(g.x,g.y,h.x,h.y),g=h;else for(m=B+G;m<E;m+=G)h=this.getPointOnEllipticalArc(l[0],l[1],l[2],l[3],m,0),n+=this.getLineLength(g.x,g.y,h.x,h.y),g=h;return h=this.getPointOnEllipticalArc(l[0],l[1],l[2],l[3],E,0),n+=this.getLineLength(g.x,g.y,h.x,h.y),n}}return 0}getPointOnLine(t,e,o,l,n){var g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:e,h=arguments.length>6&&arguments[6]!==void 0?arguments[6]:o,m=(n-o)/(l-e+jc),B=Math.sqrt(t*t/(1+m*m));l<e&&(B*=-1);var _=m*B,E=null;if(l===e)E={x:g,y:h+_};else if((h-o)/(g-e+jc)===m)E={x:g+B,y:h+_};else{var G=0,S=0,O=this.getLineLength(e,o,l,n);if(O<jc)return null;var P=(g-e)*(l-e)+(h-o)*(n-o);P/=O*O,G=e+P*(l-e),S=o+P*(n-o);var tt=this.getLineLength(g,h,G,S),z=Math.sqrt(t*t-tt*tt);B=Math.sqrt(z*z/(1+m*m)),l<e&&(B*=-1),_=m*B,E={x:G+B,y:S+_}}return E}getPointOnPath(t){var e=this.getPathLength(),o=0,l=null;if(t<-5e-5||t-5e-5>e)return null;var{dataArray:n}=this;for(var g of n){if(g&&(g.pathLength<5e-5||o+g.pathLength+5e-5<t)){o+=g.pathLength;continue}var h=t-o,m=0;switch(g.type){case ur.LINE_TO:l=this.getPointOnLine(h,g.start.x,g.start.y,g.points[0],g.points[1],g.start.x,g.start.y);break;case ur.ARC:{var B=g.points[4],_=g.points[5],E=g.points[4]+_;if(m=B+h/g.pathLength*_,_<0&&m<E||_>=0&&m>E)break;l=this.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],m,g.points[6]);break}case ur.CURVE_TO:m=h/g.pathLength,m>1&&(m=1),l=this.getPointOnCubicBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);break;case ur.QUAD_TO:m=h/g.pathLength,m>1&&(m=1),l=this.getPointOnQuadraticBezier(m,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3]);break}if(l)return l;break}return null}getLineLength(t,e,o,l){return Math.sqrt((o-t)*(o-t)+(l-e)*(l-e))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((t,e)=>e.pathLength>0?t+e.pathLength:t,0)),this.pathLength}getPointOnCubicBezier(t,e,o,l,n,g,h,m,B){var _=m*TI(t)+g*QI(t)+l*UI(t)+e*GI(t),E=B*TI(t)+h*QI(t)+n*UI(t)+o*GI(t);return{x:_,y:E}}getPointOnQuadraticBezier(t,e,o,l,n,g,h){var m=g*RI(t)+l*ZI(t)+e*HI(t),B=h*RI(t)+n*ZI(t)+o*HI(t);return{x:m,y:B}}getPointOnEllipticalArc(t,e,o,l,n,g){var h=Math.cos(g),m=Math.sin(g),B={x:o*Math.cos(n),y:l*Math.sin(n)};return{x:t+(B.x*h-B.y*m),y:e+(B.x*m+B.y*h)}}buildEquidistantCache(t,e){var o=this.getPathLength(),l=e||.25,n=t||o/100;if(!this.equidistantCache||this.equidistantCache.step!==n||this.equidistantCache.precision!==l){this.equidistantCache={step:n,precision:l,points:[]};for(var g=0,h=0;h<=o;h+=l){var m=this.getPointOnPath(h),B=this.getPointOnPath(h+l);!m||!B||(g+=this.getLineLength(m.x,m.y,B.x,B.y),g>=n&&(this.equidistantCache.points.push({x:m.x,y:m.y,distance:h}),g-=n))}}}getEquidistantPointOnPath(t,e,o){if(this.buildEquidistantCache(e,o),t<0||t-this.getPathLength()>5e-5)return null;var l=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[l]||null}},gD=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i,Bf=class extends MA{constructor(t,e,o){super(t,e,o),this.type="image",this.loaded=!1;var l=this.getHrefAttribute().getString();if(l){var n=l.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(l);t.images.push(this),n?this.loadSvg(l):this.loadImage(l),this.isSvg=n}}loadImage(t){var e=this;return bl(function*(){try{var o=yield e.document.createImage(t);e.image=o}catch(l){console.error('Error while loading image "'.concat(t,'":'),l)}e.loaded=!0})()}loadSvg(t){var e=this;return bl(function*(){var o=gD.exec(t);if(o){var l=o[5];o[4]==="base64"?e.image=atob(l):e.image=decodeURIComponent(l)}else try{var n=yield e.document.fetch(t),g=yield n.text();e.image=g}catch(h){console.error('Error while loading image "'.concat(t,'":'),h)}e.loaded=!0})()}renderChildren(t){var{document:e,image:o,loaded:l}=this,n=this.getAttribute("x").getPixels("x"),g=this.getAttribute("y").getPixels("y"),h=this.getStyle("width").getPixels("x"),m=this.getStyle("height").getPixels("y");if(!(!l||!o||!h||!m)){if(t.save(),t.translate(n,g),this.isSvg){var B=e.canvg.forkString(t,this.image,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:h,scaleHeight:m});B.document.documentElement.parent=this,B.render()}else{var _=this.image;e.setViewBox({ctx:t,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:h,desiredWidth:_.width,height:m,desiredHeight:_.height}),this.loaded&&(typeof _.complete>"u"||_.complete)&&t.drawImage(_,0,0)}t.restore()}}getBoundingBox(){var t=this.getAttribute("x").getPixels("x"),e=this.getAttribute("y").getPixels("y"),o=this.getStyle("width").getPixels("x"),l=this.getStyle("height").getPixels("y");return new Xo(t,e,t+o,e+l)}},_f=class extends MA{constructor(){super(...arguments),this.type="symbol"}render(t){}},xf=class{constructor(t){this.document=t,this.loaded=!1,t.fonts.push(this)}load(t,e){var o=this;return bl(function*(){try{var{document:l}=o,n=yield l.canvg.parser.load(e),g=n.getElementsByTagName("font");Array.from(g).forEach(h=>{var m=l.createElement(h);l.definitions[t]=m})}catch(h){console.error('Error while loading font "'.concat(e,'":'),h)}o.loaded=!0})()}},Hg=class extends an{constructor(t,e,o){super(t,e,o),this.type="style";var l=Au(Array.from(e.childNodes).map(g=>g.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")),n=l.split("}");n.forEach(g=>{var h=g.trim();if(h){var m=h.split("{"),B=m[0].split(","),_=m[1].split(";");B.forEach(E=>{var G=E.trim();if(G){var S=t.styles[G]||{};if(_.forEach(tt=>{var z=tt.indexOf(":"),rt=tt.substr(0,z).trim(),ct=tt.substr(z+1,tt.length-z).trim();rt&&ct&&(S[rt]=new Di(t,rt,ct))}),t.styles[G]=S,t.stylesSpecificity[G]=c5(G),G==="@font-face"){var O=S["font-family"].getString().replace(/"|'/g,""),P=S.src.getString().split(",");P.forEach(tt=>{if(tt.indexOf('format("svg")')>0){var z=By(tt);z&&new xf(t).load(O,z)}})}}})}})}};Hg.parseExternalUrl=By;Sf=class extends MA{constructor(){super(...arguments),this.type="use"}setContext(t){super.setContext(t);var e=this.getAttribute("x"),o=this.getAttribute("y");e.hasValue()&&t.translate(e.getPixels("x"),0),o.hasValue()&&t.translate(0,o.getPixels("y"))}path(t){var{element:e}=this;e&&e.path(t)}renderChildren(t){var{document:e,element:o}=this;if(o){var l=o;if(o.type==="symbol"&&(l=new hc(e,null),l.attributes.viewBox=new Di(e,"viewBox",o.getAttribute("viewBox").getString()),l.attributes.preserveAspectRatio=new Di(e,"preserveAspectRatio",o.getAttribute("preserveAspectRatio").getString()),l.attributes.overflow=new Di(e,"overflow",o.getAttribute("overflow").getString()),l.children=o.children,o.styles.opacity=new Di(e,"opacity",this.calculateOpacity())),l.type==="svg"){var n=this.getStyle("width",!1,!0),g=this.getStyle("height",!1,!0);n.hasValue()&&(l.attributes.width=new Di(e,"width",n.getString())),g.hasValue()&&(l.attributes.height=new Di(e,"height",g.getString()))}var h=l.parent;l.parent=this,l.render(t),l.parent=h}}getBoundingBox(t){var{element:e}=this;return e?e.getBoundingBox(t):null}elementTransform(){var{document:t,element:e}=this;return PA.fromElement(t,e)}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}};Ng=class extends an{constructor(t,e,o){super(t,e,o),this.type="feColorMatrix";var l=Jo(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{var n=l[0];l=[.213+.787*n,.715-.715*n,.072-.072*n,0,0,.213-.213*n,.715+.285*n,.072-.072*n,0,0,.213-.213*n,.715-.715*n,.072+.928*n,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{var g=l[0]*Math.PI/180;l=[Il(g,.213,.787,-.213),Il(g,.715,-.715,-.715),Il(g,.072,-.072,.928),0,0,Il(g,.213,-.213,.143),Il(g,.715,.285,.14),Il(g,.072,-.072,-.283),0,0,Il(g,.213,-.213,-.787),Il(g,.715,-.715,.715),Il(g,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=l,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}apply(t,e,o,l,n){for(var{includeOpacity:g,matrix:h}=this,m=t.getImageData(0,0,l,n),B=0;B<n;B++)for(var _=0;_<l;_++){var E=Rp(m.data,_,B,l,n,0),G=Rp(m.data,_,B,l,n,1),S=Rp(m.data,_,B,l,n,2),O=Rp(m.data,_,B,l,n,3),P=cs(h,0,E)+cs(h,1,G)+cs(h,2,S)+cs(h,3,O)+cs(h,4,1),tt=cs(h,5,E)+cs(h,6,G)+cs(h,7,S)+cs(h,8,O)+cs(h,9,1),z=cs(h,10,E)+cs(h,11,G)+cs(h,12,S)+cs(h,13,O)+cs(h,14,1),rt=cs(h,15,E)+cs(h,16,G)+cs(h,17,S)+cs(h,18,O)+cs(h,19,1);g&&(P=0,tt=0,z=0,rt*=O/255),Zp(m.data,_,B,l,n,0,P),Zp(m.data,_,B,l,n,1,tt),Zp(m.data,_,B,l,n,2,z),Zp(m.data,_,B,l,n,3,rt)}t.clearRect(0,0,l,n),t.putImageData(m,0,0)}},iu=class extends an{constructor(){super(...arguments),this.type="mask"}apply(t,e){var{document:o}=this,l=this.getAttribute("x").getPixels("x"),n=this.getAttribute("y").getPixels("y"),g=this.getStyle("width").getPixels("x"),h=this.getStyle("height").getPixels("y");if(!g&&!h){var m=new Xo;this.children.forEach(O=>{m.addBoundingBox(O.getBoundingBox(t))}),l=Math.floor(m.x1),n=Math.floor(m.y1),g=Math.floor(m.width),h=Math.floor(m.height)}var B=this.removeStyles(e,iu.ignoreStyles),_=o.createCanvas(l+g,n+h),E=_.getContext("2d");o.screen.setDefaults(E),this.renderChildren(E),new Ng(o,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(E,0,0,l+g,n+h);var G=o.createCanvas(l+g,n+h),S=G.getContext("2d");o.screen.setDefaults(S),e.render(S),S.globalCompositeOperation="destination-in",S.fillStyle=E.createPattern(_,"no-repeat"),S.fillRect(0,0,l+g,n+h),t.fillStyle=S.createPattern(G,"no-repeat"),t.fillRect(0,0,l+g,n+h),this.restoreStyles(e,B)}render(t){}};iu.ignoreStyles=["mask","transform","clip-path"];C_=()=>{},Ff=class extends an{constructor(){super(...arguments),this.type="clipPath"}apply(t){var{document:e}=this,o=Reflect.getPrototypeOf(t),{beginPath:l,closePath:n}=t;o&&(o.beginPath=C_,o.closePath=C_),Reflect.apply(l,t,[]),this.children.forEach(g=>{if(!(typeof g.path>"u")){var h=typeof g.elementTransform<"u"?g.elementTransform():null;h||(h=PA.fromElement(e,g)),h&&h.apply(t),g.path(t),o&&(o.closePath=n),h&&h.unapply(t)}}),Reflect.apply(n,t,[]),t.clip(),o&&(o.beginPath=l,o.closePath=n)}render(t){}},ru=class extends an{constructor(){super(...arguments),this.type="filter"}apply(t,e){var{document:o,children:l}=this,n=e.getBoundingBox(t);if(n){var g=0,h=0;l.forEach(z=>{var rt=z.extraFilterDistance||0;g=Math.max(g,rt),h=Math.max(h,rt)});var m=Math.floor(n.width),B=Math.floor(n.height),_=m+2*g,E=B+2*h;if(!(_<1||E<1)){var G=Math.floor(n.x),S=Math.floor(n.y),O=this.removeStyles(e,ru.ignoreStyles),P=o.createCanvas(_,E),tt=P.getContext("2d");o.screen.setDefaults(tt),tt.translate(-G+g,-S+h),e.render(tt),l.forEach(z=>{typeof z.apply=="function"&&z.apply(tt,0,0,_,E)}),t.drawImage(P,0,0,_,E,G-g,S-h,_,E),this.restoreStyles(e,O)}}}render(t){}};ru.ignoreStyles=["filter","transform","clip-path"];kf=class extends an{constructor(t,e,o){super(t,e,o),this.type="feDropShadow",this.addStylesFromStyleDefinition()}apply(t,e,o,l,n){}},Lf=class extends an{constructor(){super(...arguments),this.type="feMorphology"}apply(t,e,o,l,n){}},Ef=class extends an{constructor(){super(...arguments),this.type="feComposite"}apply(t,e,o,l,n){}},Tf=class extends an{constructor(t,e,o){super(t,e,o),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}apply(t,e,o,l,n){var{document:g,blurRadius:h}=this,m=g.window?g.window.document.body:null,B=t.canvas;B.id=g.getUniqueId(),m&&(B.style.display="none",m.appendChild(B)),W6(B,e,o,l,n,h),m&&m.removeChild(B)}},Qf=class extends an{constructor(){super(...arguments),this.type="title"}},Uf=class extends an{constructor(){super(...arguments),this.type="desc"}},dD={svg:hc,rect:Gg,circle:of,ellipse:af,line:Af,polyline:Rg,polygon:lf,path:Dr,pattern:cf,marker:uf,defs:hf,linearGradient:gf,radialGradient:df,stop:pf,animate:rh,animateColor:ff,animateTransform:mf,font:Cf,"font-face":If,"missing-glyph":yf,glyph:Ug,text:dA,tspan:eu,tref:bf,a:vf,textPath:wf,image:Bf,g:ih,symbol:_f,style:Hg,use:Sf,mask:iu,clipPath:Ff,filter:ru,feDropShadow:kf,feMorphology:Lf,feComposite:Ef,feColorMatrix:Ng,feGaussianBlur:Tf,title:Qf,desc:Uf};gA=class{constructor(t){var{rootEmSize:e=12,emSize:o=12,createCanvas:l=gA.createCanvas,createImage:n=gA.createImage,anonymousCrossOrigin:g}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.canvg=t,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=t.screen,this.rootEmSize=e,this.emSize=o,this.createCanvas=l,this.createImage=this.bindCreateImage(n,g),this.screen.wait(this.isImagesLoaded.bind(this)),this.screen.wait(this.isFontsLoaded.bind(this))}bindCreateImage(t,e){return typeof e=="boolean"?(o,l)=>t(o,typeof l=="boolean"?l:e):t}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){var{emSizeStack:t}=this;return t[t.length-1]}set emSize(t){var{emSizeStack:e}=this;e.push(t)}popEmSize(){var{emSizeStack:t}=this;t.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(t=>t.loaded)}isFontsLoaded(){return this.fonts.every(t=>t.loaded)}createDocumentElement(t){var e=this.createElement(t.documentElement);return e.root=!0,e.addStylesFromStyleDefinition(),this.documentElement=e,e}createElement(t){var e=t.nodeName.replace(/^[^:]+:/,""),o=gA.elementTypes[e];return typeof o<"u"?new o(this,t):new sf(this,t)}createTextNode(t){return new NI(this,t)}setViewBox(t){this.screen.setViewBox(pD({document:this},t))}};gA.createCanvas=fD;gA.createImage=mD;gA.elementTypes=dD;cc=class{constructor(t,e){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.parser=new $u(o),this.screen=new tu(t,o),this.options=o;var l=new gA(this,o),n=l.createDocumentElement(e);this.document=l,this.documentElement=n}static from(t,e){var o=arguments;return bl(function*(){var l=o.length>2&&o[2]!==void 0?o[2]:{},n=new $u(l),g=yield n.parse(e);return new cc(t,g,l)})()}static fromString(t,e){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=new $u(o),n=l.parseFromString(e);return new cc(t,n,o)}fork(t,e){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return cc.from(t,e,Xc(Xc({},this.options),o))}forkString(t,e){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return cc.fromString(t,e,Xc(Xc({},this.options),o))}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}render(){var t=arguments,e=this;return bl(function*(){var o=t.length>0&&t[0]!==void 0?t[0]:{};e.start(Xc({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0},o)),yield e.ready(),e.stop()})()}start(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{documentElement:e,screen:o,options:l}=this;o.start(e,Xc(Xc({enableRedraw:!0},l),t))}stop(){this.screen.stop()}resize(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(t,e,o)}}});function Nr(i){return Nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nr(i)}function Ny(i,t){t===void 0&&(t={});var e=kD();e.p(i);var o=LD(i,t,2,4);return TD(o,t),ED(o,o.length-4,e.d()),o}function UD(i,t){return _D((QD(i),i.subarray(2,-4)),t)}function ky(){sr.console&&typeof sr.console.log=="function"&&sr.console.log.apply(sr.console,arguments)}function Ly(i,t,e){var o=new XMLHttpRequest;o.open("GET",i),o.responseType="blob",o.onload=function(){lu(o.response,t,e)},o.onerror=function(){hn.error("could not download file")},o.send()}function C5(i){var t=new XMLHttpRequest;t.open("HEAD",i,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function qf(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(t)}}function D5(i){var t;i=i||"",this.ok=!1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[i=(i=i.replace(/ /g,"")).toLowerCase()]||i;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(h){return[parseInt(h[1]),parseInt(h[2]),parseInt(h[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(h){return[parseInt(h[1],16),parseInt(h[2],16),parseInt(h[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(h){return[parseInt(h[1]+h[1],16),parseInt(h[2]+h[2],16),parseInt(h[3]+h[3],16)]}}],o=0;o<e.length;o++){var l=e[o].re,n=e[o].process,g=l.exec(i);g&&(t=n(g),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var h=this.r.toString(16),m=this.g.toString(16),B=this.b.toString(16);return h.length==1&&(h="0"+h),m.length==1&&(m="0"+m),B.length==1&&(B="0"+B),"#"+h+m+B}}function Ey(i,t){var e=i[0],o=i[1],l=i[2],n=i[3];e=ao(e,o,l,n,t[0],7,-680876936),n=ao(n,e,o,l,t[1],12,-389564586),l=ao(l,n,e,o,t[2],17,606105819),o=ao(o,l,n,e,t[3],22,-1044525330),e=ao(e,o,l,n,t[4],7,-176418897),n=ao(n,e,o,l,t[5],12,1200080426),l=ao(l,n,e,o,t[6],17,-1473231341),o=ao(o,l,n,e,t[7],22,-45705983),e=ao(e,o,l,n,t[8],7,1770035416),n=ao(n,e,o,l,t[9],12,-1958414417),l=ao(l,n,e,o,t[10],17,-42063),o=ao(o,l,n,e,t[11],22,-1990404162),e=ao(e,o,l,n,t[12],7,1804603682),n=ao(n,e,o,l,t[13],12,-40341101),l=ao(l,n,e,o,t[14],17,-1502002290),e=Ao(e,o=ao(o,l,n,e,t[15],22,1236535329),l,n,t[1],5,-165796510),n=Ao(n,e,o,l,t[6],9,-1069501632),l=Ao(l,n,e,o,t[11],14,643717713),o=Ao(o,l,n,e,t[0],20,-373897302),e=Ao(e,o,l,n,t[5],5,-701558691),n=Ao(n,e,o,l,t[10],9,38016083),l=Ao(l,n,e,o,t[15],14,-660478335),o=Ao(o,l,n,e,t[4],20,-405537848),e=Ao(e,o,l,n,t[9],5,568446438),n=Ao(n,e,o,l,t[14],9,-1019803690),l=Ao(l,n,e,o,t[3],14,-187363961),o=Ao(o,l,n,e,t[8],20,1163531501),e=Ao(e,o,l,n,t[13],5,-1444681467),n=Ao(n,e,o,l,t[2],9,-51403784),l=Ao(l,n,e,o,t[7],14,1735328473),e=lo(e,o=Ao(o,l,n,e,t[12],20,-1926607734),l,n,t[5],4,-378558),n=lo(n,e,o,l,t[8],11,-2022574463),l=lo(l,n,e,o,t[11],16,1839030562),o=lo(o,l,n,e,t[14],23,-35309556),e=lo(e,o,l,n,t[1],4,-1530992060),n=lo(n,e,o,l,t[4],11,1272893353),l=lo(l,n,e,o,t[7],16,-155497632),o=lo(o,l,n,e,t[10],23,-1094730640),e=lo(e,o,l,n,t[13],4,681279174),n=lo(n,e,o,l,t[0],11,-358537222),l=lo(l,n,e,o,t[3],16,-722521979),o=lo(o,l,n,e,t[6],23,76029189),e=lo(e,o,l,n,t[9],4,-640364487),n=lo(n,e,o,l,t[12],11,-421815835),l=lo(l,n,e,o,t[15],16,530742520),e=co(e,o=lo(o,l,n,e,t[2],23,-995338651),l,n,t[0],6,-198630844),n=co(n,e,o,l,t[7],10,1126891415),l=co(l,n,e,o,t[14],15,-1416354905),o=co(o,l,n,e,t[5],21,-57434055),e=co(e,o,l,n,t[12],6,1700485571),n=co(n,e,o,l,t[3],10,-1894986606),l=co(l,n,e,o,t[10],15,-1051523),o=co(o,l,n,e,t[1],21,-2054922799),e=co(e,o,l,n,t[8],6,1873313359),n=co(n,e,o,l,t[15],10,-30611744),l=co(l,n,e,o,t[6],15,-1560198380),o=co(o,l,n,e,t[13],21,1309151649),e=co(e,o,l,n,t[4],6,-145523070),n=co(n,e,o,l,t[11],10,-1120210379),l=co(l,n,e,o,t[2],15,718787259),o=co(o,l,n,e,t[9],21,-343485551),i[0]=pc(e,i[0]),i[1]=pc(o,i[1]),i[2]=pc(l,i[2]),i[3]=pc(n,i[3])}function um(i,t,e,o,l,n){return t=pc(pc(t,i),pc(o,n)),pc(t<<l|t>>>32-l,e)}function ao(i,t,e,o,l,n,g){return um(t&e|~t&o,i,t,l,n,g)}function Ao(i,t,e,o,l,n,g){return um(t&o|e&~o,i,t,l,n,g)}function lo(i,t,e,o,l,n,g){return um(t^e^o,i,t,l,n,g)}function co(i,t,e,o,l,n,g){return um(e^(t|~o),i,t,l,n,g)}function K5(i){var t,e=i.length,o=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=i.length;t+=64)Ey(o,GD(i.substring(t-64,t)));i=i.substring(t-64);var l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i.length;t++)l[t>>2]|=i.charCodeAt(t)<<(t%4<<3);if(l[t>>2]|=128<<(t%4<<3),t>55)for(Ey(o,l),t=0;t<16;t++)l[t]=0;return l[14]=8*e,Ey(o,l),o}function GD(i){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=i.charCodeAt(t)+(i.charCodeAt(t+1)<<8)+(i.charCodeAt(t+2)<<16)+(i.charCodeAt(t+3)<<24);return e}function RD(i){for(var t="",e=0;e<4;e++)t+=I5[i>>8*e+4&15]+I5[i>>8*e&15];return t}function ZD(i){return String.fromCharCode((255&i)>>0,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24)}function My(i){return K5(i).map(ZD).join("")}function pc(i,t){if(HD){var e=(65535&i)+(65535&t);return(i>>16)+(t>>16)+(e>>16)<<16|65535&e}return i+t&4294967295}function Vy(i,t){var e,o,l,n;if(i!==e){for(var g=(l=i,n=1+(256/i.length>>0),new Array(n+1).join(l)),h=[],m=0;m<256;m++)h[m]=m;var B=0;for(m=0;m<256;m++){var _=h[m];B=(B+_+g.charCodeAt(m))%256,h[m]=h[B],h[B]=_}e=i,o=h}else h=o;var E=t.length,G=0,S=0,O="";for(m=0;m<E;m++)S=(S+(_=h[G=(G+1)%256]))%256,h[G]=h[S],h[S]=_,g=h[(h[G]+h[S])%256],O+=String.fromCharCode(t.charCodeAt(m)^g);return O}function ch(i,t,e,o){this.v=1,this.r=2;var l=192;i.forEach(function(h){if(y5.perm!==void 0)throw new Error("Invalid permission: "+h);l+=y5[h]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var n=(t+this.padding).substr(0,32),g=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(n,g),this.P=-(1+(255^l)),this.encryptionKey=My(n+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(o)).substr(0,5),this.U=Vy(this.encryptionKey,this.padding)}function uh(i){if(/[^\u0000-\u00ff]/.test(i))throw new Error("Invalid PDF Name Object: "+i+", Only accept ASCII characters.");for(var t="",e=i.length,o=0;o<e;o++){var l=i.charCodeAt(o);l<33||l===35||l===37||l===40||l===41||l===47||l===60||l===62||l===91||l===93||l===123||l===125||l>126?t+="#"+("0"+l.toString(16)).slice(-2):t+=i[o]}return t}function b5(i){if(Nr(i)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,o,l){if(l=l||!1,typeof e!="string"||typeof o!="function"||typeof l!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var n=Math.random().toString(35);return t[e][n]=[o,!!l],n},this.unsubscribe=function(e){for(var o in t)if(t[o][e])return delete t[o][e],Object.keys(t[o]).length===0&&delete t[o],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var o=Array.prototype.slice.call(arguments,1),l=[];for(var n in t[e]){var g=t[e][n];try{g[0].apply(i,o)}catch(h){sr.console&&hn.error("jsPDF PubSub Error",h.message,h)}g[1]&&l.push(n)}l.length&&l.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function am(i){if(!(this instanceof am))return new am(i);var t="opacity,stroke-opacity".split(",");for(var e in i)i.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=i[e]);this.id="",this.objectNumber=-1}function O5(i,t){this.gState=i,this.matrix=t,this.id="",this.objectNumber=-1}function cu(i,t,e,o,l){if(!(this instanceof cu))return new cu(i,t,e,o,l);this.type=i==="axial"?2:3,this.coords=t,this.colors=e,O5.call(this,o,l)}function hh(i,t,e,o,l){if(!(this instanceof hh))return new hh(i,t,e,o,l);this.boundingBox=i,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,O5.call(this,o,l)}function nr(i){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",o=arguments[1],l=arguments[2],n=arguments[3],g=[],h=1,m=16,B="S",_=null;Nr(i=i||{})==="object"&&(e=i.orientation,o=i.unit||o,l=i.format||l,n=i.compress||i.compressPdf||n,(_=i.encryption||null)!==null&&(_.userPassword=_.userPassword||"",_.ownerPassword=_.ownerPassword||"",_.userPermissions=_.userPermissions||[]),h=typeof i.userUnit=="number"?Math.abs(i.userUnit):1,i.precision!==void 0&&(t=i.precision),i.floatPrecision!==void 0&&(m=i.floatPrecision),B=i.defaultPathOperation||"S"),g=i.filters||(n===!0?["FlateEncode"]:g),o=o||"mm",e=(""+(e||"P")).toLowerCase();var E=i.putOnlyUsedFonts||!1,G={},S={internal:{},__private__:{}};S.__private__.PubSub=b5;var O="1.3",P=S.__private__.getPdfVersion=function(){return O};S.__private__.setPdfVersion=function(U){O=U};var tt={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};S.__private__.getPageFormats=function(){return tt};var z=S.__private__.getPageFormat=function(U){return tt[U]};l=l||"a4";var rt={COMPAT:"compat",ADVANCED:"advanced"},ct=rt.COMPAT;function Et(){this.saveGraphicsState(),Rt(new mt(Ye,0,0,-Ye,0,gs()*Ye).toString()+" cm"),this.setFontSize(this.getFontSize()/Ye),B="n",ct=rt.ADVANCED}function Pt(){this.restoreGraphicsState(),B="S",ct=rt.COMPAT}var Qt=S.__private__.combineFontStyleAndFontWeight=function(U,et){if(U=="bold"&&et=="normal"||U=="bold"&&et==400||U=="normal"&&et=="italic"||U=="bold"&&et=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return et&&(U=et==400||et==="normal"?U==="italic"?"italic":"normal":et!=700&&et!=="bold"||U!=="normal"?(et==700?"bold":et)+""+U:"bold"),U};S.advancedAPI=function(U){var et=ct===rt.COMPAT;return et&&Et.call(this),typeof U!="function"||(U(this),et&&Pt.call(this)),this},S.compatAPI=function(U){var et=ct===rt.ADVANCED;return et&&Pt.call(this),typeof U!="function"||(U(this),et&&Et.call(this)),this},S.isAdvancedAPI=function(){return ct===rt.ADVANCED};var Ut,dt=function(U){if(ct!==rt.ADVANCED)throw new Error(U+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},ee=S.roundToPrecision=S.__private__.roundToPrecision=function(U,et){var vt=t||et;if(isNaN(U)||isNaN(vt))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return U.toFixed(vt).replace(/0+$/,"")};Ut=S.hpf=S.__private__.hpf=typeof m=="number"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return ee(U,m)}:m==="smart"?function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return ee(U,U>-1&&U<1?16:5)}:function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.hpf");return ee(U,16)};var oe=S.f2=S.__private__.f2=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f2");return ee(U,2)},ht=S.__private__.f3=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.f3");return ee(U,3)},At=S.scale=S.__private__.scale=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.scale");return ct===rt.COMPAT?U*Ye:ct===rt.ADVANCED?U:void 0},Ft=function(U){return ct===rt.COMPAT?gs()-U:ct===rt.ADVANCED?U:void 0},St=function(U){return At(Ft(U))};S.__private__.setPrecision=S.setPrecision=function(U){typeof parseInt(U,10)=="number"&&(t=parseInt(U,10))};var ue,ce="00000000000000000000000000000000",ae=S.__private__.getFileId=function(){return ce},se=S.__private__.setFileId=function(U){return ce=U!==void 0&&/^[a-fA-F0-9]{32}$/.test(U)?U.toUpperCase():ce.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),_!==null&&(Ti=new ch(_.userPermissions,_.userPassword,_.ownerPassword,ce)),ce};S.setFileId=function(U){return se(U),this},S.getFileId=function(){return ae()};var Lt=S.__private__.convertDateToPDFDate=function(U){var et=U.getTimezoneOffset(),vt=et<0?"+":"-",Dt=Math.floor(Math.abs(et/60)),de=Math.abs(et%60),Ce=[vt,bt(Dt),"'",bt(de),"'"].join("");return["D:",U.getFullYear(),bt(U.getMonth()+1),bt(U.getDate()),bt(U.getHours()),bt(U.getMinutes()),bt(U.getSeconds()),Ce].join("")},Ht=S.__private__.convertPDFDateToDate=function(U){var et=parseInt(U.substr(2,4),10),vt=parseInt(U.substr(6,2),10)-1,Dt=parseInt(U.substr(8,2),10),de=parseInt(U.substr(10,2),10),Ce=parseInt(U.substr(12,2),10),Ke=parseInt(U.substr(14,2),10);return new Date(et,vt,Dt,de,Ce,Ke,0)},fe=S.__private__.setCreationDate=function(U){var et;if(U===void 0&&(U=new Date),U instanceof Date)et=Lt(U);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(U))throw new Error("Invalid argument passed to jsPDF.setCreationDate");et=U}return ue=et},j=S.__private__.getCreationDate=function(U){var et=ue;return U==="jsDate"&&(et=Ht(ue)),et};S.setCreationDate=function(U){return fe(U),this},S.getCreationDate=function(U){return j(U)};var It,bt=S.__private__.padd2=function(U){return("0"+parseInt(U)).slice(-2)},Vt=S.__private__.padd2Hex=function(U){return("00"+(U=U.toString())).substr(U.length)},Xt=0,he=[],me=[],be=0,Ve=[],De=[],ei=!1,ri=me,Ii=function(){Xt=0,be=0,me=[],he=[],Ve=[],fi=si(),bi=si()};S.__private__.setCustomOutputDestination=function(U){ei=!0,ri=U};var Be=function(U){ei||(ri=U)};S.__private__.resetCustomOutputDestination=function(){ei=!1,ri=me};var Rt=S.__private__.out=function(U){return U=U.toString(),be+=U.length+1,ri.push(U),ri},Ui=S.__private__.write=function(U){return Rt(arguments.length===1?U.toString():Array.prototype.join.call(arguments," "))},$t=S.__private__.getArrayBuffer=function(U){for(var et=U.length,vt=new ArrayBuffer(et),Dt=new Uint8Array(vt);et--;)Dt[et]=U.charCodeAt(et);return vt},Ze=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];S.__private__.getStandardFonts=function(){return Ze};var We=i.fontSize||16;S.__private__.setFontSize=S.setFontSize=function(U){return We=ct===rt.ADVANCED?U/Ye:U,this};var He,Re=S.__private__.getFontSize=S.getFontSize=function(){return ct===rt.COMPAT?We:We*Ye},hi=i.R2L||!1;S.__private__.setR2L=S.setR2L=function(U){return hi=U,this},S.__private__.getR2L=S.getR2L=function(){return hi};var yi,Qi=S.__private__.setZoomMode=function(U){var et=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(U))He=U;else if(isNaN(U)){if(et.indexOf(U)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+U+'" is not recognized.');He=U}else He=parseInt(U,10)};S.__private__.getZoomMode=function(){return He};var Pi,zi=S.__private__.setPageMode=function(U){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(U)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+U+'" is not recognized.');yi=U};S.__private__.getPageMode=function(){return yi};var ir=S.__private__.setLayoutMode=function(U){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(U)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+U+'" is not recognized.');Pi=U};S.__private__.getLayoutMode=function(){return Pi},S.__private__.setDisplayMode=S.setDisplayMode=function(U,et,vt){return Qi(U),ir(et),zi(vt),this};var Ei={title:"",subject:"",author:"",keywords:"",creator:""};S.__private__.getDocumentProperty=function(U){if(Object.keys(Ei).indexOf(U)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ei[U]},S.__private__.getDocumentProperties=function(){return Ei},S.__private__.setDocumentProperties=S.setProperties=S.setDocumentProperties=function(U){for(var et in Ei)Ei.hasOwnProperty(et)&&U[et]&&(Ei[et]=U[et]);return this},S.__private__.setDocumentProperty=function(U,et){if(Object.keys(Ei).indexOf(U)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ei[U]=et};var Fe,Ye,Ki,ji,vr,Qe={},gi={},Bi=[],Oi={},Fr={},pi={},Pr={},gt=null,Y=0,q=[],lt=new b5(S),_t=i.hotfixes||[],xt={},qt={},Jt=[],mt=function U(et,vt,Dt,de,Ce,Ke){if(!(this instanceof U))return new U(et,vt,Dt,de,Ce,Ke);isNaN(et)&&(et=1),isNaN(vt)&&(vt=0),isNaN(Dt)&&(Dt=0),isNaN(de)&&(de=1),isNaN(Ce)&&(Ce=0),isNaN(Ke)&&(Ke=0),this._matrix=[et,vt,Dt,de,Ce,Ke]};Object.defineProperty(mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(U){this._matrix[0]=U}}),Object.defineProperty(mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(U){this._matrix[1]=U}}),Object.defineProperty(mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(U){this._matrix[2]=U}}),Object.defineProperty(mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(U){this._matrix[3]=U}}),Object.defineProperty(mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(U){this._matrix[4]=U}}),Object.defineProperty(mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(U){this._matrix[5]=U}}),Object.defineProperty(mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mt.prototype.join=function(U){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(Ut).join(U)},mt.prototype.multiply=function(U){var et=U.sx*this.sx+U.shy*this.shx,vt=U.sx*this.shy+U.shy*this.sy,Dt=U.shx*this.sx+U.sy*this.shx,de=U.shx*this.shy+U.sy*this.sy,Ce=U.tx*this.sx+U.ty*this.shx+this.tx,Ke=U.tx*this.shy+U.ty*this.sy+this.ty;return new mt(et,vt,Dt,de,Ce,Ke)},mt.prototype.decompose=function(){var U=this.sx,et=this.shy,vt=this.shx,Dt=this.sy,de=this.tx,Ce=this.ty,Ke=Math.sqrt(U*U+et*et),ti=(U/=Ke)*vt+(et/=Ke)*Dt;vt-=U*ti,Dt-=et*ti;var di=Math.sqrt(vt*vt+Dt*Dt);return ti/=di,U*(Dt/=di)<et*(vt/=di)&&(U=-U,et=-et,ti=-ti,Ke=-Ke),{scale:new mt(Ke,0,0,di,0,0),translate:new mt(1,0,0,1,de,Ce),rotate:new mt(U,et,-et,U,0,0),skew:new mt(1,0,ti,1,0,0)}},mt.prototype.toString=function(U){return this.join(" ")},mt.prototype.inversed=function(){var U=this.sx,et=this.shy,vt=this.shx,Dt=this.sy,de=this.tx,Ce=this.ty,Ke=1/(U*Dt-et*vt),ti=Dt*Ke,di=-et*Ke,tr=-vt*Ke,cr=U*Ke;return new mt(ti,di,tr,cr,-ti*de-tr*Ce,-di*de-cr*Ce)},mt.prototype.applyToPoint=function(U){var et=U.x*this.sx+U.y*this.shx+this.tx,vt=U.x*this.shy+U.y*this.sy+this.ty;return new va(et,vt)},mt.prototype.applyToRectangle=function(U){var et=this.applyToPoint(U),vt=this.applyToPoint(new va(U.x+U.w,U.y+U.h));return new Ha(et.x,et.y,vt.x-et.x,vt.y-et.y)},mt.prototype.clone=function(){var U=this.sx,et=this.shy,vt=this.shx,Dt=this.sy,de=this.tx,Ce=this.ty;return new mt(U,et,vt,Dt,de,Ce)},S.Matrix=mt;var jt=S.matrixMult=function(U,et){return et.multiply(U)},_e=new mt(1,0,0,1,0,0);S.unitMatrix=S.identityMatrix=_e;var ve=function(U,et){if(!Fr[U]){var vt=(et instanceof cu?"Sh":"P")+(Object.keys(Oi).length+1).toString(10);et.id=vt,Fr[U]=vt,Oi[vt]=et,lt.publish("addPattern",et)}};S.ShadingPattern=cu,S.TilingPattern=hh,S.addShadingPattern=function(U,et){return dt("addShadingPattern()"),ve(U,et),this},S.beginTilingPattern=function(U){dt("beginTilingPattern()"),qA(U.boundingBox[0],U.boundingBox[1],U.boundingBox[2]-U.boundingBox[0],U.boundingBox[3]-U.boundingBox[1],U.matrix)},S.endTilingPattern=function(U,et){dt("endTilingPattern()"),et.stream=De[It].join(`
`),ve(U,et),lt.publish("endTilingPattern",et),Jt.pop().restore()};var xe=S.__private__.newObject=function(){var U=si();return _i(U,!0),U},si=S.__private__.newObjectDeferred=function(){return Xt++,he[Xt]=function(){return be},Xt},_i=function(U,et){return et=typeof et=="boolean"&&et,he[U]=be,et&&Rt(U+" 0 obj"),U},ui=S.__private__.newAdditionalObject=function(){var U={objId:si(),content:""};return Ve.push(U),U},fi=si(),bi=si(),$i=S.__private__.decodeColorString=function(U){var et=U.split(" ");if(et.length!==2||et[1]!=="g"&&et[1]!=="G")et.length===5&&(et[4]==="k"||et[4]==="K")&&(et=[(1-et[0])*(1-et[3]),(1-et[1])*(1-et[3]),(1-et[2])*(1-et[3]),"r"]);else{var vt=parseFloat(et[0]);et=[vt,vt,vt,"r"]}for(var Dt="#",de=0;de<3;de++)Dt+=("0"+Math.floor(255*parseFloat(et[de])).toString(16)).slice(-2);return Dt},or=S.__private__.encodeColorString=function(U){var et;typeof U=="string"&&(U={ch1:U});var vt=U.ch1,Dt=U.ch2,de=U.ch3,Ce=U.ch4,Ke=U.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof vt=="string"&&vt.charAt(0)!=="#"){var ti=new D5(vt);if(ti.ok)vt=ti.toHex();else if(!/^\d*\.?\d*$/.test(vt))throw new Error('Invalid color "'+vt+'" passed to jsPDF.encodeColorString.')}if(typeof vt=="string"&&/^#[0-9A-Fa-f]{3}$/.test(vt)&&(vt="#"+vt[1]+vt[1]+vt[2]+vt[2]+vt[3]+vt[3]),typeof vt=="string"&&/^#[0-9A-Fa-f]{6}$/.test(vt)){var di=parseInt(vt.substr(1),16);vt=di>>16&255,Dt=di>>8&255,de=255&di}if(Dt===void 0||Ce===void 0&&vt===Dt&&Dt===de)if(typeof vt=="string")et=vt+" "+Ke[0];else switch(U.precision){case 2:et=oe(vt/255)+" "+Ke[0];break;case 3:default:et=ht(vt/255)+" "+Ke[0]}else if(Ce===void 0||Nr(Ce)==="object"){if(Ce&&!isNaN(Ce.a)&&Ce.a===0)return et=["1.","1.","1.",Ke[1]].join(" ");if(typeof vt=="string")et=[vt,Dt,de,Ke[1]].join(" ");else switch(U.precision){case 2:et=[oe(vt/255),oe(Dt/255),oe(de/255),Ke[1]].join(" ");break;default:case 3:et=[ht(vt/255),ht(Dt/255),ht(de/255),Ke[1]].join(" ")}}else if(typeof vt=="string")et=[vt,Dt,de,Ce,Ke[2]].join(" ");else switch(U.precision){case 2:et=[oe(vt),oe(Dt),oe(de),oe(Ce),Ke[2]].join(" ");break;case 3:default:et=[ht(vt),ht(Dt),ht(de),ht(Ce),Ke[2]].join(" ")}return et},Ji=S.__private__.getFilters=function(){return g},Mi=S.__private__.putStream=function(U){var et=(U=U||{}).data||"",vt=U.filters||Ji(),Dt=U.alreadyAppliedFilters||[],de=U.addLength1||!1,Ce=et.length,Ke=U.objectId,ti=function(Sn){return Sn};if(_!==null&&Ke===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");_!==null&&(ti=Ti.encryptor(Ke,0));var di={};vt===!0&&(vt=["FlateEncode"]);var tr=U.additionalKeyValues||[],cr=(di=nr.API.processDataByFilters!==void 0?nr.API.processDataByFilters(et,vt):{data:et,reverseChain:[]}).reverseChain+(Array.isArray(Dt)?Dt.join(" "):Dt.toString());if(di.data.length!==0&&(tr.push({key:"Length",value:di.data.length}),de===!0&&tr.push({key:"Length1",value:Ce})),cr.length!=0)if(cr.split("/").length-1==1)tr.push({key:"Filter",value:cr});else{tr.push({key:"Filter",value:"["+cr+"]"});for(var Cr=0;Cr<tr.length;Cr+=1)if(tr[Cr].key==="DecodeParms"){for(var Jr=[],en=0;en<di.reverseChain.split("/").length-1;en+=1)Jr.push("null");Jr.push(tr[Cr].value),tr[Cr].value="["+Jr.join(" ")+"]"}}Rt("<<");for(var pn=0;pn<tr.length;pn++)Rt("/"+tr[pn].key+" "+tr[pn].value);Rt(">>"),di.data.length!==0&&(Rt("stream"),Rt(ti(di.data)),Rt("endstream"))},kr=S.__private__.putPage=function(U){var et=U.number,vt=U.data,Dt=U.objId,de=U.contentsObjId;_i(Dt,!0),Rt("<</Type /Page"),Rt("/Parent "+U.rootDictionaryObjId+" 0 R"),Rt("/Resources "+U.resourceDictionaryObjId+" 0 R"),Rt("/MediaBox ["+parseFloat(Ut(U.mediaBox.bottomLeftX))+" "+parseFloat(Ut(U.mediaBox.bottomLeftY))+" "+Ut(U.mediaBox.topRightX)+" "+Ut(U.mediaBox.topRightY)+"]"),U.cropBox!==null&&Rt("/CropBox ["+Ut(U.cropBox.bottomLeftX)+" "+Ut(U.cropBox.bottomLeftY)+" "+Ut(U.cropBox.topRightX)+" "+Ut(U.cropBox.topRightY)+"]"),U.bleedBox!==null&&Rt("/BleedBox ["+Ut(U.bleedBox.bottomLeftX)+" "+Ut(U.bleedBox.bottomLeftY)+" "+Ut(U.bleedBox.topRightX)+" "+Ut(U.bleedBox.topRightY)+"]"),U.trimBox!==null&&Rt("/TrimBox ["+Ut(U.trimBox.bottomLeftX)+" "+Ut(U.trimBox.bottomLeftY)+" "+Ut(U.trimBox.topRightX)+" "+Ut(U.trimBox.topRightY)+"]"),U.artBox!==null&&Rt("/ArtBox ["+Ut(U.artBox.bottomLeftX)+" "+Ut(U.artBox.bottomLeftY)+" "+Ut(U.artBox.topRightX)+" "+Ut(U.artBox.topRightY)+"]"),typeof U.userUnit=="number"&&U.userUnit!==1&&Rt("/UserUnit "+U.userUnit),lt.publish("putPage",{objId:Dt,pageContext:q[et],pageNumber:et,page:vt}),Rt("/Contents "+de+" 0 R"),Rt(">>"),Rt("endobj");var Ce=vt.join(`
`);return ct===rt.ADVANCED&&(Ce+=`
Q`),_i(de,!0),Mi({data:Ce,filters:Ji(),objectId:de}),Rt("endobj"),Dt},Nt=S.__private__.putPages=function(){var U,et,vt=[];for(U=1;U<=Y;U++)q[U].objId=si(),q[U].contentsObjId=si();for(U=1;U<=Y;U++)vt.push(kr({number:U,data:De[U],objId:q[U].objId,contentsObjId:q[U].contentsObjId,mediaBox:q[U].mediaBox,cropBox:q[U].cropBox,bleedBox:q[U].bleedBox,trimBox:q[U].trimBox,artBox:q[U].artBox,userUnit:q[U].userUnit,rootDictionaryObjId:fi,resourceDictionaryObjId:bi}));_i(fi,!0),Rt("<</Type /Pages");var Dt="/Kids [";for(et=0;et<Y;et++)Dt+=vt[et]+" 0 R ";Rt(Dt+"]"),Rt("/Count "+Y),Rt(">>"),Rt("endobj"),lt.publish("postPutPages")},ze=function(U){lt.publish("putFont",{font:U,out:Rt,newObject:xe,putStream:Mi}),U.isAlreadyPutted!==!0&&(U.objectNumber=xe(),Rt("<<"),Rt("/Type /Font"),Rt("/BaseFont /"+uh(U.postScriptName)),Rt("/Subtype /Type1"),typeof U.encoding=="string"&&Rt("/Encoding /"+U.encoding),Rt("/FirstChar 32"),Rt("/LastChar 255"),Rt(">>"),Rt("endobj"))},Ne=function(){for(var U in Qe)Qe.hasOwnProperty(U)&&(E===!1||E===!0&&G.hasOwnProperty(U))&&ze(Qe[U])},Wi=function(U){U.objectNumber=xe();var et=[];et.push({key:"Type",value:"/XObject"}),et.push({key:"Subtype",value:"/Form"}),et.push({key:"BBox",value:"["+[Ut(U.x),Ut(U.y),Ut(U.x+U.width),Ut(U.y+U.height)].join(" ")+"]"}),et.push({key:"Matrix",value:"["+U.matrix.toString()+"]"});var vt=U.pages[1].join(`
`);Mi({data:vt,additionalKeyValues:et,objectId:U.objectNumber}),Rt("endobj")},Lr=function(){for(var U in xt)xt.hasOwnProperty(U)&&Wi(xt[U])},$r=function(U,et){var vt,Dt=[],de=1/(et-1);for(vt=0;vt<1;vt+=de)Dt.push(vt);if(Dt.push(1),U[0].offset!=0){var Ce={offset:0,color:U[0].color};U.unshift(Ce)}if(U[U.length-1].offset!=1){var Ke={offset:1,color:U[U.length-1].color};U.push(Ke)}for(var ti="",di=0,tr=0;tr<Dt.length;tr++){for(vt=Dt[tr];vt>U[di+1].offset;)di++;var cr=U[di].offset,Cr=(vt-cr)/(U[di+1].offset-cr),Jr=U[di].color,en=U[di+1].color;ti+=Vt(Math.round((1-Cr)*Jr[0]+Cr*en[0]).toString(16))+Vt(Math.round((1-Cr)*Jr[1]+Cr*en[1]).toString(16))+Vt(Math.round((1-Cr)*Jr[2]+Cr*en[2]).toString(16))}return ti.trim()},Qr=function(U,et){et||(et=21);var vt=xe(),Dt=$r(U.colors,et),de=[];de.push({key:"FunctionType",value:"0"}),de.push({key:"Domain",value:"[0.0 1.0]"}),de.push({key:"Size",value:"["+et+"]"}),de.push({key:"BitsPerSample",value:"8"}),de.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),de.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Mi({data:Dt,additionalKeyValues:de,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:vt}),Rt("endobj"),U.objectNumber=xe(),Rt("<< /ShadingType "+U.type),Rt("/ColorSpace /DeviceRGB");var Ce="/Coords ["+Ut(parseFloat(U.coords[0]))+" "+Ut(parseFloat(U.coords[1]))+" ";U.type===2?Ce+=Ut(parseFloat(U.coords[2]))+" "+Ut(parseFloat(U.coords[3])):Ce+=Ut(parseFloat(U.coords[2]))+" "+Ut(parseFloat(U.coords[3]))+" "+Ut(parseFloat(U.coords[4]))+" "+Ut(parseFloat(U.coords[5])),Rt(Ce+="]"),U.matrix&&Rt("/Matrix ["+U.matrix.toString()+"]"),Rt("/Function "+vt+" 0 R"),Rt("/Extend [true true]"),Rt(">>"),Rt("endobj")},uo=function(U,et){var vt=si(),Dt=xe();et.push({resourcesOid:vt,objectOid:Dt}),U.objectNumber=Dt;var de=[];de.push({key:"Type",value:"/Pattern"}),de.push({key:"PatternType",value:"1"}),de.push({key:"PaintType",value:"1"}),de.push({key:"TilingType",value:"1"}),de.push({key:"BBox",value:"["+U.boundingBox.map(Ut).join(" ")+"]"}),de.push({key:"XStep",value:Ut(U.xStep)}),de.push({key:"YStep",value:Ut(U.yStep)}),de.push({key:"Resources",value:vt+" 0 R"}),U.matrix&&de.push({key:"Matrix",value:"["+U.matrix.toString()+"]"}),Mi({data:U.stream,additionalKeyValues:de,objectId:U.objectNumber}),Rt("endobj")},qi=function(U){var et;for(et in Oi)Oi.hasOwnProperty(et)&&(Oi[et]instanceof cu?Qr(Oi[et]):Oi[et]instanceof hh&&uo(Oi[et],U))},An=function(U){for(var et in U.objectNumber=xe(),Rt("<<"),U)switch(et){case"opacity":Rt("/ca "+oe(U[et]));break;case"stroke-opacity":Rt("/CA "+oe(U[et]))}Rt(">>"),Rt("endobj")},ho=function(){var U;for(U in pi)pi.hasOwnProperty(U)&&An(pi[U])},dn=function(){for(var U in Rt("/XObject <<"),xt)xt.hasOwnProperty(U)&&xt[U].objectNumber>=0&&Rt("/"+U+" "+xt[U].objectNumber+" 0 R");lt.publish("putXobjectDict"),Rt(">>")},Mn=function(){Ti.oid=xe(),Rt("<<"),Rt("/Filter /Standard"),Rt("/V "+Ti.v),Rt("/R "+Ti.r),Rt("/U <"+Ti.toHexString(Ti.U)+">"),Rt("/O <"+Ti.toHexString(Ti.O)+">"),Rt("/P "+Ti.P),Rt(">>"),Rt("endobj")},Ca=function(){for(var U in Rt("/Font <<"),Qe)Qe.hasOwnProperty(U)&&(E===!1||E===!0&&G.hasOwnProperty(U))&&Rt("/"+U+" "+Qe[U].objectNumber+" 0 R");Rt(">>")},Ln=function(){if(Object.keys(Oi).length>0){for(var U in Rt("/Shading <<"),Oi)Oi.hasOwnProperty(U)&&Oi[U]instanceof cu&&Oi[U].objectNumber>=0&&Rt("/"+U+" "+Oi[U].objectNumber+" 0 R");lt.publish("putShadingPatternDict"),Rt(">>")}},zr=function(U){if(Object.keys(Oi).length>0){for(var et in Rt("/Pattern <<"),Oi)Oi.hasOwnProperty(et)&&Oi[et]instanceof S.TilingPattern&&Oi[et].objectNumber>=0&&Oi[et].objectNumber<U&&Rt("/"+et+" "+Oi[et].objectNumber+" 0 R");lt.publish("putTilingPatternDict"),Rt(">>")}},Ia=function(){if(Object.keys(pi).length>0){var U;for(U in Rt("/ExtGState <<"),pi)pi.hasOwnProperty(U)&&pi[U].objectNumber>=0&&Rt("/"+U+" "+pi[U].objectNumber+" 0 R");lt.publish("putGStateDict"),Rt(">>")}},Ur=function(U){_i(U.resourcesOid,!0),Rt("<<"),Rt("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ca(),Ln(),zr(U.objectOid),Ia(),dn(),Rt(">>"),Rt("endobj")},Hr=function(){var U=[];Ne(),ho(),Lr(),qi(U),lt.publish("putResources"),U.forEach(Ur),Ur({resourcesOid:bi,objectOid:Number.MAX_SAFE_INTEGER}),lt.publish("postPutResources")},pr=function(){lt.publish("putAdditionalObjects");for(var U=0;U<Ve.length;U++){var et=Ve[U];_i(et.objId,!0),Rt(et.content),Rt("endobj")}lt.publish("postPutAdditionalObjects")},Js=function(U){gi[U.fontName]=gi[U.fontName]||{},gi[U.fontName][U.fontStyle]=U.id},Gr=function(U,et,vt,Dt,de){var Ce={id:"F"+(Object.keys(Qe).length+1).toString(10),postScriptName:U,fontName:et,fontStyle:vt,encoding:Dt,isStandardFont:de||!1,metadata:{}};return lt.publish("addFont",{font:Ce,instance:this}),Qe[Ce.id]=Ce,Js(Ce),Ce.id},pt=function(U){for(var et=0,vt=Ze.length;et<vt;et++){var Dt=Gr.call(this,U[et][0],U[et][1],U[et][2],Ze[et][3],!0);E===!1&&(G[Dt]=!0);var de=U[et][0].split("-");Js({id:Dt,fontName:de[0],fontStyle:de[1]||""})}lt.publish("addFonts",{fonts:Qe,dictionary:gi})},ft=function(U){return U.foo=function(){try{return U.apply(this,arguments)}catch(Dt){var et=Dt.stack||"";~et.indexOf(" at ")&&(et=et.split(" at ")[1]);var vt="Error in function "+et.split(`
`)[0].split("<")[0]+": "+Dt.message;if(!sr.console)throw new Error(vt);sr.console.error(vt,Dt),sr.alert&&alert(vt)}},U.foo.bar=U,U.foo},ut=function(U,et){var vt,Dt,de,Ce,Ke,ti,di,tr,cr;if(de=(et=et||{}).sourceEncoding||"Unicode",Ke=et.outputEncoding,(et.autoencode||Ke)&&Qe[Fe].metadata&&Qe[Fe].metadata[de]&&Qe[Fe].metadata[de].encoding&&(Ce=Qe[Fe].metadata[de].encoding,!Ke&&Qe[Fe].encoding&&(Ke=Qe[Fe].encoding),!Ke&&Ce.codePages&&(Ke=Ce.codePages[0]),typeof Ke=="string"&&(Ke=Ce[Ke]),Ke)){for(di=!1,ti=[],vt=0,Dt=U.length;vt<Dt;vt++)(tr=Ke[U.charCodeAt(vt)])?ti.push(String.fromCharCode(tr)):ti.push(U[vt]),ti[vt].charCodeAt(0)>>8&&(di=!0);U=ti.join("")}for(vt=U.length;di===void 0&&vt!==0;)U.charCodeAt(vt-1)>>8&&(di=!0),vt--;if(!di)return U;for(ti=et.noBOM?[]:[254,255],vt=0,Dt=U.length;vt<Dt;vt++){if((cr=(tr=U.charCodeAt(vt))>>8)>>8)throw new Error("Character at position "+vt+" of string '"+U+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ti.push(cr),ti.push(tr-(cr<<8))}return String.fromCharCode.apply(void 0,ti)},Zt=S.__private__.pdfEscape=S.pdfEscape=function(U,et){return ut(U,et).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Kt=S.__private__.beginPage=function(U){De[++Y]=[],q[Y]={objId:0,contentsObjId:0,userUnit:Number(h),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(U[0]),topRightY:Number(U[1])}},Ue(Y),Be(De[It])},ie=function(U,et){var vt,Dt,de;switch(e=et||e,typeof U=="string"&&(vt=z(U.toLowerCase()),Array.isArray(vt)&&(Dt=vt[0],de=vt[1])),Array.isArray(U)&&(Dt=U[0]*Ye,de=U[1]*Ye),isNaN(Dt)&&(Dt=l[0],de=l[1]),(Dt>14400||de>14400)&&(hn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Dt=Math.min(14400,Dt),de=Math.min(14400,de)),l=[Dt,de],e.substr(0,1)){case"l":de>Dt&&(l=[de,Dt]);break;case"p":Dt>de&&(l=[de,Dt])}Kt(l),bA(ba),Rt(ns),jA!==0&&Rt(jA+" J"),Ra!==0&&Rt(Ra+" j"),lt.publish("addPage",{pageNumber:Y})},ge=function(U){U>0&&U<=Y&&(De.splice(U,1),q.splice(U,1),Y--,It>Y&&(It=Y),this.setPage(It))},Ue=function(U){U>0&&U<=Y&&(It=U)},Ee=S.__private__.getNumberOfPages=S.getNumberOfPages=function(){return De.length-1},Se=function(U,et,vt){var Dt,de=void 0;return vt=vt||{},U=U!==void 0?U:Qe[Fe].fontName,et=et!==void 0?et:Qe[Fe].fontStyle,Dt=U.toLowerCase(),gi[Dt]!==void 0&&gi[Dt][et]!==void 0?de=gi[Dt][et]:gi[U]!==void 0&&gi[U][et]!==void 0?de=gi[U][et]:vt.disableWarning===!1&&hn.warn("Unable to look up font label for font '"+U+"', '"+et+"'. Refer to getFontList() for available fonts."),de||vt.noFallback||(de=gi.times[et])==null&&(de=gi.times.normal),de},le=S.__private__.putInfo=function(){var U=xe(),et=function(Dt){return Dt};for(var vt in _!==null&&(et=Ti.encryptor(U,0)),Rt("<<"),Rt("/Producer ("+Zt(et("jsPDF "+nr.version))+")"),Ei)Ei.hasOwnProperty(vt)&&Ei[vt]&&Rt("/"+vt.substr(0,1).toUpperCase()+vt.substr(1)+" ("+Zt(et(Ei[vt]))+")");Rt("/CreationDate ("+Zt(et(ue))+")"),Rt(">>"),Rt("endobj")},ke=S.__private__.putCatalog=function(U){var et=(U=U||{}).rootDictionaryObjId||fi;switch(xe(),Rt("<<"),Rt("/Type /Catalog"),Rt("/Pages "+et+" 0 R"),He||(He="fullwidth"),He){case"fullwidth":Rt("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Rt("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Rt("/OpenAction [3 0 R /Fit]");break;case"original":Rt("/OpenAction [3 0 R /XYZ null null 1]");break;default:var vt=""+He;vt.substr(vt.length-1)==="%"&&(He=parseInt(He)/100),typeof He=="number"&&Rt("/OpenAction [3 0 R /XYZ null null "+oe(He)+"]")}switch(Pi||(Pi="continuous"),Pi){case"continuous":Rt("/PageLayout /OneColumn");break;case"single":Rt("/PageLayout /SinglePage");break;case"two":case"twoleft":Rt("/PageLayout /TwoColumnLeft");break;case"tworight":Rt("/PageLayout /TwoColumnRight")}yi&&Rt("/PageMode /"+yi),lt.publish("putCatalog"),Rt(">>"),Rt("endobj")},Te=S.__private__.putTrailer=function(){Rt("trailer"),Rt("<<"),Rt("/Size "+(Xt+1)),Rt("/Root "+Xt+" 0 R"),Rt("/Info "+(Xt-1)+" 0 R"),_!==null&&Rt("/Encrypt "+Ti.oid+" 0 R"),Rt("/ID [ <"+ce+"> <"+ce+"> ]"),Rt(">>")},Pe=S.__private__.putHeader=function(){Rt("%PDF-"+O),Rt("%\xBA\xDF\xAC\xE0")},Gi=S.__private__.putXRef=function(){var U="0000000000";Rt("xref"),Rt("0 "+(Xt+1)),Rt("0000000000 65535 f ");for(var et=1;et<=Xt;et++)typeof he[et]=="function"?Rt((U+he[et]()).slice(-10)+" 00000 n "):he[et]!==void 0?Rt((U+he[et]).slice(-10)+" 00000 n "):Rt("0000000000 00000 n ")},Zi=S.__private__.buildDocument=function(){Ii(),Be(me),lt.publish("buildDocument"),Pe(),Nt(),pr(),Hr(),_!==null&&Mn(),le(),ke();var U=be;return Gi(),Te(),Rt("startxref"),Rt(""+U),Rt("%%EOF"),Be(De[It]),me.join(`
`)},Je=S.__private__.getBlob=function(U){return new Blob([$t(U)],{type:"application/pdf"})},Me=S.output=S.__private__.output=ft(function(U,et){switch(typeof(et=et||{})=="string"?et={filename:et}:et.filename=et.filename||"generated.pdf",U){case void 0:return Zi();case"save":S.save(et.filename);break;case"arraybuffer":return $t(Zi());case"blob":return Je(Zi());case"bloburi":case"bloburl":if(sr.URL!==void 0&&typeof sr.URL.createObjectURL=="function")return sr.URL&&sr.URL.createObjectURL(Je(Zi()))||void 0;hn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var vt="",Dt=Zi();try{vt=Py(Dt)}catch{vt=Py(unescape(encodeURIComponent(Dt)))}return"data:application/pdf;filename="+et.filename+";base64,"+vt;case"pdfobjectnewwindow":if(Object.prototype.toString.call(sr)==="[object Window]"){var de="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ce=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';et.pdfObjectUrl&&(de=et.pdfObjectUrl,Ce="");var Ke='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+de+'"'+Ce+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(et)+");<\/script></body></html>",ti=sr.open();return ti!==null&&ti.document.write(Ke),ti}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(sr)==="[object Window]"){var di='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(et.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+et.filename+'" width="500px" height="400px" /></body></html>',tr=sr.open();if(tr!==null){tr.document.write(di);var cr=this;tr.document.documentElement.querySelector("#pdfViewer").onload=function(){tr.document.title=et.filename,tr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(cr.output("bloburl"))}}return tr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(sr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Cr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",et)+'"></iframe></body></html>',Jr=sr.open();if(Jr!==null&&(Jr.document.write(Cr),Jr.document.title=et.filename),Jr||typeof safari>"u")return Jr;break;case"datauri":case"dataurl":return sr.document.location.href=this.output("datauristring",et);default:return null}}),Ci=function(U){return Array.isArray(_t)===!0&&_t.indexOf(U)>-1};switch(o){case"pt":Ye=1;break;case"mm":Ye=72/25.4;break;case"cm":Ye=72/2.54;break;case"in":Ye=72;break;case"px":Ye=Ci("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ye=12;break;case"ex":Ye=6;break;default:if(typeof o!="number")throw new Error("Invalid unit: "+o);Ye=o}var Ti=null;fe(),se();var Xi=function(U){return _!==null?Ti.encryptor(U,0):function(et){return et}},fr=S.__private__.getPageInfo=S.getPageInfo=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:q[U].objId,pageNumber:U,pageContext:q[U]}},mi=S.__private__.getPageInfoByObjId=function(U){if(isNaN(U)||U%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var et in q)if(q[et].objId===U)break;return fr(et)},Rr=S.__private__.getCurrentPageInfo=S.getCurrentPageInfo=function(){return{objId:q[It].objId,pageNumber:It,pageContext:q[It]}};S.addPage=function(){return ie.apply(this,arguments),this},S.setPage=function(){return Ue.apply(this,arguments),Be.call(this,De[It]),this},S.insertPage=function(U){return this.addPage(),this.movePage(It,U),this},S.movePage=function(U,et){var vt,Dt;if(U>et){vt=De[U],Dt=q[U];for(var de=U;de>et;de--)De[de]=De[de-1],q[de]=q[de-1];De[et]=vt,q[et]=Dt,this.setPage(et)}else if(U<et){vt=De[U],Dt=q[U];for(var Ce=U;Ce<et;Ce++)De[Ce]=De[Ce+1],q[Ce]=q[Ce+1];De[et]=vt,q[et]=Dt,this.setPage(et)}return this},S.deletePage=function(){return ge.apply(this,arguments),this},S.__private__.text=S.text=function(U,et,vt,Dt,de){var Ce,Ke,ti,di,tr,cr,Cr,Jr,en,pn=(Dt=Dt||{}).scope||this;if(typeof U=="number"&&typeof et=="number"&&(typeof vt=="string"||Array.isArray(vt))){var Sn=vt;vt=et,et=U,U=Sn}if(arguments[3]instanceof mt?(dt("The transform parameter of text() with a Matrix value"),en=de):(ti=arguments[4],di=arguments[5],Nr(Cr=arguments[3])==="object"&&Cr!==null||(typeof ti=="string"&&(di=ti,ti=null),typeof Cr=="string"&&(di=Cr,Cr=null),typeof Cr=="number"&&(ti=Cr,Cr=null),Dt={flags:Cr,angle:ti,align:di})),isNaN(et)||isNaN(vt)||U==null)throw new Error("Invalid arguments passed to jsPDF.text");if(U.length===0)return pn;var vn="",ds=!1,ss=typeof Dt.lineHeightFactor=="number"?Dt.lineHeightFactor:qo,Rs=pn.internal.scaleFactor;function Fl(Xr){return Xr=Xr.split("	").join(Array(Dt.TabLen||9).join(" ")),Zt(Xr,Cr)}function Na(Xr){for(var Vr,fn=Xr.concat(),mn=[],Bs=fn.length;Bs--;)typeof(Vr=fn.shift())=="string"?mn.push(Vr):Array.isArray(Xr)&&(Vr.length===1||Vr[1]===void 0&&Vr[2]===void 0)?mn.push(Vr[0]):mn.push([Vr[0],Vr[1],Vr[2]]);return mn}function $A(Xr,Vr){var fn;if(typeof Xr=="string")fn=Vr(Xr)[0];else if(Array.isArray(Xr)){for(var mn,Bs,as=Xr.concat(),li=[],Oa=as.length;Oa--;)typeof(mn=as.shift())=="string"?li.push(Vr(mn)[0]):Array.isArray(mn)&&typeof mn[0]=="string"&&(Bs=Vr(mn[0],mn[1],mn[2]),li.push([Bs[0],Bs[1],Bs[2]]));fn=li}return fn}var Pa=!1,Ba=!0;if(typeof U=="string")Pa=!0;else if(Array.isArray(U)){var Ma=U.concat();Ke=[];for(var Va,ps=Ma.length;ps--;)(typeof(Va=Ma.shift())!="string"||Array.isArray(Va)&&typeof Va[0]!="string")&&(Ba=!1);Pa=Ba}if(Pa===!1)throw new Error('Type of text must be string or Array. "'+U+'" is not recognized.');typeof U=="string"&&(U=U.match(/[\r?\n]/)?U.split(/\r\n|\r|\n/g):[U]);var Zo=We/pn.internal.scaleFactor,ea=Zo*(ss-1);switch(Dt.baseline){case"bottom":vt-=ea;break;case"top":vt+=Zo-ea;break;case"hanging":vt+=Zo-2*ea;break;case"middle":vt+=Zo/2-ea}if((cr=Dt.maxWidth||0)>0&&(typeof U=="string"?U=pn.splitTextToSize(U,cr):Object.prototype.toString.call(U)==="[object Array]"&&(U=U.reduce(function(Xr,Vr){return Xr.concat(pn.splitTextToSize(Vr,cr))},[]))),Ce={text:U,x:et,y:vt,options:Dt,mutex:{pdfEscape:Zt,activeFontKey:Fe,fonts:Qe,activeFontSize:We}},lt.publish("preProcessText",Ce),U=Ce.text,ti=(Dt=Ce.options).angle,!(en instanceof mt)&&ti&&typeof ti=="number"){ti*=Math.PI/180,Dt.rotationDirection===0&&(ti=-ti),ct===rt.ADVANCED&&(ti=-ti);var ia=Math.cos(ti),xA=Math.sin(ti);en=new mt(ia,xA,-xA,ia,0,0)}else ti&&ti instanceof mt&&(en=ti);ct!==rt.ADVANCED||en||(en=_e),(tr=Dt.charSpace||BA)!==void 0&&(vn+=Ut(At(tr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Jr=Dt.horizontalScale)!==void 0&&(vn+=Ut(100*Jr)+` Tz
`),Dt.lang;var Ir=-1,ra=Dt.renderingMode!==void 0?Dt.renderingMode:Dt.stroke,Tn=pn.internal.getCurrentPageInfo().pageContext;switch(ra){case 0:case!1:case"fill":Ir=0;break;case 1:case!0:case"stroke":Ir=1;break;case 2:case"fillThenStroke":Ir=2;break;case 3:case"invisible":Ir=3;break;case 4:case"fillAndAddForClipping":Ir=4;break;case 5:case"strokeAndAddPathForClipping":Ir=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ir=6;break;case 7:case"addToPathForClipping":Ir=7}var na=Tn.usedRenderingMode!==void 0?Tn.usedRenderingMode:-1;Ir!==-1?vn+=Ir+` Tr
`:na!==-1&&(vn+=`0 Tr
`),Ir!==-1&&(Tn.usedRenderingMode=Ir),di=Dt.align||"left";var fs,_a=We*ss,sa=pn.internal.pageSize.getWidth(),Da=Qe[Fe];tr=Dt.charSpace||BA,cr=Dt.maxWidth||0,Cr=Object.assign({autoencode:!0,noBOM:!0},Dt.flags);var Zs=[];if(Object.prototype.toString.call(U)==="[object Array]"){var Hs;Ke=Na(U),di!=="left"&&(fs=Ke.map(function(Xr){return pn.getStringUnitWidth(Xr,{font:Da,charSpace:tr,fontSize:We,doKerning:!1})*We/Rs}));var Ys,oa=0;if(di==="right"){et-=fs[0],U=[],ps=Ke.length;for(var fo=0;fo<ps;fo++)fo===0?(Ys=go(et),Hs=po(vt)):(Ys=At(oa-fs[fo]),Hs=-_a),U.push([Ke[fo],Ys,Hs]),oa=fs[fo]}else if(di==="center"){et-=fs[0]/2,U=[],ps=Ke.length;for(var Ho=0;Ho<ps;Ho++)Ho===0?(Ys=go(et),Hs=po(vt)):(Ys=At((oa-fs[Ho])/2),Hs=-_a),U.push([Ke[Ho],Ys,Hs]),oa=fs[Ho]}else if(di==="left"){U=[],ps=Ke.length;for(var ms=0;ms<ps;ms++)U.push(Ke[ms])}else{if(di!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');U=[],ps=Ke.length,cr=cr!==0?cr:sa;for(var Cs=0;Cs<ps;Cs++)Hs=Cs===0?po(vt):-_a,Ys=Cs===0?go(et):0,Cs<ps-1?Zs.push(Ut(At((cr-fs[Cs])/(Ke[Cs].split(" ").length-1)))):Zs.push(0),U.push([Ke[Cs],Ys,Hs])}}var Qn=typeof Dt.R2L=="boolean"?Dt.R2L:hi;Qn===!0&&(U=$A(U,function(Xr,Vr,fn){return[Xr.split("").reverse().join(""),Vr,fn]})),Ce={text:U,x:et,y:vt,options:Dt,mutex:{pdfEscape:Zt,activeFontKey:Fe,fonts:Qe,activeFontSize:We}},lt.publish("postProcessText",Ce),U=Ce.text,ds=Ce.mutex.isHex||!1;var aa=Qe[Fe].encoding;aa!=="WinAnsiEncoding"&&aa!=="StandardEncoding"||(U=$A(U,function(Xr,Vr,fn){return[Fl(Xr),Vr,fn]})),Ke=Na(U),U=[];for(var Aa,js,No,Is=0,Ka=1,Un=Array.isArray(Ke[0])?Ka:Is,os="",xa=function(Xr,Vr,fn){var mn="";return fn instanceof mt?(fn=typeof Dt.angle=="number"?jt(fn,new mt(1,0,0,1,Xr,Vr)):jt(new mt(1,0,0,1,Xr,Vr),fn),ct===rt.ADVANCED&&(fn=jt(new mt(1,0,0,-1,0,0),fn)),mn=fn.join(" ")+` Tm
`):mn=Ut(Xr)+" "+Ut(Vr)+` Td
`,mn},wn=0;wn<Ke.length;wn++){switch(os="",Un){case Ka:No=(ds?"<":"(")+Ke[wn][0]+(ds?">":")"),Aa=parseFloat(Ke[wn][1]),js=parseFloat(Ke[wn][2]);break;case Is:No=(ds?"<":"(")+Ke[wn]+(ds?">":")"),Aa=go(et),js=po(vt)}Zs!==void 0&&Zs[wn]!==void 0&&(os=Zs[wn]+` Tw
`),wn===0?U.push(os+xa(Aa,js,en)+No):Un===Is?U.push(os+No):Un===Ka&&U.push(os+xa(Aa,js,en)+No)}U=Un===Is?U.join(` Tj
T* `):U.join(` Tj
`),U+=` Tj
`;var Vn=`BT
/`;return Vn+=Fe+" "+We+` Tf
`,Vn+=Ut(We*ss)+` TL
`,Vn+=Ga+`
`,Vn+=vn,Vn+=U,Rt(Vn+="ET"),G[Fe]=!0,pn};var Kr=S.__private__.clip=S.clip=function(U){return Rt(U==="evenodd"?"W*":"W"),this};S.clipEvenOdd=function(){return Kr("evenodd")},S.__private__.discardPath=S.discardPath=function(){return Rt("n"),this};var Mr=S.__private__.isValidStyle=function(U){var et=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(U)!==-1&&(et=!0),et};S.__private__.setDefaultPathOperation=S.setDefaultPathOperation=function(U){return Mr(U)&&(B=U),this};var tn=S.__private__.getStyle=S.getStyle=function(U){var et=B;switch(U){case"D":case"S":et="S";break;case"F":et="f";break;case"FD":case"DF":et="B";break;case"f":case"f*":case"B":case"B*":et=U}return et},En=S.close=function(){return Rt("h"),this};S.stroke=function(){return Rt("S"),this},S.fill=function(U){return Xs("f",U),this},S.fillEvenOdd=function(U){return Xs("f*",U),this},S.fillStroke=function(U){return Xs("B",U),this},S.fillStrokeEvenOdd=function(U){return Xs("B*",U),this};var Xs=function(U,et){Nr(et)==="object"?ya(et,U):Rt(U)},jo=function(U){U===null||ct===rt.ADVANCED&&U===void 0||(U=tn(U),Rt(U))};function yA(U,et,vt,Dt,de){var Ce=new hh(et||this.boundingBox,vt||this.xStep,Dt||this.yStep,this.gState,de||this.matrix);Ce.stream=this.stream;var Ke=U+"$$"+this.cloneIndex+++"$$";return ve(Ke,Ce),Ce}var ya=function(U,et){var vt=Fr[U.key],Dt=Oi[vt];if(Dt instanceof cu)Rt("q"),Rt(Qo(et)),Dt.gState&&S.setGState(Dt.gState),Rt(U.matrix.toString()+" cm"),Rt("/"+vt+" sh"),Rt("Q");else if(Dt instanceof hh){var de=new mt(1,0,0,-1,0,gs());U.matrix&&(de=de.multiply(U.matrix||_e),vt=yA.call(Dt,U.key,U.boundingBox,U.xStep,U.yStep,de).id),Rt("q"),Rt("/Pattern cs"),Rt("/"+vt+" scn"),Dt.gState&&S.setGState(Dt.gState),Rt(et),Rt("Q")}},Qo=function(U){switch(U){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ar=S.moveTo=function(U,et){return Rt(Ut(At(U))+" "+Ut(St(et))+" m"),this},Uo=S.lineTo=function(U,et){return Rt(Ut(At(U))+" "+Ut(St(et))+" l"),this},bn=S.curveTo=function(U,et,vt,Dt,de,Ce){return Rt([Ut(At(U)),Ut(St(et)),Ut(At(vt)),Ut(St(Dt)),Ut(At(de)),Ut(St(Ce)),"c"].join(" ")),this};S.__private__.line=S.line=function(U,et,vt,Dt,de){if(isNaN(U)||isNaN(et)||isNaN(vt)||isNaN(Dt)||!Mr(de))throw new Error("Invalid arguments passed to jsPDF.line");return ct===rt.COMPAT?this.lines([[vt-U,Dt-et]],U,et,[1,1],de||"S"):this.lines([[vt-U,Dt-et]],U,et,[1,1]).stroke()},S.__private__.lines=S.lines=function(U,et,vt,Dt,de,Ce){var Ke,ti,di,tr,cr,Cr,Jr,en,pn,Sn,vn,ds;if(typeof U=="number"&&(ds=vt,vt=et,et=U,U=ds),Dt=Dt||[1,1],Ce=Ce||!1,isNaN(et)||isNaN(vt)||!Array.isArray(U)||!Array.isArray(Dt)||!Mr(de)||typeof Ce!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ar(et,vt),Ke=Dt[0],ti=Dt[1],tr=U.length,Sn=et,vn=vt,di=0;di<tr;di++)(cr=U[di]).length===2?(Sn=cr[0]*Ke+Sn,vn=cr[1]*ti+vn,Uo(Sn,vn)):(Cr=cr[0]*Ke+Sn,Jr=cr[1]*ti+vn,en=cr[2]*Ke+Sn,pn=cr[3]*ti+vn,Sn=cr[4]*Ke+Sn,vn=cr[5]*ti+vn,bn(Cr,Jr,en,pn,Sn,vn));return Ce&&En(),jo(de),this},S.path=function(U){for(var et=0;et<U.length;et++){var vt=U[et],Dt=vt.c;switch(vt.op){case"m":Ar(Dt[0],Dt[1]);break;case"l":Uo(Dt[0],Dt[1]);break;case"c":bn.apply(this,Dt);break;case"h":En()}}return this},S.__private__.rect=S.rect=function(U,et,vt,Dt,de){if(isNaN(U)||isNaN(et)||isNaN(vt)||isNaN(Dt)||!Mr(de))throw new Error("Invalid arguments passed to jsPDF.rect");return ct===rt.COMPAT&&(Dt=-Dt),Rt([Ut(At(U)),Ut(St(et)),Ut(At(vt)),Ut(At(Dt)),"re"].join(" ")),jo(de),this},S.__private__.triangle=S.triangle=function(U,et,vt,Dt,de,Ce,Ke){if(isNaN(U)||isNaN(et)||isNaN(vt)||isNaN(Dt)||isNaN(de)||isNaN(Ce)||!Mr(Ke))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[vt-U,Dt-et],[de-vt,Ce-Dt],[U-de,et-Ce]],U,et,[1,1],Ke,!0),this},S.__private__.roundedRect=S.roundedRect=function(U,et,vt,Dt,de,Ce,Ke){if(isNaN(U)||isNaN(et)||isNaN(vt)||isNaN(Dt)||isNaN(de)||isNaN(Ce)||!Mr(Ke))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ti=4/3*(Math.SQRT2-1);return de=Math.min(de,.5*vt),Ce=Math.min(Ce,.5*Dt),this.lines([[vt-2*de,0],[de*ti,0,de,Ce-Ce*ti,de,Ce],[0,Dt-2*Ce],[0,Ce*ti,-de*ti,Ce,-de,Ce],[2*de-vt,0],[-de*ti,0,-de,-Ce*ti,-de,-Ce],[0,2*Ce-Dt],[0,-Ce*ti,de*ti,-Ce,de,-Ce]],U+de,et,[1,1],Ke,!0),this},S.__private__.ellipse=S.ellipse=function(U,et,vt,Dt,de){if(isNaN(U)||isNaN(et)||isNaN(vt)||isNaN(Dt)||!Mr(de))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ce=4/3*(Math.SQRT2-1)*vt,Ke=4/3*(Math.SQRT2-1)*Dt;return Ar(U+vt,et),bn(U+vt,et-Ke,U+Ce,et-Dt,U,et-Dt),bn(U-Ce,et-Dt,U-vt,et-Ke,U-vt,et),bn(U-vt,et+Ke,U-Ce,et+Dt,U,et+Dt),bn(U+Ce,et+Dt,U+vt,et+Ke,U+vt,et),jo(de),this},S.__private__.circle=S.circle=function(U,et,vt,Dt){if(isNaN(U)||isNaN(et)||isNaN(vt)||!Mr(Dt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(U,et,vt,vt,Dt)},S.setFont=function(U,et,vt){return vt&&(et=Qt(et,vt)),Fe=Se(U,et,{disableWarning:!1}),this};var hs=S.__private__.getFont=S.getFont=function(){return Qe[Se.apply(S,arguments)]};S.__private__.getFontList=S.getFontList=function(){var U,et,vt={};for(U in gi)if(gi.hasOwnProperty(U))for(et in vt[U]=[],gi[U])gi[U].hasOwnProperty(et)&&vt[U].push(et);return vt},S.addFont=function(U,et,vt,Dt,de){var Ce=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ce.indexOf(arguments[3])!==-1?de=arguments[3]:arguments[3]&&Ce.indexOf(arguments[3])==-1&&(vt=Qt(vt,Dt)),de=de||"Identity-H",Gr.call(this,U,et,vt,de)};var qo,ba=i.lineWidth||.200025,$o=S.__private__.getLineWidth=S.getLineWidth=function(){return ba},bA=S.__private__.setLineWidth=S.setLineWidth=function(U){return ba=U,Rt(Ut(At(U))+" w"),this};S.__private__.setLineDash=nr.API.setLineDash=nr.API.setLineDashPattern=function(U,et){if(U=U||[],et=et||0,isNaN(et)||!Array.isArray(U))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return U=U.map(function(vt){return Ut(At(vt))}).join(" "),et=Ut(At(et)),Rt("["+U+"] "+et+" d"),this};var vA=S.__private__.getLineHeight=S.getLineHeight=function(){return We*qo};S.__private__.getLineHeight=S.getLineHeight=function(){return We*qo};var Ua=S.__private__.setLineHeightFactor=S.setLineHeightFactor=function(U){return typeof(U=U||1.15)=="number"&&(qo=U),this},wA=S.__private__.getLineHeightFactor=S.getLineHeightFactor=function(){return qo};Ua(i.lineHeight);var go=S.__private__.getHorizontalCoordinate=function(U){return At(U)},po=S.__private__.getVerticalCoordinate=function(U){return ct===rt.ADVANCED?U:q[It].mediaBox.topRightY-q[It].mediaBox.bottomLeftY-At(U)},xl=S.__private__.getHorizontalCoordinateString=S.getHorizontalCoordinateString=function(U){return Ut(go(U))},ta=S.__private__.getVerticalCoordinateString=S.getVerticalCoordinateString=function(U){return Ut(po(U))},ns=i.strokeColor||"0 G";S.__private__.getStrokeColor=S.getDrawColor=function(){return $i(ns)},S.__private__.setStrokeColor=S.setDrawColor=function(U,et,vt,Dt){return ns=or({ch1:U,ch2:et,ch3:vt,ch4:Dt,pdfColorType:"draw",precision:2}),Rt(ns),this};var YA=i.fillColor||"0 g";S.__private__.getFillColor=S.getFillColor=function(){return $i(YA)},S.__private__.setFillColor=S.setFillColor=function(U,et,vt,Dt){return YA=or({ch1:U,ch2:et,ch3:vt,ch4:Dt,pdfColorType:"fill",precision:2}),Rt(YA),this};var Ga=i.textColor||"0 g",Cc=S.__private__.getTextColor=S.getTextColor=function(){return $i(Ga)};S.__private__.setTextColor=S.setTextColor=function(U,et,vt,Dt){return Ga=or({ch1:U,ch2:et,ch3:vt,ch4:Dt,pdfColorType:"text",precision:3}),this};var BA=i.charSpace,Ic=S.__private__.getCharSpace=S.getCharSpace=function(){return parseFloat(BA||0)};S.__private__.setCharSpace=S.setCharSpace=function(U){if(isNaN(U))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return BA=U,this};var jA=0;S.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},S.__private__.setLineCap=S.setLineCap=function(U){var et=S.CapJoinStyles[U];if(et===void 0)throw new Error("Line cap style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return jA=et,Rt(et+" J"),this};var Ra=0;S.__private__.setLineJoin=S.setLineJoin=function(U){var et=S.CapJoinStyles[U];if(et===void 0)throw new Error("Line join style of '"+U+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ra=et,Rt(et+" j"),this},S.__private__.setLineMiterLimit=S.__private__.setMiterLimit=S.setLineMiterLimit=S.setMiterLimit=function(U){if(U=U||0,isNaN(U))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Rt(Ut(At(U))+" M"),this},S.GState=am,S.setGState=function(U){(U=typeof U=="string"?pi[Pr[U]]:Za(null,U)).equals(gt)||(Rt("/"+U.id+" gs"),gt=U)};var Za=function(U,et){if(!U||!Pr[U]){var vt=!1;for(var Dt in pi)if(pi.hasOwnProperty(Dt)&&pi[Dt].equals(et)){vt=!0;break}if(vt)et=pi[Dt];else{var de="GS"+(Object.keys(pi).length+1).toString(10);pi[de]=et,et.id=de}return U&&(Pr[U]=et.id),lt.publish("addGState",et),et}};S.addGState=function(U,et){return Za(U,et),this},S.saveGraphicsState=function(){return Rt("q"),Bi.push({key:Fe,size:We,color:Ga}),this},S.restoreGraphicsState=function(){Rt("Q");var U=Bi.pop();return Fe=U.key,We=U.size,Ga=U.color,gt=null,this},S.setCurrentTransformationMatrix=function(U){return Rt(U.toString()+" cm"),this},S.comment=function(U){return Rt("#"+U),this};var va=function(U,et){var vt=U||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return vt},set:function(Ce){isNaN(Ce)||(vt=parseFloat(Ce))}});var Dt=et||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Dt},set:function(Ce){isNaN(Ce)||(Dt=parseFloat(Ce))}});var de="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return de},set:function(Ce){de=Ce.toString()}}),this},Ha=function(U,et,vt,Dt){va.call(this,U,et),this.type="rect";var de=vt||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return de},set:function(Ke){isNaN(Ke)||(de=parseFloat(Ke))}});var Ce=Dt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ce},set:function(Ke){isNaN(Ke)||(Ce=parseFloat(Ke))}}),this},Go=function(){this.page=Y,this.currentPage=It,this.pages=De.slice(0),this.pagesContext=q.slice(0),this.x=Ki,this.y=ji,this.matrix=vr,this.width=Gs(It),this.height=gs(It),this.outputDestination=ri,this.id="",this.objectNumber=-1};Go.prototype.restore=function(){Y=this.page,It=this.currentPage,q=this.pagesContext,De=this.pages,Ki=this.x,ji=this.y,vr=this.matrix,_A(It,this.width),Ro(It,this.height),ri=this.outputDestination};var qA=function(U,et,vt,Dt,de){Jt.push(new Go),Y=It=0,De=[],Ki=U,ji=et,vr=de,Kt([vt,Dt])},Sl=function(U){if(qt[U])Jt.pop().restore();else{var et=new Go,vt="Xo"+(Object.keys(xt).length+1).toString(10);et.id=vt,qt[U]=vt,xt[vt]=et,lt.publish("addFormObject",et),Jt.pop().restore()}};for(var wa in S.beginFormObject=function(U,et,vt,Dt,de){return qA(U,et,vt,Dt,de),this},S.endFormObject=function(U){return Sl(U),this},S.doFormObject=function(U,et){var vt=xt[qt[U]];return Rt("q"),Rt(et.toString()+" cm"),Rt("/"+vt.id+" Do"),Rt("Q"),this},S.getFormObject=function(U){var et=xt[qt[U]];return{x:et.x,y:et.y,width:et.width,height:et.height,matrix:et.matrix}},S.save=function(U,et){return U=U||"generated.pdf",(et=et||{}).returnPromise=et.returnPromise||!1,et.returnPromise===!1?(lu(Je(Zi()),U),typeof lu.unload=="function"&&sr.setTimeout&&setTimeout(lu.unload,911),this):new Promise(function(vt,Dt){try{var de=lu(Je(Zi()),U);typeof lu.unload=="function"&&sr.setTimeout&&setTimeout(lu.unload,911),vt(de)}catch(Ce){Dt(Ce.message)}})},nr.API)nr.API.hasOwnProperty(wa)&&(wa==="events"&&nr.API.events.length?function(U,et){var vt,Dt,de;for(de=et.length-1;de!==-1;de--)vt=et[de][0],Dt=et[de][1],U.subscribe.apply(U,[vt].concat(typeof Dt=="function"?[Dt]:Dt))}(lt,nr.API.events):S[wa]=nr.API[wa]);var Gs=S.getPageWidth=function(U){return(q[U=U||It].mediaBox.topRightX-q[U].mediaBox.bottomLeftX)/Ye},_A=S.setPageWidth=function(U,et){q[U].mediaBox.topRightX=et*Ye+q[U].mediaBox.bottomLeftX},gs=S.getPageHeight=function(U){return(q[U=U||It].mediaBox.topRightY-q[U].mediaBox.bottomLeftY)/Ye},Ro=S.setPageHeight=function(U,et){q[U].mediaBox.topRightY=et*Ye+q[U].mediaBox.bottomLeftY};return S.internal={pdfEscape:Zt,getStyle:tn,getFont:hs,getFontSize:Re,getCharSpace:Ic,getTextColor:Cc,getLineHeight:vA,getLineHeightFactor:wA,getLineWidth:$o,write:Ui,getHorizontalCoordinate:go,getVerticalCoordinate:po,getCoordinateString:xl,getVerticalCoordinateString:ta,collections:{},newObject:xe,newAdditionalObject:ui,newObjectDeferred:si,newObjectDeferredBegin:_i,getFilters:Ji,putStream:Mi,events:lt,scaleFactor:Ye,pageSize:{getWidth:function(){return Gs(It)},setWidth:function(U){_A(It,U)},getHeight:function(){return gs(It)},setHeight:function(U){Ro(It,U)}},encryptionOptions:_,encryption:Ti,getEncryptor:Xi,output:Me,getNumberOfPages:Ee,pages:De,out:Rt,f2:oe,f3:ht,getPageInfo:fr,getPageInfoByObjId:mi,getCurrentPageInfo:Rr,getPDFVersion:P,Point:va,Rectangle:Ha,Matrix:mt,hasHotfix:Ci},Object.defineProperty(S.internal.pageSize,"width",{get:function(){return Gs(It)},set:function(U){_A(It,U)},enumerable:!0,configurable:!0}),Object.defineProperty(S.internal.pageSize,"height",{get:function(){return gs(It)},set:function(U){Ro(It,U)},enumerable:!0,configurable:!0}),pt.call(S,Ze),Fe="F1",ie(l,e),lt.publish("initialized"),S}function X5(i){return i.reduce(function(t,e,o){return t[e]=o,t},{})}function Oy(i){var t=i.family.replace(/"|'/g,"").toLowerCase(),e=function(n){return Y5[n=n||"normal"]?n:"normal"}(i.style),o=function(n){if(!n)return 400;if(typeof n=="number")return n>=100&&n<=900&&n%100==0?n:400;if(/^\d00$/.test(n))return parseInt(n);switch(n){case"bold":return 700;case"normal":default:return 400}}(i.weight),l=function(n){return typeof Ky[n=n||"normal"]=="number"?n:"normal"}(i.stretch);return{family:t,style:e,weight:o,stretch:l,src:i.src||[],ref:i.ref||{name:t,style:[l,e,o].join(" ")}}}function w5(i,t,e,o){var l;for(l=e;l>=0&&l<t.length;l+=o)if(i[t[l]])return i[t[l]];for(l=e;l>=0&&l<t.length;l-=o)if(i[t[l]])return i[t[l]]}function _5(i){return[i.stretch,i.style,i.weight,i.family].join(" ")}function jD(i,t,e){for(var o=(e=e||{}).defaultFontFamily||"times",l=Object.assign({},YD,e.genericFontFamilies||{}),n=null,g=null,h=0;h<t.length;++h)if(l[(n=Oy(t[h])).family]&&(n.family=l[n.family]),i.hasOwnProperty(n.family)){g=i[n.family];break}if(!(g=g||i[o]))throw new Error("Could not find a font-family for the rule '"+_5(n)+"' and default family '"+o+"'.");if(g=function(m,B){if(B[m])return B[m];var _=Ky[m],E=_<=Ky.normal?-1:1,G=w5(B,j5,_,E);if(!G)throw new Error("Could not find a matching font-stretch value for "+m);return G}(n.stretch,g),g=function(m,B){if(B[m])return B[m];for(var _=Y5[m],E=0;E<_.length;++E)if(B[_[E]])return B[_[E]];throw new Error("Could not find a matching font-style for "+m)}(n.style,g),!(g=function(m,B){if(B[m])return B[m];if(m===400&&B[500])return B[500];if(m===500&&B[400])return B[400];var _=XD[m],E=w5(B,q5,_,m<400?-1:1);if(!E)throw new Error("Could not find a matching font-weight for value "+m);return E}(n.weight,g)))throw new Error("Failed to resolve a font for the rule '"+_5(n)+"'.");return g}function x5(i){return i.trimLeft()}function qD(i,t){for(var e=0;e<i.length;){if(i.charAt(e)===t)return[i.substring(0,e),i.substring(e+1)];e+=1}return null}function $D(i){var t=i.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],i.substring(t[0].length)]}function eK(i){var t=0;if(i[t++]!==71||i[t++]!==73||i[t++]!==70||i[t++]!==56||(i[t++]+1&253)!=56||i[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=i[t++]|i[t++]<<8,o=i[t++]|i[t++]<<8,l=i[t++],n=l>>7,g=1<<(7&l)+1;i[t++],i[t++];var h=null,m=null;n&&(h=t,m=g,t+=3*g);var B=!0,_=[],E=0,G=null,S=0,O=null;for(this.width=e,this.height=o;B&&t<i.length;)switch(i[t++]){case 33:switch(i[t++]){case 255:if(i[t]!==11||i[t+1]==78&&i[t+2]==69&&i[t+3]==84&&i[t+4]==83&&i[t+5]==67&&i[t+6]==65&&i[t+7]==80&&i[t+8]==69&&i[t+9]==50&&i[t+10]==46&&i[t+11]==48&&i[t+12]==3&&i[t+13]==1&&i[t+16]==0)t+=14,O=i[t++]|i[t++]<<8,t++;else for(t+=12;;){if(!((ht=i[t++])>=0))throw Error("Invalid block size");if(ht===0)break;t+=ht}break;case 249:if(i[t++]!==4||i[t+4]!==0)throw new Error("Invalid graphics extension block.");var P=i[t++];E=i[t++]|i[t++]<<8,G=i[t++],!(1&P)&&(G=null),S=P>>2&7,t++;break;case 254:for(;;){if(!((ht=i[t++])>=0))throw Error("Invalid block size");if(ht===0)break;t+=ht}break;default:throw new Error("Unknown graphic control label: 0x"+i[t-1].toString(16))}break;case 44:var tt=i[t++]|i[t++]<<8,z=i[t++]|i[t++]<<8,rt=i[t++]|i[t++]<<8,ct=i[t++]|i[t++]<<8,Et=i[t++],Pt=Et>>6&1,Qt=1<<(7&Et)+1,Ut=h,dt=m,ee=!1;Et>>7&&(ee=!0,Ut=t,dt=Qt,t+=3*Qt);var oe=t;for(t++;;){var ht;if(!((ht=i[t++])>=0))throw Error("Invalid block size");if(ht===0)break;t+=ht}_.push({x:tt,y:z,width:rt,height:ct,has_local_palette:ee,palette_offset:Ut,palette_size:dt,data_offset:oe,data_length:t-oe,transparent_index:G,interlaced:!!Pt,delay:E,disposal:S});break;case 59:B=!1;break;default:throw new Error("Unknown gif block: 0x"+i[t-1].toString(16))}this.numFrames=function(){return _.length},this.loopCount=function(){return O},this.frameInfo=function(At){if(At<0||At>=_.length)throw new Error("Frame index out of range.");return _[At]},this.decodeAndBlitFrameBGRA=function(At,Ft){var St=this.frameInfo(At),ue=St.width*St.height,ce=new Uint8Array(ue);Q5(i,St.data_offset,ce,ue);var ae=St.palette_offset,se=St.transparent_index;se===null&&(se=256);var Lt=St.width,Ht=e-Lt,fe=Lt,j=4*(St.y*e+St.x),It=4*((St.y+St.height)*e+St.x),bt=j,Vt=4*Ht;St.interlaced===!0&&(Vt+=4*e*7);for(var Xt=8,he=0,me=ce.length;he<me;++he){var be=ce[he];if(fe===0&&(fe=Lt,(bt+=Vt)>=It&&(Vt=4*Ht+4*e*(Xt-1),bt=j+(Lt+Ht)*(Xt<<1),Xt>>=1)),be===se)bt+=4;else{var Ve=i[ae+3*be],De=i[ae+3*be+1],ei=i[ae+3*be+2];Ft[bt++]=ei,Ft[bt++]=De,Ft[bt++]=Ve,Ft[bt++]=255}--fe}},this.decodeAndBlitFrameRGBA=function(At,Ft){var St=this.frameInfo(At),ue=St.width*St.height,ce=new Uint8Array(ue);Q5(i,St.data_offset,ce,ue);var ae=St.palette_offset,se=St.transparent_index;se===null&&(se=256);var Lt=St.width,Ht=e-Lt,fe=Lt,j=4*(St.y*e+St.x),It=4*((St.y+St.height)*e+St.x),bt=j,Vt=4*Ht;St.interlaced===!0&&(Vt+=4*e*7);for(var Xt=8,he=0,me=ce.length;he<me;++he){var be=ce[he];if(fe===0&&(fe=Lt,(bt+=Vt)>=It&&(Vt=4*Ht+4*e*(Xt-1),bt=j+(Lt+Ht)*(Xt<<1),Xt>>=1)),be===se)bt+=4;else{var Ve=i[ae+3*be],De=i[ae+3*be+1],ei=i[ae+3*be+2];Ft[bt++]=Ve,Ft[bt++]=De,Ft[bt++]=ei,Ft[bt++]=255}--fe}}}function Q5(i,t,e,o){for(var l=i[t++],n=1<<l,g=n+1,h=g+1,m=l+1,B=(1<<m)-1,_=0,E=0,G=0,S=i[t++],O=new Int32Array(4096),P=null;;){for(;_<16&&S!==0;)E|=i[t++]<<_,_+=8,S===1?S=i[t++]:--S;if(_<m)break;var tt=E&B;if(E>>=m,_-=m,tt!==n){if(tt===g)break;for(var z=tt<h?tt:P,rt=0,ct=z;ct>n;)ct=O[ct]>>8,++rt;var Et=ct;if(G+rt+(z!==tt?1:0)>o)return void hn.log("Warning, gif stream longer than expected.");e[G++]=Et;var Pt=G+=rt;for(z!==tt&&(e[G++]=Et),ct=z;rt--;)ct=O[ct],e[--Pt]=255&ct,ct>>=8;P!==null&&h<4096&&(O[h++]=P<<8|Et,h>=B+1&&m<12&&(++m,B=B<<1|1)),P=tt}else h=g+1,B=(1<<(m=l+1))-1,P=null}return G!==o&&hn.log("Warning, gif stream shorter than expected."),e}function Qy(i){var t,e,o,l,n,g=Math.floor,h=new Array(64),m=new Array(64),B=new Array(64),_=new Array(64),E=new Array(65535),G=new Array(65535),S=new Array(64),O=new Array(64),P=[],tt=0,z=7,rt=new Array(64),ct=new Array(64),Et=new Array(64),Pt=new Array(256),Qt=new Array(2048),Ut=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],dt=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],ee=[0,1,2,3,4,5,6,7,8,9,10,11],oe=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],ht=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],At=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Ft=[0,1,2,3,4,5,6,7,8,9,10,11],St=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ue=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ce(j,It){for(var bt=0,Vt=0,Xt=new Array,he=1;he<=16;he++){for(var me=1;me<=j[he];me++)Xt[It[Vt]]=[],Xt[It[Vt]][0]=bt,Xt[It[Vt]][1]=he,Vt++,bt++;bt*=2}return Xt}function ae(j){for(var It=j[0],bt=j[1]-1;bt>=0;)It&1<<bt&&(tt|=1<<z),bt--,--z<0&&(tt==255?(se(255),se(0)):se(tt),z=7,tt=0)}function se(j){P.push(j)}function Lt(j){se(j>>8&255),se(255&j)}function Ht(j,It,bt,Vt,Xt){for(var he,me=Xt[0],be=Xt[240],Ve=function(Ze,We){var He,Re,hi,yi,Qi,Pi,zi,ir,Ei,Fe,Ye=0;for(Ei=0;Ei<8;++Ei){He=Ze[Ye],Re=Ze[Ye+1],hi=Ze[Ye+2],yi=Ze[Ye+3],Qi=Ze[Ye+4],Pi=Ze[Ye+5],zi=Ze[Ye+6];var Ki=He+(ir=Ze[Ye+7]),ji=He-ir,vr=Re+zi,Qe=Re-zi,gi=hi+Pi,Bi=hi-Pi,Oi=yi+Qi,Fr=yi-Qi,pi=Ki+Oi,Pr=Ki-Oi,gt=vr+gi,Y=vr-gi;Ze[Ye]=pi+gt,Ze[Ye+4]=pi-gt;var q=.707106781*(Y+Pr);Ze[Ye+2]=Pr+q,Ze[Ye+6]=Pr-q;var lt=.382683433*((pi=Fr+Bi)-(Y=Qe+ji)),_t=.5411961*pi+lt,xt=1.306562965*Y+lt,qt=.707106781*(gt=Bi+Qe),Jt=ji+qt,mt=ji-qt;Ze[Ye+5]=mt+_t,Ze[Ye+3]=mt-_t,Ze[Ye+1]=Jt+xt,Ze[Ye+7]=Jt-xt,Ye+=8}for(Ye=0,Ei=0;Ei<8;++Ei){He=Ze[Ye],Re=Ze[Ye+8],hi=Ze[Ye+16],yi=Ze[Ye+24],Qi=Ze[Ye+32],Pi=Ze[Ye+40],zi=Ze[Ye+48];var jt=He+(ir=Ze[Ye+56]),_e=He-ir,ve=Re+zi,xe=Re-zi,si=hi+Pi,_i=hi-Pi,ui=yi+Qi,fi=yi-Qi,bi=jt+ui,$i=jt-ui,or=ve+si,Ji=ve-si;Ze[Ye]=bi+or,Ze[Ye+32]=bi-or;var Mi=.707106781*(Ji+$i);Ze[Ye+16]=$i+Mi,Ze[Ye+48]=$i-Mi;var kr=.382683433*((bi=fi+_i)-(Ji=xe+_e)),Nt=.5411961*bi+kr,ze=1.306562965*Ji+kr,Ne=.707106781*(or=_i+xe),Wi=_e+Ne,Lr=_e-Ne;Ze[Ye+40]=Lr+Nt,Ze[Ye+24]=Lr-Nt,Ze[Ye+8]=Wi+ze,Ze[Ye+56]=Wi-ze,Ye++}for(Ei=0;Ei<64;++Ei)Fe=Ze[Ei]*We[Ei],S[Ei]=Fe>0?Fe+.5|0:Fe-.5|0;return S}(j,It),De=0;De<64;++De)O[Ut[De]]=Ve[De];var ei=O[0]-bt;bt=O[0],ei==0?ae(Vt[0]):(ae(Vt[G[he=32767+ei]]),ae(E[he]));for(var ri=63;ri>0&&O[ri]==0;)ri--;if(ri==0)return ae(me),bt;for(var Ii,Be=1;Be<=ri;){for(var Rt=Be;O[Be]==0&&Be<=ri;)++Be;var Ui=Be-Rt;if(Ui>=16){Ii=Ui>>4;for(var $t=1;$t<=Ii;++$t)ae(be);Ui&=15}he=32767+O[Be],ae(Xt[(Ui<<4)+G[he]]),ae(E[he]),Be++}return ri!=63&&ae(me),bt}function fe(j){j=Math.min(Math.max(j,1),100),n!=j&&(function(It){for(var bt=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Vt=0;Vt<64;Vt++){var Xt=g((bt[Vt]*It+50)/100);Xt=Math.min(Math.max(Xt,1),255),h[Ut[Vt]]=Xt}for(var he=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],me=0;me<64;me++){var be=g((he[me]*It+50)/100);be=Math.min(Math.max(be,1),255),m[Ut[me]]=be}for(var Ve=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],De=0,ei=0;ei<8;ei++)for(var ri=0;ri<8;ri++)B[De]=1/(h[Ut[De]]*Ve[ei]*Ve[ri]*8),_[De]=1/(m[Ut[De]]*Ve[ei]*Ve[ri]*8),De++}(j<50?Math.floor(5e3/j):Math.floor(200-2*j)),n=j)}this.encode=function(j,It){It&&fe(It),P=new Array,tt=0,z=7,Lt(65496),Lt(65504),Lt(16),se(74),se(70),se(73),se(70),se(0),se(1),se(1),se(0),Lt(1),Lt(1),se(0),se(0),function(){Lt(65499),Lt(132),se(0);for(var Re=0;Re<64;Re++)se(h[Re]);se(1);for(var hi=0;hi<64;hi++)se(m[hi])}(),function(Re,hi){Lt(65472),Lt(17),se(8),Lt(hi),Lt(Re),se(3),se(1),se(17),se(0),se(2),se(17),se(1),se(3),se(17),se(1)}(j.width,j.height),function(){Lt(65476),Lt(418),se(0);for(var Re=0;Re<16;Re++)se(dt[Re+1]);for(var hi=0;hi<=11;hi++)se(ee[hi]);se(16);for(var yi=0;yi<16;yi++)se(oe[yi+1]);for(var Qi=0;Qi<=161;Qi++)se(ht[Qi]);se(1);for(var Pi=0;Pi<16;Pi++)se(At[Pi+1]);for(var zi=0;zi<=11;zi++)se(Ft[zi]);se(17);for(var ir=0;ir<16;ir++)se(St[ir+1]);for(var Ei=0;Ei<=161;Ei++)se(ue[Ei])}(),Lt(65498),Lt(12),se(3),se(1),se(0),se(2),se(17),se(3),se(17),se(0),se(63),se(0);var bt=0,Vt=0,Xt=0;tt=0,z=7,this.encode.displayName="_encode_";for(var he,me,be,Ve,De,ei,ri,Ii,Be,Rt=j.data,Ui=j.width,$t=j.height,Ze=4*Ui,We=0;We<$t;){for(he=0;he<Ze;){for(De=Ze*We+he,ri=-1,Ii=0,Be=0;Be<64;Be++)ei=De+(Ii=Be>>3)*Ze+(ri=4*(7&Be)),We+Ii>=$t&&(ei-=Ze*(We+1+Ii-$t)),he+ri>=Ze&&(ei-=he+ri-Ze+4),me=Rt[ei++],be=Rt[ei++],Ve=Rt[ei++],rt[Be]=(Qt[me]+Qt[be+256>>0]+Qt[Ve+512>>0]>>16)-128,ct[Be]=(Qt[me+768>>0]+Qt[be+1024>>0]+Qt[Ve+1280>>0]>>16)-128,Et[Be]=(Qt[me+1280>>0]+Qt[be+1536>>0]+Qt[Ve+1792>>0]>>16)-128;bt=Ht(rt,B,bt,t,o),Vt=Ht(ct,_,Vt,e,l),Xt=Ht(Et,_,Xt,e,l),he+=32}We+=8}if(z>=0){var He=[];He[1]=z+1,He[0]=(1<<z+1)-1,ae(He)}return Lt(65497),new Uint8Array(P)},i=i||50,function(){for(var j=String.fromCharCode,It=0;It<256;It++)Pt[It]=j(It)}(),t=ce(dt,ee),e=ce(At,Ft),o=ce(oe,ht),l=ce(St,ue),function(){for(var j=1,It=2,bt=1;bt<=15;bt++){for(var Vt=j;Vt<It;Vt++)G[32767+Vt]=bt,E[32767+Vt]=[],E[32767+Vt][1]=bt,E[32767+Vt][0]=Vt;for(var Xt=-(It-1);Xt<=-j;Xt++)G[32767+Xt]=bt,E[32767+Xt]=[],E[32767+Xt][1]=bt,E[32767+Xt][0]=It-1+Xt;j<<=1,It<<=1}}(),function(){for(var j=0;j<256;j++)Qt[j]=19595*j,Qt[j+256>>0]=38470*j,Qt[j+512>>0]=7471*j+32768,Qt[j+768>>0]=-11059*j,Qt[j+1024>>0]=-21709*j,Qt[j+1280>>0]=32768*j+8421375,Qt[j+1536>>0]=-27439*j,Qt[j+1792>>0]=-5329*j}(),fe(i)}function mA(i,t){if(this.pos=0,this.buffer=i,this.datav=new DataView(i.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function U5(i){function t(dt){if(!dt)throw Error("assert :P")}function e(dt,ee,oe){for(var ht=0;4>ht;ht++)if(dt[ee+ht]!=oe.charCodeAt(ht))return!0;return!1}function o(dt,ee,oe,ht,At){for(var Ft=0;Ft<At;Ft++)dt[ee+Ft]=oe[ht+Ft]}function l(dt,ee,oe,ht){for(var At=0;At<ht;At++)dt[ee+At]=oe}function n(dt){return new Int32Array(dt)}function g(dt,ee){for(var oe=[],ht=0;ht<dt;ht++)oe.push(new ee);return oe}function h(dt,ee){var oe=[];return function ht(At,Ft,St){for(var ue=St[Ft],ce=0;ce<ue&&(At.push(St.length>Ft+1?[]:new ee),!(St.length<Ft+1));ce++)ht(At[ce],Ft+1,St)}(oe,0,dt),oe}var m=function(){var dt=this;function ee(p,w){for(var k=1<<w-1>>>0;p&k;)k>>>=1;return k?(p&k-1)+k:p}function oe(p,w,k,T,H){t(!(T%k));do p[w+(T-=k)]=H;while(0<T)}function ht(p,w,k,T,H){if(t(2328>=H),512>=H)var V=n(512);else if((V=n(H))==null)return 0;return function(K,X,$,nt,Ct,zt){var re,Tt,pe=X,te=1<<$,Ot=n(16),Wt=n(16);for(t(Ct!=0),t(nt!=null),t(K!=null),t(0<$),Tt=0;Tt<Ct;++Tt){if(15<nt[Tt])return 0;++Ot[nt[Tt]]}if(Ot[0]==Ct)return 0;for(Wt[1]=0,re=1;15>re;++re){if(Ot[re]>1<<re)return 0;Wt[re+1]=Wt[re]+Ot[re]}for(Tt=0;Tt<Ct;++Tt)re=nt[Tt],0<nt[Tt]&&(zt[Wt[re]++]=Tt);if(Wt[15]==1)return(nt=new At).g=0,nt.value=zt[0],oe(K,pe,1,te,nt),te;var Ie,we=-1,Le=te-1,je=0,$e=1,wi=1,qe=1<<$;for(Tt=0,re=1,Ct=2;re<=$;++re,Ct<<=1){if($e+=wi<<=1,0>(wi-=Ot[re]))return 0;for(;0<Ot[re];--Ot[re])(nt=new At).g=re,nt.value=zt[Tt++],oe(K,pe+je,Ct,qe,nt),je=ee(je,re)}for(re=$+1,Ct=2;15>=re;++re,Ct<<=1){if($e+=wi<<=1,0>(wi-=Ot[re]))return 0;for(;0<Ot[re];--Ot[re]){if(nt=new At,(je&Le)!=we){for(pe+=qe,Ie=1<<(we=re)-$;15>we&&!(0>=(Ie-=Ot[we]));)++we,Ie<<=1;te+=qe=1<<(Ie=we-$),K[X+(we=je&Le)].g=Ie+$,K[X+we].value=pe-X-we}nt.g=re-$,nt.value=zt[Tt++],oe(K,pe+(je>>$),Ct,qe,nt),je=ee(je,re)}}return $e!=2*Wt[15]-1?0:te}(p,w,k,T,H,V)}function At(){this.value=this.g=0}function Ft(){this.value=this.g=0}function St(){this.G=g(5,At),this.H=n(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=g(ps,Ft)}function ue(p,w,k,T){t(p!=null),t(w!=null),t(2147483648>T),p.Ca=254,p.I=0,p.b=-8,p.Ka=0,p.oa=w,p.pa=k,p.Jd=w,p.Yc=k+T,p.Zc=4<=T?k+T-4+1:k,he(p)}function ce(p,w){for(var k=0;0<w--;)k|=be(p,128)<<w;return k}function ae(p,w){var k=ce(p,w);return me(p)?-k:k}function se(p,w,k,T){var H,V=0;for(t(p!=null),t(w!=null),t(4294967288>T),p.Sb=T,p.Ra=0,p.u=0,p.h=0,4<T&&(T=4),H=0;H<T;++H)V+=w[k+H]<<8*H;p.Ra=V,p.bb=T,p.oa=w,p.pa=k}function Lt(p){for(;8<=p.u&&p.bb<p.Sb;)p.Ra>>>=8,p.Ra+=p.oa[p.pa+p.bb]<<ia-8>>>0,++p.bb,p.u-=8;bt(p)&&(p.h=1,p.u=0)}function Ht(p,w){if(t(0<=w),!p.h&&w<=ea){var k=It(p)&Zo[w];return p.u+=w,Lt(p),k}return p.h=1,p.u=0}function fe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function j(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function It(p){return p.Ra>>>(p.u&ia-1)>>>0}function bt(p){return t(p.bb<=p.Sb),p.h||p.bb==p.Sb&&p.u>ia}function Vt(p,w){p.u=w,p.h=bt(p)}function Xt(p){p.u>=xA&&(t(p.u>=xA),Lt(p))}function he(p){t(p!=null&&p.oa!=null),p.pa<p.Zc?(p.I=(p.oa[p.pa++]|p.I<<8)>>>0,p.b+=8):(t(p!=null&&p.oa!=null),p.pa<p.Yc?(p.b+=8,p.I=p.oa[p.pa++]|p.I<<8):p.Ka?p.b=0:(p.I<<=8,p.b+=8,p.Ka=1))}function me(p){return ce(p,1)}function be(p,w){var k=p.Ca;0>p.b&&he(p);var T=p.b,H=k*w>>>8,V=(p.I>>>T>H)+0;for(V?(k-=H,p.I-=H+1<<T>>>0):k=H+1,T=k,H=0;256<=T;)H+=8,T>>=8;return T=7^H+Ir[T],p.b-=T,p.Ca=(k<<T)-1,V}function Ve(p,w,k){p[w+0]=k>>24&255,p[w+1]=k>>16&255,p[w+2]=k>>8&255,p[w+3]=k>>0&255}function De(p,w){return p[w+0]<<0|p[w+1]<<8}function ei(p,w){return De(p,w)|p[w+2]<<16}function ri(p,w){return De(p,w)|De(p,w+2)<<16}function Ii(p,w){var k=1<<w;return t(p!=null),t(0<w),p.X=n(k),p.X==null?0:(p.Mb=32-w,p.Xa=w,1)}function Be(p,w){t(p!=null),t(w!=null),t(p.Xa==w.Xa),o(w.X,0,p.X,0,1<<w.Xa)}function Rt(){this.X=[],this.Xa=this.Mb=0}function Ui(p,w,k,T){t(k!=null),t(T!=null);var H=k[0],V=T[0];return H==0&&(H=(p*V+w/2)/w),V==0&&(V=(w*H+p/2)/p),0>=H||0>=V?0:(k[0]=H,T[0]=V,1)}function $t(p,w){return p+(1<<w)-1>>>w}function Ze(p,w){return((4278255360&p)+(4278255360&w)>>>0&4278255360)+((16711935&p)+(16711935&w)>>>0&16711935)>>>0}function We(p,w){dt[w]=function(k,T,H,V,K,X,$){var nt;for(nt=0;nt<K;++nt){var Ct=dt[p](X[$+nt-1],H,V+nt);X[$+nt]=Ze(k[T+nt],Ct)}}}function He(){this.ud=this.hd=this.jd=0}function Re(p,w){return((4278124286&(p^w))>>>1)+(p&w)>>>0}function hi(p){return 0<=p&&256>p?p:0>p?0:255<p?255:void 0}function yi(p,w){return hi(p+(p-w+.5>>1))}function Qi(p,w,k){return Math.abs(w-k)-Math.abs(p-k)}function Pi(p,w,k,T,H,V,K){for(T=V[K-1],k=0;k<H;++k)V[K+k]=T=Ze(p[w+k],T)}function zi(p,w,k,T,H){var V;for(V=0;V<k;++V){var K=p[w+V],X=K>>8&255,$=16711935&($=($=16711935&K)+((X<<16)+X));T[H+V]=(4278255360&K)+$>>>0}}function ir(p,w){w.jd=p>>0&255,w.hd=p>>8&255,w.ud=p>>16&255}function Ei(p,w,k,T,H,V){var K;for(K=0;K<T;++K){var X=w[k+K],$=X>>>8,nt=X,Ct=255&(Ct=(Ct=X>>>16)+((p.jd<<24>>24)*($<<24>>24)>>>5));nt=255&(nt=(nt=nt+((p.hd<<24>>24)*($<<24>>24)>>>5))+((p.ud<<24>>24)*(Ct<<24>>24)>>>5)),H[V+K]=(4278255360&X)+(Ct<<16)+nt}}function Fe(p,w,k,T,H){dt[w]=function(V,K,X,$,nt,Ct,zt,re,Tt){for($=zt;$<re;++$)for(zt=0;zt<Tt;++zt)nt[Ct++]=H(X[T(V[K++])])},dt[p]=function(V,K,X,$,nt,Ct,zt){var re=8>>V.b,Tt=V.Ea,pe=V.K[0],te=V.w;if(8>re)for(V=(1<<V.b)-1,te=(1<<re)-1;K<X;++K){var Ot,Wt=0;for(Ot=0;Ot<Tt;++Ot)Ot&V||(Wt=T($[nt++])),Ct[zt++]=H(pe[Wt&te]),Wt>>=re}else dt["VP8LMapColor"+k]($,nt,pe,te,Ct,zt,K,X,Tt)}}function Ye(p,w,k,T,H){for(k=w+k;w<k;){var V=p[w++];T[H++]=V>>16&255,T[H++]=V>>8&255,T[H++]=V>>0&255}}function Ki(p,w,k,T,H){for(k=w+k;w<k;){var V=p[w++];T[H++]=V>>16&255,T[H++]=V>>8&255,T[H++]=V>>0&255,T[H++]=V>>24&255}}function ji(p,w,k,T,H){for(k=w+k;w<k;){var V=(K=p[w++])>>16&240|K>>12&15,K=K>>0&240|K>>28&15;T[H++]=V,T[H++]=K}}function vr(p,w,k,T,H){for(k=w+k;w<k;){var V=(K=p[w++])>>16&248|K>>13&7,K=K>>5&224|K>>3&31;T[H++]=V,T[H++]=K}}function Qe(p,w,k,T,H){for(k=w+k;w<k;){var V=p[w++];T[H++]=V>>0&255,T[H++]=V>>8&255,T[H++]=V>>16&255}}function gi(p,w,k,T,H,V){if(V==0)for(k=w+k;w<k;)Ve(T,((V=p[w++])[0]>>24|V[1]>>8&65280|V[2]<<8&16711680|V[3]<<24)>>>0),H+=32;else o(T,H,p,w,k)}function Bi(p,w){dt[w][0]=dt[p+"0"],dt[w][1]=dt[p+"1"],dt[w][2]=dt[p+"2"],dt[w][3]=dt[p+"3"],dt[w][4]=dt[p+"4"],dt[w][5]=dt[p+"5"],dt[w][6]=dt[p+"6"],dt[w][7]=dt[p+"7"],dt[w][8]=dt[p+"8"],dt[w][9]=dt[p+"9"],dt[w][10]=dt[p+"10"],dt[w][11]=dt[p+"11"],dt[w][12]=dt[p+"12"],dt[w][13]=dt[p+"13"],dt[w][14]=dt[p+"0"],dt[w][15]=dt[p+"0"]}function Oi(p){return p==Po||p==za||p==LA||p==Ja}function Fr(){this.eb=[],this.size=this.A=this.fb=0}function pi(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Pr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Fr,this.f.kb=new pi,this.sd=null}function gt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Y(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function q(p){return alert("todo:WebPSamplerProcessPlane"),p.T}function lt(p,w){var k=p.T,T=w.ba.f.RGBA,H=T.eb,V=T.fb+p.ka*T.A,K=Dn[w.ba.S],X=p.y,$=p.O,nt=p.f,Ct=p.N,zt=p.ea,re=p.W,Tt=w.cc,pe=w.dc,te=w.Mc,Ot=w.Nc,Wt=p.ka,Ie=p.ka+p.T,we=p.U,Le=we+1>>1;for(Wt==0?K(X,$,null,null,nt,Ct,zt,re,nt,Ct,zt,re,H,V,null,null,we):(K(w.ec,w.fc,X,$,Tt,pe,te,Ot,nt,Ct,zt,re,H,V-T.A,H,V,we),++k);Wt+2<Ie;Wt+=2)Tt=nt,pe=Ct,te=zt,Ot=re,Ct+=p.Rc,re+=p.Rc,V+=2*T.A,K(X,($+=2*p.fa)-p.fa,X,$,Tt,pe,te,Ot,nt,Ct,zt,re,H,V-T.A,H,V,we);return $+=p.fa,p.j+Ie<p.o?(o(w.ec,w.fc,X,$,we),o(w.cc,w.dc,nt,Ct,Le),o(w.Mc,w.Nc,zt,re,Le),k--):1&Ie||K(X,$,null,null,nt,Ct,zt,re,nt,Ct,zt,re,H,V+T.A,null,null,we),k}function _t(p,w,k){var T=p.F,H=[p.J];if(T!=null){var V=p.U,K=w.ba.S,X=K==kA||K==LA;w=w.ba.f.RGBA;var $=[0],nt=p.ka;$[0]=p.T,p.Kb&&(nt==0?--$[0]:(--nt,H[0]-=p.width),p.j+p.ka+p.T==p.o&&($[0]=p.o-p.j-nt));var Ct=w.eb;nt=w.fb+nt*w.A,p=Oa(T,H[0],p.width,V,$,Ct,nt+(X?0:3),w.A),t(k==$),p&&Oi(K)&&as(Ct,nt,X,V,$,w.A)}return 0}function xt(p){var w=p.ma,k=w.ba.S,T=11>k,H=k==El||k==FA||k==kA||k==el||k==12||Oi(k);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!Ba(w.Oa,p,H?11:12))return 0;if(H&&Oi(k)&&Ke(),p.da)alert("todo:use_scaling");else{if(T){if(w.Ib=q,p.Kb){if(k=p.U+1>>1,w.memory=n(p.U+2*k),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+p.U,w.Mc=w.cc,w.Nc=w.dc+k,w.Ib=lt,Ke()}}else alert("todo:EmitYUV");H&&(w.Jb=_t,T&&de())}if(T&&!C){for(p=0;256>p;++p)y[p]=89858*(p-128)+yr>>EA,R[p]=-22014*(p-128)+yr,L[p]=-45773*(p-128),F[p]=113618*(p-128)+yr>>EA;for(p=I;p<s;++p)w=76283*(p-16)+yr>>EA,N[p-I]=ss(w,255),D[p-I]=ss(w+8>>4,15);C=1}return 1}function qt(p){var w=p.ma,k=p.U,T=p.T;return t(!(1&p.ka)),0>=k||0>=T?0:(k=w.Ib(p,w),w.Jb!=null&&w.Jb(p,w,k),w.Dc+=k,1)}function Jt(p){p.ma.memory=null}function mt(p,w,k,T){return Ht(p,8)!=47?0:(w[0]=Ht(p,14)+1,k[0]=Ht(p,14)+1,T[0]=Ht(p,1),Ht(p,3)!=0?0:!p.h)}function jt(p,w){if(4>p)return p+1;var k=p-2>>1;return(2+(1&p)<<k)+Ht(w,k)+1}function _e(p,w){return 120<w?w-120:1<=(k=((k=wc[w-1])>>4)*p+(8-(15&k)))?k:1;var k}function ve(p,w,k){var T=It(k),H=p[w+=255&T].g-8;return 0<H&&(Vt(k,k.u+8),T=It(k),w+=p[w].value,w+=T&(1<<H)-1),Vt(k,k.u+p[w].g),p[w].value}function xe(p,w,k){return k.g+=p.g,k.value+=p.value<<w>>>0,t(8>=k.g),p.g}function si(p,w,k){var T=p.xc;return t((w=T==0?0:p.vc[p.md*(k>>T)+(w>>T)])<p.Wb),p.Ya[w]}function _i(p,w,k,T){var H=p.ab,V=p.c*w,K=p.C;w=K+w;var X=k,$=T;for(T=p.Ta,k=p.Ua;0<H--;){var nt=p.gc[H],Ct=K,zt=w,re=X,Tt=$,pe=($=T,X=k,nt.Ea);switch(t(Ct<zt),t(zt<=nt.nc),nt.hc){case 2:na(re,Tt,(zt-Ct)*pe,$,X);break;case 0:var te=Ct,Ot=zt,Wt=$,Ie=X,we=(qe=nt).Ea;te==0&&(ra(re,Tt,null,null,1,Wt,Ie),Pi(re,Tt+1,0,0,we-1,Wt,Ie+1),Tt+=we,Ie+=we,++te);for(var Le=1<<qe.b,je=Le-1,$e=$t(we,qe.b),wi=qe.K,qe=qe.w+(te>>qe.b)*$e;te<Ot;){var ar=wi,Vi=qe,lr=1;for(Tn(re,Tt,Wt,Ie-we,1,Wt,Ie);lr<we;){var rr=(lr&~je)+Le;rr>we&&(rr=we),(0,Zs[ar[Vi++]>>8&15])(re,Tt+ +lr,Wt,Ie+lr-we,rr-lr,Wt,Ie+lr),lr=rr}Tt+=we,Ie+=we,++te&je||(qe+=$e)}zt!=nt.nc&&o($,X-pe,$,X+(zt-Ct-1)*pe,pe);break;case 1:for(pe=re,Ot=Tt,we=(re=nt.Ea)-(Ie=re&~(Wt=(Tt=1<<nt.b)-1)),te=$t(re,nt.b),Le=nt.K,nt=nt.w+(Ct>>nt.b)*te;Ct<zt;){for(je=Le,$e=nt,wi=new He,qe=Ot+Ie,ar=Ot+re;Ot<qe;)ir(je[$e++],wi),Hs(wi,pe,Ot,Tt,$,X),Ot+=Tt,X+=Tt;Ot<ar&&(ir(je[$e++],wi),Hs(wi,pe,Ot,we,$,X),Ot+=we,X+=we),++Ct&Wt||(nt+=te)}break;case 3:if(re==$&&Tt==X&&0<nt.b){for(Ot=$,re=pe=X+(zt-Ct)*pe-(Ie=(zt-Ct)*$t(nt.Ea,nt.b)),Tt=$,Wt=X,te=[],Ie=(we=Ie)-1;0<=Ie;--Ie)te[Ie]=Tt[Wt+Ie];for(Ie=we-1;0<=Ie;--Ie)Ot[re+Ie]=te[Ie];fs(nt,Ct,zt,$,pe,$,X)}else fs(nt,Ct,zt,re,Tt,$,X)}X=T,$=k}$!=k&&o(T,k,X,$,V)}function ui(p,w){var k=p.V,T=p.Ba+p.c*p.C,H=w-p.C;if(t(w<=p.l.o),t(16>=H),0<H){var V=p.l,K=p.Ta,X=p.Ua,$=V.width;if(_i(p,H,k,T),H=X=[X],t((k=p.C)<(T=w)),t(V.v<V.va),T>V.o&&(T=V.o),k<V.j){var nt=V.j-k;k=V.j,H[0]+=nt*$}if(k>=T?k=0:(H[0]+=4*V.v,V.ka=k-V.j,V.U=V.va-V.v,V.T=T-k,k=1),k){if(X=X[0],11>(k=p.ca).S){var Ct=k.f.RGBA,zt=(T=k.S,H=V.U,V=V.T,nt=Ct.eb,Ct.A),re=V;for(Ct=Ct.fb+p.Ma*Ct.A;0<re--;){var Tt=K,pe=X,te=H,Ot=nt,Wt=Ct;switch(T){case tl:Ys(Tt,pe,te,Ot,Wt);break;case El:oa(Tt,pe,te,Ot,Wt);break;case Po:oa(Tt,pe,te,Ot,Wt),as(Ot,Wt,0,te,1,0);break;case Tl:ms(Tt,pe,te,Ot,Wt);break;case FA:gi(Tt,pe,te,Ot,Wt,1);break;case za:gi(Tt,pe,te,Ot,Wt,1),as(Ot,Wt,0,te,1,0);break;case kA:gi(Tt,pe,te,Ot,Wt,0);break;case LA:gi(Tt,pe,te,Ot,Wt,0),as(Ot,Wt,1,te,1,0);break;case el:fo(Tt,pe,te,Ot,Wt);break;case Ja:fo(Tt,pe,te,Ot,Wt),li(Ot,Wt,te,1,0);break;case ys:Ho(Tt,pe,te,Ot,Wt);break;default:t(0)}X+=$,Ct+=zt}p.Ma+=V}else alert("todo:EmitRescaledRowsYUVA");t(p.Ma<=k.height)}}p.C=w,t(p.C<=p.i)}function fi(p){var w;if(0<p.ua)return 0;for(w=0;w<p.Wb;++w){var k=p.Ya[w].G,T=p.Ya[w].H;if(0<k[1][T[1]+0].g||0<k[2][T[2]+0].g||0<k[3][T[3]+0].g)return 0}return 1}function bi(p,w,k,T,H,V){if(p.Z!=0){var K=p.qd,X=p.rd;for(t(Er[p.Z]!=null);w<k;++w)Er[p.Z](K,X,T,H,T,H,V),K=T,X=H,H+=V;p.qd=K,p.rd=X}}function $i(p,w){var k=p.l.ma,T=k.Z==0||k.Z==1?p.l.j:p.C;if(T=p.C<T?T:p.C,t(w<=p.l.o),w>T){var H=p.l.width,V=k.ca,K=k.tb+H*T,X=p.V,$=p.Ba+p.c*T,nt=p.gc;t(p.ab==1),t(nt[0].hc==3),sa(nt[0],T,w,X,$,V,K),bi(k,T,w,V,K,H)}p.C=p.Ma=w}function or(p,w,k,T,H,V,K){var X=p.$/T,$=p.$%T,nt=p.m,Ct=p.s,zt=k+p.$,re=zt;H=k+T*H;var Tt=k+T*V,pe=280+Ct.ua,te=p.Pb?X:16777216,Ot=0<Ct.ua?Ct.Wa:null,Wt=Ct.wc,Ie=zt<Tt?si(Ct,$,X):null;t(p.C<V),t(Tt<=H);var we=!1;t:for(;;){for(;we||zt<Tt;){var Le=0;if(X>=te){var je=zt-k;t((te=p).Pb),te.wd=te.m,te.xd=je,0<te.s.ua&&Be(te.s.Wa,te.s.vb),te=X+pu}if($&Wt||(Ie=si(Ct,$,X)),t(Ie!=null),Ie.Qb&&(w[zt]=Ie.qb,we=!0),!we)if(Xt(nt),Ie.jc){Le=nt,je=w;var $e=zt,wi=Ie.pd[It(Le)&ps-1];t(Ie.jc),256>wi.g?(Vt(Le,Le.u+wi.g),je[$e]=wi.value,Le=0):(Vt(Le,Le.u+wi.g-256),t(256<=wi.value),Le=wi.value),Le==0&&(we=!0)}else Le=ve(Ie.G[0],Ie.H[0],nt);if(nt.h)break;if(we||256>Le){if(!we)if(Ie.nd)w[zt]=(Ie.qb|Le<<8)>>>0;else{if(Xt(nt),we=ve(Ie.G[1],Ie.H[1],nt),Xt(nt),je=ve(Ie.G[2],Ie.H[2],nt),$e=ve(Ie.G[3],Ie.H[3],nt),nt.h)break;w[zt]=($e<<24|we<<16|Le<<8|je)>>>0}if(we=!1,++zt,++$>=T&&($=0,++X,K!=null&&X<=V&&!(X%16)&&K(p,X),Ot!=null))for(;re<zt;)Le=w[re++],Ot.X[(506832829*Le&4294967295)>>>Ot.Mb]=Le}else if(280>Le){if(Le=jt(Le-256,nt),je=ve(Ie.G[4],Ie.H[4],nt),Xt(nt),je=_e(T,je=jt(je,nt)),nt.h)break;if(zt-k<je||H-zt<Le)break t;for($e=0;$e<Le;++$e)w[zt+$e]=w[zt+$e-je];for(zt+=Le,$+=Le;$>=T;)$-=T,++X,K!=null&&X<=V&&!(X%16)&&K(p,X);if(t(zt<=H),$&Wt&&(Ie=si(Ct,$,X)),Ot!=null)for(;re<zt;)Le=w[re++],Ot.X[(506832829*Le&4294967295)>>>Ot.Mb]=Le}else{if(!(Le<pe))break t;for(we=Le-280,t(Ot!=null);re<zt;)Le=w[re++],Ot.X[(506832829*Le&4294967295)>>>Ot.Mb]=Le;Le=zt,t(!(we>>>(je=Ot).Xa)),w[Le]=je.X[we],we=!0}we||t(nt.h==bt(nt))}if(p.Pb&&nt.h&&zt<H)t(p.m.h),p.a=5,p.m=p.wd,p.$=p.xd,0<p.s.ua&&Be(p.s.vb,p.s.Wa);else{if(nt.h)break t;K?.(p,X>V?V:X),p.a=0,p.$=zt-k}return 1}return p.a=3,0}function Ji(p){t(p!=null),p.vc=null,p.yc=null,p.Ya=null;var w=p.Wa;w!=null&&(w.X=null),p.vb=null,t(p!=null)}function Mi(){var p=new Sl;return p==null?null:(p.a=0,p.xb=rn,Bi("Predictor","VP8LPredictors"),Bi("Predictor","VP8LPredictors_C"),Bi("PredictorAdd","VP8LPredictorsAdd"),Bi("PredictorAdd","VP8LPredictorsAdd_C"),na=zi,Hs=Ei,Ys=Ye,oa=Ki,fo=ji,Ho=vr,ms=Qe,dt.VP8LMapColor32b=_a,dt.VP8LMapColor8b=Da,p)}function kr(p,w,k,T,H){var V=1,K=[p],X=[w],$=T.m,nt=T.s,Ct=null,zt=0;t:for(;;){if(k)for(;V&&Ht($,1);){var re=K,Tt=X,pe=T,te=1,Ot=pe.m,Wt=pe.gc[pe.ab],Ie=Ht(Ot,2);if(pe.Oc&1<<Ie)V=0;else{switch(pe.Oc|=1<<Ie,Wt.hc=Ie,Wt.Ea=re[0],Wt.nc=Tt[0],Wt.K=[null],++pe.ab,t(4>=pe.ab),Ie){case 0:case 1:Wt.b=Ht(Ot,3)+2,te=kr($t(Wt.Ea,Wt.b),$t(Wt.nc,Wt.b),0,pe,Wt.K),Wt.K=Wt.K[0];break;case 3:var we,Le=Ht(Ot,8)+1,je=16<Le?0:4<Le?1:2<Le?2:3;if(re[0]=$t(Wt.Ea,je),Wt.b=je,we=te=kr(Le,1,0,pe,Wt.K)){var $e,wi=Le,qe=Wt,ar=1<<(8>>qe.b),Vi=n(ar);if(Vi==null)we=0;else{var lr=qe.K[0],rr=qe.w;for(Vi[0]=qe.K[0][0],$e=1;$e<1*wi;++$e)Vi[$e]=Ze(lr[rr+$e],Vi[$e-1]);for(;$e<4*ar;++$e)Vi[$e]=0;qe.K[0]=null,qe.K[0]=Vi,we=1}}te=we;break;case 2:break;default:t(0)}V=te}}if(K=K[0],X=X[0],V&&Ht($,1)&&!(V=1<=(zt=Ht($,4))&&11>=zt)){T.a=3;break t}var Br;if(Br=V)e:{var _r,er,wr,Zr=T,xr=K,Bn=X,Yi=zt,Tr=k,jr=Zr.m,dr=Zr.s,ln=[null],Gn=1,Ps=0,mo=du[Yi];i:for(;;){if(Tr&&Ht(jr,1)){var Rn=Ht(jr,3)+2,Co=$t(xr,Rn),As=$t(Bn,Rn),qs=Co*As;if(!kr(Co,As,0,Zr,ln))break i;for(ln=ln[0],dr.xc=Rn,_r=0;_r<qs;++_r){var Kn=ln[_r]>>8&65535;ln[_r]=Kn,Kn>=Gn&&(Gn=Kn+1)}}if(jr.h)break i;for(er=0;5>er;++er){var Sr=xs[er];!er&&0<Yi&&(Sr+=1<<Yi),Ps<Sr&&(Ps=Sr)}var $s=g(Gn*mo,At),Hl=Gn,Do=g(Hl,St);if(Do==null)var fu=null;else t(65536>=Hl),fu=Do;var Nl=n(Ps);if(fu==null||Nl==null||$s==null){Zr.a=1;break i}var cn=$s;for(_r=wr=0;_r<Gn;++_r){var Io=fu[_r],sl=Io.G,Ko=Io.H,TA=0,ol=1,mu=0;for(er=0;5>er;++er){Sr=xs[er],sl[er]=cn,Ko[er]=wr,!er&&0<Yi&&(Sr+=1<<Yi);n:{var Fc,Ch=Sr,kc=Zr,Lc=Nl,Ih=cn,hm=wr,Ec=0,ja=kc.m,ed=Ht(ja,1);if(l(Lc,0,0,Ch),ed){var Pl=Ht(ja,1)+1,gm=Ht(ja,1),Ml=Ht(ja,gm==0?1:8);Lc[Ml]=1,Pl==2&&(Lc[Ml=Ht(ja,8)]=1);var al=1}else{var Tc=n(19),yh=Ht(ja,4)+4;if(19<yh){kc.a=3;var Qc=0;break n}for(Fc=0;Fc<yh;++Fc)Tc[Ql[Fc]]=Ht(ja,3);var bh=void 0,Zn=void 0,Al=kc,vh=Tc,Uc=Ch,Vl=Lc,wh=0,ca=Al.m,id=8,Bh=g(128,At);r:for(;ht(Bh,0,7,vh,19);){if(Ht(ca,1)){var rd=2+2*Ht(ca,3);if((bh=2+Ht(ca,rd))>Uc)break r}else bh=Uc;for(Zn=0;Zn<Uc&&bh--;){Xt(ca);var _h=Bh[0+(127&It(ca))];Vt(ca,ca.u+_h.g);var Dl=_h.value;if(16>Dl)Vl[Zn++]=Dl,Dl!=0&&(id=Dl);else{var xh=Dl==16,Sh=Dl-16,Fh=gu[Sh],Kl=Ht(ca,vc[Sh])+Fh;if(Zn+Kl>Uc)break r;for(var yo=xh?id:0;0<Kl--;)Vl[Zn++]=yo}}wh=1;break r}wh||(Al.a=3),al=wh}(al=al&&!ja.h)&&(Ec=ht(Ih,hm,8,Lc,Ch)),al&&Ec!=0?Qc=Ec:(kc.a=3,Qc=0)}if(Qc==0)break i;if(ol&&Yr[er]==1&&(ol=cn[wr].g==0),TA+=cn[wr].g,wr+=Qc,3>=er){var Ol,kh=Nl[0];for(Ol=1;Ol<Sr;++Ol)Nl[Ol]>kh&&(kh=Nl[Ol]);mu+=kh}}if(Io.nd=ol,Io.Qb=0,ol&&(Io.qb=(sl[3][Ko[3]+0].value<<24|sl[1][Ko[1]+0].value<<16|sl[2][Ko[2]+0].value)>>>0,TA==0&&256>sl[0][Ko[0]+0].value&&(Io.Qb=1,Io.qb+=sl[0][Ko[0]+0].value<<8)),Io.jc=!Io.Qb&&6>mu,Io.jc){var Gc,qa=Io;for(Gc=0;Gc<ps;++Gc){var QA=Gc,UA=qa.pd[QA],Cu=qa.G[0][qa.H[0]+QA];256<=Cu.value?(UA.g=Cu.g+256,UA.value=Cu.value):(UA.g=0,UA.value=0,QA>>=xe(Cu,8,UA),QA>>=xe(qa.G[1][qa.H[1]+QA],16,UA),QA>>=xe(qa.G[2][qa.H[2]+QA],0,UA),xe(qa.G[3][qa.H[3]+QA],24,UA))}}}dr.vc=ln,dr.Wb=Gn,dr.Ya=fu,dr.yc=$s,Br=1;break e}Br=0}if(!(V=Br)){T.a=3;break t}if(0<zt){if(nt.ua=1<<zt,!Ii(nt.Wa,zt)){T.a=1,V=0;break t}}else nt.ua=0;var Rc=T,Zc=K,nd=X,$a=Rc.s,ll=$a.xc;if(Rc.c=Zc,Rc.i=nd,$a.md=$t(Zc,ll),$a.wc=ll==0?-1:(1<<ll)-1,k){T.xb=Xa;break t}if((Ct=n(K*X))==null){T.a=1,V=0;break t}V=(V=or(T,Ct,0,K,X,X,null))&&!$.h;break t}return V?(H!=null?H[0]=Ct:(t(Ct==null),t(k)),T.$=0,k||Ji(nt)):Ji(nt),V}function Nt(p,w){var k=p.c*p.i,T=k+w+16*w;return t(p.c<=w),p.V=n(T),p.V==null?(p.Ta=null,p.Ua=0,p.a=1,0):(p.Ta=p.V,p.Ua=p.Ba+k+w,1)}function ze(p,w){var k=p.C,T=w-k,H=p.V,V=p.Ba+p.c*k;for(t(w<=p.l.o);0<T;){var K=16<T?16:T,X=p.l.ma,$=p.l.width,nt=$*K,Ct=X.ca,zt=X.tb+$*k,re=p.Ta,Tt=p.Ua;_i(p,K,H,V),la(re,Tt,Ct,zt,nt),bi(X,k,k+K,Ct,zt,$),T-=K,H+=K*p.c,k+=K}t(k==w),p.C=p.Ma=w}function Ne(){this.ub=this.yd=this.td=this.Rb=0}function Wi(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Lr(){this.Fb=this.Bb=this.Cb=0,this.Zb=n(4),this.Lb=n(4)}function $r(){this.Yb=function(){var p=[];return function w(k,T,H){for(var V=H[T],K=0;K<V&&(k.push(H.length>T+1?[]:0),!(H.length<T+1));K++)w(k[K],T+1,H)}(p,0,[3,11]),p}()}function Qr(){this.jb=n(3),this.Wc=h([4,8],$r),this.Xc=h([4,17],$r)}function uo(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new n(4),this.od=new n(4)}function qi(){this.ld=this.La=this.dd=this.tc=0}function An(){this.Na=this.la=0}function ho(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function dn(){this.ad=n(384),this.Za=0,this.Ob=n(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Mn(){this.uc=this.M=this.Nb=0,this.wa=Array(new qi),this.Y=0,this.ya=Array(new dn),this.aa=0,this.l=new zr}function Ca(){this.y=n(16),this.f=n(8),this.ea=n(8)}function Ln(){this.cb=this.a=0,this.sc="",this.m=new fe,this.Od=new Ne,this.Kc=new Wi,this.ed=new uo,this.Qa=new Lr,this.Ic=this.$c=this.Aa=0,this.D=new Mn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=g(8,fe),this.ia=0,this.pb=g(4,ho),this.Pa=new Qr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ca),this.Hd=0,this.rb=Array(new An),this.sb=0,this.wa=Array(new qi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new dn),this.L=this.aa=0,this.gd=h([4,2],qi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function zr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ia(){var p=new Ln;return p!=null&&(p.a=0,p.sc="OK",p.cb=0,p.Xb=0,Fn||(Fn=Js)),p}function Ur(p,w,k){return p.a==0&&(p.a=w,p.sc=k,p.cb=0),0}function Hr(p,w,k){return 3<=k&&p[w+0]==157&&p[w+1]==1&&p[w+2]==42}function pr(p,w){if(p==null)return 0;if(p.a=0,p.sc="OK",w==null)return Ur(p,2,"null VP8Io passed to VP8GetHeaders()");var k=w.data,T=w.w,H=w.ha;if(4>H)return Ur(p,7,"Truncated header.");var V=k[T+0]|k[T+1]<<8|k[T+2]<<16,K=p.Od;if(K.Rb=!(1&V),K.td=V>>1&7,K.yd=V>>4&1,K.ub=V>>5,3<K.td)return Ur(p,3,"Incorrect keyframe parameters.");if(!K.yd)return Ur(p,4,"Frame not displayable.");T+=3,H-=3;var X=p.Kc;if(K.Rb){if(7>H)return Ur(p,7,"cannot parse picture header");if(!Hr(k,T,H))return Ur(p,3,"Bad code word");X.c=16383&(k[T+4]<<8|k[T+3]),X.Td=k[T+4]>>6,X.i=16383&(k[T+6]<<8|k[T+5]),X.Ud=k[T+6]>>6,T+=7,H-=7,p.za=X.c+15>>4,p.Ub=X.i+15>>4,w.width=X.c,w.height=X.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,l((V=p.Pa).jb,0,255,V.jb.length),t((V=p.Qa)!=null),V.Cb=0,V.Bb=0,V.Fb=1,l(V.Zb,0,0,V.Zb.length),l(V.Lb,0,0,V.Lb)}if(K.ub>H)return Ur(p,7,"bad partition length");ue(V=p.m,k,T,K.ub),T+=K.ub,H-=K.ub,K.Rb&&(X.Ld=me(V),X.Kd=me(V)),X=p.Qa;var $,nt=p.Pa;if(t(V!=null),t(X!=null),X.Cb=me(V),X.Cb){if(X.Bb=me(V),me(V)){for(X.Fb=me(V),$=0;4>$;++$)X.Zb[$]=me(V)?ae(V,7):0;for($=0;4>$;++$)X.Lb[$]=me(V)?ae(V,6):0}if(X.Bb)for($=0;3>$;++$)nt.jb[$]=me(V)?ce(V,8):255}else X.Bb=0;if(V.Ka)return Ur(p,3,"cannot parse segment header");if((X=p.ed).zd=me(V),X.Tb=ce(V,6),X.wb=ce(V,3),X.Pc=me(V),X.Pc&&me(V)){for(nt=0;4>nt;++nt)me(V)&&(X.vd[nt]=ae(V,6));for(nt=0;4>nt;++nt)me(V)&&(X.od[nt]=ae(V,6))}if(p.L=X.Tb==0?0:X.zd?1:2,V.Ka)return Ur(p,3,"cannot parse filter header");var Ct=H;if(H=$=T,T=$+Ct,X=Ct,p.Xb=(1<<ce(p.m,2))-1,Ct<3*(nt=p.Xb))k=7;else{for($+=3*nt,X-=3*nt,Ct=0;Ct<nt;++Ct){var zt=k[H+0]|k[H+1]<<8|k[H+2]<<16;zt>X&&(zt=X),ue(p.Jc[+Ct],k,$,zt),$+=zt,X-=zt,H+=3}ue(p.Jc[+nt],k,$,X),k=$<T?0:5}if(k!=0)return Ur(p,k,"cannot parse partitions");for(k=ce($=p.m,7),H=me($)?ae($,4):0,T=me($)?ae($,4):0,X=me($)?ae($,4):0,nt=me($)?ae($,4):0,$=me($)?ae($,4):0,Ct=p.Qa,zt=0;4>zt;++zt){if(Ct.Cb){var re=Ct.Zb[zt];Ct.Fb||(re+=k)}else{if(0<zt){p.pb[zt]=p.pb[0];continue}re=k}var Tt=p.pb[zt];Tt.Sc[0]=Ul[ss(re+H,127)],Tt.Sc[1]=Bc[ss(re+0,127)],Tt.Eb[0]=2*Ul[ss(re+T,127)],Tt.Eb[1]=101581*Bc[ss(re+X,127)]>>16,8>Tt.Eb[1]&&(Tt.Eb[1]=8),Tt.Qc[0]=Ul[ss(re+nt,117)],Tt.Qc[1]=Bc[ss(re+$,127)],Tt.lc=re+$}if(!K.Rb)return Ur(p,4,"Not a key frame.");for(me(V),K=p.Pa,k=0;4>k;++k){for(H=0;8>H;++H)for(T=0;3>T;++T)for(X=0;11>X;++X)nt=be(V,xc[k][H][T][X])?ce(V,8):il[k][H][T][X],K.Wc[k][H].Yb[T][X]=nt;for(H=0;17>H;++H)K.Xc[k][H]=K.Wc[k][yn[H]]}return p.kc=me(V),p.kc&&(p.Bd=ce(V,8)),p.cb=1}function Js(p,w,k,T,H,V,K){var X=w[H].Yb[k];for(k=0;16>H;++H){if(!be(p,X[k+0]))return H;for(;!be(p,X[k+1]);)if(X=w[++H].Yb[0],k=0,H==16)return 16;var $=w[H+1].Yb;if(be(p,X[k+2])){var nt=p,Ct=0;if(be(nt,(re=X)[(zt=k)+3]))if(be(nt,re[zt+6])){for(X=0,zt=2*(Ct=be(nt,re[zt+8]))+(re=be(nt,re[zt+9+Ct])),Ct=0,re=Gl[zt];re[X];++X)Ct+=Ct+be(nt,re[X]);Ct+=3+(8<<zt)}else be(nt,re[zt+7])?(Ct=7+2*be(nt,165),Ct+=be(nt,145)):Ct=5+be(nt,159);else Ct=be(nt,re[zt+4])?3+be(nt,re[zt+5]):2;X=$[2]}else Ct=1,X=$[1];$=K+Fi[H],0>(nt=p).b&&he(nt);var zt,re=nt.b,Tt=(zt=nt.Ca>>1)-(nt.I>>re)>>31;--nt.b,nt.Ca+=Tt,nt.Ca|=1,nt.I-=(zt+1&Tt)<<re,V[$]=((Ct^Tt)-Tt)*T[(0<H)+0]}return 16}function Gr(p){var w=p.rb[p.sb-1];w.la=0,w.Na=0,l(p.zc,0,0,p.zc.length),p.ja=0}function pt(p,w){if(p==null)return 0;if(w==null)return Ur(p,2,"NULL VP8Io parameter in VP8Decode().");if(!p.cb&&!pr(p,w))return 0;if(t(p.cb),w.ac==null||w.ac(w)){w.ob&&(p.L=0);var k=st[p.L];if(p.L==2?(p.yb=0,p.zb=0):(p.yb=w.v-k>>4,p.zb=w.j-k>>4,0>p.yb&&(p.yb=0),0>p.zb&&(p.zb=0)),p.Va=w.o+15+k>>4,p.Hb=w.va+15+k>>4,p.Hb>p.za&&(p.Hb=p.za),p.Va>p.Ub&&(p.Va=p.Ub),0<p.L){var T=p.ed;for(k=0;4>k;++k){var H;if(p.Qa.Cb){var V=p.Qa.Lb[k];p.Qa.Fb||(V+=T.Tb)}else V=T.Tb;for(H=0;1>=H;++H){var K=p.gd[k][H],X=V;if(T.Pc&&(X+=T.vd[0],H&&(X+=T.od[0])),0<(X=0>X?0:63<X?63:X)){var $=X;0<T.wb&&($=4<T.wb?$>>2:$>>1)>9-T.wb&&($=9-T.wb),1>$&&($=1),K.dd=$,K.tc=2*X+$,K.ld=40<=X?2:15<=X?1:0}else K.tc=0;K.La=H}}}k=0}else Ur(p,6,"Frame setup failed"),k=p.a;if(k=k==0){if(k){p.$c=0,0<p.Aa||(p.Ic=yt);t:{k=p.Ic,T=4*($=p.za);var nt=32*$,Ct=$+1,zt=0<p.L?$*(0<p.Aa?2:1):0,re=(p.Aa==2?2:1)*$;if((K=T+832+(H=3*(16*k+st[p.L])/2*nt)+(V=p.Fa!=null&&0<p.Fa.length?p.Kc.c*p.Kc.i:0))!=K)k=0;else{if(K>p.Vb){if(p.Vb=0,p.Ec=n(K),p.Fc=0,p.Ec==null){k=Ur(p,1,"no memory during frame initialization.");break t}p.Vb=K}K=p.Ec,X=p.Fc,p.Ac=K,p.Bc=X,X+=T,p.Gd=g(nt,Ca),p.Hd=0,p.rb=g(Ct+1,An),p.sb=1,p.wa=zt?g(zt,qi):null,p.Y=0,p.D.Nb=0,p.D.wa=p.wa,p.D.Y=p.Y,0<p.Aa&&(p.D.Y+=$),t(!0),p.oc=K,p.pc=X,X+=832,p.ya=g(re,dn),p.aa=0,p.D.ya=p.ya,p.D.aa=p.aa,p.Aa==2&&(p.D.aa+=$),p.R=16*$,p.B=8*$,$=(nt=st[p.L])*p.R,nt=nt/2*p.B,p.sa=K,p.ta=X+$,p.qa=p.sa,p.ra=p.ta+16*k*p.R+nt,p.Ha=p.qa,p.Ia=p.ra+8*k*p.B+nt,p.$c=0,X+=H,p.mb=V?K:null,p.nb=V?X:null,t(X+V<=p.Fc+p.Vb),Gr(p),l(p.Ac,p.Bc,0,T),k=1}}if(k){if(w.ka=0,w.y=p.sa,w.O=p.ta,w.f=p.qa,w.N=p.ra,w.ea=p.Ha,w.Vd=p.Ia,w.fa=p.R,w.Rc=p.B,w.F=null,w.J=0,!Ll){for(k=-255;255>=k;++k)Wa[255+k]=0>k?-k:k;for(k=-1020;1020>=k;++k)yc[1020+k]=-128>k?-128:127<k?127:k;for(k=-112;112>=k;++k)ai[112+k]=-16>k?-16:15<k?15:k;for(k=-255;510>=k;++k)kl[255+k]=0>k?0:255<k?255:k;Ll=1}Cs=le,Qn=ge,Aa=Ue,js=Ee,No=Se,aa=ie,Is=YA,Ka=Ga,Un=Ic,os=jA,xa=Cc,wn=BA,Vn=Ra,Xr=Za,Vr=wA,fn=go,mn=po,Bs=xl,Cn[0]=Mr,Cn[1]=Te,Cn[2]=Rr,Cn[3]=Kr,Cn[4]=tn,Cn[5]=Xs,Cn[6]=En,Cn[7]=jo,Cn[8]=ya,Cn[9]=yA,Mo[0]=Ci,Mo[1]=Gi,Mo[2]=Zi,Mo[3]=Je,Mo[4]=Ti,Mo[5]=Xi,Mo[6]=fr,Vo[0]=bn,Vo[1]=Pe,Vo[2]=Qo,Vo[3]=Ar,Vo[4]=qo,Vo[5]=hs,Vo[6]=ba,k=1}else k=0}k&&(k=function(Tt,pe){for(Tt.M=0;Tt.M<Tt.Va;++Tt.M){var te,Ot=Tt.Jc[Tt.M&Tt.Xb],Wt=Tt.m,Ie=Tt;for(te=0;te<Ie.za;++te){var we=Wt,Le=Ie,je=Le.Ac,$e=Le.Bc+4*te,wi=Le.zc,qe=Le.ya[Le.aa+te];if(Le.Qa.Bb?qe.$b=be(we,Le.Pa.jb[0])?2+be(we,Le.Pa.jb[2]):be(we,Le.Pa.jb[1]):qe.$b=0,Le.kc&&(qe.Ad=be(we,Le.Bd)),qe.Za=!be(we,145)+0,qe.Za){var ar=qe.Ob,Vi=0;for(Le=0;4>Le;++Le){var lr,rr=wi[0+Le];for(lr=0;4>lr;++lr){rr=_c[je[$e+lr]][rr];for(var Br=Ni[be(we,rr[0])];0<Br;)Br=Ni[2*Br+be(we,rr[Br])];rr=-Br,je[$e+lr]=rr}o(ar,Vi,je,$e,4),Vi+=4,wi[0+Le]=rr}}else rr=be(we,156)?be(we,128)?1:3:be(we,163)?2:0,qe.Ob[0]=rr,l(je,$e,rr,4),l(wi,0,rr,4);qe.Dd=be(we,142)?be(we,114)?be(we,183)?1:3:2:0}if(Ie.m.Ka)return Ur(Tt,7,"Premature end-of-partition0 encountered.");for(;Tt.ja<Tt.za;++Tt.ja){if(Ie=Ot,we=(Wt=Tt).rb[Wt.sb-1],je=Wt.rb[Wt.sb+Wt.ja],te=Wt.ya[Wt.aa+Wt.ja],$e=Wt.kc?te.Ad:0)we.la=je.la=0,te.Za||(we.Na=je.Na=0),te.Hc=0,te.Gc=0,te.ia=0;else{var _r,er;if(we=je,je=Ie,$e=Wt.Pa.Xc,wi=Wt.ya[Wt.aa+Wt.ja],qe=Wt.pb[wi.$b],Le=wi.ad,ar=0,Vi=Wt.rb[Wt.sb-1],rr=lr=0,l(Le,ar,0,384),wi.Za)var wr=0,Zr=$e[3];else{Br=n(16);var xr=we.Na+Vi.Na;if(xr=Fn(je,$e[1],xr,qe.Eb,0,Br,0),we.Na=Vi.Na=(0<xr)+0,1<xr)Cs(Br,0,Le,ar);else{var Bn=Br[0]+3>>3;for(Br=0;256>Br;Br+=16)Le[ar+Br]=Bn}wr=1,Zr=$e[0]}var Yi=15&we.la,Tr=15&Vi.la;for(Br=0;4>Br;++Br){var jr=1&Tr;for(Bn=er=0;4>Bn;++Bn)Yi=Yi>>1|(jr=(xr=Fn(je,Zr,xr=jr+(1&Yi),qe.Sc,wr,Le,ar))>wr)<<7,er=er<<2|(3<xr?3:1<xr?2:Le[ar+0]!=0),ar+=16;Yi>>=4,Tr=Tr>>1|jr<<7,lr=(lr<<8|er)>>>0}for(Zr=Yi,wr=Tr>>4,_r=0;4>_r;_r+=2){for(er=0,Yi=we.la>>4+_r,Tr=Vi.la>>4+_r,Br=0;2>Br;++Br){for(jr=1&Tr,Bn=0;2>Bn;++Bn)xr=jr+(1&Yi),Yi=Yi>>1|(jr=0<(xr=Fn(je,$e[2],xr,qe.Qc,0,Le,ar)))<<3,er=er<<2|(3<xr?3:1<xr?2:Le[ar+0]!=0),ar+=16;Yi>>=2,Tr=Tr>>1|jr<<5}rr|=er<<4*_r,Zr|=Yi<<4<<_r,wr|=(240&Tr)<<_r}we.la=Zr,Vi.la=wr,wi.Hc=lr,wi.Gc=rr,wi.ia=43690&rr?0:qe.ia,$e=!(lr|rr)}if(0<Wt.L&&(Wt.wa[Wt.Y+Wt.ja]=Wt.gd[te.$b][te.Za],Wt.wa[Wt.Y+Wt.ja].La|=!$e),Ie.Ka)return Ur(Tt,7,"Premature end-of-file encountered.")}if(Gr(Tt),Wt=pe,Ie=1,te=(Ot=Tt).D,we=0<Ot.L&&Ot.M>=Ot.zb&&Ot.M<=Ot.Va,Ot.Aa==0)t:{if(te.M=Ot.M,te.uc=we,$A(Ot,te),Ie=1,te=(er=Ot.D).Nb,we=(rr=st[Ot.L])*Ot.R,je=rr/2*Ot.B,Br=16*te*Ot.R,Bn=8*te*Ot.B,$e=Ot.sa,wi=Ot.ta-we+Br,qe=Ot.qa,Le=Ot.ra-je+Bn,ar=Ot.Ha,Vi=Ot.Ia-je+Bn,Tr=(Yi=er.M)==0,lr=Yi>=Ot.Va-1,Ot.Aa==2&&$A(Ot,er),er.uc)for(jr=(xr=Ot).D.M,t(xr.D.uc),er=xr.yb;er<xr.Hb;++er){wr=er,Zr=jr;var dr=(ln=(Sr=xr).D).Nb;_r=Sr.R;var ln=ln.wa[ln.Y+wr],Gn=Sr.sa,Ps=Sr.ta+16*dr*_r+16*wr,mo=ln.dd,Rn=ln.tc;if(Rn!=0)if(t(3<=Rn),Sr.L==1)0<wr&&fn(Gn,Ps,_r,Rn+4),ln.La&&Bs(Gn,Ps,_r,Rn),0<Zr&&Vr(Gn,Ps,_r,Rn+4),ln.La&&mn(Gn,Ps,_r,Rn);else{var Co=Sr.B,As=Sr.qa,qs=Sr.ra+8*dr*Co+8*wr,Kn=Sr.Ha,Sr=Sr.Ia+8*dr*Co+8*wr;dr=ln.ld,0<wr&&(Ka(Gn,Ps,_r,Rn+4,mo,dr),os(As,qs,Kn,Sr,Co,Rn+4,mo,dr)),ln.La&&(wn(Gn,Ps,_r,Rn,mo,dr),Xr(As,qs,Kn,Sr,Co,Rn,mo,dr)),0<Zr&&(Is(Gn,Ps,_r,Rn+4,mo,dr),Un(As,qs,Kn,Sr,Co,Rn+4,mo,dr)),ln.La&&(xa(Gn,Ps,_r,Rn,mo,dr),Vn(As,qs,Kn,Sr,Co,Rn,mo,dr))}}if(Ot.ia&&alert("todo:DitherRow"),Wt.put!=null){if(er=16*Yi,Yi=16*(Yi+1),Tr?(Wt.y=Ot.sa,Wt.O=Ot.ta+Br,Wt.f=Ot.qa,Wt.N=Ot.ra+Bn,Wt.ea=Ot.Ha,Wt.W=Ot.Ia+Bn):(er-=rr,Wt.y=$e,Wt.O=wi,Wt.f=qe,Wt.N=Le,Wt.ea=ar,Wt.W=Vi),lr||(Yi-=rr),Yi>Wt.o&&(Yi=Wt.o),Wt.F=null,Wt.J=null,Ot.Fa!=null&&0<Ot.Fa.length&&er<Yi&&(Wt.J=Ro(Ot,Wt,er,Yi-er),Wt.F=Ot.mb,Wt.F==null&&Wt.F.length==0)){Ie=Ur(Ot,3,"Could not decode alpha data.");break t}er<Wt.j&&(rr=Wt.j-er,er=Wt.j,t(!(1&rr)),Wt.O+=Ot.R*rr,Wt.N+=Ot.B*(rr>>1),Wt.W+=Ot.B*(rr>>1),Wt.F!=null&&(Wt.J+=Wt.width*rr)),er<Yi&&(Wt.O+=Wt.v,Wt.N+=Wt.v>>1,Wt.W+=Wt.v>>1,Wt.F!=null&&(Wt.J+=Wt.v),Wt.ka=er-Wt.j,Wt.U=Wt.va-Wt.v,Wt.T=Yi-er,Ie=Wt.put(Wt))}te+1!=Ot.Ic||lr||(o(Ot.sa,Ot.ta-we,$e,wi+16*Ot.R,we),o(Ot.qa,Ot.ra-je,qe,Le+8*Ot.B,je),o(Ot.Ha,Ot.Ia-je,ar,Vi+8*Ot.B,je))}if(!Ie)return Ur(Tt,6,"Output aborted.")}return 1}(p,w)),w.bc!=null&&w.bc(w),k&=1}return k?(p.cb=0,k):0}function ft(p,w,k,T,H){H=p[w+k+32*T]+(H>>3),p[w+k+32*T]=-256&H?0>H?0:255:H}function ut(p,w,k,T,H,V){ft(p,w,0,k,T+H),ft(p,w,1,k,T+V),ft(p,w,2,k,T-V),ft(p,w,3,k,T-H)}function Zt(p){return(20091*p>>16)+p}function Kt(p,w,k,T){var H,V=0,K=n(16);for(H=0;4>H;++H){var X=p[w+0]+p[w+8],$=p[w+0]-p[w+8],nt=(35468*p[w+4]>>16)-Zt(p[w+12]),Ct=Zt(p[w+4])+(35468*p[w+12]>>16);K[V+0]=X+Ct,K[V+1]=$+nt,K[V+2]=$-nt,K[V+3]=X-Ct,V+=4,w++}for(H=V=0;4>H;++H)X=(p=K[V+0]+4)+K[V+8],$=p-K[V+8],nt=(35468*K[V+4]>>16)-Zt(K[V+12]),ft(k,T,0,0,X+(Ct=Zt(K[V+4])+(35468*K[V+12]>>16))),ft(k,T,1,0,$+nt),ft(k,T,2,0,$-nt),ft(k,T,3,0,X-Ct),V++,T+=32}function ie(p,w,k,T){var H=p[w+0]+4,V=35468*p[w+4]>>16,K=Zt(p[w+4]),X=35468*p[w+1]>>16;ut(k,T,0,H+K,p=Zt(p[w+1]),X),ut(k,T,1,H+V,p,X),ut(k,T,2,H-V,p,X),ut(k,T,3,H-K,p,X)}function ge(p,w,k,T,H){Kt(p,w,k,T),H&&Kt(p,w+16,k,T+4)}function Ue(p,w,k,T){Qn(p,w+0,k,T,1),Qn(p,w+32,k,T+128,1)}function Ee(p,w,k,T){var H;for(p=p[w+0]+4,H=0;4>H;++H)for(w=0;4>w;++w)ft(k,T,w,H,p)}function Se(p,w,k,T){p[w+0]&&js(p,w+0,k,T),p[w+16]&&js(p,w+16,k,T+4),p[w+32]&&js(p,w+32,k,T+128),p[w+48]&&js(p,w+48,k,T+128+4)}function le(p,w,k,T){var H,V=n(16);for(H=0;4>H;++H){var K=p[w+0+H]+p[w+12+H],X=p[w+4+H]+p[w+8+H],$=p[w+4+H]-p[w+8+H],nt=p[w+0+H]-p[w+12+H];V[0+H]=K+X,V[8+H]=K-X,V[4+H]=nt+$,V[12+H]=nt-$}for(H=0;4>H;++H)K=(p=V[0+4*H]+3)+V[3+4*H],X=V[1+4*H]+V[2+4*H],$=V[1+4*H]-V[2+4*H],nt=p-V[3+4*H],k[T+0]=K+X>>3,k[T+16]=nt+$>>3,k[T+32]=K-X>>3,k[T+48]=nt-$>>3,T+=64}function ke(p,w,k){var T,H=w-32,V=_s,K=255-p[H-1];for(T=0;T<k;++T){var X,$=V,nt=K+p[w-1];for(X=0;X<k;++X)p[w+X]=$[nt+p[H+X]];w+=32}}function Te(p,w){ke(p,w,4)}function Pe(p,w){ke(p,w,8)}function Gi(p,w){ke(p,w,16)}function Zi(p,w){var k;for(k=0;16>k;++k)o(p,w+32*k,p,w-32,16)}function Je(p,w){var k;for(k=16;0<k;--k)l(p,w,p[w-1],16),w+=32}function Me(p,w,k){var T;for(T=0;16>T;++T)l(w,k+32*T,p,16)}function Ci(p,w){var k,T=16;for(k=0;16>k;++k)T+=p[w-1+32*k]+p[w+k-32];Me(T>>5,p,w)}function Ti(p,w){var k,T=8;for(k=0;16>k;++k)T+=p[w-1+32*k];Me(T>>4,p,w)}function Xi(p,w){var k,T=8;for(k=0;16>k;++k)T+=p[w+k-32];Me(T>>4,p,w)}function fr(p,w){Me(128,p,w)}function mi(p,w,k){return p+2*w+k+2>>2}function Rr(p,w){var k,T=w-32;for(T=new Uint8Array([mi(p[T-1],p[T+0],p[T+1]),mi(p[T+0],p[T+1],p[T+2]),mi(p[T+1],p[T+2],p[T+3]),mi(p[T+2],p[T+3],p[T+4])]),k=0;4>k;++k)o(p,w+32*k,T,0,T.length)}function Kr(p,w){var k=p[w-1],T=p[w-1+32],H=p[w-1+64],V=p[w-1+96];Ve(p,w+0,16843009*mi(p[w-1-32],k,T)),Ve(p,w+32,16843009*mi(k,T,H)),Ve(p,w+64,16843009*mi(T,H,V)),Ve(p,w+96,16843009*mi(H,V,V))}function Mr(p,w){var k,T=4;for(k=0;4>k;++k)T+=p[w+k-32]+p[w-1+32*k];for(T>>=3,k=0;4>k;++k)l(p,w+32*k,T,4)}function tn(p,w){var k=p[w-1+0],T=p[w-1+32],H=p[w-1+64],V=p[w-1-32],K=p[w+0-32],X=p[w+1-32],$=p[w+2-32],nt=p[w+3-32];p[w+0+96]=mi(T,H,p[w-1+96]),p[w+1+96]=p[w+0+64]=mi(k,T,H),p[w+2+96]=p[w+1+64]=p[w+0+32]=mi(V,k,T),p[w+3+96]=p[w+2+64]=p[w+1+32]=p[w+0+0]=mi(K,V,k),p[w+3+64]=p[w+2+32]=p[w+1+0]=mi(X,K,V),p[w+3+32]=p[w+2+0]=mi($,X,K),p[w+3+0]=mi(nt,$,X)}function En(p,w){var k=p[w+1-32],T=p[w+2-32],H=p[w+3-32],V=p[w+4-32],K=p[w+5-32],X=p[w+6-32],$=p[w+7-32];p[w+0+0]=mi(p[w+0-32],k,T),p[w+1+0]=p[w+0+32]=mi(k,T,H),p[w+2+0]=p[w+1+32]=p[w+0+64]=mi(T,H,V),p[w+3+0]=p[w+2+32]=p[w+1+64]=p[w+0+96]=mi(H,V,K),p[w+3+32]=p[w+2+64]=p[w+1+96]=mi(V,K,X),p[w+3+64]=p[w+2+96]=mi(K,X,$),p[w+3+96]=mi(X,$,$)}function Xs(p,w){var k=p[w-1+0],T=p[w-1+32],H=p[w-1+64],V=p[w-1-32],K=p[w+0-32],X=p[w+1-32],$=p[w+2-32],nt=p[w+3-32];p[w+0+0]=p[w+1+64]=V+K+1>>1,p[w+1+0]=p[w+2+64]=K+X+1>>1,p[w+2+0]=p[w+3+64]=X+$+1>>1,p[w+3+0]=$+nt+1>>1,p[w+0+96]=mi(H,T,k),p[w+0+64]=mi(T,k,V),p[w+0+32]=p[w+1+96]=mi(k,V,K),p[w+1+32]=p[w+2+96]=mi(V,K,X),p[w+2+32]=p[w+3+96]=mi(K,X,$),p[w+3+32]=mi(X,$,nt)}function jo(p,w){var k=p[w+0-32],T=p[w+1-32],H=p[w+2-32],V=p[w+3-32],K=p[w+4-32],X=p[w+5-32],$=p[w+6-32],nt=p[w+7-32];p[w+0+0]=k+T+1>>1,p[w+1+0]=p[w+0+64]=T+H+1>>1,p[w+2+0]=p[w+1+64]=H+V+1>>1,p[w+3+0]=p[w+2+64]=V+K+1>>1,p[w+0+32]=mi(k,T,H),p[w+1+32]=p[w+0+96]=mi(T,H,V),p[w+2+32]=p[w+1+96]=mi(H,V,K),p[w+3+32]=p[w+2+96]=mi(V,K,X),p[w+3+64]=mi(K,X,$),p[w+3+96]=mi(X,$,nt)}function yA(p,w){var k=p[w-1+0],T=p[w-1+32],H=p[w-1+64],V=p[w-1+96];p[w+0+0]=k+T+1>>1,p[w+2+0]=p[w+0+32]=T+H+1>>1,p[w+2+32]=p[w+0+64]=H+V+1>>1,p[w+1+0]=mi(k,T,H),p[w+3+0]=p[w+1+32]=mi(T,H,V),p[w+3+32]=p[w+1+64]=mi(H,V,V),p[w+3+64]=p[w+2+64]=p[w+0+96]=p[w+1+96]=p[w+2+96]=p[w+3+96]=V}function ya(p,w){var k=p[w-1+0],T=p[w-1+32],H=p[w-1+64],V=p[w-1+96],K=p[w-1-32],X=p[w+0-32],$=p[w+1-32],nt=p[w+2-32];p[w+0+0]=p[w+2+32]=k+K+1>>1,p[w+0+32]=p[w+2+64]=T+k+1>>1,p[w+0+64]=p[w+2+96]=H+T+1>>1,p[w+0+96]=V+H+1>>1,p[w+3+0]=mi(X,$,nt),p[w+2+0]=mi(K,X,$),p[w+1+0]=p[w+3+32]=mi(k,K,X),p[w+1+32]=p[w+3+64]=mi(T,k,K),p[w+1+64]=p[w+3+96]=mi(H,T,k),p[w+1+96]=mi(V,H,T)}function Qo(p,w){var k;for(k=0;8>k;++k)o(p,w+32*k,p,w-32,8)}function Ar(p,w){var k;for(k=0;8>k;++k)l(p,w,p[w-1],8),w+=32}function Uo(p,w,k){var T;for(T=0;8>T;++T)l(w,k+32*T,p,8)}function bn(p,w){var k,T=8;for(k=0;8>k;++k)T+=p[w+k-32]+p[w-1+32*k];Uo(T>>4,p,w)}function hs(p,w){var k,T=4;for(k=0;8>k;++k)T+=p[w+k-32];Uo(T>>3,p,w)}function qo(p,w){var k,T=4;for(k=0;8>k;++k)T+=p[w-1+32*k];Uo(T>>3,p,w)}function ba(p,w){Uo(128,p,w)}function $o(p,w,k){var T=p[w-k],H=p[w+0],V=3*(H-T)+bc[1020+p[w-2*k]-p[w+k]],K=SA[112+(V+4>>3)];p[w-k]=_s[255+T+SA[112+(V+3>>3)]],p[w+0]=_s[255+H-K]}function bA(p,w,k,T){var H=p[w+0],V=p[w+k];return Ns[255+p[w-2*k]-p[w-k]]>T||Ns[255+V-H]>T}function vA(p,w,k,T){return 4*Ns[255+p[w-k]-p[w+0]]+Ns[255+p[w-2*k]-p[w+k]]<=T}function Ua(p,w,k,T,H){var V=p[w-3*k],K=p[w-2*k],X=p[w-k],$=p[w+0],nt=p[w+k],Ct=p[w+2*k],zt=p[w+3*k];return 4*Ns[255+X-$]+Ns[255+K-nt]>T?0:Ns[255+p[w-4*k]-V]<=H&&Ns[255+V-K]<=H&&Ns[255+K-X]<=H&&Ns[255+zt-Ct]<=H&&Ns[255+Ct-nt]<=H&&Ns[255+nt-$]<=H}function wA(p,w,k,T){var H=2*T+1;for(T=0;16>T;++T)vA(p,w+T,k,H)&&$o(p,w+T,k)}function go(p,w,k,T){var H=2*T+1;for(T=0;16>T;++T)vA(p,w+T*k,1,H)&&$o(p,w+T*k,1)}function po(p,w,k,T){var H;for(H=3;0<H;--H)wA(p,w+=4*k,k,T)}function xl(p,w,k,T){var H;for(H=3;0<H;--H)go(p,w+=4,k,T)}function ta(p,w,k,T,H,V,K,X){for(V=2*V+1;0<H--;){if(Ua(p,w,k,V,K))if(bA(p,w,k,X))$o(p,w,k);else{var $=p,nt=w,Ct=k,zt=$[nt-2*Ct],re=$[nt-Ct],Tt=$[nt+0],pe=$[nt+Ct],te=$[nt+2*Ct],Ot=27*(Ie=bc[1020+3*(Tt-re)+bc[1020+zt-pe]])+63>>7,Wt=18*Ie+63>>7,Ie=9*Ie+63>>7;$[nt-3*Ct]=_s[255+$[nt-3*Ct]+Ie],$[nt-2*Ct]=_s[255+zt+Wt],$[nt-Ct]=_s[255+re+Ot],$[nt+0]=_s[255+Tt-Ot],$[nt+Ct]=_s[255+pe-Wt],$[nt+2*Ct]=_s[255+te-Ie]}w+=T}}function ns(p,w,k,T,H,V,K,X){for(V=2*V+1;0<H--;){if(Ua(p,w,k,V,K))if(bA(p,w,k,X))$o(p,w,k);else{var $=p,nt=w,Ct=k,zt=$[nt-Ct],re=$[nt+0],Tt=$[nt+Ct],pe=SA[112+((te=3*(re-zt))+4>>3)],te=SA[112+(te+3>>3)],Ot=pe+1>>1;$[nt-2*Ct]=_s[255+$[nt-2*Ct]+Ot],$[nt-Ct]=_s[255+zt+te],$[nt+0]=_s[255+re-pe],$[nt+Ct]=_s[255+Tt-Ot]}w+=T}}function YA(p,w,k,T,H,V){ta(p,w,k,1,16,T,H,V)}function Ga(p,w,k,T,H,V){ta(p,w,1,k,16,T,H,V)}function Cc(p,w,k,T,H,V){var K;for(K=3;0<K;--K)ns(p,w+=4*k,k,1,16,T,H,V)}function BA(p,w,k,T,H,V){var K;for(K=3;0<K;--K)ns(p,w+=4,1,k,16,T,H,V)}function Ic(p,w,k,T,H,V,K,X){ta(p,w,H,1,8,V,K,X),ta(k,T,H,1,8,V,K,X)}function jA(p,w,k,T,H,V,K,X){ta(p,w,1,H,8,V,K,X),ta(k,T,1,H,8,V,K,X)}function Ra(p,w,k,T,H,V,K,X){ns(p,w+4*H,H,1,8,V,K,X),ns(k,T+4*H,H,1,8,V,K,X)}function Za(p,w,k,T,H,V,K,X){ns(p,w+4,1,H,8,V,K,X),ns(k,T+4,1,H,8,V,K,X)}function va(){this.ba=new Pr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Y,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ha(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Go(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function qA(){this.ua=0,this.Wa=new Rt,this.vb=new Rt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new St,this.yc=new At}function Sl(){this.xb=this.a=0,this.l=new zr,this.ca=new Pr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new j,this.Pb=0,this.wd=new j,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new qA,this.ab=0,this.gc=g(4,Go),this.Oc=0}function wa(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new zr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Gs(p,w,k,T,H,V,K){for(p=p==null?0:p[w+0],w=0;w<K;++w)H[V+w]=p+k[T+w]&255,p=H[V+w]}function _A(p,w,k,T,H,V,K){var X;if(p==null)Gs(null,null,k,T,H,V,K);else for(X=0;X<K;++X)H[V+X]=p[w+X]+k[T+X]&255}function gs(p,w,k,T,H,V,K){if(p==null)Gs(null,null,k,T,H,V,K);else{var X,$=p[w+0],nt=$,Ct=$;for(X=0;X<K;++X)nt=Ct+($=p[w+X])-nt,Ct=k[T+X]+(-256&nt?0>nt?0:255:nt)&255,nt=$,H[V+X]=Ct}}function Ro(p,w,k,T){var H=w.width,V=w.o;if(t(p!=null&&w!=null),0>k||0>=T||k+T>V)return null;if(!p.Cc){if(p.ga==null){var K;if(p.ga=new wa,(K=p.ga==null)||(K=w.width*w.o,t(p.Gb.length==0),p.Gb=n(K),p.Uc=0,p.Gb==null?K=0:(p.mb=p.Gb,p.nb=p.Uc,p.rc=null,K=1),K=!K),!K){K=p.ga;var X=p.Fa,$=p.P,nt=p.qc,Ct=p.mb,zt=p.nb,re=$+1,Tt=nt-1,pe=K.l;if(t(X!=null&&Ct!=null&&w!=null),Er[0]=null,Er[1]=Gs,Er[2]=_A,Er[3]=gs,K.ca=Ct,K.tb=zt,K.c=w.width,K.i=w.height,t(0<K.c&&0<K.i),1>=nt)w=0;else if(K.$a=X[$+0]>>0&3,K.Z=X[$+0]>>2&3,K.Lc=X[$+0]>>4&3,$=X[$+0]>>6&3,0>K.$a||1<K.$a||4<=K.Z||1<K.Lc||$)w=0;else if(pe.put=qt,pe.ac=xt,pe.bc=Jt,pe.ma=K,pe.width=w.width,pe.height=w.height,pe.Da=w.Da,pe.v=w.v,pe.va=w.va,pe.j=w.j,pe.o=w.o,K.$a)t:{t(K.$a==1),w=Mi();e:for(;;){if(w==null){w=0;break t}if(t(K!=null),K.mc=w,w.c=K.c,w.i=K.i,w.l=K.l,w.l.ma=K,w.l.width=K.c,w.l.height=K.i,w.a=0,se(w.m,X,re,Tt),!kr(K.c,K.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&fi(w.s)?(K.ic=1,X=w.c*w.i,w.Ta=null,w.Ua=0,w.V=n(X),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(K.ic=0,w=Nt(w,K.c)),!w))break e;w=1;break t}K.mc=null,w=0}else w=Tt>=K.c*K.i;K=!w}if(K)return null;p.ga.Lc!=1?p.Ga=0:T=V-k}t(p.ga!=null),t(k+T<=V);t:{if(w=(X=p.ga).c,V=X.l.o,X.$a==0){if(re=p.rc,Tt=p.Vc,pe=p.Fa,$=p.P+1+k*w,nt=p.mb,Ct=p.nb+k*w,t($<=p.P+p.qc),X.Z!=0)for(t(Er[X.Z]!=null),K=0;K<T;++K)Er[X.Z](re,Tt,pe,$,nt,Ct,w),re=nt,Tt=Ct,Ct+=w,$+=w;else for(K=0;K<T;++K)o(nt,Ct,pe,$,w),re=nt,Tt=Ct,Ct+=w,$+=w;p.rc=re,p.Vc=Tt}else{if(t(X.mc!=null),w=k+T,t((K=X.mc)!=null),t(w<=K.i),K.C>=w)w=1;else if(X.ic||de(),X.ic){X=K.V,re=K.Ba,Tt=K.c;var te=K.i,Ot=(pe=1,$=K.$/Tt,nt=K.$%Tt,Ct=K.m,zt=K.s,K.$),Wt=Tt*te,Ie=Tt*w,we=zt.wc,Le=Ot<Ie?si(zt,nt,$):null;t(Ot<=Wt),t(w<=te),t(fi(zt));e:for(;;){for(;!Ct.h&&Ot<Ie;){if(nt&we||(Le=si(zt,nt,$)),t(Le!=null),Xt(Ct),256>(te=ve(Le.G[0],Le.H[0],Ct)))X[re+Ot]=te,++Ot,++nt>=Tt&&(nt=0,++$<=w&&!($%16)&&$i(K,$));else{if(!(280>te)){pe=0;break e}te=jt(te-256,Ct);var je,$e=ve(Le.G[4],Le.H[4],Ct);if(Xt(Ct),!(Ot>=($e=_e(Tt,$e=jt($e,Ct)))&&Wt-Ot>=te)){pe=0;break e}for(je=0;je<te;++je)X[re+Ot+je]=X[re+Ot+je-$e];for(Ot+=te,nt+=te;nt>=Tt;)nt-=Tt,++$<=w&&!($%16)&&$i(K,$);Ot<Ie&&nt&we&&(Le=si(zt,nt,$))}t(Ct.h==bt(Ct))}$i(K,$>w?w:$);break e}!pe||Ct.h&&Ot<Wt?(pe=0,K.a=Ct.h?5:3):K.$=Ot,w=pe}else w=or(K,K.V,K.Ba,K.c,K.i,w,ze);if(!w){T=0;break t}}k+T>=V&&(p.Cc=1),T=1}if(!T)return null;if(p.Cc&&((T=p.ga)!=null&&(T.mc=null),p.ga=null,0<p.Ga))return alert("todo:WebPDequantizeLevels"),null}return p.nb+k*H}function U(p,w,k,T,H,V){for(;0<H--;){var K,X=p,$=w+(k?1:0),nt=p,Ct=w+(k?0:3);for(K=0;K<T;++K){var zt=nt[Ct+4*K];zt!=255&&(zt*=32897,X[$+4*K+0]=X[$+4*K+0]*zt>>23,X[$+4*K+1]=X[$+4*K+1]*zt>>23,X[$+4*K+2]=X[$+4*K+2]*zt>>23)}w+=V}}function et(p,w,k,T,H){for(;0<T--;){var V;for(V=0;V<k;++V){var K=p[w+2*V+0],X=15&(nt=p[w+2*V+1]),$=4369*X,nt=(240&nt|nt>>4)*$>>16;p[w+2*V+0]=(240&K|K>>4)*$>>16&240|(15&K|K<<4)*$>>16>>4&15,p[w+2*V+1]=240&nt|X}w+=H}}function vt(p,w,k,T,H,V,K,X){var $,nt,Ct=255;for(nt=0;nt<H;++nt){for($=0;$<T;++$){var zt=p[w+$];V[K+4*$]=zt,Ct&=zt}w+=k,K+=X}return Ct!=255}function Dt(p,w,k,T,H){var V;for(V=0;V<H;++V)k[T+V]=p[w+V]>>8}function de(){as=U,li=et,Oa=vt,la=Dt}function Ce(p,w,k){dt[p]=function(T,H,V,K,X,$,nt,Ct,zt,re,Tt,pe,te,Ot,Wt,Ie,we){var Le,je=we-1>>1,$e=X[$+0]|nt[Ct+0]<<16,wi=zt[re+0]|Tt[pe+0]<<16;t(T!=null);var qe=3*$e+wi+131074>>2;for(w(T[H+0],255&qe,qe>>16,te,Ot),V!=null&&(qe=3*wi+$e+131074>>2,w(V[K+0],255&qe,qe>>16,Wt,Ie)),Le=1;Le<=je;++Le){var ar=X[$+Le]|nt[Ct+Le]<<16,Vi=zt[re+Le]|Tt[pe+Le]<<16,lr=$e+ar+wi+Vi+524296,rr=lr+2*(ar+wi)>>3;qe=rr+$e>>1,$e=(lr=lr+2*($e+Vi)>>3)+ar>>1,w(T[H+2*Le-1],255&qe,qe>>16,te,Ot+(2*Le-1)*k),w(T[H+2*Le-0],255&$e,$e>>16,te,Ot+(2*Le-0)*k),V!=null&&(qe=lr+wi>>1,$e=rr+Vi>>1,w(V[K+2*Le-1],255&qe,qe>>16,Wt,Ie+(2*Le-1)*k),w(V[K+2*Le+0],255&$e,$e>>16,Wt,Ie+(2*Le+0)*k)),$e=ar,wi=Vi}1&we||(qe=3*$e+wi+131074>>2,w(T[H+we-1],255&qe,qe>>16,te,Ot+(we-1)*k),V!=null&&(qe=3*wi+$e+131074>>2,w(V[K+we-1],255&qe,qe>>16,Wt,Ie+(we-1)*k)))}}function Ke(){Dn[tl]=rl,Dn[El]=Sa,Dn[Tl]=nl,Dn[FA]=Rl,Dn[kA]=Zl,Dn[el]=Ya,Dn[ys]=Sc,Dn[Po]=Sa,Dn[za]=Rl,Dn[LA]=Zl,Dn[Ja]=Ya}function ti(p){return p&~d?0>p?0:255:p>>c}function di(p,w){return ti((19077*p>>8)+(26149*w>>8)-14234)}function tr(p,w,k){return ti((19077*p>>8)-(6419*w>>8)-(13320*k>>8)+8708)}function cr(p,w){return ti((19077*p>>8)+(33050*w>>8)-17685)}function Cr(p,w,k,T,H){T[H+0]=di(p,k),T[H+1]=tr(p,w,k),T[H+2]=cr(p,w)}function Jr(p,w,k,T,H){T[H+0]=cr(p,w),T[H+1]=tr(p,w,k),T[H+2]=di(p,k)}function en(p,w,k,T,H){var V=tr(p,w,k);w=V<<3&224|cr(p,w)>>3,T[H+0]=248&di(p,k)|V>>5,T[H+1]=w}function pn(p,w,k,T,H){var V=240&cr(p,w)|15;T[H+0]=240&di(p,k)|tr(p,w,k)>>4,T[H+1]=V}function Sn(p,w,k,T,H){T[H+0]=255,Cr(p,w,k,T,H+1)}function vn(p,w,k,T,H){Jr(p,w,k,T,H),T[H+3]=255}function ds(p,w,k,T,H){Cr(p,w,k,T,H),T[H+3]=255}function ss(p,w){return 0>p?0:p>w?w:p}function Rs(p,w,k){dt[p]=function(T,H,V,K,X,$,nt,Ct,zt){for(var re=Ct+(-2&zt)*k;Ct!=re;)w(T[H+0],V[K+0],X[$+0],nt,Ct),w(T[H+1],V[K+0],X[$+0],nt,Ct+k),H+=2,++K,++$,Ct+=2*k;1&zt&&w(T[H+0],V[K+0],X[$+0],nt,Ct)}}function Fl(p,w,k){return k==0?p==0?w==0?6:5:w==0?4:0:k}function Na(p,w,k,T,H){switch(p>>>30){case 3:Qn(w,k,T,H,0);break;case 2:aa(w,k,T,H);break;case 1:js(w,k,T,H)}}function $A(p,w){var k,T,H=w.M,V=w.Nb,K=p.oc,X=p.pc+40,$=p.oc,nt=p.pc+584,Ct=p.oc,zt=p.pc+600;for(k=0;16>k;++k)K[X+32*k-1]=129;for(k=0;8>k;++k)$[nt+32*k-1]=129,Ct[zt+32*k-1]=129;for(0<H?K[X-1-32]=$[nt-1-32]=Ct[zt-1-32]=129:(l(K,X-32-1,127,21),l($,nt-32-1,127,9),l(Ct,zt-32-1,127,9)),T=0;T<p.za;++T){var re=w.ya[w.aa+T];if(0<T){for(k=-1;16>k;++k)o(K,X+32*k-4,K,X+32*k+12,4);for(k=-1;8>k;++k)o($,nt+32*k-4,$,nt+32*k+4,4),o(Ct,zt+32*k-4,Ct,zt+32*k+4,4)}var Tt=p.Gd,pe=p.Hd+T,te=re.ad,Ot=re.Hc;if(0<H&&(o(K,X-32,Tt[pe].y,0,16),o($,nt-32,Tt[pe].f,0,8),o(Ct,zt-32,Tt[pe].ea,0,8)),re.Za){var Wt=K,Ie=X-32+16;for(0<H&&(T>=p.za-1?l(Wt,Ie,Tt[pe].y[15],4):o(Wt,Ie,Tt[pe+1].y,0,4)),k=0;4>k;k++)Wt[Ie+128+k]=Wt[Ie+256+k]=Wt[Ie+384+k]=Wt[Ie+0+k];for(k=0;16>k;++k,Ot<<=2)Wt=K,Ie=X+W[k],Cn[re.Ob[k]](Wt,Ie),Na(Ot,te,16*+k,Wt,Ie)}else if(Wt=Fl(T,H,re.Ob[0]),Mo[Wt](K,X),Ot!=0)for(k=0;16>k;++k,Ot<<=2)Na(Ot,te,16*+k,K,X+W[k]);for(k=re.Gc,Wt=Fl(T,H,re.Dd),Vo[Wt]($,nt),Vo[Wt](Ct,zt),Ot=te,Wt=$,Ie=nt,255&(re=k>>0)&&(170&re?Aa(Ot,256,Wt,Ie):No(Ot,256,Wt,Ie)),re=Ct,Ot=zt,255&(k>>=8)&&(170&k?Aa(te,320,re,Ot):No(te,320,re,Ot)),H<p.Ub-1&&(o(Tt[pe].y,0,K,X+480,16),o(Tt[pe].f,0,$,nt+224,8),o(Tt[pe].ea,0,Ct,zt+224,8)),k=8*V*p.B,Tt=p.sa,pe=p.ta+16*T+16*V*p.R,te=p.qa,re=p.ra+8*T+k,Ot=p.Ha,Wt=p.Ia+8*T+k,k=0;16>k;++k)o(Tt,pe+k*p.R,K,X+32*k,16);for(k=0;8>k;++k)o(te,re+k*p.B,$,nt+32*k,8),o(Ot,Wt+k*p.B,Ct,zt+32*k,8)}}function Pa(p,w,k,T,H,V,K,X,$){var nt=[0],Ct=[0],zt=0,re=$!=null?$.kd:0,Tt=$??new Ha;if(p==null||12>k)return 7;Tt.data=p,Tt.w=w,Tt.ha=k,w=[w],k=[k],Tt.gb=[Tt.gb];t:{var pe=w,te=k,Ot=Tt.gb;if(t(p!=null),t(te!=null),t(Ot!=null),Ot[0]=0,12<=te[0]&&!e(p,pe[0],"RIFF")){if(e(p,pe[0]+8,"WEBP")){Ot=3;break t}var Wt=ri(p,pe[0]+4);if(12>Wt||4294967286<Wt){Ot=3;break t}if(re&&Wt>te[0]-8){Ot=7;break t}Ot[0]=Wt,pe[0]+=12,te[0]-=12}Ot=0}if(Ot!=0)return Ot;for(Wt=0<Tt.gb[0],k=k[0];;){t:{var Ie=p;te=w,Ot=k;var we=nt,Le=Ct,je=pe=[0];if((qe=zt=[zt])[0]=0,8>Ot[0])Ot=7;else{if(!e(Ie,te[0],"VP8X")){if(ri(Ie,te[0]+4)!=10){Ot=3;break t}if(18>Ot[0]){Ot=7;break t}var $e=ri(Ie,te[0]+8),wi=1+ei(Ie,te[0]+12);if(2147483648<=wi*(Ie=1+ei(Ie,te[0]+15))){Ot=3;break t}je!=null&&(je[0]=$e),we!=null&&(we[0]=wi),Le!=null&&(Le[0]=Ie),te[0]+=18,Ot[0]-=18,qe[0]=1}Ot=0}}if(zt=zt[0],pe=pe[0],Ot!=0)return Ot;if(te=!!(2&pe),!Wt&&zt)return 3;if(V!=null&&(V[0]=!!(16&pe)),K!=null&&(K[0]=te),X!=null&&(X[0]=0),K=nt[0],pe=Ct[0],zt&&te&&$==null){Ot=0;break}if(4>k){Ot=7;break}if(Wt&&zt||!Wt&&!zt&&!e(p,w[0],"ALPH")){k=[k],Tt.na=[Tt.na],Tt.P=[Tt.P],Tt.Sa=[Tt.Sa];t:{$e=p,Ot=w,Wt=k;var qe=Tt.gb;we=Tt.na,Le=Tt.P,je=Tt.Sa,wi=22,t($e!=null),t(Wt!=null),Ie=Ot[0];var ar=Wt[0];for(t(we!=null),t(je!=null),we[0]=null,Le[0]=null,je[0]=0;;){if(Ot[0]=Ie,Wt[0]=ar,8>ar){Ot=7;break t}var Vi=ri($e,Ie+4);if(4294967286<Vi){Ot=3;break t}var lr=8+Vi+1&-2;if(wi+=lr,0<qe&&wi>qe){Ot=3;break t}if(!e($e,Ie,"VP8 ")||!e($e,Ie,"VP8L")){Ot=0;break t}if(ar[0]<lr){Ot=7;break t}e($e,Ie,"ALPH")||(we[0]=$e,Le[0]=Ie+8,je[0]=Vi),Ie+=lr,ar-=lr}}if(k=k[0],Tt.na=Tt.na[0],Tt.P=Tt.P[0],Tt.Sa=Tt.Sa[0],Ot!=0)break}k=[k],Tt.Ja=[Tt.Ja],Tt.xa=[Tt.xa];t:if(qe=p,Ot=w,Wt=k,we=Tt.gb[0],Le=Tt.Ja,je=Tt.xa,$e=Ot[0],Ie=!e(qe,$e,"VP8 "),wi=!e(qe,$e,"VP8L"),t(qe!=null),t(Wt!=null),t(Le!=null),t(je!=null),8>Wt[0])Ot=7;else{if(Ie||wi){if(qe=ri(qe,$e+4),12<=we&&qe>we-12){Ot=3;break t}if(re&&qe>Wt[0]-8){Ot=7;break t}Le[0]=qe,Ot[0]+=8,Wt[0]-=8,je[0]=wi}else je[0]=5<=Wt[0]&&qe[$e+0]==47&&!(qe[$e+4]>>5),Le[0]=Wt[0];Ot=0}if(k=k[0],Tt.Ja=Tt.Ja[0],Tt.xa=Tt.xa[0],w=w[0],Ot!=0)break;if(4294967286<Tt.Ja)return 3;if(X==null||te||(X[0]=Tt.xa?2:1),K=[K],pe=[pe],Tt.xa){if(5>k){Ot=7;break}X=K,re=pe,te=V,p==null||5>k?p=0:5<=k&&p[w+0]==47&&!(p[w+4]>>5)?(Wt=[0],qe=[0],we=[0],se(Le=new j,p,w,k),mt(Le,Wt,qe,we)?(X!=null&&(X[0]=Wt[0]),re!=null&&(re[0]=qe[0]),te!=null&&(te[0]=we[0]),p=1):p=0):p=0}else{if(10>k){Ot=7;break}X=pe,p==null||10>k||!Hr(p,w+3,k-3)?p=0:(re=p[w+0]|p[w+1]<<8|p[w+2]<<16,te=16383&(p[w+7]<<8|p[w+6]),p=16383&(p[w+9]<<8|p[w+8]),1&re||3<(re>>1&7)||!(re>>4&1)||re>>5>=Tt.Ja||!te||!p?p=0:(K&&(K[0]=te),X&&(X[0]=p),p=1))}if(!p||(K=K[0],pe=pe[0],zt&&(nt[0]!=K||Ct[0]!=pe)))return 3;$!=null&&($[0]=Tt,$.offset=w-$.w,t(4294967286>w-$.w),t($.offset==$.ha-k));break}return Ot==0||Ot==7&&zt&&$==null?(V!=null&&(V[0]|=Tt.na!=null&&0<Tt.na.length),T!=null&&(T[0]=K),H!=null&&(H[0]=pe),0):Ot}function Ba(p,w,k){var T=w.width,H=w.height,V=0,K=0,X=T,$=H;if(w.Da=p!=null&&0<p.Da,w.Da&&(X=p.cd,$=p.bd,V=p.v,K=p.j,11>k||(V&=-2,K&=-2),0>V||0>K||0>=X||0>=$||V+X>T||K+$>H))return 0;if(w.v=V,w.j=K,w.va=V+X,w.o=K+$,w.U=X,w.T=$,w.da=p!=null&&0<p.da,w.da){if(!Ui(X,$,k=[p.ib],V=[p.hb]))return 0;w.ib=k[0],w.hb=V[0]}return w.ob=p!=null&&p.ob,w.Kb=p==null||!p.Sd,w.da&&(w.ob=w.ib<3*T/4&&w.hb<3*H/4,w.Kb=0),1}function Ma(p){if(p==null)return 2;if(11>p.S){var w=p.f.RGBA;w.fb+=(p.height-1)*w.A,w.A=-w.A}else w=p.f.kb,p=p.height,w.O+=(p-1)*w.fa,w.fa=-w.fa,w.N+=(p-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(p-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(p-1)*w.lb,w.lb=-w.lb);return 0}function Va(p,w,k,T){if(T==null||0>=p||0>=w)return 2;if(k!=null){if(k.Da){var H=k.cd,V=k.bd,K=-2&k.v,X=-2&k.j;if(0>K||0>X||0>=H||0>=V||K+H>p||X+V>w)return 2;p=H,w=V}if(k.da){if(!Ui(p,w,H=[k.ib],V=[k.hb]))return 2;p=H[0],w=V[0]}}T.width=p,T.height=w;t:{var $=T.width,nt=T.height;if(p=T.S,0>=$||0>=nt||!(p>=tl&&13>p))p=2;else{if(0>=T.Rd&&T.sd==null){K=V=H=w=0;var Ct=(X=$*kt[p])*nt;if(11>p||(V=(nt+1)/2*(w=($+1)/2),p==12&&(K=(H=$)*nt)),(nt=n(Ct+2*V+K))==null){p=1;break t}T.sd=nt,11>p?(($=T.f.RGBA).eb=nt,$.fb=0,$.A=X,$.size=Ct):(($=T.f.kb).y=nt,$.O=0,$.fa=X,$.Fd=Ct,$.f=nt,$.N=0+Ct,$.Ab=w,$.Cd=V,$.ea=nt,$.W=0+Ct+V,$.Db=w,$.Ed=V,p==12&&($.F=nt,$.J=0+Ct+2*V),$.Tc=K,$.lb=H)}if(w=1,H=T.S,V=T.width,K=T.height,H>=tl&&13>H)if(11>H)p=T.f.RGBA,w&=(X=Math.abs(p.A))*(K-1)+V<=p.size,w&=X>=V*kt[H],w&=p.eb!=null;else{p=T.f.kb,X=(V+1)/2,Ct=(K+1)/2,$=Math.abs(p.fa),nt=Math.abs(p.Ab);var zt=Math.abs(p.Db),re=Math.abs(p.lb),Tt=re*(K-1)+V;w&=$*(K-1)+V<=p.Fd,w&=nt*(Ct-1)+X<=p.Cd,w=(w&=zt*(Ct-1)+X<=p.Ed)&$>=V&nt>=X&zt>=X,w&=p.y!=null,w&=p.f!=null,w&=p.ea!=null,H==12&&(w&=re>=V,w&=Tt<=p.Tc,w&=p.F!=null)}else w=0;p=w?0:2}}return p!=0||k!=null&&k.fd&&(p=Ma(T)),p}var ps=64,Zo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ea=24,ia=32,xA=8,Ir=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];We("Predictor0","PredictorAdd0"),dt.Predictor0=function(){return 4278190080},dt.Predictor1=function(p){return p},dt.Predictor2=function(p,w,k){return w[k+0]},dt.Predictor3=function(p,w,k){return w[k+1]},dt.Predictor4=function(p,w,k){return w[k-1]},dt.Predictor5=function(p,w,k){return Re(Re(p,w[k+1]),w[k+0])},dt.Predictor6=function(p,w,k){return Re(p,w[k-1])},dt.Predictor7=function(p,w,k){return Re(p,w[k+0])},dt.Predictor8=function(p,w,k){return Re(w[k-1],w[k+0])},dt.Predictor9=function(p,w,k){return Re(w[k+0],w[k+1])},dt.Predictor10=function(p,w,k){return Re(Re(p,w[k-1]),Re(w[k+0],w[k+1]))},dt.Predictor11=function(p,w,k){var T=w[k+0];return 0>=Qi(T>>24&255,p>>24&255,(w=w[k-1])>>24&255)+Qi(T>>16&255,p>>16&255,w>>16&255)+Qi(T>>8&255,p>>8&255,w>>8&255)+Qi(255&T,255&p,255&w)?T:p},dt.Predictor12=function(p,w,k){var T=w[k+0];return(hi((p>>24&255)+(T>>24&255)-((w=w[k-1])>>24&255))<<24|hi((p>>16&255)+(T>>16&255)-(w>>16&255))<<16|hi((p>>8&255)+(T>>8&255)-(w>>8&255))<<8|hi((255&p)+(255&T)-(255&w)))>>>0},dt.Predictor13=function(p,w,k){var T=w[k-1];return(yi((p=Re(p,w[k+0]))>>24&255,T>>24&255)<<24|yi(p>>16&255,T>>16&255)<<16|yi(p>>8&255,T>>8&255)<<8|yi(p>>0&255,T>>0&255))>>>0};var ra=dt.PredictorAdd0;dt.PredictorAdd1=Pi,We("Predictor2","PredictorAdd2"),We("Predictor3","PredictorAdd3"),We("Predictor4","PredictorAdd4"),We("Predictor5","PredictorAdd5"),We("Predictor6","PredictorAdd6"),We("Predictor7","PredictorAdd7"),We("Predictor8","PredictorAdd8"),We("Predictor9","PredictorAdd9"),We("Predictor10","PredictorAdd10"),We("Predictor11","PredictorAdd11"),We("Predictor12","PredictorAdd12"),We("Predictor13","PredictorAdd13");var Tn=dt.PredictorAdd2;Fe("ColorIndexInverseTransform","MapARGB","32b",function(p){return p>>8&255},function(p){return p}),Fe("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(p){return p},function(p){return p>>8&255});var na,fs=dt.ColorIndexInverseTransform,_a=dt.MapARGB,sa=dt.VP8LColorIndexInverseTransformAlpha,Da=dt.MapAlpha,Zs=dt.VP8LPredictorsAdd=[];Zs.length=16,(dt.VP8LPredictors=[]).length=16,(dt.VP8LPredictorsAdd_C=[]).length=16,(dt.VP8LPredictors_C=[]).length=16;var Hs,Ys,oa,fo,Ho,ms,Cs,Qn,aa,Aa,js,No,Is,Ka,Un,os,xa,wn,Vn,Xr,Vr,fn,mn,Bs,as,li,Oa,la,Wa=n(511),yc=n(2041),ai=n(225),kl=n(767),Ll=0,bc=yc,SA=ai,_s=kl,Ns=Wa,tl=0,El=1,Tl=2,FA=3,kA=4,el=5,ys=6,Po=7,za=8,LA=9,Ja=10,vc=[2,3,7],gu=[3,3,11],xs=[280,256,256,256,40],Yr=[0,1,1,1,0],Ql=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],wc=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],du=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],pu=8,Ul=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Bc=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Fn=null,Gl=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Fi=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ni=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],il=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],_c=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],xc=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],yn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Mo=[],Cn=[],Vo=[],Xa=1,rn=2,Er=[],Dn=[];Ce("UpsampleRgbLinePair",Cr,3),Ce("UpsampleBgrLinePair",Jr,3),Ce("UpsampleRgbaLinePair",ds,4),Ce("UpsampleBgraLinePair",vn,4),Ce("UpsampleArgbLinePair",Sn,4),Ce("UpsampleRgba4444LinePair",pn,2),Ce("UpsampleRgb565LinePair",en,2);var rl=dt.UpsampleRgbLinePair,nl=dt.UpsampleBgrLinePair,Sa=dt.UpsampleRgbaLinePair,Rl=dt.UpsampleBgraLinePair,Zl=dt.UpsampleArgbLinePair,Ya=dt.UpsampleRgba4444LinePair,Sc=dt.UpsampleRgb565LinePair,EA=16,yr=1<<EA-1,I=-227,s=482,c=6,d=(256<<c)-1,C=0,y=n(256),F=n(256),L=n(256),R=n(256),N=n(s-I),D=n(s-I);Rs("YuvToRgbRow",Cr,3),Rs("YuvToBgrRow",Jr,3),Rs("YuvToRgbaRow",ds,4),Rs("YuvToBgraRow",vn,4),Rs("YuvToArgbRow",Sn,4),Rs("YuvToRgba4444Row",pn,2),Rs("YuvToRgb565Row",en,2);var W=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],st=[0,2,8],wt=[8,7,6,4,4,2,2,2,1,1,1,1],yt=1;this.WebPDecodeRGBA=function(p,w,k,T,H){var V=El,K=new va,X=new Pr;K.ba=X,X.S=V,X.width=[X.width],X.height=[X.height];var $=X.width,nt=X.height,Ct=new gt;if(Ct==null||p==null)var zt=2;else t(Ct!=null),zt=Pa(p,w,k,Ct.width,Ct.height,Ct.Pd,Ct.Qd,Ct.format,null);if(zt!=0?$=0:($!=null&&($[0]=Ct.width[0]),nt!=null&&(nt[0]=Ct.height[0]),$=1),$){X.width=X.width[0],X.height=X.height[0],T!=null&&(T[0]=X.width),H!=null&&(H[0]=X.height);t:{if(T=new zr,(H=new Ha).data=p,H.w=w,H.ha=k,H.kd=1,w=[0],t(H!=null),((p=Pa(H.data,H.w,H.ha,null,null,null,w,null,H))==0||p==7)&&w[0]&&(p=4),(w=p)==0){if(t(K!=null),T.data=H.data,T.w=H.w+H.offset,T.ha=H.ha-H.offset,T.put=qt,T.ac=xt,T.bc=Jt,T.ma=K,H.xa){if((p=Mi())==null){K=1;break t}if(function(re,Tt){var pe=[0],te=[0],Ot=[0];e:for(;;){if(re==null)return 0;if(Tt==null)return re.a=2,0;if(re.l=Tt,re.a=0,se(re.m,Tt.data,Tt.w,Tt.ha),!mt(re.m,pe,te,Ot)){re.a=3;break e}if(re.xb=rn,Tt.width=pe[0],Tt.height=te[0],!kr(pe[0],te[0],1,re,null))break e;return 1}return t(re.a!=0),0}(p,T)){if(T=(w=Va(T.width,T.height,K.Oa,K.ba))==0){e:{T=p;i:for(;;){if(T==null){T=0;break e}if(t(T.s.yc!=null),t(T.s.Ya!=null),t(0<T.s.Wb),t((k=T.l)!=null),t((H=k.ma)!=null),T.xb!=0){if(T.ca=H.ba,T.tb=H.tb,t(T.ca!=null),!Ba(H.Oa,k,FA)){T.a=2;break i}if(!Nt(T,k.width)||k.da)break i;if((k.da||Oi(T.ca.S))&&de(),11>T.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),T.ca.f.kb.F!=null&&de()),T.Pb&&0<T.s.ua&&T.s.vb.X==null&&!Ii(T.s.vb,T.s.Wa.Xa)){T.a=1;break i}T.xb=0}if(!or(T,T.V,T.Ba,T.c,T.i,k.o,ui))break i;H.Dc=T.Ma,T=1;break e}t(T.a!=0),T=0}T=!T}T&&(w=p.a)}else w=p.a}else{if((p=new Ia)==null){K=1;break t}if(p.Fa=H.na,p.P=H.P,p.qc=H.Sa,pr(p,T)){if((w=Va(T.width,T.height,K.Oa,K.ba))==0){if(p.Aa=0,k=K.Oa,t((H=p)!=null),k!=null){if(0<($=0>($=k.Md)?0:100<$?255:255*$/100)){for(nt=Ct=0;4>nt;++nt)12>(zt=H.pb[nt]).lc&&(zt.ia=$*wt[0>zt.lc?0:zt.lc]>>3),Ct|=zt.ia;Ct&&(alert("todo:VP8InitRandom"),H.ia=1)}H.Ga=k.Id,100<H.Ga?H.Ga=100:0>H.Ga&&(H.Ga=0)}pt(p,T)||(w=p.a)}}else w=p.a}w==0&&K.Oa!=null&&K.Oa.fd&&(w=Ma(K.ba))}K=w}V=K!=0?null:11>V?X.f.RGBA.eb:X.f.kb.y}else V=null;return V};var kt=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function B(dt,ee){for(var oe="",ht=0;ht<4;ht++)oe+=String.fromCharCode(dt[ee++]);return oe}function _(dt,ee){return(dt[ee+0]<<0|dt[ee+1]<<8|dt[ee+2]<<16)>>>0}function E(dt,ee){return(dt[ee+0]<<0|dt[ee+1]<<8|dt[ee+2]<<16|dt[ee+3]<<24)>>>0}new m;var G=[0],S=[0],O=[],P=new m,tt=i,z=function(dt,ee){var oe={},ht=0,At=!1,Ft=0,St=0;if(oe.frames=[],!function(It,bt,Vt,Xt){for(var he=0;he<Xt;he++)if(It[bt+he]!=Vt.charCodeAt(he))return!0;return!1}(dt,ee,"RIFF",4)){var ue,ce;for(E(dt,ee+=4),ee+=8;ee<dt.length;){var ae=B(dt,ee),se=E(dt,ee+=4);ee+=4;var Lt=se+(1&se);switch(ae){case"VP8 ":case"VP8L":oe.frames[ht]===void 0&&(oe.frames[ht]={}),(j=oe.frames[ht]).src_off=At?St:ee-8,j.src_size=Ft+se+8,ht++,At&&(At=!1,Ft=0,St=0);break;case"VP8X":(j=oe.header={}).feature_flags=dt[ee];var Ht=ee+4;j.canvas_width=1+_(dt,Ht),Ht+=3,j.canvas_height=1+_(dt,Ht),Ht+=3;break;case"ALPH":At=!0,Ft=Lt+8,St=ee-8;break;case"ANIM":(j=oe.header).bgcolor=E(dt,ee),Ht=ee+4,j.loop_count=(ue=dt)[(ce=Ht)+0]<<0|ue[ce+1]<<8,Ht+=2;break;case"ANMF":var fe,j;(j=oe.frames[ht]={}).offset_x=2*_(dt,ee),ee+=3,j.offset_y=2*_(dt,ee),ee+=3,j.width=1+_(dt,ee),ee+=3,j.height=1+_(dt,ee),ee+=3,j.duration=_(dt,ee),ee+=3,fe=dt[ee++],j.dispose=1&fe,j.blend=fe>>1&1}ae!="ANMF"&&(ee+=Lt)}return oe}}(tt,0);z.response=tt,z.rgbaoutput=!0,z.dataurl=!1;var rt=z.header?z.header:null,ct=z.frames?z.frames:null;if(rt){rt.loop_counter=rt.loop_count,G=[rt.canvas_height],S=[rt.canvas_width];for(var Et=0;Et<ct.length&&ct[Et].blend!=0;Et++);}var Pt=ct[0],Qt=P.WebPDecodeRGBA(tt,Pt.src_off,Pt.src_size,S,G);Pt.rgba=Qt,Pt.imgwidth=S[0],Pt.imgheight=G[0];for(var Ut=0;Ut<S[0]*G[0]*4;Ut++)O[Ut]=Qt[Ut];return this.width=S,this.height=G,this.data=O,this}var Z5,CD,ID,gn,Uy,Eo,To,jg,lm,cm,Gy,H5,N5,P5,Ry,M5,yD,p5,Zy,Bl,Wr,JA,fc,Wr,Wr,Wr,Wr,qg,Wr,bD,vD,wD,BD,xy,fA,Sy,Xy,V5,_D,_l,zg,Fy,Hy,f5,Jg,im,m5,xD,SD,FD,kD,LD,ED,TD,QD,sr,hn,Yg,Py,lu,I5,HD,y5,Pn,Yy,hu,Ah,gr,gc,Yo,v5,WA,ND,PD,MD,es,is,rs,VD,DD,Dy,$f,KD,OD,WD,zD,W5,Ty,zA,z5,J5,CA,dh,ph,fh,rm,Qs,nm,mh,Am,sm,uu,om,Ri,JD,Y5,j5,Ky,q5,XD,YD,B5,tm,S5,F5,k5,lh,em,L5,E5,T5,tK,IA,mc,iK,rK,XA,nK,G5,$5,sK,oK,aK,AK,lK,cK,uK,tS,hK,gK,dK,pK,fK,dc,$g,gh,Xg,Wy,zy,Jy,R5,mK,CK,IK,yK,bK,vK,wK,BK,_K,xK,td,_y=vd(()=>{Z5=Su(Dh(),1),CD=Object.defineProperty,ID=(i,t,e)=>t in i?CD(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,gn=(i,t,e)=>(ID(i,typeof t!="symbol"?t+"":t,e),e),Uy=class{constructor(t){gn(this,"map"),gn(this,"width"),gn(this,"height"),gn(this,"svgCanvas"),gn(this,"xLine"),gn(this,"yLine"),gn(this,"color","#535353"),this.map=t,this.mapResize=this.mapResize.bind(this)}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var t,e;this.width=(t=this.map)==null?void 0:t.getCanvas().clientWidth,this.height=(e=this.map)==null?void 0:e.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);let t=this.width/2,e=this.height/2;this.yLine.setAttribute("x1",`${t}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${t}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1","0px"),this.xLine.setAttribute("y1",`${e}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${e}px`)}else console.error("element value is null")}createCanvas(t){if(this.width!==void 0&&this.height!==void 0){let e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.style.position="relative",e.setAttribute("width",`${this.width}px`),e.setAttribute("height",`${this.height}px`);let o=this.width/2,l=this.height/2;this.yLine=e.appendChild(this.createLine(o,0,o,this.height,this.color,"2px")),this.xLine=e.appendChild(this.createLine(0,l,this.width,l,this.color,"2px")),t?.appendChild(e),this.svgCanvas=e}}createLine(t,e,o,l,n,g){let h=document.createElementNS("http://www.w3.org/2000/svg","line");return h.setAttribute("x1",t),h.setAttribute("y1",e),h.setAttribute("x2",o),h.setAttribute("y2",l),h.setAttribute("stroke-dasharray","5,5"),h.setAttribute("stroke",n),h.setAttribute("stroke-width",g),h}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}};Eo=Uint8Array,To=Uint16Array,jg=Uint32Array,lm=new Eo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),cm=new Eo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Gy=new Eo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),H5=function(i,t){for(var e=new To(31),o=0;o<31;++o)e[o]=t+=1<<i[o-1];for(var l=new jg(e[30]),o=1;o<30;++o)for(var n=e[o];n<e[o+1];++n)l[n]=n-e[o]<<5|o;return[e,l]},N5=H5(lm,2),P5=N5[0],Ry=N5[1];P5[28]=258,Ry[258]=28;M5=H5(cm,0),yD=M5[0],p5=M5[1],Zy=new To(32768);for(Wr=0;Wr<32768;++Wr)Bl=(Wr&43690)>>>1|(Wr&21845)<<1,Bl=(Bl&52428)>>>2|(Bl&13107)<<2,Bl=(Bl&61680)>>>4|(Bl&3855)<<4,Zy[Wr]=((Bl&65280)>>>8|(Bl&255)<<8)>>>1;JA=function(i,t,e){for(var o=i.length,l=0,n=new To(t);l<o;++l)++n[i[l]-1];var g=new To(t);for(l=0;l<t;++l)g[l]=g[l-1]+n[l-1]<<1;var h;if(e){h=new To(1<<t);var m=15-t;for(l=0;l<o;++l)if(i[l])for(var B=l<<4|i[l],_=t-i[l],E=g[i[l]-1]++<<_,G=E|(1<<_)-1;E<=G;++E)h[Zy[E]>>>m]=B}else for(h=new To(o),l=0;l<o;++l)h[l]=Zy[g[i[l]-1]++]>>>15-i[l];return h},fc=new Eo(288);for(Wr=0;Wr<144;++Wr)fc[Wr]=8;for(Wr=144;Wr<256;++Wr)fc[Wr]=9;for(Wr=256;Wr<280;++Wr)fc[Wr]=7;for(Wr=280;Wr<288;++Wr)fc[Wr]=8;qg=new Eo(32);for(Wr=0;Wr<32;++Wr)qg[Wr]=5;bD=JA(fc,9,0),vD=JA(fc,9,1),wD=JA(qg,5,0),BD=JA(qg,5,1),xy=function(i){for(var t=i[0],e=1;e<i.length;++e)i[e]>t&&(t=i[e]);return t},fA=function(i,t,e){var o=t/8>>0;return(i[o]|i[o+1]<<8)>>>(t&7)&e},Sy=function(i,t){var e=t/8>>0;return(i[e]|i[e+1]<<8|i[e+2]<<16)>>>(t&7)},Xy=function(i){return(i/8>>0)+(i&7&&1)},V5=function(i,t,e){(t==null||t<0)&&(t=0),(e==null||e>i.length)&&(e=i.length);var o=new(i instanceof To?To:i instanceof jg?jg:Eo)(e-t);return o.set(i.subarray(t,e)),o},_D=function(i,t,e){var o=i.length,l=!t||e,n=!e||e.i;e||(e={}),t||(t=new Eo(o*3));var g=function(Xt){var he=t.length;if(Xt>he){var me=new Eo(Math.max(he*2,Xt));me.set(t),t=me}},h=e.f||0,m=e.p||0,B=e.b||0,_=e.l,E=e.d,G=e.m,S=e.n,O=o*8;do{if(!_){e.f=h=fA(i,m,1);var P=fA(i,m+1,3);if(m+=3,P)if(P==1)_=vD,E=BD,G=9,S=5;else if(P==2){var tt=fA(i,m,31)+257,z=fA(i,m+10,15)+4,rt=tt+fA(i,m+5,31)+1;m+=14;for(var ct=new Eo(rt),Et=new Eo(19),Pt=0;Pt<z;++Pt)Et[Gy[Pt]]=fA(i,m+Pt*3,7);m+=z*3;var Qt=xy(Et),Ut=(1<<Qt)-1;if(!n&&m+rt*(Qt+7)>O)break;for(var dt=JA(Et,Qt,1),Pt=0;Pt<rt;){var ee=dt[fA(i,m,Ut)];m+=ee&15;var oe=ee>>>4;if(oe<16)ct[Pt++]=oe;else{var ht=0,At=0;for(oe==16?(At=3+fA(i,m,3),m+=2,ht=ct[Pt-1]):oe==17?(At=3+fA(i,m,7),m+=3):oe==18&&(At=11+fA(i,m,127),m+=7);At--;)ct[Pt++]=ht}}var Ft=ct.subarray(0,tt),St=ct.subarray(tt);G=xy(Ft),S=xy(St),_=JA(Ft,G,1),E=JA(St,S,1)}else throw"invalid block type";else{var oe=Xy(m)+4,ue=i[oe-4]|i[oe-3]<<8,ce=oe+ue;if(ce>o){if(n)throw"unexpected EOF";break}l&&g(B+ue),t.set(i.subarray(oe,ce),B),e.b=B+=ue,e.p=m=ce*8;continue}if(m>O)throw"unexpected EOF"}l&&g(B+131072);for(var ae=(1<<G)-1,se=(1<<S)-1,Lt=G+S+18;n||m+Lt<O;){var ht=_[Sy(i,m)&ae],Ht=ht>>>4;if(m+=ht&15,m>O)throw"unexpected EOF";if(!ht)throw"invalid length/literal";if(Ht<256)t[B++]=Ht;else if(Ht==256){_=null;break}else{var fe=Ht-254;if(Ht>264){var Pt=Ht-257,j=lm[Pt];fe=fA(i,m,(1<<j)-1)+P5[Pt],m+=j}var It=E[Sy(i,m)&se],bt=It>>>4;if(!It)throw"invalid distance";m+=It&15;var St=yD[bt];if(bt>3){var j=cm[bt];St+=Sy(i,m)&(1<<j)-1,m+=j}if(m>O)throw"unexpected EOF";l&&g(B+131072);for(var Vt=B+fe;B<Vt;B+=4)t[B]=t[B-St],t[B+1]=t[B+1-St],t[B+2]=t[B+2-St],t[B+3]=t[B+3-St];B=Vt}}e.l=_,e.p=m,e.b=B,_&&(h=1,e.m=G,e.d=E,e.n=S)}while(!h);return B==t.length?t:V5(t,0,B)},_l=function(i,t,e){e<<=t&7;var o=t/8>>0;i[o]|=e,i[o+1]|=e>>>8},zg=function(i,t,e){e<<=t&7;var o=t/8>>0;i[o]|=e,i[o+1]|=e>>>8,i[o+2]|=e>>>16},Fy=function(i,t){for(var e=[],o=0;o<i.length;++o)i[o]&&e.push({s:o,f:i[o]});var l=e.length,n=e.slice();if(!l)return[new Eo(0),0];if(l==1){var g=new Eo(e[0].s+1);return g[e[0].s]=1,[g,1]}e.sort(function(Pt,Qt){return Pt.f-Qt.f}),e.push({s:-1,f:25001});var h=e[0],m=e[1],B=0,_=1,E=2;for(e[0]={s:-1,f:h.f+m.f,l:h,r:m};_!=l-1;)h=e[e[B].f<e[E].f?B++:E++],m=e[B!=_&&e[B].f<e[E].f?B++:E++],e[_++]={s:-1,f:h.f+m.f,l:h,r:m};for(var G=n[0].s,o=1;o<l;++o)n[o].s>G&&(G=n[o].s);var S=new To(G+1),O=Hy(e[_-1],S,0);if(O>t){var o=0,P=0,tt=O-t,z=1<<tt;for(n.sort(function(Qt,Ut){return S[Ut.s]-S[Qt.s]||Qt.f-Ut.f});o<l;++o){var rt=n[o].s;if(S[rt]>t)P+=z-(1<<O-S[rt]),S[rt]=t;else break}for(P>>>=tt;P>0;){var ct=n[o].s;S[ct]<t?P-=1<<t-S[ct]++-1:++o}for(;o>=0&&P;--o){var Et=n[o].s;S[Et]==t&&(--S[Et],++P)}O=t}return[new Eo(S),O]},Hy=function(i,t,e){return i.s==-1?Math.max(Hy(i.l,t,e+1),Hy(i.r,t,e+1)):t[i.s]=e},f5=function(i){for(var t=i.length;t&&!i[--t];);for(var e=new To(++t),o=0,l=i[0],n=1,g=function(m){e[o++]=m},h=1;h<=t;++h)if(i[h]==l&&h!=t)++n;else{if(!l&&n>2){for(;n>138;n-=138)g(32754);n>2&&(g(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(g(l),--n;n>6;n-=6)g(8304);n>2&&(g(n-3<<5|8208),n=0)}for(;n--;)g(l);n=1,l=i[h]}return[e.subarray(0,o),t]},Jg=function(i,t){for(var e=0,o=0;o<t.length;++o)e+=i[o]*t[o];return e},im=function(i,t,e){var o=e.length,l=Xy(t+2);i[l]=o&255,i[l+1]=o>>>8,i[l+2]=i[l]^255,i[l+3]=i[l+1]^255;for(var n=0;n<o;++n)i[l+n+4]=e[n];return(l+4+o)*8},m5=function(i,t,e,o,l,n,g,h,m,B,_){_l(t,_++,e),++l[256];for(var E=Fy(l,15),G=E[0],S=E[1],O=Fy(n,15),P=O[0],tt=O[1],z=f5(G),rt=z[0],ct=z[1],Et=f5(P),Pt=Et[0],Qt=Et[1],Ut=new To(19),dt=0;dt<rt.length;++dt)Ut[rt[dt]&31]++;for(var dt=0;dt<Pt.length;++dt)Ut[Pt[dt]&31]++;for(var ee=Fy(Ut,7),oe=ee[0],ht=ee[1],At=19;At>4&&!oe[Gy[At-1]];--At);var Ft=B+5<<3,St=Jg(l,fc)+Jg(n,qg)+g,ue=Jg(l,G)+Jg(n,P)+g+14+3*At+Jg(Ut,oe)+(2*Ut[16]+3*Ut[17]+7*Ut[18]);if(Ft<=St&&Ft<=ue)return im(t,_,i.subarray(m,m+B));var ce,ae,se,Lt;if(_l(t,_,1+(ue<St)),_+=2,ue<St){ce=JA(G,S,0),ae=G,se=JA(P,tt,0),Lt=P;var Ht=JA(oe,ht,0);_l(t,_,ct-257),_l(t,_+5,Qt-1),_l(t,_+10,At-4),_+=14;for(var dt=0;dt<At;++dt)_l(t,_+3*dt,oe[Gy[dt]]);_+=3*At;for(var fe=[rt,Pt],j=0;j<2;++j)for(var It=fe[j],dt=0;dt<It.length;++dt){var bt=It[dt]&31;_l(t,_,Ht[bt]),_+=oe[bt],bt>15&&(_l(t,_,It[dt]>>>5&127),_+=It[dt]>>>12)}}else ce=bD,ae=fc,se=wD,Lt=qg;for(var dt=0;dt<h;++dt)if(o[dt]>255){var bt=o[dt]>>>18&31;zg(t,_,ce[bt+257]),_+=ae[bt+257],bt>7&&(_l(t,_,o[dt]>>>23&31),_+=lm[bt]);var Vt=o[dt]&31;zg(t,_,se[Vt]),_+=Lt[Vt],Vt>3&&(zg(t,_,o[dt]>>>5&8191),_+=cm[Vt])}else zg(t,_,ce[o[dt]]),_+=ae[o[dt]];return zg(t,_,ce[256]),_+ae[256]},xD=new jg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),SD=new Eo(0),FD=function(i,t,e,o,l,n){var g=i.length,h=new Eo(o+g+5*(1+Math.floor(g/7e3))+l),m=h.subarray(o,h.length-l),B=0;if(!t||g<8)for(var _=0;_<=g;_+=65535){var E=_+65535;E<g?B=im(m,B,i.subarray(_,E)):(m[_]=n,B=im(m,B,i.subarray(_,g)))}else{for(var G=xD[t-1],S=G>>>13,O=G&8191,P=(1<<e)-1,tt=new To(32768),z=new To(P+1),rt=Math.ceil(e/3),ct=2*rt,Et=function(Ii){return(i[Ii]^i[Ii+1]<<rt^i[Ii+2]<<ct)&P},Pt=new jg(25e3),Qt=new To(288),Ut=new To(32),dt=0,ee=0,_=0,oe=0,ht=0,At=0;_<g;++_){var Ft=Et(_),St=_&32767,ue=z[Ft];if(tt[St]=ue,z[Ft]=St,ht<=_){var ce=g-_;if((dt>7e3||oe>24576)&&ce>423){B=m5(i,m,0,Pt,Qt,Ut,ee,oe,At,_-At,B),oe=dt=ee=0,At=_;for(var ae=0;ae<286;++ae)Qt[ae]=0;for(var ae=0;ae<30;++ae)Ut[ae]=0}var se=2,Lt=0,Ht=O,fe=St-ue&32767;if(ce>2&&Ft==Et(_-fe))for(var j=Math.min(S,ce)-1,It=Math.min(32767,_),bt=Math.min(258,ce);fe<=It&&--Ht&&St!=ue;){if(i[_+se]==i[_+se-fe]){for(var Vt=0;Vt<bt&&i[_+Vt]==i[_+Vt-fe];++Vt);if(Vt>se){if(se=Vt,Lt=fe,Vt>j)break;for(var Xt=Math.min(fe,Vt-2),he=0,ae=0;ae<Xt;++ae){var me=_-fe+ae+32768&32767,be=tt[me],Ve=me-be+32768&32767;Ve>he&&(he=Ve,ue=me)}}}St=ue,ue=tt[St],fe+=St-ue+32768&32767}if(Lt){Pt[oe++]=268435456|Ry[se]<<18|p5[Lt];var De=Ry[se]&31,ei=p5[Lt]&31;ee+=lm[De]+cm[ei],++Qt[257+De],++Ut[ei],ht=_+se,++dt}else Pt[oe++]=i[_],++Qt[i[_]]}}B=m5(i,m,n,Pt,Qt,Ut,ee,oe,At,_-At,B),n||(B=im(m,B,SD))}return V5(h,0,o+Xy(B)+l)},kD=function(){var i=1,t=0;return{p:function(e){for(var o=i,l=t,n=e.length,g=0;g!=n;){for(var h=Math.min(g+5552,n);g<h;++g)o+=e[g],l+=o;o%=65521,l%=65521}i=o,t=l},d:function(){return(i>>>8<<16|(t&255)<<8|t>>>8)+((i&255)<<23)*2}}},LD=function(i,t,e,o,l){return FD(i,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):12+t.mem,e,o,!l)},ED=function(i,t,e){for(;e;++t)i[t]=e,e>>>=8},TD=function(i,t){var e=t.level,o=e==0?0:e<6?1:e==9?3:2;i[0]=120,i[1]=o<<6|(o?32-2*o:1)},QD=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};sr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();hn={log:ky,warn:function(i){sr.console&&(typeof sr.console.warn=="function"?sr.console.warn.apply(sr.console,arguments):ky.call(null,arguments))},error:function(i){sr.console&&(typeof sr.console.error=="function"?sr.console.error.apply(sr.console,arguments):ky(i))}};lu=sr.saveAs||((typeof window>"u"?"undefined":Nr(window))!=="object"||window!==sr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(i,t,e){var o=sr.URL||sr.webkitURL,l=document.createElement("a");t=t||i.name||"download",l.download=t,l.rel="noopener",typeof i=="string"?(l.href=i,l.origin!==location.origin?C5(l.href)?Ly(i,t,e):qf(l,l.target="_blank"):qf(l)):(l.href=o.createObjectURL(i),setTimeout(function(){o.revokeObjectURL(l.href)},4e4),setTimeout(function(){qf(l)},0))}:"msSaveOrOpenBlob"in navigator?function(i,t,e){if(t=t||i.name||"download",typeof i=="string")if(C5(i))Ly(i,t,e);else{var o=document.createElement("a");o.href=i,o.target="_blank",setTimeout(function(){qf(o)})}else navigator.msSaveOrOpenBlob(function(l,n){return n===void 0?n={autoBom:!1}:Nr(n)!=="object"&&(hn.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob([String.fromCharCode(65279),l],{type:l.type}):l}(i,e),t)}:function(i,t,e,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),typeof i=="string")return Ly(i,t,e);var l=i.type==="application/octet-stream",n=/constructor/i.test(sr.HTMLElement)||sr.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||l&&n)&&(typeof FileReader>"u"?"undefined":Nr(FileReader))==="object"){var h=new FileReader;h.onloadend=function(){var _=h.result;_=g?_:_.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=_:location=_,o=null},h.readAsDataURL(i)}else{var m=sr.URL||sr.webkitURL,B=m.createObjectURL(i);o?o.location=B:location.href=B,o=null,setTimeout(function(){m.revokeObjectURL(B)},4e4)}});Yg=sr.atob.bind(sr),Py=sr.btoa.bind(sr);I5="0123456789abcdef".split("");HD=function(i){for(var t=0;t<i.length;t++)i[t]=RD(i[t]);return i.join("")}(K5("hello"))!="5d41402abc4b2a76b9719d911017c592";y5={print:4,modify:8,copy:16,"annot-forms":32};ch.prototype.lsbFirstWord=function(i){return String.fromCharCode(i>>0&255,i>>8&255,i>>16&255,i>>24&255)},ch.prototype.toHexString=function(i){return i.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},ch.prototype.hexToBytes=function(i){for(var t=[],e=0;e<i.length;e+=2)t.push(String.fromCharCode(parseInt(i.substr(e,2),16)));return t.join("")},ch.prototype.processOwnerPassword=function(i,t){return Vy(My(t).substr(0,5),i)},ch.prototype.encryptor=function(i,t){var e=My(this.encryptionKey+String.fromCharCode(255&i,i>>8&255,i>>16&255,255&t,t>>8&255)).substr(0,10);return function(o){return Vy(e,o)}},am.prototype.equals=function(i){var t,e="id,objectNumber,equals";if(!i||Nr(i)!==Nr(this))return!1;var o=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!i.hasOwnProperty(t)||this[t]!==i[t])return!1;o++}for(t in i)i.hasOwnProperty(t)&&e.indexOf(t)<0&&o--;return o===0},nr.API={events:[]},nr.version="2.5.1";Pn=nr.API,Yy=1,hu=function(i){return i.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ah=function(i){return i.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},gr=function(i){return i.toFixed(2)},gc=function(i){return i.toFixed(5)};Pn.__acroform__={};Yo=function(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i},v5=function(i){return i*Yy},WA=function(i){var t=new z5,e=Ri.internal.getHeight(i)||0,o=Ri.internal.getWidth(i)||0;return t.BBox=[0,0,Number(gr(o)),Number(gr(e))],t},ND=Pn.__acroform__.setBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return i|=1<<t},PD=Pn.__acroform__.clearBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return i&=~(1<<t)},MD=Pn.__acroform__.getBit=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return i&1<<t?1:0},es=Pn.__acroform__.getBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return MD(i,t-1)},is=Pn.__acroform__.setBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return ND(i,t-1)},rs=Pn.__acroform__.clearBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return PD(i,t-1)},VD=Pn.__acroform__.calculateCoordinates=function(i,t){var e=t.internal.getHorizontalCoordinate,o=t.internal.getVerticalCoordinate,l=i[0],n=i[1],g=i[2],h=i[3],m={};return m.lowerLeft_X=e(l)||0,m.lowerLeft_Y=o(n+h)||0,m.upperRight_X=e(l+g)||0,m.upperRight_Y=o(n)||0,[Number(gr(m.lowerLeft_X)),Number(gr(m.lowerLeft_Y)),Number(gr(m.upperRight_X)),Number(gr(m.upperRight_Y))]},DD=function(i){if(i.appearanceStreamContent)return i.appearanceStreamContent;if(i.V||i.DV){var t=[],e=i._V||i.DV,o=Dy(i,e),l=i.scope.internal.getFont(i.fontName,i.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(i.scope.__private__.encodeColorString(i.color)),t.push("/"+l+" "+gr(o.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(o.text),t.push("ET"),t.push("Q"),t.push("EMC");var n=WA(i);return n.scope=i.scope,n.stream=t.join(`
`),n}},Dy=function(i,t){var e=i.fontSize===0?i.maxFontSize:i.fontSize,o={text:"",fontSize:""},l=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");l=i.multiline?l.map(function(ht){return ht.split(`
`)}):l.map(function(ht){return[ht]});var n=e,g=Ri.internal.getHeight(i)||0;g=g<0?-g:g;var h=Ri.internal.getWidth(i)||0;h=h<0?-h:h;var m=function(ht,At,Ft){if(ht+1<l.length){var St=At+" "+l[ht+1][0];return $f(St,i,Ft).width<=h-4}return!1};n++;t:for(;n>0;){t="",n--;var B,_,E=$f("3",i,n).height,G=i.multiline?g-n:(g-E)/2,S=G+=2,O=0,P=0,tt=0;if(n<=0){t=`(...) Tj
`,t+="% Width of Text: "+$f(t,i,n=12).width+", FieldWidth:"+h+`
`;break}for(var z="",rt=0,ct=0;ct<l.length;ct++)if(l.hasOwnProperty(ct)){var Et=!1;if(l[ct].length!==1&&tt!==l[ct].length-1){if((E+2)*(rt+2)+2>g)continue t;z+=l[ct][tt],Et=!0,P=ct,ct--}else{z=(z+=l[ct][tt]+" ").substr(z.length-1)==" "?z.substr(0,z.length-1):z;var Pt=parseInt(ct),Qt=m(Pt,z,n),Ut=ct>=l.length-1;if(Qt&&!Ut){z+=" ",tt=0;continue}if(Qt||Ut){if(Ut)P=Pt;else if(i.multiline&&(E+2)*(rt+2)+2>g)continue t}else{if(!i.multiline||(E+2)*(rt+2)+2>g)continue t;P=Pt}}for(var dt="",ee=O;ee<=P;ee++){var oe=l[ee];if(i.multiline){if(ee===P){dt+=oe[tt]+" ",tt=(tt+1)%oe.length;continue}if(ee===O){dt+=oe[oe.length-1]+" ";continue}}dt+=oe[0]+" "}switch(dt=dt.substr(dt.length-1)==" "?dt.substr(0,dt.length-1):dt,_=$f(dt,i,n).width,i.textAlign){case"right":B=h-_-2;break;case"center":B=(h-_)/2;break;case"left":default:B=2}t+=gr(B)+" "+gr(S)+` Td
`,t+="("+hu(dt)+`) Tj
`,t+=-gr(B)+` 0 Td
`,S=-(n+2),_=0,O=Et?P:P+1,rt++,z=""}break}return o.text=t,o.fontSize=n,o},$f=function(i,t,e){var o=t.scope.internal.getFont(t.fontName,t.fontStyle),l=t.scope.getStringUnitWidth(i,{font:o,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:o,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:l}},KD={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},OD=function(i,t){var e={type:"reference",object:i};t.internal.getPageInfo(i.page).pageContext.annotations.find(function(o){return o.type===e.type&&o.object===e.object})===void 0&&t.internal.getPageInfo(i.page).pageContext.annotations.push(e)},WD=function(i,t){for(var e in i)if(i.hasOwnProperty(e)){var o=e,l=i[e];t.internal.newObjectDeferredBegin(l.objId,!0),Nr(l)==="object"&&typeof l.putStream=="function"&&l.putStream(),delete i[o]}},zD=function(i,t){if(t.scope=i,i.internal!==void 0&&(i.internal.acroformPlugin===void 0||i.internal.acroformPlugin.isInitialized===!1)){if(CA.FieldNum=0,i.internal.acroformPlugin=JSON.parse(JSON.stringify(KD)),i.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Yy=i.internal.scaleFactor,i.internal.acroformPlugin.acroFormDictionaryRoot=new J5,i.internal.acroformPlugin.acroFormDictionaryRoot.scope=i,i.internal.acroformPlugin.acroFormDictionaryRoot._eventID=i.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(i)}),i.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var o=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var l in o)if(o.hasOwnProperty(l)){var n=o[l];n.objId=void 0,n.hasAnnotation&&OD(n,e)}})(i)}),i.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(i)}),i.internal.events.subscribe("postPutPages",function(e){(function(o,l){var n=!o;for(var g in o||(l.internal.newObjectDeferredBegin(l.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),l.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),o=o||l.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(o.hasOwnProperty(g)){var h=o[g],m=[],B=h.Rect;if(h.Rect&&(h.Rect=VD(h.Rect,l)),l.internal.newObjectDeferredBegin(h.objId,!0),h.DA=Ri.createDefaultAppearanceStream(h),Nr(h)==="object"&&typeof h.getKeyValueListForStream=="function"&&(m=h.getKeyValueListForStream()),h.Rect=B,h.hasAppearanceStream&&!h.appearanceStreamContent){var _=DD(h);m.push({key:"AP",value:"<</N "+_+">>"}),l.internal.acroformPlugin.xForms.push(_)}if(h.appearanceStreamContent){var E="";for(var G in h.appearanceStreamContent)if(h.appearanceStreamContent.hasOwnProperty(G)){var S=h.appearanceStreamContent[G];if(E+="/"+G+" ",E+="<<",Object.keys(S).length>=1||Array.isArray(S)){for(var g in S)if(S.hasOwnProperty(g)){var O=S[g];typeof O=="function"&&(O=O.call(l,h)),E+="/"+g+" "+O+" ",l.internal.acroformPlugin.xForms.indexOf(O)>=0||l.internal.acroformPlugin.xForms.push(O)}}else typeof(O=S)=="function"&&(O=O.call(l,h)),E+="/"+g+" "+O,l.internal.acroformPlugin.xForms.indexOf(O)>=0||l.internal.acroformPlugin.xForms.push(O);E+=">>"}m.push({key:"AP",value:`<<
`+E+">>"})}l.internal.putStream({additionalKeyValues:m,objectId:h.objId}),l.internal.out("endobj")}n&&WD(l.internal.acroformPlugin.xForms,l)})(e,i)}),i.internal.acroformPlugin.isInitialized=!0}},W5=Pn.__acroform__.arrayToPdfArray=function(i,t,e){var o=function(g){return g};if(Array.isArray(i)){for(var l="[",n=0;n<i.length;n++)switch(n!==0&&(l+=" "),Nr(i[n])){case"boolean":case"number":case"object":l+=i[n].toString();break;case"string":i[n].substr(0,1)!=="/"?(t!==void 0&&e&&(o=e.internal.getEncryptor(t)),l+="("+hu(o(i[n].toString()))+")"):l+=i[n].toString()}return l+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Ty=function(i,t,e){var o=function(l){return l};return t!==void 0&&e&&(o=e.internal.getEncryptor(t)),(i=i||"").toString(),i="("+hu(o(i))+")"},zA=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(i){this._objId=i}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};zA.prototype.toString=function(){return this.objId+" 0 R"},zA.prototype.putStream=function(){var i=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:i,objectId:this.objId}),this.scope.internal.out("endobj")},zA.prototype.getKeyValueListForStream=function(){var i=[],t=Object.getOwnPropertyNames(this).filter(function(n){return n!="content"&&n!="appearanceStreamContent"&&n!="scope"&&n!="objId"&&n.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var o=t[e],l=this[o];l&&(Array.isArray(l)?i.push({key:o,value:W5(l,this.objId,this.scope)}):l instanceof zA?(l.scope=this.scope,i.push({key:o,value:l.objId+" 0 R"})):typeof l!="function"&&i.push({key:o,value:l}))}return i};z5=function(){zA.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var i,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){i=e.trim()},get:function(){return i||null}})};Yo(z5,zA);J5=function(){zA.call(this);var i,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(i){var e=function(o){return o};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+hu(e(i))+")"}},set:function(e){i=e}})};Yo(J5,zA);CA=function i(){zA.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(z){if(isNaN(z))throw new Error('Invalid value "'+z+'" for attribute F supplied.');t=z}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!es(t,3)},set:function(z){z?this.F=is(t,3):this.F=rs(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(z){if(isNaN(z))throw new Error('Invalid value "'+z+'" for attribute Ff supplied.');e=z}});var o=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(o.length!==0)return o},set:function(z){o=z!==void 0?z:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!o||isNaN(o[0])?0:o[0]},set:function(z){o[0]=z}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!o||isNaN(o[1])?0:o[1]},set:function(z){o[1]=z}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!o||isNaN(o[2])?0:o[2]},set:function(z){o[2]=z}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!o||isNaN(o[3])?0:o[3]},set:function(z){o[3]=z}});var l="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return l},set:function(z){switch(z){case"/Btn":case"/Tx":case"/Ch":case"/Sig":l=z;break;default:throw new Error('Invalid value "'+z+'" for attribute FT supplied.')}}});var n=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!n||n.length<1){if(this instanceof Am)return;n="FieldObject"+i.FieldNum++}var z=function(rt){return rt};return this.scope&&(z=this.scope.internal.getEncryptor(this.objId)),"("+hu(z(n))+")"},set:function(z){n=z.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return n},set:function(z){n=z}});var g="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return g},set:function(z){g=z}});var h="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return h},set:function(z){h=z}});var m=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return m},set:function(z){m=z}});var B=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return B===void 0?50/Yy:B},set:function(z){B=z}});var _="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return _},set:function(z){_=z}});var E="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!E||this instanceof Am||this instanceof uu))return Ty(E,this.objId,this.scope)},set:function(z){z=z.toString(),E=z}});var G=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(G)return this instanceof Qs?G:Ty(G,this.objId,this.scope)},set:function(z){z=z.toString(),G=this instanceof Qs?z:z.substr(0,1)==="("?Ah(z.substr(1,z.length-2)):Ah(z)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qs?Ah(G.substr(1,G.length-1)):G},set:function(z){z=z.toString(),G=this instanceof Qs?"/"+z:z}});var S=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(S)return S},set:function(z){this.V=z}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(S)return this instanceof Qs?S:Ty(S,this.objId,this.scope)},set:function(z){z=z.toString(),S=this instanceof Qs?z:z.substr(0,1)==="("?Ah(z.substr(1,z.length-2)):Ah(z)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qs?Ah(S.substr(1,S.length-1)):S},set:function(z){z=z.toString(),S=this instanceof Qs?"/"+z:z}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var O,P=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return P},set:function(z){z=!!z,P=z}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(O)return O},set:function(z){O=z}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,1)},set:function(z){z?this.Ff=is(this.Ff,1):this.Ff=rs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,2)},set:function(z){z?this.Ff=is(this.Ff,2):this.Ff=rs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,3)},set:function(z){z?this.Ff=is(this.Ff,3):this.Ff=rs(this.Ff,3)}});var tt=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(tt!==null)return tt},set:function(z){if([0,1,2].indexOf(z)===-1)throw new Error('Invalid value "'+z+'" for attribute Q supplied.');tt=z}}),Object.defineProperty(this,"textAlign",{get:function(){var z;switch(tt){case 0:default:z="left";break;case 1:z="center";break;case 2:z="right"}return z},configurable:!0,enumerable:!0,set:function(z){switch(z){case"right":case 2:tt=2;break;case"center":case 1:tt=1;break;case"left":case 0:default:tt=0}}})};Yo(CA,zA);dh=function(){CA.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var i=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return W5(t,this.objId,this.scope)},set:function(e){var o,l;l=[],typeof(o=e)=="string"&&(l=function(n,g,h){h||(h=1);for(var m,B=[];m=g.exec(n);)B.push(m[h]);return B}(o,/\((.*?)\)/g)),t=l}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,o){for(o=o||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),o!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,18)},set:function(e){e?this.Ff=is(this.Ff,18):this.Ff=rs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=is(this.Ff,19):this.Ff=rs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,20)},set:function(e){e?(this.Ff=is(this.Ff,20),t.sort()):this.Ff=rs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,22)},set:function(e){e?this.Ff=is(this.Ff,22):this.Ff=rs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,23)},set:function(e){e?this.Ff=is(this.Ff,23):this.Ff=rs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,27)},set:function(e){e?this.Ff=is(this.Ff,27):this.Ff=rs(this.Ff,27)}}),this.hasAppearanceStream=!1};Yo(dh,CA);ph=function(){dh.call(this),this.fontName="helvetica",this.combo=!1};Yo(ph,dh);fh=function(){ph.call(this),this.combo=!0};Yo(fh,ph);rm=function(){fh.call(this),this.edit=!0};Yo(rm,fh);Qs=function(){CA.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,15)},set:function(e){e?this.Ff=is(this.Ff,15):this.Ff=rs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,16)},set:function(e){e?this.Ff=is(this.Ff,16):this.Ff=rs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,17)},set:function(e){e?this.Ff=is(this.Ff,17):this.Ff=rs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,26)},set:function(e){e?this.Ff=is(this.Ff,26):this.Ff=rs(this.Ff,26)}});var i,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(n){return n};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var o,l=[];for(o in l.push("<<"),t)l.push("/"+o+" ("+hu(e(t[o]))+")");return l.push(">>"),l.join(`
`)}},set:function(e){Nr(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(e){i="/"+e}})};Yo(Qs,CA);nm=function(){Qs.call(this),this.pushButton=!0};Yo(nm,Qs);mh=function(){Qs.call(this),this.radio=!0,this.pushButton=!1;var i=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t!==void 0?t:[]}})};Yo(mh,Qs);Am=function(){var i,t;CA.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return i},set:function(l){i=l}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(l){t=l}});var e,o={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var l=function(h){return h};this.scope&&(l=this.scope.internal.getEncryptor(this.objId));var n,g=[];for(n in g.push("<<"),o)g.push("/"+n+" ("+hu(l(o[n]))+")");return g.push(">>"),g.join(`
`)},set:function(l){Nr(l)==="object"&&(o=l)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return o.CA||""},set:function(l){typeof l=="string"&&(o.CA=l)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(l){e=l}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(l){e="/"+l}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ri.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Yo(Am,CA),mh.prototype.setAppearance=function(i){if(!("createAppearanceStream"in i)||!("getCA"in i))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=i.createAppearanceStream(e.optionName),e.caption=i.getCA()}},mh.prototype.createOption=function(i){var t=new Am;return t.Parent=this,t.optionName=i,this.Kids.push(t),JD.call(this.scope,t),t};sm=function(){Qs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ri.CheckBox.createAppearanceStream()};Yo(sm,Qs);uu=function(){CA.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,13)},set:function(t){t?this.Ff=is(this.Ff,13):this.Ff=rs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,21)},set:function(t){t?this.Ff=is(this.Ff,21):this.Ff=rs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,23)},set:function(t){t?this.Ff=is(this.Ff,23):this.Ff=rs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,24)},set:function(t){t?this.Ff=is(this.Ff,24):this.Ff=rs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,25)},set:function(t){t?this.Ff=is(this.Ff,25):this.Ff=rs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,26)},set:function(t){t?this.Ff=is(this.Ff,26):this.Ff=rs(this.Ff,26)}});var i=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return i},set:function(t){Number.isInteger(t)&&(i=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Yo(uu,CA);om=function(){uu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!es(this.Ff,14)},set:function(i){i?this.Ff=is(this.Ff,14):this.Ff=rs(this.Ff,14)}}),this.password=!0};Yo(om,uu);Ri={CheckBox:{createAppearanceStream:function(){return{N:{On:Ri.CheckBox.YesNormal},D:{On:Ri.CheckBox.YesPushDown,Off:Ri.CheckBox.OffPushDown}}},YesPushDown:function(i){var t=WA(i);t.scope=i.scope;var e=[],o=i.scope.internal.getFont(i.fontName,i.fontStyle).id,l=i.scope.__private__.encodeColorString(i.color),n=Dy(i,i.caption);return e.push("0.749023 g"),e.push("0 0 "+gr(Ri.internal.getWidth(i))+" "+gr(Ri.internal.getHeight(i))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+o+" "+gr(n.fontSize)+" Tf "+l),e.push("BT"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(i){var t=WA(i);t.scope=i.scope;var e=i.scope.internal.getFont(i.fontName,i.fontStyle).id,o=i.scope.__private__.encodeColorString(i.color),l=[],n=Ri.internal.getHeight(i),g=Ri.internal.getWidth(i),h=Dy(i,i.caption);return l.push("1 g"),l.push("0 0 "+gr(g)+" "+gr(n)+" re"),l.push("f"),l.push("q"),l.push("0 0 1 rg"),l.push("0 0 "+gr(g-1)+" "+gr(n-1)+" re"),l.push("W"),l.push("n"),l.push("0 g"),l.push("BT"),l.push("/"+e+" "+gr(h.fontSize)+" Tf "+o),l.push(h.text),l.push("ET"),l.push("Q"),t.stream=l.join(`
`),t},OffPushDown:function(i){var t=WA(i);t.scope=i.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+gr(Ri.internal.getWidth(i))+" "+gr(Ri.internal.getHeight(i))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(i){var t={D:{Off:Ri.RadioButton.Circle.OffPushDown},N:{}};return t.N[i]=Ri.RadioButton.Circle.YesNormal,t.D[i]=Ri.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(i){var t=WA(i);t.scope=i.scope;var e=[],o=Ri.internal.getWidth(i)<=Ri.internal.getHeight(i)?Ri.internal.getWidth(i)/4:Ri.internal.getHeight(i)/4;o=Number((.9*o).toFixed(5));var l=Ri.internal.Bezier_C,n=Number((o*l).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+gc(Ri.internal.getWidth(i)/2)+" "+gc(Ri.internal.getHeight(i)/2)+" cm"),e.push(o+" 0 m"),e.push(o+" "+n+" "+n+" "+o+" 0 "+o+" c"),e.push("-"+n+" "+o+" -"+o+" "+n+" -"+o+" 0 c"),e.push("-"+o+" -"+n+" -"+n+" -"+o+" 0 -"+o+" c"),e.push(n+" -"+o+" "+o+" -"+n+" "+o+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(i){var t=WA(i);t.scope=i.scope;var e=[],o=Ri.internal.getWidth(i)<=Ri.internal.getHeight(i)?Ri.internal.getWidth(i)/4:Ri.internal.getHeight(i)/4;o=Number((.9*o).toFixed(5));var l=Number((2*o).toFixed(5)),n=Number((l*Ri.internal.Bezier_C).toFixed(5)),g=Number((o*Ri.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+gc(Ri.internal.getWidth(i)/2)+" "+gc(Ri.internal.getHeight(i)/2)+" cm"),e.push(l+" 0 m"),e.push(l+" "+n+" "+n+" "+l+" 0 "+l+" c"),e.push("-"+n+" "+l+" -"+l+" "+n+" -"+l+" 0 c"),e.push("-"+l+" -"+n+" -"+n+" -"+l+" 0 -"+l+" c"),e.push(n+" -"+l+" "+l+" -"+n+" "+l+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+gc(Ri.internal.getWidth(i)/2)+" "+gc(Ri.internal.getHeight(i)/2)+" cm"),e.push(o+" 0 m"),e.push(o+" "+g+" "+g+" "+o+" 0 "+o+" c"),e.push("-"+g+" "+o+" -"+o+" "+g+" -"+o+" 0 c"),e.push("-"+o+" -"+g+" -"+g+" -"+o+" 0 -"+o+" c"),e.push(g+" -"+o+" "+o+" -"+g+" "+o+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(i){var t=WA(i);t.scope=i.scope;var e=[],o=Ri.internal.getWidth(i)<=Ri.internal.getHeight(i)?Ri.internal.getWidth(i)/4:Ri.internal.getHeight(i)/4;o=Number((.9*o).toFixed(5));var l=Number((2*o).toFixed(5)),n=Number((l*Ri.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+gc(Ri.internal.getWidth(i)/2)+" "+gc(Ri.internal.getHeight(i)/2)+" cm"),e.push(l+" 0 m"),e.push(l+" "+n+" "+n+" "+l+" 0 "+l+" c"),e.push("-"+n+" "+l+" -"+l+" "+n+" -"+l+" 0 c"),e.push("-"+l+" -"+n+" -"+n+" -"+l+" 0 -"+l+" c"),e.push(n+" -"+l+" "+l+" -"+n+" "+l+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(i){var t={D:{Off:Ri.RadioButton.Cross.OffPushDown},N:{}};return t.N[i]=Ri.RadioButton.Cross.YesNormal,t.D[i]=Ri.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(i){var t=WA(i);t.scope=i.scope;var e=[],o=Ri.internal.calculateCross(i);return e.push("q"),e.push("1 1 "+gr(Ri.internal.getWidth(i)-2)+" "+gr(Ri.internal.getHeight(i)-2)+" re"),e.push("W"),e.push("n"),e.push(gr(o.x1.x)+" "+gr(o.x1.y)+" m"),e.push(gr(o.x2.x)+" "+gr(o.x2.y)+" l"),e.push(gr(o.x4.x)+" "+gr(o.x4.y)+" m"),e.push(gr(o.x3.x)+" "+gr(o.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(i){var t=WA(i);t.scope=i.scope;var e=Ri.internal.calculateCross(i),o=[];return o.push("0.749023 g"),o.push("0 0 "+gr(Ri.internal.getWidth(i))+" "+gr(Ri.internal.getHeight(i))+" re"),o.push("f"),o.push("q"),o.push("1 1 "+gr(Ri.internal.getWidth(i)-2)+" "+gr(Ri.internal.getHeight(i)-2)+" re"),o.push("W"),o.push("n"),o.push(gr(e.x1.x)+" "+gr(e.x1.y)+" m"),o.push(gr(e.x2.x)+" "+gr(e.x2.y)+" l"),o.push(gr(e.x4.x)+" "+gr(e.x4.y)+" m"),o.push(gr(e.x3.x)+" "+gr(e.x3.y)+" l"),o.push("s"),o.push("Q"),t.stream=o.join(`
`),t},OffPushDown:function(i){var t=WA(i);t.scope=i.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+gr(Ri.internal.getWidth(i))+" "+gr(Ri.internal.getHeight(i))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(i){var t=i.scope.internal.getFont(i.fontName,i.fontStyle).id,e=i.scope.__private__.encodeColorString(i.color);return"/"+t+" "+i.fontSize+" Tf "+e}};Ri.internal={Bezier_C:.551915024494,calculateCross:function(i){var t=Ri.internal.getWidth(i),e=Ri.internal.getHeight(i),o=Math.min(t,e);return{x1:{x:(t-o)/2,y:(e-o)/2+o},x2:{x:(t-o)/2+o,y:(e-o)/2},x3:{x:(t-o)/2,y:(e-o)/2},x4:{x:(t-o)/2+o,y:(e-o)/2+o}}}},Ri.internal.getWidth=function(i){var t=0;return Nr(i)==="object"&&(t=v5(i.Rect[2])),t},Ri.internal.getHeight=function(i){var t=0;return Nr(i)==="object"&&(t=v5(i.Rect[3])),t};JD=Pn.addField=function(i){if(zD(this,i),!(i instanceof CA))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=i).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),i.page=i.scope.internal.getCurrentPageInfo().pageNumber,this};Pn.AcroFormChoiceField=dh,Pn.AcroFormListBox=ph,Pn.AcroFormComboBox=fh,Pn.AcroFormEditBox=rm,Pn.AcroFormButton=Qs,Pn.AcroFormPushButton=nm,Pn.AcroFormRadioButton=mh,Pn.AcroFormCheckBox=sm,Pn.AcroFormTextField=uu,Pn.AcroFormPasswordField=om,Pn.AcroFormAppearance=Ri,Pn.AcroForm={ChoiceField:dh,ListBox:ph,ComboBox:fh,EditBox:rm,Button:Qs,PushButton:nm,RadioButton:mh,CheckBox:sm,TextField:uu,PasswordField:om,Appearance:Ri},nr.AcroForm={ChoiceField:dh,ListBox:ph,ComboBox:fh,EditBox:rm,Button:Qs,PushButton:nm,RadioButton:mh,CheckBox:sm,TextField:uu,PasswordField:om,Appearance:Ri};(function(i){i.__addimage__={};var t="UNKNOWN",e={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},o=i.__addimage__.getImageFileTypeByImageData=function(ht,At){var Ft,St,ue,ce,ae,se=t;if((At=At||t)==="RGBA"||ht.data!==void 0&&ht.data instanceof Uint8ClampedArray&&"height"in ht&&"width"in ht)return"RGBA";if(Qt(ht))for(ae in e)for(ue=e[ae],Ft=0;Ft<ue.length;Ft+=1){for(ce=!0,St=0;St<ue[Ft].length;St+=1)if(ue[Ft][St]!==void 0&&ue[Ft][St]!==ht[St]){ce=!1;break}if(ce===!0){se=ae;break}}else for(ae in e)for(ue=e[ae],Ft=0;Ft<ue.length;Ft+=1){for(ce=!0,St=0;St<ue[Ft].length;St+=1)if(ue[Ft][St]!==void 0&&ue[Ft][St]!==ht.charCodeAt(St)){ce=!1;break}if(ce===!0){se=ae;break}}return se===t&&At!==t&&(se=At),se},l=function ht(At){for(var Ft=this.internal.write,St=this.internal.putStream,ue=(0,this.internal.getFilters)();ue.indexOf("FlateEncode")!==-1;)ue.splice(ue.indexOf("FlateEncode"),1);At.objectId=this.internal.newObject();var ce=[];if(ce.push({key:"Type",value:"/XObject"}),ce.push({key:"Subtype",value:"/Image"}),ce.push({key:"Width",value:At.width}),ce.push({key:"Height",value:At.height}),At.colorSpace===tt.INDEXED?ce.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(At.palette.length/3-1)+" "+("sMask"in At&&At.sMask!==void 0?At.objectId+2:At.objectId+1)+" 0 R]"}):(ce.push({key:"ColorSpace",value:"/"+At.colorSpace}),At.colorSpace===tt.DEVICE_CMYK&&ce.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ce.push({key:"BitsPerComponent",value:At.bitsPerComponent}),"decodeParameters"in At&&At.decodeParameters!==void 0&&ce.push({key:"DecodeParms",value:"<<"+At.decodeParameters+">>"}),"transparency"in At&&Array.isArray(At.transparency)){for(var ae="",se=0,Lt=At.transparency.length;se<Lt;se++)ae+=At.transparency[se]+" "+At.transparency[se]+" ";ce.push({key:"Mask",value:"["+ae+"]"})}At.sMask!==void 0&&ce.push({key:"SMask",value:At.objectId+1+" 0 R"});var Ht=At.filter!==void 0?["/"+At.filter]:void 0;if(St({data:At.data,additionalKeyValues:ce,alreadyAppliedFilters:Ht,objectId:At.objectId}),Ft("endobj"),"sMask"in At&&At.sMask!==void 0){var fe="/Predictor "+At.predictor+" /Colors 1 /BitsPerComponent "+At.bitsPerComponent+" /Columns "+At.width,j={width:At.width,height:At.height,colorSpace:"DeviceGray",bitsPerComponent:At.bitsPerComponent,decodeParameters:fe,data:At.sMask};"filter"in At&&(j.filter=At.filter),ht.call(this,j)}if(At.colorSpace===tt.INDEXED){var It=this.internal.newObject();St({data:dt(new Uint8Array(At.palette)),objectId:It}),Ft("endobj")}},n=function(){var ht=this.internal.collections.addImage_images;for(var At in ht)l.call(this,ht[At])},g=function(){var ht,At=this.internal.collections.addImage_images,Ft=this.internal.write;for(var St in At)Ft("/I"+(ht=At[St]).index,ht.objectId,"0","R")},h=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",n),this.internal.events.subscribe("putXobjectDict",g))},m=function(){var ht=this.internal.collections.addImage_images;return h.call(this),ht},B=function(){return Object.keys(this.internal.collections.addImage_images).length},_=function(ht){return typeof i["process"+ht.toUpperCase()]=="function"},E=function(ht){return Nr(ht)==="object"&&ht.nodeType===1},G=function(ht,At){if(ht.nodeName==="IMG"&&ht.hasAttribute("src")){var Ft=""+ht.getAttribute("src");if(Ft.indexOf("data:image/")===0)return Yg(unescape(Ft).split("base64,").pop());var St=i.loadFile(Ft,!0);if(St!==void 0)return St}if(ht.nodeName==="CANVAS"){if(ht.width===0||ht.height===0)throw new Error("Given canvas must have data. Canvas width: "+ht.width+", height: "+ht.height);var ue;switch(At){case"PNG":ue="image/png";break;case"WEBP":ue="image/webp";break;case"JPEG":case"JPG":default:ue="image/jpeg"}return Yg(ht.toDataURL(ue,1).split("base64,").pop())}},S=function(ht){var At=this.internal.collections.addImage_images;if(At){for(var Ft in At)if(ht===At[Ft].alias)return At[Ft]}},O=function(ht,At,Ft){return ht||At||(ht=-96,At=-96),ht<0&&(ht=-1*Ft.width*72/ht/this.internal.scaleFactor),At<0&&(At=-1*Ft.height*72/At/this.internal.scaleFactor),ht===0&&(ht=At*Ft.width/Ft.height),At===0&&(At=ht*Ft.height/Ft.width),[ht,At]},P=function(ht,At,Ft,St,ue,ce){var ae=O.call(this,Ft,St,ue),se=this.internal.getCoordinateString,Lt=this.internal.getVerticalCoordinateString,Ht=m.call(this);if(Ft=ae[0],St=ae[1],Ht[ue.index]=ue,ce){ce*=Math.PI/180;var fe=Math.cos(ce),j=Math.sin(ce),It=function(Vt){return Vt.toFixed(4)},bt=[It(fe),It(j),It(-1*j),It(fe),0,0,"cm"]}this.internal.write("q"),ce?(this.internal.write([1,"0","0",1,se(ht),Lt(At+St),"cm"].join(" ")),this.internal.write(bt.join(" ")),this.internal.write([se(Ft),"0","0",se(St),"0","0","cm"].join(" "))):this.internal.write([se(Ft),"0","0",se(St),se(ht),Lt(At+St),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ue.index+" Do"),this.internal.write("Q")},tt=i.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};i.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var z=i.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},rt=i.__addimage__.sHashCode=function(ht){var At,Ft,St=0;if(typeof ht=="string")for(Ft=ht.length,At=0;At<Ft;At++)St=(St<<5)-St+ht.charCodeAt(At),St|=0;else if(Qt(ht))for(Ft=ht.byteLength/2,At=0;At<Ft;At++)St=(St<<5)-St+ht[At],St|=0;return St},ct=i.__addimage__.validateStringAsBase64=function(ht){(ht=ht||"").toString().trim();var At=!0;return ht.length===0&&(At=!1),ht.length%4!=0&&(At=!1),/^[A-Za-z0-9+/]+$/.test(ht.substr(0,ht.length-2))===!1&&(At=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(ht.substr(-2))===!1&&(At=!1),At},Et=i.__addimage__.extractImageFromDataUrl=function(ht){var At=(ht=ht||"").split("base64,"),Ft=null;if(At.length===2){var St=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(At[0]);Array.isArray(St)&&(Ft={mimeType:St[1],charset:St[2],data:At[1]})}return Ft},Pt=i.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};i.__addimage__.isArrayBuffer=function(ht){return Pt()&&ht instanceof ArrayBuffer};var Qt=i.__addimage__.isArrayBufferView=function(ht){return Pt()&&typeof Uint32Array<"u"&&(ht instanceof Int8Array||ht instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&ht instanceof Uint8ClampedArray||ht instanceof Int16Array||ht instanceof Uint16Array||ht instanceof Int32Array||ht instanceof Uint32Array||ht instanceof Float32Array||ht instanceof Float64Array)},Ut=i.__addimage__.binaryStringToUint8Array=function(ht){for(var At=ht.length,Ft=new Uint8Array(At),St=0;St<At;St++)Ft[St]=ht.charCodeAt(St);return Ft},dt=i.__addimage__.arrayBufferToBinaryString=function(ht){for(var At="",Ft=Qt(ht)?ht:new Uint8Array(ht),St=0;St<Ft.length;St+=8192)At+=String.fromCharCode.apply(null,Ft.subarray(St,St+8192));return At};i.addImage=function(){var ht,At,Ft,St,ue,ce,ae,se,Lt;if(typeof arguments[1]=="number"?(At=t,Ft=arguments[1],St=arguments[2],ue=arguments[3],ce=arguments[4],ae=arguments[5],se=arguments[6],Lt=arguments[7]):(At=arguments[1],Ft=arguments[2],St=arguments[3],ue=arguments[4],ce=arguments[5],ae=arguments[6],se=arguments[7],Lt=arguments[8]),Nr(ht=arguments[0])==="object"&&!E(ht)&&"imageData"in ht){var Ht=ht;ht=Ht.imageData,At=Ht.format||At||t,Ft=Ht.x||Ft||0,St=Ht.y||St||0,ue=Ht.w||Ht.width||ue,ce=Ht.h||Ht.height||ce,ae=Ht.alias||ae,se=Ht.compression||se,Lt=Ht.rotation||Ht.angle||Lt}var fe=this.internal.getFilters();if(se===void 0&&fe.indexOf("FlateEncode")!==-1&&(se="SLOW"),isNaN(Ft)||isNaN(St))throw new Error("Invalid coordinates passed to jsPDF.addImage");h.call(this);var j=ee.call(this,ht,At,ae,se);return P.call(this,Ft,St,ue,ce,j,Lt),this};var ee=function(ht,At,Ft,St){var ue,ce,ae;if(typeof ht=="string"&&o(ht)===t){ht=unescape(ht);var se=oe(ht,!1);(se!==""||(se=i.loadFile(ht,!0))!==void 0)&&(ht=se)}if(E(ht)&&(ht=G(ht,At)),At=o(ht,At),!_(At))throw new Error("addImage does not support files of type '"+At+"', please ensure that a plugin for '"+At+"' support is added.");if(((ae=Ft)==null||ae.length===0)&&(Ft=function(Lt){return typeof Lt=="string"||Qt(Lt)?rt(Lt):Qt(Lt.data)?rt(Lt.data):null}(ht)),(ue=S.call(this,Ft))||(Pt()&&(ht instanceof Uint8Array||At==="RGBA"||(ce=ht,ht=Ut(ht))),ue=this["process"+At.toUpperCase()](ht,B.call(this),Ft,function(Lt){return Lt&&typeof Lt=="string"&&(Lt=Lt.toUpperCase()),Lt in i.image_compression?Lt:z.NONE}(St),ce)),!ue)throw new Error("An unknown error occurred whilst processing the image.");return ue},oe=i.__addimage__.convertBase64ToBinaryString=function(ht,At){var Ft;At=typeof At!="boolean"||At;var St,ue="";if(typeof ht=="string"){St=(Ft=Et(ht))!==null?Ft.data:ht;try{ue=Yg(St)}catch(ce){if(At)throw ct(St)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ce.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ue};i.getImageProperties=function(ht){var At,Ft,St="";if(E(ht)&&(ht=G(ht)),typeof ht=="string"&&o(ht)===t&&((St=oe(ht,!1))===""&&(St=i.loadFile(ht)||""),ht=St),Ft=o(ht),!_(Ft))throw new Error("addImage does not support files of type '"+Ft+"', please ensure that a plugin for '"+Ft+"' support is added.");if(!Pt()||ht instanceof Uint8Array||(ht=Ut(ht)),!(At=this["process"+Ft.toUpperCase()](ht)))throw new Error("An unknown error occurred whilst processing the image");return At.fileType=Ft,At}})(nr.API),function(i){var t=function(e){if(e!==void 0&&e!="")return!0};nr.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),i.events.push(["putPage",function(e){for(var o,l,n,g=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString,m=this.internal.getPageInfoByObjId(e.objId),B=e.pageContext.annotations,_=!1,E=0;E<B.length&&!_;E++)switch((o=B[E]).type){case"link":(t(o.options.url)||t(o.options.pageNumber))&&(_=!0);break;case"reference":case"text":case"freetext":_=!0}if(_!=0){this.internal.write("/Annots [");for(var G=0;G<B.length;G++){o=B[G];var S=this.internal.pdfEscape,O=this.internal.getEncryptor(e.objId);switch(o.type){case"reference":this.internal.write(" "+o.object.objId+" 0 R ");break;case"text":var P=this.internal.newAdditionalObject(),tt=this.internal.newAdditionalObject(),z=this.internal.getEncryptor(P.objId),rt=o.title||"Note";n="<</Type /Annot /Subtype /Text "+(l="/Rect ["+g(o.bounds.x)+" "+h(o.bounds.y+o.bounds.h)+" "+g(o.bounds.x+o.bounds.w)+" "+h(o.bounds.y)+"] ")+"/Contents ("+S(z(o.contents))+")",n+=" /Popup "+tt.objId+" 0 R",n+=" /P "+m.objId+" 0 R",n+=" /T ("+S(z(rt))+") >>",P.content=n;var ct=P.objId+" 0 R";n="<</Type /Annot /Subtype /Popup "+(l="/Rect ["+g(o.bounds.x+30)+" "+h(o.bounds.y+o.bounds.h)+" "+g(o.bounds.x+o.bounds.w+30)+" "+h(o.bounds.y)+"] ")+" /Parent "+ct,o.open&&(n+=" /Open true"),n+=" >>",tt.content=n,this.internal.write(P.objId,"0 R",tt.objId,"0 R");break;case"freetext":l="/Rect ["+g(o.bounds.x)+" "+h(o.bounds.y)+" "+g(o.bounds.x+o.bounds.w)+" "+h(o.bounds.y+o.bounds.h)+"] ";var Et=o.color||"#000000";n="<</Type /Annot /Subtype /FreeText "+l+"/Contents ("+S(O(o.contents))+")",n+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Et+")",n+=" /Border [0 0 0]",n+=" >>",this.internal.write(n);break;case"link":if(o.options.name){var Pt=this.annotations._nameMap[o.options.name];o.options.pageNumber=Pt.page,o.options.top=Pt.y}else o.options.top||(o.options.top=0);if(l="/Rect ["+o.finalBounds.x+" "+o.finalBounds.y+" "+o.finalBounds.w+" "+o.finalBounds.h+"] ",n="",o.options.url)n="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /A <</S /URI /URI ("+S(O(o.options.url))+") >>";else if(o.options.pageNumber)switch(n="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(o.options.pageNumber).objId+" 0 R",o.options.magFactor=o.options.magFactor||"XYZ",o.options.magFactor){case"Fit":n+=" /Fit]";break;case"FitH":n+=" /FitH "+o.options.top+"]";break;case"FitV":o.options.left=o.options.left||0,n+=" /FitV "+o.options.left+"]";break;case"XYZ":default:var Qt=h(o.options.top);o.options.left=o.options.left||0,o.options.zoom===void 0&&(o.options.zoom=0),n+=" /XYZ "+o.options.left+" "+Qt+" "+o.options.zoom+"]"}n!=""&&(n+=" >>",this.internal.write(n))}}this.internal.write("]")}}]),i.createAnnotation=function(e){var o=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":o.pageContext.annotations.push(e)}},i.link=function(e,o,l,n,g){var h=this.internal.getCurrentPageInfo(),m=this.internal.getCoordinateString,B=this.internal.getVerticalCoordinateString;h.pageContext.annotations.push({finalBounds:{x:m(e),y:B(o),w:m(e+l),h:B(o+n)},options:g,type:"link"})},i.textWithLink=function(e,o,l,n){var g,h,m=this.getTextWidth(e),B=this.internal.getLineHeight()/this.internal.scaleFactor;if(n.maxWidth!==void 0){h=n.maxWidth;var _=this.splitTextToSize(e,h).length;g=Math.ceil(B*_)}else h=m,g=B;return this.text(e,o,l,n),l+=.2*B,n.align==="center"&&(o-=m/2),n.align==="right"&&(o-=m),this.link(o,l-B,h,g,n),m},i.getTextWidth=function(e){var o=this.internal.getFontSize();return this.getStringUnitWidth(e)*o/this.internal.scaleFactor}}(nr.API),function(i){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},o={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},l=[1570,1571,1573,1575];i.__arabicParser__={};var n=i.__arabicParser__.isInArabicSubstitutionA=function(P){return t[P.charCodeAt(0)]!==void 0},g=i.__arabicParser__.isArabicLetter=function(P){return typeof P=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(P)},h=i.__arabicParser__.isArabicEndLetter=function(P){return g(P)&&n(P)&&t[P.charCodeAt(0)].length<=2},m=i.__arabicParser__.isArabicAlfLetter=function(P){return g(P)&&l.indexOf(P.charCodeAt(0))>=0};i.__arabicParser__.arabicLetterHasIsolatedForm=function(P){return g(P)&&n(P)&&t[P.charCodeAt(0)].length>=1};var B=i.__arabicParser__.arabicLetterHasFinalForm=function(P){return g(P)&&n(P)&&t[P.charCodeAt(0)].length>=2};i.__arabicParser__.arabicLetterHasInitialForm=function(P){return g(P)&&n(P)&&t[P.charCodeAt(0)].length>=3};var _=i.__arabicParser__.arabicLetterHasMedialForm=function(P){return g(P)&&n(P)&&t[P.charCodeAt(0)].length==4},E=i.__arabicParser__.resolveLigatures=function(P){var tt=0,z=e,rt="",ct=0;for(tt=0;tt<P.length;tt+=1)z[P.charCodeAt(tt)]!==void 0?(ct++,typeof(z=z[P.charCodeAt(tt)])=="number"&&(rt+=String.fromCharCode(z),z=e,ct=0),tt===P.length-1&&(z=e,rt+=P.charAt(tt-(ct-1)),tt-=ct-1,ct=0)):(z=e,rt+=P.charAt(tt-ct),tt-=ct,ct=0);return rt};i.__arabicParser__.isArabicDiacritic=function(P){return P!==void 0&&o[P.charCodeAt(0)]!==void 0};var G=i.__arabicParser__.getCorrectForm=function(P,tt,z){return g(P)?n(P)===!1?-1:!B(P)||!g(tt)&&!g(z)||!g(z)&&h(tt)||h(P)&&!g(tt)||h(P)&&m(tt)||h(P)&&h(tt)?0:_(P)&&g(tt)&&!h(tt)&&g(z)&&B(z)?3:h(P)||!g(z)?1:2:-1},S=function(P){var tt=0,z=0,rt=0,ct="",Et="",Pt="",Qt=(P=P||"").split("\\s+"),Ut=[];for(tt=0;tt<Qt.length;tt+=1){for(Ut.push(""),z=0;z<Qt[tt].length;z+=1)ct=Qt[tt][z],Et=Qt[tt][z-1],Pt=Qt[tt][z+1],g(ct)?(rt=G(ct,Et,Pt),Ut[tt]+=rt!==-1?String.fromCharCode(t[ct.charCodeAt(0)][rt]):ct):Ut[tt]+=ct;Ut[tt]=E(Ut[tt])}return Ut.join(" ")},O=i.__arabicParser__.processArabic=i.processArabic=function(){var P,tt=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,z=[];if(Array.isArray(tt)){var rt=0;for(z=[],rt=0;rt<tt.length;rt+=1)Array.isArray(tt[rt])?z.push([S(tt[rt][0]),tt[rt][1],tt[rt][2]]):z.push([S(tt[rt])]);P=z}else P=S(tt);return typeof arguments[0]=="string"?P:(arguments[0].text=P,arguments[0])};i.events.push(["preProcessText",O])}(nr.API),nr.API.autoPrint=function(i){var t;switch((i=i||{}).variant=i.variant||"non-conform",i.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(i){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(h){e=h}});var o=150;Object.defineProperty(this,"width",{get:function(){return o},set:function(h){o=isNaN(h)||Number.isInteger(h)===!1||h<0?150:h,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=o+1)}});var l=300;Object.defineProperty(this,"height",{get:function(){return l},set:function(h){l=isNaN(h)||Number.isInteger(h)===!1||h<0?300:h,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=l+1)}});var n=[];Object.defineProperty(this,"childNodes",{get:function(){return n},set:function(h){n=h}});var g={};Object.defineProperty(this,"style",{get:function(){return g},set:function(h){g=h}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,o){var l;if((e=e||"2d")!=="2d")return null;for(l in o)this.pdf.context2d.hasOwnProperty(l)&&(this.pdf.context2d[l]=o[l]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(nr.API),function(i){var t={left:0,top:0,bottom:0,right:0},e=!1,o=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),l.call(this))},l=function(){this.internal.__cell__.lastCell=new n,this.internal.__cell__.pages=1},n=function(){var m=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return m},set:function(P){m=P}});var B=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return B},set:function(P){B=P}});var _=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return _},set:function(P){_=P}});var E=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return E},set:function(P){E=P}});var G=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return G},set:function(P){G=P}});var S=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return S},set:function(P){S=P}});var O=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return O},set:function(P){O=P}}),this};n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},n.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},i.setHeaderFunction=function(m){return o.call(this),this.internal.__cell__.headerFunction=typeof m=="function"?m:void 0,this},i.getTextDimensions=function(m,B){o.call(this);var _=(B=B||{}).fontSize||this.getFontSize(),E=B.font||this.getFont(),G=B.scaleFactor||this.internal.scaleFactor,S=0,O=0,P=0,tt=this;if(!Array.isArray(m)&&typeof m!="string"){if(typeof m!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");m=String(m)}var z=B.maxWidth;z>0?typeof m=="string"?m=this.splitTextToSize(m,z):Object.prototype.toString.call(m)==="[object Array]"&&(m=m.reduce(function(ct,Et){return ct.concat(tt.splitTextToSize(Et,z))},[])):m=Array.isArray(m)?m:[m];for(var rt=0;rt<m.length;rt++)S<(P=this.getStringUnitWidth(m[rt],{font:E})*_)&&(S=P);return S!==0&&(O=m.length),{w:S/=G,h:Math.max((O*_*this.getLineHeightFactor()-_*(this.getLineHeightFactor()-1))/G,0)}},i.cellAddPage=function(){o.call(this),this.addPage();var m=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new n(m.left,m.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var g=i.cell=function(){var m;m=arguments[0]instanceof n?arguments[0]:new n(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),o.call(this);var B=this.internal.__cell__.lastCell,_=this.internal.__cell__.padding,E=this.internal.__cell__.margins||t,G=this.internal.__cell__.tableHeaderRow,S=this.internal.__cell__.printHeaders;return B.lineNumber!==void 0&&(B.lineNumber===m.lineNumber?(m.x=(B.x||0)+(B.width||0),m.y=B.y||0):B.y+B.height+m.height+E.bottom>this.getPageHeight()?(this.cellAddPage(),m.y=E.top,S&&G&&(this.printHeaderRow(m.lineNumber,!0),m.y+=G[0].height)):m.y=B.y+B.height||m.y),m.text[0]!==void 0&&(this.rect(m.x,m.y,m.width,m.height,e===!0?"FD":void 0),m.align==="right"?this.text(m.text,m.x+m.width-_,m.y+_,{align:"right",baseline:"top"}):m.align==="center"?this.text(m.text,m.x+m.width/2,m.y+_,{align:"center",baseline:"top",maxWidth:m.width-_-_}):this.text(m.text,m.x+_,m.y+_,{align:"left",baseline:"top",maxWidth:m.width-_-_})),this.internal.__cell__.lastCell=m,this};i.table=function(m,B,_,E,G){if(o.call(this),!_)throw new Error("No data for PDF table.");var S,O,P,tt,z=[],rt=[],ct=[],Et={},Pt={},Qt=[],Ut=[],dt=(G=G||{}).autoSize||!1,ee=G.printHeaders!==!1,oe=G.css&&G.css["font-size"]!==void 0?16*G.css["font-size"]:G.fontSize||12,ht=G.margins||Object.assign({width:this.getPageWidth()},t),At=typeof G.padding=="number"?G.padding:3,Ft=G.headerBackgroundColor||"#c8c8c8",St=G.headerTextColor||"#000";if(l.call(this),this.internal.__cell__.printHeaders=ee,this.internal.__cell__.margins=ht,this.internal.__cell__.table_font_size=oe,this.internal.__cell__.padding=At,this.internal.__cell__.headerBackgroundColor=Ft,this.internal.__cell__.headerTextColor=St,this.setFontSize(oe),E==null)rt=z=Object.keys(_[0]),ct=z.map(function(){return"left"});else if(Array.isArray(E)&&Nr(E[0])==="object")for(z=E.map(function(Ht){return Ht.name}),rt=E.map(function(Ht){return Ht.prompt||Ht.name||""}),ct=E.map(function(Ht){return Ht.align||"left"}),S=0;S<E.length;S+=1)Pt[E[S].name]=E[S].width*(19.049976/25.4);else Array.isArray(E)&&typeof E[0]=="string"&&(rt=z=E,ct=z.map(function(){return"left"}));if(dt||Array.isArray(E)&&typeof E[0]=="string")for(S=0;S<z.length;S+=1){for(Et[tt=z[S]]=_.map(function(Ht){return Ht[tt]}),this.setFont(void 0,"bold"),Qt.push(this.getTextDimensions(rt[S],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),O=Et[tt],this.setFont(void 0,"normal"),P=0;P<O.length;P+=1)Qt.push(this.getTextDimensions(O[P],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);Pt[tt]=Math.max.apply(null,Qt)+At+At,Qt=[]}if(ee){var ue={};for(S=0;S<z.length;S+=1)ue[z[S]]={},ue[z[S]].text=rt[S],ue[z[S]].align=ct[S];var ce=h.call(this,ue,Pt);Ut=z.map(function(Ht){return new n(m,B,Pt[Ht],ce,ue[Ht].text,void 0,ue[Ht].align)}),this.setTableHeaderRow(Ut),this.printHeaderRow(1,!1)}var ae=E.reduce(function(Ht,fe){return Ht[fe.name]=fe.align,Ht},{});for(S=0;S<_.length;S+=1){"rowStart"in G&&G.rowStart instanceof Function&&G.rowStart({row:S,data:_[S]},this);var se=h.call(this,_[S],Pt);for(P=0;P<z.length;P+=1){var Lt=_[S][z[P]];"cellStart"in G&&G.cellStart instanceof Function&&G.cellStart({row:S,col:P,data:Lt},this),g.call(this,new n(m,B,Pt[z[P]],se,Lt,S+2,ae[z[P]]))}}return this.internal.__cell__.table_x=m,this.internal.__cell__.table_y=B,this};var h=function(m,B){var _=this.internal.__cell__.padding,E=this.internal.__cell__.table_font_size,G=this.internal.scaleFactor;return Object.keys(m).map(function(S){var O=m[S];return this.splitTextToSize(O.hasOwnProperty("text")?O.text:O,B[S]-_-_)},this).map(function(S){return this.getLineHeightFactor()*S.length*E/G+_+_},this).reduce(function(S,O){return Math.max(S,O)},0)};i.setTableHeaderRow=function(m){o.call(this),this.internal.__cell__.tableHeaderRow=m},i.printHeaderRow=function(m,B){if(o.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var _;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var E=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new n(E[0],E[1],E[2],E[3],void 0,-1)}this.setFont(void 0,"bold");for(var G=[],S=0;S<this.internal.__cell__.tableHeaderRow.length;S+=1){_=this.internal.__cell__.tableHeaderRow[S].clone(),B&&(_.y=this.internal.__cell__.margins.top||0,G.push(_)),_.lineNumber=m;var O=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),g.call(this,_),this.setTextColor(O)}G.length>0&&this.setTableHeaderRow(G),this.setFont(void 0,"normal"),e=!1}}(nr.API);Y5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},j5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Ky=X5(j5),q5=[100,200,300,400,500,600,700,800,900],XD=X5(q5);YD={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},B5={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};k5=["times"];(function(i){var t,e,o,l,n,g,h,m,B,_=function(j){return j=j||{},this.isStrokeTransparent=j.isStrokeTransparent||!1,this.strokeOpacity=j.strokeOpacity||1,this.strokeStyle=j.strokeStyle||"#000000",this.fillStyle=j.fillStyle||"#000000",this.isFillTransparent=j.isFillTransparent||!1,this.fillOpacity=j.fillOpacity||1,this.font=j.font||"10px sans-serif",this.textBaseline=j.textBaseline||"alphabetic",this.textAlign=j.textAlign||"left",this.lineWidth=j.lineWidth||1,this.lineJoin=j.lineJoin||"miter",this.lineCap=j.lineCap||"butt",this.path=j.path||[],this.transform=j.transform!==void 0?j.transform.clone():new m,this.globalCompositeOperation=j.globalCompositeOperation||"normal",this.globalAlpha=j.globalAlpha||1,this.clip_path=j.clip_path||[],this.currentPoint=j.currentPoint||new g,this.miterLimit=j.miterLimit||10,this.lastPoint=j.lastPoint||new g,this.lineDashOffset=j.lineDashOffset||0,this.lineDash=j.lineDash||[],this.margin=j.margin||[0,0,0,0],this.prevPageLastElemOffset=j.prevPageLastElemOffset||0,this.ignoreClearRect=typeof j.ignoreClearRect!="boolean"||j.ignoreClearRect,this};i.events.push(["initialized",function(){this.context2d=new E(this),t=this.internal.f2,e=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getHorizontalCoordinate,n=this.internal.getVerticalCoordinate,g=this.internal.Point,h=this.internal.Rectangle,m=this.internal.Matrix,B=new _}]);var E=function(j){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var It=j;Object.defineProperty(this,"pdf",{get:function(){return It}});var bt=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return bt},set:function(Be){bt=!!Be}});var Vt=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return Vt},set:function(Be){Vt=!!Be}});var Xt=0;Object.defineProperty(this,"posX",{get:function(){return Xt},set:function(Be){isNaN(Be)||(Xt=Be)}});var he=0;Object.defineProperty(this,"posY",{get:function(){return he},set:function(Be){isNaN(Be)||(he=Be)}}),Object.defineProperty(this,"margin",{get:function(){return B.margin},set:function(Be){var Rt;typeof Be=="number"?Rt=[Be,Be,Be,Be]:((Rt=new Array(4))[0]=Be[0],Rt[1]=Be.length>=2?Be[1]:Rt[0],Rt[2]=Be.length>=3?Be[2]:Rt[0],Rt[3]=Be.length>=4?Be[3]:Rt[1]),B.margin=Rt}});var me=!1;Object.defineProperty(this,"autoPaging",{get:function(){return me},set:function(Be){me=Be}});var be=0;Object.defineProperty(this,"lastBreak",{get:function(){return be},set:function(Be){be=Be}});var Ve=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ve},set:function(Be){Ve=Be}}),Object.defineProperty(this,"ctx",{get:function(){return B},set:function(Be){Be instanceof _&&(B=Be)}}),Object.defineProperty(this,"path",{get:function(){return B.path},set:function(Be){B.path=Be}});var De=[];Object.defineProperty(this,"ctxStack",{get:function(){return De},set:function(Be){De=Be}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Be){var Rt;Rt=G(Be),this.ctx.fillStyle=Rt.style,this.ctx.isFillTransparent=Rt.a===0,this.ctx.fillOpacity=Rt.a,this.pdf.setFillColor(Rt.r,Rt.g,Rt.b,{a:Rt.a}),this.pdf.setTextColor(Rt.r,Rt.g,Rt.b,{a:Rt.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Be){var Rt=G(Be);this.ctx.strokeStyle=Rt.style,this.ctx.isStrokeTransparent=Rt.a===0,this.ctx.strokeOpacity=Rt.a,Rt.a===0?this.pdf.setDrawColor(255,255,255):(Rt.a,this.pdf.setDrawColor(Rt.r,Rt.g,Rt.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Be){["butt","round","square"].indexOf(Be)!==-1&&(this.ctx.lineCap=Be,this.pdf.setLineCap(Be))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Be){isNaN(Be)||(this.ctx.lineWidth=Be,this.pdf.setLineWidth(Be))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Be){["bevel","round","miter"].indexOf(Be)!==-1&&(this.ctx.lineJoin=Be,this.pdf.setLineJoin(Be))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Be){isNaN(Be)||(this.ctx.miterLimit=Be,this.pdf.setMiterLimit(Be))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Be){this.ctx.textBaseline=Be}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Be){["right","end","center","left","start"].indexOf(Be)!==-1&&(this.ctx.textAlign=Be)}});var ei=null;function ri(Be,Rt){if(ei===null){var Ui=function($t){var Ze=[];return Object.keys($t).forEach(function(We){$t[We].forEach(function(He){var Re=null;switch(He){case"bold":Re={family:We,weight:"bold"};break;case"italic":Re={family:We,style:"italic"};break;case"bolditalic":Re={family:We,weight:"bold",style:"italic"};break;case"":case"normal":Re={family:We}}Re!==null&&(Re.ref={name:We,style:He},Ze.push(Re))})}),Ze}(Be.getFontList());ei=function($t){for(var Ze={},We=0;We<$t.length;++We){var He=Oy($t[We]),Re=He.family,hi=He.stretch,yi=He.style,Qi=He.weight;Ze[Re]=Ze[Re]||{},Ze[Re][hi]=Ze[Re][hi]||{},Ze[Re][hi][yi]=Ze[Re][hi][yi]||{},Ze[Re][hi][yi][Qi]=He}return Ze}(Ui.concat(Rt))}return ei}var Ii=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ii},set:function(Be){ei=null,Ii=Be}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Be){var Rt;if(this.ctx.font=Be,(Rt=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Be))!==null){var Ui=Rt[1],$t=(Rt[2],Rt[3]),Ze=Rt[4],We=(Rt[5],Rt[6]),He=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ze)[2];Ze=Math.floor(He==="px"?parseFloat(Ze)*this.pdf.internal.scaleFactor:He==="em"?parseFloat(Ze)*this.pdf.getFontSize():parseFloat(Ze)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ze);var Re=function(Ei){var Fe,Ye,Ki=[],ji=Ei.trim();if(ji==="")return k5;if(ji in B5)return[B5[ji]];for(;ji!=="";){switch(Ye=null,Fe=(ji=x5(ji)).charAt(0)){case'"':case"'":Ye=qD(ji.substring(1),Fe);break;default:Ye=$D(ji)}if(Ye===null||(Ki.push(Ye[0]),(ji=x5(Ye[1]))!==""&&ji.charAt(0)!==","))return k5;ji=ji.replace(/^,/,"")}return Ki}(We);if(this.fontFaces){var hi=jD(ri(this.pdf,this.fontFaces),Re.map(function(Ei){return{family:Ei,stretch:"normal",weight:$t,style:Ui}}));this.pdf.setFont(hi.ref.name,hi.ref.style)}else{var yi="";($t==="bold"||parseInt($t,10)>=700||Ui==="bold")&&(yi="bold"),Ui==="italic"&&(yi+="italic"),yi.length===0&&(yi="normal");for(var Qi="",Pi={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},zi=0;zi<Re.length;zi++){if(this.pdf.internal.getFont(Re[zi],yi,{noFallback:!0,disableWarning:!0})!==void 0){Qi=Re[zi];break}if(yi==="bolditalic"&&this.pdf.internal.getFont(Re[zi],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Qi=Re[zi],yi="bold";else if(this.pdf.internal.getFont(Re[zi],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Qi=Re[zi],yi="normal";break}}if(Qi===""){for(var ir=0;ir<Re.length;ir++)if(Pi[Re[ir]]){Qi=Pi[Re[ir]];break}}Qi=Qi===""?"Times":Qi,this.pdf.setFont(Qi,yi)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Be){this.ctx.globalCompositeOperation=Be}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Be){this.ctx.globalAlpha=Be}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Be){this.ctx.lineDashOffset=Be,fe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Be){this.ctx.lineDash=Be,fe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Be){this.ctx.ignoreClearRect=!!Be}})};E.prototype.setLineDash=function(j){this.lineDash=j},E.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},E.prototype.fill=function(){Et.call(this,"fill",!1)},E.prototype.stroke=function(){Et.call(this,"stroke",!1)},E.prototype.beginPath=function(){this.path=[{type:"begin"}]},E.prototype.moveTo=function(j,It){if(isNaN(j)||isNaN(It))throw hn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var bt=this.ctx.transform.applyToPoint(new g(j,It));this.path.push({type:"mt",x:bt.x,y:bt.y}),this.ctx.lastPoint=new g(j,It)},E.prototype.closePath=function(){var j=new g(0,0),It=0;for(It=this.path.length-1;It!==-1;It--)if(this.path[It].type==="begin"&&Nr(this.path[It+1])==="object"&&typeof this.path[It+1].x=="number"){j=new g(this.path[It+1].x,this.path[It+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new g(j.x,j.y)},E.prototype.lineTo=function(j,It){if(isNaN(j)||isNaN(It))throw hn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var bt=this.ctx.transform.applyToPoint(new g(j,It));this.path.push({type:"lt",x:bt.x,y:bt.y}),this.ctx.lastPoint=new g(bt.x,bt.y)},E.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Et.call(this,null,!0)},E.prototype.quadraticCurveTo=function(j,It,bt,Vt){if(isNaN(bt)||isNaN(Vt)||isNaN(j)||isNaN(It))throw hn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Xt=this.ctx.transform.applyToPoint(new g(bt,Vt)),he=this.ctx.transform.applyToPoint(new g(j,It));this.path.push({type:"qct",x1:he.x,y1:he.y,x:Xt.x,y:Xt.y}),this.ctx.lastPoint=new g(Xt.x,Xt.y)},E.prototype.bezierCurveTo=function(j,It,bt,Vt,Xt,he){if(isNaN(Xt)||isNaN(he)||isNaN(j)||isNaN(It)||isNaN(bt)||isNaN(Vt))throw hn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var me=this.ctx.transform.applyToPoint(new g(Xt,he)),be=this.ctx.transform.applyToPoint(new g(j,It)),Ve=this.ctx.transform.applyToPoint(new g(bt,Vt));this.path.push({type:"bct",x1:be.x,y1:be.y,x2:Ve.x,y2:Ve.y,x:me.x,y:me.y}),this.ctx.lastPoint=new g(me.x,me.y)},E.prototype.arc=function(j,It,bt,Vt,Xt,he){if(isNaN(j)||isNaN(It)||isNaN(bt)||isNaN(Vt)||isNaN(Xt))throw hn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(he=!!he,!this.ctx.transform.isIdentity){var me=this.ctx.transform.applyToPoint(new g(j,It));j=me.x,It=me.y;var be=this.ctx.transform.applyToPoint(new g(0,bt)),Ve=this.ctx.transform.applyToPoint(new g(0,0));bt=Math.sqrt(Math.pow(be.x-Ve.x,2)+Math.pow(be.y-Ve.y,2))}Math.abs(Xt-Vt)>=2*Math.PI&&(Vt=0,Xt=2*Math.PI),this.path.push({type:"arc",x:j,y:It,radius:bt,startAngle:Vt,endAngle:Xt,counterclockwise:he})},E.prototype.arcTo=function(j,It,bt,Vt,Xt){throw new Error("arcTo not implemented.")},E.prototype.rect=function(j,It,bt,Vt){if(isNaN(j)||isNaN(It)||isNaN(bt)||isNaN(Vt))throw hn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(j,It),this.lineTo(j+bt,It),this.lineTo(j+bt,It+Vt),this.lineTo(j,It+Vt),this.lineTo(j,It),this.lineTo(j+bt,It),this.lineTo(j,It)},E.prototype.fillRect=function(j,It,bt,Vt){if(isNaN(j)||isNaN(It)||isNaN(bt)||isNaN(Vt))throw hn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!S.call(this)){var Xt={};this.lineCap!=="butt"&&(Xt.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Xt.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(j,It,bt,Vt),this.fill(),Xt.hasOwnProperty("lineCap")&&(this.lineCap=Xt.lineCap),Xt.hasOwnProperty("lineJoin")&&(this.lineJoin=Xt.lineJoin)}},E.prototype.strokeRect=function(j,It,bt,Vt){if(isNaN(j)||isNaN(It)||isNaN(bt)||isNaN(Vt))throw hn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");O.call(this)||(this.beginPath(),this.rect(j,It,bt,Vt),this.stroke())},E.prototype.clearRect=function(j,It,bt,Vt){if(isNaN(j)||isNaN(It)||isNaN(bt)||isNaN(Vt))throw hn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(j,It,bt,Vt))},E.prototype.save=function(j){j=typeof j!="boolean"||j;for(var It=this.pdf.internal.getCurrentPageInfo().pageNumber,bt=0;bt<this.pdf.internal.getNumberOfPages();bt++)this.pdf.setPage(bt+1),this.pdf.internal.out("q");if(this.pdf.setPage(It),j){this.ctx.fontSize=this.pdf.internal.getFontSize();var Vt=new _(this.ctx);this.ctxStack.push(this.ctx),this.ctx=Vt}},E.prototype.restore=function(j){j=typeof j!="boolean"||j;for(var It=this.pdf.internal.getCurrentPageInfo().pageNumber,bt=0;bt<this.pdf.internal.getNumberOfPages();bt++)this.pdf.setPage(bt+1),this.pdf.internal.out("Q");this.pdf.setPage(It),j&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},E.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var G=function(j){var It,bt,Vt,Xt;if(j.isCanvasGradient===!0&&(j=j.getColor()),!j)return{r:0,g:0,b:0,a:0,style:j};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(j))It=0,bt=0,Vt=0,Xt=0;else{var he=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(j);if(he!==null)It=parseInt(he[1]),bt=parseInt(he[2]),Vt=parseInt(he[3]),Xt=1;else if((he=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(j))!==null)It=parseInt(he[1]),bt=parseInt(he[2]),Vt=parseInt(he[3]),Xt=parseFloat(he[4]);else{if(Xt=1,typeof j=="string"&&j.charAt(0)!=="#"){var me=new D5(j);j=me.ok?me.toHex():"#000000"}j.length===4?(It=j.substring(1,2),It+=It,bt=j.substring(2,3),bt+=bt,Vt=j.substring(3,4),Vt+=Vt):(It=j.substring(1,3),bt=j.substring(3,5),Vt=j.substring(5,7)),It=parseInt(It,16),bt=parseInt(bt,16),Vt=parseInt(Vt,16)}}return{r:It,g:bt,b:Vt,a:Xt,style:j}},S=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},O=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};E.prototype.fillText=function(j,It,bt,Vt){if(isNaN(It)||isNaN(bt)||typeof j!="string")throw hn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(Vt=isNaN(Vt)?void 0:Vt,!S.call(this)){var Xt=se(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;At.call(this,{text:j,x:It,y:bt,scale:he,angle:Xt,align:this.textAlign,maxWidth:Vt})}},E.prototype.strokeText=function(j,It,bt,Vt){if(isNaN(It)||isNaN(bt)||typeof j!="string")throw hn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!O.call(this)){Vt=isNaN(Vt)?void 0:Vt;var Xt=se(this.ctx.transform.rotation),he=this.ctx.transform.scaleX;At.call(this,{text:j,x:It,y:bt,scale:he,renderingMode:"stroke",angle:Xt,align:this.textAlign,maxWidth:Vt})}},E.prototype.measureText=function(j){if(typeof j!="string")throw hn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var It=this.pdf,bt=this.pdf.internal.scaleFactor,Vt=It.internal.getFontSize(),Xt=It.getStringUnitWidth(j)*Vt/It.internal.scaleFactor,he=function(me){var be=(me=me||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return be}}),this};return new he({width:Xt*=Math.round(96*bt/72*1e4)/1e4})},E.prototype.scale=function(j,It){if(isNaN(j)||isNaN(It))throw hn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var bt=new m(j,0,0,It,0,0);this.ctx.transform=this.ctx.transform.multiply(bt)},E.prototype.rotate=function(j){if(isNaN(j))throw hn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var It=new m(Math.cos(j),Math.sin(j),-Math.sin(j),Math.cos(j),0,0);this.ctx.transform=this.ctx.transform.multiply(It)},E.prototype.translate=function(j,It){if(isNaN(j)||isNaN(It))throw hn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var bt=new m(1,0,0,1,j,It);this.ctx.transform=this.ctx.transform.multiply(bt)},E.prototype.transform=function(j,It,bt,Vt,Xt,he){if(isNaN(j)||isNaN(It)||isNaN(bt)||isNaN(Vt)||isNaN(Xt)||isNaN(he))throw hn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var me=new m(j,It,bt,Vt,Xt,he);this.ctx.transform=this.ctx.transform.multiply(me)},E.prototype.setTransform=function(j,It,bt,Vt,Xt,he){j=isNaN(j)?1:j,It=isNaN(It)?0:It,bt=isNaN(bt)?0:bt,Vt=isNaN(Vt)?1:Vt,Xt=isNaN(Xt)?0:Xt,he=isNaN(he)?0:he,this.ctx.transform=new m(j,It,bt,Vt,Xt,he)};var P=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};E.prototype.drawImage=function(j,It,bt,Vt,Xt,he,me,be,Ve){var De=this.pdf.getImageProperties(j),ei=1,ri=1,Ii=1,Be=1;Vt!==void 0&&be!==void 0&&(Ii=be/Vt,Be=Ve/Xt,ei=De.width/Vt*be/Vt,ri=De.height/Xt*Ve/Xt),he===void 0&&(he=It,me=bt,It=0,bt=0),Vt!==void 0&&be===void 0&&(be=Vt,Ve=Xt),Vt===void 0&&be===void 0&&(be=De.width,Ve=De.height);for(var Rt,Ui=this.ctx.transform.decompose(),$t=se(Ui.rotate.shx),Ze=new m,We=(Ze=(Ze=(Ze=Ze.multiply(Ui.translate)).multiply(Ui.skew)).multiply(Ui.scale)).applyToRectangle(new h(he-It*Ii,me-bt*Be,Vt*ei,Xt*ri)),He=tt.call(this,We),Re=[],hi=0;hi<He.length;hi+=1)Re.indexOf(He[hi])===-1&&Re.push(He[hi]);if(ct(Re),this.autoPaging)for(var yi=Re[0],Qi=Re[Re.length-1],Pi=yi;Pi<Qi+1;Pi++){this.pdf.setPage(Pi);var zi=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ir=Pi===1?this.posY+this.margin[0]:this.margin[0],Ei=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Fe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ye=Pi===1?0:Ei+(Pi-2)*Fe;if(this.ctx.clip_path.length!==0){var Ki=this.path;Rt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=rt(Rt,this.posX+this.margin[3],-Ye+ir+this.ctx.prevPageLastElemOffset),Pt.call(this,"fill",!0),this.path=Ki}var ji=JSON.parse(JSON.stringify(We));ji=rt([ji],this.posX+this.margin[3],-Ye+ir+this.ctx.prevPageLastElemOffset)[0];var vr=(Pi>yi||Pi<Qi)&&P.call(this);vr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],zi,Fe,null).clip().discardPath()),this.pdf.addImage(j,"JPEG",ji.x,ji.y,ji.w,ji.h,null,null,$t),vr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(j,"JPEG",We.x,We.y,We.w,We.h,null,null,$t)};var tt=function(j,It,bt){var Vt=[];It=It||this.pdf.internal.pageSize.width,bt=bt||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Xt=this.posY+this.ctx.prevPageLastElemOffset;switch(j.type){default:case"mt":case"lt":Vt.push(Math.floor((j.y+Xt)/bt)+1);break;case"arc":Vt.push(Math.floor((j.y+Xt-j.radius)/bt)+1),Vt.push(Math.floor((j.y+Xt+j.radius)/bt)+1);break;case"qct":var he=Lt(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x,j.y);Vt.push(Math.floor((he.y+Xt)/bt)+1),Vt.push(Math.floor((he.y+he.h+Xt)/bt)+1);break;case"bct":var me=Ht(this.ctx.lastPoint.x,this.ctx.lastPoint.y,j.x1,j.y1,j.x2,j.y2,j.x,j.y);Vt.push(Math.floor((me.y+Xt)/bt)+1),Vt.push(Math.floor((me.y+me.h+Xt)/bt)+1);break;case"rect":Vt.push(Math.floor((j.y+Xt)/bt)+1),Vt.push(Math.floor((j.y+j.h+Xt)/bt)+1)}for(var be=0;be<Vt.length;be+=1)for(;this.pdf.internal.getNumberOfPages()<Vt[be];)z.call(this);return Vt},z=function(){var j=this.fillStyle,It=this.strokeStyle,bt=this.font,Vt=this.lineCap,Xt=this.lineWidth,he=this.lineJoin;this.pdf.addPage(),this.fillStyle=j,this.strokeStyle=It,this.font=bt,this.lineCap=Vt,this.lineWidth=Xt,this.lineJoin=he},rt=function(j,It,bt){for(var Vt=0;Vt<j.length;Vt++)switch(j[Vt].type){case"bct":j[Vt].x2+=It,j[Vt].y2+=bt;case"qct":j[Vt].x1+=It,j[Vt].y1+=bt;case"mt":case"lt":case"arc":default:j[Vt].x+=It,j[Vt].y+=bt}return j},ct=function(j){return j.sort(function(It,bt){return It-bt})},Et=function(j,It){for(var bt,Vt,Xt=this.fillStyle,he=this.strokeStyle,me=this.lineCap,be=this.lineWidth,Ve=Math.abs(be*this.ctx.transform.scaleX),De=this.lineJoin,ei=JSON.parse(JSON.stringify(this.path)),ri=JSON.parse(JSON.stringify(this.path)),Ii=[],Be=0;Be<ri.length;Be++)if(ri[Be].x!==void 0)for(var Rt=tt.call(this,ri[Be]),Ui=0;Ui<Rt.length;Ui+=1)Ii.indexOf(Rt[Ui])===-1&&Ii.push(Rt[Ui]);for(var $t=0;$t<Ii.length;$t++)for(;this.pdf.internal.getNumberOfPages()<Ii[$t];)z.call(this);if(ct(Ii),this.autoPaging)for(var Ze=Ii[0],We=Ii[Ii.length-1],He=Ze;He<We+1;He++){this.pdf.setPage(He),this.fillStyle=Xt,this.strokeStyle=he,this.lineCap=me,this.lineWidth=Ve,this.lineJoin=De;var Re=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],hi=He===1?this.posY+this.margin[0]:this.margin[0],yi=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qi=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Pi=He===1?0:yi+(He-2)*Qi;if(this.ctx.clip_path.length!==0){var zi=this.path;bt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=rt(bt,this.posX+this.margin[3],-Pi+hi+this.ctx.prevPageLastElemOffset),Pt.call(this,j,!0),this.path=zi}if(Vt=JSON.parse(JSON.stringify(ei)),this.path=rt(Vt,this.posX+this.margin[3],-Pi+hi+this.ctx.prevPageLastElemOffset),It===!1||He===0){var ir=(He>Ze||He<We)&&P.call(this);ir&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Re,Qi,null).clip().discardPath()),Pt.call(this,j,It),ir&&this.pdf.restoreGraphicsState()}this.lineWidth=be}else this.lineWidth=Ve,Pt.call(this,j,It),this.lineWidth=be;this.path=ei},Pt=function(j,It){if((j!=="stroke"||It||!O.call(this))&&(j==="stroke"||It||!S.call(this))){for(var bt,Vt,Xt=[],he=this.path,me=0;me<he.length;me++){var be=he[me];switch(be.type){case"begin":Xt.push({begin:!0});break;case"close":Xt.push({close:!0});break;case"mt":Xt.push({start:be,deltas:[],abs:[]});break;case"lt":var Ve=Xt.length;if(he[me-1]&&!isNaN(he[me-1].x)&&(bt=[be.x-he[me-1].x,be.y-he[me-1].y],Ve>0)){for(;Ve>=0;Ve--)if(Xt[Ve-1].close!==!0&&Xt[Ve-1].begin!==!0){Xt[Ve-1].deltas.push(bt),Xt[Ve-1].abs.push(be);break}}break;case"bct":bt=[be.x1-he[me-1].x,be.y1-he[me-1].y,be.x2-he[me-1].x,be.y2-he[me-1].y,be.x-he[me-1].x,be.y-he[me-1].y],Xt[Xt.length-1].deltas.push(bt);break;case"qct":var De=he[me-1].x+2/3*(be.x1-he[me-1].x),ei=he[me-1].y+2/3*(be.y1-he[me-1].y),ri=be.x+2/3*(be.x1-be.x),Ii=be.y+2/3*(be.y1-be.y),Be=be.x,Rt=be.y;bt=[De-he[me-1].x,ei-he[me-1].y,ri-he[me-1].x,Ii-he[me-1].y,Be-he[me-1].x,Rt-he[me-1].y],Xt[Xt.length-1].deltas.push(bt);break;case"arc":Xt.push({deltas:[],abs:[],arc:!0}),Array.isArray(Xt[Xt.length-1].abs)&&Xt[Xt.length-1].abs.push(be)}}Vt=It?null:j==="stroke"?"stroke":"fill";for(var Ui=!1,$t=0;$t<Xt.length;$t++)if(Xt[$t].arc)for(var Ze=Xt[$t].abs,We=0;We<Ze.length;We++){var He=Ze[We];He.type==="arc"?dt.call(this,He.x,He.y,He.radius,He.startAngle,He.endAngle,He.counterclockwise,void 0,It,!Ui):Ft.call(this,He.x,He.y),Ui=!0}else if(Xt[$t].close===!0)this.pdf.internal.out("h"),Ui=!1;else if(Xt[$t].begin!==!0){var Re=Xt[$t].start.x,hi=Xt[$t].start.y;St.call(this,Xt[$t].deltas,Re,hi),Ui=!0}Vt&&ee.call(this,Vt),It&&oe.call(this)}},Qt=function(j){var It=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,bt=It*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return j-bt;case"top":return j+It-bt;case"hanging":return j+It-2*bt;case"middle":return j+It/2-bt;case"ideographic":return j;case"alphabetic":default:return j}},Ut=function(j){return j+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};E.prototype.createLinearGradient=function(){var j=function(){};return j.colorStops=[],j.addColorStop=function(It,bt){this.colorStops.push([It,bt])},j.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},j.isCanvasGradient=!0,j},E.prototype.createPattern=function(){return this.createLinearGradient()},E.prototype.createRadialGradient=function(){return this.createLinearGradient()};var dt=function(j,It,bt,Vt,Xt,he,me,be,Ve){for(var De=ce.call(this,bt,Vt,Xt,he),ei=0;ei<De.length;ei++){var ri=De[ei];ei===0&&(Ve?ht.call(this,ri.x1+j,ri.y1+It):Ft.call(this,ri.x1+j,ri.y1+It)),ue.call(this,j,It,ri.x2,ri.y2,ri.x3,ri.y3,ri.x4,ri.y4)}be?oe.call(this):ee.call(this,me)},ee=function(j){switch(j){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},oe=function(){this.pdf.clip(),this.pdf.discardPath()},ht=function(j,It){this.pdf.internal.out(e(j)+" "+o(It)+" m")},At=function(j){var It;switch(j.align){case"right":case"end":It="right";break;case"center":It="center";break;case"left":case"start":default:It="left"}var bt=this.pdf.getTextDimensions(j.text),Vt=Qt.call(this,j.y),Xt=Ut.call(this,Vt)-bt.h,he=this.ctx.transform.applyToPoint(new g(j.x,Vt)),me=this.ctx.transform.decompose(),be=new m;be=(be=(be=be.multiply(me.translate)).multiply(me.skew)).multiply(me.scale);for(var Ve,De,ei,ri=this.ctx.transform.applyToRectangle(new h(j.x,Vt,bt.w,bt.h)),Ii=be.applyToRectangle(new h(j.x,Xt,bt.w,bt.h)),Be=tt.call(this,Ii),Rt=[],Ui=0;Ui<Be.length;Ui+=1)Rt.indexOf(Be[Ui])===-1&&Rt.push(Be[Ui]);if(ct(Rt),this.autoPaging)for(var $t=Rt[0],Ze=Rt[Rt.length-1],We=$t;We<Ze+1;We++){this.pdf.setPage(We);var He=We===1?this.posY+this.margin[0]:this.margin[0],Re=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],hi=this.pdf.internal.pageSize.height-this.margin[2],yi=hi-this.margin[0],Qi=this.pdf.internal.pageSize.width-this.margin[1],Pi=Qi-this.margin[3],zi=We===1?0:Re+(We-2)*yi;if(this.ctx.clip_path.length!==0){var ir=this.path;Ve=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=rt(Ve,this.posX+this.margin[3],-1*zi+He),Pt.call(this,"fill",!0),this.path=ir}var Ei=rt([JSON.parse(JSON.stringify(Ii))],this.posX+this.margin[3],-zi+He+this.ctx.prevPageLastElemOffset)[0];j.scale>=.01&&(De=this.pdf.internal.getFontSize(),this.pdf.setFontSize(De*j.scale),ei=this.lineWidth,this.lineWidth=ei*j.scale);var Fe=this.autoPaging!=="text";if(Fe||Ei.y+Ei.h<=hi){if(Fe||Ei.y>=He&&Ei.x<=Qi){var Ye=Fe?j.text:this.pdf.splitTextToSize(j.text,j.maxWidth||Qi-Ei.x)[0],Ki=rt([JSON.parse(JSON.stringify(ri))],this.posX+this.margin[3],-zi+He+this.ctx.prevPageLastElemOffset)[0],ji=Fe&&(We>$t||We<Ze)&&P.call(this);ji&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pi,yi,null).clip().discardPath()),this.pdf.text(Ye,Ki.x,Ki.y,{angle:j.angle,align:It,renderingMode:j.renderingMode}),ji&&this.pdf.restoreGraphicsState()}}else Ei.y<hi&&(this.ctx.prevPageLastElemOffset+=hi-Ei.y);j.scale>=.01&&(this.pdf.setFontSize(De),this.lineWidth=ei)}else j.scale>=.01&&(De=this.pdf.internal.getFontSize(),this.pdf.setFontSize(De*j.scale),ei=this.lineWidth,this.lineWidth=ei*j.scale),this.pdf.text(j.text,he.x+this.posX,he.y+this.posY,{angle:j.angle,align:It,renderingMode:j.renderingMode,maxWidth:j.maxWidth}),j.scale>=.01&&(this.pdf.setFontSize(De),this.lineWidth=ei)},Ft=function(j,It,bt,Vt){bt=bt||0,Vt=Vt||0,this.pdf.internal.out(e(j+bt)+" "+o(It+Vt)+" l")},St=function(j,It,bt){return this.pdf.lines(j,It,bt,null,null)},ue=function(j,It,bt,Vt,Xt,he,me,be){this.pdf.internal.out([t(l(bt+j)),t(n(Vt+It)),t(l(Xt+j)),t(n(he+It)),t(l(me+j)),t(n(be+It)),"c"].join(" "))},ce=function(j,It,bt,Vt){for(var Xt=2*Math.PI,he=Math.PI/2;It>bt;)It-=Xt;var me=Math.abs(bt-It);me<Xt&&Vt&&(me=Xt-me);for(var be=[],Ve=Vt?-1:1,De=It;me>1e-5;){var ei=De+Ve*Math.min(me,he);be.push(ae.call(this,j,De,ei)),me-=Math.abs(ei-De),De=ei}return be},ae=function(j,It,bt){var Vt=(bt-It)/2,Xt=j*Math.cos(Vt),he=j*Math.sin(Vt),me=Xt,be=-he,Ve=me*me+be*be,De=Ve+me*Xt+be*he,ei=4/3*(Math.sqrt(2*Ve*De)-De)/(me*he-be*Xt),ri=me-ei*be,Ii=be+ei*me,Be=ri,Rt=-Ii,Ui=Vt+It,$t=Math.cos(Ui),Ze=Math.sin(Ui);return{x1:j*Math.cos(It),y1:j*Math.sin(It),x2:ri*$t-Ii*Ze,y2:ri*Ze+Ii*$t,x3:Be*$t-Rt*Ze,y3:Be*Ze+Rt*$t,x4:j*Math.cos(bt),y4:j*Math.sin(bt)}},se=function(j){return 180*j/Math.PI},Lt=function(j,It,bt,Vt,Xt,he){var me=j+.5*(bt-j),be=It+.5*(Vt-It),Ve=Xt+.5*(bt-Xt),De=he+.5*(Vt-he),ei=Math.min(j,Xt,me,Ve),ri=Math.max(j,Xt,me,Ve),Ii=Math.min(It,he,be,De),Be=Math.max(It,he,be,De);return new h(ei,Ii,ri-ei,Be-Ii)},Ht=function(j,It,bt,Vt,Xt,he,me,be){var Ve,De,ei,ri,Ii,Be,Rt,Ui,$t,Ze,We,He,Re,hi,yi=bt-j,Qi=Vt-It,Pi=Xt-bt,zi=he-Vt,ir=me-Xt,Ei=be-he;for(De=0;De<41;De++)$t=(Rt=(ei=j+(Ve=De/40)*yi)+Ve*((Ii=bt+Ve*Pi)-ei))+Ve*(Ii+Ve*(Xt+Ve*ir-Ii)-Rt),Ze=(Ui=(ri=It+Ve*Qi)+Ve*((Be=Vt+Ve*zi)-ri))+Ve*(Be+Ve*(he+Ve*Ei-Be)-Ui),De==0?(We=$t,He=Ze,Re=$t,hi=Ze):(We=Math.min(We,$t),He=Math.min(He,Ze),Re=Math.max(Re,$t),hi=Math.max(hi,Ze));return new h(Math.round(We),Math.round(He),Math.round(Re-We),Math.round(hi-He))},fe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var j,It,bt=(j=this.ctx.lineDash,It=this.ctx.lineDashOffset,JSON.stringify({lineDash:j,lineDashOffset:It}));this.prevLineDash!==bt&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=bt)}}})(nr.API),function(i){var t=function(n){var g,h,m,B,_,E,G,S,O,P;for(h=[],m=0,B=(n+=g="\0\0\0\0".slice(n.length%4||4)).length;B>m;m+=4)(_=(n.charCodeAt(m)<<24)+(n.charCodeAt(m+1)<<16)+(n.charCodeAt(m+2)<<8)+n.charCodeAt(m+3))!==0?(E=(_=((_=((_=((_=(_-(P=_%85))/85)-(O=_%85))/85)-(S=_%85))/85)-(G=_%85))/85)%85,h.push(E+33,G+33,S+33,O+33,P+33)):h.push(122);return function(tt,z){for(var rt=z;rt>0;rt--)tt.pop()}(h,g.length),String.fromCharCode.apply(String,h)+"~>"},e=function(n){var g,h,m,B,_,E=String,G="length",S=255,O="charCodeAt",P="slice",tt="replace";for(n[P](-2),n=n[P](0,-2)[tt](/\s/g,"")[tt]("z","!!!!!"),m=[],B=0,_=(n+=g="uuuuu"[P](n[G]%5||5))[G];_>B;B+=5)h=52200625*(n[O](B)-33)+614125*(n[O](B+1)-33)+7225*(n[O](B+2)-33)+85*(n[O](B+3)-33)+(n[O](B+4)-33),m.push(S&h>>24,S&h>>16,S&h>>8,S&h);return function(z,rt){for(var ct=rt;ct>0;ct--)z.pop()}(m,g[G]),E.fromCharCode.apply(E,m)},o=function(n){var g=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((n=n.replace(/\s/g,"")).indexOf(">")!==-1&&(n=n.substr(0,n.indexOf(">"))),n.length%2&&(n+="0"),g.test(n)===!1)return"";for(var h="",m=0;m<n.length;m+=2)h+=String.fromCharCode("0x"+(n[m]+n[m+1]));return h},l=function(n){for(var g=new Uint8Array(n.length),h=n.length;h--;)g[h]=n.charCodeAt(h);return n=(g=Ny(g)).reduce(function(m,B){return m+String.fromCharCode(B)},"")};i.processDataByFilters=function(n,g){var h=0,m=n||"",B=[];for(typeof(g=g||[])=="string"&&(g=[g]),h=0;h<g.length;h+=1)switch(g[h]){case"ASCII85Decode":case"/ASCII85Decode":m=e(m),B.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":m=t(m),B.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":m=o(m),B.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":m=m.split("").map(function(_){return("0"+_.charCodeAt().toString(16)).slice(-2)}).join("")+">",B.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":m=l(m),B.push("/FlateDecode");break;default:throw new Error('The filter: "'+g[h]+'" is not implemented')}return{data:m,reverseChain:B.reverse().join(" ")}}}(nr.API),function(i){i.loadFile=function(t,e,o){return function(l,n,g){n=n!==!1,g=typeof g=="function"?g:function(){};var h=void 0;try{h=function(m,B,_){var E=new XMLHttpRequest,G=0,S=function(O){var P=O.length,tt=[],z=String.fromCharCode;for(G=0;G<P;G+=1)tt.push(z(255&O.charCodeAt(G)));return tt.join("")};if(E.open("GET",m,!B),E.overrideMimeType("text/plain; charset=x-user-defined"),B===!1&&(E.onload=function(){E.status===200?_(S(this.responseText)):_(void 0)}),E.send(null),B&&E.status===200)return S(E.responseText)}(l,n,g)}catch{}return h}(t,e,o)},i.loadImageFile=i.loadFile}(nr.API),function(i){function t(){return(sr.html2canvas?Promise.resolve(sr.html2canvas):Promise.resolve().then(()=>(rw(),iw))).catch(function(g){return Promise.reject(new Error("Could not load html2canvas: "+g))}).then(function(g){return g.default?g.default:g})}function e(){return(sr.DOMPurify?Promise.resolve(sr.DOMPurify):Promise.resolve().then(()=>(gw(),hw))).catch(function(g){return Promise.reject(new Error("Could not load dompurify: "+g))}).then(function(g){return g.default?g.default:g})}var o=function(g){var h=Nr(g);return h==="undefined"?"undefined":h==="string"||g instanceof String?"string":h==="number"||g instanceof Number?"number":h==="function"||g instanceof Function?"function":g&&g.constructor===Array?"array":g&&g.nodeType===1?"element":h==="object"?"object":"unknown"},l=function(g,h){var m=document.createElement(g);for(var B in h.className&&(m.className=h.className),h.innerHTML&&h.dompurify&&(m.innerHTML=h.dompurify.sanitize(h.innerHTML)),h.style)m.style[B]=h.style[B];return m},n=function g(h){var m=Object.assign(g.convert(Promise.resolve()),JSON.parse(JSON.stringify(g.template))),B=g.convert(Promise.resolve(),m);return B=(B=B.setProgress(1,g,1,[g])).set(h)};(n.prototype=Object.create(Promise.prototype)).constructor=n,n.convert=function(g,h){return g.__proto__=h||n.prototype,g},n.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},n.prototype.from=function(g,h){return this.then(function(){switch(h=h||function(m){switch(o(m)){case"string":return"string";case"element":return m.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(g)){case"string":return this.then(e).then(function(m){return this.set({src:l("div",{innerHTML:g,dompurify:m})})});case"element":return this.set({src:g});case"canvas":return this.set({canvas:g});case"img":return this.set({img:g});default:return this.error("Unknown source type.")}})},n.prototype.to=function(g){switch(g){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},n.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var g={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},h=function m(B,_){for(var E=B.nodeType===3?document.createTextNode(B.nodeValue):B.cloneNode(!1),G=B.firstChild;G;G=G.nextSibling)_!==!0&&G.nodeType===1&&G.nodeName==="SCRIPT"||E.appendChild(m(G,_));return B.nodeType===1&&(B.nodeName==="CANVAS"?(E.width=B.width,E.height=B.height,E.getContext("2d").drawImage(B,0,0)):B.nodeName!=="TEXTAREA"&&B.nodeName!=="SELECT"||(E.value=B.value),E.addEventListener("load",function(){E.scrollTop=B.scrollTop,E.scrollLeft=B.scrollLeft},!0)),E}(this.prop.src,this.opt.html2canvas.javascriptEnabled);h.tagName==="BODY"&&(g.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=l("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=l("div",{className:"html2pdf__container",style:g}),this.prop.container.appendChild(h),this.prop.container.firstChild.appendChild(l("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},n.prototype.toCanvas=function(){var g=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(g).then(t).then(function(h){var m=Object.assign({},this.opt.html2canvas);return delete m.onrendered,h(this.prop.container,m)}).then(function(h){(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},n.prototype.toContext2d=function(){var g=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(g).then(t).then(function(h){var m=this.opt.jsPDF,B=this.opt.fontFaces,_=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,E=Object.assign({async:!0,allowTaint:!0,scale:_,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete E.onrendered,m.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,m.context2d.posX=this.opt.x,m.context2d.posY=this.opt.y,m.context2d.margin=this.opt.margin,m.context2d.fontFaces=B,B)for(var G=0;G<B.length;++G){var S=B[G],O=S.src.find(function(P){return P.format==="truetype"});O&&m.addFont(O.url,S.ref.name,S.ref.style)}return E.windowHeight=E.windowHeight||0,E.windowHeight=E.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):E.windowHeight,m.context2d.save(!0),h(this.prop.container,E)}).then(function(h){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(h),this.prop.canvas=h,document.body.removeChild(this.prop.overlay)})},n.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var g=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=g})},n.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},n.prototype.output=function(g,h,m){return(m=m||"pdf").toLowerCase()==="img"||m.toLowerCase()==="image"?this.outputImg(g,h):this.outputPdf(g,h)},n.prototype.outputPdf=function(g,h){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(g,h)})},n.prototype.outputImg=function(g){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(g){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+g+'" is not supported.'}})},n.prototype.save=function(g){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(g?{filename:g}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},n.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},n.prototype.set=function(g){if(o(g)!=="object")return this;var h=Object.keys(g||{}).map(function(m){if(m in n.template.prop)return function(){this.prop[m]=g[m]};switch(m){case"margin":return this.setMargin.bind(this,g.margin);case"jsPDF":return function(){return this.opt.jsPDF=g.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,g.pageSize);default:return function(){this.opt[m]=g[m]}}},this);return this.then(function(){return this.thenList(h)})},n.prototype.get=function(g,h){return this.then(function(){var m=g in n.template.prop?this.prop[g]:this.opt[g];return h?h(m):m})},n.prototype.setMargin=function(g){return this.then(function(){switch(o(g)){case"number":g=[g,g,g,g];case"array":if(g.length===2&&(g=[g[0],g[1],g[0],g[1]]),g.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=g}).then(this.setPageSize)},n.prototype.setPageSize=function(g){function h(m,B){return Math.floor(m*B/72*96)}return this.then(function(){(g=g||nr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(g.inner={width:g.width-this.opt.margin[1]-this.opt.margin[3],height:g.height-this.opt.margin[0]-this.opt.margin[2]},g.inner.px={width:h(g.inner.width,g.k),height:h(g.inner.height,g.k)},g.inner.ratio=g.inner.height/g.inner.width),this.prop.pageSize=g})},n.prototype.setProgress=function(g,h,m,B){return g!=null&&(this.progress.val=g),h!=null&&(this.progress.state=h),m!=null&&(this.progress.n=m),B!=null&&(this.progress.stack=B),this.progress.ratio=this.progress.val/this.progress.state,this},n.prototype.updateProgress=function(g,h,m,B){return this.setProgress(g?this.progress.val+g:null,h||null,m?this.progress.n+m:null,B?this.progress.stack.concat(B):null)},n.prototype.then=function(g,h){var m=this;return this.thenCore(g,h,function(B,_){return m.updateProgress(null,null,1,[B]),Promise.prototype.then.call(this,function(E){return m.updateProgress(null,B),E}).then(B,_).then(function(E){return m.updateProgress(1),E})})},n.prototype.thenCore=function(g,h,m){m=m||Promise.prototype.then,g&&(g=g.bind(this)),h&&(h=h.bind(this));var B=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:n.convert(Object.assign({},this),Promise.prototype),_=m.call(B,g,h);return n.convert(_,this.__proto__)},n.prototype.thenExternal=function(g,h){return Promise.prototype.then.call(this,g,h)},n.prototype.thenList=function(g){var h=this;return g.forEach(function(m){h=h.thenCore(m)}),h},n.prototype.catch=function(g){g&&(g=g.bind(this));var h=Promise.prototype.catch.call(this,g);return n.convert(h,this)},n.prototype.catchExternal=function(g){return Promise.prototype.catch.call(this,g)},n.prototype.error=function(g){return this.then(function(){throw new Error(g)})},n.prototype.using=n.prototype.set,n.prototype.saveAs=n.prototype.save,n.prototype.export=n.prototype.output,n.prototype.run=n.prototype.then,nr.getPageSize=function(g,h,m){if(Nr(g)==="object"){var B=g;g=B.orientation,h=B.unit||h,m=B.format||m}h=h||"mm",m=m||"a4",g=(""+(g||"P")).toLowerCase();var _,E=(""+m).toLowerCase(),G={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(h){case"pt":_=1;break;case"mm":_=72/25.4;break;case"cm":_=72/2.54;break;case"in":_=72;break;case"px":_=.75;break;case"pc":case"em":_=12;break;case"ex":_=6;break;default:throw"Invalid unit: "+h}var S,O=0,P=0;if(G.hasOwnProperty(E))O=G[E][1]/_,P=G[E][0]/_;else try{O=m[1],P=m[0]}catch{throw new Error("Invalid format: "+m)}if(g==="p"||g==="portrait")g="p",P>O&&(S=P,P=O,O=S);else{if(g!=="l"&&g!=="landscape")throw"Invalid orientation: "+g;g="l",O>P&&(S=P,P=O,O=S)}return{width:P,height:O,unit:h,k:_,orientation:g}},i.html=function(g,h){(h=h||{}).callback=h.callback||function(){},h.html2canvas=h.html2canvas||{},h.html2canvas.canvas=h.html2canvas.canvas||this.canvas,h.jsPDF=h.jsPDF||this,h.fontFaces=h.fontFaces?h.fontFaces.map(Oy):null;var m=new n(h);return h.worker?m:m.from(g).doCallback()}}(nr.API),nr.API.addJS=function(i){return F5=i,this.internal.events.subscribe("postPutResources",function(){tm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(tm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),S5=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+F5+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){tm!==void 0&&S5!==void 0&&this.internal.out("/Names <</JavaScript "+tm+" 0 R>>")}),this},function(i){var t;i.events.push(["postPutResources",function(){var e=this,o=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var l=e.outline.render().split(/\r\n/),n=0;n<l.length;n++){var g=l[n],h=o.exec(g);if(h!=null){var m=h[1];e.internal.newObjectDeferredBegin(m,!1)}e.internal.write(g)}if(this.outline.createNamedDestinations){var B=this.internal.pages.length,_=[];for(n=0;n<B;n++){var E=e.internal.newObject();_.push(E);var G=e.internal.getPageInfo(n+1);e.internal.write("<< /D["+G.objId+" 0 R /XYZ null null null]>> endobj")}var S=e.internal.newObject();for(e.internal.write("<< /Names [ "),n=0;n<_.length;n++)e.internal.write("(page_"+(n+1)+")"+_[n]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+S+" 0 R"),e.internal.write(">>","endobj")}}]),i.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),i.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(o,l,n){var g={title:l,options:n,children:[]};return o==null&&(o=this.root),o.children.push(g),g},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(o){o.id=e.internal.newObjectDeferred();for(var l=0;l<o.children.length;l++)this.genIds_r(o.children[l])},e.outline.renderRoot=function(o){this.objStart(o),this.line("/Type /Outlines"),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1]))),this.line("/Count "+this.count_r({count:0},o)),this.objEnd()},e.outline.renderItems=function(o){for(var l=this.ctx.pdf.internal.getVerticalCoordinateString,n=0;n<o.children.length;n++){var g=o.children[n];this.objStart(g),this.line("/Title "+this.makeString(g.title)),this.line("/Parent "+this.makeRef(o)),n>0&&this.line("/Prev "+this.makeRef(o.children[n-1])),n<o.children.length-1&&this.line("/Next "+this.makeRef(o.children[n+1])),g.children.length>0&&(this.line("/First "+this.makeRef(g.children[0])),this.line("/Last "+this.makeRef(g.children[g.children.length-1])));var h=this.count=this.count_r({count:0},g);if(h>0&&this.line("/Count "+h),g.options&&g.options.pageNumber){var m=e.internal.getPageInfo(g.options.pageNumber);this.line("/Dest ["+m.objId+" 0 R /XYZ 0 "+l(0)+" 0]")}this.objEnd()}for(var B=0;B<o.children.length;B++)this.renderItems(o.children[B])},e.outline.line=function(o){this.ctx.val+=o+`\r
`},e.outline.makeRef=function(o){return o.id+" 0 R"},e.outline.makeString=function(o){return"("+e.internal.pdfEscape(o)+")"},e.outline.objStart=function(o){this.ctx.val+=`\r
`+o.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(o,l){for(var n=0;n<l.children.length;n++)o.count++,this.count_r(o,l.children[n]);return o.count}}])}(nr.API),function(i){var t=[192,193,194,195,196,197,198,199];i.processJPEG=function(e,o,l,n,g,h){var m,B=this.decode.DCT_DECODE,_=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=g||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,(m=function(E){for(var G,S=256*E.charCodeAt(4)+E.charCodeAt(5),O=E.length,P={width:0,height:0,numcomponents:1},tt=4;tt<O;tt+=2){if(tt+=S,t.indexOf(E.charCodeAt(tt+1))!==-1){G=256*E.charCodeAt(tt+5)+E.charCodeAt(tt+6),P={width:256*E.charCodeAt(tt+7)+E.charCodeAt(tt+8),height:G,numcomponents:E.charCodeAt(tt+9)};break}S=256*E.charCodeAt(tt+2)+E.charCodeAt(tt+3)}return P}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e)).numcomponents){case 1:h=this.color_spaces.DEVICE_GRAY;break;case 4:h=this.color_spaces.DEVICE_CMYK;break;case 3:h=this.color_spaces.DEVICE_RGB}_={data:e,width:m.width,height:m.height,colorSpace:h,bitsPerComponent:8,filter:B,index:o,alias:l}}return _}}(nr.API);tK=function(){var i,t,e;function o(n){var g,h,m,B,_,E,G,S,O,P,tt,z,rt,ct;for(this.data=n,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},E=null;;){switch(g=this.readUInt32(),O=function(){var Et,Pt;for(Pt=[],Et=0;Et<4;++Et)Pt.push(String.fromCharCode(this.data[this.pos++]));return Pt}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(g);break;case"fcTL":E&&this.animation.frames.push(E),this.pos+=4,E={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},_=this.readUInt16(),B=this.readUInt16()||100,E.delay=1e3*_/B,E.disposeOp=this.data[this.pos++],E.blendOp=this.data[this.pos++],E.data=[];break;case"IDAT":case"fdAT":for(O==="fdAT"&&(this.pos+=4,g-=4),n=E?.data||this.imgData,z=0;0<=g?z<g:z>g;0<=g?++z:--z)n.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(m=this.palette.length/3,this.transparency.indexed=this.read(g),this.transparency.indexed.length>m)throw new Error("More transparent colors than palette size");if((P=m-this.transparency.indexed.length)>0)for(rt=0;0<=P?rt<P:rt>P;0<=P?++rt:--rt)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(g)[0];break;case 2:this.transparency.rgb=this.read(g)}break;case"tEXt":G=(tt=this.read(g)).indexOf(0),S=String.fromCharCode.apply(String,tt.slice(0,G)),this.text[S]=String.fromCharCode.apply(String,tt.slice(G+1));break;case"IEND":return E&&this.animation.frames.push(E),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(ct=this.colorType)===4||ct===6,h=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*h,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=g}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}o.prototype.read=function(n){var g,h;for(h=[],g=0;0<=n?g<n:g>n;0<=n?++g:--g)h.push(this.data[this.pos++]);return h},o.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.decodePixels=function(n){var g=this.pixelBitlength/8,h=new Uint8Array(this.width*this.height*g),m=0,B=this;if(n==null&&(n=this.imgData),n.length===0)return new Uint8Array(0);function _(E,G,S,O){var P,tt,z,rt,ct,Et,Pt,Qt,Ut,dt,ee,oe,ht,At,Ft,St,ue,ce,ae,se,Lt,Ht=Math.ceil((B.width-E)/S),fe=Math.ceil((B.height-G)/O),j=B.width==Ht&&B.height==fe;for(At=g*Ht,oe=j?h:new Uint8Array(At*fe),Et=n.length,ht=0,tt=0;ht<fe&&m<Et;){switch(n[m++]){case 0:for(rt=ue=0;ue<At;rt=ue+=1)oe[tt++]=n[m++];break;case 1:for(rt=ce=0;ce<At;rt=ce+=1)P=n[m++],ct=rt<g?0:oe[tt-g],oe[tt++]=(P+ct)%256;break;case 2:for(rt=ae=0;ae<At;rt=ae+=1)P=n[m++],z=(rt-rt%g)/g,Ft=ht&&oe[(ht-1)*At+z*g+rt%g],oe[tt++]=(Ft+P)%256;break;case 3:for(rt=se=0;se<At;rt=se+=1)P=n[m++],z=(rt-rt%g)/g,ct=rt<g?0:oe[tt-g],Ft=ht&&oe[(ht-1)*At+z*g+rt%g],oe[tt++]=(P+Math.floor((ct+Ft)/2))%256;break;case 4:for(rt=Lt=0;Lt<At;rt=Lt+=1)P=n[m++],z=(rt-rt%g)/g,ct=rt<g?0:oe[tt-g],ht===0?Ft=St=0:(Ft=oe[(ht-1)*At+z*g+rt%g],St=z&&oe[(ht-1)*At+(z-1)*g+rt%g]),Pt=ct+Ft-St,Qt=Math.abs(Pt-ct),dt=Math.abs(Pt-Ft),ee=Math.abs(Pt-St),Ut=Qt<=dt&&Qt<=ee?ct:dt<=ee?Ft:St,oe[tt++]=(P+Ut)%256;break;default:throw new Error("Invalid filter algorithm: "+n[m-1])}if(!j){var It=((G+ht*O)*B.width+E)*g,bt=ht*At;for(rt=0;rt<Ht;rt+=1){for(var Vt=0;Vt<g;Vt+=1)h[It++]=oe[bt++];It+=(S-1)*g}}ht++}}return n=UD(n),B.interlaceMethod==1?(_(0,0,8,8),_(4,0,8,8),_(0,4,4,8),_(2,0,4,4),_(0,2,2,4),_(1,0,2,2),_(0,1,1,2)):_(0,0,1,1),h},o.prototype.decodePalette=function(){var n,g,h,m,B,_,E,G,S;for(h=this.palette,_=this.transparency.indexed||[],B=new Uint8Array((_.length||0)+h.length),m=0,n=0,g=E=0,G=h.length;E<G;g=E+=3)B[m++]=h[g],B[m++]=h[g+1],B[m++]=h[g+2],B[m++]=(S=_[n++])!=null?S:255;return B},o.prototype.copyToImageData=function(n,g){var h,m,B,_,E,G,S,O,P,tt,z;if(m=this.colors,P=null,h=this.hasAlphaChannel,this.palette.length&&(P=(z=this._decodedPalette)!=null?z:this._decodedPalette=this.decodePalette(),m=4,h=!0),O=(B=n.data||n).length,E=P||g,_=G=0,m===1)for(;_<O;)S=P?4*g[_/4]:G,tt=E[S++],B[_++]=tt,B[_++]=tt,B[_++]=tt,B[_++]=h?E[S++]:255,G=S;else for(;_<O;)S=P?4*g[_/4]:G,B[_++]=E[S++],B[_++]=E[S++],B[_++]=E[S++],B[_++]=h?E[S++]:255,G=S},o.prototype.decode=function(){var n;return n=new Uint8Array(this.width*this.height*4),this.copyToImageData(n,this.decodePixels()),n};var l=function(){if(Object.prototype.toString.call(sr)==="[object Window]"){try{t=sr.document.createElement("canvas"),e=t.getContext("2d")}catch{return!1}return!0}return!1};return l(),i=function(n){var g;if(l()===!0)return e.width=n.width,e.height=n.height,e.clearRect(0,0,n.width,n.height),e.putImageData(n,0,0),(g=new Image).src=t.toDataURL(),g;throw new Error("This method requires a Browser with Canvas-capability.")},o.prototype.decodeFrames=function(n){var g,h,m,B,_,E,G,S;if(this.animation){for(S=[],h=_=0,E=(G=this.animation.frames).length;_<E;h=++_)g=G[h],m=n.createImageData(g.width,g.height),B=this.decodePixels(new Uint8Array(g.data)),this.copyToImageData(m,B),g.imageData=m,S.push(g.image=i(m));return S}},o.prototype.renderFrame=function(n,g){var h,m,B;return h=(m=this.animation.frames)[g],B=m[g-1],g===0&&n.clearRect(0,0,this.width,this.height),B?.disposeOp===1?n.clearRect(B.xOffset,B.yOffset,B.width,B.height):B?.disposeOp===2&&n.putImageData(B.imageData,B.xOffset,B.yOffset),h.blendOp===0&&n.clearRect(h.xOffset,h.yOffset,h.width,h.height),n.drawImage(h.image,h.xOffset,h.yOffset)},o.prototype.animate=function(n){var g,h,m,B,_,E,G=this;return h=0,E=this.animation,B=E.numFrames,m=E.frames,_=E.numPlays,(g=function(){var S,O;if(S=h++%B,O=m[S],G.renderFrame(n,S),B>1&&h/B<_)return G.animation._timeout=setTimeout(g,O.delay)})()},o.prototype.stopAnimation=function(){var n;return clearTimeout((n=this.animation)!=null?n._timeout:void 0)},o.prototype.render=function(n){var g,h;return n._png&&n._png.stopAnimation(),n._png=this,n.width=this.width,n.height=this.height,g=n.getContext("2d"),this.animation?(this.decodeFrames(g),this.animate(g)):(h=g.createImageData(this.width,this.height),this.copyToImageData(h,this.decodePixels()),g.putImageData(h,0,0))},o}();(function(i){var t=function(){return typeof Ny=="function"},e=function(G,S,O,P){var tt=4,z=g;switch(P){case i.image_compression.FAST:tt=1,z=n;break;case i.image_compression.MEDIUM:tt=6,z=h;break;case i.image_compression.SLOW:tt=9,z=m}G=o(G,S,O,z);var rt=Ny(G,{level:tt});return i.__addimage__.arrayBufferToBinaryString(rt)},o=function(G,S,O,P){for(var tt,z,rt,ct=G.length/S,Et=new Uint8Array(G.length+ct),Pt=_(),Qt=0;Qt<ct;Qt+=1){if(rt=Qt*S,tt=G.subarray(rt,rt+S),P)Et.set(P(tt,O,z),rt+Qt);else{for(var Ut,dt=Pt.length,ee=[];Ut<dt;Ut+=1)ee[Ut]=Pt[Ut](tt,O,z);var oe=E(ee.concat());Et.set(ee[oe],rt+Qt)}z=tt}return Et},l=function(G){var S=Array.apply([],G);return S.unshift(0),S},n=function(G,S){var O,P=[],tt=G.length;P[0]=1;for(var z=0;z<tt;z+=1)O=G[z-S]||0,P[z+1]=G[z]-O+256&255;return P},g=function(G,S,O){var P,tt=[],z=G.length;tt[0]=2;for(var rt=0;rt<z;rt+=1)P=O&&O[rt]||0,tt[rt+1]=G[rt]-P+256&255;return tt},h=function(G,S,O){var P,tt,z=[],rt=G.length;z[0]=3;for(var ct=0;ct<rt;ct+=1)P=G[ct-S]||0,tt=O&&O[ct]||0,z[ct+1]=G[ct]+256-(P+tt>>>1)&255;return z},m=function(G,S,O){var P,tt,z,rt,ct=[],Et=G.length;ct[0]=4;for(var Pt=0;Pt<Et;Pt+=1)P=G[Pt-S]||0,tt=O&&O[Pt]||0,z=O&&O[Pt-S]||0,rt=B(P,tt,z),ct[Pt+1]=G[Pt]-rt+256&255;return ct},B=function(G,S,O){if(G===S&&S===O)return G;var P=Math.abs(S-O),tt=Math.abs(G-O),z=Math.abs(G+S-O-O);return P<=tt&&P<=z?G:tt<=z?S:O},_=function(){return[l,n,g,h,m]},E=function(G){var S=G.map(function(O){return O.reduce(function(P,tt){return P+Math.abs(tt)},0)});return S.indexOf(Math.min.apply(null,S))};i.processPNG=function(G,S,O,P){var tt,z,rt,ct,Et,Pt,Qt,Ut,dt,ee,oe,ht,At,Ft,St,ue=this.decode.FLATE_DECODE,ce="";if(this.__addimage__.isArrayBuffer(G)&&(G=new Uint8Array(G)),this.__addimage__.isArrayBufferView(G)){if(G=(rt=new tK(G)).imgData,z=rt.bits,tt=rt.colorSpace,Et=rt.colors,[4,6].indexOf(rt.colorType)!==-1){if(rt.bits===8){dt=(Ut=rt.pixelBitlength==32?new Uint32Array(rt.decodePixels().buffer):rt.pixelBitlength==16?new Uint16Array(rt.decodePixels().buffer):new Uint8Array(rt.decodePixels().buffer)).length,oe=new Uint8Array(dt*rt.colors),ee=new Uint8Array(dt);var ae,se=rt.pixelBitlength-rt.bits;for(Ft=0,St=0;Ft<dt;Ft++){for(At=Ut[Ft],ae=0;ae<se;)oe[St++]=At>>>ae&255,ae+=rt.bits;ee[Ft]=At>>>ae&255}}if(rt.bits===16){dt=(Ut=new Uint32Array(rt.decodePixels().buffer)).length,oe=new Uint8Array(dt*(32/rt.pixelBitlength)*rt.colors),ee=new Uint8Array(dt*(32/rt.pixelBitlength)),ht=rt.colors>1,Ft=0,St=0;for(var Lt=0;Ft<dt;)At=Ut[Ft++],oe[St++]=At>>>0&255,ht&&(oe[St++]=At>>>16&255,At=Ut[Ft++],oe[St++]=At>>>0&255),ee[Lt++]=At>>>16&255;z=8}P!==i.image_compression.NONE&&t()?(G=e(oe,rt.width*rt.colors,rt.colors,P),Qt=e(ee,rt.width,1,P)):(G=oe,Qt=ee,ue=void 0)}if(rt.colorType===3&&(tt=this.color_spaces.INDEXED,Pt=rt.palette,rt.transparency.indexed)){var Ht=rt.transparency.indexed,fe=0;for(Ft=0,dt=Ht.length;Ft<dt;++Ft)fe+=Ht[Ft];if((fe/=255)===dt-1&&Ht.indexOf(0)!==-1)ct=[Ht.indexOf(0)];else if(fe!==dt){for(Ut=rt.decodePixels(),ee=new Uint8Array(Ut.length),Ft=0,dt=Ut.length;Ft<dt;Ft++)ee[Ft]=Ht[Ut[Ft]];Qt=e(ee,rt.width,1)}}var j=function(It){var bt;switch(It){case i.image_compression.FAST:bt=11;break;case i.image_compression.MEDIUM:bt=13;break;case i.image_compression.SLOW:bt=14;break;default:bt=12}return bt}(P);return ue===this.decode.FLATE_DECODE&&(ce="/Predictor "+j+" "),ce+="/Colors "+Et+" /BitsPerComponent "+z+" /Columns "+rt.width,(this.__addimage__.isArrayBuffer(G)||this.__addimage__.isArrayBufferView(G))&&(G=this.__addimage__.arrayBufferToBinaryString(G)),(Qt&&this.__addimage__.isArrayBuffer(Qt)||this.__addimage__.isArrayBufferView(Qt))&&(Qt=this.__addimage__.arrayBufferToBinaryString(Qt)),{alias:O,data:G,index:S,filter:ue,decodeParameters:ce,transparency:ct,palette:Pt,sMask:Qt,predictor:j,width:rt.width,height:rt.height,bitsPerComponent:z,colorSpace:tt}}}})(nr.API),function(i){i.processGIF89A=function(t,e,o,l){var n=new eK(t),g=n.width,h=n.height,m=[];n.decodeAndBlitFrameRGBA(0,m);var B={data:m,width:g,height:h},_=new Qy(100).encode(B,100);return i.processJPEG.call(this,_,e,o,l)},i.processGIF87A=i.processGIF89A}(nr.API),mA.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var i=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(i);for(var t=0;t<i;t++){var e=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:l,green:o,blue:e,quad:n}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},mA.prototype.parseBGR=function(){this.pos=this.offset;try{var i="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[i]()}catch(e){hn.log("bit decode error:"+e)}},mA.prototype.bit1=function(){var i,t=Math.ceil(this.width/8),e=t%4;for(i=this.height-1;i>=0;i--){for(var o=this.bottom_up?i:this.height-1-i,l=0;l<t;l++)for(var n=this.datav.getUint8(this.pos++,!0),g=o*this.width*4+8*l*4,h=0;h<8&&8*l+h<this.width;h++){var m=this.palette[n>>7-h&1];this.data[g+4*h]=m.blue,this.data[g+4*h+1]=m.green,this.data[g+4*h+2]=m.red,this.data[g+4*h+3]=255}e!==0&&(this.pos+=4-e)}},mA.prototype.bit4=function(){for(var i=Math.ceil(this.width/2),t=i%4,e=this.height-1;e>=0;e--){for(var o=this.bottom_up?e:this.height-1-e,l=0;l<i;l++){var n=this.datav.getUint8(this.pos++,!0),g=o*this.width*4+2*l*4,h=n>>4,m=15&n,B=this.palette[h];if(this.data[g]=B.blue,this.data[g+1]=B.green,this.data[g+2]=B.red,this.data[g+3]=255,2*l+1>=this.width)break;B=this.palette[m],this.data[g+4]=B.blue,this.data[g+4+1]=B.green,this.data[g+4+2]=B.red,this.data[g+4+3]=255}t!==0&&(this.pos+=4-t)}},mA.prototype.bit8=function(){for(var i=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,o=0;o<this.width;o++){var l=this.datav.getUint8(this.pos++,!0),n=e*this.width*4+4*o;if(l<this.palette.length){var g=this.palette[l];this.data[n]=g.red,this.data[n+1]=g.green,this.data[n+2]=g.blue,this.data[n+3]=255}else this.data[n]=255,this.data[n+1]=255,this.data[n+2]=255,this.data[n+3]=255}i!==0&&(this.pos+=4-i)}},mA.prototype.bit15=function(){for(var i=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var o=this.bottom_up?e:this.height-1-e,l=0;l<this.width;l++){var n=this.datav.getUint16(this.pos,!0);this.pos+=2;var g=(n&t)/t*255|0,h=(n>>5&t)/t*255|0,m=(n>>10&t)/t*255|0,B=n>>15?255:0,_=o*this.width*4+4*l;this.data[_]=m,this.data[_+1]=h,this.data[_+2]=g,this.data[_+3]=B}this.pos+=i}},mA.prototype.bit16=function(){for(var i=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),o=this.height-1;o>=0;o--){for(var l=this.bottom_up?o:this.height-1-o,n=0;n<this.width;n++){var g=this.datav.getUint16(this.pos,!0);this.pos+=2;var h=(g&t)/t*255|0,m=(g>>5&e)/e*255|0,B=(g>>11)/t*255|0,_=l*this.width*4+4*n;this.data[_]=B,this.data[_+1]=m,this.data[_+2]=h,this.data[_+3]=255}this.pos+=i}},mA.prototype.bit24=function(){for(var i=this.height-1;i>=0;i--){for(var t=this.bottom_up?i:this.height-1-i,e=0;e<this.width;e++){var o=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),g=t*this.width*4+4*e;this.data[g]=n,this.data[g+1]=l,this.data[g+2]=o,this.data[g+3]=255}this.pos+=this.width%4}},mA.prototype.bit32=function(){for(var i=this.height-1;i>=0;i--)for(var t=this.bottom_up?i:this.height-1-i,e=0;e<this.width;e++){var o=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),g=this.datav.getUint8(this.pos++,!0),h=t*this.width*4+4*e;this.data[h]=n,this.data[h+1]=l,this.data[h+2]=o,this.data[h+3]=g}},mA.prototype.getData=function(){return this.data},function(i){i.processBMP=function(t,e,o,l){var n=new mA(t,!1),g=n.width,h=n.height,m={data:n.getData(),width:g,height:h},B=new Qy(100).encode(m,100);return i.processJPEG.call(this,B,e,o,l)}}(nr.API),U5.prototype.getData=function(){return this.data},function(i){i.processWEBP=function(t,e,o,l){var n=new U5(t),g=n.width,h=n.height,m={data:n.getData(),width:g,height:h},B=new Qy(100).encode(m,100);return i.processJPEG.call(this,B,e,o,l)}}(nr.API),nr.API.processRGBA=function(i,t,e){for(var o=i.data,l=o.length,n=new Uint8Array(l/4*3),g=new Uint8Array(l/4),h=0,m=0,B=0;B<l;B+=4){var _=o[B],E=o[B+1],G=o[B+2],S=o[B+3];n[h++]=_,n[h++]=E,n[h++]=G,g[m++]=S}var O=this.__addimage__.arrayBufferToBinaryString(n);return{alpha:this.__addimage__.arrayBufferToBinaryString(g),data:O,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:i.width,height:i.height}},nr.API.setLanguage=function(i){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[i]!==void 0&&(this.internal.languageSettings.languageCode=i,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},lh=nr.API,em=lh.getCharWidthsArray=function(i,t){var e,o,l=(t=t||{}).font||this.internal.getFont(),n=t.fontSize||this.internal.getFontSize(),g=t.charSpace||this.internal.getCharSpace(),h=t.widths?t.widths:l.metadata.Unicode.widths,m=h.fof?h.fof:1,B=t.kerning?t.kerning:l.metadata.Unicode.kerning,_=B.fof?B.fof:1,E=t.doKerning!==!1,G=0,S=i.length,O=0,P=h[0]||m,tt=[];for(e=0;e<S;e++)o=i.charCodeAt(e),typeof l.metadata.widthOfString=="function"?tt.push((l.metadata.widthOfGlyph(l.metadata.characterToGlyph(o))+g*(1e3/n)||0)/1e3):(G=E&&Nr(B[o])==="object"&&!isNaN(parseInt(B[o][O],10))?B[o][O]/_:0,tt.push((h[o]||P)/m+G)),O=o;return tt},L5=lh.getStringUnitWidth=function(i,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),o=t.font||this.internal.getFont(),l=t.charSpace||this.internal.getCharSpace();return lh.processArabic&&(i=lh.processArabic(i)),typeof o.metadata.widthOfString=="function"?o.metadata.widthOfString(i,e,l)/e:em.apply(this,arguments).reduce(function(n,g){return n+g},0)},E5=function(i,t,e,o){for(var l=[],n=0,g=i.length,h=0;n!==g&&h+t[n]<e;)h+=t[n],n++;l.push(i.slice(0,n));var m=n;for(h=0;n!==g;)h+t[n]>o&&(l.push(i.slice(m,n)),h=0,m=n),h+=t[n],n++;return m!==n&&l.push(i.slice(m,n)),l},T5=function(i,t,e){e||(e={});var o,l,n,g,h,m,B,_=[],E=[_],G=e.textIndent||0,S=0,O=0,P=i.split(" "),tt=em.apply(this,[" ",e])[0];if(m=e.lineIndent===-1?P[0].length+2:e.lineIndent||0){var z=Array(m).join(" "),rt=[];P.map(function(Et){(Et=Et.split(/\s*\n/)).length>1?rt=rt.concat(Et.map(function(Pt,Qt){return(Qt&&Pt.length?`
`:"")+Pt})):rt.push(Et[0])}),P=rt,m=L5.apply(this,[z,e])}for(n=0,g=P.length;n<g;n++){var ct=0;if(o=P[n],m&&o[0]==`
`&&(o=o.substr(1),ct=1),G+S+(O=(l=em.apply(this,[o,e])).reduce(function(Et,Pt){return Et+Pt},0))>t||ct){if(O>t){for(h=E5.apply(this,[o,l,t-(G+S),t]),_.push(h.shift()),_=[h.pop()];h.length;)E.push([h.shift()]);O=l.slice(o.length-(_[0]?_[0].length:0)).reduce(function(Et,Pt){return Et+Pt},0)}else _=[o];E.push(_),G=O+m,S=tt}else _.push(o),G+=S+O,S=tt}return B=m?function(Et,Pt){return(Pt?z:"")+Et.join(" ")}:function(Et){return Et.join(" ")},E.map(B)},lh.splitTextToSize=function(i,t,e){var o,l=(e=e||{}).fontSize||this.internal.getFontSize(),n=function(_){if(_.widths&&_.kerning)return{widths:_.widths,kerning:_.kerning};var E=this.internal.getFont(_.fontName,_.fontStyle);return E.metadata.Unicode?{widths:E.metadata.Unicode.widths||{0:1},kerning:E.metadata.Unicode.kerning||{}}:{font:E.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,e);o=Array.isArray(i)?i:String(i).split(/\r?\n/);var g=1*this.internal.scaleFactor*t/l;n.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/l:0,n.lineIndent=e.lineIndent;var h,m,B=[];for(h=0,m=o.length;h<m;h++)B=B.concat(T5.apply(this,[o[h],g,n]));return B},function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",e={},o={},l=0;l<t.length;l++)e[t[l]]="0123456789abcdef"[l],o["0123456789abcdef"[l]]=t[l];var n=function(E){return"0x"+parseInt(E,10).toString(16)},g=i.__fontmetrics__.compress=function(E){var G,S,O,P,tt=["{"];for(var z in E){if(G=E[z],isNaN(parseInt(z,10))?S="'"+z+"'":(z=parseInt(z,10),S=(S=n(z).slice(2)).slice(0,-1)+o[S.slice(-1)]),typeof G=="number")G<0?(O=n(G).slice(3),P="-"):(O=n(G).slice(2),P=""),O=P+O.slice(0,-1)+o[O.slice(-1)];else{if(Nr(G)!=="object")throw new Error("Don't know what to do with value type "+Nr(G)+".");O=g(G)}tt.push(S+O)}return tt.push("}"),tt.join("")},h=i.__fontmetrics__.uncompress=function(E){if(typeof E!="string")throw new Error("Invalid argument passed to uncompress.");for(var G,S,O,P,tt={},z=1,rt=tt,ct=[],Et="",Pt="",Qt=E.length-1,Ut=1;Ut<Qt;Ut+=1)(P=E[Ut])=="'"?G?(O=G.join(""),G=void 0):G=[]:G?G.push(P):P=="{"?(ct.push([rt,O]),rt={},O=void 0):P=="}"?((S=ct.pop())[0][S[1]]=rt,O=void 0,rt=S[0]):P=="-"?z=-1:O===void 0?e.hasOwnProperty(P)?(Et+=e[P],O=parseInt(Et,16)*z,z=1,Et=""):Et+=P:e.hasOwnProperty(P)?(Pt+=e[P],rt[O]=parseInt(Pt,16)*z,z=1,O=void 0,Pt=""):Pt+=P;return tt},m={codePages:["WinAnsiEncoding"],WinAnsiEncoding:h("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},B={Unicode:{Courier:m,"Courier-Bold":m,"Courier-BoldOblique":m,"Courier-Oblique":m,Helvetica:m,"Helvetica-Bold":m,"Helvetica-BoldOblique":m,"Helvetica-Oblique":m,"Times-Roman":m,"Times-Bold":m,"Times-BoldItalic":m,"Times-Italic":m}},_={Unicode:{"Courier-Oblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":h("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":h("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:h("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":h("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:h("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":h("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":h("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":h("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":h("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(E){var G=E.font,S=_.Unicode[G.postScriptName];S&&(G.metadata.Unicode={},G.metadata.Unicode.widths=S.widths,G.metadata.Unicode.kerning=S.kerning);var O=B.Unicode[G.postScriptName];O&&(G.metadata.Unicode.encoding=O,G.encoding=O.codePages[0])}])}(nr.API),function(i){var t=function(e){for(var o=e.length,l=new Uint8Array(o),n=0;n<o;n++)l[n]=e.charCodeAt(n);return l};i.API.events.push(["addFont",function(e){var o=void 0,l=e.font,n=e.instance;if(!l.isStandardFont){if(n===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");if(typeof(o=n.existsFileInVFS(l.postScriptName)===!1?n.loadFile(l.postScriptName):n.getFileFromVFS(l.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");(function(g,h){h=/^\x00\x01\x00\x00/.test(h)?t(h):t(Yg(h)),g.metadata=i.API.TTFFont.open(h),g.metadata.Unicode=g.metadata.Unicode||{encoding:{},kerning:{},widths:[]},g.metadata.glyIdsUsed=[0]})(l,o)}}])}(nr),function(i){function t(){return(sr.canvg?Promise.resolve(sr.canvg):Promise.resolve().then(()=>(d5(),g5))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}nr.API.addSvgAsImage=function(e,o,l,n,g,h,m,B){if(isNaN(o)||isNaN(l))throw hn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(g))throw hn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var _=document.createElement("canvas");_.width=n,_.height=g;var E=_.getContext("2d");E.fillStyle="#fff",E.fillRect(0,0,_.width,_.height);var G={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},S=this;return t().then(function(O){return O.fromString(E,e,G)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(O){return O.render(G)}).then(function(){S.addImage(_.toDataURL("image/jpeg",1),o,l,n,g,m,B)})}}(),nr.API.putTotalPages=function(i){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(i,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var o=1;o<=this.internal.getNumberOfPages();o++)for(var l=0;l<this.internal.pages[o].length;l++)this.internal.pages[o][l]=this.internal.pages[o][l].replace(t,e);return this},nr.API.viewerPreferences=function(i,t){var e;i=i||{},t=t||!1;var o,l,n,g={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},h=Object.keys(g),m=[],B=0,_=0,E=0;function G(O,P){var tt,z=!1;for(tt=0;tt<O.length;tt+=1)O[tt]===P&&(z=!0);return z}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(g)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,i==="reset"||t===!0){var S=h.length;for(E=0;E<S;E+=1)e[h[E]].value=e[h[E]].defaultValue,e[h[E]].explicitSet=!1}if(Nr(i)==="object"){for(l in i)if(n=i[l],G(h,l)&&n!==void 0){if(e[l].type==="boolean"&&typeof n=="boolean")e[l].value=n;else if(e[l].type==="name"&&G(e[l].valueSet,n))e[l].value=n;else if(e[l].type==="integer"&&Number.isInteger(n))e[l].value=n;else if(e[l].type==="array"){for(B=0;B<n.length;B+=1)if(o=!0,n[B].length===1&&typeof n[B][0]=="number")m.push(String(n[B]-1));else if(n[B].length>1){for(_=0;_<n[B].length;_+=1)typeof n[B][_]!="number"&&(o=!1);o===!0&&m.push([n[B][0]-1,n[B][1]-1].join(" "))}e[l].value="["+m.join(" ")+"]"}else e[l].value=e[l].defaultValue;e[l].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var O,P=[];for(O in e)e[O].explicitSet===!0&&(e[O].type==="name"?P.push("/"+O+" /"+e[O].value):P.push("/"+O+" "+e[O].value));P.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+P.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},function(i){var t=function(){var o='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',l=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),n=unescape(encodeURIComponent(o)),g=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),h=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),m=unescape(encodeURIComponent("</x:xmpmeta>")),B=n.length+g.length+h.length+l.length+m.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+B+" >>"),this.internal.write("stream"),this.internal.write(l+n+g+h+m),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};i.addMetadata=function(o,l){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:o,namespaceuri:l||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}}(nr.API),function(i){var t=i.API,e=t.pdfEscape16=function(n,g){for(var h,m=g.metadata.Unicode.widths,B=["","0","00","000","0000"],_=[""],E=0,G=n.length;E<G;++E){if(h=g.metadata.characterToGlyph(n.charCodeAt(E)),g.metadata.glyIdsUsed.push(h),g.metadata.toUnicode[h]=n.charCodeAt(E),m.indexOf(h)==-1&&(m.push(h),m.push([parseInt(g.metadata.widthOfGlyph(h),10)])),h=="0")return _.join("");h=h.toString(16),_.push(B[4-h.length],h)}return _.join("")},o=function(n){var g,h,m,B,_,E,G;for(_=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,m=[],E=0,G=(h=Object.keys(n).sort(function(S,O){return S-O})).length;E<G;E++)g=h[E],m.length>=100&&(_+=`
`+m.length+` beginbfchar
`+m.join(`
`)+`
endbfchar`,m=[]),n[g]!==void 0&&n[g]!==null&&typeof n[g].toString=="function"&&(B=("0000"+n[g].toString(16)).slice(-4),g=("0000"+(+g).toString(16)).slice(-4),m.push("<"+g+"><"+B+">"));return m.length&&(_+=`
`+m.length+` beginbfchar
`+m.join(`
`)+`
endbfchar
`),_+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(n){(function(g){var h=g.font,m=g.out,B=g.newObject,_=g.putStream;if(h.metadata instanceof i.API.TTFFont&&h.encoding==="Identity-H"){for(var E=h.metadata.Unicode.widths,G=h.metadata.subset.encode(h.metadata.glyIdsUsed,1),S="",O=0;O<G.length;O++)S+=String.fromCharCode(G[O]);var P=B();_({data:S,addLength1:!0,objectId:P}),m("endobj");var tt=B();_({data:o(h.metadata.toUnicode),addLength1:!0,objectId:tt}),m("endobj");var z=B();m("<<"),m("/Type /FontDescriptor"),m("/FontName /"+uh(h.fontName)),m("/FontFile2 "+P+" 0 R"),m("/FontBBox "+i.API.PDFObject.convert(h.metadata.bbox)),m("/Flags "+h.metadata.flags),m("/StemV "+h.metadata.stemV),m("/ItalicAngle "+h.metadata.italicAngle),m("/Ascent "+h.metadata.ascender),m("/Descent "+h.metadata.decender),m("/CapHeight "+h.metadata.capHeight),m(">>"),m("endobj");var rt=B();m("<<"),m("/Type /Font"),m("/BaseFont /"+uh(h.fontName)),m("/FontDescriptor "+z+" 0 R"),m("/W "+i.API.PDFObject.convert(E)),m("/CIDToGIDMap /Identity"),m("/DW 1000"),m("/Subtype /CIDFontType2"),m("/CIDSystemInfo"),m("<<"),m("/Supplement 0"),m("/Registry (Adobe)"),m("/Ordering ("+h.encoding+")"),m(">>"),m(">>"),m("endobj"),h.objectNumber=B(),m("<<"),m("/Type /Font"),m("/Subtype /Type0"),m("/ToUnicode "+tt+" 0 R"),m("/BaseFont /"+uh(h.fontName)),m("/Encoding /"+h.encoding),m("/DescendantFonts ["+rt+" 0 R]"),m(">>"),m("endobj"),h.isAlreadyPutted=!0}})(n)}]),t.events.push(["putFont",function(n){(function(g){var h=g.font,m=g.out,B=g.newObject,_=g.putStream;if(h.metadata instanceof i.API.TTFFont&&h.encoding==="WinAnsiEncoding"){for(var E=h.metadata.rawData,G="",S=0;S<E.length;S++)G+=String.fromCharCode(E[S]);var O=B();_({data:G,addLength1:!0,objectId:O}),m("endobj");var P=B();_({data:o(h.metadata.toUnicode),addLength1:!0,objectId:P}),m("endobj");var tt=B();m("<<"),m("/Descent "+h.metadata.decender),m("/CapHeight "+h.metadata.capHeight),m("/StemV "+h.metadata.stemV),m("/Type /FontDescriptor"),m("/FontFile2 "+O+" 0 R"),m("/Flags 96"),m("/FontBBox "+i.API.PDFObject.convert(h.metadata.bbox)),m("/FontName /"+uh(h.fontName)),m("/ItalicAngle "+h.metadata.italicAngle),m("/Ascent "+h.metadata.ascender),m(">>"),m("endobj"),h.objectNumber=B();for(var z=0;z<h.metadata.hmtx.widths.length;z++)h.metadata.hmtx.widths[z]=parseInt(h.metadata.hmtx.widths[z]*(1e3/h.metadata.head.unitsPerEm));m("<</Subtype/TrueType/Type/Font/ToUnicode "+P+" 0 R/BaseFont/"+uh(h.fontName)+"/FontDescriptor "+tt+" 0 R/Encoding/"+h.encoding+" /FirstChar 29 /LastChar 255 /Widths "+i.API.PDFObject.convert(h.metadata.hmtx.widths)+">>"),m("endobj"),h.isAlreadyPutted=!0}})(n)}]);var l=function(n){var g,h=n.text||"",m=n.x,B=n.y,_=n.options||{},E=n.mutex||{},G=E.pdfEscape,S=E.activeFontKey,O=E.fonts,P=S,tt="",z=0,rt="",ct=O[P].encoding;if(O[P].encoding!=="Identity-H")return{text:h,x:m,y:B,options:_,mutex:E};for(rt=h,P=S,Array.isArray(h)&&(rt=h[0]),z=0;z<rt.length;z+=1)O[P].metadata.hasOwnProperty("cmap")&&(g=O[P].metadata.cmap.unicode.codeMap[rt[z].charCodeAt(0)]),g||rt[z].charCodeAt(0)<256&&O[P].metadata.hasOwnProperty("Unicode")?tt+=rt[z]:tt+="";var Et="";return parseInt(P.slice(1))<14||ct==="WinAnsiEncoding"?Et=G(tt,P).split("").map(function(Pt){return Pt.charCodeAt(0).toString(16)}).join(""):ct==="Identity-H"&&(Et=e(tt,O[P])),E.isHex=!0,{text:Et,x:m,y:B,options:_,mutex:E}};t.events.push(["postProcessText",function(n){var g=n.text||"",h=[],m={text:g,x:n.x,y:n.y,options:n.options,mutex:n.mutex};if(Array.isArray(g)){var B=0;for(B=0;B<g.length;B+=1)Array.isArray(g[B])&&g[B].length===3?h.push([l(Object.assign({},m,{text:g[B][0]})).text,g[B][1],g[B][2]]):h.push(l(Object.assign({},m,{text:g[B]})).text);n.text=h}else n.text=l(Object.assign({},m,{text:g})).text}])}(nr),function(i){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};i.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},i.addFileToVFS=function(e,o){return t.call(this),this.internal.vFS[e]=o,this},i.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}}(nr.API),function(i){i.__bidiEngine__=i.prototype.__bidiEngine__=function(o){var l,n,g,h,m,B,_,E=t,G=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],S=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],O={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},P={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},tt=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],z=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),rt=!1,ct=0;this.__bidiEngine__={};var Et=function(ht){var At=ht.charCodeAt(),Ft=At>>8,St=P[Ft];return St!==void 0?E[256*St+(255&At)]:Ft===252||Ft===253?"AL":z.test(Ft)?"L":Ft===8?"R":"N"},Pt=function(ht){for(var At,Ft=0;Ft<ht.length;Ft++){if((At=Et(ht.charAt(Ft)))==="L")return!1;if(At==="R")return!0}return!1},Qt=function(ht,At,Ft,St){var ue,ce,ae,se,Lt=At[St];switch(Lt){case"L":case"R":rt=!1;break;case"N":case"AN":break;case"EN":rt&&(Lt="AN");break;case"AL":rt=!0,Lt="R";break;case"WS":Lt="N";break;case"CS":St<1||St+1>=At.length||(ue=Ft[St-1])!=="EN"&&ue!=="AN"||(ce=At[St+1])!=="EN"&&ce!=="AN"?Lt="N":rt&&(ce="AN"),Lt=ce===ue?ce:"N";break;case"ES":Lt=(ue=St>0?Ft[St-1]:"B")==="EN"&&St+1<At.length&&At[St+1]==="EN"?"EN":"N";break;case"ET":if(St>0&&Ft[St-1]==="EN"){Lt="EN";break}if(rt){Lt="N";break}for(ae=St+1,se=At.length;ae<se&&At[ae]==="ET";)ae++;Lt=ae<se&&At[ae]==="EN"?"EN":"N";break;case"NSM":if(g&&!h){for(se=At.length,ae=St+1;ae<se&&At[ae]==="NSM";)ae++;if(ae<se){var Ht=ht[St],fe=Ht>=1425&&Ht<=2303||Ht===64286;if(ue=At[ae],fe&&(ue==="R"||ue==="AL")){Lt="R";break}}}Lt=St<1||(ue=At[St-1])==="B"?"N":Ft[St-1];break;case"B":rt=!1,l=!0,Lt=ct;break;case"S":n=!0,Lt="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":rt=!1;break;case"BN":Lt="N"}return Lt},Ut=function(ht,At,Ft){var St=ht.split("");return Ft&&dt(St,Ft,{hiLevel:ct}),St.reverse(),At&&At.reverse(),St.join("")},dt=function(ht,At,Ft){var St,ue,ce,ae,se,Lt=-1,Ht=ht.length,fe=0,j=[],It=ct?S:G,bt=[];for(rt=!1,l=!1,n=!1,ue=0;ue<Ht;ue++)bt[ue]=Et(ht[ue]);for(ce=0;ce<Ht;ce++){if(se=fe,j[ce]=Qt(ht,bt,j,ce),St=240&(fe=It[se][O[j[ce]]]),fe&=15,At[ce]=ae=It[fe][5],St>0)if(St===16){for(ue=Lt;ue<ce;ue++)At[ue]=1;Lt=-1}else Lt=-1;if(It[fe][6])Lt===-1&&(Lt=ce);else if(Lt>-1){for(ue=Lt;ue<ce;ue++)At[ue]=ae;Lt=-1}bt[ce]==="B"&&(At[ce]=0),Ft.hiLevel|=ae}n&&function(Vt,Xt,he){for(var me=0;me<he;me++)if(Vt[me]==="S"){Xt[me]=ct;for(var be=me-1;be>=0&&Vt[be]==="WS";be--)Xt[be]=ct}}(bt,At,Ht)},ee=function(ht,At,Ft,St,ue){if(!(ue.hiLevel<ht)){if(ht===1&&ct===1&&!l)return At.reverse(),void(Ft&&Ft.reverse());for(var ce,ae,se,Lt,Ht=At.length,fe=0;fe<Ht;){if(St[fe]>=ht){for(se=fe+1;se<Ht&&St[se]>=ht;)se++;for(Lt=fe,ae=se-1;Lt<ae;Lt++,ae--)ce=At[Lt],At[Lt]=At[ae],At[ae]=ce,Ft&&(ce=Ft[Lt],Ft[Lt]=Ft[ae],Ft[ae]=ce);fe=se}fe++}}},oe=function(ht,At,Ft){var St=ht.split(""),ue={hiLevel:ct};return Ft||(Ft=[]),dt(St,Ft,ue),function(ce,ae,se){if(se.hiLevel!==0&&_)for(var Lt,Ht=0;Ht<ce.length;Ht++)ae[Ht]===1&&(Lt=tt.indexOf(ce[Ht]))>=0&&(ce[Ht]=tt[Lt+1])}(St,Ft,ue),ee(2,St,At,Ft,ue),ee(1,St,At,Ft,ue),St.join("")};return this.__bidiEngine__.doBidiReorder=function(ht,At,Ft){if(function(ue,ce){if(ce)for(var ae=0;ae<ue.length;ae++)ce[ae]=ae;h===void 0&&(h=Pt(ue)),B===void 0&&(B=Pt(ue))}(ht,At),g||!m||B)if(g&&m&&h^B)ct=h?1:0,ht=Ut(ht,At,Ft);else if(!g&&m&&B)ct=h?1:0,ht=oe(ht,At,Ft),ht=Ut(ht,At);else if(!g||h||m||B){if(g&&!m&&h^B)ht=Ut(ht,At),h?(ct=0,ht=oe(ht,At,Ft)):(ct=1,ht=oe(ht,At,Ft),ht=Ut(ht,At));else if(g&&h&&!m&&B)ct=1,ht=oe(ht,At,Ft),ht=Ut(ht,At);else if(!g&&!m&&h^B){var St=_;h?(ct=1,ht=oe(ht,At,Ft),ct=0,_=!1,ht=oe(ht,At,Ft),_=St):(ct=0,ht=oe(ht,At,Ft),ht=Ut(ht,At),ct=1,_=!1,ht=oe(ht,At,Ft),_=St,ht=Ut(ht,At))}}else ct=0,ht=oe(ht,At,Ft);else ct=h?1:0,ht=oe(ht,At,Ft);return ht},this.__bidiEngine__.setOptions=function(ht){ht&&(g=ht.isInputVisual,m=ht.isOutputVisual,h=ht.isInputRtl,B=ht.isOutputRtl,_=ht.isSymmetricSwapping)},this.__bidiEngine__.setOptions(o),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new i.__bidiEngine__({isInputVisual:!0});i.API.events.push(["postProcessText",function(o){var l=o.text,n=(o.x,o.y,o.options||{}),g=(o.mutex,n.lang,[]);if(n.isInputVisual=typeof n.isInputVisual!="boolean"||n.isInputVisual,e.setOptions(n),Object.prototype.toString.call(l)==="[object Array]"){var h=0;for(g=[],h=0;h<l.length;h+=1)Object.prototype.toString.call(l[h])==="[object Array]"?g.push([e.doBidiReorder(l[h][0]),l[h][1],l[h][2]]):g.push([e.doBidiReorder(l[h])]);o.text=g}else o.text=e.doBidiReorder(l);e.setOptions({isInputVisual:!0})}])}(nr),nr.API.TTFFont=function(){function i(t){var e;if(this.rawData=t,e=this.contents=new mc(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new fK(this),this.registerTTF()}return i.open=function(t){return new i(t)},i.prototype.parse=function(){return this.directory=new iK(this.contents),this.head=new nK(this),this.name=new lK(this),this.cmap=new $5(this),this.toUnicode={},this.hhea=new sK(this),this.maxp=new cK(this),this.hmtx=new uK(this),this.post=new aK(this),this.os2=new oK(this),this.loca=new pK(this),this.glyf=new hK(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},i.prototype.registerTTF=function(){var t,e,o,l,n;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var g,h,m,B;for(B=[],g=0,h=(m=this.bbox).length;g<h;g++)t=m[g],B.push(Math.round(t*this.scaleFactor));return B}.call(this),this.stemV=0,this.post.exists?(o=255&(l=this.post.italic_angle),32768&(e=l>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+o)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(n=this.familyClass)===1||n===2||n===3||n===4||n===5||n===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},i.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},i.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},i.prototype.widthOfString=function(t,e,o){var l,n,g,h;for(g=0,n=0,h=(t=""+t).length;0<=h?n<h:n>h;n=0<=h?++n:--n)l=t.charCodeAt(n),g+=this.widthOfGlyph(this.characterToGlyph(l))+o*(1e3/e)||0;return g*(e/1e3)},i.prototype.lineHeight=function(t,e){var o;return e==null&&(e=!1),o=e?this.lineGap:0,(this.ascender+o-this.decender)/1e3*t},i}();mc=function(){function i(t){this.data=t??[],this.pos=0,this.length=this.data.length}return i.prototype.readByte=function(){return this.data[this.pos++]},i.prototype.writeByte=function(t){return this.data[this.pos++]=t},i.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},i.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},i.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},i.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},i.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},i.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},i.prototype.readString=function(t){var e,o;for(o=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)o[e]=String.fromCharCode(this.readByte());return o.join("")},i.prototype.writeString=function(t){var e,o,l;for(l=[],e=0,o=t.length;0<=o?e<o:e>o;e=0<=o?++e:--e)l.push(this.writeByte(t.charCodeAt(e)));return l},i.prototype.readShort=function(){return this.readInt16()},i.prototype.writeShort=function(t){return this.writeInt16(t)},i.prototype.readLongLong=function(){var t,e,o,l,n,g,h,m;return t=this.readByte(),e=this.readByte(),o=this.readByte(),l=this.readByte(),n=this.readByte(),g=this.readByte(),h=this.readByte(),m=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^o)+4294967296*(255^l)+16777216*(255^n)+65536*(255^g)+256*(255^h)+(255^m)+1):72057594037927940*t+281474976710656*e+1099511627776*o+4294967296*l+16777216*n+65536*g+256*h+m},i.prototype.writeLongLong=function(t){var e,o;return e=Math.floor(t/4294967296),o=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(o>>24&255),this.writeByte(o>>16&255),this.writeByte(o>>8&255),this.writeByte(255&o)},i.prototype.readInt=function(){return this.readInt32()},i.prototype.writeInt=function(t){return this.writeInt32(t)},i.prototype.read=function(t){var e,o;for(e=[],o=0;0<=t?o<t:o>t;o=0<=t?++o:--o)e.push(this.readByte());return e},i.prototype.write=function(t){var e,o,l,n;for(n=[],o=0,l=t.length;o<l;o++)e=t[o],n.push(this.writeByte(e));return n},i}(),iK=function(){var i;function t(e){var o,l,n;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},l=0,n=this.tableCount;0<=n?l<n:l>n;l=0<=n?++l:--l)o={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[o.tag]=o}return t.prototype.encode=function(e){var o,l,n,g,h,m,B,_,E,G,S,O,P;for(P in S=Object.keys(e).length,m=Math.log(2),E=16*Math.floor(Math.log(S)/m),g=Math.floor(E/m),_=16*S-E,(l=new mc).writeInt(this.scalarType),l.writeShort(S),l.writeShort(E),l.writeShort(g),l.writeShort(_),n=16*S,B=l.pos+n,h=null,O=[],e)for(G=e[P],l.writeString(P),l.writeInt(i(G)),l.writeInt(B),l.writeInt(G.length),O=O.concat(G),P==="head"&&(h=B),B+=G.length;B%4;)O.push(0),B++;return l.write(O),o=2981146554-i(l.data),l.pos=h+8,l.writeUInt32(o),l.data},i=function(e){var o,l,n,g;for(e=tS.call(e);e.length%4;)e.push(0);for(n=new mc(e),l=0,o=0,g=e.length;o<g;o=o+=4)l+=n.readUInt32();return 4294967295&l},t}(),rK={}.hasOwnProperty,XA=function(i,t){for(var e in t)rK.call(t,e)&&(i[e]=t[e]);function o(){this.constructor=i}return o.prototype=t.prototype,i.prototype=new o,i.__super__=t.prototype,i};IA=function(){function i(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return i.prototype.parse=function(){},i.prototype.encode=function(){},i.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},i}();nK=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="head",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},t.prototype.encode=function(e){var o;return(o=new mc).writeInt(this.version),o.writeInt(this.revision),o.writeInt(this.checkSumAdjustment),o.writeInt(this.magicNumber),o.writeShort(this.flags),o.writeShort(this.unitsPerEm),o.writeLongLong(this.created),o.writeLongLong(this.modified),o.writeShort(this.xMin),o.writeShort(this.yMin),o.writeShort(this.xMax),o.writeShort(this.yMax),o.writeShort(this.macStyle),o.writeShort(this.lowestRecPPEM),o.writeShort(this.fontDirectionHint),o.writeShort(e),o.writeShort(this.glyphDataFormat),o.data},t}(),G5=function(){function i(t,e){var o,l,n,g,h,m,B,_,E,G,S,O,P,tt,z,rt,ct;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),E=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(m=0;m<256;++m)this.codeMap[m]=t.readByte();break;case 4:for(S=t.readUInt16(),G=S/2,t.pos+=6,n=function(){var Et,Pt;for(Pt=[],m=Et=0;0<=G?Et<G:Et>G;m=0<=G?++Et:--Et)Pt.push(t.readUInt16());return Pt}(),t.pos+=2,P=function(){var Et,Pt;for(Pt=[],m=Et=0;0<=G?Et<G:Et>G;m=0<=G?++Et:--Et)Pt.push(t.readUInt16());return Pt}(),B=function(){var Et,Pt;for(Pt=[],m=Et=0;0<=G?Et<G:Et>G;m=0<=G?++Et:--Et)Pt.push(t.readUInt16());return Pt}(),_=function(){var Et,Pt;for(Pt=[],m=Et=0;0<=G?Et<G:Et>G;m=0<=G?++Et:--Et)Pt.push(t.readUInt16());return Pt}(),l=(this.length-t.pos+this.offset)/2,h=function(){var Et,Pt;for(Pt=[],m=Et=0;0<=l?Et<l:Et>l;m=0<=l?++Et:--Et)Pt.push(t.readUInt16());return Pt}(),m=z=0,ct=n.length;z<ct;m=++z)for(tt=n[m],o=rt=O=P[m];O<=tt?rt<=tt:rt>=tt;o=O<=tt?++rt:--rt)_[m]===0?g=o+B[m]:(g=h[_[m]/2+(o-O)-(G-m)]||0)!==0&&(g+=B[m]),this.codeMap[o]=65535&g}t.pos=E}return i.encode=function(t,e){var o,l,n,g,h,m,B,_,E,G,S,O,P,tt,z,rt,ct,Et,Pt,Qt,Ut,dt,ee,oe,ht,At,Ft,St,ue,ce,ae,se,Lt,Ht,fe,j,It,bt,Vt,Xt,he,me,be,Ve,De,ei;switch(St=new mc,g=Object.keys(t).sort(function(ri,Ii){return ri-Ii}),e){case"macroman":for(P=0,tt=function(){var ri=[];for(O=0;O<256;++O)ri.push(0);return ri}(),rt={0:0},n={},ue=0,Lt=g.length;ue<Lt;ue++)rt[be=t[l=g[ue]]]==null&&(rt[be]=++P),n[l]={old:t[l],new:rt[t[l]]},tt[l]=rt[t[l]];return St.writeUInt16(1),St.writeUInt16(0),St.writeUInt32(12),St.writeUInt16(0),St.writeUInt16(262),St.writeUInt16(0),St.write(tt),{charMap:n,subtable:St.data,maxGlyphID:P+1};case"unicode":for(At=[],E=[],ct=0,rt={},o={},z=B=null,ce=0,Ht=g.length;ce<Ht;ce++)rt[Pt=t[l=g[ce]]]==null&&(rt[Pt]=++ct),o[l]={old:Pt,new:rt[Pt]},h=rt[Pt]-l,z!=null&&h===B||(z&&E.push(z),At.push(l),B=h),z=l;for(z&&E.push(z),E.push(65535),At.push(65535),oe=2*(ee=At.length),dt=2*Math.pow(Math.log(ee)/Math.LN2,2),G=Math.log(dt/2)/Math.LN2,Ut=2*ee-dt,m=[],Qt=[],S=[],O=ae=0,fe=At.length;ae<fe;O=++ae){if(ht=At[O],_=E[O],ht===65535){m.push(0),Qt.push(0);break}if(ht-(Ft=o[ht].new)>=32768)for(m.push(0),Qt.push(2*(S.length+ee-O)),l=se=ht;ht<=_?se<=_:se>=_;l=ht<=_?++se:--se)S.push(o[l].new);else m.push(Ft-ht),Qt.push(0)}for(St.writeUInt16(3),St.writeUInt16(1),St.writeUInt32(12),St.writeUInt16(4),St.writeUInt16(16+8*ee+2*S.length),St.writeUInt16(0),St.writeUInt16(oe),St.writeUInt16(dt),St.writeUInt16(G),St.writeUInt16(Ut),he=0,j=E.length;he<j;he++)l=E[he],St.writeUInt16(l);for(St.writeUInt16(0),me=0,It=At.length;me<It;me++)l=At[me],St.writeUInt16(l);for(Ve=0,bt=m.length;Ve<bt;Ve++)h=m[Ve],St.writeUInt16(h);for(De=0,Vt=Qt.length;De<Vt;De++)Et=Qt[De],St.writeUInt16(Et);for(ei=0,Xt=S.length;ei<Xt;ei++)P=S[ei],St.writeUInt16(P);return{charMap:o,subtable:St.data,maxGlyphID:ct+1}}},i}(),$5=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="cmap",t.prototype.parse=function(e){var o,l,n;for(e.pos=this.offset,this.version=e.readUInt16(),n=e.readUInt16(),this.tables=[],this.unicode=null,l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)o=new G5(e,this.offset),this.tables.push(o),o.isUnicode&&this.unicode==null&&(this.unicode=o);return!0},t.encode=function(e,o){var l,n;return o==null&&(o="macroman"),l=G5.encode(e,o),(n=new mc).writeUInt16(0),n.writeUInt16(1),l.table=n.data.concat(l.subtable),l},t}(),sK=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="hhea",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},t}(),oK=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="OS/2",t.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var o,l;for(l=[],o=0;o<10;++o)l.push(e.readByte());return l}(),this.charRange=function(){var o,l;for(l=[],o=0;o<4;++o)l.push(e.readInt());return l}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var o,l;for(l=[],o=0;o<2;o=++o)l.push(e.readInt());return l}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},t}(),aK=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="post",t.prototype.parse=function(e){var o,l,n;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:break;case 131072:var g;for(l=e.readUInt16(),this.glyphNameIndex=[],g=0;0<=l?g<l:g>l;g=0<=l?++g:--g)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],n=[];e.pos<this.offset+this.length;)o=e.readByte(),n.push(this.names.push(e.readString(o)));return n;case 151552:return l=e.readUInt16(),this.offsets=e.read(l);case 196608:break;case 262144:return this.map=function(){var h,m,B;for(B=[],g=h=0,m=this.file.maxp.numGlyphs;0<=m?h<m:h>m;g=0<=m?++h:--h)B.push(e.readUInt32());return B}.call(this)}},t}(),AK=function(i,t){this.raw=i,this.length=i.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},lK=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="name",t.prototype.parse=function(e){var o,l,n,g,h,m,B,_,E,G,S;for(e.pos=this.offset,e.readShort(),o=e.readShort(),m=e.readShort(),l=[],g=0;0<=o?g<o:g>o;g=0<=o?++g:--g)l.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+m+e.readShort()});for(B={},g=E=0,G=l.length;E<G;g=++E)n=l[g],e.pos=n.offset,_=e.readString(n.length),h=new AK(_,n),B[S=n.nameID]==null&&(B[S]=[]),B[n.nameID].push(h);this.strings=B,this.copyright=B[0],this.fontFamily=B[1],this.fontSubfamily=B[2],this.uniqueSubfamily=B[3],this.fontName=B[4],this.version=B[5];try{this.postscriptName=B[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=B[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=B[7],this.manufacturer=B[8],this.designer=B[9],this.description=B[10],this.vendorUrl=B[11],this.designerUrl=B[12],this.license=B[13],this.licenseUrl=B[14],this.preferredFamily=B[15],this.preferredSubfamily=B[17],this.compatibleFull=B[18],this.sampleText=B[19]},t}(),cK=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="maxp",t.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},t}(),uK=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="hmtx",t.prototype.parse=function(e){var o,l,n,g,h,m,B;for(e.pos=this.offset,this.metrics=[],o=0,m=this.file.hhea.numberOfMetrics;0<=m?o<m:o>m;o=0<=m?++o:--o)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(n=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var _,E;for(E=[],o=_=0;0<=n?_<n:_>n;o=0<=n?++_:--_)E.push(e.readInt16());return E}(),this.widths=function(){var _,E,G,S;for(S=[],_=0,E=(G=this.metrics).length;_<E;_++)g=G[_],S.push(g.advance);return S}.call(this),l=this.widths[this.widths.length-1],B=[],o=h=0;0<=n?h<n:h>n;o=0<=n?++h:--h)B.push(this.widths.push(l));return B},t.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},t}(),tS=[].slice,hK=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(e){var o,l,n,g,h,m,B,_,E,G;return e in this.cache?this.cache[e]:(g=this.file.loca,o=this.file.contents,l=g.indexOf(e),(n=g.lengthOf(e))===0?this.cache[e]=null:(o.pos=this.offset+l,h=(m=new mc(o.read(n))).readShort(),_=m.readShort(),G=m.readShort(),B=m.readShort(),E=m.readShort(),this.cache[e]=h===-1?new dK(m,_,G,B,E):new gK(m,h,_,G,B,E),this.cache[e]))},t.prototype.encode=function(e,o,l){var n,g,h,m,B;for(h=[],g=[],m=0,B=o.length;m<B;m++)n=e[o[m]],g.push(h.length),n&&(h=h.concat(n.encode(l)));return g.push(h.length),{table:h,offsets:g}},t}(),gK=function(){function i(t,e,o,l,n,g){this.raw=t,this.numberOfContours=e,this.xMin=o,this.yMin=l,this.xMax=n,this.yMax=g,this.compound=!1}return i.prototype.encode=function(){return this.raw.data},i}(),dK=function(){function i(t,e,o,l,n){var g,h;for(this.raw=t,this.xMin=e,this.yMin=o,this.xMax=l,this.yMax=n,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],g=this.raw;h=g.readShort(),this.glyphOffsets.push(g.pos),this.glyphIDs.push(g.readUInt16()),32&h;)g.pos+=1&h?4:2,128&h?g.pos+=8:64&h?g.pos+=4:8&h&&(g.pos+=2)}return i.prototype.encode=function(){var t,e,o;for(e=new mc(tS.call(this.raw.data)),t=0,o=this.glyphIDs.length;t<o;++t)e.pos=this.glyphOffsets[t];return e.data},i}(),pK=function(i){function t(){return t.__super__.constructor.apply(this,arguments)}return XA(t,IA),t.prototype.tag="loca",t.prototype.parse=function(e){var o,l;return e.pos=this.offset,o=this.file.head.indexToLocFormat,this.offsets=o===0?function(){var n,g;for(g=[],l=0,n=this.length;l<n;l+=2)g.push(2*e.readUInt16());return g}.call(this):function(){var n,g;for(g=[],l=0,n=this.length;l<n;l+=4)g.push(e.readUInt32());return g}.call(this)},t.prototype.indexOf=function(e){return this.offsets[e]},t.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},t.prototype.encode=function(e,o){for(var l=new Uint32Array(this.offsets.length),n=0,g=0,h=0;h<l.length;++h)if(l[h]=n,g<o.length&&o[g]==h){++g,l[h]=n;var m=this.offsets[h],B=this.offsets[h+1]-m;B>0&&(n+=B)}for(var _=new Array(4*l.length),E=0;E<l.length;++E)_[4*E+3]=255&l[E],_[4*E+2]=(65280&l[E])>>8,_[4*E+1]=(16711680&l[E])>>16,_[4*E]=(4278190080&l[E])>>24;return _},t}(),fK=function(){function i(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return i.prototype.generateCmap=function(){var t,e,o,l,n;for(e in l=this.font.cmap.tables[0].codeMap,t={},n=this.subset)o=n[e],t[e]=l[o];return t},i.prototype.glyphsFor=function(t){var e,o,l,n,g,h,m;for(l={},g=0,h=t.length;g<h;g++)l[n=t[g]]=this.font.glyf.glyphFor(n);for(n in e=[],l)(o=l[n])!=null&&o.compound&&e.push.apply(e,o.glyphIDs);if(e.length>0)for(n in m=this.glyphsFor(e))o=m[n],l[n]=o;return l},i.prototype.encode=function(t,e){var o,l,n,g,h,m,B,_,E,G,S,O,P,tt,z;for(l in o=$5.encode(this.generateCmap(),"unicode"),g=this.glyphsFor(t),S={0:0},z=o.charMap)S[(m=z[l]).old]=m.new;for(O in G=o.maxGlyphID,g)O in S||(S[O]=G++);return _=function(rt){var ct,Et;for(ct in Et={},rt)Et[rt[ct]]=ct;return Et}(S),E=Object.keys(_).sort(function(rt,ct){return rt-ct}),P=function(){var rt,ct,Et;for(Et=[],rt=0,ct=E.length;rt<ct;rt++)h=E[rt],Et.push(_[h]);return Et}(),n=this.font.glyf.encode(g,P,S),B=this.font.loca.encode(n.offsets,P),tt={cmap:this.font.cmap.raw(),glyf:n.table,loca:B,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(tt["OS/2"]=this.font.os2.raw()),this.font.directory.encode(tt)},i}();nr.API.PDFObject=function(){var i;function t(){}return i=function(e,o){return(Array(o+1).join("0")+e).slice(-o)},t.convert=function(e){var o,l,n,g;if(Array.isArray(e))return"["+function(){var h,m,B;for(B=[],h=0,m=e.length;h<m;h++)o=e[h],B.push(t.convert(o));return B}().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e!=null&&e.isString)return"("+e+")";if(e instanceof Date)return"(D:"+i(e.getUTCFullYear(),4)+i(e.getUTCMonth(),2)+i(e.getUTCDate(),2)+i(e.getUTCHours(),2)+i(e.getUTCMinutes(),2)+i(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(l in n=["<<"],e)g=e[l],n.push("/"+l+" "+t.convert(g));return n.push(">>"),n.join(`
`)}return""+e},t}();(function(i){var t={};function e(o){if(t[o])return t[o].exports;var l=t[o]={i:o,l:!1,exports:{}};return i[o].call(l.exports,l,l.exports,e),l.l=!0,l.exports}e.m=i,e.c=t,e.d=function(o,l,n){e.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:n})},e.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},e.t=function(o,l){if(1&l&&(o=e(o)),8&l||4&l&&typeof o=="object"&&o&&o.__esModule)return o;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:o}),2&l&&typeof o!="string")for(var g in o)e.d(n,g,function(h){return o[h]}.bind(null,g));return n},e.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return e.d(l,"a",l),l},e.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},e.p="",e(e.s=0)})([function(i,t,e){i.exports=e(1)},function(i,t){function e(l,n){for(var g=0;g<n.length;g++){var h=n[g];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(l,h.key,h)}}var o=function(){function l(){(function(h,m){if(!(h instanceof m))throw new TypeError("Cannot call a class as a function")})(this,l),this.options={overlayBackgroundColor:"#666666",overlayOpacity:.6,spinnerIcon:"ball-circus",spinnerColor:"#000",spinnerSize:"3x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetY:0,offsetX:0,lockScroll:!1,containerID:null,spinnerZIndex:99999,overlayZIndex:99998},this.stylesheetBaseURL="https://cdn.jsdelivr.net/npm/load-awesome@1.1.0/css/",this.spinner=null,this.spinnerStylesheetURL=null,this.numberOfEmptyDivForSpinner={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":1,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1}}var n,g;return n=l,(g=[{key:"show",value:function(h){this.setOptions(h),this.addSpinnerStylesheet(),this.generateSpinnerElement(),this.options.lockScroll&&(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden"),this.generateAndAddOverlayElement()}},{key:"hide",value:function(){this.options.lockScroll&&(document.body.style.overflow="",document.documentElement.style.overflow="");var h=document.getElementById("loading-overlay-stylesheet");h&&(h.disabled=!0,h.parentNode.removeChild(h),document.getElementById(this.options.overlayIDName).remove(),document.getElementById(this.options.spinnerIDName).remove())}},{key:"setOptions",value:function(h){if(h!==void 0)for(var m in h)this.options[m]=h[m]}},{key:"generateAndAddOverlayElement",value:function(){var h="50%";this.options.offsetX!==0&&(h="calc(50% + "+this.options.offsetX+")");var m="50%";if(this.options.offsetY!==0&&(m="calc(50% + "+this.options.offsetY+")"),this.options.containerID&&document.body.contains(document.getElementById(this.options.containerID))){var B='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: absolute; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,'; z-index: 50; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: absolute; top: ').concat(m,"; left: ").concat(h,'; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: 9999;">').concat(this.spinner,"</div>"),_=document.getElementById(this.options.containerID);return _.style.position="relative",void _.insertAdjacentHTML("beforeend",B)}var E='<div id="'.concat(this.options.overlayIDName,'" style="display: block !important; position: fixed; top: 0; left: 0; overflow: auto; opacity: ').concat(this.options.overlayOpacity,"; background: ").concat(this.options.overlayBackgroundColor,"; z-index: ").concat(this.options.overlayZIndex,'; width: 100%; height: 100%;"></div><div id="').concat(this.options.spinnerIDName,'" style="display: block !important; position: fixed; top: ').concat(m,"; left: ").concat(h,"; -webkit-transform: translate(-50%); -ms-transform: translate(-50%); transform: translate(-50%); z-index: ").concat(this.options.spinnerZIndex,';">').concat(this.spinner,"</div>");document.body.insertAdjacentHTML("beforeend",E)}},{key:"generateSpinnerElement",value:function(){var h=this,m=Object.keys(this.numberOfEmptyDivForSpinner).find(function(_){return _===h.options.spinnerIcon}),B=this.generateEmptyDivElement(this.numberOfEmptyDivForSpinner[m]);this.spinner='<div style="color: '.concat(this.options.spinnerColor,'" class="la-').concat(this.options.spinnerIcon," la-").concat(this.options.spinnerSize,'">').concat(B,"</div>")}},{key:"addSpinnerStylesheet",value:function(){this.setSpinnerStylesheetURL();var h=document.createElement("link");h.setAttribute("id","loading-overlay-stylesheet"),h.setAttribute("rel","stylesheet"),h.setAttribute("type","text/css"),h.setAttribute("href",this.spinnerStylesheetURL),document.getElementsByTagName("head")[0].appendChild(h)}},{key:"setSpinnerStylesheetURL",value:function(){this.spinnerStylesheetURL=this.stylesheetBaseURL+this.options.spinnerIcon+".min.css"}},{key:"generateEmptyDivElement",value:function(h){for(var m="",B=1;B<=h;B++)m+="<div></div>";return m}}])&&e(n.prototype,g),l}();window.JsLoadingOverlay=new o,i.exports=JsLoadingOverlay}]);dc={JPEG:"jpg",PNG:"png",PDF:"pdf",SVG:"svg"},$g={in:"in",mm:"mm"},gh={A2:[594,420],A3:[420,297],A4:[297,210],A5:[210,148],A6:[148,105],B2:[707,500],B3:[500,353],B4:[353,250],B5:[250,176],B6:[176,125]},Xg={Landscape:"landscape",Portrait:"portrait"},Wy={72:72,96:96,200:200,300:300,400:400},zy=class{constructor(t,e=gh.A4,o=300,l=dc.PNG.toString(),n=$g.mm,g="map"){gn(this,"map"),gn(this,"width"),gn(this,"height"),gn(this,"dpi"),gn(this,"format"),gn(this,"unit"),gn(this,"fileName"),this.map=t,this.width=e[0],this.height=e[1],this.dpi=o,this.format=l,this.unit=n,this.fileName=g}generate(){let t=this;JsLoadingOverlay.show({overlayBackgroundColor:"#5D5959",overlayOpacity:"0.6",spinnerIcon:"ball-spin",spinnerColor:"#2400FD",spinnerSize:"2x",overlayIDName:"overlay",spinnerIDName:"spinner",offsetX:0,offsetY:0,containerID:null,lockScroll:!1,overlayZIndex:9998,spinnerZIndex:9999});let e=window.devicePixelRatio;Object.defineProperty(window,"devicePixelRatio",{get(){return t.dpi/96}});let o=document.createElement("div");o.className="hidden-map",document.body.appendChild(o);let l=document.createElement("div");l.style.width=this.toPixels(this.width),l.style.height=this.toPixels(this.height),o.appendChild(l);let n=this.map.getStyle();if(n&&n.sources){let h=n.sources;Object.keys(h).forEach(m=>{let B=h[m];Object.keys(B).forEach(_=>{B[_]||delete B[_]})})}let g=new Z5.Map({container:l,style:n,center:this.map.getCenter(),zoom:this.map.getZoom(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1,transformRequest:this.map._requestManager._transformRequestFn});g.once("idle",()=>{var h;let m=g.getCanvas(),B=`${this.fileName}.${t.format}`;switch(t.format){case dc.PNG:t.toPNG(m,B);break;case dc.JPEG:t.toJPEG(m,B);break;case dc.PDF:t.toPDF(g,B);break;case dc.SVG:t.toSVG(m,B);break;default:console.error(`Invalid file format: ${t.format}`);break}g.remove(),(h=o.parentNode)==null||h.removeChild(o),Object.defineProperty(window,"devicePixelRatio",{get(){return e}}),o.remove(),JsLoadingOverlay.hide()})}toPNG(t,e){let o=document.createElement("a");o.href=t.toDataURL(),o.download=e,o.click(),o.remove()}toJPEG(t,e){let o=t.toDataURL("image/jpeg",.85);if(t.msToBlob){let l=this.toBlob(o);window.navigator.msSaveBlob(l,e)}else{let l=document.createElement("a");l.href=o,l.download=e,l.click(),l.remove()}}toPDF(t,e){let o=t.getCanvas(),l=new nr({orientation:this.width>this.height?"l":"p",unit:this.unit,compress:!0,format:[this.width,this.height]});l.addImage(o.toDataURL("image/png"),"png",0,0,this.width,this.height,void 0,"FAST");let{lng:n,lat:g}=t.getCenter();l.setProperties({title:t.getStyle().name,subject:`center: [${n}, ${g}], zoom: ${t.getZoom()}`,creator:"Mapbox GL Export Plugin",author:"(c)Mapbox, (c)OpenStreetMap"}),l.save(e)}toSVG(t,e){let o=t.toDataURL("image/png"),l=Number(this.toPixels(this.width,this.dpi).replace("px","")),n=Number(this.toPixels(this.height,this.dpi).replace("px","")),g=`
    <svg xmlns="http://www.w3.org/2000/svg" 
      xmlns:xlink="http://www.w3.org/1999/xlink" 
      version="1.1" 
      width="${l}" 
      height="${n}" 
      viewBox="0 0 ${l} ${n}" 
      xml:space="preserve">
        <image style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;"  
      xlink:href="${o}" width="${l}" height="${n}"></image>
    </svg>`,h=document.createElement("a");h.href=`data:application/xml,${encodeURIComponent(g)}`,h.download=e,h.click(),h.remove()}toPixels(t,e=96){return this.unit===$g.mm&&(e/=25.4),`${e*t}px`}toBlob(t){let e=atob(t.replace(/^.*,/,"")),o=new Uint8Array(e.length);for(let l=0;l<e.length;l+=1)o[l]=e.charCodeAt(l);return new Blob([o.buffer],{type:"image/png"})}},Jy=class{constructor(t){gn(this,"map"),gn(this,"width"),gn(this,"height"),gn(this,"unit"),gn(this,"svgCanvas"),gn(this,"svgPath");var e,o,l;if(this.map=t,this.map===void 0)return;this.mapResize=this.mapResize.bind(this),this.map.on("resize",this.mapResize);let n=(e=this.map)==null?void 0:e.getCanvas().clientWidth,g=(o=this.map)==null?void 0:o.getCanvas().clientHeight,h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.style.position="absolute",h.style.top="0px",h.style.left="0px",h.setAttribute("width",`${n}px`),h.setAttribute("height",`${g}px`);let m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttribute("style","fill:#888888;stroke-width:0"),m.setAttribute("fill-opacity","0.5"),h.append(m),(l=this.map)==null||l.getCanvasContainer().appendChild(h),this.svgCanvas=h,this.svgPath=m}mapResize(){this.generateCutOut()}updateArea(t,e){this.width=t,this.height=e,this.unit=$g.mm,this.generateCutOut()}generateCutOut(){var t,e;if(this.map===void 0||this.svgCanvas===void 0||this.svgPath===void 0)return;let o=this.toPixels(this.width),l=this.toPixels(this.height),n=(t=this.map)==null?void 0:t.getCanvas().clientWidth,g=(e=this.map)==null?void 0:e.getCanvas().clientHeight,h=n/2-o/2,m=h+o,B=g/2-l/2,_=B+l;this.svgCanvas.setAttribute("width",`${n}px`),this.svgCanvas.setAttribute("height",`${g}px`),this.svgPath.setAttribute("d",`M 0 0 L ${n} 0 L ${n} ${g} L 0 ${g} M ${h} ${B} L ${h} ${_} L ${m} ${_} L ${m} ${B}`)}destroy(){this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map=void 0)}toPixels(t,e=96){return this.unit===$g.mm&&(e/=25.4),e*t}},R5={PageSize:"Page Size",PageOrientation:"Page Orientation",Format:"Format",DPI:"DPI",Generate:"Generate"},mK={PageSize:"Taille de page",PageOrientation:"Orientation de la page",Format:"Format",DPI:"DPI",Generate:"G\xE9n\xE9rer"},CK={PageSize:"Sivukoko",PageOrientation:"Sivun suunta",Format:"Muoto",DPI:"DPI",Generate:"Generoi"},IK={PageSize:"Papierformat",PageOrientation:"Papierausrichtung",Format:"Dateiformat",DPI:"Druckaufl\xF6sung",Generate:"Erstellen"},yK={PageSize:"Sidstorlek",PageOrientation:"Sidorientering",Format:"Format",DPI:"DPI",Generate:"Generera"},bK={PageSize:"Tama\xF1o de p\xE1gina",PageOrientation:"Orientaci\xF3n de p\xE1gina",Format:"Formato",DPI:"DPI",Generate:"Generar"},vK={PageSize:"K\xEDch th\u01B0\u1EDBc trang",PageOrientation:"Lo\u1EA1i trang",Format:"\u0110\u1ECBnh d\u1EA1ng",DPI:"M\u1EADt \u0111\u1ED9 \u0111i\u1EC3m \u1EA3nh (DPI)",Generate:"T\u1EA1o"},wK={PageSize:"\u0420\u043E\u0437\u043C\u0456\u0440 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438",PageOrientation:"\u041E\u0440\u0456\u0454\u043D\u0442\u0430\u0446\u0456\u044F \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438",Format:"\u0424\u043E\u0440\u043C\u0430\u0442",DPI:"DPI",Generate:"\u0417\u0433\u0435\u043D\u0435\u0440\u0443\u0432\u0430\u0442\u0438"},BK={PageSize:"\u9875\u9762\u5927\u5C0F",PageOrientation:"\u9875\u9762\u65B9\u5411",Format:"\u683C\u5F0F",DPI:"\u50CF\u7D20",Generate:"\u5BFC\u51FA"},_K={PageSize:"\u9801\u9762\u5927\u5C0F",PageOrientation:"\u9801\u9762\u65B9\u5411",Format:"\u683C\u5F0F",DPI:"\u50CF\u7D20",Generate:"\u5C0E\u51FA"},xK={PageSize:"\u30DA\u30FC\u30B8\u30B5\u30A4\u30BA",PageOrientation:"\u30DA\u30FC\u30B8\u65B9\u5411",Format:"\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8",DPI:"DPI\uFF08\u89E3\u50CF\u5EA6\uFF09",Generate:"\u51FA\u529B"},td=class{constructor(t){gn(this,"controlContainer"),gn(this,"exportContainer"),gn(this,"crosshair"),gn(this,"printableArea"),gn(this,"map"),gn(this,"exportButton"),gn(this,"options",{PageSize:gh.A4,PageOrientation:Xg.Landscape,Format:dc.PDF,DPI:Wy[300],Crosshair:!1,PrintableArea:!1,Local:"en",AllowedSizes:Object.keys(gh),Filename:"map"}),t&&(this.options=Object.assign(this.options,t)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}getTranslation(){switch(this.options.Local){case"de":return IK;case"en":return R5;case"fr":return mK;case"fi":return CK;case"sv":return yK;case"es":return bK;case"vi":return vK;case"uk":return wK;case"zhHans":return BK;case"zhHant":return _K;case"ja":return xK;default:return R5}}onAdd(t){var e;this.map=t,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("maplibregl-ctrl"),this.controlContainer.classList.add("maplibregl-ctrl-group"),this.exportContainer=document.createElement("div"),this.exportContainer.classList.add("maplibregl-export-list"),this.exportButton=document.createElement("button"),this.exportButton.classList.add("maplibregl-ctrl-icon"),this.exportButton.classList.add("maplibregl-export-control"),this.exportButton.type="button",this.exportButton.addEventListener("click",()=>{this.exportButton.style.display="none",this.exportContainer.style.display="block",this.toggleCrosshair(!0),this.togglePrintableArea(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.exportButton),this.controlContainer.appendChild(this.exportContainer);let o=document.createElement("TABLE");o.className="print-table";let l={};(e=this.options.AllowedSizes)==null||e.forEach(_=>{gh[_]&&(l[_]=gh[_])});let n=this.createSelection(l,this.getTranslation().PageSize,"page-size",this.options.PageSize,(_,E)=>JSON.stringify(_[E]));o.appendChild(n);let g=this.createSelection(Xg,this.getTranslation().PageOrientation,"page-orientation",this.options.PageOrientation,(_,E)=>_[E]);o.appendChild(g);let h=this.createSelection(dc,this.getTranslation().Format,"format-type",this.options.Format,(_,E)=>_[E]);o.appendChild(h);let m=this.createSelection(Wy,this.getTranslation().DPI,"dpi-type",this.options.DPI,(_,E)=>_[E]);o.appendChild(m),this.exportContainer.appendChild(o);let B=document.createElement("button");return B.type="button",B.textContent=this.getTranslation().Generate,B.classList.add("generate-button"),B.addEventListener("click",()=>{let _=document.getElementById("mapbox-gl-export-page-size"),E=document.getElementById("mapbox-gl-export-page-orientation"),G=document.getElementById("mapbox-gl-export-format-type"),S=document.getElementById("mapbox-gl-export-dpi-type"),O=E.value,P=JSON.parse(_.value);O===Xg.Portrait&&(P=P.reverse()),new zy(t,P,Number(S.value),G.value,$g.mm,this.options.Filename).generate()}),this.exportContainer.appendChild(B),this.controlContainer}createSelection(t,e,o,l,n){let g=document.createElement("label");g.textContent=e;let h=document.createElement("select");h.setAttribute("id",`mapbox-gl-export-${o}`),h.style.width="100%",Object.keys(t).forEach(E=>{let G=document.createElement("option");G.setAttribute("value",n(t,E)),G.appendChild(document.createTextNode(E)),G.setAttribute("name",o),l===t[E]&&(G.selected=!0),h.appendChild(G)}),h.addEventListener("change",()=>{this.updatePrintableArea()});let m=document.createElement("TR"),B=document.createElement("TD"),_=document.createElement("TD");return B.appendChild(g),_.appendChild(h),m.appendChild(B),m.appendChild(_),m}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.exportButton||(this.exportButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.map=void 0)}onDocumentClick(t){this.controlContainer&&!this.controlContainer.contains(t.target)&&this.exportContainer&&this.exportButton&&(this.exportContainer.style.display="none",this.exportButton.style.display="block",this.toggleCrosshair(!1),this.togglePrintableArea(!1))}toggleCrosshair(t){this.options.Crosshair===!0&&(t===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new Uy(this.map),this.crosshair.create()))}togglePrintableArea(t){this.options.PrintableArea===!0&&(t===!1?this.printableArea!==void 0&&(this.printableArea.destroy(),this.printableArea=void 0):(this.printableArea=new Jy(this.map),this.updatePrintableArea()))}updatePrintableArea(){if(this.printableArea===void 0)return;let t=document.getElementById("mapbox-gl-export-page-size"),e=document.getElementById("mapbox-gl-export-page-orientation").value,o=JSON.parse(t.value);e===Xg.Portrait&&(o=o.reverse()),this.printableArea.updateArea(o[0],o[1])}}});var Us=Su(Dh()),eS=Su(fb()),iS=Su(qb());_y();var dO=Su(Dh());function BO(i,t){i.importCSS("main.css"),i.root.innerHTML=`
    <div id='map' style='width: 896px; height: 400px;'></div>
  `;let e="map",o=t.spec,{markers:l=[],clusters:n=[],controls:g=[],locate:h=[],terrain:m=[],geocode:B=[],fullscreen:_=[],scale:E=[],export_map:G=[],hover:S=[],center:O=[],info:P=[],images:tt=[],jumps:z=[],fit_bounds:rt=[]}=t.events,ct=new Us.Map({container:e,style:o});eS.default.addProtocols(Us),ct.on("load",function(){l.forEach(({location:Lt,options:Ht})=>{Et({location:Lt,options:Ht})}),n.forEach(Lt=>{ce(Lt)}),g.forEach(({position:Lt,options:Ht})=>{Pt({position:Lt,options:Ht})}),h.forEach(({high_accuracy:Lt,options:Ht})=>{Qt({high_accuracy:Lt,options:Ht})}),m.forEach(()=>{Ut()}),B.forEach(()=>{dt()}),_.forEach(()=>{ee()}),E.forEach(Lt=>{oe(Lt)}),G.forEach(Lt=>{ht(Lt)}),S.forEach(Lt=>{ue(Lt)}),O.forEach(Lt=>{Ft(Lt)}),P.forEach(({layer:Lt,property:Ht})=>{St({layer:Lt,property:Ht})}),tt.forEach(({name:Lt,url:Ht,options:fe})=>{At({name:Lt,url:Ht,options:fe})}),z.forEach(({location:Lt,options:Ht})=>{ct.easeTo({center:Lt,...Ht})}),rt.forEach(({bounds:Lt,options:Ht})=>{ct.fitBounds(Lt,Ht)})}),i.handleEvent("add_markers",Lt=>{Lt.forEach(({location:Ht,options:fe})=>{Et({location:Ht,options:fe})})}),i.handleEvent("add_marker",({location:Lt,options:Ht})=>{Et({location:Lt,options:Ht})}),i.handleEvent("add_nav_controls",({position:Lt,options:Ht})=>{Pt({position:Lt,options:Ht})}),i.handleEvent("add_locate",({high_accuracy:Lt,options:Ht})=>{Qt({high_accuracy:Lt,options:Ht})}),i.handleEvent("add_terrain",()=>{Ut()}),i.handleEvent("add_geocode",()=>{dt()}),i.handleEvent("add_fullscreen",()=>{ee()}),i.handleEvent("add_scale",Lt=>{oe(Lt)}),i.handleEvent("add_export_map",Lt=>{ht(Lt)}),i.handleEvent("clusters_expansion",Lt=>{ce(Lt)}),i.handleEvent("add_hover",Lt=>{ue(Lt)}),i.handleEvent("center_on_click",Lt=>{Ft(Lt)}),i.handleEvent("info_on_click",({layer:Lt,property:Ht})=>{St({layer:Lt,property:Ht})}),i.handleEvent("add_custom_image",({name:Lt,url:Ht,options:fe})=>{At({name:Lt,url:Ht,options:fe})}),i.handleEvent("jump_to",({location:Lt,options:Ht})=>{ct.easeTo({center:Lt,...Ht})}),i.handleEvent("fit_bounds",({bounds:Lt,options:Ht})=>{ct.fitBounds(Lt,Ht)});function Et({location:Lt,options:Ht}){new Us.Marker(Ht).setLngLat(Lt).addTo(ct)}function Pt({position:Lt,options:Ht}){let fe=new Us.NavigationControl(Ht);ct.addControl(fe,Lt)}function Qt({high_accuracy:Lt,options:Ht}){let fe=new Us.GeolocateControl({positionOptions:{enableHighAccuracy:Lt,maximumAge:0,timeout:6e3},...Ht});ct.addControl(fe)}function Ut(){let Lt=ct.getTerrain(),Ht=new Us.TerrainControl(Lt);ct.addControl(Ht)}function dt(){ct.addControl(se())}function ee(){let Lt=new Us.FullscreenControl;ct.addControl(Lt)}function oe(Lt){let Ht=new Us.ScaleControl(Lt);ct.addControl(Ht)}function ht({filename:Lt,options:Ht}){let fe=new td({Filename:Lt,...Ht});ct.addControl(fe)}function At({name:Lt,url:Ht,options:fe}){ct.loadImage(Ht,(j,It)=>{if(j)throw j;ct.addImage(Lt,It,fe)})}function Ft(Lt){ct.on("click",Lt,Ht=>{let fe=Ht.features[0].geometry.coordinates;ct.easeTo({center:fe})})}function St({layer:Lt,property:Ht}){ct.on("click",Lt,fe=>{new Us.Popup().setLngLat(fe.lngLat).setHTML(fe.features[0].properties[Ht]).addTo(ct)}),ae(Lt)}function ue(Lt){let Ht=null,fe=ct.getLayer(Lt).source;ct.on("mousemove",Lt,j=>{j.features.length>0&&(Ht&&ct.setFeatureState({source:fe,id:Ht},{hover:!1}),Ht=j.features[0].id,ct.setFeatureState({source:fe,id:Ht},{hover:!0}))}),ct.on("mouseleave",Lt,()=>{Ht&&ct.setFeatureState({source:fe,id:Ht},{hover:!1}),Ht=null})}function ce(Lt){ct.on("click",Lt,Ht=>{let fe=ct.getLayer(Lt).source,j=ct.queryRenderedFeatures(Ht.point,{layers:[Lt]}),It=j[0].properties.cluster_id;ct.getSource(fe).getClusterExpansionZoom(It,(bt,Vt)=>{bt||ct.easeTo({center:j[0].geometry.coordinates,zoom:Vt})})}),ae(Lt)}function ae(Lt){ct.on("mouseenter",Lt,()=>{ct.getCanvas().style.cursor="pointer"}),ct.on("mouseleave",Lt,()=>{ct.getCanvas().style.cursor=""})}function se(){let Lt={forwardGeocode:async Ht=>{let fe=[];try{let j=`https://nominatim.openstreetmap.org/search?q=${Ht.query}&format=geojson&polygon_geojson=1&addressdetails=1`,bt=await(await fetch(j)).json();for(let Vt of bt.features){let Xt=[Vt.bbox[0]+(Vt.bbox[2]-Vt.bbox[0])/2,Vt.bbox[1]+(Vt.bbox[3]-Vt.bbox[1])/2],he={type:"Feature",geometry:{type:"Point",coordinates:Xt},place_name:Vt.properties.display_name,properties:Vt.properties,text:Vt.properties.display_name,place_type:["place"],center:Xt};fe.push(he)}}catch(j){console.error(`Failed to forwardGeocode with error: ${j}`)}return{features:fe}}};return new iS.default(Lt,{maplibregl:Us})}}export{BO as init};
/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */
/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */
/**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */
/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */
/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */
/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */
/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */
/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */
/** @license
 *
 * jsPDF - PDF Document creation from JavaScript
 * Version 2.5.1 Built on 2022-01-28T15:37:57.791Z
 *                      CommitID 00000000
 *
 * Copyright (c) 2010-2021 James Hall <james@parall.ax>, https://github.com/MrRio/jsPDF
 *               2015-2021 yWorks GmbH, http://www.yworks.com
 *               2015-2021 Lukas Holländer <lukas.hollaender@yworks.com>, https://github.com/HackbrettXXX
 *               2016-2018 Aras Abbasi <aras.abbasi@gmail.com>
 *               2010 Aaron Spike, https://github.com/acspike
 *               2012 Willow Systems Corporation, https://github.com/willowsystems
 *               2012 Pablo Hess, https://github.com/pablohess
 *               2012 Florian Jenett, https://github.com/fjenett
 *               2013 Warren Weckesser, https://github.com/warrenweckesser
 *               2013 Youssef Beddad, https://github.com/lifof
 *               2013 Lee Driscoll, https://github.com/lsdriscoll
 *               2013 Stefan Slonevskiy, https://github.com/stefslon
 *               2013 Jeremy Morel, https://github.com/jmorel
 *               2013 Christoph Hartmann, https://github.com/chris-rock
 *               2014 Juan Pablo Gaviria, https://github.com/juanpgaviria
 *               2014 James Makes, https://github.com/dollaruw
 *               2014 Diego Casorran, https://github.com/diegocr
 *               2014 Steven Spungin, https://github.com/Flamenco
 *               2014 Kenneth Glassey, https://github.com/Gavvers
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * Contributor(s):
 *    siefkenj, ahwolf, rickygu, Midnith, saintclair, eaparango,
 *    kim3er, mfo, alnorth, Flamenco
 */
